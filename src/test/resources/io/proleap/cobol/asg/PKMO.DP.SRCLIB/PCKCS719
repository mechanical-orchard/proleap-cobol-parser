000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300*                                                                *00030000
000400* VIRTUAL LABEL CALCULATE/CREATE FROM CASEPACK SPLIT USING UCC128*00040000
000500*                                                                *00050000
000600******************************************************************00060000
000700* CHANGE LOG:                                                     00070099
000700*                                                                 00070199
000700* 02/14/2023     JEAN KURK                    CHG0281369          00070299
000700*                REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE     00070399
000700*                                                                 00070599
000600******************************************************************00071099
000700                                                                  00072099
000800 PROGRAM-ID.    PCKCS719.                                         00080000
000900 AUTHOR.        DENISE HAHN.                                      00090000
001000 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00100000
001100 DATE-WRITTEN   JUNE 2000.                                        00110000
001200 DATE-COMPILED.                                                   00120000
001300                                                                  00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 CONFIGURATION SECTION.                                           00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800                                                                  00180000
001900 DATA DIVISION.                                                   00190000
002000 WORKING-STORAGE SECTION.                                         00200000
002100                                                                  00210000
002200*----------------------------------------------------------------*00220000
002300*   PROGRAM SWITCHES                                             *00230000
002400*----------------------------------------------------------------*00240000
002500 01  PS-PROGRAM-SWITCHES.                                         00250000
002600                                                                  00260000
002700     05  PS-EOF-UCC128-SW             PIC X(01) VALUE 'N'.        00270000
002800         88  PS-NOT-EOF-UCC128-CSR              VALUE 'N'.        00280000
002900         88  PS-EOF-UCC128-CSR                  VALUE 'Y'.        00290000
003000     05  PS-EOF-EXPECT-SW             PIC X(01) VALUE 'N'.        00300000
003100         88  PS-NOT-EOF-EXPECT-CSR              VALUE 'N'.        00310000
003200         88  PS-EOF-EXPECT-CSR                  VALUE 'Y'.        00320000
003300     05  PS-EOF-PREPK-SW              PIC X(01) VALUE 'N'.        00330000
003400         88  PS-NOT-EOF-PREPK-CSR               VALUE 'N'.        00340000
003500         88  PS-EOF-PREPK-CSR                   VALUE 'Y'.        00350000
003600     05  PS-EOF-SHPSUM-SW             PIC X(01) VALUE 'N'.        00360000
003700         88  PS-NOT-EOF-SHPSUM-CSR              VALUE 'N'.        00370000
003800         88  PS-EOF-SHPSUM-CSR                  VALUE 'Y'.        00380000
003900     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00390000
004000         88  PS-NO-ERROR                        VALUE 'N'.        00400000
004100         88  PS-ERROR                           VALUE 'Y'.        00410000
004200     05  PS-UCC128-FCSE-MATCH-SW      PIC X(01) VALUE 'N'.        00420000
004300         88  PS-NOT-UCC128-FCSE-MATCH           VALUE 'N'.        00430000
004400         88  PS-UCC128-FCSE-MATCH               VALUE 'Y'.        00440000
004500     05  PS-UCC128-FCSE-PARTIAL-SW    PIC X(01) VALUE 'N'.        00450000
004600         88  PS-NOT-UCC128-FCSE-PARTIAL         VALUE 'N'.        00460000
004700         88  PS-UCC128-FCSE-PARTIAL             VALUE 'Y'.        00470000
004800     05  PS-CARTON-USE-SW             PIC X(01) VALUE ' '.        00480000
004900         88  PS-CARTON-USE-FCSE                 VALUE 'F'.        00490000
005000         88  PS-CARTON-USE-INPK                 VALUE 'I'.        00500000
005100     05  PS-CARTON-LABEL-SW           PIC X(01) VALUE ' '.        00510000
005200         88  PS-CARTON-LABEL-SML                VALUE 'S'.        00520000
005300         88  PS-CARTON-LABEL-P2L                VALUE 'P'.        00530000
005400     05  PS-CARTON-MASTER-SW          PIC X(01) VALUE 'Y'.        00540000
005500         88  PS-CARTON-MASTER-YES               VALUE 'Y'.        00550000
005600         88  PS-CARTON-MASTER-NO                VALUE 'N'.        00560000
005700     05  PS-INSERT-UPDATE-SW          PIC X(01) VALUE ' '.        00570000
005800         88  PS-DISTHD-INSERT                   VALUE 'I'.        00580000
005900         88  PS-DISTHD-UPDATE                   VALUE 'U'.        00590000
006000     05  PS-SAME-SUMMARY-SW           PIC X(01) VALUE ' '.        00600000
006100         88  PS-SAME-SUMMARY-YES                VALUE 'Y'.        00610000
006200         88  PS-SAME-SUMMARY-NO                 VALUE 'N'.        00620000
006300     05  PS-COMBO-LNE-IN-PREPK-SW     PIC X(01) VALUE ' '.        00630000
006400         88  PS-COMBO-LNE-IN-PREPK              VALUE 'Y'.        00640000
006500         88  PS-COMBO-LNE-IN-UNKNOWN            VALUE ' '.        00650000
006600     05  PS-COMBO-LNE-NOT-PREPK-SW     PIC X(01) VALUE ' '.       00660000
006700         88  PS-COMBO-LNE-NOT-PREPK              VALUE 'Y'.       00670000
006800         88  PS-COMBO-LNE-NOT-UNKNOWN            VALUE ' '.       00680000
006900     05  PS-COMBO-ENTRY-PREPK-SW      PIC X(01) VALUE ' '.        00690000
007000         88  PS-COMBO-ENTRY-PREPK               VALUE 'Y'.        00700000
007100         88  PS-COMBO-ENTRY-PREPK-UNK           VALUE ' '.        00710000
007200     05  PS-COMBO-ENTRY-NOT-PREPK-SW  PIC X(01) VALUE ' '.        00720000
007300         88  PS-COMBO-ENTRY-NOT-PREPK           VALUE 'N'.        00730000
007400         88  PS-COMBO-ENTRY-NOT-PREPK-UNK       VALUE ' '.        00740000
007500     05  PS-ENTRIES-PREPK-SW          PIC X(01) VALUE 'Y'.        00750000
007600         88  PS-ENTRIES-MIS-PREPK               VALUE 'N'.        00760000
007700         88  PS-ENTRIES-ALL-PREPK               VALUE 'Y'.        00770000
007800     05  PS-RATIO-MULT-SW             PIC X(01) VALUE 'N'.        00780000
007900         88  PS-SAME-RATIO-MULT                 VALUE 'N'.        00790000
008000         88  PS-DIFF-RATIO-MULT                 VALUE 'Y'.        00800000
008100     05  PS-RATIO-REMAINDER-SW        PIC X(01) VALUE 'N'.        00810000
008200         88  PS-NO-RATIO-REMAINDER-ERROR        VALUE 'N'.        00820000
008300         88  PS-RATIO-REMAINDER-ERROR           VALUE 'Y'.        00830000
008400     05  PS-PREPK-LINES-LEFT-SW       PIC X(01) VALUE 'Y'.        00840000
008500         88  PS-PREPK-LINES-LEFT                VALUE 'Y'.        00850000
008600         88  PS-NO-PREPK-LINES-LEFT             VALUE 'N'.        00860000
008700     05  PS-POG-DATA-FOUND-SW         PIC X(01) VALUE 'Y'.        00870000
008800         88  PS-POG-DATA-FOUND                  VALUE 'Y'.        00880000
008900         88  PS-NO-POG-DATA-FOUND               VALUE 'N'.        00890000
009000     05  PS-SEASET-DATA-FOUND-SW      PIC X(01) VALUE 'Y'.        00900000
009100         88  PS-SEASET-DATA-FOUND               VALUE 'Y'.        00910000
009200         88  PS-NO-SEASET-DATA-FOUND            VALUE 'N'.        00920000
009300     05  PS-EOF-DOOR-SEQ-CSR-SW       PIC X(01) VALUE 'N'.        00930000
009400         88  PS-NOT-EOF-DOOR-SEQ-CSR            VALUE 'N'.        00940000
009500         88  PS-EOF-DOOR-SEQ-CSR                VALUE 'Y'.        00950000
009510     05  PS-P2L-SEASET-CHECKED-SW     PIC X(01) VALUE 'N'.        00951026
009520         88  PS-P2L-SEASET-CHECKED-YES          VALUE 'Y'.        00952026
009530         88  PS-P2L-SEASET-CHECKED-NO           VALUE 'N'.        00953026
009540     05  PS-PRESENTATION-IND-SW       PIC X(01) VALUE ' '.        00954035
009550         88  PS-PRESENTATION-HANG               VALUE 'H'.        00955035
009560         88  PS-PRESENTATION-FOLD               VALUE 'F'.        00956035
009570     05  PS-SET-EAS-TAG-SW            PIC X(01) VALUE 'N'.        00957035
009580         88  PS-SET-EAS-TAG-YES                 VALUE 'Y'.        00958035
009590         88  PS-SET-EAS-TAG-NO                  VALUE 'N'.        00959035
009591     05  PS-P2L-LABEL-DISPLAY-SW         PIC  X(01)  VALUE 'N'.   00959179
009592         88  PS-TRIP-ARRIVE-DATE-ON-LABEL            VALUE 'Y'.   00959279
009593         88  PS-P2L-MOD-ON-LABEL                     VALUE 'N'.   00959379
009600                                                                  00960000
009700*----------------------------------------------------------------*00970000
009800*   DB2 KEYS                                                     *00980000
009900*----------------------------------------------------------------*00990000
010000 01  DB2-KEYS.                                                    01000000
010100                                                                  01010000
010200     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE ZERO.  01020000
010300     05  DK-STORE-NBR                 PIC S9(4) COMP VALUE ZEROES.01030000
010400     05  DK-PO-NBR                    PIC S9(9) COMP VALUE ZERO.  01040000
010500     05  DK-RCVR-SEQ-NBR              PIC S9(9) COMP VALUE ZERO.  01050000
010600     05  DK-ORD-LNE-NBR               PIC S9(9) COMP VALUE ZERO.  01060000
010700     05  DK-MOD-NBR                   PIC S9(4) COMP VALUE ZERO.  01070000
010800     05  DK-WORK-ORD-SEQ-NBR          PIC S9(4) COMP VALUE ZEROES.01080000
010900     05  DK-PREPK-ID                  PIC S9(4) COMP VALUE ZEROES.01090000
011000     05  DK-PREPK-LNE-NBR             PIC S9(9) COMP VALUE ZEROES.01100000
011100     05  DK-PREPK-RATIO-QTY           PIC S9(4) COMP VALUE ZEROES.01110000
011200                                                                  01120000
011300*----------------------------------------------------------------*01130000
011400*   PROGRAM CONSTANTS                                            *01140000
011500*----------------------------------------------------------------*01150000
011600 01  PC-PROGRAM-CONSTANTS.                                        01160000
011700                                                                  01170000
011800     05  PC-DEFAULT-TIMESTAMP        PIC  X(26)  VALUE            01180000
011900                                     '9999-09-09-09.09.09.999999'.01190000
012000     05  PC-DEFAULT-DTE              PIC  X(10)  VALUE            01200000
012100                                                     '9999-09-09'.01210000
012200     05  PC-DEFAULT-TM               PIC  X(08)  VALUE '01.01.01'.01220000
012300                                                                  01230000
012400     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'PCKCS719'.01240000
012500                                                                  01250000
012600     05  PC-MANIFEST-NBR-MODULE      PIC  X(08)  VALUE 'PCKCS721'.01260000
012700                                                                  01270000
012800***  05  PC-MAX-UCC128-TBL-ENTRY     PIC S9(04)  VALUE  +5000     01280099
012810     05  PC-MAX-UCC128-TBL-ENTRY     PIC S9(05)  VALUE  +9999     01281099
012900                                                 COMP SYNC.       01290000
013000     05  PC-MAX-EXPTED-TBL-ENTRY     PIC S9(04)  VALUE  +1500     01300000
013100                                                 COMP SYNC.       01310000
013200***  05  PC-MAX-CARTON-TBL-ENTRY     PIC S9(04)  VALUE  +5000     01320099
013210     05  PC-MAX-CARTON-TBL-ENTRY     PIC S9(05)  VALUE  +9999     01321099
013300                                                 COMP SYNC.       01330000
013400     05  PC-MAX-PREPK-LINE-ENTRY     PIC S9(04)  VALUE  +50       01340000
013500                                                 COMP SYNC.       01350000
013600***  05  PC-MAX-BEST-CASE-ENTRY      PIC S9(04)  VALUE  +5000     01360099
013610     05  PC-MAX-BEST-CASE-ENTRY      PIC S9(05)  VALUE  +9999     01361099
013700                                                 COMP SYNC.       01370000
013800     05  PC-A                        PIC  X(01)  VALUE  'A'.      01380000
013900     05  PC-C                        PIC  X(01)  VALUE  'C'.      01390000
014000     05  PC-E                        PIC  X(01)  VALUE  'E'.      01400000
014100     05  PC-F                        PIC  X(01)  VALUE  'F'.      01410000
014200     05  PC-I                        PIC  X(01)  VALUE  'I'.      01420000
014300     05  PC-M                        PIC  X(01)  VALUE  'M'.      01430000
014400     05  PC-N                        PIC  X(01)  VALUE  'N'.      01440000
014500     05  PC-P                        PIC  X(01)  VALUE  'P'.      01450000
014600     05  PC-S                        PIC  X(01)  VALUE  'S'.      01460000
014700     05  PC-U                        PIC  X(01)  VALUE  'U'.      01470000
014800                                                                  01480000
014900     05  PC-0001                     PIC  9(04)  VALUE  0001.     01490000
015000     05  PC-DOWNLOADED-STATUS        PIC  X(01)  VALUE  'D'.      01500000
015100     05  PC-READY-TO-POST-STATUS     PIC  X(01)  VALUE  'N'.      01510000
015200     05  PC-P2L-PROCESSOR            PIC  X(04)  VALUE  'P2L '.   01520000
015300     05  PC-PREPK-P2L-DWNLD          PIC  X(01)  VALUE  'D'.      01530000
015400     05  PC-PREPK-NOT-DWNLD          PIC  X(01)  VALUE  'P'.      01540000
015500     05  PC-NON-PREPK                PIC  X(01)  VALUE  'N'.      01550000
015600                                                                  01560000
015700*----------------------------------------------------------------*01570000
015800*   PROGRAM VARIABLES                                            *01580000
015900*----------------------------------------------------------------*01590000
016000 01  PV-VARIABLES.                                                01600000
016100                                                                  01610000
016200     05  PV-DB2-CURRENT-DATE          PIC X(10) VALUE SPACES.     01620000
016300     05  PV-WORK-DATE                PIC  X(05)  VALUE SPACES.    01630000
016400     05  PV-CURRENT-DATE             PIC  X(10)  VALUE SPACES.    01640000
016500     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01650000
016600         10 PV-CURRENT-CC            PIC  9(02).                  01660000
016700         10 PV-CURRENT-YY            PIC  9(02).                  01670000
016800         10 FILLER                   PIC  X(01).                  01680000
016900         10 PV-CURRENT-MM            PIC  9(02).                  01690000
017000         10 FILLER                   PIC  X(01).                  01700000
017100         10 PV-CURRENT-DD            PIC  9(02).                  01710000
017200     05  PV-CURRENT-TIME             PIC  X(08)  VALUE SPACES.    01720000
017300     05  PV-CURRENT-TIME-R REDEFINES PV-CURRENT-TIME.             01730000
017400         10 PV-CURRENT-HR            PIC  9(02).                  01740000
017500         10 FILLER                   PIC  X(01).                  01750000
017600         10 PV-CURRENT-MN            PIC  9(02).                  01760000
017700         10 FILLER                   PIC  X(03).                  01770000
017800     05  PV-USER-ID-8.                                            01780000
017900         10  PV-USER-ID              PIC  X(07)  VALUE SPACES.    01790000
018000         10  FILLER                  PIC  X(01)  VALUE 'Q'.       01800000
018100     05  PV-SYSTEM-ID.                                            01810000
018200         10  FILLER                  PIC  X(04)  VALUE SPACE.     01820000
018300         10  PV-REGION-IND           PIC  X(01).                  01830000
018400             88  PV-TEST-CICS                    VALUE 'T'.       01840000
018500             88  PV-QA-CICS                      VALUE 'Q'.       01850000
018600             88  PV-PROD-CICS                    VALUE 'P'.       01860000
018700             88  PV-LEARN-CICS                   VALUE 'L'.       01870000
018800         10  FILLER                  PIC  X(01)  VALUE SPACES.    01880000
018900     05  PV-ABS-TIME                 PIC S9(15)  COMP-3.          01890000
019000     05  PV-DATE-TIME.                                            01900000
019100         10  PV-DATE                  PIC X(10) VALUE SPACES.     01910000
019200         10  FILLER                   PIC X(01) VALUE SPACES.     01920000
019300         10  PV-TIME                  PIC X(08) VALUE SPACES.     01930000
019400     05  PV-LBL-PRT-DATE.                                         01940000
019500         10  PV-LBL-PRT-MM            PIC 9(02)      VALUE ZEROES.01950000
019600         10  FILLER                   PIC X(01)      VALUE '-'.   01960000
019700         10  PV-LBL-PRT-DD            PIC 9(02)      VALUE ZEROES.01970000
019800         10  FILLER                   PIC X(01)      VALUE '-'.   01980000
019900         10  PV-LBL-PRT-YY            PIC 9(02)      VALUE ZEROES.01990000
020000     05  PV-LBL-PRT-TIME.                                         02000000
020100         10  PV-LBL-PRT-HR            PIC 9(02)      VALUE ZEROES.02010000
020200         10  FILLER                   PIC X(01)      VALUE ':'.   02020000
020300         10  PV-LBL-PRT-MN            PIC 9(02)      VALUE ZEROES.02030000
020400     05  PV-SQL-RETURN-CD             PIC 999-.                   02040000
020500                                                                  02050000
020600     05  PV-HNG-FOLD-SEQ-NBR         PIC  X(01).                  02060050
020610     05  PV-NBR-CRTNS-FOR-OTPK       PIC S9(09)  COMP.            02061046
020700     05  PV-SHIPPED-QTY              PIC S9(09)  COMP.            02070000
020800     05  PV-UCC128-TABLE-ENTRIES     PIC  9(04)  VALUE ZERO.      02080000
020900     05  PV-UCC128-MAX-OTPK          PIC  9(04)  VALUE ZERO.      02090000
021000     05  PV-UCC128-MIN-OTPK          PIC  9(04)  VALUE ZERO.      02100000
021100     05  PV-EXPECT-TABLE-ENTRIES     PIC  9(04)  VALUE ZERO.      02110000
021200     05  PV-CARTON-TABLE-ENTRIES     PIC  9(04)  VALUE ZERO.      02120000
021300     05  PV-PREPK-TABLE-ENTRIES      PIC  9(04)  VALUE ZERO.      02130000
021400     05  PV-BEST-CASE-TBL-ENTRIES    PIC  9(04)  VALUE ZERO.      02140000
021500     05  PV-TYPE-CODE-SEQ            PIC  X(01)  VALUE SPACE.     02150000
021600     05  PV-FCSE-ALLOCATED           PIC  9(04)  VALUE ZEROES.    02160000
021700     05  PV-INPK-ALLOCATED           PIC  9(04)  VALUE ZEROES.    02170000
021800     05  PV-NBR-OF-INPKS             PIC  9(04)  VALUE ZEROES.    02180000
021900     05  PV-NEEDED-MIN-OTPK          PIC  9(05)  VALUE ZEROES.    02190086
022000     05  PV-NEEDED-MAX-OTPK          PIC  9(05)  VALUE ZEROES.    02200086
022100     05  PV-CARTON-NBR               PIC  9(04)  VALUE ZEROES.    02210000
022200     05  PV-MSTR-CARTON-NBR          PIC  9(04)  VALUE ZEROES.    02220000
022300     05  PV-P2L-QTY-NEEDED           PIC  9(09)  VALUE ZEROES.    02230000
022400     05  PV-FCSE-CRTN-CNT            PIC  9(04)  VALUE ZEROES.    02240000
022500     05  PV-INPK-CRTN-CNT            PIC  9(04)  VALUE ZEROES.    02250000
022600     05  PV-P2L-CRTN-CNT             PIC  9(04)  VALUE ZEROES.    02260000
022700     05  PV-TOTAL-LBL-CNT            PIC S9(09)  VALUE ZEROES     02270000
022800                                                 COMP.            02280000
022900     05  PV-MANIFEST-NBR             PIC S9(09)  VALUE ZEROES     02290000
023000                                                 COMP.            02300000
023100     05  PV-DC-BOUND-UNTS            PIC  9(05)  VALUE ZEROES.    02310086
023200     05  PV-DC-BOUND-CTNS            PIC  9(04)  VALUE ZEROES.    02320000
023300     05  PV-RTV-BOUND-UNTS           PIC  9(05)  VALUE ZEROES.    02330086
023400     05  PV-RTV-BOUND-CTNS           PIC  9(04)  VALUE ZEROES.    02340000
023500     05  PV-CS-BOUND-UNTS            PIC  9(05)  VALUE ZEROES.    02350086
023600     05  PV-CS-BOUND-CTNS            PIC  9(04)  VALUE ZEROES.    02360000
023700     05  PV-INPK-OTPK-RESULT         PIC  9(04)  VALUE ZEROES.    02370000
023800     05  PV-INPK-OTPK-REMAINDER      PIC  9(04)  VALUE ZEROES.    02380000
023900     05  PV-MSTR-CRTN-ASSGN          PIC  9(08)  VALUE ZEROES     02390000
024000                                                 COMP.            02400000
024100     05  PV-MASTER-CRTN-SEQ-ID       PIC  9(04)  VALUE ZEROES.    02410000
024200     05  PV-SML-CRTN-SEQ             PIC  9(04)  VALUE ZEROES.    02420000
024300     05  PV-P2L-CRTN-SEQ             PIC  9(04)  VALUE ZEROES.    02430000
024400     05  PV-DEPT-NAME                PIC  X(25)  VALUE SPACES.    02440000
024500     05  PV-MAJOR-CLASS              PIC  X(25)  VALUE SPACES.    02450000
024600     05  PV-SEASET-SHRT-NM           PIC  X(25)  VALUE SPACES.    02460000
024700     05  PV-SEASET-RLSE-DT           PIC  X(10)  VALUE SPACES.    02470000
024800     05  PV-P2L-STR-ZONE             PIC  X(05)  VALUE SPACES.    02480000
024900     05  PV-FIXTURE                  PIC  X(05)  VALUE SPACES.    02490000
025000     05  PV-CL-NBR                   PIC  X(02)  VALUE SPACES.    02500000
025100     05  PV-BARCODE                  PIC  X(22)  VALUE SPACES.    02510000
025110*CLP 06/22/2015 START                                             02511099
025120     05  PV-BUS-AREA-BRAND           PIC  X(35)  VALUE SPACES.    02512099
025130     05  PV-DESC-LEN              PIC S9(04) VALUE +0             02513099
025140                                                COMP.             02514099
025141     05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     02514199
025142     05  PV-XL-DEPT-NBR              PIC  9(4)   VALUE ZEROES.    02514299
025143*CLP 06/22/2015 END                                               02514399
025200     05  PV-DIVERT-STORE.                                         02520000
025300         10  PV-DIVERT-CODE          PIC  9(01)  VALUE ZEROES.    02530022
025400         10  PV-STORE-NBR            PIC  9(04)  VALUE ZEROES.    02540022
025500     05  PV-DIVERT-PFX-NBR           PIC  9(01)  VALUE ZEROES.    02550022
025600                                                                  02560000
025700     05  PV-SOFT-ABORT-MSG.                                       02570000
025800         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02580000
025900         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02590000
026000         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02600000
026100         10  PV-SOFT-PARAGRAPH PIC X(30).                         02610000
026200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02620000
026300                                                    COMP SYNC.    02630000
026400     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02640000
026500     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02650000
026600     05  PV-CICS-MSG-HOLD.                                        02660000
026700         10  FILLER                      PIC  X(01)  VALUE SPACE. 02670000
026800         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02680000
026900     05  PV-CICS-MSG-HOLD3.                                       02690000
027000         10  FILLER                      PIC  X(01)  VALUE SPACE. 02700000
027100         10  FILLER                      PIC  X(11)  VALUE        02710000
027200                                         ' PO/RCVR - '.           02720000
027300         10  PV-HOLD3-PO                 PIC  Z(09).              02730000
027400         10  FILLER                      PIC  X(01)  VALUE '-'.   02740000
027500         10  PV-HOLD3-RCVR               PIC  9(04).              02750000
027600         10  FILLER                      PIC  X(11)  VALUE        02760000
027700                                         '    LINE - '.           02770000
027800         10  PV-HOLD3-LINE               PIC  Z(04).              02780000
027900         10  FILLER                      PIC  X(12)  VALUE        02790000
028000                                         '    STORE - '.          02800000
028100         10  PV-HOLD3-STORE              PIC  Z(04).              02810000
028200         10  FILLER                      PIC  X(43)  VALUE SPACE. 02820000
028300                                                                  02830000
028400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02840000
028500                                                     COMP SYNC.   02850000
028600     05  PV-PREVIOUS-SHPD-QTY            PIC  S9(9)V VALUE ZEROS  02860000
028700                                                     COMP-3.      02870000
028800     05  PV-OTPK-CARTON-COUNT            PIC  9(04)  VALUE ZEROS. 02880000
028900     05  PV-TOTAL-CARTON-COUNT           PIC  9(04)  VALUE ZEROS. 02890000
029000*                                                                 02900000
029100     05  PV-PREV-PO-NBR                  PIC  9(08)  VALUE ZEROS. 02910000
029200     05  PV-PREV-PKSL-SEQ                PIC  9(04)  VALUE ZEROS. 02920000
029300     05  PV-PREV-COMBO-NBR               PIC  9(04)  VALUE ZEROS. 02930000
029400     05  PV-PREV-OTPK-QTY                PIC  9(04)  VALUE ZEROS. 02940000
029500     05  PV-PREV-CRTN-CNT                PIC  9(04)  VALUE ZEROS. 02950000
029600     05  PV-TOTAL-PREPK-OTPK             PIC  9(04)  VALUE ZEROS. 02960000
029700     05  PV-DRVR-LNE-OTPK                PIC  9(04)  VALUE ZEROS. 02970000
029800     05  PV-DRVR-LNE-RATIO-MULT          PIC  9(04)  VALUE ZEROS. 02980000
029900     05  PV-PREPK-REMAINDER              PIC  9(04)  VALUE ZEROS. 02990000
030000     05  PV-RATIO-MULTIPLE               PIC  9(04)  VALUE ZEROS. 03000000
030100                                                                  03010000
030200     05  PV-P2L-SPLT-UNT-QTY-RATIO       PIC  S9(9) COMP.         03020000
030300     05  PV-FCSE-SPLT-UNT-QTY-RATIO      PIC  S9(9) COMP.         03030000
030400     05  PV-INPK-SPLT-UNT-QTY-RATIO      PIC  S9(9) COMP.         03040000
030500     05  PV-FCSE-ACTL-UNT-QTY-RATIO      PIC  S9(9) COMP.         03050000
030600     05  PV-EXPTED-ITM-QTY-RATIO         PIC  S9(9) COMP.         03060000
030700     05  PV-ACTL-ALLOC-QTY-RATIO         PIC  S9(9) COMP.         03070000
030800     05  PV-PRCS-QTY-UNT-RATIO           PIC  S9(9) COMP.         03080000
030900     05  PV-OTPK-UNT-RATIO               PIC  S9(4) COMP.         03090000
031000*                                                                 03100000
031100 01  PV-WORK-FIELDS.                                              03110000
031200     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.03120000
031300     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      03130000
031400                                                 COMP.            03140000
031500     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         03150000
031600                                                 COMP SYNC.       03160000
031700     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    03170000
031800     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           03180000
031900         10 PV-DPKUT038-YY               PIC  X(02).              03190000
032000         10 PV-DPKUT038-MM               PIC  X(02).              03200000
032100         10 PV-DPKUT038-DD               PIC  X(02).              03210000
032200     05  PV-DPKUT038-MJR-CL.                                      03220000
032300         10 FILLER                       PIC  X(01) VALUE SPACE.  03230000
032400         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  03240000
032401                                                                  03240179
032410     05  PV-MOD-DATE.                                             03241079
032420         10  PV-MOD                  PIC   99     VALUE ZEROES.   03242079
032430         10  PV-MOD-DATE-DASH        PIC   X      VALUE SPACE.    03243083
032440         10  PV-ARRIVE-MM            PIC   XX     VALUE ZEROES.   03244079
032450         10  PV-ARRIVE-DD            PIC   XX     VALUE ZEROES.   03245079
032460                                                                  03246079
032500                                                                  03250000
032600                                                                  03260000
032700*----------------------------------------------------------------*03270000
032800*    COMMAREA PASSED FROM CALLING PROGRAM                        *03280000
032900*----------------------------------------------------------------*03290000
033000     COPY PCWS166.                                                03300000
033100                                                                  03310000
033200*----------------------------------------------------------------*03320000
033300*    20 & 22 DIGIT LAYOUT FOR BARCODES                            03330000
033400*----------------------------------------------------------------*03340000
033500     COPY PCWS160.                                                03350000
033600                                                                  03360000
033601*CLP 06/22/2015 - START                                           03360199
033602*----------------------------------------------------------------*03360299
033603*  COPYBOOK FOR CALLED MODULE TO RETURN BUSINESS AREA ID          03360399
033604*  VSM INTERFACE                                                  03360499
033605*----------------------------------------------------------------*03360599
033606     COPY XLWS073.                                                03360699
033607*CLP 06/22/2015 - END                                             03360799
033608/                                                                 03360899
033700*----------------------------------------------------------------*03370000
033800*    COMMAREA FOR MANIFEST NUMBER MODULE (PCKCS721)               03380000
033900*----------------------------------------------------------------*03390000
034000     COPY PCWS187.                                                03400000
034100                                                                  03410000
034200*----------------------------------------------------------------*03420000
034300*    COMMAREA FOR SEASONAL SET AND FIXT ID MODULE (PCKUT025)      03430000
034400*----------------------------------------------------------------*03440000
034500     COPY PCWS240.                                                03450000
034600                                                                  03460000
034610*----------------------------------------------------------------*03461029
034620*    COMMAREA FOR ITEM DOMAIN ACCESS MODULE (XLKUT001)            03462029
034630*----------------------------------------------------------------*03463029
034640     COPY XLWS001.                                                03464029
034650                                                                  03465029
034700*----------------------------------------------------------------*03470000
034800*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *03480000
034900*----------------------------------------------------------------*03490000
035000     COPY DPWS003.                                                03500000
035100                                                                  03510000
035800*================================================================*03580000
035900* UCC128 DATA TABLE - THIS TABLE WILL CONTAIN THE OUTER PACK     *03590000
036000*      AND THE NUMBER OF CARTONS FOR EACH OUTER PACK, BASED ON   *03600000
036100*      UCC128 DATA.   MAXIMUM TABLE ENTRIES = 9999               *03610099
036200*================================================================*03620000
036300 01  PT-UCC128-DATA-TABLE.                                        03630000
036400***  05  PT-UCC128-DATA OCCURS 5000 TIMES                         03640099
036410     05  PT-UCC128-DATA OCCURS 9999 TIMES                         03641099
036500                              INDEXED BY PT-U128-IDX.             03650000
036600         10  PT-UCC128-OTPK           PIC S9(04) COMP.            03660000
036700         10  PT-UCC128-CRTNS          PIC  9(04).                 03670000
036800                                                                  03680000
036900*================================================================*03690000
037000* STORE EXPECTED TABLE - THIS TABLE WILL CONTAIN AN ENTRY FOR EACH03700000
037100*      EACH STORE FOR THE LINE BEING PROCESSED. MAX ENTRIES 1500 *03710000
037200*================================================================*03720000
037300 01  PT-STORE-EXPECT-TABLE.                                       03730000
037400     05  PT-STORE-EXPECT OCCURS 1500 TIMES                        03740000
037500                              INDEXED BY PT-EXPT-IDX.             03750000
037600         10  PT-EXPT-STR-TYP-ORDER    PIC  X(01).                 03760000
037700             88 PT-EXPT-DISTRB-CNTR             VALUES 'A'.       03770000
037800             88 PT-EXPT-RETURN-VNDR             VALUES 'B'.       03780000
037900             88 PT-EXPT-CENTRL-STCK             VALUES 'C'.       03790000
038000             88 PT-EXPT-E-COMMERCE              VALUES 'D'.       03800000
038100             88 PT-EXPT-STORE                   VALUES 'E'.       03810000
038200         10  PT-EXPT-STR-NBR          PIC S9(04) COMP.            03820000
038300         10  PT-EXPT-STR-TYP          PIC  X(02).                 03830000
038400         10  PT-EXPT-EXPTED-QTY       PIC  9(09).                 03840085
038500         10  PT-EXPT-NEEDED-QTY       PIC  9(09).                 03850085
038600         10  PT-EXPT-ALLOC-QTY        PIC  9(09).                 03860085
038700         10  PT-EXPT-FCSE-CNT         PIC  9(09).                 03870085
038800         10  PT-EXPT-INPK-CNT         PIC  9(09).                 03880085
038900         10  PT-EXPT-FCSE-UNTS        PIC  9(09).                 03890085
039000         10  PT-EXPT-INPK-UNTS        PIC  9(09).                 03900085
039100         10  PT-EXPT-P2L-UNTS         PIC  9(09).                 03910085
039200         10  PT-EXPT-E-COMMERCE-IND   PIC  X(01).                 03920000
039300             88  PT-EXPT-E-COMMERCE-YES          VALUE 'Y'.       03930000
039400             88  PT-EXPT-E-COMMERCE-NO           VALUE 'N'.       03940000
039500         10  PT-EXPT-SEASET-IND       PIC  X(01).                 03950000
039600             88  PT-EXPT-SEASET-YES              VALUE 'Y'.       03960000
039700             88  PT-EXPT-SEASET-NO               VALUE 'N'.       03970000
039800         10  PT-EXPT-POG-IND          PIC  X(01).                 03980000
039900             88  PT-EXPT-POG-YES                 VALUE 'Y'.       03990000
040000             88  PT-EXPT-POG-NO                  VALUE 'N'.       04000000
040100         10  PT-EXPT-FIXT-ID          PIC  X(10).                 04010000
040200         10  PT-EXPT-SEASONAL-SET     PIC  X(25).                 04020000
040201         10  PT-EXPT-DOOR-ID          PIC  X(04).                 04020137
040210         10  PT-EXPT-PRESENTATION-IND PIC  X(01).                 04021031
040211         10  PT-EXPT-EAS-TAG-IND      PIC  X(01).                 04021131
040212             88  PT-EXPT-EAS-TAG-YES             VALUE 'Y'.       04021231
040213             88  PT-EXPT-EAS-TAG-NO              VALUE 'N'.       04021331
040214         10  PT-EXPT-MERCHANDISE-PGM  PIC  X(35).                 04021455
040300                                                                  04030000
040400*================================================================*04040000
040500* CARTON TABLE - THIS TABLE WILL CONTAIN AN ENTRY FOR EACH CRTN  *04050000
040600*      ASSIGNED.  THIS TABLE WILL ONLY BE CREATED IF VIRTUAL     *04060000
040700*      LABELS ARE BEING CREATED.  THIS TABLE WILL BE USED TO     *04070000
040800*      CREATE ENTRIES                                            *04080000
040900*                     MAXIMUM TABLE ENTRIES = 9999               *04090099
041000*================================================================*04100000
041100 01  PT-CARTON-TABLE.                                             04110000
041200***  05  PT-CARTON OCCURS 5000 TIMES                              04120099
041210     05  PT-CARTON OCCURS 9999 TIMES                              04121099
041300                              INDEXED BY PT-CRTN-IDX.             04130000
041400         10  PT-CRTN-ASSGN-SEQ-NBR    PIC  9(04).                 04140000
041500         10  PT-CRTN-MSTR-CRTN        PIC  9(04).                 04150000
041600         10  PT-CRTN-STORE-NBR        PIC  9(04).                 04160000
041700         10  PT-CRTN-STORE-TYP        PIC  X(02).                 04170000
041800             88  PT-CRTN-CENTRL-STCK             VALUE 'CS'.      04180000
041900             88  PT-CRTN-DISTRB-CNTR             VALUE 'DC'.      04190000
042000             88  PT-CRTN-STORE                   VALUE 'DS'.      04200000
042100             88  PT-CRTN-RETURN-VNDR             VALUE 'RV'.      04210000
042200         10  PT-CRTN-OTPK-QTY         PIC  9(04).                 04220000
042300         10  PT-CRTN-MSTR             PIC  X(01).                 04230000
042400         10  PT-CRTN-USE              PIC  X(01).                 04240000
042500             88  PT-CRTN-FCSE-SML                VALUE 'F'.       04250000
042600             88  PT-CRTN-INPK-SML                VALUE 'I'.       04260000
042700         10  PT-CRTN-LBL-TYP          PIC  X(01).                 04270000
042800             88  PT-CRTN-SML                     VALUE 'S'.       04280000
042900             88  PT-CRTN-P2L                     VALUE 'P'.       04290000
043000         10  PT-CRTN-E-COMMERCE-IND   PIC  X(01).                 04300000
043100             88  PT-CRTN-E-COMMERCE-YES          VALUE 'Y'.       04310000
043200             88  PT-CRTN-E-COMMERCE-NO           VALUE 'N'.       04320000
043300         10  PT-CRTN-MANIFEST-NBR     PIC S9(09) VALUE ZEROES     04330000
043400                                                 COMP.            04340000
043500         10  PT-CRTN-SEASET-IND       PIC  X(01).                 04350000
043600             88  PT-CRTN-SEASET-YES              VALUE 'Y'.       04360000
043700             88  PT-CRTN-SEASET-NO               VALUE 'N'.       04370000
043800         10  PT-CRTN-FIXT-ID          PIC  X(10).                 04380000
043900         10  PT-CRTN-SEASONAL-SET     PIC  X(25).                 04390000
043901         10  PT-CRTN-DOOR-ID          PIC  X(04).                 04390137
043910         10  PT-CRTN-PRESENTATION-IND      PIC  X(01).            04391031
043920         10  PT-CRTN-EAS-TAG-IND      PIC  X(01).                 04392031
043930             88  PT-CRTN-EAS-TAG-YES            VALUE 'Y'.        04393055
043940             88  PT-CRTN-EAS-TAG-NO             VALUE 'N'.        04394055
043950         10  PT-CRTN-MERCHANDISE-PGM  PIC  X(35).                 04395055
044000                                                                  04400000
044100                                                                  04410000
044200*================================================================*04420000
044300* PREPACK LINE TABLE - THIS TABLE WILL CONTAIN AN ENTRY FOR EACH *04430000
044400*      LINE WITHIN THE PREPACK BEING PROCESSED.                  *04440000
044500*      MAXIMUM TABLE ENTRIES = 100                               *04450000
044600*================================================================*04460000
044700 01  PT-PREPK-LINE-TABLE.                                         04470000
044800     05  PT-PREPK-LINE OCCURS 100 TIMES                           04480000
044900                              INDEXED BY PT-PRPK-IDX.             04490000
045000         10  PT-PREPK-LNE-NBR         PIC  9(08).                 04500000
045100         10  PT-PREPK-RATIO           PIC  9(04).                 04510000
045200         10  PT-PREPK-DATA-SW         PIC  X.                     04520000
045300             88  PT-PREPK-DATA-AVAIL-YES         VALUE 'Y'.       04530000
045400             88  PT-PREPK-DATA-AVAIL-NO          VALUE 'N'.       04540000
045500         10  PT-PREPK-RATIO-MULT      PIC  9(04).                 04550000
045600         10  PT-PREPK-OTPK-QTY        PIC  9(04).                 04560000
045700                                                                  04570000
045800                                                                  04580000
045900*================================================================*04590000
046000* PREPACK BEST CASE TABLE - THIS TABLE WILL CONTAIN THE CARTORS  *04600000
046100*      THAT HAVE UCC128 DATA FOR ALL OF THE LINES WITHIN THE     *04610000
046200*      PREPACK.                                                  *04620000
046300*      MAXIMUM TABLE ENTRIES = 9999                              *04630099
046400*================================================================*04640000
046500 01  PT-BEST-CASE-TABLE.                                          04650000
046600***  05  PT-BEST-CASE OCCURS 5000 TIMES                           04660099
046610     05  PT-BEST-CASE OCCURS 9999 TIMES                           04661099
046700                              INDEXED BY PT-BEST-IDX.             04670000
046800         10  PT-BEST-CRTN-COMB        PIC  9(04).                 04680000
046900         10  PT-BEST-RATIO-MULT       PIC  9(04).                 04690000
047000         10  PT-BEST-CRTN-CNT         PIC  9(04).                 04700000
047100         10  PT-BEST-OTPK-QTY         PIC  9(04).                 04710000
047200         10  PT-BEST-DRVR-LNE-OTPK    PIC  9(04).                 04720000
047300         10  PT-BEST-EXTEND-UNTS      PIC  9(08).                 04730000
047400                                                                  04740000
047500                                                                  04750000
047600*================================================================*04760000
047700* RC-PACK SLIP TABLE                                             *04770000
047800*================================================================*04780000
047900     EXEC SQL                                                     04790000
048000          INCLUDE TPKSLIP                                         04800000
048100     END-EXEC.                                                    04810000
048200                                                                  04820000
048300*================================================================*04830000
048400* SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT UNIT ASSOCIATION TABLE *04840000
048500*================================================================*04850000
048600     EXEC SQL                                                     04860000
048700          INCLUDE TINPKSU                                         04870000
048800     END-EXEC.                                                    04880000
048900                                                                  04890000
049000*================================================================*04900000
049100* SU-SHIPMENT UNIT/UPC ASSOCIATION TABLE                         *04910000
049200*================================================================*04920000
049300     EXEC SQL                                                     04930000
049400          INCLUDE TSHUUPC                                         04940000
049500     END-EXEC.                                                    04950000
049600                                                                  04960000
049700*================================================================*04970000
049800* RC-RECEIPT DISTRIBUTION TABLE                                  *04980000
049900*================================================================*04990000
050000     EXEC SQL                                                     05000000
050100          INCLUDE TRECDIS                                         05010000
050200     END-EXEC.                                                    05020000
050300                                                                  05030000
050400*================================================================*05040000
050500* RC-RECEIPT ITEM TABLE                                          *05050000
050600*================================================================*05060000
050700     EXEC SQL                                                     05070000
050800          INCLUDE TRECITM                                         05080000
050900     END-EXEC.                                                    05090000
051000                                                                  05100000
051100*================================================================*05110000
051200* PO-PURCHASE ITEM TABLE                                         *05120000
051300*================================================================*05130000
051400     EXEC SQL                                                     05140000
051500          INCLUDE TPURITM                                         05150000
051600     END-EXEC.                                                    05160000
051700                                                                  05170000
051800*================================================================*05180000
051900* CR-STORE TABLE   (XLT_LOC)                                     *05190000
052000*================================================================*05200000
052100     EXEC SQL                                                     05210000
052200          INCLUDE XLT00010                                        05220000
052300     END-EXEC.                                                    05230000
052400                                                                  05240000
052500*================================================================*05250000
052600* RC-COMPANY CONTROL TABLE                                       *05260000
052700*================================================================*05270000
052800     EXEC SQL                                                     05280000
052900          INCLUDE TCOCNTL                                         05290000
053000     END-EXEC.                                                    05300000
053100                                                                  05310000
053200*================================================================*05320000
053300* SU-VIRTUAL LABEL DATA                                          *05330000
053400*================================================================*05340000
053500     EXEC SQL                                                     05350000
053600          INCLUDE TLBVRDA                                         05360000
053700     END-EXEC.                                                    05370000
053800                                                                  05380000
053900*================================================================*05390000
054000* PC-PACK-TO-LIGHT MODULE                                        *05400000
054100*================================================================*05410000
054200     EXEC SQL                                                     05420000
054300          INCLUDE TP2LMOD                                         05430000
054400     END-EXEC.                                                    05440000
054500                                                                  05450000
054600*================================================================*05460000
054700* PO-PURCHASE TABLE                                              *05470000
054800*================================================================*05480000
054900     EXEC SQL                                                     05490000
055000          INCLUDE TPURCHS                                         05500000
055100     END-EXEC.                                                    05510000
055200                                                                  05520000
055300*================================================================*05530000
055400* PO-SEASONAL SET                                                *05540000
055500*================================================================*05550000
055600     EXEC SQL                                                     05560000
055700          INCLUDE TSEASET                                         05570000
055800     END-EXEC.                                                    05580000
055900                                                                  05590000
056700*================================================================*05670000
056800* DC-DISTRIBUTION TRANSACTION DETAIL                             *05680000
056900*================================================================*05690000
057000     EXEC SQL                                                     05700000
057100          INCLUDE TDISTDT                                         05710000
057200     END-EXEC.                                                    05720000
057300                                                                  05730000
057400*================================================================*05740000
057500* DC-DISTRIBUTION TRANSACTION HEADER                             *05750000
057600*================================================================*05760000
057700     EXEC SQL                                                     05770000
057800          INCLUDE TDISTHD                                         05780000
057900     END-EXEC.                                                    05790000
058000                                                                  05800000
058100*================================================================*05810000
058200* SU-ASN RECEIVER PACKSLIPS                                      *05820000
058300*================================================================*05830000
058400     EXEC SQL                                                     05840000
058500          INCLUDE TSHPSUM                                         05850000
058600     END-EXEC.                                                    05860000
058700                                                                  05870000
058800*================================================================*05880000
058900* DC DOOR TABLE                                                  *05890000
059000*================================================================*05900000
059100     EXEC SQL                                                     05910000
059200          INCLUDE TCNDCDR                                         05920000
059300     END-EXEC.                                                    05930000
059400                                                                  05940000
059500*================================================================*05950000
059600* DC DOOR TO STORE TABLE                                         *05960000
059700*================================================================*05970000
059800     EXEC SQL                                                     05980000
059900          INCLUDE TCNDRST                                         05990000
060000     END-EXEC.                                                    06000000
060100                                                                  06010000
060110*================================================================*06011029
060120* DCLGEN FOR EAS MDSE TAG LOOKUP  (SFT_EAS_TG_MDSE)              *06012029
060130*================================================================*06013029
060140     EXEC SQL                                                     06014029
060150          INCLUDE SFT00000                                        06015029
060160     END-EXEC.                                                    06016029
060170                                                                  06017029
060171*CLP 06/22/2015 START                                             06017199
060180*================================================================*06018056
060190* BRAND DESCRIPTION (XLT_BRND)                                    06019088
060200*================================================================*06020056
060201     EXEC SQL                                                     06020156
060202          INCLUDE XLT00043                                        06020288
060203     END-EXEC.                                                    06020356
060204                                                                  06020456
060212*================================================================*06021256
060213* SKU TABLE (XLT_SKU)                                             06021388
060214*================================================================*06021456
060215     EXEC SQL                                                     06021556
060216          INCLUDE XLT00003                                        06021688
060217     END-EXEC.                                                    06021756
060218                                                                  06021856
060219*================================================================*06021999
060220* VENDOR STYLE TABLE (XLT_VND_STYL)                               06022088
060221*================================================================*06022188
060222     EXEC SQL                                                     06022288
060223          INCLUDE XLT00004                                        06022388
060224     END-EXEC.                                                    06022488
060225                                                                  06022588
060226*CLP 06/22/2015 END                                               06022688
060227*================================================================*06022779
060228* PARM TABLE                                                      06022879
060229*================================================================*06022979
060230     EXEC SQL                                                     06023079
060231          INCLUDE TKRPRPM                                         06023179
060232     END-EXEC.                                                    06023279
060233                                                                  06023379
060240*================================================================*06024038
060300* OUTER-PACK CURSOR                                              *06030000
060400*================================================================*06040000
060500                                                                  06050000
060600     EXEC SQL                                                     06060000
060700     DECLARE UCC128-CSR CURSOR FOR                                06070000
060800         SELECT C.SHIPT_UNT_ID                                    06080000
060900               ,C.TRN_LNE_NBR                                     06090000
061000               ,SUM(C.SHPD_QTY)                                   06100000
061100           FROM TPKSLIP A                                         06110000
061200               ,TINPKSU B                                         06120000
061300               ,TSHUUPC C                                         06130000
061400          WHERE A.PO_NBR                 = :DK-PO-NBR             06140000
061500            AND A.REC_SEQ_NBR            = :DK-RCVR-SEQ-NBR       06150000
061600            AND A.VER_STAT_CDE           = 'A'                    06160000
061700            AND A.PKSL_STAT_CDE          = 'AC'                   06170000
061800            AND B.PO_NBR                 = A.PO_NBR               06180000
061900            AND B.SEQ_NBR                = A.SEQ_NBR              06190000
062000            AND C.SHIPT_UNT_ID           = B.SHIPT_UNT_ID         06200000
062100            AND C.TRN_NBR                = B.PO_NBR               06210000
062200            AND C.TRN_LNE_NBR            = :DK-ORD-LNE-NBR        06220000
062300          GROUP BY                                                06230000
062400                C.SHIPT_UNT_ID                                    06240000
062500               ,C.TRN_LNE_NBR                                     06250000
062600          ORDER BY 3                                              06260000
062700     END-EXEC.                                                    06270000
062800                                                                  06280000
062900*================================================================*06290000
063000* STORE EXPECTED CURSOR                                          *06300000
063100*================================================================*06310000
063200     EXEC SQL                                                     06320000
063300     DECLARE EXPECT-CSR CURSOR FOR                                06330000
063400         SELECT                                                   06340000
063500           CASE                                                   06350000
063600                WHEN B.LOC_TYP_CDE = 'DC' THEN 'A'                06360000
063700                WHEN B.LOC_TYP_CDE = 'RV' THEN 'B'                06370000
063800                WHEN B.LOC_TYP_CDE = 'CS' THEN 'C'                06380000
063900                WHEN B.LOC_TYP_CDE = 'DS'                         06390000
064000                     AND B.E_BUS_IND     = 'Y'                    06400000
064100                                        THEN 'D'                  06410000
064200                WHEN B.LOC_TYP_CDE = 'DS'                         06420000
064300                     AND B.E_BUS_IND     = 'N'                    06430000
064400                                        THEN 'E'                  06440000
064500                ELSE 'Z'                                          06450000
064600            END                                                   06460000
064700               ,B.LOC_TYP_CDE                                     06470000
064800               ,B.E_BUS_IND                                       06480000
064900               ,A.STR_NBR                                         06490000
065000               ,A.EXPTED_ITM_QTY                                  06500000
065100               ,B.OPN_DTE                                         06510001
065200           FROM TRECDIS A                                         06520001
065300               ,XLT_LOC B                                         06530001
065400          WHERE A.ORD_NBR                = :DK-PO-NBR             06540001
065500            AND A.REC_SEQ_NBR            = :DK-RCVR-SEQ-NBR       06550001
065600            AND A.ORD_LNE_NBR            = :DK-ORD-LNE-NBR        06560001
065700            AND A.STR_NBR                = B.LOC_NBR              06570001
065800          ORDER BY 1,4                                            06580001
065900     END-EXEC.                                                    06590001
066000                                                                  06600001
066100                                                                  06610001
066200*================================================================*06620001
066300* EXPECTED CURSOR IN DOOR SEQ ORDER                        *      06630001
066400*================================================================*06640001
066500     EXEC SQL                                                     06650001
066600     DECLARE DOOR-SEQ-CSR CURSOR FOR                              06660001
066700        SELECT                                                    06670001
066720                LOC_TYPE                                          06672077
066730              , LOC_TYP_CDE                                       06673077
066740              , E_BUS_IND                                         06674077
066750              , STR_NBR                                           06675077
066760              , EXPTED_ITM_QTY                                    06676077
066770              , MIN(LBL_SEQ)  AS LBL_SEQ                          06677077
066780              , OPN_DTE                                           06678077
066790          FROM                                                    06679077
066791          (SELECT DISTINCT                                        06679177
066792             CASE                                                 06679277
066793                  WHEN M.LOC_TYP_CDE = 'DC' THEN 'A'              06679377
066794                  WHEN M.LOC_TYP_CDE = 'RV' THEN 'B'              06679477
066795                  WHEN M.LOC_TYP_CDE = 'CS' THEN 'C'              06679577
066796                  WHEN M.LOC_TYP_CDE = 'DS'                       06679677
066797                       AND M.E_BUS_IND  = 'Y'                     06679777
066798                                            THEN 'D'              06679877
066799                  WHEN M.LOC_TYP_CDE = 'DS'                       06679977
066800                       AND M.E_BUS_IND  = 'N'                     06680077
066810                                            THEN 'E'              06681077
066820                  ELSE 'Z'                                        06682077
066830              END     AS LOC_TYPE                                 06683077
066840                                                                  06684077
066850                 ,M.LOC_TYP_CDE                                   06685077
066860                 ,M.E_BUS_IND                                     06686077
066870                 ,M.STR_NBR                                       06687077
066880                 ,M.EXPTED_ITM_QTY  AS EXPTED_ITM_QTY             06688077
066890                                                                  06689077
066891           , CASE                                                 06689177
066892                  WHEN N.DOOR_LBL_SEQ_NBR = 0     THEN 9998       06689277
066893                  WHEN N.DOOR_LBL_SEQ_NBR IS NULL THEN 9999       06689377
066894                  WHEN N.END_TMST <  '9999-09-09-09.09.09.999999' 06689477
066895                                                  THEN  9999      06689577
066896                  ELSE N.DOOR_LBL_SEQ_NBR                         06689677
066897             END AS LBL_SEQ                                       06689777
066898                                                                  06689877
066899                 ,M.OPN_DTE         AS OPN_DTE                    06689977
066900         FROM                                                     06690077
066910             ((SELECT DISTINCT                                    06691077
066920                      B.LOC_TYP_CDE                               06692077
066930                     ,B.E_BUS_IND                                 06693077
066940                     ,A.STR_NBR                                   06694077
066950                     ,A.EXPTED_ITM_QTY                            06695077
066970                     ,B.OPN_DTE                                   06697077
066980                 FROM TRECDIS A                                   06698077
066990                     ,XLT_LOC B                                   06699077
066991                WHERE A.ORD_NBR         = :DK-PO-NBR              06699177
066992                  AND A.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR        06699277
066993                  AND A.ORD_LNE_NBR     = :DK-ORD-LNE-NBR         06699377
066994                  AND A.EXPTED_ITM_QTY  > +0                      06699477
066995                  AND A.STR_NBR         = B.LOC_NBR               06699577
066996              )  M                                                06699677
066997          LEFT OUTER JOIN                                         06699777
066998              (SELECT  DISTINCT                                   06699877
066999                       B.LOC_TYP_CDE                              06699977
067000                      ,B.E_BUS_IND                                06700077
067010                      ,A.STR_NBR                                  06701077
067020                      ,A.EXPTED_ITM_QTY                           06702077
067030                      ,E.END_TMST                                 06703077
067040                      ,F.DOOR_LBL_SEQ_NBR                         06704077
067050                      ,B.OPN_DTE                                  06705077
067060                 FROM                                             06706077
067070                       TRECDIS A                                  06707077
067080                     , XLT_LOC B                                  06708077
067090                     , TCNDRST E                                  06709077
067091                     , TCNDCDR F                                  06709177
067092                WHERE  A.ORD_NBR         = :DK-PO-NBR             06709277
067093                  AND  A.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR       06709377
067094                  AND  A.ORD_LNE_NBR     = :DK-ORD-LNE-NBR        06709477
067095                  AND  A.EXPTED_ITM_QTY  > +0                     06709577
067096                  AND  A.STR_NBR         = B.LOC_NBR              06709677
067097                  AND  E.DOOR_ID         = F.DOOR_ID              06709777
067098                  AND  E.OPER_UNT_ID     = F.OPER_UNT_ID          06709877
067099                  AND  E.END_TMST  = '9999-09-09-09.09.09.999999' 06709987
067100                  AND  B.LOC_NBR         = E.STR_NBR              06710077
067101                  AND  A.OPER_UNT_ID     = F.OPER_UNT_ID          06710177
067102                  AND  F.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%'       06710278
067103                  AND  F.DOOR_LOC_DESC NOT LIKE '%UPS%'           06710378
067104                  AND  F.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%'       06710478
067110              )  N                                                06711077
067120                                                                  06712077
067130          ON           M.LOC_TYP_CDE     =  N.LOC_TYP_CDE         06713077
067140                  AND  M.E_BUS_IND       =  N.E_BUS_IND           06714077
067150                  AND  M.STR_NBR         =  N.STR_NBR             06715077
067160                  AND  M.EXPTED_ITM_QTY  =  N.EXPTED_ITM_QTY      06716077
067170                  AND  M.OPN_DTE         =  N.OPN_DTE             06717077
067180             ))  Y                                                06718077
067190                                                                  06719077
067191             GROUP BY                                             06719177
067192                     LOC_TYPE                                     06719277
067193                  ,  LOC_TYP_CDE                                  06719377
067194                  ,  E_BUS_IND                                    06719477
067195                  ,  STR_NBR                                      06719577
067196                  ,  EXPTED_ITM_QTY                               06719677
067197                  ,  OPN_DTE                                      06719777
067198             ORDER BY                                             06719877
067199                  6,4                                             06719977
074000     END-EXEC.                                                    07400002
074100                                                                  07410002
074200                                                                  07420002
074300*================================================================*07430002
074400* PREPACK LINE CURSOR                                            *07440002
074500*================================================================*07450002
074600     EXEC SQL                                                     07460002
074700          DECLARE PRE_PACK_CSR CURSOR FOR                         07470002
074800              SELECT DISTINCT                                     07480002
074900                     A.ORD_LNE_NBR                                07490000
075000                    ,A.PREPK_RATO_QTY                             07500000
075100                FROM TRECITM A                                    07510000
075200                    ,TPURITM B                                    07520000
075300               WHERE A.ORD_NBR           = :DK-PO-NBR             07530000
075400                 AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR       07540000
075500                 AND A.PREPK_ID          = :DK-PREPK-ID           07550000
075600                 AND A.ORD_NBR           = B.PO_NBR               07560000
075700                 AND A.VER_STATUS_CDE    = 'A'                    07570000
075800                 AND A.PO_VER_NBR        = B.VER_NBR              07580000
075900                 AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR       07590000
076000          ORDER BY                                                07600000
076100                A.ORD_LNE_NBR                                     07610000
076200     END-EXEC.                                                    07620000
076300                                                                  07630000
076400                                                                  07640000
076500*================================================================*07650000
076600* SHIPMENT CARTON SUMMARY CURSOR                                 *07660000
076700*================================================================*07670000
076800     EXEC SQL                                                     07680000
076900          DECLARE SHIP_SUM_CSR CURSOR FOR                         07690000
077000              SELECT A.PO_NBR                                     07700000
077100                    ,A.PKSL_SEQ_NBR                               07710000
077200                    ,A.CART_COMB_NBR                              07720000
077300                    ,A.PO_LNE_NBR                                 07730000
077400                    ,A.TOT_CART_CNT                               07740000
077500                    ,A.OTPK_UNT_QTY                               07750000
077600                FROM TSHPSUM A                                    07760000
077700                    ,TPKSLIP B                                    07770000
077800               WHERE A.PO_NBR            = :DK-PO-NBR             07780000
077900                 AND A.PO_NBR            =  B.PO_NBR              07790000
078000                 AND A.PKSL_SEQ_NBR      =  B.SEQ_NBR             07800000
078100                 AND B.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR       07810000
078200                 AND B.VER_STAT_CDE      = 'A'                    07820000
078300                 AND B.PKSL_STAT_CDE     = 'AC'                   07830000
078400          ORDER BY                                                07840000
078500                A.PKSL_SEQ_NBR                                    07850000
078600               ,A.CART_COMB_NBR                                   07860000
078700               ,A.PO_LNE_NBR                                      07870000
078800     END-EXEC.                                                    07880000
078900                                                                  07890000
079000                                                                  07900000
079100*================================================================*07910000
079200* PREPACK DELETE CURSOR                                          *07920000
079300*================================================================*07930000
079400     EXEC SQL                                                     07940000
079500          DECLARE PRE_PACK_DEL_CSR CURSOR FOR                     07950000
079600              SELECT DISTINCT                                     07960000
079700                     A.ORD_LNE_NBR                                07970000
079800                    ,A.PREPK_RATO_QTY                             07980000
079900                FROM TRECITM A                                    07990000
080000               WHERE A.ORD_NBR           = :DK-PO-NBR             08000000
080100                 AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR       08010000
080200                 AND A.PREPK_ID          = :DK-PREPK-ID           08020000
080300                 AND A.ORD_LNE_NBR      <> :DK-ORD-LNE-NBR        08030000
080400                 AND A.VER_STATUS_CDE    = 'A'                    08040000
080500          ORDER BY                                                08050000
080600                A.ORD_LNE_NBR                                     08060000
080700     END-EXEC.                                                    08070000
080800                                                                  08080000
080900                                                                  08090000
081000*================================================================*08100000
081100*                                                                *08110000
081200*================================================================*08120000
081300     EXEC SQL                                                     08130000
081400          INCLUDE SQLCA                                           08140000
081500     END-EXEC.                                                    08150000
081600                                                                  08160000
081700 LINKAGE SECTION.                                                 08170000
081800                                                                  08180000
081900 01  DFHCOMMAREA.                                                 08190000
082000     05  FILLER                         OCCURS  1 TO 4072 TIMES   08200000
082100                                        DEPENDING ON EIBCALEN.    08210000
082200         10  FILLER                   PIC X.                      08220000
082300                                                                  08230000
082400                                                                  08240000
082500*================================================================*08250000
082600*                                                                *08260000
082700*================================================================*08270000
082800 PROCEDURE DIVISION.                                              08280000
082900                                                                  08290000
083000 0000-PROGRAM-MAINLINE.                                           08300000
083100                                                                  08310000
083200     PERFORM 1000-INITIAL-PROCESS.                                08320000
083300                                                                  08330000
083400     IF  PS-ERROR                                                 08340000
083500         CONTINUE                                                 08350000
083600     ELSE                                                         08360000
083700     IF  PC166-CREATE-BOTH                                        08370000
083800         PERFORM 2000-CREATE-SML-P2L                              08380000
083900     ELSE                                                         08390000
084000     IF  PC166-CREATE-SML                                         08400000
084100         PERFORM 2200-CREATE-SML-ONLY                             08410000
084200     ELSE                                                         08420000
084300     IF  PC166-CREATE-P2L                                         08430000
084400         PERFORM 2400-CREATE-P2L-ONLY                             08440000
084500     END-IF                                                       08450000
084600     END-IF                                                       08460000
084700     END-IF                                                       08470000
084800     END-IF.                                                      08480000
084900                                                                  08490000
085000     IF  PS-ERROR                                                 08500000
085100         CONTINUE                                                 08510000
085200     ELSE                                                         08520000
085300         PERFORM 2600-SUM-LBL-QTYS                                08530000
085400     END-IF.                                                      08540000
085500                                                                  08550000
085600     MOVE  PV-FCSE-CRTN-CNT      TO  PC166-FCSE-LBL-CNT.          08560000
085700     MOVE  PV-INPK-CRTN-CNT      TO  PC166-INPK-LBL-CNT.          08570000
085800     MOVE  PV-P2L-CRTN-CNT       TO  PC166-P2L-LBL-CNT.           08580000
085900     MOVE  PV-DC-BOUND-UNTS      TO  PC166-DC-BOUND-UNTS.         08590000
086000     MOVE  PV-DC-BOUND-CTNS      TO  PC166-DC-BOUND-CTNS.         08600000
086100     MOVE  PV-RTV-BOUND-UNTS     TO  PC166-RTV-BOUND-UNTS.        08610000
086200     MOVE  PV-RTV-BOUND-CTNS     TO  PC166-RTV-BOUND-CTNS.        08620000
086300     MOVE  PV-CS-BOUND-UNTS      TO  PC166-CS-BOUND-UNTS.         08630000
086400     MOVE  PV-CS-BOUND-CTNS      TO  PC166-CS-BOUND-CTNS.         08640000
086500     IF  PV-UCC128-TABLE-ENTRIES  >  1                            08650000
086600         SET  PC166-MULT-OTPK    TO  TRUE                         08660000
086700         MOVE ZEROES             TO  PC166-OTPK-UNT-QTY           08670000
086800     ELSE                                                         08680000
086900         SET  PC166-SINGLE-OTPK  TO  TRUE                         08690000
087000         MOVE PT-UCC128-OTPK(+1) TO  PC166-OTPK-UNT-QTY           08700000
087100     END-IF.                                                      08710000
087200     MOVE PV-TOTAL-CARTON-COUNT  TO PC166-TOTAL-CARTONS.          08720000
087300                                                                  08730000
087400     SET  PC166-CRA-SUCCESSFUL  TO  TRUE.                         08740000
087500                                                                  08750000
087600     IF  PS-ERROR                                                 08760000
087700         CONTINUE                                                 08770000
087800     ELSE                                                         08780000
087900     IF  PC166-FUNC-CRE-VRTL-LBL                                  08790000
088000         PERFORM  5400-GET-LBL-DATA                               08800000
088100         IF  PS-NO-ERROR                                          08810000
088200             PERFORM  5050-GET-MANIFEST-NBRS                      08820000
088300         END-IF                                                   08830000
088400         IF  PS-NO-ERROR                                          08840000
088500             PERFORM  5100-CREATE-VRTL-LABEL                      08850000
088600         END-IF                                                   08860000
088700         IF  PS-NO-ERROR                                          08870000
088800             PERFORM  5500-CREATE-HDR-DTL-TBL                     08880000
088900         END-IF                                                   08890000
089000     END-IF                                                       08900000
089100     END-IF.                                                      08910000
089200                                                                  08920000
089300     IF  PS-NO-ERROR  OR                                          08930000
089400         PC166-FUNC-LBL-CALC                                      08940000
089500         CONTINUE                                                 08950000
089600     ELSE                                                         08960000
089700     IF  PS-ERROR  AND                                            08970000
089800         PC166-CRA-SUCCESSFUL                                     08980000
089900         CONTINUE                                                 08990000
090000     ELSE                                                         09000000
090100         EXEC CICS SYNCPOINT                                      09010000
090200              ROLLBACK                                            09020000
090300         END-EXEC                                                 09030000
090400     END-IF                                                       09040000
090500     END-IF.                                                      09050000
090600                                                                  09060000
090700     PERFORM 9000-RETURN-CALL.                                    09070000
090800                                                                  09080000
090900                                                                  09090000
091000*================================================================*09100000
091100*                                                                *09110000
091200*================================================================*09120000
091300 1000-INITIAL-PROCESS.                                            09130000
091400                                                                  09140000
091500     MOVE DFHCOMMAREA                 TO PC166-COMMAREA-REC       09150000
091600     MOVE SPACES                      TO PC166-CRA-RET-MSG        09160000
091700     SET  PC166-CRA-SUCCESSFUL                                    09170000
091800          PS-SEASET-DATA-FOUND                                    09180000
091900          PS-POG-DATA-FOUND           TO TRUE                     09190000
092000                                                                  09200000
092100     EXEC CICS ASSIGN                                             09210000
092200               APPLID(PV-SYSTEM-ID)                               09220000
092300               USERID(PV-USER-ID)                                 09230000
092400     END-EXEC.                                                    09240000
092500                                                                  09250000
092600* TRY USING A COBOL FUNCTION FOR DATE/TIME                        09260000
092700     EXEC CICS                                                    09270000
092800               ASKTIME                                            09280000
092900               ABSTIME(PV-ABS-TIME)                               09290000
093000     END-EXEC.                                                    09300000
093100                                                                  09310000
093200     EXEC CICS FORMATTIME                                         09320000
093300                 ABSTIME(PV-ABS-TIME)                             09330000
093400                 YYMMDD(PV-DATE)                                  09340000
093500                 DATESEP                                          09350000
093600                 TIME(PV-TIME)                                    09360000
093700                 TIMESEP                                          09370000
093800     END-EXEC.                                                    09380000
093900                                                                  09390000
094000     PERFORM 1010-GET-CURRENT-DATE.                               09400000
094100                                                                  09410000
094200     MOVE PC166-OPER-UNT-ID           TO DK-OPER-UNT-ID.          09420000
094300     MOVE PC166-PO-NBR                TO DK-PO-NBR.               09430000
094400     MOVE PC166-RCVR-SEQ-NBR          TO DK-RCVR-SEQ-NBR.         09440000
094500     MOVE PC166-PO-LNE-NBR            TO DK-ORD-LNE-NBR.          09450000
094600     MOVE PC166-MOD-NBR               TO DK-MOD-NBR.              09460000
094700     MOVE PC166-PREPK-ID              TO DK-PREPK-ID.             09470000
094800                                                                  09480000
094900     IF  PC166-PRE-PACK-ORDER                                     09490000
094910         PERFORM 1275-CHECK-TSHPSUM-ZERO                          09491018
094920         IF  PS-NO-ERROR                                          09492018
095000             PERFORM 1300-PREPACK-ROUTINE                         09500018
095010         END-IF                                                   09501018
095100     ELSE                                                         09510000
095200         PERFORM 1100-BUILD-UCC128-DATA-TABLE                     09520000
095300     END-IF.                                                      09530000
095400                                                                  09540000
095500     IF  PS-ERROR                                                 09550000
095600         CONTINUE                                                 09560000
095700     ELSE                                                         09570000
095800         IF PC166-PRT-DOOR-SEQ                                    09580000
095900            PERFORM 1250-BUILD-DOOR-SEQ-TABLE                     09590000
096000         ELSE                                                     09600000
096100            PERFORM 1200-BUILD-STORE-EXPECT-TABLE                 09610000
096200         END-IF                                                   09620000
096300     END-IF.                                                      09630000
096400                                                                  09640000
096410*                                                                 09641079
096411*** DMH - 10-5-10 - BEGIN                                         09641179
096412*                                                                 09641279
096413     PERFORM 1015-CHECK-TRIP-ON-P2L-LABEL.                        09641380
096414*                                                                 09641479
096415*** DMH - 10-5-10 - END                                           09641579
096416*                                                                 09641679
096420                                                                  09642079
096500*    IF  PV-EXPECT-TABLE-ENTRIES  >  0                            09650036
096600*        PERFORM 7200-GET-AD-DATE                                 09660036
096700*    END-IF.                                                      09670036
096800                                                                  09680000
096900                                                                  09690000
097000*-----------------------------------------------------------------09700000
097100*  GET CURRENT DATE TO PRINT ON LABEL                             09710000
097200*-----------------------------------------------------------------09720000
097300 1010-GET-CURRENT-DATE.                                           09730000
097400                                                                  09740000
097500     EXEC SQL                                                     09750000
097600         SELECT  CURRENT DATE                                     09760000
097700                ,CURRENT TIME                                     09770000
097800           INTO  :PV-CURRENT-DATE                                 09780000
097900                ,:PV-CURRENT-TIME                                 09790000
098000           FROM  TCOCNTL                                          09800000
098100          WHERE  OPER_UNT_ID = 90                                 09810000
098200     END-EXEC.                                                    09820000
098300                                                                  09830000
098400     EVALUATE TRUE                                                09840000
098500         WHEN SQLCODE = ZERO                                      09850000
098600              MOVE  PV-CURRENT-MM  TO  PV-LBL-PRT-MM              09860000
098700              MOVE  PV-CURRENT-DD  TO  PV-LBL-PRT-DD              09870000
098800              MOVE  PV-CURRENT-YY  TO  PV-LBL-PRT-YY              09880000
098900              MOVE  PV-CURRENT-HR  TO  PV-LBL-PRT-HR              09890000
099000              MOVE  PV-CURRENT-MN  TO  PV-LBL-PRT-MN              09900000
099100                                                                  09910000
099200         WHEN OTHER                                               09920000
099300              CONTINUE                                            09930000
099400      END-EVALUATE.                                               09940000
099500                                                                  09950000
099600                                                                  09960000
099601*================================================================*09960179
099602* DETERMINE IF THE TRIP ARRIVE DATE IS TO APPEAR ON THE P2L      *09960279
099603* LABEL                                                          *09960379
099604*================================================================*09960479
099610 1015-CHECK-TRIP-ON-P2L-LABEL.                                    09961080
099627                                                                  09962779
099628     SET PS-P2L-MOD-ON-LABEL TO TRUE                              09962879
099629                                                                  09962979
099630     EXEC SQL                                                     09963079
099631          SELECT FUNC_TXT                                         09963179
099632          INTO  :PS-P2L-LABEL-DISPLAY-SW                          09963279
099633          FROM   TKRPRPM                                          09963379
099634          WHERE  SYS_PRC_FUNC_CDE  = 'P2LARV'                     09963479
099637            AND  LOC_ID            = :DK-OPER-UNT-ID              09963779
099638            AND  INTFC_SYS_CDE     = 'KHL'                        09963879
099639            AND  FUNC_PRC_STAT_CDE = 'AC'                         09963979
099640     END-EXEC.                                                    09964079
099641                                                                  09964179
099642     EVALUATE TRUE                                                09964279
099643         WHEN SQLCODE = ZERO                                      09964379
099644             SET PS-TRIP-ARRIVE-DATE-ON-LABEL   TO  TRUE          09964479
099645         WHEN SQLCODE = +100                                      09964579
099646             SET PS-P2L-MOD-ON-LABEL   TO TRUE                    09964679
099647         WHEN OTHER                                               09964779
099648              SET PS-P2L-MOD-ON-LABEL TO TRUE                     09964879
099649              CONTINUE                                            09964979
099650      END-EVALUATE.                                               09965079
099651                                                                  09965179
099660                                                                  09966079
099700*================================================================*09970000
099800* BUILD INITIAL UCC128 DATA TABLE                                *09980000
099900*================================================================*09990000
100000 1100-BUILD-UCC128-DATA-TABLE.                                    10000000
100100                                                                  10010000
100200     INITIALIZE PT-UCC128-DATA-TABLE.                             10020000
100300                                                                  10030000
100400     SET PS-NOT-EOF-UCC128-CSR       TO TRUE.                     10040000
100500                                                                  10050000
100600     PERFORM 7000-OPEN-UCC128-CSR.                                10060000
100700     PERFORM 7010-FETCH-UCC128-CSR.                               10070000
100800                                                                  10080000
100900     IF  PS-EOF-UCC128-CSR                                        10090000
101000         CONTINUE                                                 10100000
101100     ELSE                                                         10110000
101200         MOVE  SHUUPC-SHPD-QTY  TO  PV-PREVIOUS-SHPD-QTY          10120000
101300                                    PV-UCC128-MAX-OTPK            10130000
101400                                    PV-UCC128-MIN-OTPK            10140000
101500     END-IF.                                                      10150000
101600                                                                  10160000
101700     SET   PT-U128-IDX      TO  +1.                               10170000
101800                                                                  10180000
101900     PERFORM                                                      10190000
102000       UNTIL PS-EOF-UCC128-CSR OR                                 10200000
102100             PT-U128-IDX > PC-MAX-UCC128-TBL-ENTRY                10210000
102200                                                                  10220000
102300             IF  SHUUPC-SHPD-QTY  =  PV-PREVIOUS-SHPD-QTY         10230000
102400                 ADD  1          TO  PV-OTPK-CARTON-COUNT         10240000
102500             ELSE                                                 10250000
102600                 MOVE  PV-PREVIOUS-SHPD-QTY TO  PT-UCC128-OTPK    10260000
102700                                                (PT-U128-IDX)     10270000
102800                 MOVE  PV-OTPK-CARTON-COUNT TO  PT-UCC128-CRTNS   10280000
102900                                                (PT-U128-IDX)     10290000
103000                 ADD   PV-OTPK-CARTON-COUNT                       10300000
103100                  TO   PV-TOTAL-CARTON-COUNT                      10310000
103200                 ADD   +1        TO PV-UCC128-TABLE-ENTRIES       10320000
103300                 IF  PC166-CREATE-P2L                             10330000
103400                     CONTINUE                                     10340000
103500                 ELSE                                             10350000
103600                                                                  10360000
103700                     IF  PC166-INPK-UNT-QTY  >  0                 10370000
103800                         DIVIDE SHUUPC-SHPD-QTY                   10380000
103900                             BY PC166-INPK-UNT-QTY                10390000
104000                         GIVING PV-INPK-OTPK-RESULT               10400000
104100                         REMAINDER PV-INPK-OTPK-REMAINDER         10410000
104200                     ELSE                                         10420000
104300                         MOVE ZEROES  TO  PV-INPK-OTPK-RESULT     10430000
104400                         MOVE SHUUPC-SHPD-QTY                     10440000
104500                                      TO  PV-INPK-OTPK-REMAINDER  10450000
104600                     END-IF                                       10460000
104700                                                                  10470000
104800                     IF PV-INPK-OTPK-REMAINDER > 0                10480000
104900                         SET PC166-ERR-OTPK-BY-INPK               10490000
105000                              PS-ERROR           TO  TRUE         10500000
105100                     END-IF                                       10510000
105200                 END-IF                                           10520000
105300                                                                  10530000
105400                 IF PV-UCC128-MAX-OTPK = ZEROES                   10540000
105500                     MOVE SHUUPC-SHPD-QTY                         10550000
105600                       TO PV-UCC128-MAX-OTPK                      10560000
105700                           PV-UCC128-MIN-OTPK                     10570000
105800                 ELSE                                             10580000
105900                 IF SHUUPC-SHPD-QTY >  PV-UCC128-MAX-OTPK         10590000
106000                     MOVE SHUUPC-SHPD-QTY                         10600000
106100                       TO PV-UCC128-MAX-OTPK                      10610000
106200                 ELSE                                             10620000
106300                 IF SHUUPC-SHPD-QTY <  PV-UCC128-MIN-OTPK         10630000
106400                     MOVE SHUUPC-SHPD-QTY                         10640000
106500                       TO PV-UCC128-MIN-OTPK                      10650000
106600                 END-IF                                           10660000
106700                 END-IF                                           10670000
106800                 END-IF                                           10680000
106900                                                                  10690000
107000                 MOVE  ZEROES           TO  PV-OTPK-CARTON-COUNT  10700000
107100                 MOVE  SHUUPC-SHPD-QTY  TO  PV-PREVIOUS-SHPD-QTY  10710000
107200                 ADD   1                TO  PV-OTPK-CARTON-COUNT  10720000
107300                 SET   PT-U128-IDX          UP BY +1              10730000
107400             END-IF                                               10740000
107500                                                                  10750000
107600                                                                  10760000
107700         PERFORM 7010-FETCH-UCC128-CSR                            10770000
107800                                                                  10780000
107900     END-PERFORM.                                                 10790000
108000     IF  PV-OTPK-CARTON-COUNT  >  0                               10800000
108100         MOVE  PV-PREVIOUS-SHPD-QTY TO  PT-UCC128-OTPK            10810000
108200                                        (PT-U128-IDX)             10820000
108300         MOVE  PV-OTPK-CARTON-COUNT TO  PT-UCC128-CRTNS           10830000
108400                                        (PT-U128-IDX)             10840000
108500         ADD   PV-OTPK-CARTON-COUNT                               10850000
108600          TO   PV-TOTAL-CARTON-COUNT                              10860000
108700         ADD   +1                   TO PV-UCC128-TABLE-ENTRIES    10870000
108800         IF  PC166-CREATE-P2L                                     10880000
108900             CONTINUE                                             10890000
109000         ELSE                                                     10900000
109100             IF  PC166-INPK-UNT-QTY  >  0                         10910000
109200                 DIVIDE SHUUPC-SHPD-QTY                           10920000
109300                     BY PC166-INPK-UNT-QTY                        10930000
109400                 GIVING PV-INPK-OTPK-RESULT                       10940000
109500                 REMAINDER PV-INPK-OTPK-REMAINDER                 10950000
109600             ELSE                                                 10960000
109700                 MOVE  ZEROES  TO  PV-INPK-OTPK-RESULT            10970000
109800                 MOVE  SHUUPC-SHPD-QTY                            10980000
109900                               TO  PV-INPK-OTPK-REMAINDER         10990000
110000             END-IF                                               11000000
110100                                                                  11010000
110200             IF PV-INPK-OTPK-REMAINDER > 0                        11020000
110300                 SET PC166-ERR-OTPK-BY-INPK                       11030000
110400                      PS-ERROR                   TO  TRUE         11040000
110500             END-IF                                               11050000
110600         END-IF                                                   11060000
110700                                                                  11070000
110800         IF PV-UCC128-MAX-OTPK = ZEROES                           11080000
110900             MOVE SHUUPC-SHPD-QTY                                 11090000
111000               TO PV-UCC128-MAX-OTPK                              11100000
111100                   PV-UCC128-MIN-OTPK                             11110000
111200         ELSE                                                     11120000
111300         IF SHUUPC-SHPD-QTY >          PV-UCC128-MAX-OTPK         11130000
111400             MOVE SHUUPC-SHPD-QTY                                 11140000
111500               TO PV-UCC128-MAX-OTPK                              11150000
111600         ELSE                                                     11160000
111700         IF SHUUPC-SHPD-QTY <          PV-UCC128-MIN-OTPK         11170000
111800             MOVE SHUUPC-SHPD-QTY                                 11180000
111900               TO PV-UCC128-MIN-OTPK                              11190000
112000         END-IF                                                   11200000
112100         END-IF                                                   11210000
112200         END-IF                                                   11220000
112300                                                                  11230000
112400         MOVE          ZEROES           TO  PV-OTPK-CARTON-COUNT  11240000
112500         MOVE          SHUUPC-SHPD-QTY  TO  PV-PREVIOUS-SHPD-QTY  11250000
112600         ADD           1                TO  PV-OTPK-CARTON-COUNT  11260000
112700     END-IF                                                       11270000
112800                                                                  11280000
112900                                                                  11290000
113000     PERFORM 7020-CLOSE-UCC128-CSR.                               11300000
113100                                                                  11310000
113200     MOVE  PV-TOTAL-CARTON-COUNT  TO  PC166-TOTAL-CARTONS.        11320000
113300                                                                  11330000
113400                                                                  11340000
113500                                                                  11350000
113600*================================================================*11360000
113700* BUILD INITIAL STORE EXPECTED TABLE                             *11370000
113800*================================================================*11380000
113900 1200-BUILD-STORE-EXPECT-TABLE.                                   11390000
114000                                                                  11400000
114100     INITIALIZE PT-STORE-EXPECT-TABLE.                            11410000
114200     SET PS-NOT-EOF-EXPECT-CSR        TO TRUE                     11420000
114210     IF PC166-FUNC-CRE-VRTL-LBL                                   11421075
114211        PERFORM 5432-CALL-ITEM-DOMAIN-MOD                         11421154
114212        PERFORM 7200-GET-AD-DATE                                  11421254
114213        PERFORM 5433-CHECK-EAS-TAG                                11421354
114214*CLP 06/22/2015 -START                                            11421488
114215        PERFORM 5436-GET-BUSINESS-DESC                            11421588
114216        PERFORM 5434-CHECK-BRAND                                  11421688
114217*CLP 06/22/2015 -END                                              11421788
114300     END-IF                                                       11430075
114310                                                                  11431054
114400     PERFORM 7030-OPEN-EXPECT-CSR.                                11440000
114500     PERFORM 7040-FETCH-EXPECT-CSR.                               11450000
114600     PERFORM                                                      11460000
114700         VARYING PT-EXPT-IDX                                      11470000
114800            FROM 1 BY 1                                           11480000
114900           UNTIL PS-EOF-EXPECT-CSR OR                             11490000
115000                 PT-EXPT-IDX > PC-MAX-EXPTED-TBL-ENTRY            11500000
115100                                                                  11510000
115200            MOVE PV-TYPE-CODE-SEQ       TO  PT-EXPT-STR-TYP-ORDER 11520000
115300                                            (PT-EXPT-IDX)         11530000
115400            MOVE RECDIS-STR-NBR         TO  PT-EXPT-STR-NBR       11540000
115500                                            (PT-EXPT-IDX)         11550000
115600            MOVE XLT00010-LOC-TYP-CDE   TO  PT-EXPT-STR-TYP       11560000
115700                                            (PT-EXPT-IDX)         11570000
115800            MOVE XLT00010-E-BUS-IND     TO  PT-EXPT-E-COMMERCE-IND11580000
115900                                            (PT-EXPT-IDX)         11590000
116000            MOVE RECDIS-EXPTED-ITM-QTY  TO  PT-EXPT-EXPTED-QTY    11600000
116100                                            (PT-EXPT-IDX)         11610000
116200                                            PT-EXPT-NEEDED-QTY    11620000
116300                                            (PT-EXPT-IDX)         11630000
116400            MOVE ZEROES                 TO  PT-EXPT-ALLOC-QTY     11640000
116500                                            (PT-EXPT-IDX)         11650000
116600                                            PT-EXPT-FCSE-CNT      11660000
116700                                            (PT-EXPT-IDX)         11670000
116800                                            PT-EXPT-INPK-CNT      11680000
116900                                            (PT-EXPT-IDX)         11690000
117000                                            PT-EXPT-P2L-UNTS      11700000
117100                                            (PT-EXPT-IDX)         11710000
117200                                            PT-EXPT-FCSE-UNTS     11720000
117300                                            (PT-EXPT-IDX)         11730000
117400                                            PT-EXPT-INPK-UNTS     11740000
117500                                            (PT-EXPT-IDX)         11750000
117600            IF  PV-UCC128-MAX-OTPK  =  ZEROES                     11760000
117700                MOVE  RECDIS-EXPTED-ITM-QTY                       11770000
117800                  TO  PV-NEEDED-MAX-OTPK                          11780000
117900                      PV-NEEDED-MIN-OTPK                          11790000
118000            ELSE                                                  11800000
118100            IF  RECDIS-EXPTED-ITM-QTY  >  PV-NEEDED-MAX-OTPK      11810000
118200                MOVE  RECDIS-EXPTED-ITM-QTY                       11820000
118300                  TO  PV-NEEDED-MAX-OTPK                          11830000
118400            ELSE                                                  11840000
118500            IF  RECDIS-EXPTED-ITM-QTY  <  PV-NEEDED-MIN-OTPK      11850000
118600                MOVE  RECDIS-EXPTED-ITM-QTY                       11860000
118700                  TO  PV-NEEDED-MIN-OTPK                          11870000
118800            END-IF                                                11880000
118900            END-IF                                                11890000
119000            END-IF                                                11900000
119100                                                                  11910000
119200            IF PC166-FUNC-CRE-VRTL-LBL                            11920000
119300               IF  PS-SEASET-DATA-FOUND OR                        11930002
119400                  (PV-CURRENT-DATE < XLT00010-OPN-DTE)            11940002
119500                   PERFORM 5430-CALL-SET-FIXT-ID-MOD              11950000
119600                   MOVE PC240-FIXT-ID    TO                       11960003
119700                                PT-EXPT-FIXT-ID (PT-EXPT-IDX)     11970000
119800                   MOVE PC240-SEASET-NM  TO                       11980003
119900                                PT-EXPT-SEASONAL-SET (PT-EXPT-IDX)11990000
120000               ELSE                                               12000000
120100                   MOVE SPACES           TO                       12010000
120200                        PT-EXPT-FIXT-ID (PT-EXPT-IDX)             12020000
120300                        PT-EXPT-SEASONAL-SET (PT-EXPT-IDX)        12030000
120400               END-IF                                             12040000
120401                                                                  12040138
120402               PERFORM 7300-GET-CURRENT-DOOR                      12040238
120403                                                                  12040338
120500            END-IF                                                12050000
120510            MOVE CNDCDR-DOOR-ID          TO                       12051040
120520                               PT-EXPT-DOOR-ID (PT-EXPT-IDX)      12052038
120600            MOVE PS-SET-EAS-TAG-SW       TO                       12060035
120610                           PT-EXPT-EAS-TAG-IND (PT-EXPT-IDX)      12061035
120620            MOVE PV-HNG-FOLD-SEQ-NBR     TO                       12062046
120630                           PT-EXPT-PRESENTATION-IND (PT-EXPT-IDX) 12063035
120700            MOVE PS-SEASET-DATA-FOUND-SW TO                       12070000
120800                                 PT-EXPT-SEASET-IND (PT-EXPT-IDX) 12080000
120810*CLP 06/22/2015 -START                                            12081090
120920            MOVE PV-BUS-AREA-BRAND TO                             12092090
120921                           PT-EXPT-MERCHANDISE-PGM (PT-EXPT-IDX)  12092190
120924*CLP 06/22/2015 -END                                              12092490
120930                                                                  12093055
121000            PERFORM 7040-FETCH-EXPECT-CSR                         12100000
121100                                                                  12110000
121200     END-PERFORM.                                                 12120000
121300                                                                  12130000
121400     PERFORM 7050-CLOSE-EXPECT-CSR.                               12140000
121500                                                                  12150000
121600                                                                  12160000
121610*CLP 06/22/2015 START                                             12161090
121620***************************************************************** 12162090
121630* ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     12163090
121640* AREA DESCRIPTION                                                12164090
121650***************************************************************** 12165090
121660 1210-INSPECT-BUS-AREA.                                           12166090
121670                                                                  12167090
121671     MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         12167197
121672                                                                  12167297
121673     MOVE +0                               TO PV-DESC-LEN.        12167397
121674     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        12167497
121675                                                                  12167597
121676     PERFORM                                                      12167697
121677       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        12167797
121678         PV-DESC-LEN = +0                                         12167897
121679       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    12167997
121680     END-PERFORM.                                                 12168097
121681                                                                  12168197
121696     MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          12169691
121697                                                                  12169791
121698     EVALUATE TRUE                                                12169897
121699        WHEN  PV-DESC-LEN   =  9                                  12169997
121700            STRING   PV-BUS-AREA-DESC-9(1:9)                      12170097
121701                                 '-'                              12170197
121702                     XLT00043-BRND-DESC DELIMITED BY SIZE         12170297
121703            INTO  PV-BUS-AREA-BRAND                               12170397
121704        WHEN  PV-DESC-LEN   =  8                                  12170497
121705            STRING   PV-BUS-AREA-DESC-9(1:8)                      12170597
121706                                 '-'                              12170697
121707                     XLT00043-BRND-DESC DELIMITED BY SIZE         12170797
121708            INTO  PV-BUS-AREA-BRAND                               12170897
121709        WHEN  PV-DESC-LEN   =  7                                  12170997
121710            STRING   PV-BUS-AREA-DESC-9(1:7)                      12171097
121711                                 '-'                              12171197
121712                     XLT00043-BRND-DESC DELIMITED BY SIZE         12171297
121713            INTO  PV-BUS-AREA-BRAND                               12171397
121714        WHEN  PV-DESC-LEN   =  6                                  12171497
121715            STRING   PV-BUS-AREA-DESC-9(1:6)                      12171597
121716                                 '-'                              12171697
121717                     XLT00043-BRND-DESC DELIMITED BY SIZE         12171797
121718            INTO  PV-BUS-AREA-BRAND                               12171897
121719        WHEN  PV-DESC-LEN   =  5                                  12171997
121720            STRING   PV-BUS-AREA-DESC-9(1:5)                      12172097
121721                                 '-'                              12172197
121722                     XLT00043-BRND-DESC DELIMITED BY SIZE         12172297
121723            INTO  PV-BUS-AREA-BRAND                               12172397
121724        WHEN  PV-DESC-LEN   =  4                                  12172497
121725            STRING   PV-BUS-AREA-DESC-9(1:4)                      12172597
121726                                 '-'                              12172697
121727                     XLT00043-BRND-DESC DELIMITED BY SIZE         12172797
121728            INTO  PV-BUS-AREA-BRAND                               12172897
121729        WHEN  PV-DESC-LEN   =  3                                  12172997
121730            STRING   PV-BUS-AREA-DESC-9(1:3)                      12173097
121731                                 '-'                              12173197
121732                     XLT00043-BRND-DESC DELIMITED BY SIZE         12173297
121733            INTO  PV-BUS-AREA-BRAND                               12173397
121734        WHEN  PV-DESC-LEN   =  2                                  12173497
121735            STRING   PV-BUS-AREA-DESC-9(1:2)                      12173597
121736                                 '-'                              12173697
121737                     XLT00043-BRND-DESC DELIMITED BY SIZE         12173797
121738            INTO  PV-BUS-AREA-BRAND                               12173897
121739        WHEN  PV-DESC-LEN   =  1                                  12173997
121740            STRING   PV-BUS-AREA-DESC-9(1:1)                      12174097
121741                                 '-'                              12174197
121742                     XLT00043-BRND-DESC DELIMITED BY SIZE         12174297
121743            INTO  PV-BUS-AREA-BRAND                               12174397
121744        WHEN  OTHER                                               12174497
121745*           NO BUSINESS AREA AVAILABLE                            12174597
121746            STRING   PV-BUS-AREA-DESC-9(1:9)                      12174697
121747                                 '-'                              12174797
121748                     XLT00043-BRND-DESC DELIMITED BY SIZE         12174897
121749            INTO  PV-BUS-AREA-BRAND                               12174997
121750     END-EVALUATE.                                                12175097
121793                                                                  12179391
121794*CLP 06/22/2015 END                                               12179491
121795*================================================================*12179500
121800* BUILD INITIAL EXPECTED TABLE IN DOOR SEQ                       *12180000
121900*================================================================*12190000
122000 1250-BUILD-DOOR-SEQ-TABLE.                                       12200000
122100                                                                  12210000
122200     INITIALIZE PT-STORE-EXPECT-TABLE.                            12220000
122300     SET PS-NOT-EOF-DOOR-SEQ-CSR      TO TRUE                     12230000
122301                                                                  12230135
122310     IF PC166-FUNC-CRE-VRTL-LBL                                   12231035
122320        PERFORM 5432-CALL-ITEM-DOMAIN-MOD                         12232035
122330        PERFORM 7200-GET-AD-DATE                                  12233035
122340        PERFORM 5433-CHECK-EAS-TAG                                12234035
122341*06/22/2015 - START                                               12234188
122342        PERFORM 5436-GET-BUSINESS-DESC                            12234289
122343        PERFORM 5434-CHECK-BRAND                                  12234388
122344*06/22/2015 - END                                                 12234488
122350     END-IF                                                       12235035
122400                                                                  12240000
122500     PERFORM 8030-OPEN-DOOR-SEQ-CSR.                              12250000
122600     PERFORM 8040-FETCH-DOOR-SEQ-CSR.                             12260000
122700     PERFORM                                                      12270000
122800         VARYING PT-EXPT-IDX                                      12280000
122900            FROM 1 BY 1                                           12290000
123000           UNTIL PS-EOF-DOOR-SEQ-CSR OR                           12300000
123100                 PT-EXPT-IDX > PC-MAX-EXPTED-TBL-ENTRY            12310000
123200                                                                  12320000
123300            MOVE PV-TYPE-CODE-SEQ       TO  PT-EXPT-STR-TYP-ORDER 12330000
123400                                            (PT-EXPT-IDX)         12340000
123500            MOVE RECDIS-STR-NBR         TO  PT-EXPT-STR-NBR       12350000
123600                                            (PT-EXPT-IDX)         12360000
123700            MOVE XLT00010-LOC-TYP-CDE   TO  PT-EXPT-STR-TYP       12370000
123800                                            (PT-EXPT-IDX)         12380000
123900            MOVE XLT00010-E-BUS-IND     TO  PT-EXPT-E-COMMERCE-IND12390000
124000                                            (PT-EXPT-IDX)         12400000
124100            MOVE RECDIS-EXPTED-ITM-QTY  TO  PT-EXPT-EXPTED-QTY    12410000
124200                                            (PT-EXPT-IDX)         12420000
124300                                            PT-EXPT-NEEDED-QTY    12430000
124400                                            (PT-EXPT-IDX)         12440000
124500            MOVE ZEROES                 TO  PT-EXPT-ALLOC-QTY     12450000
124600                                            (PT-EXPT-IDX)         12460000
124700                                            PT-EXPT-FCSE-CNT      12470000
124800                                            (PT-EXPT-IDX)         12480000
124900                                            PT-EXPT-INPK-CNT      12490000
125000                                            (PT-EXPT-IDX)         12500000
125100                                            PT-EXPT-P2L-UNTS      12510000
125200                                            (PT-EXPT-IDX)         12520000
125300                                            PT-EXPT-FCSE-UNTS     12530000
125400                                            (PT-EXPT-IDX)         12540000
125500                                            PT-EXPT-INPK-UNTS     12550000
125600                                            (PT-EXPT-IDX)         12560000
125700            IF  PV-UCC128-MAX-OTPK  =  ZEROES                     12570000
125800                MOVE  RECDIS-EXPTED-ITM-QTY                       12580000
125900                  TO  PV-NEEDED-MAX-OTPK                          12590000
126000                      PV-NEEDED-MIN-OTPK                          12600000
126100            ELSE                                                  12610000
126200            IF  RECDIS-EXPTED-ITM-QTY  >  PV-NEEDED-MAX-OTPK      12620000
126300                MOVE  RECDIS-EXPTED-ITM-QTY                       12630000
126400                  TO  PV-NEEDED-MAX-OTPK                          12640000
126500            ELSE                                                  12650000
126600            IF  RECDIS-EXPTED-ITM-QTY  <  PV-NEEDED-MIN-OTPK      12660000
126700                MOVE  RECDIS-EXPTED-ITM-QTY                       12670000
126800                  TO  PV-NEEDED-MIN-OTPK                          12680000
126900            END-IF                                                12690000
127000            END-IF                                                12700000
127100            END-IF                                                12710000
127200                                                                  12720000
127300            IF PC166-FUNC-CRE-VRTL-LBL                            12730000
127400               IF  PS-SEASET-DATA-FOUND OR                        12740002
127500                  (PV-CURRENT-DATE < XLT00010-OPN-DTE)            12750002
127600                   PERFORM 5430-CALL-SET-FIXT-ID-MOD              12760000
127700                   MOVE PC240-FIXT-ID    TO                       12770003
127800                                PT-EXPT-FIXT-ID (PT-EXPT-IDX)     12780000
127900                   MOVE PC240-SEASET-NM  TO                       12790003
128000                                PT-EXPT-SEASONAL-SET (PT-EXPT-IDX)12800000
128100               ELSE                                               12810000
128200                   MOVE SPACES           TO                       12820000
128300                        PT-EXPT-FIXT-ID (PT-EXPT-IDX)             12830000
128400                        PT-EXPT-SEASONAL-SET (PT-EXPT-IDX)        12840000
128500               END-IF                                             12850000
128501                                                                  12850138
128510               PERFORM 7300-GET-CURRENT-DOOR                      12851038
128520                                                                  12852038
128600            END-IF                                                12860000
128601            MOVE CNDCDR-DOOR-ID          TO                       12860140
128602                               PT-EXPT-DOOR-ID (PT-EXPT-IDX)      12860238
128610            MOVE PS-SET-EAS-TAG-SW       TO                       12861035
128620                           PT-EXPT-EAS-TAG-IND (PT-EXPT-IDX)      12862035
128630            MOVE PV-HNG-FOLD-SEQ-NBR     TO                       12863046
128640                           PT-EXPT-PRESENTATION-IND (PT-EXPT-IDX) 12864035
128700                                                                  12870000
128800            MOVE PS-SEASET-DATA-FOUND-SW TO                       12880000
128900                                 PT-EXPT-SEASET-IND (PT-EXPT-IDX) 12890000
129010                                                                  12901057
129011*CLP 06/22/2015 -START                                            12901190
129013            MOVE PV-BUS-AREA-BRAND TO                             12901390
129014                           PT-EXPT-MERCHANDISE-PGM (PT-EXPT-IDX)  12901490
129017*CLP 06/22/2015 -END                                              12901790
129040                                                                  12904057
129100            PERFORM 8040-FETCH-DOOR-SEQ-CSR                       12910000
129200                                                                  12920000
129300     END-PERFORM.                                                 12930000
129400                                                                  12940000
129500     PERFORM 8050-CLOSE-DOOR-SEQ-CSR.                             12950000
129600                                                                  12960000
129610                                                                  12961018
129621*================================================================*12962118
129622* CHECK TO SEE IF ANY OF THE PACKSLIP CARTON COMBINATION UNIT    *12962218
129623* QUANTITIES = 0.  IF THERE ARE ANY FOR PO-PACKSLIP THEN THE     *12962318
129624* UCC128 DATA CANNOT BE USED BECAUSE THE CARTONS ARE EMPTY.      *12962418
129625*================================================================*12962518
129626 1275-CHECK-TSHPSUM-ZERO.                                         12962618
129627                                                                  12962718
129628     EXEC SQL                                                     12962818
129629          SELECT  A.PO_NBR                                        12962918
129630                 ,A.PKSL_SEQ_NBR                                  12963018
129631                 ,A.CART_COMB_NBR                                 12963118
129632                 ,SUM(A.OTPK_UNT_QTY)                             12963218
129633            INTO  :SHPSUM-PO-NBR                                  12963318
129634                 ,:SHPSUM-PKSL-SEQ-NBR                            12963418
129635                 ,:SHPSUM-CART-COMB-NBR                           12963518
129636                 ,:SHPSUM-OTPK-UNT-QTY                            12963618
129638            FROM  TSHPSUM A                                       12963818
129639                 ,TPKSLIP B                                       12963918
129640           WHERE  A.PO_NBR            = :DK-PO-NBR                12964018
129641             AND  A.PO_NBR            =  B.PO_NBR                 12964118
129642             AND  A.PKSL_SEQ_NBR      =  B.SEQ_NBR                12964218
129643             AND  B.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR          12964318
129644             AND  B.VER_STAT_CDE      = 'A'                       12964418
129645             AND  B.PKSL_STAT_CDE     = 'AC'                      12964518
129648             GROUP BY A.PO_NBR                                    12964819
129649                     ,A.PKSL_SEQ_NBR                              12964919
129650                     ,A.CART_COMB_NBR                             12965019
129651             HAVING SUM(A.OTPK_UNT_QTY) = 0                       12965120
129652     END-EXEC.                                                    12965218
129653                                                                  12965318
129654     EVALUATE TRUE                                                12965418
129655         WHEN SQLCODE = ZERO                                      12965518
129656         WHEN SQLCODE = -811                                      12965618
129657              IF  SHPSUM-OTPK-UNT-QTY  =  0                       12965720
129659                  SET  PS-ERROR                                   12965920
129660                       PC166-PREPK-UCC128-NO   TO  TRUE           12966020
129661              END-IF                                              12966120
129662                                                                  12966218
129663         WHEN SQLCODE = +100                                      12966320
129664              CONTINUE                                            12966420
129666                                                                  12966620
129667         WHEN SQLCODE = -904                                      12966718
129668         WHEN SQLCODE = -911                                      12966818
129669         WHEN SQLCODE = -913                                      12966918
129670              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      12967018
129671              STRING 'SQL='                                       12967118
129672                     PV-SQL-RETURN-CD                             12967218
129673                     ' 1275-CHECK-TSHPSUM-ZERO'                   12967318
129674                                            DELIMITED BY SIZE     12967418
129675                                       INTO PC166-CRA-RET-MSG     12967518
129676              MOVE '15'                TO   PC166-CRA-RET-CDE     12967618
129677              PERFORM 9000-RETURN-CALL                            12967718
129678                                                                  12967818
129679         WHEN SQLWARN0 NOT = SPACES                               12967918
129680         WHEN SQLCODE < ZERO                                      12968018
129681         WHEN SQLCODE > ZERO                                      12968118
129682              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      12968218
129683              STRING 'SQL='                                       12968318
129684                     PV-SQL-RETURN-CD                             12968418
129685                     ' 1275-CHECK-TSHPSUM-ZERO '                  12968518
129686                                            DELIMITED BY SIZE     12968618
129687                                       INTO PC166-CRA-RET-MSG     12968718
129688             MOVE '16'                 TO   PC166-CRA-RET-CDE     12968818
129689             PERFORM 9000-RETURN-CALL                             12968918
129690     END-EVALUATE.                                                12969018
129691                                                                  12969118
129700                                                                  12970000
129800*================================================================*12980000
129900* PRE-PACK ROUTINE TO DETERMINE IF VALID UCC128 DATA             *12990000
130000*================================================================*13000000
130100 1300-PREPACK-ROUTINE.                                            13010000
130200                                                                  13020000
130300     PERFORM 1400-BUILD-PREPK-LNE-TBL.                            13030000
130400                                                                  13040000
130500     PERFORM 7075-OPEN-SHPSUM-CURSOR.                             13050000
130600     PERFORM 7080-FETCH-SHPSUM-CSR.                               13060000
130700                                                                  13070000
130800     IF  PS-EOF-SHPSUM-CSR                                        13080000
130900         SET  PS-ERROR               TO TRUE                      13090000
131000     ELSE                                                         13100000
131100         MOVE  SHPSUM-PO-NBR         TO  PV-PREV-PO-NBR           13110000
131200         MOVE  SHPSUM-PKSL-SEQ-NBR   TO  PV-PREV-PKSL-SEQ         13120000
131300         MOVE  SHPSUM-CART-COMB-NBR  TO  PV-PREV-COMBO-NBR        13130000
131400         MOVE  SHPSUM-OTPK-UNT-QTY   TO  PV-PREV-OTPK-QTY         13140000
131500         MOVE  SHPSUM-TOT-CART-CNT   TO  PV-PREV-CRTN-CNT         13150000
131600         SET   PS-SAME-SUMMARY-YES                                13160000
131700               PS-COMBO-LNE-IN-UNKNOWN                            13170000
131800               PS-COMBO-LNE-NOT-UNKNOWN                           13180000
131900               PS-COMBO-ENTRY-PREPK-UNK                           13190000
132000               PS-COMBO-ENTRY-NOT-PREPK-UNK TO TRUE               13200000
132100     END-IF.                                                      13210000
132200                                                                  13220000
132300     PERFORM                                                      13230000
132400       UNTIL PS-EOF-SHPSUM-CSR                                    13240000
132500          OR PS-ERROR                                             13250000
132600             PERFORM 1410-PROCESS-SUMMARY                         13260000
132700     END-PERFORM.                                                 13270000
132800                                                                  13280000
132900     PERFORM 7085-CLOSE-SHPSUM-CSR.                               13290000
133000                                                                  13300000
133100     IF  PS-NO-ERROR                                              13310000
133200         IF  PV-BEST-CASE-TBL-ENTRIES  >  0                       13320000
133300             SET  PC166-PREPK-UCC128-YES  TO  TRUE                13330000
133400             PERFORM 1470-BUILD-PREPK-UCC128                      13340000
133500* DMH 6/13/03 - BEGIN                                             13350000
133600             IF  PV-UCC128-MIN-OTPK  =  ZERO  AND                 13360000
133700                 PV-UCC128-MAX-OTPK  =  ZERO                      13370000
133800                 SET  PS-ERROR                                    13380000
133900                      PC166-PREPK-UCC128-NO   TO  TRUE            13390000
134000             END-IF                                               13400000
134100* DMH 6/13/03 - END                                               13410000
134200         ELSE                                                     13420000
134300             SET  PS-ERROR                                        13430000
134400                  PC166-PREPK-UCC128-NO   TO  TRUE                13440000
134500         END-IF                                                   13450000
134600     ELSE                                                         13460000
134700         SET  PC166-PREPK-UCC128-NO   TO  TRUE                    13470000
134800     END-IF.                                                      13480000
134900                                                                  13490000
135000                                                                  13500000
135100*================================================================*13510000
135200* BUILD TABLE CONTAINING ALL LINES FOR A PREPACK                 *13520000
135300*================================================================*13530000
135400 1400-BUILD-PREPK-LNE-TBL.                                        13540000
135500                                                                  13550000
135600     PERFORM 7060-OPEN-PREPK-CURSOR.                              13560000
135700     PERFORM 7065-FETCH-PREPK-CSR.                                13570000
135800                                                                  13580000
135900     IF  PS-EOF-PREPK-CSR                                         13590000
136000         SET  PS-ERROR  TO  TRUE                                  13600000
136100     END-IF.                                                      13610000
136200                                                                  13620000
136300     PERFORM                                                      13630000
136400         VARYING PT-PRPK-IDX                                      13640000
136500            FROM 1 BY 1                                           13650000
136600           UNTIL PS-EOF-PREPK-CSR  OR                             13660000
136700                 PT-PRPK-IDX  >  PC-MAX-PREPK-LINE-ENTRY          13670000
136800                                                                  13680000
136900            MOVE RECITM-ORD-LNE-NBR     TO PT-PREPK-LNE-NBR       13690000
137000                                           (PT-PRPK-IDX)          13700000
137100            MOVE RECITM-PREPK-RATO-QTY  TO PT-PREPK-RATIO         13710000
137200                                           (PT-PRPK-IDX)          13720000
137300            SET  PT-PREPK-DATA-AVAIL-NO    (PT-PRPK-IDX)          13730000
137400                                        TO TRUE                   13740000
137500            MOVE ZEROES                 TO PT-PREPK-RATIO-MULT    13750000
137600                                           (PT-PRPK-IDX)          13760000
137700                                           PT-PREPK-OTPK-QTY      13770000
137800                                           (PT-PRPK-IDX)          13780000
137900            PERFORM 7065-FETCH-PREPK-CSR                          13790000
138000     END-PERFORM.                                                 13800000
138100                                                                  13810000
138200     PERFORM 7070-CLOSE-PREPK-CSR.                                13820000
138300                                                                  13830000
138400                                                                  13840000
138500*================================================================*13850000
138600* PROCESS SHIPMENT SUMMARY TABLE                                 *13860000
138700*   -ENSURE ALL LINES FOR A PREPACK ARE IN CARTON                *13870000
138800*   -ENSURE ALL LINE ALLOCATIONS ARE DIVISIBLE BY LINE RATIO     *13880000
138900*   -ENSURE ALL LINES CARTON/RATIO ARE THE SAME MULTIPLE         *13890000
139000*================================================================*13900000
139100 1410-PROCESS-SUMMARY.                                            13910000
139200                                                                  13920000
139300     IF  SHPSUM-PO-NBR         =  PV-PREV-PO-NBR     AND          13930000
139400         SHPSUM-PKSL-SEQ-NBR   =  PV-PREV-PKSL-SEQ   AND          13940000
139500         SHPSUM-CART-COMB-NBR  =  PV-PREV-COMBO-NBR               13950000
139600         PERFORM 1420-CHECK-PREPK-LNE                             13960000
139700     ELSE                                                         13970000
139800         PERFORM 1425-CHECK-COMBO-ENTRIES                         13980000
139900         PERFORM 1430-RESET-PREPK-TABLE                           13990000
140000         IF  PS-NO-ERROR                                          14000000
140100             MOVE  SHPSUM-PO-NBR         TO  PV-PREV-PO-NBR       14010000
140200             MOVE  SHPSUM-PKSL-SEQ-NBR   TO  PV-PREV-PKSL-SEQ     14020000
140300             MOVE  SHPSUM-CART-COMB-NBR  TO  PV-PREV-COMBO-NBR    14030000
140400             MOVE  SHPSUM-OTPK-UNT-QTY   TO  PV-PREV-OTPK-QTY     14040000
140500             MOVE  SHPSUM-TOT-CART-CNT   TO  PV-PREV-CRTN-CNT     14050000
140600             SET   PS-COMBO-LNE-IN-UNKNOWN                        14060000
140700                   PS-COMBO-LNE-NOT-UNKNOWN                       14070000
140800                   PS-COMBO-ENTRY-PREPK-UNK                       14080000
140900                   PS-COMBO-ENTRY-NOT-PREPK-UNK  TO TRUE          14090000
141000             PERFORM 1420-CHECK-PREPK-LNE                         14100000
141100         END-IF                                                   14110000
141200     END-IF.                                                      14120000
141300                                                                  14130000
141400     IF  PS-NO-ERROR                                              14140000
141500         PERFORM 7080-FETCH-SHPSUM-CSR                            14150000
141600     END-IF.                                                      14160000
141700                                                                  14170000
141800     IF  PS-NO-ERROR                                              14180000
141900         IF  PS-EOF-SHPSUM-CSR                                    14190000
142000             PERFORM 1425-CHECK-COMBO-ENTRIES                     14200000
142100             PERFORM 1430-RESET-PREPK-TABLE                       14210000
142200         END-IF                                                   14220000
142300     END-IF.                                                      14230000
142400                                                                  14240000
142500                                                                  14250000
142600                                                                  14260000
142700*================================================================*14270000
142800* CHECK TO SEE IF CARTON COMBINATION IS FOR LINE WITHIN THE PRE- *14280000
142900* PACK                                                           *14290000
143000*================================================================*14300000
143100 1420-CHECK-PREPK-LNE.                                            14310000
143200                                                                  14320000
143300     SET  PS-COMBO-LNE-IN-UNKNOWN                                 14330000
143400          PS-COMBO-LNE-NOT-UNKNOWN                                14340000
143500          PS-NO-RATIO-REMAINDER-ERROR TO  TRUE                    14350000
143600                                                                  14360000
143700     PERFORM                                                      14370000
143800        VARYING PT-PRPK-IDX                                       14380000
143900           FROM 1  BY  1                                          14390000
144000          UNTIL PT-PRPK-IDX  >  PV-PREPK-TABLE-ENTRIES            14400000
144100             OR PS-ERROR                                          14410000
144200                IF  PT-PREPK-LNE-NBR (PT-PRPK-IDX) =              14420000
144300                    SHPSUM-PO-LNE-NBR                             14430000
144400                    SET  PS-COMBO-LNE-IN-PREPK                    14440000
144500                         PS-COMBO-ENTRY-PREPK                     14450000
144600                         PT-PREPK-DATA-AVAIL-YES (PT-PRPK-IDX)    14460000
144700                                                 TO  TRUE         14470000
144800                    DIVIDE  SHPSUM-OTPK-UNT-QTY                   14480000
144900                        BY  PT-PREPK-RATIO       (PT-PRPK-IDX)    14490000
145000                    GIVING  PT-PREPK-RATIO-MULT  (PT-PRPK-IDX)    14500000
145100                    REMAINDER  PV-PREPK-REMAINDER                 14510000
145200                    MOVE  SHPSUM-OTPK-UNT-QTY                     14520000
145300                      TO  PT-PREPK-OTPK-QTY (PT-PRPK-IDX)         14530000
145400                    IF  PV-PREPK-REMAINDER  >  0                  14540000
145500                       SET  PS-RATIO-REMAINDER-ERROR              14550000
145600                            PS-ERROR                 TO  TRUE     14560000
145700                    END-IF                                        14570000
145800                END-IF                                            14580000
145900     END-PERFORM.                                                 14590000
146000                                                                  14600000
146100*  IF COMBINATION LINE ENTRY IS NOT IN PREPACK SET SWITCH         14610000
146200*  INDICATING COMBINATION HAS ENTRIES OUTSIDE OF PREPK            14620000
146300                                                                  14630000
146400     IF  PS-COMBO-LNE-IN-UNKNOWN   AND                            14640000
146500         PS-COMBO-LNE-NOT-UNKNOWN                                 14650000
146600         SET  PS-COMBO-ENTRY-NOT-PREPK  TO  TRUE                  14660000
146700     END-IF.                                                      14670000
146800                                                                  14680000
146900                                                                  14690000
147000*================================================================*14700000
147100* CHECK CARTON COMBINATION ENTRY                                 *14710000
147200*    - HAS ENTRIES FOR PREPACK                                   *14720000
147300*    - HAS ENTRIES FOR PREPACK & HAS ENTRIES NOT IN PREPACK      *14730000
147400*================================================================*14740000
147500 1425-CHECK-COMBO-ENTRIES.                                        14750000
147600                                                                  14760000
147700     IF  PS-COMBO-ENTRY-PREPK-UNK                                 14770000
147800         CONTINUE                                                 14780000
147900     ELSE                                                         14790000
148000     IF  PS-COMBO-ENTRY-PREPK  AND                                14800000
148100         PS-COMBO-ENTRY-NOT-PREPK                                 14810000
148200         SET  PS-ERROR                                            14820000
148300              PC166-ERR-LNES-NOT-PRPK  TO  TRUE                   14830000
148400     ELSE                                                         14840000
148500         PERFORM 1440-CHECK-LINE-RATIO                            14850000
148600         IF  PS-SAME-RATIO-MULT  AND                              14860000
148700             PS-ENTRIES-ALL-PREPK                                 14870000
148800             PERFORM 1445-POPULATE-BEST-CASE                      14880000
148900         END-IF                                                   14890000
149000     END-IF.                                                      14900000
149100                                                                  14910000
149200                                                                  14920000
149300*================================================================*14930000
149400* RESET LINE ENTRIES IN PREPK LINE TABLE                         *14940000
149500*================================================================*14950000
149600 1430-RESET-PREPK-TABLE.                                          14960000
149700                                                                  14970000
149800     PERFORM                                                      14980000
149900        VARYING PT-PRPK-IDX                                       14990000
150000           FROM 1  BY  1                                          15000000
150100          UNTIL PT-PRPK-IDX  >  PV-PREPK-TABLE-ENTRIES            15010000
150200             OR PS-ERROR                                          15020000
150300                SET  PT-PREPK-DATA-AVAIL-NO (PT-PRPK-IDX)         15030000
150400                            TO  TRUE                              15040000
150500                MOVE ZEROES TO PT-PREPK-RATIO-MULT (PT-PRPK-IDX)  15050000
150600     END-PERFORM.                                                 15060000
150700                                                                  15070000
150800                                                                  15080000
150900*================================================================*15090000
151000* CHECK TO MAKE SURE THAT ALL LINE HAVE THE SAME RATIO MULTIPLE  *15100000
151100*================================================================*15110000
151200 1440-CHECK-LINE-RATIO.                                           15120000
151300                                                                  15130000
151400     MOVE  PT-PREPK-RATIO-MULT(+1)  TO  PV-RATIO-MULTIPLE.        15140000
151500     SET   PS-SAME-RATIO-MULT                                     15150000
151600           PS-ENTRIES-ALL-PREPK     TO  TRUE.                     15160000
151700     MOVE  ZEROES                   TO  PV-TOTAL-PREPK-OTPK       15170000
151800                                        PV-DRVR-LNE-OTPK          15180000
151900                                        PV-DRVR-LNE-RATIO-MULT.   15190000
152000                                                                  15200000
152100     PERFORM                                                      15210000
152200        VARYING PT-PRPK-IDX                                       15220000
152300           FROM 1  BY  1                                          15230000
152400          UNTIL PT-PRPK-IDX  >  PV-PREPK-TABLE-ENTRIES            15240000
152500             OR PS-ERROR                                          15250000
152600                IF  PT-PREPK-DATA-AVAIL-NO (PT-PRPK-IDX)          15260000
152700                    SET  PS-ENTRIES-MIS-PREPK TO TRUE             15270000
152800                ELSE                                              15280000
152900                    ADD PT-PREPK-OTPK-QTY   (PT-PRPK-IDX)         15290000
153000                     TO PV-TOTAL-PREPK-OTPK                       15300000
153100                    IF  PT-PREPK-LNE-NBR    (PT-PRPK-IDX)  =      15310000
153200                        PC166-PO-LNE-NBR                          15320000
153300                        MOVE PT-PREPK-OTPK-QTY (PT-PRPK-IDX)      15330000
153400                          TO PV-DRVR-LNE-OTPK                     15340000
153500                        MOVE PT-PREPK-RATIO-MULT (PT-PRPK-IDX)    15350000
153600                          TO PV-DRVR-LNE-RATIO-MULT               15360000
153700                    END-IF                                        15370000
153800                    IF  PT-PREPK-RATIO-MULT (PT-PRPK-IDX)  =      15380000
153900                        PV-RATIO-MULTIPLE                         15390000
154000                        CONTINUE                                  15400000
154100                    ELSE                                          15410000
154200                        SET  PS-DIFF-RATIO-MULT    TO  TRUE       15420000
154300                    END-IF                                        15430000
154400                END-IF                                            15440000
154500     END-PERFORM.                                                 15450000
154600                                                                  15460000
154700     IF  PS-ENTRIES-ALL-PREPK  AND                                15470000
154800         PS-DIFF-RATIO-MULT                                       15480000
154900         SET  PS-ERROR        TO  TRUE                            15490000
155000     END-IF.                                                      15500000
155100                                                                  15510000
155200                                                                  15520000
155300*================================================================*15530000
155400* RESET LINE ENTRIES IN PREPK LINE TABLE                         *15540000
155500*================================================================*15550000
155600 1445-POPULATE-BEST-CASE.                                         15560000
155700                                                                  15570000
155800                                                                  15580000
155900     MOVE PV-PREV-COMBO-NBR             TO  PT-BEST-CRTN-COMB     15590000
156000                                            (PT-BEST-IDX).        15600000
156100     MOVE PV-DRVR-LNE-RATIO-MULT        TO  PT-BEST-RATIO-MULT    15610000
156200                                            (PT-BEST-IDX).        15620000
156300     MOVE PV-PREV-CRTN-CNT              TO  PT-BEST-CRTN-CNT      15630000
156400                                            (PT-BEST-IDX).        15640000
156500     MOVE PV-DRVR-LNE-OTPK              TO  PT-BEST-DRVR-LNE-OTPK 15650000
156600                                            (PT-BEST-IDX).        15660000
156700     MOVE PV-DRVR-LNE-OTPK              TO  PT-BEST-OTPK-QTY      15670000
156800                                            (PT-BEST-IDX).        15680000
156900     MULTIPLY  PT-BEST-OTPK-QTY (PT-BEST-IDX)                     15690000
157000           BY  PT-BEST-CRTN-CNT (PT-BEST-IDX)                     15700000
157100       GIVING  PT-BEST-EXTEND-UNTS (PT-BEST-IDX)                  15710000
157200                                                                  15720000
157300     ADD  1  TO  PV-BEST-CASE-TBL-ENTRIES.                        15730000
157400     SET  PT-BEST-IDX  UP BY +1.                                  15740000
157500                                                                  15750000
157600                                                                  15760000
157700*================================================================*15770000
157800* BUILD UCC128 DATA FOR PREPK FROM BEST CASE TABLE               *15780000
157900*================================================================*15790000
158000 1470-BUILD-PREPK-UCC128.                                         15800000
158100                                                                  15810000
158200     PERFORM                                                      15820000
158300       VARYING PT-BEST-IDX                                        15830000
158400          FROM 1 BY 1                                             15840000
158500         UNTIL PT-BEST-IDX  >  PC-MAX-BEST-CASE-ENTRY             15850000
158600            OR PT-BEST-IDX  >  PV-BEST-CASE-TBL-ENTRIES           15860000
158700               IF  PT-BEST-CRTN-CNT (PT-BEST-IDX)  >  0           15870000
158800                   SET  PT-U128-IDX TO PT-BEST-IDX                15880000
158900                   MOVE PT-BEST-CRTN-CNT (PT-BEST-IDX)            15890000
159000                     TO PT-UCC128-CRTNS  (PT-U128-IDX)            15900000
159100                   MOVE PT-BEST-OTPK-QTY (PT-BEST-IDX)            15910000
159200                     TO PT-UCC128-OTPK   (PT-U128-IDX)            15920000
159300                   ADD  1  TO  PV-UCC128-TABLE-ENTRIES            15930000
159400                   ADD  PT-BEST-CRTN-CNT (PT-BEST-IDX)            15940000
159500                    TO  PV-TOTAL-CARTON-COUNT                     15950000
159600                   IF  PV-UCC128-MAX-OTPK = ZEROES                15960000
159700                       MOVE PT-BEST-OTPK-QTY (PT-BEST-IDX)        15970000
159800                         TO PV-UCC128-MAX-OTPK                    15980000
159900                            PV-UCC128-MIN-OTPK                    15990000
160000                   ELSE                                           16000000
160100                   IF  PT-BEST-OTPK-QTY (PT-BEST-IDX)             16010000
160200                                      >  PV-UCC128-MAX-OTPK       16020000
160300                       MOVE PT-BEST-OTPK-QTY (PT-BEST-IDX)        16030000
160400                         TO PV-UCC128-MAX-OTPK                    16040000
160500                   ELSE                                           16050000
160600                   IF  PT-BEST-OTPK-QTY (PT-BEST-IDX)             16060000
160700                                       <  PV-UCC128-MIN-OTPK      16070000
160800                       MOVE PT-BEST-OTPK-QTY (PT-BEST-IDX)        16080000
160900                         TO PV-UCC128-MIN-OTPK                    16090000
161000                   END-IF                                         16100000
161100                   END-IF                                         16110000
161200                   END-IF                                         16120000
161300               END-IF                                             16130000
161400     END-PERFORM.                                                 16140000
161500                                                                  16150000
161600                                                                  16160000
161700*================================================================*16170000
161800* CALCULATE LABEL COUNT - PROCESSING SML & P2L LABELS            *16180000
161900*================================================================*16190000
162000 2000-CREATE-SML-P2L.                                             16200000
162100                                                                  16210000
162200      IF  PC166-PRT-SHUFFLED                                      16220000
162300          PERFORM 4000-SML-FULLCASE-MATCH                         16230000
162400*         PERFORM 4010-SML-FULLCASE-MATCH-STR                     16240000
162500      END-IF.                                                     16250000
162600                                                                  16260000
162700* DISTRIBUTION CENTER AND RETURN TO VENDOR NEED TO BE IN FULLCASE 16270000
162800* ALLOCATIONS.  IF NOT ALL ALLOCATED FORCE AN ERROR.              16280000
162900      PERFORM                                                     16290000
163000        VARYING PT-EXPT-IDX                                       16300000
163100           FROM 1  BY  1                                          16310000
163200          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           16320000
163300                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) >  ZERO  AND 16330000
163400                    PT-EXPT-STR-TYP (PT-EXPT-IDX) = ('DC' OR 'RV')16340000
163500                    SET  PS-ERROR  TO  TRUE                       16350000
163600* DMH               SET  PC166-ERR-INVALID-OTPK  TO  TRUE         16360000
163700                    SET  PC166-ERR-DC-RTV-NOT-OTPK  TO  TRUE      16370000
163800                END-IF                                            16380000
163900      END-PERFORM.                                                16390000
164000                                                                  16400000
164100      IF  PV-FCSE-ALLOCATED  =  PC166-TOTAL-CARTONS  OR           16410000
164200          PS-ERROR                                                16420000
164300          CONTINUE                                                16430000
164400      ELSE                                                        16440000
164500      IF  PC166-PRT-SHUFFLED                                      16450000
164600          PERFORM 3000-SHUFFLED-SEQUENCE                          16460000
164700      ELSE                                                        16470000
164800      IF  PC166-PRT-STR-SEQ OR PC166-PRT-DOOR-SEQ                 16480000
164900          PERFORM 3100-STORE-SEQUENCE                             16490000
165000      END-IF                                                      16500000
165100      END-IF                                                      16510000
165200      END-IF.                                                     16520000
165300                                                                  16530000
165400                                                                  16540000
165500*================================================================*16550000
165600* CALCULATE LABEL COUNT - PROCESSING SML LABELS ONLY             *16560000
165700*================================================================*16570000
165800 2200-CREATE-SML-ONLY.                                            16580000
165900                                                                  16590000
166000      IF  PC166-PRT-SHUFFLED                                      16600000
166100          PERFORM 4000-SML-FULLCASE-MATCH                         16610000
166200*         PERFORM 4010-SML-FULLCASE-MATCH-STR                     16620000
166300      END-IF.                                                     16630000
166400                                                                  16640000
166500* DISTRIBUTION CENTER AND RETURN TO VENDOR NEED TO BE IN FULLCASE 16650000
166600* ALLOCATIONS.  IF NOT ALL ALLOCATED FORCE AN ERROR.              16660000
166700                                                                  16670000
166800     PERFORM                                                      16680000
166900        VARYING PT-EXPT-IDX                                       16690000
167000           FROM 1  BY  1                                          16700000
167100          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           16710000
167200                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) >  ZERO  AND 16720000
167300                    PT-EXPT-STR-TYP (PT-EXPT-IDX) = ('DC' OR 'RV')16730000
167400                    SET  PS-ERROR  TO  TRUE                       16740000
167500*DMH                SET  PC166-ERR-INVALID-OTPK  TO  TRUE         16750000
167600                END-IF                                            16760000
167700     END-PERFORM.                                                 16770000
167800                                                                  16780000
167900      IF  PV-FCSE-ALLOCATED  =  PC166-TOTAL-CARTONS  OR           16790000
168000          PS-ERROR                                                16800000
168100          CONTINUE                                                16810000
168200      ELSE                                                        16820000
168300      IF  PC166-PRT-SHUFFLED                                      16830000
168400          PERFORM 3000-SHUFFLED-SEQUENCE                          16840000
168500      ELSE                                                        16850000
168600      IF  PC166-PRT-STR-SEQ OR PC166-PRT-DOOR-SEQ                 16860000
168700          PERFORM 3100-STORE-SEQUENCE                             16870000
168800      END-IF                                                      16880000
168900      END-IF                                                      16890000
169000      END-IF.                                                     16900000
169100                                                                  16910000
169200                                                                  16920000
169300*================================================================*16930000
169400* CALCULATE LABEL COUNT - PROCESSING P2L LABELS ONLY             *16940000
169500*================================================================*16950000
169600 2400-CREATE-P2L-ONLY.                                            16960000
169700                                                                  16970000
169800* CENTRAL STOCK ALLOCATION                                        16980000
169900                                                                  16990000
170000     PERFORM                                                      17000000
170100        VARYING PT-EXPT-IDX                                       17010000
170200           FROM 1  BY  1                                          17020000
170300          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           17030000
170400                IF  PT-EXPT-EXPTED-QTY (PT-EXPT-IDX) >=           17040000
170500                    PV-UCC128-MIN-OTPK                  AND       17050000
170600                   (PT-EXPT-CENTRL-STCK (PT-EXPT-IDX) OR          17060000
170700                    PT-EXPT-E-COMMERCE  (PT-EXPT-IDX))            17070000
170800                    PERFORM 4120-SML-CS                           17080000
170900                END-IF                                            17090000
171000     END-PERFORM.                                                 17100000
171100                                                                  17110000
171200* P2L ALLOCATIONS                                                 17120000
171300                                                                  17130000
171400     MOVE  ZEROES  TO  PV-P2L-QTY-NEEDED.                         17140000
171500     PERFORM                                                      17150000
171600       VARYING PT-EXPT-IDX                                        17160000
171700          FROM 1 BY 1                                             17170000
171800         UNTIL PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES              17180000
171900            IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) > 0              17190000
172000                ADD  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)             17200000
172100                 TO  PV-P2L-QTY-NEEDED                            17210000
172200            END-IF                                                17220000
172300     END-PERFORM                                                  17230000
172400                                                                  17240000
172500     IF  PV-P2L-QTY-NEEDED  >  0                                  17250000
172600         PERFORM 4300-SPLIT-P2L-UNITS                             17260000
172700     END-IF.                                                      17270000
172800                                                                  17280000
172900                                                                  17290000
173000*================================================================*17300000
173100* SUM THE LABEL QUANTITIES TO SEND BACK TO CASEPACK SPLIT LIST   *17310000
173200*================================================================*17320000
173300 2600-SUM-LBL-QTYS.                                               17330000
173400                                                                  17340000
173500      PERFORM                                                     17350000
173600         VARYING PT-EXPT-IDX                                      17360000
173700            FROM 1 BY 1                                           17370000
173800           UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES          17380000
173900                 IF  PT-EXPT-STR-TYP (PT-EXPT-IDX)  =  'DC'       17390000
174000                     ADD  PT-EXPT-ALLOC-QTY (PT-EXPT-IDX)         17400000
174100                      TO  PV-DC-BOUND-UNTS                        17410000
174200                     ADD   PT-EXPT-FCSE-CNT (PT-EXPT-IDX)         17420000
174300                      TO  PV-DC-BOUND-CTNS                        17430000
174400                 ELSE                                             17440000
174500                 IF  PT-EXPT-STR-TYP (PT-EXPT-IDX)  =  'RV'       17450000
174600                     ADD  PT-EXPT-ALLOC-QTY (PT-EXPT-IDX)         17460000
174700                      TO  PV-RTV-BOUND-UNTS                       17470000
174800                     ADD  PT-EXPT-FCSE-CNT (PT-EXPT-IDX)          17480000
174900                      TO  PV-RTV-BOUND-CTNS                       17490000
175000                 ELSE                                             17500000
175100                 IF (PT-EXPT-CENTRL-STCK (PT-EXPT-IDX) OR         17510000
175200                     PT-EXPT-E-COMMERCE  (PT-EXPT-IDX))           17520000
175300                     ADD  PT-EXPT-ALLOC-QTY (PT-EXPT-IDX)         17530000
175400                      TO  PV-CS-BOUND-UNTS                        17540000
175500                     ADD  PT-EXPT-FCSE-CNT (PT-EXPT-IDX)          17550000
175600                      TO  PV-CS-BOUND-CTNS                        17560000
175700                 END-IF                                           17570000
175800                 END-IF                                           17580000
175900                 END-IF                                           17590000
176000     END-PERFORM.                                                 17600000
176100                                                                  17610000
176200     PERFORM                                                      17620000
176300        VARYING PT-CRTN-IDX                                       17630000
176400           FROM 1 BY 1                                            17640000
176500          UNTIL PT-CRTN-IDX  >  PV-CARTON-TABLE-ENTRIES           17650000
176600                EVALUATE TRUE                                     17660000
176700                    WHEN PT-CRTN-SML      (PT-CRTN-IDX)  AND      17670000
176800                         PT-CRTN-FCSE-SML (PT-CRTN-IDX)           17680000
176900                         ADD 1 TO  PV-FCSE-CRTN-CNT               17690000
177000                    WHEN PT-CRTN-SML      (PT-CRTN-IDX)  AND      17700000
177100                         PT-CRTN-INPK-SML (PT-CRTN-IDX)           17710000
177200                         ADD 1 TO  PV-INPK-CRTN-CNT               17720000
177300                    WHEN PT-CRTN-P2L      (PT-CRTN-IDX)           17730000
177400                         ADD 1 TO  PV-P2L-CRTN-CNT                17740000
177500                END-EVALUATE                                      17750000
177600     END-PERFORM.                                                 17760000
177700                                                                  17770000
177800                                                                  17780000
177900*================================================================*17790000
178000* CALCULATE LABEL COUNT - SHUFFLED SEQUENCE                      *17800000
178100*================================================================*17810000
178200 3000-SHUFFLED-SEQUENCE.                                          17820000
178300                                                                  17830000
178400     PERFORM 4200-GET-MAX-MIN-NEEDED.                             17840000
178500                                                                  17850000
178600* PROCESS STORE EXPECTED TABLE TO SEE IF STORES ALLOCATION CAN BE 17860000
178700* PARTIALLY FILLED BY FULLCASE - BASED ON UCC128 DATA TABLE.      17870000
178800                                                                  17880000
178900     IF  PV-NEEDED-MAX-OTPK >  ZERO    AND                        17890000
179000         PV-NEEDED-MAX-OTPK >= PV-UCC128-MIN-OTPK                 17900000
179100         PERFORM                                                  17910000
179200           UNTIL PV-NEEDED-MAX-OTPK < PV-UCC128-MIN-OTPK          17920000
179300              OR PV-FCSE-ALLOCATED  =  PC166-TOTAL-CARTONS        17930000
179400              OR PV-UCC128-MIN-OTPK =  ZEROES                     17940000
179500                 PERFORM                                          17950000
179600                 VARYING  PT-EXPT-IDX                             17960000
179700                    FROM  1 BY 1                                  17970000
179800                   UNTIL  PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES   17980000
179900                      IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) > 0    17990000
180000                          OR  PS-ERROR                            18000000
180100                          PERFORM 4170-SML-FCSE-PARTIAL           18010000
180200                      END-IF                                      18020000
180300                 END-PERFORM                                      18030000
180400                 PERFORM 4200-GET-MAX-MIN-NEEDED                  18040000
180500         END-PERFORM                                              18050000
180600     END-IF.                                                      18060000
180700                                                                  18070000
180800* PROCESS STORE EXPECTED TABLE TO SEE IF STORES ALLOCATION CAN BE 18080000
180900* PARTIALLY FILLED BY INNER-PACKS - BASED ON UCC128 DATA TABLE.   18090000
181000* ONLY IF INNERPACK CONVEYABLE                                    18100000
181100                                                                  18110000
181200     IF  PV-NEEDED-MAX-OTPK = ZERO    OR                          18120000
181300         PV-FCSE-ALLOCATED  =  PC166-TOTAL-CARTONS                18130000
181400         CONTINUE                                                 18140000
181500     ELSE                                                         18150000
181600     IF  PC166-INPK-CNVY-YES                                      18160000
181700         MOVE  PC166-INPK-UNT-QTY  TO  PV-UCC128-MIN-OTPK         18170000
181800                                       PV-UCC128-MAX-OTPK         18180000
181900         PERFORM 4200-GET-MAX-MIN-NEEDED                          18190000
182000         IF  PV-NEEDED-MAX-OTPK  >=  PV-UCC128-MIN-OTPK           18200000
182100             PERFORM                                              18210000
182200               UNTIL PV-NEEDED-MAX-OTPK    < PV-UCC128-MIN-OTPK   18220000
182300                  OR PV-FCSE-ALLOCATED = PC166-TOTAL-CARTONS      18230000
182400                     PERFORM                                      18240000
182500                     VARYING PT-EXPT-IDX                          18250000
182600                        FROM 1 BY 1                               18260000
182700                       UNTIL PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES18270000
182800                          IF PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)     18280000
182900                                 >  0 AND                         18290000
183000                             PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)     18300000
183100                                 >= PV-UCC128-MIN-OTPK            18310000
183200                                 PERFORM 4190-SML-INPK-PARTIAL    18320000
183300                                 PERFORM 4200-GET-MAX-MIN-NEEDED  18330000
183400                         END-IF                                   18340000
183500                     END-PERFORM                                  18350000
183600             END-PERFORM                                          18360000
183700         END-IF                                                   18370000
183800     END-IF                                                       18380000
183900     END-IF.                                                      18390000
184000                                                                  18400000
184100* PROCESS STORE EXPECTED TABLE TO SEE IF STORES STILL NEED        18410000
184200* ALLOCATIONS.  THESE WILL BE SENT TO P2L.                        18420000
184300                                                                  18430000
184400     MOVE  ZEROES  TO  PV-P2L-QTY-NEEDED.                         18440000
184500     PERFORM                                                      18450000
184600       VARYING PT-EXPT-IDX                                        18460000
184700          FROM 1 BY 1                                             18470000
184800         UNTIL PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES              18480000
184900            IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) > 0              18490000
185000                ADD  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)             18500000
185100                 TO  PV-P2L-QTY-NEEDED                            18510000
185200            END-IF                                                18520000
185300     END-PERFORM                                                  18530000
185400                                                                  18540000
185500     IF  PV-P2L-QTY-NEEDED  >  0                                  18550000
185600         PERFORM 4300-SPLIT-P2L-UNITS                             18560000
185700     END-IF.                                                      18570000
185800                                                                  18580000
185900                                                                  18590000
186000*================================================================*18600000
186100* CALCULATE LABEL COUNT - STORE ORDER SEQUENCE                   *18610000
186200*================================================================*18620000
186300 3100-STORE-SEQUENCE.                                             18630000
186400                                                                  18640000
186500     PERFORM 4200-GET-MAX-MIN-NEEDED.                             18650000
186600                                                                  18660000
186700* PROCESS STORE EXPECTED TABLE TO SEE IF STORES ALLOCATION CAN BE 18670000
186800* PARTIALLY FILLED BY FULLCASE - BASED ON UCC128 DATA TABLE.      18680000
186900                                                                  18690000
187000     IF  PV-NEEDED-MAX-OTPK >  ZERO  AND                          18700000
187100         PV-NEEDED-MAX-OTPK >= PV-UCC128-MIN-OTPK                 18710000
187200         PERFORM                                                  18720000
187300           UNTIL PV-NEEDED-MAX-OTPK < PV-UCC128-MIN-OTPK          18730000
187400              OR PV-FCSE-ALLOCATED  =  PC166-TOTAL-CARTONS        18740000
187500              OR PV-UCC128-MIN-OTPK =  ZEROES                     18750000
187600                 PERFORM                                          18760000
187700                 VARYING  PT-EXPT-IDX                             18770000
187800                    FROM  1 BY 1                                  18780000
187900                   UNTIL  PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES   18790000
188000                      IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) > 0    18800000
188100                          PERFORM                                 18810000
188200                            UNTIL PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)18820000
188300                                  = 0                             18830000
188400                               OR PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)18840000
188500                                  <  PV-UCC128-MIN-OTPK           18850000
188600                               OR (PV-UCC128-MIN-OTPK  =  0  AND  18860000
188700                                   PV-UCC128-MAX-OTPK  =  0)      18870000
188800                               OR  PS-ERROR                       18880000
188900                                  PERFORM 4170-SML-FCSE-PARTIAL   18890000
189000                          END-PERFORM                             18900000
189100                      END-IF                                      18910000
189200                 END-PERFORM                                      18920000
189300                 PERFORM 4200-GET-MAX-MIN-NEEDED                  18930000
189400         END-PERFORM                                              18940000
189500     END-IF.                                                      18950000
189600                                                                  18960000
189700* PROCESS STORE EXPECTED TABLE TO SEE IF STORES ALLOCATION CAN BE 18970000
189800* PARTIALLY FILLED BY INNER-PACKS - BASED ON UCC128 DATA TABLE.   18980000
189900* ONLY IF INNERPACK CONVEYABLE                                    18990000
190000                                                                  19000000
190100     IF  PV-NEEDED-MAX-OTPK =  ZERO  OR                           19010000
190200         PV-FCSE-ALLOCATED  =  PC166-TOTAL-CARTONS                19020000
190300         CONTINUE                                                 19030000
190400     ELSE                                                         19040000
190500     IF  PC166-INPK-CNVY-YES                                      19050000
190600         MOVE  PC166-INPK-UNT-QTY  TO  PV-UCC128-MIN-OTPK         19060000
190700                                       PV-UCC128-MAX-OTPK         19070000
190800         PERFORM 4200-GET-MAX-MIN-NEEDED                          19080000
190900         IF  PV-NEEDED-MAX-OTPK  >=  PV-UCC128-MIN-OTPK           19090000
191000             PERFORM                                              19100000
191100               UNTIL PV-NEEDED-MAX-OTPK < PV-UCC128-MIN-OTPK      19110000
191200                  OR PV-FCSE-ALLOCATED  = PC166-TOTAL-CARTONS     19120000
191300                     PERFORM                                      19130000
191400                     VARYING PT-EXPT-IDX                          19140000
191500                        FROM 1 BY 1                               19150000
191600                       UNTIL PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES19160000
191700                          IF PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)     19170000
191800                                 >  0 AND                         19180000
191900                             PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)     19190000
192000                                 >= PV-UCC128-MIN-OTPK            19200000
192100                                 PERFORM                          19210000
192200                                   UNTIL PT-EXPT-NEEDED-QTY       19220000
192300                                         (PT-EXPT-IDX) = 0        19230000
192400                                      OR PT-EXPT-NEEDED-QTY       19240000
192500                                         (PT-EXPT-IDX) <          19250000
192600                                             PV-UCC128-MIN-OTPK   19260000
192700                                         PERFORM                  19270000
192800                                            4190-SML-INPK-PARTIAL 19280000
192900                                 END-PERFORM                      19290000
193000                                 PERFORM 4200-GET-MAX-MIN-NEEDED  19300000
193100                         END-IF                                   19310000
193200                     END-PERFORM                                  19320000
193300             END-PERFORM                                          19330000
193400         END-IF                                                   19340000
193500     END-IF                                                       19350000
193600     END-IF.                                                      19360000
193700                                                                  19370000
193800* PROCESS STORE EXPECTED TABLE TO SEE IF STORES STILL NEED        19380000
193900* ALLOCATIONS.  THESE WILL BE SENT TO P2L.                        19390000
194000                                                                  19400000
194100     MOVE  ZEROES  TO  PV-P2L-QTY-NEEDED.                         19410000
194200     PERFORM                                                      19420000
194300       VARYING PT-EXPT-IDX                                        19430000
194400          FROM 1 BY 1                                             19440000
194500         UNTIL PT-EXPT-IDX > PV-EXPECT-TABLE-ENTRIES              19450000
194600            IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) > 0              19460000
194700                ADD  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)             19470000
194800                 TO  PV-P2L-QTY-NEEDED                            19480000
194900            END-IF                                                19490000
195000     END-PERFORM                                                  19500000
195100                                                                  19510000
195200     IF  PV-P2L-QTY-NEEDED  >  0                                  19520000
195300         PERFORM 4300-SPLIT-P2L-UNITS                             19530000
195400     END-IF.                                                      19540000
195500                                                                  19550000
195600                                                                  19560000
195700*================================================================*19570000
195800* CHECK TO SEE IF ALLOCATION CAN BE FILLED COMPLETELY BY 1 FCSE  *19580000
195900*================================================================*19590000
196000 4000-SML-FULLCASE-MATCH.                                         19600000
196100                                                                  19610000
196200* DISTRIBUTION CENTER ALLOCATION                                  19620000
196300                                                                  19630000
196400     PERFORM                                                      19640000
196500        WITH TEST AFTER                                           19650000
196600        VARYING PT-EXPT-IDX                                       19660000
196700           FROM 1  BY  1                                          19670000
196800          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           19680000
196900                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) >=           19690000
197000                    PV-UCC128-MIN-OTPK                  AND       19700000
197100                    PT-EXPT-STR-TYP (PT-EXPT-IDX)  =  'DC'        19710000
197200                    PERFORM 4100-SML-DC-RV                        19720000
197300                END-IF                                            19730000
197400     END-PERFORM.                                                 19740000
197500                                                                  19750000
197600* RETURN TO VENDOR ALLOCATION                                     19760000
197700                                                                  19770000
197800     PERFORM                                                      19780000
197900        WITH TEST AFTER                                           19790000
198000        VARYING PT-EXPT-IDX                                       19800000
198100           FROM 1  BY  1                                          19810000
198200          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           19820000
198300                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) >=           19830000
198400                    PV-UCC128-MIN-OTPK                  AND       19840000
198500                    PT-EXPT-STR-TYP (PT-EXPT-IDX)  =  'RV'        19850000
198600                    PERFORM 4100-SML-DC-RV                        19860000
198700                END-IF                                            19870000
198800     END-PERFORM.                                                 19880000
198900                                                                  19890000
199000* CENTRAL STOCK ALLOCATION                                        19900000
199100                                                                  19910000
199200     PERFORM                                                      19920000
199300        WITH TEST AFTER                                           19930000
199400        VARYING PT-EXPT-IDX                                       19940000
199500           FROM 1  BY  1                                          19950000
199600          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           19960000
199700                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) >=           19970000
199800                    PV-UCC128-MIN-OTPK                  AND       19980000
199900                   (PT-EXPT-CENTRL-STCK (PT-EXPT-IDX) OR          19990000
200000                    PT-EXPT-E-COMMERCE  (PT-EXPT-IDX))            20000000
200100                    PERFORM 4120-SML-CS                           20010000
200200                END-IF                                            20020000
200300     END-PERFORM.                                                 20030000
200400                                                                  20040000
200500******************************************************************20050000
200600 4010-SML-FULLCASE-MATCH-STR.                                     20060000
200700******************************************************************20070000
200800* STORE ALLOCATION                                                20080000
200900                                                                  20090000
201000     PERFORM                                                      20100000
201100        WITH TEST AFTER                                           20110000
201200        VARYING PT-EXPT-IDX                                       20120000
201300           FROM 1  BY  1                                          20130000
201400          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           20140000
201500                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX) >=           20150000
201600                    PV-UCC128-MIN-OTPK                            20160000
201700                    PERFORM 4150-SML-FCSE-MATCH                   20170000
201800                END-IF                                            20180000
201900     END-PERFORM.                                                 20190000
202000                                                                  20200000
202100                                                                  20210000
202200                                                                  20220000
202300*================================================================*20230000
202400* PROCESS DISTRIBUTION CENTER & RETURN TO VENDOR FULLCASE MATCH  *20240000
202500*================================================================*20250000
202600 4100-SML-DC-RV.                                                  20260000
202700                                                                  20270000
202800     PERFORM 4150-SML-FCSE-MATCH.                                 20280000
202900     IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >  0                   20290000
203000         PERFORM                                                  20300000
203100           UNTIL PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  =  0           20310000
203200              OR PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  <              20320000
203300                 PV-UCC128-MIN-OTPK                               20330000
203400              OR PS-ERROR                                         20340000
203500              OR PV-UCC128-MIN-OTPK = 0                           20350000
203600                 PERFORM 4170-SML-FCSE-PARTIAL                    20360000
203700         END-PERFORM                                              20370000
203800     END-IF.                                                      20380000
203900     PERFORM 4200-GET-MAX-MIN-NEEDED.                             20390000
204000                                                                  20400000
204100                                                                  20410000
204200*================================================================*20420000
204300* PROCESS CENTRAL STOCK - FULLCASE MATCH                         *20430000
204400*================================================================*20440000
204500 4120-SML-CS.                                                     20450000
204600                                                                  20460000
204700     PERFORM 4150-SML-FCSE-MATCH.                                 20470000
204800     IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >  0                   20480000
204900         PERFORM                                                  20490000
205000           UNTIL PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  =  0           20500000
205100              OR PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  <              20510000
205200                 PV-UCC128-MIN-OTPK                               20520000
205300              OR  PS-ERROR                                        20530000
205310* DMH 11/19/04 - BEGIN                                            20531021
205320              OR (PV-UCC128-MIN-OTPK  =  ZERO  AND                20532021
205330                  PV-UCC128-MAX-OTPK  =  ZERO)                    20533021
205340* DMH 11/19/04 - BEGIN                                            20534021
205400                 PERFORM 4170-SML-FCSE-PARTIAL                    20540000
205500         END-PERFORM                                              20550000
205600     END-IF.                                                      20560000
205700                                                                  20570000
205800     IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >  0  AND              20580000
205900         PC166-INPK-CNVY-YES                                      20590000
206000         MOVE  PC166-INPK-UNT-QTY  TO  PV-UCC128-MIN-OTPK         20600000
206100                                       PV-UCC128-MAX-OTPK         20610000
206200         IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >=                 20620000
206300                  PV-UCC128-MIN-OTPK                              20630000
206400             PERFORM                                              20640000
206500               UNTIL PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  =  0       20650000
206600                  OR PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  <          20660000
206700                     PV-UCC128-MIN-OTPK                           20670000
206800                     PERFORM 4190-SML-INPK-PARTIAL                20680000
206900             END-PERFORM                                          20690000
207000     END-IF.                                                      20700000
207100     PERFORM 4200-GET-MAX-MIN-NEEDED.                             20710000
207200     PERFORM 4220-GET-NEW-MAX-MIN-OTPK.                           20720000
207300                                                                  20730000
207400                                                                  20740000
207500*================================================================*20750000
207600* PROCESS STORE - FULLCASE MATCH                                 *20760000
207700*================================================================*20770000
207800 4150-SML-FCSE-MATCH.                                             20780000
207900                                                                  20790000
208000     SET  PS-NOT-UCC128-FCSE-MATCH  TO  TRUE.                     20800000
208100                                                                  20810000
208200     PERFORM                                                      20820000
208300        VARYING PT-U128-IDX                                       20830000
208400           FROM 1 BY 1                                            20840000
208500          UNTIL PT-U128-IDX    >  PV-UCC128-TABLE-ENTRIES         20850000
208600             OR PS-UCC128-FCSE-MATCH                              20860000
208700            IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  =               20870000
208800                PT-UCC128-OTPK (PT-U128-IDX)           AND        20880000
208900                PT-UCC128-CRTNS (PT-U128-IDX)  >  0               20890000
209000                    MOVE PT-EXPT-EXPTED-QTY (PT-EXPT-IDX)         20900000
209100                      TO PT-EXPT-ALLOC-QTY  (PT-EXPT-IDX)         20910000
209200                    ADD  1  TO  PV-FCSE-ALLOCATED                 20920000
209300                                PT-EXPT-FCSE-CNT (PT-EXPT-IDX)    20930000
209400                                PV-CARTON-NBR                     20940000
209500                                PV-MSTR-CARTON-NBR                20950000
209600                    ADD  PT-UCC128-OTPK (PT-U128-IDX)             20960000
209700                             TO PT-EXPT-FCSE-UNTS (PT-EXPT-IDX)   20970000
209800                    MOVE ZEROES                                   20980000
209900                      TO PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)         20990000
210000                    SUBTRACT 1                                    21000000
210100                         FROM PT-UCC128-CRTNS (PT-U128-IDX)       21010000
210200                    SET  PS-UCC128-FCSE-MATCH                     21020000
210300                         PS-CARTON-USE-FCSE                       21030000
210400                         PS-CARTON-LABEL-SML                      21040000
210500                         PS-CARTON-MASTER-YES  TO  TRUE           21050000
210600                    PERFORM 5000-CARTON-TABLE-ENTRY               21060000
210700                    IF  (PT-UCC128-OTPK (PT-U128-IDX)             21070000
210800                                        =  PV-UCC128-MIN-OTPK  OR 21080000
210900                         PT-UCC128-OTPK (PT-U128-IDX)             21090000
211000                                        =  PV-UCC128-MAX-OTPK) AND21100000
211100                         PT-UCC128-CRTNS (PT-U128-IDX)    =  0    21110000
211200                         PERFORM 4220-GET-NEW-MAX-MIN-OTPK        21120000
211300                     END-IF                                       21130000
211400            ELSE                                                  21140000
211500                IF  PT-UCC128-CRTNS (PT-U128-IDX)     >  0  AND   21150000
211600                    PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >           21160000
211700                    PT-UCC128-OTPK (PT-U128-IDX)           AND    21170000
211800                    PT-UCC128-CRTNS (PT-U128-IDX)  >  0           21180000
211900                    AND  PS-NO-ERROR                              21190000
212000                    SUBTRACT PT-UCC128-OTPK (PT-U128-IDX)         21200000
212100                        FROM PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)     21210000
212200                    ADD  PT-UCC128-OTPK (PT-U128-IDX)             21220000
212300                      TO PT-EXPT-ALLOC-QTY  (PT-EXPT-IDX)         21230000
212400                    ADD  1  TO  PV-FCSE-ALLOCATED                 21240000
212500                                PT-EXPT-FCSE-CNT (PT-EXPT-IDX)    21250000
212600                                PV-CARTON-NBR                     21260000
212700                                PV-MSTR-CARTON-NBR                21270000
212800                    ADD  PT-UCC128-OTPK (PT-U128-IDX)             21280000
212900                             TO PT-EXPT-FCSE-UNTS (PT-EXPT-IDX)   21290000
213000                    SUBTRACT 1                                    21300000
213100                         FROM PT-UCC128-CRTNS (PT-U128-IDX)       21310000
213200                    SET  PS-UCC128-FCSE-PARTIAL                   21320000
213300                         PS-CARTON-USE-FCSE                       21330000
213400                         PS-CARTON-LABEL-SML                      21340000
213500                         PS-CARTON-MASTER-YES    TO  TRUE         21350000
213600                    PERFORM 5000-CARTON-TABLE-ENTRY               21360000
213700                    IF  (PT-UCC128-OTPK (PT-U128-IDX)             21370000
213800                                        =  PV-UCC128-MIN-OTPK  OR 21380000
213900                         PT-UCC128-OTPK (PT-U128-IDX)             21390000
214000                                        =  PV-UCC128-MAX-OTPK) AND21400000
214100                         PT-UCC128-CRTNS (PT-U128-IDX)    =  0    21410000
214200                         PERFORM 4220-GET-NEW-MAX-MIN-OTPK        21420000
214300                    END-IF                                        21430000
214400                END-IF                                            21440000
214500            END-IF                                                21450000
214600     END-PERFORM.                                                 21460000
214700                                                                  21470000
214800                                                                  21480000
214900*================================================================*21490000
215000* PROCESS STORE - FULLCASE MATCH (PARTIAL ALLOCATION)            *21500000
215100*================================================================*21510000
215200 4170-SML-FCSE-PARTIAL.                                           21520000
215300                                                                  21530000
215400     SET  PS-NOT-UCC128-FCSE-PARTIAL  TO  TRUE.                   21540000
215500                                                                  21550000
215600     PERFORM                                                      21560000
215700        WITH TEST AFTER                                           21570000
215800        VARYING PT-U128-IDX                                       21580000
215900           FROM 1 BY 1                                            21590000
216000          UNTIL PT-U128-IDX    >  PV-UCC128-TABLE-ENTRIES         21600000
216100             OR PS-UCC128-FCSE-PARTIAL                            21610000
216200             OR PS-ERROR                                          21620000
216300                IF  PT-UCC128-CRTNS (PT-U128-IDX)     >  0  AND   21630000
216400                    PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >=          21640000
216500                    PT-UCC128-OTPK (PT-U128-IDX)           AND    21650000
216600                    PT-UCC128-CRTNS (PT-U128-IDX)  >  0           21660000
216700                    AND  PS-NO-ERROR                              21670000
216800                    SUBTRACT PT-UCC128-OTPK (PT-U128-IDX)         21680000
216900                        FROM PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)     21690000
217000                    ADD  PT-UCC128-OTPK (PT-U128-IDX)             21700000
217100                      TO PT-EXPT-ALLOC-QTY  (PT-EXPT-IDX)         21710000
217200                    ADD  1  TO  PV-FCSE-ALLOCATED                 21720000
217300                                PT-EXPT-FCSE-CNT (PT-EXPT-IDX)    21730000
217400                                PV-CARTON-NBR                     21740000
217500                                PV-MSTR-CARTON-NBR                21750000
217600                    ADD  PT-UCC128-OTPK (PT-U128-IDX)             21760000
217700                             TO PT-EXPT-FCSE-UNTS (PT-EXPT-IDX)   21770000
217800                    SUBTRACT 1                                    21780000
217900                         FROM PT-UCC128-CRTNS (PT-U128-IDX)       21790000
218000                    SET  PS-UCC128-FCSE-PARTIAL                   21800000
218100                         PS-CARTON-USE-FCSE                       21810000
218200                         PS-CARTON-LABEL-SML                      21820000
218300                         PS-CARTON-MASTER-YES    TO  TRUE         21830000
218400                    PERFORM 5000-CARTON-TABLE-ENTRY               21840000
218500                    IF  (PT-UCC128-OTPK (PT-U128-IDX)             21850000
218600                                        =  PV-UCC128-MIN-OTPK  OR 21860000
218700                         PT-UCC128-OTPK (PT-U128-IDX)             21870000
218800                                        =  PV-UCC128-MAX-OTPK) AND21880000
218900                         PT-UCC128-CRTNS (PT-U128-IDX)    =  0    21890000
219000                         PERFORM 4220-GET-NEW-MAX-MIN-OTPK        21900000
219100                     END-IF                                       21910000
219200                 END-IF                                           21920000
219300     END-PERFORM.                                                 21930000
219400                                                                  21940000
219500                                                                  21950000
219600*================================================================*21960000
219700* PROCESS STORE - INNER PACK MATCH (PARTIAL ALLOCATION)          *21970000
219800*================================================================*21980000
219900 4190-SML-INPK-PARTIAL.                                           21990000
220000                                                                  22000000
220100     IF  PV-NBR-OF-INPKS  =  ZERO                                 22010000
220200         PERFORM                                                  22020000
220300            WITH TEST AFTER                                       22030000
220400            VARYING PT-U128-IDX                                   22040000
220500               FROM 1 BY 1                                        22050000
220600              UNTIL PT-U128-IDX      >  PV-UCC128-TABLE-ENTRIES   22060000
220700                 OR PV-NBR-OF-INPKS  >  ZERO                      22070000
220800                    IF  PT-UCC128-CRTNS (PT-U128-IDX)    >  0     22080000
220900                                                                  22090000
221000                      IF PC166-INPK-UNT-QTY  >  0                 22100000
221100                        DIVIDE  PT-UCC128-OTPK (PT-U128-IDX)      22110000
221200                            BY  PC166-INPK-UNT-QTY                22120000
221300                        GIVING  PV-NBR-OF-INPKS                   22130000
221400                      ELSE                                        22140000
221500                        MOVE  ZEROES  TO  PV-NBR-OF-INPKS         22150000
221600                      END-IF                                      22160000
221700                                                                  22170000
221800                        ADD  1  TO  PV-MSTR-CARTON-NBR            22180000
221900                        SET  PS-CARTON-MASTER-YES  TO  TRUE       22190000
222000                    END-IF                                        22200000
222100         END-PERFORM                                              22210000
222200     ELSE                                                         22220000
222300         SET  PS-CARTON-MASTER-NO   TO  TRUE                      22230000
222400     END-IF.                                                      22240000
222500                                                                  22250000
222600     IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >=                     22260000
222700         PC166-INPK-UNT-QTY                                       22270000
222800         SUBTRACT PC166-INPK-UNT-QTY                              22280000
222900             FROM PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)                22290000
223000         ADD  PC166-INPK-UNT-QTY                                  22300000
223100          TO PT-EXPT-ALLOC-QTY  (PT-EXPT-IDX)                     22310000
223200         ADD  1  TO  PT-EXPT-INPK-CNT (PT-EXPT-IDX)               22320000
223300         ADD  1  TO  PV-CARTON-NBR                                22330000
223400         ADD  PC166-INPK-UNT-QTY                                  22340000
223500                 TO PT-EXPT-INPK-UNTS (PT-EXPT-IDX)               22350000
223600         SUBTRACT 1                                               22360000
223700             FROM PV-NBR-OF-INPKS                                 22370000
223800         IF  PV-NBR-OF-INPKS  =  ZERO                             22380000
223900             ADD  1  TO PV-FCSE-ALLOCATED                         22390000
224000             SUBTRACT  1                                          22400000
224100                 FROM  PT-UCC128-CRTNS (PT-U128-IDX)              22410000
224200         END-IF                                                   22420000
224300         SET PS-CARTON-USE-INPK                                   22430000
224400             PS-CARTON-LABEL-SML TO  TRUE                         22440000
224500         PERFORM 5000-CARTON-TABLE-ENTRY                          22450000
224600     END-IF.                                                      22460000
224700                                                                  22470000
224800                                                                  22480000
224900*================================================================*22490000
225000* DETERMINE THE MAX & MIN OTPK NEEDED IN EXPTED TABLE            *22500000
225100*================================================================*22510000
225200 4200-GET-MAX-MIN-NEEDED.                                         22520000
225300                                                                  22530000
225400     MOVE  ZEROES  TO  PV-NEEDED-MIN-OTPK                         22540000
225500                       PV-NEEDED-MAX-OTPK.                        22550000
225600                                                                  22560000
225700     PERFORM                                                      22570000
225800        VARYING PT-EXPT-IDX                                       22580000
225900           FROM 1 BY 1                                            22590000
226000          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           22600000
226100                IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)  >  0        22610000
226200                    IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)          22620000
226300                          >  PV-NEEDED-MAX-OTPK                   22630000
226400                        MOVE  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)    22640000
226500                          TO  PV-NEEDED-MAX-OTPK                  22650000
226600                    END-IF                                        22660000
226700                    IF  PV-NEEDED-MIN-OTPK  =  ZERO               22670000
226800                        MOVE  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)    22680000
226900                          TO  PV-NEEDED-MIN-OTPK                  22690000
227000                    ELSE                                          22700000
227100                    IF  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)          22710000
227200                           <  PV-NEEDED-MIN-OTPK                  22720000
227300                        MOVE  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)    22730000
227400                          TO  PV-NEEDED-MIN-OTPK                  22740000
227500                    END-IF                                        22750000
227600                    END-IF                                        22760000
227700                END-IF                                            22770000
227800     END-PERFORM.                                                 22780000
227900                                                                  22790000
228000                                                                  22800000
228100*================================================================*22810000
228200* GET THE NEW OTPK MAX AND OTPK MIN FROM THE UCC128 OTPK TABLE   *22820000
228300*================================================================*22830000
228400 4220-GET-NEW-MAX-MIN-OTPK.                                       22840000
228500                                                                  22850000
228600     MOVE  ZEROES  TO  PV-UCC128-MIN-OTPK                         22860000
228700                       PV-UCC128-MAX-OTPK.                        22870000
228800                                                                  22880000
228900     PERFORM                                                      22890000
229000        VARYING PT-U128-IDX                                       22900000
229100           FROM 1 BY 1                                            22910000
229200          UNTIL PT-U128-IDX > PV-UCC128-TABLE-ENTRIES             22920000
229300                IF  PT-UCC128-CRTNS (PT-U128-IDX)    >  0         22930000
229400                    IF  PT-UCC128-OTPK (PT-U128-IDX)              22940000
229500                          >  PV-UCC128-MAX-OTPK                   22950000
229600                        MOVE  PT-UCC128-OTPK (PT-U128-IDX)        22960000
229700                          TO  PV-UCC128-MAX-OTPK                  22970000
229800                    END-IF                                        22980000
229900                    IF  PV-UCC128-MIN-OTPK  =  ZERO               22990000
230000                        MOVE  PT-UCC128-OTPK (PT-U128-IDX)        23000000
230100                          TO  PV-UCC128-MIN-OTPK                  23010000
230200                    ELSE                                          23020000
230300                    IF  PT-UCC128-OTPK (PT-U128-IDX)              23030000
230400                           < PV-UCC128-MIN-OTPK                   23040000
230500                        MOVE  PT-UCC128-OTPK (PT-U128-IDX)        23050000
230600                          TO  PV-UCC128-MIN-OTPK                  23060000
230700                    END-IF                                        23070000
230800                    END-IF                                        23080000
230900                END-IF                                            23090000
231000     END-PERFORM.                                                 23100000
231100                                                                  23110000
231200                                                                  23120000
231300*================================================================*23130000
231400* REMAINING CARTONS/UNITS WILL BE ASSIGNED TO P2L.               *23140000
231500*================================================================*23150000
231600 4300-SPLIT-P2L-UNITS.                                            23160000
231700                                                                  23170000
231800     PERFORM                                                      23180000
231900       VARYING PT-EXPT-IDX                                        23190000
232000          FROM 1 BY 1                                             23200000
232100         UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES            23210000
232200               ADD  PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)              23220000
232300                TO  PT-EXPT-ALLOC-QTY  (PT-EXPT-IDX)              23230000
232400               MOVE PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)              23240000
232500                 TO PT-EXPT-P2L-UNTS   (PT-EXPT-IDX)              23250000
232600               MOVE ZEROES                                        23260000
232700                 TO PT-EXPT-NEEDED-QTY (PT-EXPT-IDX)              23270000
232800     END-PERFORM.                                                 23280000
232900                                                                  23290000
233000     IF  PC166-INPK-CNVY-YES  AND                                 23300000
233100         PV-NBR-OF-INPKS  >  0                                    23310000
233200         PERFORM                                                  23320000
233300           UNTIL PV-NBR-OF-INPKS  =  0                            23330000
233400                 SUBTRACT  PC166-INPK-UNT-QTY                     23340000
233500                     FROM  PV-P2L-QTY-NEEDED                      23350000
233600                 SUBTRACT  1                                      23360000
233700                     FROM  PV-NBR-OF-INPKS                        23370000
233800                 IF  PV-NBR-OF-INPKS  =  0                        23380000
233900                     ADD  1  TO PV-FCSE-ALLOCATED                 23390000
234000                     SUBTRACT  1                                  23400000
234100                         FROM  PT-UCC128-CRTNS (PT-U128-IDX)      23410000
234200                 END-IF                                           23420000
234300                 SET  PS-CARTON-USE-INPK                          23430000
234400                      PS-CARTON-LABEL-P2L                         23440000
234500                      PS-CARTON-MASTER-NO TO  TRUE                23450000
234600                 PERFORM 5000-CARTON-TABLE-ENTRY                  23460000
234700         END-PERFORM                                              23470000
234800     END-IF.                                                      23480000
234900                                                                  23490000
235000*** DMH 8/11/2004 - BEGIN                                         23500010
235100     IF  PV-P2L-QTY-NEEDED  >  ZERO  AND                          23510010
235200         PV-UCC128-MAX-OTPK =  0                                  23520012
235300         SET  PS-ERROR                                            23530010
235400              PC166-PREPK-UCC128-NO  TO  TRUE                     23540011
235500         MOVE ZEROES  TO  PC166-TOTAL-CARTONS                     23550012
235600                          PC166-OTPK-UNT-QTY                      23560012
235700                          PC166-INPK-UNT-QTY                      23570012
235800                          PC166-FCSE-LBL-CNT                      23580012
235900                          PC166-INPK-LBL-CNT                      23590012
236000                          PC166-P2L-LBL-CNT                       23600012
236100     ELSE                                                         23610010
236200*** DMH 8/11/2004 - END                                           23620010
236300                                                                  23630010
236400     IF  PV-P2L-QTY-NEEDED  >  ZERO                               23640000
236500         PERFORM                                                  23650000
236600           WITH TEST AFTER                                        23660000
236700           UNTIL PV-P2L-QTY-NEEDED <= 0  OR                       23670000
236800                 PT-U128-IDX > PV-UCC128-TABLE-ENTRIES            23680000
236900                 PERFORM                                          23690000
237000                   WITH TEST AFTER                                23700000
237100                   VARYING PT-U128-IDX                            23710000
237200                      FROM 1 BY 1                                 23720000
237300                     UNTIL PT-U128-IDX > PV-UCC128-TABLE-ENTRIES  23730000
237400                        IF  PT-UCC128-CRTNS (PT-U128-IDX) > 0     23740000
237500                            PERFORM                               23750000
237600                              UNTIL PT-UCC128-CRTNS (PT-U128-IDX) 23760000
237700                                    = 0                           23770000
237800                                    SUBTRACT PT-UCC128-OTPK       23780000
237900                                             (PT-U128-IDX)        23790000
238000                                        FROM PV-P2L-QTY-NEEDED    23800000
238100                                    SUBTRACT 1                    23810000
238200                                        FROM PT-UCC128-CRTNS      23820000
238300                                             (PT-U128-IDX)        23830000
238400                                    SET  PS-CARTON-USE-FCSE       23840000
238500                                         PS-CARTON-LABEL-P2L      23850000
238600                                    PS-CARTON-MASTER-YES          23860000
238700                                                      TO  TRUE    23870000
238800                                    PERFORM                       23880000
238900                                          5000-CARTON-TABLE-ENTRY 23890000
239000                            END-PERFORM                           23900000
239100                        END-IF                                    23910000
239200                 END-PERFORM                                      23920000
239300         END-PERFORM                                              23930000
239400     END-IF                                                       23940010
239500     END-IF.                                                      23950010
239600                                                                  23960000
239700                                                                  23970000
239800*================================================================*23980000
239900* CREATE TABLE ENTRY FOR CARTON JUST ASSIGNED.  THIS TABLE WILL  *23990000
240000* BE USED TO CREATE THE VIRTUAL TABLE.                           *24000000
240100*================================================================*24010000
240200 5000-CARTON-TABLE-ENTRY.                                         24020000
240300                                                                  24030000
240400     IF  PS-CARTON-MASTER-YES                                     24040000
240500         MOVE PC-M            TO PT-CRTN-MSTR (PT-CRTN-IDX)       24050000
240600     ELSE                                                         24060000
240700         MOVE PC-I            TO PT-CRTN-MSTR (PT-CRTN-IDX)       24070000
240800     END-IF.                                                      24080000
240900                                                                  24090000
241000     IF  PS-CARTON-LABEL-P2L                                      24100000
241100         MOVE PC166-OPER-UNT-ID                                   24110000
241200           TO  PT-CRTN-STORE-NBR  (PT-CRTN-IDX)                   24120000
241300         MOVE  'DC'                                               24130000
241400           TO  PT-CRTN-STORE-TYP  (PT-CRTN-IDX)                   24140000
241500         MOVE  PT-EXPT-SEASET-IND     (PT-EXPT-IDX)               24150000
241600           TO  PT-CRTN-SEASET-IND     (PT-CRTN-IDX)               24160000
241700         SET   PT-CRTN-P2L (PT-CRTN-IDX)  TO  TRUE                24170000
241800     ELSE                                                         24180000
241900         MOVE  PT-EXPT-STR-NBR        (PT-EXPT-IDX)               24190000
242000           TO  PT-CRTN-STORE-NBR      (PT-CRTN-IDX)               24200000
242100         MOVE  PT-EXPT-STR-TYP        (PT-EXPT-IDX)               24210000
242200           TO  PT-CRTN-STORE-TYP      (PT-CRTN-IDX)               24220000
242300         MOVE  PT-EXPT-E-COMMERCE-IND (PT-EXPT-IDX)               24230000
242400           TO  PT-CRTN-E-COMMERCE-IND (PT-CRTN-IDX)               24240000
242500         MOVE  PT-EXPT-SEASET-IND     (PT-EXPT-IDX)               24250000
242600           TO  PT-CRTN-SEASET-IND     (PT-CRTN-IDX)               24260000
242700         MOVE  PT-EXPT-FIXT-ID        (PT-EXPT-IDX)               24270000
242800           TO  PT-CRTN-FIXT-ID        (PT-CRTN-IDX)               24280000
242900         MOVE  PT-EXPT-SEASONAL-SET   (PT-EXPT-IDX)               24290000
243000           TO  PT-CRTN-SEASONAL-SET   (PT-CRTN-IDX)               24300000
243010         MOVE  PT-EXPT-PRESENTATION-IND (PT-EXPT-IDX)             24301031
243020           TO  PT-CRTN-PRESENTATION-IND (PT-CRTN-IDX)             24302031
243030         MOVE  PT-EXPT-EAS-TAG-IND (PT-EXPT-IDX)                  24303032
243040           TO  PT-CRTN-EAS-TAG-IND (PT-CRTN-IDX)                  24304032
243050         MOVE  PT-EXPT-DOOR-ID     (PT-EXPT-IDX)                  24305038
243060           TO  PT-CRTN-DOOR-ID     (PT-CRTN-IDX)                  24306038
243070         MOVE  PT-EXPT-MERCHANDISE-PGM (PT-EXPT-IDX)              24307055
243080           TO  PT-CRTN-MERCHANDISE-PGM (PT-CRTN-IDX)              24308055
243100         SET   PT-CRTN-SML (PT-CRTN-IDX)  TO  TRUE                24310000
243200     END-IF.                                                      24320000
243300                                                                  24330000
243400     MOVE PT-UCC128-OTPK (PT-U128-IDX)                            24340000
243500       TO PT-CRTN-OTPK-QTY (PT-CRTN-IDX).                         24350000
243600                                                                  24360000
243700     IF  PS-CARTON-USE-FCSE                                       24370000
243800         SET  PT-CRTN-FCSE-SML (PT-CRTN-IDX)  TO  TRUE            24380000
243900         MOVE PV-CARTON-NBR                                       24390000
244000          TO  PT-CRTN-MSTR-CRTN (PT-CRTN-IDX)                     24400000
244100     ELSE                                                         24410000
244200     IF  PS-CARTON-USE-INPK                                       24420000
244300         SET  PT-CRTN-INPK-SML (PT-CRTN-IDX)  TO  TRUE            24430000
244400         MOVE PV-MSTR-CARTON-NBR                                  24440000
244500          TO  PT-CRTN-MSTR-CRTN (PT-CRTN-IDX)                     24450000
244600     END-IF                                                       24460000
244700     END-IF.                                                      24470000
244800                                                                  24480000
244900     ADD +1                   TO PV-CARTON-TABLE-ENTRIES.         24490000
245000     SET  PT-CRTN-IDX UP BY 1.                                    24500000
245100                                                                  24510000
245200                                                                  24520000
245300*================================================================*24530000
245400* GET START MANIFEST NUMBER FOR EACH ENTRY IN TABLE              *24540000
245500*================================================================*24550000
245600 5050-GET-MANIFEST-NBRS.                                          24560000
245700                                                                  24570000
245800     PERFORM                                                      24580000
245900         VARYING PT-CRTN-IDX                                      24590000
246000            FROM 1 BY 1                                           24600000
246100            UNTIL PT-CRTN-IDX  >  PV-CARTON-TABLE-ENTRIES OR      24610000
246200                  PT-CRTN-IDX  >  PC-MAX-CARTON-TBL-ENTRY         24620000
246300            IF  PT-CRTN-SML        (PT-CRTN-IDX)                  24630000
246400                PERFORM 5435-MANIFEST-NBR                         24640000
246500            END-IF                                                24650000
246600     END-PERFORM.                                                 24660000
246700                                                                  24670000
246800                                                                  24680000
246900*================================================================*24690000
247000* CREATE ENTRIES IN VIRTUAL LABEL TABLE                          *24700000
247100*================================================================*24710000
247200 5100-CREATE-VRTL-LABEL.                                          24720000
247300                                                                  24730000
247400     MOVE  ZEROES  TO  LBVRDA-LBL-ASG-SEQ-NBR.                    24740000
247500     PERFORM                                                      24750000
247600         VARYING PT-CRTN-IDX                                      24760000
247700            FROM 1 BY 1                                           24770000
247800            UNTIL PT-CRTN-IDX  >  PV-CARTON-TABLE-ENTRIES OR      24780000
247900                  PT-CRTN-IDX  >  PC-MAX-CARTON-TBL-ENTRY         24790000
248000                                                                  24800000
248100            MOVE PC166-PO-NBR       TO LBVRDA-PO-NBR              24810000
248200            MOVE PC166-RCVR-SEQ-NBR TO LBVRDA-RCVR-SEQ-NBR        24820000
248300                                                                  24830000
248400            IF  PC166-PREPK-ID  >  0                              24840000
248500                MOVE  ZEROES        TO LBVRDA-PO-LNE-NBR          24850000
248600                MOVE PC166-PREPK-ID TO LBVRDA-PREPK-ID            24860000
248700                MOVE PC166-PREPK-RATIO                            24870000
248800                                    TO LBVRDA-PREPK-RATO-QTY      24880000
248900                MOVE PC166-TOT-PREPK-UNTS                         24890000
249000                                    TO LBVRDA-PREPK-UNT-QTY       24900000
249100                MOVE PC166-PO-LNE-NBR                             24910000
249200                                    TO LBVRDA-PREPK-PRCG-LNE-NBR  24920000
249300            ELSE                                                  24930000
249400                MOVE PC166-PO-LNE-NBR                             24940000
249500                                    TO LBVRDA-PO-LNE-NBR          24950000
249600                MOVE ZEROES         TO LBVRDA-PREPK-ID            24960000
249700                                       LBVRDA-PREPK-RATO-QTY      24970000
249800                                       LBVRDA-PREPK-UNT-QTY       24980000
249900                                       LBVRDA-PREPK-PRCG-LNE-NBR  24990000
250000            END-IF                                                25000000
250100                                                                  25010000
250200            MOVE PT-CRTN-OTPK-QTY (PT-CRTN-IDX)                   25020000
250300                                    TO LBVRDA-OTPK-UNT-QTY        25030000
250400            MOVE PC-N               TO LBVRDA-LBL-ASG-IND         25040000
250500            ADD  1                  TO LBVRDA-LBL-ASG-SEQ-NBR     25050000
250600            IF  PT-CRTN-MSTR (PT-CRTN-IDX) = PC-I                 25060000
250700                MOVE PC-I           TO LBVRDA-LBL-TYP-CDE         25070000
250800                MOVE PV-MASTER-CRTN-SEQ-ID                        25080000
250900                                    TO LBVRDA-PRNT-CART-SEQ-ID    25090000
251000            ELSE                                                  25100000
251100                MOVE PC-M           TO LBVRDA-LBL-TYP-CDE         25110000
251200                MOVE LBVRDA-LBL-ASG-SEQ-NBR                       25120000
251300                                    TO LBVRDA-PRNT-CART-SEQ-ID    25130000
251400                                       PV-MASTER-CRTN-SEQ-ID      25140000
251500            END-IF                                                25150000
251600                                                                  25160000
251700            MOVE PC166-INPK-UNT-QTY TO LBVRDA-INPK-UNT-QTY        25170000
251800            MOVE PT-CRTN-STORE-NBR (PT-CRTN-IDX)                  25180000
251900                                    TO LBVRDA-DEST-OPER-UNT-ID    25190000
252000            MOVE PT-CRTN-OTPK-QTY (PT-CRTN-IDX)                   25200000
252100                                    TO LBVRDA-CSE-PK-QTY          25210000
252200            MOVE SPACES             TO LBVRDA-ODD-CART-IND        25220000
252300            IF  PT-CRTN-INPK-SML (PT-CRTN-IDX)                    25230000
252400                MOVE 'Y'            TO LBVRDA-INPK-CNVYB-IND      25240000
252500            ELSE                                                  25250000
252600                MOVE 'N'            TO LBVRDA-INPK-CNVYB-IND      25260000
252700            END-IF                                                25270000
252800                                                                  25280000
252900            IF  PT-CRTN-SML        (PT-CRTN-IDX)                  25290000
253000*DMH            PERFORM 5435-MANIFEST-NBR                         25300000
253100                IF  PT-CRTN-E-COMMERCE-YES (PT-CRTN-IDX)  AND     25310000
253200                    PT-CRTN-STORE (PT-CRTN-IDX)           AND     25320000
253300                    PC166-PRE-PACK-ORDER                          25330000
253400                    MOVE PC-S       TO LBVRDA-CART-LBL-TYP-CDE    25340000
253500                ELSE                                              25350000
253600                IF  PT-CRTN-E-COMMERCE-YES (PT-CRTN-IDX)  AND     25360000
253700                    PT-CRTN-STORE (PT-CRTN-IDX)                   25370000
253800                    MOVE PC-E       TO LBVRDA-CART-LBL-TYP-CDE    25380000
253900                ELSE                                              25390000
254000                IF  PT-CRTN-CENTRL-STCK (PT-CRTN-IDX)             25400000
254100                    MOVE PC-C       TO LBVRDA-CART-LBL-TYP-CDE    25410000
254200                ELSE                                              25420000
254300                    MOVE PC-S       TO LBVRDA-CART-LBL-TYP-CDE    25430000
254400                END-IF                                            25440000
254500                END-IF                                            25450000
254600                END-IF                                            25460000
254700                ADD  1              TO PV-SML-CRTN-SEQ            25470000
254800                MOVE PV-SML-CRTN-SEQ                              25480000
254900                                    TO LBVRDA-LBL-TYP-LBL-SEQ-ID  25490000
255000                ADD  PV-FCSE-CRTN-CNT                             25500000
255100                     PV-INPK-CRTN-CNT                             25510000
255200                     GIVING            LBVRDA-LBL-TYP-TOT-QTY     25520000
255300                MOVE SPACES         TO LBVRDA-MODU-DESC           25530000
255400                MOVE PC166-STR-ZNE  TO LBVRDA-STR-ZN-ID           25540000
255500                                                                  25550000
255600                MOVE ZEROES         TO PC160-20-SML-CONTAINER-CDE 25560000
255700                SET  PC160-20-SML-INTERNAL-LBL                    25570000
255800                     PC160-20-SML-FROM-KOHLS   TO  TRUE           25580000
255900                MOVE PT-CRTN-STORE-NBR (PT-CRTN-IDX)              25590000
256000                                    TO PV-STORE-NBR               25600000
256100                MOVE PV-DIVERT-STORE                              25610000
256200                                    TO PC160-20-SML-BC-DIVERT     25620000
256300                MOVE PC166-OPER-UNT-ID                            25630000
256400                                    TO PC160-20-SML-BC-DC-ORIGIN  25640000
256500                MOVE PT-CRTN-MANIFEST-NBR (PT-CRTN-IDX)           25650000
256600                                    TO PC160-20-SML-BC-MNFST-NBR  25660000
256700                ADD  1              TO PT-CRTN-MANIFEST-NBR       25670000
256800                                           (PT-CRTN-IDX)          25680000
257000                MOVE PC160-20-DIGIT-BARCODE                       25700000
257100                                    TO LBVRDA-BRCDE-NBR           25710000
257200                                                                  25720000
257300            ELSE                                                  25730000
257400                MOVE PC-P           TO LBVRDA-CART-LBL-TYP-CDE    25740000
257500                ADD  1              TO PV-P2L-CRTN-SEQ            25750000
257600                MOVE PV-P2L-CRTN-SEQ                              25760000
257700                                    TO LBVRDA-LBL-TYP-LBL-SEQ-ID  25770000
257800                MOVE PV-P2L-CRTN-CNT                              25780000
257900                                    TO LBVRDA-LBL-TYP-TOT-QTY     25790000
258000                MOVE PC166-MODU-DESC                              25800000
258100                                    TO LBVRDA-MODU-DESC           25810000
258200                MOVE PC166-STR-ZNE  TO LBVRDA-STR-ZN-ID           25820000
258300                                                                  25830000
258400                SET   PC160-DEST-TYP-0                            25840000
258500                                    TO  TRUE                      25850000
258600                MOVE P2LMOD-DIVERT-CDE                            25860000
258700                                    TO  PC160-DEST-DIVERT-CODE    25870000
258800                MOVE PC166-PO-NBR   TO  PC160-DEST-PO-NBR         25880000
258900                MOVE PC166-RCVR-SEQ-NBR                           25890000
259000                                    TO  PC160-DEST-RCVR-SEQ-NBR   25900000
259100                MOVE PC166-PO-LNE-NBR                             25910000
259200                                    TO  PC160-DEST-PO-LNE-NBR     25920000
259300                MOVE LBVRDA-LBL-TYP-LBL-SEQ-ID                    25930000
259400                                    TO  PC160-DEST-LBL-SEQ-NBR    25940000
259500                MOVE PC160-DEST-BARCODE-TEXT                      25950000
259600                                    TO LBVRDA-BRCDE-NBR           25960000
259700            END-IF                                                25970000
259800                                                                  25980000
259900            MOVE PC166-SKU          TO LBVRDA-ITM-NBR             25990000
260000            MOVE PV-DEPT-NAME       TO LBVRDA-DEPT-DESC           26000000
260100            MOVE PV-MAJOR-CLASS     TO LBVRDA-MAJ-CL-DESC         26010000
260200                                                                  26020000
260300            IF PT-CRTN-SEASET-YES (PT-CRTN-IDX)                   26030000
260400               MOVE PT-CRTN-SEASONAL-SET (PT-CRTN-IDX)            26040000
260500                                       TO LBVRDA-SEASET-NM        26050000
260600               MOVE PV-DIVERT-PFX-NBR  TO                         26060008
260700                                   PC160-20-SML-BC-DIVERT-PFX     26070000
260800               MOVE PC160-20-DIGIT-BARCODE                        26080000
260900                                       TO LBVRDA-BRCDE-NBR        26090008
261000            ELSE                                                  26100000
261100               MOVE SPACES             TO LBVRDA-SEASET-NM        26110000
261200            END-IF                                                26120000
261300            MOVE PT-CRTN-FIXT-ID (PT-CRTN-IDX)                    26130008
261400                                         TO LBVRDA-FIXT-ID        26140008
261410            MOVE PT-CRTN-EAS-TAG-IND (PT-CRTN-IDX)                26141032
261420                                         TO LBVRDA-EAS-TAG-IND    26142032
261430            MOVE PT-CRTN-PRESENTATION-IND (PT-CRTN-IDX)           26143045
261440                                      TO LBVRDA-HNG-FOLD-SEQ-NBR  26144046
261450            MOVE PT-CRTN-DOOR-ID (PT-CRTN-IDX)                    26145041
261460                                         TO LBVRDA-DOOR-ID        26146041
261480            MOVE PT-CRTN-MERCHANDISE-PGM (PT-CRTN-IDX)            26148055
261481*CLP 06/22/2015 -START                                            26148188
261482                               TO LBVRDA-LBL-MSG-TXT-TEXT         26148295
261484            MOVE 35  TO LBVRDA-LBL-MSG-TXT-LEN                    26148489
261485*CLP 06/22/2015 -END                                              26148588
261490                                                                  26149055
261500            IF  PT-CRTN-P2L (PT-CRTN-IDX)                         26150000
261600                MOVE SPACES              TO LBVRDA-FIXT-ID        26160009
261601                                            LBVRDA-DOOR-ID        26160174
261610                MOVE 'N'                 TO LBVRDA-EAS-TAG-IND    26161073
261700                IF  PV-SEASET-SHRT-NM > SPACES                    26170000
261800                    IF  PV-CURRENT-DATE > PV-SEASET-RLSE-DT       26180000
261900                        CONTINUE                                  26190000
262000                    ELSE                                          26200000
262100                        MOVE PV-SEASET-SHRT-NM TO LBVRDA-STR-ZN-ID26210000
262200                    END-IF                                        26220000
262210                ELSE                                              26221026
262211                    IF PS-P2L-SEASET-CHECKED-NO                   26221126
262220                       PERFORM 5431-CALL-SET-FIXT-ID-NAME         26222026
262230                       SET PS-P2L-SEASET-CHECKED-YES TO TRUE      26223026
262250                       IF  PV-CURRENT-DATE > PV-SEASET-RLSE-DT    26225026
262260                           CONTINUE                               26226026
262270                       ELSE                                       26227026
262280                           MOVE PV-SEASET-SHRT-NM                 26228026
262281                                            TO LBVRDA-STR-ZN-ID   26228126
262290                       END-IF                                     26229026
262291                    END-IF                                        26229126
262300                END-IF                                            26230000
262400            END-IF                                                26240000
262500**** TEMPORARY - WHEN VSM HAS THE STORAGE LOCATION USE THEIR TABLE26250000
262600            MOVE SPACES             TO LBVRDA-STRG-AREA-CDE       26260000
262700            PERFORM 5120-INSERT-VIRTUAL-TBL                       26270000
262800     END-PERFORM.                                                 26280000
262900                                                                  26290000
263000                                                                  26300000
263100*================================================================*26310000
263200* INSERT ROW INTO VIRTUAL LABEL TABLE                            *26320000
263300*================================================================*26330000
263400 5120-INSERT-VIRTUAL-TBL.                                         26340000
263500                                                                  26350000
263600     EXEC SQL                                                     26360000
263700          INSERT                                                  26370000
263800          INTO  TLBVRDA                                           26380000
263900              ( PO_NBR                                            26390000
264000               ,RCVR_SEQ_NBR                                      26400000
264100               ,PO_LNE_NBR                                        26410000
264200               ,PREPK_ID                                          26420000
264300               ,OTPK_UNT_QTY                                      26430000
264400               ,LBL_ASG_IND                                       26440000
264500               ,LBL_TYP_CDE                                       26450000
264600               ,LBL_ASG_SEQ_NBR                                   26460000
264700               ,PRNT_CART_SEQ_ID                                  26470000
264800               ,CART_LBL_TYP_CDE                                  26480000
264900               ,PREPK_PRCG_LNE_NBR                                26490000
265000               ,INPK_UNT_QTY                                      26500000
265100               ,PREPK_RATO_QTY                                    26510000
265200               ,PREPK_UNT_QTY                                     26520000
265300               ,DEST_OPER_UNT_ID                                  26530000
265400               ,CSE_PK_QTY                                        26540000
265500               ,ODD_CART_IND                                      26550000
265600               ,INPK_CNVYB_IND                                    26560000
265700               ,LBL_TYP_LBL_SEQ_ID                                26570000
265800               ,LBL_TYP_TOT_QTY                                   26580000
265900               ,BRCDE_NBR                                         26590000
266000               ,STR_ZN_ID                                         26600000
266100               ,MODU_DESC                                         26610000
266200               ,ITM_NBR                                           26620000
266300               ,DEPT_DESC                                         26630000
266400               ,MAJ_CL_DESC                                       26640000
266500               ,SEASET_NM                                         26650000
266600               ,FIXT_ID                                           26660000
266700               ,STRG_AREA_CDE                                     26670070
266701*CLP 06/22/2015 START                                             26670188
266710               ,LBL_MSG_TXT                                       26671088
266711*CLP 06/22/2015 END                                               26671188
266720               ,MDSE_SET_CMNT                                     26672070
266730               ,EAS_TAG_IND                                       26673073
266740               ,DOOR_ID                                           26674070
266750               ,PRC_MSG_CDE                                       26675070
266760               ,HNG_FOLD_SEQ_NBR )                                26676070
266800        VALUES                                                    26680000
266900              (:LBVRDA-PO-NBR                                     26690000
267000              ,:LBVRDA-RCVR-SEQ-NBR                               26700000
267100              ,:LBVRDA-PO-LNE-NBR                                 26710000
267200              ,:LBVRDA-PREPK-ID                                   26720000
267300              ,:LBVRDA-OTPK-UNT-QTY                               26730000
267400              ,:LBVRDA-LBL-ASG-IND                                26740000
267500              ,:LBVRDA-LBL-TYP-CDE                                26750000
267600              ,:LBVRDA-LBL-ASG-SEQ-NBR                            26760000
267700              ,:LBVRDA-PRNT-CART-SEQ-ID                           26770000
267800              ,:LBVRDA-CART-LBL-TYP-CDE                           26780000
267900              ,:LBVRDA-PREPK-PRCG-LNE-NBR                         26790000
268000              ,:LBVRDA-INPK-UNT-QTY                               26800000
268100              ,:LBVRDA-PREPK-RATO-QTY                             26810000
268200              ,:LBVRDA-PREPK-UNT-QTY                              26820000
268300              ,:LBVRDA-DEST-OPER-UNT-ID                           26830000
268400              ,:LBVRDA-CSE-PK-QTY                                 26840000
268500              ,:LBVRDA-ODD-CART-IND                               26850000
268600              ,:LBVRDA-INPK-CNVYB-IND                             26860000
268700              ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                         26870000
268800              ,:LBVRDA-LBL-TYP-TOT-QTY                            26880000
268900              ,:LBVRDA-BRCDE-NBR                                  26890000
269000              ,:LBVRDA-STR-ZN-ID                                  26900000
269100              ,:LBVRDA-MODU-DESC                                  26910000
269200              ,:LBVRDA-ITM-NBR                                    26920000
269300              ,:LBVRDA-DEPT-DESC                                  26930000
269400              ,:LBVRDA-MAJ-CL-DESC                                26940000
269500              ,:LBVRDA-SEASET-NM                                  26950000
269600              ,:LBVRDA-FIXT-ID                                    26960000
269700              ,:LBVRDA-STRG-AREA-CDE                              26970070
269701*06/22/2015 - START                                               26970188
269710              ,:LBVRDA-LBL-MSG-TXT                                26971088
269711*06/22/2015 - END                                                 26971188
269720              ,:LBVRDA-MDSE-SET-CMNT                              26972070
269730              ,:LBVRDA-EAS-TAG-IND                                26973073
269740              ,:LBVRDA-DOOR-ID                                    26974070
269750              ,:LBVRDA-PRC-MSG-CDE                                26975070
269760              ,:LBVRDA-HNG-FOLD-SEQ-NBR)                          26976070
269800     END-EXEC.                                                    26980000
269900                                                                  26990000
270000     EVALUATE TRUE                                                27000000
270100         WHEN SQLCODE = ZERO                                      27010000
270200              CONTINUE                                            27020000
270300         WHEN SQLCODE = -904                                      27030000
270400         WHEN SQLCODE = -911                                      27040000
270500         WHEN SQLCODE = -913                                      27050000
270600                                                                  27060000
270700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   27070000
270800             MOVE '5120-INSERT-VIRTUAL-TBL  '                     27080000
270900                                             TO PV-SOFT-PARAGRAPH 27090000
271000             STRING ' PCKCS719 - '           DELIMITED BY SIZE    27100000
271100                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    27110000
271200                                           INTO PV-CICS-MSG-AREA2 27120000
271300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27130000
271400               TO PV-COMMAREA-LENGTH                              27140000
271500             EXEC CICS                                            27150000
271600                  WRITEQ TD                                       27160000
271700                   QUEUE  ('CSSL')                                27170000
271800                    FROM  (PV-CICS-MSG-AREA2)                     27180000
271900                  LENGTH  (PV-COMMAREA-LENGTH)                    27190000
272000                    RESP  (PV-CICS-RESP)                          27200000
272100             END-EXEC                                             27210000
272200             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              27220000
272300             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            27230000
272400             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            27240000
272500             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        27250000
272600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27260000
272700               TO PV-COMMAREA-LENGTH                              27270000
272800             EXEC CICS                                            27280000
272900                  WRITEQ TD                                       27290000
273000                   QUEUE  ('CSSL')                                27300000
273100                    FROM  (PV-CICS-MSG-AREA2)                     27310000
273200                  LENGTH  (PV-COMMAREA-LENGTH)                    27320000
273300                    RESP  (PV-CICS-RESP)                          27330000
273400             END-EXEC                                             27340000
273500                                                                  27350000
273600              SET  PS-ERROR                                       27360000
273700                   PC166-CRA-DB-BUSY  TO  TRUE                    27370000
273800              MOVE 'TLBVRDA DATABASE BUSY    '                    27380000
273900                TO PC166-CRA-RET-MSG                              27390000
274000                                                                  27400000
274100         WHEN SQLWARN0 NOT = SPACES                               27410000
274200         WHEN SQLCODE NOT EQUAL ZERO                              27420000
274300                                                                  27430000
274400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   27440000
274500             MOVE '5120-INSERT-VIRTUAL-TBL  '                     27450000
274600                                             TO PV-SOFT-PARAGRAPH 27460000
274700             STRING ' PCKCS719 - '           DELIMITED BY SIZE    27470000
274800                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    27480000
274900                                           INTO PV-CICS-MSG-AREA2 27490000
275000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27500000
275100               TO PV-COMMAREA-LENGTH                              27510000
275200             EXEC CICS                                            27520000
275300                  WRITEQ TD                                       27530000
275400                   QUEUE  ('CSSL')                                27540000
275500                    FROM  (PV-CICS-MSG-AREA2)                     27550000
275600                  LENGTH  (PV-COMMAREA-LENGTH)                    27560000
275700                    RESP  (PV-CICS-RESP)                          27570000
275800             END-EXEC                                             27580000
275900             INITIALIZE                  PV-CICS-MSG-AREA2        27590000
276000             STRING ' PO/RCVR-'          DELIMITED BY SIZE        27600000
276100                    PC166-PO-NBR         DELIMITED BY SIZE        27610000
276200                    '-'                  DELIMITED BY SIZE        27620000
276300                    PC166-RCVR-SEQ-NBR   DELIMITED BY SIZE        27630000
276400                    ' LINE-'             DELIMITED BY SIZE        27640000
276500                    PC166-PO-LNE-NBR     DELIMITED BY SIZE        27650000
276600                    ' BARCODE-'          DELIMITED BY SIZE        27660000
276700                    LBVRDA-BRCDE-NBR     DELIMITED BY SIZE        27670000
276800                                    INTO PV-CICS-MSG-AREA2        27680000
276900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27690000
277000               TO PV-COMMAREA-LENGTH                              27700000
277100             EXEC CICS                                            27710000
277200                  WRITEQ TD                                       27720000
277300                   QUEUE  ('CSSL')                                27730000
277400                    FROM  (PV-CICS-MSG-AREA2)                     27740000
277500                  LENGTH  (PV-COMMAREA-LENGTH)                    27750000
277600                    RESP  (PV-CICS-RESP)                          27760000
277700             END-EXEC                                             27770000
277800                                                                  27780000
277900              SET  PS-ERROR                                       27790000
278000                   PC166-CRA-SQL-ERROR TO  TRUE                   27800000
278100              MOVE 'TLBVRDA SQL-ERROR        '                    27810000
278200                TO PC166-CRA-RET-MSG                              27820000
278300     END-EVALUATE.                                                27830000
278400                                                                  27840000
278500                                                                  27850000
278600*================================================================*27860000
278700* GET LABEL INFORMATION                                          *27870000
278800*================================================================*27880000
278900 5400-GET-LBL-DATA.                                               27890000
279000                                                                  27900000
279100     MOVE ZEROES       TO  PV-DIVERT-CODE.                        27910000
279200     MOVE ZEROES       TO  PV-STORE-NBR.                          27920000
279300                                                                  27930000
279400* DMH 2/15/02                                                     27940000
279500     IF  PC166-CREATE-SML                                         27950000
279600         IF  PC166-MOD-NBR  > 0                                   27960000
279700             PERFORM 5405-GET-MODULE-DESC                         27970000
279800          ELSE                                                    27980000
279900             MOVE  SPACES  TO  PC166-MODU-DESC                    27990000
280000          END-IF                                                  28000000
280100     ELSE                                                         28010000
280200         PERFORM 5405-GET-MODULE-DESC                             28020000
280300     END-IF.                                                      28030000
280400                                                                  28040000
280500     PERFORM 5410-DEPT-MAJOR-CLASS.                               28050000
280600                                                                  28060000
280700                                                                  28070000
280800*================================================================*28080000
280900* P2L MODULE DESCRIPTION                                         *28090000
281000*================================================================*28100000
281100 5405-GET-MODULE-DESC.                                            28110000
281200                                                                  28120000
281300     MOVE PC166-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                  28130000
281400     MOVE PC166-MOD-NBR      TO  DK-MOD-NBR.                      28140000
281500                                                                  28150000
281600     EXEC SQL                                                     28160000
281700         SELECT                                                   28170000
281800         MODU_NBR                                                 28180000
281900     ,   MODU_DESC                                                28190000
282000     ,   DIVERT_CDE                                               28200000
282100     INTO                                                         28210000
282200         :P2LMOD-MODU-NBR                                         28220000
282300     ,   :P2LMOD-MODU-DESC                                        28230000
282400     ,   :P2LMOD-DIVERT-CDE                                       28240000
282500     FROM                                                         28250000
282600         TP2LMOD                                                  28260000
282700     WHERE                                                        28270000
282800         OPER_UNT_ID   = :DK-OPER-UNT-ID                          28280000
282900     AND MODU_NBR      = :DK-MOD-NBR                              28290000
283000     END-EXEC.                                                    28300000
283100                                                                  28310000
283200     EVALUATE TRUE                                                28320000
283300         WHEN SQLCODE = ZERO                                      28330000
283310              IF  PS-P2L-MOD-ON-LABEL                             28331081
283400                  MOVE P2LMOD-MODU-DESC     TO PC166-MODU-DESC    28340079
283410              ELSE                                                28341079
283420                  MOVE P2LMOD-MODU-NBR      TO PV-MOD             28342082
283430                  MOVE '-'                  TO PV-MOD-DATE-DASH   28343079
283440                  MOVE PC166-TRIP-ARRIVE-MM TO PV-ARRIVE-MM       28344083
283450                  MOVE PC166-TRIP-ARRIVE-DD TO PV-ARRIVE-DD       28345083
283460                  MOVE PV-MOD-DATE          TO PC166-MODU-DESC    28346079
283470              END-IF                                              28347079
283500                                                                  28350000
283600         WHEN SQLCODE = -904                                      28360000
283700         WHEN SQLCODE = -911                                      28370000
283800         WHEN SQLCODE = -913                                      28380000
283900                                                                  28390000
284000             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   28400000
284100             MOVE '5405-GET-MODULE-DESC     '                     28410000
284200                                             TO PV-SOFT-PARAGRAPH 28420000
284300             STRING ' PCKCS719 - '           DELIMITED BY SIZE    28430000
284400                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    28440000
284500                                           INTO PV-CICS-MSG-AREA2 28450000
284600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28460000
284700               TO PV-COMMAREA-LENGTH                              28470000
284800             EXEC CICS                                            28480000
284900                  WRITEQ TD                                       28490000
285000                   QUEUE  ('CSSL')                                28500000
285100                    FROM  (PV-CICS-MSG-AREA2)                     28510000
285200                  LENGTH  (PV-COMMAREA-LENGTH)                    28520000
285300                    RESP  (PV-CICS-RESP)                          28530000
285400             END-EXEC                                             28540000
285500             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              28550000
285600             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            28560000
285700             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            28570000
285800             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        28580000
285900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28590000
286000               TO PV-COMMAREA-LENGTH                              28600000
286100             EXEC CICS                                            28610000
286200                  WRITEQ TD                                       28620000
286300                   QUEUE  ('CSSL')                                28630000
286400                    FROM  (PV-CICS-MSG-AREA2)                     28640000
286500                  LENGTH  (PV-COMMAREA-LENGTH)                    28650000
286600                    RESP  (PV-CICS-RESP)                          28660000
286700             END-EXEC                                             28670000
286800                                                                  28680000
286900              SET  PS-ERROR                                       28690000
287000                   PC166-CRA-DB-BUSY  TO  TRUE                    28700000
287100              MOVE 'TP2LMOD DATABASE BUSY    '                    28710000
287200                TO PC166-CRA-RET-MSG                              28720000
287300                                                                  28730000
287400         WHEN SQLWARN0 NOT = SPACES                               28740000
287500         WHEN SQLCODE NOT EQUAL ZERO                              28750000
287600                                                                  28760000
287700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   28770000
287800             MOVE '5405-GET-MODULE-DESC     '                     28780000
287900                                             TO PV-SOFT-PARAGRAPH 28790000
288000             STRING ' PCKCS719 - '           DELIMITED BY SIZE    28800000
288100                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    28810000
288200                                           INTO PV-CICS-MSG-AREA2 28820000
288300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28830000
288400               TO PV-COMMAREA-LENGTH                              28840000
288500             EXEC CICS                                            28850000
288600                  WRITEQ TD                                       28860000
288700                   QUEUE  ('CSSL')                                28870000
288800                    FROM  (PV-CICS-MSG-AREA2)                     28880000
288900                  LENGTH  (PV-COMMAREA-LENGTH)                    28890000
289000                    RESP  (PV-CICS-RESP)                          28900000
289100             END-EXEC                                             28910000
289200             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              28920000
289300             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            28930000
289400             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            28940000
289500             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        28950000
289600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     28960000
289700               TO PV-COMMAREA-LENGTH                              28970000
289800             EXEC CICS                                            28980000
289900                  WRITEQ TD                                       28990000
290000                   QUEUE  ('CSSL')                                29000000
290100                    FROM  (PV-CICS-MSG-AREA2)                     29010000
290200                  LENGTH  (PV-COMMAREA-LENGTH)                    29020000
290300                    RESP  (PV-CICS-RESP)                          29030000
290400             END-EXEC                                             29040000
290500                                                                  29050000
290600              SET  PS-ERROR                                       29060000
290700                   PC166-CRA-SQL-ERROR TO  TRUE                   29070000
290800              MOVE 'TP2LMOD SQL-ERROR        '                    29080000
290900                TO PC166-CRA-RET-MSG                              29090000
291000     END-EVALUATE.                                                29100000
291100                                                                  29110000
291200                                                                  29120000
291300*================================================================*29130000
291400* DEPARTMENT DESCRIPTION AND MAJOR CLASS                         *29140000
291500*================================================================*29150000
291600 5410-DEPT-MAJOR-CLASS.                                           29160000
291700                                                                  29170000
291800     SET DP003-MCL-LOOKUP              TO TRUE.                   29180000
291900     SET DP003-DPT-LOOKUP              TO TRUE.                   29190000
292000                                                                  29200000
292100     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      29210000
292200     MOVE '03'                         TO DP003-OP-CO-NMBR.       29220000
292300     MOVE PV-CURRENT-YY                TO PV-DPKUT038-YY.         29230000
292400     MOVE PV-CURRENT-MM                TO PV-DPKUT038-MM.         29240000
292500     MOVE PV-CURRENT-DD                TO PV-DPKUT038-DD          29250000
292600     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      29260000
292700                                          DP003-EFF-DATE.         29270000
292800     MOVE PC166-DEPT-NBR               TO DP003-DPT-INPUT.        29280000
292900     MOVE PC166-CL-NBR                 TO PV-DPKUT038-MJR-CL.     29290000
293000     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   29300000
293100     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        29310000
293200                                                                  29320000
293300     EXEC CICS                                                    29330000
293400         LINK PROGRAM  (PV-DPKUT038)                              29340000
293500              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              29350000
293600              LENGTH   (PV-DPKUT038-CA-LENGTH)                    29360000
293700              RESP     (PV-DPKUT038-CICS-RESP)                    29370000
293800     END-EXEC.                                                    29380000
293900                                                                  29390000
294000     EVALUATE TRUE                                                29400000
294100         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            29410000
294200              MOVE DP003-DPT-DESCRIPTION TO PV-DEPT-NAME          29420000
294300              MOVE DP003-MCL-DESCRIPTION TO PV-MAJOR-CLASS        29430000
294400         WHEN OTHER                                               29440000
294500              MOVE SPACES                TO PV-DEPT-NAME          29450000
294600                                            PV-MAJOR-CLASS        29460000
294700     END-EVALUATE.                                                29470000
294800                                                                  29480000
294900                                                                  29490000
295000                                                                  29500000
295100 5430-CALL-SET-FIXT-ID-MOD.                                       29510000
295200     INITIALIZE PC240-ITEM-COMMAREA                               29520000
295300     MOVE PC166-PO-NBR                TO PC240-KEY-PO             29530000
295400     MOVE RECDIS-STR-NBR              TO PC240-KEY-DEST-LOC       29540000
295500     MOVE PC166-SKU                   TO PC240-KEY-SKU            29550000
295600     SET  PC240-CSEPK-SPLIT-VRTL      TO TRUE                     29560000
295700                                                                  29570000
295800     IF PC166-PRE-PACK-ORDER                                      29580000
295900        SET PC240-PREPK-ORDER-YES       TO TRUE                   29590000
296000        MOVE PC166-PREPK-ID             TO PC240-KEY-PREPK-ID     29600000
296100        MOVE PC166-RCVR-SEQ-NBR         TO PC240-KEY-REC-SEQ-NBR  29610000
296200     ELSE                                                         29620000
296300        SET PC240-PREPK-ORDER-NO        TO TRUE                   29630000
296400     END-IF                                                       29640000
296500                                                                  29650000
296600     CALL PC240-VSM-PGM USING DFHEIBLK                            29660000
296700                              PC240-COMMAREA                      29670000
296800                              PC240-ITEM-COMMAREA                 29680000
296900     EVALUATE TRUE                                                29690000
297000         WHEN PC240-SUCCESSFUL                                    29700000
297100                                                                  29710000
297200             IF PC240-NO-SEASONAL-SET-FOUND                       29720000
297300                SET PS-NO-SEASET-DATA-FOUND TO TRUE               29730000
297400             ELSE                                                 29740000
297500                MOVE PC240-SEASET-SHRT-NM TO PV-SEASET-SHRT-NM    29750000
297600                MOVE PC240-STR-RLSE-END-DTE TO PV-SEASET-RLSE-DT  29760000
297700             END-IF                                               29770000
297800                                                                  29780000
297900             IF PC240-DIVERT-PFX-NBR = ZEROES                     29790000
298000                MOVE ZEROES TO PV-DIVERT-PFX-NBR                  29800000
298100             ELSE                                                 29810000
298200                MOVE PC240-DIVERT-PFX-NBR TO                      29820000
298300                                   PV-DIVERT-PFX-NBR              29830000
298400             END-IF                                               29840000
298500                                                                  29850000
298600             IF PC240-POG-SEASET-IND = 'Y'                        29860000
298700                SET PS-POG-DATA-FOUND TO TRUE                     29870000
298800             ELSE                                                 29880000
298900                IF (PC240-POG-SEASET-YR    > SPACES) AND          29890000
299000                   (PC240-POG-SEASET-SHRT-NM  > SPACES)           29900000
299100                   SET PS-POG-DATA-FOUND TO TRUE                  29910000
299200                ELSE                                              29920000
299300                   SET PS-NO-POG-DATA-FOUND TO TRUE               29930000
299400                END-IF                                            29940000
299500             END-IF                                               29950000
299600         WHEN PC240-ITEM-NOT-FOUND                                29960000
299700             MOVE PC240-DIVERT-PFX-NBR TO PV-DIVERT-CODE          29970000
299800             MOVE SPACES               TO PV-SEASET-SHRT-NM       29980000
299900         WHEN PC240-SQL-ERROR                                     29990000
300000         WHEN PC240-INVALID-ACCESS                                30000000
300100              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      30010000
300200              STRING 'SQL='                 DELIMITED BY SIZE     30020000
300300                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     30030000
300400                     '5430-CALL-SET-FIXT-ID-MOD'                  30040000
300500                                            DELIMITED BY SIZE     30050000
300600                                       INTO PC166-CRA-RET-MSG     30060000
300700              MOVE '27'                TO   PC166-CRA-RET-CDE     30070000
300800              PERFORM 9000-RETURN-CALL                            30080000
300900                                                                  30090000
301000         WHEN OTHER                                               30100000
301100              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      30110000
301200              STRING 'SQL='                 DELIMITED BY SIZE     30120000
301300                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     30130000
301400                     '5430-CALL-SET-FIXT-ID-MOD'                  30140000
301500                                            DELIMITED BY SIZE     30150000
301600                                       INTO PC166-CRA-RET-MSG     30160000
301700              MOVE '28'                TO   PC166-CRA-RET-CDE     30170000
301800              PERFORM 9000-RETURN-CALL                            30180000
301900                                                                  30190000
302000     END-EVALUATE.                                                30200000
302001******************************************************************30200126
302002*                                                                *30200226
302003******************************************************************30200326
302010 5431-CALL-SET-FIXT-ID-NAME.                                      30201026
302020     INITIALIZE PC240-ITEM-COMMAREA                               30202026
302030     MOVE PC166-PO-NBR                TO PC240-KEY-PO             30203026
302040     MOVE PC166-OPER-UNT-ID           TO PC240-KEY-DEST-LOC       30204026
302050     MOVE PC166-SKU                   TO PC240-KEY-SKU            30205026
302060     SET  PC240-SET-NAME-ONLY         TO TRUE                     30206026
302070                                                                  30207026
302080     IF PC166-PRE-PACK-ORDER                                      30208026
302090        SET PC240-PREPK-ORDER-YES       TO TRUE                   30209026
302091        MOVE PC166-PREPK-ID             TO PC240-KEY-PREPK-ID     30209126
302092        MOVE PC166-RCVR-SEQ-NBR         TO PC240-KEY-REC-SEQ-NBR  30209226
302093     ELSE                                                         30209326
302094        SET PC240-PREPK-ORDER-NO        TO TRUE                   30209426
302095     END-IF                                                       30209526
302096                                                                  30209626
302097     CALL PC240-VSM-PGM USING DFHEIBLK                            30209726
302098                              PC240-COMMAREA                      30209826
302099                              PC240-ITEM-COMMAREA                 30209926
302100     EVALUATE TRUE                                                30210026
302101         WHEN PC240-SUCCESSFUL                                    30210126
302102                                                                  30210226
302103             IF PC240-NO-SEASONAL-SET-FOUND                       30210326
302104                MOVE SPACES TO PV-SEASET-SHRT-NM                  30210426
302105             ELSE                                                 30210526
302106                MOVE PC240-SEASET-SHRT-NM TO PV-SEASET-SHRT-NM    30210626
302107                MOVE PC240-STR-RLSE-END-DTE TO PV-SEASET-RLSE-DT  30210726
302108             END-IF                                               30210826
302109                                                                  30210926
302127         WHEN PC240-ITEM-NOT-FOUND                                30212726
302129             MOVE SPACES               TO PV-SEASET-SHRT-NM       30212926
302130         WHEN PC240-SQL-ERROR                                     30213026
302131         WHEN PC240-INVALID-ACCESS                                30213126
302132              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      30213226
302133              STRING 'SQL='                 DELIMITED BY SIZE     30213326
302134                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     30213426
302135                     '5431-CALL-SET-FIXT-ID-NAME'                 30213526
302136                                            DELIMITED BY SIZE     30213626
302137                                       INTO PC166-CRA-RET-MSG     30213726
302138              MOVE '35'                TO   PC166-CRA-RET-CDE     30213826
302139              PERFORM 9000-RETURN-CALL                            30213926
302140                                                                  30214026
302141         WHEN OTHER                                               30214126
302142              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      30214226
302143              STRING 'SQL='                 DELIMITED BY SIZE     30214326
302144                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     30214426
302145                     '5431-CALL-SET-FIXT-ID-NAME'                 30214526
302146                                            DELIMITED BY SIZE     30214626
302147                                       INTO PC166-CRA-RET-MSG     30214726
302148              MOVE '36'                TO   PC166-CRA-RET-CDE     30214826
302149              PERFORM 9000-RETURN-CALL                            30214926
302150                                                                  30215026
302151     END-EVALUATE.                                                30215126
302152                                                                  30215228
302153 5432-CALL-ITEM-DOMAIN-MOD.                                       30215327
302154                                                                  30215427
302155     INITIALIZE XL001-ITEM-COMMAREA                               30215527
302156     MOVE ZEROES                      TO PV-HNG-FOLD-SEQ-NBR      30215646
302158     MOVE PC166-SKU                   TO XL001-KEY-SKU            30215828
302167                                                                  30216728
302168     SET XL001-BY-NUMERIC-SKU                                     30216828
302170         XL001-SELECT-VND-STYL        TO TRUE                     30217028
302171                                                                  30217128
302172     CALL XL001-VSM-PGM USING DFHEIBLK                            30217228
302173                              XL001-COMMAREA                      30217328
302174                              XL001-ITEM-COMMAREA                 30217428
302175                                                                  30217528
302176     EVALUATE TRUE                                                30217628
302188                                                                  30218846
302189         WHEN XL001-SUCCESSFUL                                    30218928
302190            EVALUATE TRUE                                         30219046
302191              WHEN XL001-HNG-FOLD-CDE = 'H'                       30219146
302192                 MOVE 1 TO  PV-HNG-FOLD-SEQ-NBR                   30219246
302193              WHEN XL001-HNG-FOLD-CDE = 'F'                       30219346
302194                 MOVE 2 TO  PV-HNG-FOLD-SEQ-NBR                   30219446
302195              WHEN OTHER                                          30219546
302196                 MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR                   30219646
302197            END-EVALUATE                                          30219746
302199         WHEN XL001-SQL-ERROR                                     30219928
302200           IF XL001-VND-STYL-NOT-FOUND OR                         30220028
302201                                         XL001-VND-STYL-CONTENTION30220128
302202             MOVE XL001-VND-STYL-SQLCODE     TO PV-SOFT-SQLCODE   30220228
302203           ELSE                                                   30220328
302204             MOVE XL001-SKU-STR-SQLCODE      TO PV-SOFT-SQLCODE   30220428
302205           END-IF                                                 30220528
302206                                                                  30220628
302207           MOVE XL001-ERROR-PARAGRAPH-NBR                         30220728
302208                                           TO PV-SOFT-PARAGRAPH   30220828
302209           STRING ' PCKCS719 - '           DELIMITED BY SIZE      30220928
302210                  PV-SOFT-ABORT-MSG        DELIMITED BY SIZE      30221028
302211                                         INTO PV-CICS-MSG-AREA2   30221128
302212           MOVE LENGTH OF PV-CICS-MSG-AREA2                       30221228
302213             TO PV-COMMAREA-LENGTH                                30221328
302214           EXEC CICS                                              30221428
302215                WRITEQ TD                                         30221528
302216                 QUEUE  ('CSSL')                                  30221628
302217                  FROM  (PV-CICS-MSG-AREA2)                       30221728
302218                LENGTH  (PV-COMMAREA-LENGTH)                      30221828
302219                  RESP  (PV-CICS-RESP)                            30221928
302220           END-EXEC                                               30222028
302221           MOVE PC166-PO-NBR       TO  PV-HOLD3-PO                30222128
302222           MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR              30222228
302223           MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE              30222328
302224           MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2          30222428
302225           MOVE LENGTH OF PV-CICS-MSG-AREA2                       30222528
302226             TO PV-COMMAREA-LENGTH                                30222628
302227           EXEC CICS                                              30222728
302228                WRITEQ TD                                         30222828
302229                 QUEUE  ('CSSL')                                  30222928
302230                  FROM  (PV-CICS-MSG-AREA2)                       30223028
302231                LENGTH  (PV-COMMAREA-LENGTH)                      30223128
302232                  RESP  (PV-CICS-RESP)                            30223228
302233           END-EXEC                                               30223328
302234                                                                  30223428
302235            SET  PS-ERROR                                         30223528
302236                 PC166-CRA-DB-BUSY  TO  TRUE                      30223628
302237            MOVE 'ITEM DOMAIN ERROR   '                           30223728
302238              TO PC166-CRA-RET-MSG                                30223828
302239                                                                  30223928
302240            STRING 'SQL='                 DELIMITED BY SIZE       30224028
302241                   PV-SQL-RETURN-CD       DELIMITED BY SIZE       30224128
302242                   '5432-CALL-ITEM-DOMAIN-MOD'                    30224228
302243                                          DELIMITED BY SIZE       30224328
302244                                     INTO PC166-CRA-RET-MSG       30224428
302245            MOVE '37'                TO   PC166-CRA-RET-CDE       30224538
302246            PERFORM 9000-RETURN-CALL                              30224628
302285                                                                  30228528
302287         WHEN OTHER                                               30228728
302288              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      30228828
302289              STRING 'SQL='                 DELIMITED BY SIZE     30228928
302290                     XL001-SKU-SQLCODE      DELIMITED BY SIZE     30229029
302291                     '5432-CALL-ITEM-DOMAIN-MOD'                  30229129
302292                                            DELIMITED BY SIZE     30229228
302293                                       INTO PC166-CRA-RET-MSG     30229328
302294              MOVE '38'                TO   PC166-CRA-RET-CDE     30229438
302295              PERFORM 9000-RETURN-CALL                            30229528
302296                                                                  30229628
302297     END-EVALUATE.                                                30229728
302298                                                                  30229829
302299 5433-CHECK-EAS-TAG.                                              30229929
302300                                                                  30230029
302301      MOVE PURITM-UNT-RTL-PR-AMT TO SFT00000-BEG-PRPT-AMT.        30230134
302302                                                                  30230229
302303      EXEC SQL                                                    30230329
302304           SELECT DEPT_NBR                                        30230429
302305           INTO  :SFT00000-DEPT-NBR                               30230529
302306           FROM   SFT_EAS_TG_MDSE                                 30230629
302307           WHERE ( DEPT_NBR        = :XL001-DEPT-NBR              30230729
302308                 AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR            30230829
302309                 AND SUB_CL_NBR    = :XL001-SUB-CL-NBR )          30230929
302310             OR  ( DEPT_NBR        = :XL001-DEPT-NBR              30231029
302311                 AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR            30231129
302312                 AND SUB_CL_NBR IS NULL )                         30231229
302313             AND BEG_PRPT_AMT      <= :SFT00000-BEG-PRPT-AMT      30231329
302314      END-EXEC.                                                   30231429
302315      EVALUATE TRUE                                               30231529
302316          WHEN SQLCODE = ZERO                                     30231629
302317               SET PS-SET-EAS-TAG-YES TO TRUE                     30231735
302318          WHEN SQLCODE = +100                                     30231829
302319               SET PS-SET-EAS-TAG-NO  TO TRUE                     30231935
302321          WHEN SQLCODE = -904                                     30232129
302322          WHEN SQLCODE = -911                                     30232229
302323          WHEN SQLCODE = -913                                     30232329
302324                                                                  30232429
302325              MOVE SQLCODE                    TO PV-SOFT-SQLCODE  30232529
302326              MOVE '5433-CHECK-EAS-TAG '                          30232629
302327                                              TO PV-SOFT-PARAGRAPH30232729
302328              STRING ' PCKCS719 - '           DELIMITED BY SIZE   30232829
302329                     PV-SOFT-ABORT-MSG        DELIMITED BY SIZE   30232929
302330                                            INTO PV-CICS-MSG-AREA230233029
302331              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30233129
302332                TO PV-COMMAREA-LENGTH                             30233229
302333              EXEC CICS                                           30233329
302334                   WRITEQ TD                                      30233429
302335                    QUEUE  ('CSSL')                               30233529
302336                     FROM  (PV-CICS-MSG-AREA2)                    30233629
302337                   LENGTH  (PV-COMMAREA-LENGTH)                   30233729
302338                     RESP  (PV-CICS-RESP)                         30233829
302339              END-EXEC                                            30233929
302340              MOVE PC166-PO-NBR       TO  PV-HOLD3-PO             30234029
302341              MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR           30234129
302342              MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE           30234229
302343              MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2       30234329
302344              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30234429
302345                TO PV-COMMAREA-LENGTH                             30234529
302346              EXEC CICS                                           30234629
302347                   WRITEQ TD                                      30234729
302348                    QUEUE  ('CSSL')                               30234829
302349                     FROM  (PV-CICS-MSG-AREA2)                    30234929
302350                   LENGTH  (PV-COMMAREA-LENGTH)                   30235029
302351                     RESP  (PV-CICS-RESP)                         30235129
302352              END-EXEC                                            30235229
302353                                                                  30235329
302354               SET  PS-ERROR                                      30235429
302355                    PC166-CRA-DB-BUSY  TO  TRUE                   30235529
302356               MOVE 'SELECT OF SFT_EAS_TG_MDSE'                   30235629
302357                 TO PC166-CRA-RET-MSG                             30235729
302358                                                                  30235829
302359          WHEN SQLWARN0 NOT = SPACES                              30235929
302360          WHEN SQLCODE NOT EQUAL ZERO                             30236029
302361                                                                  30236129
302362              MOVE SQLCODE                    TO PV-SOFT-SQLCODE  30236229
302363              MOVE '5433-CHECK-EAS-TAG '                          30236329
302364                                              TO PV-SOFT-PARAGRAPH30236429
302365              STRING ' PCKCS719 - '           DELIMITED BY SIZE   30236529
302366                     PV-SOFT-ABORT-MSG        DELIMITED BY SIZE   30236629
302367                                            INTO PV-CICS-MSG-AREA230236729
302368              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30236829
302369                TO PV-COMMAREA-LENGTH                             30236929
302370              EXEC CICS                                           30237029
302371                   WRITEQ TD                                      30237129
302372                    QUEUE  ('CSSL')                               30237229
302373                     FROM  (PV-CICS-MSG-AREA2)                    30237329
302374                   LENGTH  (PV-COMMAREA-LENGTH)                   30237429
302375                     RESP  (PV-CICS-RESP)                         30237529
302376              END-EXEC                                            30237629
302377              MOVE PC166-PO-NBR       TO  PV-HOLD3-PO             30237729
302378              MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR           30237829
302379              MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE           30237929
302380              MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2       30238029
302381              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30238129
302382                TO PV-COMMAREA-LENGTH                             30238229
302383              EXEC CICS                                           30238329
302384                   WRITEQ TD                                      30238429
302385                    QUEUE  ('CSSL')                               30238529
302386                     FROM  (PV-CICS-MSG-AREA2)                    30238629
302387                   LENGTH  (PV-COMMAREA-LENGTH)                   30238729
302388                     RESP  (PV-CICS-RESP)                         30238829
302389              END-EXEC                                            30238929
302390                                                                  30239029
302391               SET  PS-ERROR                                      30239129
302392                    PC166-CRA-DB-BUSY  TO  TRUE                   30239229
302393               MOVE 'SELECT OF SFT_EAS_TG_MDSE'                   30239329
302394                 TO PC166-CRA-RET-MSG                             30239429
302395                                                                  30239529
302396      END-EVALUATE.                                               30239629
302397                                                                  30239729
302398*CLP 06/22/2015- START                                            30239888
302399 5434-CHECK-BRAND.                                                30239988
302400                                                                  30240055
302401     MOVE PC166-SKU   TO XLT00003-SKU-NBR.                        30240199
302402     MOVE SPACE TO PV-BUS-AREA-BRAND.                             30240299
302410                                                                  30241055
302412     EXEC SQL                                                     30241288
302413        SELECT  BRND_DESC                                         30241388
302416         INTO   :XLT00043-BRND-DESC                               30241688
302419          FROM  XLT_SKU      A                                    30241988
302420             ,  XLT_VND_STYL B                                    30242088
302421             ,  XLT_BRND     C                                    30242188
302422         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            30242288
302423           AND  A.STYL_ID         =  B.STYL_ID                    30242388
302424           AND  B.BRND_ID         =  C.BRND_ID                    30242488
302425           AND  C.BRND_ID         >  0                            30242598
302426     END-EXEC.                                                    30242688
302427                                                                  30242788
302444      EVALUATE TRUE                                               30244455
302445          WHEN SQLCODE = ZERO                                     30244555
302446               PERFORM 1210-INSPECT-BUS-AREA                      30244699
302447          WHEN SQLCODE = +100                                     30244755
302448               CONTINUE                                           30244855
302449          WHEN SQLCODE = -904                                     30244955
302450          WHEN SQLCODE = -911                                     30245055
302451          WHEN SQLCODE = -913                                     30245155
302452                                                                  30245255
302453              MOVE SQLCODE                    TO PV-SOFT-SQLCODE  30245355
302454              MOVE '5434-CHECK-BRAND        '                     30245488
302455                                              TO PV-SOFT-PARAGRAPH30245555
302456              STRING ' PCKCS719 - '           DELIMITED BY SIZE   30245655
302457                     PV-SOFT-ABORT-MSG        DELIMITED BY SIZE   30245755
302458                                            INTO PV-CICS-MSG-AREA230245855
302459              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30245955
302460                TO PV-COMMAREA-LENGTH                             30246055
302461              EXEC CICS                                           30246155
302462                   WRITEQ TD                                      30246255
302463                    QUEUE  ('CSSL')                               30246355
302464                     FROM  (PV-CICS-MSG-AREA2)                    30246455
302465                   LENGTH  (PV-COMMAREA-LENGTH)                   30246555
302466                     RESP  (PV-CICS-RESP)                         30246655
302467              END-EXEC                                            30246755
302468              MOVE PC166-PO-NBR       TO  PV-HOLD3-PO             30246855
302469              MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR           30246955
302470              MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE           30247063
302471              MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2       30247155
302472              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30247255
302473                TO PV-COMMAREA-LENGTH                             30247355
302474              EXEC CICS                                           30247455
302475                   WRITEQ TD                                      30247555
302476                    QUEUE  ('CSSL')                               30247655
302477                     FROM  (PV-CICS-MSG-AREA2)                    30247755
302478                   LENGTH  (PV-COMMAREA-LENGTH)                   30247855
302479                     RESP  (PV-CICS-RESP)                         30247955
302480              END-EXEC                                            30248055
302481                                                                  30248155
302482               SET  PS-ERROR                                      30248255
302483                    PC166-CRA-DB-BUSY  TO  TRUE                   30248355
302484               MOVE 'SELECT OF SFT_EAS_TG_MDSE'                   30248455
302485                 TO PC166-CRA-RET-MSG                             30248555
302486                                                                  30248655
302487          WHEN SQLWARN0 NOT = SPACES                              30248755
302488          WHEN SQLCODE NOT EQUAL ZERO                             30248855
302489                                                                  30248955
302490              MOVE SQLCODE                    TO PV-SOFT-SQLCODE  30249055
302491              MOVE '5434-CHECK-BRAND        '                     30249188
302492                                              TO PV-SOFT-PARAGRAPH30249255
302493              STRING ' PCKCS719 - '           DELIMITED BY SIZE   30249355
302494                     PV-SOFT-ABORT-MSG        DELIMITED BY SIZE   30249455
302495                                            INTO PV-CICS-MSG-AREA230249555
302496              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30249655
302497                TO PV-COMMAREA-LENGTH                             30249755
302498              EXEC CICS                                           30249855
302499                   WRITEQ TD                                      30249955
302500                    QUEUE  ('CSSL')                               30250055
302501                     FROM  (PV-CICS-MSG-AREA2)                    30250155
302502                   LENGTH  (PV-COMMAREA-LENGTH)                   30250255
302503                     RESP  (PV-CICS-RESP)                         30250355
302504              END-EXEC                                            30250455
302505              MOVE PC166-PO-NBR       TO  PV-HOLD3-PO             30250555
302506              MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR           30250655
302507              MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE           30250755
302508              MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2       30250855
302509              MOVE LENGTH OF PV-CICS-MSG-AREA2                    30250955
302510                TO PV-COMMAREA-LENGTH                             30251055
302511              EXEC CICS                                           30251155
302512                   WRITEQ TD                                      30251255
302513                    QUEUE  ('CSSL')                               30251355
302514                     FROM  (PV-CICS-MSG-AREA2)                    30251455
302515                   LENGTH  (PV-COMMAREA-LENGTH)                   30251555
302516                     RESP  (PV-CICS-RESP)                         30251655
302517              END-EXEC                                            30251755
302518                                                                  30251855
302519               SET  PS-ERROR                                      30251955
302520                    PC166-CRA-DB-BUSY  TO  TRUE                   30252055
302521               MOVE 'SELECT OF SFT_EAS_TG_MDSE'                   30252155
302522                 TO PC166-CRA-RET-MSG                             30252255
302523                                                                  30252355
302524      END-EVALUATE.                                               30252455
302525                                                                  30252555
302526*================================================================*30252655
302527* GET MANIFEST NUMBER                                            *30252755
302528*================================================================*30252855
302529 5435-MANIFEST-NBR.                                               30252955
302530                                                                  30253055
302600     ADD    PV-FCSE-CRTN-CNT                                      30260000
302700            PV-INPK-CRTN-CNT                                      30270000
302800     GIVING PV-TOTAL-LBL-CNT.                                     30280000
302900                                                                  30290000
303000     MOVE  PT-CRTN-STORE-NBR (PT-CRTN-IDX)  TO  PC187-STR-NBR.    30300000
303100     MOVE  1                                TO  PC187-NO-OF-LBLS. 30310000
303200                                                                  30320000
303300     PERFORM 5440-LINK-PCKCS721.                                  30330000
303400                                                                  30340000
303500     MOVE  PC187-START-MFST-NBR            TO PT-CRTN-MANIFEST-NBR30350000
303600                                              (PT-CRTN-IDX).      30360000
303700                                                                  30370000
303800                                                                  30380000
303801*CLP 06/22/2015 - START                                           30380188
303802****************************************************************  30380288
303803*      GET THE BUSINESS AREA DESCRIPTION                          30380388
303805****************************************************************  30380588
303810 5436-GET-BUSINESS-DESC.                                          30381088
303820                                                                  30382088
303830     INITIALIZE XL073-COMMAREA-REC.                               30383088
303840                                                                  30384088
303850     MOVE XL001-DEPT-NBR     TO  PV-XL-DEPT-NBR.                  30385088
303860                                                                  30386088
303870     IF  PV-XL-DEPT-NBR  =  0                                     30387088
303880         MOVE PC166-DEPT-NBR          TO XL073-DEPT-NBR           30388088
303890     ELSE                                                         30389088
303891         MOVE XL001-DEPT-NBR          TO XL073-DEPT-NBR           30389188
303892     END-IF.                                                      30389288
303894                                                                  30389488
303895     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     30389588
303896                                     XL073-COMMAREA               30389688
303897                                     XL073-COMMAREA-REC           30389788
303898                                                                  30389888
303899     EVALUATE TRUE                                                30389988
303900         WHEN XL073-NO-ERRORS                                     30390088
303903             CONTINUE                                             30390393
303909         WHEN OTHER                                               30390988
303910              INITIALIZE  PV-CICS-MSG-AREA                        30391088
303920              MOVE XL073-SQLCODE       TO PV-SQL-RETURN-CD        30392088
303921              STRING ' PCKCS719 - '             DELIMITED BY SIZE 30392188
303922                     '5436-GET-BUSINESS-DESC  ' DELIMITED BY SIZE 30392289
303923                     '  SQL - '                 DELIMITED BY SIZE 30392388
303924                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 30392488
303925                     ' TABLE- '                 DELIMITED BY SIZE 30392588
303926                     XL073-DB2-TABLE            DELIMITED BY SIZE 30392688
303927                                           INTO PV-CICS-MSG-AREA2 30392788
303928                  MOVE LENGTH OF PV-CICS-MSG-AREA2                30392888
303929                    TO PV-COMMAREA-LENGTH                         30392988
303930                  EXEC CICS                                       30393088
303931                       WRITEQ TD                                  30393188
303932                       QUEUE  ('CSSL')                            30393288
303933                        FROM  (PV-CICS-MSG-AREA2)                 30393388
303934                      LENGTH  (PV-COMMAREA-LENGTH)                30393488
303935                        RESP  (PV-CICS-RESP)                      30393588
303936                  END-EXEC                                        30393688
303937     END-EVALUATE.                                                30393788
303940*================================================================*30394000
304000* LINK TO MANIFEST NUMBER MODULE TO GET THE NEXT MANIFEST NBR.  *30400000
304100*================================================================*30410000
304200 5440-LINK-PCKCS721.                                              30420000
304300                                                                  30430000
304400     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   30440000
304500                                                                  30450000
304600     EXEC CICS                                                    30460000
304700         LINK PROGRAM  (PC-MANIFEST-NBR-MODULE)                   30470000
304800              COMMAREA (PC187-COMMAREA-REC)                       30480000
304900              LENGTH   (PV-COMMAREA-LENGTH)                       30490000
305000              RESP     (PV-CICS-RESP)                             30500000
305100     END-EXEC.                                                    30510000
305200                                                                  30520000
305300     EVALUATE TRUE                                                30530000
305400         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     30540000
305500              IF  PC187-CRA-SUCCESSFUL                            30550000
305600                  CONTINUE                                        30560000
305700              ELSE                                                30570000
305800                  INITIALIZE PV-CICS-MSG-AREA2                    30580000
305900                  STRING ' PCKCS719 - '       DELIMITED BY SIZE   30590000
306000                         '5440-LINK-PCKCS721' DELIMITED BY SIZE   30600000
306100                                         INTO PV-CICS-MSG-AREA2   30610000
306200                  MOVE LENGTH OF PV-CICS-MSG-AREA2                30620000
306300                    TO PV-COMMAREA-LENGTH                         30630000
306400                  EXEC CICS                                       30640000
306500                       WRITEQ TD                                  30650000
306600                       QUEUE  ('CSSL')                            30660000
306700                        FROM  (PV-CICS-MSG-AREA2)                 30670000
306800                      LENGTH  (PV-COMMAREA-LENGTH)                30680000
306900                        RESP  (PV-CICS-RESP)                      30690000
307000                  END-EXEC                                        30700000
307100                  INITIALIZE PV-CICS-MSG-AREA2                    30710000
307200                  MOVE PC166-PO-NBR       TO  PV-HOLD3-PO         30720000
307300                  MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR       30730000
307400                  MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE       30740000
307500                  MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2   30750000
307600                  MOVE LENGTH OF PV-CICS-MSG-AREA2                30760000
307700                    TO PV-COMMAREA-LENGTH                         30770000
307800                  EXEC CICS                                       30780000
307900                       WRITEQ TD                                  30790000
308000                        QUEUE  ('CSSL')                           30800000
308100                         FROM  (PV-CICS-MSG-AREA2)                30810000
308200                       LENGTH  (PV-COMMAREA-LENGTH)               30820000
308300                         RESP  (PV-CICS-RESP)                     30830000
308400                  END-EXEC                                        30840000
308500                                                                  30850000
308600                  SET  PS-ERROR                                   30860000
308700                       PC166-CRA-DB-BUSY  TO  TRUE                30870000
308800                  MOVE 'GET MANIFEST NUMBER      '                30880000
308900                    TO PC166-CRA-RET-MSG                          30890000
309000              END-IF                                              30900000
309100                                                                  30910000
309200         WHEN OTHER                                               30920000
309300                                                                  30930000
309400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   30940000
309500             MOVE '5440-LINK-PCKCS721 '                           30950000
309600                                             TO PV-SOFT-PARAGRAPH 30960000
309700             STRING ' PCKCS719 - '           DELIMITED BY SIZE    30970000
309800                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    30980000
309900                    'STORE-'                 DELIMITED BY SIZE    30990000
310000                    PC187-STR-NBR            DELIMITED BY SIZE    31000000
310100                                           INTO PV-CICS-MSG-AREA2 31010000
310200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31020000
310300               TO PV-COMMAREA-LENGTH                              31030000
310400             EXEC CICS                                            31040000
310500                  WRITEQ TD                                       31050000
310600                   QUEUE  ('CSSL')                                31060000
310700                    FROM  (PV-CICS-MSG-AREA2)                     31070000
310800                  LENGTH  (PV-COMMAREA-LENGTH)                    31080000
310900                    RESP  (PV-CICS-RESP)                          31090000
311000             END-EXEC                                             31100000
311100             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              31110000
311200             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            31120000
311300             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            31130000
311400             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        31140000
311500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31150000
311600               TO PV-COMMAREA-LENGTH                              31160000
311700             EXEC CICS                                            31170000
311800                  WRITEQ TD                                       31180000
311900                   QUEUE  ('CSSL')                                31190000
312000                    FROM  (PV-CICS-MSG-AREA2)                     31200000
312100                  LENGTH  (PV-COMMAREA-LENGTH)                    31210000
312200                    RESP  (PV-CICS-RESP)                          31220000
312300             END-EXEC                                             31230000
312400                                                                  31240000
312500              SET  PS-ERROR                                       31250000
312600                   PC166-CRA-DB-BUSY  TO  TRUE                    31260000
312700              MOVE 'LOCATION GET MANIFEST NBR '                   31270024
312800                TO PC166-CRA-RET-MSG                              31280000
312900                                                                  31290000
313000     END-EVALUATE.                                                31300000
313100                                                                  31310000
313200                                                                  31320000
313300                                                                  31330000
313400*================================================================*31340000
313500* CREATE ENTRIES IN DISTRIBUTION HEADER & DETAIL TABLES          *31350000
313600*================================================================*31360000
313700 5500-CREATE-HDR-DTL-TBL.                                         31370000
313800                                                                  31380000
313900     PERFORM 5510-BUILD-TDISTHD.                                  31390000
314000     IF  PS-NO-ERROR                                              31400000
314100         IF  PC166-PRE-PACK-ORDER                                 31410000
314200             PERFORM 5700-PREPK-DISTHD                            31420000
314300         END-IF                                                   31430000
314400         MOVE PC166-PO-LNE-NBR        TO  DK-ORD-LNE-NBR          31440000
314500     END-IF.                                                      31450000
314600                                                                  31460000
314700     IF  PS-NO-ERROR                                              31470000
314800         PERFORM 5600-BUILD-TDISTDT                               31480000
314900     END-IF.                                                      31490000
315000                                                                  31500000
315100                                                                  31510000
315200*================================================================*31520000
315300* BUILD DISTHD TABLE ENTRY                                       *31530000
315400*================================================================*31540000
315500 5510-BUILD-TDISTHD.                                              31550000
315600     INITIALIZE DCLTDISTHD.                                       31560000
315700                                                                  31570000
315800     MOVE PC166-PO-NBR            TO  DK-PO-NBR.                  31580000
315900     MOVE PC166-RCVR-SEQ-NBR      TO  DK-RCVR-SEQ-NBR.            31590000
316000     MOVE PC166-PO-LNE-NBR        TO  DK-ORD-LNE-NBR              31600000
316100     MOVE PC-0001                 TO  DK-WORK-ORD-SEQ-NBR.        31610000
316200     MOVE PC166-OPER-UNT-ID       TO  DK-OPER-UNT-ID.             31620000
316300                                                                  31630000
316400     PERFORM 5520-UPDATE-HDR-ZEROES.                              31640000
316500                                                                  31650000
316600*  DMH 8/19/2004 --- BEGIN                                        31660013
316700                                                                  31670013
316800     IF  PS-NO-ERROR                                              31680013
316900         IF  PS-DISTHD-UPDATE                                     31690013
317000             PERFORM 5522-GET-PRC-CNT                             31700013
317100         ELSE                                                     31710013
317200             MOVE ZEROES  TO  DISTHD-VRTL-LBL-PRC-CNT             31720014
317300         END-IF                                                   31730013
317400     END-IF.                                                      31740013
317500                                                                  31750013
317600*  DMH 8/19/2004 --- END                                          31760013
317700                                                                  31770013
317800     IF  PS-NO-ERROR                                              31780000
317900         MOVE PC166-TOTAL-CARTONS  TO DISTHD-TOT-CART-CNT         31790000
318000         MOVE PV-P2L-CRTN-CNT      TO DISTHD-P2L-CART-CNT         31800000
318100         MOVE PV-FCSE-CRTN-CNT     TO DISTHD-FCSE-CART-CNT        31810000
318200         MOVE PC166-MOD-NBR        TO DISTHD-PRC-AREA-MODU-ID     31820000
318300         MOVE PC-U                 TO DISTHD-FCSE-LBL-TYP-CDE     31830000
318400         MOVE PC-F                 TO DISTHD-SYS-CRE-CDE          31840000
318500         MOVE PC166-INPK-UNT-QTY   TO DISTHD-INPK-UNT-QTY         31850000
318600         MOVE PV-INPK-CRTN-CNT     TO DISTHD-INPK-CART-CNT        31860000
318700         IF PC166-MULT-OTPK                                       31870000
318800             MOVE ZEROES           TO DISTHD-OTPK-UNT-QTY         31880000
318900         ELSE                                                     31890000
319000             MOVE PC166-OTPK-UNT-QTY TO DISTHD-OTPK-UNT-QTY       31900000
319100         END-IF                                                   31910000
319200                                                                  31920000
319300         MOVE PC166-INPK-CNVY-IND  TO DISTHD-INPK-CNVYB-IND       31930000
319400         MOVE PC166-SPEC-INST-DESC TO DISTHD-SPC-INSTR-DESC       31940000
319500         MOVE PC166-USER-ID        TO DISTHD-CRE-USR-ID           31950000
319600         MOVE PC-DOWNLOADED-STATUS TO DISTHD-PRCG-STAT-CDE        31960000
319700         MOVE PC-P2L-PROCESSOR     TO DISTHD-DISTRB-PRC-AREA-ID   31970000
319800         MOVE PC-DEFAULT-TIMESTAMP TO DISTHD-RSLTS-RCVD-TMST      31980000
319900         MOVE PC-DEFAULT-TIMESTAMP TO DISTHD-VRFD-TMST            31990000
320000         MOVE PC-DEFAULT-TIMESTAMP TO DISTHD-FCSE-CNFRMN-TMST     32000000
320100         MOVE PC166-FCSE-AREA      TO DISTHD-FCSE-FCLTY-AREA-ID   32010000
320200         MOVE ZEROES               TO DISTHD-ODD-CART-UNT-QTY     32020000
320300         MOVE PC166-CASEPACK-FUNCTION TO DISTHD-CRE-LBL-OPT-CDE   32030000
320400         MOVE PC166-PRCS-QTY       TO DISTHD-CAL-UNT-PRCD-QTY     32040000
320500         MOVE PC-U                 TO DISTHD-UCC128-DAT-USG-CDE   32050000
320600                                                                  32060000
320700         IF PS-DISTHD-UPDATE                                      32070000
320800             MOVE PC166-USER-ID    TO DISTHD-CART-DWNLD-USR-ID    32080000
320900         END-IF                                                   32090000
321000                                                                  32100000
321100         IF PC166-PRE-PACK-ORDER                                  32110000
321200             MOVE PC-PREPK-P2L-DWNLD TO DISTHD-PREPK-LNE-PRC-CDE  32120000
321300         ELSE                                                     32130000
321400             MOVE PC-NON-PREPK     TO DISTHD-PREPK-LNE-PRC-CDE    32140000
321500         END-IF                                                   32150000
321600                                                                  32160000
321700* 8/19/2004 - DMH BEGIN                                           32170013
321800                                                                  32180013
321900         ADD  1  TO   DISTHD-VRTL-LBL-PRC-CNT                     32190014
322000                                                                  32200013
322100* 8/19/2004 - DMH END                                             32210013
322200                                                                  32220013
322300         IF PS-DISTHD-UPDATE                                      32230000
322400             PERFORM 5535-UPDATE-HEADER                           32240000
322500         ELSE                                                     32250000
322600         IF PS-DISTHD-INSERT                                      32260000
322700             PERFORM 5536-INSERT-HEADER                           32270000
322800         END-IF                                                   32280000
322900         END-IF                                                   32290000
323000     END-IF.                                                      32300000
323100                                                                  32310000
323200                                                                  32320000
323300*----------------------------------------------------------------*32330000
323400* THIS PARAGRAPH WILL RESET ALL VALUES IN DISTHD.  IF FOUND      *32340000
323500* DELETE ALL CORESPONDING DISTDT RECORDS AND SET PS-DISTHD-UPDATE*32350000
323600* TO TRUE                                                        *32360000
323700* IF NO RECORD WAS FOUND ON UPDATE SET PS-DISTHD-INSERT TO TRUE  *32370000
323800*----------------------------------------------------------------*32380000
323900 5520-UPDATE-HDR-ZEROES.                                          32390000
324000                                                                  32400000
324100     MOVE  SPACE  TO  PS-INSERT-UPDATE-SW.                        32410000
324200                                                                  32420000
324300     PERFORM 5530-DEL-UPD-HEADER.                                 32430000
324400                                                                  32440000
324500     IF  PS-DISTHD-UPDATE                                         32450000
324600         PERFORM 5527-DELETE-DETAIL                               32460000
324700         IF  PS-NO-ERROR                                          32470000
324800             IF  PC166-PRE-PACK-ORDER                             32480000
324900                 PERFORM  5540-DEL-PREPK-DTL                      32490000
325000             END-IF                                               32500000
325100         END-IF                                                   32510000
325200     END-IF.                                                      32520000
325300                                                                  32530000
325400                                                                  32540000
325500*----------------------------------------------------------------*32550013
325600* THIS PARAGRAPH WILL GET THE LABEL PROCESS COUNTS               *32560013
325700*----------------------------------------------------------------*32570013
325800 5522-GET-PRC-CNT.                                                32580013
325900                                                                  32590013
326000     EXEC SQL                                                     32600015
326100          SELECT  VRTL_LBL_PRC_CNT                                32610013
326200            INTO  :DISTHD-VRTL-LBL-PRC-CNT                        32620014
326300            FROM  TDISTHD                                         32630013
326400           WHERE ORD_NBR           = :DK-PO-NBR                   32640013
326500             AND RCVR_SEQ_NBR      = :DK-RCVR-SEQ-NBR             32650013
326600             AND ORD_LNE_NBR       = :DK-ORD-LNE-NBR              32660013
326700     END-EXEC.                                                    32670013
326800                                                                  32680013
326900     EVALUATE TRUE                                                32690013
327000         WHEN SQLCODE = ZERO                                      32700013
327100         WHEN SQLCODE = +100                                      32710013
327200              CONTINUE                                            32720013
327300         WHEN SQLCODE = -904                                      32730013
327400         WHEN SQLCODE = -911                                      32740013
327500         WHEN SQLCODE = -913                                      32750013
327600                                                                  32760013
327700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   32770013
327800             MOVE '5522-GET-PRC-CNT   '                           32780013
327900                                             TO PV-SOFT-PARAGRAPH 32790013
328000             STRING ' PCKCS719 - '           DELIMITED BY SIZE    32800013
328100                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    32810013
328200                                           INTO PV-CICS-MSG-AREA2 32820013
328300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     32830013
328400               TO PV-COMMAREA-LENGTH                              32840013
328500             EXEC CICS                                            32850013
328600                  WRITEQ TD                                       32860013
328700                   QUEUE  ('CSSL')                                32870013
328800                    FROM  (PV-CICS-MSG-AREA2)                     32880013
328900                  LENGTH  (PV-COMMAREA-LENGTH)                    32890013
329000                    RESP  (PV-CICS-RESP)                          32900013
329100             END-EXEC                                             32910013
329200             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              32920013
329300             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            32930013
329400             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            32940013
329500             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        32950013
329600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     32960013
329700               TO PV-COMMAREA-LENGTH                              32970013
329800             EXEC CICS                                            32980013
329900                  WRITEQ TD                                       32990013
330000                   QUEUE  ('CSSL')                                33000013
330100                    FROM  (PV-CICS-MSG-AREA2)                     33010013
330200                  LENGTH  (PV-COMMAREA-LENGTH)                    33020013
330300                    RESP  (PV-CICS-RESP)                          33030013
330400             END-EXEC                                             33040013
330500                                                                  33050013
330600              SET  PS-ERROR                                       33060013
330700                   PC166-CRA-DB-BUSY  TO  TRUE                    33070013
330800              MOVE 'TDISTHD RESET TO ZERO    '                    33080013
330900                TO PC166-CRA-RET-MSG                              33090013
331000                                                                  33100013
331100         WHEN SQLWARN0 NOT = SPACES                               33110013
331200         WHEN SQLCODE NOT EQUAL ZERO                              33120013
331300                                                                  33130013
331400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   33140013
331500             MOVE '5522-GET-PRC-CNT   '                           33150013
331600                                             TO PV-SOFT-PARAGRAPH 33160013
331700             STRING ' PCKCS719 - '           DELIMITED BY SIZE    33170013
331800                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    33180013
331900                                           INTO PV-CICS-MSG-AREA2 33190013
332000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33200013
332100               TO PV-COMMAREA-LENGTH                              33210013
332200             EXEC CICS                                            33220013
332300                  WRITEQ TD                                       33230013
332400                   QUEUE  ('CSSL')                                33240013
332500                    FROM  (PV-CICS-MSG-AREA2)                     33250013
332600                  LENGTH  (PV-COMMAREA-LENGTH)                    33260013
332700                    RESP  (PV-CICS-RESP)                          33270013
332800             END-EXEC                                             33280013
332900             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              33290013
333000             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            33300013
333100             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            33310013
333200             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        33320013
333300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33330013
333400               TO PV-COMMAREA-LENGTH                              33340013
333500             EXEC CICS                                            33350013
333600                  WRITEQ TD                                       33360013
333700                   QUEUE  ('CSSL')                                33370013
333800                    FROM  (PV-CICS-MSG-AREA2)                     33380013
333900                  LENGTH  (PV-COMMAREA-LENGTH)                    33390013
334000                    RESP  (PV-CICS-RESP)                          33400013
334100             END-EXEC                                             33410013
334200                                                                  33420013
334300              SET  PS-ERROR                                       33430013
334400                   PC166-CRA-DB-BUSY  TO  TRUE                    33440013
334500              MOVE 'TDISTHD RESET TO ZERO    '                    33450013
334600                TO PC166-CRA-RET-MSG                              33460013
334700                                                                  33470013
334800     END-EVALUATE.                                                33480013
334900                                                                  33490013
335000                                                                  33500013
335100                                                                  33510013
335200                                                                  33520013
335300*----------------------------------------------------------------*33530013
335400*                                                                 33540000
335500*----------------------------------------------------------------*33550000
335600 5527-DELETE-DETAIL.                                              33560000
335700                                                                  33570000
335800     EXEC SQL                                                     33580000
335900          DELETE FROM TDISTDT                                     33590000
336000           WHERE ORD_NBR         = :DK-PO-NBR                     33600000
336100             AND RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               33610000
336200             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                33620000
336300     END-EXEC.                                                    33630000
336400                                                                  33640000
336500     EVALUATE TRUE                                                33650000
336600         WHEN SQLCODE = ZERO                                      33660000
336700         WHEN SQLCODE = +100                                      33670000
336800                  CONTINUE                                        33680000
336900         WHEN SQLCODE = -904                                      33690000
337000         WHEN SQLCODE = -911                                      33700000
337100         WHEN SQLCODE = -913                                      33710000
337200                                                                  33720000
337300             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   33730000
337400             MOVE '5527-DELETE-DETAIL '                           33740000
337500                                             TO PV-SOFT-PARAGRAPH 33750000
337600             STRING ' PCKCS719 - '           DELIMITED BY SIZE    33760000
337700                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    33770000
337800                                           INTO PV-CICS-MSG-AREA2 33780000
337900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33790000
338000               TO PV-COMMAREA-LENGTH                              33800000
338100             EXEC CICS                                            33810000
338200                  WRITEQ TD                                       33820000
338300                   QUEUE  ('CSSL')                                33830000
338400                    FROM  (PV-CICS-MSG-AREA2)                     33840000
338500                  LENGTH  (PV-COMMAREA-LENGTH)                    33850000
338600                    RESP  (PV-CICS-RESP)                          33860000
338700             END-EXEC                                             33870000
338800             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              33880000
338900             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            33890000
339000             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            33900000
339100             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        33910000
339200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33920000
339300               TO PV-COMMAREA-LENGTH                              33930000
339400             EXEC CICS                                            33940000
339500                  WRITEQ TD                                       33950000
339600                   QUEUE  ('CSSL')                                33960000
339700                    FROM  (PV-CICS-MSG-AREA2)                     33970000
339800                  LENGTH  (PV-COMMAREA-LENGTH)                    33980000
339900                    RESP  (PV-CICS-RESP)                          33990000
340000             END-EXEC                                             34000000
340100                                                                  34010000
340200              SET  PS-ERROR                                       34020000
340300                   PC166-CRA-DB-BUSY  TO  TRUE                    34030000
340400              MOVE 'TDISTDT DELETE DISTRO    '                    34040000
340500                TO PC166-CRA-RET-MSG                              34050000
340600                                                                  34060000
340700                                                                  34070000
340800     END-EVALUATE.                                                34080000
340900                                                                  34090000
341000                                                                  34100000
341100*----------------------------------------------------------------*34110000
341200*  UPDATE TRANSACTION HEADER ROW FOR THIS PO/RCVR/LINE            34120000
341300*----------------------------------------------------------------*34130000
341400 5530-DEL-UPD-HEADER.                                             34140000
341500                                                                  34150000
341600     MOVE SPACES                  TO DISTHD-CART-DWNLD-USR-ID     34160000
341700                                     DISTHD-CRE-USR-ID            34170000
341800                                     DISTHD-SYS-CRE-CDE           34180000
341900                                     DISTHD-PRC-AREA-MODU-ID      34190000
342000                                     DISTHD-FCSE-LBL-TYP-CDE      34200000
342100                                     DISTHD-SPC-INSTR-DESC        34210000
342200                                     DISTHD-INPK-CNVYB-IND        34220000
342300                                     DISTHD-FCSE-CNFRMN-PGM-ID    34230000
342400                                     DISTHD-UCC128-DAT-USG-CDE.   34240000
342500                                                                  34250000
342600     MOVE ZERO                    TO DISTHD-TOT-CART-CNT          34260000
342700                                     DISTHD-FCSE-CART-CNT         34270000
342800                                     DISTHD-P2L-CART-CNT          34280000
342900                                     DISTHD-INPK-CART-CNT         34290000
343000                                     DISTHD-INPK-UNT-QTY          34300000
343100                                     DISTHD-OTPK-UNT-QTY          34310000
343200                                     DISTHD-ODD-CART-UNT-QTY      34320000
343300                                     DISTHD-CAL-UNT-PRCD-QTY.     34330000
343400                                                                  34340000
343500     EXEC SQL                                                     34350000
343600          UPDATE TDISTHD                                          34360000
343700             SET                                                  34370000
343800                 PRC_AREA_MODU_ID  = :DISTHD-PRC-AREA-MODU-ID     34380000
343900               , TOT_CART_CNT      = :DISTHD-TOT-CART-CNT         34390000
344000               , P2L_CART_CNT      = :DISTHD-P2L-CART-CNT         34400000
344100               , CRE_USR_ID        = :DISTHD-CRE-USR-ID           34410000
344200               , SYS_CRE_CDE       = :DISTHD-SYS-CRE-CDE          34420000
344300               , INPK_UNT_QTY      = :DISTHD-INPK-UNT-QTY         34430000
344400               , OTPK_UNT_QTY      = :DISTHD-OTPK-UNT-QTY         34440000
344500               , SPC_INSTR_DESC    = :DISTHD-SPC-INSTR-DESC       34450000
344600               , FCSE_CART_CNT     = :DISTHD-FCSE-CART-CNT        34460000
344700               , FCSE_LBL_TYP_CDE  = :DISTHD-FCSE-LBL-TYP-CDE     34470000
344800               , INPK_CART_CNT     = :DISTHD-INPK-CART-CNT        34480000
344900               , CART_DWNLD_DTE    = :PC-DEFAULT-DTE              34490000
345000               , CART_DWNLD_TM     = :PC-DEFAULT-TM               34500000
345100               ,CART_DWNLD_USR_ID  = :DISTHD-CART-DWNLD-USR-ID    34510000
345200               ,INPK_CNVYB_IND     = :DISTHD-INPK-CNVYB-IND       34520000
345300               ,FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID   34530000
345400               ,ODD_CART_UNT_QTY   = :DISTHD-ODD-CART-UNT-QTY     34540000
345500               ,CAL_UNT_PRCD_QTY   = :DISTHD-CAL-UNT-PRCD-QTY     34550000
345600               ,UCC128_DAT_USG_CDE = :DISTHD-UCC128-DAT-USG-CDE   34560000
345700           WHERE ORD_NBR           = :DK-PO-NBR                   34570000
345800             AND RCVR_SEQ_NBR      = :DK-RCVR-SEQ-NBR             34580000
345900             AND ORD_LNE_NBR       = :DK-ORD-LNE-NBR              34590000
346000     END-EXEC.                                                    34600000
346100                                                                  34610000
346200     EVALUATE TRUE                                                34620000
346300         WHEN SQLCODE = ZERO                                      34630000
346400              SET PS-DISTHD-UPDATE   TO  TRUE                     34640000
346500         WHEN SQLCODE = +100                                      34650000
346600              SET PS-DISTHD-INSERT   TO  TRUE                     34660000
346700         WHEN SQLCODE = -904                                      34670000
346800         WHEN SQLCODE = -911                                      34680000
346900         WHEN SQLCODE = -913                                      34690000
347000                                                                  34700000
347100             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   34710000
347200             MOVE '5530-DEL-UPD-HEADER'                           34720000
347300                                             TO PV-SOFT-PARAGRAPH 34730000
347400             STRING ' PCKCS719 - '           DELIMITED BY SIZE    34740000
347500                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    34750000
347600                                           INTO PV-CICS-MSG-AREA2 34760000
347700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     34770000
347800               TO PV-COMMAREA-LENGTH                              34780000
347900             EXEC CICS                                            34790000
348000                  WRITEQ TD                                       34800000
348100                   QUEUE  ('CSSL')                                34810000
348200                    FROM  (PV-CICS-MSG-AREA2)                     34820000
348300                  LENGTH  (PV-COMMAREA-LENGTH)                    34830000
348400                    RESP  (PV-CICS-RESP)                          34840000
348500             END-EXEC                                             34850000
348600             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              34860000
348700             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            34870000
348800             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            34880000
348900             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        34890000
349000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     34900000
349100               TO PV-COMMAREA-LENGTH                              34910000
349200             EXEC CICS                                            34920000
349300                  WRITEQ TD                                       34930000
349400                   QUEUE  ('CSSL')                                34940000
349500                    FROM  (PV-CICS-MSG-AREA2)                     34950000
349600                  LENGTH  (PV-COMMAREA-LENGTH)                    34960000
349700                    RESP  (PV-CICS-RESP)                          34970000
349800             END-EXEC                                             34980000
349900                                                                  34990000
350000              SET  PS-ERROR                                       35000000
350100                   PC166-CRA-DB-BUSY  TO  TRUE                    35010000
350200              MOVE 'TDISTHD RESET TO ZERO    '                    35020000
350300                TO PC166-CRA-RET-MSG                              35030000
350400                                                                  35040000
350500         WHEN SQLWARN0 NOT = SPACES                               35050000
350600         WHEN SQLCODE NOT EQUAL ZERO                              35060000
350700                                                                  35070000
350800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   35080000
350900             MOVE '5530-DEL-UPD-HEADER'                           35090000
351000                                             TO PV-SOFT-PARAGRAPH 35100000
351100             STRING ' PCKCS719 - '           DELIMITED BY SIZE    35110000
351200                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    35120000
351300                                           INTO PV-CICS-MSG-AREA2 35130000
351400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     35140000
351500               TO PV-COMMAREA-LENGTH                              35150000
351600             EXEC CICS                                            35160000
351700                  WRITEQ TD                                       35170000
351800                   QUEUE  ('CSSL')                                35180000
351900                    FROM  (PV-CICS-MSG-AREA2)                     35190000
352000                  LENGTH  (PV-COMMAREA-LENGTH)                    35200000
352100                    RESP  (PV-CICS-RESP)                          35210000
352200             END-EXEC                                             35220000
352300             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              35230000
352400             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            35240000
352500             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            35250000
352600             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        35260000
352700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     35270000
352800               TO PV-COMMAREA-LENGTH                              35280000
352900             EXEC CICS                                            35290000
353000                  WRITEQ TD                                       35300000
353100                   QUEUE  ('CSSL')                                35310000
353200                    FROM  (PV-CICS-MSG-AREA2)                     35320000
353300                  LENGTH  (PV-COMMAREA-LENGTH)                    35330000
353400                    RESP  (PV-CICS-RESP)                          35340000
353500             END-EXEC                                             35350000
353600                                                                  35360000
353700              SET  PS-ERROR                                       35370000
353800                   PC166-CRA-DB-BUSY  TO  TRUE                    35380000
353900              MOVE 'TDISTHD RESET TO ZERO    '                    35390000
354000                TO PC166-CRA-RET-MSG                              35400000
354100                                                                  35410000
354200     END-EVALUATE.                                                35420000
354300                                                                  35430000
354400                                                                  35440000
354500*----------------------------------------------------------------*35450000
354600*                                                                 35460000
354700*----------------------------------------------------------------*35470000
354800 5535-UPDATE-HEADER.                                              35480000
354900                                                                  35490000
355000     EXEC SQL                                                     35500000
355100          UPDATE TDISTHD                                          35510000
355200             SET                                                  35520000
355300                 TOT_CART_CNT        = :DISTHD-TOT-CART-CNT       35530000
355400               , P2L_CART_CNT        = :DISTHD-P2L-CART-CNT       35540000
355500               , INPK_UNT_QTY        = :DISTHD-INPK-UNT-QTY       35550000
355600               , OTPK_UNT_QTY        = :DISTHD-OTPK-UNT-QTY       35560000
355700               , CART_DWNLD_USR_ID   = :DISTHD-CART-DWNLD-USR-ID  35570000
355800               , FCSE_CART_CNT       = :DISTHD-FCSE-CART-CNT      35580000
355900               , INPK_CART_CNT       = :DISTHD-INPK-CART-CNT      35590000
356000               , PRC_AREA_MODU_ID    = :DISTHD-PRC-AREA-MODU-ID   35600000
356100               , PRCG_STAT_CDE       = :DISTHD-PRCG-STAT-CDE      35610000
356200               , CRE_USR_ID          = :PC166-USER-ID             35620000
356300               , CART_DWNLD_DTE      =  CURRENT DATE              35630000
356400               , CART_DWNLD_TM       =  CURRENT TIME              35640000
356500               , FCSE_LBL_TYP_CDE    = :DISTHD-FCSE-LBL-TYP-CDE   35650000
356600               , INPK_CNVYB_IND      = :DISTHD-INPK-CNVYB-IND     35660000
356700               , SYS_CRE_CDE         = :DISTHD-SYS-CRE-CDE        35670000
356800               , CRE_TMST            =  CURRENT TIMESTAMP         35680000
356900               , FCSE_FCLTY_AREA_ID  = :DISTHD-FCSE-FCLTY-AREA-ID 35690000
357000               , CRE_LBL_OPT_CDE     = :DISTHD-CRE-LBL-OPT-CDE    35700000
357100               , ODD_CART_UNT_QTY    = :DISTHD-ODD-CART-UNT-QTY   35710000
357200               , PREPK_LNE_PRC_CDE   = :DISTHD-PREPK-LNE-PRC-CDE  35720000
357300               , CAL_UNT_PRCD_QTY    = :DISTHD-CAL-UNT-PRCD-QTY   35730000
357400               , UCC128_DAT_USG_CDE  = :DISTHD-UCC128-DAT-USG-CDE 35740000
357500               , VRTL_LBL_PRC_CNT    = :DISTHD-VRTL-LBL-PRC-CNT   35750015
357600           WHERE ORD_NBR             = :DK-PO-NBR                 35760000
357700             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           35770000
357800             AND ORD_LNE_NBR         = :DK-ORD-LNE-NBR            35780000
357900     END-EXEC.                                                    35790000
358000                                                                  35800000
358100     EVALUATE TRUE                                                35810000
358200         WHEN SQLCODE = ZERO                                      35820000
358300              CONTINUE                                            35830000
358400         WHEN SQLCODE = +100                                      35840000
358500              PERFORM 5536-INSERT-HEADER                          35850000
358600                                                                  35860000
358700         WHEN SQLCODE = -904                                      35870000
358800         WHEN SQLCODE = -911                                      35880000
358900         WHEN SQLCODE = -913                                      35890000
359000                                                                  35900000
359100             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   35910000
359200             MOVE '5535-UPDATE-HEADER '                           35920000
359300                                             TO PV-SOFT-PARAGRAPH 35930000
359400             STRING ' PCKCS719 - '           DELIMITED BY SIZE    35940000
359500                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    35950000
359600                                           INTO PV-CICS-MSG-AREA2 35960000
359700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     35970000
359800               TO PV-COMMAREA-LENGTH                              35980000
359900             EXEC CICS                                            35990000
360000                  WRITEQ TD                                       36000000
360100                   QUEUE  ('CSSL')                                36010000
360200                    FROM  (PV-CICS-MSG-AREA2)                     36020000
360300                  LENGTH  (PV-COMMAREA-LENGTH)                    36030000
360400                    RESP  (PV-CICS-RESP)                          36040000
360500             END-EXEC                                             36050000
360600             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              36060000
360700             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            36070000
360800             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            36080000
360900             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        36090000
361000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     36100000
361100               TO PV-COMMAREA-LENGTH                              36110000
361200             EXEC CICS                                            36120000
361300                  WRITEQ TD                                       36130000
361400                   QUEUE  ('CSSL')                                36140000
361500                    FROM  (PV-CICS-MSG-AREA2)                     36150000
361600                  LENGTH  (PV-COMMAREA-LENGTH)                    36160000
361700                    RESP  (PV-CICS-RESP)                          36170000
361800             END-EXEC                                             36180000
361900                                                                  36190000
362000              SET  PS-ERROR                                       36200000
362100                   PC166-CRA-DB-BUSY  TO  TRUE                    36210000
362200              MOVE 'TDISTHD UPDATE COUNTS    '                    36220000
362300                TO PC166-CRA-RET-MSG                              36230000
362400                                                                  36240000
362500         WHEN SQLWARN0 NOT = SPACES                               36250000
362600         WHEN SQLCODE NOT EQUAL ZERO                              36260000
362700                                                                  36270000
362800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   36280000
362900             MOVE '5535-UPDATE-HEADER '                           36290000
363000                                             TO PV-SOFT-PARAGRAPH 36300000
363100             STRING ' PCKCS719 - '           DELIMITED BY SIZE    36310000
363200                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    36320000
363300                                           INTO PV-CICS-MSG-AREA2 36330000
363400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     36340000
363500               TO PV-COMMAREA-LENGTH                              36350000
363600             EXEC CICS                                            36360000
363700                  WRITEQ TD                                       36370000
363800                   QUEUE  ('CSSL')                                36380000
363900                    FROM  (PV-CICS-MSG-AREA2)                     36390000
364000                  LENGTH  (PV-COMMAREA-LENGTH)                    36400000
364100                    RESP  (PV-CICS-RESP)                          36410000
364200             END-EXEC                                             36420000
364300             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              36430000
364400             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            36440000
364500             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            36450000
364600             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        36460000
364700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     36470000
364800               TO PV-COMMAREA-LENGTH                              36480000
364900             EXEC CICS                                            36490000
365000                  WRITEQ TD                                       36500000
365100                   QUEUE  ('CSSL')                                36510000
365200                    FROM  (PV-CICS-MSG-AREA2)                     36520000
365300                  LENGTH  (PV-COMMAREA-LENGTH)                    36530000
365400                    RESP  (PV-CICS-RESP)                          36540000
365500             END-EXEC                                             36550000
365600                                                                  36560000
365700              SET  PS-ERROR                                       36570000
365800                   PC166-CRA-DB-BUSY  TO  TRUE                    36580000
365900              MOVE 'TDISTHD UPDATE COUNTS    '                    36590000
366000                TO PC166-CRA-RET-MSG                              36600000
366100     END-EVALUATE.                                                36610000
366200                                                                  36620000
366300                                                                  36630000
366400*----------------------------------------------------------------*36640000
366500*                                                                 36650000
366600*----------------------------------------------------------------*36660000
366700 5536-INSERT-HEADER.                                              36670000
366800                                                                  36680000
366900     MOVE  PC-DEFAULT-TIMESTAMP  TO  DISTHD-FCSE-CNFRMN-TMST.     36690000
367000     MOVE  PC-DEFAULT-TIMESTAMP  TO  DISTHD-DLT-REQ-TMST.         36700000
367100                                                                  36710000
367200     EXEC SQL                                                     36720000
367300          INSERT INTO TDISTHD                                     36730000
367400           ( ORD_NBR                                              36740000
367500            ,RCVR_SEQ_NBR                                         36750000
367600            ,ORD_LNE_NBR                                          36760000
367700            ,WRK_ORD_SEQ_NBR                                      36770000
367800            ,OPER_UNT_ID                                          36780000
367900            ,DISTRB_PRC_AREA_ID                                   36790000
368000            ,PRCG_STAT_CDE                                        36800000
368100            ,CRE_TMST                                             36810000
368200            ,RSLTS_RCVD_TMST                                      36820000
368300            ,VRFD_TMST                                            36830000
368400            ,PRC_AREA_MODU_ID                                     36840000
368500            ,CRE_USR_ID                                           36850000
368600            ,TOT_CART_CNT                                         36860000
368700            ,CART_DWNLD_DTE                                       36870000
368800            ,CART_DWNLD_TM                                        36880000
368900            ,CART_DWNLD_USR_ID                                    36890000
369000            ,FCSE_CART_CNT                                        36900000
369100            ,FCSE_LBL_TYP_CDE                                     36910000
369200            ,P2L_CART_CNT                                         36920000
369300            ,INPK_CART_CNT                                        36930000
369400            ,INPK_UNT_QTY                                         36940000
369500            ,INPK_CNVYB_IND                                       36950000
369600            ,OTPK_UNT_QTY                                         36960000
369700            ,SYS_CRE_CDE                                          36970000
369800            ,SPC_INSTR_DESC                                       36980000
369900            ,FCSE_CNFRMN_TMST                                     36990000
370000            ,FCSE_FCLTY_AREA_ID                                   37000000
370100            ,CRE_LBL_OPT_CDE                                      37010000
370200            ,ODD_CART_UNT_QTY                                     37020000
370300            ,DLT_REQ_TMST                                         37030000
370400            ,PREPK_LNE_PRC_CDE                                    37040000
370500            ,CAL_UNT_PRCD_QTY                                     37050000
370600            ,UCC128_DAT_USG_CDE                                   37060000
370700            ,VRTL_LBL_PRC_CNT                                     37070015
370800           )                                                      37080000
370900         VALUES (                                                 37090000
371000             :DK-PO-NBR                                           37100000
371100           , :DK-RCVR-SEQ-NBR                                     37110000
371200           , :DK-ORD-LNE-NBR                                      37120000
371300           , :DK-WORK-ORD-SEQ-NBR                                 37130000
371400           , :DK-OPER-UNT-ID                                      37140000
371500           , :DISTHD-DISTRB-PRC-AREA-ID                           37150000
371600           , :DISTHD-PRCG-STAT-CDE                                37160000
371700           ,  CURRENT TIMESTAMP                                   37170000
371800           , :DISTHD-RSLTS-RCVD-TMST                              37180000
371900           , :DISTHD-VRFD-TMST                                    37190000
372000           , :DISTHD-PRC-AREA-MODU-ID                             37200000
372100           , :DISTHD-CRE-USR-ID                                   37210000
372200           , :DISTHD-TOT-CART-CNT                                 37220000
372300           ,  CURRENT DATE                                        37230000
372400           ,  CURRENT TIME                                        37240000
372500           , :PC166-USER-ID                                       37250000
372600           , :DISTHD-FCSE-CART-CNT                                37260000
372700           , :DISTHD-FCSE-LBL-TYP-CDE                             37270000
372800           , :DISTHD-P2L-CART-CNT                                 37280000
372900           , :DISTHD-INPK-CART-CNT                                37290000
373000           , :DISTHD-INPK-UNT-QTY                                 37300000
373100           , :DISTHD-INPK-CNVYB-IND                               37310000
373200           , :DISTHD-OTPK-UNT-QTY                                 37320000
373300           , :DISTHD-SYS-CRE-CDE                                  37330000
373400           , :DISTHD-SPC-INSTR-DESC                               37340000
373500           , :DISTHD-FCSE-CNFRMN-TMST                             37350000
373600           , :DISTHD-FCSE-FCLTY-AREA-ID                           37360000
373700           , :DISTHD-CRE-LBL-OPT-CDE                              37370000
373800           , :DISTHD-ODD-CART-UNT-QTY                             37380000
373900           , :DISTHD-DLT-REQ-TMST                                 37390000
374000           , :DISTHD-PREPK-LNE-PRC-CDE                            37400000
374100           , :DISTHD-CAL-UNT-PRCD-QTY                             37410000
374200           , :DISTHD-UCC128-DAT-USG-CDE                           37420000
374300           , :DISTHD-VRTL-LBL-PRC-CNT                             37430014
374400         )                                                        37440000
374500     END-EXEC.                                                    37450000
374600                                                                  37460000
374700     EVALUATE TRUE                                                37470000
374800         WHEN SQLCODE = ZERO                                      37480000
374900              CONTINUE                                            37490000
375000                                                                  37500000
375100         WHEN SQLCODE = -803                                      37510000
375200              PERFORM 5535-UPDATE-HEADER                          37520000
375300                                                                  37530000
375400         WHEN SQLCODE = -904                                      37540000
375500         WHEN SQLCODE = -911                                      37550000
375600         WHEN SQLCODE = -913                                      37560000
375700                                                                  37570000
375800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   37580000
375900             MOVE '5536-INSERT-HEADER'                            37590000
376000                                             TO PV-SOFT-PARAGRAPH 37600000
376100             STRING ' PCKCS719 - '           DELIMITED BY SIZE    37610000
376200                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    37620000
376300                                           INTO PV-CICS-MSG-AREA2 37630000
376400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     37640000
376500               TO PV-COMMAREA-LENGTH                              37650000
376600             EXEC CICS                                            37660000
376700                  WRITEQ TD                                       37670000
376800                   QUEUE  ('CSSL')                                37680000
376900                    FROM  (PV-CICS-MSG-AREA2)                     37690000
377000                  LENGTH  (PV-COMMAREA-LENGTH)                    37700000
377100                    RESP  (PV-CICS-RESP)                          37710000
377200             END-EXEC                                             37720000
377300             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              37730000
377400             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            37740000
377500             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            37750000
377600             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        37760000
377700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     37770000
377800               TO PV-COMMAREA-LENGTH                              37780000
377900             EXEC CICS                                            37790000
378000                  WRITEQ TD                                       37800000
378100                   QUEUE  ('CSSL')                                37810000
378200                    FROM  (PV-CICS-MSG-AREA2)                     37820000
378300                  LENGTH  (PV-COMMAREA-LENGTH)                    37830000
378400                    RESP  (PV-CICS-RESP)                          37840000
378500             END-EXEC                                             37850000
378600                                                                  37860000
378700              SET  PS-ERROR                                       37870000
378800                   PC166-CRA-DB-BUSY  TO  TRUE                    37880000
378900              MOVE 'TDISTHD INSERT           '                    37890000
379000                TO PC166-CRA-RET-MSG                              37900000
379100                                                                  37910000
379200         WHEN SQLWARN0 NOT = SPACES                               37920000
379300         WHEN SQLCODE NOT EQUAL ZERO                              37930000
379400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   37940000
379500             MOVE '5536-INSERT-HEADER'                            37950000
379600                                             TO PV-SOFT-PARAGRAPH 37960000
379700             STRING ' PCKCS719 - '           DELIMITED BY SIZE    37970000
379800                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    37980000
379900                                           INTO PV-CICS-MSG-AREA2 37990000
380000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     38000000
380100               TO PV-COMMAREA-LENGTH                              38010000
380200             EXEC CICS                                            38020000
380300                  WRITEQ TD                                       38030000
380400                   QUEUE  ('CSSL')                                38040000
380500                    FROM  (PV-CICS-MSG-AREA2)                     38050000
380600                  LENGTH  (PV-COMMAREA-LENGTH)                    38060000
380700                    RESP  (PV-CICS-RESP)                          38070000
380800             END-EXEC                                             38080000
380900             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              38090000
381000             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            38100000
381100             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            38110000
381200             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        38120000
381300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     38130000
381400               TO PV-COMMAREA-LENGTH                              38140000
381500             EXEC CICS                                            38150000
381600                  WRITEQ TD                                       38160000
381700                   QUEUE  ('CSSL')                                38170000
381800                    FROM  (PV-CICS-MSG-AREA2)                     38180000
381900                  LENGTH  (PV-COMMAREA-LENGTH)                    38190000
382000                    RESP  (PV-CICS-RESP)                          38200000
382100             END-EXEC                                             38210000
382200                                                                  38220000
382300              SET  PS-ERROR                                       38230000
382400                   PC166-CRA-DB-BUSY  TO  TRUE                    38240000
382500              MOVE 'TDISTHD INSERT           '                    38250000
382600                TO PC166-CRA-RET-MSG                              38260000
382700     END-EVALUATE.                                                38270000
382800                                                                  38280000
382900                                                                  38290000
383000*----------------------------------------------------------------*38300000
383100*  ROUTINE TO DELETE DETAIL ROWS ASSOCIATED WITH PREPACK          38310000
383200*----------------------------------------------------------------*38320000
383300 5540-DEL-PREPK-DTL.                                              38330000
383400                                                                  38340000
383500     SET  PS-PREPK-LINES-LEFT TO TRUE.                            38350000
383600     PERFORM 5545-OPEN-DEL-PREPK-CSR.                             38360000
383700     PERFORM 5550-FETCH-DEL-PREPK-CSR                             38370000
383800       UNTIL PS-ERROR                                             38380000
383900          OR PS-NO-PREPK-LINES-LEFT.                              38390000
384000     PERFORM 5555-CLOSE-DEL-PREPK-CSR.                            38400000
384100                                                                  38410000
384200                                                                  38420000
384300*----------------------------------------------------------------*38430000
384400***OPEN DELETE DETAIL CURSOR FOR PREPACKS                         38440000
384500*----------------------------------------------------------------*38450000
384600 5545-OPEN-DEL-PREPK-CSR.                                         38460000
384700                                                                  38470000
384800     EXEC SQL                                                     38480000
384900          OPEN PRE_PACK_DEL_CSR                                   38490000
385000     END-EXEC.                                                    38500000
385100                                                                  38510000
385200     EVALUATE TRUE                                                38520000
385300         WHEN SQLCODE = ZERO                                      38530000
385400             CONTINUE                                             38540000
385500         WHEN SQLCODE = -904                                      38550000
385600         WHEN SQLCODE = -911                                      38560000
385700         WHEN SQLCODE = -913                                      38570000
385800                                                                  38580000
385900             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   38590000
386000             MOVE '5545-OPEN-DEL-PREPK-CSR '                      38600000
386100                                             TO PV-SOFT-PARAGRAPH 38610000
386200             STRING ' PCKCS719 - '           DELIMITED BY SIZE    38620000
386300                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    38630000
386400                                           INTO PV-CICS-MSG-AREA2 38640000
386500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     38650000
386600               TO PV-COMMAREA-LENGTH                              38660000
386700             EXEC CICS                                            38670000
386800                  WRITEQ TD                                       38680000
386900                   QUEUE  ('CSSL')                                38690000
387000                    FROM  (PV-CICS-MSG-AREA2)                     38700000
387100                  LENGTH  (PV-COMMAREA-LENGTH)                    38710000
387200                    RESP  (PV-CICS-RESP)                          38720000
387300             END-EXEC                                             38730000
387400             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              38740000
387500             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            38750000
387600             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            38760000
387700             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        38770000
387800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     38780000
387900               TO PV-COMMAREA-LENGTH                              38790000
388000             EXEC CICS                                            38800000
388100                  WRITEQ TD                                       38810000
388200                   QUEUE  ('CSSL')                                38820000
388300                    FROM  (PV-CICS-MSG-AREA2)                     38830000
388400                  LENGTH  (PV-COMMAREA-LENGTH)                    38840000
388500                    RESP  (PV-CICS-RESP)                          38850000
388600             END-EXEC                                             38860000
388700                                                                  38870000
388800              SET  PS-ERROR                                       38880000
388900                   PC166-CRA-DB-BUSY  TO  TRUE                    38890000
389000              MOVE 'OPEN PREPK CURSOR           '                 38900000
389100                TO PC166-CRA-RET-MSG                              38910000
389200                                                                  38920000
389300         WHEN SQLWARN0 NOT = SPACES                               38930000
389400         WHEN SQLCODE < ZERO                                      38940000
389500         WHEN SQLCODE > ZERO                                      38950000
389600                                                                  38960000
389700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   38970000
389800             MOVE '5545-OPEN-DEL-PREPK-CSR'                       38980000
389900                                             TO PV-SOFT-PARAGRAPH 38990000
390000             STRING ' PCKCS719 - '           DELIMITED BY SIZE    39000000
390100                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    39010000
390200                                           INTO PV-CICS-MSG-AREA2 39020000
390300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     39030000
390400               TO PV-COMMAREA-LENGTH                              39040000
390500             EXEC CICS                                            39050000
390600                  WRITEQ TD                                       39060000
390700                   QUEUE  ('CSSL')                                39070000
390800                    FROM  (PV-CICS-MSG-AREA2)                     39080000
390900                  LENGTH  (PV-COMMAREA-LENGTH)                    39090000
391000                    RESP  (PV-CICS-RESP)                          39100000
391100             END-EXEC                                             39110000
391200             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              39120000
391300             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            39130000
391400             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            39140000
391500             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        39150000
391600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     39160000
391700               TO PV-COMMAREA-LENGTH                              39170000
391800             EXEC CICS                                            39180000
391900                  WRITEQ TD                                       39190000
392000                   QUEUE  ('CSSL')                                39200000
392100                    FROM  (PV-CICS-MSG-AREA2)                     39210000
392200                  LENGTH  (PV-COMMAREA-LENGTH)                    39220000
392300                    RESP  (PV-CICS-RESP)                          39230000
392400             END-EXEC                                             39240000
392500                                                                  39250000
392600              SET  PS-ERROR                                       39260000
392700                   PC166-CRA-DB-BUSY  TO  TRUE                    39270000
392800              MOVE 'OPEN PREPK CURSOR        '                    39280000
392900                TO PC166-CRA-RET-MSG                              39290000
393000     END-EVALUATE.                                                39300000
393100                                                                  39310000
393200                                                                  39320000
393300*----------------------------------------------------------------*39330000
393400**FETCH DELETE DETAIL CURSOR FOR PREPACKS                         39340000
393500*----------------------------------------------------------------*39350000
393600 5550-FETCH-DEL-PREPK-CSR.                                        39360000
393700                                                                  39370000
393800     EXEC SQL                                                     39380000
393900          FETCH PRE_PACK_DEL_CSR                                  39390000
394000           INTO :DK-PREPK-LNE-NBR                                 39400000
394100               ,:DK-PREPK-RATIO-QTY                               39410000
394200     END-EXEC.                                                    39420000
394300                                                                  39430000
394400     EVALUATE TRUE                                                39440000
394500         WHEN SQLCODE = ZERO                                      39450000
394600              PERFORM 5560-DELETE-PREPK-DETAIL                    39460000
394700                                                                  39470000
394800         WHEN SQLCODE = +100                                      39480000
394900         SET PS-NO-PREPK-LINES-LEFT                               39490000
395000                                   TO TRUE                        39500000
395100         WHEN SQLCODE = -904                                      39510000
395200         WHEN SQLCODE = -911                                      39520000
395300         WHEN SQLCODE = -913                                      39530000
395400                                                                  39540000
395500             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   39550000
395600             MOVE '5550-FETCH-DEL-PREPK-CSR '                     39560000
395700                                             TO PV-SOFT-PARAGRAPH 39570000
395800             STRING ' PCKCS719 - '           DELIMITED BY SIZE    39580000
395900                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    39590000
396000                                           INTO PV-CICS-MSG-AREA2 39600000
396100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     39610000
396200               TO PV-COMMAREA-LENGTH                              39620000
396300             EXEC CICS                                            39630000
396400                  WRITEQ TD                                       39640000
396500                   QUEUE  ('CSSL')                                39650000
396600                    FROM  (PV-CICS-MSG-AREA2)                     39660000
396700                  LENGTH  (PV-COMMAREA-LENGTH)                    39670000
396800                    RESP  (PV-CICS-RESP)                          39680000
396900             END-EXEC                                             39690000
397000             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              39700000
397100             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            39710000
397200             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            39720000
397300             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        39730000
397400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     39740000
397500               TO PV-COMMAREA-LENGTH                              39750000
397600             EXEC CICS                                            39760000
397700                  WRITEQ TD                                       39770000
397800                   QUEUE  ('CSSL')                                39780000
397900                    FROM  (PV-CICS-MSG-AREA2)                     39790000
398000                  LENGTH  (PV-COMMAREA-LENGTH)                    39800000
398100                    RESP  (PV-CICS-RESP)                          39810000
398200             END-EXEC                                             39820000
398300                                                                  39830000
398400              SET  PS-ERROR                                       39840000
398500                   PC166-CRA-DB-BUSY  TO  TRUE                    39850000
398600              MOVE 'FETCH PREPK DELETE CURSOR   '                 39860000
398700                TO PC166-CRA-RET-MSG                              39870000
398800                                                                  39880000
398900         WHEN SQLWARN0 NOT = SPACE                                39890000
399000         WHEN SQLCODE NOT = ZERO                                  39900000
399100                                                                  39910000
399200             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   39920000
399300             MOVE '5550-FETCH-DEL-PREPK-CSR '                     39930000
399400                                             TO PV-SOFT-PARAGRAPH 39940000
399500             STRING ' PCKCS719 - '           DELIMITED BY SIZE    39950000
399600                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    39960000
399700                                           INTO PV-CICS-MSG-AREA2 39970000
399800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     39980000
399900               TO PV-COMMAREA-LENGTH                              39990000
400000             EXEC CICS                                            40000000
400100                  WRITEQ TD                                       40010000
400200                   QUEUE  ('CSSL')                                40020000
400300                    FROM  (PV-CICS-MSG-AREA2)                     40030000
400400                  LENGTH  (PV-COMMAREA-LENGTH)                    40040000
400500                    RESP  (PV-CICS-RESP)                          40050000
400600             END-EXEC                                             40060000
400700             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              40070000
400800             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            40080000
400900             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            40090000
401000             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        40100000
401100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     40110000
401200               TO PV-COMMAREA-LENGTH                              40120000
401300             EXEC CICS                                            40130000
401400                  WRITEQ TD                                       40140000
401500                   QUEUE  ('CSSL')                                40150000
401600                    FROM  (PV-CICS-MSG-AREA2)                     40160000
401700                  LENGTH  (PV-COMMAREA-LENGTH)                    40170000
401800                    RESP  (PV-CICS-RESP)                          40180000
401900             END-EXEC                                             40190000
402000                                                                  40200000
402100              SET  PS-ERROR                                       40210000
402200                   PC166-CRA-DB-BUSY  TO  TRUE                    40220000
402300              MOVE 'FETCH PREPK DELETE CURSOR'                    40230000
402400                TO PC166-CRA-RET-MSG                              40240000
402500     END-EVALUATE.                                                40250000
402600                                                                  40260000
402700                                                                  40270000
402800*----------------------------------------------------------------*40280000
402900**CLOSE DELETE DETAIL CURSOR FOR PREPACKS                         40290000
403000*----------------------------------------------------------------*40300000
403100 5555-CLOSE-DEL-PREPK-CSR.                                        40310000
403200                                                                  40320000
403300     EXEC SQL                                                     40330000
403400          CLOSE PRE_PACK_DEL_CSR                                  40340000
403500     END-EXEC.                                                    40350000
403600                                                                  40360000
403700     EVALUATE TRUE                                                40370000
403800         WHEN SQLCODE = ZERO                                      40380000
403900             CONTINUE                                             40390000
404000         WHEN SQLCODE = -904                                      40400000
404100         WHEN SQLCODE = -911                                      40410000
404200         WHEN SQLCODE = -913                                      40420000
404300                                                                  40430000
404400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   40440000
404500             MOVE '5555-CLOSE-DEL-PREPK-CSR '                     40450000
404600                                             TO PV-SOFT-PARAGRAPH 40460000
404700             STRING ' PCKCS719 - '           DELIMITED BY SIZE    40470000
404800                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    40480000
404900                                           INTO PV-CICS-MSG-AREA2 40490000
405000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     40500000
405100               TO PV-COMMAREA-LENGTH                              40510000
405200             EXEC CICS                                            40520000
405300                  WRITEQ TD                                       40530000
405400                   QUEUE  ('CSSL')                                40540000
405500                    FROM  (PV-CICS-MSG-AREA2)                     40550000
405600                  LENGTH  (PV-COMMAREA-LENGTH)                    40560000
405700                    RESP  (PV-CICS-RESP)                          40570000
405800             END-EXEC                                             40580000
405900             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              40590000
406000             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            40600000
406100             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            40610000
406200             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        40620000
406300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     40630000
406400               TO PV-COMMAREA-LENGTH                              40640000
406500             EXEC CICS                                            40650000
406600                  WRITEQ TD                                       40660000
406700                   QUEUE  ('CSSL')                                40670000
406800                    FROM  (PV-CICS-MSG-AREA2)                     40680000
406900                  LENGTH  (PV-COMMAREA-LENGTH)                    40690000
407000                    RESP  (PV-CICS-RESP)                          40700000
407100             END-EXEC                                             40710000
407200                                                                  40720000
407300              SET  PS-ERROR                                       40730000
407400                   PC166-CRA-DB-BUSY  TO  TRUE                    40740000
407500              MOVE 'CLOSE PREPK DELETE CURSOR   '                 40750000
407600                TO PC166-CRA-RET-MSG                              40760000
407700                                                                  40770000
407800         WHEN SQLWARN0 NOT = SPACES                               40780000
407900         WHEN SQLCODE < ZERO                                      40790000
408000         WHEN SQLCODE > ZERO                                      40800000
408100                                                                  40810000
408200             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   40820000
408300             MOVE '5555-CLOSE-DEL-PREPK-CSR '                     40830000
408400                                             TO PV-SOFT-PARAGRAPH 40840000
408500             STRING ' PCKCS719 - '           DELIMITED BY SIZE    40850000
408600                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    40860000
408700                                           INTO PV-CICS-MSG-AREA2 40870000
408800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     40880000
408900               TO PV-COMMAREA-LENGTH                              40890000
409000             EXEC CICS                                            40900000
409100                  WRITEQ TD                                       40910000
409200                   QUEUE  ('CSSL')                                40920000
409300                    FROM  (PV-CICS-MSG-AREA2)                     40930000
409400                  LENGTH  (PV-COMMAREA-LENGTH)                    40940000
409500                    RESP  (PV-CICS-RESP)                          40950000
409600             END-EXEC                                             40960000
409700             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              40970000
409800             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            40980000
409900             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            40990000
410000             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        41000000
410100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41010000
410200               TO PV-COMMAREA-LENGTH                              41020000
410300             EXEC CICS                                            41030000
410400                  WRITEQ TD                                       41040000
410500                   QUEUE  ('CSSL')                                41050000
410600                    FROM  (PV-CICS-MSG-AREA2)                     41060000
410700                  LENGTH  (PV-COMMAREA-LENGTH)                    41070000
410800                    RESP  (PV-CICS-RESP)                          41080000
410900             END-EXEC                                             41090000
411000                                                                  41100000
411100              SET  PS-ERROR                                       41110000
411200                   PC166-CRA-DB-BUSY  TO  TRUE                    41120000
411300              MOVE 'CLOSE PREPK DELETE CURSOR'                    41130000
411400                TO PC166-CRA-RET-MSG                              41140000
411500     END-EVALUATE.                                                41150000
411600                                                                  41160000
411700                                                                  41170000
411800*----------------------------------------------------------------*41180000
411900**DELETE DETAIL FOR PREPACKS                                      41190000
412000*----------------------------------------------------------------*41200000
412100 5560-DELETE-PREPK-DETAIL.                                        41210000
412200*DMH SET  PS-NO-ERROR                     TO  TRUE.               41220000
412300                                                                  41230000
412400     EXEC SQL                                                     41240000
412500          DELETE FROM TDISTDT                                     41250000
412600           WHERE ORD_NBR         = :DK-PO-NBR                     41260000
412700             AND RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR               41270000
412800             AND ORD_LNE_NBR     = :DK-PREPK-LNE-NBR              41280000
412900     END-EXEC.                                                    41290000
413000                                                                  41300000
413100     EVALUATE TRUE                                                41310000
413200         WHEN SQLCODE = ZERO                                      41320000
413300         WHEN SQLCODE = +100                                      41330000
413400                  CONTINUE                                        41340000
413500         WHEN SQLCODE = -904                                      41350000
413600         WHEN SQLCODE = -911                                      41360000
413700         WHEN SQLCODE = -913                                      41370000
413800                                                                  41380000
413900             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   41390000
414000             MOVE '5560-DELETE-PREPK-DETAIL '                     41400000
414100                                             TO PV-SOFT-PARAGRAPH 41410000
414200             STRING ' PCKCS719 - '           DELIMITED BY SIZE    41420000
414300                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    41430000
414400                                           INTO PV-CICS-MSG-AREA2 41440000
414500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41450000
414600               TO PV-COMMAREA-LENGTH                              41460000
414700             EXEC CICS                                            41470000
414800                  WRITEQ TD                                       41480000
414900                   QUEUE  ('CSSL')                                41490000
415000                    FROM  (PV-CICS-MSG-AREA2)                     41500000
415100                  LENGTH  (PV-COMMAREA-LENGTH)                    41510000
415200                    RESP  (PV-CICS-RESP)                          41520000
415300             END-EXEC                                             41530000
415400             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              41540000
415500             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            41550000
415600             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            41560000
415700             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        41570000
415800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41580000
415900               TO PV-COMMAREA-LENGTH                              41590000
416000             EXEC CICS                                            41600000
416100                  WRITEQ TD                                       41610000
416200                   QUEUE  ('CSSL')                                41620000
416300                    FROM  (PV-CICS-MSG-AREA2)                     41630000
416400                  LENGTH  (PV-COMMAREA-LENGTH)                    41640000
416500                    RESP  (PV-CICS-RESP)                          41650000
416600             END-EXEC                                             41660000
416700                                                                  41670000
416800              SET  PS-ERROR                                       41680000
416900                   PC166-CRA-DB-BUSY  TO  TRUE                    41690000
417000              MOVE 'DELETE PREPK DETAIL         '                 41700000
417100                TO PC166-CRA-RET-MSG                              41710000
417200                                                                  41720000
417300         WHEN SQLWARN0 NOT = SPACES                               41730000
417400         WHEN SQLCODE NOT EQUAL ZERO                              41740000
417500                                                                  41750000
417600             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   41760000
417700             MOVE '5560-DELETE-PREPK-DETAIL '                     41770000
417800                                             TO PV-SOFT-PARAGRAPH 41780000
417900             STRING ' PCKCS719 - '           DELIMITED BY SIZE    41790000
418000                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    41800000
418100                                           INTO PV-CICS-MSG-AREA2 41810000
418200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41820000
418300               TO PV-COMMAREA-LENGTH                              41830000
418400             EXEC CICS                                            41840000
418500                  WRITEQ TD                                       41850000
418600                   QUEUE  ('CSSL')                                41860000
418700                    FROM  (PV-CICS-MSG-AREA2)                     41870000
418800                  LENGTH  (PV-COMMAREA-LENGTH)                    41880000
418900                    RESP  (PV-CICS-RESP)                          41890000
419000             END-EXEC                                             41900000
419100             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              41910000
419200             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            41920000
419300             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            41930000
419400             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        41940000
419500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41950000
419600               TO PV-COMMAREA-LENGTH                              41960000
419700             EXEC CICS                                            41970000
419800                  WRITEQ TD                                       41980000
419900                   QUEUE  ('CSSL')                                41990000
420000                    FROM  (PV-CICS-MSG-AREA2)                     42000000
420100                  LENGTH  (PV-COMMAREA-LENGTH)                    42010000
420200                    RESP  (PV-CICS-RESP)                          42020000
420300             END-EXEC                                             42030000
420400                                                                  42040000
420500              SET  PS-ERROR                                       42050000
420600                   PC166-CRA-DB-BUSY  TO  TRUE                    42060000
420700              MOVE 'DELETE PREPK DETAIL      '                    42070000
420800                TO PC166-CRA-RET-MSG                              42080000
420900     END-EVALUATE.                                                42090000
421000                                                                  42100000
421100                                                                  42110000
421200*================================================================*42120000
421300*                                                                *42130000
421400*================================================================*42140000
421500 5600-BUILD-TDISTDT.                                              42150000
421600                                                                  42160000
421700     MOVE PC166-PO-NBR         TO DISTDT-ORD-NBR.                 42170000
421800     MOVE PC166-RCVR-SEQ-NBR   TO DISTDT-RCVR-SEQ-NBR.            42180000
421900     MOVE PC166-PO-LNE-NBR     TO DISTDT-ORD-LNE-NBR.             42190000
422000     MOVE PC-0001              TO DISTDT-WRK-ORD-SEQ-NBR.         42200000
422100     MOVE SPACE                TO DISTDT-ODD-CART-IND             42210000
422200     MOVE ZEROES               TO DISTDT-PREPK-ODD-UNT-QTY        42220000
422300     MOVE PC-READY-TO-POST-STATUS                                 42230000
422400                               TO DISTDT-RCVG-PSTD-STAT-CDE       42240000
422500                                                                  42250000
422600     PERFORM                                                      42260000
422700        VARYING PT-EXPT-IDX                                       42270000
422800           FROM 1  BY  1                                          42280000
422900          UNTIL PT-EXPT-IDX  >  PV-EXPECT-TABLE-ENTRIES           42290000
423000                MOVE PT-EXPT-STR-NBR (PT-EXPT-IDX)                42300000
423100                               TO DISTDT-STR-NBR                  42310000
423200                MOVE PT-EXPT-EXPTED-QTY (PT-EXPT-IDX)             42320000
423300                               TO DISTDT-EXPTED-ALLOC-QTY         42330000
423400                IF (PT-EXPT-DISTRB-CNTR (PT-EXPT-IDX)  OR         42340000
423500                    PT-EXPT-RETURN-VNDR (PT-EXPT-IDX))   AND      42350000
423600                    PT-EXPT-P2L-UNTS  (PT-EXPT-IDX)  >  0         42360000
423700*** DMH 6/5/03      MOVE PT-EXPT-EXPTED-QTY (PT-EXPT-IDX)         42370000
423800                    MOVE PT-EXPT-P2L-UNTS   (PT-EXPT-IDX)         42380000
423900                               TO DISTDT-ACTL-ALLOC-QTY           42390000
424000                ELSE                                              42400000
424100                    MOVE ZEROES                                   42410000
424200                               TO DISTDT-ACTL-ALLOC-QTY           42420000
424300                END-IF                                            42430000
424400                MOVE PT-EXPT-P2L-UNTS (PT-EXPT-IDX)               42440000
424500                               TO DISTDT-P2L-SPLT-UNT-QTY         42450000
424600                MOVE PT-EXPT-FCSE-UNTS (PT-EXPT-IDX)              42460000
424700                               TO DISTDT-FCSE-SPLT-UNT-QTY        42470000
424800                MOVE PT-EXPT-INPK-UNTS (PT-EXPT-IDX)              42480000
424900                               TO DISTDT-INPK-SPLT-UNT-QTY        42490000
425000                ADD  PT-EXPT-FCSE-UNTS (PT-EXPT-IDX)              42500000
425100                     PT-EXPT-INPK-UNTS (PT-EXPT-IDX)              42510000
425200                           GIVING DISTDT-FCSE-ACTL-UNT-QTY        42520000
425300                PERFORM 5610-INSERT-DISTDT                        42530000
425400     END-PERFORM.                                                 42540000
425500                                                                  42550000
425600                                                                  42560000
425700*================================================================*42570000
425800*                                                                *42580000
425900*================================================================*42590000
426000 5610-INSERT-DISTDT.                                              42600000
426100                                                                  42610000
426200     EXEC SQL                                                     42620000
426300          INSERT                                                  42630000
426400          INTO  TDISTDT                                           42640000
426500               (ORD_NBR                                           42650000
426600               ,RCVR_SEQ_NBR                                      42660000
426700               ,ORD_LNE_NBR                                       42670000
426800               ,WRK_ORD_SEQ_NBR                                   42680000
426900               ,STR_NBR                                           42690000
427000               ,EXPTED_ALLOC_QTY                                  42700000
427100               ,ACTL_ALLOC_QTY                                    42710000
427200               ,RCVG_PSTD_STAT_CDE                                42720000
427300              , P2L_SPLT_UNT_QTY                                  42730000
427400              , FCSE_SPLT_UNT_QTY                                 42740000
427500              , INPK_SPLT_UNT_QTY                                 42750000
427600              , FCSE_ACTL_UNT_QTY                                 42760000
427700              , ODD_CART_IND                                      42770000
427800              , PREPK_ODD_UNT_QTY)                                42780000
427900        VALUES                                                    42790000
428000              (:DK-PO-NBR                                         42800000
428100              ,:DK-RCVR-SEQ-NBR                                   42810000
428200              ,:DK-ORD-LNE-NBR                                    42820000
428300              ,:DK-WORK-ORD-SEQ-NBR                               42830000
428400              ,:DISTDT-STR-NBR                                    42840000
428500              ,:DISTDT-EXPTED-ALLOC-QTY                           42850000
428600              ,:DISTDT-ACTL-ALLOC-QTY                             42860000
428700              ,:DISTDT-RCVG-PSTD-STAT-CDE                         42870000
428800              ,:DISTDT-P2L-SPLT-UNT-QTY                           42880000
428900              ,:DISTDT-FCSE-SPLT-UNT-QTY                          42890000
429000              ,:DISTDT-INPK-SPLT-UNT-QTY                          42900000
429100              ,:DISTDT-FCSE-ACTL-UNT-QTY                          42910000
429200              ,:DISTDT-ODD-CART-IND                               42920000
429300              ,:DISTDT-PREPK-ODD-UNT-QTY)                         42930000
429400     END-EXEC.                                                    42940000
429500                                                                  42950000
429600     EVALUATE TRUE                                                42960000
429700         WHEN SQLCODE = ZERO                                      42970000
429800              IF  PC166-PRE-PACK-ORDER                            42980000
429900                  PERFORM 5730-PREPK-DISTDT                       42990000
430000                  MOVE PC166-PO-LNE-NBR  TO  DK-ORD-LNE-NBR       43000000
430100              END-IF                                              43010000
430200         WHEN SQLCODE = -904                                      43020000
430300         WHEN SQLCODE = -911                                      43030000
430400         WHEN SQLCODE = -913                                      43040000
430500                                                                  43050000
430600             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   43060000
430700             MOVE '5610-INSERT-DISTDT'                            43070000
430800                                             TO PV-SOFT-PARAGRAPH 43080000
430900             STRING ' PCKCS719 - '           DELIMITED BY SIZE    43090000
431000                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    43100000
431100                                           INTO PV-CICS-MSG-AREA2 43110000
431200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     43120000
431300               TO PV-COMMAREA-LENGTH                              43130000
431400             EXEC CICS                                            43140000
431500                  WRITEQ TD                                       43150000
431600                   QUEUE  ('CSSL')                                43160000
431700                    FROM  (PV-CICS-MSG-AREA2)                     43170000
431800                  LENGTH  (PV-COMMAREA-LENGTH)                    43180000
431900                    RESP  (PV-CICS-RESP)                          43190000
432000             END-EXEC                                             43200000
432100             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              43210000
432200             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            43220000
432300             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            43230000
432400             MOVE DISTDT-STR-NBR     TO  PV-HOLD3-STORE           43240000
432500             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        43250000
432600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     43260000
432700               TO PV-COMMAREA-LENGTH                              43270000
432800             EXEC CICS                                            43280000
432900                  WRITEQ TD                                       43290000
433000                   QUEUE  ('CSSL')                                43300000
433100                    FROM  (PV-CICS-MSG-AREA2)                     43310000
433200                  LENGTH  (PV-COMMAREA-LENGTH)                    43320000
433300                    RESP  (PV-CICS-RESP)                          43330000
433400             END-EXEC                                             43340000
433500                                                                  43350000
433600              SET  PS-ERROR                                       43360000
433700                   PC166-CRA-DB-BUSY  TO  TRUE                    43370000
433800              MOVE 'TDISTDT INSERT           '                    43380000
433900                TO PC166-CRA-RET-MSG                              43390000
434000                                                                  43400000
434100         WHEN SQLWARN0 NOT = SPACES                               43410000
434200         WHEN SQLCODE NOT EQUAL ZERO                              43420000
434300                                                                  43430000
434400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   43440000
434500             MOVE '5610-INSERT-DISTDT'                            43450000
434600                                             TO PV-SOFT-PARAGRAPH 43460000
434700             STRING ' PCKCS719 - '           DELIMITED BY SIZE    43470000
434800                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    43480000
434900                                           INTO PV-CICS-MSG-AREA2 43490000
435000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     43500000
435100               TO PV-COMMAREA-LENGTH                              43510000
435200             EXEC CICS                                            43520000
435300                  WRITEQ TD                                       43530000
435400                   QUEUE  ('CSSL')                                43540000
435500                    FROM  (PV-CICS-MSG-AREA2)                     43550000
435600                  LENGTH  (PV-COMMAREA-LENGTH)                    43560000
435700                    RESP  (PV-CICS-RESP)                          43570000
435800             END-EXEC                                             43580000
435900             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              43590000
436000             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            43600000
436100             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            43610000
436200             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        43620000
436300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     43630000
436400               TO PV-COMMAREA-LENGTH                              43640000
436500             EXEC CICS                                            43650000
436600                  WRITEQ TD                                       43660000
436700                   QUEUE  ('CSSL')                                43670000
436800                    FROM  (PV-CICS-MSG-AREA2)                     43680000
436900                  LENGTH  (PV-COMMAREA-LENGTH)                    43690000
437000                    RESP  (PV-CICS-RESP)                          43700000
437100             END-EXEC                                             43710000
437200                                                                  43720000
437300              SET  PS-ERROR                                       43730000
437400                   PC166-CRA-DB-BUSY  TO  TRUE                    43740000
437500              MOVE 'TDISTDT INSERT           '                    43750000
437600                TO PC166-CRA-RET-MSG                              43760000
437700                                                                  43770000
437800     END-EVALUATE.                                                43780000
437900                                                                  43790000
438000                                                                  43800000
438100*================================================================*43810000
438200* ROUTINE TO CREATE DISTHD ROWS FOR ALL LINES IN PREPK           *43820000
438300*================================================================*43830000
438400 5700-PREPK-DISTHD.                                               43840000
438500                                                                  43850000
438600     SET  PS-PREPK-LINES-LEFT TO TRUE.                            43860000
438700     PERFORM 5545-OPEN-DEL-PREPK-CSR.                             43870000
438800     IF  PS-NO-ERROR                                              43880000
438900         PERFORM 5710-FETCH-DEL-PREPK-CSR                         43890000
439000           UNTIL PS-ERROR                                         43900000
439100              OR PS-NO-PREPK-LINES-LEFT                           43910000
439200     END-IF.                                                      43920000
439300     PERFORM 5555-CLOSE-DEL-PREPK-CSR.                            43930000
439400                                                                  43940000
439500                                                                  43950000
439600*================================================================*43960000
439700* PROCESS PREPK CURSOR TO INSERT/UPDATE DISTHD FOR PREPK LINES   *43970000
439800*================================================================*43980000
439900 5710-FETCH-DEL-PREPK-CSR.                                        43990000
440000                                                                  44000000
440100     EXEC SQL                                                     44010000
440200          FETCH PRE_PACK_DEL_CSR                                  44020000
440300           INTO :DK-PREPK-LNE-NBR                                 44030000
440400               ,:DK-PREPK-RATIO-QTY                               44040000
440500     END-EXEC.                                                    44050000
440600                                                                  44060000
440700     EVALUATE TRUE                                                44070000
440800         WHEN SQLCODE = ZERO                                      44080000
440900              PERFORM 5720-PREPK-DISTHD                           44090000
441000                                                                  44100000
441100         WHEN SQLCODE = +100                                      44110000
441200         SET PS-NO-PREPK-LINES-LEFT                               44120000
441300                                   TO TRUE                        44130000
441400         WHEN SQLCODE = -904                                      44140000
441500         WHEN SQLCODE = -911                                      44150000
441600         WHEN SQLCODE = -913                                      44160000
441700                                                                  44170000
441800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   44180000
441900             MOVE '5710-FETCH-DEL-PREPK-CSR '                     44190000
442000                                             TO PV-SOFT-PARAGRAPH 44200000
442100             STRING ' PCKCS719 - '           DELIMITED BY SIZE    44210000
442200                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    44220000
442300                                           INTO PV-CICS-MSG-AREA2 44230000
442400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     44240000
442500               TO PV-COMMAREA-LENGTH                              44250000
442600             EXEC CICS                                            44260000
442700                  WRITEQ TD                                       44270000
442800                   QUEUE  ('CSSL')                                44280000
442900                    FROM  (PV-CICS-MSG-AREA2)                     44290000
443000                  LENGTH  (PV-COMMAREA-LENGTH)                    44300000
443100                    RESP  (PV-CICS-RESP)                          44310000
443200             END-EXEC                                             44320000
443300             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              44330000
443400             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            44340000
443500             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            44350000
443600             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        44360000
443700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     44370000
443800               TO PV-COMMAREA-LENGTH                              44380000
443900             EXEC CICS                                            44390000
444000                  WRITEQ TD                                       44400000
444100                   QUEUE  ('CSSL')                                44410000
444200                    FROM  (PV-CICS-MSG-AREA2)                     44420000
444300                  LENGTH  (PV-COMMAREA-LENGTH)                    44430000
444400                    RESP  (PV-CICS-RESP)                          44440000
444500             END-EXEC                                             44450000
444600                                                                  44460000
444700              SET  PS-ERROR                                       44470000
444800                   PC166-CRA-DB-BUSY  TO  TRUE                    44480000
444900              MOVE 'FETCH PREPK DISTHD CURSOR   '                 44490000
445000                TO PC166-CRA-RET-MSG                              44500000
445100                                                                  44510000
445200         WHEN SQLWARN0 NOT = SPACE                                44520000
445300         WHEN SQLCODE NOT = ZERO                                  44530000
445400                                                                  44540000
445500             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   44550000
445600             MOVE '5710-FETCH-DEL-PREPK-CSR '                     44560000
445700                                             TO PV-SOFT-PARAGRAPH 44570000
445800             STRING ' PCKCS719 - '           DELIMITED BY SIZE    44580000
445900                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    44590000
446000                                           INTO PV-CICS-MSG-AREA2 44600000
446100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     44610000
446200               TO PV-COMMAREA-LENGTH                              44620000
446300             EXEC CICS                                            44630000
446400                  WRITEQ TD                                       44640000
446500                   QUEUE  ('CSSL')                                44650000
446600                    FROM  (PV-CICS-MSG-AREA2)                     44660000
446700                  LENGTH  (PV-COMMAREA-LENGTH)                    44670000
446800                    RESP  (PV-CICS-RESP)                          44680000
446900             END-EXEC                                             44690000
447000             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              44700000
447100             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            44710000
447200             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            44720000
447300             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        44730000
447400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     44740000
447500               TO PV-COMMAREA-LENGTH                              44750000
447600             EXEC CICS                                            44760000
447700                  WRITEQ TD                                       44770000
447800                   QUEUE  ('CSSL')                                44780000
447900                    FROM  (PV-CICS-MSG-AREA2)                     44790000
448000                  LENGTH  (PV-COMMAREA-LENGTH)                    44800000
448100                    RESP  (PV-CICS-RESP)                          44810000
448200             END-EXEC                                             44820000
448300                                                                  44830000
448400              SET  PS-ERROR                                       44840000
448500                   PC166-CRA-DB-BUSY  TO  TRUE                    44850000
448600              MOVE 'FETCH PREPK DISTHD CURSOR'                    44860000
448700                TO PC166-CRA-RET-MSG                              44870000
448800     END-EVALUATE.                                                44880000
448900                                                                  44890000
449000                                                                  44900000
449100*================================================================*44910000
449200*                                                                *44920000
449300*================================================================*44930000
449400 5720-PREPK-DISTHD.                                               44940000
449500                                                                  44950000
449600     MOVE DK-PREPK-LNE-NBR        TO  DK-ORD-LNE-NBR              44960000
449700                                                                  44970000
449800     MOVE 'X'                     TO  DISTHD-FCSE-LBL-TYP-CDE.    44980000
449900     MOVE 'P'                     TO  DISTHD-PREPK-LNE-PRC-CDE.   44990000
450000                                                                  45000000
450100     IF  PC166-OTPK-UNT-QTY  >  0                                 45010000
450200         DIVIDE  PC166-OTPK-UNT-QTY                               45020000
450300             BY  PC166-PREPK-RATIO                                45030000
450400         GIVING  PV-OTPK-UNT-RATIO                                45040000
450500     ELSE                                                         45050000
450600        MOVE ZEROES  TO  PV-OTPK-UNT-RATIO                        45060000
450700     END-IF.                                                      45070000
450800                                                                  45080000
450900     COMPUTE DISTHD-OTPK-UNT-QTY                                  45090000
451000           = DISTHD-OTPK-UNT-QTY                                  45100000
451100           * DK-PREPK-RATIO-QTY.                                  45110000
451200                                                                  45120000
451300     DIVIDE  PC166-PRCS-QTY                                       45130000
451400         BY  PC166-PREPK-RATIO                                    45140000
451500     GIVING  PV-PRCS-QTY-UNT-RATIO.                               45150000
451600                                                                  45160000
451700     COMPUTE DISTHD-CAL-UNT-PRCD-QTY                              45170000
451800           = PV-PRCS-QTY-UNT-RATIO                                45180000
451900           * DK-PREPK-RATIO-QTY.                                  45190000
452000                                                                  45200000
452100     MOVE DK-PREPK-RATIO-QTY      TO  DISTHD-INPK-UNT-QTY.        45210000
452200                                                                  45220000
452300     IF  PS-DISTHD-UPDATE                                         45230000
452400         PERFORM 5535-UPDATE-HEADER                               45240000
452500     ELSE                                                         45250000
452600     IF  PS-DISTHD-INSERT                                         45260000
452700         PERFORM 5536-INSERT-HEADER                               45270000
452800     END-IF                                                       45280000
452900     END-IF.                                                      45290000
453000                                                                  45300000
453100                                                                  45310000
453200*================================================================*45320000
453300* ROUTINE TO CREATE DISTDT ROWS FOR ALL LINES IN PREPK           *45330000
453400*================================================================*45340000
453500 5730-PREPK-DISTDT.                                               45350000
453600                                                                  45360000
453700     DIVIDE    DISTDT-P2L-SPLT-UNT-QTY                            45370000
453800         BY    PC166-PREPK-RATIO                                  45380000
453900     GIVING    PV-P2L-SPLT-UNT-QTY-RATIO.                         45390000
454000                                                                  45400000
454100     DIVIDE    DISTDT-FCSE-SPLT-UNT-QTY                           45410000
454200         BY    PC166-PREPK-RATIO                                  45420000
454300     GIVING    PV-FCSE-SPLT-UNT-QTY-RATIO.                        45430000
454400                                                                  45440000
454500     DIVIDE    DISTDT-INPK-SPLT-UNT-QTY                           45450000
454600         BY    PC166-PREPK-RATIO                                  45460000
454700     GIVING    PV-INPK-SPLT-UNT-QTY-RATIO.                        45470000
454800                                                                  45480000
454900     DIVIDE    DISTDT-FCSE-ACTL-UNT-QTY                           45490000
455000         BY    PC166-PREPK-RATIO                                  45500000
455100     GIVING    PV-FCSE-ACTL-UNT-QTY-RATIO.                        45510000
455200                                                                  45520000
455300     DIVIDE    DISTDT-EXPTED-ALLOC-QTY                            45530000
455400         BY    PC166-PREPK-RATIO                                  45540000
455500     GIVING    PV-EXPTED-ITM-QTY-RATIO.                           45550000
455600                                                                  45560000
455700     DIVIDE    DISTDT-ACTL-ALLOC-QTY                              45570000
455800         BY    PC166-PREPK-RATIO                                  45580000
455900     GIVING    PV-ACTL-ALLOC-QTY-RATIO.                           45590000
456000                                                                  45600000
456100     SET  PS-PREPK-LINES-LEFT TO TRUE.                            45610000
456200     PERFORM 5545-OPEN-DEL-PREPK-CSR.                             45620000
456300     PERFORM 5740-FETCH-DEL-PREPK-CSR                             45630000
456400       UNTIL PS-ERROR                                             45640000
456500          OR PS-NO-PREPK-LINES-LEFT.                              45650000
456600     PERFORM 5555-CLOSE-DEL-PREPK-CSR.                            45660000
456700                                                                  45670000
456800                                                                  45680000
456900*================================================================*45690000
457000* PROCESS PREPK CURSOR TO INSERT/UPDATE DISTDT FOR PREPK LINES   *45700000
457100*================================================================*45710000
457200 5740-FETCH-DEL-PREPK-CSR.                                        45720000
457300                                                                  45730000
457400     EXEC SQL                                                     45740000
457500          FETCH PRE_PACK_DEL_CSR                                  45750000
457600           INTO :DK-PREPK-LNE-NBR                                 45760000
457700               ,:DK-PREPK-RATIO-QTY                               45770000
457800     END-EXEC.                                                    45780000
457900                                                                  45790000
458000     EVALUATE TRUE                                                45800000
458100         WHEN SQLCODE = ZERO                                      45810000
458200              PERFORM 5750-PREPK-DISTDT                           45820000
458300                                                                  45830000
458400         WHEN SQLCODE = +100                                      45840000
458500         SET PS-NO-PREPK-LINES-LEFT                               45850000
458600                                   TO TRUE                        45860000
458700         WHEN SQLCODE = -904                                      45870000
458800         WHEN SQLCODE = -911                                      45880000
458900         WHEN SQLCODE = -913                                      45890000
459000                                                                  45900000
459100             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   45910000
459200             MOVE '5740-FETCH-DEL-PREPK-CSR '                     45920000
459300                                             TO PV-SOFT-PARAGRAPH 45930000
459400             STRING ' PCKCS719 - '           DELIMITED BY SIZE    45940000
459500                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    45950000
459600                                           INTO PV-CICS-MSG-AREA2 45960000
459700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     45970000
459800               TO PV-COMMAREA-LENGTH                              45980000
459900             EXEC CICS                                            45990000
460000                  WRITEQ TD                                       46000000
460100                   QUEUE  ('CSSL')                                46010000
460200                    FROM  (PV-CICS-MSG-AREA2)                     46020000
460300                  LENGTH  (PV-COMMAREA-LENGTH)                    46030000
460400                    RESP  (PV-CICS-RESP)                          46040000
460500             END-EXEC                                             46050000
460600             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              46060000
460700             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            46070000
460800             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            46080000
460900             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        46090000
461000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     46100000
461100               TO PV-COMMAREA-LENGTH                              46110000
461200             EXEC CICS                                            46120000
461300                  WRITEQ TD                                       46130000
461400                   QUEUE  ('CSSL')                                46140000
461500                    FROM  (PV-CICS-MSG-AREA2)                     46150000
461600                  LENGTH  (PV-COMMAREA-LENGTH)                    46160000
461700                    RESP  (PV-CICS-RESP)                          46170000
461800             END-EXEC                                             46180000
461900                                                                  46190000
462000              SET  PS-ERROR                                       46200000
462100                   PC166-CRA-DB-BUSY  TO  TRUE                    46210000
462200              MOVE 'FETCH PREPK DISTDT CURSOR   '                 46220000
462300                TO PC166-CRA-RET-MSG                              46230000
462400                                                                  46240000
462500         WHEN SQLWARN0 NOT = SPACE                                46250000
462600         WHEN SQLCODE NOT = ZERO                                  46260000
462700                                                                  46270000
462800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   46280000
462900             MOVE '5740-FETCH-DEL-PREPK-CSR '                     46290000
463000                                             TO PV-SOFT-PARAGRAPH 46300000
463100             STRING ' PCKCS719 - '           DELIMITED BY SIZE    46310000
463200                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    46320000
463300                                           INTO PV-CICS-MSG-AREA2 46330000
463400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     46340000
463500               TO PV-COMMAREA-LENGTH                              46350000
463600             EXEC CICS                                            46360000
463700                  WRITEQ TD                                       46370000
463800                   QUEUE  ('CSSL')                                46380000
463900                    FROM  (PV-CICS-MSG-AREA2)                     46390000
464000                  LENGTH  (PV-COMMAREA-LENGTH)                    46400000
464100                    RESP  (PV-CICS-RESP)                          46410000
464200             END-EXEC                                             46420000
464300             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              46430000
464400             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            46440000
464500             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            46450000
464600             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        46460000
464700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     46470000
464800               TO PV-COMMAREA-LENGTH                              46480000
464900             EXEC CICS                                            46490000
465000                  WRITEQ TD                                       46500000
465100                   QUEUE  ('CSSL')                                46510000
465200                    FROM  (PV-CICS-MSG-AREA2)                     46520000
465300                  LENGTH  (PV-COMMAREA-LENGTH)                    46530000
465400                    RESP  (PV-CICS-RESP)                          46540000
465500             END-EXEC                                             46550000
465600                                                                  46560000
465700              SET  PS-ERROR                                       46570000
465800                   PC166-CRA-DB-BUSY  TO  TRUE                    46580000
465900              MOVE 'FETCH PREPK DISTDT CURSOR'                    46590000
466000                TO PC166-CRA-RET-MSG                              46600000
466100     END-EVALUATE.                                                46610000
466200                                                                  46620000
466300                                                                  46630000
466400*================================================================*46640000
466500*                                                                *46650000
466600*================================================================*46660000
466700 5750-PREPK-DISTDT.                                               46670000
466800                                                                  46680000
466900     COMPUTE DISTDT-P2L-SPLT-UNT-QTY                              46690000
467000           = PV-P2L-SPLT-UNT-QTY-RATIO                            46700000
467100           * DK-PREPK-RATIO-QTY.                                  46710000
467200                                                                  46720000
467300     COMPUTE DISTDT-FCSE-SPLT-UNT-QTY                             46730000
467400           = PV-FCSE-SPLT-UNT-QTY-RATIO                           46740000
467500           * DK-PREPK-RATIO-QTY.                                  46750000
467600                                                                  46760000
467700     COMPUTE DISTDT-INPK-SPLT-UNT-QTY                             46770000
467800           = PV-INPK-SPLT-UNT-QTY-RATIO                           46780000
467900           * DK-PREPK-RATIO-QTY.                                  46790000
468000                                                                  46800000
468100     COMPUTE DISTDT-FCSE-ACTL-UNT-QTY                             46810000
468200           = PV-FCSE-ACTL-UNT-QTY-RATIO                           46820000
468300           * DK-PREPK-RATIO-QTY.                                  46830000
468400                                                                  46840000
468500     COMPUTE DISTDT-EXPTED-ALLOC-QTY                              46850000
468600           = PV-EXPTED-ITM-QTY-RATIO                              46860000
468700           * DK-PREPK-RATIO-QTY.                                  46870000
468800                                                                  46880000
468900     COMPUTE DISTDT-ACTL-ALLOC-QTY                                46890000
469000           = PV-ACTL-ALLOC-QTY-RATIO                              46900000
469100           * DK-PREPK-RATIO-QTY.                                  46910000
469200                                                                  46920000
469300     MOVE ZEROES  TO  DISTDT-PREPK-ODD-UNT-QTY.                   46930000
469400                                                                  46940000
469500     EXEC SQL                                                     46950000
469600          INSERT                                                  46960000
469700          INTO  TDISTDT                                           46970000
469800               (ORD_NBR                                           46980000
469900               ,RCVR_SEQ_NBR                                      46990000
470000               ,ORD_LNE_NBR                                       47000000
470100               ,WRK_ORD_SEQ_NBR                                   47010000
470200               ,STR_NBR                                           47020000
470300               ,EXPTED_ALLOC_QTY                                  47030000
470400               ,ACTL_ALLOC_QTY                                    47040000
470500               ,RCVG_PSTD_STAT_CDE                                47050000
470600              , P2L_SPLT_UNT_QTY                                  47060000
470700              , FCSE_SPLT_UNT_QTY                                 47070000
470800              , INPK_SPLT_UNT_QTY                                 47080000
470900              , FCSE_ACTL_UNT_QTY                                 47090000
471000              , ODD_CART_IND                                      47100000
471100              , PREPK_ODD_UNT_QTY)                                47110000
471200        VALUES                                                    47120000
471300              (:DK-PO-NBR                                         47130000
471400              ,:DK-RCVR-SEQ-NBR                                   47140000
471500              ,:DK-PREPK-LNE-NBR                                  47150000
471600              ,:DK-WORK-ORD-SEQ-NBR                               47160000
471700              ,:DISTDT-STR-NBR                                    47170000
471800              ,:DISTDT-EXPTED-ALLOC-QTY                           47180000
471900              ,:DISTDT-ACTL-ALLOC-QTY                             47190000
472000              ,:DISTDT-RCVG-PSTD-STAT-CDE                         47200000
472100              ,:DISTDT-P2L-SPLT-UNT-QTY                           47210000
472200              ,:DISTDT-FCSE-SPLT-UNT-QTY                          47220000
472300              ,:DISTDT-INPK-SPLT-UNT-QTY                          47230000
472400              ,:DISTDT-FCSE-ACTL-UNT-QTY                          47240000
472500              ,:DISTDT-ODD-CART-IND                               47250000
472600              ,:DISTDT-PREPK-ODD-UNT-QTY)                         47260000
472700     END-EXEC.                                                    47270000
472800                                                                  47280000
472900     EVALUATE TRUE                                                47290000
473000         WHEN SQLCODE = ZERO                                      47300000
473100              CONTINUE                                            47310000
473200                                                                  47320000
473300         WHEN SQLCODE = -904                                      47330000
473400         WHEN SQLCODE = -911                                      47340000
473500         WHEN SQLCODE = -913                                      47350000
473600                                                                  47360000
473700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   47370000
473800             MOVE '5750-PREPK-DISTDT '                            47380000
473900                                             TO PV-SOFT-PARAGRAPH 47390000
474000             STRING ' PCKCS719 - '           DELIMITED BY SIZE    47400000
474100                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    47410000
474200                                           INTO PV-CICS-MSG-AREA2 47420000
474300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     47430000
474400               TO PV-COMMAREA-LENGTH                              47440000
474500             EXEC CICS                                            47450000
474600                  WRITEQ TD                                       47460000
474700                   QUEUE  ('CSSL')                                47470000
474800                    FROM  (PV-CICS-MSG-AREA2)                     47480000
474900                  LENGTH  (PV-COMMAREA-LENGTH)                    47490000
475000                    RESP  (PV-CICS-RESP)                          47500000
475100             END-EXEC                                             47510000
475200             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              47520000
475300             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            47530000
475400             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            47540000
475500             MOVE DISTDT-STR-NBR     TO  PV-HOLD3-STORE           47550000
475600             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        47560000
475700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     47570000
475800               TO PV-COMMAREA-LENGTH                              47580000
475900             EXEC CICS                                            47590000
476000                  WRITEQ TD                                       47600000
476100                   QUEUE  ('CSSL')                                47610000
476200                    FROM  (PV-CICS-MSG-AREA2)                     47620000
476300                  LENGTH  (PV-COMMAREA-LENGTH)                    47630000
476400                    RESP  (PV-CICS-RESP)                          47640000
476500             END-EXEC                                             47650000
476600                                                                  47660000
476700              SET  PS-ERROR                                       47670000
476800                   PC166-CRA-DB-BUSY  TO  TRUE                    47680000
476900              MOVE 'TDISTDT PREPK INSERT     '                    47690000
477000                TO PC166-CRA-RET-MSG                              47700000
477100                                                                  47710000
477200         WHEN SQLWARN0 NOT = SPACES                               47720000
477300         WHEN SQLCODE NOT EQUAL ZERO                              47730000
477400                                                                  47740000
477500             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   47750000
477600             MOVE '5750-PREPK-DISTDT '                            47760000
477700                                             TO PV-SOFT-PARAGRAPH 47770000
477800             STRING ' PCKCS719 - '           DELIMITED BY SIZE    47780000
477900                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    47790000
478000                                           INTO PV-CICS-MSG-AREA2 47800000
478100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     47810000
478200               TO PV-COMMAREA-LENGTH                              47820000
478300             EXEC CICS                                            47830000
478400                  WRITEQ TD                                       47840000
478500                   QUEUE  ('CSSL')                                47850000
478600                    FROM  (PV-CICS-MSG-AREA2)                     47860000
478700                  LENGTH  (PV-COMMAREA-LENGTH)                    47870000
478800                    RESP  (PV-CICS-RESP)                          47880000
478900             END-EXEC                                             47890000
479000             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              47900000
479100             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            47910000
479200             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            47920000
479300             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        47930000
479400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     47940000
479500               TO PV-COMMAREA-LENGTH                              47950000
479600             EXEC CICS                                            47960000
479700                  WRITEQ TD                                       47970000
479800                   QUEUE  ('CSSL')                                47980000
479900                    FROM  (PV-CICS-MSG-AREA2)                     47990000
480000                  LENGTH  (PV-COMMAREA-LENGTH)                    48000000
480100                    RESP  (PV-CICS-RESP)                          48010000
480200             END-EXEC                                             48020000
480300                                                                  48030000
480400              SET  PS-ERROR                                       48040000
480500                   PC166-CRA-DB-BUSY  TO  TRUE                    48050000
480600              MOVE 'TDISTDT PREPK INSERT     '                    48060000
480700                TO PC166-CRA-RET-MSG                              48070000
480800                                                                  48080000
480900     END-EVALUATE.                                                48090000
481000                                                                  48100000
481100                                                                  48110000
481200*================================================================*48120000
481300* OPEN UCC128 CURSOR - CURSOR USED TO DETERMINE # OF OTPK QTYS   *48130000
481400*================================================================*48140000
481500 7000-OPEN-UCC128-CSR.                                            48150000
481600                                                                  48160000
481700     EXEC SQL                                                     48170000
481800         OPEN UCC128-CSR                                          48180000
481900     END-EXEC.                                                    48190000
482000                                                                  48200000
482100     EVALUATE TRUE                                                48210000
482200         WHEN SQLCODE = ZERO                                      48220000
482300             CONTINUE                                             48230000
482400                                                                  48240000
482500         WHEN SQLCODE = -904                                      48250000
482600         WHEN SQLCODE = -911                                      48260000
482700         WHEN SQLCODE = -913                                      48270000
482800              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      48280000
482900              STRING 'SQL='                 DELIMITED BY SIZE     48290000
483000                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     48300000
483100                     '7000-OPEN-UCC128-CSR' DELIMITED BY SIZE     48310000
483200                                       INTO PC166-CRA-RET-MSG     48320000
483300              MOVE '01'                TO   PC166-CRA-RET-CDE     48330000
483400              PERFORM 9000-RETURN-CALL                            48340000
483500                                                                  48350000
483600         WHEN SQLWARN0 NOT = SPACES                               48360000
483700         WHEN SQLCODE < ZERO                                      48370000
483800         WHEN SQLCODE > ZERO                                      48380000
483900              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      48390000
484000              STRING 'SQL='                 DELIMITED BY SIZE     48400000
484100                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     48410000
484200                     '7000-OPEN-UCC128-CSR' DELIMITED BY SIZE     48420000
484300                                       INTO PC166-CRA-RET-MSG     48430000
484400             MOVE '02'                 TO   PC166-CRA-RET-CDE     48440000
484500             PERFORM 9000-RETURN-CALL                             48450000
484600                                                                  48460000
484700     END-EVALUATE.                                                48470000
484800                                                                  48480000
484900                                                                  48490000
485000*================================================================*48500000
485100* FETCH UCC128 CURSOR - CURSOR USED TO DETERMINE # OF OTPK QTYS  *48510000
485200*================================================================*48520000
485300 7010-FETCH-UCC128-CSR.                                           48530000
485400                                                                  48540000
485500     EXEC SQL                                                     48550000
485600         FETCH UCC128-CSR                                         48560000
485700          INTO :SHUUPC-SHIPT-UNT-ID                               48570000
485800              ,:SHUUPC-TRN-LNE-NBR                                48580000
485900              ,:SHUUPC-SHPD-QTY                                   48590000
486000     END-EXEC.                                                    48600000
486100                                                                  48610000
486200     EVALUATE TRUE                                                48620000
486300         WHEN SQLCODE = ZERO                                      48630000
486400             CONTINUE                                             48640000
486500         WHEN SQLCODE = +100                                      48650000
486600             SET PS-EOF-UCC128-CSR    TO TRUE                     48660000
486700                                                                  48670000
486800         WHEN SQLCODE = -904                                      48680000
486900         WHEN SQLCODE = -911                                      48690000
487000         WHEN SQLCODE = -913                                      48700000
487100              MOVE SQLCODE            TO   PV-SQL-RETURN-CD       48710000
487200              STRING 'SQL='                DELIMITED BY SIZE      48720000
487300                     PV-SQL-RETURN-CD      DELIMITED BY SIZE      48730000
487400                     ' 7010-FETCH-UCC128'  DELIMITED BY SIZE      48740000
487500                                      INTO PC166-CRA-RET-MSG      48750000
487600              MOVE '03'               TO   PC166-CRA-RET-CDE      48760000
487700              PERFORM 9000-RETURN-CALL                            48770000
487800                                                                  48780000
487900         WHEN SQLWARN0 NOT = SPACES                               48790000
488000         WHEN SQLCODE < ZERO                                      48800000
488100         WHEN SQLCODE > ZERO                                      48810000
488200              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      48820000
488300              STRING 'SQL='                 DELIMITED BY SIZE     48830000
488400                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     48840000
488500                     ' 7010-FETCH-UCC128'   DELIMITED BY SIZE     48850000
488600                                       INTO PC166-CRA-RET-MSG     48860000
488700              MOVE '04'                TO   PC166-CRA-RET-CDE     48870000
488800              PERFORM 9000-RETURN-CALL                            48880000
488900                                                                  48890000
489000     END-EVALUATE.                                                48900000
489100                                                                  48910000
489200                                                                  48920000
489300                                                                  48930000
489400*================================================================*48940000
489500* CLOSE UCC128 CURSOR - CURSOR USED TO DETERMINE # OF OTPK QTYS  *48950000
489600*================================================================*48960000
489700 7020-CLOSE-UCC128-CSR.                                           48970000
489800                                                                  48980000
489900     EXEC SQL                                                     48990000
490000         CLOSE UCC128-CSR                                         49000000
490100     END-EXEC.                                                    49010000
490200                                                                  49020000
490300     EVALUATE TRUE                                                49030000
490400         WHEN SQLCODE = ZERO                                      49040000
490500             CONTINUE                                             49050000
490600                                                                  49060000
490700         WHEN SQLCODE = -904                                      49070000
490800         WHEN SQLCODE = -911                                      49080000
490900         WHEN SQLCODE = -913                                      49090000
491000              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      49100000
491100              STRING 'SQL='                 DELIMITED BY SIZE     49110000
491200                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     49120000
491300                     ' 7020-CLOSE-UCC128'   DELIMITED BY SIZE     49130000
491400                                       INTO PC166-CRA-RET-MSG     49140000
491500              MOVE '05'                TO   PC166-CRA-RET-CDE     49150000
491600              PERFORM 9000-RETURN-CALL                            49160000
491700                                                                  49170000
491800         WHEN SQLWARN0 NOT = SPACES                               49180000
491900         WHEN SQLCODE < ZERO                                      49190000
492000         WHEN SQLCODE > ZERO                                      49200000
492100              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      49210000
492200              STRING 'SQL='                 DELIMITED BY SIZE     49220000
492300                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     49230000
492400                     ' 7020-CLOSE-UCC128'   DELIMITED BY SIZE     49240000
492500                                       INTO PC166-CRA-RET-MSG     49250000
492600             MOVE '06'                 TO   PC166-CRA-RET-CDE     49260000
492700             PERFORM 9000-RETURN-CALL                             49270000
492800                                                                  49280000
492900     END-EVALUATE.                                                49290000
493000                                                                  49300000
493100                                                                  49310000
493200*================================================================*49320000
493300* OPEN EXPECT CURSOR - STORE EXPECTED ALLOCATION TABLE           *49330000
493400*================================================================*49340000
493500 7030-OPEN-EXPECT-CSR.                                            49350000
493600                                                                  49360000
493700     EXEC SQL                                                     49370000
493800         OPEN EXPECT-CSR                                          49380000
493900     END-EXEC.                                                    49390000
494000                                                                  49400000
494100     EVALUATE TRUE                                                49410000
494200         WHEN SQLCODE = ZERO                                      49420000
494300             CONTINUE                                             49430000
494400                                                                  49440000
494500         WHEN SQLCODE = -904                                      49450000
494600         WHEN SQLCODE = -911                                      49460000
494700         WHEN SQLCODE = -913                                      49470000
494800              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      49480000
494900              STRING 'SQL='                 DELIMITED BY SIZE     49490000
495000                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     49500000
495100                     ' 7030-OPEN-EXPECT '   DELIMITED BY SIZE     49510000
495200                                       INTO PC166-CRA-RET-MSG     49520000
495300              MOVE '07'                TO   PC166-CRA-RET-CDE     49530000
495400              PERFORM 9000-RETURN-CALL                            49540000
495500                                                                  49550000
495600         WHEN SQLWARN0 NOT = SPACES                               49560000
495700         WHEN SQLCODE < ZERO                                      49570000
495800         WHEN SQLCODE > ZERO                                      49580000
495900              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      49590000
496000              STRING 'SQL='                 DELIMITED BY SIZE     49600000
496100                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     49610000
496200                     ' 7030-OPEN-EXPECT '   DELIMITED BY SIZE     49620000
496300                                       INTO PC166-CRA-RET-MSG     49630000
496400             MOVE '08'                 TO   PC166-CRA-RET-CDE     49640000
496500             PERFORM 9000-RETURN-CALL                             49650000
496600                                                                  49660000
496700     END-EVALUATE.                                                49670000
496800                                                                  49680000
496900                                                                  49690000
497000*================================================================*49700000
497100* FETCH EXPECT CURSOR - STORE ALLOCATION CURSOR                  *49710000
497200*================================================================*49720000
497300 7040-FETCH-EXPECT-CSR.                                           49730000
497400                                                                  49740000
497500     EXEC SQL                                                     49750000
497600         FETCH EXPECT-CSR                                         49760000
497700          INTO :PV-TYPE-CODE-SEQ                                  49770000
497800              ,:XLT00010-LOC-TYP-CDE                              49780000
497900              ,:XLT00010-E-BUS-IND                                49790000
498000              ,:RECDIS-STR-NBR                                    49800000
498100              ,:RECDIS-EXPTED-ITM-QTY                             49810000
498200              ,:XLT00010-OPN-DTE                                  49820001
498300     END-EXEC.                                                    49830000
498400                                                                  49840000
498500     EVALUATE TRUE                                                49850000
498600         WHEN SQLCODE = ZERO                                      49860000
498700             ADD +1                   TO PV-EXPECT-TABLE-ENTRIES  49870000
498800         WHEN SQLCODE = +100                                      49880000
498900             SET PS-EOF-EXPECT-CSR    TO TRUE                     49890000
499000                                                                  49900000
499100         WHEN SQLCODE = -904                                      49910000
499200         WHEN SQLCODE = -911                                      49920000
499300         WHEN SQLCODE = -913                                      49930000
499400              MOVE SQLCODE            TO   PV-SQL-RETURN-CD       49940000
499500              STRING 'SQL='                DELIMITED BY SIZE      49950000
499600                     PV-SQL-RETURN-CD      DELIMITED BY SIZE      49960000
499700                     ' 7040-FETCH-EXPECT'   DELIMITED BY SIZE     49970000
499800                                      INTO PC166-CRA-RET-MSG      49980000
499900              MOVE '09'               TO   PC166-CRA-RET-CDE      49990000
500000              PERFORM 9000-RETURN-CALL                            50000000
500100                                                                  50010000
500200         WHEN SQLWARN0 NOT = SPACES                               50020000
500300         WHEN SQLCODE < ZERO                                      50030000
500400         WHEN SQLCODE > ZERO                                      50040000
500500              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      50050000
500600              STRING 'SQL='                 DELIMITED BY SIZE     50060000
500700                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     50070000
500800                     ' 7040-FETCH-EXPECT'   DELIMITED BY SIZE     50080000
500900                                       INTO PC166-CRA-RET-MSG     50090000
501000              MOVE '10'                TO   PC166-CRA-RET-CDE     50100000
501100              PERFORM 9000-RETURN-CALL                            50110000
501200                                                                  50120000
501300     END-EVALUATE.                                                50130000
501400                                                                  50140000
501500                                                                  50150000
501600*================================================================*50160000
501700* CLOSE EXPECT CURSOR - STORE ALLOCATION CURSOR                  *50170000
501800*================================================================*50180000
501900 7050-CLOSE-EXPECT-CSR.                                           50190000
502000                                                                  50200000
502100     EXEC SQL                                                     50210000
502200         CLOSE EXPECT-CSR                                         50220000
502300     END-EXEC.                                                    50230000
502400                                                                  50240000
502500     EVALUATE TRUE                                                50250000
502600         WHEN SQLCODE = ZERO                                      50260000
502700             CONTINUE                                             50270000
502800                                                                  50280000
502900         WHEN SQLCODE = -904                                      50290000
503000         WHEN SQLCODE = -911                                      50300000
503100         WHEN SQLCODE = -913                                      50310000
503200              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      50320000
503300              STRING 'SQL='                 DELIMITED BY SIZE     50330000
503400                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     50340000
503500                     ' 7050-CLOSE-EXPECT'   DELIMITED BY SIZE     50350000
503600                                       INTO PC166-CRA-RET-MSG     50360000
503700              MOVE '11'                TO   PC166-CRA-RET-CDE     50370000
503800              PERFORM 9000-RETURN-CALL                            50380000
503900                                                                  50390000
504000         WHEN SQLWARN0 NOT = SPACES                               50400000
504100         WHEN SQLCODE < ZERO                                      50410000
504200         WHEN SQLCODE > ZERO                                      50420000
504300              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      50430000
504400              STRING 'SQL='                 DELIMITED BY SIZE     50440000
504500                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     50450000
504600                     ' 7050-CLOSE-EXPECT'   DELIMITED BY SIZE     50460000
504700                                       INTO PC166-CRA-RET-MSG     50470000
504800              MOVE '12'                TO   PC166-CRA-RET-CDE     50480000
504900              PERFORM 9000-RETURN-CALL                            50490000
505000                                                                  50500000
505100                                                                  50510000
505200     END-EVALUATE.                                                50520000
505300                                                                  50530000
505400                                                                  50540000
505500*----------------------------------------------------------------*50550000
505600* PRE-PACK ORDER - OPEN CURSOR                                    50560000
505700*----------------------------------------------------------------*50570000
505800 7060-OPEN-PREPK-CURSOR.                                          50580000
505900                                                                  50590000
506000     EXEC SQL                                                     50600000
506100          OPEN PRE_PACK_CSR                                       50610000
506200     END-EXEC.                                                    50620000
506300                                                                  50630000
506400     EVALUATE TRUE                                                50640000
506500         WHEN SQLCODE = ZERO                                      50650000
506600             CONTINUE                                             50660000
506700         WHEN SQLCODE = -904                                      50670000
506800         WHEN SQLCODE = -911                                      50680000
506900         WHEN SQLCODE = -913                                      50690000
507000              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      50700000
507100              STRING 'SQL='                 DELIMITED BY SIZE     50710000
507200                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     50720000
507300                     ' 7060-OPEN-PREPK  '   DELIMITED BY SIZE     50730000
507400                                       INTO PC166-CRA-RET-MSG     50740000
507500              MOVE '15'                TO   PC166-CRA-RET-CDE     50750000
507600              PERFORM 9000-RETURN-CALL                            50760000
507700                                                                  50770000
507800         WHEN SQLWARN0 NOT = SPACES                               50780000
507900         WHEN SQLCODE < ZERO                                      50790000
508000         WHEN SQLCODE > ZERO                                      50800000
508100              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      50810000
508200              STRING 'SQL='                 DELIMITED BY SIZE     50820000
508300                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     50830000
508400                     ' 7060-OPEN-PREPK  '   DELIMITED BY SIZE     50840000
508500                                       INTO PC166-CRA-RET-MSG     50850000
508600             MOVE '16'                 TO   PC166-CRA-RET-CDE     50860000
508700             PERFORM 9000-RETURN-CALL                             50870000
508800     END-EVALUATE.                                                50880000
508900                                                                  50890000
509000                                                                  50900000
509100*================================================================*50910000
509200* FETCH PREPK CURSOR                                             *50920000
509300*================================================================*50930000
509400 7065-FETCH-PREPK-CSR.                                            50940000
509500                                                                  50950000
509600     EXEC SQL                                                     50960000
509700         FETCH PRE_PACK_CSR                                       50970000
509800          INTO :RECITM-ORD-LNE-NBR                                50980000
509900              ,:RECITM-PREPK-RATO-QTY                             50990000
510000     END-EXEC.                                                    51000000
510100                                                                  51010000
510200     EVALUATE TRUE                                                51020000
510300         WHEN SQLCODE = ZERO                                      51030000
510400             ADD +1                   TO PV-PREPK-TABLE-ENTRIES   51040000
510500             IF  RECITM-PREPK-RATO-QTY  =  0                      51050000
510600                 SET PS-EOF-PREPK-CSR     TO TRUE                 51060000
510700             END-IF                                               51070000
510800                                                                  51080000
510900         WHEN SQLCODE = +100                                      51090000
511000             SET PS-EOF-PREPK-CSR     TO TRUE                     51100000
511100                                                                  51110000
511200         WHEN SQLCODE = -904                                      51120000
511300         WHEN SQLCODE = -911                                      51130000
511400         WHEN SQLCODE = -913                                      51140000
511500              MOVE SQLCODE            TO   PV-SQL-RETURN-CD       51150000
511600              STRING 'SQL='                DELIMITED BY SIZE      51160000
511700                     PV-SQL-RETURN-CD      DELIMITED BY SIZE      51170000
511800                     ' 7065-FETCH-PREPK '   DELIMITED BY SIZE     51180000
511900                                      INTO PC166-CRA-RET-MSG      51190000
512000              MOVE '17'               TO   PC166-CRA-RET-CDE      51200000
512100              PERFORM 9000-RETURN-CALL                            51210000
512200                                                                  51220000
512300         WHEN SQLWARN0 NOT = SPACES                               51230000
512400         WHEN SQLCODE < ZERO                                      51240000
512500         WHEN SQLCODE > ZERO                                      51250000
512600              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      51260000
512700              STRING 'SQL='                 DELIMITED BY SIZE     51270000
512800                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     51280000
512900                     ' 7065-FETCH-PREPK '   DELIMITED BY SIZE     51290000
513000                                       INTO PC166-CRA-RET-MSG     51300000
513100              MOVE '18'                TO   PC166-CRA-RET-CDE     51310000
513200              PERFORM 9000-RETURN-CALL                            51320000
513300                                                                  51330000
513400     END-EVALUATE.                                                51340000
513500                                                                  51350000
513600                                                                  51360000
513700*================================================================*51370000
513800* CLOSE PREPACK CURSOR                                           *51380000
513900*================================================================*51390000
514000 7070-CLOSE-PREPK-CSR.                                            51400000
514100                                                                  51410000
514200     EXEC SQL                                                     51420000
514300         CLOSE PRE_PACK_CSR                                       51430000
514400     END-EXEC.                                                    51440000
514500                                                                  51450000
514600     EVALUATE TRUE                                                51460000
514700         WHEN SQLCODE = ZERO                                      51470000
514800             CONTINUE                                             51480000
514900                                                                  51490000
515000         WHEN SQLCODE = -904                                      51500000
515100         WHEN SQLCODE = -911                                      51510000
515200         WHEN SQLCODE = -913                                      51520000
515300              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      51530000
515400              STRING 'SQL='                 DELIMITED BY SIZE     51540000
515500                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     51550000
515600                     ' 7070-CLOSE-PREPK '   DELIMITED BY SIZE     51560000
515700                                       INTO PC166-CRA-RET-MSG     51570000
515800              MOVE '19'                TO   PC166-CRA-RET-CDE     51580000
515900              PERFORM 9000-RETURN-CALL                            51590000
516000                                                                  51600000
516100         WHEN SQLWARN0 NOT = SPACES                               51610000
516200         WHEN SQLCODE < ZERO                                      51620000
516300         WHEN SQLCODE > ZERO                                      51630000
516400              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      51640000
516500              STRING 'SQL='                 DELIMITED BY SIZE     51650000
516600                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     51660000
516700                     ' 7070-CLOSE-PREPK '   DELIMITED BY SIZE     51670000
516800                                       INTO PC166-CRA-RET-MSG     51680000
516900              MOVE '20'                TO   PC166-CRA-RET-CDE     51690000
517000              PERFORM 9000-RETURN-CALL                            51700000
517100                                                                  51710000
517200                                                                  51720000
517300     END-EVALUATE.                                                51730000
517400                                                                  51740000
517500                                                                  51750000
517600*----------------------------------------------------------------*51760000
517700* SHIPMENT SUMMARY - OPEN CURSOR                                  51770000
517800*----------------------------------------------------------------*51780000
517900 7075-OPEN-SHPSUM-CURSOR.                                         51790000
518000                                                                  51800000
518100     EXEC SQL                                                     51810000
518200          OPEN SHIP_SUM_CSR                                       51820000
518300     END-EXEC.                                                    51830000
518400                                                                  51840000
518500     EVALUATE TRUE                                                51850000
518600         WHEN SQLCODE = ZERO                                      51860000
518700             CONTINUE                                             51870000
518800         WHEN SQLCODE = -904                                      51880000
518900         WHEN SQLCODE = -911                                      51890000
519000         WHEN SQLCODE = -913                                      51900000
519100              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      51910000
519200              STRING 'SQL='                 DELIMITED BY SIZE     51920000
519300                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     51930000
519400                     ' 7075-OPEN-SHPSUM '   DELIMITED BY SIZE     51940000
519500                                       INTO PC166-CRA-RET-MSG     51950000
519600              MOVE '21'                TO   PC166-CRA-RET-CDE     51960000
519700              PERFORM 9000-RETURN-CALL                            51970000
519800                                                                  51980000
519900         WHEN SQLWARN0 NOT = SPACES                               51990000
520000         WHEN SQLCODE < ZERO                                      52000000
520100         WHEN SQLCODE > ZERO                                      52010000
520200              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      52020000
520300              STRING 'SQL='                 DELIMITED BY SIZE     52030000
520400                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     52040000
520500                     ' 7075-OPEN-SHPSUM '   DELIMITED BY SIZE     52050000
520600                                       INTO PC166-CRA-RET-MSG     52060000
520700             MOVE '22'                 TO   PC166-CRA-RET-CDE     52070000
520800             PERFORM 9000-RETURN-CALL                             52080000
520900     END-EVALUATE.                                                52090000
521000                                                                  52100000
521100                                                                  52110000
521200*================================================================*52120000
521300* FETCH SHIPMENT SUMMARY CURSOR                                  *52130000
521400*================================================================*52140000
521500 7080-FETCH-SHPSUM-CSR.                                           52150000
521600                                                                  52160000
521700     EXEC SQL                                                     52170000
521800         FETCH SHIP_SUM_CSR                                       52180000
521900          INTO :SHPSUM-PO-NBR                                     52190000
522000              ,:SHPSUM-PKSL-SEQ-NBR                               52200000
522100              ,:SHPSUM-CART-COMB-NBR                              52210000
522200              ,:SHPSUM-PO-LNE-NBR                                 52220000
522300              ,:SHPSUM-TOT-CART-CNT                               52230000
522400              ,:SHPSUM-OTPK-UNT-QTY                               52240000
522500     END-EXEC.                                                    52250000
522600                                                                  52260000
522700     EVALUATE TRUE                                                52270000
522800         WHEN SQLCODE = ZERO                                      52280000
522900             CONTINUE                                             52290000
523000         WHEN SQLCODE = +100                                      52300000
523100             SET PS-EOF-SHPSUM-CSR     TO TRUE                    52310000
523200                                                                  52320000
523300         WHEN SQLCODE = -904                                      52330000
523400         WHEN SQLCODE = -911                                      52340000
523500         WHEN SQLCODE = -913                                      52350000
523600              MOVE SQLCODE            TO   PV-SQL-RETURN-CD       52360000
523700              STRING 'SQL='                DELIMITED BY SIZE      52370000
523800                     PV-SQL-RETURN-CD      DELIMITED BY SIZE      52380000
523900                     ' 7080-FETCH-SHPSUM'   DELIMITED BY SIZE     52390000
524000                                      INTO PC166-CRA-RET-MSG      52400000
524100              MOVE '23'               TO   PC166-CRA-RET-CDE      52410000
524200              PERFORM 9000-RETURN-CALL                            52420000
524300                                                                  52430000
524400         WHEN SQLWARN0 NOT = SPACES                               52440000
524500         WHEN SQLCODE < ZERO                                      52450000
524600         WHEN SQLCODE > ZERO                                      52460000
524700              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      52470000
524800              STRING 'SQL='                 DELIMITED BY SIZE     52480000
524900                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     52490000
525000                     ' 7080-FETCH-SHPSUM'   DELIMITED BY SIZE     52500000
525100                                       INTO PC166-CRA-RET-MSG     52510000
525200              MOVE '24'                TO   PC166-CRA-RET-CDE     52520000
525300              PERFORM 9000-RETURN-CALL                            52530000
525400                                                                  52540000
525500     END-EVALUATE.                                                52550000
525600                                                                  52560000
525700                                                                  52570000
525800*================================================================*52580000
525900* CLOSE SHIPMENU CARTON SUMMARY CURSOR                           *52590000
526000*================================================================*52600000
526100 7085-CLOSE-SHPSUM-CSR.                                           52610000
526200                                                                  52620000
526300     EXEC SQL                                                     52630000
526400         CLOSE SHIP_SUM_CSR                                       52640000
526500     END-EXEC.                                                    52650000
526600                                                                  52660000
526700     EVALUATE TRUE                                                52670000
526800         WHEN SQLCODE = ZERO                                      52680000
526900             CONTINUE                                             52690000
527000                                                                  52700000
527100         WHEN SQLCODE = -904                                      52710000
527200         WHEN SQLCODE = -911                                      52720000
527300         WHEN SQLCODE = -913                                      52730000
527400              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      52740000
527500              STRING 'SQL='                 DELIMITED BY SIZE     52750000
527600                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     52760000
527700                     ' 7085-CLOSE-SHPSUM'   DELIMITED BY SIZE     52770000
527800                                       INTO PC166-CRA-RET-MSG     52780000
527900              MOVE '25'                TO   PC166-CRA-RET-CDE     52790000
528000              PERFORM 9000-RETURN-CALL                            52800000
528100                                                                  52810000
528200         WHEN SQLWARN0 NOT = SPACES                               52820000
528300         WHEN SQLCODE < ZERO                                      52830000
528400         WHEN SQLCODE > ZERO                                      52840000
528500              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      52850000
528600              STRING 'SQL='                 DELIMITED BY SIZE     52860000
528700                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     52870000
528800                     ' 7085-CLOSE-SHPSUM'   DELIMITED BY SIZE     52880000
528900                                       INTO PC166-CRA-RET-MSG     52890000
529000              MOVE '26'                TO   PC166-CRA-RET-CDE     52900000
529100              PERFORM 9000-RETURN-CALL                            52910000
529200                                                                  52920000
529300     END-EVALUATE.                                                52930000
529400                                                                  52940000
529500                                                                  52950000
529600*================================================================*52960000
529700* GET AD DATE TO APPEAR ON LABELS                                *52970000
529800*================================================================*52980000
529900 7200-GET-AD-DATE.                                                52990000
530000                                                                  53000000
530100     EXEC SQL                                                     53010000
530500          SELECT  B.UNT_RTL_PR_AMT                                53050035
530900           INTO   :PURITM-UNT-RTL-PR-AMT                          53090035
531000            FROM  TRECITM A                                       53100000
531100                , TPURITM B                                       53110000
531200           WHERE  A.ORD_NBR        = :DK-PO-NBR                   53120000
531300             AND  A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             53130000
531400             AND  A.ORD_LNE_NBR    = :DK-ORD-LNE-NBR              53140000
531500             AND  A.VER_STATUS_CDE = 'A'                          53150000
531600             AND  A.ORD_NBR        = B.PO_NBR                     53160000
531700             AND  A.PO_VER_NBR     = B.VER_NBR                    53170000
531800             AND  A.ORD_LNE_NBR    = B.APP_PO_LNE_NBR             53180000
531900     END-EXEC.                                                    53190000
532000                                                                  53200000
532100     EVALUATE TRUE                                                53210000
532200         WHEN SQLCODE = ZERO                                      53220000
532400         WHEN SQLCODE = +100                                      53240000
532500              CONTINUE                                            53250035
532600         WHEN SQLCODE = -904                                      53260000
532700         WHEN SQLCODE = -911                                      53270000
532800         WHEN SQLCODE = -913                                      53280000
532900             MOVE SQLCODE             TO   PV-SQL-RETURN-CD       53290000
533000             STRING 'SQL='                 DELIMITED BY SIZE      53300000
533100                    PV-SQL-RETURN-CD       DELIMITED BY SIZE      53310000
533200                     ' 7200-GET-AD-DATE '  DELIMITED BY SIZE      53320000
533300                                      INTO PC166-CRA-RET-MSG      53330000
533400             MOVE '13'                TO   PC166-CRA-RET-CDE      53340000
533500             PERFORM 9000-RETURN-CALL                             53350000
533600                                                                  53360000
533700         WHEN SQLWARN0 NOT = SPACES                               53370000
533800         WHEN SQLCODE < ZERO                                      53380000
533900         WHEN SQLCODE > ZERO                                      53390000
534000              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      53400000
534100              STRING 'SQL='                 DELIMITED BY SIZE     53410000
534200                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     53420000
534300                     ' 7200-GET-AD-DATE '   DELIMITED BY SIZE     53430000
534400                                       INTO PC166-CRA-RET-MSG     53440000
534500              MOVE '14'                TO   PC166-CRA-RET-CDE     53450000
534600             PERFORM 9000-RETURN-CALL                             53460000
534700     END-EVALUATE.                                                53470000
534800                                                                  53480000
534810 7300-GET-CURRENT-DOOR.                                           53481038
534811                                                                  53481165
534820     MOVE PC166-OPER-UNT-ID TO CNDCDR-OPER-UNT-ID.                53482065
534821                                                                  53482165
534830     EXEC SQL                                                     53483038
534831          SELECT A.DOOR_ID                                        53483138
534832          INTO   :CNDCDR-DOOR-ID                                  53483240
534833          FROM   TCNDCDR A                                        53483338
534834               , TCNDRST B                                        53483438
534837          WHERE  A.DOOR_ID         = B.DOOR_ID                    53483743
534838            AND  A.OPER_UNT_ID     = :CNDCDR-OPER-UNT-ID          53483865
534839            AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                53483965
534840            AND  A.DOOR_TYP_CDE    = 'SH'                         53484065
534841            AND  B.STR_NBR         = :RECDIS-STR-NBR              53484165
534842            AND  B.END_TMST        = '9999-09-09-09.09.09.999999' 53484265
534843            AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR       53484365
534844                        DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR       53484465
534845                        DOOR_LOC_DESC  LIKE  '%RE-OPEN%'          53484565
534846                       )                                          53484665
534896     END-EXEC.                                                    53489638
534897                                                                  53489738
534999     EVALUATE TRUE                                                53499938
535000         WHEN SQLCODE = ZERO                                      53500038
535001              CONTINUE                                            53500144
535002         WHEN SQLCODE = -811                                      53500238
535004         WHEN SQLCODE = +100                                      53500442
535005              MOVE SPACES TO CNDCDR-DOOR-ID                       53500542
535006         WHEN SQLCODE = -904                                      53500638
535007         WHEN SQLCODE = -911                                      53500738
535008         WHEN SQLCODE = -913                                      53500838
535009                                                                  53500938
535010             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   53501038
535011             MOVE '7300-GET-CURRENT-DOOR '                        53501138
535012                                             TO PV-SOFT-PARAGRAPH 53501238
535013             STRING ' PCKCS719 - '           DELIMITED BY SIZE    53501338
535014                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    53501438
535015                                           INTO PV-CICS-MSG-AREA2 53501538
535016             MOVE LENGTH OF PV-CICS-MSG-AREA2                     53501638
535017               TO PV-COMMAREA-LENGTH                              53501738
535018             EXEC CICS                                            53501838
535019                  WRITEQ TD                                       53501938
535020                   QUEUE  ('CSSL')                                53502038
535021                    FROM  (PV-CICS-MSG-AREA2)                     53502138
535022                  LENGTH  (PV-COMMAREA-LENGTH)                    53502238
535023                    RESP  (PV-CICS-RESP)                          53502338
535024             END-EXEC                                             53502438
535025             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              53502538
535026             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            53502638
535027             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            53502738
535028             MOVE RECDIS-STR-NBR     TO  PV-HOLD3-STORE           53502838
535029             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        53502938
535030             MOVE LENGTH OF PV-CICS-MSG-AREA2                     53503038
535031               TO PV-COMMAREA-LENGTH                              53503138
535032             EXEC CICS                                            53503238
535033                  WRITEQ TD                                       53503338
535034                   QUEUE  ('CSSL')                                53503438
535035                    FROM  (PV-CICS-MSG-AREA2)                     53503538
535036                  LENGTH  (PV-COMMAREA-LENGTH)                    53503638
535037                    RESP  (PV-CICS-RESP)                          53503738
535038             END-EXEC                                             53503838
535039                                                                  53503938
535040              SET  PS-ERROR                                       53504038
535041                   PC166-CRA-DB-BUSY  TO  TRUE                    53504138
535042              MOVE 'TCNDCDR SELECT           '                    53504238
535043                TO PC166-CRA-RET-MSG                              53504338
535044                                                                  53504438
535045         WHEN SQLWARN0 NOT = SPACES                               53504538
535046         WHEN SQLCODE NOT EQUAL ZERO                              53504638
535047                                                                  53504738
535048             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   53504838
535049             MOVE '7300-GET-CURRENT-DOOR '                        53504938
535050                                             TO PV-SOFT-PARAGRAPH 53505038
535051             STRING ' PCKCS719 - '           DELIMITED BY SIZE    53505138
535052                    PV-SOFT-ABORT-MSG        DELIMITED BY SIZE    53505238
535053                                           INTO PV-CICS-MSG-AREA2 53505338
535054             MOVE LENGTH OF PV-CICS-MSG-AREA2                     53505438
535055               TO PV-COMMAREA-LENGTH                              53505538
535056             EXEC CICS                                            53505638
535057                  WRITEQ TD                                       53505738
535058                   QUEUE  ('CSSL')                                53505838
535059                    FROM  (PV-CICS-MSG-AREA2)                     53505938
535060                  LENGTH  (PV-COMMAREA-LENGTH)                    53506038
535061                    RESP  (PV-CICS-RESP)                          53506138
535062             END-EXEC                                             53506238
535063             MOVE PC166-PO-NBR       TO  PV-HOLD3-PO              53506338
535064             MOVE PC166-RCVR-SEQ-NBR TO  PV-HOLD3-RCVR            53506438
535065             MOVE PC166-PO-LNE-NBR   TO  PV-HOLD3-LINE            53506538
535066             MOVE PV-CICS-MSG-HOLD3  TO  PV-CICS-MSG-AREA2        53506638
535067             MOVE LENGTH OF PV-CICS-MSG-AREA2                     53506738
535068               TO PV-COMMAREA-LENGTH                              53506838
535069             EXEC CICS                                            53506938
535070                  WRITEQ TD                                       53507038
535071                   QUEUE  ('CSSL')                                53507138
535072                    FROM  (PV-CICS-MSG-AREA2)                     53507238
535073                  LENGTH  (PV-COMMAREA-LENGTH)                    53507338
535074                    RESP  (PV-CICS-RESP)                          53507438
535075             END-EXEC                                             53507538
535076                                                                  53507638
535077              SET  PS-ERROR                                       53507738
535078                   PC166-CRA-DB-BUSY  TO  TRUE                    53507838
535079              MOVE ' SELECT TCNDCDR          '                    53507938
535080                TO PC166-CRA-RET-MSG                              53508038
535081                                                                  53508138
535082     END-EVALUATE.                                                53508238
535083                                                                  53508338
535084*================================================================*53508438
535090* OPEN DOOR SEQ CURSOR                                           *53509000
535100*================================================================*53510000
535200 8030-OPEN-DOOR-SEQ-CSR.                                          53520000
535300                                                                  53530000
535400     EXEC SQL                                                     53540000
535500         OPEN DOOR-SEQ-CSR                                        53550000
535600     END-EXEC.                                                    53560000
535700                                                                  53570000
535800     EVALUATE TRUE                                                53580000
535900         WHEN SQLCODE = ZERO                                      53590000
536000             CONTINUE                                             53600000
536100                                                                  53610000
536200         WHEN SQLCODE = -904                                      53620000
536300         WHEN SQLCODE = -911                                      53630000
536400         WHEN SQLCODE = -913                                      53640000
536500              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      53650000
536600              STRING 'SQL='                 DELIMITED BY SIZE     53660000
536700                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     53670000
536800                     ' 8030-DOOR-SEQ-CSR'   DELIMITED BY SIZE     53680000
536900                                       INTO PC166-CRA-RET-MSG     53690000
537000              MOVE '29'                TO   PC166-CRA-RET-CDE     53700000
537100              PERFORM 9000-RETURN-CALL                            53710000
537200                                                                  53720000
537300         WHEN SQLWARN0 NOT = SPACES                               53730000
537400         WHEN SQLCODE < ZERO                                      53740000
537500         WHEN SQLCODE > ZERO                                      53750000
537600              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      53760000
537700              STRING 'SQL='                 DELIMITED BY SIZE     53770000
537800                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     53780000
537900                     ' 8030-DOOR-SEQ-CSR'   DELIMITED BY SIZE     53790000
538000                                       INTO PC166-CRA-RET-MSG     53800000
538100             MOVE '30'                 TO   PC166-CRA-RET-CDE     53810000
538200             PERFORM 9000-RETURN-CALL                             53820000
538300                                                                  53830000
538400     END-EVALUATE.                                                53840000
538500                                                                  53850000
538600                                                                  53860000
538700*================================================================*53870000
538800* FETCH DOOR SEQ CURSOR                                          *53880000
538900*================================================================*53890000
539000 8040-FETCH-DOOR-SEQ-CSR.                                         53900000
539100                                                                  53910000
539200     EXEC SQL                                                     53920000
539300         FETCH DOOR-SEQ-CSR                                       53930000
539400          INTO :PV-TYPE-CODE-SEQ                                  53940000
539500              ,:XLT00010-LOC-TYP-CDE                              53950000
539600              ,:XLT00010-E-BUS-IND                                53960000
539700              ,:RECDIS-STR-NBR                                    53970000
539800              ,:RECDIS-EXPTED-ITM-QTY                             53980000
539900              ,:CNDCDR-DOOR-LBL-SEQ-NBR                           53990000
540000              ,:XLT00010-OPN-DTE                                  54000002
540100     END-EXEC.                                                    54010002
540200                                                                  54020002
540300     EVALUATE TRUE                                                54030002
540400         WHEN SQLCODE = ZERO                                      54040002
540500             ADD +1                   TO PV-EXPECT-TABLE-ENTRIES  54050002
540600         WHEN SQLCODE = +100                                      54060002
540700             SET PS-EOF-DOOR-SEQ-CSR  TO TRUE                     54070002
540800                                                                  54080002
540900         WHEN SQLCODE = -904                                      54090002
541000         WHEN SQLCODE = -911                                      54100002
541100         WHEN SQLCODE = -913                                      54110002
541200              MOVE SQLCODE            TO   PV-SQL-RETURN-CD       54120002
541300              STRING 'SQL='                DELIMITED BY SIZE      54130002
541400                     PV-SQL-RETURN-CD      DELIMITED BY SIZE      54140002
541500                     ' 8040-FETCH-DOOR-SEQ' DELIMITED BY SIZE     54150002
541600                                      INTO PC166-CRA-RET-MSG      54160002
541700              MOVE '31'               TO   PC166-CRA-RET-CDE      54170002
541800              PERFORM 9000-RETURN-CALL                            54180002
541900                                                                  54190002
542000         WHEN SQLWARN0 NOT = SPACES                               54200002
542100         WHEN SQLCODE < ZERO                                      54210002
542200         WHEN SQLCODE > ZERO                                      54220002
542300              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      54230002
542400              STRING 'SQL='                 DELIMITED BY SIZE     54240002
542500                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     54250002
542600                     ' 8040-FETCH-DOOR-SEQ' DELIMITED BY SIZE     54260002
542700                                       INTO PC166-CRA-RET-MSG     54270002
542800              MOVE '32'                TO   PC166-CRA-RET-CDE     54280002
542900              PERFORM 9000-RETURN-CALL                            54290002
543000                                                                  54300002
543100     END-EVALUATE.                                                54310002
543200                                                                  54320002
543300                                                                  54330002
543400*================================================================*54340002
543500* CLOSE DOOR-SEQ CURSOR -                                        *54350002
543600*================================================================*54360002
543700 8050-CLOSE-DOOR-SEQ-CSR.                                         54370002
543800                                                                  54380002
543900     EXEC SQL                                                     54390002
544000         CLOSE DOOR-SEQ-CSR                                       54400002
544100     END-EXEC.                                                    54410002
544200                                                                  54420002
544300     EVALUATE TRUE                                                54430002
544400         WHEN SQLCODE = ZERO                                      54440002
544500             CONTINUE                                             54450002
544600                                                                  54460002
544700         WHEN SQLCODE = -904                                      54470002
544800         WHEN SQLCODE = -911                                      54480002
544900         WHEN SQLCODE = -913                                      54490002
545000              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      54500002
545100              STRING 'SQL='                 DELIMITED BY SIZE     54510002
545200                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     54520002
545300                     ' 8050-CLOSE-DOOR-SEQ' DELIMITED BY SIZE     54530002
545400                                       INTO PC166-CRA-RET-MSG     54540002
545500              MOVE '33'                TO   PC166-CRA-RET-CDE     54550002
545600              PERFORM 9000-RETURN-CALL                            54560002
545700                                                                  54570002
545800         WHEN SQLWARN0 NOT = SPACES                               54580002
545900         WHEN SQLCODE < ZERO                                      54590002
546000         WHEN SQLCODE > ZERO                                      54600002
546100              MOVE SQLCODE             TO   PV-SQL-RETURN-CD      54610002
546200              STRING 'SQL='                 DELIMITED BY SIZE     54620002
546300                     PV-SQL-RETURN-CD       DELIMITED BY SIZE     54630002
546400                     ' 8050-CLOSE-DOOR-SEQ' DELIMITED BY SIZE     54640002
546500                                       INTO PC166-CRA-RET-MSG     54650002
546600              MOVE '34'                TO   PC166-CRA-RET-CDE     54660002
546700              PERFORM 9000-RETURN-CALL                            54670002
546800                                                                  54680002
546900                                                                  54690002
547000     END-EVALUATE.                                                54700002
547100                                                                  54710002
547200                                                                  54720002
547300*----------------------------------------------------------------*54730002
547400*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.        *54740000
547500*----------------------------------------------------------------*54750000
547600 9000-RETURN-CALL.                                                54760000
547700                                                                  54770000
547800     MOVE PC166-COMMAREA-REC TO DFHCOMMAREA.                      54780000
547900                                                                  54790000
548000     EXEC CICS                                                    54800000
548100         RETURN                                                   54810000
548200     END-EXEC.                                                    54820000
548300                                                                  54830000
548400                                                                  54840000
548500*----------------------------------------------------------------*54850000
548600*  SYNCPOINT                                                     *54860000
548700*----------------------------------------------------------------*54870000
548800 9100-SYNCPOINT.                                                  54880000
548900                                                                  54890000
549000     EXEC CICS                                                    54900000
549100         SYNCPOINT                                                54910000
549200     END-EXEC.                                                    54920000
549300                                                                  54930000
