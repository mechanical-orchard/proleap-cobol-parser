000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020069
000300*-----------------------*                                         00030004
000400 PROGRAM-ID.    CNKCS218.                                         00040099
000500 AUTHOR.        LYNN MCADAMS.                                     00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  NOVEMBER, 2000.                                   00070099
000800 DATE-COMPILED.                                                   00080004
000900*---------------------------------------------------------------* 00090099
001000*    Y218 - PRINTER MAINTENANCE - PRINTER TYPE ADD/UPDATE/DELETE  00100099
001100*                                                                 00110099
001200*---------------------------------------------------------------* 00120099
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00121099
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00122099
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00123099
263455*----------------------------------------------------------------*00124099
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00125099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00126099
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00127099
CICS  *-----------------------------------------------------------------00128099
001300 ENVIRONMENT DIVISION.                                            00130004
001400                                                                  00140004
001500 DATA DIVISION.                                                   00150004
001600                                                                  00160004
001700 WORKING-STORAGE SECTION.                                         00170004
001800                                                                  00180004
001900 01  DK-DB2-KEYS.                                                 00190099
002000     10  DK-PAPR-TRK-QTY          PIC  S9(4) COMP   VALUE ZEROES. 00200099
002100                                                                  00210099
002200 01  PC-PROGRAM-CONSTANTS.                                        00220004
002300     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS218'.  00230099
002400     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CNK218  '.  00240099
002500     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM218 '.  00250099
002600     05  PC-Y                     PIC  X(01)  VALUE  'Y'.         00260099
002700     05  PC-N                     PIC  X(01)  VALUE  'N'.         00270099
002800     05  PC-P                     PIC  X(01)  VALUE  'P'.         00280099
002900     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00290004
003000                                              COMP.               00300004
003100     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00310004
003200                                              COMP.               00320004
003300     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           00330004
003400                                              COMP.               00340004
003500     05  PC-INTER-APPL-CODES.                                     00350099
003600         10  PC-INTER-APPL-CRIT-SPEC-ADD                          00360099
003700                                  PIC  X(01)  VALUE '4'.          00370099
003800         10  PC-INTER-APPL-LIST-ADD                               00380099
003900                                  PIC  X(01)  VALUE '2'.          00390099
004000         10  PC-INTER-APPL-LIST-UPDATE                            00400099
004100                                  PIC  X(01)  VALUE '3'.          00410099
004200         10  PC-INTER-APPL-LIST-DELETE                            00420099
004300                                  PIC  X(01)  VALUE '1'.          00430099
004400     05  PC-PRINT-QUEUE-SEQ       PIC  9(01)  VALUE 3.            00440099
004500*----------------------------------------------------------------*00450099
004600*  SYSTEM MESSAGES                                                00460099
004700*----------------------------------------------------------------*00470099
004800*   00005 - INVALID VALUE                                         00480099
004900*   00007 - REQUIRED ENTRY                                        00490099
005000*   00008 - MUST BE NUMERIC                                       00500099
005100*   00034 - ADD SUCCESSFUL                                        00510099
005200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00520099
005300*   00059 - UPDATE(S) SUCCESSFUL                                  00530099
005400*   00069 - TOP OF LIST                                           00540099
005500*   00070 - BOTTOM OF LIST                                        00550099
005600*   00095 - APPLICATION SYSTEM DOES NOT EXIST                     00560099
005700*   00115 - DELETE SUCCESSFUL                                     00570099
005800*   00148 - DATA DOES NOT EXIST                                   00580099
005900*   00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID            00590099
006000*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 00600099
006100*   00746 - INVALID PRINTER DESTINATION                           00610099
006200*   02552 - PRINTER TYPE ALREADY EXISTS - UNABLE TO ADD           00620099
006300*   99901 - INVALID COMMAND WAS ENTERED                           00630099
006400*----------------------------------------------------------------*00640099
006500     05  PC-TSYMSG-NUMBERS.                                       00650004
006600         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00660071
006700         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00670004
006800         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00680099
006900         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00690099
007000         10  PC-TSYMSG-00057      PIC  9(05)  VALUE 00057.        00700099
007100         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00710004
007200         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00720004
007300         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00730004
007400         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00740004
007500         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00750099
007600         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00760099
007700         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00770004
007800         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00780004
007900         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       00790099
008000         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00800099
008100         10  PC-TSYMSG-02552      PIC  9(05)  VALUE  02552.       00810099
008200         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00820004
008300                                                                  00830030
008400     05  PC-A                     PIC  X(01)  VALUE  'A'.         00840099
008500     05  PC-L                     PIC  X(01)  VALUE  'L'.         00850099
008600     05  PC-N                     PIC  X(01)  VALUE  'N'.         00860099
008700     05  PC-SPACE                 PIC  X(03)  VALUE  '   '.       00870099
008800*                                                                 00880004
008900 01  PS-PROGRAM-SWITCHES.                                         00890004
009000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00900004
009100         88  PS-ERROR                         VALUE  'Y'.         00910004
009200         88  PS-NO-ERROR                      VALUE  'N'.         00920004
009300     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         00930099
009400         88  PS-COMMAREA-VALID                VALUE  'Y'.         00940099
009500         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         00950099
009600     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         00960099
009700         88  PS-LIST-END                      VALUE  'Y'.         00970099
009800         88  PS-NO-LIST-END                   VALUE  'N'.         00980099
009900*                                                                 00990099
010000*                                                                 01000099
010100 01  PV-PROGRAM-VARIABLES.                                        01010099
010200******************************************************************01020099
010300*PV-INP VARIABLES HOLD COMMAREA VALUES                            01030099
010400*       ONLY PV-INP VARIABLES READ FROM AND WRITE TO ASC-'S       01040099
010500*PV-TBL VARIABLES HOLD TABLE VALUES                               01050099
010600*       ONLY PV-TBL VARIABLES READ FROM AND WRITE TO TABLES       01060099
010700******************************************************************01070099
010800     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01080099
010900                                              COMP SYNC.          01090099
011000     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01100099
011100                                              COMP SYNC.          01110099
011200     05  PV-INP-PRTR-TYP-CDE      PIC X(08).                      01120099
011300     05  PV-INP-PRTR-MFR-DESC     PIC X(25).                      01130099
011400     05  PV-INP-PRTR-MDL-DESC     PIC X(25).                      01140099
011500     05  PV-INP-PAPR-TRK-QTY      PIC S9(04)  COMP.               01150099
011600     05  PV-INP-AUTO-CTTR-IND     PIC X(01).                      01160099
011700     05  PV-INP-PRT-BRCDE-IND     PIC X(01).                      01170099
011800     05  PV-INP-PRTR-CNTL-IND     PIC X(01).                      01180099
011900                                                                  01190099
012000     05  PV-TBL-PRTR-TYP-CDE      PIC X(08).                      01200099
012100     05  PV-TBL-PRTR-MFR-DESC     PIC X(25).                      01210099
012200     05  PV-TBL-PRTR-MDL-DESC     PIC X(25).                      01220099
012300                                                                  01230099
012400     05  PV-TBL-PAPR-TRK-QTY      PIC S9(04) COMP.                01240099
012500     05  PV-TBL-AUTO-CTTR-IND     PIC X(01).                      01250099
012600     05  PV-TBL-PRT-BRCDE-IND     PIC X(01).                      01260099
012700     05  PV-TBL-PRTR-CNTL-IND     PIC X(01).                      01270099
012800*******                                                           01280099
012900     05  PV-PAPR-TRK-QTY1         PIC X(04)   VALUE SPACES.       01290099
013000         88   PV-PAPR-TRK1-1                  VALUE '0001'.       01300099
013100         88   PV-PAPR-TRK1-2                  VALUE '0002'.       01310099
013200         88   PV-PAPR-TRK1-3                  VALUE '0003'.       01320099
013300     05  PV-PAPR-TRK-QTY2         PIC X(04)   VALUE SPACES.       01330099
013400         88   PV-PAPR-TRK2-1                  VALUE '0001'.       01340099
013500         88   PV-PAPR-TRK2-2                  VALUE '0002'.       01350099
013600         88   PV-PAPR-TRK2-3                  VALUE '0003'.       01360099
013700     05  PV-PAPR-TRK-QTY3         PIC X(04)   VALUE SPACES.       01370099
013800         88   PV-PAPR-TRK3-1                  VALUE '0001'.       01380099
013900         88   PV-PAPR-TRK3-2                  VALUE '0002'.       01390099
014000         88   PV-PAPR-TRK3-3                  VALUE '0003'.       01400099
014100                                                                  01410099
014200*---------------------------------------------------------------* 01420099
014300* SELECTON QUEUE LAYOUT                                         * 01430099
014400*---------------------------------------------------------------* 01440099
014500     COPY CNWS163.                                                01450099
014600                                                                  01460099
014700*----------------------------------------------------------------*01470099
014800*    MAP LAYOUT                                                  *01480099
014900*----------------------------------------------------------------*01490099
015000                                                                  01500099
015100     COPY CNKM218.                                                01510099
015200                                                                  01520099
015300*----------------------------------------------------------------*01530099
015400*    ATTRIBUTE SETTINGS COPYBOOK.                                *01540099
015500*----------------------------------------------------------------*01550099
015600                                                                  01560099
015700     COPY DPWS015.                                                01570099
015800     COPY DPWS057.                                                01580099
015900                                                                  01590099
016000*----------------------------------------------------------------*01600099
016100*    FUNCTION KEYS COPYBOOK                                      *01610099
016200*----------------------------------------------------------------*01620099
016300                                                                  01630099
016400     COPY DPWS016.                                                01640099
016500                                                                  01650099
016600                                                                  01660099
016700**--------------------------------------------------------------**01670099
016800** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01680099
016900** SUB-ROUTINE (DPKUT100).                                      **01690099
017000**--------------------------------------------------------------**01700099
017100     COPY DPWS010I.                                               01710099
017200                                                                  01720099
017300**--------------------------------------------------------------**01730099
017400** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*01740099
017500** APPLICATION PROGRAMMING INTERFACE MODULE.                    **01750099
017600**--------------------------------------------------------------**01760099
017700     COPY DPWS030.                                                01770099
CICS       COPY DPWS930.                                                01780099
017900**--------------------------------------------------------------**01790099
018000*    STANDARD COMMAREA.                                           01800099
018100**--------------------------------------------------------------**01810099
018200                                                                  01820099
018300     COPY DPWS020.                                                01830099
018400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01840099
018500                                                                  01850099
018600*---------------------------------------------------------------* 01860099
018700* INTER-APPLICATION COMMAREA.                                     01870099
018800*   CNWS161 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 01880099
018900*             SPEC SCREEN.                                        01890099
019000*   CNWS162 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        01900099
019100*             THE LIST SCREEN                                     01910099
019200*---------------------------------------------------------------* 01920099
019300                                                                  01930099
019400         10  INTER-APPL-COMM-AREA PIC X(200).                     01940099
019500     COPY CNWS161.                                                01950099
019600     COPY CNWS162.                                                01960099
019700***************************************************************** 01970099
019800*    SPECIFIC COMMMAREA FOR DPKCS041.                             01980099
019900***************************************************************** 01990099
020000         10  ASC-SPECIFIC-COMMAREA.                               02000099
020100             15  ASC-PRTR-TYP-CDE          PIC X(08).             02010099
020200             15  ASC-PRTR-SELECT-TYPE      PIC X(01).             02020099
020300             15  ASC-PRTR-MFR-DESC         PIC X(25).             02030099
020400             15  ASC-PRTR-MDL-DESC         PIC X(25).             02040099
020500                                                                  02050099
020600*REDEFINED THIS FIELD SO WE CAN DO NUMERIC EDIT                   02060099
020700             15  ASC-PAPR-TRK-QTY          PIC X(04).             02070099
020800                 88  ASC-PAPR-TRK-QTY-VALID   VALUE '0001'        02080099
020900                                                    '0002'        02090099
021000                                                    '0003'        02100099
021100                                                    '    '.       02110099
021200                 88  ASC-PAPR-TRK-ENTERED     VALUE '0001'        02120099
021300                                                    '0002'        02130099
021400                                                    '0003'.       02140099
021500                 88  ASC-PAPR-TRK-QTY-1       VALUE '0001'.       02150099
021600                 88  ASC-PAPR-TRK-QTY-2       VALUE '0002'.       02160099
021700                 88  ASC-PAPR-TRK-QTY-3       VALUE '0003'.       02170099
021800             15  ASC-PAPR-TRK-QTY-R REDEFINES                     02180099
021900                                       ASC-PAPR-TRK-QTY.          02190099
022000                 20  ASC-PAPR-TRK-QTY-N    PIC 9(04).             02200099
022100                                                                  02210099
022200             15  ASC-AUTO-CTTR-IND         PIC  X(01).            02220099
022300                 88  ASC-SELECT-VALID-A    VALUE 'N' 'Y' ' '.     02230099
022400             15  ASC-PRT-BRCDE-IND         PIC  X(01).            02240099
022500                 88  ASC-SELECT-VALID-B    VALUE 'N' 'Y' ' '.     02250099
022600             15  ASC-PRTR-CNTL-IND         PIC  X(01).            02260099
022700                 88  ASC-SELECT-VALID-C    VALUE 'N' 'P' ' '.     02270099
022800                                                                  02280099
022900             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             02290099
023000*SWITCHES                                                         02300099
023100             15  ASC-ACTION-SW          PIC X(03).                02310099
023200                 88  ASC-ADD            VALUE 'ADD'.              02320099
023300                 88  ASC-DELETE         VALUE 'DEL'.              02330099
023400                 88  ASC-UPDATE         VALUE 'UPD'.              02340099
023500             15  ASC-PRTR-TYP-EXISTS-SW    PIC  X(01).            02350099
023600                 88  ASC-PRTR-TYP-EXISTS        VALUE  'Y'.       02360099
023700                 88  ASC-PRTR-TYP-NOT-EXISTS    VALUE  'N'.       02370099
023800                                                                  02380099
023900             15  ASC-TPRTRTY-INSERTED-SW   PIC  X(01).            02390099
024000                 88  ASC-TPRTRTY-INSERTED       VALUE  'Y'.       02400099
024100                 88  ASC-TPRTRTY-NOT-INSERTED   VALUE  'N'.       02410099
024200                                                                  02420099
024300             15  ASC-TPRTRTY-UPDATED-SW   PIC  X(01).             02430099
024400                 88  ASC-TPRTRTY-UPDATED              VALUE  'Y'. 02440099
024500                 88  ASC-TPRTRTY-NOT-UPDATED          VALUE  'N'. 02450099
024600                                                                  02460099
024700             15  ASC-TPRTRTY-DELETED-SW    PIC  X(01).            02470099
024800                 88  ASC-TPRTRTY-DELETED        VALUE  'Y'.       02480099
024900                 88  ASC-TPRTRTY-NOT-DELETED    VALUE  'N'.       02490099
025000*                                                                 02500099
025100             15  ASC-MSG-NUMBER.                                  02510099
025200                 20  ASC-MSG-NUMBER-N      PIC  9(05).            02520099
025300             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            02530099
025400             15  ASC-SYSTEM-ID             PIC  X(02).            02540099
025500             15  ASC-MSG-TEXT              PIC  X(70).            02550099
025600             15  ASC-USE-SELECTION-QUEUE-IND                      02560099
025700                                           PIC  X(01).            02570099
025800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02580099
025900             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02590099
026000             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02600099
026100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02610099
026200                                           PIC S9(09)  COMP-3.    02620099
026300             15  ASC-PRT-QUEUE-NAME.                              02630099
026400                 20  ASC-PRT-TERM-ID          PIC  X(04).         02640099
026500                 20  ASC-PRT-TASK-NUMBER      PIC S9(05) COMP-3.  02650099
026600                 20  ASC-PRT-SEQ              PIC  9(01).         02660099
026700             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    02670099
026800                                                          SYNC.   02680099
026900             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02690099
027000             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02700099
027100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         02710099
027200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     02720099
027300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     02730099
027400                                                                  02740099
027500*----------------------------------------------------------------*02750099
027600*    ABEND PROCESSING COPYBOOK.                                  *02760099
027700*----------------------------------------------------------------*02770099
027800     COPY DPWS013.                                                02780099
027900                                                                  02790099
028000                                                                  02800099
028100*----------------------------------------------------------------*02810099
028200*    DB2 AREA FOR PRINTER TYPE                                    02820099
028300*----------------------------------------------------------------*02830099
028400     EXEC SQL                                                     02840099
028500          INCLUDE TPRTRTY                                         02850099
028600     END-EXEC.                                                    02860099
028700                                                                  02870099
028800*----------------------------------------------------------------*02880099
028900*    DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        02890099
029000*----------------------------------------------------------------*02900099
029100     EXEC SQL                                                     02910099
029200          INCLUDE TSYMSG                                          02920099
029300     END-EXEC.                                                    02930099
029400                                                                  02940099
029500*----------------------------------------------------------------*02950099
029600*    DB2 AREA FOR COMMUNICATIONS                                  02960099
029700*----------------------------------------------------------------*02970099
029800     EXEC SQL                                                     02980099
029900          INCLUDE SQLCA                                           02990099
030000     END-EXEC.                                                    03000099
030100*                                                                 03010099
030200*                                                                 03020099
030300 LINKAGE SECTION.                                                 03030099
030400                                                                  03040099
030500 01  DFHCOMMAREA.                                                 03050099
030600     05  FILLER                         OCCURS  1 TO 4072 TIMES   03060099
030700                                        DEPENDING ON EIBCALEN.    03070099
030800         10  FILLER                     PIC X.                    03080099
030900*                                                                 03090099
031000*                                                                 03100099
031100 PROCEDURE DIVISION.                                              03110099
031200***************************************************************** 03120099
031300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03130099
031400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03140099
031500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03150099
031600**                                                             ** 03160099
031700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03170099
031800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03180099
031900***************************************************************** 03190099
032000 0000-MAIN-MODULE.                                                03200099
032100     INITIALIZE DP030-CICS-API-FIELDS.                            03210099
032200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03220099
032300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03230099
032400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03240099
032500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03250099
032600     MOVE LENGTH OF CNK218I        TO DP030-MAP-LENGTH (1).       03260099
032700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03270099
032800     PERFORM 0001-CALL-CICS-ARCH-API.                             03280099
032900                                                                  03290099
033000     PERFORM 1000-CONTROL-PROCESSING                              03300099
033100                                                                  03310099
033200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03320099
033300     PERFORM 0001-CALL-CICS-ARCH-API.                             03330099
033400                                                                  03340099
033500 0001-CALL-CICS-ARCH-API.                                         03350099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03360099
033700                                    DFHCOMMAREA                   03370099
033800                                    DP030-CICS-API-FIELDS         03380099
033900                                    DP020-STANDARD-COMMAREA       03390099
034000                                    CNK218I.                      03400099
034100                                                                  03410099
034200     IF  DP030-RC-CALL-SUCCESSFUL                                 03420099
034300         CONTINUE                                                 03430099
034400     ELSE                                                         03440099
034500         SET DP013-NO-ROLLBACK                                    03450099
034600             DP013-XCTL-DISPLAY-RESTART                           03460099
034700             DP013-CICS-ABEND      TO TRUE                        03470099
034800         MOVE 'BEFORE 0000-MAIN-MODULE'                           03480099
034900                                   TO DP013-PARAGRAPH             03490099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03491099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03492099
035200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03520099
035300         PERFORM DP013-0000-PROCESS-ABEND                         03530099
035400     END-IF.                                                      03540099
035500*                                                                 03550099
035600*                                                                 03560099
035700*----------------------------------------------------------------*03570099
035800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03580099
035900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03590099
036000*----------------------------------------------------------------*03600099
036100 1000-CONTROL-PROCESSING.                                         03610099
036200                                                                  03620099
036300     EVALUATE TRUE                                                03630099
036400         WHEN DP020-NEXT-ACT-INITIAL                              03640099
036500              INITIALIZE ASC-SPECIFIC-COMMAREA                    03650099
036600              MOVE EIBTRMID               TO ASC-PRT-TERM-ID      03660099
036700              MOVE DP020-SRC-TASK-NUMBER  TO ASC-PRT-TASK-NUMBER  03670099
036800              MOVE PC-PRINT-QUEUE-SEQ     TO ASC-PRT-SEQ          03680099
036900              PERFORM 1100-PROCESS-INTER-APPL-COMM                03690099
037000                                                                  03700099
037100              EVALUATE ASC-INT-APPL-FORMAT-IND                    03710099
037200                 WHEN PC-INTER-APPL-LIST-ADD                      03720099
037300                    MOVE PC-SPACE  TO ASC-PAPR-TRK-QTY            03730099
037400              END-EVALUATE                                        03740099
037500                                                                  03750099
037600              IF  PS-COMMAREA-NOT-VALID                           03760099
037700                  SET DP020-NEXT-ACT-APPL-ERROR                   03770099
037800                                    TO TRUE                       03780099
037900              ELSE                                                03790099
038000                  PERFORM 4000-BUILD-INITIAL-PANEL                03800099
038100                  PERFORM 3200-RESET-ATTRIBUTES                   03810099
038200              END-IF                                              03820099
038300                                                                  03830099
038400         WHEN DP020-NEXT-ACT-READ-MAP                             03840099
038500             PERFORM 2000-PROCESS-PANEL                           03850099
038600                                                                  03860099
038700*F3-END                                                           03870099
038800         WHEN DP020-NEXT-ACT-RETURN                               03880099
038900             PERFORM 4000-BUILD-INITIAL-PANEL                     03890099
039000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03900099
039100             MOVE -1                   TO ATYPCDEL                03910099
039200                                                                  03920099
039300         WHEN OTHER                                               03930099
039400             SET DP013-LOGIC-ABEND TO TRUE                        03940099
039500             SET DP013-NO-ROLLBACK TO TRUE                        03950099
039600             MOVE '1000-CONTROL-PROCESSING'                       03960099
039700                                   TO DP013-PARAGRAPH             03970099
039800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    03980099
039900                                   TO DP013-MESSAGE-TEXT(1)       03990099
040000             MOVE DP020-NEXT-APPL-ACTIVITY                        04000099
040100                                   TO DP013-MESSAGE-TEXT(2)       04010099
040200             PERFORM DP013-0000-PROCESS-ABEND                     04020099
040300     END-EVALUATE.                                                04030099
040400*                                                                 04040099
040500*                                                                 04050099
040600******************************************************************04060099
040700** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04070099
040800** INTER-APPLICATION FORMAT CODE.                               **04080099
040900******************************************************************04090099
041000 1100-PROCESS-INTER-APPL-COMM.                                    04100099
041100     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04110099
041200     MOVE DP020-INT-APPL-FORMAT-IND                               04120099
041300                                   TO ASC-INT-APPL-FORMAT-IND.    04130099
041400                                                                  04140099
041500     SET PS-COMMAREA-VALID         TO TRUE.                       04150099
041600                                                                  04160099
041700*WHEN COMING FROM CRIT SPEC (CNKCS214)                            04170099
041800     EVALUATE ASC-INT-APPL-FORMAT-IND                             04180099
041900         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         04190099
042000             MOVE CN161-PRINTER-SELECT-TYPE                       04200099
042100                                  TO ASC-PRTR-SELECT-TYPE         04210099
042200                                                                  04220099
042300*WHEN COMING FROM PRINTER TYPE ADD LIST SCREEN (CNKCS217)         04230099
042400         WHEN PC-INTER-APPL-LIST-ADD                              04240099
042500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04250099
042600             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  04260099
042700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04270099
042800             MOVE CN162-NUMBER-OF-TS-ITEMS                        04280099
042900                                   TO ASC-NUMBER-OF-TS-ITEMS      04290099
043000             MOVE CN162-SEL-QUEUE-NAME                            04300099
043100                                   TO ASC-SEL-QUEUE-NAME          04310099
043200             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04320099
043300                                                                  04330099
043400                                                                  04340099
043500*WHEN COMING FROM PRINTER TYPE UPDATE LIST SCREEN (CNKCS217)      04350099
043600         WHEN PC-INTER-APPL-LIST-UPDATE                           04360099
043700           IF CN162-NUMBER-OF-SELECTED-ITEMS > 0                  04370099
043800             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04380099
043900             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  04390099
044000                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04400099
044100             MOVE CN162-NUMBER-OF-TS-ITEMS                        04410099
044200                                   TO ASC-NUMBER-OF-TS-ITEMS      04420099
044300             MOVE CN162-SEL-QUEUE-NAME                            04430099
044400                                   TO ASC-SEL-QUEUE-NAME          04440099
044500             MOVE 'UPD' TO  ASC-ACTION-SW                         04450099
044600             PERFORM 1120-PREPARE-LIST-ENTRY                      04460099
044700             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04470099
044800             PERFORM 3010-FIND-PRTR-TYP-ON-TBL                    04480099
044900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04490099
045000           ELSE                                                   04500099
045100              MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER      04510099
045200              SET  PS-COMMAREA-NOT-VALID TO TRUE                  04520099
045300           END-IF                                                 04530099
045400                                                                  04540099
045500                                                                  04550099
045600*WHEN COMING FROM PRINTER TYPE DELETE LIST SCREEN (CNKCS217)      04560099
045700         WHEN PC-INTER-APPL-LIST-DELETE                           04570099
045800           IF CN162-NUMBER-OF-SELECTED-ITEMS > 0                  04580099
045900              SET ASC-USE-SELECTION-QUEUE TO TRUE                 04590099
046000              MOVE CN162-NUMBER-OF-TS-ITEMS                       04600099
046100                                   TO ASC-NUMBER-OF-TS-ITEMS      04610099
046200              MOVE CN162-SEL-QUEUE-NAME                           04620099
046300                                   TO ASC-SEL-QUEUE-NAME          04630099
046400              MOVE 'DEL' TO  ASC-ACTION-SW                        04640099
046500              PERFORM 1120-PREPARE-LIST-ENTRY                     04650099
046600              PERFORM 4500-MOVE-COMMAREA-TO-TEMP                  04660099
046700              PERFORM 3010-FIND-PRTR-TYP-ON-TBL                   04670099
046800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  04680099
046900           ELSE                                                   04690099
047000              MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER      04700099
047100              SET  PS-COMMAREA-NOT-VALID TO TRUE                  04710099
047200           END-IF                                                 04720099
047300     END-EVALUATE.                                                04730099
047400*                                                                 04740099
047500*                                                                 04750099
047600*----------------------------------------------------------------*04760099
047700* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *04770099
047800* STORAGE QUEUE PASSED FROM THE LIST.                            *04780099
047900*----------------------------------------------------------------*04790099
048000 1120-PREPARE-LIST-ENTRY.                                         04800099
048100     MOVE CN163-MAX-ITEMS          TO ASC-SEL-SUB.                04810099
048200     MOVE ZERO                     TO ASC-SEL-ITEM.               04820099
048300     PERFORM 1130-GET-NEXT-RECORD.                                04830099
048400*                                                                 04840099
048500*                                                                 04850099
048600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*04860099
048700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*04870099
048800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*04880099
048900 1130-GET-NEXT-RECORD.                                            04890099
049000     ADD +1                        TO ASC-SEL-SUB.                04900099
049100                                                                  04910099
049200     SET ASC-UPDATE-TSQ TO TRUE.                                  04920099
049300                                                                  04930099
049400     IF  ASC-SEL-SUB > CN163-MAX-ITEMS                            04940099
049500         ADD +1                    TO ASC-SEL-ITEM                04950099
049600         MOVE +1                   TO ASC-SEL-SUB                 04960099
049700     END-IF.                                                      04970099
049800                                                                  04980099
049900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                04990099
050000         PERFORM 9100-READ-SEL-QUEUE                              05000099
050100         IF  CN163-ITEM (ASC-SEL-SUB) > ZERO                      05010099
050200             MOVE CN163-PRTR-TYP-CDE   (ASC-SEL-SUB)              05020099
050300                                   TO ASC-PRTR-TYP-CDE            05030099
050400             MOVE CN163-MANF-DESC      (ASC-SEL-SUB)              05040099
050500                                   TO ASC-PRTR-MFR-DESC           05050099
050600             MOVE CN163-MODEL-DESC      (ASC-SEL-SUB)             05060099
050700                                   TO ASC-PRTR-MDL-DESC           05070099
050800             MOVE CN163-PAPER-TRK-QTY   (ASC-SEL-SUB)             05080099
050900                                   TO ASC-PAPR-TRK-QTY            05090099
051000             MOVE CN163-AUTO-CTR-IND    (ASC-SEL-SUB)             05100099
051100                                   TO ASC-AUTO-CTTR-IND           05110099
051200             MOVE CN163-BAR-CDE-IND     (ASC-SEL-SUB)             05120099
051300                                   TO ASC-PRT-BRCDE-IND           05130099
051400             MOVE CN163-PRTR-CNTL-IND   (ASC-SEL-SUB)             05140099
051500                                   TO ASC-PRTR-CNTL-IND           05150099
051600                                                                  05160099
051700             SET CN163-INQ (ASC-SEL-SUB) TO TRUE                  05170099
051800             PERFORM 9200-REWRITE-SEL-QUEUE                       05180099
051900         ELSE                                                     05190099
052000             SUBTRACT +1 FROM ASC-SEL-SUB                         05200099
052100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            05210099
052200             SET DP020-MSG-INFORMATIONAL                          05220099
052300                 PS-LIST-END       TO TRUE                        05230099
052400         END-IF                                                   05240099
052500     ELSE                                                         05250099
052600         SUBTRACT +1 FROM ASC-SEL-ITEM                            05260099
052700         MOVE CN163-MAX-ITEMS      TO ASC-SEL-SUB                 05270099
052800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            05280099
052900         SET DP020-MSG-INFORMATIONAL                              05290099
053000             PS-LIST-END           TO TRUE                        05300099
053100     END-IF.                                                      05310099
053200*                                                                 05320099
053300*                                                                 05330099
053400******************************************************************05340099
053500*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING       **05350099
053600*  PROCESSED.                                                   **05360099
053700******************************************************************05370099
053800 1140-GET-PREV-RECORD.                                            05380099
053900     SUBTRACT +1 FROM ASC-SEL-SUB.                                05390099
054000                                                                  05400099
054100     IF  ASC-SEL-SUB < +1                                         05410099
054200         SUBTRACT +1 FROM ASC-SEL-ITEM                            05420099
054300         MOVE CN163-MAX-ITEMS      TO ASC-SEL-SUB                 05430099
054400     END-IF.                                                      05440099
054500                                                                  05450099
054600     IF  ASC-SEL-ITEM > ZERO                                      05460099
054700         PERFORM 9100-READ-SEL-QUEUE                              05470099
054800         IF  CN163-ITEM (ASC-SEL-SUB) > ZERO                      05480099
054900             MOVE CN163-PRTR-TYP-CDE   (ASC-SEL-SUB)              05490099
055000                                   TO ASC-PRTR-TYP-CDE            05500099
055100             MOVE CN163-MANF-DESC      (ASC-SEL-SUB)              05510099
055200                                   TO ASC-PRTR-MFR-DESC           05520099
055300             MOVE CN163-MODEL-DESC      (ASC-SEL-SUB)             05530099
055400                                   TO ASC-PRTR-MDL-DESC           05540099
055500             MOVE CN163-PAPER-TRK-QTY   (ASC-SEL-SUB)             05550099
055600                                   TO ASC-PAPR-TRK-QTY            05560099
055700             MOVE CN163-AUTO-CTR-IND    (ASC-SEL-SUB)             05570099
055800                                   TO ASC-AUTO-CTTR-IND           05580099
055900             MOVE CN163-BAR-CDE-IND     (ASC-SEL-SUB)             05590099
056000                                   TO ASC-PRT-BRCDE-IND           05600099
056100             MOVE CN163-PRTR-CNTL-IND   (ASC-SEL-SUB)             05610099
056200                                   TO ASC-PRTR-CNTL-IND           05620099
056300         END-IF                                                   05630099
056400                                                                  05640099
056500         SET CN163-INQ (ASC-SEL-SUB) TO TRUE                      05650099
056600         PERFORM 9200-REWRITE-SEL-QUEUE                           05660099
056700     ELSE                                                         05670099
056800         MOVE +1                  TO ASC-SEL-ITEM                 05680099
056900                                     ASC-SEL-SUB                  05690099
057000         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             05700099
057100         SET DP020-MSG-INFORMATIONAL                              05710099
057200             PS-LIST-END             TO TRUE                      05720099
057300     END-IF.                                                      05730099
057400*                                                                 05740099
057500*                                                                 05750099
057600*----------------------------------------------------------------*05760099
057700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05770099
057800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *05780099
057900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *05790099
058000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *05800099
058100* FUNCTION KEYS CAN GET THIS FAR.                                *05810099
058200*----------------------------------------------------------------*05820099
058300 2000-PROCESS-PANEL.                                              05830099
058400                                                                  05840099
058500     EVALUATE TRUE                                                05850099
058600                                                                  05860099
058700         WHEN DP020-SRC-AID = DP016-CLEAR                         05870099
058800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05880099
058900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05890099
059000                                                                  05900099
059100*F5-REFRESH                                                       05910099
059200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05920099
059300*LMM         INITIALIZE ASC-SPECIFIC-COMMAREA                     05930099
059400             PERFORM 4000-BUILD-INITIAL-PANEL                     05940099
059500*LMM         PERFORM 3200-RESET-ATTRIBUTES                        05950099
059600                                                                  05960099
059700*F20-NEXT SEL                                                     05970099
059800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05980099
059900             IF  ASC-USE-SELECTION-QUEUE                          05990099
060000                 PERFORM 1130-GET-NEXT-RECORD                     06000099
060100                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               06010099
060200                 PERFORM 3010-FIND-PRTR-TYP-ON-TBL                06020099
060300                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               06030099
060400                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               06040099
060500                 IF PS-LIST-END                                   06050099
060600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06060099
060700                     SET PS-NO-LIST-END TO TRUE                   06070099
060800                 ELSE                                             06080099
060900                     PERFORM 4000-BUILD-INITIAL-PANEL             06090099
061000                     PERFORM 3200-RESET-ATTRIBUTES                06100099
061100                 END-IF                                           06110099
061200              ELSE                                                06120099
061300*                --- BOTTOM OF LIST ---                           06130099
061400                 MOVE PC-TSYMSG-00070                             06140099
061500                                   TO DP020-MSG-NUMBER            06150099
061600                 SET DP020-MSG-INFORMATIONAL                      06160099
061700                                   TO TRUE                        06170099
061800             END-IF                                               06180099
061900                                                                  06190099
062000*F19-PREV SEL                                                     06200099
062100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06210099
062200             IF  ASC-USE-SELECTION-QUEUE                          06220099
062300                 PERFORM 1140-GET-PREV-RECORD                     06230099
062400                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               06240099
062500                 PERFORM 3010-FIND-PRTR-TYP-ON-TBL                06250099
062600                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               06260099
062700                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               06270099
062800                 IF PS-LIST-END                                   06280099
062900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06290099
063000                     SET PS-NO-LIST-END                           06300099
063100                                   TO TRUE                        06310099
063200                 ELSE                                             06320099
063300                     PERFORM 4000-BUILD-INITIAL-PANEL             06330099
063400                     PERFORM 3200-RESET-ATTRIBUTES                06340099
063500                 END-IF                                           06350099
063600             ELSE                                                 06360099
063700                 MOVE PC-TSYMSG-00069                             06370099
063800                                   TO DP020-MSG-NUMBER            06380099
063900                 SET DP020-MSG-INFORMATIONAL                      06390099
064000                                   TO TRUE                        06400099
064100             END-IF                                               06410099
064200                                                                  06420099
064300                                                                  06430099
064400         WHEN OTHER                                               06440099
064500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06450099
064600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06460099
064700             IF  PS-NO-ERROR                                      06470099
064800                 SET DP030-CONTINUE-GO                            06480099
064900                                   TO TRUE                        06490099
065000                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               06500099
065100                 PERFORM 2100-CHECK-FUNCTION-KEY                  06510099
065200                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               06520099
065300                 IF DP020-SRC-AID = DP016-ENTER                   06530099
065400                    CONTINUE                                      06540099
065500                 ELSE                                             06550099
065600                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          06560099
065700                 END-IF                                           06570099
065800             ELSE                                                 06580099
065900                 SET DP030-OVERRIDE-GO                            06590099
066000                                   TO TRUE                        06600099
066100             END-IF                                               06610099
066200     END-EVALUATE.                                                06620099
066300*                                                                 06630099
066400*                                                                 06640099
066500*----------------------------------------------------------------*06650099
066600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *06660099
066700* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *06670099
066800* FROM THE CICS ARCHITECTURE API.                                *06680099
066900*----------------------------------------------------------------*06690099
067000 2100-CHECK-FUNCTION-KEY.                                         06700099
067100     EVALUATE TRUE                                                06710099
067200         WHEN DP020-SRC-AID = DP016-ENTER                         06720099
067300             PERFORM 3010-FIND-PRTR-TYP-ON-TBL                    06730099
067400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06740099
067500                                                                  06750099
067600                                                                  06760099
067700*--------F13=ADD PRINTER TYPE                                     06770099
067800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06780099
067900             SET DP020-MSG-INFORMATIONAL TO TRUE                  06790099
068000             PERFORM 3010-FIND-PRTR-TYP-ON-TBL                    06800099
068100                                                                  06810099
068200             IF ASC-PRTR-TYP-NOT-EXISTS                           06820099
068300                PERFORM 5000-PROCESS-ADD                          06830099
068400             END-IF                                               06840099
068500                                                                  06850099
068600*--------F15=UPDATE PRINTER TYPE                                  06860099
068700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06870099
068800             SET DP020-MSG-INFORMATIONAL TO TRUE                  06880099
068900             PERFORM 3010-FIND-PRTR-TYP-ON-TBL                    06890099
069000             PERFORM 4600-MOVE-TEMP-TO-COMMAREA                   06900099
069100                                                                  06910099
069200             IF ASC-ACTION-SW = 'UPD'                             06920099
069300                 PERFORM 9100-READ-SEL-QUEUE                      06930099
069400                 SET CN163-UPD (ASC-SEL-SUB) TO TRUE              06940099
069500                 MOVE ASC-PRTR-MFR-DESC                           06950099
069600                        TO CN163-MANF-DESC (ASC-SEL-SUB)          06960099
069700                 MOVE ASC-PRTR-MDL-DESC                           06970099
069800                        TO CN163-MODEL-DESC (ASC-SEL-SUB)         06980099
069900                 MOVE ASC-PAPR-TRK-QTY-N                          06990099
070000                        TO CN163-PAPER-TRK-QTY (ASC-SEL-SUB)      07000099
070100                 MOVE ASC-AUTO-CTTR-IND                           07010099
070200                        TO CN163-AUTO-CTR-IND (ASC-SEL-SUB)       07020099
070300                 MOVE ASC-PRT-BRCDE-IND                           07030099
070400                        TO CN163-BAR-CDE-IND (ASC-SEL-SUB)        07040099
070500                 MOVE ASC-PRTR-CNTL-IND                           07050099
070600                        TO CN163-PRTR-CNTL-IND (ASC-SEL-SUB)      07060099
070700                 PERFORM 9200-REWRITE-SEL-QUEUE                   07070099
070800             END-IF                                               07080099
070900                                                                  07090099
071000             IF ASC-PRTR-TYP-EXISTS                               07100099
071100                PERFORM 5100-PROCESS-UPDATE                       07110099
071200             END-IF                                               07120099
071300                                                                  07130099
071400*--------F16=DELETE PRINTER TYPE                                  07140099
071500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              07150099
071600             SET DP020-MSG-INFORMATIONAL TO TRUE                  07160099
071700             PERFORM 3010-FIND-PRTR-TYP-ON-TBL                    07170099
071800                                                                  07180099
071900             IF ASC-ACTION-SW = 'DEL'                             07190099
072000                 PERFORM 9100-READ-SEL-QUEUE                      07200099
072100                 SET CN163-DEL (ASC-SEL-SUB) TO TRUE              07210099
072200                 PERFORM 9200-REWRITE-SEL-QUEUE                   07220099
072300             END-IF                                               07230099
072400                                                                  07240099
072500             IF ASC-PRTR-TYP-EXISTS                               07250099
072600                SET PS-ERROR                TO TRUE               07260099
072700                SET DP020-MSG-FATAL         TO TRUE               07270099
072800                MOVE PC-TSYMSG-00354        TO DP020-MSG-NUMBER   07280099
072900                MOVE -1                     TO ATYPCDEL           07290099
073000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07300099
073100             END-IF                                               07310099
073200                                                                  07320099
073300*--------F2=CONFIRM                                               07330099
073400         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07340099
073500             PERFORM 5200-PROCESS-DELETE                          07350099
073600                                                                  07360099
073700         WHEN OTHER                                               07370099
073800             SET DP013-NO-ROLLBACK                                07380099
073900                 DP013-XCTL-DISPLAY-RESTART                       07390099
074000                 DP013-CICS-ABEND TO TRUE                         07400099
074100             MOVE '2000-PROCESS-PANEL'                            07410099
074200                                   TO DP013-PARAGRAPH             07420099
074300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07430099
074400                                   TO DP013-MESSAGE-TEXT (1)      07440099
074500             PERFORM DP013-0000-PROCESS-ABEND                     07450099
074600     END-EVALUATE.                                                07460099
074700*                                                                 07470099
074800*                                                                 07480099
074900*----------------------------------------------------------------*07490099
075000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *07500099
075100* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *07510099
075200* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *07520099
075300* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *07530099
075400*----------------------------------------------------------------*07540099
075500                                                                  07550099
075600 2200-MOVE-SCREEN-TO-COMMAREA.                                    07560099
075700*PRINTER TYPE CODE                                                07570099
075800     IF  ATYPCDEL > ZERO                                          07580099
075900         MOVE ATYPCDEI             TO ASC-PRTR-TYP-CDE            07590099
076000     ELSE                                                         07600099
076100         IF  ATYPCDEF = DP015-ERASE-EOF                           07610099
076200             MOVE ZERO             TO ASC-PRTR-TYP-CDE            07620099
076300         END-IF                                                   07630099
076400     END-IF.                                                      07640099
076500                                                                  07650099
076600*MANUFACTURER DESCRIPTION                                         07660099
076700     IF  AMNFDSL > ZERO                                           07670099
076800         MOVE AMNFDSI              TO ASC-PRTR-MFR-DESC           07680099
076900     ELSE                                                         07690099
077000         IF  AMNFDSF = DP015-ERASE-EOF                            07700099
077100             MOVE SPACE            TO ASC-PRTR-MFR-DESC           07710099
077200         END-IF                                                   07720099
077300     END-IF.                                                      07730099
077400                                                                  07740099
077500*MODEL DESCRIPTION                                                07750099
077600     IF  AMDLDSL > ZERO                                           07760099
077700         MOVE AMDLDSI              TO ASC-PRTR-MDL-DESC           07770099
077800     ELSE                                                         07780099
077900         IF  AMDLDSF = DP015-ERASE-EOF                            07790099
078000             MOVE SPACE            TO ASC-PRTR-MDL-DESC           07800099
078100         END-IF                                                   07810099
078200     END-IF                                                       07820099
078300                                                                  07830099
078400*PRINTER TRACK QUANTITY                                           07840099
078500     IF  ANBRTRKL > ZERO                                          07850099
078600         MOVE ANBRTRKI             TO ASC-PAPR-TRK-QTY            07860099
078700                                      DK-PAPR-TRK-QTY             07870099
078800     ELSE                                                         07880099
078900         IF  ANBRTRKF = DP015-ERASE-EOF                           07890099
079000             MOVE ZERO             TO ASC-PAPR-TRK-QTY            07900099
079100                                      DK-PAPR-TRK-QTY             07910099
079200         END-IF                                                   07920099
079300     END-IF.                                                      07930099
079400                                                                  07940099
079500*AUTO CUTTER                                                      07950099
079600     IF  AACTTRL > ZERO                                           07960099
079700         MOVE AACTTRI              TO ASC-AUTO-CTTR-IND           07970099
079800     ELSE                                                         07980099
079900         IF  AACTTRF = DP015-ERASE-EOF                            07990099
080000             MOVE SPACE            TO ASC-AUTO-CTTR-IND           08000099
080100         END-IF                                                   08010099
080200     END-IF.                                                      08020099
080300                                                                  08030099
080400*BARCODE CAPABLE                                                  08040099
080500     IF  ABRCDEL > ZERO                                           08050099
080600         MOVE ABRCDEI              TO ASC-PRT-BRCDE-IND           08060099
080700     ELSE                                                         08070099
080800         IF  ABRCDEF = DP015-ERASE-EOF                            08080099
080900             MOVE SPACE            TO ASC-PRT-BRCDE-IND           08090099
081000         END-IF                                                   08100099
081100     END-IF.                                                      08110099
081200                                                                  08120099
081300*PRINTER CONTROL INDICATOR                                        08130099
081400     IF  APRCTLL > ZERO                                           08140099
081500         MOVE APRCTLI              TO ASC-PRTR-CNTL-IND           08150099
081600     ELSE                                                         08160099
081700         IF  APRCTLF = DP015-ERASE-EOF                            08170099
081800             MOVE SPACE            TO ASC-PRTR-CNTL-IND           08180099
081900         END-IF                                                   08190099
082000     END-IF.                                                      08200099
082100*                                                                 08210099
082200*                                                                 08220099
082300*----------------------------------------------------------------*08230099
082400* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *08240099
082500* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *08250099
082600* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *08260099
082700*----------------------------------------------------------------*08270099
082800 3000-EDIT-DATA-IN-COMMAREA.                                      08280099
082900     PERFORM 3200-RESET-ATTRIBUTES.                               08290099
083000*                                                                 08300099
083100*-----------------------------------------------------------------08310099
083200* PRINTER TYPE CODE                                               08320099
083300*-----------------------------------------------------------------08330099
083400     IF  ASC-PRTR-TYP-CDE = SPACES                                08340099
083500         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08350099
083600             SET PS-ERROR                TO TRUE                  08360099
083700             SET DP020-MSG-FATAL         TO TRUE                  08370099
083800             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      08380099
083900             MOVE DP015-UNP-ALP-BRT-OFF  TO ATYPCDEA              08390099
084000             MOVE DP015-RED              TO ATYPCDEC              08400099
084100             MOVE DP015-REVERSE          TO ATYPCDEH              08410099
084200             MOVE -1                     TO ATYPCDEL              08420099
084300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08430099
084400         END-IF                                                   08440099
084500     END-IF.                                                      08450099
084600                                                                  08460099
084700*-----------------------------------------------------------------08470099
084800* MANUFACTURER DESCRIPTION                                        08480099
084900*-----------------------------------------------------------------08490099
085000     IF  ASC-PRTR-MFR-DESC = SPACES                               08500099
085100         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08510099
085200             SET PS-ERROR                TO TRUE                  08520099
085300             SET DP020-MSG-FATAL         TO TRUE                  08530099
085400             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      08540099
085500             MOVE DP015-UNP-ALP-BRT-OFF  TO AMNFDSA               08550099
085600             MOVE DP015-RED              TO AMNFDSC               08560099
085700             MOVE DP015-REVERSE          TO AMNFDSH               08570099
085800             MOVE -1                     TO AMNFDSL               08580099
085900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08590099
086000         END-IF                                                   08600099
086100     END-IF.                                                      08610099
086200                                                                  08620099
086300*-----------------------------------------------------------------08630099
086400* MODEL DESCRIPTION                                               08640099
086500*-----------------------------------------------------------------08650099
086600     IF  ASC-PRTR-MDL-DESC = SPACES                               08660099
086700         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08670099
086800             SET PS-ERROR                TO TRUE                  08680099
086900             SET DP020-MSG-FATAL         TO TRUE                  08690099
087000             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      08700099
087100             MOVE DP015-UNP-ALP-BRT-OFF  TO AMDLDSA               08710099
087200             MOVE DP015-RED              TO AMDLDSC               08720099
087300             MOVE DP015-REVERSE          TO AMDLDSH               08730099
087400             MOVE -1                     TO AMDLDSL               08740099
087500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08750099
087600         END-IF                                                   08760099
087700     END-IF.                                                      08770099
087800                                                                  08780099
087900*-----------------------------------------------------------------08790099
088000* PRINTER TRACK QUANTITY - '1', '2' OR '3' ONLY                   08800099
088100*-----------------------------------------------------------------08810099
088200     IF  ASC-PAPR-TRK-QTY  = SPACES                               08820099
088300         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08830099
088400             SET PS-ERROR                TO TRUE                  08840099
088500             SET DP020-MSG-FATAL         TO TRUE                  08850099
088600             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      08860099
088700             MOVE DP015-UNP-ALP-BRT-OFF  TO ANBRTRKA              08870099
088800             MOVE DP015-RED              TO ANBRTRKC              08880099
088900             MOVE DP015-REVERSE          TO ANBRTRKH              08890099
089000             MOVE -1                     TO ANBRTRKL              08900099
089100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08910099
089200         END-IF                                                   08920099
089300     END-IF.                                                      08930099
089400                                                                  08940099
089500     IF  ASC-PAPR-TRK-QTY   >  SPACES AND                         08950099
089600         (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR              08960099
089700          DP020-SRC-AID = DP016-ENTER)                            08970099
089800         MOVE ASC-PAPR-TRK-QTY         TO DP010I-UNEDITED-FIELD   08980099
089900         MOVE LENGTH OF ASC-PAPR-TRK-QTY                          08990099
090000                                       TO DP010I-MAXIMUM-DIGITS   09000099
090100         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09010099
090200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09020099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09031099
263455              USING DP010I-NUMERIC-EDIT-AREA                      09032099
090400         IF  DP010I-ERROR-DETECTED                                09040099
090500             SET PS-ERROR                TO TRUE                  09050099
090600             SET DP020-MSG-FATAL         TO TRUE                  09060099
090700             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      09070099
090800             MOVE DP015-UNP-ALP-BRT-OFF  TO ANBRTRKA              09080099
090900             MOVE DP015-RED              TO ANBRTRKC              09090099
091000             MOVE DP015-REVERSE          TO ANBRTRKH              09100099
091100             MOVE -1                     TO ANBRTRKL              09110099
091200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09120099
091300         ELSE                                                     09130099
091400             MOVE DP010I-NUMERIC-FIELD                            09140099
091500               TO ASC-PAPR-TRK-QTY-N                              09150099
091600         END-IF                                                   09160099
091700     END-IF.                                                      09170099
091800                                                                  09180099
091900     IF  ASC-PAPR-TRK-QTY  >  SPACES                              09190099
092000         EVALUATE TRUE                                            09200099
092100            WHEN ASC-PAPR-TRK-QTY = '0001'                        09210099
092200               SET ASC-PAPR-TRK-QTY-1 TO TRUE                     09220099
092300               PERFORM 9000-PROCESS-PAPR-TRK-QTY                  09230099
092400            WHEN ASC-PAPR-TRK-QTY = '0002'                        09240099
092500               SET ASC-PAPR-TRK-QTY-2 TO TRUE                     09250099
092600               PERFORM 9000-PROCESS-PAPR-TRK-QTY                  09260099
092700            WHEN ASC-PAPR-TRK-QTY = '0003'                        09270099
092800               SET ASC-PAPR-TRK-QTY-3 TO TRUE                     09280099
092900               PERFORM 9000-PROCESS-PAPR-TRK-QTY                  09290099
093000            WHEN OTHER                                            09300099
093100                 SET PS-ERROR                                     09310099
093200                 DP020-MSG-FATAL             TO TRUE              09320099
093300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09330099
093400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ANBRTRKA          09340099
093500                 MOVE DP015-RED              TO ANBRTRKC          09350099
093600                 MOVE DP015-REVERSE          TO ANBRTRKH          09360099
093700                 MOVE -1                     TO ANBRTRKL          09370099
093800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09380099
093900         END-EVALUATE                                             09390099
094000     END-IF.                                                      09400099
094100*                                                                 09410099
094200*-----------------------------------------------------------------09420099
094300* AUTO CUTTER                                                     09430099
094400*-----------------------------------------------------------------09440099
094500     IF  ASC-AUTO-CTTR-IND = SPACES                               09450099
094600         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               09460099
094700             SET PS-ERROR                TO TRUE                  09470099
094800             SET DP020-MSG-FATAL         TO TRUE                  09480099
094900             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09490099
095000             MOVE DP015-UNP-ALP-BRT-OFF  TO AACTTRA               09500099
095100             MOVE DP015-RED              TO AACTTRC               09510099
095200             MOVE DP015-REVERSE          TO AACTTRH               09520099
095300             MOVE -1                     TO AACTTRL               09530099
095400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09540099
095500         END-IF                                                   09550099
095600     END-IF.                                                      09560099
095700                                                                  09570099
095800     IF  ASC-AUTO-CTTR-IND  >  SPACES                             09580099
095900         IF  PS-NO-ERROR                                          09590099
096000             IF  ASC-SELECT-VALID-A                               09600099
096100                 CONTINUE                                         09610099
096200             ELSE                                                 09620099
096300                 SET PS-ERROR                                     09630099
096400                 DP020-MSG-FATAL             TO TRUE              09640099
096500                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09650099
096600                 MOVE DP015-UNP-ALP-BRT-OFF  TO AACTTRA           09660099
096700                 MOVE DP015-RED              TO AACTTRC           09670099
096800                 MOVE DP015-REVERSE          TO AACTTRH           09680099
096900                 MOVE -1                     TO AACTTRL           09690099
097000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09700099
097100             END-IF                                               09710099
097200         END-IF                                                   09720099
097300     END-IF.                                                      09730099
097400                                                                  09740099
097500*-----------------------------------------------------------------09750099
097600* BARCODE CAPABLE                                                 09760099
097700*-----------------------------------------------------------------09770099
097800     IF  ASC-PRT-BRCDE-IND = SPACES                               09780099
097900         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               09790099
098000             SET PS-ERROR                TO TRUE                  09800099
098100             SET DP020-MSG-FATAL         TO TRUE                  09810099
098200             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09820099
098300             MOVE DP015-UNP-ALP-BRT-OFF  TO ABRCDEA               09830099
098400             MOVE DP015-RED              TO ABRCDEC               09840099
098500             MOVE DP015-REVERSE          TO ABRCDEH               09850099
098600             MOVE -1                     TO ABRCDEL               09860099
098700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09870099
098800         END-IF                                                   09880099
098900     END-IF.                                                      09890099
099000                                                                  09900099
099100     IF  ASC-PRT-BRCDE-IND  >  SPACES                             09910099
099200         IF  PS-NO-ERROR                                          09920099
099300             IF  ASC-SELECT-VALID-B                               09930099
099400                 CONTINUE                                         09940099
099500             ELSE                                                 09950099
099600                 SET PS-ERROR                                     09960099
099700                 DP020-MSG-FATAL             TO TRUE              09970099
099800                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09980099
099900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ABRCDEA           09990099
100000                 MOVE DP015-RED              TO ABRCDEC           10000099
100100                 MOVE DP015-REVERSE          TO ABRCDEH           10010099
100200                 MOVE -1                     TO ABRCDEL           10020099
100300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10030099
100400             END-IF                                               10040099
100500         END-IF                                                   10050099
100600     END-IF.                                                      10060099
100700*                                                                 10070099
100800*-----------------------------------------------------------------10080099
100900* PRINTER CONTROL INDICATOR                                       10090099
101000*-----------------------------------------------------------------10100099
101100     IF  ASC-PRTR-CNTL-IND = SPACES                               10110099
101200         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10120099
101300             SET PS-ERROR                TO TRUE                  10130099
101400             SET DP020-MSG-FATAL         TO TRUE                  10140099
101500             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      10150099
101600             MOVE DP015-UNP-ALP-BRT-OFF  TO APRCTLA               10160099
101700             MOVE DP015-RED              TO APRCTLC               10170099
101800             MOVE DP015-REVERSE          TO APRCTLH               10180099
101900             MOVE -1                     TO APRCTLL               10190099
102000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10200099
102100         END-IF                                                   10210099
102200     END-IF.                                                      10220099
102300                                                                  10230099
102400     IF  ASC-PRTR-CNTL-IND  >  SPACES                             10240099
102500         IF  PS-NO-ERROR                                          10250099
102600             IF  ASC-SELECT-VALID-C                               10260099
102700                 CONTINUE                                         10270099
102800             ELSE                                                 10280099
102900                 SET PS-ERROR                                     10290099
103000                 DP020-MSG-FATAL             TO TRUE              10300099
103100                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  10310099
103200                 MOVE DP015-UNP-ALP-BRT-OFF  TO APRCTLA           10320099
103300                 MOVE DP015-RED              TO APRCTLC           10330099
103400                 MOVE DP015-REVERSE          TO APRCTLH           10340099
103500                 MOVE -1                     TO APRCTLL           10350099
103600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10360099
103700             END-IF                                               10370099
103800         END-IF                                                   10380099
103900     END-IF.                                                      10390099
104000*                                                                 10400099
104100*                                                                 10410099
104200*----------------------------------------------------------------*10420099
104300* CHECK TO SEE IF PRINTER TYPE CODE ENTERED EXISTS ON TABLE      *10430099
104400*----------------------------------------------------------------*10440099
104500 3010-FIND-PRTR-TYP-ON-TBL.                                       10450099
104600     PERFORM                                                      10460099
104700         WITH TEST AFTER                                          10470099
104800         VARYING PV-RETRY-COUNTER                                 10480099
104900         FROM 1 BY 1                                              10490099
105000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10500099
105100         OR     (SQLCODE = ZERO)                                  10510099
105200         OR     (SQLCODE = +100))                                 10520099
105300                                                                  10530099
105400         EXEC SQL                                                 10540099
105500             SELECT  PRTR_TYP_CDE                                 10550099
105600                    ,PRTR_MFR_DESC                                10560099
105700                    ,PRTR_MDL_DESC                                10570099
105800                    ,PAPR_TRK_QTY                                 10580099
105900                    ,AUTO_CTTR_IND                                10590099
106000                    ,PRT_BRCDE_IND                                10600099
106100                    ,PRTR_CNTL_IND                                10610099
106200               INTO  :PV-TBL-PRTR-TYP-CDE                         10620099
106300                    ,:PV-TBL-PRTR-MFR-DESC                        10630099
106400                    ,:PV-TBL-PRTR-MDL-DESC                        10640099
106500                    ,:PV-TBL-PAPR-TRK-QTY                         10650099
106600                    ,:PV-TBL-AUTO-CTTR-IND                        10660099
106700                    ,:PV-TBL-PRT-BRCDE-IND                        10670099
106800                    ,:PV-TBL-PRTR-CNTL-IND                        10680099
106900               FROM TPRTRTY                                       10690099
107000             WHERE  PRTR_TYP_CDE     = :ASC-PRTR-TYP-CDE          10700099
107100         END-EXEC                                                 10710099
107200         EVALUATE TRUE                                            10720099
107300             WHEN SQLCODE = +0                                    10730099
107400                 SET ASC-PRTR-TYP-EXISTS TO TRUE                  10740099
107500                 MOVE PV-TBL-PRTR-TYP-CDE TO ASC-PRTR-TYP-CDE     10750099
107600                                                                  10760099
107700                 IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)       10770099
107800                     SET PS-ERROR                                 10780099
107900                         DP020-MSG-FATAL           TO TRUE        10790099
108000                     MOVE PC-TSYMSG-02552                         10800099
108100                                          TO DP020-MSG-NUMBER     10810099
108200                     MOVE DP015-UNP-ALP-BRT-OFF    TO ATYPCDEA    10820099
108300                     MOVE DP015-RED                TO ATYPCDEC    10830099
108400                     MOVE DP015-REVERSE            TO ATYPCDEH    10840099
108500                     MOVE -1                       TO ATYPCDEL    10850099
108600                     SET DP030-SET-CURSOR-APPL-1   TO TRUE        10860099
108700                 ELSE                                             10870099
108800                     IF  ASC-PRTR-TYP-CDE  =  SPACES              10880099
108900                         MOVE PV-TBL-PRTR-TYP-CDE                 10890099
109000                           TO ASC-PRTR-TYP-CDE                    10900099
109100                     END-IF                                       10910099
109200                     IF DP020-SRC-AID = DP016-ENTER               10920099
109300                        CONTINUE                                  10930099
109400                     ELSE                                         10940099
109500                        MOVE PV-TBL-PRTR-MFR-DESC                 10950099
109600                             TO ASC-PRTR-MFR-DESC                 10960099
109700                        MOVE PV-TBL-PRTR-MDL-DESC                 10970099
109800                             TO ASC-PRTR-MDL-DESC                 10980099
109900                        MOVE PV-TBL-PAPR-TRK-QTY                  10990099
110000                             TO ASC-PAPR-TRK-QTY                  11000099
110100                        MOVE PV-TBL-AUTO-CTTR-IND                 11010099
110200                             TO ASC-AUTO-CTTR-IND                 11020099
110300                        MOVE PV-TBL-PRT-BRCDE-IND                 11030099
110400                             TO ASC-PRT-BRCDE-IND                 11040099
110500                        MOVE PV-TBL-PRTR-CNTL-IND                 11050099
110600                             TO ASC-PRTR-CNTL-IND                 11060099
110700                     END-IF                                       11070099
110800                 END-IF                                           11080099
110900             WHEN SQLCODE = +100                                  11090099
111000             WHEN SQLCODE = -904                                  11100099
111100             WHEN SQLCODE = -913                                  11110099
111200                 SET ASC-PRTR-TYP-NOT-EXISTS TO TRUE              11120099
111300             WHEN SQLWARN0 NOT = SPACES                           11130099
111400             WHEN SQLCODE < +0                                    11140099
111500             WHEN SQLCODE > +0                                    11150099
111600                     MOVE '3010-FIND-PRTR-TYP-ON-TBL'             11160099
111700                                       TO DP013-PARAGRAPH         11170099
111800                     MOVE 'ERROR FINDING PRINTER TYPE'            11180099
111900                                       TO DP013-MESSAGE-TEXT (1)  11190099
112000                     MOVE SQLCA        TO DP013-SQLCA             11200099
112100                     MOVE 'TPRTRTY'    TO DP013-DB2-TABLE-NAME (1)11210099
112200                     SET DP013-DB2-ABEND                          11220099
112300                         DP013-XCTL-DISPLAY-RESTART TO TRUE       11230099
112400                     PERFORM DP013-0000-PROCESS-ABEND             11240099
112500         END-EVALUATE                                             11250099
112600     END-PERFORM                                                  11260099
112700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         11270099
112800         MOVE '3010-FIND-PRTR-TYP-ON-TBL'                         11280099
112900                             TO DP013-PARAGRAPH                   11290099
113000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11300099
113100                             TO DP013-MESSAGE-TEXT (1)            11310099
113200         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   11320099
113300                             TO DP013-MESSAGE-TEXT (2)            11330099
113400         MOVE SQLCA          TO DP013-SQLCA                       11340099
113500         MOVE 'TPRTRTY'      TO DP013-DB2-TABLE-NAME (1)          11350099
113600         SET DP013-DB2-ABEND                                      11360099
113700             DP013-XCTL-DISPLAY-RESTART                           11370099
113800                             TO TRUE                              11380099
113900         PERFORM DP013-0000-PROCESS-ABEND                         11390099
114000     END-IF.                                                      11400099
114100     MOVE +0 TO PV-RETRY-COUNTER.                                 11410099
114200*                                                                 11420099
114300*                                                                 11430099
114400*----------------------------------------------------------------*11440099
114500* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *11450099
114600* MAP.                                                           *11460099
114700*----------------------------------------------------------------*11470099
114800 3200-RESET-ATTRIBUTES.                                           11480099
114900     MOVE DP015-UNP-ALP-NOR-OFF    TO AMNFDSA                     11490099
115000                                      AMDLDSA                     11500099
115100                                      ANBRTRKA                    11510099
115200                                      AACTTRA                     11520099
115300                                      ABRCDEA                     11530099
115400                                      APRCTLA.                    11540099
115500     MOVE DP015-UNP-ALP-NOR-MDT    TO AMNFDSA                     11550099
115600                                      AMDLDSA                     11560099
115700                                      ANBRTRKA                    11570099
115800                                      AACTTRA                     11580099
115900                                      ABRCDEA                     11590099
116000                                      APRCTLA.                    11600099
116100     MOVE DP015-GREEN              TO AMNFDSC                     11610099
116200                                      AMDLDSC                     11620099
116300                                      ANBRTRKC                    11630099
116400                                      AACTTRC                     11640099
116500                                      ABRCDEC                     11650099
116600                                      APRCTLC.                    11660099
116700     MOVE DP015-UNDERLINE          TO AMNFDSH                     11670099
116800                                      AMDLDSH                     11680099
116900                                      ANBRTRKH                    11690099
117000                                      AACTTRH                     11700099
117100                                      ABRCDEH                     11710099
117200                                      APRCTLH.                    11720099
117300     EVALUATE ASC-INT-APPL-FORMAT-IND                             11730099
117400         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         11740099
117500         WHEN PC-INTER-APPL-LIST-ADD                              11750099
117600            MOVE DP015-UNP-ALP-NOR-OFF    TO ATYPCDEA             11760099
117700            MOVE DP015-GREEN              TO ATYPCDEC             11770099
117800            MOVE DP015-UNDERLINE          TO ATYPCDEH             11780099
117900     END-EVALUATE.                                                11790099
118000*                                                                 11800099
118100*                                                                 11810099
118200*----------------------------------------------------------------*11820099
118300*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *11830099
118400*    ENTRY.                                                      *11840099
118500*----------------------------------------------------------------*11850099
118600                                                                  11860099
118700 4000-BUILD-INITIAL-PANEL.                                        11870099
118800     EVALUATE ASC-INT-APPL-FORMAT-IND                             11880099
118900         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         11890099
119000             SET DP030-SET-CURSOR-APPL-1     TO TRUE              11900099
119100             MOVE -1                         TO ATYPCDEL          11910099
119200         WHEN PC-INTER-APPL-LIST-ADD                              11920099
119300             SET DP030-SET-CURSOR-APPL-1     TO TRUE              11930099
119400             MOVE -1                         TO ATYPCDEL          11940099
119500         WHEN PC-INTER-APPL-LIST-UPDATE                           11950099
119600             SET DP030-SET-CURSOR-APPL-1     TO TRUE              11960099
119700             MOVE -1                         TO AMNFDSL           11970099
119800         WHEN PC-INTER-APPL-LIST-DELETE                           11980099
119900             SET DP030-SET-CURSOR-APPL-1     TO TRUE              11990099
120000             MOVE -1                         TO ATYPCDEL          12000099
120100     END-EVALUATE                                                 12010099
120200                                                                  12020099
120300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12030099
120400*                                                                 12040099
120500*                                                                 12050099
120600*----------------------------------------------------------------*12060099
120700*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12070099
120800*----------------------------------------------------------------*12080099
120900                                                                  12090099
121000 4400-MOVE-COMMAREA-TO-SCREEN.                                    12100099
121100     MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO.                   12110099
121200     MOVE ASC-PRTR-MFR-DESC        TO AMNFDSO.                    12120099
121300     MOVE ASC-PRTR-MDL-DESC        TO AMDLDSO.                    12130099
121400     MOVE ASC-PAPR-TRK-QTY         TO ANBRTRKO.                   12140099
121500     MOVE ASC-AUTO-CTTR-IND        TO AACTTRO.                    12150099
121600     MOVE ASC-PRT-BRCDE-IND        TO ABRCDEO.                    12160099
121700     MOVE ASC-PRTR-CNTL-IND        TO APRCTLO.                    12170099
121800*                                                                 12180099
121900*LMM                                                              12190099
122000     EVALUATE TRUE                                                12200099
122100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     12210099
122200              EVALUATE ASC-INT-APPL-FORMAT-IND                    12220099
122300                  WHEN PC-INTER-APPL-CRIT-SPEC-ADD                12230099
122400                  WHEN PC-INTER-APPL-LIST-ADD                     12240099
122500                     INITIALIZE ASC-PRTR-TYP-CDE                  12250099
122600                     MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO    12260099
122700                                                                  12270099
122800                     INITIALIZE ASC-PRTR-MFR-DESC                 12280099
122900                     MOVE ASC-PRTR-MFR-DESC        TO AMNFDSO     12290099
123000                                                                  12300099
123100                     INITIALIZE ASC-PRTR-MDL-DESC                 12310099
123200                     MOVE ASC-PRTR-MDL-DESC        TO AMDLDSO     12320099
123300                                                                  12330099
123400                     INITIALIZE ASC-PAPR-TRK-QTY                  12340099
123500                     MOVE ASC-PAPR-TRK-QTY         TO ANBRTRKO    12350099
123600                                                                  12360099
123700                     INITIALIZE ASC-AUTO-CTTR-IND                 12370099
123800                     MOVE ASC-AUTO-CTTR-IND        TO AACTTRO     12380099
123900                                                                  12390099
124000                     INITIALIZE ASC-PRT-BRCDE-IND                 12400099
124100                     MOVE ASC-PRT-BRCDE-IND        TO ABRCDEO     12410099
124200                                                                  12420099
124300                     INITIALIZE ASC-PRTR-CNTL-IND                 12430099
124400                     MOVE ASC-PRTR-CNTL-IND        TO APRCTLO     12440099
124500                                                                  12450099
124600*LMM                 SET DP030-SET-CURSOR-APPL-1     TO TRUE      12460099
124700*                    MOVE -1                         TO AMNFDSL   12470099
124800*                    MOVE DP015-UNP-ALP-NOR-OFF      TO AMNFDSA   12480099
124900*                    MOVE DP015-GREEN                TO AMNFDSC   12490099
125000*                    MOVE DP015-UNDERLINE            TO AMNFDSH   12500099
125100              END-EVALUATE                                        12510099
125200     END-EVALUATE                                                 12520099
125300                                                                  12530099
125400     EVALUATE ASC-INT-APPL-FORMAT-IND                             12540099
125500         WHEN PC-INTER-APPL-LIST-UPDATE                           12550099
125600            MOVE DP015-ASK-NOR-OFF          TO ATYPCDEA           12560099
125700            MOVE DP015-BLUE                 TO ATYPCDEC           12570099
125800            MOVE -1                         TO AMNFDSL            12580099
125900     END-EVALUATE.                                                12590099
126000*                                                                 12600099
126100*                                                                 12610099
126200 4500-MOVE-COMMAREA-TO-TEMP.                                      12620099
126300     MOVE ASC-PRTR-TYP-CDE        TO PV-INP-PRTR-TYP-CDE.         12630099
126400     MOVE ASC-PRTR-MFR-DESC       TO PV-INP-PRTR-MFR-DESC.        12640099
126500     MOVE ASC-PRTR-MDL-DESC       TO PV-INP-PRTR-MDL-DESC.        12650099
126600     MOVE ASC-PAPR-TRK-QTY        TO PV-INP-PAPR-TRK-QTY.         12660099
126700     MOVE ASC-AUTO-CTTR-IND       TO PV-INP-AUTO-CTTR-IND.        12670099
126800     MOVE ASC-PRT-BRCDE-IND       TO PV-INP-PRT-BRCDE-IND.        12680099
126900     MOVE ASC-PRTR-CNTL-IND       TO PV-INP-PRTR-CNTL-IND.        12690099
127000*                                                                 12700099
127100*                                                                 12710099
127200 4600-MOVE-TEMP-TO-COMMAREA.                                      12720099
127300     MOVE PV-INP-PRTR-TYP-CDE     TO ASC-PRTR-TYP-CDE.            12730099
127400     MOVE PV-INP-PRTR-MFR-DESC    TO ASC-PRTR-MFR-DESC.           12740099
127500     MOVE PV-INP-PRTR-MDL-DESC    TO ASC-PRTR-MDL-DESC.           12750099
127600     MOVE PV-INP-PAPR-TRK-QTY     TO ASC-PAPR-TRK-QTY.            12760099
127700     MOVE PV-INP-AUTO-CTTR-IND    TO ASC-AUTO-CTTR-IND.           12770099
127800     MOVE PV-INP-PRT-BRCDE-IND    TO ASC-PRT-BRCDE-IND.           12780099
127900     MOVE PV-INP-PRTR-CNTL-IND    TO ASC-PRTR-CNTL-IND.           12790099
128000*                                                                 12800099
128100*                                                                 12810099
128200*----------------------------------------------------------------*12820099
128300* PROCESS TABLE INSERTS                                           12830099
128400*----------------------------------------------------------------*12840099
128500 5000-PROCESS-ADD.                                                12850099
128600         PERFORM 6100-INSERT-TPRTRTY                              12860099
128700                                                                  12870099
128800         IF ASC-TPRTRTY-INSERTED                                  12880099
128900            MOVE PC-TSYMSG-00034                                  12890099
129000                           TO DP020-MSG-NUMBER                    12900099
129100            SET DP020-MSG-INFORMATIONAL                           12910099
129200                           TO TRUE                                12920099
129300         END-IF.                                                  12930099
129400*                                                                 12940099
129500*                                                                 12950099
129600*----------------------------------------------------------------*12960099
129700* PROCESS TABLE UPDATES                                          *12970099
129800*----------------------------------------------------------------*12980099
129900 5100-PROCESS-UPDATE.                                             12990099
130000                                                                  13000099
130100     PERFORM 7100-UPDATE-TPRTRTY.                                 13010099
130200                                                                  13020099
130300         IF ASC-TPRTRTY-UPDATED                                   13030099
130400            MOVE PC-TSYMSG-00059                                  13040099
130500                       TO DP020-MSG-NUMBER                        13050099
130600            SET DP020-MSG-INFORMATIONAL                           13060099
130700                       TO TRUE                                    13070099
130800         END-IF.                                                  13080099
130900*                                                                 13090099
131000*                                                                 13100099
131100*----------------------------------------------------------------*13110099
131200* PROCESS TABLE DELETES                                          *13120099
131300*----------------------------------------------------------------*13130099
131400 5200-PROCESS-DELETE.                                             13140099
131500                                                                  13150099
131600         PERFORM 8100-DELETE-TPRTRTY                              13160099
131700                                                                  13170099
131800         IF ASC-TPRTRTY-DELETED                                   13180099
131900            MOVE PC-TSYMSG-00115                                  13190099
132000                       TO DP020-MSG-NUMBER                        13200099
132100            SET DP020-MSG-INFORMATIONAL                           13210099
132200                       TO TRUE                                    13220099
132300         END-IF.                                                  13230099
132400*                                                                 13240099
132500*                                                                 13250099
132600*----------------------------------------------------------------*13260099
132700* INSERT A ROW INTO THE PRINTER TYPE TABLE                       *13270099
132800*----------------------------------------------------------------*13280099
132900 6100-INSERT-TPRTRTY.                                             13290099
133000     PERFORM                                                      13300099
133100         WITH TEST AFTER                                          13310099
133200         VARYING PV-RETRY-COUNTER                                 13320099
133300         FROM 1 BY 1                                              13330099
133400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13340099
133500         OR      SQLCODE = ZERO)                                  13350099
133600                                                                  13360099
133700         EXEC SQL                                                 13370099
133800             INSERT INTO TPRTRTY                                  13380099
133900             (                                                    13390099
134000                  PRTR_TYP_CDE                                    13400099
134100                 ,PRTR_MFR_DESC                                   13410099
134200                 ,PRTR_MDL_DESC                                   13420099
134300                 ,PAPR_TRK_QTY                                    13430099
134400                 ,AUTO_CTTR_IND                                   13440099
134500                 ,PRT_BRCDE_IND                                   13450099
134600                 ,PRTR_CNTL_IND                                   13460099
134700             )                                                    13470099
134800             VALUES                                               13480099
134900             (                                                    13490099
135000                  :PV-INP-PRTR-TYP-CDE                            13500099
135100                 ,:PV-INP-PRTR-MFR-DESC                           13510099
135200                 ,:PV-INP-PRTR-MDL-DESC                           13520099
135300                 ,:PV-INP-PAPR-TRK-QTY                            13530099
135400                 ,:PV-INP-AUTO-CTTR-IND                           13540099
135500                 ,:PV-INP-PRT-BRCDE-IND                           13550099
135600                 ,:PV-INP-PRTR-CNTL-IND                           13560099
135700             )                                                    13570099
135800         END-EXEC                                                 13580099
135900         EVALUATE TRUE                                            13590099
136000             WHEN SQLCODE = +0                                    13600099
136100             WHEN SQLCODE = -904                                  13610099
136200             WHEN SQLCODE = -913                                  13620099
136300                 SET ASC-TPRTRTY-INSERTED TO TRUE                 13630099
136400             WHEN SQLWARN0 NOT = SPACES                           13640099
136500             WHEN SQLCODE < +0                                    13650099
136600             WHEN SQLCODE > +0                                    13660099
136700                 MOVE '6100-INSERT-TPRTRTY'                       13670099
136800                                   TO DP013-PARAGRAPH             13680099
136900                 MOVE 'ERROR INSERTING NEW PRINTER TYPE ROW'      13690099
137000                                   TO DP013-MESSAGE-TEXT (1)      13700099
137100                 MOVE SQLCA        TO DP013-SQLCA                 13710099
137200                 MOVE 'TPRTRTY'    TO DP013-DB2-TABLE-NAME (1)    13720099
137300                 SET DP013-DB2-ABEND                              13730099
137400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13740099
137500                 PERFORM DP013-0000-PROCESS-ABEND                 13750099
137600         END-EVALUATE                                             13760099
137700     END-PERFORM.                                                 13770099
137800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         13780099
137900         MOVE '6100-INSERT-TPRTRTY'                               13790099
138000                             TO DP013-PARAGRAPH                   13800099
138100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     13810099
138200                             TO DP013-MESSAGE-TEXT (1)            13820099
138300         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   13830099
138400                             TO DP013-MESSAGE-TEXT (2)            13840099
138500         MOVE SQLCA          TO DP013-SQLCA                       13850099
138600         MOVE 'TPRTRTY'      TO DP013-DB2-TABLE-NAME (1)          13860099
138700         SET DP013-DB2-ABEND                                      13870099
138800             DP013-XCTL-DISPLAY-RESTART                           13880099
138900                             TO TRUE                              13890099
139000         PERFORM DP013-0000-PROCESS-ABEND                         13900099
139100     END-IF.                                                      13910099
139200     MOVE +0 TO PV-RETRY-COUNTER.                                 13920099
139300*                                                                 13930099
139400*                                                                 13940099
139500******************************************************************13950099
139600** UPDATE A ROW ON THE PRINTER TYPE TABLE                       **13960099
139700******************************************************************13970099
139800 7100-UPDATE-TPRTRTY.                                             13980099
139900     PERFORM                                                      13990099
140000         WITH TEST AFTER                                          14000099
140100         VARYING PV-RETRY-COUNTER                                 14010099
140200         FROM 1 BY 1                                              14020099
140300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14030099
140400         OR     (SQLCODE = ZERO)                                  14040099
140500         OR     (SQLCODE = +100))                                 14050099
140600                                                                  14060099
140700         EXEC SQL                                                 14070099
140800             UPDATE TPRTRTY                                       14080099
140900             SET                                                  14090099
141000                  PRTR_MFR_DESC     = :PV-INP-PRTR-MFR-DESC       14100099
141100                 ,PRTR_MDL_DESC     = :PV-INP-PRTR-MDL-DESC       14110099
141200                 ,PAPR_TRK_QTY      = :PV-INP-PAPR-TRK-QTY        14120099
141300                 ,AUTO_CTTR_IND     = :PV-INP-AUTO-CTTR-IND       14130099
141400                 ,PRT_BRCDE_IND     = :PV-INP-PRT-BRCDE-IND       14140099
141500                 ,PRTR_CNTL_IND     = :PV-INP-PRTR-CNTL-IND       14150099
141600           WHERE  PRTR_TYP_CDE      = :ASC-PRTR-TYP-CDE           14160099
141700         END-EXEC                                                 14170099
141800                                                                  14180099
141900         EVALUATE TRUE                                            14190099
142000             WHEN SQLCODE = +0                                    14200099
142100             WHEN SQLCODE = -904                                  14210099
142200             WHEN SQLCODE = -913                                  14220099
142300                 SET ASC-TPRTRTY-UPDATED TO TRUE                  14230099
142400             WHEN SQLWARN0 NOT = SPACES                           14240099
142500             WHEN SQLCODE < +0                                    14250099
142600             WHEN SQLCODE > +0                                    14260099
142700                 MOVE '7100-UPDATE-TPRTRTY'                       14270099
142800                                   TO DP013-PARAGRAPH             14280099
142900                 MOVE 'ERROR UPDATING PRINTER TYPE TABLE'         14290099
143000                                   TO DP013-MESSAGE-TEXT (1)      14300099
143100                 MOVE SQLCA        TO DP013-SQLCA                 14310099
143200                 MOVE 'TPRTRTY'    TO DP013-DB2-TABLE-NAME (1)    14320099
143300                 SET DP013-DB2-ABEND                              14330099
143400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14340099
143500                 PERFORM DP013-0000-PROCESS-ABEND                 14350099
143600         END-EVALUATE                                             14360099
143700     END-PERFORM.                                                 14370099
143800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14380099
143900         MOVE '7100-UPDATE-TPRTRTY'                               14390099
144000                             TO DP013-PARAGRAPH                   14400099
144100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14410099
144200                             TO DP013-MESSAGE-TEXT (1)            14420099
144300         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   14430099
144400                             TO DP013-MESSAGE-TEXT (2)            14440099
144500         MOVE SQLCA          TO DP013-SQLCA                       14450099
144600         MOVE 'TPRTRTY'      TO DP013-DB2-TABLE-NAME (1)          14460099
144700         SET DP013-DB2-ABEND                                      14470099
144800             DP013-XCTL-DISPLAY-RESTART                           14480099
144900                             TO TRUE                              14490099
145000         PERFORM DP013-0000-PROCESS-ABEND                         14500099
145100     END-IF.                                                      14510099
145200     MOVE +0 TO PV-RETRY-COUNTER.                                 14520099
145300*                                                                 14530099
145400*                                                                 14540099
145500*----------------------------------------------------------------*14550099
145600* DELETE A ROW FROM THE PRINTER TYPE TABLE                        14560099
145700*----------------------------------------------------------------*14570099
145800 8100-DELETE-TPRTRTY.                                             14580099
145900     PERFORM                                                      14590099
146000         WITH TEST AFTER                                          14600099
146100         VARYING PV-RETRY-COUNTER                                 14610099
146200         FROM 1 BY 1                                              14620099
146300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14630099
146400         OR      SQLCODE = ZERO)                                  14640099
146500                                                                  14650099
146600         EXEC SQL                                                 14660099
146700             DELETE FROM TPRTRTY                                  14670099
146800            WHERE PRTR_TYP_CDE     = :ASC-PRTR-TYP-CDE            14680099
146900         END-EXEC                                                 14690099
147000         EVALUATE TRUE                                            14700099
147100             WHEN SQLCODE = +0                                    14710099
147200             WHEN SQLCODE = -904                                  14720099
147300             WHEN SQLCODE = -913                                  14730099
147400                 SET ASC-TPRTRTY-DELETED TO TRUE                  14740099
147500             WHEN SQLWARN0 NOT = SPACES                           14750099
147600             WHEN SQLCODE < +0                                    14760099
147700             WHEN SQLCODE > +0                                    14770099
147800                 MOVE '8100-DELETE-TPRTRTY'                       14780099
147900                                   TO DP013-PARAGRAPH             14790099
148000                 MOVE 'ERROR DELETING A ROW FROM TPRTRTY'         14800099
148100                                   TO DP013-MESSAGE-TEXT (1)      14810099
148200                 MOVE SQLCA        TO DP013-SQLCA                 14820099
148300                 MOVE 'TPRTRTY'    TO DP013-DB2-TABLE-NAME (1)    14830099
148400                 SET DP013-DB2-ABEND                              14840099
148500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14850099
148600                 PERFORM DP013-0000-PROCESS-ABEND                 14860099
148700         END-EVALUATE                                             14870099
148800     END-PERFORM.                                                 14880099
148900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14890099
149000         MOVE '8100-DELETE-TPRTRTY'                               14900099
149100                             TO DP013-PARAGRAPH                   14910099
149200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14920099
149300                             TO DP013-MESSAGE-TEXT (1)            14930099
149400         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   14940099
149500                             TO DP013-MESSAGE-TEXT (2)            14950099
149600         MOVE SQLCA          TO DP013-SQLCA                       14960099
149700         MOVE 'TPRTRTY'      TO DP013-DB2-TABLE-NAME (1)          14970099
149800         SET DP013-DB2-ABEND                                      14980099
149900             DP013-XCTL-DISPLAY-RESTART                           14990099
150000                             TO TRUE                              15000099
150100         PERFORM DP013-0000-PROCESS-ABEND                         15010099
150200     END-IF.                                                      15020099
150300     MOVE +0 TO PV-RETRY-COUNTER.                                 15030099
150400*                                                                 15040099
150500*                                                                 15050099
150600*----------------------------------------------------------------*15060099
150700* THIS PARAGRAPH IS NEEDED TO MAKE SURE PRINTER TRACK QUANTITY    15070099
150800* ENTERED IS '1', '2', OR '3' ONLY.                               15080099
150900*----------------------------------------------------------------*15090099
151000 9000-PROCESS-PAPR-TRK-QTY.                                       15100099
151100                                                                  15110099
151200     EVALUATE TRUE                                                15120099
151300         WHEN  ASC-PAPR-TRK-QTY-1                                 15130099
151400                   SET  PV-PAPR-TRK1-1                            15140099
151500                        PV-PAPR-TRK1-2                            15150099
151600                        PV-PAPR-TRK1-3         TO  TRUE           15160099
151700         WHEN  ASC-PAPR-TRK-QTY-2                                 15170099
151800                   SET  PV-PAPR-TRK2-1                            15180099
151900                        PV-PAPR-TRK2-2                            15190099
152000                        PV-PAPR-TRK2-3         TO  TRUE           15200099
152100         WHEN  ASC-PAPR-TRK-QTY-3                                 15210099
152200                   SET  PV-PAPR-TRK3-1                            15220099
152300                        PV-PAPR-TRK3-2                            15230099
152400                        PV-PAPR-TRK3-3         TO  TRUE           15240099
152500     END-EVALUATE.                                                15250099
152600*                                                                 15260099
152700*                                                                 15270099
152800*----------------------------------------------------------------*15280099
152900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *15290099
153000*----------------------------------------------------------------*15300099
153100 9100-READ-SEL-QUEUE.                                             15310099
153200     EXEC CICS                                                    15320099
153300         READQ TS                                                 15330099
153400             QUEUE (ASC-SEL-QUEUE-NAME)                           15340099
153500             INTO  (CN163-SELECT-RECORD)                          15350099
153600             ITEM  (ASC-SEL-ITEM)                                 15360099
153700             RESP  (PV-CICS-RESPONSE)                             15370099
153800     END-EXEC.                                                    15380099
153900                                                                  15390099
154000     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       15400099
154100         CONTINUE                                                 15410099
154200     ELSE                                                         15420099
154300         SET DP013-LOGIC-ABEND                                    15430099
154400             DP013-NO-ROLLBACK     TO TRUE                        15440099
154500         MOVE '9100-READ-SEL-QUEUE'                               15450099
154600                                   TO DP013-PARAGRAPH             15460099
154700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   15470099
154800                                   TO DP013-MESSAGE-TEXT (1)      15480099
154900         PERFORM DP013-0000-PROCESS-ABEND                         15490099
155000     END-IF.                                                      15500099
155100*                                                                 15510099
155200*                                                                 15520099
155300*----------------------------------------------------------------*15530099
155400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *15540099
155500*----------------------------------------------------------------*15550099
155600 9200-REWRITE-SEL-QUEUE.                                          15560099
155700     EXEC CICS                                                    15570099
155800          WRITEQ TS                                               15580099
155900              QUEUE  (ASC-SEL-QUEUE-NAME)                         15590099
156000              FROM   (CN163-SELECT-RECORD)                        15600099
156100              ITEM   (ASC-SEL-ITEM)                               15610099
156200              RESP   (PV-CICS-RESPONSE)                           15620099
156300              REWRITE                                             15630099
156400     END-EXEC.                                                    15640099
156500                                                                  15650099
156600     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   15660099
156700         SET DP013-CICS-ABEND                                     15670099
156800             DP013-NO-ROLLBACK     TO TRUE                        15680099
156900         MOVE '9200-REWRITE-SEL-QUEUE'                            15690099
157000                                   TO DP013-PARAGRAPH             15700099
157100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   15710099
157200                                   TO DP013-MESSAGE-TEXT (1)      15720099
157300         PERFORM DP013-0000-PROCESS-ABEND                         15730099
157400     END-IF.                                                      15740099
157500*                                                                 15750099
157600*                                                                 15760099
157700     COPY DPPD013.                                                15770099
157800*----------------------------------------------------------------*15780099
157900*    ABEND PROCESSOR MODULE                                      *15790099
158000*----------------------------------------------------------------*15800099
