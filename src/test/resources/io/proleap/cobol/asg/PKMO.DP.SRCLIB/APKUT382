000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    APKUT382.                                         00040002
000500 AUTHOR.        BARB SCHULTZ.                                     00050002
000600 DATE-WRITTEN.  MARCH 2020.                                       00060002
000700                                                                  00070002
000800*----------------------------------------------------------------*00080002
000900*                                                                *00090002
001000*           CREATE TRANSSOLUTION PRODUCT DOWNLOAD FILE           *00100002
001100*                                                                *00110002
001200* THE PURPOSE OF THIS PROGRAM IS TO CREATE A PRODUCT FILE FOR    *00120002
001300* THE FREIGHT CLAIM SYSTEM USING ITEM EXTRACT FILES              *00130002
001400*             PKMO.IM.ITEM.SKU.LOC.DOMAIN.EXTRACT  APRD381       *00140002
001500*             PKMO.IM.ITEM.STYL.DOMAIN.V2.EXTRACT  IMRD058       *00150002
001600*                                                                *00160002
001700*----------------------------------------------------------------*00170002
001800*                                                                *00180002
001900* INPUT:                                                         *00190002
002000*                                                                *00200002
002100*  1. SKU/SKU LOC                       (APRD381)                *00210002
002200*  2. SKU STYLE V2                      (IMRD058)                *00220002
002300*                                                                *00230002
002400* OUTPUT:                                                        *00240002
002500*                                                                *00250002
002600*  1. FREIGHT CLAIM PRODUCT             (APRD382)                *00260002
002700*                                                                *00270002
002800*----------------------------------------------------------------*00280002
002900*  CHANGES:                                                      *00290002
003000*                                                                *00300002
003300*  MADE BY:                                                      *00330002
003400*                                                                *00340002
003500*   DATE  XX/XX/XXXX                                             *00350005
003600*       CHANGE MADE: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX      *00360006
003700*       WHICH WAS CAUSING EXCESSIVE LINES OF SYSOUT.             *00370006
003800*       MADE BY: XXXXXXXXXXXXXX          WR/IR #: XXXXXXXXXXXX   *00380006
003900*----------------------------------------------------------------*00390002
004100                                                                  00410002
004200 ENVIRONMENT DIVISION.                                            00420002
004300 CONFIGURATION SECTION.                                           00430002
004400 SOURCE-COMPUTER. IBM-3090.                                       00440002
004500 OBJECT-COMPUTER. IBM-3090.                                       00450002
004600                                                                  00460002
004700                                                                  00470002
004800 INPUT-OUTPUT SECTION.                                            00480002
004900 FILE-CONTROL.                                                    00490002
005000                                                                  00500002
005100     SELECT AP-SKULOC-FILE             ASSIGN TO UT-S-INP01.      00510002
005200     SELECT IM-SKU-STYLE2-FILE         ASSIGN TO UT-S-INP02.      00520002
005300     SELECT AP-CLAIM-PRODUCT-FILE      ASSIGN TO UT-S-OUT01.      00530002
005400                                                                  00540002
005500 DATA DIVISION.                                                   00550002
005600 FILE SECTION.                                                    00560002
005700                                                                  00570002
005800 FD  AP-SKULOC-FILE                                               00580002
005900     RECORDING MODE IS F                                          00590002
006000     BLOCK CONTAINS 0 CHARACTERS                                  00600002
006100     LABEL RECORDS ARE STANDARD                                   00610002
006200     DATA RECORD IS IM-SKU-RECORD.                                00620002
006300                                                                  00630002
006400 01  IM-SKULOC-RECORD             PIC X(50).                      00640002
006500                                                                  00650002
006600 FD  IM-SKU-STYLE2-FILE                                           00660002
006700     RECORDING MODE IS F                                          00670002
006800     BLOCK CONTAINS 0 CHARACTERS                                  00680002
006900     LABEL RECORDS ARE STANDARD                                   00690002
007000     DATA RECORD IS IM-SKU-STYLE2-RECORD.                         00700002
007100                                                                  00710002
007200 01  IM-SKU-STYLE2-RECORD         PIC X(510).                     00720002
007300                                                                  00730002
007400 FD  AP-CLAIM-PRODUCT-FILE                                        00740002
007500     RECORDING MODE IS F                                          00750002
007600     BLOCK CONTAINS 0 CHARACTERS                                  00760002
007700     LABEL RECORDS ARE STANDARD                                   00770002
007800     DATA RECORD IS AP-CLAIM-PRODUCT-RECORD.                      00780002
007900                                                                  00790002
008000 01  AP-CLAIM-PRODUCT-RECORD      PIC X(120).                     00800002
008100                                                                  00810002
008300 WORKING-STORAGE SECTION.                                         00830002
008400                                                                  00840002
008500 01  PC-PROGRAM-CONSTANTS.                                        00850002
008600     05  PC-WS-PROGRAM           PIC  X(40)  VALUE                00860002
008700         '**** WORKING STORAGE ** APKUT382 ****'.                 00870002
008800                                                                  00880002
008900 01  PV-PROGRAM-VARIABLES.                                        00890002
009000     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      00900002
009100     05  PV-NULL-IND             PIC S9(4)     VALUE ZERO         00910002
009200                                               COMP SYNC.         00920002
009300     05  PV-SAVE-PO-NBR-COMP     PIC S9(09)    VALUE ZEROS        00930002
009400                                               COMP.              00940002
009500*    05  PV-APTRAN-PO-ACCT.                                       00950002
009600*        10  PV-TR-PONUMB        PIC  9(09)    VALUE ZEROS.       00960002
009700*        10  PV-TR-EXPNO         PIC  X(07)    VALUE SPACES.      00970002
009800*    05  SV-APTRAN-PO-ACCT.                                       00980002
009900*        10  SV-TR-PONUMB        PIC  9(09)    VALUE ZEROS.       00990002
010000*        10  SV-TR-EXPNO         PIC  X(07)    VALUE SPACES.      01000002
010100     05  PV-CH-ACTVTY-AMT        PIC S9(11)V99 COMP-3.            01010002
010200     05  PV-CR-ACTVTY-AMT        PIC S9(11)V99 COMP-3.            01020002
010300     05  PV-NET-COST-AMT         PIC S9(09)V99 COMP-3.            01030002
010400     05  PV-VENDOR-NBR           PIC  X(09)    VALUE SPACES.      01040002
010500     05  PV-VENDOR-NAME          PIC  X(30)    VALUE SPACES.      01050002
010600     05  PV-ALW-CHRG-CDE         PIC  X(03)    VALUE SPACES.      01060002
010700     05  PV-ALC-RPT-CUTOFF-DATE  PIC  X(10)    VALUE SPACES.      01070002
010800     05  PV-ALC-RPT-CUTOFF-DTE.                                   01080002
010900         10  PV-ALC-RPT-CUTOFF-CC PIC 99.                         01090002
011000         10  PV-ALC-RPT-CUTOFF-YY PIC 99.                         01100002
011100         10  FILLER               PIC X.                          01110002
011200         10  PV-ALC-RPT-CUTOFF-MM PIC 99.                         01120002
011300         10  FILLER               PIC X.                          01130002
011400         10  PV-ALC-RPT-CUTOFF-DD PIC 99.                         01140002
011500                                                                  01150002
011600     05  PV-RCV-RPT-CUTOFF-DATE  PIC  X(10)    VALUE SPACES.      01160002
011700     05  PV-RCV-RPT-CUTOFF-DTE.                                   01170002
011800         10  PV-RVC-RPT-CUTOFF-CC PIC 99.                         01180002
011900         10  PV-RVC-RPT-CUTOFF-YY PIC 99.                         01190002
012000         10  FILLER               PIC X.                          01200002
012100         10  PV-RVC-RPT-CUTOFF-MM PIC 99.                         01210002
012200         10  FILLER               PIC X.                          01220002
012300         10  PV-RVC-RPT-CUTOFF-DD PIC 99.                         01230002
012400                                                                  01240002
012500     05  PV-PERIOD-END-DTE       PIC  X(10)    VALUE SPACES.      01250002
012600     05  PV-AP381-COUNT          PIC S9(9)     VALUE ZEROS        01260004
012700                                               COMP.              01270002
012800     05  PV-IM058-COUNT          PIC S9(9)     VALUE ZEROS        01280002
012900                                               COMP.              01290002
013000     05  PV-CLM-PRD-COUNT        PIC S9(9)     VALUE ZEROS        01300002
013100                                               COMP.              01310002
013200                                                                  01320002
013300 01  PS-FIRST-TIME-SW            PIC X(01)   VALUE ' '.           01330002
013400     88  PS-FIRST-TIME                       VALUE 'Y'.           01340002
013500     88  PS-NOT-FIRST-TIME                   VALUE ' '.           01350002
013600                                                                  01360002
013700 01  PS-PROGRAM-SWITCHES.                                         01370002
013800     05  PS-END-AP381-SW         PIC  X(01)  VALUE ' '.           01380003
013900         88  PS-END-AP381                    VALUE 'Y'.           01390003
014000     05  PS-END-IM058-SW         PIC  X(01)  VALUE ' '.           01400002
014100         88  PS-END-IM058                    VALUE 'Y'.           01410002
014200                                                                  01420002
014300 01  HOLD-FIELDS.                                                 01430002
014400     05  HOLD-006-RMS-STYL-ID    PIC X(8).                        01440002
014500     05  HOLD-058-RMS-STYL-ID    PIC X(8).                        01450002
014600                                                                  01460002
014601 01  HOLD-DESCRIPTION.                                            01460102
014602     05  HOLD-DESCRIPTION-TEXT   PIC X(30).                       01460202
014603     05  HOLD-BUSGRP-PRDLNE      PIC X(8).                        01460302
014604                                                                  01460402
014605 01  HOLD-058-DEPT                PIC 9(4)V.                      01460502
014606 01  HOLD-058-SUB-CL              PIC 9(4)V.                      01460602
014607                                                                  01460702
014608 01  HOLD-BUSPRD.                                                 01460802
014609     05  HOLD-BUSINESS1-GROUP     PIC X(1) VALUE SPACE.           01460902
014610     05  HOLD-BUSINESS2-GROUP     PIC X(1) VALUE SPACE.           01461002
014611     05  HOLD-BUSINESS3-GROUP     PIC X(1) VALUE SPACE.           01461102
014612     05  HOLD-BUSINESS4-GROUP     PIC X(1) VALUE SPACE.           01461202
014613     05  HOLD-SLASH1             PIC X  VALUE '\'.                01461302
014614     05  HOLD-PRODUCT1-LINE      PIC X(1)  VALUE SPACE.           01461402
014615     05  HOLD-PRODUCT2-LINE      PIC X(1)  VALUE SPACE.           01461502
014616     05  HOLD-PRODUCT3-LINE      PIC X(1)  VALUE SPACE.           01461602
014617     05  HOLD-PRODUCT4-LINE      PIC X(1)  VALUE SPACE.           01461702
014618                                                                  01461802
014619 01  HOLD-BUSGRP.                                                 01461902
014620     05  HOLD-BUSINESS-GROUP1    PIC X(1)   VALUE SPACE.          01462002
014621     05  HOLD-BUSINESS-GROUP2    PIC X(1)   VALUE SPACE.          01462102
014622     05  HOLD-BUSINESS-GROUP3    PIC X(1)   VALUE SPACE.          01462202
014623     05  HOLD-BUSINESS-GROUP4    PIC X(1)   VALUE SPACE.          01462302
014624                                                                  01462402
014625 01  HOLD-PRDLNE.                                                 01462502
014626     05  HOLD-PRODUCT-LINE1      PIC X(1)   VALUE SPACE.          01462602
014627     05  HOLD-PRODUCT-LINE2      PIC X(1)   VALUE SPACE.          01462702
014628     05  HOLD-PRODUCT-LINE3      PIC X(1)   VALUE SPACE.          01462802
014629     05  HOLD-PRODUCT-LINE4      PIC X(1)   VALUE SPACE.          01462902
014630                                                                  01463002
014631 01  HOLD-058-PRICE               PIC 9(7)V9(3).                  01463102
014632                                                                  01463202
014633 01  HOLD-58-PRICE.                                               01463302
014634     05  HOLD-58-FIRST-PRICE    PIC X(7).                         01463402
014635     05  HOLD-58-LAST-PRICE     PIC X(3).                         01463502
014636                                                                  01463602
014637 01  HOLD-PRICE.                                                  01463702
014638     05  HOLD-FIRST-PRICE        PIC X(7).                        01463802
014639     05  HOLD-LAST-PRICE         PIC X(3).                        01463902
014640                                                                  01464002
014650 01  HOLD-58-WEIGHT.                                              01465002
014660     05  HOLD-058-FIRST-WEIGHT   PIC S9(7).                       01466002
014670     05  HOLD-058-DECIMAL-WEIGHT PIC X.                           01467002
014680     05  HOLD-058-LAST-WEIGHT    PIC 9(3).                        01468002
014690                                                                  01469002
014700 01  HOLD-WEIGHT.                                                 01470002
014710     05  HOLD-FIRST-WEIGHT       PIC S9(7).                       01471002
014720     05  HOLD-LAST-WEIGHT        PIC 9(3).                        01472002
014730                                                                  01473002
014740 01  HOLD-58-RATE.                                                01474002
014750     05  HOLD-058-FIRST-RATE     PIC S9(7).                       01475002
014760     05  HOLD-058-DECIMAL-RATE   PIC X.                           01476002
014770     05  HOLD-058-LAST-RATE      PIC 9(3).                        01477002
014780                                                                  01478002
014790 01  HOLD-RATE.                                                   01479002
014800     05  HOLD-FIRST-RATE         PIC S9(7).                       01480002
014801     05  HOLD-LAST-RATE          PIC 9(3).                        01480102
014802                                                                  01480202
014803 01  RUN-TIME.                                                    01480302
014804     05  R-HR                    PIC 99.                          01480402
014805     05  R-MIN                   PIC 99.                          01480502
014806     05  R-SEC                   PIC 99.                          01480602
014807     05  R-TH                    PIC 99.                          01480702
014808*                                                                 01480802
014809 01  DATE-IN.                                                     01480902
014810     05 DATE-IN-YY               PIC XX.                          01481002
014820     05 DATE-IN-MM               PIC XX.                          01482002
014830     05 DATE-IN-DD               PIC XX.                          01483002
014840                                                                  01484002
014850/                                                                 01485002
014860*                                                                 01486002
014870*    IM-SKU-RECORD.                                               01487002
014880*                                                                 01488002
014890     COPY APRD381.                                                01489002
014900/                                                                 01490002
015000*                                                                 01500002
015100*    IM-SKU-STYLE2-RECORD.                                        01510002
015200*                                                                 01520002
015300     COPY IMRD058.                                                01530002
015400/                                                                 01540002
015500*                                                                 01550002
015600*    AP-CLAIM-PRODUCT-RECORD.                                     01560002
015700*                                                                 01570002
015800     COPY APRD382.                                                01580002
015900/                                                                 01590002
016000*---------------------------------------------------------------- 01600002
016100*  ABEND DATA AREAS                                               01610002
016200*---------------------------------------------------------------- 01620002
016300                                                                  01630002
016400 01  ABEND-AREAS.                                                 01640002
016500     05  AA-ABEND-LIT            PIC  X(40)  VALUE                01650002
016600             '*****       ABEND'.                                 01660002
016700     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                01670002
016800             '*****   PROGRAM: APKUT382'.                         01680002
016900     05  AA-PARAGRAPH-LIT.                                        01690002
017000         10  FILLER              PIC  X(17)  VALUE                01700002
017100             '***** PARAGRAPH: '.                                 01710002
017200         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        01720002
017300     05  AA-MESSAGE-LINE.                                         01730002
017400         10  FILLER              PIC  X(06)  VALUE '*****'.       01740002
017500         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        01750002
017600                                                                  01760002
017700/                                                                 01770002
017800 01  FILLER                      PIC  X(35)  VALUE                01780002
017900     '**** END OF W/S ** APKUT382 ****'.                          01790002
018000                                                                  01800002
018100 PROCEDURE DIVISION.                                              01810002
018200                                                                  01820002
018300     PERFORM A100-MAINLINE.                                       01830002
018400     GOBACK.                                                      01840002
018500                                                                  01850002
018700 A100-MAINLINE.                                                   01870002
018800                                                                  01880002
018900     PERFORM B100-INITIALIZE.                                     01890002
019000                                                                  01900002
019100     PERFORM B200-PROCESS-FILES                                   01910002
019200         UNTIL PS-END-AP381.                                      01920002
019300                                                                  01930002
019400     PERFORM B300-END-OF-PROGRAM.                                 01940002
019500                                                                  01950002
019700*---------------------------------------------------------------- 01970002
019800*    INITIALIZATION PROCESSING.                                   01980002
019900*---------------------------------------------------------------- 01990002
020000 B100-INITIALIZE.                                                 02000002
020100                                                                  02010002
020200     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02020002
020300                                                                  02030002
020400     ACCEPT RUN-TIME FROM TIME.                                   02040002
020500     ACCEPT DATE-IN  FROM DATE.                                   02050002
020600                                                                  02060002
020700     DISPLAY ' RUN-DATE = ' DATE-IN '   RUN-TIME = ' RUN-TIME.    02070002
020800                                                                  02080002
020900     OPEN INPUT  AP-SKULOC-FILE                                   02090002
021000                 IM-SKU-STYLE2-FILE                               02100002
021100     OPEN OUTPUT AP-CLAIM-PRODUCT-FILE.                           02110002
021200                                                                  02120002
021300     PERFORM R100-READ-AP381.                                     02130002
021400                                                                  02140002
021500                                                                  02150002
021700*---------------------------------------------------------------- 02170002
021800*    CONTROLS THE PROCESSING OF THE 2 INPUT FILES BASED ON HOW    02180002
021900*    THE PO/ACCOUNT NUMBERS COMPARE TO EACH OTHER.  THE IM057     02190002
022000*    FILE WILL HAVE 0 OR 1 RECORD FOR EACH PO/ACCOUNT COMBINATION.02200002
022100*---------------------------------------------------------------- 02210002
022200 B200-PROCESS-FILES.                                              02220002
022300                                                                  02230002
022400     MOVE AP381-RMS-STYL-ID TO HOLD-006-RMS-STYL-ID.              02240002
022500                                                                  02250002
022600     IF HOLD-058-RMS-STYL-ID = HOLD-006-RMS-STYL-ID               02260002
022700           PERFORM D100-COMBINE-RECORD                            02270002
022800           PERFORM W100-WRITE-CLAIM-PRODUCT                       02280002
022900     ELSE                                                         02290002
023000           PERFORM R200-READ-IM058 UNTIL                          02300002
023100                   HOLD-058-RMS-STYL-ID = HOLD-006-RMS-STYL-ID    02310002
023200                   OR PS-END-IM058                                02320002
023300           PERFORM D100-COMBINE-RECORD                            02330002
023400           PERFORM W100-WRITE-CLAIM-PRODUCT.                      02340002
023500                                                                  02350002
023600                                                                  02360002
023700     PERFORM R100-READ-AP381.                                     02370002
023800                                                                  02380002
023900*---------------------------------------------------------------- 02390002
024000*  END OF PROGRAM - DISPLAYS COUNTERS AND CLOSES FILES.           02400002
024100*---------------------------------------------------------------- 02410002
024200 B300-END-OF-PROGRAM.                                             02420002
024300                                                                  02430002
024400     DISPLAY 'PROGRAM APKUT382 RECORD COUNTS'.                    02440002
024500     DISPLAY '****************************'.                      02450002
024600     DISPLAY 'NBR OF AP381 RECS READ    = ' PV-AP381-COUNT.       02460002
024700     DISPLAY 'NBR OF IM058 RECS READ    = ' PV-IM058-COUNT.       02470002
024800     DISPLAY 'NBR OF AP382 RECS WRITTEN = ' PV-CLM-PRD-COUNT.     02480002
024900     DISPLAY '****************************'.                      02490002
025000     DISPLAY '** PROGRAM APKUT382 ENDS NORMALLY **'.              02500002
025100                                                                  02510002
025200     CLOSE AP-SKULOC-FILE                                         02520002
025300           IM-SKU-STYLE2-FILE                                     02530002
025400           AP-CLAIM-PRODUCT-FILE.                                 02540002
025500                                                                  02550002
025700*---------------------------------------------------------------- 02570002
025800*  MOVES ALL FIELDS NEEDED FOR TRANSSOLUTIONS PRODUCT FILE        02580002
025900*---------------------------------------------------------------- 02590002
026000 D100-COMBINE-RECORD.                                             02600002
026100                                                                  02610002
026200     IF PS-END-IM058                                              02620002
026300         CONTINUE                                                 02630002
026400     ELSE                                                         02640002
026500        MOVE IM058-VS-NBR        TO AP382-CLM-PRD-CODE            02650002
026600        PERFORM D150-GET-BUSPRD                                   02660002
026700        MOVE HOLD-DESCRIPTION    TO AP382-CLM-PRD-DESC            02670002
026900        MOVE AP381-057-UNIT-COST TO HOLD-058-PRICE                02690002
027000        MOVE HOLD-058-PRICE      TO HOLD-58-PRICE                 02700002
027100        MOVE HOLD-58-FIRST-PRICE TO HOLD-FIRST-PRICE              02710002
027200        MOVE HOLD-58-LAST-PRICE  TO HOLD-LAST-PRICE               02720002
027300        MOVE HOLD-PRICE          TO AP382-CLM-PRD-PRICE           02730002
027400        MOVE ZERO                TO AP382-CLM-PRD-WEIGHT          02740002
027500        MOVE ZERO                TO AP382-CLM-PRD-RATE            02750002
027600        MOVE IM058-DEPT-NBR      TO AP382-CLM-PRD-DEPT            02760002
027700        MOVE IM058-SUB-CL-NBR    TO AP382-CLM-PRD-LINE.           02770002
027800     INITIALIZE HOLD-BUSPRD.                                      02780002
027900     MOVE '\' TO HOLD-SLASH1.                                     02790002
028000                                                                  02800002
028100 D150-GET-BUSPRD.                                                 02810002
028200                                                                  02820002
028300     MOVE IM058-VS-DESC       TO HOLD-DESCRIPTION-TEXT.           02830002
028400     MOVE IM058-DEPT-NBR      TO HOLD-058-DEPT.                   02840002
028500     MOVE HOLD-058-DEPT       TO HOLD-BUSGRP.                     02850002
028600     MOVE IM058-SUB-CL-NBR    TO HOLD-058-SUB-CL.                 02860002
028700     MOVE HOLD-058-SUB-CL     TO HOLD-PRDLNE.                     02870002
028800     MOVE HOLD-BUSINESS-GROUP4 TO HOLD-BUSINESS4-GROUP.           02880002
028900     MOVE HOLD-BUSINESS-GROUP3 TO HOLD-BUSINESS3-GROUP.           02890002
029000     IF HOLD-BUSINESS-GROUP2 = 0                                  02900002
029100        NEXT SENTENCE                                             02910002
029110     ELSE                                                         02911002
029120        MOVE HOLD-BUSINESS-GROUP2 TO HOLD-BUSINESS2-GROUP.        02912002
029130                                                                  02913002
029140     IF HOLD-BUSINESS-GROUP1 = 0                                  02914002
029150        NEXT SENTENCE                                             02915002
029160     ELSE                                                         02916002
029170        MOVE HOLD-BUSINESS-GROUP1 TO HOLD-BUSINESS1-GROUP.        02917002
029180                                                                  02918002
029190     IF HOLD-PRODUCT-LINE1 = 0                                    02919002
029191        NEXT SENTENCE                                             02919102
029192     ELSE                                                         02919202
029193        MOVE HOLD-PRODUCT-LINE1 TO HOLD-PRODUCT1-LINE.            02919302
029194                                                                  02919402
029195     IF HOLD-PRODUCT-LINE2 = 0 AND                                02919502
029196        HOLD-PRODUCT-LINE1 = 0                                    02919602
029197        NEXT SENTENCE                                             02919702
029198     ELSE                                                         02919802
029199        IF HOLD-PRODUCT1-LINE = SPACE                             02919902
029200           MOVE HOLD-PRODUCT-LINE2 TO HOLD-PRODUCT1-LINE          02920002
029201        ELSE                                                      02920102
029202           MOVE HOLD-PRODUCT-LINE2 TO HOLD-PRODUCT2-LINE          02920202
029203        END-IF                                                    02920302
029204     END-IF.                                                      02920402
029205                                                                  02920502
029206     IF HOLD-PRODUCT-LINE3 = 0 AND                                02920602
029207        HOLD-PRODUCT-LINE2 = 0 AND                                02920702
029208        HOLD-PRODUCT-LINE1 = 0                                    02920802
029209        NEXT SENTENCE                                             02920902
029210     ELSE                                                         02921002
029211        IF HOLD-PRODUCT1-LINE = SPACE                             02921102
029212           MOVE HOLD-PRODUCT-LINE3 TO HOLD-PRODUCT1-LINE          02921202
029213        ELSE                                                      02921302
029214           IF HOLD-PRODUCT2-LINE = SPACE                          02921402
029215               MOVE HOLD-PRODUCT-LINE3 TO HOLD-PRODUCT2-LINE      02921502
029216           ELSE                                                   02921602
029217               MOVE HOLD-PRODUCT-LINE3 TO HOLD-PRODUCT3-LINE      02921702
029218           END-IF                                                 02921802
029219        END-IF                                                    02921902
029220     END-IF.                                                      02922002
029221                                                                  02922102
029222     IF HOLD-PRODUCT-LINE4 = 0 AND                                02922202
029223        HOLD-PRODUCT-LINE3 = 0 AND                                02922302
029224        HOLD-PRODUCT-LINE2 = 0 AND                                02922402
029225        HOLD-PRODUCT-LINE1 = 0                                    02922502
029226        NEXT SENTENCE                                             02922602
029227     ELSE                                                         02922702
029228        IF HOLD-PRODUCT1-LINE = SPACE                             02922802
029229           MOVE HOLD-PRODUCT-LINE4 TO HOLD-PRODUCT1-LINE          02922902
029230        ELSE                                                      02923002
029231           IF HOLD-PRODUCT2-LINE = SPACE                          02923102
029232               MOVE HOLD-PRODUCT-LINE4 TO HOLD-PRODUCT2-LINE      02923202
029233           ELSE                                                   02923302
029234               IF HOLD-PRODUCT3-LINE = SPACE                      02923402
029235                  MOVE HOLD-PRODUCT-LINE4 TO HOLD-PRODUCT3-LINE   02923502
029236               ELSE                                               02923602
029237                  MOVE HOLD-PRODUCT-LINE3 TO HOLD-PRODUCT4-LINE   02923702
029238               END-IF                                             02923802
029239           END-IF                                                 02923902
029240        END-IF                                                    02924002
029250     END-IF.                                                      02925002
029251                                                                  02925102
029252     MOVE HOLD-BUSPRD TO HOLD-BUSGRP-PRDLNE.                      02925202
029253                                                                  02925302
029255*---------------------------------------------------------------- 02925502
029256*  READS THE SKU LOCATION DOMAIN EXTRACT FILE  (IM057).           02925602
029257*---------------------------------------------------------------- 02925702
029258 R100-READ-AP381.                                                 02925802
029259                                                                  02925902
029260     READ AP-SKULOC-FILE INTO AP381-CLAIM-NEED-RECORD             02926002
029270         AT END                                                   02927002
029280             SET PS-END-AP381 TO TRUE.                            02928002
029290                                                                  02929002
029300     IF NOT PS-END-AP381                                          02930002
029400        ADD +1 TO PV-AP381-COUNT                                  02940002
029500     END-IF.                                                      02950002
029600                                                                  02960002
029800*---------------------------------------------------------------- 02980002
029900*  READS THE SKU STYLE-2 DOMAIN EXTRACT FILE  (IM058).            02990002
030000*---------------------------------------------------------------- 03000002
030100 R200-READ-IM058.                                                 03010002
030200                                                                  03020002
030300     READ IM-SKU-STYLE2-FILE INTO IM058-ITEM-STYLE-DOMAIN-REC     03030002
030400         AT END                                                   03040002
030500             SET PS-END-IM058 TO TRUE.                            03050002
030600                                                                  03060002
030700     MOVE IM058-RMS-STYL-ID TO HOLD-058-RMS-STYL-ID.              03070002
030800     IF NOT PS-END-IM058                                          03080002
030900        ADD +1 TO PV-IM058-COUNT                                  03090002
031000     END-IF.                                                      03100002
031100                                                                  03110002
031300*---------------------------------------------------------------- 03130002
031400*  WRITES OUT THE SINGLE COMBINED RECORD FROM ALL THREE           03140002
031500*  INPUT FILES HAVING MATCHED KEYS                                03150002
031600*---------------------------------------------------------------- 03160002
031700 W100-WRITE-CLAIM-PRODUCT.                                        03170002
031800                                                                  03180002
031900     IF PS-END-IM058                                              03190002
032000         CONTINUE                                                 03200002
032100     ELSE                                                         03210002
032200         WRITE AP-CLAIM-PRODUCT-RECORD FROM                       03220002
032300               AP382-CLAIM-PRODUCT-RECORD                         03230002
032400         ADD 1                TO PV-CLM-PRD-COUNT.                03240002
032500                                                                  03250002
