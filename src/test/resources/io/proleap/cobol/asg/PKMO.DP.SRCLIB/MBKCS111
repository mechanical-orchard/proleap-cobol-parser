00001 *                                                                 02/05/92
00002 *                                                                 MBKCS111
00003 *                                                                    LV200
00004  IDENTIFICATION DIVISION.                                         MBKCS111
00005                                                                   MBKCS111
00006  PROGRAM-ID.    MBKCS111.                                            CL120
00007  AUTHOR.        BOB LOOS - STRATAGEM.                                CL*28
00008  INSTALLATION.  KOHLS DEPARTMENT STORES.                          MBKCS111
00009  DATE-WRITTEN.  07-19-91.                                            CL102
00010  DATE-COMPILED.                                                   MBKCS111
00011                                                                   MBKCS111
00012 ***************************************************************** MBKCS111
00013 *    M111 - MERCHANDISE DEPT SELECTION                               CL120
00014 *                                                                    CL**3
00015 *    THIS PROGRAM ALLOWS THE USER TO CHOOSE THE TYPE OF              CL*23
00016 *    CRITERIA THAT HE OR SHE WANTS TO USE TO GENERATE THE MERCH-     CL*30
00017 *    ANDISE DEPT LIST. THE CRITERIA IS SELECTED BY ENTERING          CL102
00018 *    THE APPROPRIATE VALUES ON THE MERCHANDISE DEPT FILTER           CL102
00019 ***************************************************************** MBKCS111
262978* CHANGED 10/22/2021    BY JIM HUNTER      WR: CHG0262978                 
262978* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
262978* MAKING THE CALL DYNAMIC VS STATIC.                                      
262978******************************************************************        
00020                                                                   MBKCS111
00021 *                                                                 MBKCS111
00022 *                                                                 MBKCS111
00023 *                                                                 MBKCS111
00024  ENVIRONMENT DIVISION.                                            MBKCS111
00025 *                                                                 MBKCS111
00026 *                                                                 MBKCS111
00027 *                                                                 MBKCS111
00028  DATA DIVISION.                                                   MBKCS111
00029 *                                                                 MBKCS111
00030 *                                                                 MBKCS111
00031  WORKING-STORAGE SECTION.                                         MBKCS111
00032                                                                      CL**5
00033  01  PC-PROGRAM-CONSTANTS.                                           CL**5
00034      05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.MBKCS111
00035      05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  MBKCS111
00036                                                      COMP SYNC.   MBKCS111
00037      05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        MBKCS111
00038      'MB111A  '.                                                     CL120
00039      05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        MBKCS111
00040      'MBKM111 '.                                                     CL120
00041      05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        MBKCS111
00042      'MBKCS111'.                                                     CL120
00043      05  PC-HISTORY-DEFAULT             PIC X(01)    VALUE 'N'.      CL155
00044      05  PC-MAX-RETRIES                 PIC 9(02)    VALUE  3.       CL177
00045      05  PC-TSQ-LENGTH                  PIC S9(04)   VALUE 2007      CL187
00046                                                      COMP SYNC.      CL187
00047      05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   MBKCS111
00048                                                      COMP SYNC.   MBKCS111
00049      05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      MBKCS111
00050          10  FILLER                     PIC X(01).                MBKCS111
00051          10  PC-ERASE-EOF               PIC X(01).                MBKCS111
00052      05  PC-MBLDEPT                     PIC X(08)    VALUE           CL102
00053      'MBLDEPT '.                                                     CL102
00054      05  PC-ZERO-VALUE                  PIC X(01)    VALUE '0'.      CL*66
00055      05  PC-OPER-COMPANY                PIC X(02)    VALUE '03'.     CL*66
00056      05  PC-TSYMSG-NUMBERS.                                          CL106
00057          10 PC-TSYMSG-00005             PIC 9(05)    VALUE 00005.    CL106
00058          10 PC-TSYMSG-00007             PIC 9(05)    VALUE 00007.    CL175
00059          10 PC-TSYMSG-00010             PIC 9(05)    VALUE 00010.    CL134
00060          10 PC-TSYMSG-00030             PIC 9(05)    VALUE 00030.    CL108
00061          10 PC-TSYMSG-00032             PIC 9(05)    VALUE 00032.    CL108
00062          10 PC-TSYMSG-00045             PIC 9(05)    VALUE 00045.    CL108
00063          10 PC-TSYMSG-00076             PIC 9(05)    VALUE 00076.    CL108
00064          10 PC-TSYMSG-00077             PIC 9(05)    VALUE 00077.    CL108
00065          10 PC-TSYMSG-00078             PIC 9(05)    VALUE 00078.    CL108
00066          10 PC-TSYMSG-00079             PIC 9(05)    VALUE 00079.    CL108
00067          10 PC-TSYMSG-00080             PIC 9(05)    VALUE 00080.    CL108
00068          10 PC-TSYMSG-00081             PIC 9(05)    VALUE 00081.    CL108
00069          10 PC-TSYMSG-00082             PIC 9(05)    VALUE 00082.    CL107
00070          10 PC-TSYMSG-00137             PIC 9(05)    VALUE 00137.    CL175
00071                                                                   MBKCS111
00072  01  DK-DATABASE-KEYS.                                               CL171
00073      05  DK-MDSELV-DPT                  PIC X(03)    VALUE 'DPT'.    CL171
00074  01  PM-PROGRAM-MESSAGES.                                         MBKCS111
00075      05  PM-PROGRAM-MESSAGE-1           PIC X(78)    VALUE           CL**3
00076      'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                   CL**3
00077                                                                      CL**5
00078  01  PS-PROGRAM-SWITCHES.                                         MBKCS111
00079      05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   MBKCS111
00080          88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   MBKCS111
00081          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   MBKCS111
00082          88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   MBKCS111
00083          88  PS-SEND-DATA-ONLY                       VALUE '4'.   MBKCS111
00084          88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   MBKCS111
00085          88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   MBKCS111
00086      05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   MBKCS111
00087          88  PS-ERROR                                VALUE 'Y'.   MBKCS111
00088          88  PS-NO-ERROR                             VALUE 'N'.   MBKCS111
00089      05  PS-SPECIF-TRAN-SW              PIC X(01)    VALUE 'N'.      CL108
00090          88  PS-SPECIF-TRAN                          VALUE 'Y'.      CL108
00091          88  PS-NO-SPECIF-TRAN                       VALUE 'N'.      CL108
00092      05  PS-SPECIF-GMA-SW               PIC X(01)    VALUE 'N'.      CL108
00093          88  PS-SPECIF-GMA                           VALUE 'Y'.      CL108
00094          88  PS-NO-SPECIF-GMA                        VALUE 'N'.      CL108
00095      05  PS-SPECIF-DMA-SW               PIC X(01)    VALUE 'N'.      CL108
00096          88  PS-SPECIF-DMA                           VALUE 'Y'.      CL108
00097          88  PS-NO-SPECIF-DMA                        VALUE 'N'.      CL108
00098      05  PS-SPECIF-DPT-SW               PIC X(01)    VALUE 'N'.      CL108
00099          88  PS-SPECIF-DPT                           VALUE 'Y'.      CL108
00100          88  PS-NO-SPECIF-DPT                        VALUE 'N'.      CL108
00101      05  PS-ROW-FOUND-SW                PIC X(01)    VALUE 'N'.      CL175
00102          88  PS-ROW-FOUND                            VALUE 'Y'.      CL175
00103          88  PS-ROW-NOT-FOUND                        VALUE 'N'.      CL175
00104                                                                   MBKCS111
00105  01  PV-PROGRAM-VARIABLES.                                        MBKCS111
00106      05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     MBKCS111
00107                                                      COMP SYNC.   MBKCS111
00108      05  PV-NAV-MNEMONIC                PIC X(08)    VALUE SPACES.   CL**5
00109      05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.   CL*21
00110      05  PV-RETRY-COUNTER               PIC 9(02)    VALUE 0.        CL176
00111      05  PV-ITEM-NBR                    PIC S9(04)   COMP SYNC.      CL187
00112                                                                      CL*88
00113  EJECT                                                            MBKCS111
00114 ***************************************************************** MBKCS111
00115 *    STANDARD COMMAREA.                                           MBKCS111
00116 ***************************************************************** MBKCS111
00117                                                                   MBKCS111
00118      COPY DPWS020.                                                   CL147
00119      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                MBKCS111
00120                                                                   MBKCS111
00121 ***************************************************************** MBKCS111
00122 *    INTER-APPLICATION COMMAREA.                                  MBKCS111
00123 ***************************************************************** MBKCS111
00124                                                                   MBKCS111
00125          10  INTER-APPL-COMM-AREA       PIC X(200).               MBKCS111
00126                                                                      CL*32
00127      COPY MBWS005.                                                   CL200
00128                                                                   MBKCS111
00129 ***************************************************************** MBKCS111
00130 *    APPLICATION SPECIFIC COMMAREA                                   CL154
00131 ***************************************************************** MBKCS111
00132                                                                   MBKCS111
00133      COPY MBWS008.                                                   CL200
00134                                                                      CL187
00135 *****************************************************************    CL187
00136 *    LAYOUT FOR TEMP STG QUEUE FOR PASSING DATA TO UPDATE PGM.       CL187
00137 *****************************************************************    CL187
00138                                                                      CL187
00139  01 TSQ-TEMP-STG-QUEUE.                                              CL187
00140      COPY MBWS003.                                                   CL200
00141                                                                      CL187
00142                                                                   MBKCS111
00143 ***************************************************************** MBKCS111
00144 *    ABEND PROCESSING COPYBOOK.                                   MBKCS111
00145 ***************************************************************** MBKCS111
00146                                                                   MBKCS111
00147      COPY DPWS013.                                                   CL200
00148                                                                   MBKCS111
00149 *****************************************************************    CL148
00150 *    NUMERIC FIELD EDIT ROUTINE WORKING STORAGE                      CL148
00151 *****************************************************************    CL148
00152                                                                      CL148
00153      COPY DPWS010I.                                                  CL148
00154                                                                      CL148
00155 ***************************************************************** MBKCS111
00156 *    ATTRIBUTE SETTINGS COPYBOOK.                                 MBKCS111
00157 ***************************************************************** MBKCS111
00158                                                                   MBKCS111
00159      COPY DPWS015.                                                MBKCS111
00160                                                                   MBKCS111
00161 ***************************************************************** MBKCS111
00162 *    CURRENT DATE AND TIME COPYBOOK.                              MBKCS111
00163 ***************************************************************** MBKCS111
00164                                                                   MBKCS111
00165      COPY DPWS017.                                                   CL*14
00166                                                                   MBKCS111
00167 ***************************************************************** MBKCS111
00168 *    TOGGLE FUNCTION KEY LINES COPYBOOK.                          MBKCS111
00169 ***************************************************************** MBKCS111
00170                                                                   MBKCS111
00171      COPY DPWS009.                                                   CL*14
00172                                                                   MBKCS111
00173 ***************************************************************** MBKCS111
00174 *    FUNCTION KEYS COPYBOOK.                                      MBKCS111
00175 ***************************************************************** MBKCS111
00176                                                                   MBKCS111
00177      COPY DPWS016.                                                   CL*14
00178                                                                   MBKCS111
00179 ***************************************************************** MBKCS111
00180 *    DPKUT045 COPYBOOK.                                           MBKCS111
00181 ***************************************************************** MBKCS111
00182                                                                   MBKCS111
00183      COPY DPWS045.                                                   CL*14
00182                                                                   MBKCS111
00183      COPY DPWS006.                                                   CL*14
00184                                                                      CL*75
00185      COPY DPRD507I.                                                  CL*76
00186  EJECT                                                               CL*50
00187                                                                   MBKCS111
00188 ***************************************************************** MBKCS111
00189 *    STANDARD ATTENTION IDENTIFIER LIST                           MBKCS111
00190 ***************************************************************** MBKCS111
00191                                                                   MBKCS111
00192      COPY DFHAID.                                                 MBKCS111
00193                                                                   MBKCS111
00194 ***************************************************************** MBKCS111
00195 *    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        MBKCS111
00196 ***************************************************************** MBKCS111
00197                                                                   MBKCS111
00198      COPY DFHBMSCA.                                               MBKCS111
00199                                                                   MBKCS111
00200 *****************************************************************    CL170
00201 *    DB2 COMMUNICATION AREA.                                         CL170
00202 *****************************************************************    CL170
00203                                                                      CL170
00204      EXEC SQL                                                        CL170
00205           INCLUDE SQLCA                                              CL170
00206      END-EXEC.                                                       CL170
00207                                                                      CL170
00208 *****************************************************************    CL170
00209 *    MERCHANDISE AREA DCLGEN                                         CL170
00210 *****************************************************************    CL170
00211                                                                      CL170
00212      EXEC SQL                                                        CL170
00213           INCLUDE TMDSEAR                                            CL170
00214      END-EXEC.                                                       CL170
00215                                                                      CL170
00216 ***************************************************************** MBKCS111
00217 *    MAP LAYOUT                                                   MBKCS111
00218 ***************************************************************** MBKCS111
00219                                                                   MBKCS111
00220      COPY MBKM111.                                                   CL120
00221                                                                      CL**6
00222  01  MD-MAP-DATA-AREA REDEFINES MB111AO.                             CL120
00223      05  FILLER                         PIC X(426).                  CL151
00224  EJECT                                                            MBKCS111
00225  LINKAGE SECTION.                                                 MBKCS111
00226                                                                   MBKCS111
00227  01  DFHCOMMAREA.                                                    CL*27
00228      05  FILLER                         OCCURS  1 TO 4072 TIMES      CL*27
00229                                         DEPENDING ON EIBCALEN.       CL*27
00230          10  FILLER                     PIC X.                       CL*27
00231                                                                      CL*27
00232 *                                                                 MBKCS111
00233 *                                                                 MBKCS111
00234 *                                                                 MBKCS111
00235  PROCEDURE DIVISION.                                              MBKCS111
00236                                                                   MBKCS111
00237  0000-MAIN-MODULE.                                                   CL**8
00238                                                                   MBKCS111
00239 ******************************************************************MBKCS111
00240 *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           MBKCS111
00241 ******************************************************************MBKCS111
00242                                                                   MBKCS111
00243      PERFORM DP015-0000-CHECK-COMMAREA.                           MBKCS111
00244                                                                   MBKCS111
00245 ******************************************************************   CL**8
00246 *    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS     CL**8
00247 *    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER        CL**8
00248 *    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS         CL**8
00249 *    PROGRAM WILL RETURN TO CISS.                                    CL**8
00250 ******************************************************************   CL**8
00251      IF DP020-SRC-RETURN-W-TRAN-ID                                MBKCS111
00252          PERFORM 1000-CONTROL-PROCESSING                             CL*11
00253      END-IF.                                                      MBKCS111
00254                                                                   MBKCS111
00255      PERFORM DP003-0000-RETURN-TO-CICS.                           MBKCS111
00256  EJECT                                                            MBKCS111
00257  1000-CONTROL-PROCESSING.                                            CL**8
00258                                                                   MBKCS111
00259 ******************************************************************MBKCS111
00260 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    MBKCS111
00261 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                    MBKCS111
00262 *                                                                 MBKCS111
00263 *    PERFORMED BY 0000-MAIN-MODULE.                                  CL**8
00264 ******************************************************************MBKCS111
00265                                                                      CL**3
00266      EVALUATE TRUE                                                MBKCS111
00267                                                                   MBKCS111
00268          WHEN DP020-NEXT-ACT-INITIAL                              MBKCS111
00269              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL**3
00270                                                                   MBKCS111
00271              PERFORM 1100-INITIALIZE-COMMAREA                        CL**8
00272              PERFORM 5100-SAVE-INITIAL-INTERAPPL                     CL*41
00273              PERFORM 2000-BUILD-INITIAL-PANEL                        CL*37
00274                                                                   MBKCS111
00275          WHEN DP020-NEXT-ACT-READ-MAP                             MBKCS111
00276              PERFORM 3000-PROCESS-PANEL                              CL*10
00277                                                                      CL**3
00278          WHEN DP020-NEXT-ACT-RETURN                                  CL**3
00279              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL**3
00280              PERFORM 4000-DISPLAY-PANEL                              CL*20
00281                                                                      CL**3
00282          WHEN DP020-NEXT-ACT-ERROR                                MBKCS111
00283              MOVE DP020-MSG-MESSAGE       TO PV-MESSAGE              CL*42
00284                                                                      CL*21
00285              IF DP020-NAV-MNEMONIC = SPACES                          CL*15
00286                  MOVE SPACES              TO ANAVCMDO                CL*34
00287                  MOVE DP015-GREEN         TO ANAVCMDC                CL*34
00288                  MOVE DP015-UNDERLINE     TO ANAVCMDH                CL*34
00289              ELSE                                                    CL*15
00290                  MOVE DP015-RED           TO ANAVCMDC                CL*34
00291                  MOVE DP015-REVERSE       TO ANAVCMDH                CL*34
00292              END-IF                                                  CL*16
00293                                                                      CL**4
00294              SET PS-ERROR                 TO TRUE                    CL*38
00295              SET PS-SEND-DATA-ONLY-FRSET  TO TRUE                    CL*38
00296                                                                      CL124
00297                                                                      CL*38
00298              MOVE PV-MESSAGE              TO DP020-MSG-MESSAGE       CL**4
00299              MOVE -1                      TO ANAVCMDL                CL**4
00300                                                                      CL131
00301              MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA           CL131
00302              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL131
00303                                                                      CL**4
00304              PERFORM 4000-DISPLAY-PANEL                              CL*20
00305                                                                      CL**4
00306          WHEN OTHER                                               MBKCS111
00307              SET DP013-LOGIC-ABEND        TO TRUE                    CL*34
00308              SET DP013-NO-ROLLBACK        TO TRUE                    CL*34
00309                                                                   MBKCS111
00310              MOVE 'B100-CONTROL-PROCESSING' TO                    MBKCS111
00311                   DP013-PARAGRAPH                                 MBKCS111
00312                                                                      CL**4
00313              MOVE PM-PROGRAM-MESSAGE-1      TO                       CL**3
00314                   DP013-MESSAGE-TEXT(1)                           MBKCS111
00315                                                                   MBKCS111
00316              PERFORM DP013-0000-PROCESS-ABEND                     MBKCS111
00317                                                                   MBKCS111
00318      END-EVALUATE.                                                MBKCS111
00319  EJECT                                                            MBKCS111
00320  1100-INITIALIZE-COMMAREA.                                           CL*20
00321                                                                      CL*20
00322 ******************************************************************   CL*20
00323 *    INITIALIZE THE INTER APPLICATION COMMAREA AND THE               CL*20
00324 *    APPLICATION SPECIFIC COMMAREA.                                  CL*20
00325 *                                                                    CL*20
00326 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL*20
00327 *    PERFORMED BY D200-CHECK-FUNCTION-KEY.                           CL*20
00328 ******************************************************************   CL*20
00329                                                                      CL*20
00330      MOVE LOW-VALUES            TO DP020-INTER-APPL-DATA-AREA.       CL*57
00331      MOVE PC-OPER-COMPANY       TO MB008-CO-NUMBER-X.                CL103
00332      MOVE SPACES                TO MB008-GMA-NUMBER-X                CL103
00333                                    MB008-DMA-NUMBER-X                CL103
00334                                    MB008-DEPT-NUMBER-X.              CL104
00335                                                                      CL*20
00336  EJECT                                                               CL*20
00337  2000-BUILD-INITIAL-PANEL.                                           CL*37
00338                                                                   MBKCS111
00339 ******************************************************************MBKCS111
00340 *    PERFORMED ON THE FIRST PASS IF THIS PROGRAM                     CL*38
00341 *                                                                 MBKCS111
00342 *    PERFORMED BY B100-CONTROL-PROCESSING.                        MBKCS111
00343 ******************************************************************MBKCS111
00344                                                                      CL*53
00345                                                                      CL*38
00346      MOVE PC-HISTORY-DEFAULT TO MB008-HISTORY-FLAG.                  CL154
00347                                                                      CL152
00348      PERFORM 4000-DISPLAY-PANEL.                                     CL*38
00349  EJECT                                                               CL*37
00350  3000-PROCESS-PANEL.                                                 CL*37
00351                                                                      CL*37
00352 ******************************************************************   CL*37
00353 *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED     CL*37
00354 *    ON WHAT FUNCTION KEY WAS SELECTED.                              CL*37
00355 *                                                                    CL*37
00356 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL*37
00357 ******************************************************************   CL*37
00358                                                                      CL*37
00359      SET PS-SEND-DATA-ONLY-FRSET TO TRUE                          MBKCS111
00360                                                                   MBKCS111
00361      PERFORM DP007-0000-GET-PANEL.                                   CL**5
00362                                                                      CL**5
00363      IF (DP020-SRC-AID NOT = DP016-PF5)  AND                         CL**5
00364         (DP020-SRC-AID NOT = DP016-CLEAR)                            CL**5
00365          PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                        CL*10
00366      END-IF.                                                         CL**5
00367                                                                      CL**5
00368      PERFORM 3100-CHECK-LOCAL-FKEYS.                                 CL*10
00369  EJECT                                                            MBKCS111
00370                                                                      CL152
00371  3100-CHECK-LOCAL-FKEYS.                                             CL*20
00372                                                                      CL*10
00373 ******************************************************************   CL*10
00374 *    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION       CL*10
00375 *    KEY THE USER HIT.                                               CL*10
00376 *                                                                    CL*10
00377 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*10
00378 ******************************************************************   CL*10
00379                                                                      CL*10
00380      EVALUATE TRUE                                                   CL*10
00381                                                                      CL*10
00382          WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID) OR                  CL*98
00383               DP020-FK-RETURN(DP020-SRC-AID)                         CL*99
00384               PERFORM 5000-SETUP-INTER-APPL                          CL*60
00385               PERFORM DP015-1000-START-NAVIGATOR                     CL*60
00386                                                                      CL*60
00387          WHEN  DP020-FK-EDIT-GOTO(DP020-SRC-AID)                     CL*98
00388                                                                      CL163
00389                PERFORM 3300-EDIT-DATA-IN-COMMAREA                    CL*92
00390                                                                      CL163
00391                IF PS-NO-ERROR                                        CL*92
00392                   IF (DP020-SRC-AID = DP016-PF14) OR                 CL163
00393                      (DP020-SRC-AID = DP016-PF15)                    CL195
00394                      PERFORM 3325-INQUIRY-UPDATE-EDITS               CL169
00395 *                 ELSE                                               CL197
00396 *                    IF (DP020-SRC-AID = DP016-PF20)                 CL197
00397 *                       PERFORM 3350-LIST-PROCESS-EDITS              CL195
00398 *                    END-IF                                          CL197
00399                   END-IF                                             CL163
00400                END-IF                                                CL163
00401                                                                      CL163
00402                IF PS-NO-ERROR                                        CL163
00403                    PERFORM 5000-SETUP-INTER-APPL                     CL*92
00404                    PERFORM DP015-1000-START-NAVIGATOR                CL*92
00405                ELSE                                                  CL*92
00406                    PERFORM 4100-MOVE-COMMAREA-TO-SCREEN              CL100
00407                    PERFORM 4000-DISPLAY-PANEL                        CL*92
00408                END-IF                                                CL*92
00409                                                                      CL*32
00410          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                        CL*32
00411              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL*35
00412              INITIALIZE ANAVCMDO ANAVKEYO                            CL129
00413              PERFORM 1100-INITIALIZE-COMMAREA                        CL*32
00414              MOVE SPACES TO DP020-NAV-KEY-DATA                       CL124
00415              PERFORM 2000-BUILD-INITIAL-PANEL                        CL*58
00416                                                                      CL*32
00417          WHEN DP020-SRC-AID = DP016-ENTER                            CL*10
00418              IF (DP020-NAV-MNEMONIC = SPACES)     OR                 CL*10
00419                 (DP020-NAV-MNEMONIC = LOW-VALUES)                    CL*10
00420                  PERFORM 3300-EDIT-DATA-IN-COMMAREA                  CL*81
00421                  PERFORM 4100-MOVE-COMMAREA-TO-SCREEN                CL*83
00422                  PERFORM 4000-DISPLAY-PANEL                          CL*52
00423              ELSE                                                    CL*10
00424                  MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA       CL185
00425                  PERFORM DP015-1000-START-NAVIGATOR                  CL*10
00426              END-IF                                                  CL*10
00427                                                                      CL*10
00428          WHEN DP020-SRC-AID = DP016-PA2                              CL*33
00429              SET PS-SEND-DATA-ONLY TO TRUE                           CL*33
00430              MOVE -1               TO ANAVCMDL                       CL*33
00431              PERFORM DP017-0000-GET-CURR-DATE-TIME                   CL*79
00432              PERFORM DP009-0000-LOAD-FK-LINES                        CL*79
00433              PERFORM DP008-0000-WRITE-PANEL                          CL*79
00434                                                                      CL*33
00435          WHEN DP020-SRC-AID = DP016-CLEAR                            CL*33
00436              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL*35
00437              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL*33
00438              PERFORM 4000-DISPLAY-PANEL                              CL*33
00439                                                                      CL*33
00440          WHEN OTHER                                                  CL*33
00441              PERFORM 3300-EDIT-DATA-IN-COMMAREA                      CL*37
00442              MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER                CL106
00443              SET DP020-MSG-FATAL  TO TRUE                            CL106
00444              PERFORM 4000-DISPLAY-PANEL                              CL*37
00445                                                                      CL*10
00446      END-EVALUATE.                                                   CL*10
00447  EJECT                                                               CL*10
00448                                                                      CL154
00449  3150-RESET-SCREEN-ATTRIB.                                           CL154
00450                                                                      CL154
00451      MOVE DP015-GREEN     TO AGMAC                                   CL154
00452                              ADMAC                                   CL154
00453                              ADEPTC                                  CL154
00454                              AHISTRYC.                               CL154
00455      MOVE DP015-UNDERLINE TO AGMAH                                   CL154
00456                              ADMAH                                   CL154
00457                              ADEPTH                                  CL154
00458                              AHISTRYH.                               CL154
00459                                                                      CL154
00460  3200-MOVE-SCREEN-TO-COMMAREA.                                       CL*20
00461                                                                   MBKCS111
00462 ******************************************************************MBKCS111
00463 *    MOVE THE FIELDS FROM THE MAP TO THE COMMAREA IF ANYTHING        CL*20
00464 *    WAS ENTERED IN THAT FIELD.                                      CL*20
00465 *                                                                    CL*20
00466 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*11
00467 ******************************************************************MBKCS111
00468                                                                   MBKCS111
00469      IF AGMAL > 0                                                    CL*33
00470         MOVE AGMAI                  TO MB008-GMA-NUMBER-X            CL103
00471      ELSE                                                            CL**5
00472         IF AGMAA = PC-ERASE-EOF                                      CL*30
00473            MOVE SPACES              TO MB008-GMA-NUMBER-X            CL103
00474         END-IF                                                       CL*30
00475      END-IF.                                                         CL**5
00476                                                                      CL*33
00477      IF ADMAL > 0                                                    CL*33
00478         MOVE ADMAI                  TO MB008-DMA-NUMBER-X            CL103
00479      ELSE                                                            CL*33
00480         IF ADMAA = PC-ERASE-EOF                                      CL*30
00481            MOVE SPACES              TO MB008-DMA-NUMBER-X            CL103
00482         END-IF                                                       CL106
00483      END-IF.                                                         CL*33
00484                                                                      CL*33
00485      IF ADEPTL > 0                                                   CL*33
00486         MOVE ADEPTI                  TO MB008-DEPT-NUMBER-X          CL103
00487      ELSE                                                            CL*30
00488         IF ADEPTA = PC-ERASE-EOF                                     CL*30
00489            MOVE SPACES               TO MB008-DEPT-NUMBER-X          CL103
00490         END-IF                                                       CL*30
00491      END-IF.                                                         CL*33
00492                                                                      CL179
00493      IF AHISTRYL > 0                                                 CL179
00494         MOVE AHISTRYI                TO MB008-HISTORY-FLAG           CL179
00495      ELSE                                                            CL179
00496         IF AHISTRYA = PC-ERASE-EOF                                   CL179
00497            MOVE SPACES               TO MB008-HISTORY-FLAG           CL179
00498         END-IF                                                       CL179
00499      END-IF.                                                         CL179
00500                                                                      CL*33
00501                                                                      CL*33
00502  EJECT                                                            MBKCS111
00503  3300-EDIT-DATA-IN-COMMAREA.                                         CL*10
00504                                                                      CL**5
00505 ******************************************************************   CL**5
00506 *    EDIT THE GMA, DMA, DEPARTMENT,                                  CL103
00507 *    IN ORDER TO BE VALID, ANY AND OR ALL OF THE ABOVE MUST          CL**3
00508 *    CONTAIN NUMERIC VALUES, AN '*', OR BE SPACES.                   CL*38
00509 *                                                                    CL*20
00510 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL*10
00511 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*10
00512 *    PERFORMED BY 3100-CHECK-LOCAL-FKEYS.                            CL*10
00513 ******************************************************************   CL**5
00514                                                                      CL**5
00515      IF NOT DP020-NEXT-ACT-ERROR                                     CL*59
00516         SET PS-NO-ERROR   TO TRUE                                    CL130
00517         MOVE DP015-GREEN  TO ANAVCMDC                                CL130
00518                              ANAVKEYC                                CL130
00519         MOVE DP015-UNDERLINE TO ANAVKEYH                             CL130
00520                                 ANAVCMDH                             CL130
00521      END-IF.                                                         CL*59
00522                                                                      CL*26
00523      PERFORM 3150-RESET-SCREEN-ATTRIB.                               CL154
00524                                                                      CL156
00525      PERFORM 3400-EDIT-GMA-NUMBER.                                   CL143
00526                                                                      CL142
00527      PERFORM 3410-EDIT-DMA-NUMBER.                                   CL143
00528                                                                      CL*38
00529      PERFORM 3420-EDIT-DPT-NUMBER.                                   CL143
00530                                                                      CL*26
00531      PERFORM 3600-EDIT-FOR-SPACES.                                   CL146
00532                                                                      CL157
00533      PERFORM 3430-EDIT-HIST-FLAG.                                    CL157
00534                                                                      CL*70
00535      IF (DP020-NAV-MNEMONIC = SPACES OR                              CL127
00536          DP020-NAV-MNEMONIC = LOW-VALUES) AND                        CL127
00537         (DP020-NAV-KEY-DATA > SPACES)                                CL127
00538          MOVE DP015-RED       TO ANAVKEYC                            CL124
00539          MOVE DP015-REVERSE   TO ANAVKEYH                            CL124
00540          IF PS-NO-ERROR                                              CL124
00541              MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                CL124
00542              MOVE -1              TO ANAVKEYL                        CL124
00543              SET DP020-MSG-FATAL  TO TRUE                            CL125
00544              SET PS-ERROR         TO TRUE                            CL128
00545          END-IF                                                      CL124
00546      END-IF.                                                         CL124
00547  EJECT                                                               CL**5
00548  3325-INQUIRY-UPDATE-EDITS.                                          CL164
00549 ******************************************************************   CL164
00550 *                                                                    CL164
00551 *                                                                    CL164
00552 *                                                                    CL164
00553 *                                                                    CL164
00554 ******************************************************************   CL164
00555                                                                      CL164
00556      IF MB008-HISTORY-FLAG = 'Y'                                     CL164
00557         MOVE DP015-RED          TO AHISTRYC                          CL174
00558         MOVE DP015-REVERSE      TO AHISTRYH                          CL174
00559         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER                  CL164
00560         MOVE -1                 TO AHISTRYL                          CL174
00561         SET DP020-MSG-FATAL                                          CL164
00562             PS-ERROR            TO TRUE                              CL164
00563      END-IF.                                                         CL164
00564                                                                      CL164
00565                                                                      CL169
00566      IF MB008-DEPT-NUMBER-X = SPACES                                 CL182
00567         MOVE DP015-RED          TO ADEPTC                            CL169
00568         MOVE DP015-REVERSE      TO ADEPTH                            CL169
00569         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER                  CL169
00570         MOVE -1                 TO ADEPTL                            CL169
00571         SET DP020-MSG-FATAL                                          CL169
00572             PS-ERROR            TO TRUE                              CL169
00573      END-IF.                                                         CL169
00574                                                                      CL169
00575      PERFORM 3440-CHECK-ALL-FIELDS.                                  CL182
00576                                                                      CL164
00577      IF PS-NO-ERROR                                                  CL164
00578         PERFORM 3520-VALIDATE-DPT                                    CL169
00579      END-IF.                                                         CL164
00580      EJECT                                                           CL169
00581                                                                      CL169
00582  3350-LIST-PROCESS-EDITS.                                            CL169
00583 ******************************************************************   CL169
00584 *                                                                    CL169
00585 *                                                                    CL169
00586 *                                                                    CL169
00587 *                                                                    CL169
00588 ******************************************************************   CL169
00589                                                                      CL169
00590      IF MB008-DMA-NUMBER-X = SPACES                                  CL178
00591         MOVE DP015-RED          TO ADMAC                             CL169
00592         MOVE DP015-REVERSE      TO ADMAH                             CL169
00593         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER                  CL169
00594         MOVE -1                 TO ADMAL                             CL169
00595         SET DP020-MSG-FATAL                                          CL169
00596             PS-ERROR            TO TRUE                              CL169
00597      END-IF.                                                         CL169
00598                                                                      CL169
00599      IF MB008-GMA-NUMBER-X = SPACES                                  CL178
00600         MOVE DP015-RED          TO AGMAC                             CL169
00601         MOVE DP015-REVERSE      TO AGMAH                             CL169
00602         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER                  CL169
00603         MOVE -1                 TO AGMAL                             CL169
00604         SET DP020-MSG-FATAL                                          CL169
00605             PS-ERROR            TO TRUE                              CL169
00606      END-IF.                                                         CL169
00607                                                                      CL169
00608                                                                      CL142
00609  3400-EDIT-GMA-NUMBER.                                               CL143
00610 ******************************************************************   CL142
00611 *                                                                    CL142
00612 *                                                                    CL142
00613 *                                                                    CL142
00614 *                                                                    CL142
00615 ******************************************************************   CL142
00616                                                                      CL142
00617      IF MB008-GMA-NUMBER-X = SPACES                                  CL142
00618         CONTINUE                                                     CL142
00619      ELSE                                                            CL142
00620         IF MB008-ALL-GMAS                                            CL142
00621            MOVE '**'                  TO MB008-GMA-NUMBER-X          CL142
00622         ELSE                                                         CL142
00623            MOVE MB008-GMA-NUMBER-X    TO DP010I-UNEDITED-FIELD       CL144
00624            MOVE +2                    TO DP010I-MAXIMUM-DIGITS       CL144
00625            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   CL144
262978           CALL DP010I-NUMERIC-EDIT-ROUTINE                               
262978                USING DP010I-NUMERIC-EDIT-AREA                            
00627            IF DP010I-ERROR-DETECTED                                  CL144
00628               MOVE DP015-RED          TO AGMAC                       CL142
00629               MOVE DP015-REVERSE      TO AGMAH                       CL142
00630               IF PS-NO-ERROR                                         CL142
00631                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL142
00632                  MOVE -1                   TO AGMAL                  CL142
00633                  SET DP020-MSG-FATAL       TO TRUE                   CL142
00634                  SET PS-ERROR              TO TRUE                   CL142
00635               END-IF                                                 CL142
00636            ELSE                                                      CL142
00637               MOVE DP010I-NUMERIC-FIELD    TO MB008-GMA-NUMBER       CL144
00638               SET PS-SPECIF-GMA            TO TRUE                   CL142
00639               IF MB008-GMA-NUMBER-X = '00'                           CL142
00640                   MOVE DP015-RED      TO AGMAC                       CL142
00641                   MOVE DP015-REVERSE  TO AGMAH                       CL142
00642                   IF PS-NO-ERROR                                     CL142
00643                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL142
00644                      MOVE -1               TO AGMAL                  CL142
00645                      SET DP020-MSG-FATAL   TO TRUE                   CL142
00646                      SET PS-ERROR          TO TRUE                   CL142
00647                   END-IF                                             CL142
00648               END-IF                                                 CL142
00649            END-IF                                                    CL142
00650         END-IF                                                       CL142
00651      END-IF.                                                         CL142
00652      EJECT                                                           CL143
00653                                                                      CL143
00654  3410-EDIT-DMA-NUMBER.                                               CL143
00655 ******************************************************************   CL143
00656 *                                                                    CL143
00657 *                                                                    CL143
00658 *                                                                    CL143
00659 *                                                                    CL143
00660 ******************************************************************   CL143
00661      IF MB008-DMA-NUMBER-X = SPACES                                  CL143
00662         CONTINUE                                                     CL143
00663      ELSE                                                            CL143
00664         IF MB008-ALL-DMAS                                            CL143
00665            MOVE '**'                       TO MB008-DMA-NUMBER-X     CL143
00666         ELSE                                                         CL143
00667            MOVE MB008-DMA-NUMBER-X      TO DP010I-UNEDITED-FIELD     CL149
00668            MOVE +2                      TO DP010I-MAXIMUM-DIGITS     CL149
00669            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   CL145
262978           CALL DP010I-NUMERIC-EDIT-ROUTINE                               
262978                USING DP010I-NUMERIC-EDIT-AREA                            
00671            IF DP010I-ERROR-DETECTED                                  CL145
00672               MOVE DP015-RED               TO ADMAC                  CL143
00673               MOVE DP015-REVERSE           TO ADMAH                  CL143
00674               IF PS-NO-ERROR                                         CL143
00675                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL143
00676                  MOVE -1                   TO ADMAL                  CL143
00677                  SET DP020-MSG-FATAL       TO TRUE                   CL143
00678                  SET PS-ERROR              TO TRUE                   CL143
00679               END-IF                                                 CL143
00680            ELSE                                                      CL143
00681               MOVE DP010I-NUMERIC-FIELD TO MB008-DMA-NUMBER          CL149
00682               SET PS-SPECIF-DMA       TO TRUE                        CL143
00683               IF MB008-DMA-NUMBER-X = '00'                           CL143
00684                   MOVE DP015-RED           TO ADMAC                  CL143
00685                   MOVE DP015-REVERSE       TO ADMAH                  CL143
00686                   IF PS-NO-ERROR                                     CL143
00687                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL143
00688                      MOVE -1               TO ADMAL                  CL143
00689                      SET DP020-MSG-FATAL   TO TRUE                   CL143
00690                      SET PS-ERROR          TO TRUE                   CL143
00691                   END-IF                                             CL143
00692               END-IF                                                 CL143
00693            END-IF                                                    CL143
00694         END-IF                                                       CL143
00695      END-IF.                                                         CL143
00696      EJECT                                                           CL143
00697                                                                      CL143
00698                                                                      CL143
00699  3420-EDIT-DPT-NUMBER.                                               CL143
00700 ******************************************************************   CL143
00701 *                                                                    CL143
00702 *                                                                    CL143
00703 *                                                                    CL143
00704 *                                                                    CL143
00705 ******************************************************************   CL143
00706      IF MB008-DEPT-NUMBER-X = SPACES                                 CL143
00707         CONTINUE                                                     CL143
00708      ELSE                                                            CL143
00709         IF MB008-ALL-DEPARTMENTS                                     CL143
00710            MOVE '***'                 TO MB008-DEPT-NUMBER-X         CL143
00711         ELSE                                                         CL143
00712            MOVE MB008-DEPT-NUMBER-X   TO DP010I-UNEDITED-FIELD       CL150
00713            MOVE +3                    TO DP010I-MAXIMUM-DIGITS       CL145
00714            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   CL145
262978           CALL DP010I-NUMERIC-EDIT-ROUTINE                               
262978                USING DP010I-NUMERIC-EDIT-AREA                            
00716            IF DP010I-ERROR-DETECTED                                  CL145
00717               MOVE DP015-RED          TO ADEPTC                      CL143
00718               MOVE DP015-REVERSE      TO ADEPTH                      CL143
00719               IF PS-NO-ERROR                                         CL143
00720                  MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER       CL143
00721                  MOVE -1                   TO ADEPTL                 CL143
00722                  SET DP020-MSG-FATAL       TO TRUE                   CL143
00723                  SET PS-ERROR              TO TRUE                   CL143
00724               END-IF                                                 CL143
00725            ELSE                                                      CL143
00726               MOVE DP010I-NUMERIC-FIELD    TO MB008-DEPT-NUMBER      CL145
00727               SET PS-SPECIF-DPT            TO TRUE                   CL143
00728               IF MB008-DEPT-NUMBER-X = '000'                         CL143
00729                   MOVE DP015-RED      TO ADEPTC                      CL143
00730                   MOVE DP015-REVERSE  TO ADEPTH                      CL143
00731                   IF PS-NO-ERROR                                     CL143
00732                      MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER       CL143
00733                      MOVE -1               TO ADEPTL                 CL143
00734                      SET DP020-MSG-FATAL   TO TRUE                   CL143
00735                      SET PS-ERROR          TO TRUE                   CL143
00736                   END-IF                                             CL143
00737               END-IF                                                 CL143
00738            END-IF                                                    CL143
00739         END-IF                                                       CL143
00740      END-IF.                                                         CL143
00741      EJECT                                                           CL143
00742                                                                      CL156
00743  3430-EDIT-HIST-FLAG.                                                CL159
00744 ******************************************************************   CL156
00745 *                                                                    CL156
00746 *                                                                    CL156
00747 ******************************************************************   CL156
00748                                                                      CL156
00749      IF NOT MB008-VALID-HIST-VALUES                                  CL160
00750         MOVE DP015-RED      TO AHISTRYC                              CL156
00751         MOVE DP015-REVERSE  TO AHISTRYH                              CL156
00752         IF PS-NO-ERROR                                               CL156
00753            MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER                 CL156
00754            MOVE -1               TO AHISTRYL                         CL156
00755            SET DP020-MSG-FATAL   TO TRUE                             CL156
00756            SET PS-ERROR          TO TRUE                             CL156
00757         END-IF                                                       CL156
00758      END-IF.                                                         CL160
00759                                                                      CL164
00760  3440-CHECK-ALL-FIELDS.                                              CL173
00761 ******************************************************************   CL164
00762 *                                                                    CL164
00763 *                                                                    CL164
00764 ******************************************************************   CL164
00765      IF MB008-ALL-DEPARTMENTS                                        CL164
00766          MOVE DP015-RED          TO ADEPTC                           CL164
00767          MOVE DP015-REVERSE      TO ADEPTH                           CL164
00768          MOVE PC-TSYMSG-00137 TO DP020-MSG-NUMBER                    CL164
00769          MOVE -1                  TO ADEPTL                          CL164
00770          SET DP020-MSG-FATAL      TO TRUE                            CL164
00771          SET PS-ERROR             TO TRUE                            CL164
00772      END-IF.                                                         CL164
00773                                                                      CL164
00774      IF  MB008-ALL-DMAS                                              CL199
00775          MOVE DP015-RED      TO ADMAC                                CL164
00776          MOVE DP015-REVERSE  TO ADMAH                                CL164
00777          MOVE PC-TSYMSG-00137 TO DP020-MSG-NUMBER                    CL164
00778          MOVE -1              TO ADMAL                               CL164
00779          SET DP020-MSG-FATAL  TO TRUE                                CL164
00780          SET PS-ERROR         TO TRUE                                CL164
00781      END-IF.                                                         CL164
00782                                                                      CL164
00783      IF  MB008-ALL-GMAS                                              CL199
00784          MOVE DP015-RED   TO AGMAC                                   CL164
00785          MOVE DP015-REVERSE TO AGMAH                                 CL164
00786          MOVE PC-TSYMSG-00137 TO DP020-MSG-NUMBER                    CL164
00787          MOVE -1           TO AGMAL                                  CL164
00788          SET DP020-MSG-FATAL TO TRUE                                 CL164
00789          SET PS-ERROR      TO TRUE                                   CL164
00790      END-IF.                                                         CL164
00791                                                                      CL143
00792      IF  MB008-DMA-NUMBER-X EQUAL SPACES                             CL199
00793          MOVE DP015-RED      TO ADMAC                                CL199
00794          MOVE DP015-REVERSE  TO ADMAH                                CL199
00795          MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                    CL199
00796          MOVE -1              TO ADMAL                               CL199
00797          SET DP020-MSG-FATAL  TO TRUE                                CL199
00798          SET PS-ERROR         TO TRUE                                CL199
00799      END-IF.                                                         CL199
00800                                                                      CL199
00801      IF  MB008-GMA-NUMBER-X EQUAL SPACES                             CL199
00802          MOVE DP015-RED   TO AGMAC                                   CL199
00803          MOVE DP015-REVERSE TO AGMAH                                 CL199
00804          MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                    CL199
00805          MOVE -1           TO AGMAL                                  CL199
00806          SET DP020-MSG-FATAL TO TRUE                                 CL199
00807          SET PS-ERROR      TO TRUE                                   CL199
00808      END-IF.                                                         CL199
00809                                                                      CL199
00810  3520-VALIDATE-DPT.                                                  CL164
00811 ******************************************************************   CL164
00812 *                                                                    CL164
00813 *                                                                    CL164
00814 *                                                                    CL164
00815 *                                                                    CL164
00816 ******************************************************************   CL164
00817                                                                      CL164
00818      PERFORM 3525-GET-DPT-DB2.                                       CL164
00819                                                                      CL164
00820      IF PS-ROW-FOUND                                                 CL164
00821          IF (MDSEAR-DMA-NBR NOT = MB008-DMA-NUMBER) AND              CL166
00822             (PS-SPECIF-DMA)                                          CL164
00823                                                                      CL164
00824 ********  DEPT DOES NOT EXIST WITHIN DMA                             CL169
00825                                                                      CL164
00826              MOVE PC-TSYMSG-00077 TO DP020-MSG-NUMBER                CL164
00827              MOVE DP015-RED       TO ADEPTC                          CL164
00828              MOVE DP015-REVERSE   TO ADEPTH                          CL164
00829              MOVE -1              TO ADEPTL                          CL164
00830              SET DP020-MSG-FATAL                                     CL164
00831                  PS-ERROR         TO TRUE                            CL164
00832          ELSE                                                        CL164
00833              IF (MDSEAR-GMA-NBR NOT = MB008-GMA-NUMBER) AND          CL166
00834                 (PS-SPECIF-GMA)                                      CL164
00835                                                                      CL164
00836 ********  DEPT DOES NOT EXIST WITHIN GMA                             CL169
00837                                                                      CL164
00838                  MOVE PC-TSYMSG-00081 TO DP020-MSG-NUMBER            CL164
00839                  MOVE DP015-RED       TO ADEPTC                      CL164
00840                  MOVE DP015-REVERSE   TO ADEPTH                      CL164
00841                  MOVE -1              TO ADEPTL                      CL164
00842                  SET DP020-MSG-FATAL                                 CL164
00843                      PS-ERROR         TO TRUE                        CL164
00844              ELSE                                                    CL192
00845                 MOVE MDSEAR-GMA-NBR TO MB008-GMA-NUMBER-X            CL192
00846                 MOVE MDSEAR-DMA-NBR TO MB008-DMA-NUMBER-X            CL192
00847              END-IF                                                  CL192
00848          END-IF                                                      CL164
00849      ELSE                                                            CL164
00850 *******   DEPT DOES NOT EXIST                                        CL169
00851          MOVE PC-TSYMSG-00032 TO DP020-MSG-NUMBER                    CL164
00852          MOVE DP015-RED       TO ADEPTC                              CL164
00853          MOVE DP015-REVERSE   TO ADEPTH                              CL164
00854          MOVE -1              TO ADEPTL                              CL164
00855          SET DP020-MSG-FATAL                                         CL164
00856              PS-ERROR         TO TRUE                                CL164
00857      END-IF.                                                         CL164
00858 *                                                                    CL195
00859 *    IF  MB008-GMA-NUMBER-X EQUAL SPACES                             CL195
00860 *        MOVE MDSEAR-GMA-NBR  TO  MB008-GMA-NUMBER-X                 CL195
00861 *    END-IF.                                                         CL195
00862 *                                                                    CL195
00863 *    IF  MB008-DMA-NUMBER-X EQUAL SPACES                             CL195
00864 *        MOVE MDSEAR-DMA-NBR  TO  MB008-DMA-NUMBER-X                 CL195
00865 *    END-IF.                                                         CL195
00866                                                                      CL195
00867      EJECT                                                           CL164
00868                                                                      CL164
00869  3525-GET-DPT-DB2.                                                   CL164
00870 ******************************************************************   CL165
00871 *                                                                    CL165
00872 *                                                                    CL165
00873 *                                                                    CL165
00874 *                                                                    CL165
00875 ******************************************************************   CL165
00876                                                                      CL143
00877      PERFORM WITH TEST AFTER                                         CL165
00878          VARYING PV-RETRY-COUNTER                                    CL165
00879          FROM 1 BY 1                                                 CL165
00880          UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)                 CL165
00881                  OR (SQLCODE = 0)                                    CL165
00882                  OR (SQLCODE = +100))                                CL165
00883                                                                      CL165
00884          EXEC SQL                                                    CL166
00885              SELECT GMA_NBR,                                         CL166
00886                     DMA_NBR,                                         CL166
00887                     DEPT_NBR                                         CL166
00888              INTO :MDSEAR-GMA-NBR,                                   CL166
00889                   :MDSEAR-DMA-NBR,                                   CL166
00890                   :MDSEAR-DEPT-NBR                                   CL166
00891              FROM TMDSEAR                                            CL166
00892              WHERE ((DEPT_NBR = :MB008-DEPT-NUMBER-X)  AND           CL166
00893                     (MDSELV_CDE = :DK-MDSELV-DPT) AND                CL171
00894                     (END_DTE    > DATE (CURRENT TIMESTAMP)))         CL173
00895          END-EXEC                                                    CL177
00896                                                                      CL165
00897                                                                      CL165
00898          EVALUATE TRUE                                               CL165
00899              WHEN SQLCODE = ZERO                                     CL165
00900                  SET PS-ROW-FOUND TO TRUE                            CL165
00901              WHEN SQLCODE = -904                                     CL165
00902              WHEN SQLCODE = -913                                     CL165
00903                   CONTINUE                                           CL165
00904              WHEN SQLCODE = +100                                     CL165
00905                  SET PS-ROW-NOT-FOUND TO TRUE                        CL165
00906              WHEN SQLWARN0 NOT = SPACES                              CL165
00907              WHEN SQLCODE < 0                                        CL165
00908              WHEN SQLCODE > 0                                        CL165
00909                  MOVE '3525-GET-DPT-DB2' TO                          CL165
00910                                           DP013-PARAGRAPH            CL165
00911                  MOVE 'SELECT DEPARTMENT ROW ' TO                    CL165
00912                                           DP013-MESSAGE-TEXT(1)      CL165
00913                  STRING 'DPT '  MB008-DEPT-NUMBER-X                  CL169
00914                         ' LEVEL ' DK-MDSELV-DPT                      CL177
00915                         DELIMITED BY SIZE                            CL165
00916                         INTO DP013-MESSAGE-TEXT(2)                   CL165
00917                  MOVE SQLCA TO DP013-SQLCA                           CL165
00918                  MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)           CL165
00919                  SET DP013-DB2-ABEND TO TRUE                         CL165
00920                  SET DP013-NO-ROLLBACK TO TRUE                       CL165
00921                  SET DP013-XCTL-DISPLAY-RESTART TO TRUE              CL165
00922                  PERFORM DP013-0000-PROCESS-ABEND                    CL165
00923          END-EVALUATE                                                CL165
00924      END-PERFORM.                                                    CL165
00925                                                                      CL165
00926                                                                      CL165
00927      IF PV-RETRY-COUNTER > PC-MAX-RETRIES                            CL165
00928          MOVE '3525-GET-DPT-DB2' TO DP013-PARAGRAPH                  CL165
00929          MOVE 'SELECT DEPARTMENT INFO' TO                            CL165
00930                                      DP013-MESSAGE-TEXT(1)           CL165
00931          MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                    CL165
00932                                      DP013-MESSAGE-TEXT(2)           CL165
00933          STRING 'DPT ' MB008-DEPT-NUMBER-X                           CL169
00934                 ' LEVEL ' DK-MDSELV-DPT                              CL177
00935                 DELIMITED BY SIZE                                    CL165
00936                 INTO DP013-MESSAGE-TEXT(3)                           CL165
00937          MOVE SQLCA TO DP013-SQLCA                                   CL165
00938          MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                   CL165
00939          SET DP013-DB2-ABEND TO TRUE                                 CL165
00940          SET DP013-NO-ROLLBACK TO TRUE                               CL165
00941          SET DP013-XCTL-DISPLAY-RESTART TO TRUE                      CL165
00942          PERFORM DP013-0000-PROCESS-ABEND                            CL165
00943      END-IF.                                                         CL165
00944      EJECT                                                           CL165
00945                                                                      CL167
00946  3600-EDIT-FOR-SPACES.                                               CL*71
00947                                                                      CL*70
00948 ******************************************************************   CL*70
00949 *    EDIT EACH SCREEN FIELD FOR SPACES. ENTRIES ARE NOT ALLOWED      CL*70
00950 *    IF A PREVIOUS FIELD IS SPACES.                                  CL*70
00951 *                                                                    CL*70
00952 *    PERFORMED BY 3300-EDIT-DATA-IN-COMMAREA                         CL*70
00953 ******************************************************************   CL*70
00954                                                                      CL*70
00955      IF (MB008-DEPT-NUMBER-X = SPACES AND                            CL112
00956          MB008-DMA-NUMBER-X = SPACES  AND                            CL112
00957          MB008-GMA-NUMBER-X = SPACES)                                CL112
00958          MOVE DP015-RED            TO ADMAC                          CL112
00959                                       AGMAC                          CL162
00960                                       ADEPTC                         CL162
00961          MOVE DP015-REVERSE        TO ADMAH                          CL112
00962                                       AGMAH                          CL162
00963                                       ADEPTH                         CL162
00964          IF PS-NO-ERROR                                              CL140
00965              MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER               CL140
00966              MOVE -1               TO AGMAL                          CL140
00967              SET DP020-MSG-FATAL   TO TRUE                           CL140
00968              SET PS-ERROR          TO TRUE                           CL140
00969          END-IF                                                      CL140
00970      END-IF.                                                         CL140
00971                                                                      CL112
00972      IF (MB008-DEPT-NUMBER-X = SPACES AND                            CL112
00973         (MB008-GMA-NUMBER-X = SPACES AND                             CL112
00974          MB008-DMA-NUMBER-X > SPACES))                               CL112
00975          MOVE DP015-RED            TO AGMAC                          CL112
00976          MOVE DP015-REVERSE        TO AGMAH                          CL112
00977          IF PS-NO-ERROR                                              CL140
00978              MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER               CL181
00979              MOVE -1               TO AGMAL                          CL140
00980              SET DP020-MSG-FATAL   TO TRUE                           CL140
00981              SET PS-ERROR          TO TRUE                           CL140
00982          END-IF                                                      CL140
00983      END-IF.                                                         CL140
00984                                                                      CL111
00985      IF (MB008-DEPT-NUMBER-X = SPACES AND                            CL112
00986         (MB008-DMA-NUMBER-X = SPACES AND                             CL112
00987          MB008-GMA-NUMBER-X > SPACES))                               CL112
00988          MOVE DP015-RED            TO ADMAC                          CL112
00989          MOVE DP015-REVERSE        TO ADMAH                          CL112
00990          IF PS-NO-ERROR                                              CL140
00991              MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER               CL181
00992              MOVE -1               TO ADMAL                          CL140
00993              SET DP020-MSG-FATAL   TO TRUE                           CL140
00994              SET PS-ERROR          TO TRUE                           CL140
00995          END-IF                                                      CL140
00996      END-IF.                                                         CL140
00997                                                                      CL116
00998      IF (MB008-DEPT-NUMBER-X > SPACES AND                            CL115
00999          MB008-GMA-NUMBER-X > SPACES AND                             CL116
01000          MB008-DMA-NUMBER-X = SPACES)                                CL116
01001          MOVE DP015-RED            TO ADMAC                          CL115
01002          MOVE DP015-REVERSE        TO ADMAH                          CL115
01003          IF PS-NO-ERROR                                              CL140
01004              MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER               CL181
01005              MOVE -1               TO ADMAL                          CL140
01006              SET DP020-MSG-FATAL   TO TRUE                           CL140
01007              SET PS-ERROR          TO TRUE                           CL140
01008          END-IF                                                      CL140
01009      END-IF.                                                         CL140
01010                                                                      CL*70
01011      IF (MB008-DEPT-NUMBER-X > SPACES AND                            CL122
01012          MB008-DMA-NUMBER-X > SPACES AND                             CL122
01013          MB008-GMA-NUMBER-X = SPACES)                                CL122
01014          MOVE DP015-RED            TO AGMAC                          CL122
01015          MOVE DP015-REVERSE        TO AGMAH                          CL122
01016          IF PS-NO-ERROR                                              CL140
01017              MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER               CL181
01018              MOVE -1               TO AGMAL                          CL140
01019              SET DP020-MSG-FATAL   TO TRUE                           CL140
01020              SET PS-ERROR          TO TRUE                           CL140
01021          END-IF                                                      CL140
01022      END-IF.                                                         CL140
01023                                                                      CL122
01024  4000-DISPLAY-PANEL.                                                 CL108
01025                                                                      CL**3
01026 ******************************************************************   CL**3
01027 *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.          CL**3
01028 *                                                                    CL**3
01029 *    PERFORMED BY 1000-CONTROL-PROCESSING.                           CL*10
01030 *    PERFORMED BY 3000-PROCESS-PANEL.                                CL*10
01031 *    PERFORMED BY 3100-CHECK-LOCAL-FKEYS.                            CL*10
01032 ******************************************************************   CL**3
01033                                                                      CL**3
01034      PERFORM DP017-0000-GET-CURR-DATE-TIME.                          CL**3
01035      MOVE DP017-EDITED-TIME-HMS                                      CL193
01036                                TO  ATIMEO.                           CL193
01037                                                                      CL**3
01038      IF PS-SEND-MAP-N-DATA-FRSET                                     CL**3
01039          PERFORM DP002-0000-FORMAT-TITLE-LINES                       CL**3
01040          PERFORM 4100-MOVE-COMMAREA-TO-SCREEN                        CL*82
01041      END-IF.                                                         CL**3
01042                                                                      CL**4
01043      PERFORM DP005-0000-FORMAT-MSG-LINES.                            CL**4
01044                                                                      CL108
01045      IF (DP020-SRC-AID = DP016-PA2) OR                               CL**4
01046         (PS-SEND-MAP-N-DATA-FRSET)                                   CL**4
01047          PERFORM DP009-0000-LOAD-FK-LINES                            CL**3
01048      END-IF.                                                         CL**3
01049                                                                      CL**3
01050      IF PS-NO-ERROR                                                  CL**3
01051          MOVE -1 TO AGMAL                                            CL**7
01052      END-IF                                                          CL**3
01053                                                                      CL**3
01054      PERFORM DP008-0000-WRITE-PANEL.                                 CL**3
01055                                                                      CL**3
01056  EJECT                                                               CL**3
01057                                                                      CL162
01058  4100-MOVE-COMMAREA-TO-SCREEN.                                       CL*20
01059                                                                      CL**4
01060 ******************************************************************   CL**4
01061 *    MOVE THE FIELDS FROM THE COMMAREA TO THE SCREEN.                CL**4
01062 *                                                                    CL**4
01063 *    PERFORMED BY 4000-DISPLAY-PANEL.                                CL*20
01064 ******************************************************************   CL**4
01065                                                                      CL**4
01066      MOVE MB008-CO-NUMBER-X     TO ACOO.                             CL103
01067      MOVE MB008-GMA-NUMBER-X    TO AGMAO.                            CL103
01068      MOVE MB008-DMA-NUMBER-X    TO ADMAO.                            CL103
01069      MOVE MB008-DEPT-NUMBER-X   TO ADEPTO.                           CL103
01070      MOVE MB008-HISTORY-FLAG    TO AHISTRYO.                         CL154
01071                                                                      CL*87
01072  EJECT                                                               CL**4
01073                                                                      CL108
01074  EJECT                                                               CL108
01075  5000-SETUP-INTER-APPL.                                              CL108
01076                                                                      CL*31
01077 ******************************************************************   CL*31
01078 *    SETUP THE INTER APPLICATION COMMAREA WITH DATA FROM THE         CL*31
01079 *    SPECIFIC COMMAREA AND SET THE INTER APPLICATION FORMAT CODE.    CL*31
01080 *                                                                    CL*31
01081 *    PERFORMED BY 3100-CHECK-LOCAL-FKEYS                             CL*31
01082 ******************************************************************   CL*31
01083                                                                      CL*31
01084      INITIALIZE TSQ-TEMP-STG-QUEUE.                                  CL190
01085      MOVE EIBTRMID                  TO MB008-TERM-ID.                CL187
01086      MOVE EIBTASKN                  TO MB008-TASK-ID.                CL187
01087      SET MB003-IDX                  TO 1.                            CL187
01088      MOVE 100                       TO MB003-MAX-ITEMS.              CL187
01089      SET MB003-UPDATE               TO TRUE.                         CL187
01090      MOVE 1                         TO MB003-ITEM (1)                CL189
01091                                        MB003-SELECTED-ITEMS          CL187
01092                                        PV-ITEM-NBR.                  CL187
01093      MOVE MB008-CO-NUMBER-X         TO MB005-CO-NUMBER.              CL183
01094      MOVE MB008-GMA-NUMBER-X        TO MB005-GMA-NUMBER              CL187
01095                                        MB003-GMA-NUMBER(1).          CL187
01096      MOVE MB008-DMA-NUMBER-X        TO MB005-DMA-NUMBER              CL187
01097                                        MB003-DMA-NUMBER(1).          CL187
01098      MOVE MB008-DEPT-NUMBER-X       TO MB005-DEPT-NUMBER             CL191
01099                                        MB003-DEPT-NUMBER(1).         CL187
01100      MOVE '000'                     TO MB005-MCLASS-NUMBER           CL187
01101                                        MB005-SCLASS-NUMBER           CL187
01102                                        MB003-MCLASS-NUMBER(1)        CL187
01103                                        MB003-SCLASS-NUMBER(1).       CL187
01104      MOVE 'DPT'                     TO MB003-MDSELV-NUMBER(1).       CL187
01105      MOVE MB008-HISTORY-FLAG        TO MB005-HISTORY-INDICATOR.      CL184
01106      PERFORM 5010-WRITE-TSQ.                                         CL187
01107      MOVE MB008-TEMP-QUEUE-NAME     TO MB005-LIST-QUEUE-NAME.        CL190
01108      MOVE PC-TSQ-LENGTH             TO MB005-LIST-QUEUE-LENGTH.      CL190
01109                                                                      CL*31
01110      SET DP020-MB-MERCH-DEPT-SELECT TO TRUE.                         CL124
01111  EJECT                                                               CL*31
01112                                                                      CL188
01113                                                                      CL188
01114  5010-WRITE-TSQ.                                                     CL187
01115 ******************************************************************   CL187
01116 *                                                                    CL187
01117 *                                                                    CL187
01118 ******************************************************************   CL187
01119                                                                      CL187
01120      EXEC CICS                                                       CL187
01121          WRITEQ TS                                                   CL187
01122          QUEUE(MB008-TEMP-QUEUE-NAME)                                CL189
01123          FROM(TSQ-TEMP-STG-QUEUE)                                    CL190
01124          LENGTH(PC-TSQ-LENGTH)                                       CL187
01125          ITEM(PV-ITEM-NBR)                                           CL187
01126          RESP(PV-CICS-RESPONSE)                                      CL187
01127      END-EXEC.                                                       CL187
01128      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                       CL187
01129         SET DP013-LOGIC-ABEND TO TRUE                                CL187
01130         SET DP013-NO-ROLLBACK TO TRUE                                CL187
01131         MOVE 'Z600-WRITE-TSQ' TO DP013-PARAGRAPH                     CL187
01132         MOVE 'RESPONSE CODE = ' TO DP013-MESSAGE-TEXT(1)             CL187
01133         MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT(2)               CL187
01134         PERFORM DP013-0000-PROCESS-ABEND                             CL187
01135      END-IF.                                                         CL187
01136                                                                      CL187
01137  5100-SAVE-INITIAL-INTERAPPL.                                        CL*41
01138                                                                      CL*41
01139 ******************************************************************   CL*41
01140 *    SAVE THE INTER-APPLICATION COMMAREA ON THE FIRST CYCLE          CL*41
01141 *    OF THIS TRANSACTION.                                            CL*41
01142 *                                                                    CL*41
01143 *    PERFORMED BY 1000-CONTROL-PROCESSING                            CL*41
01144 ******************************************************************   CL*41
01145                                                                      CL*41
01146      MOVE LOW-VALUES TO INTER-APPL-COMM-AREA.                        CL*41
01147                                                                      CL*41
01148  EJECT                                                               CL*41
01149  5100-UPDATE-INTER-APPL.                                             CL*36
01150                                                                      CL*34
01151 ******************************************************************   CL*34
01152 *    WHEN RETURNING FROM ANOTHER TRANSACTION, SAVE THE FIELDS        CL*34
01153 *    PASSED IN THE INTER APPLICATION COMMAREA, ONLY IF THE           CL*34
01154 *    INTER APPLICATION FORMAT CODE IS VALID FOR THIS TRANSACTION.    CL*34
01155 *                                                                    CL*34
01156 *    PERFORMED BY 1000-CONTROL-PROCESSING                            CL*34
01157 ******************************************************************   CL*34
01158                                                                      CL*34
01159      IF DP020-MB-MERCH-DEPT-LIST                                     CL126
01160         MOVE MB005-CO-NUMBER       TO MB008-CO-NUMBER-X              CL183
01161         MOVE MB005-GMA-NUMBER      TO MB008-GMA-NUMBER-X             CL183
01162         MOVE MB005-DMA-NUMBER      TO MB008-DMA-NUMBER-X             CL183
01163         MOVE MB005-DEPT-NUMBER     TO MB008-DEPT-NUMBER-X            CL183
01164      ELSE                                                            CL121
01165         INITIALIZE MB005-INTER-APPL-COMMAREA                         CL183
01166         INITIALIZE MB008-SPECIFIC-COMMAREA                           CL121
01167      END-IF.                                                         CL121
01168                                                                      CL117
01169  EJECT                                                               CL*34
01170 ******************************************************************MBKCS111
01171 *    FILL IN SCREEN HEADER MODULE                                 MBKCS111
01172 ******************************************************************MBKCS111
01173                                                                   MBKCS111
01174      COPY DPPD002.                                                   CL*14
01175  EJECT                                                            MBKCS111
01176 ******************************************************************MBKCS111
01177 *    RETURN TO CICS MODULE                                        MBKCS111
01178 ******************************************************************MBKCS111
01179                                                                   MBKCS111
01180      COPY DPPD003.                                                   CL*14
01181  EJECT                                                            MBKCS111
01182 ******************************************************************MBKCS111
01183 *    FORMAT MESSAGE LINES MODULE                                  MBKCS111
01184 ******************************************************************MBKCS111
01185                                                                   MBKCS111
01186      COPY DPPD005.                                                   CL113
01187  EJECT                                                            MBKCS111
01188 ******************************************************************MBKCS111
01189 *    GET PANEL MODULE                                             MBKCS111
01190 ******************************************************************MBKCS111
01191                                                                   MBKCS111
01192      COPY DPPD007.                                                   CL*14
01193  EJECT                                                            MBKCS111
01194 ******************************************************************MBKCS111
01195 *    WRITE PANEL MODULE                                           MBKCS111
01196 ******************************************************************MBKCS111
01197                                                                   MBKCS111
01198      COPY DPPD008.                                                   CL*14
01199  EJECT                                                            MBKCS111
01200 ******************************************************************MBKCS111
01201 *    TOGGLE THE FUNCTION KEY LINE MODULE                          MBKCS111
01202 ******************************************************************MBKCS111
01203                                                                   MBKCS111
01204      COPY DPPD009.                                                   CL*14
01205  EJECT                                                            MBKCS111
01206 ******************************************************************MBKCS111
01207 *    ABEND PROCESSOR MODULE                                       MBKCS111
01208 ******************************************************************MBKCS111
01209                                                                   MBKCS111
01210      COPY DPPD013.                                                   CL*14
01211  EJECT                                                            MBKCS111
01212 ******************************************************************MBKCS111
01213 *    CHECK COMMUNICATION AREA MODULE                              MBKCS111
01214 ******************************************************************MBKCS111
01215                                                                   MBKCS111
01216      COPY DPPD015.                                                   CL*14
01217  EJECT                                                            MBKCS111
01218 ******************************************************************MBKCS111
01219 *    UPDATE TIME AND DATE MODULE                                  MBKCS111
01220 ******************************************************************MBKCS111
01221                                                                   MBKCS111
01222      COPY DPPD017.                                                   CL*14
01223  EJECT                                                            MBKCS111
