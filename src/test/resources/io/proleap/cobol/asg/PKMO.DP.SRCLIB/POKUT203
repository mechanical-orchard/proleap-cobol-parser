000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*                                                                 00040000
000500 PROGRAM-ID.    POKUT203.                                         00050002
000600 AUTHOR.        COGNIZANT.                                        00060003
000700 INSTALLATION.  KOHLS DEPARTMENT STORES                           00070000
000800 DATE-WRITTEN.  04/10.                                            00080003
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100******************************************************************00110000
001200* ATTACH MBS INFO TO PO EXTRACT                                  *00120000
001300*                                                                *00130000
001400* COBOL 390 WITH SQL                                             *00140000
001500******************************************************************00150000
001600* THIS PROGRAM WILL APPEND MBS INFORMATION TO THE INPUT RECORDS   00160000
001700* BEING READ IN. A CURSOR IS OPENED WHICH SELECTS ALL DEPT/CLASSES00170000
001800* FROM MBS. THIS IS THEN MATCHED WITH THE DEPT/CLASSES FROM THE   00180000
001900* INPUT FILE. IF THE DEPT/CLASSES MATCH, THE GMA, DMA, BUYER, AND 00190000
002000* DESCRIPTION ARE ADDED TO THE RECORD. IF A RECORD EXISTS ON MBS  00200000
002100* BUT NO RECORD EXISTS ON THE PO EXTRACT FILE, A BLANK RECORD     00210000
002200* IS WRITTEN FOR THAT DEPT/CLASS.                                 00220000
002300******************************************************************00230000
002400*     CHANGE LOG                                                 *00240000
002500******************************************************************00250000
002600*    DATE  04/10/10                                              *00260004
002700*  CHANGE MADE: ADDED WITH UR STATEMENT TO SQL.                  *00270004
002800*  MADE BY: COGNIZANT                              WR #: 2344    *00280004
002900******************************************************************00290000
003000* 04/12/12 MADE BY: COGNIZANT               WR/IR #: CRQ 23538    00300006
003100* CHANGES: CHANGED RECORD LAYOUT FOR PO RECORDS AND PO RECEIPT    00310006
003200* RECORDS. ADDED FUNCTIONALITY TO PROCESS CRE-BY-UID.             00320006
003300******************************************************************00330006
003000* 07/18/12 MADE BY: COGNIZANT               WR/IR #: CRQ 29188    00340012
003100* CHANGES: CHANGED RECORD LAYOUT FOR PO RECORDS.                  00350010
003200*          ADDED FUNCTIONALITY TO PROCESS DISTRIBUTION DATE WEEK. 00360010
003300******************************************************************00370010
C98147* 11/04/14 MADE BY: LINDA FRIESS            CHG0098147            00380014
C98147* CHANGES: RECOMPILED TO BRING IN POWS010 & POWS015 COPYBOOKS     00390014
C98147*          WITH EXPANDED PO NUMBER                                00400014
C98147***************************************************************** 00410014
003400                                                                  00420000
003500 ENVIRONMENT DIVISION.                                            00430000
003600                                                                  00440000
003700 CONFIGURATION SECTION.                                           00450000
003800*                                                                 00460000
003900 SOURCE-COMPUTER. IBM-3083.                                       00470000
004000 OBJECT-COMPUTER. IBM-3083.                                       00480000
004100*                                                                 00490000
004200 INPUT-OUTPUT SECTION.                                            00500000
004300                                                                  00510000
004400 FILE-CONTROL.                                                    00520000
004500     SELECT PO-EXT-FILE                                           00530000
004600         ASSIGN TO INP01.                                         00540000
004700*                                                                 00550000
004800     SELECT NEW-PO-EXT-FILE                                       00560000
004900         ASSIGN TO OUT01.                                         00570000
005000*                                                                 00580000
005100******************************************************************00590000
005200 DATA DIVISION.                                                   00600000
005300******************************************************************00610000
005400*                                                                 00620000
005500 FILE SECTION.                                                    00630000
005600*                                                                 00640000
005700 FD  PO-EXT-FILE                                                  00650000
005800     LABEL RECORDS ARE STANDARD                                   00660000
005900     RECORDING MODE IS F                                          00670000
006000     BLOCK CONTAINS 0 RECORDS.                                    00680000
006100 01  PO-EXT-RECORD                  PIC X(210).                   00690009
006200*                                                                 00700000
006300 FD  NEW-PO-EXT-FILE                                              00710000
006400     LABEL RECORDS ARE STANDARD                                   00720000
006500     RECORDING MODE IS F                                          00730000
006600     BLOCK CONTAINS 0 RECORDS.                                    00740000
006700 01  NEW-PO-EXT-RECORD              PIC X(210).                   00750009
006800*                                                                 00760000
006900 WORKING-STORAGE SECTION.                                         00770000
007000*                                                                 00780000
007100 01  PS-PROGRAM-SWITCHES.                                         00790000
007200     05  PS-MORE-INPUT-RECS-SW           PIC X(01)   VALUE 'Y'.   00800000
007300         88  PS-MORE-INPUT-RECS                      VALUE 'Y'.   00810000
007400         88  PS-NO-MORE-INPUT-RECS                   VALUE 'N'.   00820000
007500     05  PS-MORE-INPUT-ROWS-SW           PIC X(01)   VALUE 'Y'.   00830000
007600         88  PS-MORE-INPUT-ROWS                      VALUE 'Y'.   00840000
007700         88  PS-NO-MORE-INPUT-ROWS                   VALUE 'N'.   00850000
007800*                                                                 00860000
007900******************************************************************00870000
008000*  INPUT FILE RECORD LAYOUT.                                      00880000
008100******************************************************************00890000
008200     COPY POWS010.                                                00900005
008300*                                                                 00910000
008400******************************************************************00920000
008500*  OUTPUT FILE RECORD LAYOUT.                                     00930000
008600******************************************************************00940000
008700     COPY POWS015.                                                00950005
008800*                                                                 00960000
008900 01  PC-PROGRAM-CONSTANTS.                                        00970000
009000     05  PC-OPERCO-NBR            PIC X(02)   VALUE '03'.         00980000
009100     05  PC-MAX-RETRIES               PIC S9(3)  VALUE +3.        00990000
009200     05  PC-SUB-CL-CDE            PIC X(03)   VALUE '000'.        01000000
009300     05  PC-APLSYS-CDE            PIC X(02)   VALUE 'OB'.         01010000
009400     05  PC-MDSELV-CDE            PIC X(03)   VALUE 'MCL'.        01020000
009500*                                                                 01030000
009600 01  PV-PROGRAM-VARIABLES.                                        01040000
009700     05  PV-PARAGRAPH-NAME          PIC X(30)  VALUE SPACE.       01050000
009800     05  PV-DB2-OPER-ATTEMPTED      PIC X(30)  VALUE SPACE.       01060000
009900     05  PV-SQL-SUB                 PIC S9(4)  VALUE ZERO         01070000
010000                                                     COMP.        01080000
010100     05  PV-EXT-DEPT-CL.                                          01090000
010200         10  PV-EXT-DEPT            PIC X(03)  VALUE SPACES.      01100000
010300         10  PV-EXT-CL              PIC X(02)  VALUE SPACES.      01110000
010400     05  PV-PREV-DEPT-CL            PIC X(05)  VALUE SPACES.      01120000
010500     05  PV-MBS-DEPT-CL.                                          01130000
010600         10  PV-MBS-DEPT            PIC X(03)  VALUE SPACES.      01140000
010700         10  PV-MBS-CL              PIC X(02)  VALUE SPACES.      01150000
010800*                                                                 01160000
010900******************************************************************01170000
011000*  DB2 ERROR MESSAGE FIELDS                                       01180000
011100******************************************************************01190000
011200     COPY DPWS004.                                                01200000
011300*                                                                 01210000
011400*  DB2 MERCHANDISE AREA TABLE LAYOUT                              01220000
011500*                                                                 01230000
011600     EXEC SQL                                                     01240000
011700        INCLUDE TMDSEAR                                           01250000
011800     END-EXEC.                                                    01260000
011900*                                                                 01270000
012000*  DB2 APPLICATION SYSTEM AVAIL TABLE LAYOUT                      01280000
012100*                                                                 01290000
012200     EXEC SQL                                                     01300000
012300        INCLUDE TAPLAVL                                           01310000
012400     END-EXEC.                                                    01320000
012500*                                                                 01330000
012600*  DB2 COMMUNICATION AREA                                         01340000
012700*                                                                 01350000
012800     EXEC SQL                                                     01360000
012900        INCLUDE SQLCA                                             01370000
013000     END-EXEC.                                                    01380000
013100*                                                                 01390000
013200*  DB2 COMMUNICATION AREA 2                                       01400000
013300*                                                                 01410000
013400     COPY SQLCA2.                                                 01420000
013500*                                                                 01430000
013600******************************************************************01440000
013700*  DB2 DEPT CL CURSOR                                             01450000
013800******************************************************************01460000
013900     EXEC SQL                                                     01470000
014000        DECLARE DEPT_CL_CURSOR CURSOR FOR                         01480000
014100          SELECT GMA_NBR,                                         01490000
014200                 DMA_NBR,                                         01500000
014300                 DEPT_NBR,                                        01510000
014400                 MAJ_CL_NBR,                                      01520000
014500                 BYR_NBR,                                         01530000
014600                 MDSEAR_DESC                                      01540000
014700            FROM TMDSEAR A,                                       01550000
014800                 TAPLAVL B                                        01560000
014900            WHERE (A.OPERCO_NBR = :PC-OPERCO-NBR) AND             01570000
015000                  (A.MDSEAR_DKEY = B.MDSEAR_DKEY) AND             01580000
015100                  (SUB_CL_NBR = :PC-SUB-CL-CDE)   AND             01590000
015200                  (MDSELV_CDE = :PC-MDSELV-CDE)   AND             01600000
015300                  (APLSYS_CDE = :PC-APLSYS-CDE)   AND             01610000
015400                  (DATE (CURRENT TIMESTAMP) BETWEEN               01620000
015500                                    STRT_DTE AND END_DTE) AND     01630000
015600                  (DATE (CURRENT TIMESTAMP) BETWEEN               01640000
015700                     MDSEAR_STRT_DTE AND MDSEAR_END_DTE)          01650000
015800            ORDER BY 3,4                                          01660000
015900        WITH UR                                                   01670001
016000     END-EXEC.                                                    01680000
016100*                                                                 01690000
016200 01  ABEND-CODE                           PIC S9(04) VALUE +0     01700000
016300                                                     COMP SYNC.   01710000
016400*                                                                 01720000
016500 LINKAGE SECTION.                                                 01730000
016600*                                                                 01740000
016700 PROCEDURE DIVISION.                                              01750000
016800*                                                                 01760000
016900 A100-MAIN-MODULE.                                                01770000
017000******************************************************************01780000
017100*  MAIN PROCESSING                                                01790000
017200******************************************************************01800000
017300                                                                  01810000
017400     OPEN INPUT  PO-EXT-FILE                                      01820000
017500          OUTPUT NEW-PO-EXT-FILE.                                 01830000
017600                                                                  01840000
017700     PERFORM Z300-OPEN-CURSOR.                                    01850000
017800                                                                  01860000
017900     PERFORM Z100-READ-INPUT-FILE.                                01870000
018000     PERFORM Z400-FETCH-ROW.                                      01880000
018100                                                                  01890000
018200     PERFORM B100-PROCESS-RECS                                    01900000
018300         UNTIL PS-NO-MORE-INPUT-RECS  AND                         01910000
018400               PS-NO-MORE-INPUT-ROWS.                             01920000
018500                                                                  01930000
018600     PERFORM Z500-CLOSE-CURSOR.                                   01940000
018700                                                                  01950000
018800     CLOSE PO-EXT-FILE                                            01960000
018900           NEW-PO-EXT-FILE.                                       01970000
019000                                                                  01980000
019100     STOP RUN.                                                    01990000
019200*                                                                 02000000
019300 B100-PROCESS-RECS.                                               02010000
019400******************************************************************02020000
019500* COMPARE THE DEPT CLASS FROM MBS TO THE DEPT CLASS FROM THE      02030000
019600* EXTRACT FILE.                                                   02040000
019700******************************************************************02050000
019800*                                                                 02060000
019900                                                                  02070000
020000     IF PV-MBS-DEPT-CL = PV-EXT-DEPT-CL                           02080000
020100         MOVE PO010-RECORD   TO PO015-FIRST-PART                  02090005
               MOVE PO010-DIST-WW  TO PO015-DIST-WW                     02100007
020200         MOVE PO010-PO-TYP-CDE                                    02110005
020300                             TO PO015-PO-TYP-CDE                  02120005
020400         MOVE PO010-CRE-BY-UID                                    02130005
020500                             TO PO015-CRE-BY-UID                  02140005
020600         MOVE MDSEAR-GMA-NBR TO PO015-GMA                         02150005
020700         MOVE MDSEAR-DMA-NBR TO PO015-DMA                         02160005
020800         MOVE MDSEAR-DESC    TO PO015-DESC                        02170005
020900         MOVE MDSEAR-BYR-NBR TO PO015-BYR                         02180005
021000         PERFORM Z200-WRITE-EXTRACT                               02190000
021100         MOVE PV-EXT-DEPT-CL TO PV-PREV-DEPT-CL                   02200000
021200         PERFORM C100-ADVANCE-DEPT-CLASS                          02210000
021300             UNTIL (PS-NO-MORE-INPUT-RECS)  OR                    02220000
021400                   (PV-EXT-DEPT-CL NOT = PV-PREV-DEPT-CL)         02230000
021500         PERFORM Z400-FETCH-ROW                                   02240000
021600     ELSE                                                         02250000
021700         IF PV-MBS-DEPT-CL < PV-EXT-DEPT-CL                       02260000
021800             INITIALIZE              PO015-FIRST-PART             02270005
021800             INITIALIZE              PO015-DIST-WW                02280007
021900             MOVE PV-MBS-DEPT        TO PO015-DEPT                02290005
022000             MOVE PV-MBS-CL          TO PO015-MAJOR-CLASS         02300005
022100             MOVE MDSEAR-GMA-NBR     TO PO015-GMA                 02310005
022200             MOVE MDSEAR-DMA-NBR     TO PO015-DMA                 02320005
022300             MOVE MDSEAR-DESC        TO PO015-DESC                02330005
022400             MOVE MDSEAR-BYR-NBR     TO PO015-BYR                 02340005
022500             PERFORM Z200-WRITE-EXTRACT                           02350000
022600             PERFORM Z400-FETCH-ROW                               02360000
022700         ELSE                                                     02370000
022800             DISPLAY '***ERROR - DEPT/CLASS NOT FOUND ON MBS '    02380000
022900                     PV-EXT-DEPT-CL                               02390000
023000             MOVE PV-EXT-DEPT-CL TO PV-PREV-DEPT-CL               02400000
023100             PERFORM Z100-READ-INPUT-FILE                         02410000
023200                 UNTIL (PS-NO-MORE-INPUT-RECS)  OR                02420000
023300                 (PV-EXT-DEPT-CL NOT = PV-PREV-DEPT-CL)           02430000
023400         END-IF                                                   02440000
023500     END-IF.                                                      02450000
023600*                                                                 02460000
023700 C100-ADVANCE-DEPT-CLASS.                                         02470000
023800******************************************************************02480000
023900*  READ THE INPUT FILE UNITL A BREAK OCCURS ON DEPT/CLASS.        02490000
024000*  WRITE AN OUTPUT RECORD FOR EVERY RECORD READ THAT HAS THE      02500000
024100*  SAME DEPT/CLASS AS THE PREVIOUS RECORD.                        02510000
024200******************************************************************02520000
024300                                                                  02530000
024400     PERFORM Z100-READ-INPUT-FILE.                                02540000
024500                                                                  02550000
024600     IF (PV-EXT-DEPT-CL = PV-PREV-DEPT-CL) AND                    02560000
024700        (PV-EXT-DEPT-CL NOT = '99999')                            02570000
024800                                                                  02580000
024900         MOVE PO010-RECORD   TO PO015-FIRST-PART                  02590005
025000         MOVE PO010-PO-TYP-CDE                                    02600005
025100                             TO PO015-PO-TYP-CDE                  02610005
025200         MOVE PO010-CRE-BY-UID                                    02620005
025300                             TO PO015-CRE-BY-UID                  02630005
025200         MOVE PO010-DIST-WW                                       02640008
025300                             TO PO015-DIST-WW                     02650008
025400         PERFORM Z200-WRITE-EXTRACT                               02660000
025500                                                                  02670000
025600     END-IF.                                                      02680000
025700                                                                  02690000
025800*                                                                 02700000
025900 Z100-READ-INPUT-FILE.                                            02710000
026000******************************************************************02720000
026100*    READ THE PO EXTRACT INPUT FILE.                              02730000
026200******************************************************************02740000
026300                                                                  02750000
026400     READ PO-EXT-FILE                                             02760000
026500         INTO PO010-RECORD                                        02770005
026600         AT END SET PS-NO-MORE-INPUT-RECS TO TRUE                 02780000
026700                MOVE ALL '9' TO PO010-DEPT                        02790005
026800                                PO010-MAJOR-CLASS.                02800005
026900                                                                  02810000
027000     MOVE PO010-DEPT         TO PV-EXT-DEPT.                      02820005
027100     MOVE PO010-MAJOR-CLASS TO PV-EXT-CL.                         02830005
027200                                                                  02840000
027300 Z200-WRITE-EXTRACT.                                              02850000
027400******************************************************************02860000
027500*  WRITE THE RECORD TO THE PO EXTRACT FILE.                       02870000
027600******************************************************************02880000
027700                                                                  02890000
027800     WRITE NEW-PO-EXT-RECORD FROM PO015-RECORD.                   02900005
027900                                                                  02910000
028000 Z300-OPEN-CURSOR.                                                02920000
028100******************************************************************02930000
028200*    OPEN THE CURSOR FOR THE JOIN OF THE MERCHANDISE AREA TABLE   02940000
028300*    AND THE APPLICATION SYSTEM AVAILABILITY TABLE.               02950000
028400******************************************************************02960000
028500     INITIALIZE DCLTMDSEAR                                        02970000
028600                DCLTAPLAVL.                                       02980000
028700                                                                  02990000
028800     PERFORM                                                      03000000
028900         WITH TEST AFTER                                          03010000
029000         VARYING PV-SQL-SUB                                       03020000
029100         FROM 1 BY 1                                              03030000
029200         UNTIL (PV-SQL-SUB > PC-MAX-RETRIES                       03040000
029300                   OR SQLCODE = 0                                 03050000
029400                   OR SQLCODE = +100)                             03060000
029500                                                                  03070000
029600         EXEC SQL                                                 03080000
029700             OPEN DEPT_CL_CURSOR                                  03090000
029800         END-EXEC                                                 03100000
029900                                                                  03110000
030000         EVALUATE TRUE                                            03120000
030100             WHEN SQLCODE = -904                                  03130000
030200             WHEN SQLCODE = -911                                  03140000
030300             WHEN SQLCODE = +100                                  03150000
030400             WHEN SQLCODE = 0                                     03160000
030500                 CONTINUE                                         03170000
030600             WHEN SQLWARN NOT = SPACES                            03180000
030700             WHEN SQLCODE NOT = ZERO                              03190000
030800                 MOVE 'Z300-OPEN-CURSOR'                          03200000
030900                               TO  PV-PARAGRAPH-NAME              03210000
031000                 MOVE 'OPEN ON CURSOR'                            03220000
031100                               TO  PV-DB2-OPER-ATTEMPTED          03230000
031200                 PERFORM Z600-SQL-ERROR                           03240000
031300         END-EVALUATE                                             03250000
031400     END-PERFORM.                                                 03260000
031500*                                                                 03270000
031600     IF  PV-SQL-SUB GREATER PC-MAX-RETRIES                        03280000
031700         MOVE 'Z300-OPEN-CURSOR'                                  03290000
031800                               TO  PV-PARAGRAPH-NAME              03300000
031900         MOVE 'OPEN RETRIES EXCEEDED'                             03310000
032000                               TO  PV-DB2-OPER-ATTEMPTED          03320000
032100         PERFORM Z600-SQL-ERROR                                   03330000
032200     END-IF.                                                      03340000
032300                                                                  03350000
032400 Z400-FETCH-ROW.                                                  03360000
032500******************************************************************03370000
032600*    FETCH THE NEXT ROW OF THE CURSOR.                            03380000
032700******************************************************************03390000
032800                                                                  03400000
032900     EXEC SQL                                                     03410000
033000         FETCH DEPT_CL_CURSOR                                     03420000
033100         INTO  :MDSEAR-GMA-NBR,                                   03430000
033200               :MDSEAR-DMA-NBR,                                   03440000
033300               :MDSEAR-DEPT-NBR,                                  03450000
033400               :MDSEAR-MAJ-CL-NBR,                                03460000
033500               :MDSEAR-BYR-NBR,                                   03470000
033600               :MDSEAR-DESC                                       03480000
033700     END-EXEC.                                                    03490000
033800                                                                  03500000
033900     IF SQLCODE = 0                                               03510000
034000         MOVE MDSEAR-DEPT-NBR   TO PV-MBS-DEPT                    03520000
034100         MOVE MDSEAR-MAJ-CL-NBR TO PV-MBS-CL                      03530000
034200     ELSE                                                         03540000
034300         IF SQLCODE = +100                                        03550000
034400             SET PS-NO-MORE-INPUT-ROWS TO TRUE                    03560000
034500             MOVE ALL '9' TO       PV-MBS-DEPT                    03570000
034600                                   PV-MBS-CL                      03580000
034700         ELSE                                                     03590000
034800             IF SQLCODE NOT = 0                                   03600000
034900                 DISPLAY '** ABEND **'                            03610000
035000                 DISPLAY 'FETCH ERROR FOR PLAN CURSOR'            03620000
035100                 PERFORM Z600-SQL-ERROR                           03630000
035200             END-IF                                               03640000
035300         END-IF                                                   03650000
035400     END-IF.                                                      03660000
035500                                                                  03670000
035600 Z500-CLOSE-CURSOR.                                               03680000
035700******************************************************************03690000
035800*    CLOSE THE CURSOR.                                            03700000
035900******************************************************************03710000
036000                                                                  03720000
036100     PERFORM                                                      03730000
036200         WITH TEST AFTER                                          03740000
036300         VARYING PV-SQL-SUB                                       03750000
036400         FROM 1 BY 1                                              03760000
036500         UNTIL (PV-SQL-SUB > PC-MAX-RETRIES                       03770000
036600                   OR SQLCODE = 0                                 03780000
036700                   OR SQLCODE = +100)                             03790000
036800                                                                  03800000
036900         EXEC SQL                                                 03810000
037000             CLOSE DEPT_CL_CURSOR                                 03820000
037100         END-EXEC                                                 03830000
037200                                                                  03840000
037300         EVALUATE TRUE                                            03850000
037400             WHEN SQLCODE = -904                                  03860000
037500             WHEN SQLCODE = -911                                  03870000
037600             WHEN SQLCODE = +100                                  03880000
037700             WHEN SQLCODE = 0                                     03890000
037800                 CONTINUE                                         03900000
037900             WHEN SQLWARN NOT = SPACES                            03910000
038000             WHEN SQLCODE NOT = ZERO                              03920000
038100                 MOVE 'Z500-CLOSE-CURSOR'                         03930000
038200                               TO  PV-PARAGRAPH-NAME              03940000
038300                 MOVE 'OPEN ON CURSOR'                            03950000
038400                               TO  PV-DB2-OPER-ATTEMPTED          03960000
038500                 PERFORM Z600-SQL-ERROR                           03970000
038600         END-EVALUATE                                             03980000
038700     END-PERFORM.                                                 03990000
038800*                                                                 04000000
038900     IF  PV-SQL-SUB GREATER PC-MAX-RETRIES                        04010000
039000         MOVE 'Z500-CLOSE-CURSOR'                                 04020000
039100                               TO  PV-PARAGRAPH-NAME              04030000
039200         MOVE 'OPEN RETRIES EXCEEDED'                             04040000
039300                               TO  PV-DB2-OPER-ATTEMPTED          04050000
039400         PERFORM Z600-SQL-ERROR                                   04060000
039500     END-IF.                                                      04070000
039600                                                                  04080000
039700                                                                  04090000
039800 Z600-SQL-ERROR.                                                  04100000
039900******************************************************************04110000
040000* Z600-SQL-ERROR  -  PROCESSES AN SQL ERROR                       04120000
040100******************************************************************04130000
040200*                                                                 04140000
040300     MOVE 4013 TO ABEND-CODE.                                     04150000
040400     DISPLAY '**  ABEND     **'.                                  04160000
040500     DISPLAY '**  PROGRAM   **  =  POKUT203'.                     04170002
040600     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            04180000
040700     DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        04190000
040800*                                                                 04200000
040900*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         04210000
041000*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        04220000
041100*                                                                 04230000
041200     COPY DPPD004.                                                04240000
041300*                                                                 04250000
041400     CALL 'ILBOABN0'  USING ABEND-CODE.                           04260000
041500*                                                                 04270000
