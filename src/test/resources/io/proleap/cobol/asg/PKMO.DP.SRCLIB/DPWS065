00001 ***************************************************************** 01/27/94
00002 *    COPY MEMBER:  DPWS065                                      * DPWS065 
00003 *                                                               *    LV002
00004 *    THIS MEMBER IS USED TO CALL DPKUT001 FROM EITHER A BATCH   * DPWS065 
00005 *    OR CICS PROGRAM TO GENERATE A RANDOM NUMBER. THIS          * DPWS065 
00006 *    MEMBER MUST BE INCLUDED IN ANY PROGRAM THAT CALLS THIS     * DPWS065 
00007 *    SUBROUTINE.                                                * DPWS065 
00008 *                                                               * DPWS065 
00009 *    BEFORE EVERY CALL TO THE DPKUT001 PROGRAM, THE             *    CL**2
00010 *    CURRENT-DATE AND CURRENT-TIME FIELDS MUST BE REFRESHED.    *    CL**2
00011 *                                                                    CL**2
00012 *    SEE THE DPKUT001 PROGRAM FOR SAMPLES OF CALLS FROM BOTH    *    CL**2
00013 *    BATCH AND ONLINE PROGRAMS.                                      CL**2
00014 *                                                               * DPWS065 
00015 *    TO CALL THE SUBROUTINE, DO THE FOLLOWING:                  * DPWS065 
00016 *        05  PC-RANDNBR-PGM      PIC X(08)   VALUE 'DPKUT001'.  * DPWS065 
00017 *                                                               * DPWS065 
00018 *        CALL PC-MBS-PGM USING DP065-RANDNBR-ROUTINE-FIELDS.    * DPWS065 
00019 *                                                               * DPWS065 
00020 *                                                               * DPWS065 
00021 *    USING A VARIABLE NAME RATHER THAN A LITERAL IN THE CALL    * DPWS065 
00022 *    AND LINK STATEMENTS MAKES THEM DYNAMIC RATHER THAN         * DPWS065 
00023 *    STATIC.                                                    * DPWS065 
00024 *                                                               * DPWS065 
00025 *---------------------------------------------------------------* DPWS065 
00026 *                                                               * DPWS065 
00027 *                                                               * DPWS065 
00028 *    COMMON INPUT FIELDS                                        * DPWS065 
00029 *    -------------------                                        * DPWS065 
00030 *                                                               * DPWS065 
00031 *    THE FOLLOWING FIELDS ARE REQUIRED FOR EVERY USAGE OF THIS  * DPWS065 
00032 *    ROUTINE:                                                   * DPWS065 
00033 *        INITIALIZE         DP065-RANDNBR-ROUTINE-FIELDS.       * DPWS065 
00034 *        MOVE 'YYMMDD'   TO DP065-CURRENT-DATE.                 * DPWS065 
00035 *        MOVE 'HHMMSSHS' TO DP065-CURRENT-TIME.                 * DPWS065 
00036 *                                                               * DPWS065 
00037 *    DP065-CURRENT-DATE SHOULD BE FILLED IN WITH THE CURRENT    * DPWS065 
00038 *    DATE IN A YYMMDD FORMAT.                                   * DPWS065 
00039 *                                                               * DPWS065 
00040 *    DP065-CURRENT-TIME SHOULD BE FILLED IN WITH THE CURRENT    * DPWS065 
00041 *    TIME IN A HHMMSSHS (HOURS,MINUTES,SECONDS,HUNDREDTHS       * DPWS065 
00042 *    OF A SECOND) FORMAT.                                       * DPWS065 
00043 *                                                               * DPWS065 
00044 *                                                               * DPWS065 
00045 *    COMMON RETURN CODES                                        * DPWS065 
00046 *    -------------------                                        * DPWS065 
00047 *                                                               * DPWS065 
00048 *    THE FOLLOWING IS A LIST OF THE COMMON RETURN CODES THAT    * DPWS065 
00049 *    CAN BE RETURNED FOR EVERY CALL TO THE SUBROUTINE:          * DPWS065 
00050 *                                                               * DPWS065 
00051 *        RETURN CODE               | MEANING                    * DPWS065 
00052 *        -----------               | -------                    * DPWS065 
00053 *                                  |                            * DPWS065 
00054 *        DP065-SUCCESSFUL          | CALL WAS SUCCESSFUL        * DPWS065 
00055 *        DP065-INVALID-DATE        | CURRENT DATE NOT PASSED    * DPWS065 
00056 *                                  | OR INVALID                 * DPWS065 
00057 *        DP065-INVALID-TIME        | CURRENT TIME NOT PASSED    * DPWS065 
00058 *                                  | OR INVALID                 * DPWS065 
00059 ***************************************************************** DPWS065 
00060  01  DP065-RANDNBR-ROUTINE-FIELDS.                                DPWS065 
00061      05  DP065-INPUT-FIELDS.                                      DPWS065 
00062          10  DP065-CURRENT-DATE      PIC  9(06).                  DPWS065 
00063          10  FILLER REDEFINES DP065-CURRENT-DATE.                 DPWS065 
00064              15  DP065-CURRENT-DATE-YY                            DPWS065 
00065                                      PIC  9(02).                  DPWS065 
00066              15  DP065-CURRENT-DATE-MM                            DPWS065 
00067                                      PIC  9(02).                  DPWS065 
00068              15  DP065-CURRENT-DATE-DD                            DPWS065 
00069                                      PIC  9(02).                  DPWS065 
00070          10  DP065-CURRENT-TIME      PIC  9(08).                  DPWS065 
00071          10  FILLER REDEFINES DP065-CURRENT-TIME.                 DPWS065 
00072              15  DP065-CURRENT-TIME-HH                            DPWS065 
00073                                      PIC  9(02).                  DPWS065 
00074              15  DP065-CURRENT-TIME-MM                            DPWS065 
00075                                      PIC  9(02).                  DPWS065 
00076              15  DP065-CURRENT-TIME-SS                            DPWS065 
00077                                      PIC  9(02).                  DPWS065 
00078              15  DP065-CURRENT-TIME-HS                            DPWS065 
00079                                      PIC  9(02).                  DPWS065 
00080 *-----------------------------------------------------------------DPWS065 
00081      05  DP065-OUTPUT-FIELDS.                                     DPWS065 
00082          10  DP065-RANDOM-NUMBER     PIC S9(09) COMP.             DPWS065 
00083          10  DP065-RANDOM-TRAIL      PIC  9(02) VALUE 0.          DPWS065 
00084          10  DP065-RETURN-DATA.                                   DPWS065 
00085              15  DP065-RETURN-CODE   PIC  X(02).                  DPWS065 
00086                  88  DP065-SUCCESSFUL              VALUE '00'.    DPWS065 
00087                  88  DP065-INVALID-DATE            VALUE '01'.    DPWS065 
00088                  88  DP065-INVALID-TIME            VALUE '02'.    DPWS065 
