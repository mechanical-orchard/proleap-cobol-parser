000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    IQKCS408.                                         00040099
000500 AUTHOR.        GREG SHEFF.                                       00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  02-19-03.                                         00070099
000800 DATE-COMPILED.                                                   00080099
000900                                                                  00090099
001000*---------------------------------------------------------------* 00100099
001100*    I408 - SKU LIST                                            * 00110099
001200*                                                               * 00120099
001300*    DISPLAYS A UPC LIST ASSOCIATED WITH A PARTICULAR           * 00130099
001400*    DEPARTMENT AND POSSIBLY MAJOR AND SUB CLASS, COLOR, STYLE, * 00140099
001500*    AND SIZE THAT WAS PREVIOUSLY SELECTED.                     * 00150099
001600*                                                               * 00160099
001700*    YOU CAN GET TO THIS SCREEN IN THE FOLLOWING WAYS:          * 00170099
001800*        1 - F17 - IQLCLASS - IQKCS405 - MAJOR AND SUB CLASS    * 00180099
001900*                                        LIST                   * 00190099
002000*                  FORMAT CODE IS '1'.                          * 00200099
002100*                                                               * 00210099
002200*        2 - F17 - IQLCOLOR - IQKCS406 - COLOR LIST             * 00220099
002300*                  FORMAT CODE IS '2'.                          * 00230099
002400*                                                               * 00240099
002500*        3 - F17 - IQLSIZE  - IQKCS407 - SIZE LIST              * 00250099
002600*                  FORMAT CODE IS '3'.                          * 00260099
002700*                                                               * 00270099
002800*        4 - F17 - IQLSTYLE - IQKCS409 - STYLE LIST             * 00280099
002900*                  FORMAT CODE IS '5'.                          * 00290099
003000*                                                               * 00300099
003100*        5 - F21 - IQSVEND  - IQKCS401 - UPC VERIFICATION LIST  * 00310099
003200*                  FORMAT CODE IS '4'.                          * 00320099
003300*                                                               * 00330099
003400*        6 - F22 - IQSVEND  - IQKCS401 - UPC VERIFICATION LIST  * 00340099
003500*                  FORMAT CODE IS '6'.                          * 00350099
003600*                                                               * 00360099
003700*    THERE ARE 19 DIFFERENT CURSORS IN THIS PROGRAM USED TO     * 00370099
003800*    SELECT THE DATA BECAUSE OF THE DIFFERENT PATHS YOU CAN     * 00380099
003900*    TAKE TO GET HERE.                                          * 00390099
004000*         DO A FIND FOR EXPLANATION TO FIND THE DESCRIPTION     * 00400099
004100*         OF HOW CURSORS ARE NAMED, ETC.                        * 00410099
004200*                                                               * 00420099
004300*    ALLOWS THE USER TO SELECT ONE UPC AND PASS THE SKU, STORE, * 00430099
004400*    SUB CLASS AND DEPARTMENT TO THE SKU INQUIRY PROGRAM        * 00440099
004500*    FSISKUST (FSKCS024).                                       * 00450099
004600*                                                               * 00460099
004700*     YOU MAY ALSO PRINT A LABEL FOR RETICKETING OF MERCHANDISE * 00470099
004800*     BY SELECTING ONE OR MORE UPCS AND PRESSING F18.           * 00480099
004900*        LABELS WILL PRINT AT THE MONARCH PRINTER FOR THE STORE.* 00490099
005000*                                                               * 00500099
005100*---------------------------------------------------------------* 00510099
005200* CRQ 7670 - CHANGE IN WHERE CLAUSE OF THE QUERY FOR PERFORMACE * 00520099
005300*            IMPROVMENT.                                        * 00530099
005400*---------------------------------------------------------------* 00540099
005500* CHG 53622 - REMOVED ALL REFERENCES TO RFID PRINTING.          * 00550099
005600*---------------------------------------------------------------* 00560099
005610*---------------------------------------------------------------* 00561099
005620* DATE:        09/14/2021                                         00562099
005630* WR/IR#:      CHG0261678                                         00563099
005640* PROGRAMMER:  GERMAN BANDA                                       00564099
005650* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00565099
005660*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00566099
005670*              MAKING THE CALL DYNAMIC VS STATIC                  00567099
005680*---------------------------------------------------------------* 00568099
CICS  * CHANGED 11/01/2022    BY JIM HUNTER      WR: CHG0277565         00569099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00569199
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00569299
005680*---------------------------------------------------------------* 00569399
LIMIT * CHANGED 02/02/2023    BY JIM HUNTER      WR: CHG0282069         00569499
LIMIT * THIS PROGRAM ABENDS WHEN THE NUMBER OF UPC ROWS RETURNED        00569599
LIMIT * REACHES 10,000 WHICH HAS OCCURRED WHEN USING THE CSR-MAJ-CL     00569699
LIMIT * (DEPT AND MAJ CL IN SEARCH, BUT NOT SUB CL). THIS WOULD         00569799
LIMIT * SEEM TO BE AN UNINTENTIONAL RESULT SINCE THE SCREEN HOLDS       00569899
LIMIT * ONLY 15 UPC ROWS AND WOULD REQUIRE A LOT OF SCROLLING.          00569999
LIMIT * TO PREVENT THE ABEND AND PROVIDE UP TO 10,000 ROWS FOR          00570099
LIMIT * DISPLAY, PC-MAX-ITEMS IS BEING REDUCED FROM 1 MILLION TO 9,999. 00570199
LIMIT *---------------------------------------------------------------* 00570299
LIMIT * CHANGED 02/09/2023    BY JIM HUNTER      WR: CHG0282707         00570399
LIMIT * PREV CHANGE ACCIDENTALLY SET MAX LIMIT TO 99,999.               00570499
LIMIT * SETTING IT TO 9,998.                                            00570599
LIMIT ******************************************************************00570699
005700                                                                  00571099
005800 ENVIRONMENT DIVISION.                                            00580099
005900                                                                  00590099
006000 DATA DIVISION.                                                   00600099
006100                                                                  00610099
006200 WORKING-STORAGE SECTION.                                         00620099
006300 01  DK-DB2-KEYS.                                                 00630099
006400     15  DK-DEPT-NBR                    PIC S9(04)  COMP-3        00640099
006500                                                    VALUE ZERO.   00650099
006600     15  DK-MAJ-CL                      PIC S9(04)  COMP-3        00660099
006700                                                    VALUE ZERO.   00670099
006800     15  DK-SUB-CL                      PIC S9(04)  COMP-3        00680099
006900                                                    VALUE ZERO.   00690099
007000     15  DK-CLOR-DESC                   PIC  X(10)  VALUE SPACE.  00700099
007100     15  DK-SIZE-DESC                   PIC  X(10)  VALUE SPACE.  00710099
007200     15  DK-LBL-NM                      PIC  X(30)  VALUE SPACE.  00720099
007300     15  DK-VS-NBR                      PIC  X(20)  VALUE SPACE.  00730099
007400     15  DK-STYL-ID                     PIC S9(08)  COMP-3        00740099
007500                                                    VALUE ZERO.   00750099
007600                                                                  00760099
007700 01  PC-PROGRAM-CONSTANTS.                                        00770099
007800     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00780099
007900                                                    'IQ408A  '.   00790099
008000     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00800099
008100                                                    'IQKM408 '.   00810099
008200     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00820099
008300                                                    'IQKCS408'.   00830099
008400     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00840099
008500     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00850099
008600                                                                  00860099
008700*                   IQKCS405 - CLASS LIST                         00870099
008800     05  PC-CLASS-FORMAT-IND            PIC  X(01)  VALUE '1'.    00880099
008900                                                                  00890099
009000*                   IQKCS406 - COLOR LIST                         00900099
009100     05  PC-COLOR-FORMAT-IND            PIC  X(01)  VALUE '2'.    00910099
009200                                                                  00920099
009300*                   IQKCS407 - SIZE LIST                          00930099
009400     05  PC-SIZE-FORMAT-IND             PIC  X(01)  VALUE '3'.    00940099
009500                                                                  00950099
009600*                   IQKCS401 -SIMILAR UPC F21 KEY                 00960099
009700     05  PC-SIMILAR-UPC-FORMAT-IND      PIC  X(01)  VALUE '4'.    00970099
009800                                                                  00980099
009900*                   IQKCS409 - STYLE LIST                         00990099
010000     05  PC-STYLE-FORMAT-IND            PIC  X(01)  VALUE '5'.    01000099
010100                                                                  01010099
010200*     THE '6' IS FROM IQKCS401 F17 KEY                            01020099
010300     05  PC-SIMILAR-STYLE-FORMAT-IND    PIC  X(01)  VALUE '6'.    01030099
010400                                                                  01040099
010500*     THE '7' IS FROM IQKCS401 F22 KEY                            01050099
010600     05  PC-MAJOR-SUB-CLASS-FORMAT-IND  PIC  X(01)  VALUE '7'.    01060099
010700                                                                  01070099
010800**??                                                              01080099
010900*     THE '?' IS FROM IQKCS401 F17 KEY                            01090099
011000     05  PC-SUB-CLASS-FORMAT-IND        PIC  X(01)  VALUE '6'.    01100099
011100                                                                  01110099
011200     05  PC-DEPT-FORMAT-IND             PIC  X(01)  VALUE ' '.    01120099
011300*                                                                 01130099
011400     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +15     01140099
011500                                                    COMP SYNC.    01150099
011600     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01160099
011700                                                    COMP SYNC.    01170099
011800     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01180099
LIMIT                                                     +9998         01190099
012000                                                    COMP-3.       01200099
LIMIT **                                                  +1000000      01201099
012100     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      01210099
012200                                                    COMP SYNC.    01220099
012300     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01230099
012400                                                    COMP-3.       01240099
012500     05  PC-CORPORATE-LOCATION          PIC  9(04)  VALUE 90.     01250099
012600*                                                                 01260099
012700     05  PC-TSYMSG-NUMBERS.                                       01270099
012800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01280099
012900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01290099
013000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01300099
013100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01310099
013200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01320099
013300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01330099
013400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01340099
013500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01350099
013600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01360099
013700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01370099
013800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01380099
014000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01400099
014100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01410099
014200         10  PC-TSYMSG-00457            PIC  9(05)  VALUE 00279.  01420099
014900*                                                                 01490099
015000 01  PS-PROGRAM-SWITCHES.                                         01500099
015100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01510099
015200         88  PS-NO-ERROR                            VALUE 'Y'.    01520099
015300         88  PS-ERROR                               VALUE 'N'.    01530099
015400     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01540099
015500         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01550099
015600         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01560099
015700     05  PS-SKU-SW                      PIC  X(01)  VALUE 'N'.    01570099
015800         88  PS-SKU-FND                             VALUE 'Y'.    01580099
015900         88  PS-SKU-NOT-FND                         VALUE 'N'.    01590099
016000     05  PS-STATUS-MATCH-SW             PIC  X(01)  VALUE 'N'.    01600099
016100         88  PS-STATUS-MATCH                        VALUE 'Y'.    01610099
016200         88  PS-STATUS-NO-MATCH                     VALUE 'N'.    01620099
016600                                                                  01660099
016700*--------------------------------------------------------------*  01670099
016800*    CURSOR EXPLANATION.                                       *  01680099
016900*    FOR ALL CURSORS THE FOLLOWING FIELDS ARE ALWAYS USED.     *  01690099
017000*                                                              *  01700099
017100*        DEPARTMENT (IQKCS404)                                 *  01710099
017200*                                                              *  01720099
017300*    FOR ALL CURSORS, SOME OF THE FOLLOWING FIELDS MAY BE USED.*  01730099
017400*                                                              *  01740099
017500*        VENDOR OR LABEL (IQKCS402)                            *  01750099
017600*        MAJOR CLASS AND SUB CLASS (IQKCS405)                  *  01760099
017700*        STYLE (IQKCS409)                                      *  01770099
017800*        COLOR (IQKCS406)                                      *  01780099
017900*        SIZE (IQKCS407)                                       *  01790099
018000*        MAJOR CLASS (IQKCS401)                                *  01800099
018100*        SUB CLASS (IQKCS401)                                  *  01810099
018200*                                                              *  01820099
018300*--------------------------------------------------------------*  01830099
018400*    NAMING CONVENTION FOR THE CURSOR SWITCHES ARE AS FOLLOWS: *  01840099
018500*        ALL OF THE CURSOR SWITCHES BEGIN WITH CSR-.           *  01850099
018600*        ALL OF THE CURSORS USE THE DEPARTMENT AS SELECTED     *  01860099
018700*            ON IQKCS404.                                      *  01870099
018800*                                                              *  01880099
018900*        IF VENDOR IS USED IN THE CURSOR, IT APPEARS AS VND-.  *  01890099
019000*                                                              *  01900099
019100*        CLASS, COLOR, STYLE, AND SIZE ARE ALL SPELLED OUT     *  01910099
019200*            IF THE CURSOR USES THEM.                          *  01920099
019300*                                                              *  01930099
019400*  FOR EXAMPLE:                                                *  01940099
019500*        CSR-VND-STYLE-COLOR-SIZE  USES THE VENDOR/LABEL NAME, *  01950099
019600*            DEPARTMENT, STYLE, COLOR, AND SIZE VALUES TO      *  01960099
019700*            QUALIFY THE CURSOR.                               *  01970099
019800*                                                              *  01980099
019900*        CSR-CLASS  USES THE DEPARTMENT AND CLASS TO QUALIFY   *  01990099
020000*            THE CURSOR.                                       *  02000099
020100*                                                              *  02010099
020200*    FOLLOWING ARE THE CURSOR SWITCH NAMES AND ASSOCIATED      *  02020099
020300*        CURSOR NAME.                                          *  02030099
020400*                                                              *  02040099
020500*    ALL OF THE FOLLOWING CURSORS USE VENDOR NAME / LABEL.     *  02050099
020600*                                                              *  02060099
020700*     CURSOR SWITCH NAME         CURSOR NAME                   *  02070099
020800*    ------------------------    ------------------            *  02080099
020900*    CSR-VND-CLASS-COLOR-SIZE  - CSR-VND-CLS-CLR-SZ            *  02090099
021000*    CSR-VND-CLASS-COLOR       - CSR-VND-CLS-CLR               *  02100099
021100*    CSR-VND-CLASS             - CSR-VND-CLS                   *  02110099
021200*    CSR-VND-STYLE-COLOR-SIZE  - CSR-VND-STY-CLR-SZ            *  02120099
021300*    CSR-VND-STYLE-COLOR       - CSR-VND-STY-CLR               *  02130099
021400*    CSR-VND-STYLE             - CSR-VND-STY                   *  02140099
021500*    CSR-VND-COLOR-SIZE        - CSR-VND-CLR-SZ                *  02150099
021600*    CSR-VND-COLOR             - CSR-VND-CLR                   *  02160099
021700*                                                              *  02170099
021800*     CURSOR SWITCH NAME         CURSOR NAME                   *  02180099
021900*    ------------------------    ------------------            *  02190099
022000*    CSR-CLASS-COLOR-SIZE      - CSR-CLS-CLR-SZ                *  02200099
022100*    CSR-CLASS-COLOR           - CSR-CLS-CLR                   *  02210099
022200*    CSR-CLASS                 - CSR-CLS                       *  02220099
022300*    CSR-STYLE-COLOR-SIZE      - CSR-STY-CLR-SZ                *  02230099
022400*    CSR-STYLE-COLOR           - CSR-STY-CLR                   *  02240099
022500*    CSR-STYLE                 - CSR-STY                       *  02250099
022600*    CSR-COLOR-SIZE            - CSR-CLR-SZ                    *  02260099
022700*    CSR-COLOR                 - CSR-CLR                       *  02270099
022800*    CSR-MAJOR-CLASS           - CSR-MAJOR-CLASS               *  02280099
022900*    CSR-SUB-CLASS             - CSR-SUB-CLASS                 *  02290099
023000*                                                              *  02300099
023100*--------------------------------------------------------------*  02310099
023200                                                                  02320099
023300     05  PS-CURSOR-SW                   PIC  X(01)  VALUE SPACE.  02330099
023400         88 CSR-VND-CLASS-COLOR-SIZE                VALUE 'A'.    02340099
023500         88 CSR-VND-CLASS-COLOR                     VALUE 'B'.    02350099
023600         88 CSR-VND-CLASS                           VALUE 'C'.    02360099
023700         88 CSR-VND-STYLE-COLOR-SIZE                VALUE 'D'.    02370099
023800         88 CSR-VND-STYLE-COLOR                     VALUE 'E'.    02380099
023900         88 CSR-VND-STYLE                           VALUE 'F'.    02390099
024000         88 CSR-VND-COLOR-SIZE                      VALUE 'G'.    02400099
024100         88 CSR-VND-COLOR                           VALUE 'H'.    02410099
024200                                                                  02420099
024300         88 CSR-CLASS-COLOR-SIZE                    VALUE 'I'.    02430099
024400         88 CSR-CLASS-COLOR                         VALUE 'J'.    02440099
024500         88 CSR-CLASS                               VALUE 'K'.    02450099
024600         88 CSR-STYLE-COLOR-SIZE                    VALUE 'L'.    02460099
024700         88 CSR-STYLE-COLOR                         VALUE 'M'.    02470099
024800         88 CSR-STYLE                               VALUE 'N'.    02480099
024900         88 CSR-COLOR-SIZE                          VALUE 'O'.    02490099
025000         88 CSR-COLOR                               VALUE 'P'.    02500099
025100                                                                  02510099
025200         88 CSR-MAJOR-CLASS                         VALUE 'S'.    02520099
025300         88 CSR-SUB-CLASS                           VALUE 'T'.    02530099
025400                                                                  02540099
025500         88 CSR-STLPGM409                           VALUE 'Q'.    02550099
025600         88 CSR-SIMILAR-STYLE                       VALUE 'Y'.    02560099
025700         88 CSR-SIMILAR                             VALUE 'Z'.    02570099
025800                                                                  02580099
025900 01  IV-INDICATOR-VARIABLES.                                      02590099
026000     05  IV-LAST-NCLR-RTL-AMT           PIC S9(04)  VALUE +0      02600099
026100                                                    COMP SYNC.    02610099
026200                                                                  02620099
026300 01  PV-PROGRAM-VARIABLES.                                        02630099
026400     05  PV-SUB                         PIC S9(04)  VALUE +0      02640099
026500                                                    COMP SYNC.    02650099
026600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02660099
026700                                                    COMP SYNC.    02670099
026800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02680099
026900                                                    COMP-3.       02690099
027000     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02700099
027100                                                    COMP-3.       02710099
027200     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02720099
027300                                                    COMP-3.       02730099
027400     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02740099
027500                                                    COMP-3.       02750099
027600     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02760099
027700                                                    COMP-3.       02770099
027800     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02780099
027900                                                    COMP-3.       02790099
028000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02800099
028100                                                    COMP SYNC.    02810099
028200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02820099
028300                                                    COMP SYNC.    02830099
028400     05  PV-ITEM                        PIC S9(04)  VALUE +0      02840099
028500                                                    COMP SYNC.    02850099
028600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02860099
028700                                                    COMP SYNC.    02870099
028800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02880099
028900                                                    COMP SYNC.    02890099
029000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02900099
029100                                                    COMP SYNC.    02910099
029200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02920099
029300                                                    COMP SYNC.    02930099
029400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02940099
029500                                                    COMP SYNC.    02950099
029600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02960099
029700                                                    COMP SYNC.    02970099
029800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02980099
029900                                                    COMP SYNC.    02990099
030000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03000099
030100                                                    COMP SYNC.    03010099
030200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03020099
030300                                                    COMP SYNC.    03030099
030400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03040099
030500                                                    COMP SYNC.    03050099
030600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03060099
030700                                                    COMP SYNC.    03070099
030800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03080099
030900                                                    COMP SYNC.    03090099
031000     05  PV-STORE-NUMBER          PIC  S9(4) COMP.                03100099
031100     05  PV-INTR-UPC-ID           PIC  S9(9) COMP.                03110099
031200     05  PV-LONG-COMP-UPC-ID      PIC  S9(10)   COMP    VALUE +0. 03120099
031300     05  PV-INTR-UPC-ID-D         PIC  Z(11) VALUE ZEROS.         03130099
031400     05  PV-SQLCODE               PIC +9(9) VALUE ZERO.           03140099
031500     05  PV-STYL-ID               PIC  S9(8) COMP-3 VALUE 0.      03150099
031600     05  PV-END-TMST-NULL         PIC  S9(4) COMP   VALUE 0.      03160099
031700     05  PV-STAT-CDE              PIC  X(02) VALUE SPACES.        03170099
031800     05  PV-UNT-RTL-AMT           PIC  S9(7)V99 COMP-3  VALUE 0.  03180099
031900     05  PV-CUR-UNT-RTL-AMT       PIC  S9(7)V99 COMP-3  VALUE 0.  03190099
032000     05  PV-NUMBER-LABELS         PIC  S9(3)    COMP-3  VALUE 0.  03200099
032100     05  PV-CURSOR-NAME           PIC  X(18) VALUE SPACES.        03210099
032200     05  PV-CURRENT-DATE          PIC X(10).                      03220099
032300                                                                  03230099
035600******************************************************************03560099
035700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03570099
035800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03580099
035900**  APPLICATION-SPECIFIC COMMAREA.                              **03590099
036000******************************************************************03600099
036100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03610099
036200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03620099
036300     05  LQW-ITEM-ENTRIES               OCCURS 15 TIMES           03630099
036400                                        INDEXED BY LQW-IDX.       03640099
036500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03650099
036600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03660099
036700         10  LQW-SELECTED-SW            PIC  X(01).               03670099
036800             88  LQW-SELECT                         VALUE 'S'.    03680099
036900             88  LQW-DESELECT                       VALUE ' '.    03690099
037000         10  LQW-MAJ-CL                     PIC S9(004)           03700099
037100                                                    COMP-3.       03710099
037200         10  LQW-SUB-CL                     PIC S9(004)           03720099
037300                                                    COMP-3.       03730099
037400         10  LQW-UPC-NBR                    PIC S9(015)           03740099
037500                                                    COMP-3.       03750099
037600         10  LQW-STAT-CDE                   PIC X(002).           03760099
037700         10  LQW-CLOR-DESC                  PIC X(010).           03770099
037800         10  LQW-SIZE-DESC                  PIC X(010).           03780099
037900         10  LQW-DET-SKU-DESC               PIC X(020).           03790099
038000         10  LQW-UNT-RTL-AMT                PIC S9(007)V99        03800099
038100                                                    COMP-3.       03810099
038200         10  LQW-CUR-RTL-AMT                PIC S9(007)V99        03820099
038300                                                    COMP-3.       03830099
038400         10  LQW-SKU-NBR                    PIC S9(008)V          03840099
038500                                                     COMP-3.      03850099
038600         10  LQW-STYL-ID                    PIC S9(008)V          03860099
038700                                                     COMP-3.      03870099
038800     EJECT                                                        03880099
038900*---------------------------------------------------------------* 03890099
039000*  RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE             03900099
039100*---------------------------------------------------------------* 03910099
039400     COPY IQWS014.                                                03940099
039500                                                                  03950099
039600     EJECT                                                        03960099
039700*---------------------------------------------------------------* 03970099
039800*    MAP LAYOUT                                                 * 03980099
039900*---------------------------------------------------------------* 03990099
040000                                                                  04000099
040100     COPY IQKM408.                                                04010099
040200*                                                                 04020099
040300 01  MR-OCCURS-LAYOUT                   REDEFINES  IQ408AO.       04030099
040400     05  FILLER                         PIC X(042).               04040099
040500     05  MR-SCROLL-AREA                 OCCURS 15 TIMES.          04050099
040600         10  MR-SELECTL                 PIC S9(04) COMP.          04060099
040700         10  MR-SELECTA                 PIC  X(01).               04070099
040800         10  MR-SELECTC                 PIC  X(01).               04080099
040900         10  MR-SELECTH                 PIC  X(01).               04090099
041000         10  MR-SELECTI                 PIC  X(01).               04100099
041100                                                                  04110099
041200         10  MR-MAJ-CLL                 PIC S9(04) COMP.          04120099
041300         10  MR-MAJ-CLA                 PIC  X(01).               04130099
041400         10  MR-MAJ-CLC                 PIC  X(01).               04140099
041500         10  MR-MAJ-CLH                 PIC  X(01).               04150099
041600         10  MR-MAJ-CLX.                                          04160099
041700             15  MR-MAJ-CL              PIC  9(04).               04170099
041800                                                                  04180099
041900         10  MR-SUB-CLL                 PIC S9(04) COMP.          04190099
042000         10  MR-SUB-CLA                 PIC  X(01).               04200099
042100         10  MR-SUB-CLC                 PIC  X(01).               04210099
042200         10  MR-SUB-CLH                 PIC  X(01).               04220099
042300         10  MR-SUB-CLX.                                          04230099
042400             15  MR-SUB-CL              PIC  9(04).               04240099
042500                                                                  04250099
042600         10  MR-SKU-DESCL               PIC S9(04) COMP.          04260099
042700         10  MR-SKU-DESCA               PIC  X(01).               04270099
042800         10  MR-SKU-DESCC               PIC  X(01).               04280099
042900         10  MR-SKU-DESCH               PIC  X(01).               04290099
043000         10  MR-SKU-DESC                PIC  X(16).               04300099
043100                                                                  04310099
043200         10  MR-UPC-NBRL                PIC S9(04) COMP.          04320099
043300         10  MR-UPC-NBRA                PIC  X(01).               04330099
043400         10  MR-UPC-NBRC                PIC  X(01).               04340099
043500         10  MR-UPC-NBRH                PIC  X(01).               04350099
043600         10  MR-UPC-NBR                 PIC  X(15).               04360099
043700                                                                  04370099
043800         10  MR-STAT-CDEL               PIC S9(04) COMP.          04380099
043900         10  MR-STAT-CDEA               PIC  X(01).               04390099
044000         10  MR-STAT-CDEC               PIC  X(01).               04400099
044100         10  MR-STAT-CDEH               PIC  X(01).               04410099
044200         10  MR-STAT-CDE                PIC  X(02).               04420099
044300                                                                  04430099
044400         10  MR-CLOR-DESCL              PIC S9(04) COMP.          04440099
044500         10  MR-CLOR-DESCA              PIC  X(01).               04450099
044600         10  MR-CLOR-DESCC              PIC  X(01).               04460099
044700         10  MR-CLOR-DESCH              PIC  X(01).               04470099
044800         10  MR-CLOR-DESC               PIC  X(10).               04480099
044900                                                                  04490099
045000         10  MR-SIZE-DESCL              PIC S9(04) COMP.          04500099
045100         10  MR-SIZE-DESCA              PIC  X(01).               04510099
045200         10  MR-SIZE-DESCC              PIC  X(01).               04520099
045300         10  MR-SIZE-DESCH              PIC  X(01).               04530099
045400         10  MR-SIZE-DESC               PIC  X(10).               04540099
045500                                                                  04550099
045600         10  MR-UNT-RTL-AMTL            PIC S9(04) COMP.          04560099
045700         10  MR-UNT-RTL-AMTA            PIC  X(01).               04570099
045800         10  MR-UNT-RTL-AMTC            PIC  X(01).               04580099
045900         10  MR-UNT-RTL-AMTH            PIC  X(01).               04590099
046000         10  MR-UNT-RTL-AMTX.                                     04600099
046100             15  MR-UNT-RTL-AMT         PIC  Z(05).99.            04610099
046200     EJECT                                                        04620099
046300*---------------------------------------------------------------* 04630099
046400*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04640099
046500*---------------------------------------------------------------* 04650099
046600                                                                  04660099
046700     COPY DPWS015.                                                04670099
046800                                                                  04680099
046900*---------------------------------------------------------------* 04690099
047000*    FUNCTION KEYS COPYBOOK.                                    * 04700099
047100*---------------------------------------------------------------* 04710099
047200                                                                  04720099
047300     COPY DPWS016.                                                04730099
047400                                                                  04740099
047500*---------------------------------------------------------------* 04750099
047600*    NUMERIC EDIT LAYOUT.                                       * 04760099
047700*---------------------------------------------------------------* 04770099
047800                                                                  04780099
047900     COPY DPWS010I.                                               04790099
048000                                                                  04800099
048100*---------------------------------------------------------------* 04810099
048200*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04820099
048300*---------------------------------------------------------------* 04830099
048400                                                                  04840099
048500     COPY DPWS030.                                                04850099
CICS       COPY DPWS930.                                                04851099
048600                                                                  04860099
048700*---------------------------------------------------------------* 04870099
048800*    STANDARD COMMAREA.                                         * 04880099
048900*---------------------------------------------------------------* 04890099
049000                                                                  04900099
049100     COPY DPWS020.                                                04910099
049200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04920099
049300*---------------------------------------------------------------* 04930099
049400* INTER-APPLICATION COMMAREA.                                   * 04940099
049500*   IQWS016 - IS THE INPUT LAYOUT WHEN COMING FROM THE PREVIOUS * 04950099
049600*             LIST PROGRAM.                                     * 04960099
049700*   IQWS016 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04970099
049800*             THIS LIST PROGRAM.                                * 04980099
049900*---------------------------------------------------------------* 04990099
050000                                                                  05000099
050100         10  INTER-APPL-COMM-AREA       PIC X(200).               05010099
050200     COPY IQWS016.                                                05020099
050300*---------------------------------------------------------------* 05030099
050400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05040099
050500*        CURRENT LENGTH IS 2700 FOR IQSSKU  MNEMONIC.             05050099
050600*        YOU MUST CHECK THE COMMAREA LENGTH FOR THE MNEMONIC      05060099
050700*            IF YOU ADD ANY MORE FIELDS.                          05070099
050800*---------------------------------------------------------------* 05080099
050900         10  ASC-SPECIFIC-COMMAREA.                               05090099
051000             15  ASC-LIST-KEYS.                                   05100099
051100                 20  ASC-LBL-NM                      PIC  X(30).  05110099
051200                 20  ASC-GP-NBR                      PIC  9(03).  05120099
051300                 20  ASC-DEPT-NBR                    PIC  9(04).  05130099
051400                 20  ASC-MAJ-CL                      PIC  9(04).  05140099
051500                 20  ASC-SUB-CL                      PIC  9(04).  05150099
051600                 20  ASC-SUB-CL-NM                   PIC  X(20).  05160099
051700                 20  ASC-CLOR-DESC                   PIC  X(10).  05170099
051800                 20  ASC-SIZE-DESC                   PIC  X(10).  05180099
051900                 20  ASC-STYL-ID                     PIC  9(08).  05190099
052000                 20  ASC-STATUS                      PIC  X(02).  05200099
052100                 20  ASC-LOCATION-NBR                PIC  9(04).  05210099
052200                 20  ASC-CURSOR-SW                   PIC  X(01).  05220099
052300                 20  ASC-INT-APPL-FORMAT-IND         PIC  X(01).  05230099
052400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05240099
052500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05250099
052600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05260099
052700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05270099
052800                                                                  05280099
052900                 20  ASC-ITEM-ARRAY.                              05290099
053000                     25  ASC-ITEM-ENTRIES OCCURS 15 TIMES.        05300099
053100                         30  ASC-LIST-ITEM-NUMBER                 05310099
053200                                                     PIC S9(09)   05320099
053300                                                     COMP-3.      05330099
053400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05340099
053500                             88  ASC-VALID-SELECT    VALUE ' '    05350099
053600                                                           'S'    05360099
053700                                                           'B'    05370099
053800                                                           'E'.   05380099
053900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05390099
054000                             88  ASC-TEMP-SELECT     VALUE 'S'.   05400099
054100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05410099
054200                             88  ASC-TEMP-END        VALUE 'E'.   05420099
054300                         30  ASC-SELECTED-SW         PIC  X(01).  05430099
054400                             88  ASC-NO-SELECT       VALUE ' '.   05440099
054500                             88  ASC-SELECT          VALUE 'S'.   05450099
054600                             88  ASC-BEGIN           VALUE 'B'.   05460099
054700                             88  ASC-END             VALUE 'E'.   05470099
054800                        30  ASC-DET-MAJ-CL          PIC S9(004)   05480099
054900                                                          COMP-3. 05490099
055000                        30  ASC-DET-SUB-CL          PIC S9(004)   05500099
055100                                                          COMP-3. 05510099
055200                        30  ASC-DET-UPC-NBR         PIC S9(015)   05520099
055300                                                          COMP-3. 05530099
055400                        30  ASC-DET-STAT-CDE        PIC X(002).   05540099
055500                        30  ASC-DET-CLOR-DESC       PIC X(010).   05550099
055600                        30  ASC-DET-SIZE-DESC       PIC X(010).   05560099
055700                        30  ASC-DET-SKU-DESC        PIC X(020).   05570099
055800                        30  ASC-DET-UNT-RTL-AMT     PIC S9(007)V9905580099
055900                                                           COMP-3.05590099
056000                        30  ASC-CUR-UNT-RTL-AMT     PIC S9(007)V9905600099
056100                                                           COMP-3.05610099
056200                        30  ASC-DET-SKU-NBR         PIC S9(008)V  05620099
056300                                                          COMP-3. 05630099
056400                        30  ASC-DET-STYLE           PIC S9(008)V  05640099
056500                                                          COMP-3. 05650099
056600                                                                  05660099
056700             15  ASC-BLK-SUB                         PIC S9(04)   05670099
056800                                                          COMP    05680099
056900                                                          SYNC.   05690099
057000             15  ASC-ITEM-SUB                        PIC S9(04)   05700099
057100                                                          COMP    05710099
057200                                                          SYNC.   05720099
057300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05730099
057400                                                          COMP-3. 05740099
057500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05750099
057600                                                          COMP-3. 05760099
057700             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05770099
057800                                                          COMP-3. 05780099
057900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05790099
058000                                                          COMP-3. 05800099
058100             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05810099
058200                                                          COMP-3. 05820099
058300             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05830099
058400                                                          COMP    05840099
058500                                                          SYNC.   05850099
058600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05860099
058700                                                          COMP-3. 05870099
058800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05880099
058900                                                          COMP-3. 05890099
059000             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05900099
059100                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05910099
059200                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05920099
059300             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05930099
059400                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05940099
059500                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05950099
059600             15  ASC-LIST-QUEUE-NAME.                             05960099
059700                 20  ASC-LIST-TERM-ID                PIC  X(04).  05970099
059800                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05980099
059900                                                          COMP-3. 05990099
060000                 20  ASC-LIST-SEQ                    PIC  9(01).  06000099
060100             15  ASC-SEL-QUEUE-NAME.                              06010099
060200                 20  ASC-SEL-TERM-ID                 PIC  X(04).  06020099
060300                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06030099
060400                                                          COMP-3. 06040099
060500                 20  ASC-SEL-SEQ                     PIC  9(01).  06050099
060600             15  ASC-START-ITEM-REQUEST.                          06060099
060700                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06070099
060800             15  ASC-CLEARANCE-SW                    PIC  X(01).  06080099
060900                 88  ASC-CLEARANCE                   VALUE 'Y'.   06090099
061000                 88  ASC-NOT-CLEARANCE               VALUE 'N'.   06100099
061100             15  ASC-FILLER                          PIC  X(210). 06110099
061200                                                                  06120099
061300*---------------------------------------------------------------* 06130099
061400*    ABEND PROCESSING COPYBOOK.                                 * 06140099
061500*---------------------------------------------------------------* 06150099
061600                                                                  06160099
061700     COPY DPWS013.                                                06170099
061800                                                                  06180099
061900*---------------------------------------------------------------* 06190099
062000*    DB2 AREA FOR TUPC                                          * 06200099
062100*---------------------------------------------------------------* 06210099
062200     EXEC SQL                                                     06220099
062300          INCLUDE TUPC                                            06230099
062400     END-EXEC.                                                    06240099
062500*---------------------------------------------------------------* 06250099
062600*    DB2 AREA FOR XST_SKU_LOC                                   * 06260099
062700*---------------------------------------------------------------* 06270099
062800     EXEC SQL                                                     06280099
062900          INCLUDE XST00008                                        06290099
063000     END-EXEC.                                                    06300099
063100*---------------------------------------------------------------* 06310099
063200*    DB2 AREA FOR TUPCSKU                                       * 06320099
063300*---------------------------------------------------------------* 06330099
063400     EXEC SQL                                                     06340099
063500          INCLUDE TUPCSKU                                         06350099
063600     END-EXEC.                                                    06360099
063700*---------------------------------------------------------------* 06370099
063800*    DB2 AREA FOR TSK                                           * 06380099
063900*---------------------------------------------------------------* 06390099
064000     EXEC SQL                                                     06400099
064100          INCLUDE TSK                                             06410099
064200     END-EXEC.                                                    06420099
064300*---------------------------------------------------------------* 06430099
064400*    DB2 AREA FOR XST_SKU                                         06440099
064500*---------------------------------------------------------------* 06450099
064600     EXEC SQL                                                     06460099
064700          INCLUDE XST00010                                        06470099
064800     END-EXEC.                                                    06480099
064900*---------------------------------------------------------------* 06490099
065000*    DB2 AREA FOR XST_SKU_ATTR                                    06500099
065100*---------------------------------------------------------------* 06510099
065200     EXEC SQL                                                     06520099
065300          INCLUDE XST00011                                        06530099
065400     END-EXEC.                                                    06540099
065500*---------------------------------------------------------------* 06550099
065600*    DB2 AREA FOR XST_UPC                                         06560099
065700*---------------------------------------------------------------* 06570099
065800     EXEC SQL                                                     06580099
065900          INCLUDE XST00012                                        06590099
066000     END-EXEC.                                                    06600099
066100*---------------------------------------------------------------* 06610099
066200*    DB2 AREA FOR XST_VND_STYL                                    06620099
066300*---------------------------------------------------------------* 06630099
066400     EXEC SQL                                                     06640099
066500          INCLUDE XST00013                                        06650099
066600     END-EXEC.                                                    06660099
066700*---------------------------------------------------------------* 06670099
066800*    DB2 AREA FOR XST_VND                                       * 06680099
066900*---------------------------------------------------------------* 06690099
067000     EXEC SQL                                                     06700099
067100          INCLUDE XST00018                                        06710099
067200     END-EXEC.                                                    06720099
067900*---------------------------------------------------------------* 06790099
068000*    DB2 AREA FOR COMMUNICATIONS                                * 06800099
068100*---------------------------------------------------------------* 06810099
068200     EXEC SQL                                                     06820099
068300          INCLUDE SQLCA                                           06830099
068400     END-EXEC.                                                    06840099
068500*---------------------------------------------------------------* 06850099
068600*XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX* 06860099
068700*        ENTRY FROM IQKCS405 (MISSING COLOR AND SIZE)             06870099
068800*        PATH IQKCS404, IQKCS405, IQKCS408                        06880099
068900     EXEC SQL                                                     06890099
069000          DECLARE CSR-VND-CLS CURSOR FOR                          06900099
069100            SELECT  DISTINCT                                      06910099
069200                    H.UPC_NBR,                                    06920099
069300                    D.DEPT_NBR,                                   06930099
069400                    D.MAJ_CL_NBR,                                 06940099
069500                    D.SUB_CL_NBR,                                 06950099
069600                    D.VS_NBR,                                     06960099
069700                    F.SIZE_DESC,                                  06970099
069800                    F.SKU_NBR,                                    06980099
069900                    F.SKU_DESC,                                   06990099
070000                    F.NRF_CLOR_DESC,                              07000099
070100                    F.INTR_UPC_ID,                                07010099
070200                    F.REGN_PRIC_IND                               07020099
070300                 FROM  XST_VND_STYL  D,                           07030099
070400                       XST_VND       E,                           07040099
070500                       XST_SKU       F,                           07050099
070600                       XST_UPC       H                            07060099
070700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         07070099
070800                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           07080099
070900                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           07090099
071000                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           07100099
071100                     AND  D.STYL_ID        =  F.STYL_ID           07110099
071200                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       07120099
071300                     AND  H.UPC_TYP_CDE    = 'I'                  07130099
071400                     AND  D.ENT_ID         =  E.ENT_ID            07140099
071500            UNION                                                 07150099
071600            SELECT  DISTINCT                                      07160099
071700                    H.UPC_NBR,                                    07170099
071800                    D.DEPT_NBR,                                   07180099
071900                    D.MAJ_CL_NBR,                                 07190099
072000                    D.SUB_CL_NBR,                                 07200099
072100                    D.VS_NBR,                                     07210099
072200                    F.SIZE_DESC,                                  07220099
072300                    F.SKU_NBR,                                    07230099
072400                    F.SKU_DESC,                                   07240099
072500                    F.NRF_CLOR_DESC,                              07250099
072600                    F.INTR_UPC_ID,                                07260099
072700                    F.REGN_PRIC_IND                               07270099
072800                 FROM  XST_VND_STYL  D,                           07280099
072900                       XST_SKU       F,                           07290099
073000                       XST_UPC       H                            07300099
073100                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         07310099
073200                     AND  D.LBL_NM         = :DK-LBL-NM           07320099
073300                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           07330099
073400                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           07340099
073500                     AND  D.STYL_ID        =  F.STYL_ID           07350099
073600                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       07360099
073700                     AND  H.UPC_TYP_CDE    = 'I'                  07370099
073800                        ORDER BY 2, 3, 4                          07380099
073900     END-EXEC.                                                    07390099
074000                                                                  07400099
074100*        ENTRY FROM IQKCS406 (MISSING SIZE)                       07410099
074200*        PATH IQKCS404, IQKCS405, IQKCS406, IQKCS408              07420099
074300     EXEC SQL                                                     07430099
074400          DECLARE CSR-VND-CLS-CLR CURSOR FOR                      07440099
074500            SELECT  DISTINCT                                      07450099
074600                    H.UPC_NBR,                                    07460099
074700                    D.DEPT_NBR,                                   07470099
074800                    D.MAJ_CL_NBR,                                 07480099
074900                    D.SUB_CL_NBR,                                 07490099
075000                    D.VS_NBR,                                     07500099
075100                    F.SIZE_DESC,                                  07510099
075200                    F.SKU_NBR,                                    07520099
075300                    F.SKU_DESC,                                   07530099
075400                    F.NRF_CLOR_DESC,                              07540099
075500                    F.INTR_UPC_ID,                                07550099
075600                    F.REGN_PRIC_IND                               07560099
075700                 FROM  XST_VND_STYL  D,                           07570099
075800                       XST_VND       E,                           07580099
075900                       XST_SKU       F,                           07590099
076000                       XST_UPC       H                            07600099
076100                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         07610099
076200                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           07620099
076300                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           07630099
076400                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           07640099
076500                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        07650099
076600                     AND  D.STYL_ID        =  F.STYL_ID           07660099
076700                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       07670099
076800                     AND  H.UPC_TYP_CDE    = 'I'                  07680099
076900                     AND  D.ENT_ID         =  E.ENT_ID            07690099
077000            UNION                                                 07700099
077100            SELECT  DISTINCT                                      07710099
077200                    H.UPC_NBR,                                    07720099
077300                    D.DEPT_NBR,                                   07730099
077400                    D.MAJ_CL_NBR,                                 07740099
077500                    D.SUB_CL_NBR,                                 07750099
077600                    D.VS_NBR,                                     07760099
077700                    F.SIZE_DESC,                                  07770099
077800                    F.SKU_NBR,                                    07780099
077900                    F.SKU_DESC,                                   07790099
078000                    F.NRF_CLOR_DESC,                              07800099
078100                    F.INTR_UPC_ID,                                07810099
078200                    F.REGN_PRIC_IND                               07820099
078300                 FROM  XST_VND_STYL  D,                           07830099
078400                       XST_SKU       F,                           07840099
078500                       XST_UPC       H                            07850099
078600                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         07860099
078700                     AND  D.LBL_NM         = :DK-LBL-NM           07870099
078800                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           07880099
078900                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           07890099
079000                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         07900099
079100                     AND  D.STYL_ID        =  F.STYL_ID           07910099
079200                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       07920099
079300                     AND  H.UPC_TYP_CDE    = 'I'                  07930099
079400                        ORDER BY 2, 3, 4                          07940099
079500     END-EXEC.                                                    07950099
079600                                                                  07960099
079700*        ENTRY FROM IQKCS407                                      07970099
079800*        PATH IQKCS404, IQKCS405, IQKCS406, IQKCS407, IQKCS408    07980099
079900     EXEC SQL                                                     07990099
080000          DECLARE CSR-VND-CLS-CLR-SZ CURSOR FOR                   08000099
080100            SELECT  DISTINCT                                      08010099
080200                    H.UPC_NBR,                                    08020099
080300                    D.DEPT_NBR,                                   08030099
080400                    D.MAJ_CL_NBR,                                 08040099
080500                    D.SUB_CL_NBR,                                 08050099
080600                    D.VS_NBR,                                     08060099
080700                    F.SIZE_DESC,                                  08070099
080800                    F.SKU_NBR,                                    08080099
080900                    F.SKU_DESC,                                   08090099
081000                    F.NRF_CLOR_DESC,                              08100099
081100                    F.INTR_UPC_ID,                                08110099
081200                    F.REGN_PRIC_IND                               08120099
081300                 FROM  XST_VND_STYL  D,                           08130099
081400                       XST_VND       E,                           08140099
081500                       XST_SKU       F,                           08150099
081600                       XST_UPC       H                            08160099
081700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         08170099
081800                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           08180099
081900                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           08190099
082000                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           08200099
082100                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        08210099
082200                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        08220099
082300                     AND  D.STYL_ID        =  F.STYL_ID           08230099
082400                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       08240099
082500                     AND  H.UPC_TYP_CDE    = 'I'                  08250099
082600                     AND  D.ENT_ID         =  E.ENT_ID            08260099
082700            UNION                                                 08270099
082800            SELECT  DISTINCT                                      08280099
082900                    H.UPC_NBR,                                    08290099
083000                    D.DEPT_NBR,                                   08300099
083100                    D.MAJ_CL_NBR,                                 08310099
083200                    D.SUB_CL_NBR,                                 08320099
083300                    D.VS_NBR,                                     08330099
083400                    F.SIZE_DESC,                                  08340099
083500                    F.SKU_NBR,                                    08350099
083600                    F.SKU_DESC,                                   08360099
083700                    F.NRF_CLOR_DESC,                              08370099
083800                    F.INTR_UPC_ID,                                08380099
083900                    F.REGN_PRIC_IND                               08390099
084000                 FROM  XST_VND_STYL  D,                           08400099
084100                       XST_SKU       F,                           08410099
084200                       XST_UPC       H                            08420099
084300                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         08430099
084400                     AND  D.LBL_NM         = :DK-LBL-NM           08440099
084500                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           08450099
084600                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           08460099
084700                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        08470099
084800                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        08480099
084900                     AND  D.STYL_ID        =  F.STYL_ID           08490099
085000                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       08500099
085100                     AND  H.UPC_TYP_CDE    = 'I'                  08510099
085200                        ORDER BY 2, 3, 4                          08520099
085300     END-EXEC.                                                    08530099
085400                                                                  08540099
085500*        ENTRY FROM IQKCS405 (MISSING COLOR AND SIZE)             08550099
085600*        PATH IQKCS404, IQKCS405, IQKCS408                        08560099
085700     EXEC SQL                                                     08570099
085800          DECLARE CSR-VND-STY CURSOR FOR                          08580099
085900            SELECT  DISTINCT                                      08590099
086000                    H.UPC_NBR,                                    08600099
086100                    D.DEPT_NBR,                                   08610099
086200                    D.MAJ_CL_NBR,                                 08620099
086300                    D.SUB_CL_NBR,                                 08630099
086400                    D.VS_NBR,                                     08640099
086500                    F.SIZE_DESC,                                  08650099
086600                    F.SKU_NBR,                                    08660099
086700                    F.SKU_DESC,                                   08670099
086800                    F.NRF_CLOR_DESC,                              08680099
086900                    F.INTR_UPC_ID,                                08690099
087000                    F.REGN_PRIC_IND                               08700099
087100                 FROM  XST_VND_STYL  D,                           08710099
087200                       XST_VND       E,                           08720099
087300                       XST_SKU       F,                           08730099
087400                       XST_UPC       H                            08740099
087500                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         08750099
087600                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           08760099
087700                     AND  D.VS_NBR         = :DK-VS-NBR           08770099
087800                     AND  D.STYL_ID        =  F.STYL_ID           08780099
087900                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       08790099
088000                     AND  H.UPC_TYP_CDE    = 'I'                  08800099
088100                     AND  D.ENT_ID         =  E.ENT_ID            08810099
088200            UNION                                                 08820099
088300            SELECT  DISTINCT                                      08830099
088400                    H.UPC_NBR,                                    08840099
088500                    D.DEPT_NBR,                                   08850099
088600                    D.MAJ_CL_NBR,                                 08860099
088700                    D.SUB_CL_NBR,                                 08870099
088800                    D.VS_NBR,                                     08880099
088900                    F.SIZE_DESC,                                  08890099
089000                    F.SKU_NBR,                                    08900099
089100                    F.SKU_DESC,                                   08910099
089200                    F.NRF_CLOR_DESC,                              08920099
089300                    F.INTR_UPC_ID,                                08930099
089400                    F.REGN_PRIC_IND                               08940099
089500                 FROM  XST_VND_STYL  D,                           08950099
089600                       XST_SKU       F,                           08960099
089700                       XST_UPC       H                            08970099
089800                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         08980099
089900                     AND  D.LBL_NM         = :DK-LBL-NM           08990099
090000                     AND  D.VS_NBR         = :DK-VS-NBR           09000099
090100                     AND  D.STYL_ID        =  F.STYL_ID           09010099
090200                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       09020099
090300                     AND  H.UPC_TYP_CDE    = 'I'                  09030099
090400                        ORDER BY 2, 3, 4                          09040099
090500     END-EXEC.                                                    09050099
090600                                                                  09060099
090700*        ENTRY FROM IQKCS406 (MISSING SIZE)                       09070099
090800*        PATH IQKCS404, IQKCS405, IQKCS406, IQKCS408              09080099
090900     EXEC SQL                                                     09090099
091000          DECLARE CSR-VND-STY-CLR CURSOR FOR                      09100099
091100            SELECT  DISTINCT                                      09110099
091200                    H.UPC_NBR,                                    09120099
091300                    D.DEPT_NBR,                                   09130099
091400                    D.MAJ_CL_NBR,                                 09140099
091500                    D.SUB_CL_NBR,                                 09150099
091600                    D.VS_NBR,                                     09160099
091700                    F.SIZE_DESC,                                  09170099
091800                    F.SKU_NBR,                                    09180099
091900                    F.SKU_DESC,                                   09190099
092000                    F.NRF_CLOR_DESC,                              09200099
092100                    F.INTR_UPC_ID,                                09210099
092200                    F.REGN_PRIC_IND                               09220099
092300                 FROM  XST_VND_STYL  D,                           09230099
092400                       XST_VND       E,                           09240099
092500                       XST_SKU       F,                           09250099
092600                       XST_UPC       H                            09260099
092700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         09270099
092800                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           09280099
092900                     AND  D.VS_NBR         = :DK-VS-NBR           09290099
093000                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        09300099
093100                     AND  D.STYL_ID        =  F.STYL_ID           09310099
093200                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       09320099
093300                     AND  H.UPC_TYP_CDE    = 'I'                  09330099
093400                     AND  D.ENT_ID         =  E.ENT_ID            09340099
093500            UNION                                                 09350099
093600            SELECT  DISTINCT                                      09360099
093700                    H.UPC_NBR,                                    09370099
093800                    D.DEPT_NBR,                                   09380099
093900                    D.MAJ_CL_NBR,                                 09390099
094000                    D.SUB_CL_NBR,                                 09400099
094100                    D.VS_NBR,                                     09410099
094200                    F.SIZE_DESC,                                  09420099
094300                    F.SKU_NBR,                                    09430099
094400                    F.SKU_DESC,                                   09440099
094500                    F.NRF_CLOR_DESC,                              09450099
094600                    F.INTR_UPC_ID,                                09460099
094700                    F.REGN_PRIC_IND                               09470099
094800                 FROM  XST_VND_STYL  D,                           09480099
094900                       XST_SKU       F,                           09490099
095000                       XST_UPC       H                            09500099
095100                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         09510099
095200                     AND  D.LBL_NM         = :DK-LBL-NM           09520099
095300                     AND  D.VS_NBR         = :DK-VS-NBR           09530099
095400                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        09540099
095500                     AND  D.STYL_ID        =  F.STYL_ID           09550099
095600                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       09560099
095700                     AND  H.UPC_TYP_CDE    = 'I'                  09570099
095800                        ORDER BY 2, 3, 4                          09580099
095900     END-EXEC.                                                    09590099
096000                                                                  09600099
096100*        ENTRY FROM IQKCS407                                      09610099
096200*        PATH IQKCS404, IQKCS405, IQKCS406, IQKCS407, IQKCS408    09620099
096300     EXEC SQL                                                     09630099
096400          DECLARE CSR-VND-STY-CLR-SZ CURSOR FOR                   09640099
096500            SELECT  DISTINCT                                      09650099
096600                    H.UPC_NBR,                                    09660099
096700                    D.DEPT_NBR,                                   09670099
096800                    D.MAJ_CL_NBR,                                 09680099
096900                    D.SUB_CL_NBR,                                 09690099
097000                    D.VS_NBR,                                     09700099
097100                    F.SIZE_DESC,                                  09710099
097200                    F.SKU_NBR,                                    09720099
097300                    F.SKU_DESC,                                   09730099
097400                    F.NRF_CLOR_DESC,                              09740099
097500                    F.INTR_UPC_ID,                                09750099
097600                    F.REGN_PRIC_IND                               09760099
097700                 FROM  XST_VND_STYL  D,                           09770099
097800                       XST_VND       E,                           09780099
097900                       XST_SKU       F,                           09790099
098000                       XST_UPC       H                            09800099
098100                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         09810099
098200                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           09820099
098300                     AND  D.VS_NBR         = :DK-VS-NBR           09830099
098400                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        09840099
098500                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        09850099
098600                     AND  D.STYL_ID        =  F.STYL_ID           09860099
098700                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       09870099
098800                     AND  H.UPC_TYP_CDE    = 'I'                  09880099
098900                     AND  D.ENT_ID         =  E.ENT_ID            09890099
099000            UNION                                                 09900099
099100            SELECT  DISTINCT                                      09910099
099200                    H.UPC_NBR,                                    09920099
099300                    D.DEPT_NBR,                                   09930099
099400                    D.MAJ_CL_NBR,                                 09940099
099500                    D.SUB_CL_NBR,                                 09950099
099600                    D.VS_NBR,                                     09960099
099700                    F.SIZE_DESC,                                  09970099
099800                    F.SKU_NBR,                                    09980099
099900                    F.SKU_DESC,                                   09990099
100000                    F.NRF_CLOR_DESC,                              10000099
100100                    F.INTR_UPC_ID,                                10010099
100200                    F.REGN_PRIC_IND                               10020099
100300                 FROM  XST_VND_STYL  D,                           10030099
100400                       XST_SKU       F,                           10040099
100500                       XST_UPC       H                            10050099
100600                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         10060099
100700                     AND  D.LBL_NM         = :DK-LBL-NM           10070099
100800                     AND  D.VS_NBR         = :DK-VS-NBR           10080099
100900                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        10090099
101000                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        10100099
101100                     AND  D.STYL_ID        =  F.STYL_ID           10110099
101200                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       10120099
101300                     AND  H.UPC_TYP_CDE    = 'I'                  10130099
101400                        ORDER BY 2, 3, 4                          10140099
101500     END-EXEC.                                                    10150099
101600                                                                  10160099
101700*        ENTRY FROM IQKCS406 (MISSING CLASS AND SIZE)             10170099
101800*        PATH IQKCS404, IQKCS406, IQKCS408                        10180099
101900     EXEC SQL                                                     10190099
102000          DECLARE CSR-VND-CLR CURSOR FOR                          10200099
102100            SELECT  DISTINCT                                      10210099
102200                    H.UPC_NBR,                                    10220099
102300                    D.DEPT_NBR,                                   10230099
102400                    D.MAJ_CL_NBR,                                 10240099
102500                    D.SUB_CL_NBR,                                 10250099
102600                    D.VS_NBR,                                     10260099
102700                    F.SIZE_DESC,                                  10270099
102800                    F.SKU_NBR,                                    10280099
102900                    F.SKU_DESC,                                   10290099
103000                    F.NRF_CLOR_DESC,                              10300099
103100                    F.INTR_UPC_ID,                                10310099
103200                    F.REGN_PRIC_IND                               10320099
103300                 FROM  XST_VND_STYL  D,                           10330099
103400                       XST_VND       E,                           10340099
103500                       XST_SKU       F,                           10350099
103600                       XST_UPC       H                            10360099
103700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         10370099
103800                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           10380099
103900                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         10390099
104000                     AND  D.STYL_ID        =  F.STYL_ID           10400099
104100                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       10410099
104200                     AND  H.UPC_TYP_CDE    = 'I'                  10420099
104300                     AND  D.ENT_ID         =  E.ENT_ID            10430099
104400            UNION                                                 10440099
104500            SELECT  DISTINCT                                      10450099
104600                    H.UPC_NBR,                                    10460099
104700                    D.DEPT_NBR,                                   10470099
104800                    D.MAJ_CL_NBR,                                 10480099
104900                    D.SUB_CL_NBR,                                 10490099
105000                    D.VS_NBR,                                     10500099
105100                    F.SIZE_DESC,                                  10510099
105200                    F.SKU_NBR,                                    10520099
105300                    F.SKU_DESC,                                   10530099
105400                    F.NRF_CLOR_DESC,                              10540099
105500                    F.INTR_UPC_ID,                                10550099
105600                    F.REGN_PRIC_IND                               10560099
105700                 FROM  XST_VND_STYL  D,                           10570099
105800                       XST_SKU       F,                           10580099
105900                       XST_UPC       H                            10590099
106000                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         10600099
106100                     AND  D.LBL_NM         = :DK-LBL-NM           10610099
106200                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         10620099
106300                     AND  D.STYL_ID        =  F.STYL_ID           10630099
106400                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       10640099
106500                     AND  H.UPC_TYP_CDE    = 'I'                  10650099
106600                        ORDER BY 2, 3, 4                          10660099
106700     END-EXEC.                                                    10670099
106800                                                                  10680099
106900*        ENTRY FROM IQKCS407 (MISSING CLASS)                      10690099
107000*        PATH IQKCS404, IQKCS406, IQKCS407, IQKCS408              10700099
107100     EXEC SQL                                                     10710099
107200          DECLARE CSR-VND-CLR-SZ CURSOR FOR                       10720099
107300            SELECT  DISTINCT                                      10730099
107400                    H.UPC_NBR,                                    10740099
107500                    D.DEPT_NBR,                                   10750099
107600                    D.MAJ_CL_NBR,                                 10760099
107700                    D.SUB_CL_NBR,                                 10770099
107800                    D.VS_NBR,                                     10780099
107900                    F.SIZE_DESC,                                  10790099
108000                    F.SKU_NBR,                                    10800099
108100                    F.SKU_DESC,                                   10810099
108200                    F.NRF_CLOR_DESC,                              10820099
108300                    F.INTR_UPC_ID,                                10830099
108400                    F.REGN_PRIC_IND                               10840099
108500                 FROM  XST_VND_STYL  D,                           10850099
108600                       XST_VND       E,                           10860099
108700                       XST_SKU       F,                           10870099
108800                       XST_UPC       H                            10880099
108900                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         10890099
109000                     AND  E.ENT_NM_DESC    = :DK-LBL-NM           10900099
109100                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         10910099
109200                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        10920099
109300                     AND  D.STYL_ID        =  F.STYL_ID           10930099
109400                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       10940099
109500                     AND  H.UPC_TYP_CDE    = 'I'                  10950099
109600                     AND  D.ENT_ID         =  E.ENT_ID            10960099
109700            UNION                                                 10970099
109800            SELECT  DISTINCT                                      10980099
109900                    H.UPC_NBR,                                    10990099
110000                    D.DEPT_NBR,                                   11000099
110100                    D.MAJ_CL_NBR,                                 11010099
110200                    D.SUB_CL_NBR,                                 11020099
110300                    D.VS_NBR,                                     11030099
110400                    F.SIZE_DESC,                                  11040099
110500                    F.SKU_NBR,                                    11050099
110600                    F.SKU_DESC,                                   11060099
110700                    F.NRF_CLOR_DESC,                              11070099
110800                    F.INTR_UPC_ID,                                11080099
110900                    F.REGN_PRIC_IND                               11090099
111000                 FROM  XST_VND_STYL  D,                           11100099
111100                       XST_SKU       F,                           11110099
111200                       XST_UPC       H                            11120099
111300                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         11130099
111400                     AND  D.LBL_NM         = :DK-LBL-NM           11140099
111500                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         11150099
111600                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        11160099
111700                     AND  D.STYL_ID        =  F.STYL_ID           11170099
111800                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       11180099
111900                     AND  H.UPC_TYP_CDE    = 'I'                  11190099
112000                        ORDER BY 2, 3, 4                          11200099
112100     END-EXEC.                                                    11210099
112200                                                                  11220099
112300*        ENTRY FROM IQKCS409                                      11230099
112400*        PATH IQKCS404, IQKCS409, IQKCS408                        11240099
112500     EXEC SQL                                                     11250099
112600          DECLARE STLPGM409-CSR CURSOR FOR                        11260099
112700            SELECT  DISTINCT                                      11270099
112800                    H.UPC_NBR,                                    11280099
112900                    D.DEPT_NBR,                                   11290099
113000                    D.MAJ_CL_NBR,                                 11300099
113100                    D.SUB_CL_NBR,                                 11310099
113200                    D.STYL_ID,                                    11320099
113300                    D.VS_NBR,                                     11330099
113400                    F.SIZE_DESC,                                  11340099
113500                    F.SKU_NBR,                                    11350099
113600                    F.SKU_DESC,                                   11360099
113700                    F.NRF_CLOR_DESC,                              11370099
113800                    F.INTR_UPC_ID,                                11380099
113900                    F.REGN_PRIC_IND                               11390099
114000                 FROM  XST_VND_STYL  D,                           11400099
114100                       XST_SKU       F,                           11410099
114200                       XST_UPC       H                            11420099
114300                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         11430099
114400                     AND  D.STYL_ID        = :DK-STYL-ID          11440099
114500                     AND  D.STYL_ID        =  F.STYL_ID           11450099
114600                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       11460099
114700                     AND  H.UPC_TYP_CDE    = 'I'                  11470099
114800                     AND  H.LAST_ACTN_CDE  <> 'D'                 11480099
114900     END-EXEC.                                                    11490099
115000                                                                  11500099
115100****************************************************************  11510099
115200*    FOLLOWING ARE ALL OF THE NON-VENDOR OR LABEL CURSORS.     *  11520099
115300*                                                              *  11530099
115400****************************************************************  11540099
115500                                                                  11550099
115600     EXEC SQL                                                     11560099
115700          DECLARE CSR-CLS CURSOR FOR                              11570099
115800            SELECT  DISTINCT                                      11580099
115900                    H.UPC_NBR,                                    11590099
116000                    D.DEPT_NBR,                                   11600099
116100                    D.MAJ_CL_NBR,                                 11610099
116200                    D.SUB_CL_NBR,                                 11620099
116300                    D.VS_NBR,                                     11630099
116400                    F.SIZE_DESC,                                  11640099
116500                    F.SKU_NBR,                                    11650099
116600                    F.SKU_DESC,                                   11660099
116700                    F.NRF_CLOR_DESC,                              11670099
116800                    F.INTR_UPC_ID,                                11680099
116900                    F.REGN_PRIC_IND                               11690099
117000                 FROM  XST_VND_STYL  D,                           11700099
117100                       XST_SKU       F,                           11710099
117200                       XST_UPC       H                            11720099
117300                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         11730099
117400                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           11740099
117500                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           11750099
117600                     AND  D.STYL_ID        =  F.STYL_ID           11760099
117700                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       11770099
117800                     AND  H.UPC_TYP_CDE    = 'I'                  11780099
117900                        ORDER BY 2, 3, 4                          11790099
118000     END-EXEC.                                                    11800099
118100                                                                  11810099
118200     EXEC SQL                                                     11820099
118300          DECLARE CSR-CLS-CLR CURSOR FOR                          11830099
118400            SELECT  DISTINCT                                      11840099
118500                    H.UPC_NBR,                                    11850099
118600                    D.DEPT_NBR,                                   11860099
118700                    D.MAJ_CL_NBR,                                 11870099
118800                    D.SUB_CL_NBR,                                 11880099
118900                    D.VS_NBR,                                     11890099
119000                    F.SIZE_DESC,                                  11900099
119100                    F.SKU_NBR,                                    11910099
119200                    F.SKU_DESC,                                   11920099
119300                    F.NRF_CLOR_DESC,                              11930099
119400                    F.INTR_UPC_ID,                                11940099
119500                    F.REGN_PRIC_IND                               11950099
119600                 FROM  XST_VND_STYL  D,                           11960099
119700                       XST_SKU       F,                           11970099
119800                       XST_UPC       H                            11980099
119900                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         11990099
120000                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           12000099
120100                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           12010099
120200                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         12020099
120300                     AND  D.STYL_ID        =  F.STYL_ID           12030099
120400                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       12040099
120500                     AND  H.UPC_TYP_CDE    = 'I'                  12050099
120600                        ORDER BY 2, 3, 4                          12060099
120700     END-EXEC.                                                    12070099
120800                                                                  12080099
120900     EXEC SQL                                                     12090099
121000          DECLARE CSR-CLS-CLR-SZ CURSOR FOR                       12100099
121100            SELECT  DISTINCT                                      12110099
121200                    H.UPC_NBR,                                    12120099
121300                    D.DEPT_NBR,                                   12130099
121400                    D.MAJ_CL_NBR,                                 12140099
121500                    D.SUB_CL_NBR,                                 12150099
121600                    D.VS_NBR,                                     12160099
121700                    F.SIZE_DESC,                                  12170099
121800                    F.SKU_NBR,                                    12180099
121900                    F.SKU_DESC,                                   12190099
122000                    F.NRF_CLOR_DESC,                              12200099
122100                    F.INTR_UPC_ID,                                12210099
122200                    F.REGN_PRIC_IND                               12220099
122300                 FROM  XST_VND_STYL  D,                           12230099
122400                       XST_SKU       F,                           12240099
122500                       XST_UPC       H                            12250099
122600                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         12260099
122700                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           12270099
122800                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           12280099
122900                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         12290099
123000                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        12300099
123100                     AND  D.STYL_ID        =  F.STYL_ID           12310099
123200                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       12320099
123300                     AND  H.UPC_TYP_CDE    = 'I'                  12330099
123400                        ORDER BY 2, 3, 4                          12340099
123500     END-EXEC.                                                    12350099
123600                                                                  12360099
123700     EXEC SQL                                                     12370099
123800          DECLARE CSR-STY CURSOR FOR                              12380099
123900            SELECT  DISTINCT                                      12390099
124000                    H.UPC_NBR,                                    12400099
124100                    D.DEPT_NBR,                                   12410099
124200                    D.MAJ_CL_NBR,                                 12420099
124300                    D.SUB_CL_NBR,                                 12430099
124400                    D.VS_NBR,                                     12440099
124500                    F.SIZE_DESC,                                  12450099
124600                    F.SKU_NBR,                                    12460099
124700                    F.SKU_DESC,                                   12470099
124800                    F.NRF_CLOR_DESC,                              12480099
124900                    F.INTR_UPC_ID,                                12490099
125000                    F.REGN_PRIC_IND                               12500099
125100                 FROM  XST_VND_STYL  D,                           12510099
125200                       XST_SKU       F,                           12520099
125300                       XST_UPC       H                            12530099
125400                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         12540099
125500                     AND  D.VS_NBR         = :DK-VS-NBR           12550099
125600                     AND  D.STYL_ID        =  F.STYL_ID           12560099
125700                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       12570099
125800                     AND  H.UPC_TYP_CDE    = 'I'                  12580099
125900                        ORDER BY 2, 3, 4                          12590099
126000     END-EXEC.                                                    12600099
126100                                                                  12610099
126200     EXEC SQL                                                     12620099
126300          DECLARE CSR-STY-CLR CURSOR FOR                          12630099
126400            SELECT  DISTINCT                                      12640099
126500                    H.UPC_NBR,                                    12650099
126600                    D.DEPT_NBR,                                   12660099
126700                    D.MAJ_CL_NBR,                                 12670099
126800                    D.SUB_CL_NBR,                                 12680099
126900                    D.VS_NBR,                                     12690099
127000                    F.SIZE_DESC,                                  12700099
127100                    F.SKU_NBR,                                    12710099
127200                    F.SKU_DESC,                                   12720099
127300                    F.NRF_CLOR_DESC,                              12730099
127400                    F.INTR_UPC_ID,                                12740099
127500                    F.REGN_PRIC_IND                               12750099
127600                 FROM  XST_VND_STYL  D,                           12760099
127700                       XST_SKU       F,                           12770099
127800                       XST_UPC       H                            12780099
127900                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         12790099
128000                     AND  D.VS_NBR         = :DK-VS-NBR           12800099
128100                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        12810099
128200                     AND  D.STYL_ID        =  F.STYL_ID           12820099
128300                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       12830099
128400                     AND  H.UPC_TYP_CDE    = 'I'                  12840099
128500                        ORDER BY 2, 3, 4                          12850099
128600     END-EXEC.                                                    12860099
128700                                                                  12870099
128800     EXEC SQL                                                     12880099
128900          DECLARE CSR-STY-CLR-SZ CURSOR FOR                       12890099
129000            SELECT  DISTINCT                                      12900099
129100                    H.UPC_NBR,                                    12910099
129200                    D.DEPT_NBR,                                   12920099
129300                    D.MAJ_CL_NBR,                                 12930099
129400                    D.SUB_CL_NBR,                                 12940099
129500                    D.VS_NBR,                                     12950099
129600                    F.SIZE_DESC,                                  12960099
129700                    F.SKU_NBR,                                    12970099
129800                    F.SKU_DESC,                                   12980099
129900                    F.NRF_CLOR_DESC,                              12990099
130000                    F.INTR_UPC_ID,                                13000099
130100                    F.REGN_PRIC_IND                               13010099
130200                 FROM  XST_VND_STYL  D,                           13020099
130300                       XST_SKU       F,                           13030099
130400                       XST_UPC       H                            13040099
130500                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         13050099
130600                     AND  D.VS_NBR         = :DK-VS-NBR           13060099
130700                     AND  F.NRF_CLOR_DESC  = :DK-CLOR-DESC        13070099
130800                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        13080099
130900                     AND  D.STYL_ID        =  F.STYL_ID           13090099
131000                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       13100099
131100                     AND  H.UPC_TYP_CDE    = 'I'                  13110099
131200                        ORDER BY 2, 3, 4                          13120099
131300     END-EXEC.                                                    13130099
131400                                                                  13140099
131500     EXEC SQL                                                     13150099
131600          DECLARE CSR-CLR CURSOR FOR                              13160099
131700            SELECT  DISTINCT                                      13170099
131800                    H.UPC_NBR,                                    13180099
131900                    D.DEPT_NBR,                                   13190099
132000                    D.MAJ_CL_NBR,                                 13200099
132100                    D.SUB_CL_NBR,                                 13210099
132200                    D.VS_NBR,                                     13220099
132300                    F.SIZE_DESC,                                  13230099
132400                    F.SKU_NBR,                                    13240099
132500                    F.SKU_DESC,                                   13250099
132600                    F.NRF_CLOR_DESC,                              13260099
132700                    F.INTR_UPC_ID,                                13270099
132800                    F.REGN_PRIC_IND                               13280099
132900                 FROM  XST_VND_STYL  D,                           13290099
133000                       XST_SKU       F,                           13300099
133100                       XST_UPC       H                            13310099
133200                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         13320099
133300                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         13330099
133400                     AND  D.STYL_ID        =  F.STYL_ID           13340099
133500                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       13350099
133600                     AND  H.UPC_TYP_CDE    = 'I'                  13360099
133700                        ORDER BY 2, 3, 4                          13370099
133800     END-EXEC.                                                    13380099
133900                                                                  13390099
134000     EXEC SQL                                                     13400099
134100          DECLARE CSR-CLR-SZ CURSOR FOR                           13410099
134200            SELECT  DISTINCT                                      13420099
134300                    H.UPC_NBR,                                    13430099
134400                    D.DEPT_NBR,                                   13440099
134500                    D.MAJ_CL_NBR,                                 13450099
134600                    D.SUB_CL_NBR,                                 13460099
134700                    D.VS_NBR,                                     13470099
134800                    F.SIZE_DESC,                                  13480099
134900                    F.SKU_NBR,                                    13490099
135000                    F.SKU_DESC,                                   13500099
135100                    F.NRF_CLOR_DESC,                              13510099
135200                    F.INTR_UPC_ID,                                13520099
135300                    F.REGN_PRIC_IND                               13530099
135400                 FROM  XST_VND_STYL  D,                           13540099
135500                       XST_SKU       F,                           13550099
135600                       XST_UPC       H                            13560099
135700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         13570099
135800                     AND  F.NRF_CLOR_DESC = :DK-CLOR-DESC         13580099
135900                     AND  F.SIZE_DESC      = :DK-SIZE-DESC        13590099
136000                     AND  D.STYL_ID        =  F.STYL_ID           13600099
136100                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       13610099
136200                     AND  H.UPC_TYP_CDE    = 'I'                  13620099
136300                        ORDER BY 2, 3, 4                          13630099
136400     END-EXEC.                                                    13640099
136500                                                                  13650099
136600*---------------------------------------------------------------* 13660099
136700*        ENTRY FROM IQKCS401 (SIMILAR SKU)                        13670099
136800*---------------------------------------------------------------* 13680099
136900                                                                  13690099
137000     EXEC SQL                                                     13700099
137100          DECLARE SIMILAR-CSR CURSOR FOR                          13710099
137200            SELECT                                                13720099
137300                    UPC.UPC_NBR                                   13730099
137400                                                                  13740099
137500                   ,VNDSTYL.DEPT_NBR                              13750099
137600                   ,VNDSTYL.MAJ_CL_NBR                            13760099
137700                   ,VNDSTYL.SUB_CL_NBR                            13770099
137800                   ,VNDSTYL.STYL_ID                               13780099
137900                   ,VNDSTYL.VS_NBR                                13790099
138000                                                                  13800099
138100                   ,SKU.SIZE_DESC                                 13810099
138200                   ,SKU.SKU_NBR                                   13820099
138300                   ,SKU.SKU_DESC                                  13830099
138400                   ,SKU.NRF_CLOR_DESC                             13840099
138500                   ,SKU.INTR_UPC_ID                               13850099
138600                   ,SKU.REGN_PRIC_IND                             13860099
138700                                                                  13870099
138800              FROM  XST_VND_STYL  VNDSTYL                         13880099
138900                   ,XST_SKU       SKU                             13890099
139000                   ,XST_UPC       UPC                             13900099
139100                                                                  13910099
139200             WHERE  VNDSTYL.STYL_ID   = :PV-STYL-ID               13920099
139300               AND  VNDSTYL.STYL_ID   =  SKU.STYL_ID              13930099
139400               AND  SKU.INTR_UPC_ID   =  UPC.INTR_UPC_ID          13940099
139500               AND  UPC.UPC_TYP_CDE   = 'I'                       13950099
139600                                                                  13960099
139700          ORDER BY  SKU.SIZE_DESC                                 13970099
139800                   ,SKU.NRF_CLOR_DESC                             13980099
139900                                                                  13990099
140000     END-EXEC.                                                    14000099
140100                                                                  14010099
140200*---------------------------------------------------------------* 14020099
140300*        ENTRY FROM IQKCS401 (STYLE SKU)                          14030099
140400*---------------------------------------------------------------* 14040099
140500                                                                  14050099
140600     EXEC SQL                                                     14060099
140700          DECLARE SIMILAR-STYLE-CSR CURSOR FOR                    14070099
140800            SELECT                                                14080099
140900                    UPC.UPC_NBR                                   14090099
141000                                                                  14100099
141100                   ,VNDSTYL.DEPT_NBR                              14110099
141200                   ,VNDSTYL.MAJ_CL_NBR                            14120099
141300                   ,VNDSTYL.SUB_CL_NBR                            14130099
141400                   ,VNDSTYL.STYL_ID                               14140099
141500                   ,VNDSTYL.VS_NBR                                14150099
141600                                                                  14160099
141700                   ,SKU.SIZE_DESC                                 14170099
141800                   ,SKU.SKU_NBR                                   14180099
141900                   ,SKU.SKU_DESC                                  14190099
142000                   ,SKU.NRF_CLOR_DESC                             14200099
142100                   ,SKU.INTR_UPC_ID                               14210099
142200                   ,SKU.REGN_PRIC_IND                             14220099
142300                                                                  14230099
142400              FROM  XST_VND_STYL  VNDSTYL                         14240099
142500                   ,XST_SKU       SKU                             14250099
142600                   ,XST_UPC       UPC                             14260099
142700                                                                  14270099
142800             WHERE  VNDSTYL.VS_NBR    = :IQ016-VS-NBR             14280099
142900               AND  VNDSTYL.STYL_ID   =  SKU.STYL_ID              14290099
143000               AND  SKU.INTR_UPC_ID   =  UPC.INTR_UPC_ID          14300099
143100               AND  UPC.UPC_TYP_CDE   = 'I'                       14310099
143200                                                                  14320099
143300          ORDER BY  SKU.SIZE_DESC                                 14330099
143400                   ,SKU.NRF_CLOR_DESC                             14340099
143500                                                                  14350099
143600     END-EXEC.                                                    14360099
143700                                                                  14370099
143800*        ENTRY FROM IQKCS401 - F22                                14380099
143900*        PATH IQKCS401 - DEPARTMENT AND MAJOR CLASS               14390099
144000     EXEC SQL                                                     14400099
144100          DECLARE CSR-MAJOR-CLASS CURSOR FOR                      14410099
144200            SELECT  DISTINCT                                      14420099
144300                    H.UPC_NBR,                                    14430099
144400                    D.DEPT_NBR,                                   14440099
144500                    D.MAJ_CL_NBR,                                 14450099
144600                    D.SUB_CL_NBR,                                 14460099
144700                    D.VS_NBR,                                     14470099
144800                    F.SIZE_DESC,                                  14480099
144900                    F.SKU_NBR,                                    14490099
145000                    F.SKU_DESC,                                   14500099
145100                    F.NRF_CLOR_DESC,                              14510099
145200                    F.INTR_UPC_ID,                                14520099
145300                    F.REGN_PRIC_IND                               14530099
145400                 FROM  XST_VND_STYL  D,                           14540099
145500                       XST_SKU       F,                           14550099
145600                       XST_UPC       H                            14560099
145700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         14570099
145800                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           14580099
145900                     AND  D.STYL_ID        =  F.STYL_ID           14590099
146000                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       14600099
146100                     AND  H.UPC_TYP_CDE    = 'I'                  14610099
146200            UNION                                                 14620099
146300            SELECT  DISTINCT                                      14630099
146400                    H.UPC_NBR,                                    14640099
146500                    D.DEPT_NBR,                                   14650099
146600                    D.MAJ_CL_NBR,                                 14660099
146700                    D.SUB_CL_NBR,                                 14670099
146800                    D.VS_NBR,                                     14680099
146900                    F.SIZE_DESC,                                  14690099
147000                    F.SKU_NBR,                                    14700099
147100                    F.SKU_DESC,                                   14710099
147200                    F.NRF_CLOR_DESC,                              14720099
147300                    F.INTR_UPC_ID,                                14730099
147400                    F.REGN_PRIC_IND                               14740099
147500                 FROM  XST_VND_STYL  D,                           14750099
147600                       XST_SKU       F,                           14760099
147700                       XST_UPC       H                            14770099
147800                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         14780099
147900                     AND  D.MAJ_CL_NBR     = :DK-MAJ-CL           14790099
148000                     AND  D.STYL_ID        =  F.STYL_ID           14800099
148100                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       14810099
148200                     AND  H.UPC_TYP_CDE    = 'I'                  14820099
148300                        ORDER BY 2, 3, 4                          14830099
148400     END-EXEC.                                                    14840099
148500                                                                  14850099
148600                                                                  14860099
148700                                                                  14870099
148800*        ENTRY FROM IQKCS401                                      14880099
148900*        PATH IQKCS401   DEPARTMENT AND SUB CLASS                 14890099
149000     EXEC SQL                                                     14900099
149100          DECLARE CSR-SUB-CLASS CURSOR FOR                        14910099
149200            SELECT  DISTINCT                                      14920099
149300                    H.UPC_NBR,                                    14930099
149400                    D.DEPT_NBR,                                   14940099
149500                    D.MAJ_CL_NBR,                                 14950099
149600                    D.SUB_CL_NBR,                                 14960099
149700                    D.VS_NBR,                                     14970099
149800                    F.SIZE_DESC,                                  14980099
149900                    F.SKU_NBR,                                    14990099
150000                    F.SKU_DESC,                                   15000099
150100                    F.NRF_CLOR_DESC,                              15010099
150200                    F.INTR_UPC_ID,                                15020099
150300                    F.REGN_PRIC_IND                               15030099
150400                 FROM  XST_VND_STYL  D,                           15040099
150500                       XST_SKU       F,                           15050099
150600                       XST_UPC       H                            15060099
150700                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         15070099
150800                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           15080099
150900                     AND  D.STYL_ID        =  F.STYL_ID           15090099
151000                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       15100099
151100                     AND  H.UPC_TYP_CDE    = 'I'                  15110099
151200            UNION                                                 15120099
151300            SELECT  DISTINCT                                      15130099
151400                    H.UPC_NBR,                                    15140099
151500                    D.DEPT_NBR,                                   15150099
151600                    D.MAJ_CL_NBR,                                 15160099
151700                    D.SUB_CL_NBR,                                 15170099
151800                    D.VS_NBR,                                     15180099
151900                    F.SIZE_DESC,                                  15190099
152000                    F.SKU_NBR,                                    15200099
152100                    F.SKU_DESC,                                   15210099
152200                    F.NRF_CLOR_DESC,                              15220099
152300                    F.INTR_UPC_ID,                                15230099
152400                    F.REGN_PRIC_IND                               15240099
152500                 FROM  XST_VND_STYL  D,                           15250099
152600                       XST_SKU       F,                           15260099
152700                       XST_UPC       H                            15270099
152800                   WHERE  D.DEPT_NBR       = :DK-DEPT-NBR         15280099
152900                     AND  D.SUB_CL_NBR     = :DK-SUB-CL           15290099
153000                     AND  D.STYL_ID        =  F.STYL_ID           15300099
153100                     AND  F.INTR_UPC_ID    =  H.INTR_UPC_ID       15310099
153200                     AND  H.UPC_TYP_CDE    = 'I'                  15320099
153300                        ORDER BY 2, 3, 4                          15330099
153400     END-EXEC.                                                    15340099
153500                                                                  15350099
153600 LINKAGE SECTION.                                                 15360099
153700                                                                  15370099
153800 01  DFHCOMMAREA.                                                 15380099
153900     05  FILLER                         OCCURS  1 TO 4072 TIMES   15390099
154000                                        DEPENDING ON EIBCALEN.    15400099
154100         10  FILLER                     PIC X.                    15410099
154200                                                                  15420099
154300 EJECT                                                            15430099
154400 PROCEDURE DIVISION.                                              15440099
154500******************************************************************15450099
154600**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **15460099
154700**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **15470099
154800**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **15480099
154900******************************************************************15490099
155000 0000-MAIN-MODULE.                                                15500099
155100     INITIALIZE DP030-CICS-API-FIELDS.                            15510099
155200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       15520099
155300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          15530099
155400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         15540099
155500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       15550099
155600                                                                  15560099
155700     MOVE LENGTH OF IQ408AI        TO DP030-MAP-LENGTH (1).       15570099
155800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     15580099
155900     PERFORM 0001-CALL-CICS-ARCH-API.                             15590099
156000*                                                                 15600099
156100     PERFORM 1000-CONTROL-PROCESSING                              15610099
156200*                                                                 15620099
156300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     15630099
156400     PERFORM 0001-CALL-CICS-ARCH-API.                             15640099
156500                                                                  15650099
156600******************************************************************15660099
156700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **15670099
156800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **15680099
156900******************************************************************15690099
157000 0001-CALL-CICS-ARCH-API.                                         15700099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      15710099
157200                                    DFHCOMMAREA                   15720099
157300                                    DP030-CICS-API-FIELDS         15730099
157400                                    DP020-STANDARD-COMMAREA       15740099
157500                                    IQ408AI.                      15750099
157600*                                                                 15760099
157700     IF  DP030-RC-CALL-SUCCESSFUL                                 15770099
157800         CONTINUE                                                 15780099
157900     ELSE                                                         15790099
158000         SET DP013-NO-ROLLBACK                                    15800099
158100             DP013-XCTL-DISPLAY-RESTART                           15810099
158200             DP013-CICS-ABEND      TO TRUE                        15820099
158300         MOVE '0001-CALL-CICS-ARCH-API'                           15830099
158400                                   TO DP013-PARAGRAPH             15840099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O15841099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      15842099
158700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      15870099
158800         PERFORM DP013-0000-PROCESS-ABEND                         15880099
158900     END-IF.                                                      15890099
159000*----------------------------------------------------------------*15900099
159100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *15910099
159200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *15920099
159300*                                                                *15930099
159400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *15940099
159500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *15950099
159600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *15960099
159700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *15970099
159800*----------------------------------------------------------------*15980099
159900                                                                  15990099
160000 1000-CONTROL-PROCESSING.                                         16000099
160100                                                                  16010099
160200     EVALUATE TRUE                                                16020099
160300         WHEN DP020-NEXT-ACT-INITIAL                              16030099
160400             INITIALIZE ASC-SPECIFIC-COMMAREA                     16040099
160500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            16050099
160600                                      ASC-SEL-TERM-ID             16060099
160700             MOVE DP020-SRC-TASK-NUMBER                           16070099
160800                                   TO ASC-LIST-TASK-NUMBER        16080099
160900                                      ASC-SEL-TASK-NUMBER         16090099
161000             MOVE PC-LIST-QUEUE-SEQ                               16100099
161100                                   TO ASC-LIST-SEQ                16110099
161200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 16120099
161300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 16130099
161400***-----$TEMPLATE NOTE$-------------------------------------------16140099
161500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,16150099
161600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  16160099
161700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.16170099
161800***---------------------------------------------------------------16180099
161900             IF  PS-COMMAREA-NOT-VALID                            16190099
162000                 SET DP020-NEXT-ACT-APPL-ERROR                    16200099
162100                                   TO TRUE                        16210099
162200             ELSE                                                 16220099
162300                 PERFORM 4000-BUILD-INITIAL-PANEL                 16230099
162400             END-IF                                               16240099
162500                                                                  16250099
162600         WHEN DP020-NEXT-ACT-READ-MAP                             16260099
162700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        16270099
162800                                   TO PV-TOP-ITEM                 16280099
162900             PERFORM 2000-PROCESS-PANEL                           16290099
163000                                                                  16300099
163100         WHEN DP020-NEXT-ACT-RETURN                               16310099
163200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        16320099
163300                                   TO PV-TOP-ITEM                 16330099
163400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    16340099
163500             MOVE ASC-CURSOR-SW    TO PS-CURSOR-SW                16350099
163600             PERFORM 6500-REINIT-IQ016-FLDS                       16360099
163700             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 16370099
163800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16380099
163900                                                                  16390099
164000         WHEN OTHER                                               16400099
164100             SET DP013-LOGIC-ABEND TO TRUE                        16410099
164200             SET DP013-NO-ROLLBACK TO TRUE                        16420099
164300             MOVE '1000-CONTROL-PROCESSING'                       16430099
164400                                   TO DP013-PARAGRAPH             16440099
164500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    16450099
164600                                   TO DP013-MESSAGE-TEXT(1)       16460099
164700             PERFORM DP013-0000-PROCESS-ABEND                     16470099
164800     END-EVALUATE.                                                16480099
164900                                                                  16490099
165000 EJECT                                                            16500099
165100*----------------------------------------------------------------*16510099
165200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *16520099
165300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *16530099
165400*----------------------------------------------------------------*16540099
165500                                                                  16550099
165600 1100-PROCESS-INTER-APPL-COMM.                                    16560099
165700                                                                  16570099
165800     SET PS-COMMAREA-VALID         TO TRUE.                       16580099
165900     MOVE DP020-LOCATION-NBR       TO PV-STORE-NUMBER.            16590099
166000     MOVE IQ016-STORE-NO           TO ASC-LOCATION-NBR.           16600099
166100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     16610099
166200                                                                  16620099
166300     IF  DP020-INT-APPL-FORMAT-IND = PC-CLASS-FORMAT-IND          16630099
166400         MOVE SPACES                   TO IQ016-CLOR-DESC         16640099
166500         MOVE SPACES                   TO IQ016-SIZE-DESC         16650099
166600     END-IF.                                                      16660099
166700                                                                  16670099
166800     MOVE DP020-INT-APPL-FORMAT-IND TO                            16680099
166900                         ASC-INT-APPL-FORMAT-IND.                 16690099
167000                                                                  16700099
167100*        ENTRY FROM IQKCS401 - SIMILAR UPC                        16710099
167200     IF  DP020-INT-APPL-FORMAT-IND = PC-SIMILAR-UPC-FORMAT-IND    16720099
167300         PERFORM 4330-SELECT-STYL-ID                              16730099
167400     END-IF.                                                      16740099
167500                                                                  16750099
167600*        ENTRY FROM IQKCS406                                      16760099
167700     IF  DP020-INT-APPL-FORMAT-IND = PC-COLOR-FORMAT-IND          16770099
167800         MOVE SPACES                   TO IQ016-SIZE-DESC         16780099
167900     END-IF.                                                      16790099
168000                                                                  16800099
168100*        ENTRY FROM IQKCS409                                      16810099
168200     IF  DP020-INT-APPL-FORMAT-IND = PC-STYLE-FORMAT-IND          16820099
168300         MOVE SPACES                   TO IQ016-LBL-NM            16830099
168400         MOVE ZEROES                   TO IQ016-GP-NBR            16840099
168500         MOVE SPACES                   TO IQ016-GP-DESC           16850099
168600         MOVE ZEROES                   TO IQ016-MAJ-CL            16860099
168700         MOVE ZEROES                   TO IQ016-SUB-CL            16870099
168800         MOVE SPACES                   TO IQ016-SUB-CL-NM         16880099
168900         MOVE SPACES                   TO IQ016-CLOR-DESC         16890099
169000         MOVE SPACES                   TO IQ016-SIZE-DESC         16900099
169100         MOVE ZEROES                   TO IQ016-SKU-NBR           16910099
169200         MOVE ZEROES                   TO IQ016-UPC-NO            16920099
169300     END-IF.                                                      16930099
169400                                                                  16940099
169500     IF  DP020-INT-APPL-FORMAT-IND = PC-DEPT-FORMAT-IND           16950099
169600     OR  DP020-INT-APPL-FORMAT-IND = PC-CLASS-FORMAT-IND          16960099
169700     OR  DP020-INT-APPL-FORMAT-IND = PC-COLOR-FORMAT-IND          16970099
169800     OR  DP020-INT-APPL-FORMAT-IND = PC-SIZE-FORMAT-IND           16980099
169900     OR  DP020-INT-APPL-FORMAT-IND = PC-SIMILAR-UPC-FORMAT-IND    16990099
170000     OR  DP020-INT-APPL-FORMAT-IND = PC-STYLE-FORMAT-IND          17000099
170100     OR  DP020-INT-APPL-FORMAT-IND = PC-SIMILAR-STYLE-FORMAT-IND  17010099
170200     OR DP020-INT-APPL-FORMAT-IND = PC-MAJOR-SUB-CLASS-FORMAT-IND 17020099
170300         MOVE IQ016-LBL-NM       TO ASC-LBL-NM                    17030099
170400                                    DK-LBL-NM                     17040099
170500         MOVE IQ016-GP-NBR       TO ASC-GP-NBR                    17050099
170600         MOVE IQ016-DEPT-NBR     TO ASC-DEPT-NBR                  17060099
170700                                    DK-DEPT-NBR                   17070099
170800         MOVE IQ016-MAJ-CL       TO ASC-MAJ-CL                    17080099
170900                                    DK-MAJ-CL                     17090099
171000         MOVE IQ016-SUB-CL       TO ASC-SUB-CL                    17100099
171100                                    DK-SUB-CL                     17110099
171200         MOVE IQ016-SUB-CL-NM    TO ASC-SUB-CL-NM                 17120099
171300         MOVE IQ016-CLOR-DESC    TO ASC-CLOR-DESC                 17130099
171400                                    DK-CLOR-DESC                  17140099
171500         MOVE IQ016-SIZE-DESC    TO ASC-SIZE-DESC                 17150099
171600                                    DK-SIZE-DESC                  17160099
171700         MOVE IQ016-STYLE-ID     TO DK-STYL-ID                    17170099
171800                                    ASC-STYL-ID                   17180099
171900         MOVE IQ016-STATUS       TO ASC-STATUS                    17190099
172000     ELSE                                                         17200099
172100         IF  DP020-NAV-KEY-DATA > SPACE                           17210099
172200             MOVE DP020-NAV-KEY-DATA TO                           17220099
172300                                    ASC-LBL-NM                    17230099
172400                                    DK-LBL-NM                     17240099
172500                                    ASC-DEPT-NBR                  17250099
172600                                    DK-DEPT-NBR                   17260099
172700                                    ASC-MAJ-CL                    17270099
172800                                    DK-MAJ-CL                     17280099
172900                                    ASC-SUB-CL                    17290099
173000                                    DK-SUB-CL                     17300099
173100                                    ASC-CLOR-DESC                 17310099
173200                                    DK-CLOR-DESC                  17320099
173300                                    ASC-SIZE-DESC                 17330099
173400                                    DK-SIZE-DESC                  17340099
173500         END-IF                                                   17350099
173600     END-IF.                                                      17360099
173700                                                                  17370099
173800 EJECT                                                            17380099
173900*----------------------------------------------------------------*17390099
174000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *17400099
174100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *17410099
174200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *17420099
174300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *17430099
174400* FUNCTION KEYS CAN GET THIS FAR.                                *17440099
174500*----------------------------------------------------------------*17450099
174600                                                                  17460099
174700 2000-PROCESS-PANEL.                                              17470099
174800     EVALUATE TRUE                                                17480099
174900         WHEN DP020-SRC-AID = DP016-CLEAR                         17490099
175000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    17500099
175100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17510099
175200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17520099
175300                                                                  17530099
175400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    17540099
175500             MOVE ASC-LBL-NM    TO DK-LBL-NM                      17550099
175600             MOVE ASC-DEPT-NBR  TO DK-DEPT-NBR                    17560099
175700             MOVE ASC-MAJ-CL    TO DK-MAJ-CL                      17570099
175800             MOVE ASC-SUB-CL    TO DK-SUB-CL                      17580099
175900             MOVE ASC-SIZE-DESC TO DK-SIZE-DESC                   17590099
176000             MOVE ASC-CLOR-DESC TO DK-CLOR-DESC                   17600099
176100                                                                  17610099
176200             PERFORM 2050-DELETE-LIST-QUEUE                       17620099
176300             PERFORM 4000-BUILD-INITIAL-PANEL                     17630099
176400                                                                  17640099
176500         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    17650099
176600             PERFORM 2140-DESELECT-ALL-ITEMS                      17660099
176700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17670099
176800                                                                  17680099
176900         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  17690099
177000             PERFORM 2150-SELECT-ALL-ITEMS                        17700099
177100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17710099
177200                                                                  17720099
177300         WHEN OTHER                                               17730099
177400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 17740099
177500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17750099
177600             IF  PS-NO-ERROR                                      17760099
177700                 SET DP030-CONTINUE-GO                            17770099
177800                                 TO TRUE                          17780099
177900                 PERFORM 2100-CHECK-FUNCTION-KEY                  17790099
178000             ELSE                                                 17800099
178100                 SET DP030-OVERRIDE-GO                            17810099
178200                                 TO TRUE                          17820099
178300             END-IF                                               17830099
178400     END-EVALUATE.                                                17840099
178500 EJECT                                                            17850099
178600*----------------------------------------------------------------*17860099
178700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *17870099
178800*----------------------------------------------------------------*17880099
178900 2050-DELETE-LIST-QUEUE.                                          17890099
179000                                                                  17900099
179100     EXEC CICS                                                    17910099
179200         DELETEQ TS                                               17920099
179300             QUEUE (ASC-LIST-QUEUE-NAME)                          17930099
179400             RESP  (PV-CICS-RESP)                                 17940099
179500     END-EXEC.                                                    17950099
179600                                                                  17960099
179700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       17970099
179800        (PV-CICS-RESP = DFHRESP(QIDERR))                          17980099
179900         CONTINUE                                                 17990099
180000     ELSE                                                         18000099
180100         SET DP013-CICS-ABEND      TO TRUE                        18010099
180200         SET DP013-NO-ROLLBACK     TO TRUE                        18020099
180300                                                                  18030099
180400         MOVE '2050-DELETE-LIST-QUEUE'                            18040099
180500                                   TO DP013-PARAGRAPH             18050099
180600         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    18060099
180700                                   TO DP013-MESSAGE-TEXT (1)      18070099
180800         PERFORM DP013-0000-PROCESS-ABEND                         18080099
180900     END-IF.                                                      18090099
181000                                                                  18100099
181100     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  18110099
181200                                                                  18120099
181300*----------------------------------------------------------------*18130099
181400* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*18140099
181500* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *18150099
181600* CICS ARCHITECTURE API.                                         *18160099
181700*----------------------------------------------------------------*18170099
181800 2100-CHECK-FUNCTION-KEY.                                         18180099
181900     EVALUATE TRUE                                                18190099
182000         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               18200099
182100**           LOCAL-01 - UPC INQ - IQIUPCST - F17 - IQKCS414       18210099
182200             IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO              18220099
182300**               --  A LIST ITEM MUST BE SELECTED --              18230099
182400                 MOVE PC-TSYMSG-00057                             18240099
182500                                   TO DP020-MSG-NUMBER            18250099
182600                 SET DP020-MSG-FATAL                              18260099
182700                     DP030-OVERRIDE-GO                            18270099
182800                                   TO TRUE                        18280099
182900             ELSE                                                 18290099
183000                 INITIALIZE IQ016-INTER-APPL-COMMAREA             18300099
183100                 IF ASC-LOCATION-NBR = 0                          18310099
183200                    MOVE DP020-LOCATION-NBR TO ASC-LOCATION-NBR   18320099
183300                 END-IF                                           18330099
183400                                                                  18340099
183500                 MOVE ASC-LOCATION-NBR TO IQ016-STORE-NO          18350099
183600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                18360099
183700                                TO IQ016-NUMBER-OF-SELECTED-ITEMS 18370099
183800                 PERFORM 5000-PREPARE-SEL-QUEUE                   18380099
183900             END-IF                                               18390099
184000                                                                  18400099
187200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  18720099
187300             MOVE +1               TO PV-TOP-ITEM                 18730099
187400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18740099
187500                                                                  18750099
187600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   18760099
187700             PERFORM 2110-BROWSE-BACKWARD                         18770099
187800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18780099
187900                                                                  18790099
188000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   18800099
188100             PERFORM 2120-BROWSE-FORWARD                          18810099
188200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18820099
188300                                                                  18830099
188400         WHEN DP020-SRC-AID = DP016-ENTER                         18840099
188500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   18850099
188600             IF  PS-ERROR                                         18860099
188700                 CONTINUE                                         18870099
188800             ELSE                                                 18880099
188900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18890099
189000             END-IF                                               18900099
189100                                                                  18910099
189200         WHEN OTHER                                               18920099
189300             SET DP013-NO-ROLLBACK                                18930099
189400                 DP013-XCTL-DISPLAY-RESTART                       18940099
189500                 DP013-CICS-ABEND  TO TRUE                        18950099
189600             MOVE '2100-CHECK-FUNCTION-KEY'                       18960099
189700                                   TO DP013-PARAGRAPH             18970099
189800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      18980099
189900                                   TO DP013-MESSAGE-TEXT (1)      18990099
190000             PERFORM DP013-0000-PROCESS-ABEND                     19000099
190100     END-EVALUATE.                                                19010099
190200*                                                                 19020099
190300*----------------------------------------------------------------*19030099
190400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *19040099
190500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *19050099
190600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *19060099
190700*----------------------------------------------------------------*19070099
190800                                                                  19080099
190900 2110-BROWSE-BACKWARD.                                            19090099
191000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    19100099
191100         GIVING PV-TOP-ITEM.                                      19110099
191200*                                                                 19120099
191300     IF  ((PV-TOP-ITEM < +1)                                      19130099
191400       OR (PV-TOP-ITEM = +1))                                     19140099
191500         MOVE +1                   TO PV-TOP-ITEM                 19150099
191600*        -- TOP OF LIST --                                        19160099
191700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            19170099
191800         SET DP020-MSG-INFORMATIONAL TO TRUE                      19180099
191900     END-IF.                                                      19190099
192000                                                                  19200099
192100 EJECT                                                            19210099
192200*----------------------------------------------------------------*19220099
192300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *19230099
192400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *19240099
192500*    PAST THE END, ISSUE THE BOTTOM OF LIST                      *19250099
192600*----------------------------------------------------------------*19260099
192700                                                                  19270099
192800 2120-BROWSE-FORWARD.                                             19280099
192900                                                                  19290099
193000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              19300099
193100         GIVING PV-TOP-ITEM.                                      19310099
193200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   19320099
193300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            19330099
193400                                   TO PV-TOP-ITEM                 19340099
193500*        -- BOTTOM OF LIST --                                     19350099
193600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            19360099
193700         SET DP020-MSG-INFORMATIONAL                              19370099
193800                                   TO TRUE                        19380099
193900     ELSE                                                         19390099
194000         COMPUTE PV-BOTTOM-ITEM =                                 19400099
194100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 19410099
194200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            19420099
194300*            -- BOTTOM OF LIST --                                 19430099
194400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            19440099
194500             SET DP020-MSG-INFORMATIONAL                          19450099
194600                                   TO TRUE                        19460099
194700         END-IF                                                   19470099
194800     END-IF.                                                      19480099
194900 EJECT                                                            19490099
195000*----------------------------------------------------------------*19500099
195100*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *19510099
195200*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *19520099
195300*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *19530099
195400*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *19540099
195500*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *19550099
195600*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *19560099
195700*----------------------------------------------------------------*19570099
195800                                                                  19580099
195900 2130-CHECK-FOR-JUMP-BROWSE.                                      19590099
196000     SET PS-NO-ERROR               TO TRUE.                       19600099
196100     IF (ASC-START-ITEM-REQUEST = SPACE)                          19610099
196200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            19620099
196300                                   TO PV-TOP-ITEM                 19630099
196400     ELSE                                                         19640099
196500         MOVE ASC-START-ITEM-REQUEST                              19650099
196600                                   TO DP010I-UNEDITED-FIELD       19660099
196700         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       19670099
196800         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     19680099
196900         SET DP010I-NEGATIVE-NOT-ALLOWED                          19690099
197000                                   TO TRUE                        19700099
197110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19711099
197120                         USING DP010I-NUMERIC-EDIT-AREA           19712099
197200                                                                  19720099
197300         IF  NOT DP010I-ERROR-DETECTED                            19730099
197400             MOVE DP010I-NUMERIC-FIELD                            19740099
197500                                   TO  ASC-START-ITEM-REQUEST-N   19750099
197600             IF  ASC-START-ITEM-REQUEST-N > ZERO                  19760099
197700                 IF  ASC-START-ITEM-REQUEST-N >                   19770099
197800                                          ASC-NUMBER-OF-ITEMS-READ19780099
197900                     MOVE SPACE TO ASC-START-ITEM-REQUEST         19790099
198000                     COMPUTE PV-TOP-ITEM =                        19800099
198100                             ASC-NUMBER-OF-ITEMS-READ             19810099
198200                             - PC-ITEMS-PER-PANEL + 1             19820099
198300                     IF  PV-TOP-ITEM < +1                         19830099
198400                         MOVE +1   TO PV-TOP-ITEM                 19840099
198500                         MOVE PC-TSYMSG-00070                     19850099
198600                                   TO DP020-MSG-NUMBER            19860099
198700                         SET DP020-MSG-INFORMATIONAL              19870099
198800                                   TO TRUE                        19880099
198900                     END-IF                                       19890099
199000                 ELSE                                             19900099
199100                     MOVE ASC-START-ITEM-REQUEST-N                19910099
199200                                   TO PV-TOP-ITEM                 19920099
199300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      19930099
199400                     COMPUTE PV-BOTTOM-ITEM =                     19940099
199500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     19950099
199600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ19960099
199700*                        -- BOTTOM OF LIST --                     19970099
199800                         MOVE PC-TSYMSG-00070                     19980099
199900                                   TO DP020-MSG-NUMBER            19990099
200000                         SET DP020-MSG-INFORMATIONAL              20000099
200100                                   TO TRUE                        20010099
200200                     END-IF                                       20020099
200300                 END-IF                                           20030099
200400             ELSE                                                 20040099
200500*                --- VALUE OUT OF RANGE ----                      20050099
200600                 MOVE PC-TSYMSG-00101                             20060099
200700                                   TO DP020-MSG-NUMBER            20070099
200800                 MOVE -1           TO ASTRTITL                    20080099
200900                 SET DP030-SET-CURSOR-APPL-1                      20090099
201000                                   TO TRUE                        20100099
201100                 MOVE DP015-REVERSE                               20110099
201200                                   TO ASTRTITH                    20120099
201300                 MOVE DP015-RED    TO ASTRTITC                    20130099
201400                 MOVE DP015-UNP-NUM-BRT-MDT                       20140099
201500                                   TO ASTRTITA                    20150099
201600                 SET DP020-MSG-FATAL                              20160099
201700                                   TO TRUE                        20170099
201800                 SET PS-ERROR      TO TRUE                        20180099
201900             END-IF                                               20190099
202000                                                                  20200099
202100         ELSE                                                     20210099
202200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20220099
202300             MOVE -1               TO ASTRTITL                    20230099
202400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20240099
202500             MOVE DP015-REVERSE    TO ASTRTITH                    20250099
202600             MOVE DP015-RED        TO ASTRTITC                    20260099
202700             MOVE DP015-UNP-NUM-BRT-MDT                           20270099
202800                                   TO ASTRTITA                    20280099
202900             SET DP020-MSG-FATAL   TO TRUE                        20290099
203000             SET PS-ERROR          TO TRUE                        20300099
203100         END-IF                                                   20310099
203200     END-IF.                                                      20320099
203300 EJECT                                                            20330099
203400*----------------------------------------------------------------*20340099
203500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *20350099
203600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *20360099
203700*----------------------------------------------------------------*20370099
203800 2140-DESELECT-ALL-ITEMS.                                         20380099
203900     MOVE +1                       TO ASC-BLK-SUB.                20390099
204000                                                                  20400099
204100     PERFORM 2141-CLEAR-SELECTED-INDS                             20410099
204200         VARYING ASC-ITEM-SUB                                     20420099
204300         FROM 1 BY 1                                              20430099
204400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20440099
204500                                                                  20450099
204600     ADD +1                        TO ASC-BLK-SUB.                20460099
204700                                                                  20470099
204800     PERFORM 2141-CLEAR-SELECTED-INDS                             20480099
204900         VARYING ASC-ITEM-SUB                                     20490099
205000         FROM 1 BY 1                                              20500099
205100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20510099
205200                                                                  20520099
205300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20530099
205400                                   TO PV-LIST-ITEM-NUMBER.        20540099
205500                                                                  20550099
205600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20560099
205700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    20570099
205800                                                                  20580099
205900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20590099
206000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      20600099
206100         MOVE +1                   TO ASC-BLK-SUB                 20610099
206200                                                                  20620099
206300         PERFORM 5100-WRITE-TEMP-STORAGE                          20630099
206400                                                                  20640099
206500         MOVE +1                   TO PV-BLOCK-NUMBER             20650099
206600                                                                  20660099
206700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20670099
206800             PV-FIRST-BLOCK-IN-ARRAY - 1                          20680099
206900                                                                  20690099
207000         PERFORM                                                  20700099
207100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20710099
207200                                                                  20720099
207300             PERFORM 4410-READ-TEMP-STORAGE                       20730099
207400                                                                  20740099
207500             PERFORM 2141-CLEAR-SELECTED-INDS                     20750099
207600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 20760099
207700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20770099
207800                                                                  20780099
207900             PERFORM 5100-WRITE-TEMP-STORAGE                      20790099
208000                                                                  20800099
208100             ADD +1                TO PV-BLOCK-NUMBER             20810099
208200                                                                  20820099
208300         END-PERFORM                                              20830099
208400                                                                  20840099
208500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20850099
208600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20860099
208700                                                                  20870099
208800         PERFORM                                                  20880099
208900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20890099
209000                   ASC-HIGHEST-BLOCK-WRITTEN                      20900099
209100                                                                  20910099
209200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20920099
209300                                   TO PV-BLOCK-NUMBER             20930099
209400                                                                  20940099
209500             PERFORM 4410-READ-TEMP-STORAGE                       20950099
209600                                                                  20960099
209700             PERFORM 2141-CLEAR-SELECTED-INDS                     20970099
209800                 VARYING ASC-ITEM-SUB                             20980099
209900                 FROM 1 BY 1                                      20990099
210000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21000099
210100                                                                  21010099
210200             PERFORM 5100-WRITE-TEMP-STORAGE                      21020099
210300                                                                  21030099
210400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21040099
210500                                                                  21050099
210600         END-PERFORM                                              21060099
210700                                                                  21070099
210800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21080099
210900                                   TO PV-BLOCK-NUMBER             21090099
211000                                                                  21100099
211100         PERFORM 4410-READ-TEMP-STORAGE                           21110099
211200     END-IF.                                                      21120099
211300                                                                  21130099
211400                                                                  21140099
211500     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 21150099
211600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.21160099
211700     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  21170099
211800                                                                  21180099
211900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21190099
212000                                                                  21200099
212100 EJECT                                                            21210099
212200*----------------------------------------------------------------*21220099
212300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *21230099
212400*----------------------------------------------------------------*21240099
212500                                                                  21250099
212600 2141-CLEAR-SELECTED-INDS.                                        21260099
212700                                                                  21270099
212800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           21280099
212900             NOT EQUAL ZERO                                       21290099
213000         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21300099
213100             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21310099
213200                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    21320099
213300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  21330099
213400                                   TO TRUE                        21340099
213500         END-IF                                                   21350099
213600     END-IF.                                                      21360099
213700                                                                  21370099
213800 EJECT                                                            21380099
213900*----------------------------------------------------------------*21390099
214000*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *21400099
214100*  FOR ALL ITEMS.                                                *21410099
214200*----------------------------------------------------------------*21420099
214300                                                                  21430099
214400 2150-SELECT-ALL-ITEMS.                                           21440099
214500                                                                  21450099
214600     MOVE +1                       TO ASC-BLK-SUB.                21460099
214700                                                                  21470099
214800     PERFORM 2151-SET-SELECTED-INDS                               21480099
214900         VARYING ASC-ITEM-SUB                                     21490099
215000         FROM 1 BY 1                                              21500099
215100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21510099
215200                                                                  21520099
215300     ADD +1                        TO ASC-BLK-SUB.                21530099
215400                                                                  21540099
215500     PERFORM 2151-SET-SELECTED-INDS                               21550099
215600         VARYING ASC-ITEM-SUB                                     21560099
215700         FROM 1 BY 1                                              21570099
215800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21580099
215900                                                                  21590099
216000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21600099
216100                                   TO PV-LIST-ITEM-NUMBER.        21610099
216200                                                                  21620099
216300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21630099
216400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21640099
216500                                                                  21650099
216600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     21660099
216700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    21670099
216800         MOVE +1                   TO ASC-BLK-SUB                 21680099
216900                                                                  21690099
217000         PERFORM 5100-WRITE-TEMP-STORAGE                          21700099
217100                                                                  21710099
217200         MOVE +1                   TO PV-BLOCK-NUMBER             21720099
217300                                                                  21730099
217400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21740099
217500             PV-FIRST-BLOCK-IN-ARRAY - 1                          21750099
217600                                                                  21760099
217700         PERFORM                                                  21770099
217800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       21780099
217900                                                                  21790099
218000             PERFORM 4410-READ-TEMP-STORAGE                       21800099
218100                                                                  21810099
218200             PERFORM 2151-SET-SELECTED-INDS                       21820099
218300                 VARYING ASC-ITEM-SUB                             21830099
218400                 FROM 1 BY 1                                      21840099
218500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21850099
218600                                                                  21860099
218700             PERFORM 5100-WRITE-TEMP-STORAGE                      21870099
218800                                                                  21880099
218900             ADD +1                TO PV-BLOCK-NUMBER             21890099
219000                                                                  21900099
219100         END-PERFORM                                              21910099
219200                                                                  21920099
219300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21930099
219400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21940099
219500                                                                  21950099
219600         PERFORM                                                  21960099
219700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21970099
219800                   ASC-HIGHEST-BLOCK-WRITTEN                      21980099
219900                                                                  21990099
220000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22000099
220100                                   TO PV-BLOCK-NUMBER             22010099
220200                                                                  22020099
220300             PERFORM 4410-READ-TEMP-STORAGE                       22030099
220400                                                                  22040099
220500             PERFORM 2151-SET-SELECTED-INDS                       22050099
220600                 VARYING ASC-ITEM-SUB                             22060099
220700                 FROM 1 BY 1                                      22070099
220800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22080099
220900                                                                  22090099
221000             PERFORM 5100-WRITE-TEMP-STORAGE                      22100099
221100                                                                  22110099
221200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22120099
221300                                                                  22130099
221400         END-PERFORM                                              22140099
221500                                                                  22150099
221600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22160099
221700                                   TO PV-BLOCK-NUMBER             22170099
221800                                                                  22180099
221900         PERFORM 4410-READ-TEMP-STORAGE                           22190099
222000     END-IF.                                                      22200099
222100                                                                  22210099
222200                                                                  22220099
222300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             22230099
222400                       ASC-NUMBER-OF-SELECTED-ITEMS.              22240099
222500                                                                  22250099
222600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        22260099
222700                                                                  22270099
222800 EJECT                                                            22280099
222900*----------------------------------------------------------------*22290099
223000*    MARK EACH ITEM AS BEING SELECTED.                           *22300099
223100*----------------------------------------------------------------*22310099
223200                                                                  22320099
223300 2151-SET-SELECTED-INDS.                                          22330099
223400                                                                  22340099
223500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           22350099
223600             NOT EQUAL ZERO                                       22360099
223700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             22370099
223800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             22380099
223900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        22390099
224000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  22400099
224100                               TO  TRUE                           22410099
224200         END-IF                                                   22420099
224300     END-IF.                                                      22430099
224400                                                                  22440099
237600******************************************************************23760099
237700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **23770099
237800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **23780099
237900******************************************************************23790099
238000 2200-MOVE-SCREEN-TO-COMMAREA.                                    23800099
238100                                                                  23810099
238200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             23820099
238300     MOVE +1                       TO PV-SUB.                     23830099
238400                                                                  23840099
238500     PERFORM 3100-SET-SUBSCRIPTS.                                 23850099
238600     IF  ASTRTITL > ZERO                                          23860099
238700         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          23870099
238800     ELSE                                                         23880099
238900         IF  ASTRTITF = DP015-ERASE-EOF                           23890099
239000             INITIALIZE ASC-START-ITEM-REQUEST                    23900099
239100         END-IF                                                   23910099
239200     END-IF.                                                      23920099
239300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          23930099
239400         VARYING PV-SUB                                           23940099
239500         FROM 1 BY 1                                              23950099
239600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      23960099
239700******************************************************************23970099
239800** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**23980099
239900******************************************************************23990099
240000 2210-MOVE-LINES-TO-COMMAREA.                                     24000099
240100     IF  MR-SELECTL (PV-SUB) > ZERO                               24010099
240200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             24020099
240300         MOVE MR-SELECTI (PV-SUB)                                 24030099
240400                                   TO ASC-TEMP-SELECTED-SW        24040099
240500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24050099
240600     ELSE                                                         24060099
240700         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                24070099
240800                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     24080099
240900                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        24090099
241000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24100099
241100         END-IF                                                   24110099
241200     END-IF.                                                      24120099
241300     ADD +1                        TO ASC-ITEM-SUB.               24130099
241400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24140099
241500         ADD +1                    TO ASC-BLK-SUB                 24150099
241600         MOVE +1                   TO ASC-ITEM-SUB                24160099
241700     END-IF.                                                      24170099
241800                                                                  24180099
248800******************************************************************24880099
248900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **24890099
249000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **24900099
249100******************************************************************24910099
249200 3000-EDIT-DATA-IN-COMMAREA.                                      24920099
249300     SET PS-NO-ERROR               TO TRUE.                       24930099
249400     PERFORM 3200-RESET-ATTRIBUTES.                               24940099
249500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     24950099
249600**                                                                24960099
249700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              24970099
249800* EDITTING IS DONE FROM THE BOTTOM UP.                            24980099
249900**                                                                24990099
250000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       25000099
250100         ASC-ITEMS-DISPLAYED - 1.                                 25010099
250200     PERFORM 3100-SET-SUBSCRIPTS.                                 25020099
250300     PERFORM 3300-EDIT-SELECTIONS                                 25030099
250400         VARYING PV-SUB                                           25040099
250500         FROM PV-SUB BY -1                                        25050099
250600         UNTIL PV-SUB < +1                                        25060099
250700*                                                                 25070099
250800     IF  PS-NO-ERROR                                              25080099
250900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        25090099
251000     END-IF.                                                      25100099
251100*                                                                 25110099
251200     IF  ((PS-NO-ERROR)                                           25120099
251300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   25130099
251400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    25140099
251500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  25150099
251600     END-IF.                                                      25160099
251700 EJECT                                                            25170099
251800*----------------------------------------------------------------*25180099
251900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *25190099
252000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*25200099
252100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *25210099
252200*                                                                *25220099
252300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *25230099
252400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *25240099
252500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *25250099
252600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *25260099
252700*----------------------------------------------------------------*25270099
252800                                                                  25280099
252900 3100-SET-SUBSCRIPTS.                                             25290099
253000                                                                  25300099
253100     COMPUTE ASC-ITEM-SUB =                                       25310099
253200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        25320099
253300                                                                  25330099
253400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         25340099
253500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25350099
253600                                                                  25360099
253700         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               25370099
253800     ELSE                                                         25380099
253900         MOVE +1                     TO ASC-BLK-SUB               25390099
254000     END-IF.                                                      25400099
254100******************************************************************25410099
254200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **25420099
254300******************************************************************25430099
254400                                                                  25440099
254500 3200-RESET-ATTRIBUTES.                                           25450099
254600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   25460099
254700     MOVE DP015-GREEN              TO ASTRTITC.                   25470099
254800     MOVE DP015-UNDERLINE          TO ASTRTITH.                   25480099
254900*                                                                 25490099
255000     PERFORM                                                      25500099
255100         VARYING PV-SUB                                           25510099
255200         FROM 1 BY 1                                              25520099
255300         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        25530099
255400         MOVE DP015-UNP-ALP-NOR-OFF                               25540099
255500                                   TO MR-SELECTA (PV-SUB)         25550099
255600         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         25560099
255700         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         25570099
255800     END-PERFORM.                                                 25580099
255900******************************************************************25590099
256000** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **25600099
256100** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **25610099
256200** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **25620099
256300** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **25630099
256400******************************************************************25640099
256500 3300-EDIT-SELECTIONS.                                            25650099
256600     EVALUATE TRUE                                                25660099
256700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     25670099
256800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         25680099
256900                 CONTINUE                                         25690099
257000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         25700099
257100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        25710099
257200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   25720099
257300                 MOVE ASC-TEMP-SELECTED-SW                        25730099
257400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25740099
257500                                TO ASC-SELECTED-SW                25750099
257600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25760099
257700             END-IF                                               25770099
257800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     25780099
257900                 = SPACE                                          25790099
258000             EVALUATE TRUE                                        25800099
258100                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       25810099
258200                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS25820099
258300                     MOVE SPACE TO ASC-SELECTED-SW                25830099
258400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25840099
258500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        25850099
258600                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    25860099
258700                     MOVE SPACE TO ASC-SELECTED-SW                25870099
258800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25880099
258900                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          25890099
259000                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      25900099
259100                     MOVE SPACE TO ASC-SELECTED-SW                25910099
259200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25920099
259300             END-EVALUATE                                         25930099
259400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           25940099
259500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            25950099
259600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    25960099
259700             END-IF                                               25970099
259800             PERFORM 3310-EDIT-RANGE                              25980099
259900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             25990099
260000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            26000099
260100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    26010099
260200             END-IF                                               26020099
260300             PERFORM 3310-EDIT-RANGE                              26030099
260400         WHEN OTHER                                               26040099
260500             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           26050099
260600             SET DP020-MSG-FATAL    TO TRUE                       26060099
260700             MOVE -1                TO MR-SELECTL (PV-SUB)        26070099
260800             SET DP030-SET-CURSOR-APPL-1                          26080099
260900                                    TO TRUE                       26090099
261000             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        26100099
261100             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        26110099
261200             SET PS-ERROR TO TRUE                                 26120099
261300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            26130099
261400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     26140099
261500                 MOVE SPACE         TO ASC-SELECTED-SW            26150099
261600                                        (ASC-BLK-SUB ASC-ITEM-SUB)26160099
261700             END-IF                                               26170099
261800     END-EVALUATE.                                                26180099
261900                                                                  26190099
262000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 26200099
262100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               26210099
262200     IF  ASC-ITEM-SUB < 1                                         26220099
262300         SUBTRACT +1 FROM ASC-BLK-SUB                             26230099
262400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                26240099
262500     END-IF.                                                      26250099
262600******************************************************************26260099
262700** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **26270099
262800** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **26280099
262900** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**26290099
263000** THE ENDING.                                                  **26300099
263100******************************************************************26310099
263200 3310-EDIT-RANGE.                                                 26320099
263300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                26330099
263400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   26340099
263500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)26350099
263600                                   TO ASC-SELECTED-SW             26360099
263700                                        (ASC-BLK-SUB ASC-ITEM-SUB)26370099
263800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 26380099
263900         ELSE                                                     26390099
264000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     26400099
264100                 CONTINUE                                         26410099
264200             ELSE                                                 26420099
264300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        26430099
264400                 MOVE PC-TSYMSG-00054                             26440099
264500                                   TO DP020-MSG-NUMBER            26450099
264600                 SET DP020-MSG-FATAL                              26460099
264700                                   TO TRUE                        26470099
264800                 MOVE -1           TO MR-SELECTL (PV-SUB)         26480099
264900                 SET DP030-SET-CURSOR-APPL-1                      26490099
265000                                   TO TRUE                        26500099
265100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         26510099
265200                 MOVE DP015-UNDERLINE                             26520099
265300                                   TO MR-SELECTH (PV-SUB)         26530099
265400                 SET PS-ERROR      TO TRUE                        26540099
265500             END-IF                                               26550099
265600         END-IF                                                   26560099
265700     ELSE                                                         26570099
265800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     26580099
265900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 26590099
266000                                   TO ASC-SELECTED-SW             26600099
266100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26610099
266200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   26620099
266300         ELSE                                                     26630099
266400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       26640099
266500                 CONTINUE                                         26650099
266600             ELSE                                                 26660099
266700*                -- ONLY ONE END-OF-RANGE ALLOWED --              26670099
266800                 MOVE PC-TSYMSG-00055                             26680099
266900                                   TO DP020-MSG-NUMBER            26690099
267000                 SET DP020-MSG-FATAL                              26700099
267100                                   TO TRUE                        26710099
267200                 MOVE -1           TO MR-SELECTL (PV-SUB)         26720099
267300                 SET DP030-SET-CURSOR-APPL-1                      26730099
267400                                   TO TRUE                        26740099
267500                 SET PS-ERROR      TO TRUE                        26750099
267600             END-IF                                               26760099
267700         END-IF                                                   26770099
267800     END-IF.                                                      26780099
267900*                                                                 26790099
268000******************************************************************26800099
268100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **26810099
268200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **26820099
268300******************************************************************26830099
268400 3400-CHECK-RANGE-SEQUENCE.                                       26840099
268500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       26850099
268600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      26860099
268700       AND  ASC-START-OF-SELECTED-RANGE >                         26870099
268800                                         ASC-END-OF-SELECTED-RANGE26880099
268900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                26890099
269000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 26900099
269100         SET DP020-MSG-FATAL TO TRUE                              26910099
269200         SET PS-ERROR TO TRUE                                     26920099
269300         PERFORM 3410-POSITION-AT-ERROR                           26930099
269400     END-IF.                                                      26940099
269500******************************************************************26950099
269600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **26960099
269700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **26970099
269800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **26980099
269900******************************************************************26990099
270000 3410-POSITION-AT-ERROR.                                          27000099
270100     SET DP030-SET-CURSOR-APPL-1                                  27010099
270200                                   TO TRUE.                       27020099
270300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 27030099
270400                    - PV-TOP-ITEM + 1.                            27040099
270500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27050099
270600         CONTINUE                                                 27060099
270700     ELSE                                                         27070099
270800         MOVE -1                   TO MR-SELECTL (PV-SUB)         27080099
270900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         27090099
271000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         27100099
271100     END-IF.                                                      27110099
271200*                                                                 27120099
271300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   27130099
271400                    - PV-TOP-ITEM + 1.                            27140099
271500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27150099
271600         CONTINUE                                                 27160099
271700     ELSE                                                         27170099
271800         MOVE -1                   TO MR-SELECTL (PV-SUB)         27180099
271900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         27190099
272000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         27200099
272100     END-IF.                                                      27210099
272200 EJECT                                                            27220099
272300*----------------------------------------------------------------*27230099
272400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *27240099
272500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *27250099
272600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *27260099
272700*----------------------------------------------------------------*27270099
272800                                                                  27280099
272900 3500-MARK-RANGE-AS-SELECTED.                                     27290099
273000     MOVE +1                       TO  ASC-BLK-SUB.               27300099
273100     PERFORM 3510-MARK-SELECTED-INDS                              27310099
273200         VARYING ASC-ITEM-SUB                                     27320099
273300         FROM 1 BY 1                                              27330099
273400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27340099
273500                                                                  27350099
273600     ADD +1                        TO ASC-BLK-SUB.                27360099
273700     PERFORM 3510-MARK-SELECTED-INDS                              27370099
273800         VARYING ASC-ITEM-SUB                                     27380099
273900         FROM 1 BY 1                                              27390099
274000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27400099
274100                                                                  27410099
274200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               27420099
274300                                   TO  PV-LIST-ITEM-NUMBER.       27430099
274400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            27440099
274500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         27450099
274600               PC-ITEMS-PER-PANEL).                               27460099
274700                                                                  27470099
274800     MOVE ASC-START-OF-SELECTED-RANGE                             27480099
274900                                   TO PV-START-OF-SELECTED-RANGE. 27490099
275000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            27500099
275100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  27510099
275200               PC-ITEMS-PER-PANEL).                               27520099
275300                                                                  27530099
275400     MOVE ASC-END-OF-SELECTED-RANGE                               27540099
275500                                   TO  PV-END-OF-SELECTED-RANGE.  27550099
275600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             27560099
275700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    27570099
275800               PC-ITEMS-PER-PANEL).                               27580099
275900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             27590099
276000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             27600099
276100                                                                  27610099
276200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    27620099
276300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        27630099
276400         MOVE +1                   TO ASC-BLK-SUB                 27640099
276500         PERFORM 5100-WRITE-TEMP-STORAGE                          27650099
276600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         27660099
276700             PV-FIRST-BLOCK-IN-ARRAY - 1                          27670099
276800                                                                  27680099
276900         PERFORM                                                  27690099
277000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      27700099
277100                   PV-PREV-BLOCK-IN-ARRAY                         27710099
277200             MOVE PV-FIRST-BLOCK-IN-RANGE                         27720099
277300                                   TO PV-BLOCK-NUMBER             27730099
277400             PERFORM 4410-READ-TEMP-STORAGE                       27740099
277500             PERFORM 3510-MARK-SELECTED-INDS                      27750099
277600                 VARYING ASC-ITEM-SUB                             27760099
277700                 FROM 1 BY 1                                      27770099
277800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27780099
277900             PERFORM 5100-WRITE-TEMP-STORAGE                      27790099
278000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     27800099
278100         END-PERFORM                                              27810099
278200                                                                  27820099
278300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         27830099
278400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     27840099
278500         PERFORM                                                  27850099
278600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       27860099
278700                   PV-LAST-BLOCK-IN-RANGE                         27870099
278800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          27880099
278900                                   TO PV-BLOCK-NUMBER             27890099
279000             PERFORM 4410-READ-TEMP-STORAGE                       27900099
279100             PERFORM 3510-MARK-SELECTED-INDS                      27910099
279200                 VARYING ASC-ITEM-SUB                             27920099
279300                 FROM 1 BY 1                                      27930099
279400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27940099
279500             PERFORM 5100-WRITE-TEMP-STORAGE                      27950099
279600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      27960099
279700         END-PERFORM                                              27970099
279800                                                                  27980099
279900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             27990099
280000                                   TO PV-BLOCK-NUMBER             28000099
280100         PERFORM 4410-READ-TEMP-STORAGE                           28010099
280200     END-IF.                                                      28020099
280300                                                                  28030099
280400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 28040099
280500                                      ASC-END-OF-SELECTED-RANGE.  28050099
280600                                                                  28060099
280700 EJECT                                                            28070099
280800*----------------------------------------------------------------*28080099
280900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *28090099
281000*----------------------------------------------------------------*28100099
281100                                                                  28110099
281200 3510-MARK-SELECTED-INDS.                                         28120099
281300                                                                  28130099
281400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         28140099
281500                                ASC-ITEM-SUB) >                   28150099
281600         ASC-START-OF-SELECTED-RANGE)                             28160099
281700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         28170099
281800                                ASC-ITEM-SUB) =                   28180099
281900         ASC-START-OF-SELECTED-RANGE)                             28190099
282000                                                                  28200099
282100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     28210099
282200                                    ASC-ITEM-SUB) <               28220099
282300             ASC-END-OF-SELECTED-RANGE)                           28230099
282400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     28240099
282500                                    ASC-ITEM-SUB) =               28250099
282600             ASC-END-OF-SELECTED-RANGE)                           28260099
282700                                                                  28270099
282800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          28280099
282900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   28290099
283000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   28300099
283100                               TO TRUE                            28310099
283200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              28320099
283300                               TO TRUE                            28330099
283400                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    28340099
283500             END-IF                                               28350099
283600         END-IF                                                   28360099
283700     END-IF.                                                      28370099
283800                                                                  28380099
283900 EJECT                                                            28390099
284000*----------------------------------------------------------------*28400099
284100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *28410099
284200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *28420099
284300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *28430099
284400*    DISPLAY THE PANEL TO USER.                                  *28440099
284500*----------------------------------------------------------------*28450099
284600                                                                  28460099
284700 4000-BUILD-INITIAL-PANEL.                                        28470099
284800                                                                  28480099
284900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            28490099
285000                                 ASC-BLOCK-ENTRIES (2).           28500099
285100     MOVE +1                 TO ASC-BLK-SUB.                      28510099
285200     SET ASC-ITEMS-LEFT-ON-DB                                     28520099
285300                             TO TRUE.                             28530099
285400                                                                  28540099
285500     MOVE +0                 TO ASC-ITEM-SUB                      28550099
285600                                ASC-NUMBER-OF-ITEMS-READ          28560099
285700                                ASC-NUMBER-OF-SELECTED-ITEMS      28570099
285800                                ASC-HIGHEST-BLOCK-WRITTEN         28580099
285900                                ASC-START-OF-SELECTED-RANGE       28590099
286000                                ASC-END-OF-SELECTED-RANGE         28600099
286100                                ASC-ITEM-AT-TOP-OF-PANEL.         28610099
286200                                                                  28620099
286300*----------------------------------------------------------------*28630099
286400*    FOLLOWING LOGIC IS USED TO DETERMINE WHAT CURSOR TO USE     *28640099
286500*        TO RETRIEVE THE DATA. MOST OF THE CURSORS USE COLOR     *28650099
286600*        AND DEPARTMENT IN THE CURSOR TO SELECT THE DATA.        *28660099
286700*                                                                *28670099
286800*        THE EXCEPTION TO THIS ARE THE CURSORS THAT ARE          *28680099
286900*        INITIATED DIRECTLY FROM IQSVEND  - IQKCS401.            *28690099
287000*            CSR-SIMILAR, CSR-MAJOR-CLASS, CSR-SUB-CLASS.        *28700099
287100*                                                                *28710099
287200*   ALL OF THE OTHER FIELDS ARE OPTIONAL AND ARE USED IN THE     *28720099
287300*        CURSOR DEPENDING ON WHAT SCREENS YOU CAME THROUGH.      *28730099
287400*                                                                *28740099
287500*        VENDOR - SELECTED IN IQLVEND  - IQKCS402.               *28750099
287600*                                                                *28760099
287700*  (MAJOR AND SUB CLASS) AND STYLE ARE MUTUALLY EXCLUSIVE AS     *28770099
287800*        YOU CAN ONLY COME THROUGH ONE OF THE SCREENS WHEN       *28780099
287900*        COMING HERE.  THERE IS ALSO THE OPTION OF NOT COMING    *28790099
288000*        THROUGH EITHER ONE.                                     *28800099
288100*                                                                *28810099
288200*        MAJOR AND SUB CLASS - SELECTED IN IQLCLASS - IQKCS405.  *28820099
288300*        STYLE - SELECTED IN IQLSTYLE - IQKCS409                 *28830099
288400*                                                                *28840099
288500*        SIZE - SELECTED IN IQLSIZE  - IQKCS407                  *28850099
288600*                                                                *28860099
288700*----------------------------------------------------------------*28870099
288800                                                                  28880099
288900     EVALUATE ASC-INT-APPL-FORMAT-IND                             28890099
289000         WHEN PC-SIZE-FORMAT-IND                                  28900099
289100              EVALUATE IQ016-SUB-CL-NM                            28910099
289200                  WHEN 'CLASS SCREEN BYPASSD'                     28920099
289300                       IF IQ016-LBL-NM = SPACES                   28930099
289400                          SET CSR-COLOR-SIZE        TO TRUE       28940099
289500                          MOVE 'CSR-CLR-SZ        ' TO            28950099
289600                                                PV-CURSOR-NAME    28960099
289700                       ELSE                                       28970099
289800                          SET CSR-VND-COLOR-SIZE    TO TRUE       28980099
289900                          MOVE 'CSR-VND-CLR-SZ    ' TO            28990099
290000                                                PV-CURSOR-NAME    29000099
290100                       END-IF                                     29010099
290200                                                                  29020099
290300                  WHEN 'STYLE SCREEN USED   '                     29030099
290400                       IF IQ016-LBL-NM = SPACES                   29040099
290500                          SET CSR-STYLE-COLOR-SIZE  TO TRUE       29050099
290600                          MOVE 'CSR-STY-CLR-SZ    ' TO            29060099
290700                                                PV-CURSOR-NAME    29070099
290800                       ELSE                                       29080099
290900                          SET CSR-VND-STYLE-COLOR-SIZE TO TRUE    29090099
291000                          MOVE 'CSR-VND-STY-CLR-SZ' TO            29100099
291100                                                PV-CURSOR-NAME    29110099
291200                       END-IF                                     29120099
291300                                                                  29130099
291400                  WHEN OTHER                                      29140099
291500*                      ****************************************** 29150099
291600*                       ENTRY FROM IQKCS407                       29160099
291700*                       PATH IQKCS404, IQKCS405, IQKCS406,        29170099
291800*                            IQKCS407, IQKCS408.                  29180099
291900*                      ****************************************** 29190099
292000                       IF IQ016-LBL-NM = SPACES                   29200099
292100                          SET CSR-CLASS-COLOR-SIZE  TO TRUE       29210099
292200                          MOVE 'CSR-CLS-CLR-SZ    ' TO            29220099
292300                                                PV-CURSOR-NAME    29230099
292400                       ELSE                                       29240099
292500                          SET CSR-VND-CLASS-COLOR-SIZE   TO TRUE  29250099
292600                          MOVE 'CSR-VND-CLS-CLR-SZ' TO            29260099
292700                                                PV-CURSOR-NAME    29270099
292800                       END-IF                                     29280099
292900                                                                  29290099
293000              END-EVALUATE                                        29300099
293100                                                                  29310099
293200         WHEN PC-COLOR-FORMAT-IND                                 29320099
293300              EVALUATE IQ016-SUB-CL-NM                            29330099
293400                  WHEN 'CLASS SCREEN BYPASSD'                     29340099
293500*                      ****************************************   29350099
293600*                       ENTRY FROM IQKCS406 (MISSING CLASS AND    29360099
293700*                              AND SIZE)                          29370099
293800*                       PATH IQKCS404, IQKCS406, IQKCS408         29380099
293900*                      ****************************************   29390099
294000                       IF IQ016-LBL-NM = SPACES                   29400099
294100                          SET CSR-COLOR             TO TRUE       29410099
294200                          MOVE 'CSR-CLR           ' TO            29420099
294300                                             PV-CURSOR-NAME       29430099
294400                       ELSE                                       29440099
294500                          SET CSR-VND-COLOR         TO TRUE       29450099
294600                          MOVE 'CSR-VND-CLR       ' TO            29460099
294700                                             PV-CURSOR-NAME       29470099
294800                       END-IF                                     29480099
294900                                                                  29490099
295000                  WHEN 'STYLE SCREEN USED   '                     29500099
295100*                      ****************************************** 29510099
295200*                       ENTRY FROM IQKCS409 (MISSING SIZE)        29520099
295300*                       PATH IQKCS404, IQKCS409, IQKCS406,        29530099
295400*                            IQKCS408                             29540099
295500*                      ****************************************** 29550099
295600                       IF IQ016-LBL-NM = SPACES                   29560099
295700                          SET CSR-STYLE-COLOR       TO TRUE       29570099
295800                          MOVE 'CSR-STY-CLR       ' TO            29580099
295900                                             PV-CURSOR-NAME       29590099
296000                       ELSE                                       29600099
296100                          SET CSR-VND-STYLE-COLOR   TO TRUE       29610099
296200                          MOVE 'CSR-VND-STY-CLR   ' TO            29620099
296300                                             PV-CURSOR-NAME       29630099
296400                       END-IF                                     29640099
296500                                                                  29650099
296600                  WHEN OTHER                                      29660099
296700*                      ****************************************** 29670099
296800*                       ENTRY FROM IQKCS406 (MISSING SIZE)        29680099
296900*                       PATH IQKCS404, IQKCS405, IQKCS406,        29690099
297000*                            IQKCS408                             29700099
297100*                      ****************************************** 29710099
297200                       IF IQ016-LBL-NM = SPACES                   29720099
297300                          SET CSR-CLASS-COLOR       TO TRUE       29730099
297400                          MOVE 'CSR-CLS-CLR       ' TO            29740099
297500                                             PV-CURSOR-NAME       29750099
297600                       ELSE                                       29760099
297700                          SET CSR-VND-CLASS-COLOR   TO TRUE       29770099
297800                          MOVE 'CSR-VND-CLS-CLR   ' TO            29780099
297900                                             PV-CURSOR-NAME       29790099
298000                       END-IF                                     29800099
298100                                                                  29810099
298200              END-EVALUATE                                        29820099
298300                                                                  29830099
298400         WHEN PC-SIMILAR-UPC-FORMAT-IND                           29840099
298500*             ***********************************************     29850099
298600*              ENTRY FROM IQKCS401 - F20                          29860099
298700*              PATH IQKCS401, IQKCS408                            29870099
298800*             ***********************************************     29880099
298900              SET CSR-SIMILAR           TO TRUE                   29890099
299000              MOVE 'CSR-SIMILAR       ' TO PV-CURSOR-NAME         29900099
299100                                                                  29910099
299200         WHEN PC-SIMILAR-STYLE-FORMAT-IND                         29920099
299300*             ***********************************************     29930099
299400*              ENTRY FROM IQKCS401 - F17                          29940099
299500*              PATH IQKCS401, IQKCS408                            29950099
299600*             ***********************************************     29960099
299700              SET CSR-SIMILAR-STYLE     TO TRUE                   29970099
299800              MOVE 'CSR-SIMILAR-STYLE ' TO PV-CURSOR-NAME         29980099
299900                                                                  29990099
300000         WHEN PC-MAJOR-SUB-CLASS-FORMAT-IND                       30000099
300100*             ***********************************************     30010099
300200*              ENTRY FROM IQKCS401 - F22                          30020099
300300*              PATH IQKCS401, IQKCS408                            30030099
300400*             ***********************************************     30040099
300500              IF ASC-SUB-CL = 0                                   30050099
300600                 SET CSR-MAJOR-CLASS       TO TRUE                30060099
300700                 MOVE 'CSR-MAJOR-CLASS   ' TO PV-CURSOR-NAME      30070099
300800              ELSE                                                30080099
300900                 SET CSR-SUB-CLASS         TO TRUE                30090099
301000                 MOVE 'CSR-SUB-CLASS     ' TO PV-CURSOR-NAME      30100099
301100              END-IF                                              30110099
301200                                                                  30120099
301300         WHEN PC-CLASS-FORMAT-IND                                 30130099
301400*             ***********************************************     30140099
301500*              ENTRY FROM IQKCS405 (MISSING COLOR AND SIZE)       30150099
301600*              PATH IQKCS404, IQKCS405, IQKCS408                  30160099
301700*             ***********************************************     30170099
301800              IF IQ016-SUB-CL-NM = 'STYLE SCREEN USED '           30180099
301900                 IF IQ016-LBL-NM = SPACES                         30190099
302000                    SET CSR-STYLE             TO TRUE             30200099
302100                    MOVE 'CSR-STY           ' TO PV-CURSOR-NAME   30210099
302200                 ELSE                                             30220099
302300                    SET CSR-VND-STYLE         TO TRUE             30230099
302400                    MOVE 'CSR-VND-STY       ' TO PV-CURSOR-NAME   30240099
302500                 END-IF                                           30250099
302600              ELSE                                                30260099
302700                 IF IQ016-LBL-NM = SPACES                         30270099
302800                    SET CSR-CLASS             TO TRUE             30280099
302900                    MOVE 'CSR-CLS           ' TO PV-CURSOR-NAME   30290099
303000                 ELSE                                             30300099
303100                    SET CSR-VND-CLASS         TO TRUE             30310099
303200                    MOVE 'CSR-VND-CLS       ' TO PV-CURSOR-NAME   30320099
303300                 END-IF                                           30330099
303400              END-IF                                              30340099
303500                                                                  30350099
303600         WHEN PC-STYLE-FORMAT-IND                                 30360099
303700*             ***********************************************     30370099
303800*              ENTRY FROM IQKCS409 (MISSING COLOR AND SIZE)       30380099
303900*              PATH IQKCS404, IQKCS409, IQKCS408                  30390099
304000*             ***********************************************     30400099
304100              IF IQ016-LBL-NM = SPACES                            30410099
304200                 SET CSR-STLPGM409         TO TRUE                30420099
304300                 MOVE 'STLPGM409-CSR     ' TO PV-CURSOR-NAME      30430099
304400              ELSE                                                30440099
304500                 SET CSR-VND-STYLE         TO TRUE                30450099
304600                 MOVE 'CSR-VND-STY       ' TO PV-CURSOR-NAME      30460099
304700              END-IF                                              30470099
304800                                                                  30480099
304900     END-EVALUATE.                                                30490099
305000                                                                  30500099
305100     PERFORM 4005-OPEN-CURSORS.                                   30510099
305200     PERFORM 4300-READ-ITEMS-FROM-DB.                             30520099
305300     PERFORM 4021-CLOSE-CURSORS.                                  30530099
305400     MOVE PS-CURSOR-SW TO ASC-CURSOR-SW.                          30540099
305500                                                                  30550099
305600     MOVE +1                   TO  PV-TOP-ITEM.                   30560099
305700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          30570099
305800         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    30580099
305900         SET DP020-MSG-FATAL   TO  TRUE                           30590099
306000         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               30600099
306100     ELSE                                                         30610099
306200         MOVE -1               TO MR-SELECTL (1)                  30620099
306300         SET DP030-SET-CURSOR-APPL-1                              30630099
306400                               TO TRUE                            30640099
306500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     30650099
306600     END-IF.                                                      30660099
306700                                                                  30670099
306800*----------------------------------------------------------------*30680099
306900*    PARAGRAPH IS USED TO OPEN ANY OF THE CURSORS USED IN THIS   *30690099
307000*    PROGRAM.                                                    *30700099
307100*                                                                *30710099
307200*----------------------------------------------------------------*30720099
307300                                                                  30730099
307400 4005-OPEN-CURSORS.                                               30740099
307500                                                                  30750099
307600     MOVE '4005-OPEN-CURSORS    '  TO DP013-PARAGRAPH.            30760099
307700                                                                  30770099
307800     PERFORM WITH TEST AFTER                                      30780099
307900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     30790099
308000            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            30800099
308100                    OR (SQLCODE = ZERO))                          30810099
308200                                                                  30820099
308300         EVALUATE TRUE                                            30830099
308400             WHEN CSR-VND-COLOR-SIZE                              30840099
308500                  EXEC SQL                                        30850099
308600                       OPEN CSR-VND-CLR-SZ                        30860099
308700                  END-EXEC                                        30870099
308800                                                                  30880099
308900             WHEN CSR-VND-CLASS-COLOR-SIZE                        30890099
309000                  EXEC SQL                                        30900099
309100                       OPEN CSR-VND-CLS-CLR-SZ                    30910099
309200                  END-EXEC                                        30920099
309300                                                                  30930099
309400             WHEN CSR-VND-STYLE-COLOR-SIZE                        30940099
309500                  EXEC SQL                                        30950099
309600                       OPEN CSR-VND-STY-CLR-SZ                    30960099
309700                  END-EXEC                                        30970099
309800                                                                  30980099
309900             WHEN CSR-VND-COLOR                                   30990099
310000                  EXEC SQL                                        31000099
310100                       OPEN CSR-VND-CLR                           31010099
310200                  END-EXEC                                        31020099
310300                                                                  31030099
310400             WHEN CSR-VND-CLASS-COLOR                             31040099
310500                  EXEC SQL                                        31050099
310600                       OPEN CSR-VND-CLS-CLR                       31060099
310700                  END-EXEC                                        31070099
310800                                                                  31080099
310900             WHEN CSR-VND-STYLE-COLOR                             31090099
311000                  EXEC SQL                                        31100099
311100                       OPEN CSR-VND-STY-CLR                       31110099
311200                  END-EXEC                                        31120099
311300                                                                  31130099
311400             WHEN CSR-VND-CLASS                                   31140099
311500                  EXEC SQL                                        31150099
311600                       OPEN CSR-VND-CLS                           31160099
311700                  END-EXEC                                        31170099
311800                                                                  31180099
311900             WHEN CSR-VND-STYLE                                   31190099
312000                  EXEC SQL                                        31200099
312100                       OPEN CSR-VND-STY                           31210099
312200                  END-EXEC                                        31220099
312300                                                                  31230099
312400             WHEN CSR-COLOR-SIZE                                  31240099
312500                  EXEC SQL                                        31250099
312600                       OPEN CSR-CLR-SZ                            31260099
312700                  END-EXEC                                        31270099
312800                                                                  31280099
312900             WHEN CSR-CLASS-COLOR-SIZE                            31290099
313000                  EXEC SQL                                        31300099
313100                       OPEN CSR-CLS-CLR-SZ                        31310099
313200                  END-EXEC                                        31320099
313300                                                                  31330099
313400             WHEN CSR-STYLE-COLOR-SIZE                            31340099
313500                  EXEC SQL                                        31350099
313600                       OPEN CSR-STY-CLR-SZ                        31360099
313700                  END-EXEC                                        31370099
313800                                                                  31380099
313900             WHEN CSR-COLOR                                       31390099
314000                  EXEC SQL                                        31400099
314100                       OPEN CSR-CLR                               31410099
314200                  END-EXEC                                        31420099
314300                                                                  31430099
314400             WHEN CSR-CLASS-COLOR                                 31440099
314500                  EXEC SQL                                        31450099
314600                       OPEN CSR-CLS-CLR                           31460099
314700                  END-EXEC                                        31470099
314800                                                                  31480099
314900             WHEN CSR-STYLE-COLOR                                 31490099
315000                  EXEC SQL                                        31500099
315100                       OPEN CSR-STY-CLR                           31510099
315200                  END-EXEC                                        31520099
315300                                                                  31530099
315400             WHEN CSR-CLASS                                       31540099
315500                  EXEC SQL                                        31550099
315600                       OPEN CSR-CLS                               31560099
315700                  END-EXEC                                        31570099
315800                                                                  31580099
315900             WHEN CSR-STYLE                                       31590099
316000                  EXEC SQL                                        31600099
316100                       OPEN CSR-STY                               31610099
316200                  END-EXEC                                        31620099
316300                                                                  31630099
316400             WHEN CSR-SIMILAR                                     31640099
316500                  EXEC SQL                                        31650099
316600                       OPEN SIMILAR-CSR                           31660099
316700                  END-EXEC                                        31670099
316800                                                                  31680099
316900             WHEN CSR-SIMILAR-STYLE                               31690099
317000                  EXEC SQL                                        31700099
317100                       OPEN SIMILAR-STYLE-CSR                     31710099
317200                  END-EXEC                                        31720099
317300                                                                  31730099
317400             WHEN CSR-STLPGM409                                   31740099
317500                  EXEC SQL                                        31750099
317600                       OPEN STLPGM409-CSR                         31760099
317700                  END-EXEC                                        31770099
317800                                                                  31780099
317900             WHEN CSR-MAJOR-CLASS                                 31790099
318000                  EXEC SQL                                        31800099
318100                       OPEN CSR-MAJOR-CLASS                       31810099
318200                  END-EXEC                                        31820099
318300                                                                  31830099
318400             WHEN CSR-SUB-CLASS                                   31840099
318500                  EXEC SQL                                        31850099
318600                       OPEN CSR-SUB-CLASS                         31860099
318700                  END-EXEC                                        31870099
318800                                                                  31880099
318900         END-EVALUATE                                             31890099
319000                                                                  31900099
319100         EVALUATE TRUE                                            31910099
319200             WHEN SQLCODE = ZERO                                  31920099
319300             WHEN SQLCODE = -904                                  31930099
319400             WHEN SQLCODE = -913                                  31940099
319500                  CONTINUE                                        31950099
319600                                                                  31960099
319700             WHEN SQLWARN0 NOT = SPACES                           31970099
319800             WHEN SQLCODE < ZERO                                  31980099
319900             WHEN SQLCODE > ZERO                                  31990099
320000                  STRING 'OPEN  '                                 32000099
320100                          PV-CURSOR-NAME                          32010099
320200                         ' CURSOR - BAD SQLCODE '                 32020099
320300                          DELIMITED BY SIZE                       32030099
320400                          INTO DP013-MESSAGE-TEXT (1)             32040099
320500                 MOVE SQLCA        TO DP013-SQLCA                 32050099
320600                 MOVE 'XST_VND_STYL ' TO DP013-DB2-TABLE-NAME (1) 32060099
320700                 MOVE 'XST_VND      ' TO DP013-DB2-TABLE-NAME (2) 32070099
320800                 MOVE 'XST_SKU      ' TO DP013-DB2-TABLE-NAME (3) 32080099
320900                 MOVE 'XST_UPC      ' TO DP013-DB2-TABLE-NAME (4) 32090099
321000                 SET DP013-DB2-ABEND                              32100099
321100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32110099
321200                 PERFORM DP013-0000-PROCESS-ABEND                 32120099
321300           END-EVALUATE                                           32130099
321400                                                                  32140099
321500     END-PERFORM.                                                 32150099
321600                                                                  32160099
321700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32170099
321800         STRING 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN '    32180099
321900                 PV-CURSOR-NAME                                   32190099
322000                ' CURSOR'                                         32200099
322100                 DELIMITED BY SIZE                                32210099
322200                 INTO DP013-MESSAGE-TEXT (1)                      32220099
322300         MOVE SQLCA                TO DP013-SQLCA                 32230099
322400         MOVE 'SKU, VND, VND_STYL'                                32240099
322500                                   TO DP013-DB2-TABLE-NAME (1)    32250099
322600         MOVE 'SKU_LOC, UPC'                                      32260099
322700                                   TO DP013-DB2-TABLE-NAME (2)    32270099
322800         SET DP013-DB2-ABEND                                      32280099
322900             DP013-XCTL-DISPLAY-RESTART                           32290099
323000                                   TO TRUE                        32300099
323100         PERFORM DP013-0000-PROCESS-ABEND                         32310099
323200     END-IF.                                                      32320099
323300                                                                  32330099
323400                                                                  32340099
323500*----------------------------------------------------------------*32350099
323600*                                                                *32360099
323700*                                                                *32370099
323800*----------------------------------------------------------------*32380099
323900                                                                  32390099
324000 4021-CLOSE-CURSORS.                                              32400099
324100                                                                  32410099
324200     MOVE '4021-CLOSE-CURSORS   '  TO DP013-PARAGRAPH.            32420099
324300                                                                  32430099
324400     PERFORM WITH TEST AFTER                                      32440099
324500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     32450099
324600            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            32460099
324700                    OR (SQLCODE = ZERO))                          32470099
324800                                                                  32480099
324900         EVALUATE TRUE                                            32490099
325000             WHEN CSR-VND-COLOR-SIZE                              32500099
325100                  EXEC SQL                                        32510099
325200                       CLOSE CSR-VND-CLR-SZ                       32520099
325300                  END-EXEC                                        32530099
325400                                                                  32540099
325500             WHEN CSR-VND-CLASS-COLOR-SIZE                        32550099
325600                  EXEC SQL                                        32560099
325700                       CLOSE CSR-VND-CLS-CLR-SZ                   32570099
325800                  END-EXEC                                        32580099
325900                                                                  32590099
326000             WHEN CSR-VND-STYLE-COLOR-SIZE                        32600099
326100                  EXEC SQL                                        32610099
326200                       CLOSE CSR-VND-STY-CLR-SZ                   32620099
326300                  END-EXEC                                        32630099
326400                                                                  32640099
326500             WHEN CSR-VND-COLOR                                   32650099
326600                  EXEC SQL                                        32660099
326700                       CLOSE CSR-VND-CLR                          32670099
326800                  END-EXEC                                        32680099
326900                                                                  32690099
327000             WHEN CSR-VND-CLASS-COLOR                             32700099
327100                  EXEC SQL                                        32710099
327200                       CLOSE CSR-VND-CLS-CLR                      32720099
327300                  END-EXEC                                        32730099
327400                                                                  32740099
327500             WHEN CSR-VND-STYLE-COLOR                             32750099
327600                  EXEC SQL                                        32760099
327700                       CLOSE CSR-VND-STY-CLR                      32770099
327800                  END-EXEC                                        32780099
327900                                                                  32790099
328000             WHEN CSR-VND-CLASS                                   32800099
328100                  EXEC SQL                                        32810099
328200                       CLOSE CSR-VND-CLS                          32820099
328300                  END-EXEC                                        32830099
328400                                                                  32840099
328500             WHEN CSR-VND-STYLE                                   32850099
328600                  EXEC SQL                                        32860099
328700                       CLOSE CSR-VND-STY                          32870099
328800                  END-EXEC                                        32880099
328900                                                                  32890099
329000             WHEN CSR-COLOR-SIZE                                  32900099
329100                  EXEC SQL                                        32910099
329200                       CLOSE CSR-CLR-SZ                           32920099
329300                  END-EXEC                                        32930099
329400                                                                  32940099
329500             WHEN CSR-CLASS-COLOR-SIZE                            32950099
329600                  EXEC SQL                                        32960099
329700                       CLOSE CSR-CLS-CLR-SZ                       32970099
329800                  END-EXEC                                        32980099
329900                                                                  32990099
330000             WHEN CSR-STYLE-COLOR-SIZE                            33000099
330100                  EXEC SQL                                        33010099
330200                       CLOSE CSR-STY-CLR-SZ                       33020099
330300                  END-EXEC                                        33030099
330400                                                                  33040099
330500             WHEN CSR-COLOR                                       33050099
330600                  EXEC SQL                                        33060099
330700                       CLOSE CSR-CLR                              33070099
330800                  END-EXEC                                        33080099
330900                                                                  33090099
331000             WHEN CSR-CLASS-COLOR                                 33100099
331100                  EXEC SQL                                        33110099
331200                       CLOSE CSR-CLS-CLR                          33120099
331300                  END-EXEC                                        33130099
331400                                                                  33140099
331500             WHEN CSR-STYLE-COLOR                                 33150099
331600                  EXEC SQL                                        33160099
331700                       CLOSE CSR-STY-CLR                          33170099
331800                  END-EXEC                                        33180099
331900                                                                  33190099
332000             WHEN CSR-CLASS                                       33200099
332100                  EXEC SQL                                        33210099
332200                       CLOSE CSR-CLS                              33220099
332300                  END-EXEC                                        33230099
332400                                                                  33240099
332500             WHEN CSR-STYLE                                       33250099
332600                  EXEC SQL                                        33260099
332700                       CLOSE CSR-STY                              33270099
332800                  END-EXEC                                        33280099
332900                                                                  33290099
333000             WHEN CSR-SIMILAR                                     33300099
333100                  EXEC SQL                                        33310099
333200                       CLOSE SIMILAR-CSR                          33320099
333300                  END-EXEC                                        33330099
333400                                                                  33340099
333500             WHEN CSR-SIMILAR-STYLE                               33350099
333600                  EXEC SQL                                        33360099
333700                       CLOSE SIMILAR-STYLE-CSR                    33370099
333800                  END-EXEC                                        33380099
333900                                                                  33390099
334000             WHEN CSR-STLPGM409                                   33400099
334100                  EXEC SQL                                        33410099
334200                       CLOSE STLPGM409-CSR                        33420099
334300                  END-EXEC                                        33430099
334400                                                                  33440099
334500             WHEN CSR-MAJOR-CLASS                                 33450099
334600                  EXEC SQL                                        33460099
334700                       CLOSE CSR-MAJOR-CLASS                      33470099
334800                  END-EXEC                                        33480099
334900                                                                  33490099
335000             WHEN CSR-SUB-CLASS                                   33500099
335100                  EXEC SQL                                        33510099
335200                       CLOSE CSR-SUB-CLASS                        33520099
335300                  END-EXEC                                        33530099
335400                                                                  33540099
335500         END-EVALUATE                                             33550099
335600                                                                  33560099
335700         EVALUATE TRUE                                            33570099
335800             WHEN SQLCODE = ZERO                                  33580099
335900             WHEN SQLCODE = -904                                  33590099
336000             WHEN SQLCODE = -913                                  33600099
336100                  CONTINUE                                        33610099
336200                                                                  33620099
336300             WHEN SQLWARN0 NOT = SPACES                           33630099
336400             WHEN SQLCODE < ZERO                                  33640099
336500             WHEN SQLCODE > ZERO                                  33650099
336600                  STRING 'CLOSE  '                                33660099
336700                          PV-CURSOR-NAME                          33670099
336800                         ' CURSOR'                                33680099
336900                          DELIMITED BY SIZE                       33690099
337000                          INTO DP013-MESSAGE-TEXT (1)             33700099
337100                 MOVE SQLCA        TO DP013-SQLCA                 33710099
337200                 MOVE 'XST_VND_STYL ' TO DP013-DB2-TABLE-NAME (1) 33720099
337300                 MOVE 'XST_VND      ' TO DP013-DB2-TABLE-NAME (2) 33730099
337400                 MOVE 'XST_SKU      ' TO DP013-DB2-TABLE-NAME (3) 33740099
337500                 MOVE 'XST_UPC      ' TO DP013-DB2-TABLE-NAME (4) 33750099
337600                 SET DP013-DB2-ABEND                              33760099
337700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33770099
337800                 PERFORM DP013-0000-PROCESS-ABEND                 33780099
337900           END-EVALUATE                                           33790099
338000                                                                  33800099
338100     END-PERFORM.                                                 33810099
338200                                                                  33820099
338300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33830099
338400         STRING 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO CLOSE '   33840099
338500                 PV-CURSOR-NAME                                   33850099
338600                ' CURSOR'                                         33860099
338700                 DELIMITED BY SIZE                                33870099
338800                 INTO DP013-MESSAGE-TEXT (1)                      33880099
338900         MOVE SQLCA                TO DP013-SQLCA                 33890099
339000         MOVE 'SKU, VND, VND_STYL'                                33900099
339100                                   TO DP013-DB2-TABLE-NAME (1)    33910099
339200         MOVE 'SKU_LOC, UPC'                                      33920099
339300                                   TO DP013-DB2-TABLE-NAME (2)    33930099
339400         SET DP013-DB2-ABEND                                      33940099
339500             DP013-XCTL-DISPLAY-RESTART                           33950099
339600                                   TO TRUE                        33960099
339700         PERFORM DP013-0000-PROCESS-ABEND                         33970099
339800     END-IF.                                                      33980099
339900                                                                  33990099
340000*----------------------------------------------------------------*34000099
340100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *34010099
340200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *34020099
340300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *34030099
340400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *34040099
340500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *34050099
340600*                                                                *34060099
340700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *34070099
340800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *34080099
340900*    UPON INITIALIZATION.                                        *34090099
341000*----------------------------------------------------------------*34100099
341100                                                                  34110099
341200 4300-READ-ITEMS-FROM-DB.                                         34120099
341300                                                                  34130099
341400     PERFORM                                                      34140099
341500         VARYING PV-READ-COUNT                                    34150099
341600         FROM 1 BY 1                                              34160099
341700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    34170099
341800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         34180099
341900                                                                  34190099
342000         PERFORM 4310-FETCH-UPC                                   34200099
342100         IF SQLCODE = ZERO                                        34210099
342200            IF XST00010-REGN-PRIC-IND = 'Y'                       34220099
342300                PERFORM 4340-SELECT-STATUS                        34230099
342400            ELSE                                                  34240099
342500                PERFORM 4350-SELECT-STORE0-STATUS                 34250099
342600            END-IF                                                34260099
342700            IF ASC-STATUS = SPACES                                34270099
342800               SET PS-STATUS-MATCH TO TRUE                        34280099
342900            ELSE                                                  34290099
343000               IF ASC-STATUS = PV-STAT-CDE                        34300099
343100                  SET PS-STATUS-MATCH TO TRUE                     34310099
343200               ELSE                                               34320099
343300                  SET PS-STATUS-NO-MATCH TO TRUE                  34330099
343400               END-IF                                             34340099
343500            END-IF                                                34350099
343600         END-IF                                                   34360099
343700                                                                  34370099
343800         IF ASC-ITEMS-LEFT-ON-DB AND                              34380099
343900            PS-SKU-FND      AND                                   34390099
344000            PS-STATUS-MATCH                                       34400099
344100            IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 34410099
344200                ADD +1            TO ASC-ITEM-SUB                 34420099
344300            ELSE                                                  34430099
344400               ADD +1            TO ASC-BLK-SUB                   34440099
344500               MOVE +1           TO ASC-ITEM-SUB                  34450099
344600                                                                  34460099
344700               IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY            34470099
344800                  MOVE +1       TO ASC-BLK-SUB                    34480099
344900                  SET ASC-BLOCK-MODIFIED (1)                      34490099
345000                                TO TRUE                           34500099
345100                  PERFORM 5100-WRITE-TEMP-STORAGE                 34510099
345200                  MOVE ASC-BLOCK-ENTRIES                          34520099
345300                            (PC-MAX-BLOCKS-IN-ARRAY)              34530099
345400                             TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)    34540099
345500                  ADD +1        TO ASC-BLK-SUB                    34550099
345600                  INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)      34560099
345700                  SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)         34570099
345800                                   TO TRUE                        34580099
345900               END-IF                                             34590099
346000            END-IF                                                34600099
346100                                                                  34610099
346200            ADD +1                TO ASC-NUMBER-OF-ITEMS-READ     34620099
346300            MOVE ASC-NUMBER-OF-ITEMS-READ                         34630099
346400                                  TO ASC-LIST-ITEM-NUMBER         34640099
346500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   34650099
346600            MOVE XST00012-UPC-NBR                                 34660099
346700                TO ASC-DET-UPC-NBR      (ASC-BLK-SUB ASC-ITEM-SUB)34670099
346800            MOVE PV-STAT-CDE                                      34680099
346900                 TO ASC-DET-STAT-CDE                              34690099
347000                                        (ASC-BLK-SUB ASC-ITEM-SUB)34700099
347100            MOVE PV-UNT-RTL-AMT                                   34710099
347200                TO  ASC-DET-UNT-RTL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)34720099
347300*---------------------                                            34730099
347400            MOVE PV-CUR-UNT-RTL-AMT                               34740099
347500                TO  ASC-CUR-UNT-RTL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)34750099
347600*---------------------                                            34760099
347700            MOVE XST00010-SKU-NBR                                 34770099
347800                TO  ASC-DET-SKU-NBR     (ASC-BLK-SUB ASC-ITEM-SUB)34780099
347900            MOVE XST00013-MAJ-CL-NBR TO ASC-DET-MAJ-CL            34790099
348000                                        (ASC-BLK-SUB ASC-ITEM-SUB)34800099
348100            MOVE XST00013-SUB-CL-NBR TO ASC-DET-SUB-CL            34810099
348200                                        (ASC-BLK-SUB ASC-ITEM-SUB)34820099
348300                                                                  34830099
348400            INSPECT XST00010-SIZE-DESC REPLACING ALL '"' BY SPACE 34840099
348500                                                                  34850099
348600            MOVE XST00010-SIZE-DESC  TO ASC-DET-SIZE-DESC         34860099
348700                                        (ASC-BLK-SUB ASC-ITEM-SUB)34870099
348800            MOVE XST00010-NRF-CLOR-DESC   TO ASC-DET-CLOR-DESC    34880099
348900                                        (ASC-BLK-SUB ASC-ITEM-SUB)34890099
349000            MOVE XST00010-SKU-DESC   TO ASC-DET-SKU-DESC          34900099
349100                                        (ASC-BLK-SUB ASC-ITEM-SUB)34910099
349200         END-IF                                                   34920099
349300     END-PERFORM.                                                 34930099
349400                                                                  34940099
349500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          34950099
349600         MOVE +1               TO ASC-BLK-SUB                     34960099
349700         PERFORM 5100-WRITE-TEMP-STORAGE                          34970099
349800         ADD +1                TO ASC-BLK-SUB                     34980099
349900         PERFORM 5100-WRITE-TEMP-STORAGE                          34990099
350000                                                                  35000099
350100         MOVE 1                TO ASC-BLK-SUB                     35010099
350200                                  PV-BLOCK-NUMBER                 35020099
350300         PERFORM 4410-READ-TEMP-STORAGE                           35030099
350400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             35040099
350500             MOVE 2            TO ASC-BLK-SUB                     35050099
350600                                  PV-BLOCK-NUMBER                 35060099
350700             PERFORM 4410-READ-TEMP-STORAGE                       35070099
350800         END-IF                                                   35080099
350900     END-IF.                                                      35090099
351000 EJECT                                                            35100099
351100*----------------------------------------------------------------*35110099
351200*    FETCH THE CURSOR                                             35120099
351300*----------------------------------------------------------------*35130099
351400                                                                  35140099
351500 4310-FETCH-UPC.                                                  35150099
351600                                                                  35160099
351700     MOVE '4310-FETCH-UPC       ' TO DP013-PARAGRAPH.             35170099
351800                                                                  35180099
351900     PERFORM                                                      35190099
352000         WITH TEST AFTER                                          35200099
352100         VARYING PV-RETRY-COUNTER                                 35210099
352200         FROM 1 BY 1                                              35220099
352300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35230099
352400                   OR  SQLCODE = ZERO                             35240099
352500                   OR  SQLCODE = +100)                            35250099
352600                                                                  35260099
352700         EVALUATE TRUE                                            35270099
352800             WHEN CSR-VND-COLOR-SIZE                              35280099
352900                  EXEC SQL                                        35290099
353000                      FETCH CSR-VND-CLR-SZ                        35300099
353100                           INTO                                   35310099
353200                               :XST00012-UPC-NBR,                 35320099
353300                               :XST00013-DEPT-NBR,                35330099
353400                               :XST00013-MAJ-CL-NBR,              35340099
353500                               :XST00013-SUB-CL-NBR,              35350099
353600                               :XST00013-VS-NBR,                  35360099
353700                               :XST00010-SIZE-DESC,               35370099
353800                               :XST00010-SKU-NBR,                 35380099
353900                               :XST00010-SKU-DESC,                35390099
354000                               :XST00010-NRF-CLOR-DESC,           35400099
354100                               :XST00010-INTR-UPC-ID,             35410099
354200                               :XST00010-REGN-PRIC-IND            35420099
354300                  END-EXEC                                        35430099
354400                                                                  35440099
354500             WHEN CSR-VND-CLASS-COLOR-SIZE                        35450099
354600                  EXEC SQL                                        35460099
354700                      FETCH CSR-VND-CLS-CLR-SZ                    35470099
354800                           INTO                                   35480099
354900                               :XST00012-UPC-NBR,                 35490099
355000                               :XST00013-DEPT-NBR,                35500099
355100                               :XST00013-MAJ-CL-NBR,              35510099
355200                               :XST00013-SUB-CL-NBR,              35520099
355300                               :XST00013-VS-NBR,                  35530099
355400                               :XST00010-SIZE-DESC,               35540099
355500                               :XST00010-SKU-NBR,                 35550099
355600                               :XST00010-SKU-DESC,                35560099
355700                               :XST00010-NRF-CLOR-DESC,           35570099
355800                               :XST00010-INTR-UPC-ID,             35580099
355900                               :XST00010-REGN-PRIC-IND            35590099
356000                  END-EXEC                                        35600099
356100                                                                  35610099
356200             WHEN CSR-VND-STYLE-COLOR-SIZE                        35620099
356300                  EXEC SQL                                        35630099
356400                      FETCH CSR-VND-STY-CLR-SZ                    35640099
356500                           INTO                                   35650099
356600                               :XST00012-UPC-NBR,                 35660099
356700                               :XST00013-DEPT-NBR,                35670099
356800                               :XST00013-MAJ-CL-NBR,              35680099
356900                               :XST00013-SUB-CL-NBR,              35690099
357000                               :XST00013-VS-NBR,                  35700099
357100                               :XST00010-SIZE-DESC,               35710099
357200                               :XST00010-SKU-NBR,                 35720099
357300                               :XST00010-SKU-DESC,                35730099
357400                               :XST00010-NRF-CLOR-DESC,           35740099
357500                               :XST00010-INTR-UPC-ID,             35750099
357600                               :XST00010-REGN-PRIC-IND            35760099
357700                  END-EXEC                                        35770099
357800                                                                  35780099
357900             WHEN CSR-VND-COLOR                                   35790099
358000                  EXEC SQL                                        35800099
358100                      FETCH CSR-VND-CLR                           35810099
358200                           INTO                                   35820099
358300                               :XST00012-UPC-NBR,                 35830099
358400                               :XST00013-DEPT-NBR,                35840099
358500                               :XST00013-MAJ-CL-NBR,              35850099
358600                               :XST00013-SUB-CL-NBR,              35860099
358700                               :XST00013-VS-NBR,                  35870099
358800                               :XST00010-SIZE-DESC,               35880099
358900                               :XST00010-SKU-NBR,                 35890099
359000                               :XST00010-SKU-DESC,                35900099
359100                               :XST00010-NRF-CLOR-DESC,           35910099
359200                               :XST00010-INTR-UPC-ID,             35920099
359300                               :XST00010-REGN-PRIC-IND            35930099
359400                  END-EXEC                                        35940099
359500                                                                  35950099
359600             WHEN CSR-VND-CLASS-COLOR                             35960099
359700                  EXEC SQL                                        35970099
359800                      FETCH CSR-VND-CLS-CLR                       35980099
359900                           INTO                                   35990099
360000                               :XST00012-UPC-NBR,                 36000099
360100                               :XST00013-DEPT-NBR,                36010099
360200                               :XST00013-MAJ-CL-NBR,              36020099
360300                               :XST00013-SUB-CL-NBR,              36030099
360400                               :XST00013-VS-NBR,                  36040099
360500                               :XST00010-SIZE-DESC,               36050099
360600                               :XST00010-SKU-NBR,                 36060099
360700                               :XST00010-SKU-DESC,                36070099
360800                               :XST00010-NRF-CLOR-DESC,           36080099
360900                               :XST00010-INTR-UPC-ID,             36090099
361000                               :XST00010-REGN-PRIC-IND            36100099
361100                  END-EXEC                                        36110099
361200                                                                  36120099
361300             WHEN CSR-VND-STYLE-COLOR                             36130099
361400                  EXEC SQL                                        36140099
361500                      FETCH CSR-VND-STY-CLR                       36150099
361600                           INTO                                   36160099
361700                               :XST00012-UPC-NBR,                 36170099
361800                               :XST00013-DEPT-NBR,                36180099
361900                               :XST00013-MAJ-CL-NBR,              36190099
362000                               :XST00013-SUB-CL-NBR,              36200099
362100                               :XST00013-VS-NBR,                  36210099
362200                               :XST00010-SIZE-DESC,               36220099
362300                               :XST00010-SKU-NBR,                 36230099
362400                               :XST00010-SKU-DESC,                36240099
362500                               :XST00010-NRF-CLOR-DESC,           36250099
362600                               :XST00010-INTR-UPC-ID,             36260099
362700                               :XST00010-REGN-PRIC-IND            36270099
362800                  END-EXEC                                        36280099
362900                                                                  36290099
363000             WHEN CSR-VND-CLASS                                   36300099
363100                  EXEC SQL                                        36310099
363200                      FETCH CSR-VND-CLS                           36320099
363300                           INTO                                   36330099
363400                               :XST00012-UPC-NBR,                 36340099
363500                               :XST00013-DEPT-NBR,                36350099
363600                               :XST00013-MAJ-CL-NBR,              36360099
363700                               :XST00013-SUB-CL-NBR,              36370099
363800                               :XST00013-VS-NBR,                  36380099
363900                               :XST00010-SIZE-DESC,               36390099
364000                               :XST00010-SKU-NBR,                 36400099
364100                               :XST00010-SKU-DESC,                36410099
364200                               :XST00010-NRF-CLOR-DESC,           36420099
364300                               :XST00010-INTR-UPC-ID,             36430099
364400                               :XST00010-REGN-PRIC-IND            36440099
364500                  END-EXEC                                        36450099
364600                                                                  36460099
364700             WHEN CSR-VND-STYLE                                   36470099
364800                  EXEC SQL                                        36480099
364900                      FETCH CSR-VND-STY                           36490099
365000                           INTO                                   36500099
365100                               :XST00012-UPC-NBR,                 36510099
365200                               :XST00013-DEPT-NBR,                36520099
365300                               :XST00013-MAJ-CL-NBR,              36530099
365400                               :XST00013-SUB-CL-NBR,              36540099
365500                               :XST00013-VS-NBR,                  36550099
365600                               :XST00010-SIZE-DESC,               36560099
365700                               :XST00010-SKU-NBR,                 36570099
365800                               :XST00010-SKU-DESC,                36580099
365900                               :XST00010-NRF-CLOR-DESC,           36590099
366000                               :XST00010-INTR-UPC-ID,             36600099
366100                               :XST00010-REGN-PRIC-IND            36610099
366200                  END-EXEC                                        36620099
366300                                                                  36630099
366400             WHEN CSR-COLOR-SIZE                                  36640099
366500                  EXEC SQL                                        36650099
366600                      FETCH CSR-CLR-SZ                            36660099
366700                           INTO                                   36670099
366800                               :XST00012-UPC-NBR,                 36680099
366900                               :XST00013-DEPT-NBR,                36690099
367000                               :XST00013-MAJ-CL-NBR,              36700099
367100                               :XST00013-SUB-CL-NBR,              36710099
367200                               :XST00013-VS-NBR,                  36720099
367300                               :XST00010-SIZE-DESC,               36730099
367400                               :XST00010-SKU-NBR,                 36740099
367500                               :XST00010-SKU-DESC,                36750099
367600                               :XST00010-NRF-CLOR-DESC,           36760099
367700                               :XST00010-INTR-UPC-ID,             36770099
367800                               :XST00010-REGN-PRIC-IND            36780099
367900                  END-EXEC                                        36790099
368000                                                                  36800099
368100             WHEN CSR-CLASS-COLOR-SIZE                            36810099
368200                  EXEC SQL                                        36820099
368300                      FETCH CSR-CLS-CLR-SZ                        36830099
368400                           INTO                                   36840099
368500                               :XST00012-UPC-NBR,                 36850099
368600                               :XST00013-DEPT-NBR,                36860099
368700                               :XST00013-MAJ-CL-NBR,              36870099
368800                               :XST00013-SUB-CL-NBR,              36880099
368900                               :XST00013-VS-NBR,                  36890099
369000                               :XST00010-SIZE-DESC,               36900099
369100                               :XST00010-SKU-NBR,                 36910099
369200                               :XST00010-SKU-DESC,                36920099
369300                               :XST00010-NRF-CLOR-DESC,           36930099
369400                               :XST00010-INTR-UPC-ID,             36940099
369500                               :XST00010-REGN-PRIC-IND            36950099
369600                  END-EXEC                                        36960099
369700                                                                  36970099
369800             WHEN CSR-STYLE-COLOR-SIZE                            36980099
369900                  EXEC SQL                                        36990099
370000                      FETCH CSR-STY-CLR-SZ                        37000099
370100                           INTO                                   37010099
370200                               :XST00012-UPC-NBR,                 37020099
370300                               :XST00013-DEPT-NBR,                37030099
370400                               :XST00013-MAJ-CL-NBR,              37040099
370500                               :XST00013-SUB-CL-NBR,              37050099
370600                               :XST00013-VS-NBR,                  37060099
370700                               :XST00010-SIZE-DESC,               37070099
370800                               :XST00010-SKU-NBR,                 37080099
370900                               :XST00010-SKU-DESC,                37090099
371000                               :XST00010-NRF-CLOR-DESC,           37100099
371100                               :XST00010-INTR-UPC-ID,             37110099
371200                               :XST00010-REGN-PRIC-IND            37120099
371300                  END-EXEC                                        37130099
371400                                                                  37140099
371500             WHEN CSR-COLOR                                       37150099
371600                  EXEC SQL                                        37160099
371700                      FETCH CSR-CLR                               37170099
371800                           INTO                                   37180099
371900                               :XST00012-UPC-NBR,                 37190099
372000                               :XST00013-DEPT-NBR,                37200099
372100                               :XST00013-MAJ-CL-NBR,              37210099
372200                               :XST00013-SUB-CL-NBR,              37220099
372300                               :XST00013-VS-NBR,                  37230099
372400                               :XST00010-SIZE-DESC,               37240099
372500                               :XST00010-SKU-NBR,                 37250099
372600                               :XST00010-SKU-DESC,                37260099
372700                               :XST00010-NRF-CLOR-DESC,           37270099
372800                               :XST00010-INTR-UPC-ID,             37280099
372900                               :XST00010-REGN-PRIC-IND            37290099
373000                  END-EXEC                                        37300099
373100                                                                  37310099
373200             WHEN CSR-CLASS-COLOR                                 37320099
373300                  EXEC SQL                                        37330099
373400                      FETCH CSR-CLS-CLR                           37340099
373500                           INTO                                   37350099
373600                               :XST00012-UPC-NBR,                 37360099
373700                               :XST00013-DEPT-NBR,                37370099
373800                               :XST00013-MAJ-CL-NBR,              37380099
373900                               :XST00013-SUB-CL-NBR,              37390099
374000                               :XST00013-VS-NBR,                  37400099
374100                               :XST00010-SIZE-DESC,               37410099
374200                               :XST00010-SKU-NBR,                 37420099
374300                               :XST00010-SKU-DESC,                37430099
374400                               :XST00010-NRF-CLOR-DESC,           37440099
374500                               :XST00010-INTR-UPC-ID,             37450099
374600                               :XST00010-REGN-PRIC-IND            37460099
374700                  END-EXEC                                        37470099
374800                                                                  37480099
374900             WHEN CSR-STYLE-COLOR                                 37490099
375000                  EXEC SQL                                        37500099
375100                      FETCH CSR-STY-CLR                           37510099
375200                           INTO                                   37520099
375300                               :XST00012-UPC-NBR,                 37530099
375400                               :XST00013-DEPT-NBR,                37540099
375500                               :XST00013-MAJ-CL-NBR,              37550099
375600                               :XST00013-SUB-CL-NBR,              37560099
375700                               :XST00013-VS-NBR,                  37570099
375800                               :XST00010-SIZE-DESC,               37580099
375900                               :XST00010-SKU-NBR,                 37590099
376000                               :XST00010-SKU-DESC,                37600099
376100                               :XST00010-NRF-CLOR-DESC,           37610099
376200                               :XST00010-INTR-UPC-ID,             37620099
376300                               :XST00010-REGN-PRIC-IND            37630099
376400                  END-EXEC                                        37640099
376500                                                                  37650099
376600             WHEN CSR-CLASS                                       37660099
376700                  EXEC SQL                                        37670099
376800                      FETCH CSR-CLS                               37680099
376900                           INTO                                   37690099
377000                               :XST00012-UPC-NBR,                 37700099
377100                               :XST00013-DEPT-NBR,                37710099
377200                               :XST00013-MAJ-CL-NBR,              37720099
377300                               :XST00013-SUB-CL-NBR,              37730099
377400                               :XST00013-VS-NBR,                  37740099
377500                               :XST00010-SIZE-DESC,               37750099
377600                               :XST00010-SKU-NBR,                 37760099
377700                               :XST00010-SKU-DESC,                37770099
377800                               :XST00010-NRF-CLOR-DESC,           37780099
377900                               :XST00010-INTR-UPC-ID,             37790099
378000                               :XST00010-REGN-PRIC-IND            37800099
378100                  END-EXEC                                        37810099
378200                                                                  37820099
378300             WHEN CSR-STYLE                                       37830099
378400                  EXEC SQL                                        37840099
378500                      FETCH CSR-STY                               37850099
378600                           INTO                                   37860099
378700                               :XST00012-UPC-NBR,                 37870099
378800                               :XST00013-DEPT-NBR,                37880099
378900                               :XST00013-MAJ-CL-NBR,              37890099
379000                               :XST00013-SUB-CL-NBR,              37900099
379100                               :XST00013-VS-NBR,                  37910099
379200                               :XST00010-SIZE-DESC,               37920099
379300                               :XST00010-SKU-NBR,                 37930099
379400                               :XST00010-SKU-DESC,                37940099
379500                               :XST00010-NRF-CLOR-DESC,           37950099
379600                               :XST00010-INTR-UPC-ID,             37960099
379700                               :XST00010-REGN-PRIC-IND            37970099
379800                  END-EXEC                                        37980099
379900                                                                  37990099
380000             WHEN CSR-SIMILAR                                     38000099
380100                  EXEC SQL                                        38010099
380200                      FETCH SIMILAR-CSR                           38020099
380300                           INTO                                   38030099
380400                               :XST00012-UPC-NBR,                 38040099
380500                               :XST00013-DEPT-NBR,                38050099
380600                               :XST00013-MAJ-CL-NBR,              38060099
380700                               :XST00013-SUB-CL-NBR,              38070099
380800                               :XST00013-STYL-ID,                 38080099
380900                               :XST00013-VS-NBR,                  38090099
381000                               :XST00010-SIZE-DESC,               38100099
381100                               :XST00010-SKU-NBR,                 38110099
381200                               :XST00010-SKU-DESC,                38120099
381300                               :XST00010-NRF-CLOR-DESC,           38130099
381400                               :XST00010-INTR-UPC-ID,             38140099
381500                               :XST00010-REGN-PRIC-IND            38150099
381600                  END-EXEC                                        38160099
381700                                                                  38170099
381800             WHEN CSR-SIMILAR-STYLE                               38180099
381900                  EXEC SQL                                        38190099
382000                      FETCH SIMILAR-STYLE-CSR                     38200099
382100                           INTO                                   38210099
382200                               :XST00012-UPC-NBR,                 38220099
382300                               :XST00013-DEPT-NBR,                38230099
382400                               :XST00013-MAJ-CL-NBR,              38240099
382500                               :XST00013-SUB-CL-NBR,              38250099
382600                               :XST00013-STYL-ID,                 38260099
382700                               :XST00013-VS-NBR,                  38270099
382800                               :XST00010-SIZE-DESC,               38280099
382900                               :XST00010-SKU-NBR,                 38290099
383000                               :XST00010-SKU-DESC,                38300099
383100                               :XST00010-NRF-CLOR-DESC,           38310099
383200                               :XST00010-INTR-UPC-ID,             38320099
383300                               :XST00010-REGN-PRIC-IND            38330099
383400                  END-EXEC                                        38340099
383500                                                                  38350099
383600             WHEN CSR-STLPGM409                                   38360099
383700                  EXEC SQL                                        38370099
383800                      FETCH STLPGM409-CSR                         38380099
383900                           INTO                                   38390099
384000                               :XST00012-UPC-NBR,                 38400099
384100                               :XST00013-DEPT-NBR,                38410099
384200                               :XST00013-MAJ-CL-NBR,              38420099
384300                               :XST00013-SUB-CL-NBR,              38430099
384400                               :XST00013-STYL-ID,                 38440099
384500                               :XST00013-VS-NBR,                  38450099
384600                               :XST00010-SIZE-DESC,               38460099
384700                               :XST00010-SKU-NBR,                 38470099
384800                               :XST00010-SKU-DESC,                38480099
384900                               :XST00010-NRF-CLOR-DESC,           38490099
385000                               :XST00010-INTR-UPC-ID,             38500099
385100                               :XST00010-REGN-PRIC-IND            38510099
385200                  END-EXEC                                        38520099
385300                                                                  38530099
385400             WHEN CSR-MAJOR-CLASS                                 38540099
385500                  EXEC SQL                                        38550099
385600                      FETCH CSR-MAJOR-CLASS                       38560099
385700                           INTO                                   38570099
385800                               :XST00012-UPC-NBR,                 38580099
385900                               :XST00013-DEPT-NBR,                38590099
386000                               :XST00013-MAJ-CL-NBR,              38600099
386100                               :XST00013-SUB-CL-NBR,              38610099
386200                               :XST00013-VS-NBR,                  38620099
386300                               :XST00010-SIZE-DESC,               38630099
386400                               :XST00010-SKU-NBR,                 38640099
386500                               :XST00010-SKU-DESC,                38650099
386600                               :XST00010-NRF-CLOR-DESC,           38660099
386700                               :XST00010-INTR-UPC-ID,             38670099
386800                               :XST00010-REGN-PRIC-IND            38680099
386900                  END-EXEC                                        38690099
387000                                                                  38700099
387100             WHEN CSR-SUB-CLASS                                   38710099
387200                  EXEC SQL                                        38720099
387300                      FETCH CSR-SUB-CLASS                         38730099
387400                           INTO                                   38740099
387500                               :XST00012-UPC-NBR,                 38750099
387600                               :XST00013-DEPT-NBR,                38760099
387700                               :XST00013-MAJ-CL-NBR,              38770099
387800                               :XST00013-SUB-CL-NBR,              38780099
387900                               :XST00013-VS-NBR,                  38790099
388000                               :XST00010-SIZE-DESC,               38800099
388100                               :XST00010-SKU-NBR,                 38810099
388200                               :XST00010-SKU-DESC,                38820099
388300                               :XST00010-NRF-CLOR-DESC,           38830099
388400                               :XST00010-INTR-UPC-ID,             38840099
388500                               :XST00010-REGN-PRIC-IND            38850099
388600                  END-EXEC                                        38860099
388700                                                                  38870099
388800             WHEN OTHER                                           38880099
388900                  SET DP013-LOGIC-ABEND TO TRUE                   38890099
389000                  SET DP013-NO-ROLLBACK TO TRUE                   38900099
389100                  STRING 'NO CURSOR SWITCH SET - '                38910099
389200                         'PLEASE CORRECT PROGRAM LOGIC'           38920099
389300                          DELIMITED BY SIZE                       38930099
389400                          INTO DP013-MESSAGE-TEXT (1)             38940099
389500                  PERFORM DP013-0000-PROCESS-ABEND                38950099
389600                                                                  38960099
389700         END-EVALUATE                                             38970099
389800                                                                  38980099
389900         EVALUATE TRUE                                            38990099
390000           WHEN SQLCODE = ZERO                                    39000099
390100                MOVE XST00010-INTR-UPC-ID TO PV-INTR-UPC-ID       39010099
390200           WHEN SQLCODE = +100                                    39020099
390300                CONTINUE                                          39030099
390400           WHEN SQLWARN0 NOT = SPACE                              39040099
390500           WHEN SQLCODE NOT = ZERO                                39050099
390600                STRING 'FETCH  '                                  39060099
390700                        PV-CURSOR-NAME                            39070099
390800                       ' CURSOR'                                  39080099
390900                        DELIMITED BY SIZE                         39090099
391000                        INTO DP013-MESSAGE-TEXT (1)               39100099
391100                MOVE 'XST_VND_STYL ' TO DP013-DB2-TABLE-NAME (1)  39110099
391200                MOVE 'XST_VND      ' TO DP013-DB2-TABLE-NAME (2)  39120099
391300                MOVE 'XST_SKU      ' TO DP013-DB2-TABLE-NAME (3)  39130099
391400                MOVE 'XST_UPC      ' TO DP013-DB2-TABLE-NAME (4)  39140099
391500                MOVE SQLCA          TO DP013-SQLCA                39150099
391600                SET DP013-DB2-ABEND                               39160099
391700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            39170099
391800                PERFORM DP013-0000-PROCESS-ABEND                  39180099
391900                                                                  39190099
392000         END-EVALUATE                                             39200099
392100                                                                  39210099
392200     END-PERFORM.                                                 39220099
392300                                                                  39230099
392400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39240099
392500         STRING 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO FETCH '   39250099
392600                 PV-CURSOR-NAME                                   39260099
392700                ' CURSOR'                                         39270099
392800                 DELIMITED BY SIZE                                39280099
392900                 INTO DP013-MESSAGE-TEXT (1)                      39290099
393000         MOVE SQLCA                TO DP013-SQLCA                 39300099
393100         SET DP013-DB2-ABEND                                      39310099
393200             DP013-XCTL-DISPLAY-RESTART                           39320099
393300                                   TO TRUE                        39330099
393400         PERFORM DP013-0000-PROCESS-ABEND                         39340099
393500     END-IF.                                                      39350099
393600                                                                  39360099
393700     IF  SQLCODE EQUAL +100                                       39370099
393800         SET ASC-NO-ITEMS-LEFT-ON-DB                              39380099
393900                                 TO TRUE                          39390099
394000     END-IF.                                                      39400099
394100                                                                  39410099
394200*----------------------------------------------------------------*39420099
394300*    FIND THE STYLE-ID SO ALL SIMILAR UPCS CAN BE RETRIEVED      *39430099
394400*         AND DISPLAYED.                                         *39440099
394500*----------------------------------------------------------------*39450099
394600                                                                  39460099
394700 4330-SELECT-STYL-ID.                                             39470099
394800                                                                  39480099
394900     PERFORM                                                      39490099
395000         WITH TEST AFTER                                          39500099
395100         VARYING PV-RETRY-COUNTER                                 39510099
395200         FROM 1 BY 1                                              39520099
395300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39530099
395400                   OR  SQLCODE = ZERO                             39540099
395500                   OR  SQLCODE = +100)                            39550099
395600                                                                  39560099
395700         EXEC SQL                                                 39570099
395800                SELECT                                            39580099
395900                        UPC.UPC_NBR                               39590099
396000                       ,SKU.SIZE_DESC                             39600099
396100                       ,SKU.SKU_NBR                               39610099
396200                       ,SKU.STYL_ID                               39620099
396300                       ,SKU.SKU_DESC                              39630099
396400                       ,SKU.NRF_CLOR_DESC                         39640099
396500                       ,SKU.INTR_UPC_ID                           39650099
396600                  INTO                                            39660099
396700                        :XST00012-UPC-NBR                         39670099
396800                       ,:XST00010-SIZE-DESC                       39680099
396900                       ,:XST00010-SKU-NBR                         39690099
397000                       ,:XST00010-STYL-ID                         39700099
397100                       ,:XST00010-SKU-DESC                        39710099
397200                       ,:XST00010-NRF-CLOR-DESC                   39720099
397300                       ,:XST00010-INTR-UPC-ID                     39730099
397400                  FROM  XST_SKU       SKU                         39740099
397500                       ,XST_UPC       UPC                         39750099
397600                 WHERE  ((UPC.UPC_NBR      = :IQ016-UPC-NO)       39760099
397700                   AND  (UPC.LAST_ACTN_CDE NOT IN ('D')))         39770099
397800                   AND  SKU.INTR_UPC_ID    =  UPC.INTR_UPC_ID     39780099
397900         END-EXEC                                                 39790099
398000                                                                  39800099
398100         EVALUATE SQLCODE                                         39810099
398200             WHEN 0                                               39820099
398300                  MOVE XST00010-STYL-ID TO PV-STYL-ID             39830099
398400                                                                  39840099
398500             WHEN 100                                             39850099
398600                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           39860099
398700                  SET DP020-MSG-FATAL   TO  TRUE                  39870099
398800                  MOVE PC-TSYMSG-00457  TO  DP020-MSG-NUMBER      39880099
398900                                                                  39890099
399000             WHEN OTHER                                           39900099
399100                  MOVE '4330-SELECT-STYL-ID  ' TO DP013-PARAGRAPH 39910099
399200                  MOVE 'XST_SKU    ' TO DP013-DB2-TABLE-NAME (1)  39920099
399300                  MOVE 'XST_UPC    ' TO DP013-DB2-TABLE-NAME (2)  39930099
399400                  STRING 'SELECT ON '                             39940099
399500                          DP013-DB2-TABLE-NAME (1)                39950099
399600                          DP013-DB2-TABLE-NAME (2)                39960099
399700                         ' HAD BAD SQLCODE'                       39970099
399800                          DELIMITED BY SIZE                       39980099
399900                          INTO DP013-MESSAGE-TEXT (1)             39990099
400000                  MOVE SQLCA       TO DP013-SQLCA                 40000099
400100                  SET DP013-DB2-ABEND                             40010099
400200                      DP013-XCTL-DISPLAY-RESTART TO TRUE          40020099
400300                  PERFORM DP013-0000-PROCESS-ABEND                40030099
400400                                                                  40040099
400500         END-EVALUATE                                             40050099
400600                                                                  40060099
400700     END-PERFORM.                                                 40070099
400800                                                                  40080099
400900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40090099
401000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT ROW' 40100099
401100                                   TO DP013-MESSAGE-TEXT (1)      40110099
401200         MOVE SQLCA                TO DP013-SQLCA                 40120099
401300         MOVE 'XST_SKU, XST_UPC  ' TO DP013-DB2-TABLE-NAME (1)    40130099
401400         SET DP013-DB2-ABEND                                      40140099
401500             DP013-XCTL-DISPLAY-RESTART                           40150099
401600                                   TO TRUE                        40160099
401700         PERFORM DP013-0000-PROCESS-ABEND                         40170099
401800     END-IF.                                                      40180099
401900                                                                  40190099
402000*----------------------------------------------------------------*40200099
402100*     SELECTS LOC_SKU_STAT_CDE TO DETERMINE IF THE ITEM IS        40210099
402200*     CLEARANCE OR NOT.                                           40220099
402300*----------------------------------------------------------------*40230099
402400 4340-SELECT-STATUS.                                              40240099
402500                                                                  40250099
402600     MOVE DP020-LOCATION-NBR TO PV-STORE-NUMBER.                  40260099
402800                                                                  40280099
402900     IF XST00010-REGN-PRIC-IND = 'Y'                              40290099
403000                                                                  40300099
403100         PERFORM                                                  40310099
403200             WITH TEST AFTER                                      40320099
403300             VARYING PV-RETRY-COUNTER                             40330099
403400             FROM 1 BY 1                                          40340099
403500             UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)           40350099
403600                       OR SQLCODE = ZERO                          40360099
403700                       OR SQLCODE = +100)                         40370099
403800             EXEC SQL                                             40380099
403900                SELECT LOC_SKU_STAT_CDE                           40390099
404000                      ,UNT_RTL_AMT                                40400099
404100                  INTO :XST00008-LOC-SKU-STAT-CDE                 40410099
404200                      ,:XST00008-UNT-RTL-AMT                      40420099
404300                  FROM XST_SKU_LOC                                40430099
404400                 WHERE INTR_UPC_ID = :PV-INTR-UPC-ID              40440099
404500                   AND LOC_NBR = :PV-STORE-NUMBER                 40450099
404600                   AND BEG_TMST <= CURRENT TIMESTAMP              40460099
404700                   AND (END_TMST >= CURRENT TIMESTAMP             40470099
404800                        OR END_TMST IS NULL)                      40480099
404900             END-EXEC                                             40490099
405000                                                                  40500099
405100             EVALUATE TRUE                                        40510099
405200                 WHEN SQLCODE = ZERO                              40520099
405300                      IF  XST00008-LOC-SKU-STAT-CDE = '30'        40530099
405400                          MOVE XST00008-UNT-RTL-AMT               40540099
405500                                        TO PV-CUR-UNT-RTL-AMT     40550099
405600                          MOVE XST00008-LOC-SKU-STAT-CDE          40560099
405700                                             TO PV-STAT-CDE       40570099
405800                          PERFORM  4360-SELECT-NON-CLR-PRICE      40580099
405900                      ELSE                                        40590099
406000                          MOVE XST00008-LOC-SKU-STAT-CDE          40600099
406100                                             TO PV-STAT-CDE       40610099
406200                          MOVE XST00008-UNT-RTL-AMT               40620099
406300                                        TO PV-UNT-RTL-AMT         40630099
406400                                           PV-CUR-UNT-RTL-AMT     40640099
406500                          SET PS-SKU-FND TO TRUE                  40650099
406600                      END-IF                                      40660099
406700                 WHEN SQLCODE = +100                              40670099
406800                      PERFORM 4350-SELECT-STORE0-STATUS           40680099
406900                 WHEN SQLWARN0 NOT = SPACE                        40690099
407000                 WHEN SQLCODE NOT = ZERO                          40700099
407100                      MOVE SQLCODE TO PV-SQLCODE                  40710099
407200                      MOVE '4320-SELECT-STATUS   '                40720099
407300                                       TO DP013-PARAGRAPH         40730099
407400                      MOVE 'XST_SKU_LOC    ' TO                   40740099
407500                                        DP013-DB2-TABLE-NAME (1)  40750099
407600                      MOVE PV-INTR-UPC-ID   TO PV-LONG-COMP-UPC-ID40760099
407700                      MOVE PV-LONG-COMP-UPC-ID TO PV-INTR-UPC-ID-D40770099
407800                      STRING 'SELECT ON '                         40780099
407900                              DP013-DB2-TABLE-NAME (1)            40790099
408000                             ' HAD BAD SQLCODE '                  40800099
408100                              PV-SQLCODE  ' '                     40810099
408200                              PV-INTR-UPC-ID-D                    40820099
408300                              DELIMITED BY SIZE                   40830099
408400                              INTO DP013-MESSAGE-TEXT (1)         40840099
408500                      SET DP013-DB2-ABEND                         40850099
408600                          DP013-XCTL-DISPLAY-RESTART TO TRUE      40860099
408700                      PERFORM DP013-0000-PROCESS-ABEND            40870099
408800             END-EVALUATE                                         40880099
408900                                                                  40890099
409000         END-PERFORM                                              40900099
409100                                                                  40910099
409200         IF PV-RETRY-COUNTER > PC-MAX-RETRIES                     40920099
409300             STRING 'MAX RETRIES EXCEEDED ATTEMPTING TO SELECT'   40930099
409400                     DELIMITED BY SIZE                            40940099
409500                     INTO DP013-MESSAGE-TEXT (1)                  40950099
409600             SET DP013-DB2-ABEND                                  40960099
409700                 DP013-XCTL-DISPLAY-RESTART                       40970099
409800                                       TO TRUE                    40980099
409900             PERFORM DP013-0000-PROCESS-ABEND                     40990099
410000         END-IF                                                   41000099
410100     ELSE                                                         41010099
410200         PERFORM 4350-SELECT-STORE0-STATUS                        41020099
410300     END-IF.                                                      41030099
410400                                                                  41040099
410500                                                                  41050099
410600*----------------------------------------------------------------*41060099
410700*     SELECTS LOC_SKU_STAT_CDE TO DETERMINE IF THE ITEM IS        41070099
410800*     CLEARANCE OR NOT FROM STORE 0.                              41080099
410900*----------------------------------------------------------------*41090099
411000 4350-SELECT-STORE0-STATUS.                                       41100099
411100                                                                  41110099
411200     PERFORM                                                      41120099
411300         WITH TEST AFTER                                          41130099
411400         VARYING PV-RETRY-COUNTER                                 41140099
411500         FROM 1 BY 1                                              41150099
411600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41160099
411700                   OR SQLCODE = ZERO                              41170099
411800                   OR SQLCODE = +100)                             41180099
411900         EXEC SQL                                                 41190099
412000            SELECT LOC_SKU_STAT_CDE                               41200099
412100                  ,UNT_RTL_AMT                                    41210099
412200              INTO :XST00008-LOC-SKU-STAT-CDE                     41220099
412300                  ,:XST00008-UNT-RTL-AMT                          41230099
412400              FROM XST_SKU_LOC                                    41240099
412500             WHERE INTR_UPC_ID = :PV-INTR-UPC-ID                  41250099
412600               AND LOC_NBR = 0                                    41260099
412700               AND BEG_TMST <= CURRENT TIMESTAMP                  41270099
412800               AND (END_TMST >= CURRENT TIMESTAMP                 41280099
412900                    OR END_TMST IS NULL)                          41290099
413000         END-EXEC                                                 41300099
413100                                                                  41310099
413200         EVALUATE TRUE                                            41320099
413300             WHEN SQLCODE = ZERO                                  41330099
413400                 MOVE XST00008-UNT-RTL-AMT                        41340099
413500                                       TO PV-CUR-UNT-RTL-AMT      41350099
413600                 IF  XST00008-LOC-SKU-STAT-CDE = '30'             41360099
413700                    MOVE XST00008-LOC-SKU-STAT-CDE                41370099
413800                                            TO PV-STAT-CDE        41380099
413900                    PERFORM  4360-SELECT-NON-CLR-PRICE            41390099
414000                 ELSE                                             41400099
414100                    MOVE XST00008-LOC-SKU-STAT-CDE                41410099
414200                                            TO PV-STAT-CDE        41420099
414300                    MOVE XST00008-UNT-RTL-AMT                     41430099
414400                                       TO PV-UNT-RTL-AMT          41440099
414500                                          PV-CUR-UNT-RTL-AMT      41450099
414600                    SET PS-SKU-FND TO TRUE                        41460099
414700                 END-IF                                           41470099
414800             WHEN SQLCODE = +100                                  41480099
414900             WHEN SQLWARN0 NOT = SPACE                            41490099
415000             WHEN SQLCODE NOT = ZERO                              41500099
415100                  MOVE SQLCODE             TO PV-SQLCODE          41510099
415200                  MOVE PV-INTR-UPC-ID      TO PV-LONG-COMP-UPC-ID 41520099
415300                  MOVE PV-LONG-COMP-UPC-ID TO PV-INTR-UPC-ID-D    41530099
415400                  MOVE '4350-SELECT-STORE0-STATUS'                41540099
415500                                   TO DP013-PARAGRAPH             41550099
415600                  MOVE 'XST_SKU_LOC    ' TO                       41560099
415700                                    DP013-DB2-TABLE-NAME (1)      41570099
415800                  STRING 'SELECT ON '                             41580099
415900                          DP013-DB2-TABLE-NAME (1)                41590099
416000                         ' HAD BAD SQLCODE '                      41600099
416100                          PV-SQLCODE  ' '                         41610099
416200                          PV-INTR-UPC-ID-D                        41620099
416300                          DELIMITED BY SIZE                       41630099
416400                          INTO DP013-MESSAGE-TEXT (1)             41640099
416500                  SET DP013-DB2-ABEND                             41650099
416600                      DP013-XCTL-DISPLAY-RESTART TO TRUE          41660099
416700                  PERFORM DP013-0000-PROCESS-ABEND                41670099
416800         END-EVALUATE                                             41680099
416900                                                                  41690099
417000     END-PERFORM                                                  41700099
417100                                                                  41710099
417200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41720099
417300         STRING 'MAX RETRIES EXCEEDED ATTEMPTING TO SELECT'       41730099
417400                 DELIMITED BY SIZE                                41740099
417500                 INTO DP013-MESSAGE-TEXT (1)                      41750099
417600         SET DP013-DB2-ABEND                                      41760099
417700             DP013-XCTL-DISPLAY-RESTART                           41770099
417800                                   TO TRUE                        41780099
417900         PERFORM DP013-0000-PROCESS-ABEND                         41790099
418000     END-IF.                                                      41800099
418100                                                                  41810099
418200*----------------------------------------------------------------*41820099
418300* SELECTS LAST NON CLRNCE PRICE FROM XST_SKU_ATTR                 41830099
418400*----------------------------------------------------------------*41840099
418500 4360-SELECT-NON-CLR-PRICE.                                       41850099
418600                                                                  41860099
418700     PERFORM                                                      41870099
418800         WITH TEST AFTER                                          41880099
418900         VARYING PV-RETRY-COUNTER                                 41890099
419000         FROM 1 BY 1                                              41900099
419100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41910099
419200                   OR SQLCODE = ZERO                              41920099
419300                   OR SQLCODE = +100)                             41930099
419400                                                                  41940099
419500         EXEC SQL                                                 41950099
419600            SELECT LAST_NCLR_RTL_AMT                              41960099
419700              INTO :XST00011-LAST-NCLR-RTL-AMT                    41970099
419800                   :IV-LAST-NCLR-RTL-AMT                          41980099
419900              FROM XST_SKU_ATTR                                   41990099
420000             WHERE INTR_UPC_ID = :PV-INTR-UPC-ID                  42000099
420100         END-EXEC                                                 42010099
420200                                                                  42020099
420300         EVALUATE TRUE                                            42030099
420400             WHEN SQLCODE = ZERO                                  42040099
420500                  IF IV-LAST-NCLR-RTL-AMT = 0                     42050099
420600                     SET PS-SKU-FND TO TRUE                       42060099
420700                     MOVE XST00011-LAST-NCLR-RTL-AMT TO           42070099
420800                                      PV-UNT-RTL-AMT              42080099
420900                  ELSE                                            42090099
421000                     PERFORM  4370-SELECT-ORIG-PRICE              42100099
421100                  END-IF                                          42110099
421200             WHEN SQLCODE = +100                                  42120099
421300                  PERFORM  4370-SELECT-ORIG-PRICE                 42130099
421400             WHEN SQLWARN0 NOT = SPACE                            42140099
421500             WHEN SQLCODE NOT = ZERO                              42150099
421600                  MOVE SQLCODE          TO PV-SQLCODE             42160099
421700                  MOVE PV-INTR-UPC-ID   TO PV-LONG-COMP-UPC-ID    42170099
421800                  MOVE PV-LONG-COMP-UPC-ID TO PV-INTR-UPC-ID-D    42180099
421900                  MOVE '4360-SELECT-NON-CLR-PRICE    '            42190099
422000                                   TO DP013-PARAGRAPH             42200099
422100                  MOVE 'XST_SKU_ATTR   ' TO                       42210099
422200                                    DP013-DB2-TABLE-NAME (1)      42220099
422300                  STRING 'SELECT ON '                             42230099
422400                          DP013-DB2-TABLE-NAME (1)                42240099
422500                         ' HAD BAD SQLCODE '                      42250099
422600                          PV-SQLCODE  ' '                         42260099
422700                          PV-INTR-UPC-ID-D                        42270099
422800                          DELIMITED BY SIZE                       42280099
422900                          INTO DP013-MESSAGE-TEXT (1)             42290099
423000                  SET DP013-DB2-ABEND                             42300099
423100                      DP013-XCTL-DISPLAY-RESTART TO TRUE          42310099
423200                  PERFORM DP013-0000-PROCESS-ABEND                42320099
423300         END-EVALUATE                                             42330099
423400                                                                  42340099
423500     END-PERFORM                                                  42350099
423600                                                                  42360099
423700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         42370099
423800         STRING 'MAX RETRIES EXCEEDED ATTEMPTING TO SELECT'       42380099
423900                 DELIMITED BY SIZE                                42390099
424000                 INTO DP013-MESSAGE-TEXT (1)                      42400099
424100         SET DP013-DB2-ABEND                                      42410099
424200             DP013-XCTL-DISPLAY-RESTART                           42420099
424300                                   TO TRUE                        42430099
424400         PERFORM DP013-0000-PROCESS-ABEND                         42440099
424500     END-IF.                                                      42450099
424600                                                                  42460099
424700*----------------------------------------------------------------*42470099
424800* SELECTS PRICE FROM TSK WHEN PRINTING FROM THIS PROGRAM          42480099
424900*----------------------------------------------------------------*42490099
425000 4370-SELECT-ORIG-PRICE.                                          42500099
425100                                                                  42510099
425200     PERFORM                                                      42520099
425300         WITH TEST AFTER                                          42530099
425400         VARYING PV-RETRY-COUNTER                                 42540099
425500         FROM 1 BY 1                                              42550099
425600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42560099
425700                   OR SQLCODE = ZERO                              42570099
425800                   OR SQLCODE = +100)                             42580099
425900                                                                  42590099
426000         EXEC SQL                                                 42600099
426100            SELECT B.ORIG_UNIT_RTL_AMT                            42610099
426200              INTO :TSK-ORIG-UNIT-RTL-AMT                         42620099
426300              FROM TUPCSKU A,                                     42630099
426400                   TSK     B                                      42640099
426500             WHERE A.UPC_NBR = :XST00012-UPC-NBR                  42650099
426600               AND A.ITEM_NBR = B.ITEM_NMBR                       42660099
426700         END-EXEC                                                 42670099
426800                                                                  42680099
426900         EVALUATE TRUE                                            42690099
427000             WHEN SQLCODE = ZERO                                  42700099
427100                  SET PS-SKU-FND TO TRUE                          42710099
427200                  MOVE TSK-ORIG-UNIT-RTL-AMT TO                   42720099
427300                                      PV-UNT-RTL-AMT              42730099
427400             WHEN SQLCODE = +100                                  42740099
427500                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           42750099
427600                  SET DP030-OVERRIDE-GO TO  TRUE                  42760099
427700                  SET DP020-MSG-FATAL   TO  TRUE                  42770099
427800                  MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER      42780099
427900             WHEN SQLWARN0 NOT = SPACE                            42790099
428000             WHEN SQLCODE NOT = ZERO                              42800099
428100                  MOVE '4370-SELECT-ORIG-PRICE    '               42810099
428200                                   TO DP013-PARAGRAPH             42820099
428300                  MOVE 'TUPCSKU        ' TO                       42830099
428400                                    DP013-DB2-TABLE-NAME (1)      42840099
428500                  MOVE 'TSK            ' TO                       42850099
428600                                    DP013-DB2-TABLE-NAME (2)      42860099
428700                  STRING 'SELECT ON '                             42870099
428800                          DP013-DB2-TABLE-NAME (1)                42880099
428900                          DP013-DB2-TABLE-NAME (2)                42890099
429000                         ' HAD BAD SQLCODE'                       42900099
429100                          DELIMITED BY SIZE                       42910099
429200                          INTO DP013-MESSAGE-TEXT (1)             42920099
429300                  SET DP013-DB2-ABEND                             42930099
429400                      DP013-XCTL-DISPLAY-RESTART TO TRUE          42940099
429500                  PERFORM DP013-0000-PROCESS-ABEND                42950099
429600         END-EVALUATE                                             42960099
429700                                                                  42970099
429800     END-PERFORM                                                  42980099
429900                                                                  42990099
430000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         43000099
430100         STRING 'MAX RETRIES EXCEEDED ATTEMPTING TO SELECT'       43010099
430200                 DELIMITED BY SIZE                                43020099
430300                 INTO DP013-MESSAGE-TEXT (1)                      43030099
430400         SET DP013-DB2-ABEND                                      43040099
430500             DP013-XCTL-DISPLAY-RESTART                           43050099
430600                                   TO TRUE                        43060099
430700         PERFORM DP013-0000-PROCESS-ABEND                         43070099
430800     END-IF.                                                      43080099
430900                                                                  43090099
431000*----------------------------------------------------------------*43100099
431100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *43110099
431200*----------------------------------------------------------------*43120099
431300                                                                  43130099
431400 4400-MOVE-COMMAREA-TO-SCREEN.                                    43140099
431500                                                                  43150099
431600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             43160099
431700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          43170099
431800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          43180099
431900             MOVE +1    TO ASC-BLK-SUB                            43190099
432000             PERFORM 5100-WRITE-TEMP-STORAGE                      43200099
432100             ADD +1     TO ASC-BLK-SUB                            43210099
432200             PERFORM 5100-WRITE-TEMP-STORAGE                      43220099
432300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             43230099
432400                 GIVING PV-BLOCK-NUMBER                           43240099
432500                 REMAINDER PV-REMAINDER                           43250099
432600             IF  PV-REMAINDER > ZERO                              43260099
432700                 ADD +1 TO PV-BLOCK-NUMBER                        43270099
432800             END-IF                                               43280099
432900             MOVE +1    TO ASC-BLK-SUB                            43290099
433000             PERFORM 4410-READ-TEMP-STORAGE                       43300099
433100             ADD +1     TO ASC-BLK-SUB                            43310099
433200                           PV-BLOCK-NUMBER                        43320099
433300             PERFORM 4410-READ-TEMP-STORAGE                       43330099
433400     END-IF.                                                      43340099
433500     MOVE +1            TO ASC-BLK-SUB.                           43350099
433600     COMPUTE ASC-ITEM-SUB =                                       43360099
433700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              43370099
433800         + PC-ITEMS-PER-PANEL).                                   43380099
433900*                                                                 43390099
434000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        43400099
434100         ADD +1         TO ASC-BLK-SUB                            43410099
434200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            43420099
434300     END-IF.                                                      43430099
434400*                                                                 43440099
434500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           43450099
434600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                43460099
434700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        43470099
434800     PERFORM 4420-FORMAT-LIST-LINES                               43480099
434900         VARYING PV-SUB                                           43490099
435000         FROM PC-ITEMS-PER-PANEL BY -1                            43500099
435100         UNTIL PV-SUB < +1.                                       43510099
435200*                                                                 43520099
435300     COMPUTE ASC-ITEMS-DISPLAYED =                                43530099
435400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          43540099
435500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    43550099
435600                                      ASTRTITO.                   43560099
435700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    43570099
435800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    43580099
435900     IF  DP020-MSG-NUMBER-X = SPACE                               43590099
436000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  43600099
436100*            --- MORE ITEMS TO DISPLAY ----                       43610099
436200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            43620099
436300             SET DP020-MSG-INFORMATIONAL TO TRUE                  43630099
436400         END-IF                                                   43640099
436500     END-IF.                                                      43650099
436600*----------------------------------------------------------------*43660099
436700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *43670099
436800*----------------------------------------------------------------*43680099
436900                                                                  43690099
437000 4410-READ-TEMP-STORAGE.                                          43700099
437100                                                                  43710099
437200     EXEC CICS                                                    43720099
437300         READQ TS                                                 43730099
437400             QUEUE (ASC-LIST-QUEUE-NAME)                          43740099
437500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               43750099
437600             ITEM  (PV-BLOCK-NUMBER)                              43760099
437700             RESP  (PV-CICS-RESP)                                 43770099
437800     END-EXEC.                                                    43780099
437900                                                                  43790099
438000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       43800099
438100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     43810099
438200         CONTINUE                                                 43820099
438300     ELSE                                                         43830099
438400         SET DP013-CICS-ABEND     TO TRUE                         43840099
438500         SET DP013-NO-ROLLBACK    TO TRUE                         43850099
438600         MOVE '4410-READ-TEMP-STORAGE'                            43860099
438700                                  TO DP013-PARAGRAPH              43870099
438800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      43880099
438900                                  TO DP013-MESSAGE-TEXT(1)        43890099
439000         PERFORM DP013-0000-PROCESS-ABEND                         43900099
439100     END-IF.                                                      43910099
439200                                                                  43920099
439300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             43930099
439400*                                                                 43940099
439500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         43950099
439600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               43960099
439700     END-IF.                                                      43970099
439800 EJECT                                                            43980099
439900*----------------------------------------------------------------*43990099
440000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *44000099
440100*----------------------------------------------------------------*44010099
440200                                                                  44020099
440300 4420-FORMAT-LIST-LINES.                                          44030099
440400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      44040099
440500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                44050099
440600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           44060099
440700         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           44070099
440800         MOVE SPACE              TO MR-SELECTI (PV-SUB)           44080099
440900                                    MR-MAJ-CLX (PV-SUB)           44090099
441000                                    MR-SUB-CLX (PV-SUB)           44100099
441100                                    MR-SKU-DESC (PV-SUB)          44110099
441200                                    MR-UPC-NBR (PV-SUB)           44120099
441300                                    MR-STAT-CDE (PV-SUB)          44130099
441400                                    MR-CLOR-DESC (PV-SUB)         44140099
441500                                    MR-SIZE-DESC (PV-SUB)         44150099
441600                                    MR-UNT-RTL-AMTX (PV-SUB)      44160099
441700     ELSE                                                         44170099
441800         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      44180099
441900                                                   > SPACE        44190099
442000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 44200099
442100                                 TO MR-SELECTI (PV-SUB)           44210099
442200         ELSE                                                     44220099
442300             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      44230099
442400                                 TO MR-SELECTI (PV-SUB)           44240099
442500         END-IF                                                   44250099
442600*                                                                 44260099
442700         IF  DP030-SET-CURSOR-TRAILER                             44270099
442800             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)44280099
442900                 > SPACE)                                         44290099
443000               OR (PV-SUB = 1))                                   44300099
443100                SET DP030-SET-CURSOR-APPL-1 TO TRUE               44310099
443200                MOVE -1          TO MR-SELECTL (PV-SUB)           44320099
443300             END-IF                                               44330099
443400         END-IF                                                   44340099
443500*                                                                 44350099
443600         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           44360099
443700             MOVE ASC-DET-MAJ-CL      (ASC-BLK-SUB ASC-ITEM-SUB)  44370099
443800                                      TO MR-MAJ-CL (PV-SUB)       44380099
443900             MOVE ASC-DET-SUB-CL      (ASC-BLK-SUB ASC-ITEM-SUB)  44390099
444000                                      TO MR-SUB-CL (PV-SUB)       44400099
444100             MOVE ASC-DET-SKU-DESC    (ASC-BLK-SUB ASC-ITEM-SUB)  44410099
444200                                      TO MR-SKU-DESC (PV-SUB)     44420099
444300             MOVE ASC-DET-UPC-NBR     (ASC-BLK-SUB ASC-ITEM-SUB)  44430099
444400                                      TO MR-UPC-NBR (PV-SUB)      44440099
444500             MOVE ASC-DET-STAT-CDE    (ASC-BLK-SUB ASC-ITEM-SUB)  44450099
444600                                      TO MR-STAT-CDE (PV-SUB)     44460099
444700             MOVE ASC-DET-CLOR-DESC   (ASC-BLK-SUB ASC-ITEM-SUB)  44470099
444800                                      TO MR-CLOR-DESC (PV-SUB)    44480099
444900             MOVE ASC-DET-SIZE-DESC   (ASC-BLK-SUB ASC-ITEM-SUB)  44490099
445000                                      TO MR-SIZE-DESC (PV-SUB)    44500099
445100***********  MOVE ASC-DET-UNT-RTL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)  44510099
445200***********                           TO MR-UNT-RTL-AMT (PV-SUB)  44520099
445300             MOVE ASC-CUR-UNT-RTL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)  44530099
445400                                      TO MR-UNT-RTL-AMT (PV-SUB)  44540099
445500         END-IF                                                   44550099
445600     END-IF.                                                      44560099
445700     SUBTRACT +1 FROM ASC-ITEM-SUB                                44570099
445800     IF  ASC-ITEM-SUB < + 1                                       44580099
445900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  44590099
446000         MOVE +1                 TO ASC-BLK-SUB                   44600099
446100     END-IF.                                                      44610099
446200******************************************************************44620099
446300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **44630099
446400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **44640099
446500** ISSUE A WARNING.                                             **44650099
446600******************************************************************44660099
446700 4430-CHECK-FOR-BEGIN-AND-END.                                    44670099
446800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       44680099
446900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     44690099
447000*            -- NO END-OF-RANGE SPECFIED ---                      44700099
447100             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            44710099
447200             SET DP020-MSG-WARNING TO TRUE                        44720099
447300             PERFORM 4431-POSITION-AT-WARNING                     44730099
447400         END-IF                                                   44740099
447500     ELSE                                                         44750099
447600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     44760099
447700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                44770099
447800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            44780099
447900             SET DP020-MSG-WARNING TO TRUE                        44790099
448000             PERFORM 4431-POSITION-AT-WARNING                     44800099
448100         END-IF                                                   44810099
448200     END-IF.                                                      44820099
448300******************************************************************44830099
448400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **44840099
448500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **44850099
448600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **44860099
448700** POSITION THE CURSOR THERE.                                   **44870099
448800******************************************************************44880099
448900 4431-POSITION-AT-WARNING.                                        44890099
449000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 44900099
449100                    - PV-TOP-ITEM + 1.                            44910099
449200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      44920099
449300         CONTINUE                                                 44930099
449400     ELSE                                                         44940099
449500         SET DP030-SET-CURSOR-APPL-1                              44950099
449600                                   TO TRUE                        44960099
449700         MOVE -1                   TO MR-SELECTL (PV-SUB)         44970099
449800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         44980099
449900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         44990099
450000     END-IF.                                                      45000099
450100*                                                                 45010099
450200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   45020099
450300                    - PV-TOP-ITEM + 1.                            45030099
450400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45040099
450500         CONTINUE                                                 45050099
450600     ELSE                                                         45060099
450700         SET DP030-SET-CURSOR-APPL-1                              45070099
450800                                   TO TRUE                        45080099
450900         MOVE -1                   TO MR-SELECTL (PV-SUB)         45090099
451000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         45100099
451100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         45110099
451200     END-IF.                                                      45120099
451300 EJECT                                                            45130099
451400*----------------------------------------------------------------*45140099
451500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *45150099
451600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *45160099
451700* FOR THE SELECTED ITEMS QUEUE.                                  *45170099
451800*                                                                *45180099
451900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *45190099
452000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *45200099
452100* THE ARRAY IS FULL.                                             *45210099
452200*----------------------------------------------------------------*45220099
452300                                                                  45230099
452400 5000-PREPARE-SEL-QUEUE.                                          45240099
452500                                                                  45250099
452600     MOVE +1                   TO  ASC-BLK-SUB.                   45260099
452700     PERFORM 5100-WRITE-TEMP-STORAGE.                             45270099
452800     ADD +1                    TO  ASC-BLK-SUB.                   45280099
452900     PERFORM 5100-WRITE-TEMP-STORAGE.                             45290099
453000                                                                  45300099
453100     MOVE ASC-SEL-QUEUE-NAME   TO  IQ016-SEL-QUEUE-NAME.          45310099
453200     PERFORM 6010-DELETE-SEL-QUEUE.                               45320099
453300                                                                  45330099
453400     SET ASC-UPDATE-TSQ        TO  TRUE.                          45340099
453500                                                                  45350099
453600     SET IQ014-IDX             TO  1.                             45360099
453700     MOVE ZERO                 TO IQ016-NUMBER-OF-TS-ITEMS.       45370099
453800     INITIALIZE IQ014-SELECTED-ITEM-ARRAY.                        45380099
453900                                                                  45390099
454000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           45400099
454100             VARYING PV-ITEM                                      45410099
454200             FROM 1 BY 1                                          45420099
454300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     45430099
454400                                                                  45440099
454500     IF  IQ014-IDX > 1                                            45450099
454600         PERFORM 5205-WRITE-SEL-QUEUE                             45460099
454700         ADD +1                TO IQ016-NUMBER-OF-TS-ITEMS        45470099
454800     END-IF.                                                      45480099
454900 EJECT                                                            45490099
455000*----------------------------------------------------------------*45500099
455100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *45510099
455200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *45520099
455300*----------------------------------------------------------------*45530099
455400                                                                  45540099
455500 5100-WRITE-TEMP-STORAGE.                                         45550099
455600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     45560099
455700                                   TO PV-LIST-ITEM-NUMBER.        45570099
455800     COMPUTE PV-BLOCK-NUMBER =                                    45580099
455900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    45590099
456000                                                                  45600099
456100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             45610099
456200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             45620099
456300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      45630099
456400             PERFORM 5105-REWRITE-ASC-LISTQ                       45640099
456500         END-IF                                                   45650099
456600     ELSE                                                         45660099
456700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       45670099
456800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            45680099
456900         PERFORM 5110-WRITE-ASC-LISTQ                             45690099
457000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   45700099
457100     END-IF.                                                      45710099
457200                                                                  45720099
457300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             45730099
457400******************************************************************45740099
457500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **45750099
457600** SPECIFIC COMMAREA.                                           **45760099
457700******************************************************************45770099
457800 5105-REWRITE-ASC-LISTQ.                                          45780099
457900     EXEC CICS                                                    45790099
458000         WRITEQ TS                                                45800099
458100             QUEUE (ASC-LIST-QUEUE-NAME)                          45810099
458200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               45820099
458300             ITEM  (PV-BLOCK-NUMBER)                              45830099
458400             REWRITE                                              45840099
458500             RESP  (PV-CICS-RESP)                                 45850099
458600     END-EXEC.                                                    45860099
458700                                                                  45870099
458800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           45880099
458900         CONTINUE                                                 45890099
459000     ELSE                                                         45900099
459100         SET DP013-CICS-ABEND            TO TRUE                  45910099
459200         SET DP013-NO-ROLLBACK           TO TRUE                  45920099
459300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       45930099
459400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     45940099
459500                                         TO DP013-MESSAGE-TEXT(1) 45950099
459600         PERFORM DP013-0000-PROCESS-ABEND                         45960099
459700     END-IF.                                                      45970099
459800                                                                  45980099
459900******************************************************************45990099
460000** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **46000099
460100** SPECIFIC COMMAREA.                                           **46010099
460200******************************************************************46020099
460300 5110-WRITE-ASC-LISTQ.                                            46030099
460400     EXEC CICS                                                    46040099
460500         WRITEQ TS                                                46050099
460600             QUEUE (ASC-LIST-QUEUE-NAME)                          46060099
460700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               46070099
460800             ITEM  (PV-BLOCK-NUMBER)                              46080099
460900             RESP  (PV-CICS-RESP)                                 46090099
461000     END-EXEC.                                                    46100099
461100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      46110099
461200         SET DP013-CICS-ABEND      TO TRUE                        46120099
461300         SET DP013-NO-ROLLBACK     TO TRUE                        46130099
461400         MOVE '5110-WRITE-ASC-LISTQ'                              46140099
461500                                   TO DP013-PARAGRAPH             46150099
461600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           46160099
461700                                   TO DP013-MESSAGE-TEXT(1)       46170099
461800         PERFORM DP013-0000-PROCESS-ABEND                         46180099
461900     END-IF.                                                      46190099
462000 EJECT                                                            46200099
462100*----------------------------------------------------------------*46210099
462200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *46220099
462300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *46230099
462400*----------------------------------------------------------------*46240099
462500                                                                  46250099
462600 5200-FILL-SEL-QUEUE-RECORD.                                      46260099
462700                                                                  46270099
462800     PERFORM 6112-READ-LIST-QUEUE.                                46280099
462900                                                                  46290099
463000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       46300099
463100         PERFORM                                                  46310099
463200         VARYING LQW-IDX                                          46320099
463300         FROM 1 BY 1                                              46330099
463400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            46340099
463500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          46350099
463600                                                                  46360099
463700             IF  LQW-SELECT (LQW-IDX)                             46370099
463800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              46380099
463900                                   TO IQ014-ITEM (IQ014-IDX)      46390099
464000                 MOVE LQW-MAJ-CL      (LQW-IDX)                   46400099
464100                             TO IQ014-MAJ-CL    (IQ014-IDX)       46410099
464200                 MOVE LQW-SUB-CL      (LQW-IDX)                   46420099
464300                             TO IQ014-SUB-CL    (IQ014-IDX)       46430099
464400                 MOVE LQW-SKU-NBR     (LQW-IDX)                   46440099
464500                             TO IQ016-SKU-NBR                     46450099
464600                                IQ014-SKU-CNT (IQ014-IDX)         46460099
464700                 MOVE LQW-UPC-NBR     (LQW-IDX)                   46470099
464800                             TO IQ014-UPC-NBR   (IQ014-IDX)       46480099
464900                 MOVE LQW-STAT-CDE    (LQW-IDX)                   46490099
465000                             TO IQ014-STAT-CDE  (IQ014-IDX)       46500099
465100                 MOVE LQW-CLOR-DESC   (LQW-IDX)                   46510099
465200                             TO IQ014-CLOR-DESC (IQ014-IDX)       46520099
465300                 MOVE LQW-SIZE-DESC   (LQW-IDX)                   46530099
465400                             TO IQ014-SIZE-DESC (IQ014-IDX)       46540099
465500                                IQ016-SIZE-DESC                   46550099
465600                 MOVE LQW-UNT-RTL-AMT (LQW-IDX)                   46560099
465700                             TO IQ014-RTL-AMT   (IQ014-IDX)       46570099
465800                 MOVE LQW-STYL-ID     (LQW-IDX)                   46580099
465900                             TO IQ016-STYLE-ID                    46590099
466000*                                                                 46600099
466100                 SET IQ014-IDX UP BY 1                            46610099
466200                 IF  IQ014-IDX > IQ014-MAX-ITEMS                  46620099
466300                     PERFORM 5205-WRITE-SEL-QUEUE                 46630099
466400                     ADD +1        TO IQ016-NUMBER-OF-TS-ITEMS    46640099
466500                     INITIALIZE IQ014-SELECTED-ITEM-ARRAY         46650099
466600                     SET IQ014-IDX TO  1                          46660099
466700                 END-IF                                           46670099
466800             END-IF                                               46680099
466900         END-PERFORM                                              46690099
467000     END-IF.                                                      46700099
467100                                                                  46710099
467200*----------------------------------------------------------------*46720099
467300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *46730099
467400*----------------------------------------------------------------*46740099
467500                                                                  46750099
467600 5205-WRITE-SEL-QUEUE.                                            46760099
467700                                                                  46770099
467800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            46780099
467900                                   TO IQ014-SELECTED-ITEMS.       46790099
468000                                                                  46800099
468100     EXEC CICS                                                    46810099
468200          WRITEQ TS                                               46820099
468300              QUEUE (ASC-SEL-QUEUE-NAME)                          46830099
468400              FROM  (IQ014-MESSAGE-SEL-REC)                       46840099
468500              ITEM  (PV-SEL-QUEUE-ITEM)                           46850099
468600              RESP  (PV-CICS-RESP)                                46860099
468700     END-EXEC.                                                    46870099
468800                                                                  46880099
468900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          46890099
469000         CONTINUE                                                 46900099
469100     ELSE                                                         46910099
469200         SET DP013-CICS-ABEND      TO TRUE                        46920099
469300         SET DP013-NO-ROLLBACK     TO TRUE                        46930099
469400         MOVE '5205-WRITE-SEL-QUEUE'                              46940099
469500                                   TO DP013-PARAGRAPH             46950099
469600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          46960099
469700                                   TO DP013-MESSAGE-TEXT(1)       46970099
469800         PERFORM DP013-0000-PROCESS-ABEND                         46980099
469900     END-IF.                                                      46990099
470000                                                                  47000099
470100******************************************************************47010099
470200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **47020099
470300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **47030099
470400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **47040099
470500** THE USER.                                                    **47050099
470600******************************************************************47060099
470700 6000-REFRESH-PANEL-FROM-TEMP.                                    47070099
470800     IF  ASC-UPDATE-TSQ                                           47080099
470900         SET ASC-NO-TSQ-UPDATE TO TRUE                            47090099
471000         MOVE ZERO                 TO PV-SAVE-ITEM                47100099
471100                                      PV-SEL-QUEUE-ITEM           47110099
471200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        47120099
471300                                   TO PV-HOLD-SELECTED-ITEMS      47130099
471400         MOVE +1                   TO PV-ITEMS-PROCESSED          47140099
471500         PERFORM 6100-UPDATE-TSQ                                  47150099
471600             UNTIL PV-ITEMS-PROCESSED >                           47160099
471700                                     PV-HOLD-SELECTED-ITEMS       47170099
471800         PERFORM 6010-DELETE-SEL-QUEUE                            47180099
471900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         47190099
472000                    ASC-BLOCK-ENTRIES (2)                         47200099
472100     END-IF.                                                      47210099
472200                                                                  47220099
472300*----------------------------------------------------------------*47230099
472400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *47240099
472500*----------------------------------------------------------------*47250099
472600 6010-DELETE-SEL-QUEUE.                                           47260099
472700                                                                  47270099
472800     EXEC CICS                                                    47280099
472900         DELETEQ TS                                               47290099
473000             QUEUE (ASC-SEL-QUEUE-NAME)                           47300099
473100             RESP  (PV-CICS-RESP)                                 47310099
473200     END-EXEC.                                                    47320099
473300*                                                                 47330099
473400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      47340099
473500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         47350099
473600         CONTINUE                                                 47360099
473700     ELSE                                                         47370099
473800         SET DP013-CICS-ABEND TO TRUE                             47380099
473900         SET DP013-NO-ROLLBACK TO TRUE                            47390099
474000         MOVE '6010-DELETE-SEL-QUEUE'                             47400099
474100                        TO DP013-PARAGRAPH                        47410099
474200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         47420099
474300                        TO DP013-MESSAGE-TEXT (1)                 47430099
474400         PERFORM DP013-0000-PROCESS-ABEND                         47440099
474500     END-IF.                                                      47450099
474600                                                                  47460099
474700*----------------------------------------------------------------*47470099
474800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *47480099
474900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *47490099
475000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *47500099
475100*    THE TEMP QUEUE.                                             *47510099
475200*----------------------------------------------------------------*47520099
475300                                                                  47530099
475400 6100-UPDATE-TSQ.                                                 47540099
475500                                                                  47550099
475600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             47560099
475700     PERFORM 6105-READ-SEL-QUEUE.                                 47570099
475800                                                                  47580099
475900     PERFORM                                                      47590099
476000         VARYING IQ014-IDX                                        47600099
476100         FROM 1 BY 1                                              47610099
476200         UNTIL ((PV-ITEMS-PROCESSED >                             47620099
476300                              PV-HOLD-SELECTED-ITEMS)             47630099
476400         OR (IQ014-IDX GREATER THAN IQ014-MAX-ITEMS))             47640099
476500         PERFORM 6110-PROCESS-ITEMS                               47650099
476600         ADD +1                     TO PV-ITEMS-PROCESSED         47660099
476700     END-PERFORM.                                                 47670099
476800     PERFORM 6111-WRITE-LIST-QUEUE.                               47680099
476900*----------------------------------------------------------------*47690099
477000*    READ THE LIST QUEUE RECORD.                                 *47700099
477100*----------------------------------------------------------------*47710099
477200                                                                  47720099
477300 6105-READ-SEL-QUEUE.                                             47730099
477400                                                                  47740099
477500     EXEC CICS                                                    47750099
477600          READQ TS                                                47760099
477700              QUEUE (ASC-SEL-QUEUE-NAME)                          47770099
477800              INTO  (IQ014-MESSAGE-SEL-REC)                       47780099
477900              ITEM  (PV-SEL-QUEUE-ITEM)                           47790099
478000              RESP  (PV-CICS-RESP)                                47800099
478100     END-EXEC.                                                    47810099
478200*                                                                 47820099
478300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47830099
478400         CONTINUE                                                 47840099
478500     ELSE                                                         47850099
478600         SET DP013-CICS-ABEND      TO  TRUE                       47860099
478700         SET DP013-NO-ROLLBACK     TO  TRUE                       47870099
478800         MOVE '6105-READ-SEL-QUEUE'                               47880099
478900                                   TO  DP013-PARAGRAPH            47890099
479000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           47900099
479100                                   TO  DP013-MESSAGE-TEXT(1)      47910099
479200         PERFORM DP013-0000-PROCESS-ABEND                         47920099
479300     END-IF.                                                      47930099
479400 EJECT                                                            47940099
479500*----------------------------------------------------------------*47950099
479600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*47960099
479700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*47970099
479800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *47980099
479900*----------------------------------------------------------------*47990099
480000                                                                  48000099
480100 6110-PROCESS-ITEMS.                                              48010099
480200                                                                  48020099
480300     COMPUTE PV-ITEM = 1 + ((IQ014-ITEM (IQ014-IDX) - 1)          48030099
480400                     / PC-ITEMS-PER-PANEL).                       48040099
480500                                                                  48050099
480600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           48060099
480700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          48070099
480800             PERFORM 6111-WRITE-LIST-QUEUE                        48080099
480900         END-IF                                                   48090099
481000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    48100099
481100                                                                  48110099
481200         PERFORM 6112-READ-LIST-QUEUE                             48120099
481300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               48130099
481400             CONTINUE                                             48140099
481500         END-IF                                                   48150099
481600     END-IF.                                                      48160099
481700                                                                  48170099
481800     COMPUTE PV-SUB = (IQ014-ITEM (IQ014-IDX)                     48180099
481900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              48190099
482000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         48200099
482100     MOVE LQW-SELECTED-SW (PV-SUB)                                48210099
482200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  48220099
482300                                                                  48230099
482400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                48240099
482500                                                                  48250099
482600*----------------------------------------------------------------*48260099
482700*    WRITE THE TS QUEUE RECORD JUST UPDATED                      *48270099
482800*----------------------------------------------------------------*48280099
482900                                                                  48290099
483000 6111-WRITE-LIST-QUEUE.                                           48300099
483100                                                                  48310099
483200     EXEC CICS                                                    48320099
483300         WRITEQ TS                                                48330099
483400             QUEUE (ASC-LIST-QUEUE-NAME)                          48340099
483500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     48350099
483600             ITEM  (PV-SAVE-ITEM)                                 48360099
483700             REWRITE                                              48370099
483800             RESP  (PV-CICS-RESP)                                 48380099
483900     END-EXEC.                                                    48390099
484000*                                                                 48400099
484100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48410099
484200         CONTINUE                                                 48420099
484300     ELSE                                                         48430099
484400         SET DP013-CICS-ABEND  TO  TRUE                           48440099
484500         SET DP013-NO-ROLLBACK TO  TRUE                           48450099
484600         MOVE '6111-WRITE-LIST-QUEUE'                             48460099
484700                               TO  DP013-PARAGRAPH                48470099
484800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  48480099
484900                               TO  DP013-MESSAGE-TEXT(1)          48490099
485000         PERFORM DP013-0000-PROCESS-ABEND                         48500099
485100     END-IF.                                                      48510099
485200                                                                  48520099
485300 EJECT                                                            48530099
485400*----------------------------------------------------------------*48540099
485500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*48550099
485600*----------------------------------------------------------------*48560099
485700                                                                  48570099
485800 6112-READ-LIST-QUEUE.                                            48580099
485900                                                                  48590099
486000     EXEC CICS                                                    48600099
486100         READQ TS                                                 48610099
486200             QUEUE (ASC-LIST-QUEUE-NAME)                          48620099
486300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     48630099
486400             ITEM  (PV-ITEM)                                      48640099
486500             RESP  (PV-CICS-RESP)                                 48650099
486600     END-EXEC.                                                    48660099
486700*                                                                 48670099
486800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48680099
486900         CONTINUE                                                 48690099
487000     ELSE                                                         48700099
487100         SET DP013-CICS-ABEND        TO TRUE                      48710099
487200         SET DP013-NO-ROLLBACK       TO TRUE                      48720099
487300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           48730099
487400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    48740099
487500                                     TO DP013-MESSAGE-TEXT(1)     48750099
487600         PERFORM DP013-0000-PROCESS-ABEND                         48760099
487700     END-IF.                                                      48770099
487800                                                                  48780099
487900 EJECT                                                            48790099
488000*----------------------------------------------------------------*48800099
488100*    RE-INITIALIZE ASC- FIELDS AFTER F3 RETURN                   *48810099
488200*----------------------------------------------------------------*48820099
488300 6500-REINIT-IQ016-FLDS.                                          48830099
488400                                                                  48840099
488500     MOVE +1               TO   IQ016-NUMBER-OF-SELECTED-ITEMS.   48850099
488600     MOVE +0               TO   IQ016-NUMBER-OF-TS-ITEMS.         48860099
488700     MOVE ASC-SEL-QUEUE-NAME                                      48870099
488800                           TO   IQ016-SEL-QUEUE-NAME.             48880099
488900     MOVE ASC-LBL-NM       TO   IQ016-LBL-NM.                     48890099
489000     MOVE ASC-GP-NBR       TO   IQ016-GP-NBR.                     48900099
489100     MOVE ASC-DEPT-NBR     TO   IQ016-DEPT-NBR.                   48910099
489200     MOVE ASC-MAJ-CL       TO   IQ016-MAJ-CL.                     48920099
489300     MOVE ASC-SUB-CL       TO   IQ016-SUB-CL.                     48930099
489400     MOVE ASC-SUB-CL-NM    TO   IQ016-SUB-CL-NM.                  48940099
489500     MOVE ASC-CLOR-DESC    TO   IQ016-CLOR-DESC.                  48950099
489600     MOVE ASC-SIZE-DESC    TO   IQ016-SIZE-DESC.                  48960099
489700                                                                  48970099
489800                                                                  48980099
489900*----------------------------------------------------------------*48990099
490000*    ABEND PROCESSOR MODULE                                      *49000099
490100*----------------------------------------------------------------*49010099
490200                                                                  49020099
490300     COPY DPPD013.                                                49030099
