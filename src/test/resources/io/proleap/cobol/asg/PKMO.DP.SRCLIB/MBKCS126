00001 *************************                                         12/19/92
00002  IDENTIFICATION DIVISION.                                         MBKCS126
00003 *************************                                            LV004
00004  PROGRAM-ID.    MBKCS126.                                         MBKCS126
00005  AUTHOR.        MIKE FURLICK.                                     MBKCS126
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          MBKCS126
00007  DATE-WRITTEN.  9-04-91.                                          MBKCS126
00008  DATE-COMPILED.                                                   MBKCS126
00009                                                                   MBKCS126
00010 ***************************************************************** MBKCS126
00011 *    R126 - APPLICATION SYSTEM ADD/DELETE/UPDATE.                 MBKCS126
00012 *                                                                 MBKCS126
00013 *    THIS PROGRAM PERFORMS THE MAINTENANCE TO THE APPLICATION SYS MBKCS126
00014 *    TABLE (TAPLSYS).  TAPLAVL IS ALSO USED AS INPUT.             MBKCS126
00015 *    FOR THE UPDATE AND DELETE FUNCTIONS, SELECTED DATA IS PASSED MBKCS126
00016 *    HERE FROM MBKCS125 (APPL SYSTEM LIST).   FOR THE ADD FUNCTIONMBKCS126
00017 *    NO LIST IS PASSED AND THE APPLICATION SYSTEM CODE ON THE     MBKCS126
00018 *    SCREEN IS UNPROTECTED.                                       MBKCS126
00019 *                                                                 MBKCS126
00020 ***************************************************************** MBKCS126
00018 *    06/18/98   DOUG DOUGLAS   STRATAGEM     WR#: 6041            MBKCS126
00019 *               - UPDATE FOR Y2K                                  MBKCS126
00019 *               - REPLACE ++INCLUDES WITH COPY'S   (STDS)         MBKCS126
00020 ***************************************************************** MBKCS126
00022 *                                                                 MBKCS126
00023 *                                                                 MBKCS126
00024 *                                                                 MBKCS126
00025  ENVIRONMENT DIVISION.                                            MBKCS126
00026 *                                                                 MBKCS126
00027 *                                                                 MBKCS126
00028 *                                                                 MBKCS126
00029  DATA DIVISION.                                                   MBKCS126
00030 *                                                                 MBKCS126
00031 *                                                                 MBKCS126
00032  WORKING-STORAGE SECTION.                                         MBKCS126
00033 *                                                                 MBKCS126
00034  01  PC-PROGRAM-CONSTANTS.                                        MBKCS126
00035      05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.MBKCS126
00036      05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  MBKCS126
00037                                                      COMP SYNC.   MBKCS126
00038      05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        MBKCS126
00039      'MB126A  '.                                                  MBKCS126
00040      05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        MBKCS126
00041      'MBKM126 '.                                                  MBKCS126
00042      05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        MBKCS126
00043      'MBKCS126'.                                                  MBKCS126
00044      05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   MBKCS126
00045                                                      COMP SYNC.   MBKCS126
00046      05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      MBKCS126
00047          10  FILLER                     PIC X(01).                MBKCS126
00048          10  PC-ERASE-EOF               PIC X(01).                MBKCS126
00049      05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      MBKCS126
00050                                                      COMP-3.      MBKCS126
00051      05  PC-N                           PIC X        VALUE 'N'.   MBKCS126
00052      05  PC-Y                           PIC X        VALUE 'Y'.   MBKCS126
00053  01  PC-COMPANY                         PIC XX       VALUE '03'.  MBKCS126
00054  01  PC-SPACE3                          PIC X(3)     VALUE '   '. MBKCS126
00055 *                                                                 MBKCS126
00056  01  PC-TSYMSG-NUMBERS.                                           MBKCS126
00057      05  PC-TSYMSG-00004                PIC 9(5)    VALUE 00004.  MBKCS126
00058      05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.  MBKCS126
00059      05  PC-TSYMSG-00007                PIC 9(5)    VALUE 00007.  MBKCS126
00060      05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  MBKCS126
00061      05  PC-TSYMSG-00009                PIC 9(5)    VALUE 00009.  MBKCS126
00062      05  PC-TSYMSG-00025                PIC 9(5)    VALUE 00025.  MBKCS126
00063      05  PC-TSYMSG-00034                PIC 9(5)    VALUE 00034.  MBKCS126
00064      05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.  MBKCS126
00065      05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  MBKCS126
00066      05  PC-TSYMSG-00051                PIC 9(5)    VALUE 00051.  MBKCS126
00067      05  PC-TSYMSG-00052                PIC 9(5)    VALUE 00052.  MBKCS126
00068      05  PC-TSYMSG-00053                PIC 9(5)    VALUE 00053.  MBKCS126
00069      05  PC-TSYMSG-00054                PIC 9(5)    VALUE 00054.  MBKCS126
00070      05  PC-TSYMSG-00055                PIC 9(5)    VALUE 00055.  MBKCS126
00071      05  PC-TSYMSG-00057                PIC 9(5)    VALUE 00057.  MBKCS126
00072      05  PC-TSYMSG-00059                PIC 9(5)    VALUE 00059.  MBKCS126
00073      05  PC-TSYMSG-00061                PIC 9(5)    VALUE 00061.  MBKCS126
00074      05  PC-TSYMSG-00062                PIC 9(5)    VALUE 00062.  MBKCS126
00075      05  PC-TSYMSG-00067                PIC 9(5)    VALUE 00067.  MBKCS126
00076      05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  MBKCS126
00077      05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  MBKCS126
00078      05  PC-TSYMSG-00115                PIC 9(5)    VALUE 00115.  MBKCS126
00079      05  PC-TSYMSG-00117                PIC 9(5)    VALUE 00117.  MBKCS126
00080      05  PC-TSYMSG-00118                PIC 9(5)    VALUE 00118.  MBKCS126
00081      05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  MBKCS126
00082      05  PC-TSYMSG-00149                PIC 9(5)    VALUE 00149.  MBKCS126
00083      05  PC-TSYMSG-00208                PIC 9(5)    VALUE 00208.  MBKCS126
00084      05  PC-TSYMSG-00209                PIC 9(5)    VALUE 00209.  MBKCS126
00085      05  PC-TSYMSG-99901                PIC 9(5)    VALUE 99901.  MBKCS126
00086 *                                                                 MBKCS126
00087  01  PM-PROGRAM-MESSAGES.                                         MBKCS126
00088      05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE        MBKCS126
00089      'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                MBKCS126
00090      05  PM-PROGRAM-MESSAGE-22          PIC X(78)    VALUE        MBKCS126
00091      'LOGIC ERROR IN TRYING TO READ APLSYS QUEUE - RESP = '.      MBKCS126
00092      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-22.                  MBKCS126
00093          10  FILLER                     PIC X(61).                MBKCS126
00094          10  PM-RESP-22                 PIC 9999.                 MBKCS126
00095          10  FILLER                     PIC X(12).                MBKCS126
00096      05  PM-PROGRAM-MESSAGE-23          PIC X(78)    VALUE        MBKCS126
00097      'CICS VSAM ERROR OCCURED TRYING TO ACCESS MBBCHCTL. RESP ='. MBKCS126
00098      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-23.                  MBKCS126
00099          10  FILLER                     PIC X(59).                MBKCS126
00100          10  PM-RESP-23                 PIC 9999.                 MBKCS126
00101          10  FILLER                     PIC X(15).                MBKCS126
00102 *                                                                 MBKCS126
00103  01  PS-PROGRAM-SUBSCRIPTS.                                       MBKCS126
00104      05  PS-SUB                         PIC S9(04)   VALUE +0     MBKCS126
00105                                                      COMP SYNC.   MBKCS126
00106      05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0     MBKCS126
00107                                                      COMP-3.      MBKCS126
00108                                                                   MBKCS126
00109  01  PS-PROGRAM-SWITCHES.                                         MBKCS126
00110      05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   MBKCS126
00111          88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   MBKCS126
00112          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   MBKCS126
00113          88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   MBKCS126
00114          88  PS-SEND-DATA-ONLY                       VALUE '4'.   MBKCS126
00115          88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   MBKCS126
00116          88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   MBKCS126
00117      05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   MBKCS126
00118          88  PS-ERROR                                VALUE 'Y'.   MBKCS126
00119          88  PS-NO-ERROR                             VALUE 'N'.   MBKCS126
00120      05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.   MBKCS126
00121          88  PS-INTER-APPL-VALID                     VALUE 'Y'.   MBKCS126
00122          88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.   MBKCS126
00123      05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.   MBKCS126
00124          88  PS-WARNING                              VALUE 'Y'.   MBKCS126
00125          88  PS-NO-WARNING                           VALUE 'N'.   MBKCS126
00126      05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.   MBKCS126
00127          88  PS-INFORMATIONAL                        VALUE 'Y'.   MBKCS126
00128          88  PS-NOT-INFORMATIONAL                    VALUE 'N'.   MBKCS126
00129      05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.   MBKCS126
00130          88  PS-CONTINUE                             VALUE 'Y'.   MBKCS126
00131          88  PS-DONT-PROCESS                         VALUE 'N'.   MBKCS126
00132      05  PS-SAVE-SW                     PIC X(01)    VALUE 'N'.   MBKCS126
00133          88  PS-SAVE-DATA                            VALUE 'Y'.   MBKCS126
00134          88  PS-DONT-SAVE-DATA                       VALUE 'N'.   MBKCS126
00135      EJECT                                                        MBKCS126
00136  01  PV-PROGRAM-VARIABLES.                                        MBKCS126
00137      05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     MBKCS126
00138                                                      COMP SYNC.   MBKCS126
00139      05  PV-RESP                        PIC S9(04)   VALUE +0     MBKCS126
00140                                                      COMP SYNC.   MBKCS126
00141      05  PV-ITEM                        PIC S9(04)   VALUE +0     MBKCS126
00142                                                      COMP SYNC.   MBKCS126
00143      05  PV-AS-ITEM                     PIC S9(04)   VALUE +0     MBKCS126
00144                                                      COMP SYNC.   MBKCS126
00145      05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.MBKCS126
00146      05  PV-SQL-SUB                     PIC S9(4)    COMP.        MBKCS126
00147      05  PV-RETRY-COUNTER               PIC S9(3)    COMP-3.      MBKCS126
00148      05  PV-WORK-DATE.                                            MBKCS126
00149          10  PV-WD-CC                   PIC XX.                   MBKCS126
00149          10  PV-WD-YY                   PIC XX.                   MBKCS126
00150          10  PV-WD-MM                   PIC XX.                   MBKCS126
00151          10  PV-WD-DD                   PIC XX.                   MBKCS126
00152 *                                                                 MBKCS126
00153  01  PV-DB2-COUNT                       PIC S9(9)    VALUE +0     MBKCS126
00154                                                      COMP-3.      MBKCS126
00155  01  PV-DB2-DATE                        PIC X(10).                MBKCS126
00156  01  FILLER  REDEFINES PV-DB2-DATE.                               MBKCS126
00157      05  PV-DD-CCYY.                                              MBKCS126
00158          10  PV-DD-CC                   PIC XX.                   MBKCS126
00159          10  PV-DD-YY                   PIC XX.                   MBKCS126
00160      05  FILLER                         PIC X.                    MBKCS126
00161          88  PV-DD-DASH1                             VALUE '-'.   MBKCS126
00162      05  PV-DD-MM                       PIC XX.                   MBKCS126
00163      05  FILLER                         PIC X.                    MBKCS126
00164          88  PV-DD-DASH2                             VALUE '-'.   MBKCS126
00165      05  PV-DD-DD                       PIC XX.                   MBKCS126
00166 *                                                                 MBKCS126
00167  EJECT                                                            MBKCS126
00168 ***************************************************************** MBKCS126
00169 *    STANDARD COMMAREA.                                           MBKCS126
00170 ***************************************************************** MBKCS126
00171                                                                   MBKCS126
00172      COPY DPWS020.                                                MBKCS126
00173      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                MBKCS126
00174                                                                   MBKCS126
00175 ***************************************************************** MBKCS126
00176 *    INTER-APPLICATION COMMAREA.                                  MBKCS126
00177 ***************************************************************** MBKCS126
00178                                                                   MBKCS126
00179          10  INTER-APPL-COMM-AREA       PIC X(200).               MBKCS126
00180      COPY MBWS005.                                                   CL**3
00181 ***************************************************************** MBKCS126
00182 *    SPECIFIC COMMMAREA FOR MBKCS126.                             MBKCS126
00183 ***************************************************************** MBKCS126
00184          10  MB126-SPECIFIC-COMMAREA.                             MBKCS126
00185              15  MB126-APPL-CURSOR-POSITION          PIC S9(04)   MBKCS126
00186                                                      COMP.        MBKCS126
00187              15  MB126-AS-SUB                        PIC S9(4)    MBKCS126
00188                                                          COMP.    MBKCS126
00189              15  MB126-AS-ITEM                       PIC S9(4)    MBKCS126
00190                                                          COMP.    MBKCS126
00191            12    MB126-LAST-AREA.                                 MBKCS126
00192              15  MB126-LAST-APLSYS-CODE              PIC XX.      MBKCS126
00193              15  MB126-LAST-APLSYS-DESC              PIC X(25).   MBKCS126
00194              15  MB126-LAST-PRNT-APLSYS-CODE         PIC XX.      MBKCS126
00195              15  MB126-LAST-PRNT-APLSYS-DESC         PIC X(25).   MBKCS126
00196              15  MB126-LAST-MDSE-IND                 PIC X.       MBKCS126
00197                  88  MB126-ADD-VSAM-RECORD           VALUE 'Y'.   MBKCS126
00198              15  MB126-LAST-LIKE-SYSTEM              PIC XX.      MBKCS126
00199              15  MB126-LAST-LIKE-DESC                PIC X(25).   MBKCS126
00201              15  MB126-LAST-EFF-START-DATE.                       MBKCS126
00202                  20  MB126-LAST-START-CC             PIC XX.      MBKCS126
00204                  20  MB126-LAST-START-YY             PIC XX.      MBKCS126
00202                  20  MB126-LAST-START-MM             PIC XX.      MBKCS126
00203                  20  MB126-LAST-START-DD             PIC XX.      MBKCS126
00205            12    MB126-LAST-AREA-END.                             MBKCS126
00206              15  MB126-CONFIRM-SWITCH                PIC X.       MBKCS126
00207                  88  MB126-CANT-CONFIRM              VALUE 'N'.   MBKCS126
00208                  88  MB126-CAN-CONFIRM               VALUE 'Y'.   MBKCS126
00209              15  MB126-ACTION                        PIC X.       MBKCS126
00210                  88  MB126-ADD-FUNCTION              VALUE 'A'.   MBKCS126
00211                  88  MB126-UPDATE-FUNCTION           VALUE 'U'.   MBKCS126
00212                  88  MB126-DELETE-FUNCTION           VALUE 'D'.   MBKCS126
00213              15  MB126-TEMP-QUEUE-NAME.                           MBKCS126
00214                  20  MB126-TERM-ID                   PIC X(4).    MBKCS126
00215                  20  MB126-TASK-NUMBER               PIC S9(7)    MBKCS126
00216                                                          COMP-3.  MBKCS126
00217              15  MB126-SAVE-INTER-APPL-COMMAREA      PIC X(200).  MBKCS126
00218              15  MB126-SAVE-TS-QUEUE                 PIC X(1500). MBKCS126
00219 *                                                                 MBKCS126
00220      EJECT                                                        MBKCS126
00221 ***************************************************************** MBKCS126
00222 *    APPL SYS LIST QUEUE RECORD LAYOUT.                           MBKCS126
00223 ***************************************************************** MBKCS126
00224  01 APLSYS-LIST-RECORD.                                           MBKCS126
00225      COPY MBWS125.                                                MBKCS126
00226                                                                   MBKCS126
00227 *                                                                 MBKCS126
00228      EJECT                                                        MBKCS126
00229 ***************************************************************** MBKCS126
00230 *    MERCHANDISE AREA REALIGNMENT RECORD LAYOUT.                  MBKCS126
00231 ***************************************************************** MBKCS126
00232      COPY MBWS018.                                                MBKCS126
00233                                                                   MBKCS126
00234 *                                                                 MBKCS126
00235      EJECT                                                        MBKCS126
00236 ***************************************************************** MBKCS126
00237 *    ABEND PROCESSING COPYBOOK.                                   MBKCS126
00238 ***************************************************************** MBKCS126
00239                                                                   MBKCS126
00240      COPY DPWS013.                                                MBKCS126
00241                                                                   MBKCS126
00242      EJECT                                                        MBKCS126
00243 ***************************************************************** MBKCS126
00244 *    ATTRIBUTE SETTINGS COPYBOOK.                                 MBKCS126
00245 ***************************************************************** MBKCS126
00246                                                                   MBKCS126
00247      COPY DPWS015.                                                MBKCS126
00248                                                                   MBKCS126
00249 ***************************************************************** MBKCS126
00250 *    CURRENT DATE AND TIME COPYBOOK.                              MBKCS126
00251 ***************************************************************** MBKCS126
00252                                                                   MBKCS126
00253      COPY DPWS017.                                                MBKCS126
00254                                                                   MBKCS126
00255 ***************************************************************** MBKCS126
00256 *    TOGGLE FUNCTION KEY LINES COPYBOOK.                          MBKCS126
00257 ***************************************************************** MBKCS126
00258                                                                   MBKCS126
00259      COPY DPWS009.                                                MBKCS126
00260                                                                   MBKCS126
00261 ***************************************************************** MBKCS126
00262 *    FUNCTION KEYS COPYBOOK.                                      MBKCS126
00263 ***************************************************************** MBKCS126
00264                                                                   MBKCS126
00265      COPY DPWS016.                                                MBKCS126
00266                                                                   MBKCS126
00267 ***************************************************************** MBKCS126
00268 *    DPKUT045 COPYBOOK.                                           MBKCS126
00269 ***************************************************************** MBKCS126
00270                                                                   MBKCS126
00271      COPY DPWS045.                                                MBKCS126
00272                                                                   MBKCS126
00273 ***************************************************************** MBKCS126
00274 *                                                                 MBKCS126
00275 ***************************************************************** MBKCS126
00276                                                                   MBKCS126
00277      COPY DPWS006.                                                MBKCS126
00278                                                                   MBKCS126
00273 ***************************************************************** MBKCS126
00274 *    DATE VALIDATION COPYBOOK                                     MBKCS126
00275 ***************************************************************** MBKCS126
00276                                                                   MBKCS126
00277      COPY DPWS500.                                                MBKCS126
00278                                                                   MBKCS126
00279 ***************************************************************** MBKCS126
00280 *    NUMERIC EDIT LAYOUT.                                         MBKCS126
00281 ***************************************************************** MBKCS126
00282                                                                   MBKCS126
00283      COPY DPWS010I.                                               MBKCS126
00284                                                                   MBKCS126
00285 ***************************************************************** MBKCS126
00286 *    MESSAGE RECORD LAYOUT                                        MBKCS126
00287 ***************************************************************** MBKCS126
00288                                                                   MBKCS126
00289      COPY DPRD507I.                                               MBKCS126
00290                                                                   MBKCS126
00291 ***************************************************************** MBKCS126
00292 *    STANDARD ATTENTION IDENTIFIER LIST                           MBKCS126
00293 ***************************************************************** MBKCS126
00294                                                                   MBKCS126
00295      COPY DFHAID.                                                 MBKCS126
00296                                                                   MBKCS126
00297 ***************************************************************** MBKCS126
00298 *    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        MBKCS126
00299 ***************************************************************** MBKCS126
00300                                                                   MBKCS126
00301      COPY DFHBMSCA.                                               MBKCS126
00302                                                                   MBKCS126
00303 ***************************************************************** MBKCS126
00304 *    MAP LAYOUT                                                   MBKCS126
00305 ***************************************************************** MBKCS126
00306                                                                   MBKCS126
00307      COPY MBKM126.                                                MBKCS126
00308  01  MD-MAP-DATA-AREA  REDEFINES MB126AO PIC X(1200).             MBKCS126
00309 *                                                                 MBKCS126
00310  EJECT                                                            MBKCS126
00311 *                                                                 MBKCS126
00312 *    DB2 AREA FOR TAPLSYS                                         MBKCS126
00313 *                                                                 MBKCS126
00314      EXEC SQL                                                     MBKCS126
00315           INCLUDE TAPLSYS                                         MBKCS126
00316      END-EXEC.                                                    MBKCS126
00317 *                                                                 MBKCS126
00318 *    DB2 AREA FOR TAPLAVL                                         MBKCS126
00319 *                                                                 MBKCS126
00320      EXEC SQL                                                     MBKCS126
00321           INCLUDE TAPLAVL                                         MBKCS126
00322      END-EXEC.                                                    MBKCS126
00323 *                                                                 MBKCS126
00324 *    DB2 AREA FOR COMMUNICATIONS                                  MBKCS126
00325 *                                                                 MBKCS126
00326      EXEC SQL                                                     MBKCS126
00327           INCLUDE SQLCA                                           MBKCS126
00328      END-EXEC.                                                    MBKCS126
00329 *                                                                 MBKCS126
00330  EJECT                                                            MBKCS126
00331  LINKAGE SECTION.                                                 MBKCS126
00332                                                                   MBKCS126
00333  01  DFHCOMMAREA.                                                 MBKCS126
00334      05  FILLER                         OCCURS  1 TO 4072 TIMES   MBKCS126
00335                                         DEPENDING ON EIBCALEN.    MBKCS126
00336          10  FILLER                     PIC X.                    MBKCS126
00337                                                                   MBKCS126
00338 *                                                                 MBKCS126
00339 *                                                                 MBKCS126
00340 *                                                                 MBKCS126
00341  PROCEDURE DIVISION.                                              MBKCS126
00342                                                                   MBKCS126
00343                                                                   MBKCS126
00344  0000-MAIN-MODULE.                                                MBKCS126
00345                                                                   MBKCS126
00346 ******************************************************************MBKCS126
00347 *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           MBKCS126
00348 ******************************************************************MBKCS126
00349                                                                   MBKCS126
00350      PERFORM DP015-0000-CHECK-COMMAREA.                           MBKCS126
00351                                                                   MBKCS126
00352      IF DP020-SRC-RETURN-W-TRAN-ID                                MBKCS126
00353          PERFORM 1000-CONTROL-PROCESSING                          MBKCS126
00354      END-IF.                                                      MBKCS126
00355                                                                   MBKCS126
00356      PERFORM DP003-0000-RETURN-TO-CICS.                           MBKCS126
00357  EJECT                                                            MBKCS126
00358 ******************************************************************MBKCS126
00359 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    MBKCS126
00360 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                    MBKCS126
00361 *                                                                 MBKCS126
00362 *    PERFORMED BY 0000-MAIN-MODULE.                               MBKCS126
00363 ******************************************************************MBKCS126
00364 *                                                                 MBKCS126
00365  1000-CONTROL-PROCESSING.                                         MBKCS126
00366 *                                                                 MBKCS126
00367      SET PS-CONTINUE           TO  TRUE.                          MBKCS126
00368 *                                                                 MBKCS126
00369      EVALUATE TRUE                                                MBKCS126
00370          WHEN DP020-NEXT-ACT-INITIAL                              MBKCS126
00371              PERFORM 4100-VALIDATE-COMMAREA                       MBKCS126
00372              IF  PS-INTER-APPL-NOT-VALID                          MBKCS126
00373                  MOVE DP016-PF3                                   MBKCS126
00374                                TO  DP020-SRC-AID                  MBKCS126
00375                  SET DP020-MSG-FATAL                              MBKCS126
00376                                TO  TRUE                           MBKCS126
00377                  MOVE PC-TSYMSG-99901                             MBKCS126
00378                                TO  DP020-MSG-NUMBER               MBKCS126
00379                  PERFORM DP015-1000-START-NAVIGATOR               MBKCS126
00380              ELSE                                                 MBKCS126
00381                  INITIALIZE MB126-SPECIFIC-COMMAREA               MBKCS126
00382                  SET PS-SEND-MAP-N-DATA-FRSET                     MBKCS126
00383                                TO  TRUE                           MBKCS126
00384                  SET DP020-NEXT-ACT-READ-MAP                      MBKCS126
00385                                TO  TRUE                           MBKCS126
00386                  PERFORM 2000-BUILD-INITIAL-PANEL                 MBKCS126
00387              END-IF                                               MBKCS126
00388 *                                                                 MBKCS126
00389          WHEN DP020-NEXT-ACT-READ-MAP                             MBKCS126
00390              PERFORM 3000-PROCESS-PANEL                           MBKCS126
00391 *                                                                 MBKCS126
00392          WHEN DP020-NEXT-ACT-RETURN                               MBKCS126
00393              SET PS-SEND-MAP-N-DATA-FRSET                         MBKCS126
00394                                TO  TRUE                           MBKCS126
00395              MOVE MB126-SAVE-INTER-APPL-COMMAREA                  MBKCS126
00396                                TO  MB005-INTER-APPL-COMMAREA      MBKCS126
00397              PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                 MBKCS126
00398              IF  MB126-DELETE-FUNCTION                            MBKCS126
00399                  CONTINUE                                         MBKCS126
00400              ELSE                                                 MBKCS126
00401                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
00402              END-IF                                               MBKCS126
00403              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
00404 *                                                                 MBKCS126
00405          WHEN DP020-NEXT-ACT-ERROR                                MBKCS126
00406              MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                 MBKCS126
00407              IF DP020-NAV-MNEMONIC = SPACES                       MBKCS126
00408                  MOVE SPACES   TO  ANAVCMDO                       MBKCS126
00409                  MOVE DP015-UNDERLINE                             MBKCS126
00410                                TO  ANAVCMDH                       MBKCS126
00411                  MOVE DP015-GREEN                                 MBKCS126
00412                                TO  ANAVCMDC                       MBKCS126
00413              ELSE                                                 MBKCS126
00414                  MOVE DP015-REVERSE                               MBKCS126
00415                                TO  ANAVCMDH                       MBKCS126
00416                  MOVE DP015-RED                                   MBKCS126
00417                                TO  ANAVCMDC                       MBKCS126
00418              END-IF                                               MBKCS126
00419 *                                                                 MBKCS126
00420              MOVE PV-MESSAGE   TO  DP020-MSG-MESSAGE              MBKCS126
00421                                                                   MBKCS126
00422              SET DP020-MSG-FATAL                                  MBKCS126
00423                                TO  TRUE                           MBKCS126
00424              SET PS-SEND-DATA-ONLY-FRSET                          MBKCS126
00425                                TO  TRUE                           MBKCS126
00426              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
00427 *                                                                 MBKCS126
00428          WHEN OTHER                                               MBKCS126
00429              SET DP013-LOGIC-ABEND TO TRUE                        MBKCS126
00430              SET DP013-NO-ROLLBACK TO TRUE                        MBKCS126
00431              MOVE '1000-CONTROL-PROCESSING'                       MBKCS126
00432                                TO  DP013-PARAGRAPH                MBKCS126
00433              MOVE PM-PROGRAM-MESSAGE-12                           MBKCS126
00434                                TO  DP013-MESSAGE-TEXT(1)          MBKCS126
00435              PERFORM DP013-0000-PROCESS-ABEND                     MBKCS126
00436      END-EVALUATE.                                                MBKCS126
00437 *                                                                 MBKCS126
00438  EJECT                                                            MBKCS126
00439 ******************************************************************MBKCS126
00440 *    DETERMINE WHETHER THE PROGRAM IS TO PROCESS ADDS (DON'T READ MBKCS126
00441 *    THE QUEUE) OR DELETES/UPDATES.                               MBKCS126
00442 *                                                                 MBKCS126
00443 *    PERFORMED BY 1000-CONTROL-PROCESSING.                        MBKCS126
00444 ******************************************************************MBKCS126
00445 *                                                                 MBKCS126
00446  2000-BUILD-INITIAL-PANEL.                                        MBKCS126
00447 *                                                                 MBKCS126
00448      IF  MB005-LIST-QUEUE-NAME GREATER THAN SPACES                MBKCS126
00449          MOVE 1                TO  MB126-AS-ITEM                  MBKCS126
00450          PERFORM 2150-READ-LIST-QUEUE                             MBKCS126
00451          MOVE APLSYS-LIST-RECORD                                  MBKCS126
00452                                TO  MB126-SAVE-TS-QUEUE            MBKCS126
00453          MOVE MBWS125-ACTION   TO  MB126-ACTION                   MBKCS126
00454          MOVE 1                TO  MB126-AS-SUB                   MBKCS126
00455          MOVE SPACES           TO  DCLTAPLSYS                     MBKCS126
00456          MOVE MBWS125-APLSYS-CODE (1)                             MBKCS126
00457                                TO  APLSYS-CDE                     MBKCS126
00458          SET PS-SAVE-DATA      TO  TRUE                           MBKCS126
00459          PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                     MBKCS126
00460      ELSE                                                         MBKCS126
00461          MOVE DP015-GREEN      TO  AAPLSYSC                       MBKCS126
00462          MOVE DP015-UNDERLINE  TO  AAPLSYSH                       MBKCS126
00463          SET MB126-ADD-FUNCTION                                   MBKCS126
00464                                TO  TRUE                           MBKCS126
00465      END-IF.                                                      MBKCS126
00466 *                                                                 MBKCS126
00467      MOVE PC-COMPANY           TO  AOPERCOO.                      MBKCS126
00468      PERFORM 2200-DISPLAY-PANEL.                                  MBKCS126
00469 *                                                                 MBKCS126
00470  EJECT                                                            MBKCS126
00471 ******************************************************************MBKCS126
00472 *    OBTAIN THE APPLICATION SYSTEM DATA.                          MBKCS126
00473 *    BECAUSE WE MUST READ THE SAME TABLE TO OBTAIN THE            MBKCS126
00474 *    PARENT APPLICATION SYSTEM DESCRIPTION, THE SQL STATEMENTS    MBKCS126
00475 *    ARE IN THE 2110 PARAGRAPH.                                   MBKCS126
00476 *                                                                 MBKCS126
00477 *    PERFORMED BY 2000, 2160                                      MBKCS126
00478 ******************************************************************MBKCS126
00479 *                                                                 MBKCS126
00480  2100-RETRIEVE-DATA-FOR-PANEL.                                    MBKCS126
00481 *                                                                 MBKCS126
00482      PERFORM 2110-REAL-APLSYS-READ.                               MBKCS126
00483 *                                                                 MBKCS126
00484      IF  PS-SAVE-DATA                                             MBKCS126
00485          MOVE APLSYS-CDE       TO  MB126-LAST-APLSYS-CODE         MBKCS126
00486          MOVE APLSYS-DESC      TO  MB126-LAST-APLSYS-DESC         MBKCS126
00487          MOVE APLSYS-PRNT-APLSYS-CDE                              MBKCS126
00488                                TO  MB126-LAST-PRNT-APLSYS-CODE    MBKCS126
00489          MOVE APLSYS-MDSE-IND  TO  MB126-LAST-MDSE-IND            MBKCS126
00490 *                                                                 MBKCS126
00491          IF  APLSYS-CDE NOT EQUAL APLSYS-PRNT-APLSYS-CDE          MBKCS126
00492              MOVE APLSYS-PRNT-APLSYS-CDE                          MBKCS126
00493                                TO  APLSYS-CDE                     MBKCS126
00494              PERFORM 2110-REAL-APLSYS-READ                        MBKCS126
00495              IF  SQLCODE EQUAL +100                               MBKCS126
00496                  MOVE SPACES   TO  APLSYS-DESC                    MBKCS126
00497              END-IF                                               MBKCS126
00498          END-IF                                                   MBKCS126
00499          MOVE APLSYS-DESC      TO  MB126-LAST-PRNT-APLSYS-DESC    MBKCS126
00500          PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                     MBKCS126
00501      END-IF.                                                      MBKCS126
00502 *                                                                 MBKCS126
00503  EJECT                                                            MBKCS126
00504 ******************************************************************MBKCS126
00505 *    THE REAL ACCESS TO TAPLSYS IS DONE HERE.                     MBKCS126
00506 *                                                                 MBKCS126
00507 *    PERFORMED BY 2100                                            MBKCS126
00508 ******************************************************************MBKCS126
00509 *                                                                 MBKCS126
00510  2110-REAL-APLSYS-READ.                                           MBKCS126
00511 *                                                                 MBKCS126
00512      PERFORM                                                      MBKCS126
00513          WITH TEST AFTER                                          MBKCS126
00514          VARYING PV-SQL-SUB                                       MBKCS126
00515          FROM 1 BY 1                                              MBKCS126
00516          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             MBKCS126
00517             OR SQLCODE = 0                                        MBKCS126
00518             OR SQLCODE = +100                                     MBKCS126
00519 *                                                                 MBKCS126
00520          EXEC SQL                                                 MBKCS126
00521               SELECT                                              MBKCS126
00522                      APLSYS_CDE,                                  MBKCS126
00523                      PRNT_APLSYS_CDE,                             MBKCS126
00524                      MDSE_IND,                                    MBKCS126
00525                      APLSYS_DESC                                  MBKCS126
00526               INTO                                                MBKCS126
00527                      :APLSYS-CDE,                                 MBKCS126
00528                      :APLSYS-PRNT-APLSYS-CDE,                     MBKCS126
00529                      :APLSYS-MDSE-IND,                            MBKCS126
00530                      :APLSYS-DESC                                 MBKCS126
00531               FROM                                                MBKCS126
00532                      TAPLSYS                                      MBKCS126
00533               WHERE                                               MBKCS126
00534                      OPERCO_NBR     = :PC-COMPANY                 MBKCS126
00535                 AND  APLSYS_CDE     = :APLSYS-CDE                 MBKCS126
00536          END-EXEC                                                 MBKCS126
00537 *                                                                 MBKCS126
00538          EVALUATE TRUE                                            MBKCS126
00539              WHEN SQLCODE = -904                                  MBKCS126
00540              WHEN SQLCODE = -913                                  MBKCS126
00541              WHEN SQLCODE = ZERO                                  MBKCS126
00542              WHEN SQLCODE = +100                                  MBKCS126
00543                   CONTINUE                                        MBKCS126
00544              WHEN SQLWARN0 NOT EQUAL SPACE                        MBKCS126
00545              WHEN SQLCODE NOT EQUAL ZERO                          MBKCS126
00546                   MOVE '2110-REAL-APLSYS-READ'                    MBKCS126
00547                                TO  DP013-PARAGRAPH                MBKCS126
00548                   MOVE 'READ APLSYS'                              MBKCS126
00549                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00550                   MOVE SQLCA   TO  DP013-SQLCA                    MBKCS126
00551                   SET DP013-DB2-ABEND                             MBKCS126
00552                                TO  TRUE                           MBKCS126
00553                   PERFORM DP013-0000-PROCESS-ABEND                MBKCS126
00554          END-EVALUATE                                             MBKCS126
00555      END-PERFORM.                                                 MBKCS126
00556 *                                                                 MBKCS126
00557      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   MBKCS126
00558          MOVE '2110-REAL-APLSYS-READ'                             MBKCS126
00559                                TO  DP013-PARAGRAPH                MBKCS126
00560          MOVE 'MAX RETRIES EXCEEDED FOR READ APLSYS'              MBKCS126
00561                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00562          MOVE SQLCA            TO  DP013-SQLCA                    MBKCS126
00563          SET DP013-DB2-ABEND   TO  TRUE                           MBKCS126
00564          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00565      END-IF.                                                      MBKCS126
00566 *                                                                 MBKCS126
00567      IF (SQLCODE EQUAL +100                                       MBKCS126
00568      AND NOT MB126-ADD-FUNCTION)                                  MBKCS126
00569          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER               MBKCS126
00570          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
00571          MOVE -1               TO  ANAVCMDL                       MBKCS126
00572      END-IF.                                                      MBKCS126
00573 *                                                                 MBKCS126
00574  EJECT                                                            MBKCS126
00575 ******************************************************************MBKCS126
00576 *    VALIDATION HAS BEEN PERFORMED.  A NEW BUSINESS GROUP MAY     MBKCS126
00577 *    BE ADDED.                                                    MBKCS126
00578 *                                                                 MBKCS126
00579 *    PERFORMED BY 3000                                            MBKCS126
00580 ******************************************************************MBKCS126
00581 *                                                                 MBKCS126
00582  2120-ADD-APLSYS.                                                 MBKCS126
00583 *                                                                 MBKCS126
00584      PERFORM                                                      MBKCS126
00585          WITH TEST AFTER                                          MBKCS126
00586          VARYING PV-SQL-SUB                                       MBKCS126
00587          FROM 1 BY 1                                              MBKCS126
00588          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             MBKCS126
00589             OR SQLCODE = 0                                        MBKCS126
00590 *                                                                 MBKCS126
00591          EXEC SQL                                                 MBKCS126
00592               INSERT INTO TAPLSYS                                 MBKCS126
00593                     (OPERCO_NBR,                                  MBKCS126
00594                      APLSYS_CDE,                                  MBKCS126
00595                      PRNT_APLSYS_CDE,                             MBKCS126
00596                      MDSE_IND,                                    MBKCS126
00597                      APLSYS_DESC)                                 MBKCS126
00598               VALUES                                              MBKCS126
00599                     (:PC-COMPANY,                                 MBKCS126
00600                      :MB126-LAST-APLSYS-CODE,                     MBKCS126
00601                      :MB126-LAST-PRNT-APLSYS-CODE,                MBKCS126
00602                      :MB126-LAST-MDSE-IND,                        MBKCS126
00603                      :MB126-LAST-APLSYS-DESC)                     MBKCS126
00604          END-EXEC                                                 MBKCS126
00605 *                                                                 MBKCS126
00606          EVALUATE TRUE                                            MBKCS126
00607              WHEN SQLCODE = -904                                  MBKCS126
00608              WHEN SQLCODE = -913                                  MBKCS126
00609              WHEN SQLCODE = ZERO                                  MBKCS126
00610                   CONTINUE                                        MBKCS126
00611              WHEN SQLWARN0 NOT EQUAL SPACE                        MBKCS126
00612              WHEN SQLCODE NOT EQUAL ZERO                          MBKCS126
00613                   MOVE '2120-ADD-APLSYS'                          MBKCS126
00614                                TO  DP013-PARAGRAPH                MBKCS126
00615                   MOVE 'ADD APLSYS'                               MBKCS126
00616                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00617                   MOVE SQLCA   TO  DP013-SQLCA                    MBKCS126
00618                   SET DP013-DB2-ABEND                             MBKCS126
00619                                TO  TRUE                           MBKCS126
00620                   PERFORM DP013-0000-PROCESS-ABEND                MBKCS126
00621          END-EVALUATE                                             MBKCS126
00622      END-PERFORM.                                                 MBKCS126
00623 *                                                                 MBKCS126
00624      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   MBKCS126
00625          MOVE '2120-ADD-APLSYS'                                   MBKCS126
00626                                TO  DP013-PARAGRAPH                MBKCS126
00627          MOVE 'MAX RETRIES EXCEEDED FOR ADD MDSEBG'               MBKCS126
00628                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00629          MOVE SQLCA            TO  DP013-SQLCA                    MBKCS126
00630          SET DP013-DB2-ABEND   TO  TRUE                           MBKCS126
00631          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00632      END-IF.                                                      MBKCS126
00633 *                                                                 MBKCS126
00634      MOVE SPACES               TO  AAPLSYSO                       MBKCS126
00635                                    AAPLDESO                       MBKCS126
00636                                    AMDSINDO                       MBKCS126
00637                                    AAPLPRTO                       MBKCS126
00638                                    APRTDESO                       MBKCS126
00639                                    ALIKESYO                       MBKCS126
00640                                    ALIKEDEO                       MBKCS126
00641                                    ASTRTMMO                       MBKCS126
00642                                    ASTRTDDO                       MBKCS126
00643                                    ASTRTYYO.                         CL**4
00644 *                                                                 MBKCS126
00645      MOVE PC-TSYMSG-00034      TO  DP020-MSG-NUMBER.              MBKCS126
00646      SET DP020-MSG-INFORMATIONAL                                  MBKCS126
00647                                TO  TRUE.                          MBKCS126
00648 *                                                                 MBKCS126
00649  EJECT                                                            MBKCS126
00650 ******************************************************************MBKCS126
00651 *    VALIDATION HAS BEEN PERFORMED.  THE APPLICATION SYSTEM ROW   MBKCS126
00652 *    IS TO BE DELETED.                                            MBKCS126
00653 *                                                                 MBKCS126
00654 *    PERFORMED BY 3100.                                           MBKCS126
00655 ******************************************************************MBKCS126
00656 *                                                                 MBKCS126
00657  2130-DELETE-APLSYS.                                              MBKCS126
00658 *                                                                 MBKCS126
00659      PERFORM                                                      MBKCS126
00660          WITH TEST AFTER                                          MBKCS126
00661          VARYING PV-SQL-SUB                                       MBKCS126
00662          FROM 1 BY 1                                              MBKCS126
00663          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             MBKCS126
00664             OR SQLCODE = 0                                        MBKCS126
00665             OR SQLCODE = +100                                     MBKCS126
00666 *                                                                 MBKCS126
00667          EXEC SQL                                                 MBKCS126
00668               DELETE FROM                                         MBKCS126
00669                     TAPLSYS                                       MBKCS126
00670               WHERE                                               MBKCS126
00671                     OPERCO_NBR   =  :PC-COMPANY                   MBKCS126
00672                 AND APLSYS_CDE   =  :MB126-LAST-APLSYS-CODE       MBKCS126
00673          END-EXEC                                                 MBKCS126
00674 *                                                                 MBKCS126
00675          EVALUATE TRUE                                            MBKCS126
00676              WHEN SQLCODE = -904                                  MBKCS126
00677              WHEN SQLCODE = -913                                  MBKCS126
00678              WHEN SQLCODE = +100                                  MBKCS126
00679              WHEN SQLCODE = ZERO                                  MBKCS126
00680                   CONTINUE                                        MBKCS126
00681              WHEN SQLWARN0 NOT EQUAL SPACE                        MBKCS126
00682              WHEN SQLCODE NOT EQUAL ZERO                          MBKCS126
00683                   MOVE '2130-DELETE-APLSYS'                       MBKCS126
00684                                TO  DP013-PARAGRAPH                MBKCS126
00685                   MOVE 'DELETE APLSYS'                            MBKCS126
00686                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00687                   MOVE SQLCA   TO  DP013-SQLCA                    MBKCS126
00688                   SET DP013-DB2-ABEND                             MBKCS126
00689                                TO  TRUE                           MBKCS126
00690                   PERFORM DP013-0000-PROCESS-ABEND                MBKCS126
00691          END-EVALUATE                                             MBKCS126
00692      END-PERFORM.                                                 MBKCS126
00693 *                                                                 MBKCS126
00694      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   MBKCS126
00695          MOVE '2130-DELETE-APLSYS'                                MBKCS126
00696                                TO  DP013-PARAGRAPH                MBKCS126
00697          MOVE 'MAX RETRIES EXCEEDED FOR DELETE APLSYS'            MBKCS126
00698                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00699          MOVE SQLCA            TO  DP013-SQLCA                    MBKCS126
00700          SET DP013-DB2-ABEND   TO  TRUE                           MBKCS126
00701          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00702      END-IF.                                                      MBKCS126
00703 *                                                                 MBKCS126
00704      IF  SQLCODE = ZERO                                           MBKCS126
00705          MOVE PC-TSYMSG-00115  TO  DP020-MSG-NUMBER               MBKCS126
00706          SET DP020-MSG-INFORMATIONAL                              MBKCS126
00707                                TO  TRUE                           MBKCS126
00708      ELSE                                                         MBKCS126
00709          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER               MBKCS126
00710          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
00711      END-IF.                                                      MBKCS126
00712 *                                                                 MBKCS126
00713  EJECT                                                            MBKCS126
00714 ******************************************************************MBKCS126
00715 *    VALIDATION HAS BEEN PERFORMED.  THE APPLICATION AVAILABILITY MBKCS126
00716 *    ROWS MAY BE DELETED.                                         MBKCS126
00717 *                                                                 MBKCS126
00718 *    PERFORMED BY 3100.                                           MBKCS126
00719 ******************************************************************MBKCS126
00720 *                                                                 MBKCS126
00721  2135-DELETE-APLAVL.                                              MBKCS126
00722 *                                                                 MBKCS126
00723      PERFORM                                                      MBKCS126
00724          WITH TEST AFTER                                          MBKCS126
00725          VARYING PV-SQL-SUB                                       MBKCS126
00726          FROM 1 BY 1                                              MBKCS126
00727          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             MBKCS126
00728             OR SQLCODE = 0                                        MBKCS126
00729             OR SQLCODE = +100                                     MBKCS126
00730 *                                                                 MBKCS126
00731          EXEC SQL                                                 MBKCS126
00732               DELETE FROM                                         MBKCS126
00733                     TAPLAVL                                       MBKCS126
00734               WHERE                                               MBKCS126
00735                     OPERCO_NBR   =  :PC-COMPANY                   MBKCS126
00736                 AND APLSYS_CDE   =  :MB126-LAST-APLSYS-CODE       MBKCS126
00737          END-EXEC                                                 MBKCS126
00738 *                                                                 MBKCS126
00739          EVALUATE TRUE                                            MBKCS126
00740              WHEN SQLCODE = -904                                  MBKCS126
00741              WHEN SQLCODE = -913                                  MBKCS126
00742              WHEN SQLCODE = +100                                  MBKCS126
00743              WHEN SQLCODE = ZERO                                  MBKCS126
00744                   CONTINUE                                        MBKCS126
00745              WHEN SQLWARN0 NOT EQUAL SPACE                        MBKCS126
00746              WHEN SQLCODE NOT EQUAL ZERO                          MBKCS126
00747                   MOVE '2135-DELETE-APLAVL'                       MBKCS126
00748                                TO  DP013-PARAGRAPH                MBKCS126
00749                   MOVE 'DELETE APLAVL'                            MBKCS126
00750                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00751                   MOVE SQLCA   TO  DP013-SQLCA                    MBKCS126
00752                   SET DP013-DB2-ABEND                             MBKCS126
00753                                TO  TRUE                           MBKCS126
00754                   PERFORM DP013-0000-PROCESS-ABEND                MBKCS126
00755          END-EVALUATE                                             MBKCS126
00756      END-PERFORM.                                                 MBKCS126
00757 *                                                                 MBKCS126
00758      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   MBKCS126
00759          MOVE '2130-DELETE-APLAVL'                                MBKCS126
00760                                TO  DP013-PARAGRAPH                MBKCS126
00761          MOVE 'MAX RETRIES EXCEEDED FOR DELETE APLAVL'            MBKCS126
00762                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00763          MOVE SQLCA            TO  DP013-SQLCA                    MBKCS126
00764          SET DP013-DB2-ABEND   TO  TRUE                           MBKCS126
00765          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00766      END-IF.                                                      MBKCS126
00767 *                                                                 MBKCS126
00768      IF  SQLCODE = ZERO                                           MBKCS126
00769          MOVE PC-TSYMSG-00115  TO  DP020-MSG-NUMBER               MBKCS126
00770          SET DP020-MSG-INFORMATIONAL                              MBKCS126
00771                                TO  TRUE                           MBKCS126
00772      ELSE                                                         MBKCS126
00773          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER               MBKCS126
00774          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
00775      END-IF.                                                      MBKCS126
00776 *                                                                 MBKCS126
00777  EJECT                                                            MBKCS126
00778 ******************************************************************MBKCS126
00779 *    VALIDATION HAS BEEN PERFORMED.  THE CURRENT APPLICATION      MBKCS126
00780 *    SYSTEM CODE CAN BE UPDATED.                                  MBKCS126
00781 *                                                                 MBKCS126
00782 *    PERFORMED BY 3000.                                           MBKCS126
00783 ******************************************************************MBKCS126
00784 *                                                                 MBKCS126
00785  2140-UPDATE-APLSYS.                                              MBKCS126
00786 *                                                                 MBKCS126
00787      PERFORM                                                      MBKCS126
00788          WITH TEST AFTER                                          MBKCS126
00789          VARYING PV-SQL-SUB                                       MBKCS126
00790          FROM 1 BY 1                                              MBKCS126
00791          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             MBKCS126
00792             OR SQLCODE = 0                                        MBKCS126
00793             OR SQLCODE = +100                                     MBKCS126
00794 *                                                                 MBKCS126
00795          EXEC SQL                                                 MBKCS126
00796               UPDATE                                              MBKCS126
00797                     TAPLSYS                                       MBKCS126
00798                 SET                                               MBKCS126
00799                     APLSYS_DESC     = :MB126-LAST-APLSYS-DESC,    MBKCS126
00800                     MDSE_IND        = :MB126-LAST-MDSE-IND,       MBKCS126
00801                     PRNT_APLSYS_CDE = :MB126-LAST-PRNT-APLSYS-CODEMBKCS126
00802               WHERE                                               MBKCS126
00803                     OPERCO_NBR      = :PC-COMPANY                 MBKCS126
00804                 AND APLSYS_CDE      = :MB126-LAST-APLSYS-CODE     MBKCS126
00805          END-EXEC                                                 MBKCS126
00806 *                                                                 MBKCS126
00807          EVALUATE TRUE                                            MBKCS126
00808              WHEN SQLCODE = -904                                  MBKCS126
00809              WHEN SQLCODE = -913                                  MBKCS126
00810              WHEN SQLCODE = +100                                  MBKCS126
00811              WHEN SQLCODE = ZERO                                  MBKCS126
00812                   CONTINUE                                        MBKCS126
00813              WHEN SQLWARN0 NOT EQUAL SPACE                        MBKCS126
00814              WHEN SQLCODE NOT EQUAL ZERO                          MBKCS126
00815                   MOVE '2140-UPDATE-APLSYS'                       MBKCS126
00816                                TO  DP013-PARAGRAPH                MBKCS126
00817                   MOVE 'UPDATE APLSYS'                            MBKCS126
00818                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00819                   MOVE SQLCA   TO  DP013-SQLCA                    MBKCS126
00820                   SET DP013-DB2-ABEND                             MBKCS126
00821                                TO  TRUE                           MBKCS126
00822                   PERFORM DP013-0000-PROCESS-ABEND                MBKCS126
00823          END-EVALUATE                                             MBKCS126
00824      END-PERFORM.                                                 MBKCS126
00825 *                                                                 MBKCS126
00826      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   MBKCS126
00827          MOVE '2140-UPDATE-APLSYS'                                MBKCS126
00828                                TO  DP013-PARAGRAPH                MBKCS126
00829          MOVE 'MAX RETRIES EXCEEDED FOR ADD APLSYS'               MBKCS126
00830                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00831          MOVE SQLCA            TO  DP013-SQLCA                    MBKCS126
00832          SET DP013-DB2-ABEND   TO  TRUE                           MBKCS126
00833          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00834      END-IF.                                                      MBKCS126
00835 *                                                                 MBKCS126
00836      IF  SQLCODE EQUAL ZERO                                       MBKCS126
00837          MOVE PC-TSYMSG-00059  TO  DP020-MSG-NUMBER               MBKCS126
00838          SET DP020-MSG-INFORMATIONAL                              MBKCS126
00839                                TO  TRUE                           MBKCS126
00840      ELSE                                                         MBKCS126
00841          MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER               MBKCS126
00842          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
00843      END-IF.                                                      MBKCS126
00844 *                                                                 MBKCS126
00845  EJECT                                                            MBKCS126
00846 ******************************************************************MBKCS126
00847 *    READ THE TEMPORARY STORAGE QUEUE THAT CONTAINS THE SELECTED  MBKCS126
00848 *    BUSINESS GROUPS FROM MBKCS120 (BUSINESS GROUP LIST).         MBKCS126
00849 *                                                                 MBKCS126
00850 *    PERFORMED BY 2000, 2160                                      MBKCS126
00851 ******************************************************************MBKCS126
00852 *                                                                 MBKCS126
00853  2150-READ-LIST-QUEUE.                                            MBKCS126
00854 *                                                                 MBKCS126
00855      EXEC CICS                                                    MBKCS126
00856          READQ TS                                                 MBKCS126
00857          QUEUE(MB005-LIST-QUEUE-NAME)                             MBKCS126
00858          INTO(APLSYS-LIST-RECORD)                                 MBKCS126
00859          LENGTH(MB005-LIST-QUEUE-LENGTH)                          MBKCS126
00860          ITEM(MB126-AS-ITEM)                                      MBKCS126
00861          RESP(PV-RESP)                                            MBKCS126
00862      END-EXEC.                                                    MBKCS126
00863 *                                                                 MBKCS126
00864      IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                        MBKCS126
00865          MOVE PV-RESP          TO  PM-RESP-22                     MBKCS126
00866          SET DP013-LOGIC-ABEND TO  TRUE                           MBKCS126
00867          SET DP013-NO-ROLLBACK TO  TRUE                           MBKCS126
00868          MOVE '2150-READ-LIST-QUEUE'                              MBKCS126
00869                                TO  DP013-PARAGRAPH                MBKCS126
00870          MOVE PM-PROGRAM-MESSAGE-22                               MBKCS126
00871                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00872          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00873      END-IF.                                                      MBKCS126
00874 *                                                                 MBKCS126
00875  EJECT                                                            MBKCS126
00876 ******************************************************************MBKCS126
00877 *    READ THE TEMP STORAGE QUEUE, GET THE NEXT BUSINESS GROUP.    MBKCS126
00878 *    IF AT END, ISSUE MESSAGE, OTHERWISE CONTINUE PROCESSING.     MBKCS126
00879 *                                                                 MBKCS126
00880 *    PERFORMED BY 3000                                            MBKCS126
00881 ******************************************************************MBKCS126
00882 *                                                                 MBKCS126
00883  2160-GET-NEXT-APLSYS.                                            MBKCS126
00884 *                                                                 MBKCS126
00885      ADD 1                     TO  MB126-AS-SUB.                  MBKCS126
00886      IF  MB126-AS-SUB GREATER THAN MBWS125-MAX-APLSYS-CODES       MBKCS126
00887          ADD 1                 TO  MB126-AS-ITEM                  MBKCS126
00888          MOVE 1                TO  MB126-AS-SUB                   MBKCS126
00889          PERFORM 2150-READ-LIST-QUEUE                             MBKCS126
00890          MOVE APLSYS-LIST-RECORD                                  MBKCS126
00891                                TO  MB126-SAVE-TS-QUEUE            MBKCS126
00892      ELSE                                                         MBKCS126
00893          MOVE MB126-SAVE-TS-QUEUE                                 MBKCS126
00894                                TO  APLSYS-LIST-RECORD             MBKCS126
00895      END-IF.                                                      MBKCS126
00896 *                                                                 MBKCS126
00897      IF  MBWS125-APLSYS-CODE (MB126-AS-SUB) GREATER THAN SPACES   MBKCS126
00898          MOVE SPACES           TO  DCLTAPLSYS                     MBKCS126
00899          MOVE MBWS125-APLSYS-CODE (MB126-AS-SUB)                  MBKCS126
00900                                TO  APLSYS-CDE                     MBKCS126
00901          SET PS-SAVE-DATA      TO  TRUE                           MBKCS126
00902          PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                     MBKCS126
00903          MOVE DP015-GREEN      TO  AAPLDESC                       MBKCS126
00904                                    AMDSINDC                       MBKCS126
00905                                    AAPLPRTC                       MBKCS126
00906          MOVE DP015-UNDERLINE  TO  AAPLDESH                       MBKCS126
00907                                    AMDSINDH                       MBKCS126
00908                                    AAPLPRTH                       MBKCS126
00909      ELSE                                                         MBKCS126
00910          SUBTRACT 1          FROM  MB126-AS-SUB                   MBKCS126
00911          MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER               MBKCS126
00912          SET DP020-MSG-INFORMATIONAL                              MBKCS126
00913                                TO  TRUE                           MBKCS126
00914      END-IF.                                                      MBKCS126
00915 *                                                                 MBKCS126
00916  EJECT                                                            MBKCS126
00917 ******************************************************************MBKCS126
00918 *    DETERMINE WHETHER THE APPLICATION IS ACTIVE. IF SO, IT MAY   MBKCS126
00919 *    NOT BE DELETED.                                              MBKCS126
00920 *                                                                 MBKCS126
00921 *    PERFORMED BY C300                                            MBKCS126
00922 ******************************************************************MBKCS126
00923 *                                                                 MBKCS126
00924  2170-APPLICATION-CHECK.                                          MBKCS126
00925 *                                                                 MBKCS126
00926      PERFORM DP017-0000-GET-CURR-DATE-TIME.                       MBKCS126
00927      MOVE DP017-CURRENT-YMD-YYYY                                  MBKCS126
00928                                TO  PV-DD-CCYY.                    MBKCS126
00929      MOVE DP017-CURRENT-YMD-MONTH                                 MBKCS126
00930                                TO  PV-DD-MM.                      MBKCS126
00931      MOVE DP017-CURRENT-YMD-DAY                                   MBKCS126
00932                                TO  PV-DD-DD.                      MBKCS126
00933      SET PV-DD-DASH1           TO  TRUE.                          MBKCS126
00934      SET PV-DD-DASH2           TO  TRUE.                          MBKCS126
00935      MOVE MB126-LAST-APLSYS-CODE                                  MBKCS126
00936                                TO  APLAVL-APLSYS-CDE.             MBKCS126
00937 *                                                                 MBKCS126
00938      PERFORM                                                      MBKCS126
00939          WITH TEST AFTER                                          MBKCS126
00940          VARYING PV-SQL-SUB                                       MBKCS126
00941          FROM 1 BY 1                                              MBKCS126
00942          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             MBKCS126
00943             OR SQLCODE = 0                                        MBKCS126
00944             OR SQLCODE = +100                                     MBKCS126
00945 *                                                                 MBKCS126
00946          EXEC SQL                                                 MBKCS126
00947            SELECT COUNT(DISTINCT APLSYS_CDE)                      MBKCS126
00948            INTO  :PV-DB2-COUNT                                    MBKCS126
00949            FROM TAPLAVL                                           MBKCS126
00950            WHERE APLSYS_CDE      =  :APLAVL-APLSYS-CDE            MBKCS126
00951              AND OPERCO_NBR      =  :PC-COMPANY                   MBKCS126
00952          END-EXEC                                                 MBKCS126
00953 *                                                                 MBKCS126
00954          EVALUATE TRUE                                            MBKCS126
00955              WHEN SQLCODE = -904                                  MBKCS126
00956              WHEN SQLCODE = -913                                  MBKCS126
00957              WHEN SQLCODE = ZERO                                  MBKCS126
00958              WHEN SQLCODE = +100                                  MBKCS126
00959                   CONTINUE                                        MBKCS126
00960              WHEN SQLWARN0 NOT EQUAL SPACE                        MBKCS126
00961              WHEN SQLCODE NOT EQUAL ZERO                          MBKCS126
00962                   MOVE '2170-APPLICATON-CHECK'                    MBKCS126
00963                                TO  DP013-PARAGRAPH                MBKCS126
00964                   MOVE 'COUNT FUNCTION - DEPARTMENTS'             MBKCS126
00965                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00966                   MOVE SQLCA   TO  DP013-SQLCA                    MBKCS126
00967                   SET DP013-DB2-ABEND                             MBKCS126
00968                                TO  TRUE                           MBKCS126
00969                   PERFORM DP013-0000-PROCESS-ABEND                MBKCS126
00970          END-EVALUATE                                             MBKCS126
00971      END-PERFORM.                                                 MBKCS126
00972 *                                                                 MBKCS126
00973      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   MBKCS126
00974          MOVE '2170-APPLICATON-CHECK'                             MBKCS126
00975                                TO  DP013-PARAGRAPH                MBKCS126
00976          MOVE 'MAX RETRIES EXCEEDED FOR COUNT - APPLICATION'      MBKCS126
00977                                TO  DP013-MESSAGE-TEXT (1)         MBKCS126
00978          MOVE SQLCA            TO  DP013-SQLCA                    MBKCS126
00979          SET DP013-DB2-ABEND   TO  TRUE                           MBKCS126
00980          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
00981      END-IF.                                                      MBKCS126
00982 *                                                                 MBKCS126
00983      IF  PV-DB2-COUNT GREATER THAN ZERO                           MBKCS126
00984          MOVE PC-TSYMSG-00208  TO  DP020-MSG-NUMBER               MBKCS126
00985      ELSE                                                         MBKCS126
00986          MOVE PC-TSYMSG-00004  TO  DP020-MSG-NUMBER               MBKCS126
00987      END-IF.                                                      MBKCS126
00988 *                                                                 MBKCS126
00989      SET DP020-MSG-INFORMATIONAL                                  MBKCS126
00990                                TO  TRUE.                          MBKCS126
00991 *                                                                 MBKCS126
00992  EJECT                                                            MBKCS126
00993 ******************************************************************MBKCS126
00994 *    FORMAT AND WRITE THE VSAM BATCH PARAMETER CONTROL RECORD.    MBKCS126
00995 *                                                                 MBKCS126
00996 *    PERFORMED BY 3100                                            MBKCS126
00997 ******************************************************************MBKCS126
00998 *                                                                 MBKCS126
00999  2180-WRITE-BATCH-CONTROL.                                        MBKCS126
01000 *                                                                 MBKCS126
01001      MOVE LOW-VALUES           TO  MB018-BATCH-CNTL-RECORD.       MBKCS126
01002      SET MB018-CREAT-NEW-APPL-SYS-AVAIL                           MBKCS126
01003                                TO  TRUE.                          MBKCS126
01004      MOVE PC-COMPANY           TO  MB018-OPERATING-CO-005.        MBKCS126
01005      MOVE MB126-LAST-APLSYS-CODE                                  MBKCS126
01006                                TO  MB018-NEW-APPL-SYS-CODE-005.   MBKCS126
01007      MOVE MB126-LAST-LIKE-SYSTEM                                  MBKCS126
01008                                TO  MB018-LIKE-APPL-SYS-CODE-005.  MBKCS126
01009 *                                                                 MBKCS126
01010      MOVE MB126-LAST-START-CC  TO  PV-DD-CC.                      MBKCS126
01011      MOVE MB126-LAST-START-MM  TO  PV-DD-MM.                      MBKCS126
01012      MOVE MB126-LAST-START-DD  TO  PV-DD-DD.                      MBKCS126
01013      MOVE MB126-LAST-START-YY  TO  PV-DD-YY.                      MBKCS126
01014      SET PV-DD-DASH1           TO  TRUE.                          MBKCS126
01015      SET PV-DD-DASH2           TO  TRUE.                          MBKCS126
01016      MOVE PV-DB2-DATE          TO  MB018-EFFECTIVE-START-DATE-005.MBKCS126
01017 *                                                                 MBKCS126
01018      EXEC CICS WRITE                                              MBKCS126
01019           FROM(MB018-BATCH-CNTL-RECORD)                           MBKCS126
01020           FILE('MBBCHCTL')                                        MBKCS126
01021           RIDFLD(MB018-BCR-KEY)                                   MBKCS126
01022           RESP(PV-RESP)                                           MBKCS126
01023      END-EXEC.                                                    MBKCS126
01024 *                                                                 MBKCS126
01025      IF  PV-RESP EQUAL DFHRESP(NORMAL)                            MBKCS126
01026          MOVE LOW-VALUES       TO  MB126-LAST-AREA                MBKCS126
01027          SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                     MBKCS126
01028          PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                     MBKCS126
01029      ELSE                                                         MBKCS126
01030          SET DP013-LOGIC-ABEND TO  TRUE                           MBKCS126
01031          SET DP013-NO-ROLLBACK TO  TRUE                           MBKCS126
01032          MOVE PV-RESP          TO  PM-RESP-23                     MBKCS126
01033          MOVE '2180-WRITE-BATCH-CONTROL'                          MBKCS126
01034                                TO  DP013-PARAGRAPH                MBKCS126
01035          MOVE PM-PROGRAM-MESSAGE-23                               MBKCS126
01036                                TO  DP013-MESSAGE-TEXT(1)          MBKCS126
01037          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
01038      END-IF.                                                      MBKCS126
01039 *                                                                 MBKCS126
01040  EJECT                                                            MBKCS126
01041 ******************************************************************MBKCS126
01042 *    ATTEMPT TO DELETE THE VSAM BATCH PARAMETER CONTROL RECORD.   MBKCS126
01043 *    EITHER NOT FOUND OR NORMAL IS AN ACCEPTABLE RESPONSE CODE.   MBKCS126
01044 *                                                                 MBKCS126
01045 *    PERFORMED BY 3100                                            MBKCS126
01046 ******************************************************************MBKCS126
01047 *                                                                 MBKCS126
01048  2190-DELETE-BATCH-CONTROL.                                       MBKCS126
01049 *                                                                 MBKCS126
01050      MOVE LOW-VALUES           TO  MB018-BATCH-CNTL-RECORD.       MBKCS126
01051      SET MB018-CREAT-NEW-APPL-SYS-AVAIL                           MBKCS126
01052                                TO  TRUE.                          MBKCS126
01053      MOVE PC-COMPANY           TO  MB018-OPERATING-CO-005.        MBKCS126
01054      MOVE MB126-LAST-APLSYS-CODE                                  MBKCS126
01055                                TO  MB018-NEW-APPL-SYS-CODE-005.   MBKCS126
01056 *                                                                 MBKCS126
01057      EXEC CICS DELETE                                             MBKCS126
01058           FILE('MBBCHCTL')                                        MBKCS126
01059           RIDFLD(MB018-BCR-KEY)                                   MBKCS126
01060           RESP(PV-RESP)                                           MBKCS126
01061      END-EXEC.                                                    MBKCS126
01062 *                                                                 MBKCS126
01063      IF (PV-RESP EQUAL DFHRESP(NORMAL)                            MBKCS126
01064      OR  PV-RESP EQUAL DFHRESP(NOTFND))                           MBKCS126
01065          CONTINUE                                                 MBKCS126
01066      ELSE                                                         MBKCS126
01067          SET DP013-LOGIC-ABEND TO  TRUE                           MBKCS126
01068          SET DP013-NO-ROLLBACK TO  TRUE                           MBKCS126
01069          MOVE PV-RESP          TO  PM-RESP-23                     MBKCS126
01070          MOVE '2190-DELETE-BATCH-CONTROL'                         MBKCS126
01071                                TO  DP013-PARAGRAPH                MBKCS126
01072          MOVE PM-PROGRAM-MESSAGE-23                               MBKCS126
01073                                TO  DP013-MESSAGE-TEXT(1)          MBKCS126
01074          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS126
01075      END-IF.                                                      MBKCS126
01076 *                                                                 MBKCS126
01077  EJECT                                                            MBKCS126
01078 ******************************************************************MBKCS126
01079 *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       MBKCS126
01080 *                                                                 MBKCS126
01081 *    PERFORMED BY 1000-CONTROL-PROCESSING.                        MBKCS126
01082 *    PERFORMED BY 3000-PROCESS-PANEL.                             MBKCS126
01083 ******************************************************************MBKCS126
01084 *                                                                 MBKCS126
01085  2200-DISPLAY-PANEL.                                              MBKCS126
01086 *                                                                 MBKCS126
01087      PERFORM DP017-0000-GET-CURR-DATE-TIME.                       MBKCS126
01088      MOVE DP017-EDITED-TIME-HMS                                   MBKCS126
01089                                TO  ATIMEO.                        MBKCS126
01090      IF  NOT DP020-MSG-FATAL                                      MBKCS126
01091          IF  MB126-ADD-FUNCTION                                   MBKCS126
01092              MOVE -1           TO  AAPLSYSL                       MBKCS126
01093          ELSE                                                     MBKCS126
01094              IF  MB126-UPDATE-FUNCTION                            MBKCS126
01095                  MOVE -1       TO  AAPLDESL                       MBKCS126
01096              END-IF                                               MBKCS126
01097          END-IF                                                   MBKCS126
01098      END-IF.                                                      MBKCS126
01099 *                                                                 MBKCS126
01100      IF  MB126-ADD-FUNCTION                                       MBKCS126
01101          MOVE DP015-UNP-ALP-NOR-MDT                               MBKCS126
01102                                TO  AAPLSYSA                       MBKCS126
01103      ELSE                                                         MBKCS126
01104          MOVE DP015-ASK-DRK-OFF                                   MBKCS126
01105                                TO  ALIKESYA                       MBKCS126
01106                                    ALIKEDEA                       MBKCS126
01107                                    ASTRTMMA                       MBKCS126
01108                                    ASTRTDDA                       MBKCS126
01109                                    ASTRTYYA                       MBKCS126
01110                                    ALIKEHDA                       MBKCS126
01111                                    ASTRTHDA                       MBKCS126
01112          MOVE DP015-HL-OFF     TO  ALIKESYH                       MBKCS126
01113                                    ALIKEDEH                       MBKCS126
01114                                    ASTRTMMH                       MBKCS126
01115                                    ASTRTDDH                       MBKCS126
01116                                    ASTRTYYH                       MBKCS126
01117          MOVE DP015-ASK-NOR-OFF                                   MBKCS126
01118                                TO  AMDSINDA                       MBKCS126
01119          MOVE DP015-BLUE       TO  AMDSINDC                       MBKCS126
01120          MOVE DP015-HL-OFF     TO  AMDSINDH                       MBKCS126
01121      END-IF.                                                      MBKCS126
01122 *                                                                 MBKCS126
01123      IF  MB126-DELETE-FUNCTION                                    MBKCS126
01124          MOVE DP015-ASK-NOR-OFF                                   MBKCS126
01125                                TO  AAPLSYSA                       MBKCS126
01126                                    AAPLPRTA                       MBKCS126
01127                                    AMDSINDA                       MBKCS126
01128                                    AAPLDESA                       MBKCS126
01129          MOVE DP015-BLUE       TO  AAPLSYSC                       MBKCS126
01130                                    AAPLPRTC                       MBKCS126
01131                                    AMDSINDC                       MBKCS126
01132                                    AAPLDESC                       MBKCS126
01133          MOVE DP015-HL-OFF     TO  AAPLSYSH                       MBKCS126
01134                                    AAPLPRTH                       MBKCS126
01135                                    AMDSINDH                       MBKCS126
01136                                    AAPLDESH                       MBKCS126
01137          MOVE -1               TO  ANAVCMDL                       MBKCS126
01138      END-IF.                                                      MBKCS126
01139 *                                                                 MBKCS126
01140      IF  PS-SEND-MAP-N-DATA-FRSET                                 MBKCS126
01141          PERFORM DP002-0000-FORMAT-TITLE-LINES                    MBKCS126
01142          PERFORM DP009-0000-LOAD-FK-LINES                         MBKCS126
01143      END-IF.                                                      MBKCS126
01144 *                                                                 MBKCS126
01145      PERFORM DP005-0000-FORMAT-MSG-LINES.                         MBKCS126
01146                                                                   MBKCS126
01147      PERFORM DP008-0000-WRITE-PANEL.                              MBKCS126
01148 *                                                                 MBKCS126
01149  EJECT                                                            MBKCS126
01150 ******************************************************************MBKCS126
01151 *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED  MBKCS126
01152 *    ON WHAT FUNCTION KEY WAS SELECTED.                           MBKCS126
01153 *                                                                 MBKCS126
01154 *    PERFORMED BY 1000-CONTROL-PROCESSING.                        MBKCS126
01155 ******************************************************************MBKCS126
01156 *                                                                 MBKCS126
01157  3000-PROCESS-PANEL.                                              MBKCS126
01158 *                                                                 MBKCS126
01159      PERFORM DP007-0000-GET-PANEL.                                MBKCS126
01160      SET PS-SEND-DATA-ONLY-FRSET                                  MBKCS126
01161                                TO TRUE.                           MBKCS126
01162 *                                                                 MBKCS126
01163      IF  (DP020-SRC-AID NOT EQUAL DP016-PF5                       MBKCS126
01164      AND  DP020-SRC-AID NOT EQUAL DP016-CLEAR)                    MBKCS126
01165          PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                     MBKCS126
01166      END-IF.                                                      MBKCS126
01167 *                                                                 MBKCS126
01168      IF (MB126-CAN-CONFIRM                                        MBKCS126
01169      AND NOT DP020-FK-CONFIRM(DP020-SRC-AID))                     MBKCS126
01170          SET MB126-CANT-CONFIRM                                   MBKCS126
01171                                TO  TRUE                           MBKCS126
01172      END-IF.                                                      MBKCS126
01173      PERFORM 3100-CHECK-LOCAL-FKEYS.                              MBKCS126
01174 *                                                                 MBKCS126
01175  EJECT                                                            MBKCS126
01176 ******************************************************************MBKCS126
01177 *   DETERMINE THE PROCESSING PATH HERE.                           MBKCS126
01178 *                                                                 MBKCS126
01179 *   PERFORMED BY 3000.                                            MBKCS126
01180 ******************************************************************MBKCS126
01181 *                                                                 MBKCS126
01182  3100-CHECK-LOCAL-FKEYS.                                          MBKCS126
01183 *                                                                 MBKCS126
01184      EVALUATE TRUE                                                MBKCS126
01185 *                                                                 MBKCS126
01186          WHEN DP020-SRC-AID = DP016-CLEAR                         MBKCS126
01187              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 MBKCS126
01188              PERFORM 3400-MOVE-COMMAREA-TO-SCREEN                 MBKCS126
01189              IF  MB126-DELETE-FUNCTION                            MBKCS126
01190                  CONTINUE                                         MBKCS126
01191              ELSE                                                 MBKCS126
01192                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01193              END-IF                                               MBKCS126
01194              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01195 *                                                                 MBKCS126
01196          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     MBKCS126
01197              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 MBKCS126
01198              MOVE SPACES       TO  ANAVCMDO                       MBKCS126
01199                                    ANAVKEYO                       MBKCS126
01200              IF  MB126-ADD-FUNCTION                               MBKCS126
01201                  MOVE LOW-VALUES TO  MB126-LAST-AREA              MBKCS126
01202                  MOVE DP015-GREEN                                 MBKCS126
01203                                 TO  AAPLSYSC                      MBKCS126
01204                  MOVE DP015-UNDERLINE                             MBKCS126
01205                                 TO  AAPLSYSH                      MBKCS126
01206                  PERFORM 3400-MOVE-COMMAREA-TO-SCREEN             MBKCS126
01207              ELSE                                                 MBKCS126
01208                  MOVE MB126-LAST-APLSYS-CODE                      MBKCS126
01209                                TO  APLSYS-CDE                     MBKCS126
01210                  SET PS-SAVE-DATA                                 MBKCS126
01211                                TO  TRUE                           MBKCS126
01212                  MOVE PC-COMPANY                                  MBKCS126
01213                                TO  AOPERCOO                       MBKCS126
01214                  PERFORM 2100-RETRIEVE-DATA-FOR-PANEL             MBKCS126
01215              END-IF                                               MBKCS126
01216              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01217 *                                                                 MBKCS126
01218 *    "NEXT" PROCESSING - POSITION TO NEXT BUSINESS GROUP          MBKCS126
01219 *                                                                 MBKCS126
01220          WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              MBKCS126
01221              IF  MB126-ADD-FUNCTION                               MBKCS126
01222                  MOVE PC-TSYMSG-00045                             MBKCS126
01223                                TO  DP020-MSG-NUMBER               MBKCS126
01224                  SET DP020-MSG-FATAL                              MBKCS126
01225                                TO  TRUE                           MBKCS126
01226                  MOVE -1       TO  ANAVCMDL                       MBKCS126
01227              ELSE                                                 MBKCS126
01228                  PERFORM 2160-GET-NEXT-APLSYS                     MBKCS126
01229              END-IF                                               MBKCS126
01230              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01231 *                                                                 MBKCS126
01232          WHEN DP020-SRC-AID = DP016-PA2                           MBKCS126
01233              PERFORM DP009-0000-LOAD-FK-LINES                     MBKCS126
01234              PERFORM DP017-0000-GET-CURR-DATE-TIME                MBKCS126
01235              SET PS-SEND-DATA-ONLY                                MBKCS126
01236                                TO  TRUE                           MBKCS126
01237              MOVE -1           TO  ANAVCMDL                       MBKCS126
01238              PERFORM DP008-0000-WRITE-PANEL                       MBKCS126
01239 *                                                                 MBKCS126
01240          WHEN DP020-FK-RETURN(DP020-SRC-AID)                      MBKCS126
01241               PERFORM 4000-NAVIGATE                               MBKCS126
01242 *                                                                 MBKCS126
01243          WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                  MBKCS126
01244               PERFORM 4000-NAVIGATE                               MBKCS126
01245 *                                                                 MBKCS126
01246          WHEN DP020-SRC-AID = DP016-ENTER                         MBKCS126
01247              IF  DP020-NAV-MNEMONIC GREATER THAN SPACES           MBKCS126
01248                  PERFORM 4000-NAVIGATE                            MBKCS126
01249              ELSE                                                 MBKCS126
01250                  IF  MB126-DELETE-FUNCTION                        MBKCS126
01251                      CONTINUE                                     MBKCS126
01252                  ELSE                                             MBKCS126
01253                      PERFORM 3300-EDIT-DATA-IN-COMMAREA           MBKCS126
01254                  END-IF                                           MBKCS126
01255                  PERFORM 2200-DISPLAY-PANEL                       MBKCS126
01256              END-IF                                               MBKCS126
01257 *                                                                 MBKCS126
01258 *    ADD FUNCTION                                                 MBKCS126
01259 *                                                                 MBKCS126
01260          WHEN DP020-SRC-AID = DP016-PF13                          MBKCS126
01261              IF  MB126-ADD-FUNCTION                               MBKCS126
01262                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01263                  IF  PS-CONTINUE                                  MBKCS126
01264                      PERFORM 2120-ADD-APLSYS                      MBKCS126
01265                      IF  MB126-ADD-VSAM-RECORD                    MBKCS126
01266                          PERFORM 2180-WRITE-BATCH-CONTROL         MBKCS126
01267                          MOVE SPACES                                 CL**4
01268                                TO  MB126-LAST-AREA                   CL**4
01269                      END-IF                                       MBKCS126
01270                  END-IF                                           MBKCS126
01271              ELSE                                                 MBKCS126
01272                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01273                  MOVE PC-TSYMSG-00045                             MBKCS126
01274                                TO  DP020-MSG-NUMBER               MBKCS126
01275                  SET DP020-MSG-FATAL                              MBKCS126
01276                                TO  TRUE                           MBKCS126
01277                  MOVE -1       TO  ANAVCMDL                       MBKCS126
01278              END-IF                                               MBKCS126
01279              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01280 *                                                                 MBKCS126
01281 *    UPDATE FUNCTION                                              MBKCS126
01282 *                                                                 MBKCS126
01283          WHEN DP020-SRC-AID = DP016-PF15                          MBKCS126
01284              IF  MB126-UPDATE-FUNCTION                            MBKCS126
01285                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01286                  IF  PS-CONTINUE                                  MBKCS126
01287                      PERFORM 2140-UPDATE-APLSYS                   MBKCS126
01288                  END-IF                                           MBKCS126
01289              ELSE                                                 MBKCS126
01290                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01291                  MOVE PC-TSYMSG-00045                             MBKCS126
01292                                TO  DP020-MSG-NUMBER               MBKCS126
01293                  SET DP020-MSG-FATAL                              MBKCS126
01294                                TO  TRUE                           MBKCS126
01295                  MOVE -1       TO  ANAVCMDL                       MBKCS126
01296              END-IF                                               MBKCS126
01297              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01298 *                                                                 MBKCS126
01299 *    DELETE FUNCTION                                              MBKCS126
01300 *                                                                 MBKCS126
01301          WHEN DP020-SRC-AID = DP016-PF16                          MBKCS126
01302              IF  MB126-DELETE-FUNCTION                            MBKCS126
01303                  SET MB126-CAN-CONFIRM                            MBKCS126
01304                                TO  TRUE                           MBKCS126
01305                  MOVE MB126-LAST-APLSYS-CODE                      MBKCS126
01306                                TO  APLSYS-CDE                     MBKCS126
01307                  SET PS-DONT-SAVE-DATA                            MBKCS126
01308                                TO  TRUE                           MBKCS126
01309                  PERFORM 2100-RETRIEVE-DATA-FOR-PANEL             MBKCS126
01310                  IF  SQLCODE EQUAL ZERO                           MBKCS126
01311                      PERFORM 2170-APPLICATION-CHECK               MBKCS126
01312                  END-IF                                           MBKCS126
01313              ELSE                                                 MBKCS126
01314                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01315                  MOVE PC-TSYMSG-00045                             MBKCS126
01316                                TO  DP020-MSG-NUMBER               MBKCS126
01317                  SET DP020-MSG-FATAL                              MBKCS126
01318                                TO  TRUE                           MBKCS126
01319                  MOVE -1       TO  ANAVCMDL                       MBKCS126
01320              END-IF                                               MBKCS126
01321              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01322 *                                                                 MBKCS126
01323          WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     MBKCS126
01324              IF  MB126-DELETE-FUNCTION                            MBKCS126
01325                  IF  MB126-CAN-CONFIRM                            MBKCS126
01326 *                    PERFORM 2170-APPLICATION-CHECK               MBKCS126
01327 *                    IF  PS-CONTINUE                              MBKCS126
01328                          PERFORM 2135-DELETE-APLAVL               MBKCS126
01329                          PERFORM 2130-DELETE-APLSYS               MBKCS126
01330                          PERFORM 2190-DELETE-BATCH-CONTROL        MBKCS126
01331 *                    END-IF                                       MBKCS126
01332                  ELSE                                             MBKCS126
01333                      MOVE PC-TSYMSG-00118                         MBKCS126
01334                                TO  DP020-MSG-NUMBER               MBKCS126
01335                      SET DP020-MSG-FATAL                          MBKCS126
01336                                TO  TRUE                           MBKCS126
01337                      MOVE -1   TO  ANAVCMDL                       MBKCS126
01338                  END-IF                                           MBKCS126
01339              ELSE                                                 MBKCS126
01340                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS126
01341                  MOVE PC-TSYMSG-00045                             MBKCS126
01342                                TO  DP020-MSG-NUMBER               MBKCS126
01343                  SET DP020-MSG-FATAL                              MBKCS126
01344                                TO  TRUE                           MBKCS126
01345                  MOVE -1       TO  ANAVCMDL                       MBKCS126
01346              END-IF                                               MBKCS126
01347              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01348 *                                                                 MBKCS126
01349          WHEN OTHER                                               MBKCS126
01350              PERFORM 3300-EDIT-DATA-IN-COMMAREA                   MBKCS126
01351              MOVE PC-TSYMSG-00045                                 MBKCS126
01352                                TO  DP020-MSG-NUMBER               MBKCS126
01353              SET DP020-MSG-FATAL                                  MBKCS126
01354                                TO  TRUE                           MBKCS126
01355              MOVE -1           TO  ANAVCMDL                       MBKCS126
01356              PERFORM 2200-DISPLAY-PANEL                           MBKCS126
01357      END-EVALUATE.                                                MBKCS126
01358 *                                                                 MBKCS126
01359  EJECT                                                            MBKCS126
01360 ******************************************************************MBKCS126
01361 *    HERE WE MOVE THE DATA FROM THE SCREEN TO THE COMMAREA.  THEN,MBKCS126
01362 *    INVOKE THE EDIT ROUTINE, 3300.                               MBKCS126
01363 *                                                                 MBKCS126
01364 *    PERFORMED BY 3000                                            MBKCS126
01365 ******************************************************************MBKCS126
01366 *                                                                 MBKCS126
01367  3200-MOVE-SCREEN-TO-COMMAREA.                                    MBKCS126
01368 *                                                                 MBKCS126
01369      IF (AAPLPRTL GREATER THAN ZERO                               MBKCS126
01370      OR  AAPLPRTA EQUAL PC-ERASE-EOF)                             MBKCS126
01371          MOVE AAPLPRTI         TO  MB126-LAST-PRNT-APLSYS-CODE    MBKCS126
01372      END-IF.                                                      MBKCS126
01373 *                                                                 MBKCS126
01374      IF (AMDSINDL GREATER THAN ZERO                               MBKCS126
01375      OR  AMDSINDA EQUAL PC-ERASE-EOF)                             MBKCS126
01376          MOVE AMDSINDI         TO  MB126-LAST-MDSE-IND            MBKCS126
01377      END-IF.                                                      MBKCS126
01378 *                                                                 MBKCS126
01379      IF (AAPLDESL GREATER THAN ZERO                               MBKCS126
01380      OR  AAPLDESA EQUAL PC-ERASE-EOF)                             MBKCS126
01381          MOVE AAPLDESI         TO  MB126-LAST-APLSYS-DESC         MBKCS126
01382      END-IF.                                                      MBKCS126
01383 *                                                                 MBKCS126
01384      IF (AAPLSYSL GREATER THAN ZERO                               MBKCS126
01385      OR  AAPLSYSA EQUAL PC-ERASE-EOF)                             MBKCS126
01386          MOVE AAPLSYSI         TO  MB126-LAST-APLSYS-CODE         MBKCS126
01387      END-IF.                                                      MBKCS126
01388 *                                                                 MBKCS126
01389      IF (ALIKESYL GREATER THAN ZERO                               MBKCS126
01390      OR  ALIKESYA EQUAL PC-ERASE-EOF)                             MBKCS126
01391          MOVE ALIKESYI         TO  MB126-LAST-LIKE-SYSTEM         MBKCS126
01392      END-IF.                                                      MBKCS126
01393 *                                                                 MBKCS126
01394      IF (ASTRTMML GREATER THAN ZERO                               MBKCS126
01395      OR  ASTRTMMA EQUAL PC-ERASE-EOF)                             MBKCS126
01396          MOVE ASTRTMMI         TO  MB126-LAST-START-MM            MBKCS126
01397      END-IF.                                                      MBKCS126
01398 *                                                                 MBKCS126
01399      IF (ASTRTDDL GREATER THAN ZERO                               MBKCS126
01400      OR  ASTRTDDA EQUAL PC-ERASE-EOF)                             MBKCS126
01401          MOVE ASTRTDDI         TO  MB126-LAST-START-DD            MBKCS126
01402      END-IF.                                                      MBKCS126
01403 *                                                                 MBKCS126
01404      IF (ASTRTYYL GREATER THAN ZERO                               MBKCS126
01405      OR  ASTRTYYA EQUAL PC-ERASE-EOF)                             MBKCS126
01406          MOVE ASTRTYYI         TO  MB126-LAST-START-YY            MBKCS126
01407      END-IF.                                                      MBKCS126
01408 *                                                                 MBKCS126
01409  EJECT                                                            MBKCS126
01410 ******************************************************************MBKCS126
01411 *    VALIDATE THE FIELDS HERE.                                    MBKCS126
01412 *                                                                 MBKCS126
01413 *    PERFORMED BY 3000, 3100.                                     MBKCS126
01414 ******************************************************************MBKCS126
01415 *                                                                 MBKCS126
01416  3300-EDIT-DATA-IN-COMMAREA.                                      MBKCS126
01417 *                                                                 MBKCS126
01418 *    LIKE SYSTEM VALIDATION                                       MBKCS126
01419 *                                                                 MBKCS126
01420      IF  MB126-ADD-FUNCTION                                       MBKCS126
01421          MOVE DP015-GREEN      TO  ASTRTYYC                       MBKCS126
01422                                    ASTRTMMC                       MBKCS126
01423                                    ASTRTDDC                       MBKCS126
01424                                    ALIKESYC                       MBKCS126
01425          MOVE DP015-UNDERLINE  TO  ASTRTYYH                       MBKCS126
01426                                    ASTRTMMH                       MBKCS126
01427                                    ASTRTDDH                       MBKCS126
01428                                    ALIKESYH                       MBKCS126
01429          MOVE SPACES           TO  MB126-LAST-LIKE-DESC           MBKCS126
01430                                    ALIKEDEO                       MBKCS126
01431          IF  MB126-ADD-VSAM-RECORD                                MBKCS126
01432              PERFORM 3310-DATE-VALIDATION                         MBKCS126
01433              MOVE MB126-LAST-LIKE-SYSTEM                          MBKCS126
01434                                TO  APLSYS-CDE                     MBKCS126
01435              SET PS-DONT-SAVE-DATA                                MBKCS126
01436                                TO      TRUE                       MBKCS126
01437              PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                 MBKCS126
01438 *                                                                 MBKCS126
01439              IF  SQLCODE EQUAL ZERO                               MBKCS126
01440                  MOVE APLSYS-DESC                                 MBKCS126
01441                                TO  MB126-LAST-LIKE-DESC           MBKCS126
01442                                    ALIKEDEO                       MBKCS126
01443              ELSE                                                 MBKCS126
01444                  MOVE DP015-RED                                   MBKCS126
01445                                TO  ALIKESYC                       MBKCS126
01446                  MOVE DP015-REVERSE                               MBKCS126
01447                                TO  ALIKESYH                       MBKCS126
01448                  MOVE -1       TO  ALIKESYL                       MBKCS126
01449                  SET DP020-MSG-FATAL                              MBKCS126
01450                                TO  TRUE                           MBKCS126
01451                  SET PS-DONT-PROCESS                              MBKCS126
01452                                TO  TRUE                           MBKCS126
01453                  MOVE PC-TSYMSG-00005                             MBKCS126
01454                                TO  DP020-MSG-NUMBER               MBKCS126
01455              END-IF                                               MBKCS126
01456          END-IF                                                   MBKCS126
01457      END-IF.                                                      MBKCS126
01458 *                                                                 MBKCS126
01459 *    PARENT SYSTEM VALIDATION                                     MBKCS126
01460 *                                                                 MBKCS126
01461      IF  MB126-LAST-PRNT-APLSYS-CODE EQUAL MB126-LAST-APLSYS-CODE MBKCS126
01462          CONTINUE                                                 MBKCS126
01463      ELSE                                                         MBKCS126
01464          MOVE MB126-LAST-PRNT-APLSYS-CODE                         MBKCS126
01465                                TO  APLSYS-CDE                     MBKCS126
01466          SET PS-DONT-SAVE-DATA TO  TRUE                           MBKCS126
01467          PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                     MBKCS126
01468 *                                                                 MBKCS126
01469          IF  SQLCODE EQUAL ZERO                                   MBKCS126
01470              MOVE DP015-GREEN  TO  AAPLPRTC                       MBKCS126
01471              MOVE DP015-UNDERLINE                                 MBKCS126
01472                                TO  AAPLPRTH                       MBKCS126
01473              MOVE APLSYS-DESC  TO  MB126-LAST-PRNT-APLSYS-DESC    MBKCS126
01474                                    APRTDESO                       MBKCS126
01475          ELSE                                                     MBKCS126
01476              MOVE DP015-RED    TO  AAPLPRTC                       MBKCS126
01477              MOVE DP015-REVERSE                                   MBKCS126
01478                                TO  AAPLPRTH                       MBKCS126
01479              MOVE -1           TO  AAPLPRTL                       MBKCS126
01480              SET DP020-MSG-FATAL                                  MBKCS126
01481                                TO  TRUE                           MBKCS126
01482              SET PS-DONT-PROCESS                                  MBKCS126
01483                                TO  TRUE                           MBKCS126
01484              MOVE PC-TSYMSG-00005                                 MBKCS126
01485                                TO  DP020-MSG-NUMBER               MBKCS126
01486          END-IF                                                   MBKCS126
01487      END-IF.                                                      MBKCS126
01488 *                                                                 MBKCS126
01489 *    MERCHANDISE INDICATOR VALIDATION                             MBKCS126
01490 *                                                                 MBKCS126
01491      IF  MB126-LAST-MDSE-IND EQUAL PC-Y OR PC-N                   MBKCS126
01492          MOVE DP015-GREEN      TO  AMDSINDC                       MBKCS126
01493          MOVE DP015-UNDERLINE  TO  AMDSINDH                       MBKCS126
01494          IF  NOT MB126-ADD-VSAM-RECORD                            MBKCS126
01495 *                                                                 MBKCS126
01496              IF  MB126-LAST-LIKE-SYSTEM GREATER THAN SPACES       MBKCS126
01497                  MOVE DP015-RED                                   MBKCS126
01498                                TO  ALIKESYC                       MBKCS126
01499                                    AMDSINDC                       MBKCS126
01500                  MOVE DP015-REVERSE                               MBKCS126
01501                                TO  ALIKESYH                       MBKCS126
01502                                    AMDSINDH                       MBKCS126
01503                  MOVE -1       TO  ALIKESYL                       MBKCS126
01504                  SET DP020-MSG-FATAL                              MBKCS126
01505                                TO  TRUE                           MBKCS126
01506                  SET PS-DONT-PROCESS                              MBKCS126
01507                                TO  TRUE                           MBKCS126
01508                  MOVE PC-TSYMSG-00209                             MBKCS126
01509                                TO  DP020-MSG-NUMBER               MBKCS126
01510              END-IF                                               MBKCS126
01511 *                                                                 MBKCS126
01512              IF (MB126-LAST-START-YY NUMERIC                      MBKCS126
01513              OR  MB126-LAST-START-MM NUMERIC                      MBKCS126
01514              OR  MB126-LAST-START-DD NUMERIC)                     MBKCS126
01515                  MOVE DP015-RED                                   MBKCS126
01516                                TO  ASTRTYYC                       MBKCS126
01517                                    ASTRTMMC                       MBKCS126
01518                                    ASTRTDDC                       MBKCS126
01519                                    AMDSINDC                       MBKCS126
01520                  MOVE DP015-REVERSE                               MBKCS126
01521                                TO  ASTRTYYH                       MBKCS126
01522                                    ASTRTMMH                       MBKCS126
01523                                    ASTRTDDH                       MBKCS126
01524                                    AMDSINDH                       MBKCS126
01525                  MOVE -1       TO  ASTRTYYL                       MBKCS126
01526                  SET DP020-MSG-FATAL                              MBKCS126
01527                                TO  TRUE                           MBKCS126
01528                  SET PS-DONT-PROCESS                              MBKCS126
01529                                TO  TRUE                           MBKCS126
01530                  MOVE PC-TSYMSG-00209                             MBKCS126
01531                                TO  DP020-MSG-NUMBER               MBKCS126
01532              END-IF                                               MBKCS126
01533          END-IF                                                   MBKCS126
01534      ELSE                                                         MBKCS126
01535          MOVE DP015-RED        TO  AMDSINDC                       MBKCS126
01536          MOVE DP015-REVERSE    TO  AMDSINDH                       MBKCS126
01537          MOVE -1               TO  AMDSINDL                       MBKCS126
01538          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
01539          SET PS-DONT-PROCESS   TO  TRUE                           MBKCS126
01540          MOVE PC-TSYMSG-00005  TO  DP020-MSG-NUMBER               MBKCS126
01541      END-IF.                                                      MBKCS126
01542 *                                                                 MBKCS126
01543 *    APPLICATION DESCRIPTION VALIDATION                           MBKCS126
01544 *                                                                 MBKCS126
01545      IF  MB126-LAST-APLSYS-DESC GREATER THAN SPACES               MBKCS126
01546          MOVE DP015-GREEN      TO  AAPLDESC                       MBKCS126
01547          MOVE DP015-UNDERLINE  TO  AAPLDESH                       MBKCS126
01548      ELSE                                                         MBKCS126
01549          MOVE DP015-RED        TO  AAPLDESC                       MBKCS126
01550          MOVE DP015-REVERSE    TO  AAPLDESH                       MBKCS126
01551          MOVE -1               TO  AAPLDESL                       MBKCS126
01552          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
01553          SET PS-DONT-PROCESS   TO  TRUE                           MBKCS126
01554          MOVE PC-TSYMSG-00007  TO  DP020-MSG-NUMBER               MBKCS126
01555      END-IF.                                                      MBKCS126
01556 *                                                                 MBKCS126
01557      IF  MB126-ADD-FUNCTION                                       MBKCS126
01558          MOVE DP015-GREEN      TO  AAPLSYSC                       MBKCS126
01559          MOVE DP015-UNDERLINE  TO  AAPLSYSH                       MBKCS126
01560          IF  MB126-LAST-APLSYS-CODE NOT GREATER THAN SPACES       MBKCS126
01561              MOVE DP015-RED    TO  AAPLSYSC                       MBKCS126
01562              MOVE DP015-REVERSE                                   MBKCS126
01563                                TO  AAPLSYSH                       MBKCS126
01564              MOVE -1           TO  AAPLSYSL                       MBKCS126
01565              SET DP020-MSG-FATAL                                  MBKCS126
01566                                TO  TRUE                           MBKCS126
01567              SET PS-DONT-PROCESS                                  MBKCS126
01568                                TO  TRUE                           MBKCS126
01569              MOVE PC-TSYMSG-00007                                 MBKCS126
01570                                TO  DP020-MSG-NUMBER               MBKCS126
01571          ELSE                                                     MBKCS126
01572              MOVE MB126-LAST-APLSYS-CODE                          MBKCS126
01573                                TO  APLSYS-CDE                     MBKCS126
01574              SET PS-DONT-SAVE-DATA                                MBKCS126
01575                                TO  TRUE                           MBKCS126
01576              PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                 MBKCS126
01577              IF  SQLCODE EQUAL ZERO                               MBKCS126
01578                  MOVE DP015-RED                                   MBKCS126
01579                                TO  AAPLSYSC                       MBKCS126
01580                  MOVE DP015-REVERSE                               MBKCS126
01581                                TO  AAPLSYSH                       MBKCS126
01582                  MOVE -1       TO  AAPLSYSL                       MBKCS126
01583                  SET DP020-MSG-FATAL                              MBKCS126
01584                                TO  TRUE                           MBKCS126
01585                  SET PS-DONT-PROCESS                              MBKCS126
01586                                TO  TRUE                           MBKCS126
01587                  MOVE PC-TSYMSG-00117                             MBKCS126
01588                                TO  DP020-MSG-NUMBER               MBKCS126
01589              END-IF                                               MBKCS126
01590          END-IF                                                   MBKCS126
01591      END-IF.                                                      MBKCS126
01592 *                                                                 MBKCS126
01593  EJECT                                                            MBKCS126
01594 ******************************************************************MBKCS126
01595 *    FIRST, ENSURE THE DATE IS NUMERIC, THEN INVOKE THE DATE      MBKCS126
01596 *    VALIDATION SUBROUTINE.                                       MBKCS126
01597 *                                                                 MBKCS126
01598 *    PERFORMED BY 3300                                            MBKCS126
01599 ******************************************************************MBKCS126
01600 *                                                                 MBKCS126
01601  3310-DATE-VALIDATION.                                            MBKCS126
01602 *                                                                 MBKCS126
01603      IF  MB126-LAST-START-YY NOT NUMERIC                          MBKCS126
01604          MOVE DP015-RED        TO  ASTRTYYC                       MBKCS126
01605          MOVE DP015-REVERSE    TO  ASTRTYYH                       MBKCS126
01606          MOVE -1               TO  ASTRTYYL                       MBKCS126
01607          MOVE PC-TSYMSG-00008  TO  DP020-MSG-NUMBER               MBKCS126
01608          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
01608          SET PS-DONT-PROCESS   TO  TRUE                           MBKCS126
01609      END-IF.                                                      MBKCS126
01610 *                                                                 MBKCS126
01611      IF  MB126-LAST-START-DD NOT NUMERIC                          MBKCS126
01612          MOVE DP015-RED        TO  ASTRTDDC                       MBKCS126
01613          MOVE DP015-REVERSE    TO  ASTRTDDH                       MBKCS126
01614          MOVE -1               TO  ASTRTDDL                       MBKCS126
01615          MOVE PC-TSYMSG-00008  TO  DP020-MSG-NUMBER               MBKCS126
01616          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
01608          SET PS-DONT-PROCESS   TO  TRUE                           MBKCS126
01617      END-IF.                                                      MBKCS126
01618 *                                                                 MBKCS126
01619      IF  MB126-LAST-START-MM NOT NUMERIC                          MBKCS126
01620          MOVE DP015-RED        TO  ASTRTMMC                       MBKCS126
01621          MOVE DP015-REVERSE    TO  ASTRTMMH                       MBKCS126
01622          MOVE -1               TO  ASTRTMML                       MBKCS126
01623          MOVE PC-TSYMSG-00008  TO  DP020-MSG-NUMBER               MBKCS126
01624          SET DP020-MSG-FATAL   TO  TRUE                           MBKCS126
01608          SET PS-DONT-PROCESS   TO  TRUE                           MBKCS126
01625      END-IF.                                                      MBKCS126
01626 *                                                                 MBKCS126
01627      IF  NOT DP020-MSG-FATAL                                      MBKCS126
                                                                                
               INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56              
                                                                                
01632          MOVE MB126-LAST-START-YY   TO  PV-WD-YY                  MBKCS126
01664                                         DPG52-GREG-DATE-YR-X      MBKCS126
01628          MOVE MB126-LAST-START-MM   TO  PV-WD-MM                  MBKCS126
01664                                         DPG52-GREG-DATE-MO-X      MBKCS126
01630          MOVE MB126-LAST-START-DD   TO  PV-WD-DD                  MBKCS126
01664                                         DPG52-GREG-DATE-DY-X      MBKCS126
                                                                                
               SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE                         
               SET DPG52-LK-DTE-GREG            TO TRUE                         
                                                                                
               CALL  DP500-KOHLS-CALENDAR-ROUTINE                               
                     USING DPG51, DPG52, DPG53, DPG54, DPG55, DPG56             
                                                                                
               IF DPG54-NO-ERROR                                                
                   MOVE DPG55-JULIAN-CC-DATE-CC-X                               
01671                                    TO MB126-LAST-START-CC                 
01672                                       PV-WD-CC                            
01673          ELSE                                                     MBKCS126
01674              MOVE DP015-RED        TO  ASTRTDDC                   MBKCS126
01675                                        ASTRTMMC                   MBKCS126
01676                                        ASTRTYYC                   MBKCS126
01677              MOVE DP015-REVERSE    TO  ASTRTDDH                   MBKCS126
01679                                        ASTRTMMH                   MBKCS126
01680                                        ASTRTYYH                   MBKCS126
01681              MOVE -1               TO  ASTRTMML                   MBKCS126
01682              MOVE PC-TSYMSG-00009  TO  DP020-MSG-NUMBER           MBKCS126
01684              SET DP020-MSG-FATAL   TO  TRUE                       MBKCS126
01608              SET PS-DONT-PROCESS   TO  TRUE                       MBKCS126
01686          END-IF                                                   MBKCS126
01634 *                                                                 MBKCS126
01635          PERFORM DP017-0000-GET-CURR-DATE-TIME                    MBKCS126
01636          IF  PV-WORK-DATE < DP017-CURRENT-DATE-YYYYMMDD           MBKCS126
01637              MOVE PC-TSYMSG-00067  TO  DP020-MSG-NUMBER           MBKCS126
01639              SET DP020-MSG-FATAL   TO  TRUE                       MBKCS126
01608              SET PS-DONT-PROCESS   TO  TRUE                       MBKCS126
01641          ELSE                                                     MBKCS126
01642              ADD 1             TO  DP017-CURRENT-YMD-YYYY         MBKCS126
01643              IF  PV-WORK-DATE > DP017-CURRENT-DATE-YYYYMMDD       MBKCS126
01644                  MOVE PC-TSYMSG-00025  TO  DP020-MSG-NUMBER       MBKCS126
01639                  SET DP020-MSG-FATAL   TO  TRUE                   MBKCS126
01608                  SET PS-DONT-PROCESS   TO  TRUE                   MBKCS126
01648              END-IF                                               MBKCS126
01642              SUBTRACT 1      FROM  DP017-CURRENT-YMD-YYYY         MBKCS126
01649          END-IF                                                   MBKCS126
01650 *                                                                 MBKCS126
01651          IF  DP020-MSG-FATAL                                      MBKCS126
01652              MOVE DP015-RED    TO  ASTRTDDC                       MBKCS126
01653                                    ASTRTMMC                       MBKCS126
01654                                    ASTRTYYC                       MBKCS126
01655              MOVE DP015-REVERSE                                   MBKCS126
01656                                TO  ASTRTDDH                       MBKCS126
01657                                    ASTRTMMH                       MBKCS126
01658                                    ASTRTYYH                       MBKCS126
01659              MOVE -1           TO  ASTRTMML                       MBKCS126
01660          END-IF                                                   MBKCS126
01661      END-IF.                                                      MBKCS126
01662 *                                                                 MBKCS126
01689  EJECT                                                            MBKCS126
01690 ******************************************************************MBKCS126
01691 *    LOAD THE DATA TO THE SCREEN FROM THE COMM AREA.              MBKCS126
01692 *                                                                 MBKCS126
01693 *    PERFORMED BY 2000, 2160.                                     MBKCS126
01694 ******************************************************************MBKCS126
01695 *                                                                 MBKCS126
01696  3400-MOVE-COMMAREA-TO-SCREEN.                                    MBKCS126
01697 *                                                                 MBKCS126
01698      MOVE MB126-LAST-APLSYS-DESC                                  MBKCS126
01699                                TO  AAPLDESO.                      MBKCS126
01700      MOVE MB126-LAST-APLSYS-CODE                                  MBKCS126
01701                                TO  AAPLSYSO.                      MBKCS126
01702      MOVE MB126-LAST-PRNT-APLSYS-DESC                             MBKCS126
01703                                TO  APRTDESO.                      MBKCS126
01704      MOVE MB126-LAST-PRNT-APLSYS-CODE                             MBKCS126
01705                                TO  AAPLPRTO.                      MBKCS126
01706      MOVE MB126-LAST-MDSE-IND                                     MBKCS126
01707                                TO  AMDSINDO.                      MBKCS126
01708 *                                                                 MBKCS126
01709      MOVE MB126-LAST-LIKE-SYSTEM                                  MBKCS126
01710                                TO  ALIKESYO.                      MBKCS126
01711      MOVE MB126-LAST-LIKE-DESC TO  ALIKEDEO.                      MBKCS126
01712      MOVE MB126-LAST-START-MM  TO  ASTRTMMO.                      MBKCS126
01713      MOVE MB126-LAST-START-DD  TO  ASTRTDDO.                      MBKCS126
01714      MOVE MB126-LAST-START-YY  TO  ASTRTYYO.                      MBKCS126
01715      MOVE PC-COMPANY           TO  AOPERCOO.                      MBKCS126
01716 *                                                                 MBKCS126
01717  EJECT                                                            MBKCS126
01718 ******************************************************************MBKCS126
01719 *    IF THE USER HITS A KEY THAT REQUIRES US TO GO TO ANOTHER     MBKCS126
01720 *    TRANSACTION, SAVE THE INTER APPLICATION COMMUNICATIONS AREA  MBKCS126
01721 *    AND START THE NAVIGATOR.                                     MBKCS126
01722 *                                                                 MBKCS126
01723 *    PERFORMED BY 3000                                            MBKCS126
01724 ******************************************************************MBKCS126
01725 *                                                                 MBKCS126
01726  4000-NAVIGATE.                                                   MBKCS126
01727 *                                                                 MBKCS126
01728      COMPUTE MB005-NUMBER-PROCESSED-ITEMS =                       MBKCS126
01729            ((MB126-AS-ITEM - 1) * MBWS125-MAX-APLSYS-CODES)       MBKCS126
01730            + MB126-AS-SUB.                                        MBKCS126
01731 *                                                                 MBKCS126
01732      MOVE MB005-INTER-APPL-COMMAREA                               MBKCS126
01733                                TO  MB126-SAVE-INTER-APPL-COMMAREA.MBKCS126
01734      PERFORM DP015-1000-START-NAVIGATOR.                          MBKCS126
01735 *                                                                 MBKCS126
01736  EJECT                                                            MBKCS126
01737 ******************************************************************MBKCS126
01738 *    ENSURE THIS PROGRAM WAS ENTERED PROPERLY.                    MBKCS126
01739 *                                                                 MBKCS126
01740 *    PERFORMED BY 1000                                            MBKCS126
01741 ******************************************************************MBKCS126
01742 *                                                                 MBKCS126
01743  4100-VALIDATE-COMMAREA.                                          MBKCS126
01744 *                                                                 MBKCS126
01745      IF  DP020-MB-APPL-SYS-LIST                                   MBKCS126
01746          SET PS-INTER-APPL-VALID                                  MBKCS126
01747                                TO  TRUE                           MBKCS126
01748      ELSE                                                         MBKCS126
01749          SET PS-INTER-APPL-NOT-VALID                              MBKCS126
01750                                TO  TRUE                           MBKCS126
01751      END-IF.                                                      MBKCS126
01752 *                                                                 MBKCS126
01753  EJECT                                                            MBKCS126
01754 ******************************************************************MBKCS126
01755 *    FILL IN SCREEN HEADER MODULE                                 MBKCS126
01756 ******************************************************************MBKCS126
01757                                                                   MBKCS126
01758      COPY DPPD002.                                                MBKCS126
01759  EJECT                                                            MBKCS126
01760 ******************************************************************MBKCS126
01761 *    RETURN TO CICS MODULE                                        MBKCS126
01762 ******************************************************************MBKCS126
01763                                                                   MBKCS126
01764      COPY DPPD003.                                                MBKCS126
01765  EJECT                                                            MBKCS126
01766 ******************************************************************MBKCS126
01767 *    FORMAT MESSAGE LINES MODULE                                  MBKCS126
01768 ******************************************************************MBKCS126
01769                                                                   MBKCS126
01770      COPY DPPD005.                                                MBKCS126
01771  EJECT                                                            MBKCS126
01772 ******************************************************************MBKCS126
01773 *    GET PANEL MODULE                                             MBKCS126
01774 ******************************************************************MBKCS126
01775                                                                   MBKCS126
01776      COPY DPPD007.                                                MBKCS126
01777  EJECT                                                            MBKCS126
01778 ******************************************************************MBKCS126
01779 *    WRITE PANEL MODULE                                           MBKCS126
01780 ******************************************************************MBKCS126
01781                                                                   MBKCS126
01782      COPY DPPD008.                                                MBKCS126
01783  EJECT                                                            MBKCS126
01784 ******************************************************************MBKCS126
01785 *    TOGGLE THE FUNCTION KEY LINE MODULE                          MBKCS126
01786 ******************************************************************MBKCS126
01787                                                                   MBKCS126
01788      COPY DPPD009.                                                MBKCS126
01789  EJECT                                                            MBKCS126
01790 ******************************************************************MBKCS126
01791 *    ABEND PROCESSOR MODULE                                       MBKCS126
01792 ******************************************************************MBKCS126
01793                                                                   MBKCS126
01794      COPY DPPD013.                                                MBKCS126
01795  EJECT                                                            MBKCS126
01796 ******************************************************************MBKCS126
01797 *    CHECK COMMUNICATION AREA MODULE                              MBKCS126
01798 ******************************************************************MBKCS126
01799                                                                   MBKCS126
01800      COPY DPPD015.                                                MBKCS126
01801  EJECT                                                            MBKCS126
01802 ******************************************************************MBKCS126
01803 *    UPDATE TIME AND DATE MODULE                                  MBKCS126
01804 ******************************************************************MBKCS126
01805                                                                   MBKCS126
01806      COPY DPPD017.                                                MBKCS126
01807  EJECT                                                            MBKCS126
