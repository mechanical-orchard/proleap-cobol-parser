000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKCS010.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  07/08/93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - V010                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100000
001100*    DESCRIPTION - VENDOR ADDRESS/REP MAINTENANCE               * 00110000
001200*    MAPSET      - VNKM010                                      * 00120000
001300*                                                               * 00130000
001400*    THIS SCREEN ALLOWS USERS TO MAINTAIN VENDOR ADDRESS AND REP* 00140000
001500*    INFORMATION FOR A SPECIFIC BUSINESS FUNCTION.              * 00150000
001600*    DATE 1/17/01 MODIFIED PROGRAM TO ALLOW FOR THE DATABASE    * 00160000
001700*                 AND BUSINESS RULE CHANGES BEING MADE FOR THE  * 00170000
001800*                 INTERFACE TO RMS SUPPLIER AND PARTNER DATABASE* 00180000
001900*    BY   L SCHALLHORN                       WR# 21278          * 00190000
002000*    DATE  04/19/2001                                           * 00200000
002100*        CHANGE MADE: CHANGE VNWS014 COPYBOOK AND VNKCS010 FOR  * 00210000
002200*   WHAT IS SENT TO PEOPLESOFT AS A PRIMARY VENDOR TYPE.        * 00220000
002300*        MADE BY: L SCHALLHORN                       WR# 21278  * 00230000
002400*                                                               * 00240000
002500*   02/10/2003                                                  * 00250000
002600*      CHANGED CALL TO PEOPLESOFT TABLE TO USE NEW ALIAS        * 00260000
002700*      NAMING STANDARD.                                         * 00270000
002800*   MADE BY: L SCHALLHORN                 WR#: 23417            * 00280000
002900*                                                               * 00290000
003000* DATE  05/27/2003                                              * 00300000
003100*     CHANGE MADE: VENDOR MULTI PRE-PACK USAGE PROJECT.         * 00310000
003200*     INCLUDED ENT-ID IN MOVES TO VNWS007 COPYBOOK FOR PARA-    * 00320000
003300*     GRAPHS 6100, 7100, 7200, AND 8040.  ADDED EDI-PO-PREPK-CDE* 00330000
003400*     TO CURSOR IN PARAGRAPH 7030 AND IN MOVES TO VNWS013 COPY- * 00340000
003500*     BOOK IN PARAGRAPH 6200.                                   * 00350000
003600*     MADE BY: KEVIN CATLIN            WR/IR #: WR24663         * 00360000
003700*                                                               * 00370000
003800* DATE  11/05/2003                                              * 00380000
003900*     CHANGE MADE: ADDED CODE TO MOVE THE 4 NEW COLUMN VALUES   * 00390000
004000*     FROM TEXTENT (GVRNG_IND, GVRNG_ENT_ID, CART_LBL_IND,      * 00400000
004100*     CART_LBL_EFF_DTE) TO THE RMS PO MESSAGE SETUPIN PARAS:    * 00410000
004200*     6200- & 7030-.                                            * 00420000
004300*     MADE BY: MIKE BESKE              WR/IR #: WR25358         * 00430000
004400*                                                               * 00440000
004500* DATE  08/24/2004                                              * 00450000
004600*     CHANGE MADE: CHANGED THE WHEN THE EXTENDED NAME IS        * 00460000
004700*     EDITTABLE FOR THE REMITTANCE ADDRESS.  IT SHOULD ONLY     * 00470000
004800*     BE EDITTABLE FOR THE CURRENT REMIT ADDRESS SEQUENCE       * 00480000
004900*     NUMBER THAT IS ON THE LOCATION PAGE IN PEOPLESOFT.        * 00490000
005000*     ADD A CALL TO PEOPLESOFT PS_VENDOR_LOC TO GET THE CURRENT * 00500000
005100*     REMIT ADDR SEQ NUMBER, OPEN EXTENDED NAME FOR THAT SEQ #. * 00510000
005200*     MADE BY: L SCHALLHORN            WR/IR #: P000686510      * 00520000
005300*                                                               * 00530000
005400* DATE  09/21/2004                                              * 00540000
005500*     CHANGE MADE: ENSURED THAT ONLY THE REMITTANCE FUNCTION    * 00550000
005600*     UPDATES WOULD USE PARAGRAPH 4340-GET-PS-REMIT-SEQ AND     * 00560000
005700*     SELECT FROM FI_VENDOR_LOC TABLE.  THIS WILL PREVENT THE   * 00570000
005800*     PROGRAM FROM ABENDING IF THE REMIT ADDRESS DOES NOT YET   * 00580000
005900*     EXIST AND A DIFFERENT ADDRESS IS BEING UPDATED.           * 00590000
006000*     MADE BY: KEVIN CATLIN            WR/IR #: P000694292      * 00600000
006100*                                                               * 00610000
006200* DATE  03/11/2005                                              * 00620000
006300*     CHANGE MADE: DELETED THE CODE THAT DELETED ROWS FROM THE  * 00630000
006400*     TENTREP TABLE.  THIS WAS DONE BECAUSE OF RI BEING IM-     * 00640000
006500*     PLEMENTED BETWEEN TENTREP AND TBUSLOC.                    * 00650000
006600*     MADE BY: MIKE BESKE              WR/IR #: WR25278         * 00660000
006700*                                                               * 00670000
006800* DATE  04/14/2005                                              * 00680000
006900*     CHANGE MADE: ADDED 2 NEW MESSAGES, AND LOGIC IN THE RETURN* 00690000
007000*     FROM CALLING VNKCS023 TO IDENTIFY THE FACT THAT THE       * 00700000
007100*     MAX NUMBER OF CAPABILITIES OR RELATIONSHIPS WAS EXCEEDED  * 00710000
007200*     WHEN SENDING A 'NEW VENDOR' MESSAGE TO RMS.               * 00720000
007300*     MADE BY: JACK KRAMER             WR/IR #: WR25278         * 00730000
007400*                                                               * 00740000
007500* DATE  07/21/2005                                              * 00750000
007600*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.    * 00760000
007700*     RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO       * 00770000
007800*     COPYBOOK VNWS013.                                         * 00780000
007900*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         * 00790000
008000*                                                               * 00800000
008100* DATE  03/24/2006                                              * 00810000
008200*     CHANGE MADE: VENDOR ALLOWANCE AUTOMATION PROJECT.         * 00820000
008300*     RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO       * 00830000
008400*     COPYBOOK VNWS007 AND VNWS013.                             * 00840000
008500*     MADE BY: MIKE BESKE              WR/IR #: WR30028         * 00850000
008600*                                                               * 00860000
008700* DATE  02/25/2008                                              * 00870000
008800*     CHANGE MADE: VENDOR MINORITY CERTIFICATIONS PROJECT.      * 00880000
008900*     RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO       * 00890000
009000*     COPYBOOK VNWS014.                                         * 00900000
009100*     MADE BY: MIKE BESKE              WR/IR #: WR33218         * 00910000
009200*                                                               * 00920000
009300* DATE  09/21/2011                                                00930000
009400*     CHANGE MADE: REMOVED DB2 SELECT OF PFI0006 AND PFI0013.     00940000
009500*     REPLACED WITH A CALL TO THE VNKUT034 MODULE.  THIS          00950000
009600*     IS NEEDED AS A RESULT OF THE PEOPLESOFT FI UPGRADE AND      00960000
009700*     RE-PLATFORM.                                                00970000
009800*     MADE BY: STEVE KRIEG             WR/IR #: WR37038           00980000
009900*                                                               * 00990000
010000*     CHANGE MADE: ADDED A CALL TO VNKUT040 TO COMMIT PS        * 01000000
010100*     ORACLE CHANGES.                                           * 01010000
010200*     MADE BY: MADHURA PETHE           WR/IR #: WR37038         * 01020000
010210*                                                               * 01021000
010220*  DATE  09/25/2014                                             * 01022000
010230*      CHANGE MADE:                                             * 01023000
010240*      CALLED NEW SUB-ROUTINE VNKUT054 TO DERIVE ADDITIONAL     * 01024000
010250*      VENDOR TYPES.                                            * 01025000
010260*      MADE BY: COGNIZANT               WR/IR #: CHG0099490     * 01026000
010270*  DATE  05/17/2016                                             * 01027000
010280*      CHANGE MADE:                                             * 01028000
010290*      RECOMPILE FOR VNWS014 AND VNWS054                        * 01029000
010291*      MADE BY: ACCENTURE               WR/IR #: CHG0135353     * 01029100
010292*                                                               * 01029200
010293*  DATE  07/05/2018                                             * 01029300
010294*      CHANGE MADE: CHANGES MADE TO ADD TWO NEW FIELDS NODE AND * 01029400
010295*      STATUS FOR THE DIRECT SHIP WAREHOUSE FUNCTION            * 01029500
010296*      MADE BY: COGNIZANT               WR/IR #: CHG0205731     * 01029600
010297*  DATE  03/22/2019                                              *01029700
010298*   CHANGE MADE: ADDED CHECK TO NOT CALL PEOPLESOFT CALLED       *01029800
010299*   MODULES AS PART OF THE PS REPLACEMENT TO ORACLE. *            01029900
010300*   BASED ON TKRPRPM PARAMTER LOOKUP 'ERPDTE'. IF CURRENT DATE *  01030000
010301*   IS GREATER THEN PARAMATER DATE, ASC-ERP-OIC-LIVE-YES OR *     01030100
010302*   ASC-ERP-OIC-LIVE-NO WILL BE SET AND CHECKED IN THE PROGRAM *  01030200
010303*        MADE BY: GERMAN BANDA            WR/IR #: CHG0220043 *   01030300
010304*  DATE  08/26/2019                                              *01030400
010305*   CHANGE MADE: INITIALIZED VN034-RF-REMIT-ADDR-SEQ-NUM IN      *01030500
010306*   4300-READ-ITEMS-FROM-DB PARA TO FIX THE ERROR WE ARE GETTING  01030600
010307*   WHILE TRYING TO UPDATE REMITTANCE ADDRESS IN CICS SCREENS.    01030700
010308*        MADE BY: COGNIZANT               WR/IR #: CHG0230029 *   01030800
010309*  DATE  05/18/2020                                              *01030900
010310*   CHANGE MADE: REMOVE CALLS TO VNKUT054, VNKUT040, VNKUT034.   *01031000
010311*        MADE BY: JEAN KURK               WR/IR #: CHG0243534 *   01031100
010312*  DATE  09/07/2021                                              *01031205
010313*            - CHANGE CALL OF DPKUT100 TO                       * 01031305
010314*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 01031405
010315*              MAKING THE CALL DYNAMIC VS STATIC                * 01031505
010316*      MADE BY: GERMAN BANDA            WR/IR #: CHG0261091      *01031607
010317*                                                               * 01031705
010312*  DATE  01/05/2023                                              *01031808
010313*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               * 01031908
010316*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *01032208
010318******************************************************************01032300
010319*---------------------------------------------------------------* 01032400
010320                                                                  01032500
010321 ENVIRONMENT DIVISION.                                            01032600
010322 DATA DIVISION.                                                   01032700
010323/                                                                 01032800
010324 WORKING-STORAGE SECTION.                                         01032900
010325                                                                  01033000
010326 01  DK-DB2-KEYS.                                                 01033100
010330     05  DK-ENT-ID                      PIC S9(09) VALUE +0       01033200
010340                                                   COMP.          01034000
010350     05  DK-FUNCTION-ID                 PIC S9(04) VALUE +0       01035000
010360                                                   COMP.          01036000
010370     05  DK-STATE-CODE                  PIC  X(02) VALUE SPACES.  01037000
010380                                                                  01038000
010390 01  PC-PROGRAM-CONSTANTS.                                        01039000
010400     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01040000
010500                                                    'VNKCS010'.   01050000
010600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01060000
010700                                                    'VN010A  '.   01070000
010800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         01080000
010900                                                    'VNKM010 '.   01090000
011000     05  PC-PO-FUNCTION-ID              PIC S9(04)  VALUE +2      01100000
011100                                                    COMP.         01110000
011200     05  PC-CORP-FUNCTION-ID            PIC S9(04)  VALUE +4      01120000
011300                                                    COMP.         01130000
011400     05  PC-PRETICK-FUNCTION-ID         PIC S9(04)  VALUE +5      01140000
011500                                                    COMP.         01150000
011600     05  PC-REMIT-FUNCTION-ID           PIC S9(04)  VALUE +9      01160000
011700                                                    COMP.         01170000
011800     05  PC-VENDOR-COM-FUNCTION-ID      PIC S9(04)  VALUE +15     01180000
011900                                                    COMP.         01190000
012000     05  PC-DC-CUST-SERV-FUNCTION-ID    PIC S9(04)  VALUE +14     01200000
012100                                                    COMP.         01210000
012200     05  PC-1099-FUNCTION-ID            PIC S9(04)  VALUE +16     01220000
012300                                                    COMP.         01230000
012400     05  PC-DSV-WAREHOUSE-LOC           PIC S9(04)  VALUE +17     01240000
012500                                                    COMP.         01250000
012600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      01260000
012700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      01270000
012800     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      01280000
012900     05  PC-INTER-APPL-CODES.                                     01290000
013000         10  PC-INTER-APPL-ADD          PIC  X(01)  VALUE '1'.    01300000
013100         10  PC-INTER-APPL-UPDATE       PIC  X(01)  VALUE '2'.    01310000
013200         10  PC-INTER-APPL-DELETE       PIC  X(01)  VALUE '3'.    01320000
013300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +1      01330000
013400                                                    COMP SYNC.    01340000
013500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01350000
013600                                                    +1000000      01360000
013700                                                    COMP-3.       01370000
013800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      01380000
013900                                                    COMP-3.       01390000
014000     05  PC-DPKUT410                    PIC  X(08)  VALUE         01400000
014100                                                    'DPKUT410'.   01410000
014200     05  PC-VNKCS023              PIC  X(08)  VALUE 'VNKCS023'.   01420000
014300     05  PC-VNKCS024              PIC  X(08)  VALUE 'VNKCS024'.   01430000
014400                                                                  01440000
014500     05  PC-TSYMSG-NUMBERS.                                       01450000
014600         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  01460000
014700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01470000
014800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01480000
014900         10  PC-TSYMSG-00034            PIC  9(05)  VALUE 00034.  01490000
015000         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01500000
015100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01510000
015200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01520000
015300         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01530000
015400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01540000
015500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01550000
015600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01560000
015700         10  PC-TSYMSG-00115            PIC  9(05)  VALUE 00115.  01570000
015800         10  PC-TSYMSG-00116            PIC  9(05)  VALUE 00116.  01580000
015900         10  PC-TSYMSG-00117            PIC  9(05)  VALUE 00117.  01590000
016000         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01600000
016100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01610000
016200         10  PC-TSYMSG-00460            PIC  9(05)  VALUE 00460.  01620000
016300         10  PC-TSYMSG-03809            PIC  9(05)  VALUE 03809.  01630000
016400         10  PC-TSYMSG-03810            PIC  9(05)  VALUE 03810.  01640000
016500         10  PC-TSYMSG-01405            PIC  9(05)  VALUE 01405.  01650000
016600         10  PC-TSYMSG-01674            PIC  9(05)  VALUE 01674.  01660000
016700         10  PC-TSYMSG-01498            PIC  9(05)  VALUE 01498.  01670000
016800         10  PC-TSYMSG-01879            PIC  9(05)  VALUE 01879.  01680000
016900         10  PC-TSYMSG-01880            PIC  9(05)  VALUE 01880.  01690000
017000         10  PC-TSYMSG-01881            PIC  9(05)  VALUE 01881.  01700000
017100         10  PC-TSYMSG-01884            PIC  9(05)  VALUE 01884.  01710000
017200         10  PC-TSYMSG-01887            PIC  9(05)  VALUE 01887.  01720000
017300         10  PC-TSYMSG-01888            PIC  9(05)  VALUE 01888.  01730000
017400         10  PC-TSYMSG-01889            PIC  9(05)  VALUE 01889.  01740000
017500         10  PC-TSYMSG-01890            PIC  9(05)  VALUE 01890.  01750000
017600         10  PC-TSYMSG-01891            PIC  9(05)  VALUE 01891.  01760000
017700         10  PC-TSYMSG-01892            PIC  9(05)  VALUE 01892.  01770000
017800         10  PC-TSYMSG-01893            PIC  9(05)  VALUE 01893.  01780000
017900         10  PC-TSYMSG-01894            PIC  9(05)  VALUE 01894.  01790000
018000         10  PC-TSYMSG-01895            PIC  9(05)  VALUE 01895.  01800000
018100         10  PC-TSYMSG-01896            PIC  9(05)  VALUE 01896.  01810000
018200         10  PC-TSYMSG-01957            PIC  9(05)  VALUE 01957.  01820000
018300         10  PC-TSYMSG-01958            PIC  9(05)  VALUE 01958.  01830000
018400         10  PC-TSYMSG-02021            PIC  9(05)  VALUE 02021.  01840000
018500         10  PC-TSYMSG-02594            PIC  9(05)  VALUE 02594.  01850000
018600         10  PC-TSYMSG-02595            PIC  9(05)  VALUE 02595.  01860000
018700         10  PC-TSYMSG-02596            PIC  9(05)  VALUE 02596.  01870000
018800         10  PC-TSYMSG-02597            PIC  9(05)  VALUE 02597.  01880000
018900         10  PC-TSYMSG-02598            PIC  9(05)  VALUE 02598.  01890000
019000         10  PC-TSYMSG-02599            PIC  9(05)  VALUE 02599.  01900000
019100         10  PC-TSYMSG-02600            PIC  9(05)  VALUE 02600.  01910000
019200         10  PC-TSYMSG-02601            PIC  9(05)  VALUE 02601.  01920000
019300         10  PC-TSYMSG-02606            PIC  9(05)  VALUE 02606.  01930000
019400         10  PC-TSYMSG-02608            PIC  9(05)  VALUE 02608.  01940000
019500         10  PC-TSYMSG-02645            PIC  9(05)  VALUE 02645.  01950000
019600         10  PC-TSYMSG-02668            PIC  9(05)  VALUE 02668.  01960000
019700         10  PC-TSYMSG-03380            PIC  9(05)  VALUE 03380.  01970000
019800         10  PC-TSYMSG-03381            PIC  9(05)  VALUE 03381.  01980000
019900                                                                  01990000
020000 01  PS-PROGRAM-SWITCHES.                                         02000000
020100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02010000
020200         88  PS-NO-ERROR                            VALUE 'Y'.    02020000
020300         88  PS-ERROR                               VALUE 'N'.    02030000
020400     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02040000
020500         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02050000
020600         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02060000
020700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02070000
020800         88  PS-LIST-END                            VALUE 'Y'.    02080000
020900         88  PS-NO-LIST-END                         VALUE 'N'.    02090000
021000     05  PS-VN-UPDATE-PERFORMED-SW      PIC  X(01)  VALUE 'N'.    02100000
021100         88  VN-UPDATE-PERFORMED                    VALUE 'Y'.    02110000
021200         88  VN-UPDATE-NOT-PERFORMED                VALUE 'N'.    02120000
021300     05  PS-PRIM-ADDR-IND-SW            PIC  X(01)  VALUE ' '.    02130000
021400         88  PRIM-ADDR-IND-SAME                     VALUE 'S'.    02140000
021500         88  PRIM-ADDR-IND-DIFFERENT                VALUE 'D'.    02150000
021600         88  PRIM-ADDR-IND-NOT-FOUND                VALUE 'N'.    02160000
021700     05  PS-ERROR-SHORT-NAME-SW         PIC  X(01)  VALUE 'N'.    02170000
021800         88  PS-ERROR-NO-SHORT-NAME                 VALUE 'Y'.    02180000
021900         88  PS-ERROR-SHORT-NAME                    VALUE 'N'.    02190000
022000                                                                  02200000
022100 01  PV-PROGRAM-VARIABLES.                                        02210000
022200     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      02220000
022300                                                    COMP SYNC.    02230000
022400     05  PV-SUB                         PIC S9(04)  VALUE +0      02240000
022500                                                    COMP SYNC.    02250000
022600     05  PV-ITEM                        PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02280000
022900                                                    COMP SYNC.    02290000
023000     05  PV-NODE-LEN                    PIC S9(04)  VALUE +0      02300000
023100                                                    COMP SYNC.    02310000
023200     05  PV-READ-COUNT                  PIC S9(04)  VALUE +0      02320000
023300                                                    COMP.         02330000
023400     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02340000
023500                                                    COMP-3.       02350000
023600     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02360000
023700                                                    COMP-3.       02370000
023800     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02380000
023900                                                     COMP-3.      02390000
024000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02400000
024100                                                    COMP SYNC.    02410000
024200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02420000
024300                                                    COMP SYNC.    02430000
024400     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02440000
024500                                                    COMP SYNC.    02450000
024600     05  PV-PO-ADDRESS-CNT              PIC S9(09)  VALUE +0      02460000
024700                                                    COMP-3.       02470000
024800     05  PV-CORP-ADDRESS-CNT            PIC S9(09)  VALUE +0      02480000
024900                                                    COMP-3.       02490000
025000     05  PV-1099-ADDRESS-CNT            PIC S9(09)  VALUE +0      02500000
025100                                                    COMP-3.       02510000
025200     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02520000
025300                                                    COMP-3.       02530000
025400     05  PV-MAX-TBUSLOC-SEQ-NBR         PIC S9(04)  VALUE +0      02540000
025500                                                    COMP.         02550000
025600     05  PV-MAX-PS-VND-ADDR-SEQ-NBR     PIC S9(04)  VALUE +0      02560000
025700                                                    COMP.         02570000
025800     05  PV-NEXT-TBUSLOC-SEQ-NBR        PIC S9(04)  VALUE +0      02580000
025900                                                    COMP.         02590000
026000     05  PV-MAX-TENTREP-SEQ-NBR         PIC S9(04)  VALUE +0      02600000
026100                                                    COMP.         02610000
026200     05  PV-NEXT-TENTREP-SEQ-NBR        PIC S9(04)  VALUE +0      02620000
026300                                                    COMP.         02630000
026400     05  PV-ENT-BUS-LOC-ID              PIC  S9(4)  VALUE +0      02640000
026500                                                    COMP.         02650000
026600     05  PV-PRIM-ADDR-IND               PIC  X(01)   VALUE SPACE. 02660000
026700     05  PV-DB2-TIMESTAMP               PIC  X(26).               02670000
026800     05  FILLER REDEFINES PV-DB2-TIMESTAMP.                       02680000
026900         10  PV-DB2-TIMESTAMP-CC        PIC  X(02).               02690000
027000         10  PV-DB2-TIMESTAMP-YY        PIC  X(02).               02700000
027100         10  FILLER                     PIC  X(01).               02710000
027200         10  PV-DB2-TIMESTAMP-MM        PIC  X(02).               02720000
027300         10  FILLER                     PIC  X(01).               02730000
027400         10  PV-DB2-TIMESTAMP-DD        PIC  X(02).               02740000
027500         10  FILLER                     PIC  X(16).               02750000
027600     05  PV-DPKUT410-COMMAREA           PIC  X(01)   VALUE SPACES.02760000
027700     05  PV-LOAD-EXTD-NAME              PIC  X(40)   VALUE SPACES.02770000
027800     05  PV-LOAD-1099-NAME              PIC  X(40)   VALUE SPACES.02780000
027900     05  PV-LOAD-ADDRESS1               PIC  X(40)   VALUE SPACES.02790000
028000     05  PV-LOAD-ADDRESS2               PIC  X(40)   VALUE SPACES.02800000
028100     05  PV-LOAD-ADDRESS3               PIC  X(40)   VALUE SPACES.02810000
028200     05  PV-LOAD-ADDRESS4               PIC  X(40)   VALUE SPACES.02820000
028300     05  PV-RMS-NAME                    PIC  X(31)   VALUE SPACES.02830000
028400     05  PV-ENT-NAME-DESC               PIC  X(30)   VALUE SPACES.02840000
028500     05  PV-DUN-NBR                     PIC  X(09)   VALUE SPACES.02850000
028600     05  PV-STATUS-CDE                  PIC  X(01)   VALUE SPACES.02860000
028700     05  PV-BUSLOC-SEQ-NBR              PIC S9(04)  COMP VALUE 0. 02870000
028800     05  PV-FIRST-NAME                  PIC  X(15)   VALUE SPACES.02880000
028900     05  PV-LAST-NAME                   PIC  X(15)   VALUE SPACES.02890000
029000     05  PV-PHONE-NBR                   PIC  X(18)   VALUE SPACES.02900000
029100     05  PV-FAX-NBR                     PIC  X(24)   VALUE SPACES.02910000
029200     05  PV-EMAIL-ADDR                  PIC  X(64)   VALUE SPACES.02920000
029300     05  PV-CITY-NAME                   PIC  X(30)   VALUE SPACES.02930000
029400     05  PV-STATE-CDE                   PIC  X(06)   VALUE SPACES.02940000
029500     05  PV-COUNTRY-CDE                 PIC  X(03)   VALUE SPACES.02950000
029600     05  PV-ZIP-CDE                     PIC  X(12)   VALUE SPACES.02960000
029700     05  PV-RMS-ADDRESS1                PIC  X(40)   VALUE SPACES.02970000
029800     05  PV-RMS-ADDRESS2                PIC  X(40)   VALUE SPACES.02980000
029900     05  PV-RMS-ADDRESS3                PIC  X(40)   VALUE SPACES.02990000
030000     05  PV-SQLDISP                     PIC  -99999.              03000000
030100                                                                  03010000
030200/                                                                 03020000
030300*----------------------------------------------------------------*03030000
030400*    MAP LAYOUT                                                  *03040000
030500*----------------------------------------------------------------*03050000
030600                                                                  03060000
030700     COPY VNKM010.                                                03070000
030800                                                                  03080000
030900*---------------------------------------------------------------* 03090000
031000*    ABEND PROCESSING COPYBOOK.                                 * 03100000
031100*---------------------------------------------------------------* 03110000
031200     COPY DPWS013.                                                03120000
031300                                                                  03130000
031400*---------------------------------------------------------------* 03140000
031500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03150000
031600*---------------------------------------------------------------* 03160000
031700     COPY DPWS015.                                                03170000
031800                                                                  03180000
031900*---------------------------------------------------------------* 03190000
032000*    FUNCTION KEYS COPYBOOK.                                    * 03200000
032100*---------------------------------------------------------------* 03210000
032200     COPY DPWS016.                                                03220000
032300                                                                  03230000
032400*---------------------------------------------------------------* 03240000
032500*    NUMERIC EDIT LAYOUT.                                       * 03250000
032600*---------------------------------------------------------------* 03260000
032700     COPY DPWS010I.                                               03270000
032800/                                                                 03280000
032900*---------------------------------------------------------------* 03290000
033000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 03300008
033100*---------------------------------------------------------------* 03310000
033200     COPY DPWS030.                                                03320000
033200     COPY DPWS930.                                                03321008
033300                                                                  03330000
033400*---------------------------------------------------------------* 03340000
033500*    COUNTRY AND STATE VERIFICATION COPYBOOK                    * 03350000
033600*---------------------------------------------------------------* 03360000
033700     COPY DPWS410.                                                03370000
033800                                                                  03380000
033900**--------------------------------------------------------------**03390000
034000*    MESSAGE INTERFACE FOR MQ SERIES LINK PROGRAM                 03400000
034100**--------------------------------------------------------------**03410000
034200 01  VN007-COMMAREA.                                              03420000
034300     COPY VNWS007.                                                03430000
034400                                                                  03440000
034500**--------------------------------------------------------------**03450000
034600*    VENDOR INFORMATION INTERFACE FOR DB2 LINK PROGRAM            03460000
034700**--------------------------------------------------------------**03470000
034800 01  VN013-COMMAREA.                                              03480000
034900     COPY VNWS013.                                                03490000
035000/                                                                 03500000
035100*----------------------------------------------------------------*03510000
035200*    STANDARD COMMAREA.                                          *03520000
035300*----------------------------------------------------------------*03530000
035400                                                                  03540000
035500     COPY DPWS020.                                                03550000
035600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03560000
035700                                                                  03570000
035800*----------------------------------------------------------------*03580000
035900*    INTER-APPLICATION COMMAREA.                                 *03590000
036000*----------------------------------------------------------------*03600000
036100                                                                  03610000
036200         10  INTER-APPL-COMM-AREA PIC X(200).                     03620000
036300     COPY VNWS001.                                                03630000
036400     COPY VNWS002.                                                03640000
036500     COPY VNWS005.                                                03650000
036600*----------------------------------------------------------------*03660000
036700*    SPECIFIC COMMMAREA FOR VNKCS010.                            *03670000
036800*----------------------------------------------------------------*03680000
036900         10  ASC-SPECIFIC-COMMAREA.                               03690000
037000             15  ASC-LIST-KEYS.                                   03700000
037100                 20  ASC-KEY-ENT-ID       PIC S9(09) COMP.        03710000
037200                 20  ASC-KEY-FUNCTION-ID  PIC S9(04) COMP.        03720000
037300             15  ASC-ACTION-SW            PIC X(03).              03730000
037400                 88  ASC-ADD-PENDING      VALUE 'ADD'.            03740000
037500                 88  ASC-DELETE-PENDING   VALUE 'DEL'.            03750000
037600                 88  ASC-UPDATE-PENDING   VALUE 'UPD'.            03760000
037700             15  ASC-DELETE-SUCCESSFUL-SW   PIC X(01).            03770000
037800                 88  ASC-DELETE-SUCCESSFUL  VALUE 'Y'.            03780000
037900             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).            03790000
038000                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.            03800000
038100                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.            03810000
038200             15  ASC-LIST-ENTRY.                                  03820000
038300                 20  ASC-LIST-ITEM-NUMBER PIC S9(09)              03830000
038400                                          COMP-3.                 03840000
038500                 20  ASC-TENTREP-SEQ-NBR  PIC S9(04) COMP.        03850000
038600                 20  ASC-TBUSLOC-SEQ-NBR  PIC S9(04) COMP.        03860000
038700                 20  ASC-PRIM-ADDR-IND    PIC X(01).              03870000
038800                 20  ASC-FIRST-NAME       PIC X(15).              03880000
038900                 20  ASC-LAST-NAME        PIC X(15).              03890000
039000                 20  ASC-TITLE            PIC X(35).              03900000
039100                 20  ASC-TEL1-NBR         PIC X(18).              03910000
039200                 20  ASC-TEL1-EXT-NBR     PIC X(04).              03920000
039300                 20  ASC-TEL1-CNTY-PH-CD  PIC X(03).              03930000
039400                 20  ASC-TEL2-NBR         PIC X(18).              03940000
039500                 20  ASC-TEL2-EXT-NBR     PIC X(04).              03950000
039600                 20  ASC-TEL2-CNTY-PH-CD  PIC X(03).              03960000
039700                 20  ASC-FAX-NBR          PIC X(24).              03970000
039800                 20  ASC-EMAIL-ADDR       PIC X(64).              03980000
039900                 20  ASC-LAST-UPDATE-DATE PIC X(10).              03990000
040000                 20  ASC-LAST-UPDATE-ID   PIC X(08).              04000000
040100                 20  ASC-ADR-EXNAM-TEXT   PIC X(11).              04010000
040200                 20  ASC-ADDR1-EXNAME     PIC X(40).              04020000
040300                 20  ASC-ADDRESS-TEXT     PIC X(11).              04030000
040400                 20  ASC-ADDR12-DESC      PIC X(40).              04040000
040500                 20  ASC-ADDR23-DESC      PIC X(40).              04050000
040600                 20  ASC-ADDR34-DESC      PIC X(40).              04060000
040700                 20  ASC-CITY             PIC X(30).              04070000
040800                 20  ASC-ZIP              PIC X(12).              04080000
040900                 20  ASC-OLD-STATE-CDE    PIC X(02).              04090000
041000                 20  ASC-STATE-CDE        PIC X(06).              04100000
041100                 20  ASC-STATE-NAME       PIC X(30).              04110000
041200                 20  ASC-COUNTRY-CDE      PIC X(03).              04120000
041300                 20  ASC-COUNTRY-NAME     PIC X(30).              04130000
041400                 20  ASC-ROOM-NBR         PIC X(10).              04140000
041500                 20  ASC-ATTENTION-TO-TXT PIC X(40).              04150000
041600                 20  ASC-COMMENT1-TXT     PIC X(60).              04160000
041700                 20  ASC-COMMENT2-TXT     PIC X(60).              04170000
041800                 20  ASC-COMMENT3-TXT     PIC X(60).              04180000
041900                                                                  04190000
042000             15  ASC-VENDOR-NAME        PIC X(30).                04200000
042100             15  ASC-DUN-NBR            PIC X(09).                04210000
042200             15  ASC-FUNCTION-NAME      PIC X(30).                04220000
042300                                                                  04230000
042400             15  ASC-SEL-SUB            PIC S9(04) COMP SYNC.     04240000
042500             15  ASC-SEL-ITEM           PIC S9(04) COMP SYNC.     04250000
042600             15  ASC-NUMBER-OF-ITEMS-READ                         04260000
042700                                        PIC S9(09) COMP-3.        04270000
042800             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        04280000
042900             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        04290000
043000             15  ASC-ITEM-AT-TOP-OF-PANEL                         04300000
043100                                        PIC S9(09) COMP-3.        04310000
043200             15  ASC-ITEM-AT-BOT-OF-PANEL                         04320000
043300                                        PIC S9(09) COMP-3.        04330000
043400             15  ASC-ITEMS-LEFT-INDICATOR                         04340000
043500                                        PIC  X(01).               04350000
043600                 88  ASC-ITEMS-LEFT-ON-DB     VALUE 'Y'.          04360000
043700                 88  ASC-NO-ITEMS-LEFT-ON-DB  VALUE 'N'.          04370000
043800             15  ASC-USE-SELECTION-QUEUE-IND                      04380000
043900                                        PIC  X(01).               04390000
044000                 88  ASC-USE-SELECTION-QUEUE  VALUE 'Y'.          04400000
044100             15  ASC-DTL-QUEUE-NAME.                              04410000
044200                 20  ASC-DTL-TERM-ID     PIC  X(04).              04420000
044300                 20  ASC-DTL-TASK-NUMBER PIC S9(05) COMP-3.       04430000
044400                 20  ASC-DTL-SEQ         PIC  9(01).              04440000
044500             15  ASC-SEL-QUEUE-NAME.                              04450000
044600                 20  ASC-SEL-TERM-ID     PIC  X(04).              04460000
044700                 20  ASC-SEL-TASK-NUMBER PIC S9(05) COMP-3.       04470000
044800                 20  ASC-SEL-SEQ         PIC  9(01).              04480000
044900             15  ASC-UPDATE-AND-CHANGE-SW   PIC X(01).            04490000
045000                 88  ASC-UPDATE-WITH-CHANGE VALUE 'Y'.            04500000
045100                                                                  04510000
045200 01 WS-MISC-FIELDS.                                               04520000
045300    05 WS-VENDOR-SHORTNAME               PIC X(30) VALUE SPACES.  04530000
045400    05 WS-PRNT-CO-ENT-ID                 PIC S9(09)  COMP.        04540000
045500    05 WS-SUB1                      PIC 9(03) VALUE ZEROES.       04550000
045600    05 WS-SUB2                      PIC 9(03) VALUE ZEROES.       04560000
045700    05 WS-VALID-DIGIT               PIC  X(01).                   04570000
045800       88 VALID-DIGIT               VALUES '0', '1', '2', '3',    04580000
045900                                     '4', '5', '6', '7', '8',     04590000
046000                                     '9'.                         04600000
046100    05 WS-FAX-NUMBER.                                             04610000
046200       10 WS-FAX-NBR1         PIC X(18) VALUE SPACES.             04620000
046300       10 WS-FAX-NBR2         PIC X(06) VALUE SPACES.             04630000
046400    05 WS-FAX-NBR-REFORMAT    PIC X(24) VALUE SPACES.             04640000
046500    05 WS-FAX2-CHECK.                                             04650000
046600       10 WS-FAX-CK1          PIC X(01).                          04660000
046700       10 WS-FAX-CK2          PIC X(01).                          04670000
046800       10 WS-FAX-CK3          PIC X(01).                          04680000
046900       10 WS-FAX-CK4          PIC X(01).                          04690000
047000       10 WS-FAX-CK5          PIC X(01).                          04700000
047100       10 WS-FAX-CK6          PIC X(01).                          04710000
047200    05 WS-FAX-PART2 REDEFINES WS-FAX2-CHECK.                      04720000
047300       10 WS-FAX2-DIGS   OCCURS 6 TIMES.                          04730000
047400          15 WS-FAX2-BYTE      PIC X(01).                         04740000
047500    05 WS-FAX2-CHECK2.                                            04750000
047600       10 WS-FAX2-CK1          PIC X(01) VALUE SPACES.            04760000
047700       10 WS-FAX2-CK2          PIC X(01) VALUE SPACES.            04770000
047800       10 WS-FAX2-CK3          PIC X(01) VALUE SPACES.            04780000
047900       10 WS-FAX2-CK4          PIC X(01) VALUE SPACES.            04790000
048000       10 WS-FAX2-CK5          PIC X(01) VALUE SPACES.            04800000
048100       10 WS-FAX2-CK6          PIC X(01) VALUE SPACES.            04810000
048200    05 WS-FAX2-PART2 REDEFINES WS-FAX2-CHECK2.                    04820000
048300       10 WS-FAX2-DIGITS OCCURS 6 TIMES.                          04830000
048400          15 WS-FAX2-NBR       PIC X(01).                         04840000
048500    05 WS-PHONE-WITH-DASHES.                                      04850000
048600       10 WS-PHN-WD1          PIC  X(01).                         04860000
048700       10 WS-PHN-WD2          PIC  X(01).                         04870000
048800       10 WS-PHN-WD3          PIC  X(01).                         04880000
048900       10 WS-PHN-WD4          PIC  X(01).                         04890000
049000       10 WS-PHN-WD5          PIC  X(01).                         04900000
049100       10 WS-PHN-WD6          PIC  X(01).                         04910000
049200       10 WS-PHN-WD7          PIC  X(01).                         04920000
049300       10 WS-PHN-WD8          PIC  X(01).                         04930000
049400       10 WS-PHN-WD9          PIC  X(01).                         04940000
049500       10 WS-PHN-WD10         PIC  X(01).                         04950000
049600       10 WS-PHN-WD11         PIC  X(01).                         04960000
049700       10 WS-PHN-WD12         PIC  X(01).                         04970000
049800       10 WS-PHN-WD13         PIC  X(01).                         04980000
049900       10 WS-PHN-WD14         PIC  X(01).                         04990000
050000       10 WS-PHN-WD15         PIC  X(01).                         05000000
050100       10 WS-PHN-WD16         PIC  X(01).                         05010000
050200       10 WS-PHN-WD17         PIC  X(01).                         05020000
050300       10 WS-PHN-WD18         PIC  X(01).                         05030000
050400    05 WS-PHN-W-DASHES REDEFINES WS-PHONE-WITH-DASHES.            05040000
050500       10 WS-PHN-WD-DIGS   OCCURS 18 TIMES.                       05050000
050600          15 WS-PHN-WD-BYTE      PIC X(01).                       05060000
050700    05 WS-PHONE-MINUS-DASHES.                                     05070000
050800       10 WS-PHN-MD1          PIC  X(01).                         05080000
050900       10 WS-PHN-MD2          PIC  X(01).                         05090000
051000       10 WS-PHN-MD3          PIC  X(01).                         05100000
051100       10 WS-PHN-MD4          PIC  X(01).                         05110000
051200       10 WS-PHN-MD5          PIC  X(01).                         05120000
051300       10 WS-PHN-MD6          PIC  X(01).                         05130000
051400       10 WS-PHN-MD7          PIC  X(01).                         05140000
051500       10 WS-PHN-MD8          PIC  X(01).                         05150000
051600       10 WS-PHN-MD9          PIC  X(01).                         05160000
051700       10 WS-PHN-MD10         PIC  X(01).                         05170000
051800       10 WS-PHN-MD11         PIC  X(01).                         05180000
051900       10 WS-PHN-MD12         PIC  X(01).                         05190000
052000       10 WS-PHN-MD13         PIC  X(01).                         05200000
052100       10 WS-PHN-MD14         PIC  X(01).                         05210000
052200       10 WS-PHN-MD15         PIC  X(01).                         05220000
052300       10 WS-PHN-MD16         PIC  X(01).                         05230000
052400       10 WS-PHN-MD17         PIC  X(01).                         05240000
052500       10 WS-PHN-MD18         PIC  X(01).                         05250000
052600    05 WS-PHN-M-DASHES REDEFINES WS-PHONE-MINUS-DASHES.           05260000
052700       10 WS-PHONE-MD-DIGS  OCCURS 18 TIMES.                      05270000
052800          15 WS-PHN-MD-BYTE    PIC X(01).                         05280000
052900    05 WS-DIGIT-COUNT          PIC  9(02) VALUE ZEROES.           05290000
053000    05 WS-TELE-FORMAT1.                                           05300000
053100       10 WS-TELE-F1-1         PIC  X(01).                        05310000
053200       10 WS-TELE-F1-2         PIC  X(01).                        05320000
053300       10 WS-TELE-F1-3         PIC  X(01).                        05330000
053400       10 FILLER               PIC  X(01) VALUE '-'.              05340000
053500       10 WS-TELE-F1-4         PIC  X(01).                        05350000
053600       10 WS-TELE-F1-5         PIC  X(01).                        05360000
053700       10 WS-TELE-F1-6         PIC  X(01).                        05370000
053800       10 WS-TELE-F1-7         PIC  X(01).                        05380000
053900       10 FILLER               PIC  X(06) VALUE SPACES.           05390000
054000    05 WS-TELE-FORMAT2.                                           05400000
054100       10 WS-TELE-F2-1         PIC  X(01).                        05410000
054200       10 FILLER               PIC  X(01) VALUE '-'.              05420000
054300       10 WS-TELE-F2-2         PIC  X(01).                        05430000
054400       10 WS-TELE-F2-3         PIC  X(01).                        05440000
054500       10 WS-TELE-F2-4         PIC  X(01).                        05450000
054600       10 FILLER               PIC  X(01) VALUE '-'.              05460000
054700       10 WS-TELE-F2-5         PIC  X(01).                        05470000
054800       10 WS-TELE-F2-6         PIC  X(01).                        05480000
054900       10 WS-TELE-F2-7         PIC  X(01).                        05490000
055000       10 WS-TELE-F2-8         PIC  X(01).                        05500000
055100       10 FILLER               PIC  X(04) VALUE SPACES.           05510000
055200    05 WS-TELE-FORMAT3.                                           05520000
055300       10 WS-TELE-F3-1         PIC  X(01).                        05530000
055400       10 WS-TELE-F3-2         PIC  X(01).                        05540000
055500       10 WS-TELE-F3-3         PIC  X(01).                        05550000
055600       10 FILLER               PIC  X(01) VALUE '-'.              05560000
055700       10 WS-TELE-F3-4         PIC  X(01).                        05570000
055800       10 WS-TELE-F3-5         PIC  X(01).                        05580000
055900       10 WS-TELE-F3-6         PIC  X(01).                        05590000
056000       10 FILLER               PIC  X(01) VALUE '-'.              05600000
056100       10 WS-TELE-F3-7         PIC  X(01).                        05610000
056200       10 WS-TELE-F3-8         PIC  X(01).                        05620000
056300       10 WS-TELE-F3-9         PIC  X(01).                        05630000
056400       10 WS-TELE-F3-10        PIC  X(01).                        05640000
056500       10 FILLER               PIC  X(02) VALUE SPACES.           05650000
056600    05 WS-TELE-FORMAT4.                                           05660000
056700       10 WS-TELE-F4-1         PIC  X(01).                        05670000
056800       10 FILLER               PIC  X(01) VALUE '-'.              05680000
056900       10 WS-TELE-F4-2         PIC  X(01).                        05690000
057000       10 WS-TELE-F4-3         PIC  X(01).                        05700000
057100       10 WS-TELE-F4-4         PIC  X(01).                        05710000
057200       10 FILLER               PIC  X(01) VALUE '-'.              05720000
057300       10 WS-TELE-F4-5         PIC  X(01).                        05730000
057400       10 WS-TELE-F4-6         PIC  X(01).                        05740000
057500       10 WS-TELE-F4-7         PIC  X(01).                        05750000
057600       10 FILLER               PIC  X(01) VALUE '-'.              05760000
057700       10 WS-TELE-F4-8         PIC  X(01).                        05770000
057800       10 WS-TELE-F4-9         PIC  X(01).                        05780000
057900       10 WS-TELE-F4-10        PIC  X(01).                        05790000
058000       10 WS-TELE-F4-11        PIC  X(01).                        05800000
058100    05 WS-REFORMATTED-PHONE-NBR   PIC  X(18) VALUE SPACES.        05810000
058200    05 WS-PHONE-ERROR             PIC  X(01)  VALUE 'N'.          05820000
058300       88  PHONE-ERROR                        VALUE 'Y'.          05830000
058400       88  NO-PHONE-ERROR                     VALUE 'N'.          05840000
058500    05 WS-FAX-EDIT                PIC  X(01)  VALUE 'N'.          05850000
058600       88  FAX-EDIT                           VALUE 'Y'.          05860000
058700       88  NO-FAX-EDIT                        VALUE 'N'.          05870000
058800/                                                                 05880000
058900*---------------------------------------------------------------* 05890000
059000*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 05900000
059100*---------------------------------------------------------------* 05910000
059200     COPY VNWS003.                                                05920000
059300                                                                  05930000
059400/                                                                 05940000
059500*----------------------------------------------------------------*05950000
059600*    DB2 SQL COMMUNICATION AREA                                   05960000
059700*----------------------------------------------------------------*05970000
059800     EXEC SQL                                                     05980000
059900          INCLUDE SQLCA                                           05990000
060000     END-EXEC.                                                    06000000
060100                                                                  06010000
060200/                                                                 06020000
060300*----------------------------------------------------------------*06030000
060400*    DB2 DCLGEN FOR STATE CODE TABLE                              06040000
060500*----------------------------------------------------------------*06050000
060600     EXEC SQL                                                     06060000
060700          INCLUDE TSTATE                                          06070000
060800     END-EXEC.                                                    06080000
060900                                                                  06090000
061000/                                                                 06100000
061100*----------------------------------------------------------------*06110000
061200*    DB2 DCLGEN FOR BUSINESS LOCATION TABLE                       06120000
061300*----------------------------------------------------------------*06130000
061400     EXEC SQL                                                     06140000
061500          INCLUDE TBUSLOC                                         06150000
061600     END-EXEC.                                                    06160000
061700*----------------------------------------------------------------*06170000
061800*    DB2 AREA FOR VENDOR DETAIL HISTORY TABLE                    *06180000
061900*----------------------------------------------------------------*06190000
062000     EXEC SQL                                                     06200000
062100          INCLUDE TVNADAU                                         06210000
062200     END-EXEC.                                                    06220000
062300                                                                  06230000
062400/                                                                 06240000
062500*----------------------------------------------------------------*06250000
062600*    DB2 DCLGEN FOR BUSINESS FUNCTION TABLE                       06260000
062700*----------------------------------------------------------------*06270000
062800     EXEC SQL                                                     06280000
062900          INCLUDE TBUSFNC                                         06290000
063000     END-EXEC.                                                    06300000
063100                                                                  06310000
063200/                                                                 06320000
063300*----------------------------------------------------------------*06330000
063400*    DB2 DCLGEN FOR ENTERPRISE REPRESENTATIVE TABLE               06340000
063500*----------------------------------------------------------------*06350000
063600     EXEC SQL                                                     06360000
063700          INCLUDE TENTREP                                         06370000
063800     END-EXEC.                                                    06380000
063900                                                                  06390000
064000/                                                                 06400000
064100*----------------------------------------------------------------*06410000
064200*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE NAME TABLE         06420000
064300*----------------------------------------------------------------*06430000
064400     EXEC SQL                                                     06440000
064500          INCLUDE TENTNME                                         06450000
064600     END-EXEC.                                                    06460000
064700                                                                  06470000
064800/                                                                 06480000
064900*----------------------------------------------------------------*06490000
065000*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE TABLE              06500000
065100*----------------------------------------------------------------*06510000
065200     EXEC SQL                                                     06520000
065300          INCLUDE TEXTENT                                         06530000
065400     END-EXEC.                                                    06540000
065500                                                                  06550000
065600/                                                                 06560000
065700*----------------------------------------------------------------*06570000
065800*    DB2 DCLGEN FOR PRETICKET HEADER TABLE                        06580000
065900*----------------------------------------------------------------*06590000
066000     EXEC SQL                                                     06600000
066100          INCLUDE TPTKREQ                                         06610000
066200     END-EXEC.                                                    06620000
066300                                                                  06630000
066400/                                                                 06640000
066500*---------------------------------------------------------------* 06650000
066600*  CURSOR TO LIST ALL ADDRESSES/REPS FOR A FUNCTION             * 06660000
066700*---------------------------------------------------------------* 06670000
066800                                                                  06680000
066900     EXEC SQL                                                     06690000
067000         DECLARE ADDRESS-CSR CURSOR FOR                           06700000
067100             SELECT A.ENT_ID                                      06710000
067200                   ,A.SEQ_NBR                                     06720000
067300                   ,A.FIRST_NAME                                  06730000
067400                   ,A.LAST_NAME                                   06740000
067500                   ,A.TITLE_NAME                                  06750000
067600                   ,A.TEL1_NBR                                    06760000
067700                   ,A.TEL1_EXT_NBR                                06770000
067800                   ,A.TEL_1_CNTRY_CDE                             06780000
067900                   ,A.TEL2_NBR                                    06790000
068000                   ,A.TEL2_EXT_NBR                                06800000
068100                   ,A.TEL_2_CNTRY_CDE                             06810000
068200                   ,A.FAX_NBR                                     06820000
068300                   ,A.EMAIL_ADDR_ID                               06830000
068400                   ,A.FUNCTION_ID                                 06840000
068500                   ,A.LAST_UPDATE_TMST                            06850000
068600                   ,A.LAST_UPDATE_ID                              06860000
068700                   ,A.ENT_BUS_LOC_ID                              06870000
068800                   ,B.SEQ_NBR                                     06880000
068900                   ,B.ADDRESS_LINE1_DESC                          06890000
069000                   ,B.ADDRESS_LINE2_DESC                          06900000
069100                   ,B.ADDRESS_LINE3_DESC                          06910000
069200                   ,B.ADDRESS_LINE4_DESC                          06920000
069300                   ,B.ATTENTION_TO_TXT                            06930000
069400                   ,B.CITY_NAME                                   06940000
069500                   ,B.ST_PROV_CDE                                 06950000
069600                   ,B.CNTRY_CDE                                   06960000
069700                   ,B.ZIP_CDE                                     06970000
069800                   ,B.ROOM_NBR                                    06980000
069900                   ,B.COMMENT1_TXT                                06990000
070000                   ,B.COMMENT2_TXT                                07000000
070100                   ,B.COMMENT3_TXT                                07010000
070200                   ,B.EXTD_VND_NM                                 07020000
070300                   ,B.ALT_1099_VND_NM                             07030000
070400                   ,B.PRIM_ADDR_IND                               07040000
070500             FROM TENTREP A                                       07050000
070600                 ,TBUSLOC B                                       07060000
070700                 ,TBUSFNC C                                       07070000
070800             WHERE A.ENT_ID         = :DK-ENT-ID                  07080000
070900               AND A.FUNCTION_ID    = :DK-FUNCTION-ID             07090000
071000               AND A.ENT_ID         = B.ENT_ID                    07100000
071100               AND A.ENT_BUS_LOC_ID = B.SEQ_NBR                   07110000
071200               AND B.FUNCTION_ID    = C.FUNCTION_ID               07120000
071300             ORDER BY A.SEQ_NBR                                   07130000
071400     END-EXEC.                                                    07140000
071500                                                                  07150000
071600/                                                                 07160000
071700 LINKAGE SECTION.                                                 07170000
071800                                                                  07180000
071900 01  DFHCOMMAREA.                                                 07190000
072000     05  FILLER                       OCCURS  1 TO 4072 TIMES     07200000
072100                                      DEPENDING ON EIBCALEN.      07210000
072200         10  FILLER                   PIC X.                      07220000
072300                                                                  07230000
072400/                                                                 07240000
072500 PROCEDURE DIVISION.                                              07250000
072600                                                                  07260000
072700*----------------------------------------------------------------*07270000
072800*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *07280000
072900*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *07290000
073000*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *07300000
073100*                                                                *07310000
073200*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *07320000
073300*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *07330000
073400*----------------------------------------------------------------*07340000
073500 0000-MAIN-MODULE.                                                07350000
073600                                                                  07360000
073700     INITIALIZE DP030-CICS-API-FIELDS.                            07370000
073800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07380000
073900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07390000
074000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07400000
074100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07410000
074200     MOVE LENGTH OF VN010AI        TO DP030-MAP-LENGTH (1).       07420000
074300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07430000
074400     PERFORM 0001-CALL-CICS-ARCH-API.                             07440000
074500                                                                  07450000
074600     PERFORM 1000-CONTROL-PROCESSING.                             07460000
074700                                                                  07470000
074800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07480000
074900     PERFORM 0001-CALL-CICS-ARCH-API.                             07490000
075000                                                                  07500000
075100/                                                                 07510000
075200 0001-CALL-CICS-ARCH-API.                                         07520000
075300                                                                  07530000
075400*    CALL 'DPKCS030' USING DFHEIBLK                               07540008
075400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07541008
075500                           DFHCOMMAREA                            07550000
075600                           DP030-CICS-API-FIELDS                  07560000
075700                           DP020-STANDARD-COMMAREA                07570000
075800                           VN010AI.                               07580000
075900                                                                  07590000
076000     IF  DP030-RC-CALL-SUCCESSFUL                                 07600000
076100         CONTINUE                                                 07610000
076200     ELSE                                                         07620000
076300         SET DP013-NO-ROLLBACK                                    07630000
076400             DP013-XCTL-DISPLAY-RESTART                           07640000
076500             DP013-CICS-ABEND      TO TRUE                        07650000
076600         MOVE 'BEFORE 0000-MAIN-MODULE'                           07660000
076700                                   TO DP013-PARAGRAPH             07670000
076800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07680008
076900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07690008
076800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07691008
076900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07692008
077000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07700000
077100         PERFORM DP013-0000-PROCESS-ABEND                         07710000
077200     END-IF.                                                      07720000
077300                                                                  07730000
077400/                                                                 07740000
077500*'---------------------------------------------------------------*07750000
077600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07760000
077700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07770000
077800*----------------------------------------------------------------*07780000
077900                                                                  07790000
078000 1000-CONTROL-PROCESSING.                                         07800000
078100                                                                  07810000
078200     EVALUATE TRUE                                                07820000
078300         WHEN DP020-NEXT-ACT-INITIAL                              07830000
078400         WHEN ASC-ADD-SUCCESSFUL AND NOT                          07840000
078500                      DP020-FK-LOCAL-GOTO (DP020-SRC-AID)         07850000
078600                                 AND NOT                          07860000
078700                      DP020-NEXT-ACT-RETURN                       07870000
078800                                                                  07880000
078900             INITIALIZE ASC-SPECIFIC-COMMAREA                     07890000
079000             MOVE EIBTRMID     TO ASC-DTL-TERM-ID                 07900000
079100             MOVE DP020-SRC-TASK-NUMBER                           07910000
079200                               TO ASC-DTL-TASK-NUMBER             07920000
079300             MOVE PC-DTL-QUEUE-SEQ                                07930000
079400                               TO ASC-DTL-SEQ                     07940000
079500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07950000
079600                                                                  07960000
079700***-----$TEMPLATE NOTE$-------------------------------------------07970000
079800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,07980000
079900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  07990000
080000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08000000
080100***---------------------------------------------------------------08010000
080200             IF  PS-COMMAREA-NOT-VALID                            08020000
080300                 SET DP020-NEXT-ACT-APPL-ERROR                    08030000
080400                                   TO TRUE                        08040000
080500             ELSE                                                 08050000
080600                 IF  ASC-ADD-PENDING                              08060000
080700                     PERFORM 4320-GET-VENDOR-NAME                 08070000
080800                     PERFORM 4330-GET-FUNCTION-NAME               08080000
080900                     PERFORM 1200-INIT-ADD-SCREEN                 08090000
081000                     PERFORM 1300-FORMAT-EXTD-NAME                08100000
081100                     PERFORM 3200-RESET-ATTRIBUTES                08110000
081200                 ELSE                                             08120000
081300                     PERFORM 2050-DELETE-DETAIL-QUEUE             08130000
081400                     PERFORM UNTIL ASC-NUMBER-OF-ITEMS-READ > ZERO08140000
081500                             OR    PS-LIST-END                    08150000
081600                         PERFORM 4000-BUILD-INITIAL-PANEL         08160000
081700                                                                  08170000
081800                         IF ASC-NUMBER-OF-ITEMS-READ < 1          08180000
081900                            PERFORM 2140-GET-NEXT-FUNCTION        08190000
082000                         END-IF                                   08200000
082100                     END-PERFORM                                  08210000
082200                                                                  08220000
082300                     PERFORM 3200-RESET-ATTRIBUTES                08230000
082400                     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO          08240000
082500                         SET DP020-NEXT-ACT-APPL-ERROR            08250000
082600                             DP020-MSG-FATAL                      08260000
082700                                   TO TRUE                        08270000
082800                         MOVE PC-TSYMSG-00050                     08280000
082900                                   TO DP020-MSG-NUMBER            08290000
083000                     ELSE                                         08300000
083100                         MOVE SPACES TO DP020-MSG-NUMBER-X        08310000
083200                                        DP020-MSG-SEVERITY-IND    08320000
083300                         IF  ASC-ITEM-AT-BOT-OF-PANEL <           08330000
083400                                        ASC-NUMBER-OF-ITEMS-READ  08340000
083500*                        --- MORE ITEMS TO DISPLAY ----           08350000
083600                             MOVE PC-TSYMSG-00279                 08360000
083700                                   TO DP020-MSG-NUMBER            08370000
083800                             SET DP020-MSG-INFORMATIONAL          08380000
083900                                   TO TRUE                        08390000
084000                         END-IF                                   08400000
084100                         IF  ASC-DELETE-PENDING                   08410000
084200                             MOVE PC-TSYMSG-00004                 08420000
084300                                   TO DP020-MSG-NUMBER            08430000
084400                             SET DP020-MSG-INFORMATIONAL          08440000
084500                                   TO TRUE                        08450000
084600                         END-IF                                   08460000
084700                     END-IF                                       08470000
084800                 END-IF                                           08480000
084900             END-IF                                               08490000
085000                                                                  08500000
085100         WHEN DP020-NEXT-ACT-READ-MAP                             08510000
085200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08520000
085300                                   TO PV-TOP-ITEM                 08530000
085400             PERFORM 2000-PROCESS-PANEL                           08540000
085500                                                                  08550000
085600         WHEN DP020-NEXT-ACT-RETURN                               08560000
085700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08570000
085800                                   TO PV-TOP-ITEM                 08580000
085900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08590000
086000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08600000
086100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08610000
086200                                                                  08620000
086300         WHEN OTHER                                               08630000
086400             SET DP013-LOGIC-ABEND TO TRUE                        08640000
086500             SET DP013-NO-ROLLBACK TO TRUE                        08650000
086600             MOVE '1000-CONTROL-PROCESSING'                       08660000
086700                                   TO DP013-PARAGRAPH             08670000
086800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08680000
086900                                   TO DP013-MESSAGE-TEXT(1)       08690000
087000             PERFORM DP013-0000-PROCESS-ABEND                     08700000
087100     END-EVALUATE.                                                08710000
087200                                                                  08720000
087300/                                                                 08730000
087400*----------------------------------------------------------------*08740000
087500*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *08750000
087600*    INTER-APPLICATION FORMAT CODE.                              *08760000
087700*----------------------------------------------------------------*08770000
087800 1100-PROCESS-INTER-APPL-COMM.                                    08780000
087900                                                                  08790000
088000     SET PS-COMMAREA-VALID         TO TRUE.                       08800000
088100                                                                  08810000
088200     EVALUATE DP020-INT-APPL-FORMAT-IND                           08820000
088300                                                                  08830000
088400         WHEN PC-INTER-APPL-ADD                                   08840000
088500             IF  VN002-NUMBER-OF-SELECTED-ITEMS = ZERO            08850000
088600                 MOVE PC-TSYMSG-00057                             08860000
088700                                   TO DP020-MSG-NUMBER            08870000
088800                 SET DP020-MSG-WARNING                            08880000
088900                     PS-COMMAREA-NOT-VALID                        08890000
089000                                   TO TRUE                        08900000
089100             ELSE                                                 08910000
089200             IF  VN002-NUMBER-OF-SELECTED-ITEMS > 1               08920000
089300                 MOVE PC-TSYMSG-00047                             08930000
089400                                   TO DP020-MSG-NUMBER            08940000
089500                 SET DP020-MSG-WARNING                            08950000
089600                     PS-COMMAREA-NOT-VALID                        08960000
089700                     PS-ERROR      TO TRUE                        08970000
089800             ELSE                                                 08980000
089900                 SET ASC-ADD-PENDING                              08990000
090000                     ASC-USE-SELECTION-QUEUE                      09000000
090100                                   TO TRUE                        09010000
090200                 MOVE VN002-NUMBER-OF-TS-ITEMS                    09020000
090300                                   TO ASC-NUMBER-OF-TS-ITEMS      09030000
090400                 MOVE VN002-SEL-QUEUE-NAME                        09040000
090500                                   TO ASC-SEL-QUEUE-NAME          09050000
090600                 PERFORM 1120-PREPARE-LIST-ENTRY                  09060000
090700             END-IF                                               09070000
090800             END-IF                                               09080000
090900                                                                  09090000
091000         WHEN PC-INTER-APPL-UPDATE                                09100000
091100             IF  VN002-NUMBER-OF-SELECTED-ITEMS = ZERO            09110000
091200                 MOVE PC-TSYMSG-00057                             09120000
091300                                   TO DP020-MSG-NUMBER            09130000
091400                 SET DP020-MSG-WARNING                            09140000
091500                     PS-COMMAREA-NOT-VALID                        09150000
091600                                   TO TRUE                        09160000
091700             ELSE                                                 09170000
091800                 SET ASC-UPDATE-PENDING                           09180000
091900                     ASC-USE-SELECTION-QUEUE                      09190000
092000                                   TO TRUE                        09200000
092100                 MOVE VN002-NUMBER-OF-TS-ITEMS                    09210000
092200                                   TO ASC-NUMBER-OF-TS-ITEMS      09220000
092300                 MOVE VN002-SEL-QUEUE-NAME                        09230000
092400                                   TO ASC-SEL-QUEUE-NAME          09240000
092500                 PERFORM 1120-PREPARE-LIST-ENTRY                  09250000
092600             END-IF                                               09260000
092700                                                                  09270000
092800         WHEN PC-INTER-APPL-DELETE                                09280000
092900             IF  VN002-NUMBER-OF-SELECTED-ITEMS = ZERO            09290000
093000                 MOVE PC-TSYMSG-00057                             09300000
093100                                   TO DP020-MSG-NUMBER            09310000
093200                 SET DP020-MSG-WARNING                            09320000
093300                     PS-COMMAREA-NOT-VALID                        09330000
093400                                   TO TRUE                        09340000
093500             ELSE                                                 09350000
093600             IF  VN002-NUMBER-OF-SELECTED-ITEMS > 1               09360000
093700                 MOVE PC-TSYMSG-00047                             09370000
093800                                   TO DP020-MSG-NUMBER            09380000
093900                 SET DP020-MSG-WARNING                            09390000
094000                     PS-COMMAREA-NOT-VALID                        09400000
094100                     PS-ERROR      TO TRUE                        09410000
094200             ELSE                                                 09420000
094300                 MOVE PC-TSYMSG-00004                             09430000
094400                                   TO DP020-MSG-NUMBER            09440000
094500                 SET ASC-DELETE-PENDING                           09450000
094600                     ASC-USE-SELECTION-QUEUE                      09460000
094700                     DP020-MSG-INFORMATIONAL                      09470000
094800                                   TO TRUE                        09480000
094900                 MOVE VN002-NUMBER-OF-TS-ITEMS                    09490000
095000                                   TO ASC-NUMBER-OF-TS-ITEMS      09500000
095100                 MOVE VN002-SEL-QUEUE-NAME                        09510000
095200                                   TO ASC-SEL-QUEUE-NAME          09520000
095300                 PERFORM 1120-PREPARE-LIST-ENTRY                  09530000
095400             END-IF                                               09540000
095500             END-IF                                               09550000
095600                                                                  09560000
095700         WHEN OTHER                                               09570000
095800             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            09580000
095900             SET DP020-MSG-FATAL                                  09590000
096000                 DP020-NEXT-ACT-APPL-ERROR                        09600000
096100                 PS-COMMAREA-NOT-VALID                            09610000
096200                                   TO TRUE                        09620000
096300                                                                  09630000
096400     END-EVALUATE.                                                09640000
096500                                                                  09650000
096600/                                                                 09660000
096700*----------------------------------------------------------------*09670000
096800*    ENTRY IS FROM A LIST.  GET THE FUNCTION ID FROM THE         *09680000
096900*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *09690000
097000*----------------------------------------------------------------*09700000
097100 1120-PREPARE-LIST-ENTRY.                                         09710000
097200                                                                  09720000
097300     MOVE VN003-MAX-ITEMS          TO ASC-SEL-SUB.                09730000
097400     MOVE ZERO                     TO ASC-SEL-ITEM.               09740000
097500     PERFORM 2140-GET-NEXT-FUNCTION.                              09750000
097600                                                                  09760000
097700     IF  ASC-ADD-PENDING                                          09770000
097800         MOVE DK-ENT-ID            TO ASC-KEY-ENT-ID              09780000
097900         MOVE DK-FUNCTION-ID       TO ASC-KEY-FUNCTION-ID         09790000
098000     END-IF.                                                      09800000
098100                                                                  09810000
098200/                                                                 09820000
098300*----------------------------------------------------------------*09830000
098400* INITIALIZE SCREEN FIELDS FOR AN ADD                            *09840000
098500*----------------------------------------------------------------*09850000
098600 1200-INIT-ADD-SCREEN.                                            09860000
098700                                                                  09870000
098800     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       09880000
098900                                                                  09890000
099000     IF  ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID                09900000
099100         MOVE -1                       TO AD1ENML                 09910000
099200     ELSE                                                         09920000
099300         IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR            09930000
099400            ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID             09940000
099500            MOVE -1                    TO APMADINL                09950000
099600         ELSE                                                     09960000
099700            MOVE -1                    TO AFNAMEL                 09970000
099800         END-IF                                                   09980000
099900     END-IF.                                                      09990000
100000                                                                  10000000
100100     INITIALIZE ASC-LIST-ENTRY                                    10010000
100200                DP020-MSG-NUMBER-X                                10020000
100300                DP020-MSG-SEVERITY-IND                            10030000
100400                APMADINO                                          10040000
100500                AFNAMEO                                           10050000
100600                ALNAMEO                                           10060000
100700                ATITLEO                                           10070000
100800                APHONE1O                                          10080000
100900                AEXT1O                                            10090000
101000                APHONE2O                                          10100000
101100                AEXT2O                                            10110000
101200                AFAXO                                             10120000
101300                ACPC1O                                            10130000
101400                ACPC2O                                            10140000
101500                AUPDTO                                            10150000
101600                AUPIDO                                            10160000
101700                AD1ENMTO                                          10170000
101800                AD1ENMO                                           10180000
101900                ADDR12TO                                          10190000
102000                ASTATUSO                                          10200000
102100                ANODEO                                            10210000
102200                AADDR12O                                          10220000
102300                AADDR23O                                          10230000
102400                AADDR34O                                          10240000
102500                ACITYO                                            10250000
102600                AZIPCDEO                                          10260000
102700                ASTCDEO                                           10270000
102800                ASTNMEO                                           10280000
102900                ACNTCDO                                           10290000
103000                ACNTNMO                                           10300000
103100                AROOMO                                            10310000
103200                AATTNTOO                                          10320000
103300                ACOMM1O                                           10330000
103400                ACOMM2O                                           10340000
103500                ACOMM3O.                                          10350000
103600                                                                  10360000
103700     MOVE ASC-VENDOR-NAME          TO AVNNAMEO.                   10370000
103800     MOVE ASC-DUN-NBR              TO ADUNSO.                     10380000
103900     MOVE ASC-FUNCTION-NAME        TO AFUNCNMO.                   10390000
104000                                                                  10400000
104100     IF ASC-KEY-FUNCTION-ID = PC-DSV-WAREHOUSE-LOC                10410000
104200        MOVE 'A'                  TO ACOMM3O                      10420000
104300                                     ACOMM3I                      10430000
104400                                     ASC-COMMENT3-TXT             10440000
104500     END-IF.                                                      10450000
104600                                                                  10460000
104700*----------------------------------------------------------------*10470000
104800* FORMAT THE EXTENDED NAME FIELD HEADER                          *10480000
104900*----------------------------------------------------------------*10490000
105000 1300-FORMAT-EXTD-NAME.                                           10500000
105100                                                                  10510000
105200     EVALUATE ASC-KEY-FUNCTION-ID                                 10520000
105300                                                                  10530000
105400         WHEN PC-REMIT-FUNCTION-ID                                10540000
105500              MOVE 'EXTD NAME.:'                                  10550000
105600                           TO ASC-ADR-EXNAM-TEXT                  10560000
105700              MOVE 'ADDRESS...:'                                  10570000
105800                           TO ASC-ADDRESS-TEXT                    10580000
105900              MOVE ASC-ADR-EXNAM-TEXT TO AD1ENMTO                 10590000
106000              MOVE ASC-ADDRESS-TEXT   TO ADDR12TO                 10600000
106100                                                                  10610000
106200         WHEN PC-1099-FUNCTION-ID                                 10620000
106300              MOVE '1099 VEND.:'                                  10630000
106400                           TO ASC-ADR-EXNAM-TEXT                  10640000
106500              MOVE 'ADDRESS...:'                                  10650000
106600                           TO ASC-ADDRESS-TEXT                    10660000
106700              MOVE ASC-ADR-EXNAM-TEXT TO AD1ENMTO                 10670000
106800              MOVE ASC-ADDRESS-TEXT   TO ADDR12TO                 10680000
106900                                                                  10690000
107000         WHEN PC-DSV-WAREHOUSE-LOC                                10700000
107100              MOVE 'ADDRESS...:'                                  10710000
107200                           TO ASC-ADR-EXNAM-TEXT                  10720000
107300              MOVE ASC-ADR-EXNAM-TEXT TO AD1ENMTO                 10730000
107400              MOVE SPACES  TO ASC-ADDRESS-TEXT                    10740000
107500                              ADDR12TO                            10750000
107600              MOVE 'NODE......:'                                  10760000
107700                           TO ANODEO                              10770000
107800              MOVE 'STATUS....:'                                  10780000
107900                           TO ASTATUSO                            10790000
108000                                                                  10800000
108100         WHEN OTHER                                               10810000
108200              MOVE 'ADDRESS...:'                                  10820000
108300                           TO ASC-ADR-EXNAM-TEXT                  10830000
108400              MOVE ASC-ADR-EXNAM-TEXT TO AD1ENMTO                 10840000
108500              MOVE SPACES  TO ASC-ADDRESS-TEXT                    10850000
108600                              ADDR12TO                            10860000
108700     END-EVALUATE.                                                10870000
108800                                                                  10880000
108900*----------------------------------------------------------------*10890000
109000*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*10900000
109100*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*10910000
109200*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *10920000
109300*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *10930000
109400*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *10940000
109500*----------------------------------------------------------------*10950000
109600                                                                  10960000
109700 2000-PROCESS-PANEL.                                              10970000
109800                                                                  10980000
109900     EVALUATE TRUE                                                10990000
110000         WHEN DP020-SRC-AID = DP016-CLEAR                         11000000
110100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11010000
110200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11020000
110300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11030000
110400                                                                  11040000
110500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     11050000
110600             IF  ASC-ADD-PENDING                                  11060000
110700                 PERFORM 1200-INIT-ADD-SCREEN                     11070000
110800                 PERFORM 1300-FORMAT-EXTD-NAME                    11080000
110900                 PERFORM 3200-RESET-ATTRIBUTES                    11090000
111000             ELSE                                                 11100000
111100                 MOVE ASC-KEY-ENT-ID                              11110000
111200                                   TO DK-ENT-ID                   11120000
111300                 MOVE ASC-KEY-FUNCTION-ID                         11130000
111400                                   TO DK-FUNCTION-ID              11140000
111500                 PERFORM 2050-DELETE-DETAIL-QUEUE                 11150000
111600                 PERFORM 4000-BUILD-INITIAL-PANEL                 11160000
111700                 PERFORM 3200-RESET-ATTRIBUTES                    11170000
111800             END-IF                                               11180000
111900                                                                  11190000
112000         WHEN OTHER                                               11200000
112100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11210000
112200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11220000
112300             IF PS-NO-ERROR                                       11230000
112400                PERFORM 2100-CHECK-FUNCTION-KEY                   11240000
112500             END-IF                                               11250000
112600     END-EVALUATE.                                                11260000
112700                                                                  11270000
112800/                                                                 11280000
112900*----------------------------------------------------------------*11290000
113000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11300000
113100*----------------------------------------------------------------*11310000
113200 2050-DELETE-DETAIL-QUEUE.                                        11320000
113300                                                                  11330000
113400     EXEC CICS                                                    11340000
113500         DELETEQ TS                                               11350000
113600           QUEUE (ASC-DTL-QUEUE-NAME)                             11360000
113700            RESP (PV-CICS-RESP)                                   11370000
113800     END-EXEC.                                                    11380000
113900                                                                  11390000
114000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11400000
114100        (PV-CICS-RESP = DFHRESP(QIDERR))                          11410000
114200         CONTINUE                                                 11420000
114300     ELSE                                                         11430000
114400         SET DP013-CICS-ABEND                                     11440000
114500             DP013-NO-ROLLBACK     TO TRUE                        11450000
114600                                                                  11460000
114700         MOVE '2050-DELETE-DTL-QUEUE'                             11470000
114800                                   TO DP013-PARAGRAPH             11480000
114900         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  11490000
115000                                   TO DP013-MESSAGE-TEXT (1)      11500000
115100         PERFORM DP013-0000-PROCESS-ABEND                         11510000
115200     END-IF.                                                      11520000
115300                                                                  11530000
115400/                                                                 11540000
115500*----------------------------------------------------------------*11550000
115600*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *11560000
115700*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*11570000
115800*    FROM THE CICS ARCHITECTURE API.                             *11580000
115900*----------------------------------------------------------------*11590000
116000                                                                  11600000
116100 2100-CHECK-FUNCTION-KEY.                                         11610000
116200                                                                  11620000
116300     EVALUATE TRUE                                                11630000
116400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11640000
116500             MOVE +1               TO PV-TOP-ITEM                 11650000
116600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11660000
116700                                                                  11670000
116800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11680000
116900             PERFORM 2110-BROWSE-BACKWARD                         11690000
117000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11700000
117100                                                                  11710000
117200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11720000
117300             IF  ASC-DELETE-PENDING                               11730000
117400                 MOVE PC-TSYMSG-00004                             11740000
117500                                   TO DP020-MSG-NUMBER            11750000
117600                 SET DP020-MSG-INFORMATIONAL                      11760000
117700                                   TO TRUE                        11770000
117800                 IF  ASC-DELETE-SUCCESSFUL                        11780000
117900                     MOVE SPACES   TO ASC-DELETE-SUCCESSFUL-SW    11790000
118000                 END-IF                                           11800000
118100             END-IF                                               11810000
118200             PERFORM 2120-BROWSE-FORWARD                          11820000
118300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11830000
118400                                                                  11840000
118500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11850000
118600             IF  ASC-USE-SELECTION-QUEUE                          11860000
118700                 PERFORM WITH TEST AFTER                          11870000
118800                         UNTIL ASC-NUMBER-OF-ITEMS-READ > ZERO    11880000
118900                         OR    PS-LIST-END                        11890000
119000                     PERFORM 2140-GET-NEXT-FUNCTION               11900000
119100                     IF  PS-LIST-END                              11910000
119200                         MOVE PC-TSYMSG-00070                     11920000
119300                                   TO DP020-MSG-NUMBER            11930000
119400                         SET DP020-MSG-INFORMATIONAL              11940000
119500                                   TO TRUE                        11950000
119600                     ELSE                                         11960000
119700                         PERFORM 2050-DELETE-DETAIL-QUEUE         11970000
119800                         PERFORM 4000-BUILD-INITIAL-PANEL         11980000
119900                     END-IF                                       11990000
120000                 END-PERFORM                                      12000000
120100                 SET PS-NO-LIST-END                               12010000
120200                                   TO TRUE                        12020000
120300                 PERFORM 3200-RESET-ATTRIBUTES                    12030000
120400             ELSE                                                 12040000
120500                 MOVE PC-TSYMSG-00070                             12050000
120600                                   TO DP020-MSG-NUMBER            12060000
120700                 SET DP020-MSG-INFORMATIONAL                      12070000
120800                                   TO TRUE                        12080000
120900             END-IF                                               12090000
121000                                                                  12100000
121100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12110000
121200             IF  ASC-USE-SELECTION-QUEUE                          12120000
121300                 PERFORM WITH TEST AFTER                          12130000
121400                         UNTIL ASC-NUMBER-OF-ITEMS-READ > ZERO    12140000
121500                         OR    PS-LIST-END                        12150000
121600                     PERFORM 2150-GET-PREV-FUNCTION               12160000
121700                     IF  PS-LIST-END                              12170000
121800                         MOVE PC-TSYMSG-00069                     12180000
121900                                   TO DP020-MSG-NUMBER            12190000
122000                         SET DP020-MSG-INFORMATIONAL              12200000
122100                                   TO TRUE                        12210000
122200                     ELSE                                         12220000
122300                         PERFORM 2050-DELETE-DETAIL-QUEUE         12230000
122400                         PERFORM 4000-BUILD-INITIAL-PANEL         12240000
122500                     END-IF                                       12250000
122600                 END-PERFORM                                      12260000
122700                 SET PS-NO-LIST-END                               12270000
122800                                   TO TRUE                        12280000
122900                 PERFORM 3200-RESET-ATTRIBUTES                    12290000
123000             ELSE                                                 12300000
123100                 MOVE PC-TSYMSG-00069                             12310000
123200                                   TO DP020-MSG-NUMBER            12320000
123300                 SET DP020-MSG-INFORMATIONAL                      12330000
123400                                   TO TRUE                        12340000
123500             END-IF                                               12350000
123600                                                                  12360000
123700         WHEN DP020-SRC-AID = DP016-ENTER                         12370000
123800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12380000
123900             PERFORM 3200-RESET-ATTRIBUTES                        12390000
124000                                                                  12400000
124100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    12410000
124200             IF  ASC-DELETE-SUCCESSFUL                            12420000
124300                 MOVE PC-TSYMSG-00116                             12430000
124400                                   TO DP020-MSG-NUMBER            12440000
124500                 SET DP020-MSG-FATAL                              12450000
124600                     PS-ERROR      TO TRUE                        12460000
124700                 PERFORM 3200-RESET-ATTRIBUTES                    12470000
124800             ELSE                                                 12480000
124900                 SET DP030-CONTINUE-GO                            12490000
125000                                   TO TRUE                        12500000
125100                 IF ASC-KEY-FUNCTION-ID = PC-PRETICK-FUNCTION-ID  12510000
125200                     MOVE +0 TO PV-DB2-COUNT                      12520000
125300                     PERFORM 8030-CHECK-FOR-PRETICK-RQST          12530000
125400                     IF PV-DB2-COUNT = +0                         12540000
125500                         PERFORM 8000-DELETE-ADDRESS              12550000
125600                     ELSE                                         12560000
125700                         MOVE PC-TSYMSG-01498                     12570000
125800                                   TO DP020-MSG-NUMBER            12580000
125900                         SET DP020-MSG-INFORMATIONAL              12590000
126000                                   TO TRUE                        12600000
126100                     END-IF                                       12610000
126200                 ELSE                                             12620000
126300                    IF (ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR12630000
126400                        ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID)12640000
126500                     AND ASC-PRIM-ADDR-IND = 'Y'                  12650000
126600                         SET PS-ERROR         TO TRUE             12660000
126700                         SET DP020-MSG-FATAL  TO TRUE             12670000
126800                         MOVE PC-TSYMSG-02594                     12680000
126900                         TO DP020-MSG-NUMBER                      12690000
127000***** CANNOT DELETE PRIMARY CORP OR PO ADDRESS                    12700000
127100                     ELSE                                         12710000
127200                        PERFORM 8000-DELETE-ADDRESS               12720000
127300                    END-IF                                        12730000
127400                 END-IF                                           12740000
127500             END-IF                                               12750000
127600                                                                  12760000
127700         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 12770000
127800             INITIALIZE VN005-INTER-APPL-COMMAREA                 12780000
127900             PERFORM 2160-PREPARE-INTER-COM                       12790000
128000                                                                  12800000
128100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12810000
128200             SET DP030-CONTINUE-GO TO TRUE                        12820000
128300                                                                  12830000
128400             IF PC-PRETICK-FUNCTION-ID = ASC-KEY-FUNCTION-ID OR   12840000
128500                PC-VENDOR-COM-FUNCTION-ID = ASC-KEY-FUNCTION-ID OR12850000
128600                PC-DC-CUST-SERV-FUNCTION-ID = ASC-KEY-FUNCTION-ID 12860000
128700                 IF ASC-FIRST-NAME > SPACES AND                   12870000
128800                    ASC-LAST-NAME > SPACES                        12880000
128900                     IF ((ASC-ADDR1-EXNAME > SPACES OR            12890000
129000                          ASC-ADDR12-DESC > SPACES  OR            12900000
129100                          ASC-ADDR23-DESC > SPACES  OR            12910000
129200                          ASC-ADDR34-DESC > SPACES) AND           12920000
129300                          ASC-CITY > SPACES         AND           12930000
129400                          ASC-STATE-CDE > SPACES    AND           12940000
129500                          ASC-ZIP > SPACES)                       12950000
129600                           PERFORM 6000-ADD-ADDRESS               12960000
129700                     ELSE                                         12970000
129800                         IF ASC-FAX-NBR > SPACES                  12980000
129900                             PERFORM 6000-ADD-ADDRESS             12990000
130000                         ELSE                                     13000000
130100                             IF ASC-EMAIL-ADDR > SPACES           13010000
130200                                 PERFORM 6000-ADD-ADDRESS         13020000
130300                             ELSE                                 13030000
130400                                 SET PS-ERROR         TO TRUE     13040000
130500                                 SET DP020-MSG-FATAL  TO TRUE     13050000
130600                                 MOVE PC-TSYMSG-01674             13060000
130700                                   TO DP020-MSG-NUMBER            13070000
130800                             END-IF                               13080000
130900                         END-IF                                   13090000
131000                     END-IF                                       13100000
131100                 ELSE                                             13110000
131200*                --- A FIRST AND LAST NAME WERE NOT ENTERED ---   13120000
131300                     SET PS-ERROR         TO TRUE                 13130000
131400                     SET DP020-MSG-FATAL  TO TRUE                 13140000
131500                     MOVE PC-TSYMSG-01405 TO DP020-MSG-NUMBER     13150000
131600                 END-IF                                           13160000
131700             ELSE                                                 13170000
131800                IF PC-PO-FUNCTION-ID = ASC-KEY-FUNCTION-ID OR     13180000
131900                   PC-CORP-FUNCTION-ID = ASC-KEY-FUNCTION-ID      13190000
132000                   IF  ASC-ADDR1-EXNAME > SPACES AND              13200000
132100                       ASC-CITY > SPACES         AND              13210000
132200                       ASC-COUNTRY-CDE > SPACES                   13220000
132300                       PERFORM 6000-ADD-ADDRESS                   13230000
132400                   ELSE                                           13240000
132500*               -- MUST ENTER ADDRESS ---                         13250000
132600                       SET PS-ERROR         TO TRUE               13260000
132700                       SET DP020-MSG-FATAL  TO TRUE               13270000
132800                       MOVE PC-TSYMSG-02608 TO DP020-MSG-NUMBER   13280000
132900                   END-IF                                         13290000
133000             ELSE                                                 13300000
133100                IF PC-DSV-WAREHOUSE-LOC = ASC-KEY-FUNCTION-ID     13310000
133200                  INITIALIZE PV-NODE-LEN                          13320000
133300                  INSPECT FUNCTION REVERSE (ASC-ADDR34-DESC)      13330000
133400                    TALLYING PV-NODE-LEN FOR LEADING SPACES       13340000
133500                  COMPUTE PV-NODE-LEN = LENGTH OF ASC-ADDR34-DESC 13350000
133600                                        - PV-NODE-LEN             13360000
133700                   IF ASC-COMMENT3-TXT NOT = 'A' AND              13370000
133800                      ASC-COMMENT3-TXT NOT = 'I'                  13380000
133900                       SET PS-ERROR         TO TRUE               13390000
134000                       SET DP020-MSG-FATAL  TO TRUE               13400000
134100                       MOVE PC-TSYMSG-03809 TO DP020-MSG-NUMBER   13410000
134200                   ELSE                                           13420000
134300                     IF PV-NODE-LEN > 15                          13430000
134400                       SET PS-ERROR         TO TRUE               13440000
134500                       SET DP020-MSG-FATAL  TO TRUE               13450000
134600                       MOVE PC-TSYMSG-03810 TO DP020-MSG-NUMBER   13460000
134700                   ELSE                                           13470000
134800                       PERFORM 6000-ADD-ADDRESS                   13480000
134900                     END-IF                                       13490000
135000                   END-IF                                         13500000
135100                ELSE                                              13510000
135200                   PERFORM 6000-ADD-ADDRESS                       13520000
135300                END-IF                                            13530000
135400                END-IF                                            13540000
135500             END-IF                                               13550000
135600                                                                  13560000
135700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13570000
135800             SET DP030-CONTINUE-GO TO TRUE                        13580000
135900                                                                  13590000
136000             IF PC-PRETICK-FUNCTION-ID = ASC-KEY-FUNCTION-ID OR   13600000
136100                PC-VENDOR-COM-FUNCTION-ID = ASC-KEY-FUNCTION-ID OR13610000
136200                PC-DC-CUST-SERV-FUNCTION-ID = ASC-KEY-FUNCTION-ID 13620000
136300                    IF ASC-FIRST-NAME > SPACES AND                13630000
136400                       ASC-LAST-NAME > SPACES                     13640000
136500                        IF ((ASC-ADDR1-EXNAME > SPACES OR         13650000
136600                             ASC-ADDR12-DESC > SPACES  OR         13660000
136700                             ASC-ADDR23-DESC > SPACES  OR         13670000
136800                             ASC-ADDR34-DESC > SPACES) AND        13680000
136900                             ASC-CITY > SPACES         AND        13690000
137000                             ASC-STATE-CDE > SPACES    AND        13700000
137100                             ASC-ZIP > SPACES)                    13710000
137200                              PERFORM 7000-UPDATE-ADDRESS         13720000
137300                        ELSE                                      13730000
137400                            IF ASC-FAX-NBR > SPACES               13740000
137500                                PERFORM 7000-UPDATE-ADDRESS       13750000
137600                            ELSE                                  13760000
137700                                IF ASC-EMAIL-ADDR > SPACES        13770000
137800                                    PERFORM 7000-UPDATE-ADDRESS   13780000
137900                                ELSE                              13790000
138000                                    SET PS-ERROR         TO TRUE  13800000
138100                                    SET DP020-MSG-FATAL  TO TRUE  13810000
138200                                    MOVE PC-TSYMSG-01674          13820000
138300                                      TO DP020-MSG-NUMBER         13830000
138400                                END-IF                            13840000
138500                            END-IF                                13850000
138600                        END-IF                                    13860000
138700                    ELSE                                          13870000
138800*                   --- A FIRST AND LAST NAME WERE NOT ENTERED ---13880000
138900                        SET PS-ERROR         TO TRUE              13890000
139000                        SET DP020-MSG-FATAL  TO TRUE              13900000
139100                        MOVE PC-TSYMSG-01405 TO DP020-MSG-NUMBER  13910000
139200                    END-IF                                        13920000
139300             ELSE                                                 13930000
139400                IF PC-PO-FUNCTION-ID = ASC-KEY-FUNCTION-ID OR     13940000
139500                   PC-CORP-FUNCTION-ID = ASC-KEY-FUNCTION-ID      13950000
139600                   IF ASC-ADDR1-EXNAME > SPACES AND               13960000
139700                       ASC-CITY > SPACES      AND                 13970000
139800                       ASC-COUNTRY-CDE > SPACES                   13980000
139900                       PERFORM 7000-UPDATE-ADDRESS                13990000
140000                   ELSE                                           14000000
140100*                  -- MUST ENTER ADDRESS ---                      14010000
140200                       SET PS-ERROR      TO TRUE                  14020000
140300                       SET DP020-MSG-FATAL TO TRUE                14030000
140400                       MOVE PC-TSYMSG-02608 TO DP020-MSG-NUMBER   14040000
140500                   END-IF                                         14050000
140600                ELSE                                              14060000
140700                    PERFORM 7000-UPDATE-ADDRESS                   14070000
140800                END-IF                                            14080000
140900             END-IF                                               14090000
141000                                                                  14100000
141100         WHEN OTHER                                               14110000
141200             SET DP013-NO-ROLLBACK                                14120000
141300                 DP013-XCTL-DISPLAY-RESTART                       14130000
141400                 DP013-CICS-ABEND  TO TRUE                        14140000
141500             MOVE '2100-CHECK-FUNCTION-KEY'                       14150000
141600                                   TO DP013-PARAGRAPH             14160000
141700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14170000
141800                                   TO DP013-MESSAGE-TEXT (1)      14180000
141900             PERFORM DP013-0000-PROCESS-ABEND                     14190000
142000     END-EVALUATE.                                                14200000
142100                                                                  14210000
142200/                                                                 14220000
142300*----------------------------------------------------------------*14230000
142400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14240000
142500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14250000
142600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14260000
142700*    MESSAGE.                                                    *14270000
142800*----------------------------------------------------------------*14280000
142900                                                                  14290000
143000 2110-BROWSE-BACKWARD.                                            14300000
143100                                                                  14310000
143200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14320000
143300         GIVING PV-TOP-ITEM.                                      14330000
143400                                                                  14340000
143500     IF  ((PV-TOP-ITEM < +1)                                      14350000
143600       OR (PV-TOP-ITEM = +1))                                     14360000
143700         MOVE +1                   TO PV-TOP-ITEM                 14370000
143800*        -- TOP OF LIST --                                        14380000
143900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14390000
144000         SET DP020-MSG-INFORMATIONAL                              14400000
144100                                   TO TRUE                        14410000
144200     END-IF.                                                      14420000
144300                                                                  14430000
144400/                                                                 14440000
144500*----------------------------------------------------------------*14450000
144600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14460000
144700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14470000
144800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14480000
144900*----------------------------------------------------------------*14490000
145000                                                                  14500000
145100 2120-BROWSE-FORWARD.                                             14510000
145200                                                                  14520000
145300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14530000
145400         GIVING PV-TOP-ITEM.                                      14540000
145500                                                                  14550000
145600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14560000
145700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14570000
145800                                   TO PV-TOP-ITEM                 14580000
145900*        -- BOTTOM OF LIST --                                     14590000
146000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14600000
146100         SET DP020-MSG-INFORMATIONAL                              14610000
146200                                   TO TRUE                        14620000
146300     ELSE                                                         14630000
146400         COMPUTE PV-BOTTOM-ITEM =                                 14640000
146500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14650000
146600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14660000
146700*            -- BOTTOM OF LIST --                                 14670000
146800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14680000
146900             SET DP020-MSG-INFORMATIONAL                          14690000
147000                                   TO TRUE                        14700000
147100         END-IF                                                   14710000
147200     END-IF.                                                      14720000
147300                                                                  14730000
147400/                                                                 14740000
147500*----------------------------------------------------------------*14750000
147600*    GET THE KEY OF THE NEXT SELECTED OBJECT FROM THE            *14760000
147700*    THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                     *14770000
147800*----------------------------------------------------------------*14780000
147900 2140-GET-NEXT-FUNCTION.                                          14790000
148000                                                                  14800000
148100     ADD +1                        TO ASC-SEL-SUB.                14810000
148200                                                                  14820000
148300     IF  ASC-SEL-SUB > VN003-MAX-ITEMS                            14830000
148400         ADD +1                    TO ASC-SEL-ITEM                14840000
148500         MOVE +1                   TO ASC-SEL-SUB                 14850000
148600     END-IF.                                                      14860000
148700                                                                  14870000
148800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14880000
148900         PERFORM 9100-READ-SEL-QUEUE                              14890000
149000         IF  VN003-ITEM (ASC-SEL-SUB) > ZERO                      14900000
149100             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      14910000
149200                                   TO DK-ENT-ID                   14920000
149300             MOVE VN003-FUNCTION-ID (ASC-SEL-SUB)                 14930000
149400                                   TO DK-FUNCTION-ID              14940000
149500             SET VN003-INQ (ASC-SEL-SUB)                          14950000
149600                                   TO TRUE                        14960000
149700             PERFORM 9200-REWRITE-LIST-QUEUE                      14970000
149800         ELSE                                                     14980000
149900             SUBTRACT +1 FROM ASC-SEL-SUB                         14990000
150000*            --- BOTTOM OF LIST ---                               15000000
150100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15010000
150200             SET DP020-MSG-INFORMATIONAL                          15020000
150300                 PS-LIST-END                                      15030000
150400                                   TO TRUE                        15040000
150500         END-IF                                                   15050000
150600     ELSE                                                         15060000
150700         SUBTRACT +1 FROM ASC-SEL-ITEM                            15070000
150800         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 15080000
150900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15090000
151000         SET DP020-MSG-INFORMATIONAL                              15100000
151100             PS-LIST-END                                          15110000
151200                                   TO TRUE                        15120000
151300     END-IF.                                                      15130000
151400                                                                  15140000
151500/                                                                 15150000
151600*----------------------------------------------------------------*15160000
151700*    GET THE KEY OF THE PREVIOUS SELECTED OBJECT FROM THE        *15170000
151800*    SELECTED-ITEMS TEMP. STORAGE QUEUE.                         *15180000
151900*----------------------------------------------------------------*15190000
152000 2150-GET-PREV-FUNCTION.                                          15200000
152100                                                                  15210000
152200     SUBTRACT +1 FROM ASC-SEL-SUB.                                15220000
152300                                                                  15230000
152400     IF  ASC-SEL-SUB < +1                                         15240000
152500         SUBTRACT +1 FROM ASC-SEL-ITEM                            15250000
152600         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 15260000
152700     END-IF.                                                      15270000
152800                                                                  15280000
152900     IF  ASC-SEL-ITEM > ZERO                                      15290000
153000         PERFORM 9100-READ-SEL-QUEUE                              15300000
153100         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          15310000
153200                                   TO DK-ENT-ID                   15320000
153300         MOVE VN003-FUNCTION-ID (ASC-SEL-SUB)                     15330000
153400                                   TO DK-FUNCTION-ID              15340000
153500     ELSE                                                         15350000
153600         MOVE +1                   TO ASC-SEL-ITEM                15360000
153700                                      ASC-SEL-SUB                 15370000
153800*        --- TOP OF LIST ---                                      15380000
153900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15390000
154000         SET DP020-MSG-INFORMATIONAL                              15400000
154100             PS-LIST-END           TO TRUE                        15410000
154200     END-IF.                                                      15420000
154300/                                                                 15430000
154400*----------------------------------------------------------------*15440000
154500*  PREPARE THE COMMAREA TO TRANSFER ADDRESS INFORMATION          *15450000
154600*----------------------------------------------------------------*15460000
154700 2160-PREPARE-INTER-COM.                                          15470000
154800                                                                  15480000
154900     MOVE ASC-KEY-ENT-ID          TO  VN005-ENT-ID.               15490000
155000     MOVE ASC-KEY-FUNCTION-ID     TO  VN005-FUNCTION-ID.          15500000
155100     MOVE ASC-TENTREP-SEQ-NBR     TO  VN005-REP-SEQ-NBR.          15510000
155200     MOVE ASC-VENDOR-NAME         TO  VN005-VENDOR-NAME.          15520000
155300                                                                  15530000
155400     IF ASC-ADD-SUCCESSFUL                                        15540000
155500        INITIALIZE ASC-KEY-ENT-ID                                 15550000
155600                   ASC-KEY-FUNCTION-ID                            15560000
155700                   ASC-TENTREP-SEQ-NBR                            15570000
155800     END-IF.                                                      15580000
155900                                                                  15590000
156000*----------------------------------------------------------------*15600000
156100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *15610000
156200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *15620000
156300*----------------------------------------------------------------*15630000
156400 2200-MOVE-SCREEN-TO-COMMAREA.                                    15640000
156500                                                                  15650000
156600     IF  AFNAMEL > ZERO                                           15660000
156700         MOVE AFNAMEI              TO ASC-FIRST-NAME              15670000
156800     ELSE                                                         15680000
156900         IF  AFNAMEA = DP015-ERASE-EOF                            15690000
157000             MOVE SPACE            TO ASC-FIRST-NAME              15700000
157100         END-IF                                                   15710000
157200     END-IF.                                                      15720000
157300                                                                  15730000
157400     IF  APMADINL > ZERO                                          15740000
157500         MOVE APMADINI             TO ASC-PRIM-ADDR-IND           15750000
157600     ELSE                                                         15760000
157700         IF APMADINF = DP015-ERASE-EOF                            15770000
157800            MOVE 'N'                  TO ASC-PRIM-ADDR-IND        15780000
157900         END-IF                                                   15790000
158000     END-IF.                                                      15800000
158100                                                                  15810000
158200     IF  ALNAMEL > ZERO                                           15820000
158300         MOVE ALNAMEI              TO ASC-LAST-NAME               15830000
158400     ELSE                                                         15840000
158500         IF  ALNAMEA = DP015-ERASE-EOF                            15850000
158600             MOVE SPACE            TO ASC-LAST-NAME               15860000
158700         END-IF                                                   15870000
158800     END-IF.                                                      15880000
158900     IF  ATITLEL > ZERO                                           15890000
159000         MOVE ATITLEI              TO ASC-TITLE                   15900000
159100     ELSE                                                         15910000
159200         IF  ATITLEA = DP015-ERASE-EOF                            15920000
159300             MOVE SPACE            TO ASC-TITLE                   15930000
159400         END-IF                                                   15940000
159500     END-IF.                                                      15950000
159600                                                                  15960000
159700     IF  APHONE1L > ZERO                                          15970000
159800         MOVE APHONE1I             TO ASC-TEL1-NBR                15980000
159900     ELSE                                                         15990000
160000         IF  APHONE1A = DP015-ERASE-EOF                           16000000
160100             MOVE SPACE            TO ASC-TEL1-NBR                16010000
160200         END-IF                                                   16020000
160300     END-IF.                                                      16030000
160400                                                                  16040000
160500     IF  AEXT1L > ZERO                                            16050000
160600         MOVE AEXT1I               TO ASC-TEL1-EXT-NBR            16060000
160700     ELSE                                                         16070000
160800         IF  AEXT1A = DP015-ERASE-EOF                             16080000
160900             MOVE SPACE            TO ASC-TEL1-EXT-NBR            16090000
161000         END-IF                                                   16100000
161100     END-IF.                                                      16110000
161200                                                                  16120000
161300     IF  ACPC1L > ZERO                                            16130000
161400         MOVE ACPC1I               TO ASC-TEL1-CNTY-PH-CD         16140000
161500     ELSE                                                         16150000
161600         IF  ACPC1A = DP015-ERASE-EOF                             16160000
161700             MOVE SPACE            TO ASC-TEL1-CNTY-PH-CD         16170000
161800         END-IF                                                   16180000
161900     END-IF.                                                      16190000
162000                                                                  16200000
162100     IF  APHONE2L > ZERO                                          16210000
162200         MOVE APHONE2I             TO ASC-TEL2-NBR                16220000
162300     ELSE                                                         16230000
162400         IF  APHONE2A = DP015-ERASE-EOF                           16240000
162500             MOVE SPACE            TO ASC-TEL2-NBR                16250000
162600         END-IF                                                   16260000
162700     END-IF.                                                      16270000
162800                                                                  16280000
162900     IF  AEXT2L > ZERO                                            16290000
163000         MOVE AEXT2I               TO ASC-TEL2-EXT-NBR            16300000
163100     ELSE                                                         16310000
163200         IF  AEXT2A = DP015-ERASE-EOF                             16320000
163300             MOVE SPACE            TO ASC-TEL2-EXT-NBR            16330000
163400         END-IF                                                   16340000
163500     END-IF.                                                      16350000
163600                                                                  16360000
163700     IF  ACPC2L > ZERO                                            16370000
163800         MOVE ACPC2I               TO ASC-TEL2-CNTY-PH-CD         16380000
163900     ELSE                                                         16390000
164000         IF  ACPC2A = DP015-ERASE-EOF                             16400000
164100             MOVE SPACE            TO ASC-TEL2-CNTY-PH-CD         16410000
164200         END-IF                                                   16420000
164300     END-IF.                                                      16430000
164400                                                                  16440000
164500     IF  AFAXL > ZERO                                             16450000
164600         MOVE AFAXI                TO ASC-FAX-NBR                 16460000
164700     ELSE                                                         16470000
164800         IF  AFAXA = DP015-ERASE-EOF                              16480000
164900             MOVE SPACE            TO ASC-FAX-NBR                 16490000
165000         END-IF                                                   16500000
165100     END-IF.                                                      16510000
165200                                                                  16520000
165300     IF  AEMAILL > ZERO                                           16530000
165400         MOVE AEMAILI              TO ASC-EMAIL-ADDR              16540000
165500     ELSE                                                         16550000
165600         IF  AEMAILA = DP015-ERASE-EOF                            16560000
165700             MOVE SPACE            TO ASC-EMAIL-ADDR              16570000
165800         END-IF                                                   16580000
165900     END-IF.                                                      16590000
166000                                                                  16600000
166100     IF  AD1ENML > ZERO                                           16610000
166200         MOVE AD1ENMI              TO ASC-ADDR1-EXNAME            16620000
166300     ELSE                                                         16630000
166400         IF  AD1ENMA = DP015-ERASE-EOF                            16640000
166500             MOVE SPACE            TO ASC-ADDR1-EXNAME            16650000
166600         END-IF                                                   16660000
166700     END-IF.                                                      16670000
166800                                                                  16680000
166900     IF  AADDR12L > ZERO                                          16690000
167000         MOVE AADDR12I             TO ASC-ADDR12-DESC             16700000
167100     ELSE                                                         16710000
167200         IF  AADDR12A = DP015-ERASE-EOF                           16720000
167300             MOVE SPACE            TO ASC-ADDR12-DESC             16730000
167400         END-IF                                                   16740000
167500     END-IF.                                                      16750000
167600                                                                  16760000
167700     IF  AADDR23L > ZERO                                          16770000
167800         MOVE AADDR23I             TO ASC-ADDR23-DESC             16780000
167900     ELSE                                                         16790000
168000         IF  AADDR23A = DP015-ERASE-EOF                           16800000
168100             MOVE SPACE            TO ASC-ADDR23-DESC             16810000
168200         END-IF                                                   16820000
168300     END-IF.                                                      16830000
168400                                                                  16840000
168500     IF  AADDR34L > ZERO                                          16850000
168600         MOVE AADDR34I             TO ASC-ADDR34-DESC             16860000
168700     ELSE                                                         16870000
168800         IF  AADDR34A = DP015-ERASE-EOF                           16880000
168900             MOVE SPACE            TO ASC-ADDR34-DESC             16890000
169000         END-IF                                                   16900000
169100     END-IF.                                                      16910000
169200                                                                  16920000
169300     IF  ACITYL > ZERO                                            16930000
169400         MOVE ACITYI               TO ASC-CITY                    16940000
169500     ELSE                                                         16950000
169600         IF  ACITYA = DP015-ERASE-EOF                             16960000
169700             MOVE SPACE            TO ASC-CITY                    16970000
169800         END-IF                                                   16980000
169900     END-IF.                                                      16990000
170000                                                                  17000000
170100     IF  ASTCDEL > ZERO                                           17010000
170200         MOVE ASTCDEI              TO ASC-STATE-CDE               17020000
170300     ELSE                                                         17030000
170400         IF  ASTCDEA = DP015-ERASE-EOF                            17040000
170500             MOVE SPACE            TO ASC-STATE-CDE               17050000
170600         END-IF                                                   17060000
170700     END-IF.                                                      17070000
170800                                                                  17080000
170900     IF  AZIPCDEL > ZERO                                          17090000
171000         MOVE AZIPCDEI             TO ASC-ZIP                     17100000
171100     ELSE                                                         17110000
171200         IF  AZIPCDEA = DP015-ERASE-EOF                           17120000
171300             MOVE SPACE            TO ASC-ZIP                     17130000
171400         END-IF                                                   17140000
171500     END-IF.                                                      17150000
171600                                                                  17160000
171700     IF  ACNTCDL > ZERO                                           17170000
171800         MOVE ACNTCDI              TO ASC-COUNTRY-CDE             17180000
171900     ELSE                                                         17190000
172000         IF  ACNTCDA = DP015-ERASE-EOF                            17200000
172100             MOVE SPACE            TO ASC-COUNTRY-CDE             17210000
172200         END-IF                                                   17220000
172300     END-IF.                                                      17230000
172400                                                                  17240000
172500     IF  AROOML > ZERO                                            17250000
172600         MOVE AROOMI               TO ASC-ROOM-NBR                17260000
172700     ELSE                                                         17270000
172800         IF  AROOMA = DP015-ERASE-EOF                             17280000
172900             MOVE SPACE            TO ASC-ROOM-NBR                17290000
173000         END-IF                                                   17300000
173100     END-IF.                                                      17310000
173200                                                                  17320000
173300     IF  AATTNTOL > ZERO                                          17330000
173400         MOVE AATTNTOI             TO ASC-ATTENTION-TO-TXT        17340000
173500     ELSE                                                         17350000
173600         IF  AATTNTOA = DP015-ERASE-EOF                           17360000
173700             MOVE SPACE            TO ASC-ATTENTION-TO-TXT        17370000
173800         END-IF                                                   17380000
173900     END-IF.                                                      17390000
174000                                                                  17400000
174100     IF  ACOMM1L > ZERO                                           17410000
174200         MOVE ACOMM1I              TO ASC-COMMENT1-TXT            17420000
174300     ELSE                                                         17430000
174400         IF  ACOMM1A = DP015-ERASE-EOF                            17440000
174500             MOVE SPACE            TO ASC-COMMENT1-TXT            17450000
174600         END-IF                                                   17460000
174700     END-IF.                                                      17470000
174800                                                                  17480000
174900     IF  ACOMM2L > ZERO                                           17490000
175000         MOVE ACOMM2I              TO ASC-COMMENT2-TXT            17500000
175100     ELSE                                                         17510000
175200         IF  ACOMM2A = DP015-ERASE-EOF                            17520000
175300             MOVE SPACE            TO ASC-COMMENT2-TXT            17530000
175400         END-IF                                                   17540000
175500     END-IF.                                                      17550000
175600                                                                  17560000
175700     IF  ACOMM3L > ZERO                                           17570000
175800         MOVE ACOMM3I              TO ASC-COMMENT3-TXT            17580000
175900     ELSE                                                         17590000
176000         IF  ACOMM3A = DP015-ERASE-EOF                            17600000
176100             MOVE SPACE            TO ASC-COMMENT3-TXT            17610000
176200         END-IF                                                   17620000
176300     END-IF.                                                      17630000
176400                                                                  17640000
176500/                                                                 17650000
176600*----------------------------------------------------------------*17660000
176700*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *17670000
176800*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *17680000
176900*----------------------------------------------------------------*17690000
177000 3000-EDIT-DATA-IN-COMMAREA.                                      17700000
177100                                                                  17710000
177200     SET PS-NO-ERROR               TO TRUE.                       17720000
177300                                                                  17730000
177400     PERFORM 3200-RESET-ATTRIBUTES.                               17740000
177500                                                                  17750000
177600     IF NOT ASC-DELETE-PENDING                                    17760000
177700        PERFORM 3010-RETRIEVE-ST-PRV-CNTY-NAME.                   17770000
177800                                                                  17780000
177900     EVALUATE TRUE                                                17790000
178000                                                                  17800000
178100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              17810000
178200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              17820000
178300             PERFORM 3005-EDIT-PHONE-NUMBERS                      17830000
178400             IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR        17840000
178500                ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID         17850000
178600                PERFORM 3050-EDIT-PRIM-ADDR-IND                   17860000
178700                PERFORM 3060-EDIT-ADDRESS                         17870000
178800             END-IF                                               17880000
178900     END-EVALUATE.                                                17890000
179000                                                                  17900000
179100     PERFORM 5100-WRITE-TEMP-STORAGE.                             17910000
179200                                                                  17920000
179300     IF  PS-NO-ERROR                                              17930000
179400         EVALUATE TRUE                                            17940000
179500             WHEN ASC-ADD-PENDING                                 17950000
179600             WHEN ASC-UPDATE-PENDING                              17960000
179700                 SET DP030-SET-CURSOR-APPL-1                      17970000
179800                                 TO TRUE                          17980000
179900                 IF  ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID    17990000
180000                     MOVE -1     TO AD1ENML                       18000000
180100                 ELSE                                             18010000
180200                     IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR18020000
180300                        ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID 18030000
180400                        MOVE -1  TO APMADINL                      18040000
180500                     ELSE                                         18050000
180600                        MOVE -1  TO AFNAMEL                       18060000
180700                     END-IF                                       18070000
180800                 END-IF                                           18080000
180900             WHEN ASC-DELETE-PENDING                              18090000
181000                 SET DP030-SET-CURSOR-TRAILER                     18100000
181100                                 TO TRUE                          18110000
181200         END-EVALUATE                                             18120000
181300     END-IF.                                                      18130000
181400                                                                  18140000
181500 3005-EDIT-PHONE-NUMBERS.                                         18150000
181600                                                                  18160000
181700     IF ASC-TEL1-NBR > SPACES                                     18170000
181800        MOVE SPACES              TO WS-PHONE-WITH-DASHES          18180000
181900                                    WS-PHONE-MINUS-DASHES         18190000
182000                                    WS-REFORMATTED-PHONE-NBR      18200000
182100        MOVE ZEROES              TO WS-SUB2                       18210000
182200                                    WS-DIGIT-COUNT                18220000
182300        MOVE ASC-TEL1-NBR        TO WS-PHONE-WITH-DASHES          18230000
182400        SET NO-PHONE-ERROR       TO TRUE                          18240000
182500        SET NO-FAX-EDIT          TO TRUE                          18250000
182600        PERFORM 3020-CHECK-PHONE-NUMBER                           18260000
182700            VARYING WS-SUB1 FROM 1 BY 1                           18270000
182800               UNTIL WS-SUB1 > 18 OR PHONE-ERROR                  18280000
182900        IF PHONE-ERROR                                            18290000
183000          SET PS-ERROR          TO TRUE                           18300000
183100          SET DP020-MSG-FATAL   TO TRUE                           18310000
183200*            --- MUST BE NUMERIC    ---                           18320000
183300          MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER               18330000
183400          MOVE DP015-UNP-ALP-BRT-OFF                              18340000
183500                                TO APHONE1A                       18350000
183600          MOVE DP015-RED        TO APHONE1C                       18360000
183700          MOVE DP015-REVERSE    TO APHONE1H                       18370000
183800          MOVE -1               TO APHONE1L                       18380000
183900          SET DP030-SET-CURSOR-APPL-1                             18390000
184000                                TO TRUE                           18400000
184100        ELSE                                                      18410000
184200          PERFORM 3030-REFORMAT-PHONE-NUMBER                      18420000
184300          IF PHONE-ERROR                                          18430000
184400            SET PS-ERROR          TO TRUE                         18440000
184500            SET DP020-MSG-FATAL   TO TRUE                         18450000
184600            MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER             18460000
184700            MOVE DP015-UNP-ALP-BRT-OFF                            18470000
184800                                  TO APHONE1A                     18480000
184900            MOVE DP015-RED        TO APHONE1C                     18490000
185000            MOVE DP015-REVERSE    TO APHONE1H                     18500000
185100            MOVE -1               TO APHONE1L                     18510000
185200            SET DP030-SET-CURSOR-APPL-1                           18520000
185300                                  TO TRUE                         18530000
185400          ELSE                                                    18540000
185500            MOVE WS-REFORMATTED-PHONE-NBR  TO ASC-TEL1-NBR        18550000
185600                                              APHONE1I            18560000
185700          END-IF                                                  18570000
185800        END-IF                                                    18580000
185900     END-IF.                                                      18590000
186000                                                                  18600000
186100     IF ASC-TEL1-EXT-NBR > SPACES                                 18610000
186200        MOVE ASC-TEL1-EXT-NBR    TO DP010I-UNEDITED-FIELD         18620000
186300        MOVE 4                   TO DP010I-MAXIMUM-DIGITS         18630000
186400        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       18640000
186500        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   18650000
186600                                                                  18660000
186710        CALL DP010I-NUMERIC-EDIT-ROUTINE                          18671005
186720                         USING DP010I-NUMERIC-EDIT-AREA           18672005
186800                                                                  18680000
186900        IF DP010I-ERROR-DETECTED                                  18690000
187000          SET PS-ERROR          TO TRUE                           18700000
187100          SET DP020-MSG-FATAL   TO TRUE                           18710000
187200*            --- MUST BE NUMERIC    ---                           18720000
187300          MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER               18730000
187400          MOVE DP015-UNP-ALP-BRT-OFF                              18740000
187500                                TO AEXT1A                         18750000
187600          MOVE DP015-RED        TO AEXT1C                         18760000
187700          MOVE DP015-REVERSE    TO AEXT1H                         18770000
187800          MOVE -1               TO AEXT1L                         18780000
187900          SET DP030-SET-CURSOR-APPL-1                             18790000
188000                                TO TRUE                           18800000
188100        END-IF                                                    18810000
188200     END-IF.                                                      18820000
188300                                                                  18830000
188400     IF ASC-TEL2-NBR > SPACES                                     18840000
188500       MOVE SPACES TO WS-PHONE-WITH-DASHES                        18850000
188600                      WS-PHONE-MINUS-DASHES                       18860000
188700                      WS-REFORMATTED-PHONE-NBR                    18870000
188800       MOVE ZEROES              TO WS-SUB2                        18880000
188900                                   WS-DIGIT-COUNT                 18890000
189000       MOVE ASC-TEL2-NBR        TO WS-PHONE-WITH-DASHES           18900000
189100       SET NO-PHONE-ERROR       TO TRUE                           18910000
189200       SET NO-FAX-EDIT          TO TRUE                           18920000
189300       PERFORM 3020-CHECK-PHONE-NUMBER                            18930000
189400           VARYING WS-SUB1 FROM 1 BY 1                            18940000
189500             UNTIL WS-SUB1 > 18 OR PHONE-ERROR                    18950000
189600       IF PHONE-ERROR                                             18960000
189700          SET PS-ERROR          TO TRUE                           18970000
189800          SET DP020-MSG-FATAL   TO TRUE                           18980000
189900*            --- MUST BE NUMERIC    ---                           18990000
190000          MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER               19000000
190100          MOVE DP015-UNP-ALP-BRT-OFF                              19010000
190200                                TO APHONE2A                       19020000
190300          MOVE DP015-RED        TO APHONE2C                       19030000
190400          MOVE DP015-REVERSE    TO APHONE2H                       19040000
190500          MOVE -1               TO APHONE2L                       19050000
190600          SET DP030-SET-CURSOR-APPL-1                             19060000
190700                                TO TRUE                           19070000
190800       ELSE                                                       19080000
190900         PERFORM 3030-REFORMAT-PHONE-NUMBER                       19090000
191000         IF PHONE-ERROR                                           19100000
191100           SET PS-ERROR          TO TRUE                          19110000
191200           SET DP020-MSG-FATAL   TO TRUE                          19120000
191300           MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER              19130000
191400           MOVE DP015-UNP-ALP-BRT-OFF                             19140000
191500                                 TO APHONE2A                      19150000
191600           MOVE DP015-RED        TO APHONE2C                      19160000
191700           MOVE DP015-REVERSE    TO APHONE2H                      19170000
191800           MOVE -1               TO APHONE2L                      19180000
191900           SET DP030-SET-CURSOR-APPL-1                            19190000
192000                                 TO TRUE                          19200000
192100         ELSE                                                     19210000
192200            MOVE WS-REFORMATTED-PHONE-NBR  TO ASC-TEL2-NBR        19220000
192300                                              APHONE2I            19230000
192400         END-IF                                                   19240000
192500       END-IF                                                     19250000
192600     END-IF.                                                      19260000
192700                                                                  19270000
192800     IF ASC-TEL2-EXT-NBR > SPACES                                 19280000
192900       MOVE ASC-TEL2-EXT-NBR    TO DP010I-UNEDITED-FIELD          19290000
193000       MOVE 4                   TO DP010I-MAXIMUM-DIGITS          19300000
193100       MOVE 0                   TO DP010I-MAXIMUM-DECIMALS        19310000
193200       SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                    19320000
193300                                                                  19330000
193410       CALL DP010I-NUMERIC-EDIT-ROUTINE                           19341005
193420                         USING DP010I-NUMERIC-EDIT-AREA           19342005
193500                                                                  19350000
193600       IF DP010I-ERROR-DETECTED                                   19360000
193700         SET PS-ERROR          TO TRUE                            19370000
193800         SET DP020-MSG-FATAL   TO TRUE                            19380000
193900*            --- MUST BE NUMERIC    ---                           19390000
194000         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                19400000
194100         MOVE DP015-UNP-ALP-BRT-OFF                               19410000
194200                               TO AEXT2A                          19420000
194300         MOVE DP015-RED        TO AEXT2C                          19430000
194400         MOVE DP015-REVERSE    TO AEXT2H                          19440000
194500         MOVE -1               TO AEXT2L                          19450000
194600         SET DP030-SET-CURSOR-APPL-1                              19460000
194700                               TO TRUE                            19470000
194800       END-IF                                                     19480000
194900     END-IF.                                                      19490000
195000                                                                  19500000
195100     IF ASC-FAX-NBR > SPACES                                      19510000
195200       MOVE SPACES TO WS-PHONE-WITH-DASHES                        19520000
195300                      WS-PHONE-MINUS-DASHES                       19530000
195400                      WS-FAX-NUMBER                               19540000
195500                      WS-FAX-NBR-REFORMAT                         19550000
195600                      WS-FAX2-CHECK                               19560000
195700                      WS-REFORMATTED-PHONE-NBR                    19570000
195800       MOVE ZEROES              TO WS-SUB2                        19580000
195900                                   WS-DIGIT-COUNT                 19590000
196000       MOVE ASC-FAX-NBR         TO WS-FAX-NUMBER                  19600000
196100       MOVE WS-FAX-NBR1         TO WS-PHONE-WITH-DASHES           19610000
196200       SET NO-PHONE-ERROR       TO TRUE                           19620000
196300       PERFORM 3020-CHECK-PHONE-NUMBER                            19630000
196400          VARYING WS-SUB1 FROM 1 BY 1                             19640000
196500            UNTIL WS-SUB1 > 18 OR PHONE-ERROR                     19650000
196600       IF PHONE-ERROR                                             19660000
196700          SET PS-ERROR          TO TRUE                           19670000
196800          SET DP020-MSG-FATAL   TO TRUE                           19680000
196900*            --- MUST BE NUMERIC    ---                           19690000
197000          MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER               19700000
197100          MOVE DP015-UNP-ALP-BRT-OFF                              19710000
197200                                TO AFAXA                          19720000
197300          MOVE DP015-RED        TO AFAXC                          19730000
197400          MOVE DP015-REVERSE    TO AFAXH                          19740000
197500          MOVE -1               TO AFAXL                          19750000
197600          SET DP030-SET-CURSOR-APPL-1                             19760000
197700                                TO TRUE                           19770000
197800       ELSE                                                       19780000
197900        IF WS-FAX-NBR2 NOT = SPACES                               19790000
198000          MOVE WS-FAX-NBR2 TO WS-FAX2-CHECK                       19800000
198100          MOVE ZEROES TO WS-SUB2                                  19810000
198200          PERFORM 3040-CHECK-FAX-PART2                            19820000
198300             VARYING WS-SUB1 FROM 1 BY 1                          19830000
198400               UNTIL WS-SUB1 > 6 OR PHONE-ERROR                   19840000
198500        END-IF                                                    19850000
198600        IF NO-PHONE-ERROR                                         19860000
198700          PERFORM 3030-REFORMAT-PHONE-NUMBER                      19870000
198800          IF PHONE-ERROR                                          19880000
198900            SET PS-ERROR          TO TRUE                         19890000
199000            SET DP020-MSG-FATAL   TO TRUE                         19900000
199100            MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER             19910000
199200            MOVE DP015-UNP-ALP-BRT-OFF                            19920000
199300                                  TO AFAXA                        19930000
199400            MOVE DP015-RED        TO AFAXC                        19940000
199500            MOVE DP015-REVERSE    TO AFAXH                        19950000
199600            MOVE -1               TO AFAXL                        19960000
199700            SET DP030-SET-CURSOR-APPL-1                           19970000
199800                                  TO TRUE                         19980000
199900          ELSE                                                    19990000
200000            STRING WS-REFORMATTED-PHONE-NBR DELIMITED BY ' '      20000000
200100                   WS-FAX2-CHECK2 DELIMITED BY ' '                20010000
200200                   INTO WS-FAX-NBR-REFORMAT                       20020000
200300            MOVE WS-FAX-NBR-REFORMAT   TO ASC-FAX-NBR             20030000
200400                                          AFAXI                   20040000
200500          END-IF                                                  20050000
200600        END-IF                                                    20060000
200700       END-IF                                                     20070000
200800     END-IF.                                                      20080000
200900                                                                  20090000
201000     IF ASC-TEL2-CNTY-PH-CD > SPACES                              20100000
201100         MOVE ASC-TEL2-CNTY-PH-CD TO DP010I-UNEDITED-FIELD        20110000
201200         MOVE 3                   TO DP010I-MAXIMUM-DIGITS        20120000
201300         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      20130000
201400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  20140000
201500                                                                  20150000
201610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20161005
201620                         USING DP010I-NUMERIC-EDIT-AREA           20162005
201700                                                                  20170000
201800         IF DP010I-ERROR-DETECTED                                 20180000
201900             SET PS-ERROR          TO TRUE                        20190000
202000             SET DP020-MSG-FATAL   TO TRUE                        20200000
202100*            --- MUST BE NUMERIC    ---                           20210000
202200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20220000
202300             MOVE DP015-UNP-ALP-BRT-OFF                           20230000
202400                                   TO ACPC2A                      20240000
202500             MOVE DP015-RED        TO ACPC2C                      20250000
202600             MOVE DP015-REVERSE    TO ACPC2H                      20260000
202700             MOVE -1               TO ACPC2L                      20270000
202800             SET DP030-SET-CURSOR-APPL-1                          20280000
202900                                   TO TRUE                        20290000
203000         END-IF                                                   20300000
203100     END-IF.                                                      20310000
203200                                                                  20320000
203300     IF ASC-TEL1-CNTY-PH-CD > SPACES                              20330000
203400         MOVE ASC-TEL1-CNTY-PH-CD TO DP010I-UNEDITED-FIELD        20340000
203500         MOVE 3                   TO DP010I-MAXIMUM-DIGITS        20350000
203600         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      20360000
203700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  20370000
203800                                                                  20380000
203910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20391005
203920                         USING DP010I-NUMERIC-EDIT-AREA           20392005
204000                                                                  20400000
204100         IF DP010I-ERROR-DETECTED                                 20410000
204200             SET PS-ERROR          TO TRUE                        20420000
204300             SET DP020-MSG-FATAL   TO TRUE                        20430000
204400*            --- MUST BE NUMERIC    ---                           20440000
204500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20450000
204600             MOVE DP015-UNP-ALP-BRT-OFF                           20460000
204700                                   TO ACPC1A                      20470000
204800             MOVE DP015-RED        TO ACPC1C                      20480000
204900             MOVE DP015-REVERSE    TO ACPC1H                      20490000
205000             MOVE -1               TO ACPC1L                      20500000
205100             SET DP030-SET-CURSOR-APPL-1                          20510000
205200                                   TO TRUE                        20520000
205300         END-IF                                                   20530000
205400     END-IF.                                                      20540000
205500                                                                  20550000
205600*----------------------------------------------------------------*20560000
205700*    RETRIEVE COUNTRY AND STATE NAME                             *20570000
205800*----------------------------------------------------------------*20580000
205900 3010-RETRIEVE-ST-PRV-CNTY-NAME.                                  20590000
206000                                                                  20600000
206100     MOVE ASC-STATE-CDE          TO DP410-STATE-CODE.             20610000
206200     MOVE ASC-COUNTRY-CDE        TO DP410-COUNTRY-CODE.           20620000
206300     INITIALIZE                     ASC-STATE-NAME                20630000
206400                                    ASC-COUNTRY-NAME.             20640000
206500                                                                  20650000
206600     CALL PC-DPKUT410 USING DFHEIBLK                              20660000
206700                            PV-DPKUT410-COMMAREA                  20670000
206800                            DP410-ST-PROV-CNTRY-ROUTINE.          20680000
206900                                                                  20690000
207000     EVALUATE TRUE                                                20700000
207100                                                                  20710000
207200         WHEN  DP410-NO-ERRORS                                    20720000
207300             MOVE DP410-STATE-CODE   TO ASC-STATE-CDE             20730000
207400             MOVE DP410-STATE-NAME   TO ASC-STATE-NAME            20740000
207500             MOVE DP410-COUNTRY-CODE TO ASC-COUNTRY-CDE           20750000
207600             MOVE DP410-COUNTRY-NAME TO ASC-COUNTRY-NAME          20760000
207700             IF ASC-COUNTRY-CDE = 'US ' OR '   '                  20770000
207800                 MOVE DP410-STATE-CODE   TO ASC-OLD-STATE-CDE     20780000
207900             ELSE                                                 20790000
208000                 MOVE SPACES             TO ASC-OLD-STATE-CDE     20800000
208100             END-IF                                               20810000
208200                                                                  20820000
208300         WHEN  DP410-DEADLOCK-BYPASS-ROUTINE                      20830000
208400             MOVE DP410-STATE-CODE TO ASC-STATE-CDE               20840000
208500             MOVE DP410-COUNTRY-CODE TO ASC-COUNTRY-CDE           20850000
208600             IF ASC-COUNTRY-CDE = 'US ' OR '   '                  20860000
208700                 MOVE DP410-STATE-CODE   TO ASC-OLD-STATE-CDE     20870000
208800             ELSE                                                 20880000
208900                 MOVE SPACES             TO ASC-OLD-STATE-CDE     20890000
209000             END-IF                                               20900000
209100                                                                  20910000
209200         WHEN  DP410-MUST-ENTER-STATE                             20920000
209300             IF ASC-CITY > SPACES                                 20930000
209400                 SET PS-ERROR         TO TRUE                     20940000
209500                 SET DP020-MSG-FATAL  TO TRUE                     20950000
209600                 MOVE PC-TSYMSG-01879 TO DP020-MSG-NUMBER         20960000
209700                 MOVE DP015-UNP-ALP-BRT-OFF                       20970000
209800                                      TO ASTCDEA                  20980000
209900                 MOVE DP015-RED       TO ASTCDEC                  20990000
210000                 MOVE DP015-REVERSE   TO ASTCDEH                  21000000
210100                 MOVE -1              TO ASTCDEL                  21010000
210200                 SET DP030-SET-CURSOR-APPL-1                      21020000
210300                                      TO TRUE                     21030000
210400             END-IF                                               21040000
210500                                                                  21050000
210600         WHEN  DP410-INVALID-COUNTRY                              21060000
210700             SET PS-ERROR         TO TRUE                         21070000
210800             SET DP020-MSG-FATAL  TO TRUE                         21080000
210900             MOVE PC-TSYMSG-01880 TO DP020-MSG-NUMBER             21090000
211000             MOVE DP015-UNP-ALP-BRT-OFF                           21100000
211100                                  TO ACNTCDA                      21110000
211200             MOVE DP015-RED       TO ACNTCDC                      21120000
211300             MOVE DP015-REVERSE   TO ACNTCDH                      21130000
211400             MOVE -1              TO ACNTCDL                      21140000
211500             SET DP030-SET-CURSOR-APPL-1                          21150000
211600                                  TO TRUE                         21160000
211700                                                                  21170000
211800         WHEN  DP410-INVALID-STATE                                21180000
211900             SET PS-ERROR         TO TRUE                         21190000
212000             SET DP020-MSG-FATAL  TO TRUE                         21200000
212100             MOVE PC-TSYMSG-01881 TO DP020-MSG-NUMBER             21210000
212200             MOVE DP015-UNP-ALP-BRT-OFF                           21220000
212300                                  TO ASTCDEA                      21230000
212400             MOVE DP015-RED       TO ASTCDEC                      21240000
212500             MOVE DP015-REVERSE   TO ASTCDEH                      21250000
212600             MOVE -1              TO ASTCDEL                      21260000
212700             SET DP030-SET-CURSOR-APPL-1                          21270000
212800                                  TO TRUE                         21280000
212900                                                                  21290000
213000         WHEN  DP410-DB2-ERROR                                    21300000
213100             MOVE DP410-PARAGRAPH-NAME                            21310000
213200                                     TO DP013-PARAGRAPH           21320000
213300             MOVE DP410-PROGRAM-NAME TO DP013-MESSAGE-TEXT (1)    21330000
213400             MOVE DP410-MESSAGE      TO DP013-MESSAGE-TEXT (2)    21340000
213500             MOVE DP410-SQLCODE      TO DP013-SQLCA               21350000
213600             SET DP013-DB2-ABEND     TO TRUE                      21360000
213700             PERFORM DP013-0000-PROCESS-ABEND                     21370000
213800                                                                  21380000
213900     END-EVALUATE.                                                21390000
214000                                                                  21400000
214100     MOVE ASC-STATE-NAME             TO ASTNMEO.                  21410000
214200     MOVE ASC-COUNTRY-NAME           TO ACNTNMO.                  21420000
214300                                                                  21430000
214400/                                                                 21440000
214500*----------------------------------------------------------------*21450000
214600*    REFORMAT PHONE/FAX NUMBERS TO REMOVE DASHES                 *21460000
214700*----------------------------------------------------------------*21470000
214800 3020-CHECK-PHONE-NUMBER.                                         21480000
214900     MOVE WS-PHN-WD-BYTE (WS-SUB1) TO WS-VALID-DIGIT.             21490000
215000                                                                  21500000
215100     IF VALID-DIGIT                                               21510000
215200       ADD 1 TO WS-SUB2                                           21520000
215300                 WS-DIGIT-COUNT                                   21530000
215400       MOVE WS-PHN-WD-BYTE (WS-SUB1) TO WS-PHN-MD-BYTE (WS-SUB2)  21540000
215500     ELSE                                                         21550000
215600     IF WS-PHN-WD-BYTE (WS-SUB1) NOT = '-' AND                    21560000
215700        WS-PHN-WD-BYTE (WS-SUB1) NOT = ' '                        21570000
215800       SET PHONE-ERROR TO TRUE.                                   21580000
215900                                                                  21590000
216000 3030-REFORMAT-PHONE-NUMBER.                                      21600000
216100     MOVE SPACES TO WS-REFORMATTED-PHONE-NBR.                     21610000
216200                                                                  21620000
216300     IF WS-DIGIT-COUNT < 7                                        21630000
216400        SET PHONE-ERROR TO TRUE                                   21640000
216500     ELSE                                                         21650000
216600     IF WS-DIGIT-COUNT = 7                                        21660000
216700        MOVE WS-PHN-MD1       TO WS-TELE-F1-1                     21670000
216800        MOVE WS-PHN-MD2       TO WS-TELE-F1-2                     21680000
216900        MOVE WS-PHN-MD3       TO WS-TELE-F1-3                     21690000
217000        MOVE WS-PHN-MD4       TO WS-TELE-F1-4                     21700000
217100        MOVE WS-PHN-MD5       TO WS-TELE-F1-5                     21710000
217200        MOVE WS-PHN-MD6       TO WS-TELE-F1-6                     21720000
217300        MOVE WS-PHN-MD7       TO WS-TELE-F1-7                     21730000
217400        MOVE WS-TELE-FORMAT1  TO WS-REFORMATTED-PHONE-NBR         21740000
217500     ELSE                                                         21750000
217600     IF WS-DIGIT-COUNT = 8 AND WS-PHN-MD1 = '1'                   21760000
217700        MOVE WS-PHN-MD1       TO WS-TELE-F2-1                     21770000
217800        MOVE WS-PHN-MD2       TO WS-TELE-F2-2                     21780000
217900        MOVE WS-PHN-MD3       TO WS-TELE-F2-3                     21790000
218000        MOVE WS-PHN-MD4       TO WS-TELE-F2-4                     21800000
218100        MOVE WS-PHN-MD5       TO WS-TELE-F2-5                     21810000
218200        MOVE WS-PHN-MD6       TO WS-TELE-F2-6                     21820000
218300        MOVE WS-PHN-MD7       TO WS-TELE-F2-7                     21830000
218400        MOVE WS-PHN-MD8       TO WS-TELE-F2-8                     21840000
218500        MOVE WS-TELE-FORMAT2  TO WS-REFORMATTED-PHONE-NBR         21850000
218600     ELSE                                                         21860000
218700     IF WS-DIGIT-COUNT = 10                                       21870000
218800        MOVE WS-PHN-MD1       TO WS-TELE-F3-1                     21880000
218900        MOVE WS-PHN-MD2       TO WS-TELE-F3-2                     21890000
219000        MOVE WS-PHN-MD3       TO WS-TELE-F3-3                     21900000
219100        MOVE WS-PHN-MD4       TO WS-TELE-F3-4                     21910000
219200        MOVE WS-PHN-MD5       TO WS-TELE-F3-5                     21920000
219300        MOVE WS-PHN-MD6       TO WS-TELE-F3-6                     21930000
219400        MOVE WS-PHN-MD7       TO WS-TELE-F3-7                     21940000
219500        MOVE WS-PHN-MD8       TO WS-TELE-F3-8                     21950000
219600        MOVE WS-PHN-MD9       TO WS-TELE-F3-9                     21960000
219700        MOVE WS-PHN-MD10      TO WS-TELE-F3-10                    21970000
219800        MOVE WS-TELE-FORMAT3  TO WS-REFORMATTED-PHONE-NBR         21980000
219900     ELSE                                                         21990000
220000     IF WS-DIGIT-COUNT = 11 AND WS-PHN-MD1 = '1'                  22000000
220100        MOVE WS-PHN-MD1       TO WS-TELE-F4-1                     22010000
220200        MOVE WS-PHN-MD2       TO WS-TELE-F4-2                     22020000
220300        MOVE WS-PHN-MD3       TO WS-TELE-F4-3                     22030000
220400        MOVE WS-PHN-MD4       TO WS-TELE-F4-4                     22040000
220500        MOVE WS-PHN-MD5       TO WS-TELE-F4-5                     22050000
220600        MOVE WS-PHN-MD6       TO WS-TELE-F4-6                     22060000
220700        MOVE WS-PHN-MD7       TO WS-TELE-F4-7                     22070000
220800        MOVE WS-PHN-MD8       TO WS-TELE-F4-8                     22080000
220900        MOVE WS-PHN-MD9       TO WS-TELE-F4-9                     22090000
221000        MOVE WS-PHN-MD10      TO WS-TELE-F4-10                    22100000
221100        MOVE WS-PHN-MD11      TO WS-TELE-F4-11                    22110000
221200        MOVE WS-TELE-FORMAT4  TO WS-REFORMATTED-PHONE-NBR         22120000
221300     ELSE                                                         22130000
221400     IF WS-DIGIT-COUNT > 7                                        22140000
221500        MOVE WS-PHONE-WITH-DASHES  TO WS-REFORMATTED-PHONE-NBR    22150000
221600     ELSE                                                         22160000
221700        SET PHONE-ERROR TO TRUE.                                  22170000
221800                                                                  22180000
221900 3040-CHECK-FAX-PART2.                                            22190000
222000     MOVE WS-FAX2-BYTE (WS-SUB1) TO WS-VALID-DIGIT.               22200000
222100     IF VALID-DIGIT                                               22210000
222200        ADD 1 TO WS-SUB2                                          22220000
222300        MOVE WS-FAX2-BYTE (WS-SUB1) TO WS-FAX2-NBR (WS-SUB2)      22230000
222400     ELSE                                                         22240000
222500     IF WS-FAX2-BYTE (WS-SUB1) NOT = ' ' AND                      22250000
222600                           WS-FAX2-BYTE (WS-SUB1) NOT = '-'       22260000
222700        SET PHONE-ERROR TO TRUE.                                  22270000
222800                                                                  22280000
222900 3050-EDIT-PRIM-ADDR-IND.                                         22290000
223000                                                                  22300000
223100     MOVE SPACE TO ASC-UPDATE-AND-CHANGE-SW                       22310000
223200                   PS-PRIM-ADDR-IND-SW.                           22320000
223300                                                                  22330000
223400     IF ASC-PRIM-ADDR-IND = SPACE                                 22340000
223500        MOVE 'N' TO ASC-PRIM-ADDR-IND                             22350000
223600     END-IF.                                                      22360000
223700                                                                  22370000
223800     EVALUATE ASC-PRIM-ADDR-IND                                   22380000
223900        WHEN 'N'                                                  22390000
224000              PERFORM 3100-SELECT-TBUSLOC-PRIMARY                 22400000
224100              IF PRIM-ADDR-IND-SAME                               22410000
224200                 SET PS-ERROR     TO TRUE                         22420000
224300                 SET DP020-MSG-FATAL TO TRUE                      22430000
224400** CANNOT CHANGE TO NON-PRIMARY - NO OTHER PRIMARY EXISTS         22440000
224500                 MOVE PC-TSYMSG-02606 TO DP020-MSG-NUMBER         22450000
224600                 MOVE DP015-UNP-ALP-BRT-OFF                       22460000
224700                                  TO APMADINA                     22470000
224800                 MOVE DP015-RED   TO APMADINC                     22480000
224900                 MOVE DP015-REVERSE TO APMADINH                   22490000
225000                 MOVE -1          TO APMADINL                     22500000
225100                 SET DP030-SET-CURSOR-APPL-1                      22510000
225200                                       TO TRUE                    22520000
225300              END-IF                                              22530000
225400              IF PRIM-ADDR-IND-NOT-FOUND                          22540000
225500                 MOVE 'Y' TO ASC-PRIM-ADDR-IND                    22550000
225600                 IF DP020-MSG-FATAL                               22560000
225700                    CONTINUE                                      22570000
225800                 ELSE                                             22580000
225900                    SET DP020-MSG-INFORMATIONAL TO TRUE           22590000
226000                    SET ASC-UPDATE-WITH-CHANGE TO TRUE            22600000
226100** UPDATE OK - PRIM ADDR NOT FOUND, CURRENT ADDR IS PRIM          22610000
226200                    MOVE PC-TSYMSG-02600 TO DP020-MSG-NUMBER      22620000
226300                 END-IF                                           22630000
226400              END-IF                                              22640000
226500              MOVE SPACE           TO PS-PRIM-ADDR-IND-SW         22650000
226600        WHEN 'Y'                                                  22660000
226700              PERFORM 3100-SELECT-TBUSLOC-PRIMARY                 22670000
226800              IF PRIM-ADDR-IND-SAME OR PRIM-ADDR-IND-NOT-FOUND    22680000
226900                 CONTINUE                                         22690000
227000              ELSE                                                22700000
227100                 PERFORM 8200-GET-ADDRESS-INFORMATION             22710000
227200                 PERFORM 3150-UPDATE-TBUSLOC-PRIMARY              22720000
227300                 IF DP020-MSG-FATAL                               22730000
227400                    CONTINUE                                      22740000
227500                 ELSE                                             22750000
227600                    SET DP020-MSG-INFORMATIONAL TO TRUE           22760000
227700                    SET ASC-UPDATE-WITH-CHANGE TO TRUE            22770000
227800** UPDATE OK - EXISTING PRIM ADDR FOUND, NOW NON-PRIMARY          22780000
227900                    MOVE PC-TSYMSG-02601 TO DP020-MSG-NUMBER      22790000
228000                 END-IF                                           22800000
228100              END-IF                                              22810000
228200        WHEN OTHER                                                22820000
228300            SET PS-ERROR          TO TRUE                         22830000
228400            SET DP020-MSG-FATAL   TO TRUE                         22840000
228500** VALID VALUES ARE 'Y' OR 'N'                                    22850000
228600            MOVE PC-TSYMSG-02595 TO DP020-MSG-NUMBER              22860000
228700            MOVE DP015-UNP-ALP-BRT-OFF                            22870000
228800                                  TO APMADINA                     22880000
228900            MOVE DP015-RED        TO APMADINC                     22890000
229000            MOVE DP015-REVERSE    TO APMADINH                     22900000
229100            MOVE -1               TO APMADINL                     22910000
229200            SET DP030-SET-CURSOR-APPL-1                           22920000
229300                                  TO TRUE                         22930000
229400     END-EVALUATE.                                                22940000
229500                                                                  22950000
229600 3060-EDIT-ADDRESS.                                               22960000
229700                                                                  22970000
229800     IF ASC-ADDR1-EXNAME(31:10) > SPACES                          22980000
229900         MOVE DP015-UNP-ALP-BRT-OFF                               22990000
230000                                  TO AD1ENMA                      23000000
230100         MOVE DP015-RED           TO AD1ENMC                      23010000
230200         MOVE DP015-REVERSE       TO AD1ENMH                      23020000
230300         MOVE -1                  TO AD1ENML                      23030000
230400         SET PS-ERROR                                             23040000
230500             DP020-MSG-FATAL                                      23050000
230600             DP030-SET-CURSOR-TRAILER                             23060000
230700                                     TO TRUE                      23070000
230800*** MAX LENGTH 30 CHARACTERS                                      23080000
230900         MOVE PC-TSYMSG-02596 TO DP020-MSG-NUMBER                 23090000
231000     END-IF.                                                      23100000
231100                                                                  23110000
231200     IF ASC-ADDR12-DESC (31:10) > SPACES                          23120000
231300         MOVE DP015-UNP-ALP-BRT-OFF                               23130000
231400                                  TO AADDR12A                     23140000
231500         MOVE DP015-RED           TO AADDR23C                     23150000
231600         MOVE DP015-REVERSE       TO AADDR12H                     23160000
231700         MOVE -1                  TO AADDR12L                     23170000
231800         SET PS-ERROR                                             23180000
231900             DP020-MSG-FATAL                                      23190000
232000             DP030-SET-CURSOR-TRAILER                             23200000
232100                                     TO TRUE                      23210000
232200*** MAX LENGTH 30 CHARACTERS                                      23220000
232300         MOVE PC-TSYMSG-02596 TO DP020-MSG-NUMBER                 23230000
232400     END-IF.                                                      23240000
232500                                                                  23250000
232600     IF ASC-ADDR23-DESC (31:10) > SPACES                          23260000
232700         MOVE DP015-UNP-ALP-BRT-OFF                               23270000
232800                                  TO AADDR23A                     23280000
232900         MOVE DP015-RED           TO AADDR23C                     23290000
233000         MOVE DP015-REVERSE       TO AADDR23H                     23300000
233100         MOVE -1                  TO AADDR23L                     23310000
233200         SET PS-ERROR                                             23320000
233300             DP020-MSG-FATAL                                      23330000
233400             DP030-SET-CURSOR-TRAILER                             23340000
233500                                     TO TRUE                      23350000
233600*** MAX LENGTH 30 CHARACTERS                                      23360000
233700         MOVE PC-TSYMSG-02596 TO DP020-MSG-NUMBER                 23370000
233800     END-IF.                                                      23380000
233900                                                                  23390000
234000     IF ASC-ADDR34-DESC > SPACES                                  23400000
234100         SET PS-ERROR                                             23410000
234200             DP020-MSG-FATAL  TO TRUE                             23420000
234300            MOVE DP015-UNP-ALP-BRT-OFF                            23430000
234400                                  TO AADDR34A                     23440000
234500            MOVE DP015-RED        TO AADDR34C                     23450000
234600            MOVE DP015-REVERSE    TO AADDR34H                     23460000
234700            MOVE -1               TO AADDR34L                     23470000
234800            SET DP030-SET-CURSOR-APPL-1                           23480000
234900                                  TO TRUE                         23490000
235000***  ADDRESS LINE 4 NOT ALLOWED                                   23500000
235100         MOVE PC-TSYMSG-02597 TO DP020-MSG-NUMBER                 23510000
235200     END-IF.                                                      23520000
235300                                                                  23530000
235400     IF ASC-CITY(21:10) > SPACES                                  23540000
235500         MOVE DP015-UNP-ALP-BRT-OFF                               23550000
235600                                  TO ACITYA                       23560000
235700         MOVE DP015-RED           TO ACITYC                       23570000
235800         MOVE DP015-REVERSE       TO ACITYH                       23580000
235900         MOVE -1                  TO ACITYL                       23590000
236000         SET PS-ERROR                                             23600000
236100             DP020-MSG-FATAL                                      23610000
236200             DP030-SET-CURSOR-TRAILER                             23620000
236300                                     TO TRUE                      23630000
236400***  MAX LIMIT 20 CHARACTERS                                      23640000
236500         MOVE PC-TSYMSG-02598 TO DP020-MSG-NUMBER                 23650000
236600     END-IF.                                                      23660000
236700                                                                  23670000
236800     IF ASC-FAX-NBR (21:4) > SPACES                               23680000
236900         SET PS-ERROR                                             23690000
237000             DP020-MSG-FATAL                                      23700000
237100             DP030-SET-CURSOR-TRAILER                             23710000
237200                                     TO TRUE                      23720000
237300***  MAX LIMIT 20 CHARACTERS                                      23730000
237400         MOVE PC-TSYMSG-02598 TO DP020-MSG-NUMBER                 23740000
237500         MOVE DP015-UNP-ALP-BRT-OFF                               23750000
237600                                  TO AFAXA                        23760000
237700         MOVE DP015-RED           TO AFAXC                        23770000
237800         MOVE DP015-REVERSE       TO AFAXH                        23780000
237900         MOVE -1                  TO AFAXL                        23790000
238000     END-IF.                                                      23800000
238100                                                                  23810000
238200     IF ASC-ZIP(11:2) > SPACES                                    23820000
238300         MOVE DP015-UNP-ALP-BRT-OFF                               23830000
238400                                  TO AZIPCDEA                     23840000
238500         MOVE DP015-RED           TO AZIPCDEC                     23850000
238600         MOVE DP015-REVERSE       TO AZIPCDEH                     23860000
238700         MOVE -1                  TO AZIPCDEL                     23870000
238800         SET PS-ERROR                                             23880000
238900             DP020-MSG-FATAL                                      23890000
239000             DP030-SET-CURSOR-TRAILER                             23900000
239100                                     TO TRUE                      23910000
239200***  MAX LIMIT 10 CHARACTERS                                      23920000
239300         MOVE PC-TSYMSG-02668 TO DP020-MSG-NUMBER                 23930000
239400     END-IF.                                                      23940000
239500                                                                  23950000
239600     STRING ASC-FIRST-NAME      DELIMITED BY '  '                 23960000
239700            ' '                 DELIMITED BY SIZE                 23970000
239800            ASC-LAST-NAME       DELIMITED BY '  '                 23980000
239900            INTO PV-RMS-NAME.                                     23990000
240000                                                                  24000000
240100     IF PV-RMS-NAME(21:11) > SPACES                               24010000
240200         MOVE DP015-UNP-ALP-BRT-OFF                               24020000
240300                                  TO AFNAMEA                      24030000
240400                                     ALNAMEA                      24040000
240500         MOVE DP015-RED           TO AFNAMEC                      24050000
240600                                     ALNAMEC                      24060000
240700         MOVE DP015-REVERSE       TO AFNAMEH                      24070000
240800                                     ALNAMEH                      24080000
240900         MOVE -1                  TO AFNAMEL                      24090000
241000         SET PS-ERROR                                             24100000
241100             DP020-MSG-FATAL                                      24110000
241200             DP030-SET-CURSOR-TRAILER                             24120000
241300                                     TO TRUE                      24130000
241400***  MAX LIMIT 20 CHARACTERS                                      24140000
241500         MOVE PC-TSYMSG-02599 TO DP020-MSG-NUMBER                 24150000
241600     END-IF.                                                      24160000
241700                                                                  24170000
241800 3100-SELECT-TBUSLOC-PRIMARY.                                     24180000
241900                                                                  24190000
242000     PERFORM                                                      24200000
242100         WITH TEST AFTER                                          24210000
242200         VARYING PV-RETRY-COUNTER                                 24220000
242300         FROM 1 BY 1                                              24230000
242400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24240000
242500             OR (SQLCODE = +0) OR (SQLCODE = +100))               24250000
242600                                                                  24260000
242700         EXEC SQL                                                 24270000
242800              SELECT SEQ_NBR                                      24280000
242900                INTO :PV-BUSLOC-SEQ-NBR                           24290000
243000                FROM TBUSLOC                                      24300000
243100               WHERE ENT_ID = :ASC-KEY-ENT-ID                     24310000
243200                 AND FUNCTION_ID = :ASC-KEY-FUNCTION-ID           24320000
243300                 AND PRIM_ADDR_IND = 'Y'                          24330000
243400         END-EXEC                                                 24340000
243500                                                                  24350000
243600         EVALUATE TRUE                                            24360000
243700             WHEN SQLCODE = +0                                    24370000
243800               IF ASC-TBUSLOC-SEQ-NBR = PV-BUSLOC-SEQ-NBR         24380000
243900                  SET PRIM-ADDR-IND-SAME TO TRUE                  24390000
244000               ELSE                                               24400000
244100                  SET PRIM-ADDR-IND-DIFFERENT TO TRUE             24410000
244200               END-IF                                             24420000
244300             WHEN SQLCODE = +100                                  24430000
244400                  SET PRIM-ADDR-IND-NOT-FOUND TO TRUE             24440000
244500             WHEN SQLCODE = -904                                  24450000
244600             WHEN SQLCODE = -913                                  24460000
244700                  CONTINUE                                        24470000
244800             WHEN SQLWARN0 NOT = SPACES                           24480000
244900             WHEN SQLCODE < +0                                    24490000
245000             WHEN SQLCODE > +0                                    24500000
245100                  MOVE '3100-SELECT-TBUSLOC '                     24510000
245200                                  TO DP013-PARAGRAPH              24520000
245300                  MOVE 'UNSUCCESSFUL SELECT PRIM ADDR '           24530000
245400                                  TO DP013-MESSAGE-TEXT (1)       24540000
245500                  MOVE SQLCA      TO DP013-SQLCA                  24550000
245600                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     24560000
245700                  SET DP013-DB2-ABEND                             24570000
245800                      DP013-XCTL-DISPLAY-RESTART                  24580000
245900                                  TO TRUE                         24590000
246000                  PERFORM DP013-0000-PROCESS-ABEND                24600000
246100         END-EVALUATE                                             24610000
246200     END-PERFORM.                                                 24620000
246300                                                                  24630000
246400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24640000
246500         MOVE '3100-SELECT-TBUSLOC ' TO DP013-PARAGRAPH           24650000
246600         MOVE 'MAX RETRIES EXCEEDED ON SELECT PRIM ADDR'          24660000
246700                                  TO DP013-MESSAGE-TEXT (1)       24670000
246800         MOVE SQLCA               TO DP013-SQLCA                  24680000
246900         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     24690000
247000         SET DP013-DB2-ABEND                                      24700000
247100             DP013-XCTL-DISPLAY-RESTART                           24710000
247200                                  TO TRUE                         24720000
247300         PERFORM DP013-0000-PROCESS-ABEND                         24730000
247400     END-IF.                                                      24740000
247500                                                                  24750000
247600 3150-UPDATE-TBUSLOC-PRIMARY.                                     24760000
247700                                                                  24770000
247800     PERFORM                                                      24780000
247900         WITH TEST AFTER                                          24790000
248000         VARYING PV-RETRY-COUNTER                                 24800000
248100         FROM 1 BY 1                                              24810000
248200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24820000
248300             OR (SQLCODE = +0))                                   24830000
248400                                                                  24840000
248500         EXEC SQL                                                 24850000
248600              UPDATE TBUSLOC                                      24860000
248700                SET PRIM_ADDR_IND = 'N'                           24870000
248800               WHERE ENT_ID = :ASC-KEY-ENT-ID                     24880000
248900                 AND FUNCTION_ID = :ASC-KEY-FUNCTION-ID           24890000
249000                 AND PRIM_ADDR_IND = 'Y'                          24900000
249100         END-EXEC                                                 24910000
249200                                                                  24920000
249300         EVALUATE TRUE                                            24930000
249400             WHEN SQLCODE = +0                                    24940000
249500             WHEN SQLCODE = -904                                  24950000
249600             WHEN SQLCODE = -913                                  24960000
249700                  CONTINUE                                        24970000
249800             WHEN SQLWARN0 NOT = SPACES                           24980000
249900             WHEN SQLCODE < +0                                    24990000
250000             WHEN SQLCODE > +0                                    25000000
250100                  MOVE '3150-UPDATE-TBUSLOC '                     25010000
250200                                  TO DP013-PARAGRAPH              25020000
250300                  MOVE 'UNSUCCESSFUL UPDATE PRIM ADDR '           25030000
250400                                  TO DP013-MESSAGE-TEXT (1)       25040000
250500                  MOVE SQLCA      TO DP013-SQLCA                  25050000
250600                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     25060000
250700                  SET DP013-DB2-ABEND                             25070000
250800                      DP013-XCTL-DISPLAY-RESTART                  25080000
250900                                  TO TRUE                         25090000
251000                  PERFORM DP013-0000-PROCESS-ABEND                25100000
251100         END-EVALUATE                                             25110000
251200     END-PERFORM.                                                 25120000
251300                                                                  25130000
251400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25140000
251500         MOVE '3150-UPDATE-TBUSLOC ' TO DP013-PARAGRAPH           25150000
251600         MOVE 'MAX RETRIES EXCEEDED ON UPDATE PRIM ADDR'          25160000
251700                                  TO DP013-MESSAGE-TEXT (1)       25170000
251800         MOVE SQLCA               TO DP013-SQLCA                  25180000
251900         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     25190000
252000         SET DP013-DB2-ABEND                                      25200000
252100             DP013-XCTL-DISPLAY-RESTART                           25210000
252200                                  TO TRUE                         25220000
252300         PERFORM DP013-0000-PROCESS-ABEND                         25230000
252400     END-IF.                                                      25240000
252500                                                                  25250000
252600*----------------------------------------------------------------*25260000
252700*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *25270000
252800*----------------------------------------------------------------*25280000
252900                                                                  25290000
253000 3200-RESET-ATTRIBUTES.                                           25300000
253100                                                                  25310000
253200     IF ASC-ADD-PENDING OR ASC-UPDATE-PENDING                     25320000
253300        IF  ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR            25330000
253400            ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID             25340000
253500            MOVE DP015-UNP-ALP-NOR-OFF  TO APMADINA               25350000
253600            MOVE DP015-GREEN            TO APMADINC               25360000
253700            MOVE DP015-UNDERLINE        TO APMADINH               25370000
253800        END-IF                                                    25380000
253900                                                                  25390000
254000        MOVE DP015-UNP-ALP-NOR-OFF TO AFNAMEA                     25400000
254100                                      ALNAMEA                     25410000
254200                                      ATITLEA                     25420000
254300                                      APHONE1A                    25430000
254400                                      AEXT1A                      25440000
254500                                      ACPC1A                      25450000
254600                                      APHONE2A                    25460000
254700                                      AEXT2A                      25470000
254800                                      ACPC2A                      25480000
254900                                      AFAXA                       25490000
255000                                      AEMAILA                     25500000
255100                                      AD1ENMA                     25510000
255200                                      AADDR12A                    25520000
255300                                      AADDR23A                    25530000
255400                                      AADDR34A                    25540000
255500                                      ACITYA                      25550000
255600                                      ASTCDEA                     25560000
255700                                      AZIPCDEA                    25570000
255800                                      ACNTCDA                     25580000
255900                                      AROOMA                      25590000
256000                                      AATTNTOA                    25600000
256100                                      ACOMM1A                     25610000
256200                                      ACOMM2A                     25620000
256300                                      ACOMM3A                     25630000
256400        MOVE DP015-GREEN           TO AFNAMEC                     25640000
256500                                      ALNAMEC                     25650000
256600                                      ATITLEC                     25660000
256700                                      APHONE1C                    25670000
256800                                      AEXT1C                      25680000
256900                                      ACPC1C                      25690000
257000                                      APHONE2C                    25700000
257100                                      AEXT2C                      25710000
257200                                      ACPC2C                      25720000
257300                                      AFAXC                       25730000
257400                                      AEMAILC                     25740000
257500                                      AD1ENMC                     25750000
257600                                      AADDR12C                    25760000
257700                                      AADDR23C                    25770000
257800                                      AADDR34C                    25780000
257900                                      ACITYC                      25790000
258000                                      ASTCDEC                     25800000
258100                                      AZIPCDEC                    25810000
258200                                      ACNTCDC                     25820000
258300                                      AROOMC                      25830000
258400                                      AATTNTOC                    25840000
258500                                      ACOMM1C                     25850000
258600                                      ACOMM2C                     25860000
258700                                      ACOMM3C                     25870000
258800        MOVE DP015-UNDERLINE       TO AFNAMEH                     25880000
258900                                      ALNAMEH                     25890000
259000                                      ATITLEH                     25900000
259100                                      APHONE1H                    25910000
259200                                      AEXT1H                      25920000
259300                                      ACPC1H                      25930000
259400                                      APHONE2H                    25940000
259500                                      AEXT2H                      25950000
259600                                      ACPC2H                      25960000
259700                                      AFAXH                       25970000
259800                                      AEMAILH                     25980000
259900                                      AD1ENMH                     25990000
260000                                      AADDR12H                    26000000
260100                                      AADDR23H                    26010000
260200                                      AADDR34H                    26020000
260300                                      ACITYH                      26030000
260400                                      ASTCDEH                     26040000
260500                                      AZIPCDEH                    26050000
260600                                      ACNTCDH                     26060000
260700                                      AROOMH                      26070000
260800                                      AATTNTOH                    26080000
260900                                      ACOMM1H                     26090000
261000                                      ACOMM2H                     26100000
261100                                      ACOMM3H                     26110000
261200     ELSE                                                         26120000
261300                                                                  26130000
261400        MOVE DP015-PRO-NOR-OFF     TO AFNAMEA                     26140000
261500                                      ALNAMEA                     26150000
261600                                      APMADINA                    26160000
261700                                      ATITLEA                     26170000
261800                                      APHONE1A                    26180000
261900                                      AEXT1A                      26190000
262000                                      ACPC1A                      26200000
262100                                      APHONE2A                    26210000
262200                                      AEXT2A                      26220000
262300                                      ACPC2A                      26230000
262400                                      AFAXA                       26240000
262500                                      AEMAILA                     26250000
262600                                      AD1ENMTA                    26260000
262700                                      AD1ENMA                     26270000
262800                                      ADDR12TA                    26280000
262900                                      ASTATUSA                    26290000
263000                                      ANODEA                      26300000
263100                                      AADDR12A                    26310000
263200                                      AADDR23A                    26320000
263300                                      AADDR34A                    26330000
263400                                      ACITYA                      26340000
263500                                      ASTCDEA                     26350000
263600                                      ASTNMEA                     26360000
263700                                      AZIPCDEA                    26370000
263800                                      ACNTCDA                     26380000
263900                                      ACNTNMA                     26390000
264000                                      AROOMA                      26400000
264100                                      AATTNTOA                    26410000
264200                                      ACOMM1A                     26420000
264300                                      ACOMM2A                     26430000
264400                                      ACOMM3A                     26440000
264500        MOVE DP015-BLUE            TO AFNAMEC                     26450000
264600                                      ALNAMEC                     26460000
264700                                      APMADINC                    26470000
264800                                      ATITLEC                     26480000
264900                                      APHONE1C                    26490000
265000                                      AEXT1C                      26500000
265100                                      ACPC1C                      26510000
265200                                      APHONE2C                    26520000
265300                                      AEXT2C                      26530000
265400                                      ACPC2C                      26540000
265500                                      AFAXC                       26550000
265600                                      AEMAILC                     26560000
265700                                      AD1ENMC                     26570000
265800                                      AADDR12C                    26580000
265900                                      AADDR23C                    26590000
266000                                      AADDR34C                    26600000
266100                                      ACITYC                      26610000
266200                                      ASTCDEC                     26620000
266300                                      ASTNMEC                     26630000
266400                                      AZIPCDEC                    26640000
266500                                      ACNTCDC                     26650000
266600                                      ACNTNMC                     26660000
266700                                      AROOMC                      26670000
266800                                      AATTNTOC                    26680000
266900                                      ACOMM1C                     26690000
267000                                      ACOMM2C                     26700000
267100                                      ACOMM3C                     26710000
267200        MOVE DP015-WHITE           TO AD1ENMTC                    26720000
267300                                      ADDR12TC                    26730000
267400                                      ASTATUSC                    26740000
267500                                      ANODEC                      26750000
267600        MOVE DP015-HL-OFF          TO AFNAMEH                     26760000
267700                                      ALNAMEH                     26770000
267800                                      APMADINH                    26780000
267900                                      ATITLEH                     26790000
268000                                      APHONE1H                    26800000
268100                                      AEXT1H                      26810000
268200                                      ACPC1H                      26820000
268300                                      APHONE2H                    26830000
268400                                      AEXT2H                      26840000
268500                                      ACPC2H                      26850000
268600                                      AFAXH                       26860000
268700                                      AEMAILH                     26870000
268800                                      AD1ENMTH                    26880000
268900                                      AD1ENMH                     26890000
269000                                      ADDR12TH                    26900000
269100                                      ASTATUSH                    26910000
269200                                      ANODEH                      26920000
269300                                      AADDR12H                    26930000
269400                                      AADDR23H                    26940000
269500                                      AADDR34H                    26950000
269600                                      ACITYH                      26960000
269700                                      ASTCDEH                     26970000
269800                                      ASTNMEH                     26980000
269900                                      AZIPCDEH                    26990000
270000                                      ACNTCDH                     27000000
270100                                      ACNTNMH                     27010000
270200                                      AROOMH                      27020000
270300                                      AATTNTOH                    27030000
270400                                      ACOMM1H                     27040000
270500                                      ACOMM2H                     27050000
270600                                      ACOMM3H                     27060000
270700     END-IF.                                                      27070000
270800                                                                  27080000
270900     IF  ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID               27090000
271000         CONTINUE                                                 27100000
271100     ELSE                                                         27110000
271200         IF  ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID            27120000
271300             MOVE DP015-PRO-NOR-OFF        TO AFNAMEA             27130000
271400                                              ALNAMEA             27140000
271500                                              APMADINA            27150000
271600                                              ATITLEA             27160000
271700                                              APHONE1A            27170000
271800                                              AEXT1A              27180000
271900                                              ACPC1A              27190000
272000                                              APHONE2A            27200000
272100                                              AEXT2A              27210000
272200                                              ACPC2A              27220000
272300                                              AFAXA               27230000
272400                                              AEMAILA             27240000
272500                                              AROOMA              27250000
272600             MOVE DP015-BLUE               TO AFNAMEC             27260000
272700                                              ALNAMEC             27270000
272800                                              APMADINC            27280000
272900                                              ATITLEC             27290000
273000                                              APHONE1C            27300000
273100                                              AEXT1C              27310000
273200                                              ACPC1C              27320000
273300                                              APHONE2C            27330000
273400                                              AEXT2C              27340000
273500                                              ACPC2C              27350000
273600                                              AFAXC               27360000
273700                                              AEMAILC             27370000
273800                                              AROOMC              27380000
273900             MOVE DP015-HL-OFF             TO AFNAMEH             27390000
274000                                              ALNAMEH             27400000
274100                                              APMADINH            27410000
274200                                              ATITLEH             27420000
274300                                              APHONE1H            27430000
274400                                              AEXT1H              27440000
274500                                              ACPC1H              27450000
274600                                              APHONE2H            27460000
274700                                              AEXT2H              27470000
274800                                              ACPC2H              27480000
274900                                              AFAXH               27490000
275000                                              AEMAILH             27500000
275100                                              AROOMH              27510000
275200     END-IF.                                                      27520000
275300                                                                  27530000
275400 4000-BUILD-INITIAL-PANEL.                                        27540000
275500                                                                  27550000
275600     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       27560000
275700                                                                  27570000
275800     MOVE +0                       TO ASC-NUMBER-OF-ITEMS-READ    27580000
275900                                      ASC-ITEM-AT-TOP-OF-PANEL.   27590000
276000                                                                  27600000
276100     PERFORM 4010-OPEN-CURSOR.                                    27610000
276200                                                                  27620000
276300     PERFORM 4300-READ-ITEMS-FROM-DB.                             27630000
276400                                                                  27640000
276500     PERFORM 4020-CLOSE-CURSOR.                                   27650000
276600                                                                  27660000
276700     MOVE +1                       TO PV-TOP-ITEM.                27670000
276800                                                                  27680000
276900     IF  DP020-NEXT-ACT-INITIAL                                   27690000
277000     AND ASC-NUMBER-OF-ITEMS-READ = ZERO                          27700000
277100         CONTINUE                                                 27710000
277200     ELSE                                                         27720000
277300         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      27730000
277400             CONTINUE                                             27740000
277500         ELSE                                                     27750000
277600             IF  ASC-UPDATE-PENDING                               27760000
277700                 SET DP030-SET-CURSOR-APPL-1                      27770000
277800                                   TO TRUE                        27780000
277900                 IF  ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID    27790000
278000                     MOVE -1     TO AD1ENML                       27800000
278100                 ELSE                                             27810000
278200                     IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR27820000
278300                      ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID   27830000
278400                        MOVE -1     TO APMADINL                   27840000
278500                     ELSE                                         27850000
278600                        MOVE -1     TO AFNAMEL                    27860000
278700                     END-IF                                       27870000
278800                 END-IF                                           27880000
278900             ELSE                                                 27890000
279000                 SET DP030-SET-CURSOR-TRAILER                     27900000
279100                                   TO TRUE                        27910000
279200             END-IF                                               27920000
279300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 27930000
279400         END-IF                                                   27940000
279500     END-IF.                                                      27950000
279600                                                                  27960000
279700/                                                                 27970000
279800*----------------------------------------------------------------*27980000
279900* OPEN THE ADDRESS CURSOR                                        *27990000
280000*----------------------------------------------------------------*28000000
280100                                                                  28010000
280200 4010-OPEN-CURSOR.                                                28020000
280300                                                                  28030000
280400     PERFORM                                                      28040000
280500         WITH TEST AFTER                                          28050000
280600         VARYING PV-RETRY-COUNTER                                 28060000
280700         FROM 1 BY 1                                              28070000
280800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28080000
280900            OR (SQLCODE = +0))                                    28090000
281000                                                                  28100000
281100         EXEC SQL                                                 28110000
281200             OPEN ADDRESS-CSR                                     28120000
281300         END-EXEC                                                 28130000
281400                                                                  28140000
281500         EVALUATE TRUE                                            28150000
281600             WHEN SQLCODE = +0                                    28160000
281700                  CONTINUE                                        28170000
281800             WHEN SQLCODE = -904                                  28180000
281900             WHEN SQLCODE = -913                                  28190000
282000                  CONTINUE                                        28200000
282100             WHEN SQLWARN0 NOT = SPACE                            28210000
282200             WHEN SQLCODE  NOT = +0                               28220000
282300                  MOVE '4010-OPEN-CURSOR'                         28230000
282400                                   TO DP013-PARAGRAPH             28240000
282500                  MOVE 'OPEN ADDRESS-CSR CURSOR'                  28250000
282600                                   TO DP013-MESSAGE-TEXT (1)      28260000
282700                  MOVE SQLCA       TO DP013-SQLCA                 28270000
282800                  MOVE 'TENTREP'   TO DP013-DB2-TABLE-NAME (1)    28280000
282900                  MOVE 'TBUSLOC'   TO DP013-DB2-TABLE-NAME (2)    28290000
283000                  MOVE 'TBUSFNC'   TO DP013-DB2-TABLE-NAME (3)    28300000
283100                  SET DP013-DB2-ABEND                             28310000
283200                                   TO TRUE                        28320000
283300                  PERFORM DP013-0000-PROCESS-ABEND                28330000
283400         END-EVALUATE                                             28340000
283500     END-PERFORM.                                                 28350000
283600                                                                  28360000
283700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28370000
283800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             28380000
283900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              28390000
284000                                   TO DP013-MESSAGE-TEXT (1)      28400000
284100         MOVE SQLCA                TO DP013-SQLCA                 28410000
284200         SET DP013-DB2-ABEND       TO TRUE                        28420000
284300         PERFORM DP013-0000-PROCESS-ABEND                         28430000
284400     END-IF.                                                      28440000
284500                                                                  28450000
284600/                                                                 28460000
284700*----------------------------------------------------------------*28470000
284800* CLOSE THE ADDRESS CURSOR                                       *28480000
284900*----------------------------------------------------------------*28490000
285000                                                                  28500000
285100 4020-CLOSE-CURSOR.                                               28510000
285200                                                                  28520000
285300     EXEC SQL                                                     28530000
285400         CLOSE ADDRESS-CSR                                        28540000
285500     END-EXEC.                                                    28550000
285600                                                                  28560000
285700     EVALUATE TRUE                                                28570000
285800         WHEN SQLCODE = +0                                        28580000
285900              CONTINUE                                            28590000
286000         WHEN SQLWARN0 NOT = SPACE                                28600000
286100         WHEN SQLCODE  NOT = +0                                   28610000
286200              MOVE '4020-CLOSE-CURSOR'                            28620000
286300                                   TO DP013-PARAGRAPH             28630000
286400              MOVE 'CLOSE ADDRESS-CSR CURSOR'                     28640000
286500                                   TO DP013-MESSAGE-TEXT (1)      28650000
286600              MOVE SQLCA           TO DP013-SQLCA                 28660000
286700               MOVE 'TENTREP'      TO DP013-DB2-TABLE-NAME (1)    28670000
286800               MOVE 'TBUSLOC'      TO DP013-DB2-TABLE-NAME (2)    28680000
286900               MOVE 'TBUSFNC'      TO DP013-DB2-TABLE-NAME (3)    28690000
287000              SET DP013-DB2-ABEND  TO TRUE                        28700000
287100              PERFORM DP013-0000-PROCESS-ABEND                    28710000
287200     END-EVALUATE.                                                28720000
287300                                                                  28730000
287400/                                                                 28740000
287500*----------------------------------------------------------------*28750000
287600*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *28760000
287700*    TEMP STORAGE QUEUE.                                         *28770000
287800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *28780000
287900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *28790000
288000*    UPON INITIALIZATION.                                        *28800000
288100*----------------------------------------------------------------*28810000
288200                                                                  28820000
288300 4300-READ-ITEMS-FROM-DB.                                         28830000
288400                                                                  28840000
288500     PERFORM 4320-GET-VENDOR-NAME.                                28850000
288600                                                                  28860000
288700     PERFORM 4330-GET-FUNCTION-NAME.                              28870000
288800                                                                  28880000
288900     PERFORM                                                      28890000
289000         VARYING PV-READ-COUNT                                    28900000
289100         FROM 1 BY 1                                              28910000
289200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    28920000
289300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         28930000
289400                                                                  28940000
289500         PERFORM 4310-FETCH                                       28950000
289600                                                                  28960000
289700         IF  ASC-ITEMS-LEFT-ON-DB                                 28970000
289800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    28980000
289900             MOVE ASC-NUMBER-OF-ITEMS-READ                        28990000
290000                                   TO ASC-LIST-ITEM-NUMBER        29000000
290100             MOVE ENTREP-ENT-ID    TO ASC-KEY-ENT-ID              29010000
290200             MOVE ENTREP-SEQ-NBR   TO ASC-TENTREP-SEQ-NBR         29020000
290300             MOVE ENTREP-FUNCTION-ID                              29030000
290400                                   TO ASC-KEY-FUNCTION-ID         29040000
290500             MOVE ENTREP-FIRST-NAME                               29050000
290600                                   TO ASC-FIRST-NAME              29060000
290700             MOVE ENTREP-LAST-NAME TO ASC-LAST-NAME               29070000
290800             MOVE ENTREP-TITLE-NAME                               29080000
290900                                   TO ASC-TITLE                   29090000
291000             MOVE ENTREP-TEL1-NBR  TO ASC-TEL1-NBR                29100000
291100             MOVE ENTREP-TEL1-EXT-NBR                             29110000
291200                                   TO ASC-TEL1-EXT-NBR            29120000
291300             MOVE ENTREP-TEL-1-CNTRY-CDE                          29130000
291400                                   TO ASC-TEL1-CNTY-PH-CD         29140000
291500             MOVE ENTREP-TEL2-NBR  TO ASC-TEL2-NBR                29150000
291600             MOVE ENTREP-TEL2-EXT-NBR                             29160000
291700                                   TO ASC-TEL2-EXT-NBR            29170000
291800             MOVE ENTREP-TEL-2-CNTRY-CDE                          29180000
291900                                   TO ASC-TEL2-CNTY-PH-CD         29190000
292000             MOVE ENTREP-FAX-NBR   TO ASC-FAX-NBR                 29200000
292100             MOVE ENTREP-EMAIL-ADDR-ID TO ASC-EMAIL-ADDR          29210000
292200             MOVE ENTREP-LAST-UPDATE-TMST                         29220000
292300                                   TO PV-DB2-TIMESTAMP            29230000
292400             STRING PV-DB2-TIMESTAMP-MM DELIMITED BY SIZE         29240000
292500                    '/'                 DELIMITED BY SIZE         29250000
292600                    PV-DB2-TIMESTAMP-DD DELIMITED BY SIZE         29260000
292700                    '/'                 DELIMITED BY SIZE         29270000
292800                    PV-DB2-TIMESTAMP-CC DELIMITED BY SIZE         29280000
292900                    PV-DB2-TIMESTAMP-YY DELIMITED BY SIZE         29290000
293000                                 INTO ASC-LAST-UPDATE-DATE        29300000
293100             MOVE ENTREP-LAST-UPDATE-ID                           29310000
293200                                   TO ASC-LAST-UPDATE-ID          29320000
293300             MOVE BUSLOC-SEQ-NBR   TO ASC-TBUSLOC-SEQ-NBR         29330000
293400             MOVE BUSLOC-ADDRESS-LINE1-DESC                       29340000
293500                                   TO ASC-ADDR12-DESC             29350000
293600             MOVE BUSLOC-ADDRESS-LINE2-DESC                       29360000
293700                                   TO ASC-ADDR23-DESC             29370000
293800             MOVE BUSLOC-ADDRESS-LINE3-DESC                       29380000
293900                                   TO ASC-ADDR34-DESC             29390000
294000             MOVE BUSLOC-CITY-NAME TO ASC-CITY                    29400000
294100             MOVE BUSLOC-ST-PROV-CDE TO ASC-STATE-CDE             29410000
294200             MOVE BUSLOC-ZIP-CDE   TO ASC-ZIP                     29420000
294300             MOVE BUSLOC-CNTRY-CDE                                29430000
294400                                   TO ASC-COUNTRY-CDE             29440000
294500             MOVE BUSLOC-ROOM-NBR  TO ASC-ROOM-NBR                29450000
294600             MOVE BUSLOC-ATTENTION-TO-TXT                         29460000
294700                                   TO ASC-ATTENTION-TO-TXT        29470000
294800             MOVE BUSLOC-COMMENT1-TXT                             29480000
294900                                   TO ASC-COMMENT1-TXT            29490000
295000             MOVE BUSLOC-COMMENT2-TXT                             29500000
295100                                   TO ASC-COMMENT2-TXT            29510000
295200             MOVE BUSLOC-COMMENT3-TXT                             29520000
295300                                   TO ASC-COMMENT3-TXT            29530000
295400             MOVE BUSLOC-PRIM-ADDR-IND                            29540000
295500                                   TO ASC-PRIM-ADDR-IND           29550000
295600                                                                  29560000
295700             IF ASC-COUNTRY-CDE = SPACES AND                      29570000
295800                ASC-STATE-CDE = SPACES                            29580000
295900                 INITIALIZE           ASC-STATE-NAME              29590000
296000                                      ASC-COUNTRY-NAME            29600000
296100             ELSE                                                 29610000
296200                 PERFORM 3010-RETRIEVE-ST-PRV-CNTY-NAME           29620000
296300             END-IF                                               29630000
296400                                                                  29640000
296500             EVALUATE ASC-KEY-FUNCTION-ID                         29650000
296600                                                                  29660000
296700                 WHEN PC-REMIT-FUNCTION-ID                        29670000
296800                      MOVE 'EXTD NAME.:'                          29680000
296900                                   TO ASC-ADR-EXNAM-TEXT          29690000
297000                      MOVE 'ADDRESS...:'                          29700000
297100                                   TO ASC-ADDRESS-TEXT            29710000
297200                      MOVE BUSLOC-EXTD-VND-NM                     29720000
297300                                   TO ASC-ADDR1-EXNAME            29730000
297400                      MOVE BUSLOC-ADDRESS-LINE1-DESC              29740000
297500                                   TO ASC-ADDR12-DESC             29750000
297600                      MOVE BUSLOC-ADDRESS-LINE2-DESC              29760000
297700                                   TO ASC-ADDR23-DESC             29770000
297800                      MOVE BUSLOC-ADDRESS-LINE3-DESC              29780000
297900                                   TO ASC-ADDR34-DESC             29790000
298000                                                                  29800000
298100                 WHEN PC-1099-FUNCTION-ID                         29810000
298200                      MOVE '1099 VEND.:'                          29820000
298300                                   TO ASC-ADR-EXNAM-TEXT          29830000
298400                      MOVE 'ADDRESS...:'                          29840000
298500                                   TO ASC-ADDRESS-TEXT            29850000
298600                      MOVE BUSLOC-ALT-1099-VND-NM                 29860000
298700                                   TO ASC-ADDR1-EXNAME            29870000
298800                      MOVE BUSLOC-ADDRESS-LINE1-DESC              29880000
298900                                   TO ASC-ADDR12-DESC             29890000
299000                      MOVE BUSLOC-ADDRESS-LINE2-DESC              29900000
299100                                   TO ASC-ADDR23-DESC             29910000
299200                      MOVE BUSLOC-ADDRESS-LINE3-DESC              29920000
299300                                   TO ASC-ADDR34-DESC             29930000
299400                                                                  29940000
299500                 WHEN OTHER                                       29950000
299600                      MOVE 'ADDRESS...:'                          29960000
299700                                   TO ASC-ADR-EXNAM-TEXT          29970000
299800                      MOVE SPACES  TO ASC-ADDRESS-TEXT            29980000
299900                      MOVE BUSLOC-ADDRESS-LINE1-DESC              29990000
300000                                   TO ASC-ADDR1-EXNAME            30000000
300100                      MOVE BUSLOC-ADDRESS-LINE2-DESC              30010000
300200                                   TO ASC-ADDR12-DESC             30020000
300300                      MOVE BUSLOC-ADDRESS-LINE3-DESC              30030000
300400                                   TO ASC-ADDR23-DESC             30040000
300500                      MOVE BUSLOC-ADDRESS-LINE4-DESC              30050000
300600                                   TO ASC-ADDR34-DESC             30060000
300700             END-EVALUATE                                         30070000
300800                                                                  30080000
300900             PERFORM 5100-WRITE-TEMP-STORAGE                      30090000
301000             MOVE ASC-LIST-ITEM-NUMBER                            30100000
301100                                   TO PV-TOP-ITEM                 30110000
301200                                      PV-ITEM                     30120000
301300             PERFORM 4410-READ-TEMP-STORAGE                       30130000
301400         END-IF                                                   30140000
301500     END-PERFORM.                                                 30150000
301600                                                                  30160000
301700/                                                                 30170000
301800*----------------------------------------------------------------*30180000
301900*    FETCH A ROW FROM THE ADDRESS CURSOR                         *30190000
302000*----------------------------------------------------------------*30200000
302100                                                                  30210000
302200 4310-FETCH.                                                      30220000
302300                                                                  30230000
302400     EXEC SQL                                                     30240000
302500          FETCH  ADDRESS-CSR                                      30250000
302600           INTO :ENTREP-ENT-ID                                    30260000
302700               ,:ENTREP-SEQ-NBR                                   30270000
302800               ,:ENTREP-FIRST-NAME                                30280000
302900               ,:ENTREP-LAST-NAME                                 30290000
303000               ,:ENTREP-TITLE-NAME                                30300000
303100               ,:ENTREP-TEL1-NBR                                  30310000
303200               ,:ENTREP-TEL1-EXT-NBR                              30320000
303300               ,:ENTREP-TEL-1-CNTRY-CDE                           30330000
303400               ,:ENTREP-TEL2-NBR                                  30340000
303500               ,:ENTREP-TEL2-EXT-NBR                              30350000
303600               ,:ENTREP-TEL-2-CNTRY-CDE                           30360000
303700               ,:ENTREP-FAX-NBR                                   30370000
303800               ,:ENTREP-EMAIL-ADDR-ID                             30380000
303900               ,:ENTREP-FUNCTION-ID                               30390000
304000               ,:ENTREP-LAST-UPDATE-TMST                          30400000
304100               ,:ENTREP-LAST-UPDATE-ID                            30410000
304200               ,:PV-ENT-BUS-LOC-ID                                30420000
304300               ,:BUSLOC-SEQ-NBR                                   30430000
304400               ,:BUSLOC-ADDRESS-LINE1-DESC                        30440000
304500               ,:BUSLOC-ADDRESS-LINE2-DESC                        30450000
304600               ,:BUSLOC-ADDRESS-LINE3-DESC                        30460000
304700               ,:BUSLOC-ADDRESS-LINE4-DESC                        30470000
304800               ,:BUSLOC-ATTENTION-TO-TXT                          30480000
304900               ,:BUSLOC-CITY-NAME                                 30490000
305000               ,:BUSLOC-ST-PROV-CDE                               30500000
305100               ,:BUSLOC-CNTRY-CDE                                 30510000
305200               ,:BUSLOC-ZIP-CDE                                   30520000
305300               ,:BUSLOC-ROOM-NBR                                  30530000
305400               ,:BUSLOC-COMMENT1-TXT                              30540000
305500               ,:BUSLOC-COMMENT2-TXT                              30550000
305600               ,:BUSLOC-COMMENT3-TXT                              30560000
305700               ,:BUSLOC-EXTD-VND-NM                               30570000
305800               ,:BUSLOC-ALT-1099-VND-NM                           30580000
305900               ,:BUSLOC-PRIM-ADDR-IND                             30590000
306000     END-EXEC.                                                    30600000
306100                                                                  30610000
306200     EVALUATE TRUE                                                30620000
306300         WHEN SQLCODE = +0                                        30630000
306400*             CONTINUE                                            30640000
306500              MOVE BUSLOC-PRIM-ADDR-IND TO PV-PRIM-ADDR-IND       30650000
306600         WHEN SQLCODE = +100                                      30660000
306700              SET ASC-NO-ITEMS-LEFT-ON-DB                         30670000
306800                                   TO TRUE                        30680000
306900         WHEN SQLWARN0 NOT = SPACE                                30690000
307000         WHEN SQLCODE < +0                                        30700000
307100         WHEN SQLCODE > +0                                        30710000
307200              MOVE '4310-FETCH-CURSOR'                            30720000
307300                                   TO DP013-PARAGRAPH             30730000
307400              MOVE 'FETCH ADDRESS CURSOR'                         30740000
307500                                   TO DP013-MESSAGE-TEXT (1)      30750000
307600              MOVE SQLCA           TO DP013-SQLCA                 30760000
307700              MOVE 'TENTREP'       TO DP013-DB2-TABLE-NAME (1)    30770000
307800              MOVE 'TBUSLOC'       TO DP013-DB2-TABLE-NAME (2)    30780000
307900              SET DP013-DB2-ABEND  TO TRUE                        30790000
308000              PERFORM DP013-0000-PROCESS-ABEND                    30800000
308100     END-EVALUATE.                                                30810000
308200                                                                  30820000
308300/                                                                 30830000
308400*----------------------------------------------------------------*30840000
308500* GET THE VENDOR NAME                                            *30850000
308600*----------------------------------------------------------------*30860000
308700                                                                  30870000
308800 4320-GET-VENDOR-NAME.                                            30880000
308900                                                                  30890000
309000     PERFORM                                                      30900000
309100         WITH TEST AFTER                                          30910000
309200         VARYING PV-RETRY-COUNTER                                 30920000
309300         FROM 1 BY 1                                              30930000
309400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30940000
309500            OR (SQLCODE = +0))                                    30950000
309600                                                                  30960000
309700         EXEC SQL                                                 30970000
309800             SELECT A.ENT_NAME_DESC                               30980000
309900                  , B.DUN_NBR                                     30990000
310000              INTO  :ENTNME-ENT-NAME-DESC                         31000000
310100                  , :EXTENT-DUN-NBR                               31010000
310200              FROM  TENTNME A                                     31020000
310300                 ,  TEXTENT B                                     31030000
310400              WHERE A.ENT_ID   = :DK-ENT-ID                       31040000
310500                AND A.ENT_ID   = B.ENT_ID                         31050000
310600                AND A.TYPE_CDE = '01'                             31060000
310700         END-EXEC                                                 31070000
310800                                                                  31080000
310900         EVALUATE TRUE                                            31090000
311000             WHEN SQLCODE = +0                                    31100000
311100                 MOVE ENTNME-ENT-NAME-DESC                        31110000
311200                                 TO ASC-VENDOR-NAME               31120000
311300                 MOVE EXTENT-DUN-NBR                              31130000
311400                                 TO ASC-DUN-NBR                   31140000
311500             WHEN SQLCODE = -904                                  31150000
311600             WHEN SQLCODE = -913                                  31160000
311700                 CONTINUE                                         31170000
311800             WHEN SQLWARN0 NOT = SPACE                            31180000
311900             WHEN SQLCODE < +0                                    31190000
312000             WHEN SQLCODE > +0                                    31200000
312100                 MOVE '4320-GET-VENDOR-NAME'                      31210000
312200                                 TO DP013-PARAGRAPH               31220000
312300                 MOVE 'SELECT ON ENTERPRISE NAME TABLE'           31230000
312400                                 TO DP013-MESSAGE-TEXT (1)        31240000
312500                 MOVE SQLCA      TO DP013-SQLCA                   31250000
312600                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (1)      31260000
312700                     SET DP013-DB2-ABEND                          31270000
312800                         DP013-XCTL-DISPLAY-RESTART               31280000
312900                                 TO TRUE                          31290000
313000                 PERFORM DP013-0000-PROCESS-ABEND                 31300000
313100         END-EVALUATE                                             31310000
313200     END-PERFORM.                                                 31320000
313300                                                                  31330000
313400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31340000
313500         MOVE '4320-GET-VENDOR-NAME' TO DP013-PARAGRAPH           31350000
313600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TENTNME'        31360000
313700                                   TO DP013-MESSAGE-TEXT (1)      31370000
313800         MOVE SQLCA                TO DP013-SQLCA                 31380000
313900         SET DP013-DB2-ABEND       TO TRUE                        31390000
314000         PERFORM DP013-0000-PROCESS-ABEND                         31400000
314100     END-IF.                                                      31410000
314200                                                                  31420000
314300/                                                                 31430000
314400*----------------------------------------------------------------*31440000
314500* GET THE FUNCTION NAME                                          *31450000
314600*----------------------------------------------------------------*31460000
314700                                                                  31470000
314800 4330-GET-FUNCTION-NAME.                                          31480000
314900                                                                  31490000
315000     PERFORM                                                      31500000
315100         WITH TEST AFTER                                          31510000
315200         VARYING PV-RETRY-COUNTER                                 31520000
315300         FROM 1 BY 1                                              31530000
315400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31540000
315500            OR (SQLCODE = +0))                                    31550000
315600                                                                  31560000
315700         EXEC SQL                                                 31570000
315800             SELECT FUNCTION_NAME                                 31580000
315900              INTO  :BUSFNC-FUNCTION-NAME                         31590000
316000              FROM  TBUSFNC                                       31600000
316100              WHERE FUNCTION_ID = :DK-FUNCTION-ID                 31610000
316200         END-EXEC                                                 31620000
316300                                                                  31630000
316400         EVALUATE TRUE                                            31640000
316500             WHEN SQLCODE = +0                                    31650000
316600                 MOVE BUSFNC-FUNCTION-NAME                        31660000
316700                                 TO ASC-FUNCTION-NAME             31670000
316800             WHEN SQLCODE = -904                                  31680000
316900             WHEN SQLCODE = -913                                  31690000
317000                 CONTINUE                                         31700000
317100             WHEN SQLWARN0 NOT = SPACE                            31710000
317200             WHEN SQLCODE < +0                                    31720000
317300             WHEN SQLCODE > +0                                    31730000
317400                 MOVE '4330-GET-FUNCTION-NAME'                    31740000
317500                                 TO DP013-PARAGRAPH               31750000
317600                 MOVE 'SELECT ON BUSINESS FUNCTION TABLE'         31760000
317700                                 TO DP013-MESSAGE-TEXT (1)        31770000
317800                 MOVE SQLCA      TO DP013-SQLCA                   31780000
317900                 MOVE 'TBUSFNC'  TO DP013-DB2-TABLE-NAME (1)      31790000
318000                     SET DP013-DB2-ABEND                          31800000
318100                         DP013-XCTL-DISPLAY-RESTART               31810000
318200                                 TO TRUE                          31820000
318300                 PERFORM DP013-0000-PROCESS-ABEND                 31830000
318400         END-EVALUATE                                             31840000
318500     END-PERFORM.                                                 31850000
318600                                                                  31860000
318700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31870000
318800         MOVE '4330-GET-FUNCTION-NAME' TO DP013-PARAGRAPH         31880000
318900         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TBUSFNC'        31890000
319000                                   TO DP013-MESSAGE-TEXT (1)      31900000
319100         MOVE SQLCA                TO DP013-SQLCA                 31910000
319200         SET DP013-DB2-ABEND       TO TRUE                        31920000
319300         PERFORM DP013-0000-PROCESS-ABEND                         31930000
319400     END-IF.                                                      31940000
319500                                                                  31950000
319600/                                                                 31960000
319700*----------------------------------------------------------------*31970000
319800* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31980000
319900*----------------------------------------------------------------*31990000
320000                                                                  32000000
320100 4400-MOVE-COMMAREA-TO-SCREEN.                                    32010000
320200                                                                  32020000
320300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER)                   32030000
320400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER))                32040000
320500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER))                32050000
320600             PERFORM 5100-WRITE-TEMP-STORAGE                      32060000
320700             MOVE PV-TOP-ITEM      TO PV-ITEM                     32070000
320800             PERFORM 4410-READ-TEMP-STORAGE                       32080000
320900     END-IF.                                                      32090000
321000                                                                  32100000
321100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32110000
321200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32120000
321300                                                                  32130000
321400     PERFORM 4420-FORMAT-LIST-LINES.                              32140000
321500                                                                  32150000
321600     COMPUTE ASC-ITEMS-DISPLAYED =                                32160000
321700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32170000
321800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   32180000
321900                                                                  32190000
322000     MOVE ASC-VENDOR-NAME          TO AVNNAMEO.                   32200000
322100     MOVE ASC-DUN-NBR              TO ADUNSO.                     32210000
322200     MOVE ASC-FUNCTION-NAME        TO AFUNCNMO.                   32220000
322300     PERFORM 1300-FORMAT-EXTD-NAME.                               32230000
322400                                                                  32240000
322500     IF  DP020-MSG-NUMBER-X = SPACE                               32250000
322600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32260000
322700*            --- MORE ITEMS TO DISPLAY ----                       32270000
322800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32280000
322900             SET DP020-MSG-INFORMATIONAL                          32290000
323000                                   TO TRUE                        32300000
323100         END-IF                                                   32310000
323200     END-IF.                                                      32320000
323300                                                                  32330000
323400/                                                                 32340000
323500 4410-READ-TEMP-STORAGE.                                          32350000
323600                                                                  32360000
323700     EXEC CICS                                                    32370000
323800         READQ TS                                                 32380000
323900             QUEUE (ASC-DTL-QUEUE-NAME)                           32390000
324000             INTO  (ASC-LIST-ENTRY)                               32400000
324100             ITEM  (PV-ITEM)                                      32410000
324200             RESP  (PV-CICS-RESP)                                 32420000
324300     END-EXEC.                                                    32430000
324400                                                                  32440000
324500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       32450000
324600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     32460000
324700         CONTINUE                                                 32470000
324800     ELSE                                                         32480000
324900         SET DP013-CICS-ABEND      TO TRUE                        32490000
325000         SET DP013-NO-ROLLBACK     TO TRUE                        32500000
325100         MOVE '4410-READ-TEMP-STORAGE'                            32510000
325200                                   TO DP013-PARAGRAPH             32520000
325300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      32530000
325400                                   TO DP013-MESSAGE-TEXT(1)       32540000
325500         PERFORM DP013-0000-PROCESS-ABEND                         32550000
325600     END-IF.                                                      32560000
325700                                                                  32570000
325800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         32580000
325900         INITIALIZE ASC-LIST-ENTRY                                32590000
326000     END-IF.                                                      32600000
326100                                                                  32610000
326200/                                                                 32620000
326300*----------------------------------------------------------------*32630000
326400*    PROCESS THE ITEMS IN THE QUEUE AND MOVE THEM TO THE MAP.    *32640000
326500*----------------------------------------------------------------*32650000
326600                                                                  32660000
326700 4420-FORMAT-LIST-LINES.                                          32670000
326800                                                                  32680000
326900     IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL               32690000
327000         MOVE ASC-PRIM-ADDR-IND    TO APMADINO                    32700000
327100         MOVE ASC-FIRST-NAME       TO AFNAMEO                     32710000
327200         MOVE ASC-LAST-NAME        TO ALNAMEO                     32720000
327300         MOVE ASC-TITLE            TO ATITLEO                     32730000
327400         MOVE ASC-TEL1-NBR         TO APHONE1O                    32740000
327500         MOVE ASC-TEL1-EXT-NBR     TO AEXT1O                      32750000
327600         MOVE ASC-TEL1-CNTY-PH-CD  TO ACPC1O                      32760000
327700         MOVE ASC-TEL2-NBR         TO APHONE2O                    32770000
327800         MOVE ASC-TEL2-EXT-NBR     TO AEXT2O                      32780000
327900         MOVE ASC-TEL2-CNTY-PH-CD  TO ACPC2O                      32790000
328000         MOVE ASC-FAX-NBR          TO AFAXO                       32800000
328100         MOVE ASC-EMAIL-ADDR       TO AEMAILO                     32810000
328200         MOVE ASC-LAST-UPDATE-DATE TO AUPDTO                      32820000
328300         MOVE ASC-LAST-UPDATE-ID   TO AUPIDO                      32830000
328400         MOVE ASC-ADDR1-EXNAME     TO AD1ENMO                     32840000
328500         MOVE ASC-ADDR12-DESC      TO AADDR12O                    32850000
328600         MOVE ASC-ADDR23-DESC      TO AADDR23O                    32860000
328700         MOVE ASC-ADDR34-DESC      TO AADDR34O                    32870000
328800         MOVE ASC-CITY             TO ACITYO                      32880000
328900         MOVE ASC-STATE-CDE        TO ASTCDEO                     32890000
329000         MOVE ASC-STATE-NAME       TO ASTNMEO                     32900000
329100         MOVE ASC-ZIP              TO AZIPCDEO                    32910000
329200                                                                  32920000
329300         EVALUATE ASC-KEY-FUNCTION-ID                             32930000
329400                                                                  32940000
329500             WHEN PC-REMIT-FUNCTION-ID                            32950000
329600             WHEN PC-1099-FUNCTION-ID                             32960000
329700                  MOVE ASC-ADR-EXNAM-TEXT   TO AD1ENMTO           32970000
329800                  MOVE ASC-ADDRESS-TEXT     TO ADDR12TO           32980000
329900             WHEN PC-DSV-WAREHOUSE-LOC                            32990000
330000                  MOVE ASC-ADR-EXNAM-TEXT   TO AD1ENMTO           33000000
330100                  MOVE SPACES               TO ADDR12TO           33010000
330200                  MOVE 'NODE......:'        TO ANODEO             33020000
330300                  MOVE 'STATUS....:'        TO ASTATUSO           33030000
330400             WHEN OTHER                                           33040000
330500                  MOVE ASC-ADR-EXNAM-TEXT   TO AD1ENMTO           33050000
330600                  MOVE SPACES               TO ADDR12TO           33060000
330700                                                                  33070000
330800         END-EVALUATE                                             33080000
330900                                                                  33090000
331000         IF ASC-COUNTRY-CDE = 'US '                               33100000
331100             MOVE SPACES           TO ACNTCDO                     33110000
331200                                      ACNTNMO                     33120000
331300         ELSE                                                     33130000
331400             MOVE ASC-COUNTRY-CDE  TO ACNTCDO                     33140000
331500             MOVE ASC-COUNTRY-NAME TO ACNTNMO                     33150000
331600         END-IF                                                   33160000
331700                                                                  33170000
331800         MOVE ASC-ROOM-NBR         TO AROOMO                      33180000
331900         MOVE ASC-ATTENTION-TO-TXT TO AATTNTOO                    33190000
332000         MOVE ASC-COMMENT1-TXT     TO ACOMM1O                     33200000
332100         MOVE ASC-COMMENT2-TXT     TO ACOMM2O                     33210000
332200         MOVE ASC-COMMENT3-TXT     TO ACOMM3O                     33220000
332300     END-IF.                                                      33230000
332400                                                                  33240000
332500 5100-WRITE-TEMP-STORAGE.                                         33250000
332600                                                                  33260000
332700     MOVE ASC-LIST-ITEM-NUMBER TO PV-LIST-ITEM-NUMBER.            33270000
332800                                                                  33280000
332900     EXEC CICS                                                    33290000
333000         WRITEQ TS                                                33300000
333100             QUEUE (ASC-DTL-QUEUE-NAME)                           33310000
333200             FROM  (ASC-LIST-ENTRY)                               33320000
333300             ITEM  (PV-LIST-ITEM-NUMBER)                          33330000
333400             RESP  (PV-CICS-RESP)                                 33340000
333500     END-EXEC.                                                    33350000
333600                                                                  33360000
333700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      33370000
333800         SET DP013-CICS-ABEND                                     33380000
333900             DP013-NO-ROLLBACK     TO TRUE                        33390000
334000         MOVE '5100-WRITE-TEMP-STORAGE'                           33400000
334100                                   TO DP013-PARAGRAPH             33410000
334200         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST'             33420000
334300                                   TO DP013-MESSAGE-TEXT(1)       33430000
334400         PERFORM DP013-0000-PROCESS-ABEND                         33440000
334500     END-IF.                                                      33450000
334600                                                                  33460000
334700/                                                                 33470000
334800*----------------------------------------------------------------*33480000
334900* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *33490000
335000* OBJECT WAS UDPATED.                                            *33500000
335100*----------------------------------------------------------------*33510000
335200                                                                  33520000
335300 5200-UPDATE-SELECTION-QUEUE.                                     33530000
335400                                                                  33540000
335500     PERFORM 9100-READ-SEL-QUEUE.                                 33550000
335600                                                                  33560000
335700     IF ASC-ADD-SUCCESSFUL                                        33570000
335800        SET VN003-ADD (ASC-SEL-SUB)    TO TRUE                    33580000
335900     ELSE                                                         33590000
336000        IF ASC-DELETE-SUCCESSFUL                                  33600000
336100           SET VN003-DEL (ASC-SEL-SUB) TO TRUE                    33610000
336200        ELSE                                                      33620000
336300           SET VN003-UPD (ASC-SEL-SUB) TO TRUE                    33630000
336400        END-IF                                                    33640000
336500     END-IF.                                                      33650000
336600                                                                  33660000
336700     PERFORM 9200-REWRITE-LIST-QUEUE.                             33670000
336800                                                                  33680000
336900*----------------------------------------------------------------*33690000
337000/                                                                 33700000
337100 6000-ADD-ADDRESS.                                                33710000
337200                                                                  33720000
337300     MOVE ASC-KEY-ENT-ID           TO DK-ENT-ID.                  33730000
337400     MOVE ASC-KEY-FUNCTION-ID      TO DK-FUNCTION-ID.             33740000
337500                                                                  33750000
337600     IF  ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID                33760000
337700         PERFORM 6015-1099-ADDRESS-EXIST                          33770000
337800     END-IF.                                                      33780000
337900                                                                  33790000
338000     IF PS-ERROR                                                  33800000
338100         CONTINUE                                                 33810000
338200     ELSE                                                         33820000
338300         PERFORM 6010-MAX-TBUSLOC                                 33830000
338400                                                                  33840000
338500         INITIALIZE DCLTBUSLOC                                    33850000
338600                    DCLTENTREP                                    33860000
338700                                                                  33870000
338800         PERFORM 6012-LOAD-ADDRESS                                33880000
338900                                                                  33890000
339000         IF PS-ERROR                                              33900000
339100             CONTINUE                                             33910000
339200         ELSE                                                     33920000
339300             PERFORM 6020-INSERT-TBUSLOC                          33930000
339400                                                                  33940000
339500             IF  SQLCODE = -803                                   33950000
339600                 SET PS-ERROR                                     33960000
339700                     DP020-MSG-FATAL                              33970000
339800                     DP030-SET-CURSOR-TRAILER                     33980000
339900                                           TO TRUE                33990000
340000                 MOVE PC-TSYMSG-00117      TO DP020-MSG-NUMBER    34000000
340100             ELSE                                                 34010000
340200                 PERFORM 6030-MAX-TENTREP                         34020000
340300                 PERFORM 6040-INSERT-TENTREP                      34030000
340400                 IF  SQLCODE = +0                                 34040000
340500                     IF  ASC-KEY-FUNCTION-ID =                    34050000
340600                                           PC-REMIT-FUNCTION-ID   34060000
340700                                        OR PC-1099-FUNCTION-ID    34070000
340800                         PERFORM 6003-GET-VENDOR-SHORTNAME        34080000
340900                         MOVE 'A'          TO VNADAU-AUD-FUNC-CDE 34090000
341000                         MOVE ASC-KEY-ENT-ID     TO VNADAU-ENT-ID 34100000
341100                         PERFORM 6050-MOVES-TO-VENDOR-DETAIL      34110000
341200                         PERFORM 6060-INSERT-ADDR-HISTORY-ROW     34120000
341300                         SET ASC-ADD-SUCCESSFUL TO TRUE           34130000
341400                     ELSE                                         34140000
341500*** CHECK IF MQ SERIES PROGRAM LINK IS NEEDED FOR ADD MESSAGE     34150000
341600*** FOR PO ADDRESS OR CORPORATE ADDRESS THAT WAS ADDED ON DB2     34160000
341700*** AND VENDOR ALREADY EXISTS ON RMS                              34170000
341800                         IF ASC-KEY-FUNCTION-ID =                 34180000
341900                                             PC-PO-FUNCTION-ID    34190000
342000                                          OR PC-CORP-FUNCTION-ID  34200000
342030                                                                  34203003
342100                             PERFORM 8100-CHECK-VENDOR-IN-RMS     34210000
342200                             IF (EXTENT-VND-IN-RMS-IND = 'Y') AND 34220000
342300                                (EXTENT-PRIM-TYP-CDE = 'M')       34230000
342400                                IF PRIM-ADDR-IND-DIFFERENT        34240000
342500                                   PERFORM 7200-SEND-UPDATE-RMS   34250000
342600                                END-IF                            34260000
342700                                PERFORM 6100-SEND-ADD-MQ-MESSAGE  34270000
342800                                MOVE PC-TSYMSG-00034              34280000
342900                                  TO DP020-MSG-NUMBER             34290000
343000                                SET  DP020-MSG-INFORMATIONAL      34300000
343100                                     ASC-ADD-SUCCESSFUL TO TRUE   34310000
343200                             ELSE                                 34320000
343300*** CHECK IF ADDITIONAL DB2 INFO PROGRAM LINK IS NEEDED FOR       34330000
343400*** PO ADDRESS THAT WAS ADDED ON DB2 AND VENDOR DOES NOT ALREADY  34340000
343500*** EXIST ON RMS                                                  34350000
343600                                IF (EXTENT-VND-IN-RMS-IND   = 'N')34360000
343700                                   AND (EXTENT-PRIM-TYP-CDE = 'M')34370000
343800                                   AND (ASC-KEY-FUNCTION-ID =     34380000
343900                                                PC-PO-FUNCTION-ID)34390000
344000                                  PERFORM 6200-ADD-NEW-ADDR-TO-RMS34400000
344100                                  MOVE PC-TSYMSG-00034            34410000
344200                                    TO DP020-MSG-NUMBER           34420000
344300                                  SET  DP020-MSG-INFORMATIONAL    34430000
344400                                       ASC-ADD-SUCCESSFUL TO TRUE 34440000
344500                                END-IF                            34450000
344600                             END-IF                               34460000
344700                         ELSE                                     34470000
344800                             IF ASC-UPDATE-WITH-CHANGE            34480000
344900                                CONTINUE                          34490000
345000                             ELSE                                 34500000
345100                                MOVE PC-TSYMSG-00034              34510000
345200                                  TO DP020-MSG-NUMBER             34520000
345300                                SET  DP020-MSG-INFORMATIONAL      34530000
345400                                     ASC-ADD-SUCCESSFUL TO TRUE   34540000
345500                             END-IF                               34550000
345600                         END-IF                                   34560000
345700                     END-IF                                       34570000
345800                                                                  34580000
345900                     IF  ASC-USE-SELECTION-QUEUE                  34590000
346000                         PERFORM 5200-UPDATE-SELECTION-QUEUE      34600000
346100                     END-IF                                       34610000
346200                 ELSE                                             34620000
346300                     IF  SQLCODE = -803                           34630000
346400                         SET PS-ERROR                             34640000
346500                             DP020-MSG-FATAL                      34650000
346600                             DP030-SET-CURSOR-TRAILER             34660000
346700                                          TO TRUE                 34670000
346800                         MOVE PC-TSYMSG-00117                     34680000
346900                           TO DP020-MSG-NUMBER                    34690000
347000                     END-IF                                       34700000
347100                 END-IF                                           34710000
347200             END-IF                                               34720000
347300         END-IF                                                   34730000
347400     END-IF.                                                      34740000
347500                                                                  34750000
347600*----------------------------------------------------------------*34760000
347700* VERIFY THE ADDRESS LENGTH IS LESS THAN 35 FOR REMIT/1099 VNDRS *34770000
347800*----------------------------------------------------------------*34780000
347900 6001-VERIFY-ADDRESS-LENGTH.                                      34790000
348000                                                                  34800000
348100     IF ASC-ADDR12-DESC (36:5) > SPACES OR                        34810000
348200        ASC-ADDR23-DESC (36:5) > SPACES OR                        34820000
348300        ASC-ADDR23-DESC (36:5) > SPACES OR                        34830000
348400        ASC-ADDR34-DESC (36:5) > SPACES                           34840000
348500         SET PS-ERROR                                             34850000
348600             DP020-MSG-FATAL                                      34860000
348700             DP030-SET-CURSOR-TRAILER                             34870000
348800                                     TO TRUE                      34880000
348900         MOVE PC-TSYMSG-01957 TO DP020-MSG-NUMBER                 34890000
349000     END-IF.                                                      34900000
349100                                                                  34910000
349200*----------------------------------------------------------------*34920000
349300* GET THE VENDOR SHORT NAME                                      *34930000
349400*----------------------------------------------------------------*34940000
349500                                                                  34950000
349600 6003-GET-VENDOR-SHORTNAME.                                       34960000
349700                                                                  34970000
349800     PERFORM                                                      34980000
349900         WITH TEST AFTER                                          34990000
350000         VARYING PV-RETRY-COUNTER                                 35000000
350100         FROM 1 BY 1                                              35010000
350200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35020000
350300            OR (SQLCODE = +0)                                     35030000
350400            OR (SQLCODE = +100))                                  35040000
350500                                                                  35050000
350600         EXEC SQL                                                 35060000
350700             SELECT A.ENT_NAME_DESC                               35070000
350800                  , B.DUN_NBR                                     35080000
350900              INTO  :ENTNME-ENT-NAME-DESC                         35090000
351000                  , :EXTENT-DUN-NBR                               35100000
351100                                                                  35110000
351200              FROM  TENTNME A                                     35120000
351300                 ,  TEXTENT B                                     35130000
351400              WHERE A.ENT_ID   = :DK-ENT-ID                       35140000
351500                AND A.ENT_ID   = B.ENT_ID                         35150000
351600                AND A.TYPE_CDE = '04'                             35160000
351700         END-EXEC                                                 35170000
351800                                                                  35180000
351900         EVALUATE TRUE                                            35190000
352000             WHEN SQLCODE = +0                                    35200000
352100                MOVE ENTNME-ENT-NAME-DESC TO WS-VENDOR-SHORTNAME  35210000
352200             WHEN SQLCODE = +100                                  35220000
352300                SET PS-ERROR-NO-SHORT-NAME                        35230000
352400                    DP020-MSG-FATAL                               35240000
352500                    DP030-SET-CURSOR-APPL-1 TO TRUE               35250000
352600                 MOVE PC-TSYMSG-02021 TO DP020-MSG-NUMBER         35260000
352700             WHEN SQLCODE = -904                                  35270000
352800             WHEN SQLCODE = -913                                  35280000
352900                 CONTINUE                                         35290000
353000             WHEN SQLWARN0 NOT = SPACE                            35300000
353100             WHEN SQLCODE < +0                                    35310000
353200             WHEN SQLCODE > +0                                    35320000
353300                 MOVE '6003-GET-VENDOR-SHORTNAME'                 35330000
353400                                 TO DP013-PARAGRAPH               35340000
353500                 MOVE 'SELECT ON ENTERPRISE NAME TABLE'           35350000
353600                                 TO DP013-MESSAGE-TEXT (1)        35360000
353700                 MOVE SQLCA      TO DP013-SQLCA                   35370000
353800                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (1)      35380000
353900                     SET DP013-DB2-ABEND                          35390000
354000                         DP013-XCTL-DISPLAY-RESTART               35400000
354100                                 TO TRUE                          35410000
354200                 PERFORM DP013-0000-PROCESS-ABEND                 35420000
354300         END-EVALUATE                                             35430000
354400     END-PERFORM.                                                 35440000
354500                                                                  35450000
354600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35460000
354700         MOVE '6003-GET-VENDOR-SHORTNAME' TO DP013-PARAGRAPH      35470000
354800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TENTNME'        35480000
354900                                   TO DP013-MESSAGE-TEXT (1)      35490000
355000         MOVE SQLCA                TO DP013-SQLCA                 35500000
355100         SET DP013-DB2-ABEND       TO TRUE                        35510000
355200         PERFORM DP013-0000-PROCESS-ABEND                         35520000
355300     END-IF.                                                      35530000
355400                                                                  35540000
355500 6010-MAX-TBUSLOC.                                                35550000
355600                                                                  35560000
355700     PERFORM                                                      35570000
355800         WITH TEST AFTER                                          35580000
355900         VARYING PV-RETRY-COUNTER                                 35590000
356000         FROM 1 BY 1                                              35600000
356100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35610000
356200             OR (SQLCODE = +0)                                    35620000
356300             OR (SQLCODE = -305))                                 35630000
356400                                                                  35640000
356500         EXEC SQL                                                 35650000
356600              SELECT MAX(SEQ_NBR)                                 35660000
356700                INTO :PV-MAX-TBUSLOC-SEQ-NBR                      35670000
356800                FROM TBUSLOC                                      35680000
356900               WHERE ENT_ID = :DK-ENT-ID                          35690000
357000         END-EXEC                                                 35700000
357100                                                                  35710000
357200         EVALUATE TRUE                                            35720000
357300             WHEN SQLCODE = +0                                    35730000
357400                  COMPUTE PV-NEXT-TBUSLOC-SEQ-NBR =               35740000
357500                          PV-MAX-TBUSLOC-SEQ-NBR + 1              35750000
357600             WHEN SQLCODE = -305                                  35760000
357700                  MOVE +1         TO PV-NEXT-TBUSLOC-SEQ-NBR      35770000
357800             WHEN SQLCODE = -904                                  35780000
357900             WHEN SQLCODE = -913                                  35790000
358000                  CONTINUE                                        35800000
358100                                                                  35810000
358200             WHEN SQLWARN0 NOT = SPACES                           35820000
358300             WHEN SQLCODE < +0                                    35830000
358400             WHEN SQLCODE > +0                                    35840000
358500                  MOVE '6010-MAX-TBUSLOC'                         35850000
358600                                  TO DP013-PARAGRAPH              35860000
358700                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          35870000
358800                                  TO DP013-MESSAGE-TEXT (1)       35880000
358900                  MOVE SQLCA      TO DP013-SQLCA                  35890000
359000                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     35900000
359100                  SET DP013-DB2-ABEND                             35910000
359200                      DP013-XCTL-DISPLAY-RESTART                  35920000
359300                                  TO TRUE                         35930000
359400                  PERFORM DP013-0000-PROCESS-ABEND                35940000
359500         END-EVALUATE                                             35950000
359600     END-PERFORM.                                                 35960000
359700                                                                  35970000
359800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35980000
359900         MOVE '6010-MAX-TBUSLOC'  TO DP013-PARAGRAPH              35990000
360000         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        36000000
360100                                  TO DP013-MESSAGE-TEXT (1)       36010000
360200         MOVE SQLCA               TO DP013-SQLCA                  36020000
360300         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     36030000
360400         SET DP013-DB2-ABEND                                      36040000
360500             DP013-XCTL-DISPLAY-RESTART                           36050000
360600                                  TO TRUE                         36060000
360700         PERFORM DP013-0000-PROCESS-ABEND                         36070000
360800     END-IF.                                                      36080000
360900                                                                  36090000
361000***************************************************************** 36100000
361100* LOAD ADDRESS INFORMATION INTO HOST VARIABLES                    36110000
361200***************************************************************** 36120000
361300                                                                  36130000
361400 6012-LOAD-ADDRESS.                                               36140000
361500                                                                  36150000
361600     IF ASC-PRIM-ADDR-IND = SPACE                                 36160000
361700        MOVE 'N' TO ASC-PRIM-ADDR-IND                             36170000
361800     END-IF.                                                      36180000
361900                                                                  36190000
362000     IF  ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID               36200000
362100         MOVE ASC-ADDR1-EXNAME  TO PV-LOAD-EXTD-NAME              36210000
362200         MOVE SPACES            TO PV-LOAD-1099-NAME              36220000
362300         MOVE ASC-ADDR12-DESC   TO PV-LOAD-ADDRESS1               36230000
362400         MOVE ASC-ADDR23-DESC   TO PV-LOAD-ADDRESS2               36240000
362500         MOVE ASC-ADDR34-DESC   TO PV-LOAD-ADDRESS3               36250000
362600         MOVE SPACES            TO PV-LOAD-ADDRESS4               36260000
362700         PERFORM 6001-VERIFY-ADDRESS-LENGTH                       36270000
362800     ELSE                                                         36280000
362900         IF  ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID            36290000
363000             MOVE SPACES            TO PV-LOAD-EXTD-NAME          36300000
363100             MOVE ASC-ADDR1-EXNAME  TO PV-LOAD-1099-NAME          36310000
363200             MOVE ASC-ADDR12-DESC   TO PV-LOAD-ADDRESS1           36320000
363300             MOVE ASC-ADDR23-DESC   TO PV-LOAD-ADDRESS2           36330000
363400             MOVE ASC-ADDR34-DESC   TO PV-LOAD-ADDRESS3           36340000
363500             MOVE SPACES            TO PV-LOAD-ADDRESS4           36350000
363600             PERFORM 6001-VERIFY-ADDRESS-LENGTH                   36360000
363700         ELSE                                                     36370000
363800            IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID OR         36380000
363900               ASC-KEY-FUNCTION-ID = PC-CORP-FUNCTION-ID          36390000
364000                MOVE SPACES         TO PV-LOAD-EXTD-NAME          36400000
364100                                       PV-LOAD-1099-NAME          36410000
364200                MOVE ASC-ADDR1-EXNAME TO PV-LOAD-ADDRESS1         36420000
364300                MOVE ASC-ADDR12-DESC TO PV-LOAD-ADDRESS2          36430000
364400                MOVE ASC-ADDR23-DESC TO PV-LOAD-ADDRESS3          36440000
364500                MOVE SPACES         TO PV-LOAD-ADDRESS4           36450000
364600            ELSE                                                  36460000
364700               MOVE SPACES          TO PV-LOAD-EXTD-NAME          36470000
364800               MOVE SPACES          TO PV-LOAD-1099-NAME          36480000
364900               MOVE ASC-ADDR1-EXNAME TO PV-LOAD-ADDRESS1          36490000
365000               MOVE ASC-ADDR12-DESC TO PV-LOAD-ADDRESS2           36500000
365100               MOVE ASC-ADDR23-DESC TO PV-LOAD-ADDRESS3           36510000
365200               MOVE ASC-ADDR34-DESC TO PV-LOAD-ADDRESS4           36520000
365300            END-IF                                                36530000
365400         END-IF                                                   36540000
365500     END-IF.                                                      36550000
365600                                                                  36560000
365700***************************************************************** 36570000
365800* VERIFY 1099 ADDRESS DOESN'T EXIST ALREADY                       36580000
365900***************************************************************** 36590000
366000                                                                  36600000
366100 6015-1099-ADDRESS-EXIST.                                         36610000
366200                                                                  36620000
366300     PERFORM                                                      36630000
366400         WITH TEST AFTER                                          36640000
366500         VARYING PV-RETRY-COUNTER                                 36650000
366600         FROM 1 BY 1                                              36660000
366700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36670000
366800             OR (SQLCODE = +0))                                   36680000
366900                                                                  36690000
367000         EXEC SQL                                                 36700000
367100              SELECT COUNT(*)                                     36710000
367200                INTO :PV-1099-ADDRESS-CNT                         36720000
367300                FROM TBUSLOC                                      36730000
367400               WHERE ENT_ID = :DK-ENT-ID                          36740000
367500                 AND FUNCTION_ID = :DK-FUNCTION-ID                36750000
367600         END-EXEC                                                 36760000
367700                                                                  36770000
367800         EVALUATE TRUE                                            36780000
367900             WHEN SQLCODE = +0                                    36790000
368000                  IF PV-1099-ADDRESS-CNT > 0                      36800000
368100                      SET PS-ERROR                                36810000
368200                          DP020-MSG-FATAL                         36820000
368300                          DP030-SET-CURSOR-TRAILER                36830000
368400                                     TO TRUE                      36840000
368500                      MOVE PC-TSYMSG-01958 TO DP020-MSG-NUMBER    36850000
368600                  END-IF                                          36860000
368700             WHEN SQLCODE = -904                                  36870000
368800             WHEN SQLCODE = -913                                  36880000
368900                  CONTINUE                                        36890000
369000                                                                  36900000
369100             WHEN SQLWARN0 NOT = SPACES                           36910000
369200             WHEN SQLCODE < +0                                    36920000
369300             WHEN SQLCODE > +0                                    36930000
369400                  MOVE '6015-1099-ADDRESS-EXIST'                  36940000
369500                                  TO DP013-PARAGRAPH              36950000
369600                  MOVE 'UNSUCCESSFUL SELECT 1099 ADDRESS'         36960000
369700                                  TO DP013-MESSAGE-TEXT (1)       36970000
369800                  MOVE SQLCA      TO DP013-SQLCA                  36980000
369900                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     36990000
370000                  SET DP013-DB2-ABEND                             37000000
370100                      DP013-XCTL-DISPLAY-RESTART                  37010000
370200                                  TO TRUE                         37020000
370300                  PERFORM DP013-0000-PROCESS-ABEND                37030000
370400         END-EVALUATE                                             37040000
370500     END-PERFORM.                                                 37050000
370600                                                                  37060000
370700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37070000
370800         MOVE '6015-1099-ADDRESS-EXIST' TO DP013-PARAGRAPH        37080000
370900         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        37090000
371000                                  TO DP013-MESSAGE-TEXT (1)       37100000
371100         MOVE SQLCA               TO DP013-SQLCA                  37110000
371200         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     37120000
371300         SET DP013-DB2-ABEND                                      37130000
371400             DP013-XCTL-DISPLAY-RESTART                           37140000
371500                                  TO TRUE                         37150000
371600         PERFORM DP013-0000-PROCESS-ABEND                         37160000
371700     END-IF.                                                      37170000
371800                                                                  37180000
371900/                                                                 37190000
372000 6020-INSERT-TBUSLOC.                                             37200000
372100                                                                  37210000
372200     PERFORM                                                      37220000
372300         WITH TEST AFTER                                          37230000
372400         VARYING PV-RETRY-COUNTER                                 37240000
372500         FROM 1 BY 1                                              37250000
372600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37260000
372700             OR (SQLCODE = +0)                                    37270000
372800             OR (SQLCODE = -803))                                 37280000
372900                                                                  37290000
373000         EXEC SQL                                                 37300000
373100             INSERT  INTO TBUSLOC                                 37310000
373200                   ( ENT_ID                                       37320000
373300                    ,SEQ_NBR                                      37330000
373400                    ,ADDRESS_LINE1_DESC                           37340000
373500                    ,ADDRESS_LINE2_DESC                           37350000
373600                    ,ADDRESS_LINE3_DESC                           37360000
373700                    ,ADDRESS_LINE4_DESC                           37370000
373800                    ,ATTENTION_TO_TXT                             37380000
373900                    ,CITY_NAME                                    37390000
374000                    ,STATE_CDE                                    37400000
374100                    ,ZIP_CDE                                      37410000
374200                    ,ROOM_NBR                                     37420000
374300                    ,COMMENT1_TXT                                 37430000
374400                    ,COMMENT2_TXT                                 37440000
374500                    ,COMMENT3_TXT                                 37450000
374600                    ,FUNCTION_ID                                  37460000
374700                    ,LAST_UPDATE_TMST                             37470000
374800                    ,LAST_UPDATE_ID                               37480000
374900                    ,ST_PROV_CDE                                  37490000
375000                    ,CNTRY_CDE                                    37500000
375100                    ,EXTD_VND_NM                                  37510000
375200                    ,ALT_1099_VND_NM                              37520000
375300                    ,PRIM_ADDR_IND)                               37530000
375400            VALUES  (:DK-ENT-ID                                   37540000
375500                    ,:PV-NEXT-TBUSLOC-SEQ-NBR                     37550000
375600                    ,:PV-LOAD-ADDRESS1                            37560000
375700                    ,:PV-LOAD-ADDRESS2                            37570000
375800                    ,:PV-LOAD-ADDRESS3                            37580000
375900                    ,:PV-LOAD-ADDRESS4                            37590000
376000                    ,:ASC-ATTENTION-TO-TXT                        37600000
376100                    ,:ASC-CITY                                    37610000
376200                    ,:ASC-OLD-STATE-CDE                           37620000
376300                    ,:ASC-ZIP                                     37630000
376400                    ,:ASC-ROOM-NBR                                37640000
376500                    ,:ASC-COMMENT1-TXT                            37650000
376600                    ,:ASC-COMMENT2-TXT                            37660000
376700                    ,:ASC-COMMENT3-TXT                            37670000
376800                    ,:DK-FUNCTION-ID                              37680000
376900                    , CURRENT TIMESTAMP                           37690000
377000                    ,:DP020-USERID                                37700000
377100                    ,:ASC-STATE-CDE                               37710000
377200                    ,:ASC-COUNTRY-CDE                             37720000
377300                    ,:PV-LOAD-EXTD-NAME                           37730000
377400                    ,:PV-LOAD-1099-NAME                           37740000
377500                    ,:ASC-PRIM-ADDR-IND)                          37750000
377600         END-EXEC                                                 37760000
377700                                                                  37770000
377800         EVALUATE TRUE                                            37780000
377900             WHEN SQLCODE = +0                                    37790000
378000             WHEN SQLCODE = -803                                  37800000
378100             WHEN SQLCODE = -904                                  37810000
378200             WHEN SQLCODE = -913                                  37820000
378300                 CONTINUE                                         37830000
378400             WHEN SQLWARN0 NOT = SPACES                           37840000
378500             WHEN SQLCODE < +0                                    37850000
378600             WHEN SQLCODE > +0                                    37860000
378700                 MOVE '6020-INSERT-TBUSLOC'                       37870000
378800                                   TO DP013-PARAGRAPH             37880000
378900                 MOVE 'INSERT A ROW ON TBUSLOC'                   37890000
379000                                   TO DP013-MESSAGE-TEXT(1)       37900000
379100                 MOVE SQLCA        TO DP013-SQLCA                 37910000
379200                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    37920000
379300                 SET DP013-DB2-ABEND                              37930000
379400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37940000
379500                 PERFORM DP013-0000-PROCESS-ABEND                 37950000
379600         END-EVALUATE                                             37960000
379700     END-PERFORM.                                                 37970000
379800                                                                  37980000
379900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37990000
380000         MOVE '6020-INSERT-TBUSLOC'                               38000000
380100                                   TO DP013-PARAGRAPH             38010000
380200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38020000
380300                                   TO DP013-MESSAGE-TEXT (1)      38030000
380400         MOVE 'TO INSERT A TBUSLOC ROW'                           38040000
380500                                   TO DP013-MESSAGE-TEXT (2)      38050000
380600         MOVE SQLCA                TO DP013-SQLCA                 38060000
380700         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    38070000
380800         SET DP013-DB2-ABEND                                      38080000
380900             DP013-XCTL-DISPLAY-RESTART                           38090000
381000                                   TO TRUE                        38100000
381100         PERFORM DP013-0000-PROCESS-ABEND                         38110000
381200     END-IF.                                                      38120000
381300                                                                  38130000
381400/                                                                 38140000
381500 6030-MAX-TENTREP.                                                38150000
381600                                                                  38160000
381700     PERFORM                                                      38170000
381800         WITH TEST AFTER                                          38180000
381900         VARYING PV-RETRY-COUNTER                                 38190000
382000         FROM 1 BY 1                                              38200000
382100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38210000
382200             OR (SQLCODE = +0)                                    38220000
382300             OR (SQLCODE = -305))                                 38230000
382400                                                                  38240000
382500         EXEC SQL                                                 38250000
382600              SELECT MAX(SEQ_NBR)                                 38260000
382700                INTO :PV-MAX-TENTREP-SEQ-NBR                      38270000
382800                FROM TENTREP                                      38280000
382900               WHERE ENT_ID = :DK-ENT-ID                          38290000
383000         END-EXEC                                                 38300000
383100                                                                  38310000
383200         EVALUATE TRUE                                            38320000
383300             WHEN SQLCODE = +0                                    38330000
383400                  COMPUTE PV-NEXT-TENTREP-SEQ-NBR =               38340000
383500                          PV-MAX-TENTREP-SEQ-NBR + 1              38350000
383600                  MOVE    PV-NEXT-TENTREP-SEQ-NBR TO              38360000
383700                          ASC-TENTREP-SEQ-NBR                     38370000
383800             WHEN SQLCODE = -305                                  38380000
383900                  MOVE +1         TO PV-NEXT-TENTREP-SEQ-NBR      38390000
384000                                     ASC-TENTREP-SEQ-NBR          38400000
384100             WHEN SQLCODE = -904                                  38410000
384200             WHEN SQLCODE = -913                                  38420000
384300                  CONTINUE                                        38430000
384400                                                                  38440000
384500             WHEN SQLWARN0 NOT = SPACES                           38450000
384600             WHEN SQLCODE < +0                                    38460000
384700             WHEN SQLCODE > +0                                    38470000
384800                  MOVE '6030-MAX-TENTREP'                         38480000
384900                                  TO DP013-PARAGRAPH              38490000
385000                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          38500000
385100                                  TO DP013-MESSAGE-TEXT (1)       38510000
385200                  MOVE SQLCA      TO DP013-SQLCA                  38520000
385300                  MOVE 'TENTREP ' TO DP013-DB2-TABLE-NAME (1)     38530000
385400                  SET DP013-DB2-ABEND                             38540000
385500                      DP013-XCTL-DISPLAY-RESTART                  38550000
385600                                  TO TRUE                         38560000
385700                  PERFORM DP013-0000-PROCESS-ABEND                38570000
385800         END-EVALUATE                                             38580000
385900     END-PERFORM.                                                 38590000
386000                                                                  38600000
386100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38610000
386200         MOVE '6030-MAX-TENTREP'  TO DP013-PARAGRAPH              38620000
386300         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        38630000
386400                                  TO DP013-MESSAGE-TEXT (1)       38640000
386500         MOVE SQLCA               TO DP013-SQLCA                  38650000
386600         MOVE 'TENTREP '          TO DP013-DB2-TABLE-NAME (1)     38660000
386700         SET DP013-DB2-ABEND                                      38670000
386800             DP013-XCTL-DISPLAY-RESTART                           38680000
386900                                  TO TRUE                         38690000
387000         PERFORM DP013-0000-PROCESS-ABEND                         38700000
387100     END-IF.                                                      38710000
387200                                                                  38720000
387300/                                                                 38730000
387400 6040-INSERT-TENTREP.                                             38740000
387500                                                                  38750000
387600     PERFORM                                                      38760000
387700         WITH TEST AFTER                                          38770000
387800         VARYING PV-RETRY-COUNTER                                 38780000
387900         FROM 1 BY 1                                              38790000
388000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38800000
388100             OR (SQLCODE = +0)                                    38810000
388200             OR (SQLCODE = -803))                                 38820000
388300                                                                  38830000
388400         EXEC SQL                                                 38840000
388500             INSERT  INTO TENTREP                                 38850000
388600                   ( ENT_ID                                       38860000
388700                    ,SEQ_NBR                                      38870000
388800                    ,FIRST_NAME                                   38880000
388900                    ,LAST_NAME                                    38890000
389000                    ,TITLE_NAME                                   38900000
389100                    ,TEL1_NBR                                     38910000
389200                    ,TEL1_EXT_NBR                                 38920000
389300                    ,TEL2_NBR                                     38930000
389400                    ,TEL2_EXT_NBR                                 38940000
389500                    ,FAX_NBR                                      38950000
389600                    ,EMAIL_ADDR_ID                                38960000
389700                    ,ENT_BUS_LOC_ID                               38970000
389800                    ,FUNCTION_ID                                  38980000
389900                    ,LAST_UPDATE_TMST                             38990000
390000                    ,LAST_UPDATE_ID                               39000000
390100                    ,TEL_1_CNTRY_CDE                              39010000
390200                    ,TEL_2_CNTRY_CDE)                             39020000
390300            VALUES  (:DK-ENT-ID                                   39030000
390400                    ,:PV-NEXT-TENTREP-SEQ-NBR                     39040000
390500                    ,:ASC-FIRST-NAME                              39050000
390600                    ,:ASC-LAST-NAME                               39060000
390700                    ,:ASC-TITLE                                   39070000
390800                    ,:ASC-TEL1-NBR                                39080000
390900                    ,:ASC-TEL1-EXT-NBR                            39090000
391000                    ,:ASC-TEL2-NBR                                39100000
391100                    ,:ASC-TEL2-EXT-NBR                            39110000
391200                    ,:ASC-FAX-NBR                                 39120000
391300                    ,:ASC-EMAIL-ADDR                              39130000
391400                    ,:PV-NEXT-TBUSLOC-SEQ-NBR                     39140000
391500                    ,:DK-FUNCTION-ID                              39150000
391600                    , CURRENT TIMESTAMP                           39160000
391700                    ,:DP020-USERID                                39170000
391800                    ,:ASC-TEL1-CNTY-PH-CD                         39180000
391900                    ,:ASC-TEL2-CNTY-PH-CD)                        39190000
392000         END-EXEC                                                 39200000
392100                                                                  39210000
392200         EVALUATE TRUE                                            39220000
392300             WHEN SQLCODE = +0                                    39230000
392400             WHEN SQLCODE = -803                                  39240000
392500             WHEN SQLCODE = -904                                  39250000
392600             WHEN SQLCODE = -913                                  39260000
392700                 CONTINUE                                         39270000
392800             WHEN SQLWARN0 NOT = SPACES                           39280000
392900             WHEN SQLCODE < +0                                    39290000
393000             WHEN SQLCODE > +0                                    39300000
393100                 MOVE '6040-INSERT-TENTREP'                       39310000
393200                                   TO DP013-PARAGRAPH             39320000
393300                 MOVE 'INSERT A ROW ON TENTREP'                   39330000
393400                                   TO DP013-MESSAGE-TEXT(1)       39340000
393500                 MOVE SQLCA        TO DP013-SQLCA                 39350000
393600                 MOVE 'TENTREP'    TO DP013-DB2-TABLE-NAME (1)    39360000
393700                 SET DP013-DB2-ABEND                              39370000
393800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39380000
393900                 PERFORM DP013-0000-PROCESS-ABEND                 39390000
394000         END-EVALUATE                                             39400000
394100     END-PERFORM.                                                 39410000
394200                                                                  39420000
394300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39430000
394400         MOVE '6040-INSERT-TENTREP'                               39440000
394500                                   TO DP013-PARAGRAPH             39450000
394600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39460000
394700                                   TO DP013-MESSAGE-TEXT (1)      39470000
394800         MOVE 'TO INSERT A TENTREP ROW'                           39480000
394900                                   TO DP013-MESSAGE-TEXT (2)      39490000
395000         MOVE SQLCA                TO DP013-SQLCA                 39500000
395100         MOVE 'TENTREP'            TO DP013-DB2-TABLE-NAME (1)    39510000
395200         SET DP013-DB2-ABEND                                      39520000
395300             DP013-XCTL-DISPLAY-RESTART                           39530000
395400                                   TO TRUE                        39540000
395500         PERFORM DP013-0000-PROCESS-ABEND                         39550000
395600     END-IF.                                                      39560000
395700 6050-MOVES-TO-VENDOR-DETAIL.                                     39570000
395800     MOVE PV-NEXT-TBUSLOC-SEQ-NBR TO VNADAU-SEQ-NBR.              39580000
395900     MOVE ASC-FIRST-NAME          TO VNADAU-REP-1ST-NM.           39590000
396000     MOVE ASC-LAST-NAME           TO VNADAU-REP-LAST-NM.          39600000
396100     MOVE ASC-ADDR1-EXNAME        TO VNADAU-EXTD-VND-NM.          39610000
396200     MOVE ASC-ADDR12-DESC         TO VNADAU-VND-1ST-LNE-ADDR.     39620000
396300     MOVE ASC-ADDR23-DESC         TO VNADAU-VND-2ND-LNE-ADDR.     39630000
396400     MOVE ASC-ADDR34-DESC         TO VNADAU-VND-3RD-LNE-ADDR.     39640000
396500     MOVE ASC-CITY                TO VNADAU-CTY-NM.               39650000
396600     MOVE ASC-STATE-CDE           TO VNADAU-ST-PROV-CDE.          39660000
396700     MOVE ASC-ZIP                 TO VNADAU-ZIP-CDE.              39670000
396800     MOVE ASC-COUNTRY-CDE         TO VNADAU-CNTRY-CDE.            39680000
396900     MOVE ASC-ATTENTION-TO-TXT    TO VNADAU-ATTN-TO-TXT.          39690000
397000                                                                  39700000
397100 6060-INSERT-ADDR-HISTORY-ROW.                                    39710000
397200     PERFORM                                                      39720000
397300         WITH TEST AFTER                                          39730000
397400         VARYING PV-RETRY-COUNTER                                 39740000
397500         FROM 1 BY 1                                              39750000
397600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39760000
397700                   OR (SQLCODE = ZERO))                           39770000
397800         EXEC SQL                                                 39780000
397900             INSERT INTO TVNADAU                                  39790000
398000                 (  ENT_ID                                        39800000
398100                  ,SEQ_NBR                                        39810000
398200                  ,AUD_TMST                                       39820000
398300                  ,LAST_UPD_BY_USR_ID                             39830000
398400                  ,AUD_FUNC_CDE                                   39840000
398500                  ,REP_1ST_NM                                     39850000
398600                  ,REP_LAST_NM                                    39860000
398700                  ,EXTD_VND_NM                                    39870000
398800                  ,VND_1ST_LNE_ADDR                               39880000
398900                  ,VND_2ND_LNE_ADDR                               39890000
399000                  ,VND_3RD_LNE_ADDR                               39900000
399100                  ,CTY_NM                                         39910000
399200                  ,ST_PROV_CDE                                    39920000
399300                  ,ZIP_CDE                                        39930000
399400                  ,CNTRY_CDE                                      39940000
399500                  ,ATTN_TO_TXT)                                   39950000
399600             VALUES                                               39960000
399700                 (:VNADAU-ENT-ID                                  39970000
399800                 ,:VNADAU-SEQ-NBR                                 39980000
399900                 ,CURRENT TIMESTAMP                               39990000
400000                 ,:DP020-USERID                                   40000000
400100                 ,:VNADAU-AUD-FUNC-CDE                            40010000
400200                 ,:VNADAU-REP-1ST-NM                              40020000
400300                 ,:VNADAU-REP-LAST-NM                             40030000
400400                 ,:VNADAU-EXTD-VND-NM                             40040000
400500                 ,:VNADAU-VND-1ST-LNE-ADDR                        40050000
400600                 ,:VNADAU-VND-2ND-LNE-ADDR                        40060000
400700                 ,:VNADAU-VND-3RD-LNE-ADDR                        40070000
400800                 ,:VNADAU-CTY-NM                                  40080000
400900                 ,:VNADAU-ST-PROV-CDE                             40090000
401000                 ,:VNADAU-ZIP-CDE                                 40100000
401100                 ,:VNADAU-CNTRY-CDE                               40110000
401200                 ,:VNADAU-ATTN-TO-TXT)                            40120000
401300         END-EXEC                                                 40130000
401400                                                                  40140000
401500         EVALUATE TRUE                                            40150000
401600             WHEN SQLCODE = ZERO                                  40160000
401700             WHEN SQLCODE = -904                                  40170000
401800             WHEN SQLCODE = -913                                  40180000
401900                 CONTINUE                                         40190000
402000             WHEN SQLWARN0 NOT = SPACES                           40200000
402100             WHEN SQLCODE < ZERO                                  40210000
402200             WHEN SQLCODE > ZERO                                  40220000
402300                 MOVE '6060-INSERT-ADDR-HISTORY-ROW'              40230000
402400                                   TO DP013-PARAGRAPH             40240000
402500                 MOVE 'ADD A ROW TO THE ADDRESS HISTORY TBL'      40250000
402600                                   TO DP013-MESSAGE-TEXT(1)       40260000
402700                 MOVE SQLCA        TO DP013-SQLCA                 40270000
402800                 MOVE 'TVNADAU'    TO DP013-DB2-TABLE-NAME (1)    40280000
402900                 SET DP013-DB2-ABEND                              40290000
403000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40300000
403100                 PERFORM DP013-0000-PROCESS-ABEND                 40310000
403200         END-EVALUATE                                             40320000
403300     END-PERFORM.                                                 40330000
403400                                                                  40340000
403500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40350000
403600         MOVE '6060-INSERT-ADDR-HISTORY-ROW'                      40360000
403700                                   TO DP013-PARAGRAPH             40370000
403800         MOVE 'MAX RETRIES EXCEEDED TRYING TO INSERT TVNADAU ROW' 40380000
403900                                   TO DP013-MESSAGE-TEXT (1)      40390000
404000         MOVE SQLCA                TO DP013-SQLCA                 40400000
404100         MOVE 'TVNADAU'            TO DP013-DB2-TABLE-NAME (1)    40410000
404200         SET DP013-DB2-ABEND                                      40420000
404300             DP013-XCTL-DISPLAY-RESTART                           40430000
404400                                   TO TRUE                        40440000
404500         PERFORM DP013-0000-PROCESS-ABEND                         40450000
404600     END-IF.                                                      40460000
404700                                                                  40470000
404800***************************************************************** 40480000
404900*            SELECT TBUSLOC ROW FOR ADDRESS DETAIL COMPARE      * 40490000
405000***************************************************************** 40500000
405100                                                                  40510000
405200 6070-SELECT-TBUSLOC.                                             40520000
405300                                                                  40530000
405400     PERFORM                                                      40540000
405500         WITH TEST AFTER                                          40550000
405600         VARYING PV-RETRY-COUNTER                                 40560000
405700         FROM 1 BY 1                                              40570000
405800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40580000
405900             OR (SQLCODE = +0))                                   40590000
406000                                                                  40600000
406100         EXEC SQL                                                 40610000
406200              SELECT ADDRESS_LINE1_DESC                           40620000
406300                    ,ADDRESS_LINE2_DESC                           40630000
406400                    ,ADDRESS_LINE3_DESC                           40640000
406500                    ,ATTENTION_TO_TXT                             40650000
406600                    ,CITY_NAME                                    40660000
406700                    ,ZIP_CDE                                      40670000
406800                    ,ST_PROV_CDE                                  40680000
406900                    ,CNTRY_CDE                                    40690000
407000                    ,EXTD_VND_NM                                  40700000
407100                    ,ALT_1099_VND_NM                              40710000
407200                    ,PRIM_ADDR_IND                                40720000
407300                INTO :BUSLOC-ADDRESS-LINE1-DESC                   40730000
407400                    ,:BUSLOC-ADDRESS-LINE2-DESC                   40740000
407500                    ,:BUSLOC-ADDRESS-LINE3-DESC                   40750000
407600                    ,:BUSLOC-ATTENTION-TO-TXT                     40760000
407700                    ,:BUSLOC-CITY-NAME                            40770000
407800                    ,:BUSLOC-ZIP-CDE                              40780000
407900                    ,:BUSLOC-ST-PROV-CDE                          40790000
408000                    ,:BUSLOC-CNTRY-CDE                            40800000
408100                    ,:BUSLOC-EXTD-VND-NM                          40810000
408200                    ,:BUSLOC-ALT-1099-VND-NM                      40820000
408300                    ,:BUSLOC-PRIM-ADDR-IND                        40830000
408400                FROM TBUSLOC                                      40840000
408500               WHERE ENT_ID = :ASC-KEY-ENT-ID                     40850000
408600                 AND FUNCTION_ID = :ASC-KEY-FUNCTION-ID           40860000
408700                 AND SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR               40870000
408800         END-EXEC                                                 40880000
408900                                                                  40890000
409000         EVALUATE TRUE                                            40900000
409100             WHEN SQLCODE = +0                                    40910000
409200             WHEN SQLCODE = -904                                  40920000
409300             WHEN SQLCODE = -913                                  40930000
409400                  CONTINUE                                        40940000
409500             WHEN SQLWARN0 NOT = SPACES                           40950000
409600             WHEN SQLCODE < +0                                    40960000
409700             WHEN SQLCODE > +0                                    40970000
409800                  MOVE '6070-SELECT-TBUSLOC '                     40980000
409900                                  TO DP013-PARAGRAPH              40990000
410000                  MOVE 'UNSUCCESSFUL SELECT ADDRESS   '           41000000
410100                                  TO DP013-MESSAGE-TEXT (1)       41010000
410200                  MOVE SQLCA      TO DP013-SQLCA                  41020000
410300                  MOVE 'TBUSLOC ' TO DP013-DB2-TABLE-NAME (1)     41030000
410400                  SET DP013-DB2-ABEND                             41040000
410500                      DP013-XCTL-DISPLAY-RESTART                  41050000
410600                                  TO TRUE                         41060000
410700                  PERFORM DP013-0000-PROCESS-ABEND                41070000
410800         END-EVALUATE                                             41080000
410900     END-PERFORM.                                                 41090000
411000                                                                  41100000
411100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41110000
411200         MOVE '6070-SELECT-TBUSLOC ' TO DP013-PARAGRAPH           41120000
411300         MOVE 'MAX RETRIES EXCEEDED ON SELECT ADDRESS  '          41130000
411400                                  TO DP013-MESSAGE-TEXT (1)       41140000
411500         MOVE SQLCA               TO DP013-SQLCA                  41150000
411600         MOVE 'TBUSLOC '          TO DP013-DB2-TABLE-NAME (1)     41160000
411700         SET DP013-DB2-ABEND                                      41170000
411800             DP013-XCTL-DISPLAY-RESTART                           41180000
411900                                  TO TRUE                         41190000
412000         PERFORM DP013-0000-PROCESS-ABEND                         41200000
412100     END-IF.                                                      41210000
412200                                                                  41220000
412300***************************************************************** 41230000
412400*            SELECT TENTREP ROW FOR ADDRESS DETAIL COMPARE      * 41240000
412500***************************************************************** 41250000
412600                                                                  41260000
412700 6075-SELECT-TENTREP.                                             41270000
412800                                                                  41280000
412900     PERFORM                                                      41290000
413000         WITH TEST AFTER                                          41300000
413100         VARYING PV-RETRY-COUNTER                                 41310000
413200         FROM 1 BY 1                                              41320000
413300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41330000
413400             OR (SQLCODE = +0))                                   41340000
413500                                                                  41350000
413600         EXEC SQL                                                 41360000
413700              SELECT FIRST_NAME                                   41370000
413800                    ,LAST_NAME                                    41380000
413900                INTO :ENTREP-FIRST-NAME                           41390000
414000                    ,:ENTREP-LAST-NAME                            41400000
414100                FROM TENTREP                                      41410000
414200               WHERE ENT_ID = :ASC-KEY-ENT-ID                     41420000
414300                 AND FUNCTION_ID = :ASC-KEY-FUNCTION-ID           41430000
414400                 AND SEQ_NBR = :ASC-TENTREP-SEQ-NBR               41440000
414500         END-EXEC                                                 41450000
414600                                                                  41460000
414700         EVALUATE TRUE                                            41470000
414800             WHEN SQLCODE = +0                                    41480000
414900             WHEN SQLCODE = -904                                  41490000
415000             WHEN SQLCODE = -913                                  41500000
415100                  CONTINUE                                        41510000
415200             WHEN SQLWARN0 NOT = SPACES                           41520000
415300             WHEN SQLCODE < +0                                    41530000
415400             WHEN SQLCODE > +0                                    41540000
415500                  MOVE '6075-SELECT-TENTREP '                     41550000
415600                                  TO DP013-PARAGRAPH              41560000
415700                  MOVE 'UNSUCCESSFUL SELECT TENTREP   '           41570000
415800                                  TO DP013-MESSAGE-TEXT (1)       41580000
415900                  MOVE SQLCA      TO DP013-SQLCA                  41590000
416000                  MOVE 'TENTREP ' TO DP013-DB2-TABLE-NAME (1)     41600000
416100                  SET DP013-DB2-ABEND                             41610000
416200                      DP013-XCTL-DISPLAY-RESTART                  41620000
416300                                  TO TRUE                         41630000
416400                  PERFORM DP013-0000-PROCESS-ABEND                41640000
416500         END-EVALUATE                                             41650000
416600     END-PERFORM.                                                 41660000
416700                                                                  41670000
416800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41680000
416900         MOVE '6075-SELECT-TENTREP ' TO DP013-PARAGRAPH           41690000
417000         MOVE 'MAX RETRIES EXCEEDED ON SELECT ADDRESS  '          41700000
417100                                  TO DP013-MESSAGE-TEXT (1)       41710000
417200         MOVE SQLCA               TO DP013-SQLCA                  41720000
417300         MOVE 'TENTREP '          TO DP013-DB2-TABLE-NAME (1)     41730000
417400         SET DP013-DB2-ABEND                                      41740000
417500             DP013-XCTL-DISPLAY-RESTART                           41750000
417600                                  TO TRUE                         41760000
417700         PERFORM DP013-0000-PROCESS-ABEND                         41770000
417800     END-IF.                                                      41780000
417900                                                                  41790000
418000 6080-CHECK-FOR-UPDATE.                                           41800000
418100     IF ASC-FIRST-NAME NOT = ENTREP-FIRST-NAME                    41810000
418200        SET VN-UPDATE-PERFORMED      TO TRUE                      41820000
418300        MOVE ASC-FIRST-NAME          TO VNADAU-REP-1ST-NM.        41830000
418400                                                                  41840000
418500     IF ASC-LAST-NAME NOT = ENTREP-LAST-NAME                      41850000
418600        SET VN-UPDATE-PERFORMED      TO TRUE                      41860000
418700        MOVE ASC-LAST-NAME           TO VNADAU-REP-LAST-NM.       41870000
418800                                                                  41880000
418900     IF ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID                41890000
419000       IF ASC-ADDR1-EXNAME NOT = BUSLOC-EXTD-VND-NM               41900000
419100        SET VN-UPDATE-PERFORMED      TO TRUE                      41910000
419200        MOVE ASC-ADDR1-EXNAME        TO VNADAU-EXTD-VND-NM.       41920000
419300                                                                  41930000
419400     IF ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID                 41940000
419500       IF ASC-ADDR1-EXNAME NOT = BUSLOC-ALT-1099-VND-NM           41950000
419600        SET VN-UPDATE-PERFORMED      TO TRUE                      41960000
419700        MOVE ASC-ADDR1-EXNAME        TO VNADAU-EXTD-VND-NM.       41970000
419800                                                                  41980000
419900     IF ASC-ADDR12-DESC NOT = BUSLOC-ADDRESS-LINE1-DESC OR        41990000
420000        ASC-ADDR23-DESC NOT = BUSLOC-ADDRESS-LINE2-DESC OR        42000000
420100        ASC-ADDR34-DESC NOT = BUSLOC-ADDRESS-LINE3-DESC           42010000
420200        SET VN-UPDATE-PERFORMED      TO TRUE                      42020000
420300        MOVE ASC-ADDR12-DESC         TO VNADAU-VND-1ST-LNE-ADDR   42030000
420400        MOVE ASC-ADDR23-DESC         TO VNADAU-VND-2ND-LNE-ADDR   42040000
420500        MOVE ASC-ADDR34-DESC         TO VNADAU-VND-3RD-LNE-ADDR.  42050000
420600                                                                  42060000
420700     IF ASC-CITY NOT = BUSLOC-CITY-NAME                           42070000
420800        SET VN-UPDATE-PERFORMED      TO TRUE                      42080000
420900        MOVE ASC-CITY                TO VNADAU-CTY-NM.            42090000
421000                                                                  42100000
421100     IF ASC-STATE-CDE NOT = BUSLOC-ST-PROV-CDE                    42110000
421200        SET VN-UPDATE-PERFORMED      TO TRUE                      42120000
421300        MOVE ASC-STATE-CDE           TO VNADAU-ST-PROV-CDE.       42130000
421400                                                                  42140000
421500     IF ASC-ZIP NOT = BUSLOC-ZIP-CDE                              42150000
421600        SET VN-UPDATE-PERFORMED      TO TRUE                      42160000
421700        MOVE ASC-ZIP                 TO VNADAU-ZIP-CDE.           42170000
421800                                                                  42180000
421900     IF ASC-COUNTRY-CDE NOT = BUSLOC-CNTRY-CDE                    42190000
422000        SET VN-UPDATE-PERFORMED      TO TRUE                      42200000
422100        MOVE ASC-COUNTRY-CDE         TO VNADAU-CNTRY-CDE.         42210000
422200                                                                  42220000
422300     IF ASC-ATTENTION-TO-TXT NOT = BUSLOC-ALT-1099-VND-NM         42230000
422400        SET VN-UPDATE-PERFORMED      TO TRUE                      42240000
422500        MOVE ASC-ATTENTION-TO-TXT    TO VNADAU-ATTN-TO-TXT.       42250000
422600                                                                  42260000
422700                                                                  42270000
422800/                                                                 42280000
422900*----------------------------------------------------------------*42290000
423000*    FORMAT AND LINK THE MQ SERIES PROGRAM FOR ADDING ADDRESS    *42300000
423100*    RMS.                                                        *42310000
423200*----------------------------------------------------------------*42320000
423300 6100-SEND-ADD-MQ-MESSAGE.                                        42330000
423400                                                                  42340000
423500     INITIALIZE VN007-INTERFACE-MESSAGE-PARMS.                    42350000
423600                                                                  42360000
423700     PERFORM 8150-GET-VENDOR-NAME.                                42370000
423800                                                                  42380000
423900     MOVE PV-DUN-NBR                TO VN007-VND-NBR.             42390000
424000     MOVE DK-ENT-ID                 TO VN007-ENT-ID.              42400000
424100     MOVE ASC-KEY-FUNCTION-ID       TO VN007-FUNCTION-ID(1).      42410000
424200     MOVE PV-NEXT-TBUSLOC-SEQ-NBR   TO VN007-ADDR-SEQ-NBR(1).     42420000
424300     MOVE ASC-PRIM-ADDR-IND         TO VN007-PRIM-ADDR-IND(1).    42430000
424400     MOVE ASC-COUNTRY-CDE           TO VN007-CNTRY-CD(1).         42440000
424500     MOVE PV-LOAD-ADDRESS1          TO VN007-ADDR-LINE1(1).       42450000
424600     MOVE PV-LOAD-ADDRESS2          TO VN007-ADDR-LINE2(1).       42460000
424700     MOVE PV-LOAD-ADDRESS3          TO VN007-ADDR-LINE3(1).       42470000
424800     MOVE ASC-CITY                  TO VN007-CITY(1).             42480000
424900     MOVE ASC-STATE-CDE             TO VN007-ST-PROV-CDE(1).      42490000
425000     MOVE ASC-ZIP                   TO VN007-ZIP-CDE(1).          42500000
425100     MOVE ASC-EMAIL-ADDR            TO VN007-EMAIL-ADD(1).        42510000
425200     STRING ASC-FIRST-NAME DELIMITED BY '  '                      42520000
425300            ' '            DELIMITED BY SIZE                      42530000
425400            ASC-LAST-NAME  DELIMITED BY '  '                      42540000
425500                                  INTO VN007-CONTACT-NAME(1).     42550000
425600     MOVE ASC-TEL1-NBR              TO VN007-TEL1-NBR(1).         42560000
425700     MOVE ASC-FAX-NBR               TO VN007-FAX-NBR(1).          42570000
425800     MOVE 'N'                       TO VN007-ADDR-DELETE-IND(1).  42580000
425900                                                                  42590000
426000     EXEC CICS                                                    42600000
426100      LINK PROGRAM (PC-VNKCS024)                                  42610000
426200           COMMAREA(VN007-COMMAREA)                               42620000
426300           RESP    (PV-CICS-RESPONSE)                             42630000
426400     END-EXEC.                                                    42640000
426500                                                                  42650000
426600     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   42660000
426700         MOVE '6100-SEND-ADD-MQ-MESSAGE'                          42670000
426800                         TO DP013-PARAGRAPH                       42680000
426900         MOVE 'UNSUCCESSFUL LINK TO VNKCS024'                     42690000
427000                         TO DP013-MESSAGE-TEXT(1)                 42700000
427100         SET DP013-CICS-ABEND                                     42710000
427200             DP013-ROLLBACK                                       42720000
427300             DP013-XCTL-DISPLAY-RESTART                           42730000
427400                         TO TRUE                                  42740000
427500         PERFORM DP013-0000-PROCESS-ABEND                         42750000
427600     ELSE                                                         42760000
427700        IF VN007-NO-ERRORS                                        42770000
427800           NEXT SENTENCE                                          42780000
427900        ELSE                                                      42790000
428000           IF VN007-MQ-ERROR                                      42800000
428100              MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM          42810000
428200              MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH        42820000
428300              MOVE VN007-REASON-CODE    TO DP013-MESSAGE-TEXT(1)  42830000
428400              MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT(2)  42840000
428500              SET DP013-XCTL-DISPLAY-RESTART                      42850000
428600                  DP013-ROLLBACK                                  42860000
428700                  DP013-OTHER-ABEND     TO TRUE                   42870000
428800              PERFORM DP013-0000-PROCESS-ABEND                    42880000
428900           END-IF                                                 42890000
429000        END-IF                                                    42900000
429100     END-IF.                                                      42910000
429200                                                                  42920000
429300/                                                                 42930000
429400*----------------------------------------------------------------*42940000
429500*    FORMAT AND LINK THE ADDITIONAL DB2 INFO PROGRAM FOR ADDING  *42950000
429600*    A NEW VENDOR'S ADDRESS TO RMS.                              *42960000
429700*----------------------------------------------------------------*42970000
429800 6200-ADD-NEW-ADDR-TO-RMS.                                        42980000
429900                                                                  42990000
430000     INITIALIZE VN013-VENDOR-INTERFACE-PARMS.                     43000000
430120                                                                  43012000
430200     PERFORM 8150-GET-VENDOR-NAME.                                43020000
430300                                                                  43030000
430400     MOVE DK-ENT-ID                 TO VN013-ENT-ID.              43040000
430500     MOVE PV-DUN-NBR                TO VN013-VND-NBR.             43050000
430600     MOVE EXTENT-PRIM-TYP-CDE       TO VN013-PRIM-TYP-CDE.        43060000
430700     MOVE 'N'                       TO VN013-VND-IN-RMS-IND.      43070000
430800     MOVE PV-STATUS-CDE             TO VN013-STATUS-CDE.          43080000
430900     MOVE EXTENT-EDI-PO-PREPK-CDE   TO VN013-PO-PREPK-CDE.        43090000
431000     MOVE PV-ENT-NAME-DESC          TO VN013-ENT-NAME-DESC.       43100000
431100     MOVE ASC-KEY-FUNCTION-ID       TO VN013-FUNCTION-ID.         43110000
431200     MOVE PV-NEXT-TBUSLOC-SEQ-NBR   TO VN013-ADDR-SEQ-NBR.        43120000
431300     MOVE ASC-PRIM-ADDR-IND         TO VN013-PRIM-ADDR-IND.       43130000
431400     MOVE ASC-COUNTRY-CDE           TO VN013-CNTRY-CD.            43140000
431500     MOVE PV-LOAD-ADDRESS1          TO VN013-ADDR-LINE1.          43150000
431600     MOVE PV-LOAD-ADDRESS2          TO VN013-ADDR-LINE2.          43160000
431700     MOVE PV-LOAD-ADDRESS3          TO VN013-ADDR-LINE3.          43170000
431800     MOVE ASC-CITY                  TO VN013-CITY.                43180000
431900     MOVE ASC-STATE-CDE             TO VN013-ST-PROV-CDE.         43190000
432000     MOVE ASC-ZIP                   TO VN013-ZIP-CDE.             43200000
432100     MOVE ASC-EMAIL-ADDR            TO VN013-EMAIL-ADD.           43210000
432200     STRING ASC-FIRST-NAME DELIMITED BY '  '                      43220000
432300            ' '            DELIMITED BY SIZE                      43230000
432400            ASC-LAST-NAME  DELIMITED BY '  '                      43240000
432500                                  INTO VN013-CONTACT-NAME.        43250000
432600     MOVE ASC-TEL1-NBR              TO VN013-TEL1-NBR.            43260000
432700     MOVE ASC-FAX-NBR               TO VN013-FAX-NBR.             43270000
432800     SET VN013-ACTION-ADD                                         43280000
432900         VN013-FUNCTION-ADDRESS     TO TRUE.                      43290000
433000                                                                  43300000
433100     EXEC CICS                                                    43310000
433200      LINK PROGRAM (PC-VNKCS023)                                  43320000
433300           COMMAREA(VN013-COMMAREA)                               43330000
433400           RESP    (PV-CICS-RESPONSE)                             43340000
433500     END-EXEC.                                                    43350000
433600                                                                  43360000
433700     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   43370000
433800         MOVE '6200-ADD-NEW-ADDR-TO-RMS'                          43380000
433900                         TO DP013-PARAGRAPH                       43390000
434000         MOVE 'UNSUCCESSFUL LINK TO VNKCS023'                     43400000
434100                         TO DP013-MESSAGE-TEXT(1)                 43410000
434200         SET DP013-CICS-ABEND                                     43420000
434300             DP013-ROLLBACK                                       43430000
434400             DP013-XCTL-DISPLAY-RESTART                           43440000
434500                         TO TRUE                                  43450000
434600         PERFORM DP013-0000-PROCESS-ABEND                         43460000
434700     ELSE                                                         43470000
434800        IF VN013-NO-ERRORS                                        43480000
434900           IF VN013-RMS-VENDOR-ADDED                              43490000
435000              PERFORM 6250-UPDATE-RMS-VENDOR-IND                  43500000
435100           END-IF                                                 43510000
435200           IF VN013-MAX-CPBLTY-EXCEEDED                           43520000
435300               MOVE PC-TSYMSG-03380  TO DP020-MSG-NUMBER          43530000
435400               SET DP020-MSG-WARNING TO TRUE                      43540000
435500           END-IF                                                 43550000
435600           IF VN013-MAX-RLTNSHP-EXCEEDED                          43560000
435700               MOVE PC-TSYMSG-03381  TO DP020-MSG-NUMBER          43570000
435800               SET DP020-MSG-WARNING TO TRUE                      43580000
435900           END-IF                                                 43590000
436000           IF VN013-MAX-ADDR-EXCEEDED                             43600000
436100              MOVE PC-TSYMSG-02645 TO DP020-MSG-NUMBER            43610000
436200              SET DP020-MSG-WARNING TO TRUE                       43620000
436300           END-IF                                                 43630000
436400        ELSE                                                      43640000
436500           IF VN013-MQ-ERROR OR VN013-DB-ERROR                    43650000
436600              MOVE VN013-PROGRAM-NAME   TO DP013-PROGRAM          43660000
436700              MOVE VN013-PARAGRAPH-NAME TO DP013-PARAGRAPH        43670000
436800              MOVE VN013-SQLCODE        TO DP013-MESSAGE-TEXT(1)  43680000
436900              MOVE VN013-MESSAGE        TO DP013-MESSAGE-TEXT(2)  43690000
437000              SET DP013-XCTL-DISPLAY-RESTART                      43700000
437100                  DP013-ROLLBACK                                  43710000
437200                  DP013-OTHER-ABEND     TO TRUE                   43720000
437300              PERFORM DP013-0000-PROCESS-ABEND                    43730000
437400           END-IF                                                 43740000
437500        END-IF                                                    43750000
437600     END-IF.                                                      43760000
437700                                                                  43770000
437800/                                                                 43780000
437900 6250-UPDATE-RMS-VENDOR-IND.                                      43790000
438000                                                                  43800000
438100     PERFORM                                                      43810000
438200         WITH TEST AFTER                                          43820000
438300         VARYING PV-RETRY-COUNTER                                 43830000
438400         FROM 1 BY 1                                              43840000
438500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43850000
438600             OR (SQLCODE = +0))                                   43860000
438700                                                                  43870000
438800         EXEC SQL                                                 43880000
438900              UPDATE TEXTENT                                      43890000
439000                SET VND_IN_RMS_IND = 'Y'                          43900000
439100               WHERE ENT_ID = :DK-ENT-ID                          43910000
439200         END-EXEC                                                 43920000
439300                                                                  43930000
439400         EVALUATE TRUE                                            43940000
439500             WHEN SQLCODE = +0                                    43950000
439600             WHEN SQLCODE = -904                                  43960000
439700             WHEN SQLCODE = -913                                  43970000
439800                  CONTINUE                                        43980000
439900             WHEN SQLWARN0 NOT = SPACES                           43990000
440000             WHEN SQLCODE < +0                                    44000000
440100             WHEN SQLCODE > +0                                    44010000
440200                  MOVE '6250-UPDATE-RMS-VENDOR-IND'               44020000
440300                                  TO DP013-PARAGRAPH              44030000
440400                  MOVE 'UNSUCCESSFUL UPDATE VND IN RMS'           44040000
440500                                  TO DP013-MESSAGE-TEXT (1)       44050000
440600                  MOVE SQLCA      TO DP013-SQLCA                  44060000
440700                  MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     44070000
440800                  SET DP013-DB2-ABEND                             44080000
440900                      DP013-XCTL-DISPLAY-RESTART                  44090000
441000                                  TO TRUE                         44100000
441100                  PERFORM DP013-0000-PROCESS-ABEND                44110000
441200         END-EVALUATE                                             44120000
441300     END-PERFORM.                                                 44130000
441400                                                                  44140000
441500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        44150000
441600         MOVE '6250-UPDATE-RMS-VENDOR-IND' TO DP013-PARAGRAPH     44160000
441700         MOVE 'MAX RETRIES EXCEEDED ON UPDATE VND IN RMS'         44170000
441800                                  TO DP013-MESSAGE-TEXT (1)       44180000
441900         MOVE SQLCA               TO DP013-SQLCA                  44190000
442000         MOVE 'TEXTENT '          TO DP013-DB2-TABLE-NAME (1)     44200000
442100         SET DP013-DB2-ABEND                                      44210000
442200             DP013-XCTL-DISPLAY-RESTART                           44220000
442300                                  TO TRUE                         44230000
442400         PERFORM DP013-0000-PROCESS-ABEND                         44240000
442500     END-IF.                                                      44250000
442600                                                                  44260000
442700/                                                                 44270000
442800 7000-UPDATE-ADDRESS.                                             44280000
442900                                                                  44290000
443000     IF (ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID OR            44300000
443100         ASC-KEY-FUNCTION-ID = PC-1099-FUNCTION-ID)               44310000
443200         SET VN-UPDATE-NOT-PERFORMED TO TRUE                      44320000
443300         INITIALIZE DCLTVNADAU                                    44330000
443400         PERFORM 6070-SELECT-TBUSLOC                              44340000
443500         PERFORM 6075-SELECT-TENTREP                              44350000
443600         PERFORM 6080-CHECK-FOR-UPDATE                            44360000
443700         IF VN-UPDATE-PERFORMED                                   44370000
443800           MOVE ASC-KEY-ENT-ID      TO VNADAU-ENT-ID              44380000
443900           MOVE ASC-TBUSLOC-SEQ-NBR TO VNADAU-SEQ-NBR             44390000
444000           MOVE 'U'                 TO VNADAU-AUD-FUNC-CDE        44400000
444100           PERFORM 6060-INSERT-ADDR-HISTORY-ROW.                  44410000
444200                                                                  44420000
444300     MOVE ASC-KEY-ENT-ID           TO DK-ENT-ID.                  44430000
444400     MOVE ASC-KEY-FUNCTION-ID      TO DK-FUNCTION-ID.             44440000
444500                                                                  44450000
444600     EVALUATE ASC-KEY-FUNCTION-ID                                 44460000
444700                                                                  44470000
444800         WHEN PC-REMIT-FUNCTION-ID                                44480000
444900             PERFORM 6001-VERIFY-ADDRESS-LENGTH                   44490000
445000             IF PS-ERROR                                          44500000
445100                 CONTINUE                                         44510000
445200             ELSE                                                 44520000
445300                 PERFORM 7010-UPDATE-TBUSLOC-REMIT                44530000
445400             END-IF                                               44540000
445500         WHEN PC-1099-FUNCTION-ID                                 44550000
445600             PERFORM 6001-VERIFY-ADDRESS-LENGTH                   44560000
445700             IF PS-ERROR                                          44570000
445800                 CONTINUE                                         44580000
445900             ELSE                                                 44590000
446000                 PERFORM 7015-UPDATE-TBUSLOC-1099                 44600000
446100             END-IF                                               44610000
446200         WHEN PC-PO-FUNCTION-ID                                   44620000
446300         WHEN PC-CORP-FUNCTION-ID                                 44630000
446400             PERFORM 7016-UPDATE-TBUSLOC-PO-CORP                  44640000
446500         WHEN PC-DSV-WAREHOUSE-LOC                                44650000
446600             INITIALIZE PV-NODE-LEN                               44660000
446700             INSPECT FUNCTION REVERSE (ASC-ADDR34-DESC)           44670000
446800               TALLYING PV-NODE-LEN FOR LEADING SPACES            44680000
446900             COMPUTE PV-NODE-LEN = LENGTH OF ASC-ADDR34-DESC      44690000
447000                                   - PV-NODE-LEN                  44700000
447100             IF ASC-COMMENT3-TXT NOT = 'A' AND                    44710000
447200                ASC-COMMENT3-TXT NOT = 'I'                        44720000
447300                 SET PS-ERROR         TO TRUE                     44730000
447400                 SET DP020-MSG-FATAL  TO TRUE                     44740000
447500                 MOVE PC-TSYMSG-03809 TO DP020-MSG-NUMBER         44750000
447600             ELSE                                                 44760000
447700               IF PV-NODE-LEN > 15                                44770000
447800                 SET PS-ERROR         TO TRUE                     44780000
447900                 SET DP020-MSG-FATAL  TO TRUE                     44790000
448000                 MOVE PC-TSYMSG-03810 TO DP020-MSG-NUMBER         44800000
448100             ELSE                                                 44810000
448200                 PERFORM 7005-UPDATE-TBUSLOC                      44820000
448300               END-IF                                             44830000
448400             END-IF                                               44840000
448500         WHEN OTHER                                               44850000
448600             PERFORM 7005-UPDATE-TBUSLOC                          44860000
448700                                                                  44870000
448800     END-EVALUATE.                                                44880000
448900                                                                  44890000
449000     IF PS-ERROR                                                  44900000
449100         CONTINUE                                                 44910000
449200     ELSE                                                         44920000
449300         PERFORM 7020-UPDATE-TENTREP                              44930000
449400                                                                  44940000
449500*** CALL INTERFACE ONLY WHEN REMITTANCE OR 1099 ADDRESS ADDED     44950000
449600         IF  ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID           44960000
449700                                OR PC-1099-FUNCTION-ID            44970000
449800             PERFORM 6003-GET-VENDOR-SHORTNAME                    44980000
449900             PERFORM 7030-SELECT-TEXTENT                          44990000
450000         ELSE                                                     45000000
450100*** CHECK IF MQ SERIES PROGRAM LINK IS NEEDED FOR UPDATE MESSAGE  45010000
450200*** FOR PO ADDRESS OR CORPORATE ADDRESS THAT WAS UPDATED ON DB2   45020000
450300*** AND VENDOR ALREADY EXISTS ON RMS                              45030000
450400             IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID           45040000
450500                                   OR PC-CORP-FUNCTION-ID         45050000
450600                 PERFORM 8100-CHECK-VENDOR-IN-RMS                 45060000
450700                 IF (EXTENT-VND-IN-RMS-IND = 'Y') AND             45070000
450800                    (EXTENT-PRIM-TYP-CDE = 'M')                   45080000
450900                    IF PRIM-ADDR-IND-DIFFERENT                    45090000
451000                       PERFORM 7200-SEND-UPDATE-RMS               45100000
451100                    END-IF                                        45110000
451200                    PERFORM 7100-SEND-UPDATE-MQ-MESSAGE           45120000
451300                    MOVE PC-TSYMSG-00059       TO DP020-MSG-NUMBER45130000
451400                    SET DP020-MSG-INFORMATIONAL TO TRUE           45140000
451500                 END-IF                                           45150000
451600             ELSE                                                 45160000
451700                 IF ASC-UPDATE-WITH-CHANGE                        45170000
451800                    CONTINUE                                      45180000
451900                 ELSE                                             45190000
452000                    MOVE PC-TSYMSG-00059       TO DP020-MSG-NUMBER45200000
452100                    SET DP020-MSG-INFORMATIONAL TO TRUE           45210000
452200                 END-IF                                           45220000
452300                 IF  ASC-USE-SELECTION-QUEUE                      45230000
452400                     PERFORM 5200-UPDATE-SELECTION-QUEUE          45240000
452500                 END-IF                                           45250000
452600             END-IF                                               45260000
452700         END-IF                                                   45270000
452800     END-IF.                                                      45280000
452900                                                                  45290000
453000******************************************************************45300000
453100* THIS PARAGRAPH IS EXECUTED WHEN AN UPDATE TO A NON-REMIT AND    45310000
453200* NON-1099 VENDOR IS DONE                                         45320000
453300******************************************************************45330000
453400 7005-UPDATE-TBUSLOC.                                             45340000
453500                                                                  45350000
453600     PERFORM                                                      45360000
453700         WITH TEST AFTER                                          45370000
453800         VARYING PV-RETRY-COUNTER                                 45380000
453900         FROM 1 BY 1                                              45390000
454000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45400000
454100             OR (SQLCODE = +0))                                   45410000
454200                                                                  45420000
454300         EXEC SQL                                                 45430000
454400             UPDATE TBUSLOC                                       45440000
454500               SET ADDRESS_LINE1_DESC = :ASC-ADDR1-EXNAME         45450000
454600                  ,ADDRESS_LINE2_DESC = :ASC-ADDR12-DESC          45460000
454700                  ,ADDRESS_LINE3_DESC = :ASC-ADDR23-DESC          45470000
454800                  ,ADDRESS_LINE4_DESC = :ASC-ADDR34-DESC          45480000
454900                  ,ATTENTION_TO_TXT   = :ASC-ATTENTION-TO-TXT     45490000
455000                  ,CITY_NAME          = :ASC-CITY                 45500000
455100                  ,STATE_CDE          = :ASC-OLD-STATE-CDE        45510000
455200                  ,ST_PROV_CDE        = :ASC-STATE-CDE            45520000
455300                  ,CNTRY_CDE          = :ASC-COUNTRY-CDE          45530000
455400                  ,ZIP_CDE            = :ASC-ZIP                  45540000
455500                  ,ROOM_NBR           = :ASC-ROOM-NBR             45550000
455600                  ,COMMENT1_TXT       = :ASC-COMMENT1-TXT         45560000
455700                  ,COMMENT2_TXT       = :ASC-COMMENT2-TXT         45570000
455800                  ,COMMENT3_TXT       = :ASC-COMMENT3-TXT         45580000
455900                  ,FUNCTION_ID        = :DK-FUNCTION-ID           45590000
456000                  ,LAST_UPDATE_TMST   =  CURRENT TIMESTAMP        45600000
456100                  ,LAST_UPDATE_ID     = :DP020-USERID             45610000
456200                  ,PRIM_ADDR_IND      = :ASC-PRIM-ADDR-IND        45620000
456300             WHERE ENT_ID  = :DK-ENT-ID                           45630000
456400               AND SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR                 45640000
456500         END-EXEC                                                 45650000
456600                                                                  45660000
456700         EVALUATE TRUE                                            45670000
456800             WHEN SQLCODE = +0                                    45680000
456900             WHEN SQLCODE = -904                                  45690000
457000             WHEN SQLCODE = -913                                  45700000
457100                 CONTINUE                                         45710000
457200             WHEN SQLWARN0 NOT = SPACES                           45720000
457300             WHEN SQLCODE < +0                                    45730000
457400             WHEN SQLCODE > +0                                    45740000
457500                 MOVE '7005-UPDATE-TBUSLOC'                       45750000
457600                                   TO DP013-PARAGRAPH             45760000
457700                 MOVE 'UPDATE A ROW ON TBUSLOC'                   45770000
457800                                   TO DP013-MESSAGE-TEXT(1)       45780000
457900                 MOVE SQLCA        TO DP013-SQLCA                 45790000
458000                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    45800000
458100                 SET DP013-DB2-ABEND                              45810000
458200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           45820000
458300                 PERFORM DP013-0000-PROCESS-ABEND                 45830000
458400         END-EVALUATE                                             45840000
458500     END-PERFORM.                                                 45850000
458600                                                                  45860000
458700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        45870000
458800         MOVE '7005-UPDATE-TBUSLOC'                               45880000
458900                                   TO DP013-PARAGRAPH             45890000
459000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              45900000
459100                                   TO DP013-MESSAGE-TEXT (1)      45910000
459200         MOVE 'TO UDPATE A TBUSLOC ROW'                           45920000
459300                                   TO DP013-MESSAGE-TEXT (2)      45930000
459400         MOVE SQLCA                TO DP013-SQLCA                 45940000
459500         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    45950000
459600         SET DP013-DB2-ABEND                                      45960000
459700             DP013-XCTL-DISPLAY-RESTART                           45970000
459800                                   TO TRUE                        45980000
459900         PERFORM DP013-0000-PROCESS-ABEND                         45990000
460000     END-IF.                                                      46000000
460100                                                                  46010000
460200******************************************************************46020000
460300* THIS PARAGRAPH IS EXECUTED WHEN AN UPDATE TO A REMIT VENDOR     46030000
460400* IS DONE                                                         46040000
460500******************************************************************46050000
460600 7010-UPDATE-TBUSLOC-REMIT.                                       46060000
460700                                                                  46070000
460800     PERFORM                                                      46080000
460900         WITH TEST AFTER                                          46090000
461000         VARYING PV-RETRY-COUNTER                                 46100000
461100         FROM 1 BY 1                                              46110000
461200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46120000
461300             OR (SQLCODE = +0))                                   46130000
461400                                                                  46140000
461500         EXEC SQL                                                 46150000
461600             UPDATE TBUSLOC                                       46160000
461700               SET ADDRESS_LINE1_DESC = :ASC-ADDR12-DESC          46170000
461800                  ,ADDRESS_LINE2_DESC = :ASC-ADDR23-DESC          46180000
461900                  ,ADDRESS_LINE3_DESC = :ASC-ADDR34-DESC          46190000
462000                  ,ATTENTION_TO_TXT   = :ASC-ATTENTION-TO-TXT     46200000
462100                  ,CITY_NAME          = :ASC-CITY                 46210000
462200                  ,STATE_CDE          = :ASC-OLD-STATE-CDE        46220000
462300                  ,ST_PROV_CDE        = :ASC-STATE-CDE            46230000
462400                  ,CNTRY_CDE          = :ASC-COUNTRY-CDE          46240000
462500                  ,ZIP_CDE            = :ASC-ZIP                  46250000
462600                  ,ROOM_NBR           = :ASC-ROOM-NBR             46260000
462700                  ,COMMENT1_TXT       = :ASC-COMMENT1-TXT         46270000
462800                  ,COMMENT2_TXT       = :ASC-COMMENT2-TXT         46280000
462900                  ,COMMENT3_TXT       = :ASC-COMMENT3-TXT         46290000
463000                  ,EXTD_VND_NM        = :ASC-ADDR1-EXNAME         46300000
463100                  ,FUNCTION_ID        = :DK-FUNCTION-ID           46310000
463200                  ,LAST_UPDATE_TMST   =  CURRENT TIMESTAMP        46320000
463300                  ,LAST_UPDATE_ID     = :DP020-USERID             46330000
463400                  ,PRIM_ADDR_IND      = :ASC-PRIM-ADDR-IND        46340000
463500             WHERE ENT_ID  = :DK-ENT-ID                           46350000
463600               AND SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR                 46360000
463700         END-EXEC                                                 46370000
463800                                                                  46380000
463900         EVALUATE TRUE                                            46390000
464000             WHEN SQLCODE = +0                                    46400000
464100             WHEN SQLCODE = -904                                  46410000
464200             WHEN SQLCODE = -913                                  46420000
464300                 CONTINUE                                         46430000
464400             WHEN SQLWARN0 NOT = SPACES                           46440000
464500             WHEN SQLCODE < +0                                    46450000
464600             WHEN SQLCODE > +0                                    46460000
464700                 MOVE '7010-UPDATE-TBUSLOC-REMIT'                 46470000
464800                                   TO DP013-PARAGRAPH             46480000
464900                 MOVE 'UPDATE A ROW ON TBUSLOC'                   46490000
465000                                   TO DP013-MESSAGE-TEXT(1)       46500000
465100                 MOVE SQLCA        TO DP013-SQLCA                 46510000
465200                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    46520000
465300                 SET DP013-DB2-ABEND                              46530000
465400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           46540000
465500                 PERFORM DP013-0000-PROCESS-ABEND                 46550000
465600         END-EVALUATE                                             46560000
465700     END-PERFORM.                                                 46570000
465800                                                                  46580000
465900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46590000
466000         MOVE '7010-UPDATE-TBUSLOC-REMIT'                         46600000
466100                                   TO DP013-PARAGRAPH             46610000
466200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              46620000
466300                                   TO DP013-MESSAGE-TEXT (1)      46630000
466400         MOVE 'TO UDPATE A TBUSLOC ROW'                           46640000
466500                                   TO DP013-MESSAGE-TEXT (2)      46650000
466600         MOVE SQLCA                TO DP013-SQLCA                 46660000
466700         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    46670000
466800         SET DP013-DB2-ABEND                                      46680000
466900             DP013-XCTL-DISPLAY-RESTART                           46690000
467000                                   TO TRUE                        46700000
467100         PERFORM DP013-0000-PROCESS-ABEND                         46710000
467200     END-IF.                                                      46720000
467300                                                                  46730000
467400******************************************************************46740000
467500* THIS PARAGRAPH IS EXECUTED WHEN AN UPDATE TO A 1099 VENDOR      46750000
467600* IS DONE                                                         46760000
467700******************************************************************46770000
467800 7015-UPDATE-TBUSLOC-1099.                                        46780000
467900                                                                  46790000
468000     PERFORM                                                      46800000
468100         WITH TEST AFTER                                          46810000
468200         VARYING PV-RETRY-COUNTER                                 46820000
468300         FROM 1 BY 1                                              46830000
468400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46840000
468500             OR (SQLCODE = +0))                                   46850000
468600                                                                  46860000
468700         EXEC SQL                                                 46870000
468800             UPDATE TBUSLOC                                       46880000
468900               SET ADDRESS_LINE1_DESC = :ASC-ADDR12-DESC          46890000
469000                  ,ADDRESS_LINE2_DESC = :ASC-ADDR23-DESC          46900000
469100                  ,ADDRESS_LINE3_DESC = :ASC-ADDR34-DESC          46910000
469200                  ,ATTENTION_TO_TXT   = :ASC-ATTENTION-TO-TXT     46920000
469300                  ,CITY_NAME          = :ASC-CITY                 46930000
469400                  ,STATE_CDE          = :ASC-OLD-STATE-CDE        46940000
469500                  ,ST_PROV_CDE        = :ASC-STATE-CDE            46950000
469600                  ,CNTRY_CDE          = :ASC-COUNTRY-CDE          46960000
469700                  ,ZIP_CDE            = :ASC-ZIP                  46970000
469800                  ,ROOM_NBR           = :ASC-ROOM-NBR             46980000
469900                  ,COMMENT1_TXT       = :ASC-COMMENT1-TXT         46990000
470000                  ,COMMENT2_TXT       = :ASC-COMMENT2-TXT         47000000
470100                  ,COMMENT3_TXT       = :ASC-COMMENT3-TXT         47010000
470200                  ,ALT_1099_VND_NM    = :ASC-ADDR1-EXNAME         47020000
470300                  ,FUNCTION_ID        = :DK-FUNCTION-ID           47030000
470400                  ,LAST_UPDATE_TMST   =  CURRENT TIMESTAMP        47040000
470500                  ,LAST_UPDATE_ID     = :DP020-USERID             47050000
470600                  ,PRIM_ADDR_IND      = :ASC-PRIM-ADDR-IND        47060000
470700             WHERE ENT_ID  = :DK-ENT-ID                           47070000
470800               AND SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR                 47080000
470900         END-EXEC                                                 47090000
471000                                                                  47100000
471100         EVALUATE TRUE                                            47110000
471200             WHEN SQLCODE = +0                                    47120000
471300             WHEN SQLCODE = -904                                  47130000
471400             WHEN SQLCODE = -913                                  47140000
471500                 CONTINUE                                         47150000
471600             WHEN SQLWARN0 NOT = SPACES                           47160000
471700             WHEN SQLCODE < +0                                    47170000
471800             WHEN SQLCODE > +0                                    47180000
471900                 MOVE '7015-UPDATE-TBUSLOC-1099'                  47190000
472000                                   TO DP013-PARAGRAPH             47200000
472100                 MOVE 'UPDATE A ROW ON TBUSLOC'                   47210000
472200                                   TO DP013-MESSAGE-TEXT(1)       47220000
472300                 MOVE SQLCA        TO DP013-SQLCA                 47230000
472400                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    47240000
472500                 SET DP013-DB2-ABEND                              47250000
472600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47260000
472700                 PERFORM DP013-0000-PROCESS-ABEND                 47270000
472800         END-EVALUATE                                             47280000
472900     END-PERFORM.                                                 47290000
473000                                                                  47300000
473100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47310000
473200         MOVE '7015-UPDATE-TBUSLOC-1099'                          47320000
473300                                   TO DP013-PARAGRAPH             47330000
473400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              47340000
473500                                   TO DP013-MESSAGE-TEXT (1)      47350000
473600         MOVE 'TO UDPATE A TBUSLOC ROW'                           47360000
473700                                   TO DP013-MESSAGE-TEXT (2)      47370000
473800         MOVE SQLCA                TO DP013-SQLCA                 47380000
473900         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    47390000
474000         SET DP013-DB2-ABEND                                      47400000
474100             DP013-XCTL-DISPLAY-RESTART                           47410000
474200                                   TO TRUE                        47420000
474300         PERFORM DP013-0000-PROCESS-ABEND                         47430000
474400     END-IF.                                                      47440000
474500                                                                  47450000
474600******************************************************************47460000
474700* THIS PARAGRAPH IS EXECUTED WHEN AN UPDATE TO A PO OR CORP       47470000
474800* ADDRESS IS DONE                                                 47480000
474900******************************************************************47490000
475000 7016-UPDATE-TBUSLOC-PO-CORP.                                     47500000
475100                                                                  47510000
475200     PERFORM                                                      47520000
475300         WITH TEST AFTER                                          47530000
475400         VARYING PV-RETRY-COUNTER                                 47540000
475500         FROM 1 BY 1                                              47550000
475600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47560000
475700             OR (SQLCODE = +0))                                   47570000
475800                                                                  47580000
475900         EXEC SQL                                                 47590000
476000             UPDATE TBUSLOC                                       47600000
476100               SET ADDRESS_LINE1_DESC = :ASC-ADDR1-EXNAME         47610000
476200                  ,ADDRESS_LINE2_DESC = :ASC-ADDR12-DESC          47620000
476300                  ,ADDRESS_LINE3_DESC = :ASC-ADDR23-DESC          47630000
476400                  ,ATTENTION_TO_TXT   = :ASC-ATTENTION-TO-TXT     47640000
476500                  ,CITY_NAME          = :ASC-CITY                 47650000
476600                  ,STATE_CDE          = :ASC-OLD-STATE-CDE        47660000
476700                  ,ST_PROV_CDE        = :ASC-STATE-CDE            47670000
476800                  ,CNTRY_CDE          = :ASC-COUNTRY-CDE          47680000
476900                  ,ZIP_CDE            = :ASC-ZIP                  47690000
477000                  ,ROOM_NBR           = :ASC-ROOM-NBR             47700000
477100                  ,COMMENT1_TXT       = :ASC-COMMENT1-TXT         47710000
477200                  ,COMMENT2_TXT       = :ASC-COMMENT2-TXT         47720000
477300                  ,COMMENT3_TXT       = :ASC-COMMENT3-TXT         47730000
477400                  ,FUNCTION_ID        = :DK-FUNCTION-ID           47740000
477500                  ,LAST_UPDATE_TMST   =  CURRENT TIMESTAMP        47750000
477600                  ,LAST_UPDATE_ID     = :DP020-USERID             47760000
477700                  ,PRIM_ADDR_IND      = :ASC-PRIM-ADDR-IND        47770000
477800             WHERE ENT_ID  = :DK-ENT-ID                           47780000
477900               AND SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR                 47790000
478000         END-EXEC                                                 47800000
478100                                                                  47810000
478200         EVALUATE TRUE                                            47820000
478300             WHEN SQLCODE = +0                                    47830000
478400             WHEN SQLCODE = -904                                  47840000
478500             WHEN SQLCODE = -913                                  47850000
478600                 CONTINUE                                         47860000
478700             WHEN SQLWARN0 NOT = SPACES                           47870000
478800             WHEN SQLCODE < +0                                    47880000
478900             WHEN SQLCODE > +0                                    47890000
479000                 MOVE '7016-UPDATE-TBUSLOC-PO-CORP'               47900000
479100                                   TO DP013-PARAGRAPH             47910000
479200                 MOVE 'UPDATE A ROW ON TBUSLOC'                   47920000
479300                                   TO DP013-MESSAGE-TEXT(1)       47930000
479400                 MOVE SQLCA        TO DP013-SQLCA                 47940000
479500                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    47950000
479600                 SET DP013-DB2-ABEND                              47960000
479700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47970000
479800                 PERFORM DP013-0000-PROCESS-ABEND                 47980000
479900         END-EVALUATE                                             47990000
480000     END-PERFORM.                                                 48000000
480100                                                                  48010000
480200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48020000
480300         MOVE '7016-UPDATE-TBUSLOC-PO-CORP'                       48030000
480400                                   TO DP013-PARAGRAPH             48040000
480500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              48050000
480600                                   TO DP013-MESSAGE-TEXT (1)      48060000
480700         MOVE 'TO UDPATE A TBUSLOC ROW'                           48070000
480800                                   TO DP013-MESSAGE-TEXT (2)      48080000
480900         MOVE SQLCA                TO DP013-SQLCA                 48090000
481000         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    48100000
481100         SET DP013-DB2-ABEND                                      48110000
481200             DP013-XCTL-DISPLAY-RESTART                           48120000
481300                                   TO TRUE                        48130000
481400         PERFORM DP013-0000-PROCESS-ABEND                         48140000
481500     END-IF.                                                      48150000
481600                                                                  48160000
481700/                                                                 48170000
481800 7020-UPDATE-TENTREP.                                             48180000
481900                                                                  48190000
482000     PERFORM                                                      48200000
482100         WITH TEST AFTER                                          48210000
482200         VARYING PV-RETRY-COUNTER                                 48220000
482300         FROM 1 BY 1                                              48230000
482400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48240000
482500             OR (SQLCODE = +0))                                   48250000
482600                                                                  48260000
482700         EXEC SQL                                                 48270000
482800             UPDATE TENTREP                                       48280000
482900               SET FIRST_NAME       = :ASC-FIRST-NAME             48290000
483000                  ,LAST_NAME        = :ASC-LAST-NAME              48300000
483100                  ,TITLE_NAME       = :ASC-TITLE                  48310000
483200                  ,TEL1_NBR         = :ASC-TEL1-NBR               48320000
483300                  ,TEL1_EXT_NBR     = :ASC-TEL1-EXT-NBR           48330000
483400                  ,TEL_1_CNTRY_CDE  = :ASC-TEL1-CNTY-PH-CD        48340000
483500                  ,TEL2_NBR         = :ASC-TEL2-NBR               48350000
483600                  ,TEL2_EXT_NBR     = :ASC-TEL2-EXT-NBR           48360000
483700                  ,TEL_2_CNTRY_CDE  = :ASC-TEL2-CNTY-PH-CD        48370000
483800                  ,FAX_NBR          = :ASC-FAX-NBR                48380000
483900                  ,EMAIL_ADDR_ID    = :ASC-EMAIL-ADDR             48390000
484000                  ,FUNCTION_ID      = :DK-FUNCTION-ID             48400000
484100                  ,LAST_UPDATE_TMST =  CURRENT TIMESTAMP          48410000
484200                  ,LAST_UPDATE_ID   = :DP020-USERID               48420000
484300             WHERE ENT_ID  = :DK-ENT-ID                           48430000
484400               AND SEQ_NBR = :ASC-TENTREP-SEQ-NBR                 48440000
484500         END-EXEC                                                 48450000
484600                                                                  48460000
484700         EVALUATE TRUE                                            48470000
484800             WHEN SQLCODE = +0                                    48480000
484900             WHEN SQLCODE = -904                                  48490000
485000             WHEN SQLCODE = -913                                  48500000
485100                 CONTINUE                                         48510000
485200             WHEN SQLWARN0 NOT = SPACES                           48520000
485300             WHEN SQLCODE < +0                                    48530000
485400             WHEN SQLCODE > +0                                    48540000
485500                 MOVE '7020-UPDATE-TENTREP'                       48550000
485600                                   TO DP013-PARAGRAPH             48560000
485700                 MOVE 'UPDATE A ROW ON TENTREP'                   48570000
485800                                   TO DP013-MESSAGE-TEXT(1)       48580000
485900                 MOVE SQLCA        TO DP013-SQLCA                 48590000
486000                 MOVE 'TENTREP'    TO DP013-DB2-TABLE-NAME (1)    48600000
486100                 SET DP013-DB2-ABEND                              48610000
486200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48620000
486300                 PERFORM DP013-0000-PROCESS-ABEND                 48630000
486400         END-EVALUATE                                             48640000
486500     END-PERFORM.                                                 48650000
486600                                                                  48660000
486700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48670000
486800         MOVE '7020-UPDATE-TENTREP'                               48680000
486900                                   TO DP013-PARAGRAPH             48690000
487000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              48700000
487100                                   TO DP013-MESSAGE-TEXT (1)      48710000
487200         MOVE 'TO UPDATE A TENTREP ROW'                           48720000
487300                                   TO DP013-MESSAGE-TEXT (2)      48730000
487400         MOVE SQLCA                TO DP013-SQLCA                 48740000
487500         MOVE 'TENTREP'            TO DP013-DB2-TABLE-NAME (1)    48750000
487600         SET DP013-DB2-ABEND                                      48760000
487700             DP013-XCTL-DISPLAY-RESTART                           48770000
487800                                   TO TRUE                        48780000
487900         PERFORM DP013-0000-PROCESS-ABEND                         48790000
488000     END-IF.                                                      48800000
488100                                                                  48810000
488200 7030-SELECT-TEXTENT.                                             48820000
488300                                                                  48830000
488400     PERFORM                                                      48840000
488500         WITH TEST AFTER                                          48850000
488600         VARYING PV-RETRY-COUNTER                                 48860000
488700         FROM 1 BY 1                                              48870000
488800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48880000
488900            OR (SQLCODE = +0))                                    48890000
489000                                                                  48900000
489100         EXEC SQL                                                 48910000
489200             SELECT DUN_NBR                                       48920000
489300                  , PRNT_CO_ENT_ID                                48930000
489400                  , PRNT_CO_IND                                   48940000
489500                  , FED_TX_ID_NBR                                 48950000
489600                  , FED_TX_ID_TYP_CDE                             48960000
489700                  , EDI_PO_PREPK_CDE                              48970000
489800                  , PRIM_TYP_CDE                                  48980000
489900                  , PRTNR_TYP_CDE                                 48990000
490000                  , STATUS_CDE                                    49000000
490100                  , VND_CLSN_CDE                                  49010000
490200                  , VND_PRSST_CDE                                 49020000
490300                  , CRE_BY_UID                                    49030000
490400                  , NEED_1099_IND                                 49040000
490500                  , HLD_PAYT_IND                                  49050000
490600                  , PAY_FCTR_VND_IND                              49060000
490700                  , SEPR_INVC_PAYT_IND                            49070000
490800                  , WHLDG_PAYT_TYP_CDE                            49080000
490900                  , PAYT_HNDLG_CDE                                49090000
491000                  , CAP_EXP_CDE                                   49100000
491100              INTO  :EXTENT-DUN-NBR                               49110000
491200                  , :EXTENT-PRNT-CO-ENT-ID                        49120000
491300                  , :EXTENT-PRNT-CO-IND                           49130000
491400                  , :EXTENT-FED-TX-ID-NBR                         49140000
491500                  , :EXTENT-FED-TX-ID-TYP-CDE                     49150000
491600                  , :EXTENT-EDI-PO-PREPK-CDE                      49160000
491700                  , :EXTENT-PRIM-TYP-CDE                          49170000
491800                  , :EXTENT-PRTNR-TYP-CDE                         49180000
491900                  , :EXTENT-STATUS-CDE                            49190000
492000                  , :EXTENT-VND-CLSN-CDE                          49200000
492100                  , :EXTENT-VND-PRSST-CDE                         49210000
492200                  , :EXTENT-CRE-BY-UID                            49220000
492300                  , :EXTENT-NEED-1099-IND                         49230000
492400                  , :EXTENT-HLD-PAYT-IND                          49240000
492500                  , :EXTENT-PAY-FCTR-VND-IND                      49250000
492600                  , :EXTENT-SEPR-INVC-PAYT-IND                    49260000
492700                  , :EXTENT-WHLDG-PAYT-TYP-CDE                    49270000
492800                  , :EXTENT-PAYT-HNDLG-CDE                        49280000
492900                  , :EXTENT-CAP-EXP-CDE                           49290000
493000                                                                  49300000
493100              FROM  TEXTENT                                       49310000
493200              WHERE ENT_ID   = :DK-ENT-ID                         49320000
493300         END-EXEC                                                 49330000
493400                                                                  49340000
493500         EVALUATE TRUE                                            49350000
493600             WHEN SQLCODE = +0                                    49360000
493700             WHEN SQLCODE = -904                                  49370000
493800             WHEN SQLCODE = -913                                  49380000
493900                 CONTINUE                                         49390000
494000             WHEN SQLWARN0 NOT = SPACE                            49400000
494100             WHEN SQLCODE < +0                                    49410000
494200             WHEN SQLCODE > +0                                    49420000
494300                 MOVE '7030-SELECT-TEXTENT'                       49430000
494400                                 TO DP013-PARAGRAPH               49440000
494500                 MOVE 'SELECT ON ENTERPRISE NAME TABLE'           49450000
494600                                 TO DP013-MESSAGE-TEXT (1)        49460000
494700                 MOVE SQLCA      TO DP013-SQLCA                   49470000
494800                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      49480000
494900                     SET DP013-DB2-ABEND                          49490000
495000                         DP013-XCTL-DISPLAY-RESTART               49500000
495100                                 TO TRUE                          49510000
495200                 PERFORM DP013-0000-PROCESS-ABEND                 49520000
495300         END-EVALUATE                                             49530000
495400     END-PERFORM.                                                 49540000
495500                                                                  49550000
495600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49560000
495700         MOVE '7030-SELECT-TEXTENT' TO DP013-PARAGRAPH            49570000
495800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TEXTENT'        49580000
495900                                   TO DP013-MESSAGE-TEXT (1)      49590000
496000         MOVE SQLCA                TO DP013-SQLCA                 49600000
496100         SET DP013-DB2-ABEND       TO TRUE                        49610000
496200         PERFORM DP013-0000-PROCESS-ABEND                         49620000
496300     END-IF.                                                      49630000
496400                                                                  49640000
496500***************************************************************** 49650000
496600 7050-SELECT-PARENT-DUNNS.                                        49660000
496700     PERFORM                                                      49670000
496800         WITH TEST AFTER                                          49680000
496900         VARYING PV-RETRY-COUNTER                                 49690000
497000         FROM 1 BY 1                                              49700000
497100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49710000
497200                   OR (SQLCODE = ZERO)                            49720000
497300                   OR (SQLCODE = +100))                           49730000
497400                                                                  49740000
497500         EXEC SQL                                                 49750000
497600             SELECT                                               49760000
497700                 DUN_NBR                                          49770000
497800             INTO                                                 49780000
497900                 :EXTENT-DUN-NBR                                  49790000
498000             FROM TEXTENT                                         49800000
498100             WHERE                                                49810000
498200                ENT_ID = :WS-PRNT-CO-ENT-ID                       49820000
498300         END-EXEC                                                 49830000
498400                                                                  49840000
498500         EVALUATE TRUE                                            49850000
498600             WHEN SQLCODE = ZERO                                  49860000
498700             WHEN SQLCODE = +100                                  49870000
498800             WHEN SQLCODE = -904                                  49880000
498900             WHEN SQLCODE = -913                                  49890000
499000                 CONTINUE                                         49900000
499100             WHEN SQLWARN0 NOT = SPACES                           49910000
499200             WHEN SQLCODE < ZERO                                  49920000
499300             WHEN SQLCODE > ZERO                                  49930000
499400                 MOVE '7050-SELECT-PARENT-DUNNS'                  49940000
499500                                   TO DP013-PARAGRAPH             49950000
499600                 MOVE 'SELECT TEXTENT FOR PARENT ENT ID'          49960000
499700                                   TO DP013-MESSAGE-TEXT (1)      49970000
499800                 MOVE EXTENT-PRNT-CO-ENT-ID                       49980000
499900                                   TO DP013-MESSAGE-TEXT (2)      49990000
500000                 MOVE SQLCA        TO DP013-SQLCA                 50000000
500100                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    50010000
500200                 SET DP013-DB2-ABEND                              50020000
500300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           50030000
500400                 PERFORM DP013-0000-PROCESS-ABEND                 50040000
500500         END-EVALUATE                                             50050000
500600     END-PERFORM.                                                 50060000
500700                                                                  50070000
500800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50080000
500900         MOVE '7050-SELECT-PARENT-DUNNS'                          50090000
501000                                   TO DP013-PARAGRAPH             50100000
501100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     50110000
501200                                   TO DP013-MESSAGE-TEXT (1)      50120000
501300         MOVE 'ENTERPRISE FOR DUN NBR: '                          50130000
501400                                   TO DP013-MESSAGE-TEXT (2)      50140000
501500         MOVE ASC-DUN-NBR          TO DP013-MESSAGE-TEXT (3)      50150000
501600         MOVE SQLCA                TO DP013-SQLCA                 50160000
501700         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    50170000
501800         SET DP013-DB2-ABEND                                      50180000
501900             DP013-XCTL-DISPLAY-RESTART                           50190000
502000                                   TO TRUE                        50200000
502100         PERFORM DP013-0000-PROCESS-ABEND                         50210000
502200     END-IF.                                                      50220000
502300                                                                  50230000
502400/                                                                 50240000
502500*----------------------------------------------------------------*50250000
502600*    FORMAT AND LINK THE MQ SERIES PROGRAM FOR UPDATING ADDRESS  *50260000
502700*    RMS.                                                        *50270000
502800*----------------------------------------------------------------*50280000
502900 7100-SEND-UPDATE-MQ-MESSAGE.                                     50290000
503000                                                                  50300000
503100     INITIALIZE VN007-INTERFACE-MESSAGE-PARMS.                    50310000
503200                                                                  50320000
503300     PERFORM 8150-GET-VENDOR-NAME.                                50330000
503400                                                                  50340000
503500     MOVE PV-DUN-NBR                TO VN007-VND-NBR.             50350000
503600     MOVE DK-ENT-ID                 TO VN007-ENT-ID.              50360000
503700     MOVE ASC-KEY-FUNCTION-ID       TO VN007-FUNCTION-ID(1).      50370000
503800     MOVE ASC-TBUSLOC-SEQ-NBR       TO VN007-ADDR-SEQ-NBR(1).     50380000
503900     MOVE ASC-PRIM-ADDR-IND         TO VN007-PRIM-ADDR-IND(1).    50390000
504000     MOVE ASC-COUNTRY-CDE           TO VN007-CNTRY-CD(1).         50400000
504100     MOVE ASC-ADDR1-EXNAME          TO VN007-ADDR-LINE1(1).       50410000
504200     MOVE ASC-ADDR12-DESC           TO VN007-ADDR-LINE2(1).       50420000
504300     MOVE ASC-ADDR23-DESC           TO VN007-ADDR-LINE3(1).       50430000
504400     MOVE ASC-CITY                  TO VN007-CITY(1).             50440000
504500     MOVE ASC-STATE-CDE             TO VN007-ST-PROV-CDE(1).      50450000
504600     MOVE ASC-ZIP                   TO VN007-ZIP-CDE(1).          50460000
504700     MOVE ASC-EMAIL-ADDR            TO VN007-EMAIL-ADD(1).        50470000
504800     STRING ASC-FIRST-NAME DELIMITED BY '  '                      50480000
504900            ' '            DELIMITED BY SIZE                      50490000
505000            ASC-LAST-NAME  DELIMITED BY '  '                      50500000
505100                                  INTO VN007-CONTACT-NAME(1).     50510000
505200     MOVE ASC-TEL1-NBR              TO VN007-TEL1-NBR(1).         50520000
505300     MOVE ASC-FAX-NBR               TO VN007-FAX-NBR(1).          50530000
505400     MOVE 'N'                       TO VN007-ADDR-DELETE-IND(1).  50540000
505500                                                                  50550000
505600     EXEC CICS                                                    50560000
505700      LINK PROGRAM (PC-VNKCS024)                                  50570000
505800           COMMAREA(VN007-COMMAREA)                               50580000
505900           RESP    (PV-CICS-RESPONSE)                             50590000
506000     END-EXEC.                                                    50600000
506100                                                                  50610000
506200     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   50620000
506300         MOVE '7100-SEND-UPDATE-MQ-MESSAGE'                       50630000
506400                         TO DP013-PARAGRAPH                       50640000
506500         MOVE 'UNSUCCESSFUL LINK TO VNKCS024'                     50650000
506600                         TO DP013-MESSAGE-TEXT(1)                 50660000
506700         SET DP013-CICS-ABEND                                     50670000
506800             DP013-ROLLBACK                                       50680000
506900             DP013-XCTL-DISPLAY-RESTART                           50690000
507000                         TO TRUE                                  50700000
507100         PERFORM DP013-0000-PROCESS-ABEND                         50710000
507200     ELSE                                                         50720000
507300        IF VN007-NO-ERRORS                                        50730000
507400           NEXT SENTENCE                                          50740000
507500        ELSE                                                      50750000
507600           IF VN007-MQ-ERROR                                      50760000
507700              MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM          50770000
507800              MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH        50780000
507900              MOVE VN007-REASON-CODE    TO DP013-MESSAGE-TEXT(1)  50790000
508000              MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT(2)  50800000
508100              SET DP013-XCTL-DISPLAY-RESTART                      50810000
508200                  DP013-ROLLBACK                                  50820000
508300                  DP013-OTHER-ABEND     TO TRUE                   50830000
508400              PERFORM DP013-0000-PROCESS-ABEND                    50840000
508500           END-IF                                                 50850000
508600        END-IF                                                    50860000
508700     END-IF.                                                      50870000
508800                                                                  50880000
508900 7200-SEND-UPDATE-RMS.                                            50890000
509000                                                                  50900000
509100     INITIALIZE VN007-INTERFACE-MESSAGE-PARMS.                    50910000
509200                                                                  50920000
509300     PERFORM 8150-GET-VENDOR-NAME.                                50930000
509400                                                                  50940000
509500     MOVE PV-DUN-NBR                TO VN007-VND-NBR.             50950000
509600     MOVE DK-ENT-ID                 TO VN007-ENT-ID.              50960000
509700     MOVE ASC-KEY-FUNCTION-ID       TO VN007-FUNCTION-ID(1).      50970000
509800     MOVE PV-BUSLOC-SEQ-NBR         TO VN007-ADDR-SEQ-NBR(1).     50980000
509900     MOVE 'N'                       TO VN007-PRIM-ADDR-IND(1).    50990000
510000     MOVE PV-COUNTRY-CDE            TO VN007-CNTRY-CD(1).         51000000
510100     MOVE PV-RMS-ADDRESS1           TO VN007-ADDR-LINE1(1).       51010000
510200     MOVE PV-RMS-ADDRESS2           TO VN007-ADDR-LINE2(1).       51020000
510300     MOVE PV-RMS-ADDRESS3           TO VN007-ADDR-LINE3(1).       51030000
510400     MOVE PV-CITY-NAME              TO VN007-CITY(1).             51040000
510500     MOVE PV-STATE-CDE              TO VN007-ST-PROV-CDE(1).      51050000
510600     MOVE PV-ZIP-CDE                TO VN007-ZIP-CDE(1).          51060000
510700     MOVE PV-EMAIL-ADDR             TO VN007-EMAIL-ADD(1).        51070000
510800     STRING PV-FIRST-NAME DELIMITED BY '  '                       51080000
510900            ' '            DELIMITED BY SIZE                      51090000
511000            PV-LAST-NAME  DELIMITED BY '  '                       51100000
511100                                  INTO VN007-CONTACT-NAME(1).     51110000
511200     MOVE PV-PHONE-NBR              TO VN007-TEL1-NBR(1).         51120000
511300     MOVE PV-FAX-NBR                TO VN007-FAX-NBR(1).          51130000
511400     MOVE 'N'                       TO VN007-ADDR-DELETE-IND(1).  51140000
511500                                                                  51150000
511600     EXEC CICS                                                    51160000
511700      LINK PROGRAM (PC-VNKCS024)                                  51170000
511800           COMMAREA(VN007-COMMAREA)                               51180000
511900           RESP    (PV-CICS-RESPONSE)                             51190000
512000     END-EXEC.                                                    51200000
512100                                                                  51210000
512200     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   51220000
512300         MOVE '7200-SEND-UPDATE-RMS'                              51230000
512400                         TO DP013-PARAGRAPH                       51240000
512500         MOVE 'UNSUCCESSFUL LINK TO VNKCS024'                     51250000
512600                         TO DP013-MESSAGE-TEXT(1)                 51260000
512700         SET DP013-CICS-ABEND                                     51270000
512800             DP013-ROLLBACK                                       51280000
512900             DP013-XCTL-DISPLAY-RESTART                           51290000
513000                         TO TRUE                                  51300000
513100         PERFORM DP013-0000-PROCESS-ABEND                         51310000
513200     ELSE                                                         51320000
513300        IF VN007-NO-ERRORS                                        51330000
513400           NEXT SENTENCE                                          51340000
513500        ELSE                                                      51350000
513600           IF VN007-MQ-ERROR                                      51360000
513700              MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM          51370000
513800              MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH        51380000
513900              MOVE VN007-REASON-CODE    TO DP013-MESSAGE-TEXT(1)  51390000
514000              MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT(2)  51400000
514100              SET DP013-XCTL-DISPLAY-RESTART                      51410000
514200                  DP013-ROLLBACK                                  51420000
514300                  DP013-OTHER-ABEND     TO TRUE                   51430000
514400              PERFORM DP013-0000-PROCESS-ABEND                    51440000
514500           END-IF                                                 51450000
514600        END-IF                                                    51460000
514700     END-IF.                                                      51470000
514800                                                                  51480000
514900/                                                                 51490000
515000 8000-DELETE-ADDRESS.                                             51500000
515100                                                                  51510000
515200     MOVE ASC-KEY-ENT-ID           TO DK-ENT-ID.                  51520000
515300     MOVE ASC-KEY-FUNCTION-ID      TO DK-FUNCTION-ID.             51530000
515400                                                                  51540000
515500     PERFORM 8010-DELETE-TBUSLOC.                                 51550000
515600                                                                  51560000
515700*** CHECK IF MQ SERIES PROGRAM LINK IS NEEDED FOR DELETE MESSAGE  51570000
515800*** ONLY WHEN PO ADDRESS OR CORPORATE ADDRESS IS DELETED AND      51580000
515900*** VENDOR ALREADY EXISTS ON RMS                                  51590000
516000     IF ASC-KEY-FUNCTION-ID = PC-PO-FUNCTION-ID                   51600000
516100                           OR PC-CORP-FUNCTION-ID                 51610000
516200        PERFORM 8100-CHECK-VENDOR-IN-RMS                          51620000
516300        IF (EXTENT-VND-IN-RMS-IND = 'Y') AND                      51630000
516400           (EXTENT-PRIM-TYP-CDE = 'M')                            51640000
516500           PERFORM 8040-SEND-DELETE-MQ-MESSAGE                    51650000
516600        END-IF                                                    51660000
516700     END-IF.                                                      51670000
516800                                                                  51680000
516900*** CALL INTERFACE ONLY WHEN REMITTANCE OR 1099 ADDRESS DELETED   51690000
517000     IF  ASC-KEY-FUNCTION-ID = PC-REMIT-FUNCTION-ID               51700000
517100                            OR PC-1099-FUNCTION-ID                51710000
517200         PERFORM 6003-GET-VENDOR-SHORTNAME                        51720000
517300         PERFORM 7030-SELECT-TEXTENT                              51730000
517400         SET ASC-DELETE-SUCCESSFUL   TO TRUE                      51740000
517500     ELSE                                                         51750000
517600         MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER        51760000
517700         SET DP020-MSG-INFORMATIONAL                              51770000
517800             ASC-DELETE-SUCCESSFUL     TO TRUE                    51780000
517900     END-IF.                                                      51790000
518000                                                                  51800000
518100     IF  ASC-USE-SELECTION-QUEUE                                  51810000
518200         PERFORM 5200-UPDATE-SELECTION-QUEUE                      51820000
518300     END-IF.                                                      51830000
518400                                                                  51840000
518500/                                                                 51850000
518600 8010-DELETE-TBUSLOC.                                             51860000
518700                                                                  51870000
518800     PERFORM                                                      51880000
518900         WITH TEST AFTER                                          51890000
519000         VARYING PV-RETRY-COUNTER                                 51900000
519100         FROM 1 BY 1                                              51910000
519200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               51920000
519300             OR (SQLCODE = +0))                                   51930000
519400                                                                  51940000
519500         EXEC SQL                                                 51950000
519600             DELETE FROM TBUSLOC                                  51960000
519700             WHERE ENT_ID  = :DK-ENT-ID                           51970000
519800               AND SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR                 51980000
519900         END-EXEC                                                 51990000
520000                                                                  52000000
520100         EVALUATE TRUE                                            52010000
520200             WHEN SQLCODE = +0                                    52020000
520300             WHEN SQLCODE = -904                                  52030000
520400             WHEN SQLCODE = -913                                  52040000
520500                 CONTINUE                                         52050000
520600             WHEN SQLWARN0 NOT = SPACES                           52060000
520700             WHEN SQLCODE < +0                                    52070000
520800             WHEN SQLCODE > +0                                    52080000
520900                 MOVE '8010-DELETE-TBUSLOC'                       52090000
521000                                   TO DP013-PARAGRAPH             52100000
521100                 MOVE 'DELETE A ROW ON TBUSLOC'                   52110000
521200                                   TO DP013-MESSAGE-TEXT(1)       52120000
521300                 MOVE SQLCA        TO DP013-SQLCA                 52130000
521400                 MOVE 'TBUSLOC'    TO DP013-DB2-TABLE-NAME (1)    52140000
521500                 SET DP013-DB2-ABEND                              52150000
521600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           52160000
521700                 PERFORM DP013-0000-PROCESS-ABEND                 52170000
521800         END-EVALUATE                                             52180000
521900     END-PERFORM.                                                 52190000
522000                                                                  52200000
522100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        52210000
522200         MOVE '8010-DELETE-TBUSLOC'                               52220000
522300                                   TO DP013-PARAGRAPH             52230000
522400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              52240000
522500                                   TO DP013-MESSAGE-TEXT (1)      52250000
522600         MOVE 'TO DELETE A TBUSLOC ROW'                           52260000
522700                                   TO DP013-MESSAGE-TEXT (2)      52270000
522800         MOVE SQLCA                TO DP013-SQLCA                 52280000
522900         MOVE 'TBUSLOC'            TO DP013-DB2-TABLE-NAME (1)    52290000
523000         SET DP013-DB2-ABEND                                      52300000
523100             DP013-XCTL-DISPLAY-RESTART                           52310000
523200                                   TO TRUE                        52320000
523300         PERFORM DP013-0000-PROCESS-ABEND                         52330000
523400     END-IF.                                                      52340000
523500                                                                  52350000
523600/                                                                 52360000
523700*----------------------------------------------------------------*52370000
523800*    CHECK IF THE ADDRESS IS ATTACHED TO A PRETICKET REQUEST     *52380000
523900*----------------------------------------------------------------*52390000
524000 8030-CHECK-FOR-PRETICK-RQST.                                     52400000
524100                                                                  52410000
524200     MOVE ASC-KEY-ENT-ID    TO DK-ENT-ID                          52420000
524300                                                                  52430000
524400     PERFORM                                                      52440000
524500         WITH TEST AFTER                                          52450000
524600         VARYING PV-RETRY-COUNTER                                 52460000
524700         FROM 1 BY 1                                              52470000
524800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52480000
524900             OR (SQLCODE = +0))                                   52490000
525000                                                                  52500000
525100         EXEC SQL                                                 52510000
525200             SELECT COUNT(*)                                      52520000
525300             INTO  :PV-DB2-COUNT                                  52530000
525400             FROM  TPTKREQ                                        52540000
525500             WHERE ENT_ID  = :DK-ENT-ID                           52550000
525600               AND ADDR_SEQ_NBR = :ASC-TBUSLOC-SEQ-NBR            52560000
525700         END-EXEC                                                 52570000
525800                                                                  52580000
525900         EVALUATE TRUE                                            52590000
526000             WHEN SQLCODE = +0                                    52600000
526100             WHEN SQLCODE = -904                                  52610000
526200             WHEN SQLCODE = -913                                  52620000
526300                 CONTINUE                                         52630000
526400             WHEN SQLWARN0 NOT = SPACES                           52640000
526500             WHEN SQLCODE < +0                                    52650000
526600             WHEN SQLCODE > +0                                    52660000
526700                 MOVE '8030-CHECK-FOR-PRETICK-RQST'               52670000
526800                                   TO DP013-PARAGRAPH             52680000
526900                 MOVE 'SELECT PRETICKET HEADER RECORDS'           52690000
527000                                   TO DP013-MESSAGE-TEXT(1)       52700000
527100                 MOVE DK-ENT-ID    TO DP013-MESSAGE-TEXT(2)       52710000
527200                 MOVE ASC-TBUSLOC-SEQ-NBR                         52720000
527300                                   TO DP013-MESSAGE-TEXT(3)       52730000
527400                 MOVE SQLCA        TO DP013-SQLCA                 52740000
527500                 MOVE 'TPTKREQ'    TO DP013-DB2-TABLE-NAME (1)    52750000
527600                 SET DP013-DB2-ABEND                              52760000
527700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           52770000
527800                 PERFORM DP013-0000-PROCESS-ABEND                 52780000
527900         END-EVALUATE                                             52790000
528000     END-PERFORM.                                                 52800000
528100                                                                  52810000
528200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        52820000
528300         MOVE '8030-CHECK-FOR-PRETICK-RQST'                       52830000
528400                                   TO DP013-PARAGRAPH             52840000
528500         MOVE 'MAX RETRIES SELECT PRETICKET HEADER RECORDS'       52850000
528600                                   TO DP013-MESSAGE-TEXT(1)       52860000
528700         MOVE DK-ENT-ID            TO DP013-MESSAGE-TEXT(2)       52870000
528800         MOVE ASC-TBUSLOC-SEQ-NBR  TO DP013-MESSAGE-TEXT(3)       52880000
528900         MOVE SQLCA                TO DP013-SQLCA                 52890000
529000         MOVE 'TPTKREQ'            TO DP013-DB2-TABLE-NAME (1)    52900000
529100         SET DP013-DB2-ABEND                                      52910000
529200             DP013-XCTL-DISPLAY-RESTART                           52920000
529300                                   TO TRUE                        52930000
529400         PERFORM DP013-0000-PROCESS-ABEND                         52940000
529500     END-IF.                                                      52950000
529600                                                                  52960000
529700/                                                                 52970000
529800*----------------------------------------------------------------*52980000
529900*    FORMAT AND LINK THE MQ SERIES PROGRAM FOR DELETING ADDRESS  *52990000
530000*    RMS.                                                        *53000000
530100*----------------------------------------------------------------*53010000
530200 8040-SEND-DELETE-MQ-MESSAGE.                                     53020000
530300                                                                  53030000
530400     INITIALIZE VN007-INTERFACE-MESSAGE-PARMS.                    53040000
530500                                                                  53050000
530600     PERFORM 8150-GET-VENDOR-NAME.                                53060000
530700                                                                  53070000
530800     MOVE PV-DUN-NBR                TO VN007-VND-NBR.             53080000
530900     MOVE DK-ENT-ID                 TO VN007-ENT-ID.              53090000
531000     MOVE ASC-KEY-FUNCTION-ID       TO VN007-FUNCTION-ID(1).      53100000
531100     MOVE ASC-TBUSLOC-SEQ-NBR       TO VN007-ADDR-SEQ-NBR(1).     53110000
531200     MOVE ASC-PRIM-ADDR-IND         TO VN007-PRIM-ADDR-IND(1).    53120000
531300     MOVE ASC-COUNTRY-CDE           TO VN007-CNTRY-CD(1).         53130000
531400     MOVE ASC-ADDR1-EXNAME          TO VN007-ADDR-LINE1(1).       53140000
531500     MOVE ASC-ADDR12-DESC           TO VN007-ADDR-LINE2(1).       53150000
531600     MOVE ASC-ADDR23-DESC           TO VN007-ADDR-LINE3(1).       53160000
531700     MOVE ASC-CITY                  TO VN007-CITY(1).             53170000
531800     MOVE ASC-STATE-CDE             TO VN007-ST-PROV-CDE(1).      53180000
531900     MOVE ASC-ZIP                   TO VN007-ZIP-CDE(1).          53190000
532000     MOVE ASC-EMAIL-ADDR            TO VN007-EMAIL-ADD(1).        53200000
532100     STRING ASC-FIRST-NAME DELIMITED BY '  '                      53210000
532200            ' '            DELIMITED BY SIZE                      53220000
532300            ASC-LAST-NAME  DELIMITED BY '  '                      53230000
532400                                  INTO VN007-CONTACT-NAME(1).     53240000
532500     MOVE ASC-TEL1-NBR              TO VN007-TEL1-NBR(1).         53250000
532600     MOVE ASC-FAX-NBR               TO VN007-FAX-NBR(1).          53260000
532700     MOVE 'Y'                       TO VN007-ADDR-DELETE-IND(1).  53270000
532800                                                                  53280000
532900     EXEC CICS                                                    53290000
533000      LINK PROGRAM (PC-VNKCS024)                                  53300000
533100           COMMAREA(VN007-COMMAREA)                               53310000
533200           RESP    (PV-CICS-RESPONSE)                             53320000
533300     END-EXEC.                                                    53330000
533400                                                                  53340000
533500     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   53350000
533600         MOVE '8040-SEND-DELETE-MQ-MESSAGE'                       53360000
533700                         TO DP013-PARAGRAPH                       53370000
533800         MOVE 'UNSUCCESSFUL LINK TO VNKCS024'                     53380000
533900                         TO DP013-MESSAGE-TEXT(1)                 53390000
534000         SET DP013-CICS-ABEND                                     53400000
534100             DP013-ROLLBACK                                       53410000
534200             DP013-XCTL-DISPLAY-RESTART                           53420000
534300                         TO TRUE                                  53430000
534400         PERFORM DP013-0000-PROCESS-ABEND                         53440000
534500     ELSE                                                         53450000
534600        IF VN007-NO-ERRORS                                        53460000
534700           NEXT SENTENCE                                          53470000
534800        ELSE                                                      53480000
534900           IF VN007-MQ-ERROR                                      53490000
535000              MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM          53500000
535100              MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH        53510000
535200              MOVE VN007-REASON-CODE    TO DP013-MESSAGE-TEXT(1)  53520000
535300              MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT(2)  53530000
535400              SET DP013-XCTL-DISPLAY-RESTART                      53540000
535500                  DP013-ROLLBACK                                  53550000
535600                  DP013-OTHER-ABEND     TO TRUE                   53560000
535700              PERFORM DP013-0000-PROCESS-ABEND                    53570000
535800           END-IF                                                 53580000
535900        END-IF                                                    53590000
536000     END-IF.                                                      53600000
536100                                                                  53610000
536200/                                                                 53620000
536300 8100-CHECK-VENDOR-IN-RMS.                                        53630000
536400                                                                  53640000
536500     PERFORM                                                      53650000
536600         WITH TEST AFTER                                          53660000
536700         VARYING PV-RETRY-COUNTER                                 53670000
536800         FROM 1 BY 1                                              53680000
536900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53690000
537000            OR (SQLCODE = +0))                                    53700000
537100                                                                  53710000
537200         EXEC SQL                                                 53720000
537300             SELECT PRIM_TYP_CDE                                  53730000
537400                  , VND_IN_RMS_IND                                53740000
537410                  , EDI_PO_PREPK_CDE                              53741002
537500              INTO  :EXTENT-PRIM-TYP-CDE                          53750000
537600                  , :EXTENT-VND-IN-RMS-IND                        53760000
537610                  , :EXTENT-EDI-PO-PREPK-CDE                      53761002
537700                                                                  53770000
537800              FROM  TEXTENT                                       53780000
537900              WHERE ENT_ID   = :DK-ENT-ID                         53790000
538000         END-EXEC                                                 53800000
538100                                                                  53810000
538200         EVALUATE TRUE                                            53820000
538300             WHEN SQLCODE = +0                                    53830000
538400             WHEN SQLCODE = -904                                  53840000
538500             WHEN SQLCODE = -913                                  53850000
538600                 CONTINUE                                         53860000
538700             WHEN SQLWARN0 NOT = SPACE                            53870000
538800             WHEN SQLCODE < +0                                    53880000
538900             WHEN SQLCODE > +0                                    53890000
539000                 MOVE '8100-CHECK-VENDOR-IN-RMS'                  53900000
539100                                 TO DP013-PARAGRAPH               53910000
539200                 MOVE 'SELECT FOR IN-RMS-IND'                     53920000
539300                                 TO DP013-MESSAGE-TEXT (1)        53930000
539400                 MOVE SQLCA      TO DP013-SQLCA                   53940000
539500                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      53950000
539600                     SET DP013-DB2-ABEND                          53960000
539700                         DP013-XCTL-DISPLAY-RESTART               53970000
539800                                 TO TRUE                          53980000
539900                 PERFORM DP013-0000-PROCESS-ABEND                 53990000
540000         END-EVALUATE                                             54000000
540100     END-PERFORM.                                                 54010000
540200                                                                  54020000
540300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        54030000
540400         MOVE '8100-CHECK-VENDOR-IN-RMS'                          54040000
540500                                    TO DP013-PARAGRAPH            54050000
540600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TEXTENT'        54060000
540700                                   TO DP013-MESSAGE-TEXT (1)      54070000
540800         MOVE SQLCA                TO DP013-SQLCA                 54080000
540900         SET DP013-DB2-ABEND       TO TRUE                        54090000
541000         PERFORM DP013-0000-PROCESS-ABEND                         54100000
541100     END-IF.                                                      54110000
541200                                                                  54120000
541300/                                                                 54130000
541400*----------------------------------------------------------------*54140000
541500* GET THE VENDOR NAME FOR RMS MQ SERIES INTERFACE                 54150000
541600*----------------------------------------------------------------*54160000
541700                                                                  54170000
541800 8150-GET-VENDOR-NAME.                                            54180000
541900                                                                  54190000
542000     PERFORM                                                      54200000
542100         WITH TEST AFTER                                          54210000
542200         VARYING PV-RETRY-COUNTER                                 54220000
542300         FROM 1 BY 1                                              54230000
542400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               54240000
542500            OR (SQLCODE = +0))                                    54250000
542600                                                                  54260000
542700         EXEC SQL                                                 54270000
542800             SELECT A.ENT_NAME_DESC                               54280000
542900                  , B.DUN_NBR                                     54290000
543000                  , B.STATUS_CDE                                  54300000
543100              INTO  :PV-ENT-NAME-DESC                             54310000
543200                  , :PV-DUN-NBR                                   54320000
543300                  , :PV-STATUS-CDE                                54330000
543400              FROM  TENTNME A                                     54340000
543500                 ,  TEXTENT B                                     54350000
543600              WHERE A.ENT_ID   = :DK-ENT-ID                       54360000
543700                AND A.ENT_ID   = B.ENT_ID                         54370000
543800                AND A.TYPE_CDE = '01'                             54380000
543900         END-EXEC                                                 54390000
544000                                                                  54400000
544100         EVALUATE TRUE                                            54410000
544200             WHEN SQLCODE = +0                                    54420000
544300             WHEN SQLCODE = -904                                  54430000
544400             WHEN SQLCODE = -913                                  54440000
544500                 CONTINUE                                         54450000
544600             WHEN SQLWARN0 NOT = SPACE                            54460000
544700             WHEN SQLCODE < +0                                    54470000
544800             WHEN SQLCODE > +0                                    54480000
544900                 MOVE '8150-GET-VENDOR-NAME'                      54490000
545000                                 TO DP013-PARAGRAPH               54500000
545100                 MOVE 'SELECT ON ENTERPRISE NAME TABLE'           54510000
545200                                 TO DP013-MESSAGE-TEXT (1)        54520000
545300                 MOVE SQLCA      TO DP013-SQLCA                   54530000
545400                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (1)      54540000
545500                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (2)      54550000
545600                     SET DP013-DB2-ABEND                          54560000
545700                         DP013-XCTL-DISPLAY-RESTART               54570000
545800                                 TO TRUE                          54580000
545900                 PERFORM DP013-0000-PROCESS-ABEND                 54590000
546000         END-EVALUATE                                             54600000
546100     END-PERFORM.                                                 54610000
546200                                                                  54620000
546300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        54630000
546400         MOVE '8150-GET-VENDOR-NAME' TO DP013-PARAGRAPH           54640000
546500         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TENTNME'        54650000
546600                                   TO DP013-MESSAGE-TEXT (1)      54660000
546700         MOVE SQLCA                TO DP013-SQLCA                 54670000
546800         SET DP013-DB2-ABEND       TO TRUE                        54680000
546900         PERFORM DP013-0000-PROCESS-ABEND                         54690000
547000     END-IF.                                                      54700000
547100                                                                  54710000
547200 8200-GET-ADDRESS-INFORMATION.                                    54720000
547300                                                                  54730000
547400     PERFORM                                                      54740000
547500         WITH TEST AFTER                                          54750000
547600         VARYING PV-RETRY-COUNTER                                 54760000
547700         FROM 1 BY 1                                              54770000
547800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               54780000
547900            OR (SQLCODE = +0))                                    54790000
548000                                                                  54800000
548100          EXEC SQL                                                54810000
548200             SELECT A.FIRST_NAME                                  54820000
548300                   ,A.LAST_NAME                                   54830000
548400                   ,A.TEL1_NBR                                    54840000
548500                   ,A.FAX_NBR                                     54850000
548600                   ,A.EMAIL_ADDR_ID                               54860000
548700                   ,B.ADDRESS_LINE1_DESC                          54870000
548800                   ,B.ADDRESS_LINE2_DESC                          54880000
548900                   ,B.ADDRESS_LINE3_DESC                          54890000
549000                   ,B.CITY_NAME                                   54900000
549100                   ,B.ST_PROV_CDE                                 54910000
549200                   ,B.CNTRY_CDE                                   54920000
549300                   ,B.ZIP_CDE                                     54930000
549400               INTO :PV-FIRST-NAME                                54940000
549500                   ,:PV-LAST-NAME                                 54950000
549600                   ,:PV-PHONE-NBR                                 54960000
549700                   ,:PV-FAX-NBR                                   54970000
549800                   ,:PV-EMAIL-ADDR                                54980000
549900                   ,:PV-RMS-ADDRESS1                              54990000
550000                   ,:PV-RMS-ADDRESS2                              55000000
550100                   ,:PV-RMS-ADDRESS3                              55010000
550200                   ,:PV-CITY-NAME                                 55020000
550300                   ,:PV-STATE-CDE                                 55030000
550400                   ,:PV-COUNTRY-CDE                               55040000
550500                   ,:PV-ZIP-CDE                                   55050000
550600             FROM TENTREP A                                       55060000
550700                 ,TBUSLOC B                                       55070000
550800             WHERE A.ENT_ID         = :ASC-KEY-ENT-ID             55080000
550900               AND A.FUNCTION_ID    = :ASC-KEY-FUNCTION-ID        55090000
551000               AND A.ENT_BUS_LOC_ID = :PV-BUSLOC-SEQ-NBR          55100000
551100               AND A.ENT_ID         = B.ENT_ID                    55110000
551200               AND A.ENT_BUS_LOC_ID = B.SEQ_NBR                   55120000
551300          END-EXEC                                                55130000
551400                                                                  55140000
551500          EVALUATE TRUE                                           55150000
551600              WHEN SQLCODE = +0                                   55160000
551700              WHEN SQLCODE = -904                                 55170000
551800              WHEN SQLCODE = -913                                 55180000
551900                  CONTINUE                                        55190000
552000              WHEN SQLWARN0 NOT = SPACE                           55200000
552100              WHEN SQLCODE < +0                                   55210000
552200              WHEN SQLCODE > +0                                   55220000
552300                  MOVE '8200-GET-ADDRESS-INFORMATION'             55230000
552400                                  TO DP013-PARAGRAPH              55240000
552500                  MOVE 'SELECT ON BUSLOC TABLE'                   55250000
552600                                  TO DP013-MESSAGE-TEXT (1)       55260000
552700                 MOVE SQLCA      TO DP013-SQLCA                   55270000
552800                 MOVE 'TBUSLOC'  TO DP013-DB2-TABLE-NAME (1)      55280000
552900                 MOVE 'TENTREP'  TO DP013-DB2-TABLE-NAME (2)      55290000
553000                     SET DP013-DB2-ABEND                          55300000
553100                         DP013-XCTL-DISPLAY-RESTART               55310000
553200                                 TO TRUE                          55320000
553300                 PERFORM DP013-0000-PROCESS-ABEND                 55330000
553400         END-EVALUATE                                             55340000
553500     END-PERFORM.                                                 55350000
553600                                                                  55360000
553700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        55370000
553800         MOVE '8200-GET-ADDRESS-INFORMATION' TO DP013-PARAGRAPH   55380000
553900         MOVE 'MAX RETRIES EXCEEDED FOR SELECT ON TBUSLOC'        55390000
554000                                   TO DP013-MESSAGE-TEXT (1)      55400000
554100         MOVE SQLCA                TO DP013-SQLCA                 55410000
554200         SET DP013-DB2-ABEND       TO TRUE                        55420000
554300         PERFORM DP013-0000-PROCESS-ABEND                         55430000
554400     END-IF.                                                      55440000
554500/                                                                 55450000
554600*----------------------------------------------------------------*55460000
554700*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *55470000
554800*----------------------------------------------------------------*55480000
554900                                                                  55490000
555000 9100-READ-SEL-QUEUE.                                             55500000
555100     EXEC CICS                                                    55510000
555200         READQ TS                                                 55520000
555300             QUEUE (ASC-SEL-QUEUE-NAME)                           55530000
555400             INTO  (VN003-VENDOR-SEL-REC)                         55540000
555500             ITEM  (ASC-SEL-ITEM)                                 55550000
555600             RESP  (PV-CICS-RESP)                                 55560000
555700     END-EXEC.                                                    55570000
555800                                                                  55580000
555900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       55590000
556000         CONTINUE                                                 55600000
556100     ELSE                                                         55610000
556200         SET DP013-LOGIC-ABEND                                    55620000
556300             DP013-NO-ROLLBACK     TO TRUE                        55630000
556400         MOVE '9100-READ-SEL-QUEUE'                               55640000
556500                                   TO DP013-PARAGRAPH             55650000
556600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   55660000
556700                                   TO DP013-MESSAGE-TEXT (1)      55670000
556800         PERFORM DP013-0000-PROCESS-ABEND                         55680000
556900     END-IF.                                                      55690000
557000                                                                  55700000
557100/                                                                 55710000
557200*----------------------------------------------------------------*55720000
557300*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *55730000
557400*----------------------------------------------------------------*55740000
557500 9200-REWRITE-LIST-QUEUE.                                         55750000
557600     EXEC CICS                                                    55760000
557700          WRITEQ TS                                               55770000
557800              QUEUE  (ASC-SEL-QUEUE-NAME)                         55780000
557900              FROM   (VN003-VENDOR-SEL-REC)                       55790000
558000              ITEM   (ASC-SEL-ITEM)                               55800000
558100              RESP   (PV-CICS-RESP)                               55810000
558200              REWRITE                                             55820000
558300     END-EXEC.                                                    55830000
558400                                                                  55840000
558500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   55850000
558600         SET DP013-CICS-ABEND                                     55860000
558700             DP013-NO-ROLLBACK     TO TRUE                        55870000
558800         MOVE '9200-REWRITE-LIST-QUEUE'                           55880000
558900                                   TO DP013-PARAGRAPH             55890000
559000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   55900000
559100                                   TO DP013-MESSAGE-TEXT (1)      55910000
559200         PERFORM DP013-0000-PROCESS-ABEND                         55920000
559300     END-IF.                                                      55930000
559400                                                                  55940000
559500*----------------------------------------------------------------*55950000
559600*    ABEND PROCESSOR MODULE                                      *55960000
559700*----------------------------------------------------------------*55970000
559800                                                                  55980000
559900     COPY DPPD013.                                                55990000
