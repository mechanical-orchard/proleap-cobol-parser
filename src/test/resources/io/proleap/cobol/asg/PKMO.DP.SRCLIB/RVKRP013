000100******************************************************************00010009
000200 IDENTIFICATION DIVISION.                                         00020009
000300******************************************************************00030009
000400                                                                  00040009
000500 PROGRAM-ID.             RVKRP013.                                00050009
000600 AUTHOR.                 MICHAEL WALTERS.                         00060009
000700 INSTALLATION.           KOHLS.                                   00070009
000800 DATE-WRITTEN            AUGUST, 1995.                            00080009
000900 DATE-COMPILED.                                                   00090009
001000                                                                  00100009
001100******************************************************************00110009
001200*  THIS PROGRAM WILL CREATES A RETURN TO VENDOR REPORT            00120009
001300*      THAT IS CREATED QUARTERLY OR BY SPECIAL REQUEST            00130009
001400******************************************************************00140009
001500                                                                  00150009
001600******************************************************************00160009
001700 ENVIRONMENT DIVISION.                                            00170009
001800******************************************************************00180009
001900                                                                  00190009
002000 CONFIGURATION SECTION.                                           00200009
002100                                                                  00210009
002200 SOURCE-COMPUTER.        IBM-3090.                                00220009
002300 OBJECT-COMPUTER.        IBM-3090.                                00230009
002400                                                                  00240009
002500 INPUT-OUTPUT SECTION.                                            00250009
002600                                                                  00260009
002700 FILE-CONTROL.                                                    00270009
002800                                                                  00280009
002900     SELECT RTV-REPORT-EXTRACT                                    00290009
003000         ASSIGN TO IN01.                                          00300009
003100                                                                  00310009
003200     SELECT DI-DEFECT-ITEM-REPORT                                 00320009
003300         ASSIGN TO RPT01.                                         00330009
003400                                                                  00340009
003500******************************************************************00350009
003600 DATA DIVISION.                                                   00360009
003700******************************************************************00370009
003800                                                                  00380009
003900 FILE SECTION.                                                    00390009
004000                                                                  00400009
004100 FD  RTV-REPORT-EXTRACT                                           00410009
004200     RECORDING MODE IS F                                          00420009
004300     LABEL RECORDS ARE STANDARD                                   00430009
004400     BLOCK CONTAINS 0 RECORDS.                                    00440009
004500                                                                  00450009
004600 01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                 00460009
004700                                                                  00470009
004800 FD  DI-DEFECT-ITEM-REPORT                                        00480009
004900     RECORDING MODE IS F                                          00490009
005000     LABEL RECORDS ARE STANDARD                                   00500009
005100     BLOCK CONTAINS 0 RECORDS.                                    00510009
005200                                                                  00520009
005300 01  DI-DEFECT-ITEM-LINE             PIC  X(132).                 00530009
005400                                                                  00540009
005500******************************************************************00550009
005600 WORKING-STORAGE SECTION.                                         00560009
005700******************************************************************00570009
005800*                                                                 00580009
005900*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                00590009
006000*                                                                 00600009
006100     COPY DPWS132O.                                               00610009
006200                                                                  00620009
006300*                                                                 00630009
006400*  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         00640009
006500*                                                                 00650009
006600     COPY RVRD002.                                                00660009
006700                                                                  00670009
006800 01  ABEND-CODE                          PIC S9(04) VALUE +0      00680009
006900                                                     COMP SYNC.   00690009
007000 01  PH2-PAGE-HEADING-QUARTERLY.                                  00700009
007100     05  FILLER                          PIC  X(45)  VALUE SPACE. 00710009
007200     05  FILLER                          PIC  X(42)  VALUE        00720009
007300         'VENDOR RETURN-AGREEMENT REPORT (QUARTERLY)'.            00730009
007400     05  FILLER                          PIC  X(46)  VALUE SPACE. 00740009
007500                                                                  00750009
007600 01  PH2-PAGE-HEADING-REQUEST.                                    00760009
007700     05  FILLER                          PIC  X(42)  VALUE SPACE. 00770009
007800     05  FILLER                          PIC  X(48)  VALUE        00780009
007900         'VENDOR RETURN-AGREEMENT REPORT (SPECIAL REQUEST)'.      00790009
008000     05  FILLER                          PIC  X(43)  VALUE SPACE. 00800009
008100                                                                  00810009
008200 01  PH3-PAGE-HEADING-3.                                          00820009
008300     05  FILLER                          PIC  X(44)  VALUE SPACE. 00830009
008400     05  FILLER                          PIC  X(12)  VALUE        00840009
008500         'BEGIN DATE: '.                                          00850009
008600     05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. 00860009
008700     05  FILLER                          PIC  X(13)  VALUE        00870009
008800         ' - END DATE: '.                                         00880009
008900     05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. 00890009
009000     05  FILLER                          PIC  X(42)  VALUE SPACE. 00900009
009100                                                                  00910009
009200 01  DH1-DETAIL-HEADING-1.                                        00920009
009300     05  FILLER                          PIC  X(20)  VALUE SPACES.00930009
009400     05  FILLER                          PIC  X(02)  VALUE SPACES.00940009
009500     05  FILLER                          PIC  X(04)  VALUE        00950009
009600         'VEND'.                                                  00960009
009700     05  FILLER                          PIC  X(02)  VALUE SPACES.00970009
009800     05  FILLER                          PIC  X(03)  VALUE        00980009
009900         'DPT'.                                                   00990009
010000     05  FILLER                          PIC  X(02)  VALUE SPACES.01000009
010100     05  FILLER                          PIC  X(20)  VALUE        01010009
010200         ' DEPARTMENT         '.                                  01020009
010300     05  FILLER                          PIC  X(02)  VALUE SPACES.01030009
010400     05  FILLER                          PIC  X(11)  VALUE        01040009
010500         'RTRN AGRMNT'.                                           01050009
010600     05  FILLER                          PIC  X(03)  VALUE SPACES.01060009
010700     05  FILLER                          PIC  X(17)  VALUE        01070009
010800         '        COST OF  '.                                     01080009
010900     05  FILLER                          PIC  X(04)  VALUE SPACES.01090009
011000     05  FILLER                          PIC  X(17)  VALUE        01100009
011100         '        COST OF  '.                                     01110009
011200     05  FILLER                          PIC  X(03)  VALUE SPACES.01120009
011300     05  FILLER                          PIC  X(06)  VALUE        01130009
011400         'RETURN'.                                                01140009
011500     05  FILLER                          PIC  X(04)  VALUE SPACES.01150009
011600     05  FILLER                          PIC  X(10)  VALUE        01160009
011700         'NEGOTIATED'.                                            01170009
011800                                                                  01180009
011900 01  DH2-DETAIL-HEADING-2.                                        01190009
012000     05  FILLER                          PIC  X(20)  VALUE        01200009
012100         ' VENDOR NAME        '.                                  01210009
012200     05  FILLER                          PIC  X(02)  VALUE SPACES.01220009
012300     05  FILLER                          PIC  X(04)  VALUE        01230009
012400         'RANK'.                                                  01240009
012500     05  FILLER                          PIC  X(02)  VALUE SPACES.01250009
012600     05  FILLER                          PIC  X(03)  VALUE 'NBR'. 01260009
012700     05  FILLER                          PIC  X(02)  VALUE SPACES.01270009
012800     05  FILLER                          PIC  X(20)  VALUE        01280009
012900         ' DESCRIPTION        '.                                  01290009
013000     05  FILLER                          PIC  X(02)  VALUE SPACES.01300009
013100     05  FILLER                          PIC  X(03)  VALUE        01310009
013200         'D&R'.                                                   01320009
013300     05  FILLER                          PIC  X(01)  VALUE SPACES.01330009
013400     05  FILLER                          PIC  X(03)  VALUE        01340009
013500         'D&D'.                                                   01350009
013600     05  FILLER                          PIC  X(01)  VALUE SPACES.01360009
013700     05  FILLER                          PIC  X(03)  VALUE        01370009
013800         'MOS'.                                                   01380009
013900     05  FILLER                          PIC  X(03)  VALUE SPACES.01390009
014000     05  FILLER                          PIC  X(17)  VALUE        01400009
014100         '       PURCHASES '.                                     01410009
014200     05  FILLER                          PIC  X(03)  VALUE SPACES.01420009
014300     05  FILLER                          PIC  X(17)  VALUE        01430009
014400         '         RETURNS '.                                     01440009
014500     05  FILLER                          PIC  X(03)  VALUE SPACES.01450009
014600     05  FILLER                          PIC  X(07)  VALUE        01460009
014700         'PERCENT'.                                               01470009
014800     05  FILLER                          PIC  X(06)  VALUE SPACES.01480009
014900     05  FILLER                          PIC  X(07)  VALUE        01490009
015000         'PERCENT'.                                               01500009
015100                                                                  01510009
015200 01  DHD-DETAIL-HEADING-DASHES.                                   01520009
015300     05  FILLER                          PIC  X(20) VALUE ALL '_'.01530009
015400     05  FILLER                          PIC  X(02)  VALUE SPACES.01540009
015500     05  FILLER                          PIC  X(04) VALUE ALL '_'.01550009
015600     05  FILLER                          PIC  X(02)  VALUE SPACES.01560009
015700     05  FILLER                          PIC  X(03) VALUE ALL '_'.01570009
015800     05  FILLER                          PIC  X(02)  VALUE SPACES.01580009
015900     05  FILLER                          PIC  X(20) VALUE ALL '_'.01590009
016000     05  FILLER                          PIC  X(02) VALUE SPACES. 01600009
016100     05  FILLER                          PIC  X(03) VALUE ALL '_'.01610009
016200     05  FILLER                          PIC  X(01) VALUE SPACES. 01620009
016300     05  FILLER                          PIC  X(03) VALUE ALL '_'.01630009
016400     05  FILLER                          PIC  X(01) VALUE SPACES. 01640009
016500     05  FILLER                          PIC  X(03) VALUE ALL '_'.01650009
016600     05  FILLER                          PIC  X(01) VALUE SPACES. 01660009
016700     05  FILLER                          PIC  X(19) VALUE ALL '_'.01670009
016800     05  FILLER                          PIC  X(01) VALUE SPACES. 01680009
016900     05  FILLER                          PIC  X(19) VALUE ALL '_'.01690009
017000     05  FILLER                          PIC  X(02) VALUE SPACES. 01700009
017100     05  FILLER                          PIC  X(10) VALUE ALL '_'.01710009
017200     05  FILLER                          PIC  X(02) VALUE SPACES. 01720009
017300     05  FILLER                          PIC  X(10) VALUE ALL '_'.01730009
017400                                                                  01740009
017500 01  DL-DETAIL-LINE.                                              01750009
017600     05  DL-VENDOR-NAME                  PIC  X(20).              01760009
017700     05  FILLER                          PIC  X(02)  VALUE SPACES.01770009
017800     05  DL-RANK-X.                                               01780009
017900         10  DL-RANK                     PIC  9(04).              01790009
018000     05  FILLER                          PIC  X(02)  VALUE SPACES.01800009
018100     05  DL-DPT-NBR                      PIC  X(03).              01810009
018200     05  FILLER                          PIC  X(02)  VALUE SPACES.01820009
018300     05  DL-DPT-DESC                     PIC  X(20).              01830009
018400     05  FILLER                          PIC  X(02)  VALUE SPACES.01840009
018500     05  DL-DEBIT-AND-RETURN-IND         PIC  X(03)  VALUE SPACES.01850009
018600     05  FILLER                          PIC  X(01)  VALUE SPACES.01860009
018700     05  DL-DEBIT-AND-DISPOSE-IND        PIC  X(03)  VALUE SPACES.01870009
018800     05  FILLER                          PIC  X(01)  VALUE SPACES.01880009
018900     05  DL-MARK-OUT-OF-STOCK-IND        PIC  X(03)  VALUE SPACES.01890009
019200     05  DL-PURCHS-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.01920009
019500     05  DL-RETURN-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.01950009
019600     05  FILLER                          PIC  X(02)  VALUE SPACES.01960009
019700     05  DL-COST-RETURN-PERCENT          PIC  ZZZ,ZZ9.99.         01970009
019800     05  FILLER                          PIC  X(04)  VALUE SPACES.01980009
019900     05  DL-NEGOTIATED-PERCENT           PIC  ZZZ9.999.           01990009
020000                                                                  02000009
020100 01  TL-TOTAL-LINE-DASHES.                                        02010009
020200     05  FILLER                          PIC  X(20) VALUE SPACES. 02020009
020300     05  FILLER                          PIC  X(02) VALUE SPACES. 02030009
020400     05  FILLER                          PIC  X(04) VALUE SPACES. 02040009
020500     05  FILLER                          PIC  X(02) VALUE SPACES. 02050009
020600     05  FILLER                          PIC  X(03) VALUE SPACES. 02060009
020700     05  FILLER                          PIC  X(01) VALUE SPACES. 02070009
020800     05  FILLER                          PIC  X(34) VALUE SPACES. 02080009
020900     05  FILLER                          PIC  X(01) VALUE SPACES. 02090009
021000     05  FILLER                          PIC  X(19) VALUE ALL '_'.02100009
021100     05  FILLER                          PIC  X(02) VALUE SPACES. 02110009
021200     05  FILLER                          PIC  X(19) VALUE ALL '_'.02120009
021300     05  FILLER                          PIC  X(01) VALUE SPACES. 02130009
021400     05  FILLER                          PIC  X(10) VALUE ALL '_'.02140009
021500                                                                  02150009
021600 01  TL-TOTAL-LINE.                                               02160009
021700     05  FILLER                          PIC  X(20) VALUE SPACES. 02170009
021800     05  FILLER                          PIC  X(02) VALUE SPACES. 02180009
021900     05  FILLER                          PIC  X(04) VALUE SPACES. 02190009
022000     05  FILLER                          PIC  X(02) VALUE SPACES. 02200009
022100     05  FILLER                          PIC  X(03) VALUE SPACES. 02210009
022200     05  FILLER                          PIC  X(01) VALUE SPACES. 02220009
022300     05  FILLER                          PIC  X(34) VALUE SPACES. 02230009
022400*    05  FILLER                          PIC  X(01) VALUE SPACES. 02240009
022500*    05  TL-PURCHS-COST                  PIC ZZZ,ZZZ,ZZZ,ZZ9.99-. 02250009
022600     05  TL-PURCHS-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.02260009
022700*    05  FILLER                          PIC  X(01) VALUE SPACES. 02270009
022800*    05  TL-RETURN-COST                  PIC ZZZ,ZZZ,ZZZ,ZZ9.99-. 02280009
022900     05  TL-RETURN-COST                  PIC ZZZZ,ZZZ,ZZZ,ZZ9.99-.02290009
023000     05  FILLER                          PIC  X(02) VALUE SPACES. 02300009
023100     05  TL-COST-RETURN-PERCENT          PIC  ZZZ,ZZ9.99.         02310009
023200                                                                  02320009
023300 01  BLANK-LINE.                                                  02330009
023400     05  FILLER                          PIC  X(132) VALUE SPACE. 02340009
023500                                                                  02350009
023600 01  END-OF-REPORT-LINE.                                          02360009
023700     05  FILLER                          PIC  X(52)  VALUE SPACE. 02370009
023800     05  FILLER                          PIC  X(25)  VALUE        02380009
023900         '***** END OF REPORT *****'.                             02390009
024000     05  FILLER                          PIC  X(55)  VALUE SPACE. 02400009
024100                                                                  02410009
024200 01  ER-EMPTY-REPORT-LINE.                                        02420009
024300     05  FILLER                          PIC  X(42)  VALUE SPACE. 02430009
024400     05  FILLER                          PIC  X(48)  VALUE        02440009
024500         '*******   THERE IS NO DATA TO REPORT     *******'.      02450009
024600     05  FILLER                          PIC  X(42)  VALUE SPACE. 02460009
024700                                                                  02470009
024800 01  PA-PROGRAM-ACCUMULATORS.                                     02480009
024900     05  PA-VND-TOTALS.                                           02490009
025000         10 PA-VND-PURCHS-COST           PIC S9(13)V99            02500009
025100                                                VALUE +0 COMP-3.  02510009
025200         10 PA-VND-RETURN-COST           PIC S9(13)V99            02520009
025300                                                VALUE +0 COMP-3.  02530009
025400 01  PC-CONSTANTS.                                                02540009
025500     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55    02550009
025600                                                     COMP SYNC.   02560009
025700 01  PS-PROGRAM-SWITCHES.                                         02570009
025800     05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   02580009
025900         88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   02590009
026000         88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   02600009
026100                                                                  02610009
026200     05  PS-NEW-LINE-IND                 PIC  X(01)  VALUE 'N'.   02620009
026300         88  PS-NEW-LINE                             VALUE 'Y'.   02630009
026400         88  PS-NO-NEW-LINE                          VALUE 'N'.   02640009
026500                                                                  02650009
026600     05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   02660009
026700         88  PS-NO-DATA                              VALUE 'N'.   02670009
026800         88  PS-DATA                                 VALUE 'Y'.   02680009
026900                                                                  02690009
027000 01  PV-PROGRAM-VARIABLES.                                        02700009
027100     05  PV-PERCENT                      PIC S9(06)V9(5)          02710009
027200                                             VALUE +0 COMP SYNC.  02720009
027300     05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     02730009
027400                                                     COMP SYNC.   02740009
027500     05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     02750009
027600                                                     COMP SYNC.   02760009
027700                                                                  02770009
027800     05  PV-HOLD-VENDOR-DUNNS            PIC  X(09).              02780009
027900     05  PV-HOLD-VENDOR-NAME             PIC  X(25).              02790009
028000     05  PV-HOLD-RANK-X.                                          02800009
028100         10  PV-HOLD-RANK                PIC  9(04).              02810009
028200     05  PV-RPT-TYPE                     PIC  X(1).               02820009
028300         88  PV-QUARTERLY-REPORT         VALUE 'Q'.               02830009
028400         88  PV-REQUEST-REPORT           VALUE 'R'.               02840009
028500*                                                                 02850009
028600     05  PV-START-DATE.                                           02860009
028700         10  PV-START-MONTH              PIC  9(02).              02870009
028800         10  FILLER                      PIC  X(01) VALUE '/'.    02880009
028900         10  PV-START-DAY                PIC  9(02).              02890009
029000         10  FILLER                      PIC  X(01) VALUE '/'.    02900009
029100         10  PV-START-CENTURY            PIC  9(02).              02910009
029200         10  PV-START-YEAR               PIC  9(02).              02920009
029300     05  PV-END-DATE.                                             02930009
029400         10  PV-END-MONTH                PIC  9(02).              02940009
029500         10  FILLER                      PIC  X(01) VALUE '/'.    02950009
029600         10  PV-END-DAY                  PIC  9(02).              02960009
029700         10  FILLER                      PIC  X(01) VALUE '/'.    02970009
029800         10  PV-END-CENTURY              PIC  9(02).              02980009
029900         10  PV-END-YEAR                 PIC  9(02).              02990009
030000     05  PV-REPORT-LINE                 PIC X(132).               03000009
030100                                                                  03010009
030200 01  ST-SYSTEM-TIME.                                              03020009
030300     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 03030009
030400     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 03040009
030500                                                                  03050009
030600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03060009
030700 PROCEDURE DIVISION.                                              03070009
030800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03080009
030900                                                                  03090009
031000******************************************************************03100009
031100*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    03110009
031200******************************************************************03120009
031300 0000-PROGRAM-MAINLINE.                                           03130009
031400     PERFORM 1000-INITIALIZE.                                     03140009
031500                                                                  03150009
031600     PERFORM 2000-CREATE-REPORT                                   03160009
031700         UNTIL PS-END-OF-EXTRACT-FILE.                            03170009
031800                                                                  03180009
031900     PERFORM 9000-EOJ-ROUTINE.                                    03190009
032000     STOP RUN.                                                    03200009
032100                                                                  03210009
032200******************************************************************03220009
032300*  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  03230009
032400*  AND DISPLAYS CONTROL CARD INFORMATION, PRINTS INITIAL PAGE     03240009
032500*  HEADING TO REPORT                                              03250009
032600******************************************************************03260009
032700 1000-INITIALIZE.                                                 03270009
032800     OPEN OUTPUT DI-DEFECT-ITEM-REPORT                            03280009
032900          INPUT  RTV-REPORT-EXTRACT.                              03290009
033000                                                                  03300009
033100     SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      03310009
033200                                                                  03320009
033300     PERFORM 7000-READ-EXTRACT-FILE.                              03330009
033400                                                                  03340009
033500     IF PS-END-OF-EXTRACT-FILE                                    03350009
033600         SET PS-NO-DATA          TO TRUE                          03360009
033700         WRITE DI-DEFECT-ITEM-LINE                                03370009
033800             FROM ER-EMPTY-REPORT-LINE                            03380009
033900             AFTER ADVANCING 3 LINES                              03390009
034000         WRITE DI-DEFECT-ITEM-LINE                                03400009
034100             FROM END-OF-REPORT-LINE                              03410009
034200             AFTER ADVANCING 2 LINES                              03420009
034300     ELSE                                                         03430009
034400         IF RV002-DETAIL-REC                                      03440009
034500             DISPLAY '** ABEND **'                                03450009
034600             DISPLAY '** PROGRAM = RVKRP013 **'                   03460009
034700             DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'     03470009
034800             DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'     03480009
034900             MOVE +4003 TO ABEND-CODE                             03490009
035000             CALL 'ILBOABN0' USING ABEND-CODE                     03500009
035100         ELSE                                                     03510009
035200             SET PS-DATA           TO TRUE                        03520009
035300                                                                  03530009
035400             MOVE RV002-RPT-TYPE   TO PV-RPT-TYPE                 03540009
035500                                                                  03550009
035600             MOVE RV002-END-MM     TO PV-END-MONTH                03560009
035700             MOVE RV002-END-DD     TO PV-END-DAY                  03570009
035800             MOVE RV002-END-CC     TO PV-END-CENTURY              03580009
035900             MOVE RV002-END-YY     TO PV-END-YEAR                 03590009
036000                                                                  03600009
036100             MOVE RV002-BEGIN-MM   TO PV-START-MONTH              03610009
036200             MOVE RV002-BEGIN-DD   TO PV-START-DAY                03620009
036300             MOVE RV002-BEGIN-CC   TO PV-START-CENTURY            03630009
036400             MOVE RV002-BEGIN-YY   TO PV-START-YEAR               03640009
036500                                                                  03650009
036600             MOVE PV-START-DATE    TO PH3-START-DATE              03660009
036700             MOVE PV-END-DATE      TO PH3-END-DATE                03670009
036800                                                                  03680009
036900             MOVE RV002-CURR-YY    TO DP132O-RUN-YEAR             03690009
037000             MOVE RV002-CURR-MM    TO DP132O-RUN-MONTH            03700009
037100             MOVE RV002-CURR-DD    TO DP132O-RUN-DAY              03710009
037200                                                                  03720009
037300             ACCEPT ST-SYSTEM-TIME FROM TIME                      03730009
037400             MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR             03740009
037500             MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE           03750009
037600                                                                  03760009
037700             MOVE 'RVKRP013'       TO DP132O-PROGRAM-NAME         03770009
037800             MOVE 1                TO DP132O-REPORT-NUMBER        03780009
037900                                                                  03790009
038000             MOVE PC-MAX-REPORT-LINES                             03800009
038100                                   TO PV-LINE-COUNT               03810009
038200             MOVE +0               TO PV-PAGE-COUNT               03820009
038300                                                                  03830009
038400             INITIALIZE DL-DETAIL-LINE                            03840009
038500                        PA-PROGRAM-ACCUMULATORS                   03850009
038600             PERFORM 7000-READ-EXTRACT-FILE                       03860009
038700             MOVE RV002-VENDOR-DUNNS  TO PV-HOLD-VENDOR-DUNNS     03870009
038800             MOVE RV002-VENDOR-NAME   TO DL-VENDOR-NAME           03880009
038900                                         PV-HOLD-VENDOR-NAME      03890009
039000             IF RV002-ZERO-VENDOR-RANK                            03900009
039100                MOVE 'N/A'          TO DL-RANK-X                  03910009
039200                                         PV-HOLD-RANK-X           03920009
039300             ELSE                                                 03930009
039400                IF RV002-UNKOWN-VENDOR-RANK                       03940009
039500                   MOVE '    '       TO DL-RANK-X                 03950009
039600                                         PV-HOLD-RANK-X           03960009
039700                ELSE                                              03970009
039800                   MOVE RV002-VENDOR-RANK  TO DL-RANK             03980009
039900                                         PV-HOLD-RANK             03990009
040000                END-IF                                            04000009
040100             END-IF                                               04010009
040200         END-IF                                                   04020009
040300     END-IF.                                                      04030009
040400                                                                  04040009
040500******************************************************************04050009
040600* 2000-CREATE-REPORT                                              04060009
040700* PROCESS:  THIS PARAGRAPH WILL FILL IN THE DETAIL LINE AND       04070009
040800*   WRITE IT OUT.                                                 04080009
040900******************************************************************04090009
041000 2000-CREATE-REPORT.                                              04100009
041100     IF RV002-VENDOR-DUNNS = PV-HOLD-VENDOR-DUNNS                 04110009
041200         CONTINUE                                                 04120009
041300     ELSE                                                         04130009
041400         PERFORM 2200-NEW-VENDOR                                  04140009
041500     END-IF.                                                      04150009
041600                                                                  04160009
041700     PERFORM 2100-SETUP-DETAIL.                                   04170009
041800                                                                  04180009
041900     PERFORM 7000-READ-EXTRACT-FILE.                              04190009
042000                                                                  04200009
042100******************************************************************04210009
042200* 2100-SETUP-DETAIL -- PERFORMED TO FILL IN THE DETAIL LINE OF    04220009
042300*    THE REPORT                                                   04230009
042400******************************************************************04240009
042500 2100-SETUP-DETAIL.                                               04250009
042600     MOVE RV002-DEPT-NMBR     TO DL-DPT-NBR                       04260009
042700     MOVE RV002-DEPT-DESC     TO DL-DPT-DESC                      04270009
042800     IF RV002-DEBIT-AND-RETURN                                    04280009
042900         MOVE 'YES'           TO DL-DEBIT-AND-RETURN-IND          04290009
043000     ELSE                                                         04300009
043100         MOVE '   '           TO DL-DEBIT-AND-RETURN-IND          04310009
043200     END-IF.                                                      04320009
043300                                                                  04330009
043400     IF RV002-DEBIT-AND-DISPOSE                                   04340009
043500         MOVE 'YES'           TO DL-DEBIT-AND-DISPOSE-IND         04350009
043600     ELSE                                                         04360009
043700         MOVE '   '           TO DL-DEBIT-AND-DISPOSE-IND         04370009
043800     END-IF.                                                      04380009
043900                                                                  04390009
044000     IF RV002-MARK-OUT-OF-STOCK                                   04400009
044100         MOVE 'YES'           TO DL-MARK-OUT-OF-STOCK-IND         04410009
044200     ELSE                                                         04420009
044300         MOVE '   '           TO DL-MARK-OUT-OF-STOCK-IND         04430009
044400     END-IF.                                                      04440009
044500                                                                  04450009
044600     MOVE RV002-PURCH-COST    TO DL-PURCHS-COST.                  04460009
044700     ADD  RV002-PURCH-COST    TO PA-VND-PURCHS-COST.              04470009
044800     MOVE RV002-RETURN-COST   TO DL-RETURN-COST.                  04480009
044900     ADD  RV002-RETURN-COST   TO PA-VND-RETURN-COST.              04490009
045000                                                                  04500009
045100     IF RV002-RETURN-COST = 0                                     04510009
045200     OR RV002-PURCH-COST = 0                                      04520009
045300         MOVE 0               TO DL-COST-RETURN-PERCENT           04530009
045400     ELSE                                                         04540009
045500         COMPUTE PV-PERCENT ROUNDED =                             04550009
045600           (RV002-RETURN-COST / RV002-PURCH-COST * 100)           04560009
045700         MOVE PV-PERCENT TO  DL-COST-RETURN-PERCENT               04570009
045800     END-IF.                                                      04580009
045900                                                                  04590009
046000     MOVE RV002-NEGOTIATED-PCT TO DL-NEGOTIATED-PERCENT.          04600009
046100                                                                  04610009
046200******************************************************************04620009
046300* IF BOTH THE RETURN-COST AND THE PURCH-COST = 0 THEN             04630009
046400*    DO NOT PRINT THE RECORD ON THE REPORT, CONTINUE ON TO        04640009
046500*    THE NEXT RECORD.                                             04650009
046600******************************************************************04660009
046700     IF RV002-RETURN-COST = 0 AND RV002-PURCH-COST = 0            04670009
046800         CONTINUE                                                 04680009
046900     ELSE                                                         04690009
047000         PERFORM 8000-PRINT-REPORT-LINE                           04700009
047100***      MOVE SPACES              TO DL-VENDOR-NAME               04710010
047200***                                  DL-RANK-X                    04720010
047300     END-IF.                                                      04730009
047400                                                                  04740009
047500******************************************************************04750009
047600* 2200-NEW-VENDOR -- PERFORMED WHEN THE VENDOR CHANGES            04760009
047700******************************************************************04770009
047800 2200-NEW-VENDOR.                                                 04780009
047900     MOVE PA-VND-PURCHS-COST      TO TL-PURCHS-COST               04790009
048000     MOVE PA-VND-RETURN-COST      TO TL-RETURN-COST               04800009
048100                                                                  04810009
048200     IF PA-VND-RETURN-COST = 0                                    04820009
048300        OR PA-VND-PURCHS-COST = 0                                 04830009
048400         MOVE 0                   TO TL-COST-RETURN-PERCENT       04840009
048500     ELSE                                                         04850009
048600         COMPUTE PV-PERCENT =                                     04860009
048700           ((PA-VND-RETURN-COST / PA-VND-PURCHS-COST) * 100)      04870009
048800         MOVE PV-PERCENT TO TL-COST-RETURN-PERCENT                04880009
048900     END-IF                                                       04890009
049000                                                                  04900009
049100     WRITE DI-DEFECT-ITEM-LINE                                    04910009
049200         FROM TL-TOTAL-LINE-DASHES                                04920009
049300         AFTER ADVANCING 0 LINES                                  04930009
049400                                                                  04940009
049500     WRITE DI-DEFECT-ITEM-LINE                                    04950009
049600         FROM TL-TOTAL-LINE                                       04960009
049700         AFTER ADVANCING 1 LINES                                  04970009
049800                                                                  04980009
049900     ADD +1 TO PV-LINE-COUNT                                      04990009
050000                                                                  05000009
050100     PERFORM 8200-WRITE-BLANK-LINE                                05010009
050200                                                                  05020009
050300     MOVE RV002-VENDOR-DUNNS      TO PV-HOLD-VENDOR-DUNNS         05030009
050400     MOVE RV002-VENDOR-NAME       TO DL-VENDOR-NAME               05040009
050500                                     PV-HOLD-VENDOR-NAME          05050009
050600     IF RV002-ZERO-VENDOR-RANK                                    05060009
050700        MOVE 'N/A'              TO DL-RANK-X                      05070009
050800                                 PV-HOLD-RANK-X                   05080009
050900     ELSE                                                         05090009
051000        IF RV002-UNKOWN-VENDOR-RANK                               05100009
051100           MOVE '    '           TO DL-RANK-X                     05110009
051200                                    PV-HOLD-RANK-X                05120009
051300        ELSE                                                      05130009
051400           MOVE RV002-VENDOR-RANK TO DL-RANK                      05140009
051500                                     PV-HOLD-RANK                 05150009
051600        END-IF                                                    05160009
051700     END-IF.                                                      05170009
051800     MOVE +0                      TO PA-VND-PURCHS-COST           05180009
051900                                     PA-VND-RETURN-COST.          05190009
052000                                                                  05200009
052100******************************************************************05210009
052200* 7000-READ-EXTRACT-FILE.                                        *05220009
052300*  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *05230009
052400*  FLAT FILE.                                                    *05240009
052500******************************************************************05250009
052600 7000-READ-EXTRACT-FILE.                                          05260009
052700     READ RTV-REPORT-EXTRACT                                      05270009
052800         INTO RV002-RETURN-AGREE-EXTRACT-REC                      05280009
052900         AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               05290009
053000                                                                  05300009
053100******************************************************************05310009
053200* 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   05320009
053300* CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT05330009
053400* INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  05340009
053500******************************************************************05350009
053600 8000-PRINT-REPORT-LINE.                                          05360009
053700     ADD +1 TO PV-LINE-COUNT.                                     05370009
053800                                                                  05380009
053900     IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      05390009
054000         PERFORM 8300-WRITE-PAGE-HEADING                          05400009
054100         PERFORM 8400-WRITE-COLUMN-HEADING                        05410009
054200         MOVE PV-HOLD-VENDOR-NAME     TO DL-VENDOR-NAME           05420009
054300         MOVE PV-HOLD-RANK-X          TO DL-RANK-X                05430009
054400     END-IF.                                                      05440009
054500                                                                  05450009
054600     WRITE DI-DEFECT-ITEM-LINE                                    05460009
054700         FROM DL-DETAIL-LINE                                      05470009
054800         AFTER ADVANCING 1 LINES.                                 05480009
054900                                                                  05490009
055000******************************************************************05500009
055100* 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      05510009
055200******************************************************************05520009
055300 8200-WRITE-BLANK-LINE.                                           05530009
055400     WRITE DI-DEFECT-ITEM-LINE                                    05540009
055500         FROM BLANK-LINE                                          05550009
055600         AFTER ADVANCING 1 LINES.                                 05560009
055700                                                                  05570009
055800     ADD +1                        TO PV-LINE-COUNT.              05580009
055900                                                                  05590009
056000******************************************************************05600009
056100* 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR05610009
056200* THE RETURN TO VENDOR REPORT                                     05620009
056300******************************************************************05630009
056400 8300-WRITE-PAGE-HEADING.                                         05640009
056500     ADD +1 TO PV-PAGE-COUNT.                                     05650009
056600     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    05660009
056700                                                                  05670009
056800     WRITE DI-DEFECT-ITEM-LINE                                    05680009
056900         FROM DP132O-STANDRD-HEADER-132-COLS                      05690009
057000         AFTER ADVANCING PAGE.                                    05700009
057100                                                                  05710009
057200     IF PV-QUARTERLY-REPORT                                       05720009
057300         WRITE DI-DEFECT-ITEM-LINE                                05730009
057400             FROM PH2-PAGE-HEADING-QUARTERLY                      05740009
057500             AFTER ADVANCING 1 LINES                              05750009
057600     ELSE                                                         05760009
057700         WRITE DI-DEFECT-ITEM-LINE                                05770009
057800             FROM PH2-PAGE-HEADING-REQUEST                        05780009
057900             AFTER ADVANCING 1 LINES                              05790009
058000     END-IF.                                                      05800009
058100                                                                  05810009
058200     WRITE DI-DEFECT-ITEM-LINE                                    05820009
058300         FROM PH3-PAGE-HEADING-3                                  05830009
058400         AFTER ADVANCING 1 LINES.                                 05840009
058500                                                                  05850009
058600     MOVE +3     TO PV-LINE-COUNT.                                05860009
058700                                                                  05870009
058800     SET PS-NEW-LINE             TO TRUE.                         05880009
058900                                                                  05890009
059000******************************************************************05900009
059100* 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       05910009
059200* THE RETURN TO VENDOR REPORT                                     05920009
059300******************************************************************05930009
059400 8400-WRITE-COLUMN-HEADING.                                       05940009
059500     WRITE DI-DEFECT-ITEM-LINE                                    05950009
059600         FROM DH1-DETAIL-HEADING-1                                05960009
059700         AFTER ADVANCING 2 LINES.                                 05970009
059800                                                                  05980009
059900     WRITE DI-DEFECT-ITEM-LINE                                    05990009
060000         FROM DH2-DETAIL-HEADING-2                                06000009
060100         AFTER ADVANCING 1 LINES.                                 06010009
060200                                                                  06020009
060300     WRITE DI-DEFECT-ITEM-LINE                                    06030009
060400         FROM DHD-DETAIL-HEADING-DASHES                           06040009
060500         AFTER ADVANCING 0 LINES.                                 06050009
060600                                                                  06060009
060700     ADD +3       TO PV-LINE-COUNT.                               06070009
060800                                                                  06080009
060900******************************************************************06090009
061000* 9000-EOJ-ROUTINE - PRINTS THE TOTALS AND CLOSES THE REPORT      06100009
061100*  FILE.                                                          06110009
061200******************************************************************06120009
061300 9000-EOJ-ROUTINE.                                                06130009
061400     MOVE PA-VND-PURCHS-COST  TO TL-PURCHS-COST.                  06140009
061500     MOVE PA-VND-RETURN-COST  TO TL-RETURN-COST.                  06150009
061600                                                                  06160009
061700     IF PA-VND-RETURN-COST = 0                                    06170009
061800     OR PA-VND-PURCHS-COST = 0                                    06180009
061900         MOVE 0               TO TL-COST-RETURN-PERCENT           06190009
062000     ELSE                                                         06200009
062100         COMPUTE PV-PERCENT =                                     06210009
062200           ((PA-VND-RETURN-COST / PA-VND-PURCHS-COST) * 100)      06220009
062300         MOVE PV-PERCENT      TO TL-COST-RETURN-PERCENT           06230009
062400     END-IF.                                                      06240009
062500                                                                  06250009
062600     WRITE DI-DEFECT-ITEM-LINE                                    06260009
062700         FROM TL-TOTAL-LINE-DASHES                                06270009
062800         AFTER ADVANCING 0 LINES.                                 06280009
062900                                                                  06290009
063000     WRITE DI-DEFECT-ITEM-LINE                                    06300009
063100         FROM TL-TOTAL-LINE                                       06310009
063200         AFTER ADVANCING 1 LINES.                                 06320009
063300                                                                  06330009
063400     WRITE DI-DEFECT-ITEM-LINE                                    06340009
063500         FROM END-OF-REPORT-LINE                                  06350009
063600         AFTER ADVANCING 1 LINES.                                 06360009
063700                                                                  06370009
063800     CLOSE DI-DEFECT-ITEM-REPORT                                  06380009
063900           RTV-REPORT-EXTRACT.                                    06390009
064000                                                                  06400009
064100******************************************************************06410009
064200**************************** END OF RVKRP013 *********************06420009
064300******************************************************************06430009
