       IDENTIFICATION DIVISION.                                            CL**4
       PROGRAM-ID.         MLKRP801.                                       CL**4
       AUTHOR.             PAUL KEBER - STRATAGEM.                         CL**4
       INSTALLATION.       KOHLS DEPARTMENT STORE.                         CL**4
       DATE-WRITTEN.       06-01-99.                                       CL**4
       DATE-COMPILED.                                                      CL**4
                                                                           CL**4
      ******************************************************************   CL**4
      *   MLKRP801 - PRODUCE THE VENDOR ANALYSIS MARKET REPORT BY      *        
      *              DEPARTMENT/VENDOR.                                *        
      *   WR# 10587                                                    *        
      ******************************************************************        
      *   READ THE MARKET REPORT DATA FILE AND PRINT THE MARKET REPORT.*   CL**4
      *   THE FILE WILL CONTAIN VENDOR DATA BETWEEN THE FIRST MONTH    *00409000
      *   OF THE CURRENT FISCAL SEASON AND THE CURRENT FISCAL MONTH    *        
      *   OF THE CURRENT FISCAL YEAR.  AN INPUT CONTROL CARD           *        
      *   CONTAINING THE END FISCAL MONTH DATE MAY BE USED TO OVERRIDE *        
      *   THE TMLCNTL AND TDTATTR CURRENT MONTH INFO.  THIS PROGRAM    *00410000
      *   ASSUMES THAT REPORT DATA FILE WILL CONTAIN ONLY 1 RECORD PER *   CL**4
      *   VENDOR.                                                      *   CL**4
      *                                                                *00410000
      *   THE PAGE HEADER WILL DISPLAY THE MONTH NAME AND YEAR OF THE  *00410000
      *   CURRENT FISCAL MONTH OF THE CURRENT FISCAL YEAR (I.E. 'MARCH *        
      *   1999').                                                      *00410000
      *                                                                *00410000
      *   DATA IS PRINTED FOR EACH VENDOR, WITH TOTALS FOR ALL VENDORS *   CL**4
      *   WITHIN THE SAME DEPARTMENT.  GRAND TOTALS ARE PRINTED AT THE *   CL**4
      *   END OF THE REPORT FOR ALL DEPARTMENTS COMBINED.  THE REPORT  *   CL**4
      *   WILL DISPLAY VENDOR DATA FOR THE CURRENT YEAR, AND FOR THE   *   CL**4
      *   SAME MONTH(S) THIS TIME LAST YEAR.  THE DETAIL LINES HEADER  *   CL**4
      *   WILL DISPLAY THE CALENDAR MONTHS DATE RANGE (I.E. 02/1999    *   CL**4
      *   THRU 05/1999).                                               *   CL**4
      *                                                                *   CL**4
      *   THIS REPORT BREAKS BY DEPARTMENT, AND SHOWS THE MANAGER AND  *   CL**4
      *   BUYER NAME FOR EACH DEPARTMENT.                              *   CL**4
      ******************************************************************        
      *   DATE: 06/18/99       CHANGE ID: WR10587    WHO: P. KEBER              
      *   REASON FOR CHANGE : CHANGED FROM YEAR-TO-DATE TO SEASON-TO-           
      *   DATE REPORTING.  CUMM MARKUP PERCENT IS NOW CALCULATED WITH           
      *   DATABASE EXTRACT AMOUNTS.                                             
      *                                                                *        
      *   DATE: 08/19/1999     CHANGE ID: WR10587    WHO: B.MCASEY              
      *   REASON FOR CHANGE : CHANGED REPORT TO SHOW RECEIPT COST/RTL           
      *   AND PURCHASE ADJ COST/RTL INSTEAD OF GROSS COST, COST PURCH           
      *   ADJ, NET COST AND RETAIL PURCHASES.                                   
      *                                                                *        
      *   DATE: 09/09/1999     CHANGE ID: WR10587    WHO: B.MCASEY              
      *   REASON FOR CHANGE : CHANGED REPORT TOTALS TO NOT INCLUDE THE          
      *   UNKNOWN VENDOR IN THE GROSS MARGIN, CUM MARKUP.                       
      *                                                                *        
      *   DATE: 10/18/1999     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : CHANGED REPORT TO NOT INCLUDE UNKNOWN    *        
      *   VENDOR IN THE MISCELLANEOUS TOTALS.                          *        
      *                                                                *        
      *   DATE: 01/06/2000     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : CHANGED REPORT TO ONLY INCLUDE 1999 DATA *        
      *   UNDER THE LAST YEAR COLUMN TOTALS FOR RECEIPTS AND SALES     *        
      *                                                                *        
      *   DATE: 01/08/2001     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : ADDED LOGIC TO FIND THE LAST YEAR DATE   *        
      *   WHEN THE CURRENT YEAR CONTAINS 53 WEEKS. THIS WILL EXECUTE   *        
      *   WHEN DTATTR-LY-THIS-DAY-KY-DTE IS EQUAL TO '9999-09-09' IN   *        
      *   F200-SELECT-CURR-YR-TDTATTR.  THE NEW MODULE IS:             *        
      *   F225-LY-THIS-DTE-53WK.                                       *        
      *                                                                *        
      *   DATE: 01/11/2001     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : CHANGED HEADING DATE TO REFLECT THE      *        
      *   ACTUAL YEAR OF THE MONTH NOT THE FISCAL YEAR.                *        
W02191*                                                                *        
  |   *   DATE: 02/19/2001     CHANGE ID: 99999      WHO: ROD JANSSEN  *        
  |   * CHANGE DATE CONTROL LOGIC TO USE THE POSTING FISCAL MTH DATE   *        
  |   * IN PLACE OF THE OPEN FISCAL MTH DATE.                          *        
W02191******************************************************************        
      ******************************************************************        
      *                                                                    CL**4
       ENVIRONMENT DIVISION.                                               CL**4
                                                                           CL**4
       CONFIGURATION SECTION.                                              CL**4
       SOURCE-COMPUTER.    IBM-3090.                                       CL**4
       OBJECT-COMPUTER.    IBM-3090.                                       CL**4
                                                                           CL**4
       INPUT-OUTPUT SECTION.                                               CL**4
                                                                           CL**4
       FILE-CONTROL.                                                       CL**4
                                                                           CL**4
           SELECT VA-REPORT-EXTRACT-FILE                                   CL**4
               ASSIGN TO INP01.                                            CL**4
                                                                           CL**4
           SELECT MARKET-REPORT                                            CL**4
               ASSIGN TO RPT01.                                            CL**4
                                                                           CL**4
       DATA DIVISION.                                                      CL**4
                                                                           CL**4
       FILE SECTION.                                                       CL**4
                                                                           CL**4
       FD  VA-REPORT-EXTRACT-FILE                                          CL**4
           RECORDING MODE IS F                                             CL**4
           LABEL RECORDS ARE STANDARD                                      CL**4
           RECORD CONTAINS 660 CHARACTERS                                  CL**4
           BLOCK CONTAINS 0 RECORDS                                        CL**4
           DATA RECORD IS VA-REPORT-EXTRACT-RECORD.                     MLKRP801
                                                                           CL**4
       01  VA-REPORT-EXTRACT-RECORD PIC X(660).                            CL*32
                                                                           CL**4
       FD  MARKET-REPORT                                                   CL**4
           RECORDING MODE IS F                                             CL**4
           LABEL RECORDS ARE STANDARD                                      CL**4
           RECORD CONTAINS 200 CHARACTERS                                  CL**4
           BLOCK CONTAINS 0 RECORDS                                        CL**4
           DATA RECORD IS MR-MARKET-REPORT-RECORD.                         CL**4
                                                                           CL**4
       01  MR-MARKET-REPORT-RECORD       PIC X(200).                       CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       WORKING-STORAGE SECTION.                                            CL**4
                                                                           CL**4
       01  PC-PROGRAM-CONSTANTS.                                           CL**4
           05  PC-LINE-MAX                   PIC S9(4)   VALUE +74         CL**4
                                                         COMP SYNC.        CL**4
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'MLKRP801'.MLKRP801
           05  PC-MIN-TOTAL-SALES            PIC S9(11)V99 VALUE +5000  MLKRP803
                                                         COMP-3.        MLKRP803
0999RM     05  PC-UNKNOWN-VENDOR             PIC S9(09) VALUE 5161      MLKRP803
0999RM                                                   COMP.          MLKRP803
           05  PC-MISCELLANEOUS-VENDOR       PIC X(30) VALUE                    
                                             'MISCELLANEOUS'.                   
           05  PC-REPORT-TOTAL               PIC X(30) VALUE                    
                                             'REPORT TOTAL'.                    
           05  PC-1998                       PIC 9(04) VALUE                    
                                             1998.                              
0100RM     05  PC-1999                       PIC 9(04) VALUE                    
0100RM                                       1999.                              
                                                                                
       01  PS-PROGRAM-SUBSCRIPTS.                                          CL**4
           05  PS-SUB                        PIC S9(4)   VALUE ZEROES      CL**4
                                                         COMP SYNC.        CL**4
       01  PS-PROGRAM-SWITCHES.                                            CL**4
           05  PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.       CL**4
               88  PS-INPUT-EOF                           VALUE 'Y'.       CL**4
           05  PS-FIRST-DATAREC-SW           PIC X(1)     VALUE 'Y'.       CL**4
               88  PS-FIRST-DATAREC                       VALUE 'Y'.       CL**4
               88  PS-DONE-WITH-FIRST-DATAREC             VALUE 'N'.       CL**4
           05  PS-FOUND-A-RECORD-SW          PIC X(1)     VALUE 'N'.       CL**4
               88  PS-FOUND-A-RECORD                      VALUE 'Y'.       CL**4
           05  PS-PRINT-DETAIL-IND           PIC X(01)    VALUE 'Y'.            
               88  PS-PRINT-DETAIL                        VALUE 'Y'.            
               88  PS-NO-PRINT-DETAIL                     VALUE 'N'.            
                                                                           CL**4
       01  PV-PROGRAM-VARIABLES.                                           CL**4
           05  PV-PAGE-COUNTER               PIC S9(4)   VALUE ZEROES      CL**4
                                                         COMP SYNC.        CL**4
           05  PV-LINE-COUNTER               PIC S9(4)   VALUE 99          CL**4
                                                         COMP SYNC.        CL**4
           05  PV-IN-COUNTER                 PIC S9(4)   VALUE ZEROES      CL**4
                                                         COMP SYNC.        CL**4
           05  PV-NEW-TOTAL1                 PIC S9(3)V9 VALUE +0          CL**4
                                                         COMP-3.                
           05  PV-NEW-TOTAL2                 PIC S9(8)V9 VALUE +0          CL**4
                                                         COMP-3.                
           05  PV-PERCENT                    PIC S9(3)V9 VALUE +0       MLKRP801
                                                         COMP-3.                
           05  PV-RETAIL-PURCH-LY            PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-RETAIL-PURCH-TY            PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-TOTAL-SALES-LY             PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-TOTAL-SALES-TY             PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-TOTAL-MKDN-LY              PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-TOTAL-MKDN-TY              PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-CUM-TO-DATE-PURCH-RETAIL   PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-CUM-TO-DATE-PURCH-COST     PIC S9(11)V99 VALUE +0     MLKRP801
                                                         COMP-3.        MLKRP801
           05  PV-CAL-LY-END-CCYY            PIC 9(04)   VALUE  0.              
           05  PV-CAL-LY-END-MONTH           PIC 9(02)   VALUE  0.      MLKRP801
           05  PV-CAL-TY-BEG-MONTH           PIC 9(02)   VALUE  0.      MLKRP800
           05  PV-CAL-TY-END-CCYY            PIC 9(04)   VALUE  0.              
           05  PV-CAL-TY-END-MONTH           PIC 9(02)   VALUE  0.      MLKRP801
           05  PV-FISCAL-LY-CCYY             PIC 9(04)   VALUE  0.              
           05  PV-FISCAL-LY-END-MONTH        PIC 9(02)   VALUE  0.      MLKRP801
           05  PV-FISCAL-TY-BEG-MONTH        PIC 9(02)   VALUE  0.      MLKRP800
           05  PV-FISCAL-TY-CCYY             PIC 9(04)   VALUE  0.              
           05  PV-FISCAL-TY-END-MONTH        PIC 9(02)   VALUE  0.      MLKRP801
           05  PV-ALL-DASHES                 PIC X(199)  VALUE ALL '-'.    CL**4
           05  PV-OPN-FSCL-MN-DTE            PIC X(10)   VALUE SPACES.  MLKRP801
0101RM     05  PV-OPN-FSCL-MN-DTE-RDF REDEFINES PV-OPN-FSCL-MN-DTE.             
0101RM         10  PV-OPN-FSCL-MN-CCYY       PIC X(04).                         
0101RM         10  FILLER                    PIC X(06).                         
0101RM     05  PV-INVALID-DATE           PIC X(10)   VALUE '9999-09-09'.MLKRP801
                                                                                
           05  PV-HDG-DATE-TY.                                          MLKRP801
               10  FILLER                PIC X(01)   VALUE ' '.         MLKRP801
               10  PV-HDG-START-MM-TY    PIC 9(02)   VALUE ZEROES.      MLKRP801
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP801
               10  PV-HDG-START-CCYY-TY  PIC 9(04)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(06)   VALUE ' THRU '.    MLKRP801
               10  PV-HDG-END-MM-TY      PIC 9(02)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP801
               10  PV-HDG-END-CCYY-TY    PIC 9(04)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(01)   VALUE ' '.         MLKRP801
           05  PV-HDG-DATE-LY.                                          MLKRP801
               10  FILLER                PIC X(1)    VALUE ' '.         MLKRP801
               10  PV-HDG-START-MM-LY    PIC 9(02)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP801
               10  PV-HDG-START-CCYY-LY  PIC 9(04)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(06)   VALUE ' THRU '.    MLKRP801
               10  PV-HDG-END-MM-LY      PIC 9(02)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP801
               10  PV-HDG-END-CCYY-LY    PIC 9(04)   VALUE 0.           MLKRP801
               10  FILLER                PIC X(01)   VALUE ' '.         MLKRP801
                                                                           CL**4
       01  CC-CONTROL-CARD.                                             MLKRP801
           05  CC-FISCAL-END-DATE                        VALUE SPACES.  MLKRP801
               10  CC-FISCAL-END-YEAR        PIC 9(04).                 MLKRP801
               10  CC-FISCAL-END-DSH1        PIC X(01).                 MLKRP801
               10  CC-FISCAL-END-MONTH       PIC 9(02).                 MLKRP801
               10  CC-FISCAL-END-DSH2        PIC X(01).                 MLKRP801
               10  CC-FISCAL-END-DAY         PIC 9(02).                 MLKRP801
           05  FILLER                        PIC X(01).                         
           05  CC-REPORT-SEQUENCE            PIC X(1)    VALUE SPACES.     CL**4
               88  CC-RETAIL-PURCH-SEQ                   VALUE 'P'.        CL**4
               88  CC-VENDOR-NAME-SEQ                    VALUE 'V'.        CL**4
           05  FILLER                        PIC X(68)   VALUE SPACES.  MLKRP801
      *                                                                 MLKRP801
      *   DETAIL REPORT FILE LAYOUT                                     MLKRP801
           COPY MLRD202.                                                   CL*31
      /                                                                 MLKRP801
      *  KOHL'S STANDARD FIRST HEADING LINE                             MLKRP801
           COPY DPWS200O.                                                  CL**4
                                                                           CL**4
       01  DH-DETAIL-HEADING1.                                             CL**4
           05  FILLER                        PIC X(20)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(44)   VALUE ALL '-'.    CL**4
           05  DH-DATE-RANGE-TY              PIC X(22)   VALUE SPACES.     CL*26
           05  FILLER                        PIC X(43)   VALUE ALL '-'.    CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(22)   VALUE ALL '-'.    CL**4
           05  DH-DATE-RANGE-LY              PIC X(22)   VALUE SPACES.     CL*26
           05  FILLER                        PIC X(23)   VALUE ALL '-'.    CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DH-DETAIL-HEADING2.                                             CL**4
 *******   05  FILLER                        PIC X(25)   VALUE SPACES.     CL**4
W10587*** CHANGED HEADING                                                       
0899RM*    05  FILLER                        PIC X(24)   VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(20)   VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(08) VALUE                    
0899RM                                                     '<-------'.          
0899RM     05  FILLER                        PIC X(08) VALUE                    
0899RM                                                    'RECEIPTS'.           
0899RM     05  FILLER                        PIC X(07) VALUE                    
0899RM                                                     '------>'.           
0899RM     05  FILLER                        PIC X(05) VALUE                    
0899RM                                                     ' <---'.             
0899RM     05  FILLER                        PIC X(09) VALUE                    
0899RM                                                    'PURCHASE '.          
0899RM     05  FILLER                        PIC X(03) VALUE                    
0899RM                                                    'ADJ'.                
0899RM     05  FILLER                        PIC X(05) VALUE                    
0899RM                                                     '---> '.             
0899RM*    05  FILLER                        PIC X(5)    VALUE 'GROSS'.    CL**4
0899RM*    05  FILLER                        PIC X(05)   VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(04)   VALUE 'COST'.     CL**4
0899RM*    05  FILLER                        PIC X(08)   VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(3)    VALUE 'NET'.      CL**4
0899RM*    05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(6)    VALUE             CL**4
0899RM*    'RETAIL'.                                                       CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
W10587*** CHANGED HEADING                                                       
           05  FILLER                        PIC X(7)    VALUE             CL**4
           'NET    '.                                                      CL**4
           05  FILLER                        PIC X(2)   VALUE SPACES.      CL**4
           05  FILLER                        PIC X(5)    VALUE             CL**4
           'CUMM '.                                                        CL**4
           05  FILLER                        PIC X(16)  VALUE SPACES.      CL**4
           05  FILLER                        PIC X(5)    VALUE 'TOTAL'.    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'TOTAL'.    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'GROSS'.    CL**4
           05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(9)    VALUE             CL**4
               'END INVEN'.                                                     
           05  FILLER                        PIC X(1)    VALUE SPACE.      CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(3)    VALUE 'NET'.      CL**4
           05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'RETAIL'.                                                       CL**4
           05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(7)    VALUE             CL**4
           'NET    '.                                                      CL**4
********   05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(11)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'TOTAL'.    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'GROSS'.    CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(9)    VALUE             CL**4
               'END INVEN'.                                                     
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DH-DETAIL-HEADING3.                                             CL**4
********** 05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(8)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'VENDOR'.                                                       CL**4
           05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
W10587*** CHANGED HEADING                                                       
0899RM     05  FILLER                        PIC X(04) VALUE 'COST'.            
0899RM     05  FILLER                        PIC X(06) VALUE SPACE.             
0899RM     05  FILLER                        PIC X(06) VALUE 'RETAIL'.          
0899RM     05  FILLER                        PIC X(08) VALUE SPACE.             
0899RM     05  FILLER                        PIC X(04) VALUE 'COST'.            
0899RM     05  FILLER                        PIC X(06) VALUE SPACE.             
0899RM     05  FILLER                        PIC X(06) VALUE 'RETAIL'.          
0899RM*    05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(9)    VALUE             CL**4
0899RM*    'PURCH ADJ'.                                                    CL**4
0899RM*    05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
0899RM*    05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(9)    VALUE             CL**4
0899RM*    'PURCHASES'.                                                    CL**4
W10587*** CHANGED HEADING                                                       
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKUP %'.                                                       CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'MKUP%'.    CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'SALES'.    CL**4
           05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKDN $'.                                                       CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKDN %'.                                                       CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MRGN %'.                                                       CL**4
           05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(8)    VALUE             CL**4
           ' RETAIL '.                                                     CL**4
           05  FILLER                        PIC X(1)    VALUE SPACE.      CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(9)    VALUE             CL**4
           'PURCHASES'.                                                    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKUP %'.                                                       CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'SALES'.    CL**4
********   05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKDN $'.                                                       CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MRGN %'.                                                       CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE 'RETAIL'.   CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DL-DETAIL-LINE.                                                 CL**4
           05  DL-VENDOR-NAME                PIC X(20)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-GROSS-COST                 PIC ZZZ,ZZ9.9-                CL**4
0899RM     05  DL-RECEIPTS-COST              PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-COST-PURCH-ADJ             PIC ZZZ,ZZ9.9-                CL**4
0899RM     05  DL-RECEIPTS-RETAIL            PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-NET-COST-TY                PIC ZZZ,ZZ9.9-                CL**4
0899RM     05  DL-PURCHASE-ADJ-COST          PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-RETAIL-PURCH-TY            PIC ZZZ,ZZ9.9-                CL**4
0899RM     05  DL-PURCHASE-ADJ-RETAIL        PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-NET-MKUP-PCT-TY            PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  DL-CUMM-MARKUP-PCT-TY         PIC ZZ9.9-  VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  DL-TOTAL-SALES-TY             PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-MKDN-TY              PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-MKDN-PCT-SALES-TY          PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  DL-GROSS-MRGIN-PCT-TY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  DL-INVEN-RTL-DLR-TY           PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-SEPARATOR                  PIC X(1)    VALUE '|'.        CL**4
           05  DL-NET-COST-LY                PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-RETAIL-PURCH-LY            PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-NET-MKUP-PCT-LY            PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-SALES-LY             PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-MKDN-LY              PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
********   05  DL-MKDN-PCT-SALES-LY          PIC ZZ9.9- VALUE ZEROES       CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-GROSS-MRGIN-PCT-LY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-INVEN-RTL-DLR-LY           PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
*******    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
                                                                                
      *-- UNKNOWN VENDOR TOTALS                                            CL**4
0999RM 01  UVDT-UNKN-VNDR-DEPT-TOTALS.                                     CL**4
0999RM     05  UVDT-GROSS-COST                PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-RECEIPTS-COST-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-COST-PURCH-ADJ            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-RECEIPTS-RTL-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-NET-COST-TY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-PRCH-ADJ-COST-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-RETAIL-PURCH-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-PRCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-NET-MKUP-TY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-TOTAL-SALES-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-TOTAL-MKDN-TY             PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-GROSS-MRGIN-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-END-INV-RTL-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-STD-PURCH-COST-TY         PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-STD-PURCH-RTL-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-NET-COST-LY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-RETAIL-PURCH-LY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-NET-MKUP-LY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-TOTAL-SALES-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-TOTAL-MKDN-LY             PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-GROSS-MRGIN-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVDT-END-INV-RTL-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
                                                                           CL**4
       01  MDT-MISC-DEPT-TOTALS.                                           CL**4
           05  MDT-GROSS-COST                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  MDT-RECEIPTS-COST-TY          PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-COST-PURCH-ADJ            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  MDT-RECEIPTS-RTL-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-NET-COST-TY               PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  MDT-PRCH-ADJ-COST-TY          PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-RETAIL-PURCH-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  MDT-PRCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-NET-MKUP-TY               PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-NET-MKUP-PCT-TY           PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  MDT-CUMM-MKUP-PCT-TY          PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  MDT-TOTAL-SALES-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-TOTAL-MKDN-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-MKDN-PCT-SALES-TY         PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  MDT-GROSS-MRGIN-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-GROSS-MRGIN-PCT-TY        PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  MDT-MISC-END-INV-RTL-TY       PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-CUM-TO-DATE-PURCH-COST-TY PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-CUM-TO-DATE-PURCH-RTL-TY  PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-NET-COST-LY               PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-RETAIL-PURCH-LY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-NET-MKUP-LY               PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-NET-MKUP-PCT-LY           PIC S9(3)V9   VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-TOTAL-SALES-LY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
*********  05  MDT-MKDN-PCT-SALES-LY         PIC S9(3)V9   VALUE 0         CL**4
           05  MDT-TOTAL-MKDN-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-GROSS-MRGIN-LY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-GROSS-MRGIN-PCT-LY        PIC S9(3)V9   VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  MDT-END-INV-RTL-LY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
                                                                           CL**4
       01  DT-DEPT-TOTALS.                                                 CL**4
           05  DT-GROSS-COST                 PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-COST-PURCH-ADJ             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-NET-COST-TY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-RETAIL-PURCH-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  DT-RECEIPTS-COST-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  DT-RECEIPTS-RTL-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  DT-PRCH-ADJ-COST-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  DT-PRCH-ADJ-RTL-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-NET-MKUP-TY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-NET-MKUP-PCT-TY            PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  DT-CUMM-MKUP-PCT-TY           PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  DT-TOTAL-SALES-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-TOTAL-MKDN-TY              PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-MKDN-PCT-SALES-TY          PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  DT-GROSS-MRGIN-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-GROSS-MRGIN-PCT-TY         PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  DT-END-INV-RTL-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-CUM-TO-DATE-PURCH-COST-TY  PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-CUM-TO-DATE-PURCH-RETAIL-TY PIC S9(11)V99 VALUE 0        CL**4
                                                          COMP-3.          CL**4
           05  DT-NET-COST-LY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-RETAIL-PURCH-LY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-NET-MKUP-LY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-NET-MKUP-PCT-LY            PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  DT-TOTAL-SALES-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
*********  05  DT-MKDN-PCT-SALES-LY          PIC S9(3)V9   VALUE 0         CL**4
           05  DT-TOTAL-MKDN-LY              PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-GROSS-MRGIN-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-GROSS-MRGIN-PCT-LY         PIC S9(3)V9   VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  DT-END-INV-RTL-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
                                                                           CL**4
                                                                           CL**4
       01  GT-GRAND-TOTALS.                                                CL**4
           05  GT-GROSS-COST                 PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-COST-PURCH-ADJ             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-COST-TY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-RETAIL-PURCH-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  GT-RECEIPTS-COST-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  GT-RECEIPTS-RTL-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  GT-PRCH-ADJ-COST-TY           PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
0899RM     05  GT-PRCH-ADJ-RTL-TY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-TY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-PCT-TY            PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  GT-CUMM-MKUP-PCT-TY           PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-SALES-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-MKDN-TY              PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-MKDN-PCT-SALES-TY          PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-PCT-TY         PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  GT-END-INV-RTL-TY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-CUM-TO-DATE-PURCH-COST-TY  PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-CUM-TO-DATE-PURCH-RETAIL-TY PIC S9(11)V99 VALUE 0        CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-COST-LY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-RETAIL-PURCH-LY            PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-LY                PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-PCT-LY            PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-SALES-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-MKDN-LY              PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
*******    05  GT-MKDN-PCT-SALES-LY          PIC S9(3)V9  VALUE 0          CL**4
*******                                                   COMP-3.          CL**4
           05  GT-GROSS-MRGIN-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-PCT-LY         PIC S9(3)V9  VALUE 0          CL**4
                                                          COMP-3.          CL**4
           05  GT-END-INV-RTL-LY             PIC S9(11)V99 VALUE 0         CL**4
                                                          COMP-3.          CL**4
                                                                           CL**4
      *-- UNKNOWN VENDOR TOTALS                                            CL**4
0999RM 01  UVGT-UNKNOWN-VNDR-GRAND-TOTALS.                                 CL**4
0999RM     05  UVGT-GROSS-COST                PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RECEIPTS-COST-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-COST-PURCH-ADJ            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RECEIPTS-RTL-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-COST-TY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-PRCH-ADJ-COST-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RETAIL-PURCH-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-PRCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-MKUP-TY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-SALES-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-MKDN-TY             PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-GROSS-MRGIN-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-END-INV-RTL-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-STD-PURCH-COST-TY         PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-STD-PURCH-RTL-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-COST-LY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RETAIL-PURCH-LY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-MKUP-LY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-SALES-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-MKDN-LY             PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-GROSS-MRGIN-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-END-INV-RTL-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
                                                                                
       01  GTL-GRAND-TOTAL-LINE-1.                                         CL**4
           05  FILLER                        PIC X(7)    VALUE SPACES.     CL**4
           05  GTL-TOTAL                     PIC X(13)   VALUE             CL**4
           'GRAND TOTAL :'.                                                CL**4
           05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
0899RM*    05  GTL-RECEIPTS-COST             PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM     05  GTL-RECEIPTS-RETAIL           PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
0899RM*    05  GTL-RETAIL-PURCH-TY           PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM     05  GTL-PURCHASE-ADJ-RETAIL       PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
           05  GTL-CUMM-MARKUP-PCT-TY        PIC ZZ9.9-  VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
           05  GTL-TOTAL-MKDN-TY             PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
           05  GTL-GROSS-MRGIN-PCT-TY        PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(11)   VALUE SPACES.     CL**4
           05  GTL-NET-COST-LY               PIC ZZ,ZZZ,ZZZ.Z-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-NET-MKUP-PCT-LY           PIC ZZZ.Z- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
           05  GTL-TOTAL-MKDN-LY             PIC ZZ,ZZZ,ZZZ.Z-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(05)   VALUE SPACES.     CL**4
           05  GTL-INVEN-RTL-DLR-LY          PIC ZZ,ZZZ,ZZZ.Z-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  GTL-GRAND-TOTAL-LINE-2.                                         CL**4
           05  FILLER                        PIC X(18)   VALUE SPACES.     CL**4
0899RM*    05  GTL-GROSS-COST                PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM     05  GTL-RECEIPTS-COST             PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
0899RM*    05  GTL-NET-COST-TY               PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM     05  GTL-PURCHASE-ADJ-COST         PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-NET-MKUP-PCT-TY           PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(7)    VALUE SPACES.     CL**4
           05  GTL-TOTAL-SALES-TY            PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-MKDN-PCT-SALES-TY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(7)    VALUE SPACES.     CL**4
           05  GTL-INVEN-RTL-DLR-TY          PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
           05  GTL-RETAIL-PURCH-LY           PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  GTL-TOTAL-SALES-LY            PIC ZZ,ZZZ,ZZZ.Z-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-GROSS-MRGIN-PCT-LY        PIC ZZZ.Z- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(11)   VALUE SPACES.     CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING1.                                                CL**4
           05  FILLER                        PIC X(92)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(15)   VALUE             CL**4
           'VENDOR ANALYSIS'.                                              CL**4
           05  FILLER                        PIC X(93)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING2.                                                CL**4
           05  FILLER                        PIC X(87)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(27)   VALUE             CL**4
           'MARKET REPORT BY DEPARTMENT'.                                  CL**4
           05  FILLER                        PIC X(86)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING3.                                                CL**4
           05  FILLER                        PIC X(88)   VALUE SPACES.     CL**4
           05  SH-SEQUENCE                   PIC X(24)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(88)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(90)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING4.                                                CL**4
           05  FILLER                        PIC X(92)   VALUE SPACES.     CL**4
           05  SH-MONTH                      PIC X(9)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE SPACE.      CL**4
           05  SH-YEAR                       PIC X(4)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(94)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING5.                                                CL**4
           05  FILLER                        PIC X(11)   VALUE             CL**4
           'MANAGER :  '.                                                  CL**4
           05  SH-MANAGER-NMBR               PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(3)    VALUE ' - '.      CL**4
           05  SH-MANAGER-NAME               PIC X(30)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(154)  VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING6.                                                CL**4
           05  FILLER                        PIC X(10)   VALUE             CL**4
           'BUYER   : '.                                                   CL**4
           05  SH-BUYER-NMBR                 PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(3)    VALUE ' - '.      CL**4
           05  SH-BUYER-NAME                 PIC X(30)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(154)  VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING7.                                                CL**4
           05  FILLER                        PIC X(10)   VALUE             CL**4
           'DEPT    : '.                                                   CL**4
           05  SH-DEPT-NMBR                  PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(3)    VALUE ' - '.      CL**4
           05  SH-DEPT-DESC                  PIC X(25)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(159)  VALUE SPACES.          
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SL-SPECIAL-LINE.                                                CL**4
           05  FILLER                        PIC X(130)  VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(69)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SV-SAVE-VENDOR-INFO.                                            CL**4
           05  SV-DEPT-NMBR                  PIC X(3)    VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  TL-TOTAL-LINE.                                                  CL**4
*******    05  FILLER                        PIC X(13)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  TL-TOTAL                      PIC X(7)    VALUE             CL**4
           'TOTAL :'.                                                      CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  TL-GROSS-COST                 PIC ZZZZ,ZZ9.9-               CL**4
0899RM     05  TL-RECEIPTS-COST              PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
0899RM*    05  TL-COST-PURCH-ADJ             PIC ZZZZ,ZZ9.9-               CL**4
0899RM     05  TL-RECEIPTS-RETAIL            PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
0899RM*    05  TL-NET-COST-TY                PIC ZZZZ,ZZ9.9-               CL**4
0899RM     05  TL-PURCHASE-ADJ-COST          PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
0899RM*    05  TL-RETAIL-PURCH-TY            PIC ZZZZ,ZZ9.9-               CL**4
0899RM     05  TL-PURCHASE-ADJ-RETAIL        PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-NET-MKUP-PCT-TY            PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  TL-CUMM-MARKUP-PCT-TY         PIC ZZ9.9-  VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-TOTAL-SALES-TY             PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  TL-TOTAL-MKDN-TY              PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-MKDN-PCT-SALES-TY          PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  TL-GROSS-MRGIN-PCT-TY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-INVEN-RTL-DLR-TY           PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-NET-COST-LY                PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  TL-RETAIL-PURCH-LY            PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-NET-MKUP-PCT-LY            PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  TL-TOTAL-SALES-LY             PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  TL-TOTAL-MKDN-LY              PIC ZZZZ,ZZ9.9-                    
                                                        VALUE ZEROES            
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  TL-GROSS-MRGIN-PCT-LY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  TL-INVEN-RTL-DLR-LY           PIC ZZZZ,ZZ9.9-               CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
       01  ABEND-AREAS.                                                         
           05  ABEND-CODE              PIC S9(04)  VALUE ZERO                   
                                                   COMP SYNC.                   
               88  AC-BAD-CONTROL-CARD             VALUE +4003.                 
               88  AC-DB2-ERROR                    VALUE +4013.                 
           05  AA-ABEND-LIT            PIC X(40)   VALUE                        
                 '*****       ABEND'.                                           
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                        
                   '*****   PROGRAM: MLKRP801'.                                 
           05  AA-PARAGRAPH-LIT.                                                
               10  FILLER              PIC X(17)   VALUE                        
                   '***** PARAGRAPH: '.                                         
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.                
           05  AA-MESSAGE-LINE.                                                 
               10  FILLER              PIC X(06)   VALUE '*****'.               
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.                
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                        
                   '*****    DB2 ERROR'.                                        
           05  AA-DB2-OPERATION-LIT.                                            
               10  FILLER              PIC X(17)   VALUE                        
                   '***** OPERATION: '.                                         
               10  AA-DB2-OPERATION.                                            
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.                
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.                
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.                
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
      *  DB2 ERROR MESSAGES FORMAT AREA.                                        
      ******************************************************************        
           COPY DPWS004.                                                        
                                                                                
      ******************************************************************        
      *  DB2 ERRORS                                                             
      ******************************************************************        
           COPY SQLCA2.                                                         
                                                                                
      ******************************************************************        
      *  DB2 MLCNTL TABLE LAYOUT                                                
      ******************************************************************        
           EXEC SQL                                                             
                INCLUDE TMLCNTL                                                 
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  DB2 DTATTR TABLE LAYOUT                                                
      ******************************************************************        
           EXEC SQL                                                             
                INCLUDE TDTATTR                                                 
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  DB2 COMMUNICATION AREA                                                 
      ******************************************************************        
           EXEC SQL                                                             
                INCLUDE SQLCA                                                   
           END-EXEC.                                                            
                                                                                
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       EJECT                                                               CL**4
      *                                                                    CL**4
       PROCEDURE DIVISION.                                                 CL**4
                                                                           CL**4
       A100-MAIN-MODULE.                                                   CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    OPEN ALL FILES.                                                 CL**4
      *    INITIALIZE PAGE HEADINGS AND PRINT THEM.                        CL**4
      *    PROCESS AND PRINT RECORDS ON MARKET REPORT FILE.                CL**4
      *    PRINT THE DEPT TOTALS FOR LAST DEPT.                            CL**4
      *    PRINT THE GRAND TOTALS FOR ALL DEPTS.                           CL**4
      *    CLOSE ALL FILES.                                                CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           OPEN INPUT  VA-REPORT-EXTRACT-FILE                              CL**4
                OUTPUT MARKET-REPORT.                                      CL**4
                                                                           CL**4
           PERFORM B100-INITIALIZE-HEADER.                                 CL**4
                                                                           CL**4
           PERFORM B200-PROCESS-AND-PRINT                                  CL**4
               UNTIL PS-INPUT-EOF.                                         CL**4
                                                                           CL**4
           IF PV-IN-COUNTER > 0                                            CL**4
               PERFORM E200-MISC-VENDOR-DETAIL                                  
               PERFORM C400-DEPT-TOTAL-PCT                                 CL**4
               PERFORM C200-DEPT-TOTALS                                    CL**4
               PERFORM B300-GRAND-TOTAL-PCT                                CL**4
               PERFORM B400-GRAND-TOTALS                                   CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           CLOSE VA-REPORT-EXTRACT-FILE                                    CL**4
                 MARKET-REPORT.                                            CL**4
                                                                           CL**4
           STOP RUN.                                                       CL**4
                                                                           CL**4
       B100-INITIALIZE-HEADER.                                             CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE STANDARD PAGE HEADER.                                CL**4
      *    ACCEPT THE CONTROL CARD AND GET THE RUN DATE INFO FROM          CL**4
      *    THE TMLCNTL AND TDTATTR DB2 TABLES.                                  
      *    PRINT PAGE HEADERS.                                             CL**4
      *    IF FIRST RECORD WAS A HEADER RECORD, READ THE NEXT RECORD.      CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE FUNCTION CURRENT-DATE (3:2) TO DP200O-RUN-YEAR.         MLKRP801
           MOVE FUNCTION CURRENT-DATE (5:2) TO DP200O-RUN-MONTH.        MLKRP801
           MOVE FUNCTION CURRENT-DATE (7:2) TO DP200O-RUN-DAY.          MLKRP801
           MOVE FUNCTION CURRENT-DATE (9:2) TO DP200O-RUN-HOUR.         MLKRP801
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP200O-RUN-MINUTE.      MLKRP801
           MOVE PC-PROGRAM-NAME TO DP200O-PROGRAM-NAME.                    CL**4
                                                                           CL**4
           ACCEPT CC-CONTROL-CARD.                                      MLKRP801
                                                                           CL**4
           IF (NOT CC-RETAIL-PURCH-SEQ) AND                                CL**4
              (NOT CC-VENDOR-NAME-SEQ)                                     CL**4
               SET AC-BAD-CONTROL-CARD TO TRUE                                  
               DISPLAY 'INVALID INPUT CONTROL CARD REPORT SEQUENCE'             
               DISPLAY '** ABEND IN PGM  ', PC-PROGRAM-NAME                     
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           END-IF.                                                         CL**4
           IF CC-RETAIL-PURCH-SEQ                                          CL**4
               MOVE 'RETAIL PURCHASE SEQUENCE' TO SH-SEQUENCE              CL**4
               MOVE 2 TO DP200O-REPORT-NUMBER                              CL**4
           ELSE                                                            CL**4
               MOVE '  VENDOR NAME SEQUENCE  ' TO SH-SEQUENCE              CL**4
               MOVE 1 TO DP200O-REPORT-NUMBER                              CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           IF CC-FISCAL-END-DATE = SPACES                               MLKRP801
               PERFORM F100-SELECT-TMLCNTL                                      
W02191*****    DISPLAY 'USING TMLCNTL OPEN FISCAL MONTH END DATE: '             
W02191         DISPLAY 'USING TMLCNTL PSTG FISCAL MONTH END DATE: '             
                        PV-OPN-FSCL-MN-DTE                                      
           ELSE                                                         MLKRP801
               DISPLAY 'USING INPUT CONTROL CARD FISCAL END DATE: '             
                        CC-CONTROL-CARD                                 MLKRP801
               IF CC-FISCAL-END-YEAR IS NUMERIC                         MLKRP801
                 AND CC-FISCAL-END-DSH1 = '-'                           MLKRP801
                 AND CC-FISCAL-END-MONTH IS NUMERIC                     MLKRP801
                 AND CC-FISCAL-END-DSH2 = '-'                           MLKRP801
                 AND CC-FISCAL-END-DAY IS NUMERIC                       MLKRP801
                   MOVE CC-FISCAL-END-DATE TO PV-OPN-FSCL-MN-DTE                
               ELSE                                                     MLKRP801
                   SET AC-BAD-CONTROL-CARD TO TRUE                              
                   DISPLAY 'INVALID INPUT CONTROL CARD FISCAL END DATE'         
                   DISPLAY '** ABEND IN PGM  ', PC-PROGRAM-NAME                 
                   CALL 'ILBOABN0' USING ABEND-CODE                             
               END-IF                                                   MLKRP801
           END-IF.                                                      MLKRP801
                                                                        MLKRP801
           PERFORM F200-SELECT-CURR-YR-TDTATTR.                                 
           DISPLAY '*** CURRENT FISCAL YEAR NUMBER IS:  '                       
                 DTATTR-FSCL-YR-NBR.                                            
           DISPLAY '*** CURRENT FISCAL MONTH NUMBER IS: '                       
                 DTATTR-FSCL-MN-NBR.                                            
                                                                        MLKRP801
           MOVE DTATTR-FSCL-MN-NM         TO SH-MONTH.                     CL**4
0101RM*** MADE THE FOLLOWING CHANGE BECAUSE IN JANUARY THE YEAR PRINTING        
0101RM*** WAS THE CALENDAR YEAR NOT THE FISCAL YEAR.                            
0101RM*    MOVE DTATTR-FSCL-YR-NBR        TO SH-YEAR.                      CL**4
0101RM     MOVE PV-OPN-FSCL-MN-CCYY       TO SH-YEAR.                           
                                                                           CL**4
           PERFORM F250-SELECT-TY-SEA-BEG-TDTATTR.                              
           DISPLAY '*** CURRENT SEASON FISCAL MONTH NUMBER IS: '                
                 DTATTR-FSCL-MN-NBR.                                            
                                                                        MLKRP800
           PERFORM F300-SELECT-LAST-YR-TDTATTR.                                 
           DISPLAY '*** LAST FISCAL YEAR NUMBER IS:  '                          
                 DTATTR-FSCL-YR-NBR.                                            
           DISPLAY '*** LAST FISCAL MONTH NUMBER IS: '                          
                 DTATTR-FSCL-MN-NBR.                                            
                                                                        MLKRP801
           PERFORM B150-MONTHLY-RUN-HSKPG.                              MLKRP801
                                                                        MLKRP801
           INITIALIZE DL-DETAIL-LINE.                                      CL**4
                                                                           CL**4
           PERFORM Z200-PRINT-HEADERS.                                     CL**4
                                                                           CL**4
           MOVE '|' TO DL-SEPARATOR.                                       CL**4
                                                                           CL**4
           PERFORM Z100-READ-REPORT-DATA.                                  CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       B150-MONTHLY-RUN-HSKPG.                                          MLKRP801
      ******************************************************************MLKRP801
      *   B150-MONTH-RUN-HSPKG.                                        *MLKRP801
      *   DOES THE FOLLOWING:                                          *MLKRP801
      *      1.  SET-UP HEADING LINE                                   *MLKRP801
      *                                                                *MLKRP801
      *   PERFORMED BY: B100-INITIALIZE-HEADER.                        *MLKRP801
      ******************************************************************MLKRP801
                                                                        MLKRP801
           ADD 1 TO PV-FISCAL-TY-END-MONTH                              MLKRP801
                 GIVING PV-CAL-TY-END-MONTH.                                    
           IF PV-CAL-TY-END-MONTH = 13                                          
               MOVE 1 TO PV-CAL-TY-END-MONTH                                    
               ADD 1 TO PV-FISCAL-TY-CCYY                               MLKRP801
                     GIVING PV-CAL-TY-END-CCYY                                  
           ELSE                                                                 
               MOVE PV-FISCAL-TY-CCYY TO PV-CAL-TY-END-CCYY             MLKRP801
           END-IF.                                                              
                                                                        MLKRP801
           ADD 1 TO PV-FISCAL-TY-BEG-MONTH                              MLKRP800
                 GIVING PV-CAL-TY-BEG-MONTH.                                    
                                                                        MLKRP800
           ADD 1 TO PV-FISCAL-LY-END-MONTH                              MLKRP801
                 GIVING PV-CAL-LY-END-MONTH.                                    
           IF PV-CAL-LY-END-MONTH = 13                                          
               MOVE 1 TO PV-CAL-LY-END-MONTH                                    
               ADD 1 TO PV-FISCAL-LY-CCYY                               MLKRP801
                     GIVING PV-CAL-LY-END-CCYY                                  
           ELSE                                                                 
               MOVE PV-FISCAL-LY-CCYY TO PV-CAL-LY-END-CCYY             MLKRP801
           END-IF.                                                              
                                                                        MLKRP801
           MOVE PV-CAL-TY-BEG-MONTH      TO PV-HDG-START-MM-TY          MLKRP801
                                            PV-HDG-START-MM-LY.         MLKRP801
           MOVE PV-FISCAL-TY-CCYY        TO PV-HDG-START-CCYY-TY.       MLKRP801
           MOVE PV-FISCAL-LY-CCYY        TO PV-HDG-START-CCYY-LY.       MLKRP801
                                                                        MLKRP801
           MOVE PV-CAL-TY-END-MONTH      TO PV-HDG-END-MM-TY.           MLKRP801
           MOVE PV-CAL-LY-END-MONTH      TO PV-HDG-END-MM-LY.           MLKRP801
           MOVE PV-CAL-TY-END-CCYY       TO PV-HDG-END-CCYY-TY.         MLKRP801
           MOVE PV-CAL-LY-END-CCYY       TO PV-HDG-END-CCYY-LY.         MLKRP801
           MOVE PV-HDG-DATE-TY           TO DH-DATE-RANGE-TY.              CL*26
           MOVE PV-HDG-DATE-LY           TO DH-DATE-RANGE-LY.              CL*26
                                                                        MLKRP801
       EJECT                                                               CL**4
                                                                           CL**4
       B200-PROCESS-AND-PRINT.                                             CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    IF WE ENCOUNTER A NEW DEPT, PRINT THE DEPARTMENT TOTALS         CL**4
      *    FOR THE LAST DEPARTMENT AND PRINT PAGE HEADERS.                 CL**4
      *                                                                    CL**4
      *    PRINT DETAIL FOR THE CURRENT VENDOR AND READ THE NEXT           CL**4
      *    INPUT RECORD.                                                   CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           IF PS-FIRST-DATAREC                                             CL**4
               PERFORM Z250-PRINT-HEADERS2                                 CL**4
               SET PS-DONE-WITH-FIRST-DATAREC TO TRUE                      CL**4
               MOVE ML202-DEPT-NBR TO SV-DEPT-NMBR                         CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           IF ML202-DEPT-NBR NOT EQUAL SV-DEPT-NMBR                        CL**4
               PERFORM E200-MISC-VENDOR-DETAIL                                  
               PERFORM C400-DEPT-TOTAL-PCT                                 CL**4
               PERFORM C200-DEPT-TOTALS                                    CL**4
               PERFORM Z200-PRINT-HEADERS                                  CL**4
               PERFORM Z250-PRINT-HEADERS2                                 CL**4
               MOVE ML202-DEPT-NBR TO SV-DEPT-NMBR                         CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           PERFORM C100-NEW-ENT-ID.                                        CL**4
                                                                           CL**4
           PERFORM Z100-READ-REPORT-DATA.                                  CL**4
                                                                           CL**4
           EJECT                                                           CL**4
                                                                           CL**4
       B300-GRAND-TOTAL-PCT.                                               CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    DETERMINE THE GRAND TOTALS FOR THE PERCENTAGE FIELDS USING      CL**4
      *    THE GRAND TOTALS ALREADY CALCULATED.                            CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      ****************************************************************     CL**4
                                                                           CL**4
0999RM     INITIALIZE GTL-GRAND-TOTAL-LINE-1.                              CL**4
0999RM     INITIALIZE GTL-GRAND-TOTAL-LINE-2.                              CL**4
                                                                                
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               GT-NET-MKUP-TY * 100                                        CL**4
             / GT-RETAIL-PURCH-TY                                          CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-NET-MKUP-PCT-TY.                       CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               GT-NET-MKUP-LY * 100                                        CL**4
             / GT-RETAIL-PURCH-LY                                          CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-NET-MKUP-PCT-LY.                       CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
             ( GT-CUM-TO-DATE-PURCH-RETAIL-TY                                   
             - GT-CUM-TO-DATE-PURCH-COST-TY ) * 100.00                          
             / GT-CUM-TO-DATE-PURCH-RETAIL-TY                           MLKRP801
               ON SIZE ERROR                                            MLKRP801
                   MOVE 100 TO PV-NEW-TOTAL1.                           MLKRP801
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-CUMM-MKUP-PCT-TY.                      CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
0999RM*        GT-TOTAL-MKDN-TY * 100 / GT-TOTAL-SALES-TY                  CL**4
0999RM       ((UVGT-TOTAL-MKDN-TY + GT-TOTAL-MKDN-TY) * 100)               CL**4
0999RM      / (UVGT-TOTAL-SALES-TY + GT-TOTAL-SALES-TY)                    CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-MKDN-PCT-SALES-TY.                     CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               GT-GROSS-MRGIN-TY * 100 / GT-TOTAL-SALES-TY                 CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-GROSS-MRGIN-PCT-TY.                    CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               GT-GROSS-MRGIN-LY * 100 / GT-TOTAL-SALES-LY                 CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-GROSS-MRGIN-PCT-LY.                    CL**4
                                                                           CL**4
       B400-GRAND-TOTALS.                                                  CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE GRAND TOTALS AND PRINT.          CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      ****************************************************************     CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*                 GT-GROSS-COST / 1000.00.                           CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-GROSS-COST.                   CL**4
                                                                                
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            GT-RECEIPTS-COST-TY / 1000.00.                               
0899RM            (UVGT-RECEIPTS-COST-TY + GT-RECEIPTS-COST-TY)                 
0899RM           / 1000.00.                                                     
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-RECEIPTS-COST.                CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        GT-COST-PURCH-ADJ   / 1000.00.                              CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-COST-PURCH-ADJ.               CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            GT-RECEIPTS-RTL-TY / 1000.00.                                
0899RM            (UVGT-RECEIPTS-RTL-TY + GT-RECEIPTS-RTL-TY)                   
0899RM           / 1000.00.                                                     
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-RECEIPTS-RETAIL.              CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*                 GT-NET-COST-TY / 1000.00.                          CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-NET-COST-TY.                  CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            GT-PRCH-ADJ-COST-TY / 1000.00.                               
0899RM            (UVGT-PRCH-ADJ-COST-TY + GT-PRCH-ADJ-COST-TY)                 
0899RM           / 1000.00.                                                     
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-PURCHASE-ADJ-COST.            CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*                 GT-RETAIL-PURCH-TY / 1000.00.                      CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-RETAIL-PURCH-TY.              CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*             GT-PRCH-ADJ-RTL-TY / 1000.00.                               
0999RM            (UVGT-PRCH-ADJ-RTL-TY + GT-PRCH-ADJ-RTL-TY)                   
0899RM           / 1000.00.                                                     
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-PURCHASE-ADJ-RETAIL.          CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*        GT-TOTAL-SALES-TY   / 1000.00.                              CL**4
0999RM            (UVGT-TOTAL-SALES-TY + GT-TOTAL-SALES-TY)                CL**4
0899RM           / 1000.00.                                                     
                                                                           CL**4
           MOVE PV-NEW-TOTAL2         TO GTL-TOTAL-SALES-TY.               CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*        GT-TOTAL-MKDN-TY    / 1000.00.                              CL**4
0999RM            (UVGT-TOTAL-MKDN-TY + GT-TOTAL-MKDN-TY)                  CL**4
0899RM           / 1000.00.                                                     
                                                                           CL**4
           MOVE PV-NEW-TOTAL2         TO GTL-TOTAL-MKDN-TY.                CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*        GT-END-INV-RTL-TY / 1000.00.                                CL**4
0999RM           (UVGT-END-INV-RTL-TY + GT-END-INV-RTL-TY)                 CL**4
0999RM           / 1000.00.                                                     
                                                                           CL**4
           MOVE PV-NEW-TOTAL2         TO GTL-INVEN-RTL-DLR-TY.             CL**4
                                                                           CL**4
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                     GT-NET-COST-LY / 1000.00.                      CL**4
0999RM                (UVGT-NET-COST-LY + GT-NET-COST-LY)                  CL**4
0999RM               / 1000.00                                             CL**4
0999RM         END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2     TO GTL-NET-COST-LY                   CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                     GT-RETAIL-PURCH-LY / 1000.00.                  CL**4
0999RM                (UVGT-RETAIL-PURCH-LY + GT-RETAIL-PURCH-LY)          CL**4
0999RM              / 1000.00                                              CL**4
0999RM         END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2     TO GTL-RETAIL-PURCH-LY               CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*            GT-TOTAL-SALES-LY / 1000.00.                            CL**4
0999RM                (UVGT-TOTAL-SALES-LY + GT-TOTAL-SALES-LY)            CL**4
0999RM               / 1000.00                                             CL**4
0999RM         END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2     TO GTL-TOTAL-SALES-LY                CL**4
               MOVE GT-NET-MKUP-PCT-LY TO GTL-NET-MKUP-PCT-LY              CL**4
0100RM*** OMIT THE FOLLOWING LAST YEAR FIELDS FOR 1999 FROM THE REPORT          
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
0999RM*                GT-TOTAL-MKDN-LY / 1000.00.                         CL**4
0999RM                    (UVGT-TOTAL-MKDN-LY + GT-TOTAL-MKDN-LY)          CL**4
0999RM                   / 1000.00                                         CL**4
0999RM             END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL2 TO GTL-TOTAL-MKDN-LY                 CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
0999RM*                GT-END-INV-RTL-LY / 1000.00.                        CL**4
0999RM                    (UVGT-END-INV-RTL-LY + GT-END-INV-RTL-LY)        CL**4
0999RM                   / 1000.00                                         CL**4
0999RM             END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL2         TO GTL-INVEN-RTL-DLR-LY      CL**4
                   MOVE GT-GROSS-MRGIN-PCT-LY TO                           CL**4
                        GTL-GROSS-MRGIN-PCT-LY                             CL**4
0100RM         END-IF                                                      CL**4
0999RM     END-IF.                                                         CL**4
                                                                                
                                                                           CL**4
           MOVE GT-NET-MKUP-PCT-TY    TO GTL-NET-MKUP-PCT-TY.              CL**4
           MOVE GT-CUMM-MKUP-PCT-TY   TO GTL-CUMM-MARKUP-PCT-TY.           CL**4
           MOVE GT-MKDN-PCT-SALES-TY  TO GTL-MKDN-PCT-SALES-TY.            CL**4
           MOVE GT-GROSS-MRGIN-PCT-TY TO GTL-GROSS-MRGIN-PCT-TY.           CL**4
                                                                           CL**4
           PERFORM Z450-PRINT-GRAND-TOTALS.                                CL**4
                                                                           CL**4
       C100-NEW-ENT-ID.                                                    CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP AND PRINT THE DETAIL LINE.                               CL**4
      *    CHECK IF A NEW PAGE HEADER IS REQUIRED.                         CL**4
      *    UPDATE THE DEPT TOTALS FROM THE CURRENT VENDOR.                 CL**4
      *    INITIALIZE THE DETAIL LINES.                                    CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      *    PERFORMED BY B200-PROCESS-AND-PRINT.                            CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           PERFORM D100-MOVE-TO-DETAIL.                                    CL**4
                                                                           CL**4
           PERFORM D300-CHECK-DETAIL-GT-ZERO.                                   
0999RM*-- IF LAST YEAR IS 1998, DO NOT CHECK LAST YEAR SALES            MLKRP800
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         IF PS-PRINT-DETAIL                                               
0999RM             IF PV-TOTAL-SALES-TY > PC-MIN-TOTAL-SALES            MLKRP800
1099RM             OR (ML202-ENT-ID = PC-UNKNOWN-VENDOR)                        
0999RM                 PERFORM Z300-PRINT-DETAIL                               C
0999RM                 ADD 2 TO PV-LINE-COUNTER                                C
0999RM             ELSE                                                         
0999RM                 PERFORM E100-ADD-MISC-VENDOR                            C
0999RM             END-IF                                                       
0999RM         END-IF                                                           
0999RM     ELSE                                                                 
               IF PS-PRINT-DETAIL                                               
                   IF PV-TOTAL-SALES-TY > PC-MIN-TOTAL-SALES                    
                     OR PV-TOTAL-SALES-LY > PC-MIN-TOTAL-SALES                  
1099RM               OR (ML202-ENT-ID = PC-UNKNOWN-VENDOR)                      
                       PERFORM Z300-PRINT-DETAIL                               C
                       ADD 2 TO PV-LINE-COUNTER                                C
                   ELSE                                                         
                       PERFORM E100-ADD-MISC-VENDOR                            C
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                           CL**4
           IF PV-LINE-COUNTER >= PC-LINE-MAX                               CL**4
               PERFORM Z200-PRINT-HEADERS                                  CL**4
               PERFORM Z250-PRINT-HEADERS2                                 CL**4
           END-IF.                                                         CL**4
                                                                                
0899RM*-- ACCUMULATE ALL UNKNOWN VENDOR (5161) SEPARATELY                  CL**4
0999RM     IF ML202-ENT-ID = PC-UNKNOWN-VENDOR                                  
0999RM         PERFORM D220-ADD-UNKNOWN-VNDR-TOTALS                             
0999RM     ELSE                                                                 
0999RM         PERFORM D200-ADD-DEPT-TOTALS                                CL**4
0999RM     END-IF.                                                              
0999RM*    PERFORM D200-ADD-DEPT-TOTALS.                                   CL**4
                                                                           CL**4
           INITIALIZE DL-DETAIL-LINE.                                      CL**4
                                                                           CL**4
           MOVE '|' TO DL-SEPARATOR.                                       CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       C200-DEPT-TOTALS.                                                   CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE DEPT TOTALS AND PRINT.           CL**4
      *    UPDATE THE GRAND TOTALS WITH THE CURRENT DEPT TOTALS.           CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           INITIALIZE TL-TOTAL-LINE.                                       CL**4
                                                                           CL**4
           MOVE 'TOTAL :'             TO TL-TOTAL.                         CL**4
0999RM* ADD ALL UNKNOWN VENDOR AMOUNTS TO THE 'NON-CALCULATED' AMTS        CL**4
*************************************                                           
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-PRCH-ADJ-COST-TY / 1000.00.                               
0999RM            (UVDT-PRCH-ADJ-COST-TY + DT-PRCH-ADJ-COST-TY)                 
0999RM            / 1000.00.                                                    
0899RM     MOVE PV-NEW-TOTAL2         TO TL-PURCHASE-ADJ-COST.             CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-GROSS-COST / 1000.00.                                CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO TL-GROSS-COST.                    CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-RECEIPTS-COST-TY / 1000.00.                               
0999RM            (UVDT-RECEIPTS-COST-TY + DT-RECEIPTS-COST-TY)                 
0999RM            / 1000.00.                                                    
0899RM     MOVE PV-NEW-TOTAL2         TO TL-RECEIPTS-COST.                 CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-COST-PURCH-ADJ   / 1000.00.                          CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO TL-COST-PURCH-ADJ.                CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-RECEIPTS-RTL-TY / 1000.00.                                
0999RM            (UVDT-RECEIPTS-RTL-TY + DT-RECEIPTS-RTL-TY)                   
0999RM            / 1000.00.                                                    
0899RM     MOVE PV-NEW-TOTAL2         TO TL-RECEIPTS-RETAIL.               CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-NET-COST-TY / 1000.00.                               CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO TL-NET-COST-TY.                   CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-PRCH-ADJ-COST-TY / 1000.00.                               
0999RM            (UVDT-PRCH-ADJ-COST-TY + DT-PRCH-ADJ-COST-TY)                 
0999RM            / 1000.00.                                                    
0899RM     MOVE PV-NEW-TOTAL2         TO TL-PURCHASE-ADJ-COST.             CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-RETAIL-PURCH-TY / 1000.00.                           CL**4
0899RM*                                                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO TL-RETAIL-PURCH-TY.               CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*            DT-PRCH-ADJ-RTL-TY / 1000.00.                                
0999RM            (UVDT-PRCH-ADJ-RTL-TY + DT-PRCH-ADJ-RTL-TY)                   
0999RM            / 1000.00.                                                    
0899RM     MOVE PV-NEW-TOTAL2         TO TL-PURCHASE-ADJ-RETAIL.           CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*            DT-TOTAL-SALES-TY   / 1000.00.                          CL**4
0999RM            (UVDT-TOTAL-SALES-TY + DT-TOTAL-SALES-TY) / 1000.00.     CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL2         TO TL-TOTAL-SALES-TY.                CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*            DT-TOTAL-MKDN-TY    / 1000.00.                          CL**4
0999RM            (UVDT-TOTAL-MKDN-TY + DT-TOTAL-MKDN-TY) / 1000.00.       CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL2         TO TL-TOTAL-MKDN-TY.                 CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*            DT-END-INV-RTL-TY   / 1000.00.                          CL**4
0999RM            (UVDT-END-INV-RTL-TY + DT-END-INV-RTL-TY) / 1000.00.     CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL2         TO TL-INVEN-RTL-DLR-TY.              CL**4
                                                                           CL**4
           MOVE DT-NET-MKUP-PCT-TY    TO TL-NET-MKUP-PCT-TY.               CL**4
           MOVE DT-CUMM-MKUP-PCT-TY   TO TL-CUMM-MARKUP-PCT-TY.            CL**4
           MOVE DT-MKDN-PCT-SALES-TY  TO TL-MKDN-PCT-SALES-TY.             CL**4
           MOVE DT-GROSS-MRGIN-PCT-TY TO TL-GROSS-MRGIN-PCT-TY.            CL**4
                                                                                
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                DT-NET-COST-LY / 1000.00.                           CL**4
0999RM                (UVDT-NET-COST-LY + DT-NET-COST-LY)                  CL**4
0999RM               / 1000.00                                             CL**4
0999RM         END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2 TO TL-NET-COST-LY                        CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                DT-RETAIL-PURCH-LY / 1000.00.                       CL**4
0999RM                (UVDT-RETAIL-PURCH-LY + DT-RETAIL-PURCH-LY)          CL**4
0999RM               / 1000.00                                                  
0999RM         END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2     TO TL-RETAIL-PURCH-LY                CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                DT-TOTAL-SALES-LY / 1000.00.                        CL**4
0999RM                (UVDT-TOTAL-SALES-LY + DT-TOTAL-SALES-LY)            CL**4
0999RM               / 1000.00                                             CL**4
0999RM         END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2     TO TL-TOTAL-SALES-LY                 CL**4
               MOVE DT-NET-MKUP-PCT-LY TO TL-NET-MKUP-PCT-LY               CL**4
0100RM*** OMIT THE FOLLOWING LAST YEAR FIELDS FOR 1999 FROM THE REPORT          
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
0999RM*                    DT-TOTAL-MKDN-LY / 1000.00.                     CL**4
0999RM                    (UVDT-TOTAL-MKDN-LY + DT-TOTAL-MKDN-LY)          CL**4
0999RM                   / 1000.00                                         CL**4
0999RM             END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL2 TO TL-TOTAL-MKDN-LY                  CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
0999RM*                    DT-END-INV-RTL-LY / 1000.00.                    CL**4
0999RM                    (UVDT-END-INV-RTL-LY + DT-END-INV-RTL-LY)        CL**4
0999RM                   / 1000.00                                         CL**4
0999RM             END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL2     TO TL-INVEN-RTL-DLR-LY           CL**4
                   MOVE DT-GROSS-MRGIN-PCT-LY TO                           CL**4
                        TL-GROSS-MRGIN-PCT-LY                              CL**4
0100RM         END-IF                                                           
0999RM     END-IF.                                                              
                                                                           CL**4
           PERFORM Z400-PRINT-DEPT-TOTALS.                                 CL**4
                                                                           CL**4
           ADD DT-GROSS-COST          TO GT-GROSS-COST.                    CL**4
           ADD DT-COST-PURCH-ADJ      TO GT-COST-PURCH-ADJ.                CL**4
           ADD DT-NET-COST-TY         TO GT-NET-COST-TY.                   CL**4
           ADD DT-RETAIL-PURCH-TY     TO GT-RETAIL-PURCH-TY.               CL**4
                                                                                
0899RM     ADD DT-RECEIPTS-COST-TY    TO GT-RECEIPTS-COST-TY.              CL**4
0899RM     ADD DT-RECEIPTS-RTL-TY     TO GT-RECEIPTS-RTL-TY.               CL**4
0899RM     ADD DT-PRCH-ADJ-COST-TY    TO GT-PRCH-ADJ-COST-TY.              CL**4
0899RM     ADD DT-PRCH-ADJ-RTL-TY     TO GT-PRCH-ADJ-RTL-TY.               CL**4
                                                                                
           ADD DT-NET-MKUP-TY         TO GT-NET-MKUP-TY.                   CL**4
           ADD DT-TOTAL-SALES-TY      TO GT-TOTAL-SALES-TY.                CL**4
           ADD DT-TOTAL-MKDN-TY       TO GT-TOTAL-MKDN-TY.                 CL**4
           ADD DT-GROSS-MRGIN-TY      TO GT-GROSS-MRGIN-TY.                CL**4
           ADD DT-END-INV-RTL-TY      TO GT-END-INV-RTL-TY.                     
           ADD DT-CUM-TO-DATE-PURCH-COST-TY                                CL**4
                                      TO GT-CUM-TO-DATE-PURCH-COST-TY.          
           ADD DT-CUM-TO-DATE-PURCH-RETAIL-TY                              CL**4
                                      TO GT-CUM-TO-DATE-PURCH-RETAIL-TY.        
                                                                           CL**4
           ADD DT-NET-COST-LY         TO GT-NET-COST-LY.                   CL**4
           ADD DT-RETAIL-PURCH-LY     TO GT-RETAIL-PURCH-LY.               CL**4
           ADD DT-NET-MKUP-LY         TO GT-NET-MKUP-LY.                   CL**4
           ADD DT-TOTAL-SALES-LY      TO GT-TOTAL-SALES-LY.                CL**4
           ADD DT-TOTAL-MKDN-LY       TO GT-TOTAL-MKDN-LY.                 CL**4
           ADD DT-GROSS-MRGIN-LY      TO GT-GROSS-MRGIN-LY.                CL**4
           ADD DT-END-INV-RTL-LY      TO GT-END-INV-RTL-LY.                     
           INITIALIZE DT-DEPT-TOTALS.                                      CL**4
                                                                           CL**4
*******UNKNOWN VENDOR TOTAL ACCUMULATION                                        
0999RM     ADD UVDT-GROSS-COST        TO UVGT-GROSS-COST.                  CL**4
0999RM     ADD UVDT-COST-PURCH-ADJ    TO UVGT-COST-PURCH-ADJ.              CL**4
0999RM     ADD UVDT-NET-COST-TY       TO UVGT-NET-COST-TY.                 CL**4
0999RM     ADD UVDT-RETAIL-PURCH-TY   TO UVGT-RETAIL-PURCH-TY.             CL**4
0999RM                                                                          
0999RM     ADD UVDT-RECEIPTS-COST-TY  TO UVGT-RECEIPTS-COST-TY.            CL**4
0999RM     ADD UVDT-RECEIPTS-RTL-TY   TO UVGT-RECEIPTS-RTL-TY.             CL**4
0999RM     ADD UVDT-PRCH-ADJ-COST-TY  TO UVGT-PRCH-ADJ-COST-TY.            CL**4
0999RM     ADD UVDT-PRCH-ADJ-RTL-TY   TO UVGT-PRCH-ADJ-RTL-TY.             CL**4
0999RM                                                                          
0999RM     ADD UVDT-NET-MKUP-TY       TO UVGT-NET-MKUP-TY.                 CL**4
0999RM     ADD UVDT-TOTAL-SALES-TY    TO UVGT-TOTAL-SALES-TY.              CL**4
0999RM     ADD UVDT-TOTAL-MKDN-TY     TO UVGT-TOTAL-MKDN-TY.               CL**4
0999RM     ADD UVDT-GROSS-MRGIN-TY    TO UVGT-GROSS-MRGIN-TY.              CL**4
0999RM     ADD UVDT-END-INV-RTL-TY    TO UVGT-END-INV-RTL-TY.                   
0999RM     ADD UVDT-STD-PURCH-COST-TY TO UVGT-STD-PURCH-COST-TY.           CL**4
0999RM     ADD UVDT-STD-PURCH-RTL-TY  TO UVGT-STD-PURCH-RTL-TY.            CL**4
0999RM     ADD UVDT-NET-COST-LY       TO UVGT-NET-COST-LY.                 CL**4
0999RM     ADD UVDT-RETAIL-PURCH-LY   TO UVGT-RETAIL-PURCH-LY.             CL**4
0999RM     ADD UVDT-NET-MKUP-LY       TO UVGT-NET-MKUP-LY.                 CL**4
0999RM     ADD UVDT-TOTAL-SALES-LY    TO UVGT-TOTAL-SALES-LY.              CL**4
0999RM     ADD UVDT-TOTAL-MKDN-LY     TO UVGT-TOTAL-MKDN-LY.               CL**4
0999RM     ADD UVDT-GROSS-MRGIN-LY    TO UVGT-GROSS-MRGIN-LY.              CL**4
0999RM     ADD UVDT-END-INV-RTL-LY    TO UVGT-END-INV-RTL-LY.                   
0999RM     INITIALIZE UVDT-UNKN-VNDR-DEPT-TOTALS.                          CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       C400-DEPT-TOTAL-PCT.                                                CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    DETERMINE THE DEPT TOTALS FOR THE PERCENTAGE FIELDS USING       CL**4
      *    THE DEPT TOTALS ALREADY CALCULATED.                             CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      *    PERFORMED BY B200-PROCESS-AND-PRINT.                            CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               DT-NET-MKUP-TY * 100                                        CL**4
             / DT-RETAIL-PURCH-TY                                          CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO DT-NET-MKUP-PCT-TY.                       CL**4
                                                                           CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
             ( DT-CUM-TO-DATE-PURCH-RETAIL-TY                                   
             - DT-CUM-TO-DATE-PURCH-COST-TY ) * 100.00                          
             / DT-CUM-TO-DATE-PURCH-RETAIL-TY                           MLKRP801
               ON SIZE ERROR                                            MLKRP801
                   MOVE 100 TO PV-NEW-TOTAL1.                           MLKRP801
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO DT-CUMM-MKUP-PCT-TY.                      CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
0999RM*        DT-TOTAL-MKDN-TY * 100 / DT-TOTAL-SALES-TY                  CL**4
0999RM        ((UVDT-TOTAL-MKDN-TY + DT-TOTAL-MKDN-TY) * 100)              CL**4
0999RM       / (UVDT-TOTAL-SALES-TY + DT-TOTAL-SALES-TY)                   CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO DT-MKDN-PCT-SALES-TY.                     CL**4
                                                                           CL**4
                                                                                
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               DT-GROSS-MRGIN-TY * 100 / DT-TOTAL-SALES-TY                 CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                                
           MOVE PV-NEW-TOTAL1 TO DT-GROSS-MRGIN-PCT-TY.                    CL**4
                                                                                
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL1 ROUNDED =                             CL**4
                   DT-NET-MKUP-LY * 100                                    CL**4
                 / DT-RETAIL-PURCH-LY                                      CL**4
                   ON SIZE ERROR                                           CL**4
                       INITIALIZE PV-NEW-TOTAL1                            CL**4
               END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL1 TO DT-NET-MKUP-PCT-LY                    CL**4
               COMPUTE PV-NEW-TOTAL1 ROUNDED =                             CL**4
                   DT-GROSS-MRGIN-LY * 100 / DT-TOTAL-SALES-LY             CL**4
                   ON SIZE ERROR                                           CL**4
                       INITIALIZE PV-NEW-TOTAL1                            CL**4
               END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL1 TO DT-GROSS-MRGIN-PCT-LY                 CL**4
0999RM     END-IF.                                                              
                                                                                
       D100-MOVE-TO-DETAIL.                                                CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE CURRENT VENDOR.                  CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE ML202-NAME-VENDOR TO DL-VENDOR-NAME.                       CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*           ML202-TY-RCPT-GRO-COST-AMT / 1000.00.                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-GROSS-COST.                CL**4
                                                                                
      *-- RECEIPTS - COST                                                       
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                      
0899RM             ML202-TY-RCPT-NET-COST-AMT / 1000.00.                        
0899RM     MOVE PV-NEW-TOTAL2             TO DL-RECEIPTS-COST.             CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        ML202-TY-PADJ-NET-COST-AMT / 1000.00.                       CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-COST-PURCH-ADJ.            CL**4
                                                                           CL**4
      *-- RECEIPTS - RETAIL                                                     
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM             ML202-TY-RCPT-RTL-AMT / 1000.00.                     MLKRP801
0899RM     MOVE PV-NEW-TOTAL2             TO DL-RECEIPTS-RETAIL.           CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*          (ML202-TY-RCPT-NET-COST-AMT                               CL**4
0899RM*           + ML202-TY-PADJ-NET-COST-AMT) / 1000.00.                 CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-NET-COST-TY.               CL**4
                                                                                
      *-- RECEIPTS - PURCH ADJ COST                                             
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                      
0899RM             ML202-TY-PADJ-NET-COST-AMT / 1000.00.                        
0899RM     MOVE PV-NEW-TOTAL2             TO DL-PURCHASE-ADJ-COST.         CL**4
                                                                           CL**4
           COMPUTE PV-RETAIL-PURCH-TY = ML202-TY-RCPT-RTL-AMT           MLKRP801
                                      + ML202-TY-PADJ-RTL-AMT           MLKRP801
                                      + ML202-TY-MKUP-RTL-AMT           MLKRP801
                                      + ML202-TY-XFER-IN-RTL-AMT        MLKRP801
                                      - ML202-TY-XFER-OUT-RTL-AMT.      MLKRP801
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        PV-RETAIL-PURCH-TY / 1000.00.                               CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-RETAIL-PURCH-TY.           CL**4
                                                                           CL**4
      *-- RECEIPTS - PURCH ADJ RETAIL                                           
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM           ( ML202-TY-PADJ-RTL-AMT                                MLKRP801
0899RM           + ML202-TY-MKUP-RTL-AMT                                MLKRP801
0899RM           + ML202-TY-XFER-IN-RTL-AMT                             MLKRP801
0899RM           - ML202-TY-XFER-OUT-RTL-AMT) / 1000.00.                MLKRP801
0899RM     MOVE PV-NEW-TOTAL2 TO DL-PURCHASE-ADJ-RETAIL.                   CL**4
                                                                                
           COMPUTE PV-PERCENT ROUNDED =                                 MLKRP801
                        ML202-TY-MKUP-NET-AMT * 100.00                  MLKRP801
                      / PV-RETAIL-PURCH-TY                              MLKRP801
                        ON SIZE ERROR MOVE 0 TO PV-PERCENT              MLKRP801
           END-COMPUTE.                                                 MLKRP801
           MOVE PV-PERCENT                TO DL-NET-MKUP-PCT-TY.        MLKRP801
                                                                           CL**4
           COMPUTE PV-CUM-TO-DATE-PURCH-COST   =                                
                                       ML202-TY-PREV-SEA-EI-COST                
                                     + ML202-TY-RCPT-NET-COST-AMT               
                                     + ML202-TY-PADJ-NET-COST-AMT.              
           COMPUTE PV-CUM-TO-DATE-PURCH-RETAIL =                        MLKRP801
                                       ML202-TY-PREV-SEA-EI-RTL                 
                                     + ML202-TY-XFER-IN-RTL-AMT         MLKRP801
                                     - ML202-TY-XFER-OUT-RTL-AMT        MLKRP801
                                     + ML202-TY-RCPT-RTL-AMT               CL**4
                                     + ML202-TY-PADJ-RTL-AMT               CL**4
                                     + ML202-TY-MKUP-RTL-AMT.              CL**4
                                                                           CL**4
           COMPUTE PV-PERCENT ROUNDED =                                 MLKRP801
                      ( PV-CUM-TO-DATE-PURCH-RETAIL                             
                      - PV-CUM-TO-DATE-PURCH-COST ) * 100.00                    
                      / PV-CUM-TO-DATE-PURCH-RETAIL                     MLKRP801
                        ON SIZE ERROR MOVE 100 TO PV-PERCENT            MLKRP801
           END-COMPUTE.                                                 MLKRP801
           MOVE PV-PERCENT                TO DL-CUMM-MARKUP-PCT-TY.     MLKRP801
                                                                           CL**4
           COMPUTE PV-TOTAL-SALES-TY = ML202-TY-SLS-REG-RTL-AMT         MLKRP801
                                     + ML202-TY-SLS-PROMO-RTL-AMT       MLKRP801
                                     + ML202-TY-SLS-PROCLR-RTL-AMT      MLKRP801
                                     + ML202-TY-SLS-CLR-RTL-AMT         MLKRP801
                                     + ML202-TY-SLS-OTH-RTL-AMT.        MLKRP801
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               PV-TOTAL-SALES-TY / 1000.00.                                CL**4
           MOVE PV-NEW-TOTAL2             TO DL-TOTAL-SALES-TY.            CL**4
                                                                           CL**4
           COMPUTE PV-TOTAL-MKDN-TY = ML202-TY-MKDN-PLU-RTL-AMT         MLKRP801
                                    + ML202-TY-MKDN-RGST-RTL-AMT        MLKRP801
                                    + ML202-TY-MKDN-UMTCH-RTL-AMT       MLKRP801
                                    + ML202-TY-MKDN-BYR-RTL-AMT         MLKRP801
                                    + ML202-TY-MKDN-STR-RTL-AMT.        MLKRP801
                                                                        MLKRP801
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               PV-TOTAL-MKDN-TY / 1000.00.                                 CL**4
           MOVE PV-NEW-TOTAL2             TO DL-TOTAL-MKDN-TY.             CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               PV-TOTAL-MKDN-TY * 100 / PV-TOTAL-SALES-TY                  CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1             TO DL-MKDN-PCT-SALES-TY.         CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               ML202-TY-GRO-MRGN-AMT * 100 / PV-TOTAL-SALES-TY             CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1             TO DL-GROSS-MRGIN-PCT-TY.        CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               ML202-TY-END-INV-RTL-AMT / 1000.00.                         CL**4
           MOVE PV-NEW-TOTAL2            TO DL-INVEN-RTL-DLR-TY.           CL**4
                                                                           CL**4
      ***** LAST YEAR                                                           
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                     (ML202-LY-RCPT-NET-COST-AMT                           CL**4
                      + ML202-LY-PADJ-NET-COST-AMT) / 1000.00              CL**4
               MOVE PV-NEW-TOTAL2         TO DL-NET-COST-LY                CL**4
               COMPUTE PV-RETAIL-PURCH-LY =                             MLKRP801
                       ML202-LY-RCPT-RTL-AMT                            MLKRP801
                     + ML202-LY-PADJ-RTL-AMT                            MLKRP801
                     + ML202-LY-MKUP-RTL-AMT                            MLKRP801
                     + ML202-LY-XFER-IN-RTL-AMT                         MLKRP801
                     - ML202-LY-XFER-OUT-RTL-AMT                        MLKRP801
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   PV-RETAIL-PURCH-LY / 1000.00                            CL**4
               MOVE PV-NEW-TOTAL2    TO DL-RETAIL-PURCH-LY                 CL**4
               COMPUTE PV-TOTAL-SALES-LY =                              MLKRP801
                       ML202-LY-SLS-REG-RTL-AMT                         MLKRP801
                     + ML202-LY-SLS-PROMO-RTL-AMT                       MLKRP801
                     + ML202-LY-SLS-PROCLR-RTL-AMT                      MLKRP801
                     + ML202-LY-SLS-CLR-RTL-AMT                         MLKRP801
                     + ML202-LY-SLS-OTH-RTL-AMT                         MLKRP801
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   PV-TOTAL-SALES-LY / 1000.00                             CL**4
               MOVE PV-NEW-TOTAL2         TO DL-TOTAL-SALES-LY             CL**4
               COMPUTE PV-PERCENT ROUNDED =                             MLKRP801
                            ML202-LY-MKUP-NET-AMT * 100.00              MLKRP801
                          / PV-RETAIL-PURCH-LY                          MLKRP801
                            ON SIZE ERROR MOVE 0 TO PV-PERCENT          MLKRP801
               END-COMPUTE                                              MLKRP801
               MOVE PV-PERCENT            TO DL-NET-MKUP-PCT-LY         MLKRP801
0100RM*                                                                         
0100RM*** OMIT THE FOLLOWING LAST YEAR FIELDS FOR 1999 FROM THE REPORT          
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-TOTAL-MKDN-LY =                           MLKRP801
                           ML202-LY-MKDN-PLU-RTL-AMT                    MLKRP801
                         + ML202-LY-MKDN-RGST-RTL-AMT                   MLKRP801
                         + ML202-LY-MKDN-UMTCH-RTL-AMT                  MLKRP801
                         + ML202-LY-MKDN-BYR-RTL-AMT                    MLKRP801
                         + ML202-LY-MKDN-STR-RTL-AMT                    MLKRP801
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       PV-TOTAL-MKDN-LY / 1000                             CL**4
                       ON SIZE ERROR                                       CL**4
                           INITIALIZE PV-NEW-TOTAL2                        CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL2     TO DL-TOTAL-MKDN-LY              CL**4
                   COMPUTE PV-NEW-TOTAL1 ROUNDED =                         CL**4
                       ML202-LY-GRO-MRGN-AMT * 100 / PV-TOTAL-SALES-LY     CL**4
                       ON SIZE ERROR                                       CL**4
                           INITIALIZE PV-NEW-TOTAL1                        CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL1     TO DL-GROSS-MRGIN-PCT-LY         CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       ML202-LY-END-INV-RTL-AMT / 1000.00                  CL**4
                   MOVE PV-NEW-TOTAL2    TO DL-INVEN-RTL-DLR-LY            CL**4
0100RM         END-IF                                                           
0999RM     END-IF.                                                              
                                                                           CL**4
       D200-ADD-DEPT-TOTALS.                                               CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    UPDATE THE DEPT TOTALS WITH THE CURRENT VENDOR TOTALS.          CL**4
      *                                                                    CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           ADD ML202-TY-RCPT-GRO-COST-AMT  TO DT-GROSS-COST.               CL**4
           ADD ML202-TY-PADJ-NET-COST-AMT  TO DT-COST-PURCH-ADJ.           CL**4
           COMPUTE DT-NET-COST-TY = DT-NET-COST-TY                         CL**4
                                  + ML202-TY-RCPT-NET-COST-AMT             CL**4
                                  + ML202-TY-PADJ-NET-COST-AMT.            CL**4
           ADD PV-RETAIL-PURCH-TY      TO DT-RETAIL-PURCH-TY.              CL**4
                                                                                
0899RM     COMPUTE DT-RECEIPTS-COST-TY =                                        
0899RM           + DT-RECEIPTS-COST-TY                                          
0899RM           + ML202-TY-RCPT-NET-COST-AMT.                                  
                                                                                
0899RM     COMPUTE DT-RECEIPTS-RTL-TY =                                         
0899RM           ( DT-RECEIPTS-RTL-TY                                           
0899RM           + ML202-TY-RCPT-RTL-AMT).                              MLKRP801
                                                                                
0899RM     COMPUTE DT-PRCH-ADJ-COST-TY =                                        
0899RM             DT-PRCH-ADJ-COST-TY                                          
0899RM           + ML202-TY-PADJ-NET-COST-AMT.                                  
                                                                                
0899RM     COMPUTE DT-PRCH-ADJ-RTL-TY =                                         
0899RM           ( DT-PRCH-ADJ-RTL-TY                                           
0899RM           + ML202-TY-PADJ-RTL-AMT                                MLKRP801
0899RM           + ML202-TY-MKUP-RTL-AMT                                MLKRP801
0899RM           + ML202-TY-XFER-IN-RTL-AMT                             MLKRP801
0899RM           - ML202-TY-XFER-OUT-RTL-AMT).                          MLKRP801
                                                                                
           ADD ML202-TY-MKUP-NET-AMT   TO DT-NET-MKUP-TY.                  CL**4
           ADD PV-TOTAL-SALES-TY       TO DT-TOTAL-SALES-TY.               CL**4
           ADD PV-TOTAL-MKDN-TY        TO DT-TOTAL-MKDN-TY.                CL**4
           ADD ML202-TY-GRO-MRGN-AMT   TO DT-GROSS-MRGIN-TY.               CL**4
           ADD ML202-TY-END-INV-RTL-AMT                                         
                                       TO DT-END-INV-RTL-TY.                    
           ADD PV-CUM-TO-DATE-PURCH-COST                                        
                                       TO DT-CUM-TO-DATE-PURCH-COST-TY.         
           ADD PV-CUM-TO-DATE-PURCH-RETAIL                                      
                                      TO DT-CUM-TO-DATE-PURCH-RETAIL-TY.        
           COMPUTE DT-NET-COST-LY = DT-NET-COST-LY                         CL**4
                                  + ML202-LY-RCPT-NET-COST-AMT             CL**4
                                  + ML202-LY-PADJ-NET-COST-AMT.            CL**4
           ADD PV-RETAIL-PURCH-LY      TO DT-RETAIL-PURCH-LY.              CL**4
           ADD ML202-LY-MKUP-NET-AMT   TO DT-NET-MKUP-LY.                  CL**4
           ADD PV-TOTAL-SALES-LY       TO DT-TOTAL-SALES-LY.               CL**4
           ADD PV-TOTAL-MKDN-LY        TO DT-TOTAL-MKDN-LY.                CL**4
           ADD ML202-LY-GRO-MRGN-AMT   TO DT-GROSS-MRGIN-LY.               CL**4
           ADD ML202-LY-END-INV-RTL-AMT                                         
                                       TO DT-END-INV-RTL-LY.                    
                                                                           CL**4
                                                                           CL**4
0999RM D220-ADD-UNKNOWN-VNDR-TOTALS.                                       CL**4
0999RM                                                                     CL**4
0999RM****************************************************************     CL**4
0999RM*    UPDATE THE UNNKOWN VENDOR DEPARTMENT TOTALS WITH THE UNKNOWN    CL**4
0999RM*    VENDOR TOTALS (5161)                                            CL**4
0999RM*    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
0999RM****************************************************************     CL**4
0999RM                                                                     CL**4
0999RM     ADD ML202-TY-RCPT-GRO-COST-AMT  TO UVDT-GROSS-COST.             CL**4
0999RM     ADD ML202-TY-PADJ-NET-COST-AMT  TO UVDT-COST-PURCH-ADJ.         CL**4
0999RM     COMPUTE UVDT-NET-COST-TY = UVDT-NET-COST-TY                     CL**4
0999RM                            + ML202-TY-RCPT-NET-COST-AMT             CL**4
0999RM                            + ML202-TY-PADJ-NET-COST-AMT.            CL**4
0999RM     ADD PV-RETAIL-PURCH-TY      TO UVDT-RETAIL-PURCH-TY.            CL**4
0999RM                                                                          
0999RM     COMPUTE UVDT-RECEIPTS-COST-TY =                                      
0999RM           + UVDT-RECEIPTS-COST-TY                                        
0999RM           + ML202-TY-RCPT-NET-COST-AMT.                                  
0999RM                                                                          
0999RM     COMPUTE UVDT-RECEIPTS-RTL-TY =                                       
0999RM           ( UVDT-RECEIPTS-RTL-TY                                         
0999RM           + ML202-TY-RCPT-RTL-AMT).                              MLKRP801
0999RM                                                                          
0999RM     COMPUTE UVDT-PRCH-ADJ-COST-TY =                                      
0999RM             UVDT-PRCH-ADJ-COST-TY                                        
0999RM           + ML202-TY-PADJ-NET-COST-AMT.                                  
0999RM                                                                          
0999RM     COMPUTE UVDT-PRCH-ADJ-RTL-TY =                                       
0999RM           ( UVDT-PRCH-ADJ-RTL-TY                                         
0999RM           + ML202-TY-PADJ-RTL-AMT                                MLKRP801
0999RM           + ML202-TY-MKUP-RTL-AMT                                MLKRP801
0999RM           + ML202-TY-XFER-IN-RTL-AMT                             MLKRP801
0999RM           - ML202-TY-XFER-OUT-RTL-AMT).                          MLKRP801
0999RM                                                                          
0999RM     ADD ML202-TY-MKUP-NET-AMT   TO UVDT-NET-MKUP-TY.                CL**4
0999RM     ADD PV-TOTAL-SALES-TY       TO UVDT-TOTAL-SALES-TY.             CL**4
0999RM     ADD PV-TOTAL-MKDN-TY        TO UVDT-TOTAL-MKDN-TY.              CL**4
0999RM     ADD ML202-TY-GRO-MRGN-AMT   TO UVDT-GROSS-MRGIN-TY.             CL**4
0999RM     ADD ML202-TY-END-INV-RTL-AMT                                         
0999RM                                 TO UVDT-END-INV-RTL-TY.                  
0999RM     ADD PV-CUM-TO-DATE-PURCH-COST                                        
0999RM                                 TO UVDT-STD-PURCH-COST-TY.       .       
0999RM     ADD PV-CUM-TO-DATE-PURCH-RETAIL                                      
0999RM                                 TO UVDT-STD-PURCH-RTL-TY.        Y.      
0999RM     COMPUTE UVDT-NET-COST-LY = UVDT-NET-COST-LY                     CL**4
0999RM                            + ML202-LY-RCPT-NET-COST-AMT             CL**4
0999RM                            + ML202-LY-PADJ-NET-COST-AMT.            CL**4
0999RM     ADD PV-RETAIL-PURCH-LY      TO UVDT-RETAIL-PURCH-LY.            CL**4
0999RM     ADD ML202-LY-MKUP-NET-AMT   TO UVDT-NET-MKUP-LY.                CL**4
0999RM     ADD PV-TOTAL-SALES-LY       TO UVDT-TOTAL-SALES-LY.             CL**4
0999RM     ADD PV-TOTAL-MKDN-LY        TO UVDT-TOTAL-MKDN-LY.              CL**4
0999RM     ADD ML202-LY-GRO-MRGN-AMT   TO UVDT-GROSS-MRGIN-LY.             CL**4
0999RM     ADD ML202-LY-END-INV-RTL-AMT                                         
0999RM                                 TO UVDT-END-INV-RTL-LY.                  
0999RM                                                                     CL**4
       D300-CHECK-DETAIL-GT-ZERO.                                          CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    CHECK THE DOLLAR FIELDS IN DETAIL LINE NUMBER 2 TO              CL**4
      *    DETERMINE IF ANY ONE OF THEM WILL BE GREATER THAN ZERO.              
      *    IF ONE IS THEN THE DETAIL LINES WILL BE PRINTED, OTHERWISE           
      *    THE DETAIL LINES ARE NOT PLACED ON THE REPORT.                       
      *                                                                    CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           SET PS-PRINT-DETAIL TO TRUE.                                         
                                                                                
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0899RM         IF DL-RECEIPTS-COST            = SPACES AND                      
0899RM            DL-RECEIPTS-RETAIL          = SPACES AND                      
0899RM            DL-PURCHASE-ADJ-COST        = SPACES AND                      
0899RM            DL-PURCHASE-ADJ-RETAIL      = SPACES AND                      
                  DL-NET-MKUP-PCT-TY          = SPACES AND                      
                  DL-TOTAL-SALES-TY           = SPACES AND                      
                  DL-TOTAL-MKDN-TY            = SPACES AND                      
                  DL-MKDN-PCT-SALES-TY        = SPACES AND                      
                  DL-GROSS-MRGIN-PCT-TY       = SPACES                          
                   SET PS-NO-PRINT-DETAIL TO TRUE                               
                   INITIALIZE DL-DETAIL-LINE                                    
               END-IF                                                           
0999RM     ELSE                                                                 
0100RM*-- DO NOT PRINT 1999 DATA (LAST YEAR)                                    
0100RM     IF PV-HDG-START-CCYY-LY = PC-1999                                    
0100RM         IF DL-RECEIPTS-COST            = SPACES AND                      
0100RM            DL-RECEIPTS-RETAIL          = SPACES AND                      
0100RM            DL-PURCHASE-ADJ-COST        = SPACES AND                      
0100RM            DL-PURCHASE-ADJ-RETAIL      = SPACES AND                      
0100RM            DL-NET-MKUP-PCT-TY          = SPACES AND                      
0100RM            DL-TOTAL-SALES-TY           = SPACES AND                      
0100RM            DL-TOTAL-MKDN-TY            = SPACES AND                      
0100RM            DL-MKDN-PCT-SALES-TY        = SPACES AND                      
0100RM            DL-GROSS-MRGIN-PCT-TY       = SPACES AND                      
0100RM            DL-NET-COST-LY              = SPACES AND                      
0100RM            DL-RETAIL-PURCH-LY          = SPACES AND                      
0100RM            DL-TOTAL-SALES-LY           = SPACES                          
0100RM             SET PS-NO-PRINT-DETAIL TO TRUE                               
0100RM             INITIALIZE DL-DETAIL-LINE                                    
0100RM         END-IF                                                           
0100RM     ELSE                                                                 
0899RM         IF DL-RECEIPTS-COST            = SPACES AND                      
0899RM            DL-RECEIPTS-RETAIL          = SPACES AND                      
0899RM            DL-PURCHASE-ADJ-COST        = SPACES AND                      
0899RM            DL-PURCHASE-ADJ-RETAIL      = SPACES AND                      
                  DL-NET-MKUP-PCT-TY          = SPACES AND                      
                  DL-TOTAL-SALES-TY           = SPACES AND                      
                  DL-TOTAL-MKDN-TY            = SPACES AND                      
                  DL-MKDN-PCT-SALES-TY        = SPACES AND                      
                  DL-GROSS-MRGIN-PCT-TY       = SPACES AND                      
                  DL-NET-COST-LY              = SPACES AND                      
                  DL-RETAIL-PURCH-LY          = SPACES AND                      
                  DL-NET-MKUP-PCT-LY          = SPACES AND                      
                  DL-TOTAL-SALES-LY           = SPACES AND                      
                  DL-TOTAL-MKDN-LY            = SPACES AND                      
                  DL-GROSS-MRGIN-PCT-LY       = SPACES AND                      
                  DL-INVEN-RTL-DLR-LY         = SPACES                          
                   SET PS-NO-PRINT-DETAIL TO TRUE                               
                   INITIALIZE DL-DETAIL-LINE                                    
               END-IF                                                           
           END-IF.                                                              
                                                                           CL**4
       E100-ADD-MISC-VENDOR.                                               CL**4
      ****************************************************************     CL**4
      *    UPDATE THE MISCELLANEOUS VENDOR TOTALS WITH THE CURRENT         CL**4
      *    VENDOR TOTALS WITHIN THE DEPARTMENT                             CL**4
      *                                                                    CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           ADD ML202-TY-RCPT-GRO-COST-AMT TO MDT-GROSS-COST.               CL**4
           ADD ML202-TY-PADJ-NET-COST-AMT TO MDT-COST-PURCH-ADJ.           CL**4
           COMPUTE MDT-NET-COST-TY = MDT-NET-COST-TY                       CL**4
                                  + ML202-TY-RCPT-NET-COST-AMT             CL**4
                                  + ML202-TY-PADJ-NET-COST-AMT.            CL**4
           ADD PV-RETAIL-PURCH-TY      TO MDT-RETAIL-PURCH-TY.             CL**4
                                                                                
0899RM     COMPUTE MDT-RECEIPTS-COST-TY =                                       
0899RM             MDT-RECEIPTS-COST-TY                                         
0899RM           + ML202-TY-RCPT-NET-COST-AMT.                                  
                                                                                
0899RM     COMPUTE MDT-RECEIPTS-RTL-TY =                                        
0899RM           ( MDT-RECEIPTS-RTL-TY                                          
0899RM           + ML202-TY-RCPT-RTL-AMT).                              MLKRP801
                                                                                
0899RM     COMPUTE MDT-PRCH-ADJ-COST-TY =                                       
0899RM           + MDT-PRCH-ADJ-COST-TY                                         
0899RM           + ML202-TY-PADJ-NET-COST-AMT.                                  
                                                                                
0899RM     COMPUTE MDT-PRCH-ADJ-RTL-TY =                                        
0899RM           ( MDT-PRCH-ADJ-RTL-TY                                          
0899RM           + ML202-TY-PADJ-RTL-AMT                                MLKRP801
0899RM           + ML202-TY-MKUP-RTL-AMT                                MLKRP801
0899RM           + ML202-TY-XFER-IN-RTL-AMT                             MLKRP801
0899RM           - ML202-TY-XFER-OUT-RTL-AMT).                          MLKRP801
                                                                                
           ADD ML202-TY-MKUP-NET-AMT   TO MDT-NET-MKUP-TY.                 CL**4
           ADD PV-TOTAL-SALES-TY       TO MDT-TOTAL-SALES-TY.              CL**4
           ADD PV-TOTAL-MKDN-TY        TO MDT-TOTAL-MKDN-TY.               CL**4
           ADD ML202-TY-GRO-MRGN-AMT   TO MDT-GROSS-MRGIN-TY.              CL**4
           ADD ML202-TY-END-INV-RTL-AMT                                         
                                       TO MDT-MISC-END-INV-RTL-TY.              
           ADD PV-CUM-TO-DATE-PURCH-COST                                        
                                       TO MDT-CUM-TO-DATE-PURCH-COST-TY.        
           ADD PV-CUM-TO-DATE-PURCH-RETAIL                                      
                                      TO MDT-CUM-TO-DATE-PURCH-RTL-TY.          
           COMPUTE MDT-NET-COST-LY = MDT-NET-COST-LY                       CL**4
                                  + ML202-LY-RCPT-NET-COST-AMT             CL**4
                                  + ML202-LY-PADJ-NET-COST-AMT.            CL**4
           ADD PV-RETAIL-PURCH-LY      TO MDT-RETAIL-PURCH-LY.             CL**4
           ADD ML202-LY-MKUP-NET-AMT   TO MDT-NET-MKUP-LY.                 CL**4
           ADD PV-TOTAL-SALES-LY       TO MDT-TOTAL-SALES-LY.              CL**4
           ADD PV-TOTAL-MKDN-LY        TO MDT-TOTAL-MKDN-LY.               CL**4
           ADD ML202-LY-GRO-MRGN-AMT   TO MDT-GROSS-MRGIN-LY.              CL**4
           ADD ML202-LY-END-INV-RTL-AMT                                         
                                       TO MDT-END-INV-RTL-LY.                   
                                                                           CL**4
       E200-MISC-VENDOR-DETAIL.                                            CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE MISCELLANEOUS VENDOR LINE.       CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE PC-MISCELLANEOUS-VENDOR  TO DL-VENDOR-NAME.                CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MDT-GROSS-COST / 1000.00.                                   CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-GROSS-COST.                    CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         MDT-RECEIPTS-COST-TY / 1000.00.                             CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-RECEIPTS-COST.                 CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MDT-COST-PURCH-ADJ / 1000.00.                               CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-COST-PURCH-ADJ.                CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM             MDT-RECEIPTS-RTL-TY / 1000.00.                          CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-RECEIPTS-RETAIL.               CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MDT-NET-COST-TY / 1000.00.                                  CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-NET-COST-TY.                   CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM             MDT-PRCH-ADJ-COST-TY / 1000.00.                         CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-PURCHASE-ADJ-COST.             CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MDT-RETAIL-PURCH-TY / 1000.00.                              CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-RETAIL-PURCH-TY.               CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         MDT-PRCH-ADJ-RTL-TY / 1000.00.                              CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-PURCHASE-ADJ-RETAIL.           CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               MDT-NET-MKUP-TY * 100                                       CL**4
             / MDT-RETAIL-PURCH-TY                                         CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1         TO DL-NET-MKUP-PCT-TY.               CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
             ( MDT-CUM-TO-DATE-PURCH-RTL-TY                                     
             - MDT-CUM-TO-DATE-PURCH-COST-TY ) * 100.00                         
             / MDT-CUM-TO-DATE-PURCH-RTL-TY                             MLKRP803
               ON SIZE ERROR                                            MLKRP803
                   MOVE 100 TO PV-NEW-TOTAL1.                           MLKRP803
           MOVE PV-NEW-TOTAL1         TO DL-CUMM-MARKUP-PCT-TY.            CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               MDT-TOTAL-SALES-TY / 1000.00.                               CL**4
           MOVE PV-NEW-TOTAL2         TO DL-TOTAL-SALES-TY.                CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               MDT-TOTAL-MKDN-TY / 1000.00.                                CL**4
           MOVE PV-NEW-TOTAL2         TO DL-TOTAL-MKDN-TY.                 CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               MDT-TOTAL-MKDN-TY * 100 / MDT-TOTAL-SALES-TY                CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1         TO DL-MKDN-PCT-SALES-TY.             CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               MDT-GROSS-MRGIN-TY * 100 / MDT-TOTAL-SALES-TY               CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1         TO DL-GROSS-MRGIN-PCT-TY.            CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               MDT-MISC-END-INV-RTL-TY / 1000.00.                          CL**4
           MOVE PV-NEW-TOTAL2         TO DL-INVEN-RTL-DLR-TY.              CL**4
                                                                           CL**4
0999RM*-- DO NOT PRINT                                                          
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   MDT-NET-COST-LY / 1000.00                               CL**4
               MOVE PV-NEW-TOTAL2     TO DL-NET-COST-LY                    CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                            MDT-RETAIL-PURCH-LY / 1000.00                  CL**4
               MOVE PV-NEW-TOTAL2     TO DL-RETAIL-PURCH-LY                CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   MDT-TOTAL-SALES-LY / 1000.00                            CL**4
               MOVE PV-NEW-TOTAL2     TO DL-TOTAL-SALES-LY                 CL**4
               COMPUTE PV-NEW-TOTAL1 ROUNDED =                             CL**4
                   MDT-NET-MKUP-LY * 100                                   CL**4
                 / MDT-RETAIL-PURCH-LY                                     CL**4
                   ON SIZE ERROR                                           CL**4
                       INITIALIZE PV-NEW-TOTAL1                            CL**4
               END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL1 TO DL-NET-MKUP-PCT-LY                    CL**4
0100RM*-- DO NOT PRINT                                                          
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       MDT-TOTAL-MKDN-LY / 1000.00                         CL**4
                   MOVE PV-NEW-TOTAL2 TO DL-TOTAL-MKDN-LY                  CL**4
                   COMPUTE PV-NEW-TOTAL1 ROUNDED =                         CL**4
                       MDT-GROSS-MRGIN-LY * 100 / MDT-TOTAL-SALES-LY       CL**4
                       ON SIZE ERROR                                       CL**4
                           INITIALIZE PV-NEW-TOTAL1                        CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL1 TO DL-GROSS-MRGIN-PCT-LY             CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       MDT-END-INV-RTL-LY / 1000.00                        CL**4
                   MOVE PV-NEW-TOTAL2 TO DL-INVEN-RTL-DLR-LY               CL**4
0100RM         END-IF                                                           
0999RM     END-IF.                                                              
                                                                           CL**4
           PERFORM D300-CHECK-DETAIL-GT-ZERO.                                   
           IF PS-PRINT-DETAIL                                                   
               PERFORM Z300-PRINT-DETAIL                                   CL**4
               ADD 2 TO PV-LINE-COUNTER                                    CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           INITIALIZE MDT-MISC-DEPT-TOTALS.                                     
                                                                                
       F100-SELECT-TMLCNTL.                                                     
      ******************************************************************        
      *   F100-SELECT-TMLCNTL.                                         *        
      *      OBTAIN THE OPEN FISCAL MONTH DATE IN ORDER TO ACCESS      *        
      *      TDTATTR TABLE FIELDS.                                     *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
W02191*******  SELECT OPN_FSCL_MN_DTE                                           
W02191         SELECT PSTG_FSCL_MN_DTE                                          
               INTO  :PV-OPN-FSCL-MN-DTE                                        
               FROM TMLCNTL                                                     
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE 'F100-SELECT-TMLCNTL'                                   
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TMLCNTL ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
       EJECT                                                                    
                                                                                
       F200-SELECT-CURR-YR-TDTATTR.                                             
      ******************************************************************        
      *   F200-SELECT-CURR-YR-TDTATTR.                                 *        
      *      OBTAIN THE OPEN FISCAL MONTH DATE'S FISCAL YEAR AND MONTH *        
      *      NUMBERS.                                                  *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
               SELECT FSCL_YR_NBR,                                              
                      FSCL_MN_NBR,                                              
                      FSCL_MN_NM,                                               
                      SEA_BEG_DTE,                                              
                      LY_THIS_DAY_KY_DTE                                        
               INTO   :DTATTR-FSCL-YR-NBR,                                      
                      :DTATTR-FSCL-MN-NBR,                                      
                      :DTATTR-FSCL-MN-NM,                                       
                      :DTATTR-SEA-BEG-DTE,                                      
                      :DTATTR-LY-THIS-DAY-KY-DTE                                
               FROM   TDTATTR                                                   
               WHERE  KY_DTE = :PV-OPN-FSCL-MN-DTE                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   MOVE DTATTR-FSCL-YR-NBR (1:4)                                
                                       TO PV-FISCAL-TY-CCYY                     
                   MOVE DTATTR-FSCL-MN-NBR                                      
                                       TO PV-FISCAL-TY-END-MONTH                
               WHEN SQLCODE = +100                                              
                   MOVE 'F200-SELECT-CURR-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
               WHEN OTHER                                                       
                   MOVE 'F200-SELECT-CURR-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR TABLE ERROR'                                   
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
0101RM     IF DTATTR-LY-THIS-DAY-KY-DTE = PV-INVALID-DATE                       
0101RM         PERFORM F225-LY-THIS-DTE-53WK                                    
0101RM     END-IF.                                                              
                                                                                
                                                                                
0101RM F225-LY-THIS-DTE-53WK.                                                   
0101RM******************************************************************        
0101RM*   F225-LY-THIS-DTE-53WK.                                       *        
0101RM*      OBTAIN THE DTATTR-LY-THIS-DAY-KY-DTE FOR THE LAST MONTH   *        
0101RM*      OF A YEAR THAT CONTAINS 53 WEEKS                          *        
0101RM******************************************************************        
0101RM*                                                                         
0101RM     EXEC SQL                                                             
0101RM         SELECT LY_THIS_DAY_KY_DTE                                        
0101RM         INTO   :DTATTR-LY-THIS-DAY-KY-DTE                                
0101RM         FROM   TDTATTR                                                   
0101RM         WHERE  KY_DTE = DATE(:PV-OPN-FSCL-MN-DTE) - 7 DAYS               
0101RM     END-EXEC.                                                            
0101RM                                                                          
0101RM     EVALUATE TRUE                                                        
0101RM         WHEN SQLCODE = 0                                                 
0101RM             CONTINUE                                                     
0101RM         WHEN SQLCODE = +100                                              
0101RM             MOVE 'F225-LY-THIS-DTE-53WK'                                 
0101RM                                 TO AA-PARAGRAPH-NAME                     
0101RM             MOVE 'TDTATTR ROW NOT FOUND'                                 
0101RM                                 TO AA-MESSAGE                            
0101RM             MOVE 'SELECT'       TO AA-DB2-OPERATION                      
0101RM             PERFORM Z999-SQL-ERROR                                       
0101RM         WHEN OTHER                                                       
0101RM             MOVE 'F225-LY-THIS-DTE-53WK'                                 
0101RM                                 TO AA-PARAGRAPH-NAME                     
0101RM             MOVE 'TDTATTR TABLE ERROR'                                   
0101RM                                 TO AA-MESSAGE                            
0101RM             MOVE 'SELECT'       TO AA-DB2-OPERATION                      
0101RM             PERFORM Z999-SQL-ERROR                                       
0101RM     END-EVALUATE.                                                        
                                                                                
                                                                                
       F250-SELECT-TY-SEA-BEG-TDTATTR.                                          
      ******************************************************************        
      *   F250-SELECT-TY-SEA-BEG-TDTATTR.                              *        
      *      OBTAIN THIS YEAR SEASON BEGIN MONTH DATE'S FISCAL YEAR    *        
      *      AND MONTH NUMBERS.                                        *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
               SELECT FSCL_MN_NBR                                               
               INTO   :DTATTR-FSCL-MN-NBR                                       
               FROM   TDTATTR                                                   
               WHERE  KY_DTE = :DTATTR-SEA-BEG-DTE                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   MOVE DTATTR-FSCL-MN-NBR                                      
                                       TO PV-FISCAL-TY-BEG-MONTH                
               WHEN SQLCODE = +100                                              
                   MOVE 'F250-SELECT-TY-SEA-BEG-TDTATTR'                        
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
               WHEN OTHER                                                       
                   MOVE 'F250-SELECT-TY-SEA-BEG-TDTATTR'                        
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR TABLE ERROR'                                   
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
       EJECT                                                                    
                                                                                
       F300-SELECT-LAST-YR-TDTATTR.                                             
      ******************************************************************        
      *   F300-SELECT-LAST-YR-TDTATTR.                                 *        
      *      OBTAIN THE OPEN FISCAL MONTH DATE'S FISCAL YEAR AND MONTH *        
      *      NUMBERS.                                                  *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
               SELECT FSCL_YR_NBR,                                              
                      FSCL_MN_NBR                                               
               INTO   :DTATTR-FSCL-YR-NBR,                                      
                      :DTATTR-FSCL-MN-NBR                                       
               FROM   TDTATTR                                                   
               WHERE  KY_DTE = :DTATTR-LY-THIS-DAY-KY-DTE                       
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   MOVE DTATTR-FSCL-YR-NBR (1:4)                                
                                       TO PV-FISCAL-LY-CCYY                     
                   MOVE DTATTR-FSCL-MN-NBR                                      
                                       TO PV-FISCAL-LY-END-MONTH                
               WHEN SQLCODE = +100                                              
                   MOVE 'F300-SELECT-LAST-YR-TDTATTR'                           
                                     TO AA-PARAGRAPH-NAME                       
                                                                                
                   MOVE 'TDTATTR ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
               WHEN OTHER                                                       
                   MOVE 'F300-SELECT-LAST-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR TABLE ERROR'                                   
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
       Z100-READ-REPORT-DATA.                                              CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    READ THE MARKET REPORT DATA FILE.                               CL**4
      *                                                                    CL**4
      *    PERFORMED BY A100-MAIN-MODULE.                                  CL**4
      *    PERFORMED BY B100-INITIALIZE-HEADER.                            CL**4
      *    PERFORMED BY B200-PROCESS-AND-PRINT.                            CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           READ VA-REPORT-EXTRACT-FILE INTO ML202-VENDOR-EXTRACT           CL**4
               AT END                                                      CL**4
                   SET PS-INPUT-EOF TO TRUE                                CL**4
               NOT AT END                                                  CL**4
                   ADD 1 TO PV-IN-COUNTER.                                 CL**4
                                                                           CL**4
       Z200-PRINT-HEADERS.                                                 CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT THE PAGE HEADERS.                                         CL**4
      *                                                                    CL**4
      *    PERFORMED BY B100-INITIALIZE-HEADER.                            CL**4
      *    PERFORMED BY C100-ENT-ID.                                       CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           ADD  1               TO PV-PAGE-COUNTER.                        CL**4
                                                                           CL**4
           MOVE PV-PAGE-COUNTER TO DP200O-PAGE-NUMBER.                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM DP200O-STANDRD-HEADER-200-COLS                         CL**4
               AFTER ADVANCING PAGE.                                       CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING1                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING2                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING3                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING4                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       Z250-PRINT-HEADERS2.                                                CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT THE REST OF THE PAGE HEADERS AFTER READING                CL**4
      *    A DATA RECORD.                                                  CL**4
      *                                                                    CL**4
      *    PERFORMED BY B200-PROCESS-AND-PRINT.                            CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE ML202-DMM                 TO SH-MANAGER-NMBR.              CL**4
           MOVE ML202-NAME-DMM            TO SH-MANAGER-NAME.              CL**4
           MOVE ML202-BUYER               TO SH-BUYER-NMBR.                CL**4
           MOVE ML202-NAME-BUYER          TO SH-BUYER-NAME.                CL**4
           MOVE ML202-DEPT-NBR            TO SH-DEPT-NMBR.                 CL**4
           MOVE ML202-NAME-DEPT           TO SH-DEPT-DESC.                 CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING5                                        CL**4
               AFTER ADVANCING 2 LINES.                                    CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING6                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SH-SUB-HEADING7                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM DH-DETAIL-HEADING1                                     CL**4
               AFTER ADVANCING 2 LINES.                                    CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM DH-DETAIL-HEADING2                                     CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM DH-DETAIL-HEADING3                                     CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM SL-SPECIAL-LINE                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           MOVE 14 TO PV-LINE-COUNTER.                                     CL**4
                                                                           CL**4
           EJECT                                                           CL**4
                                                                           CL**4
       Z300-PRINT-DETAIL.                                                  CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT DETAIL LINE.                                              CL**4
      *                                                                    CL**4
      *    PERFORMED BY C100-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM DL-DETAIL-LINE                                         CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM PV-ALL-DASHES                                          CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
       Z400-PRINT-DEPT-TOTALS.                                             CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT THE GRAND TOTAL LINE.                                     CL**4
      *                                                                    CL**4
      *    PERFORMED BY C200-DEPT-TOTALS.                                  CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM TL-TOTAL-LINE                                          CL**4
               AFTER ADVANCING 2 LINES.                                    CL**4
                                                                           CL**4
           EJECT                                                           CL**4
                                                                           CL**4
       Z450-PRINT-GRAND-TOTALS.                                            CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT THE GRAND TOTAL LINES.                                    CL**4
      *                                                                    CL**4
      *    PERFORMED BY C200-DEPT-TOTALS.                                  CL**4
      ****************************************************************     CL**4
           PERFORM Z200-PRINT-HEADERS.                                     CL**4
           MOVE SPACES          TO ML202-DMM                               CL**4
                                   ML202-BUYER                             CL**4
                                   ML202-NAME-BUYER                        CL**4
                                   ML202-DEPT-NBR                          CL**4
                                   ML202-NAME-DEPT.                        CL**4
           MOVE PC-REPORT-TOTAL TO ML202-NAME-DMM.                         CL**4
           PERFORM Z250-PRINT-HEADERS2.                                    CL**4
                                                                                
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM GTL-GRAND-TOTAL-LINE-1                                 CL**4
               AFTER ADVANCING 2 LINES.                                    CL**4
                                                                           CL**4
           WRITE MR-MARKET-REPORT-RECORD                                   CL**4
               FROM GTL-GRAND-TOTAL-LINE-2                                 CL**4
               AFTER ADVANCING 1 LINES.                                    CL**4
                                                                           CL**4
       Z999-SQL-ERROR.                                                          
      ******************************************************************MLKRP801
      *   Z999-SQL-ERROR.                                              *MLKRP801
      *      SQL ERROR ABEND ROUTINE.                                  *MLKRP801
      ******************************************************************        
                                                                                
           DISPLAY AA-ABEND-LIT.                                                
           DISPLAY AA-DB2-ERROR-LIT.                                            
           DISPLAY AA-PROGRAM-LIT.                                              
           DISPLAY AA-PARAGRAPH-LIT.                                            
           DISPLAY AA-MESSAGE-LINE.                                             
           DISPLAY AA-DB2-OPERATION-LIT.                                        
           SET AC-DB2-ERROR TO TRUE.                                            
           MOVE +4013                  TO ABEND-CODE.                           
                                                                                
           COPY DPPD004.                                                        
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
