      *************************                                                 
       IDENTIFICATION DIVISION.                                                 
      *************************                                                 
       PROGRAM-ID.      IMKUT115.                                               
       AUTHOR.          COGNIZANT.                                              
       INSTALLATION.    KOHLS DEPARTMENT STORES.                                
       DATE-WRITTEN.    APRIL 2014.                                             
       DATE-COMPILED.                                                           
                                                                                
      *****************************************************************         
      *   IMKUT115 - EXECUTE DB2 QUERY TO CHECK THE EXISTENCE OF A    *         
      *              SKU ON A PO LESS THAN 2 YEARS                    *         
      *                                                               *         
      *   THIS PROGRAM IS CALLED FROM IMKUT087.                       *         
      *   SKU NO IS PASSED IN FROM THE INPUT FILE AND THE             *         
      *   PV-RELATION-EXIST STATUS IS PASSED BACK TO IMKUT087.        *         
      *   IF FAIL PUSH ERROR MESSAGE BACK.                            *         
      *                                      CR NO :CHG0081766        *         
      *****************************************************************         
      * DB2 TABLES:                                                   *         
      *  1. TPLNSHP                                                   *         
      *  2. TPURITM                                                   *         
      *****************************************************************         
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  FILLER                          PIC X(30) VALUE                  
               '** BEGINING OF IMKUT888 W/S **'.                                
           05  PV-CURRENT-PARAGRAPH            PIC X(35) VALUE SPACES.          
                                                                                
                                                                                
       01  FILLER                              PIC  X(25)  VALUE                
           '** END OF IMKUT888 W/S **'.                                         
                                                                                
      *****************************************************************         
      *  DB2 MESSAGE AREA                                                       
      *****************************************************************         
           COPY SQLCA2.                                                         
                                                                                
      *****************************************************************         
      *    DB2 AREA FOR TABLES                                        *         
      *****************************************************************         
           EXEC SQL INCLUDE TPURITM END-EXEC.                                   
           EXEC SQL INCLUDE TPLNSHP END-EXEC.                                   
                                                                                
      *****************************************************************         
      *    SQL COMMUNICATIONS AREA DCLGEN                                       
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ********************                                                      
       EJECT                                                                    
      ********************                                                      
       LINKAGE SECTION.                                                         
      ********************                                                      
           COPY IMRD115.                                                        
      *******************************************                               
       PROCEDURE DIVISION USING IM115-PARAMETERS.                               
      *******************************************                               
                                                                                
      *---------------------------------------------------------------*         
      *    MAINLINE-LOGIC                                             *         
      *---------------------------------------------------------------*         
                                                                                
       0000-IMKUT115.                                                           
                                                                                
           PERFORM 2000-PROCESS-PARA                                            
                                                                                
           GOBACK.                                                              
                                                                                
       EJECT                                                                    
      *****************************************************************         
      *    PROCESS PARA                                               *         
      *****************************************************************         
       2000-PROCESS-PARA.                                                       
                                                                                
           MOVE '2000-PROCESS-PARA' TO PV-CURRENT-PARAGRAPH.                    
                                                                                
           EXEC SQL                                                             
                SELECT DECODE (COUNT(*),0,'N','Y')                              
                  INTO :IM115-RELATION-EXIST                                    
                  FROM SYSIBM.SYSDUMMY1                                         
                 WHERE EXISTS (SELECT A.PO_NBR                                  
                   FROM TPLNSHP A,TPURITM B                                     
                   WHERE A.PO_NBR = B.PO_NBR                                    
                   AND A.VER_STATUS_CDE = 'A'                                   
                   AND B.VER_STATUS_CDE = 'A'                                   
                   AND A.DONT_SHIP_BEF_DTE >= CURRENT DATE - 730 DAYS           
                   AND B.RMS_PO_SKU_NBR = :IM115-SKU)                           
           END-EXEC                                                             
                                                                                
           MOVE SQLCODE TO IM115-SQLCODE.                                       
                                                                                
       EJECT                                                                    
                                                                                
