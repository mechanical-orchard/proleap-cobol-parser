000300******************************************************************00030001
000400 IDENTIFICATION DIVISION.                                         00040001
000500******************************************************************00050001
000600                                                                  00060001
000700 PROGRAM-ID.             PCKUT058.                                00070001
000800 AUTHOR.                 DAN HINTZ.                               00080001
000900 INSTALLATION.           KOHLS.                                   00090001
001000 DATE-WRITTEN            JANUARY 2014.                            00100001
001100 DATE-COMPILED.                                                   00110001
001200                                                                  00120001
001300******************************************************************00130001
001400* THIS MODULE WILL CREATE A FLAT FILE OF STORES THAT WILL BE USED 00140001
001500* TO UNLOAD DATA FROM THE PCT_TRN_CLSN_DTL TABLE.                 00150001
001600******************************************************************00160001
001700                                                                  00170001
001800******************************************************************00180001
001900 ENVIRONMENT DIVISION.                                            00190001
003300                                                                  00191001
003400 CONFIGURATION SECTION.                                           00192001
003500                                                                  00193001
003600 SOURCE-COMPUTER.  IBM-3090.                                      00194001
003700 OBJECT-COMPUTER.  IBM-3090.                                      00195001
003800                                                                  00196001
003900 INPUT-OUTPUT SECTION.                                            00197001
004000                                                                  00198001
004100 FILE-CONTROL.                                                    00199001
004200                                                                  00199101
004300     SELECT PCRD046-STORE-NBR-FILE                                00199201
004400         ASSIGN TO INP01.                                         00199301
004600                                                                  00199401
004300     SELECT STORE-NBR-OUTPUT-FILE                                 00199503
004400         ASSIGN TO OUT01.                                         00199601
004600                                                                  00199701
004700 EJECT                                                            00199801
002000******************************************************************00200001
002100                                                                  00210001
002200******************************************************************00220001
002300 DATA DIVISION.                                                   00230001
005400                                                                  00231001
005500 FILE SECTION.                                                    00232001
005600                                                                  00233001
005700 FD  PCRD046-STORE-NBR-FILE                                       00234001
005800     RECORDING MODE IS F                                          00235001
005900     LABEL RECORDS ARE STANDARD                                   00236001
006000     BLOCK CONTAINS 0 RECORDS.                                    00237001
006100                                                                  00238001
006200 01  PCRD046-STORE-NBR-RECORD       PIC X(80).                    00239001
006300                                                                  00239101
005700 FD  STORE-NBR-OUTPUT-FILE                                        00239203
005800     RECORDING MODE IS F                                          00239301
005900     LABEL RECORDS ARE STANDARD                                   00239401
006000     BLOCK CONTAINS 0 RECORDS.                                    00239501
006100                                                                  00239601
006200 01  STORE-NBR-OUTPUT-RECORD        PIC X(80).                    00239703
006300                                                                  00239801
006300                                                                  00239901
002400******************************************************************00240001
002500                                                                  00250001
002600******************************************************************00260001
002700 WORKING-STORAGE SECTION.                                         00270001
002800******************************************************************00280001
004100                                                                  00410001
004200 01  PC-PROGRAM-CONSTANTS.                                        00420001
004500     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)                00450001
                                                       VALUE 'PCKUT058'.00460001
004900                                                                  00491001
005000 01  PS-PROGRAM-SWITCHES.                                         00500001
006231     05  PS-END-OF-STORE-FILE-SW         PIC X(01)  VALUE 'N'.    00623102
006232         88  PS-END-OF-STORE-FILE                   VALUE 'Y'.    00623202
006233         88  PS-NOT-END-OF-STORE-FILE               VALUE 'N'.    00623302
006231     05  PS-FIRST-RECORD-SW              PIC X(01)  VALUE 'N'.    00623402
006232         88  PS-FIRST-RECORD                        VALUE 'Y'.    00623502
006233         88  PS-NOT-FIRST-RECORD                    VALUE 'N'.    00623602
006300                                                                  00630001
006400 01  PV-PROGRAM-VARIABLES.                                        00640001
006500     05  PV-STORE-RECS-READ              PIC 9(03) VALUE ZERO.    00650002
006500     05  PV-STORE-RECS-WRITTEN           PIC 9(03) VALUE ZERO.    00650102
006500     05  PV-STORE-NBR-N                  PIC 9(04) VALUE ZERO.    00651004
006500     05  PV-STORE-NBR-ZZZ9               PIC ZZZ9.                00660004
010500                                                                  01050001
013800***************************************************************** 01050102
013800*    OUTPUT FILE RECORD                                           01050202
013800***************************************************************** 01050302
008000 01  OUT-OUTPUT-FILE-RECORD.                                      01050402
013700     05  FILLER                          PIC  X(17) VALUE SPACES. 01050502
013700     05  OUT-STORE-NBR                   PIC  X(05) VALUE SPACES. 01050602
013700     05  FILLER                          PIC  X(58) VALUE SPACES. 01050702
014800                                                                  01051502
010510*----------------------------------------------------------------*01051601
010520*  INTRANSIT UNLOAD FILE (CONTAINS STORE NUMBERS)                 01052001
010523*----------------------------------------------------------------*01052301
           COPY PCRD046.                                                01052601
014400                                                                  01440001
014500******************************************************************01450001
 14600 PROCEDURE DIVISION.                                              01460002
015300******************************************************************01530001
015400 0000-PROGRAM-MAINLINE.                                           01540001
015400                                                                  01541002
015500     INITIALIZE PV-PROGRAM-VARIABLES.                             01550001
015400                                                                  01550102
020200     OPEN INPUT  PCRD046-STORE-NBR-FILE                           01551002
020200          OUTPUT STORE-NBR-OUTPUT-FILE.                           01552003
015400                                                                  01554002
015600     SET PS-NOT-END-OF-STORE-FILE                                 01560002
015600         PS-FIRST-RECORD          TO TRUE.                        01570002
016210                                                                  01621001
017000     PERFORM 7000-READ-STORE-INPUT.                               01700002
017200                                                                  01720001
017600     PERFORM 2000-PROCESS-STORE-RECS                              01760002
017600         UNTIL PS-END-OF-STORE-FILE .                             01770002
024200                                                                  01771002
024100     PERFORM 3000-TERMINATE.                                      01780002
024200                                                                  01790002
024400     STOP RUN.                                                    01800002
018400                                                                  01840001
032000******************************************************************01840102
032100*  PROCESS THE STORE RECORDS FROM THE INPUT FILE                 *01840205
032200******************************************************************01840302
032300 2000-PROCESS-STORE-RECS.                                         01840402
032400                                                                  01840502
015500     INITIALIZE OUT-OUTPUT-FILE-RECORD.                           01840603
032500     MOVE PC046-LOC-NBR TO PV-STORE-NBR-N.                        01840703
                                                                        01840802
080100     IF  PS-FIRST-RECORD                                          01840902
080100         SET PS-NOT-FIRST-RECORD TO TRUE                          01841002
080100         MOVE PV-STORE-NBR-N     TO PV-STORE-NBR-ZZZ9             01841104
080100         STRING ' '               DELIMITED BY SIZE               01841204
080100                PV-STORE-NBR-ZZZ9 DELIMITED BY SIZE               01841304
080100                               INTO OUT-STORE-NBR                 01841404
080100     ELSE                                                         01841504
080100         MOVE PV-STORE-NBR-N     TO PV-STORE-NBR-ZZZ9             01841604
080100         STRING ','               DELIMITED BY SIZE               01841704
080100                PV-STORE-NBR-ZZZ9 DELIMITED BY SIZE               01841804
080100                               INTO OUT-STORE-NBR                 01841904
080100     END-IF.                                                      01842004
032600                                                                  01842104
032700     PERFORM 8000-WRITE-STORE-OUTPUT.                             01842204
032600                                                                  01842304
032700     PERFORM 7000-READ-STORE-INPUT.                               01842404
034700                                                                  01842502
035000 EJECT                                                            01842602
032000******************************************************************01842702
032100*  CLOSE FILES AND DISPLAY TOTALS OF RECORDS PROCESSED           *01842805
032200******************************************************************01842902
032300 3000-TERMINATE.                                                  01843002
032400                                                                  01843102
020200     CLOSE PCRD046-STORE-NBR-FILE                                 01843202
020200           STORE-NBR-OUTPUT-FILE.                                 01843303
032400                                                                  01843402
032400     DISPLAY '** PCKUT058 TOTALS **'.                             01843502
032400     DISPLAY '** STORE RECORDS READ...: ' PV-STORE-RECS-READ.     01843602
032400     DISPLAY '** STORE RECORDS WRITTEN: ' PV-STORE-RECS-WRITTEN.  01843702
032400                                                                  01843902
032400                                                                  01844002
032000******************************************************************01844102
032100*  READ A RECORD FROM THE STORE INPUT FILE                       *01844202
032200******************************************************************01844302
032300 7000-READ-STORE-INPUT.                                           01844402
032400                                                                  01844502
032500     READ PCRD046-STORE-NBR-FILE                                  01844602
               INTO PC046-INV-PARM-REC                                  01844702
080100            AT END SET PS-END-OF-STORE-FILE TO TRUE.              01844802
032600                                                                  01844902
032700     IF  PS-NOT-END-OF-STORE-FILE                                 01845002
032900           ADD 1 TO PV-STORE-RECS-READ                            01845102
032700     END-IF.                                                      01845202
034700                                                                  01845302
035000 EJECT                                                            01846002
051200***************************************************************** 03393002
051200*  WRITE A RECORD TO THE STORE NUMBER OUTPUT FILE                 03394002
051200***************************************************************** 03395002
050800 8000-WRITE-STORE-OUTPUT.                                         03396002
002800                                                                  03396102
050900     WRITE STORE-NBR-OUTPUT-RECORD                                03397003
               FROM OUT-OUTPUT-FILE-RECORD.                             03398003
051000                                                                  03399002
051100     ADD 1                TO PV-STORE-RECS-WRITTEN.               03400003
002800                                                                  03410002
