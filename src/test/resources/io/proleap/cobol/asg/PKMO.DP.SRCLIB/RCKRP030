000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.             RCKRP030.                                00040001
000500 AUTHOR.                 JOE LAROSA.                              00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN.           MARCH, 2000                              00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*                                                               * 00100001
001100*  WEEKLY UNIT VARIANCE - ESTIMATED (PACKSLIP) TO ACTUAL (DC)   * 00110001
001200*                                                               * 00120001
001300***************************************************************** 00130001
001400*                                                                 00140001
001500***************************************************************** 00150001
001600 ENVIRONMENT DIVISION.                                            00160001
001700***************************************************************** 00170001
001800 CONFIGURATION SECTION.                                           00180001
001900                                                                  00190001
002000 SOURCE-COMPUTER.        IBM-3090.                                00200001
002100 OBJECT-COMPUTER.        IBM-3090.                                00210001
002200                                                                  00220001
002300***************************************************************** 00230001
002400 INPUT-OUTPUT SECTION.                                            00240001
002500                                                                  00250001
002600 FILE-CONTROL.                                                    00260001
002700                                                                  00270001
002800     SELECT INPUT-EXTRACT-FILE                                    00280001
002900         ASSIGN TO INP01.                                         00290001
003000                                                                  00300001
003100     SELECT OUTPUT-REPORT                                         00310001
003200         ASSIGN TO RPT01.                                         00320001
003300                                                                  00330001
003400***************************************************************** 00340001
003500 DATA DIVISION.                                                   00350001
003600***************************************************************** 00360001
003700 FILE SECTION.                                                    00370001
003800                                                                  00380001
003900 FD  INPUT-EXTRACT-FILE                                           00390001
004000     LABEL RECORDS ARE STANDARD                                   00400001
004100     RECORDING MODE IS F                                          00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     RECORD CONTAINS 170 CHARACTERS.                              00430010
004400 01  EXTRACT-REC                     PIC X(170).                  00440010
004500                                                                  00450001
004600 FD  OUTPUT-REPORT                                                00460001
004700     RECORDING MODE IS F                                          00470001
004800     BLOCK CONTAINS 0  RECORDS.                                   00480001
004900 01  OUTPUT-REC                      PIC X(132).                  00490001
005000                                                                  00500001
005100***************************************************************** 00510001
005200 WORKING-STORAGE SECTION.                                         00520001
005300                                                                  00530001
005400 01  PROGRAM-SWITCHES.                                            00540001
005500     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00550001
005600         88  PS-END-OF-INPUT                   VALUE 'Y'.         00560001
005700         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00570001
005800     05  PS-END-OF-CURSOR-SW         PIC X(01) VALUE 'N'.         00580013
005900         88  PS-END-OF-CURSOR-YES              VALUE 'Y'.         00590013
006000         88  PS-END-OF-CURSOR-NO               VALUE 'N'.         00600013
006100                                                                  00610001
006200 01  PC-PROGRAM-CONSTANTS.                                        00620001
006300     05  PC-RCKRP030                 PIC X(08) VALUE              00630001
006400                                               'RCKRP030'.        00640001
006500     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00650001
006600     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00660012
006700                                               COMP-3.            00670001
006800                                                                  00680001
006900 01  PV-PROGRAM-VARIABLES.                                        00690001
007000     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00700001
007100     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00710001
007200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00720001
007300                                               COMP-3.            00730001
007400     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00740001
007500                                               COMP-3.            00750001
007600     05  PV-REC-IN-QTY               PIC 9(07).                   00760001
007700     05  PV-REC-OUT-QTY              PIC 9(07).                   00770001
007800     05  PV-VAR-PCT                  PIC S9(9)V9(8).              00780001
007900     05  PV-STORE-DESC               PIC X(15).                   00790001
008000     05  DK-STORE                    PIC X(04).                   00800001
008100     05  FILLER REDEFINES DK-STORE.                               00810001
008200         10  DK-STORE-1              PIC X(01).                   00820001
008300         10  DK-STORE-3              PIC X(03).                   00830001
008400     05  PV-COMPARE-FIELDS.                                       00840001
008500         10  PV-CURR-VEND            PIC X(30) VALUE SPACES.      00850001
008600         10  PV-CURR-DC              PIC 9(04) VALUE ZEROES.      00860003
008700         10  PV-CURR-AP              PIC X(01) VALUE SPACES.      00870003
008800         10  PV-CURR-PO-NBR          PIC S9(9) VALUE ZEROES.      00880001
008900         10  PV-CURR-REC-SEQ-NBR     PIC S9(9) VALUE ZEROES.      00890001
009000     05  PV-VRFD-DATE.                                            00900008
009100         10  PV-VRFD-DATE-CC         PIC X(02) VALUE SPACES.      00910008
009200         10  PV-VRFD-DATE-YY         PIC X(02) VALUE SPACES.      00920008
009300         10  PV-VRFD-DATE-H1         PIC X(01) VALUE '-'.         00930008
009400         10  PV-VRFD-DATE-MM         PIC X(02) VALUE SPACES.      00940008
009500         10  PV-VRFD-DATE-H2         PIC X(01) VALUE '-'.         00950008
009600         10  PV-VRFD-DATE-DD         PIC X(02) VALUE SPACES.      00960008
009700                                                                  00970001
009800     05  PV-ACCUMULATORS.                                         00980001
009900         10  PV-ACCUM-EXPTD-UNTS-VEND PIC S9(9) VALUE ZEROES.     00990004
010000         10  PV-ACCUM-VRFD-UNTS-VEND PIC S9(9) VALUE ZEROES.      01000004
010100         10  PV-ACCUM-VAR-AMT-VEND   PIC S9(9) VALUE ZEROES.      01010004
010200         10  PV-ACCUM-PO-COUNT-VEND  PIC S9(9) VALUE ZEROES.      01020004
010300         10  PV-ACCUM-EXPTD-UNTS-ALL PIC S9(9) VALUE ZEROES.      01030004
010400         10  PV-ACCUM-VRFD-UNTS-ALL  PIC S9(9) VALUE ZEROES.      01040004
010500         10  PV-ACCUM-VAR-AMT-ALL    PIC S9(9) VALUE ZEROES.      01050004
010600         10  PV-ACCUM-PO-COUNT-ALL   PIC S9(9) VALUE ZEROES.      01060004
010700                                                                  01070001
010800     05  PV-FORMAT-FIELDS.                                        01080001
010900         10  PV-FORMAT-3             PIC ZZ9.                     01090001
011000         10  PV-FORMAT-4             PIC ZZZ9.                    01100001
011100         10  PV-FORMAT-6             PIC ZZZ,ZZ9.                 01110001
011110         10  PV-FORMAT-6S            PIC ZZZ,ZZ9-.                01111015
011200         10  PV-FORMAT-7             PIC ZZZZZZ9.                 01120001
011300         10  PV-FORMAT-PO-RCVR.                                   01130001
011400             15  PV-FORMAT-PO        PIC 9(08).                   01140001
011500             15  PV-FORMAT-HYPHEN    PIC X(01) VALUE '-'.         01150001
011600             15  PV-FORMAT-RCVR      PIC 9(03).                   01160001
011700                                                                  01170001
011800     05  PV-TODAYS-DATE.                                          01180001
011900         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01190001
012000         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01200001
012100         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01210001
012200     05  PV-TODAYS-DATE-YYYY.                                     01220001
012300         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01230001
012400         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01240001
012500                                                                  01250001
012600     05  PV-TODAYS-TIME.                                          01260001
012700         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01270001
012800         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01280001
012900         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01290001
013000         10  FILLER                  PIC 9(02) VALUE ZERO.        01300001
013100                                                                  01310001
013200 01  PV-ABEND-FIELDS.                                             01320001
013300     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01330001
013400                                               COMP SYNC.         01340001
013500     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP030'.  01350001
013600     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01360001
013700     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01370001
013800     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01380001
013900     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01390001
014000     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01400001
014100     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01410001
014200     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01420001
014300     05  PV-DB2-TABLE-NAME           PIC X(08) VALUE SPACES.      01430001
014400                                                                  01440001
014500******************************************************************01450001
014600*  RECORD LAYOUT FOR INPUT FILE                                   01460001
014700******************************************************************01470008
014800     COPY RCRD051.                                                01480008
014900                                                                  01490001
015000******************************************************************01500001
015100*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01510001
015200******************************************************************01520001
015300     COPY DPWS132.                                                01530001
015400                                                                  01540001
015500 01  WS-BATCH-PROC-DATE.                                          01550001
015600     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      01560001
015700     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      01570001
015800     05  FILLER                      PIC X(01) VALUE SPACES.      01580001
015900     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      01590001
016000     05  FILLER                      PIC X(01) VALUE SPACES.      01600001
016100     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      01610001
016200*                                                                 01620001
016300 01  HEADING-LINES.                                               01630001
016400     05  HEADING-LINE-1.                                          01640001
016500         10  FILLER                  PIC X(37) VALUE SPACES.      01650001
016600         10  FILLER                  PIC X(46) VALUE              01660001
016700             'WEEKLY UNIT VARIANCE - ESTIMATED (PACKSLIP) TO'.    01670001
016800         10  FILLER                  PIC X(12) VALUE              01680007
016900                                               ' ACTUAL (DC)'.    01690007
017000         10  FILLER                  PIC X(37) VALUE SPACES.      01700007
017100                                                                  01710001
017200     05  HEADING-LINE-2.                                          01720001
017300         10  FILLER                  PIC X(01) VALUE SPACES.      01730002
017400         10  FILLER                  PIC X(25) VALUE              01740002
017500                                     'VENDOR NAME              '. 01750002
017600         10  FILLER                  PIC X(01) VALUE SPACES.      01760002
017700         10  FILLER                  PIC X(04) VALUE '   '.       01770002
017800         10  FILLER                  PIC X(01) VALUE SPACES.      01780002
017900         10  FILLER                  PIC X(08) VALUE '  VRFY  '.  01790002
018000         10  FILLER                  PIC X(01) VALUE SPACES.      01800002
018100         10  FILLER                  PIC X(09) VALUE '   A/P   '. 01810002
018200         10  FILLER                  PIC X(01) VALUE SPACES.      01820002
018300         10  FILLER                  PIC X(12) VALUE              01830002
018400                                     '   PO/RCVR  '.              01840002
018500         10  FILLER                  PIC X(01) VALUE SPACES.      01850002
018600         10  FILLER                  PIC X(04) VALUE 'DEPT'.      01860002
018700         10  FILLER                  PIC X(01) VALUE SPACES.      01870002
018800         10  FILLER                  PIC X(06) VALUE ' PROC '.    01880002
018900         10  FILLER                  PIC X(02) VALUE SPACES.      01890002
019000         10  FILLER                  PIC X(07) VALUE 'EXPECTD'.   01900002
019100         10  FILLER                  PIC X(02) VALUE SPACES.      01910002
019200         10  FILLER                  PIC X(07) VALUE '  ADJ  '.   01920002
019300         10  FILLER                  PIC X(02) VALUE SPACES.      01930002
019400         10  FILLER                  PIC X(07) VALUE 'EXPECTD'.   01940002
019500         10  FILLER                  PIC X(02) VALUE SPACES.      01950002
019600         10  FILLER                  PIC X(07) VALUE ' VERIFD'.   01960002
019700         10  FILLER                  PIC X(02) VALUE SPACES.      01970002
019800         10  FILLER                  PIC X(04) VALUE 'UNIT'.      01980002
019900         10  FILLER                  PIC X(02) VALUE SPACES.      01990002
020000         10  FILLER                  PIC X(07) VALUE ' DOLLAR'.   02000002
020100         10  FILLER                  PIC X(02) VALUE SPACES.      02010002
020200         10  FILLER                  PIC X(04) VALUE 'STYL'.      02020002
020300                                                                  02030001
020400     05  HEADING-LINE-3.                                          02040001
020500         10  FILLER                  PIC X(01) VALUE SPACES.      02050002
020600         10  FILLER                  PIC X(25) VALUE SPACES.      02060002
020700         10  FILLER                  PIC X(01) VALUE SPACES.      02070002
020800         10  FILLER                  PIC X(04) VALUE ' DC'.       02080002
020900         10  FILLER                  PIC X(01) VALUE SPACES.      02090002
021000         10  FILLER                  PIC X(08) VALUE '  DATE  '.  02100002
021100         10  FILLER                  PIC X(01) VALUE SPACES.      02110002
021200         10  FILLER                  PIC X(09) VALUE ' VEND NBR'. 02120002
021300         10  FILLER                  PIC X(01) VALUE SPACES.      02130002
021400         10  FILLER                  PIC X(12) VALUE SPACES.      02140002
021500         10  FILLER                  PIC X(01) VALUE SPACES.      02150002
021600         10  FILLER                  PIC X(04) VALUE ' NBR'.      02160002
021700         10  FILLER                  PIC X(01) VALUE SPACES.      02170002
021800         10  FILLER                  PIC X(06) VALUE ' AREA '.    02180002
021900         10  FILLER                  PIC X(02) VALUE SPACES.      02190002
022000         10  FILLER                  PIC X(07) VALUE '  CTNS '.   02200002
022100         10  FILLER                  PIC X(02) VALUE SPACES.      02210002
022200         10  FILLER                  PIC X(07) VALUE '  CTNS '.   02220002
022300         10  FILLER                  PIC X(02) VALUE SPACES.      02230002
022400         10  FILLER                  PIC X(07) VALUE ' UNITS '.   02240002
022500         10  FILLER                  PIC X(02) VALUE SPACES.      02250002
022600         10  FILLER                  PIC X(07) VALUE ' UNITS '.   02260002
022700         10  FILLER                  PIC X(02) VALUE SPACES.      02270002
022800         10  FILLER                  PIC X(04) VALUE 'VAR '.      02280002
022900         10  FILLER                  PIC X(02) VALUE SPACES.      02290002
023000         10  FILLER                  PIC X(07) VALUE '  VAR  '.   02300002
023100         10  FILLER                  PIC X(02) VALUE SPACES.      02310002
023200         10  FILLER                  PIC X(04) VALUE 'SUB '.      02320002
023300                                                                  02330001
023400     05  HEADING-LINE-4.                                          02340001
023500         10  FILLER                  PIC X(01) VALUE SPACES.      02350001
023600         10  FILLER                  PIC X(25) VALUE ALL '-'.     02360001
023700         10  FILLER                  PIC X(01) VALUE SPACES.      02370001
023800         10  FILLER                  PIC X(04) VALUE ALL '-'.     02380001
023900         10  FILLER                  PIC X(01) VALUE SPACES.      02390001
024000         10  FILLER                  PIC X(08) VALUE ALL '-'.     02400001
024100         10  FILLER                  PIC X(01) VALUE SPACES.      02410001
024200         10  FILLER                  PIC X(09) VALUE ALL '-'.     02420002
024300         10  FILLER                  PIC X(01) VALUE SPACES.      02430001
024400         10  FILLER                  PIC X(12) VALUE ALL '-'.     02440001
024500         10  FILLER                  PIC X(01) VALUE SPACES.      02450002
024600         10  FILLER                  PIC X(04) VALUE ALL '-'.     02460001
024700         10  FILLER                  PIC X(01) VALUE SPACES.      02470002
024800         10  FILLER                  PIC X(06) VALUE ALL '-'.     02480001
024900         10  FILLER                  PIC X(02) VALUE SPACES.      02490001
025000         10  FILLER                  PIC X(07) VALUE ALL '-'.     02500001
025100         10  FILLER                  PIC X(02) VALUE SPACES.      02510002
025200         10  FILLER                  PIC X(07) VALUE ALL '-'.     02520001
025300         10  FILLER                  PIC X(02) VALUE SPACES.      02530001
025400         10  FILLER                  PIC X(07) VALUE ALL '-'.     02540002
025500         10  FILLER                  PIC X(02) VALUE SPACES.      02550001
025600         10  FILLER                  PIC X(07) VALUE ALL '-'.     02560001
025700         10  FILLER                  PIC X(02) VALUE SPACES.      02570001
025800         10  FILLER                  PIC X(04) VALUE ALL '-'.     02580001
025900         10  FILLER                  PIC X(02) VALUE SPACES.      02590001
026000         10  FILLER                  PIC X(07) VALUE ALL '-'.     02600001
026100         10  FILLER                  PIC X(02) VALUE SPACES.      02610002
026200         10  FILLER                  PIC X(04) VALUE ALL '-'.     02620002
026300                                                                  02630004
026400 01  DETAIL-LINES.                                                02640001
026500     05  DETAIL-LINE-1.                                           02650001
026600         10  FILLER                  PIC X(01) VALUE SPACES.      02660002
026700         10  DL1-VEND-NAME           PIC X(25) VALUE SPACES.      02670002
026800         10  FILLER                  PIC X(01) VALUE SPACES.      02680002
026900         10  DL1-DC                  PIC ZZZ9.                    02690003
027000         10  FILLER                  PIC X(01) VALUE SPACES.      02700002
027100         10  DL1-VERIFY-MM           PIC X(02) VALUE SPACES.      02710003
027200         10  FILLER                  PIC X(01) VALUE '/'.         02720003
027300         10  DL1-VERIFY-DD           PIC X(02) VALUE SPACES.      02730003
027400         10  FILLER                  PIC X(01) VALUE '/'.         02740003
027500         10  DL1-VERIFY-YY           PIC X(02) VALUE SPACES.      02750003
027600         10  FILLER                  PIC X(01) VALUE SPACES.      02760002
027700         10  DL1-VEND-NBR            PIC Z(8)9 VALUE ZEROES.      02770003
027800         10  FILLER                  PIC X(01) VALUE SPACES.      02780002
027900         10  DL1-PO-RCVR             PIC X(12) VALUE SPACES.      02790003
028000         10  FILLER                  PIC X(01) VALUE SPACES.      02800002
028100         10  DL1-DEPT                PIC X(03) VALUE SPACES.      02810003
028200         10  FILLER                  PIC X(02) VALUE SPACES.      02820003
028300         10  DL1-PROC-AREA           PIC X(06) VALUE SPACES.      02830003
028400         10  FILLER                  PIC X(02) VALUE SPACES.      02840002
028500         10  DL1-EXPCTD-CTNS         PIC X(07) VALUE SPACES.      02850003
028600         10  FILLER                  PIC X(02) VALUE SPACES.      02860002
028700         10  DL1-ACTUAL-CTNS         PIC X(07) VALUE SPACES.      02870008
028800         10  FILLER                  PIC X(02) VALUE SPACES.      02880002
028900         10  DL1-EXPCTD-UNTS         PIC X(07) VALUE SPACES.      02890003
029000         10  FILLER                  PIC X(02) VALUE SPACES.      02900002
029100         10  DL1-VERIFD-UNTS         PIC X(07) VALUE SPACES.      02910003
029200         10  FILLER                  PIC X(02) VALUE SPACES.      02920002
029300         10  DL1-UNIT-VAR            PIC ZZ9   VALUE ZEROES.      02930003
029400         10  FILLER                  PIC X(01) VALUE '%'.         02940003
029500         10  FILLER                  PIC X(02) VALUE SPACES.      02950002
029600         10  DL1-DOLLAR-VAR          PIC X(08) VALUE SPACES.      02960015
029700         10  FILLER                  PIC X(02) VALUE SPACES.      02970015
029800         10  DL1-STYLE-SUB           PIC X(01) VALUE SPACES.      02980001
029900         10  FILLER                  PIC X(02) VALUE SPACES.      02990003
030000                                                                  03000001
030100 01  TOTAL-LINES.                                                 03010001
030200     05  TOTAL-LINE-1.                                            03020001
030300         10  FILLER                  PIC X(23) VALUE SPACES.      03030003
030400         10  FILLER                  PIC X(27) VALUE              03040003
030500             'TOTAL PO/RCVRS FOR VENDOR: '.                       03050003
030600         10  TL1-PO-COUNT            PIC X(07).                   03060001
030700         10  FILLER                  PIC X(16) VALUE SPACES.      03070006
030800         10  FILLER                  PIC X(18) VALUE              03080003
030900                                     'TOTALS FOR VENDOR:'.        03090003
031000         10  FILLER                  PIC X(04) VALUE SPACES.      03100006
031100         10  TL1-EXPCTD-UNTS         PIC X(07) VALUE SPACES.      03110001
031200         10  FILLER                  PIC X(02) VALUE SPACES.      03120001
031300         10  TL1-VERIFD-UNTS         PIC X(07) VALUE SPACES.      03130001
031400         10  FILLER                  PIC X(02) VALUE SPACES.      03140001
031500         10  TL1-UNIT-VAR            PIC X(03) VALUE SPACES.      03150001
031600         10  FILLER                  PIC X(01) VALUE '%'.         03160001
031700         10  FILLER                  PIC X(02) VALUE SPACES.      03170001
031800         10  TL1-DOLLAR-VAR          PIC X(08) VALUE SPACES.      03180016
031900         10  FILLER                  PIC X(05) VALUE SPACES.      03190016
032000                                                                  03200001
032100     05  TOTAL-LINE-2.                                            03210003
032200         10  FILLER                  PIC X(01) VALUE SPACES.      03220003
032300         10  FILLER                  PIC X(32) VALUE              03230003
032400             'TOTAL PO/RCVRS FOR ALL VENDORS: '.                  03240003
032500         10  TL2-PO-COUNT            PIC X(07).                   03250003
032600         10  FILLER                  PIC X(28) VALUE SPACES.      03260006
032700         10  FILLER                  PIC X(23) VALUE              03270003
032800                                     'TOTALS FOR ALL VENDORS:'.   03280003
032900         10  FILLER                  PIC X(04) VALUE SPACES.      03290006
033000         10  TL2-EXPCTD-UNTS         PIC X(07) VALUE SPACES.      03300003
033100         10  FILLER                  PIC X(02) VALUE SPACES.      03310003
033200         10  TL2-VERIFD-UNTS         PIC X(07) VALUE SPACES.      03320003
033300         10  FILLER                  PIC X(02) VALUE SPACES.      03330003
033400         10  TL2-UNIT-VAR            PIC X(03) VALUE SPACES.      03340003
033500         10  FILLER                  PIC X(01) VALUE '%'.         03350003
033600         10  FILLER                  PIC X(02) VALUE SPACES.      03360003
033700         10  TL2-DOLLAR-VAR          PIC X(08) VALUE SPACES.      03370016
033800         10  FILLER                  PIC X(05) VALUE SPACES.      03380016
033900                                                                  03390003
034000 01  SUMMARY-LINES.                                               03400011
034100     05  SUMMARY-LINE-1.                                          03410011
034200         10  FILLER                  PIC X(01) VALUE SPACES.      03420011
034300         10  FILLER                  PIC X(03) VALUE 'DC '.       03430011
034400         10  SL1-DC                  PIC ZZZ9.                    03440011
034500         10  FILLER                  PIC X(04) VALUE ' -  '.      03450011
034600         10  FILLER                  PIC X(24) VALUE              03460011
034700                                 'DOLLAR VARIANCE PERCENT '.      03470011
034800         10  SL1-DOL-PCT             PIC ZZ9.                     03480011
034900         10  FILLER                  PIC X(04) VALUE '%   '.      03490011
035000         10  FILLER                  PIC X(24) VALUE              03500011
035100                                 ' DOLLAR VARIANCE AMOUNT '.      03510014
035200         10  SL1-DOL-AMT             PIC $$$$$.99.                03520011
035300         10  FILLER                  PIC X(57) VALUE SPACES.      03530011
035400                                                                  03540011
035500 01  MISCELLANEOUS-LINES.                                         03550003
035600     05  BLANK-LINE.                                              03560001
035700         10  FILLER                  PIC X(132) VALUE SPACES.     03570001
035800                                                                  03580001
035900     05  END-OF-REPORT-LINE.                                      03590001
036000         10  FILLER                  PIC X(44) VALUE SPACES.      03600001
036100         10  FILLER                  PIC X(45) VALUE              03610001
036200             '*******   E N D   O F   R E P O R T   *******'.     03620001
036300         10  FILLER                  PIC X(43) VALUE SPACES.      03630001
036400                                                                  03640001
036500     05  NO-MISDIRECT-DATA-LINE.                                  03650001
036600         10  FILLER                  PIC X(01) VALUE SPACES.      03660001
036700         10  FILLER                  PIC X(23) VALUE              03670001
036800                                     '** NO DATA TO REPORT **'.   03680001
036900         10  FILLER                  PIC X(108) VALUE SPACES.     03690001
037000                                                                  03700001
037100     05  NO-DATA-TO-REPORT-LINE.                                  03710001
037200         10  FILLER                  PIC X(40) VALUE SPACES.      03720001
037300         10  FILLER                  PIC  X(52)    VALUE          03730001
037400         '*******  N O   D A T A   T O   R E P O R T   *******'.  03740001
037500         10  FILLER                  PIC  X(40)    VALUE SPACES.  03750001
037600                                                                  03760001
037700******************************************************************03770001
037800*  USED FOR DB2 ERROR MESSAGE BUILDING                            03780001
037900******************************************************************03790001
038000     COPY DPWS004.                                                03800018
038100                                                                  03810001
038200******************************************************************03820001
038300*   DB2 SQL COMMUNICATION AREA                                    03830001
038400******************************************************************03840001
038500     EXEC SQL                                                     03850001
038600          INCLUDE SQLCA                                           03860001
038700     END-EXEC.                                                    03870001
038800                                                                  03880001
038900******************************************************************03890001
039000*  DCLGEN FOR THE COMPANY CONTROL TABLE                           03900001
039100******************************************************************03910001
039200     EXEC SQL                                                     03920001
039300          INCLUDE TCOCNTL                                         03930001
039400     END-EXEC.                                                    03940001
039500                                                                  03950001
039600     EXEC SQL                                                     03960012
039700         DECLARE DC-CSR CURSOR FOR                                03970012
039800          SELECT OPER_UNT_ID                                      03980012
039900               , UNT_VRFN_VARN_PCT                                03990012
040000               , DOL_VRFN_VARN_PCT                                04000012
040100               , DOL_VARN_THRS_AMT                                04010012
040200            FROM TCOCNTL                                          04020012
040300        ORDER BY OPER_UNT_ID ASC                                  04030012
040400     END-EXEC.                                                    04040012
040500                                                                  04050012
040600/*****************************************************************04060001
040700******************************************************************04070001
040800 PROCEDURE DIVISION.                                              04080001
040900     DISPLAY '**** START OF RCKRP030 ****'.                       04090003
041000                                                                  04100001
041100*OPEN FILES.                                                      04110001
041200     OPEN INPUT  INPUT-EXTRACT-FILE                               04120001
041300          OUTPUT OUTPUT-REPORT.                                   04130001
041400                                                                  04140001
041500*READ FIRST INPUT RECORD.                                         04150001
041600     SET PS-NOT-END-OF-INPUT TO TRUE.                             04160001
041700     MOVE 0 TO PV-REC-IN-QTY.                                     04170001
041800     PERFORM 0100-READ-EXTRACT.                                   04180001
041900                                                                  04190001
042000*SET/PRINT REPORT HEADINGS.                                       04200001
042100     IF NOT PS-END-OF-INPUT                                       04210001
042200         MOVE RC051-VENDOR-NAME-DUNNS TO PV-CURR-VEND             04220009
042300         MOVE 1                       TO PV-REC-IN-QTY            04230009
042400     END-IF.                                                      04240001
042500     DISPLAY '  ** 1000-INITIALIZATION **'.                       04250001
042600     PERFORM 1000-INITIALIZATION.                                 04260001
042700     DISPLAY '  ** 1000-INITIALIZATION DONE **'.                  04270001
042800                                                                  04280001
042900*PROCESS INPUT FILE.                                              04290001
043000     IF PS-END-OF-INPUT                                           04300001
043100         PERFORM 1300-NO-DETAIL-LINE                              04310001
043200     ELSE                                                         04320001
043300         PERFORM 2000-PROCESS-EXTRACT                             04330001
043400           UNTIL PS-END-OF-INPUT                                  04340001
043500         PERFORM 2200-PRINT-VEND-TOTAL                            04350003
043600         PERFORM 2300-PRINT-GRAND-TOTAL                           04360003
043700     END-IF.                                                      04370001
043800                                                                  04380001
043900     DISPLAY '**** RECORDS READ    ==> ' PV-REC-IN-QTY.           04390001
044000     DISPLAY '**** RECORDS WRITTEN ==> ' PV-REC-OUT-QTY.          04400001
044100                                                                  04410001
044200*WRITE DC SUMMARY LINES.                                          04420011
044300     PERFORM 3000-PRINT-SUMMARY.                                  04430011
044400                                                                  04440001
044500*WRITE END-OF-REPORT LINE.                                        04450011
044600     PERFORM 1400-END-OF-RPT-LINE.                                04460011
044700                                                                  04470011
044800*CLOSE FILES.                                                     04480001
044900     CLOSE INPUT-EXTRACT-FILE                                     04490001
045000           OUTPUT-REPORT.                                         04500001
045100                                                                  04510001
045200     GOBACK.                                                      04520001
045300                                                                  04530001
045400******************************************************************04540001
045500*  READ NEXT INPUT FILE RECORD.                                  *04550001
045600******************************************************************04560001
045700 0100-READ-EXTRACT.                                               04570001
045800                                                                  04580001
045900     READ INPUT-EXTRACT-FILE INTO RC051-RECORD                    04590008
046000       AT END                                                     04600001
046100           SET PS-END-OF-INPUT TO TRUE.                           04610001
046200                                                                  04620001
046300******************************************************************04630001
046400*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *04640001
046500******************************************************************04650001
046600 1000-INITIALIZATION.                                             04660001
046700                                                                  04670001
046800     ACCEPT PV-TODAYS-DATE FROM DATE.                             04680001
046900     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                04690001
047000     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  04700001
047100     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              04710001
047200     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 04720001
047300                                                                  04730001
047400     ACCEPT PV-TODAYS-TIME FROM TIME.                             04740001
047500     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 04750001
047600     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               04760001
047700                                                                  04770001
047800     MOVE PC-RCKRP030          TO DP132-PROGRAM-NAME.             04780003
047900     MOVE PC-REPORT-NBR        TO DP132-REPORT-NUMBER.            04790001
048000                                                                  04800001
048100     MOVE +0                   TO PV-REC-OUT-QTY.                 04810001
048200                                                                  04820001
048300     MOVE +0                   TO PV-PAGE-COUNT                   04830001
048400                                  PV-ACCUM-EXPTD-UNTS-VEND        04840003
048500                                  PV-ACCUM-VRFD-UNTS-VEND         04850003
048600                                  PV-ACCUM-VAR-AMT-VEND           04860003
048700                                  PV-ACCUM-PO-COUNT-VEND          04870003
048800                                  PV-ACCUM-EXPTD-UNTS-ALL         04880003
048900                                  PV-ACCUM-VRFD-UNTS-ALL          04890003
049000                                  PV-ACCUM-VAR-AMT-ALL            04900003
049100                                  PV-ACCUM-PO-COUNT-ALL.          04910003
049200                                                                  04920001
049300     PERFORM 1200-PRINT-HEADINGS.                                 04930001
049400                                                                  04940001
049500******************************************************************04950001
049600*  PRINT THE REPORT HEADINGS.                                    *04960001
049700******************************************************************04970001
049800 1200-PRINT-HEADINGS.                                             04980001
049900                                                                  04990001
050000     ADD +1 TO PV-PAGE-COUNT.                                     05000001
050100     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     05010001
050200                                                                  05020001
050300     WRITE OUTPUT-REC                                             05030001
050400       FROM DP132-STANDRD-HEADER-132-COLS                         05040001
050500         AFTER ADVANCING PAGE.                                    05050001
050600                                                                  05060001
050700     WRITE OUTPUT-REC                                             05070001
050800       FROM HEADING-LINE-1                                        05080001
050900         AFTER ADVANCING 2 LINES.                                 05090001
051000                                                                  05100001
051100     PERFORM 1210-PRINT-SUB-HEADINGS.                             05110003
051200                                                                  05120001
051300     MOVE +9 TO PV-LINE-COUNT.                                    05130003
051400                                                                  05140003
051500******************************************************************05150003
051600*  PRINT REPORT SUB-HEADINGS.                                    *05160003
051700******************************************************************05170003
051800 1210-PRINT-SUB-HEADINGS.                                         05180003
051900                                                                  05190003
052000     WRITE OUTPUT-REC                                             05200003
052100       FROM HEADING-LINE-2                                        05210003
052200         AFTER ADVANCING 3 LINES.                                 05220003
052300                                                                  05230003
052400     WRITE OUTPUT-REC                                             05240003
052500       FROM HEADING-LINE-3                                        05250003
052600         AFTER ADVANCING 1 LINES.                                 05260003
052700                                                                  05270003
052800     WRITE OUTPUT-REC                                             05280003
052900       FROM HEADING-LINE-4                                        05290003
053000         AFTER ADVANCING 1 LINES.                                 05300003
053100                                                                  05310003
053200     WRITE OUTPUT-REC                                             05320003
053300       FROM BLANK-LINE                                            05330003
053400         AFTER ADVANCING 1 LINES.                                 05340003
053500                                                                  05350003
053600******************************************************************05360001
053700*  PRINT A 'NO INPUT' REPORT LINE.                               *05370001
053800******************************************************************05380001
053900 1300-NO-DETAIL-LINE.                                             05390001
054000                                                                  05400001
054100     WRITE OUTPUT-REC                                             05410001
054200       FROM NO-DATA-TO-REPORT-LINE                                05420001
054300         AFTER ADVANCING 3 LINES.                                 05430001
054400                                                                  05440001
054500******************************************************************05450001
054600*  PRINT A 'END OF REPORT' REPORT LINE.                          *05460001
054700******************************************************************05470001
054800 1400-END-OF-RPT-LINE.                                            05480001
054900                                                                  05490001
055000*CHECK FOR OVERFLOW.                                              05500001
055100     ADD 3 TO PV-LINE-COUNT.                                      05510001
055200     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05520001
055300         PERFORM 1200-PRINT-HEADINGS                              05530001
055400     END-IF.                                                      05540001
055500                                                                  05550001
055600*PRINT LINE.                                                      05560001
055700     WRITE OUTPUT-REC                                             05570001
055800       FROM END-OF-REPORT-LINE                                    05580001
055900         AFTER ADVANCING 3 LINES.                                 05590001
056000                                                                  05600001
056100******************************************************************05610001
056200*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR READING THE INPUT  *05620001
056300*  EXTRACT FILE (FORMAT RCRD051) AND WRITING THE 'WEEKLY UNIT    *05630008
056400*  VARIANCE - ESTIMATED (PACKSLIP) TO ACTUAL (DC)' REPORT.       *05640003
056500******************************************************************05650011
056600 2000-PROCESS-EXTRACT.                                            05660001
056700                                                                  05670001
056800*CHECK FOR BREAKS.                                                05680001
056900     IF RC051-VENDOR-NAME-DUNNS NOT = PV-CURR-VEND                05690009
057000         PERFORM 2200-PRINT-VEND-TOTAL                            05700003
057100                                                                  05710006
057200         ADD 6 TO PV-LINE-COUNT                                   05720006
057300         IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                     05730006
057400             PERFORM 1200-PRINT-HEADINGS                          05740006
057500         ELSE                                                     05750006
057600             PERFORM 1210-PRINT-SUB-HEADINGS                      05760006
057700         END-IF                                                   05770006
057800                                                                  05780006
057900         MOVE RC051-VENDOR-NAME-DUNNS TO PV-CURR-VEND             05790009
058000         MOVE +0 TO PV-ACCUM-EXPTD-UNTS-VEND                      05800009
058100                    PV-ACCUM-VRFD-UNTS-VEND                       05810009
058200                    PV-ACCUM-VAR-AMT-VEND                         05820009
058300                    PV-ACCUM-PO-COUNT-VEND                        05830009
058400     END-IF.                                                      05840001
058500                                                                  05850001
058600*PRINT DETAIL LINE.                                               05860001
058700     PERFORM 2100-PRINT-DETAIL.                                   05870001
058800     ADD +1 TO PV-REC-OUT-QTY.                                    05880001
058900                                                                  05890001
059000*READ NEXT INPUT RECORD.                                          05900001
059100     PERFORM 0100-READ-EXTRACT.                                   05910001
059200     IF NOT PS-END-OF-INPUT                                       05920001
059300         ADD +1 TO PV-REC-IN-QTY                                  05930001
059400     END-IF.                                                      05940001
059500                                                                  05950001
059600******************************************************************05960001
059700*  FILL AND DETAIL REPORT LINE.                                  *05970001
059800******************************************************************05980008
059900 2100-PRINT-DETAIL.                                               05990001
060000                                                                  06000001
060100*FILL VENDOR NAME.                                                06010001
060200     MOVE RC051-VENDOR-NAME-DUNNS  TO DL1-VEND-NAME.              06020008
060300                                                                  06030001
060400*FILL DC.                                                         06040004
060500     MOVE RC051-CURR-OPER-UNT-ID   TO DL1-DC.                     06050008
060600                                                                  06060004
060700*FILL VERIFY DATE.                                                06070004
060800     MOVE RC051-VERIFIED-TIMESTAMP TO PV-VRFD-DATE.               06080008
060900     MOVE PV-VRFD-DATE-MM          TO DL1-VERIFY-MM.              06090008
061000     MOVE PV-VRFD-DATE-DD          TO DL1-VERIFY-DD.              06100008
061100     MOVE PV-VRFD-DATE-YY          TO DL1-VERIFY-YY.              06110008
061200                                                                  06120004
061300*FILL A/P VENDOR NUMBER.                                          06130001
061400     MOVE RC051-VENDOR-NO-DUNNS    TO DL1-VEND-NBR.               06140008
061500                                                                  06150001
061600*FILL PO/RECEIVER.                                                06160001
061700     MOVE RC051-PO                 TO PV-FORMAT-PO.               06170008
061800     MOVE RC051-REC-SEQ-NBR        TO PV-FORMAT-RCVR.             06180008
061900     MOVE PV-FORMAT-PO-RCVR        TO DL1-PO-RCVR.                06190008
062000                                                                  06200001
062100*FILL DEPT NUMBER.                                                06210001
062200     MOVE RC051-DEPT               TO DL1-DEPT.                   06220008
062300                                                                  06230001
062400*FILL PROC AREA.                                                  06240001
062500     MOVE RC051-PROCESSING-AREA    TO DL1-PROC-AREA.              06250008
062600                                                                  06260001
062700*FILL EXPECTED CARTONS.                                           06270001
062800     MOVE RC051-EXPTD-CARTONS      TO PV-FORMAT-6.                06280008
062900     MOVE PV-FORMAT-6              TO DL1-EXPCTD-CTNS.            06290008
063000                                                                  06300001
063100*FILL ACTUAL CARTONS.                                             06310008
063200     MOVE RC051-ACTUAL-CARTONS     TO PV-FORMAT-6.                06320008
063300     MOVE PV-FORMAT-6              TO DL1-ACTUAL-CTNS.            06330008
063400                                                                  06340001
063500*FILL EXPECTED UNITS.                                             06350001
063600     MOVE RC051-EXPTD-UNITS        TO PV-FORMAT-6.                06360008
063700     MOVE PV-FORMAT-6              TO DL1-EXPCTD-UNTS.            06370008
063800                                                                  06380001
063900*FILL VERIFIED UNITS.                                             06390001
064000     MOVE RC051-ACTUAL-UNITS       TO PV-FORMAT-6.                06400008
064100     MOVE PV-FORMAT-6              TO DL1-VERIFD-UNTS.            06410008
064200                                                                  06420001
064300*FILL UNIT VARIANCE.                                              06430001
064400     MOVE RC051-DLY-UNIT-VARIANCE-PCT                             06440008
064500                                   TO PV-FORMAT-3.                06450008
064600     MOVE PV-FORMAT-3              TO DL1-UNIT-VAR.               06460008
064700                                                                  06470001
064800*FILL DOLLAR VARIANCE.                                            06480001
064900     MOVE RC051-DOLLAR-VARIANCE    TO PV-FORMAT-6S.               06490015
065000     MOVE PV-FORMAT-6S             TO DL1-DOLLAR-VAR.             06500015
065100                                                                  06510001
065200*FILL STYLE SUB.                                                  06520001
065300     MOVE RC051-STYLE-SUB          TO DL1-STYLE-SUB.              06530008
065400                                                                  06540001
065500*ACCUMULATE TOTALS.                                               06550001
065600     ADD +1  TO PV-ACCUM-PO-COUNT-VEND.                           06560008
065700     COMPUTE PV-ACCUM-EXPTD-UNTS-VEND = PV-ACCUM-EXPTD-UNTS-VEND  06570008
065800                                      + RC051-EXPTD-UNITS.        06580008
065900     COMPUTE PV-ACCUM-VRFD-UNTS-VEND  = PV-ACCUM-VRFD-UNTS-VEND   06590008
066000                                      + RC051-ACTUAL-UNITS.       06600008
066100     COMPUTE PV-ACCUM-VAR-AMT-VEND    = PV-ACCUM-VAR-AMT-VEND     06610008
066200                                      + RC051-DOLLAR-VARIANCE.    06620008
066300                                                                  06630001
066400*CHECK FOR OVERFLOW.                                              06640001
066500     ADD 1 TO PV-LINE-COUNT.                                      06650001
066600     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06660001
066700         PERFORM 1200-PRINT-HEADINGS                              06670001
066800     END-IF.                                                      06680001
066900                                                                  06690001
067000*WRITE DETAIL LINE.                                               06700001
067100     WRITE OUTPUT-REC                                             06710001
067200       FROM DETAIL-LINE-1                                         06720001
067300         AFTER ADVANCING 1 LINES.                                 06730001
067400                                                                  06740001
067500******************************************************************06750001
067600*  PRINT TOTAL LINE FOR VENDOR.                                  *06760003
067700******************************************************************06770004
067800 2200-PRINT-VEND-TOTAL.                                           06780003
067900                                                                  06790001
068000*CHECK FOR OVERFLOW.                                              06800001
068100     ADD 3 TO PV-LINE-COUNT.                                      06810001
068200     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06820001
068300         PERFORM 1200-PRINT-HEADINGS                              06830001
068400     END-IF.                                                      06840001
068500                                                                  06850001
068600*FILL VENDOR TOTALS.                                              06860003
068700     MOVE PV-ACCUM-PO-COUNT-VEND   TO PV-FORMAT-7.                06870004
068800     MOVE PV-FORMAT-7              TO TL1-PO-COUNT.               06880004
068900                                                                  06890001
069000     MOVE PV-ACCUM-EXPTD-UNTS-VEND TO PV-FORMAT-6.                06900004
069100     MOVE PV-FORMAT-6              TO TL1-EXPCTD-UNTS.            06910004
069200                                                                  06920001
069300     MOVE PV-ACCUM-VRFD-UNTS-VEND  TO PV-FORMAT-6.                06930004
069400     MOVE PV-FORMAT-6              TO TL1-VERIFD-UNTS.            06940004
069500                                                                  06950001
069600     MOVE PV-ACCUM-VAR-AMT-VEND    TO PV-FORMAT-6S.               06960017
069700     MOVE PV-FORMAT-6S             TO TL1-DOLLAR-VAR.             06970017
069800                                                                  06980004
069900*CALCULATE VARIANCE PERCENTAGE.                                   06990004
070000     MOVE ZEROES                   TO PV-VAR-PCT.                 07000004
070100     IF PV-ACCUM-EXPTD-UNTS-VEND NOT = +0                         07010004
070200         COMPUTE PV-VAR-PCT = ((PV-ACCUM-VRFD-UNTS-VEND           07020004
070300                              - PV-ACCUM-EXPTD-UNTS-VEND)         07030004
070400                              / PV-ACCUM-EXPTD-UNTS-VEND)         07040004
070500                              * 100                               07050004
070600     END-IF.                                                      07060004
070700     MOVE PV-VAR-PCT               TO PV-FORMAT-3                 07070004
070800     MOVE PV-FORMAT-3              TO TL1-UNIT-VAR.               07080004
070900                                                                  07090001
071000*ACCUMULATE GRAND TOTALS.                                         07100004
071100     COMPUTE PV-ACCUM-PO-COUNT-ALL  = PV-ACCUM-PO-COUNT-ALL       07110004
071200                                    + PV-ACCUM-PO-COUNT-VEND.     07120004
071300     COMPUTE PV-ACCUM-EXPTD-UNTS-ALL =                            07130004
071400                                      PV-ACCUM-EXPTD-UNTS-ALL     07140004
071500                                    + PV-ACCUM-EXPTD-UNTS-VEND.   07150004
071600     COMPUTE PV-ACCUM-VRFD-UNTS-ALL = PV-ACCUM-VRFD-UNTS-ALL      07160004
071700                                    + PV-ACCUM-VRFD-UNTS-VEND.    07170004
071800     COMPUTE PV-ACCUM-VAR-AMT-ALL   = PV-ACCUM-VAR-AMT-ALL        07180004
071900                                    + PV-ACCUM-VAR-AMT-VEND.      07190004
072000                                                                  07200004
072100*WRITE TOTAL LINE.                                                07210001
072200     WRITE OUTPUT-REC                                             07220001
072300       FROM TOTAL-LINE-1                                          07230001
072400         AFTER ADVANCING 3 LINES.                                 07240001
072500                                                                  07250001
072600******************************************************************07260004
072700*  PRINT GRAND TOTAL LINE FOR ALL VENDORS.                       *07270004
072800******************************************************************07280004
072900 2300-PRINT-GRAND-TOTAL.                                          07290004
073000                                                                  07300004
073100*CHECK FOR OVERFLOW.                                              07310004
073200     ADD 5 TO PV-LINE-COUNT.                                      07320004
073300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         07330004
073400         PERFORM 1200-PRINT-HEADINGS                              07340004
073500     END-IF.                                                      07350004
073600                                                                  07360004
073700*FILL VENDOR TOTALS.                                              07370004
073800     MOVE PV-ACCUM-PO-COUNT-ALL    TO PV-FORMAT-7.                07380004
073900     MOVE PV-FORMAT-7              TO TL2-PO-COUNT.               07390004
074000                                                                  07400004
074100     MOVE PV-ACCUM-EXPTD-UNTS-ALL  TO PV-FORMAT-6.                07410004
074200     MOVE PV-FORMAT-6              TO TL2-EXPCTD-UNTS.            07420004
074300                                                                  07430004
074400     MOVE PV-ACCUM-VRFD-UNTS-ALL   TO PV-FORMAT-6.                07440004
074500     MOVE PV-FORMAT-6              TO TL2-VERIFD-UNTS.            07450004
074600                                                                  07460004
074700     MOVE PV-ACCUM-VAR-AMT-ALL     TO PV-FORMAT-6S.               07470017
074800     MOVE PV-FORMAT-6S             TO TL2-DOLLAR-VAR.             07480017
074900                                                                  07490004
075000*CALCULATE VARIANCE PERCENTAGE.                                   07500004
075100     MOVE ZEROES                   TO PV-VAR-PCT.                 07510004
075200     IF PV-ACCUM-EXPTD-UNTS-ALL NOT = +0                          07520004
075300         COMPUTE PV-VAR-PCT = ((PV-ACCUM-VRFD-UNTS-ALL            07530004
075400                              - PV-ACCUM-EXPTD-UNTS-ALL)          07540004
075500                              / PV-ACCUM-EXPTD-UNTS-ALL)          07550004
075600                              * 100                               07560004
075700     END-IF.                                                      07570004
075800     MOVE PV-VAR-PCT               TO PV-FORMAT-3                 07580004
075900     MOVE PV-FORMAT-3              TO TL2-UNIT-VAR.               07590004
076000                                                                  07600004
076100*WRITE TOTAL LINE.                                                07610004
076200     WRITE OUTPUT-REC                                             07620004
076300       FROM TOTAL-LINE-2                                          07630004
076400         AFTER ADVANCING 5 LINES.                                 07640004
076500                                                                  07650004
076600******************************************************************07660011
076700*  PRINT A SUMMARY LINE FOR EACH DC IN THE TCOCNTL TABLE.        *07670011
076800******************************************************************07680011
076900 3000-PRINT-SUMMARY.                                              07690011
077000                                                                  07700011
077100     MOVE +0 TO PV-PAGE-COUNT.                                    07710011
077200     PERFORM 1200-PRINT-HEADINGS.                                 07720011
077300                                                                  07730011
077400     WRITE OUTPUT-REC                                             07740011
077500       FROM BLANK-LINE                                            07750011
077600         AFTER ADVANCING 2 LINES.                                 07760011
077700                                                                  07770012
077800*READ/PRINT DC INFO FROM THE COMPANY CONTROL TABLE (TCOCNTL).     07780012
077900     PERFORM 3100-OPEN-DC-CSR.                                    07790012
078000                                                                  07800012
078100     SET PS-END-OF-CURSOR-NO TO TRUE.                             07810012
078200     PERFORM 3200-FETCH-DC-CSR.                                   07820012
078300                                                                  07830012
078400     PERFORM                                                      07840012
078500       UNTIL PS-END-OF-CURSOR-YES                                 07850012
078600                                                                  07860012
078700         MOVE COCNTL-OPER-UNT-ID       TO SL1-DC                  07870012
078800         MOVE COCNTL-DOL-VRFN-VARN-PCT TO SL1-DOL-PCT             07880012
078900         MOVE COCNTL-DOL-VARN-THRS-AMT TO SL1-DOL-AMT             07890012
079000                                                                  07900012
079100         WRITE OUTPUT-REC                                         07910012
079200           FROM SUMMARY-LINE-1                                    07920012
079300             AFTER ADVANCING 1 LINES                              07930012
079400                                                                  07940012
079500         PERFORM 3200-FETCH-DC-CSR                                07950012
079600     END-PERFORM.                                                 07960012
079700                                                                  07970012
079800     PERFORM 3300-CLOSE-DC-CSR.                                   07980012
079900                                                                  07990012
080000******************************************************************08000012
080100 3100-OPEN-DC-CSR.                                                08010012
080200                                                                  08020012
080300     EXEC SQL                                                     08030012
080400         OPEN DC-CSR                                              08040012
080500     END-EXEC.                                                    08050012
080600                                                                  08060012
080700     EVALUATE TRUE                                                08070012
080800       WHEN SQLCODE = ZERO                                        08080012
080900           CONTINUE                                               08090012
081000                                                                  08100012
081100       WHEN OTHER                                                 08110012
081200           MOVE '3100-OPEN-DC-CSR' TO PV-ABEND-PARAGRAPH          08120012
081300           MOVE 'OPEN CURSOR' TO PV-DB2-OPERATION-MESSAGE-1       08130012
081400           MOVE 'TCOCNTL'     TO PV-DB2-TABLE-NAME                08140012
081500           PERFORM 9900-DB2-ABEND                                 08150012
081600     END-EVALUATE.                                                08160012
081700                                                                  08170012
081800******************************************************************08180012
081900 3200-FETCH-DC-CSR.                                               08190012
082000                                                                  08200012
082100     EXEC SQL                                                     08210012
082200         FETCH DC-CSR                                             08220012
082300          INTO :COCNTL-OPER-UNT-ID                                08230012
082400             , :COCNTL-UNT-VRFN-VARN-PCT                          08240012
082500             , :COCNTL-DOL-VRFN-VARN-PCT                          08250012
082600             , :COCNTL-DOL-VARN-THRS-AMT                          08260012
082700     END-EXEC.                                                    08270012
082800                                                                  08280012
082900     EVALUATE TRUE                                                08290012
083000       WHEN SQLCODE = ZERO                                        08300012
083100           CONTINUE                                               08310012
083200                                                                  08320012
083300       WHEN SQLCODE = +100                                        08330012
083400           SET PS-END-OF-CURSOR-YES TO TRUE                       08340012
083500                                                                  08350012
083600       WHEN OTHER                                                 08360012
083700           MOVE '3200-FETCH-DC-CSR' TO PV-ABEND-PARAGRAPH         08370012
083800           MOVE 'FETCH CURSOR' TO PV-DB2-OPERATION-MESSAGE-1      08380012
083900           MOVE 'TCOCNTL'      TO PV-DB2-TABLE-NAME               08390012
084000           PERFORM 9900-DB2-ABEND                                 08400012
084100     END-EVALUATE.                                                08410012
084200                                                                  08420012
084300******************************************************************08430012
084400 3300-CLOSE-DC-CSR.                                               08440012
084500                                                                  08450012
084600     EXEC SQL                                                     08460012
084700         CLOSE DC-CSR                                             08470012
084800     END-EXEC.                                                    08480012
084900                                                                  08490012
085000     EVALUATE TRUE                                                08500012
085100       WHEN SQLCODE = ZERO                                        08510012
085200           CONTINUE                                               08520012
085300                                                                  08530012
085400       WHEN OTHER                                                 08540012
085500           MOVE '3300-CLOSE-DC-CSR' TO PV-ABEND-PARAGRAPH         08550012
085600           MOVE 'CLOSE CURSOR' TO PV-DB2-OPERATION-MESSAGE-1      08560012
085700           MOVE 'TCOCNTL'      TO PV-DB2-TABLE-NAME               08570012
085800           PERFORM 9900-DB2-ABEND                                 08580012
085900     END-EVALUATE.                                                08590012
086000                                                                  08600012
086100******************************************************************08610001
086200*  ABEND ROUTINE                                                 *08620001
086300******************************************************************08630001
086400 9900-DB2-ABEND.                                                  08640001
086500                                                                  08650001
086600     MOVE SQLCODE TO PV-SQLCODE.                                  08660001
086700     DISPLAY '*** DB2 ERROR '.                                    08670001
086800     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       08680001
086900     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 08690001
087000     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               08700001
087100     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               08710001
087200     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       08720001
087300     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       08730001
087400     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             08740001
087500                                                                  08750001
087600     COPY DPPD004.                                                08760001
087700                                                                  08770001
087800     MOVE +4013 TO PV-ABEND-CODE.                                 08780001
087900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08790001
088000                                                                  08800001
088100******************************************************************08810001
088200******************************************************************08820001
