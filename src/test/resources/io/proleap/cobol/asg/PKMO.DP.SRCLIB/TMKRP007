000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             TMKRP007.                                00030000
000400 AUTHOR.                 TAMARA KOLTUN.                           00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            10/01/96.                                00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000810******************************************************************00080000
000820*  THIS PROGRAM USES XLKUT071 - LOCATION DOMAIN MODULE            00080000
000830******************************************************************00080000
000840                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00130000
001000 INPUT-OUTPUT SECTION.                                            00140000
001100                                                                  00150000
001200 FILE-CONTROL.                                                    00160000
001300                                                                  00170000
001400     SELECT TROUBLE-EXTRACT-FILE      ASSIGN TO INP01.            00180000
001500     SELECT DAILY-OVERALL-TRBL-RPT    ASSIGN TO RPT01.            00181006
001600                                                                  00182000
001700                                                                  00183000
001800 DATA DIVISION.                                                   00184000
001900                                                                  00185000
002000 FILE SECTION.                                                    00186000
002100 FD  TROUBLE-EXTRACT-FILE                                         00187000
002200     RECORDING MODE IS F                                          00188000
002300     LABEL RECORDS ARE STANDARD                                   00189000
002400     BLOCK CONTAINS 0 RECORDS.                                    00190000
002500                                                                  00200000
002600 01  TROUBLE-EXTRACT-RECORD         PIC X(400).                   00210000
002700                                                                  00220000
002800 FD  DAILY-OVERALL-TRBL-RPT                                       00230000
002900     RECORDING MODE IS F                                          00240000
003000     LABEL RECORDS ARE STANDARD                                   00250000
003100     BLOCK CONTAINS 0 RECORDS.                                    00260000
003200                                                                  00270000
003300 01  DAILY-OVERALL-TRBL-RECORD      PIC X(132).                   00280000
003400                                                                  00290000
003500 WORKING-STORAGE SECTION.                                         00300000
003600 01  PS-SWITCHES.                                                 00310000
003700     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00320000
003800         88  PS-EOF                                VALUE 'Y'.     00330000
003900         88  PS-NOT-EOF                            VALUE 'N'.     00340000
004000     05  PS-REPORT-SW                PIC  X(01)    VALUE ' '.     00350000
004100         88  PS-TROUBLES-ASSIGNED-RPT              VALUE 'A'.     00360001
004200         88  PS-TOP-TROUBLES-RPT                   VALUE 'T'.     00370001
004300         88  PS-UNRESOLVED-TRBLS-RPT               VALUE 'U'.     00380001
004400     05  PS-FIRST-GMM-SW             PIC  X(01)    VALUE 'F'.     00381042
004500         88  PS-FIRST-GMM                          VALUE 'F'.     00382042
004600         88  PS-NOT-FIRST-GMM                      VALUE 'N'.     00383042
004700     05  PS-FIRST-ANL-SW             PIC  X(01)    VALUE 'F'.     00383199
004800         88  PS-FIRST-ANL                          VALUE 'F'.     00383299
004900         88  PS-NOT-FIRST-ANL                      VALUE 'N'.     00383399
005000     05  PS-FIRST-DC-SW              PIC  X(01)    VALUE 'F'.     00383499
005100         88  PS-FIRST-DC                           VALUE 'F'.     00383542
005200         88  PS-NOT-FIRST-DC                       VALUE 'N'.     00383642
005300     05  PS-AREA-SW                  PIC  X(01)    VALUE ' '.     00384001
005400         88  PS-AREA-GMM-ANL                       VALUE 'G'.     00384199
005500         88  PS-AREA-DC                            VALUE 'D'.     00384201
005600     05  PS-FIRST-BA-RECORD-SW       PIC  X(01)    VALUE 'F'.     00384310
005700         88  PS-FIRST-BA-RECORD                    VALUE 'F'.     00384410
005800         88  PS-NOT-FIRST-BA-RECORD                VALUE ' '.     00384510
005900     05  PS-FIRST-CM-RECORD-SW       PIC  X(01)    VALUE 'F'.     00384622
006000         88  PS-FIRST-CM-RECORD                    VALUE 'F'.     00384722
006100         88  PS-NOT-FIRST-CM-RECORD                VALUE ' '.     00384822
006200     05 PS-FIRST-UNRSLVED-DETAIL-SW     PIC X(01)  VALUE 'F'.     00384925
006300        88 PS-FIRST-UNRSLVED-DETAIL                VALUE 'F'.     00385025
006400        88 PS-NOT-FIRST-UNRSLVD-DETAIL             VALUE ' '.     00385125
006500 01  PC-PROGRAM-CONSTANTS.                                        00385300
006600     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00385400
006700                                    'TMKRP007'.                   00385500
006800     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00385600
006900                                                   COMP SYNC.     00386000
007000     05  PC-SPECIAL-RUN-NOTE         PIC X(27)     VALUE          00389000
007100                                    '** SPECIAL REQUESTED RUN **'.00390000
007200     05  PC-ONE                      PIC 9(01)     VALUE  1.      00400000
007300     05  PC-NOT-FOUND                PIC X(17)     VALUE          00410000
007400                                         '*** NOT FOUND ***'.     00420000
007500     05  PC-AREA-GMM                 PIC X(03)     VALUE 'GMM'.   00421001
007600     05  PC-AREA-MERCH               PIC X(03)     VALUE 'MDS'.   00421199
007700     05  PC-AREA-DC                  PIC X(03)     VALUE 'DC '.   00422001
007800     05  PC-MDS-DESC                 PIC X(19)     VALUE          00422199
007900                                          'MERCHANDISE ANALYST'.  00422299
008000     05  PC-TBL-MAX                  PIC 9(03)     VALUE 250.     00423003
008100 01  PV-PROGRAM-VARIABLES.                                        00430000
008200     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00440000
008300                                                   COMP SYNC.     00450000
008400     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00460000
008410     05  PV-ABEND-SQLCODE            PIC  X(10)    VALUE SPACES.  00460000
008500     05  PV-LINE-COUNT               PIC S9(04)    VALUE +80      00470000
008600                                                   COMP SYNC.     00480000
008700     05  PV-PAGE-COUNT               PIC S9(04)    VALUE 0        00490009
008800                                                   COMP SYNC.     00500000
008900     05  PV-DETAIL-COUNT             PIC S9(10)    VALUE 0        00501099
009000                                                   COMP-3.        00502099
009100     05  PV-TOP-TRBLS-COUNT          PIC S9(10)    VALUE 1        00510099
009200                                                   COMP-3.        00511099
009300     05  PV-VER-REC-COUNT            PIC S9(10)    VALUE 0        00520099
009400                                                   COMP-3.        00530099
009500     05  PV-VER-TRBL-COUNT           PIC S9(10)    VALUE 0        00531099
009600                                                   COMP-3.        00532099
009700     05  PV-VER-INTRBL-COUNT         PIC S9(10)    VALUE 0        00520099
009800                                                   COMP-3.        00530099
009900     05  PV-CURRENT-DATE             PIC  X(10)    VALUE SPACE.   00540000
009900     05  PV-START-DATE               PIC  X(08)    VALUE SPACE.   00540000
010000     05  PV-END-DATE                 PIC  X(08)    VALUE SPACE.   00550000
010100     05  PV-START-EXTRACT.                                        00560000
010200         10 PV-START-YYYY.                                        00570060
010300            15 PV-START-CC           PIC 9(02)     VALUE 0.       00571060
010400            15 PV-START-YY           PIC 9(02)     VALUE 0.       00572060
010500         10 FILLER                   PIC X(01)     VALUE SPACE.   00580000
010600         10 PV-START-MM              PIC 9(02)     VALUE 0.       00590000
010700         10 FILLER                   PIC X(01)     VALUE SPACE.   00600000
010800         10 PV-START-DD              PIC 9(02)     VALUE 0.       00610000
010900         10 FILLER                   PIC X(01)     VALUE SPACE.   00620000
011000     05  PV-START-EXTRACT-MMDDYY.                                 00621060
011100         10 PV-START-EXTR-MM         PIC 9(02)     VALUE 0.       00621160
011200         10 PV-START-EXTR-DD         PIC 9(02)     VALUE 0.       00621260
011300         10 PV-START-EXTR-YY         PIC 9(02)     VALUE 0.       00621360
011400     05  PV-END-EXTRACT.                                          00630000
011500         10 PV-END-YYYY.                                          00631060
011600            15 PV-END-CC             PIC 9(02)     VALUE 0.       00631160
011700            15 PV-END-YY             PIC 9(02)     VALUE 0.       00631260
011800         10 FILLER                   PIC X(01)     VALUE SPACE.   00632000
011900         10 PV-END-MM                PIC 9(02)     VALUE 0.       00633000
012000         10 FILLER                   PIC X(01)     VALUE SPACE.   00634000
012100         10 PV-END-DD                PIC 9(02)     VALUE 0.       00635000
012200         10 FILLER                   PIC X(01)     VALUE SPACE.   00636000
012300     05  PV-END-EXTRACT-MMDDYY.                                   00636160
012400         10 PV-END-EXTR-MM           PIC 9(02)     VALUE 0.       00636260
012500         10 PV-END-EXTR-DD           PIC 9(02)     VALUE 0.       00636360
012600         10 PV-END-EXTR-YY           PIC 9(02)     VALUE 0.       00636460
012700     05  PV-REPORT-DATE              PIC X(10)     VALUE SPACE.   00637000
012800     05  PV-AVG-TOT-HOURS            PIC 9(10)     VALUE 0.       00638000
012900     05  PV-AVG-TOT-MINUTES          PIC 9(10)     VALUE 0.       00639000
013000     05  PV-AVG-MINUTES              PIC 9(10)     VALUE 0.       00640000
013100     05  PV-OPER-UNT-ID-SAVE         PIC 9(04)     VALUE 0.       00641038
013200     05  PV-OPER-UNT-ID-HOLD         PIC 9(04)     VALUE 0.       00641138
013300     05  PV-OPER-UNT-ID-GROUP.                                    00641200
013400         10 FILLER                   PIC X(01)   VALUE SPACE.     00641302
013500         10 PV-OPER-UNT-ID           PIC X(03)   VALUE SPACE.     00641402
013600     05  PV-GMM-SAVE                PIC  X(02)   VALUE SPACES.    00649034
013700     05  PV-GMM-NAME-SAVE           PIC  X(30)   VALUE SPACES.    00649637
013800     05  PV-PO-NBR-SAVE             PIC S9(9)    VALUE 0 COMP.    00649702
013900     05  PV-REC-SEQ-NBR-SAVE        PIC S9(9)    VALUE 0 COMP.    00649802
014000     05  PV-TRBL-RSN-CDE-SAVE       PIC S9(4)    VALUE 0 COMP.    00649902
014100     05  PV-TRBL-RSN-CDE-DESC-SAVE  PIC  X(20)   VALUE SPACE.     00650043
014200     05  PV-TOT-TROUBLE-SAVE        PIC S9(7)    VALUE 0 COMP-3.  00650102
014300     05  PV-NOTIF-DATE-SAVE         PIC  X(8)    VALUE SPACES.    00650275
014400     05  PV-RSN-CDE-TOT-QTY-SAVE    PIC S9(7)    VALUE 0 COMP-3.  00650383
014500     05  PV-PER-TO-TOT              PIC 9(3)V99  VALUE 0 COMP-3.  00650402
014600     05  PV-PER-OF-VER-REC          PIC 9(3)V99  VALUE 0 COMP-3.  00650561
014700     05  PV-DC-NAME-HOLD            PIC X(30)    VALUE SPACES.    00650605
014800     05  PV-RPT-AREA-SAVE           PIC X(01)    VALUE 'B'.       00650744
014900         88 PV-AREA-SAVE-BUYING VALUE 'B'.                        00650838
015000         88 PV-AREA-SAVE-MDS    VALUE 'A'.                        00650999
015100         88 PV-AREA-SAVE-DC     VALUE 'D'.                        00651038
015200                                                                  00660000
015300 01  CT-CPU-TIME.                                                 00690000
015400     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    00700000
015500     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    00710000
015600     03  FILLER                      PIC  9(04)    VALUE ZERO.    00720000
015700                                                                  00730000
015800 01  CD-CPU-DATE.                                                 00740000
015900     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    00750000
016000     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    00760000
016100     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    00770000
016200                                                                  00780000
016300 01  UTT-UNRESOLVED-TROUBLE-TABLE.                                00781003
016400     05 UTT-UNRESOLVED-TRBL-ENTRY OCCURS 250 TIMES                00781107
016500                                  INDEXED BY UTT-INX.             00781207
016600       10  UTT-AREA                  PIC  X(03) VALUE ZERO.       00781307
016700       10  UTT-GMM-OR-DC-NBR         PIC  X(04) VALUE ZERO.       00781498
016800       10  UTT-GMM-OR-DC-NBR-RED REDEFINES UTT-GMM-OR-DC-NBR.     00781598
016900           15 FILLER                 PIC  Z9.                     00781699
017000           15 UTT-GMM-NBR            PIC  X(02).                  00781799
017100       10  UTT-GMM-OR-DC-NAME        PIC  X(30) VALUE ZERO.       00781807
017200       10  UTT-TRBL-RSN-CDE          PIC S9(4)  VALUE 0 COMP.     00781907
017300       10  UTT-TRBL-RSN-CDE-DESC     PIC  X(30) VALUE SPACES.     00782007
017400       10  UTT-NBR-UNRSLVED-TRBLS    PIC  9(05) VALUE 0 COMP-3.   00782107
017500                                                                  00782203
017600                                                                  00783003
017700 01  FF-FIELD-FORMATS.                                                  00
017800     05  FF-ONES.                                                         
017900         10  FILLER                  PIC   X(01)  VALUE '('.              
018000         10  FF-ONES-QTY             PIC   9(01).                         
018100         10  FILLER                  PIC   X(07)  VALUE ')      '.        
018200     05  FF-TENS.                                                         
018300         10  FILLER                  PIC   X(01)  VALUE '('.              
018400         10  FF-TENS-QTY             PIC   9(02).                         
018500         10  FILLER                  PIC   X(06)  VALUE ')     '.         
018600     05  FF-HUNDREDS.                                                     
018700         10  FILLER                  PIC   X(01)  VALUE '('.              
018800         10  FF-HUNDREDS-QTY         PIC   9(03).                         
018900         10  FILLER                  PIC   X(05)  VALUE ')    '.          
019000     05  FF-THOUSANDS.                                                    
019100         10  FILLER                  PIC   X(01)  VALUE '('.              
019200         10  FF-THOUSANDS-QTY        PIC   9,999.                         
019300         10  FILLER                  PIC   X(03)  VALUE ')  '.            
019400     05  FF-10-THOUSANDS.                                                 
019500         10  FILLER                  PIC   X(01)  VALUE '('.              
019600         10  FF-10-THOUSANDS-QTY     PIC   99,999.                        
019700         10  FILLER                  PIC   X(02)  VALUE ') '.             
019800     05  FF-100-THOUSANDS.                                                
019900         10  FILLER                  PIC   X(01)  VALUE '('.              
020000         10  FF-100-THOUSANDS-QTY    PIC   999,999.                       
020100         10  FILLER                  PIC   X(01)  VALUE ')'.              
020900                                                                  00782203
021000                                                                  00783003
021100 01  PA-PROGRAM-ACCUMULATORS.                                     00790000
021200     05  PA-RESOLVE-HOURS            PIC  S9(10)  VALUE 0 COMP-3. 00800000
021300     05  PA-RESOLVE-MINUTES          PIC  S9(10)  VALUE 0 COMP-3. 00810000
021400     05  PA-TOT-TRBLS                PIC  S9(10)  VALUE 0 COMP-3. 00820002
021500     05  PA-TOT-OF-PRBLMS            PIC  S9(10)  VALUE 0 COMP-3. 00821001
021600     05  PA-NBR-OF-RESOLVED-TRBLS    PIC  S9(10)  VALUE 0 COMP-3. 00821102
021700     05  PA-NBR-UNRESOLVED-TRBLS     PIC  S9(10)  VALUE 0 COMP-3. 00821207
021800     05  PA-TOT-UNRESLVED-TRBLS      PIC  S9(10)  VALUE 0 COMP-3. 00821312
021900                                                                  00822000
022000     COPY DPWS132O.                                               00822101
022100                                                                  00822201
022200 01  HL1-HEADING-LINE-1.                                          00823000
022300     05  FILLER                      PIC  X(02)    VALUE SPACES.  00824000
022400     05  HL1-SPECIAL-RUN-NOTE        PIC  X(27)    VALUE SPACES.  00825000
022500     05  FILLER                      PIC  X(23)    VALUE SPACES.  00826000
022600     05  FILLER                      PIC  X(29)    VALUE          00827000
022700                                 'DAILY OVERALL TROUBLE SUMMARY'. 00828000
022800     05  FILLER                      PIC  X(51)    VALUE SPACES.  00830000
022900                                                                  00840000
023000 01  HL2-HEADING-LINE-2.                                          00850000
023100     05  FILLER                      PIC  X(56)   VALUE SPACES.   00860082
023200     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  00861000
023300     05  FILLER                      PIC  X(32)   VALUE SPACES.   00870081
023400     05  FILLER                      PIC  X(07)   VALUE 'AVERAGE'.00880000
023500     05  FILLER                      PIC  X(36)   VALUE SPACES.   00881000
023600                                                                  00890000
023700 01  HL3-HEADING-LINE-3.                                          00900000
023800     05  FILLER                      PIC  X(06)    VALUE SPACES.  00910057
023900     05  FILLER                      PIC  X(04)    VALUE 'AREA'.  00920000
024000     05  FILLER                      PIC  X(41)    VALUE SPACE.   00930000
024100     05  FILLER                      PIC  X(16)    VALUE          00940000
024200                                              'TROUBLE CREATED '. 00941081
024300     05  FILLER                      PIC  X(05)    VALUE SPACES.  00950000
024400     05  FILLER                      PIC  X(10)    VALUE          00960000
024500                                                   '% TO TOTAL'.  00961000
024600     05  FILLER                      PIC  X(07)    VALUE SPACES.  00970000
024700     05  FILLER                      PIC  X(15)    VALUE          00971000
024800                                              'TIME TO RESOLVE'.  00972000
024900     05  FILLER                      PIC  X(27)    VALUE SPACES.  00973057
025000                                                                  00980000
025100 01  HL4-HEADING-LINE-4.                                          00990000
025200     05  FILLER                      PIC  X(02)    VALUE SPACES.  01000058
025300     05  FILLER                      PIC  X(21)    VALUE          01010081
025400                                         'TOP 5 TROUBLE REASONS'. 01011081
025500     05  FILLER                      PIC  X(109)   VALUE SPACE.   01020081
025600                                                                  01041000
025700 01  HL5-HEADING-LINE-5.                                          01050000
025800     05  FILLER                      PIC  X(06)    VALUE SPACES.  01060057
025900     05  FILLER                      PIC  X(07)    VALUE          01061000
026000                                                     'TROUBLE'.   01062000
026100     05  FILLER                      PIC  X(34)    VALUE SPACE.   01063000
026200     05  FILLER                      PIC  X(08)    VALUE          01064000
026300                                                     'CREATED '.  01065081
026400     05  FILLER                      PIC  X(86)    VALUE SPACES.  01066057
026500                                                                  01070000
026600 01  HL6-HEADING-LINE-6.                                          01080000
026700     05  FILLER                      PIC  X(06)    VALUE SPACES.  01090057
026800     05  FILLER                      PIC  X(06)    VALUE 'REASON'.01100081
026900     05  FILLER                      PIC  X(08)    VALUE SPACE.   01110000
027000     05  FILLER                      PIC  X(19)    VALUE          01120000
027100                                            'TROUBLE DESCRIPTION'.01121000
027200     05  FILLER                      PIC  X(08)    VALUE SPACES.  01130000
027300     05  FILLER                      PIC  X(08)    VALUE          01140099
027400                                            'QUANTITY'.           01141099
027500     05  FILLER                      PIC  X(07)    VALUE SPACES.  01150099
027600     05  FILLER                      PIC  X(10)    VALUE          01151007
027700                                            '% TO TOTAL'.         01152000
027800     05  FILLER                      PIC  X(52)    VALUE SPACES.  01153057
027900 01  HL7-HEADING-LINE-7.                                          01154000
028000     05  FILLER                      PIC  X(57)   VALUE SPACES.   01155081
028100     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  01156000
028200     05  FILLER                      PIC  X(70)   VALUE SPACES.   01157081
028300                                                                  01158000
028400 01  HL8-HEADING-LINE-8.                                          01159000
028500     05  FILLER                      PIC  X(06)    VALUE SPACES.  01159157
028600     05  FILLER                      PIC  X(04)    VALUE 'AREA'.  01159200
028700     05  FILLER                      PIC  X(41)    VALUE SPACE.   01159300
028800     05  FILLER                      PIC  X(18)    VALUE          01159400
028900                                             'UNRESOLVED TROUBLE'.01159500
029000     05  FILLER                      PIC  X(66)    VALUE SPACES.  01159657
029100                                                                  01230000
029200 01  DL-GMM-INFO.                                                 01240099
029300     05  DL-GMM-AREA                 PIC  X(03)    VALUE 'GMM'.   01250099
029400     05  FILLER                      PIC  X(03)    VALUE ' - '.   01260099
029500     05  DL-GMM-NBR-4                PIC  X(04)    VALUE ZEROS.   01260199
029500     05  DL-GMM-NBR-G REDEFINES DL-GMM-NBR-4.                     01260199
029500         10  FILLER                  PIC  X(01).                  01260199
029500         10  DL-GMM-NBR              PIC  X(03).                  01260199
029600                                                                  01260299
029700 01  DL-MDS-INFO.                                                 01260399
029800     05  DL-MDS-AREA                 PIC  X(03)    VALUE 'MDS'.   01260499
029900     05  FILLER                      PIC  X(03)    VALUE ' - '.   01260599
030000     05  FILLER                      PIC  X(04)    VALUE SPACE.   01260699
030100                                                                  01260799
030200 01  DL-DC-INFO.                                                  01260899
030300     05  DL-DC-AREA                  PIC  X(03)    VALUE 'DC '.   01260999
030400     05  FILLER                      PIC  X(03)    VALUE ' - '.   01261099
030500     05  DL-DC-NBR                   PIC  X(04)    VALUE ZEROS.   01261199
030600                                                                  01262099
030700 01  DL1-DETAIL-LINE-1.                                           01270099
030800     05  FILLER                      PIC  X(06)    VALUE SPACES.  01280099
030900     05  DL1-INFO                    PIC  X(10)    VALUE SPACES.  01281099
031000     05  FILLER                      PIC  X(01)    VALUE SPACE.   01290000
031100     05  DL1-GMM-OR-DC-NAME          PIC  X(30)    VALUE SPACES.  01300000
031200     05  FILLER                      PIC  X(09)    VALUE SPACE.   01310000
031300     05  DL1-TOT-ASSIGNED-TRBLS      PIC  ZZ,ZZ9   VALUE ZEROS.   01320000
031400     05  FILLER                      PIC  X(12)    VALUE SPACE.   01330000
031500     05  DL1-PER-TO-TOT              PIC  ZZ9.99   VALUE ZEROS.   01340000
031600     05  FILLER                      PIC  X(14)    VALUE SPACE.   01350000
031700     05  DL1-AVG-RESOLVE-HHH         PIC  Z(2)9    VALUE ZEROS.   01360002
031800     05  FILLER                      PIC  X(01)    VALUE ':'.     01361002
031900     05  DL1-AVG-RESOLVE-MM          PIC  9(02)    VALUE ZEROS.   01362002
032000     05  FILLER                      PIC  X(34)    VALUE SPACE.   01370057
032100                                                                  01380000
032200 01  DL2-DETAIL-LINE-2.                                           01381000
032300     05  FILLER                      PIC  X(08)    VALUE SPACES.  01381157
032400     05  DL2-TROUBLE-NBR             PIC  Z(3)9    VALUE ZEROS.   01381200
032500     05  FILLER                      PIC  X(08)    VALUE SPACES.  01381300
032600     05  DL2-TROUBLE-DESCRIPTION     PIC  X(20)    VALUE SPACES.  01381407
032700     05  FILLER                      PIC  X(08)    VALUE SPACE.   01381500
032800     05  DL2-ASSIGNED-QTY            PIC  ZZ,ZZ9   VALUE ZEROS.   01381600
032900     05  FILLER                      PIC  X(11)    VALUE SPACE.   01381700
033000     05  DL2-PER-TO-TOTAL            PIC  ZZ9.99   VALUE ZEROS.   01381800
033100     05  FILLER                      PIC  X(61)    VALUE SPACE.   01381957
033200                                                                  01382000
033300                                                                  01382199
033400 01  DL3-DETAIL-LINE-3.                                           01382299
033500     05  FILLER                      PIC  X(06)    VALUE SPACES.  01382399
033600     05  DL3-INFO                    PIC  X(10)    VALUE SPACES.  01382499
033700     05  FILLER                      PIC  X(01)    VALUE SPACE.   01382599
033800     05  DL3-GMM-OR-DC-NAME          PIC  X(30)    VALUE SPACES.  01383199
033900     05  FILLER                      PIC  X(09)    VALUE SPACE.   01383299
034000     05  DL3-TOT-ASSIGNED-TRBLS      PIC  ZZ,ZZ9   VALUE ZEROS.   01383399
034100     05  FILLER                      PIC  X(72)    VALUE SPACE.   01383499
034200                                                                  01383500
034300 01  TL1-TOTAL-LINE-1.                                            01383600
034400     05  FILLER                      PIC X(02)  VALUE SPACES.     01384000
034500     05  FILLER                      PIC X(26)  VALUE             01385088
034600                             'TOTAL TROUBLE CREATED FOR '.        01386086
034700     05  TL1-DATE                    PIC X(10)  VALUE SPACES.     01387099
034800     05  FILLER                      PIC X(06)  VALUE SPACES.     01388099
034900     05  FILLER                      PIC X(01)  VALUE '-'.        01389000
035000     05  FILLER                      PIC X(01)  VALUE SPACE.      01389100
035100     05  TL1-TROUBLE-TOTAL           PIC Z(02),Z(02)9.            01389200
035200     05  FILLER                      PIC X(77)  VALUE SPACE.      01389300
035300                                                                  01391600
035400 01  TL2-TOTAL-LINE-2.                                            01391700
035500     05  FILLER                      PIC X(02)   VALUE SPACES.    01391800
035600     05  FILLER                      PIC X(31)   VALUE            01391900
035700                            'TOTAL UNRESOLVED TROUBLE AS OF '.    01392000
035800     05  TL2-DATE                    PIC X(10)   VALUE SPACES.    01392190
035900     05  FILLER                      PIC X(04)   VALUE SPACES.    01392299
036000     05  FILLER                      PIC X(01)   VALUE '-'.       01392300
036100     05  FILLER                      PIC X(01)   VALUE SPACE.     01392400
036200     05  TL2-UNRSLVED-TRBL-TOT       PIC ZZZ,ZZ9 VALUE SPACES.    01392512
036300     05  FILLER                      PIC X(77)   VALUE SPACES.    01392690
036400                                                                  01392761
036500 01  TL3-TOTAL-LINE-3.                                            01392861
036600     05  FILLER                      PIC X(02)  VALUE SPACES.     01392961
036700     05  FILLER                      PIC X(28)  VALUE             01393068
036800                             'TOTAL RECEIVERS VERIFIED ON '.      01393168
036900     05  TL3-DATE                    PIC X(10)  VALUE SPACES.     01393261
037000     05  FILLER                      PIC X(04)  VALUE SPACES.     01393399
037100     05  FILLER                      PIC X(01)  VALUE '-'.        01393461
037200     05  FILLER                      PIC X(01)  VALUE SPACE.      01393561
037300     05  TL3-VER-REC-TOTAL           PIC Z(02),Z(02)9.            01393661
037400     05  FILLER                      PIC X(76)  VALUE SPACE.      01393768
037500                                                                  01393861
037600 01  TL4-TOTAL-LINE-4.                                            01393961
037700     05  FILLER                      PIC X(02)  VALUE SPACES.     01394061
037800     05  FILLER                      PIC X(41)  VALUE             01394199
037900                  'PERCENT OF VERIFIED RECEIVERS IN TROUBLE'.     01394299
038000     05  FILLER                      PIC X(01)  VALUE SPACES.     01394399
038100     05  FILLER                      PIC X(01)  VALUE '-'.        01394461
038200     05  FILLER                      PIC X(01)  VALUE SPACE.      01394561
038300     05  TL4-PER-OF-VER-REC          PIC Z(02)9.99.               01394661
038400     05  FILLER                      PIC X(02)  VALUE SPACES.     01394061
038500     05  TL4-RCVRS-VER-TRBL          PIC X(09)  VALUE SPACES.     01394061
038600     05  FILLER                      PIC X(66)  VALUE SPACE.      01394761
038700                                                                  01394800
038800 01  TL5-TOTAL-LINE-5.                                            01394999
038900     05  FILLER                      PIC X(02)  VALUE SPACES.     01395099
039000     05  FILLER                      PIC X(41)  VALUE             01395199
039100                  'TOTAL RECEIVERS IN TROUBLE              '.     01395299
039200     05  FILLER                      PIC X(01)  VALUE SPACES.     01395399
039300     05  FILLER                      PIC X(01)  VALUE '-'.        01395499
039400     05  FILLER                      PIC X(01)  VALUE SPACES.     01395599
039500     05  TL5-RCVRS-IN-TRBL           PIC Z(02),Z(02)9.            01395699
039600     05  FILLER                      PIC X(77)  VALUE SPACE.      01395799
039700                                                                  01395899
039800 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  01395999
039900 01  ER-END-REPORT-LINE.                                          01396099
040000     05  FILLER                      PIC X(02)  VALUE SPACE.      01396199
040100     05  FILLER                      PIC X(16)  VALUE             01396299
040200                                     '** END REPORT **'.          01396399
040300     05  FILLER                      PIC X(116) VALUE SPACE.      01396499
040400                                                                  01396599
040500 01  PR-PRINT-FINAL.                                              01396699
040600     05  FILLER                      PIC X(53)  VALUE SPACES.     01396799
040700     05  FILLER                      PIC X(21)  VALUE             01396899
040800         '*** END OF REPORT ***'.                                 01396999
040900                                                                  01397099
041000     COPY DPWS004.                                                01397199
041100                                                                  01397299
041200     COPY TMRD001.                                                01398000
041210                                                                  01397299
041220** COPYBOOK FOR LOCATION CALLED MODULE XLKUT071                   01399000
041230     COPY XLWS071.                                                01398000
041240                                                                  01399000
041300*----------------------------------------------------------------*01399000
041310* DB2 AREA FOR COMMUNITCATION                                     01399000
041320*----------------------------------------------------------------*01399000
041330     EXEC SQL                                                     01399000
041340         INCLUDE SQLCA                                            01399000
041350     END-EXEC.                                                    01399000
041360                                                                  01399000
042600***************************************************************** 01580000
042700 PROCEDURE DIVISION.                                              01590000
042800***************************************************************** 01600000
042900                                                                  01610000
043000 0000-MAINLINE.                                                   01620000
043100***************************************************************** 01630000
043200*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 01640000
043300***************************************************************** 01650000
043400     PERFORM 1000-INITIALIZE.                                     01660000
043500                                                                  01670000
043600     SET PS-NOT-EOF   TO TRUE.                                    01671060
043700     PERFORM 2000-MAIN-PROCESS                                    01680000
043800           UNTIL  PS-EOF.                                         01690000
043900                                                                  01691001
044000     IF PV-DETAIL-COUNT > 0                                       01691170
044100        PERFORM 3000-WRITE-UNRESOLVED-TRBL-RPT  THRU 3000-EXIT    01692071
044200     END-IF                                                       01700070
044300                                                                  01701070
044400     PERFORM 9000-END-PROCESS THRU 9000-EXIT.                     01710000
044500                                                                  01720000
044600 0000-EXIT.  STOP RUN.                                            01730000
044700                                                                  01740000
044800 1000-INITIALIZE.                                                 01750000
044900      OPEN INPUT  TROUBLE-EXTRACT-FILE.                           01760099
045000      OPEN OUTPUT DAILY-OVERALL-TRBL-RPT.                         01770001
045100**** READING THE HEADER RECORD.                                   01780000
045200      READ TROUBLE-EXTRACT-FILE    INTO                           01790008
045300                                  TM001-TROUBLE-EXT-RECORD        01800000
045400          AT END                                                  01810000
045500             SET PS-EOF TO TRUE                                   01820000
045600          NOT AT END                                              01830000
045700             MOVE TM001-RCVRS-VRFYD-QTY TO PV-VER-REC-COUNT       01831099
045800                                           TL3-VER-REC-TOTAL      01832099
045900             MOVE TM001-RCVRS-TRBL-QTY  TO PV-VER-TRBL-COUNT      01833099
046000                                           TL5-RCVRS-IN-TRBL      01834099
046100             MOVE TM001-VRFYD-TRBL-QTY  TO PV-VER-INTRBL-COUNT    01833099
046200             MOVE TM001-RUN-BEGIN-DATE  TO PV-START-EXTRACT       01840000
046300             MOVE TM001-RUN-END-DATE    TO PV-END-EXTRACT         01850000
046400             STRING                                               01860000
046500                   PV-START-MM                                    01870000
046600                   '/'                                            01880000
046700                   PV-START-DD                                    01890000
046800                   '/'                                            01900000
046900                   PV-START-YYYY                                  01910000
047000                DELIMITED BY SIZE                                 01920000
047100                INTO PV-REPORT-DATE                               01930000
047200              END-STRING                                          01940000
047300             STRING                                               01950000
047400                   PV-START-YYYY                                  01960000
047500                   PV-START-MM                                    01970000
047600                   PV-START-DD                                    01980000
047700                DELIMITED BY SIZE                                 01990000
047800                INTO PV-START-DATE                                02000000
047900             END-STRING                                           02010000
048000             STRING                                               02020000
048100                   PV-END-YYYY                                    02030000
048200                   PV-END-MM                                      02040000
048300                   PV-END-DD                                      02050000
048400                DELIMITED BY SIZE                                 02060000
048500                INTO PV-END-DATE                                  02070000
048600             END-STRING                                           02080000
048700             MOVE PV-REPORT-DATE     TO TL1-DATE                  02090007
048800                                        TL2-DATE                  02110000
048900                                        TL3-DATE                  02111060
049000     END-READ.                                                    02120000
049100** PV-CURRENT-DATE NOT USED, INCLUDED TO KEEP PROGRAM DB2         02130000
049100**    WITHOUT HAVING TO CHANGE JCL TO NON-DB2 PROGRAM             02130000
049100     EXEC SQL                                                     02130000
049100       SET :PV-CURRENT-DATE = CURRENT DATE                        02130000
049100     END-EXEC.                                                    02130000
049100                                                                  02130000
049200     ACCEPT CT-CPU-TIME          FROM TIME.                       02140000
049300     MOVE   CT-HOUR              TO DP132O-RUN-HOUR.              02150000
049400     MOVE   CT-MINUTE            TO DP132O-RUN-MINUTE.            02160000
049500                                                                  02170000
049600     ACCEPT CD-CPU-DATE          FROM DATE.                       02180000
049700     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              02190000
049800     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             02200000
049900     MOVE CD-DAY                 TO DP132O-RUN-DAY.               02210000
050000                                                                  02220000
050100     MOVE 'TMKRP007'             TO DP132O-PROGRAM-NAME.          02230000
050200     MOVE PC-ONE                 TO DP132O-REPORT-NUMBER          02240000
050300                                                                  02250000
050400     IF TM001-RUN-SPECIAL                                         02260000
050500        MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          02270000
050600     ELSE                                                         02280000
050700        MOVE SPACE               TO HL1-SPECIAL-RUN-NOTE          02290000
050800     END-IF.                                                      02300000
050900                                                                  02300105
051000     MOVE LOW-VALUES  TO UTT-UNRESOLVED-TROUBLE-TABLE.            02300205
051100     SET UTT-INX   TO  1.                                         02301033
051200                                                                  02310000
051300*    MOVE 1                      TO DP132O-REPORT-NUMBER.         02320000
051400*DP132O-LASER-NEW-PAGE-INDICATR                                   02330000
051500 1000-EXIT.  EXIT.                                                02340000
051600                                                                  02340160
051700 2000-MAIN-PROCESS.                                               02360000
051800      READ TROUBLE-EXTRACT-FILE    INTO                           02361108
051900                                  TM001-TROUBLE-EXT-RECORD        02362001
052000          AT END                                                  02363000
052100             SET PS-EOF TO TRUE                                   02364000
052200          NOT AT END                                              02364100
052300             EVALUATE TRUE                                        02364200
052400                 WHEN TM001-RECORD-TYPE-FINTOT                    02364401
052500                    PERFORM 2100-WRITE-TL1          THRU 2100-EXIT02364501
052600                 WHEN TM001-RECORD-TYPE-DETAIL                    02364601
052700                    ADD 1   TO PV-DETAIL-COUNT                    02364770
052800                    PERFORM 2200-SUMMARY-AREAS-REPORTS            02364801
052900                                                    THRU 2200-EXIT02364901
053000                 WHEN TM001-RECORD-TYPE-RSNTOT                    02365000
053100                  IF PS-FIRST-CM-RECORD                           02365141
053200                    PERFORM 6000-WRITE-DETAIL-LINE  THRU 6000-EXIT02365240
053300                    PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL         02365353
053400                                                    THRU 2230-EXIT02365453
053500                  END-IF                                          02365541
053600                    PERFORM 2300-TOP-TROUBLES-RPT   THRU 2300-EXIT02365601
053700                                                                  02365702
053800             END-EVALUATE.                                        02365800
053900 2000-EXIT.  EXIT.                                                02365900
054000                                                                  02366001
054100 2100-WRITE-TL1.                                                  02366101
054200     PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT                  02366210
054300                                                                  02366301
054400     MOVE TM001-ATL-ASSIGN-TOT-QTY    TO TL1-TROUBLE-TOTAL        02366402
054500                                         PV-TOT-TROUBLE-SAVE.     02366502
054600     WRITE DAILY-OVERALL-TRBL-RECORD                              02366601
054700                   FROM TL1-TOTAL-LINE-1                          02366701
054800                        AFTER ADVANCING 4 LINES.                  02366858
054900     ADD 4   TO PV-LINE-COUNT.                                    02366958
055000                                                                  02367061
055100     WRITE DAILY-OVERALL-TRBL-RECORD                              02367161
055200                   FROM TL3-TOTAL-LINE-3                          02367261
055300                        AFTER ADVANCING 1 LINES.                  02367361
055400     ADD 1   TO PV-LINE-COUNT.                                    02367461
055500                                                                  02368099
055600     IF TM001-ATL-ASSIGN-TOT-QTY > 0                              02368199
055700        IF  PV-VER-REC-COUNT = 0                                  02368299
055800            MOVE ZERO TO PV-PER-OF-VER-REC                        02368399
055900        ELSE                                                      02368499
056000            COMPUTE PV-PER-OF-VER-REC =                           02368599
056100                    PV-VER-INTRBL-COUNT * 100 /                   02368699
056200                    PV-VER-REC-COUNT                              02368799
056300        END-IF                                                    02368899
056400     ELSE                                                         02368999
056500        MOVE 0   TO PV-PER-OF-VER-REC                             02369099
056600     END-IF.                                                      02369299
056700                                                                  02369399
056800     MOVE  PV-PER-OF-VER-REC   TO TL4-PER-OF-VER-REC.             02369499
056900                                                                          
057000     IF  PV-VER-INTRBL-COUNT < 10                                         
057100         MOVE PV-VER-INTRBL-COUNT TO                                      
057200              FF-ONES-QTY                                                 
057300         MOVE FF-ONES TO                                                  
057400              TL4-RCVRS-VER-TRBL                                          
057500     ELSE                                                                 
057600     IF  PV-VER-INTRBL-COUNT < 100                                        
057700         MOVE PV-VER-INTRBL-COUNT TO                                      
057800              FF-TENS-QTY                                                 
057900         MOVE FF-TENS TO                                                  
058000              TL4-RCVRS-VER-TRBL                                          
058100     ELSE                                                                 
058200     IF  PV-VER-INTRBL-COUNT < 1000                                       
058300         MOVE PV-VER-INTRBL-COUNT TO                                      
058400              FF-HUNDREDS-QTY                                             
058500         MOVE FF-HUNDREDS TO                                              
058600              TL4-RCVRS-VER-TRBL                                          
058700     ELSE                                                                 
058800     IF  PV-VER-INTRBL-COUNT < 10000                                      
058900         MOVE PV-VER-INTRBL-COUNT TO                                      
059000              FF-THOUSANDS-QTY                                            
059100         MOVE FF-THOUSANDS TO                                             
059200              TL4-RCVRS-VER-TRBL                                          
059300     ELSE                                                                 
059400     IF  PV-VER-INTRBL-COUNT < 100000                                     
059500         MOVE PV-VER-INTRBL-COUNT TO                                      
059600              FF-10-THOUSANDS-QTY                                         
059700         MOVE FF-10-THOUSANDS TO                                          
059800              TL4-RCVRS-VER-TRBL                                          
059900     ELSE                                                                 
060000         MOVE PV-VER-INTRBL-COUNT TO                                      
060100              FF-100-THOUSANDS-QTY                                        
060200         MOVE FF-100-THOUSANDS TO                                         
060300              TL4-RCVRS-VER-TRBL.                                         
060400                                                                          
060500     WRITE DAILY-OVERALL-TRBL-RECORD                              02369599
060600                   FROM TL4-TOTAL-LINE-4                          02369699
060700                        AFTER ADVANCING 1 LINES.                  02369799
060800     ADD 1   TO PV-LINE-COUNT.                                    02369899
060900                                                                  02367599
061000     WRITE DAILY-OVERALL-TRBL-RECORD                              02367699
061100                   FROM TL5-TOTAL-LINE-5                          02367799
061200                        AFTER ADVANCING 1 LINES.                  02367899
061300     ADD 1   TO PV-LINE-COUNT.                                    02367999
061400                                                                  02369999
061500 2100-EXIT.  EXIT.                                                02370099
061600                                                                  02370199
061700 2200-SUMMARY-AREAS-REPORTS.                                      02370299
061800     SET   PS-TROUBLES-ASSIGNED-RPT   TO TRUE.                    02370399
061900     IF PV-LINE-COUNT > PC-LINE-LIMIT                             02370499
062000        PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT               02370599
062100     END-IF.                                                      02370699
062200     IF PS-FIRST-BA-RECORD                                        02370799
062300         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     02370899
062400         SET PS-NOT-FIRST-BA-RECORD  TO TRUE                      02370999
062500     END-IF.                                                      02371099
062600                                                                  02371199
062700     EVALUATE TRUE                                                02371299
062800         WHEN TM001-RPT-AREA-BUYING                               02371399
062900         WHEN TM001-RPT-AREA-ANALYST                              02371499
063000              SET PS-AREA-GMM-ANL  TO TRUE                        02371599
063100              PERFORM 2210-GMM-ANL-TOTALS THRU 2210-EXIT          02371699
063200         WHEN TM001-RPT-AREA-DC                                   02371799
063300              IF PS-FIRST-DC                                      02371899
063400               PERFORM 6000-WRITE-DETAIL-LINE  THRU 6000-EXIT     02371999
063500               PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL              02372099
063600                                               THRU 2230-EXIT     02372199
063700              END-IF                                              02372299
063800              SET PV-AREA-SAVE-DC       TO TRUE                   02372399
063900              SET PS-AREA-DC            TO TRUE                   02372499
064000              PERFORM 2220-DC-TOTALS  THRU 2220-EXIT              02372599
064100     END-EVALUATE.                                                02372699
064200                                                                  02372799
064300     IF TM001-PO-NBR       NOT = PV-PO-NBR-SAVE                   02372899
064400         MOVE TM001-PO-NBR       TO PV-PO-NBR-SAVE                02372999
064500     END-IF.                                                      02373099
064600     IF TM001-REC-SEQ-NBR  NOT = PV-REC-SEQ-NBR-SAVE              02373199
064700         MOVE TM001-REC-SEQ-NBR  TO PV-REC-SEQ-NBR-SAVE           02373299
064800     END-IF.                                                      02373399
064900     IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE             02373499
065000         MOVE TM001-TRBL-RSN-CDE TO PV-TRBL-RSN-CDE-SAVE          02373599
065100         MOVE TM001-TRBL-RSN-CDE-DESC                             02373699
065200                                 TO PV-TRBL-RSN-CDE-DESC-SAVE     02373799
065300     END-IF.                                                      02373899
065400                                                                  02373999
065500     IF TM001-NOTIF-DATE  NOT =  PV-NOTIF-DATE-SAVE               02374099
065600        MOVE TM001-NOTIF-DATE  TO  PV-NOTIF-DATE-SAVE             02374199
065700     END-IF.                                                      02374299
065800 2200-EXIT.  EXIT.                                                02374399
065900                                                                  02374499
066000 2210-GMM-ANL-TOTALS.                                             02374599
066100     EVALUATE TRUE                                                02374699
066200        WHEN TM001-RPT-AREA-BUYING                                02374799
066300             PERFORM 2212-CHECK-FOR-GMM-TOTALS THRU 2212-EXIT     02374899
066400        WHEN TM001-RPT-AREA-ANALYST                               02374999
066500             PERFORM 2214-LAST-GMM-TOTAL       THRU 2214-EXIT     02375099
066600      END-EVALUATE.                                               02376099
066700                                                                  02377101
066800     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             02377243
066900 2210-EXIT.  EXIT.                                                02377301
067000                                                                  02377499
067100 2212-CHECK-FOR-GMM-TOTALS.                                       02377599
067200     IF TM001-GMM-NBR NOT = PV-GMM-SAVE                           02377699
067300        IF NOT PS-FIRST-GMM                                       02377799
067400          PERFORM 6000-WRITE-DETAIL-LINE        THRU 6000-EXIT    02377899
067500          PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL THRU 2230-EXIT    02377999
067600        END-IF                                                    02378099
067700        MOVE 0    TO PA-RESOLVE-HOURS                             02378199
067800                     PA-RESOLVE-MINUTES                           02378299
067900                     PV-AVG-MINUTES                               02378399
068000                     PA-NBR-OF-RESOLVED-TRBLS                     02378499
068100                     PV-AVG-TOT-HOURS                             02378599
068200                     PV-AVG-TOT-MINUTES                           02378699
068300                     PA-TOT-OF-PRBLMS                             02378799
068400                     PA-TOT-TRBLS                                 02378899
068500        IF PS-FIRST-GMM                                           02378999
068600           SET PS-NOT-FIRST-GMM        TO TRUE                    02379099
068700        END-IF                                                    02379199
068800                                                                  02379299
068900                                                                  02379399
069000        MOVE TM001-GMM-NBR     TO PV-GMM-SAVE                     02379499
069100        MOVE TM001-GMM-NAME    TO PV-GMM-NAME-SAVE                02379599
069200     END-IF.                                                      02379699
069300 2212-EXIT.  EXIT.                                                02379799
069400                                                                  02379899
069500 2214-LAST-GMM-TOTAL.                                             02379999
069600       IF PS-FIRST-ANL                                            02380099
069700          PERFORM 6000-WRITE-DETAIL-LINE        THRU 6000-EXIT    02380199
069800          PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL THRU 2230-EXIT    02380299
069900          MOVE 0    TO PA-RESOLVE-HOURS                           02380499
070000                       PA-RESOLVE-MINUTES                         02380599
070100                       PV-AVG-MINUTES                             02380699
070200                       PA-NBR-OF-RESOLVED-TRBLS                   02380799
070300                       PV-AVG-TOT-HOURS                           02380899
070400                       PV-AVG-TOT-MINUTES                         02380999
070500                       PA-TOT-OF-PRBLMS                           02381099
070600                       PA-TOT-TRBLS                               02381199
070700          SET PS-NOT-FIRST-ANL       TO TRUE                      02381399
070800          SET PV-AREA-SAVE-MDS       TO TRUE                      02381499
070900       END-IF.                                                    02381699
071000 2214-EXIT.  EXIT.                                                02381799
071100                                                                  02381899
071200                                                                  02381904
071300 2220-DC-TOTALS.                                                  02382043
071400     IF TM001-OPER-UNT-ID  NOT = PV-OPER-UNT-ID-SAVE              02382142
071500        IF NOT PS-FIRST-DC                                        02382242
071600           PERFORM 6000-WRITE-DETAIL-LINE         THRU 6000-EXIT  02382345
071700           PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL  THRU 2230-EXIT  02382445
071800        END-IF                                                    02382542
071900        MOVE 0    TO PA-RESOLVE-HOURS                             02382642
072000                     PA-RESOLVE-MINUTES                           02382742
072100                     PV-AVG-MINUTES                               02382842
072200                     PA-NBR-OF-RESOLVED-TRBLS                     02382942
072300                     PV-AVG-TOT-HOURS                             02383042
072400                     PV-AVG-TOT-MINUTES                           02383142
072500                     PA-TOT-OF-PRBLMS                             02383242
072600                     PA-TOT-TRBLS                                 02383342
072700        IF PS-FIRST-DC                                            02383447
072800           SET PS-NOT-FIRST-DC         TO TRUE                    02383542
072900        END-IF                                                    02383642
073000        MOVE TM001-OPER-UNT-ID    TO PV-OPER-UNT-ID-SAVE          02383742
073100     END-IF                                                       02383842
073200                                                                  02383942
073300     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             02384043
073400 2220-EXIT.  EXIT.                                                02384143
073500                                                                  02384242
073600 2215-ACCUMULATE-TOTALS.                                          02384342
073700     IF TM001-NOTIF-DATE       <= PV-END-DATE     AND             02384442
073800        TM001-NOTIF-DATE       >= PV-START-DATE   AND             02384542
073900         ((TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR      02384642
074000          (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR      02384742
074100          (TM001-NOTIF-DATE   NOT = PV-NOTIF-DATE-SAVE)   OR      02384878
074200          (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE))       02384942
074300                                                                  02385042
074400        ADD 1   TO PA-TOT-TRBLS                                   02385142
074500     END-IF.                                                      02385278
074600                                                                  02385342
074700     IF TM001-RESOLVED-DATE    <= PV-END-DATE     AND             02385478
074800        TM001-RESOLVED-DATE    >= PV-START-DATE   AND             02385578
074900        TM001-RPT-RESOLVED                                        02385678
075000          ADD TM001-RESOLVED-HOURS    TO PA-RESOLVE-HOURS         02385742
075100          ADD TM001-RESOLVED-MINUTES  TO PA-RESOLVE-MINUTES       02385842
075200          ADD 1      TO PA-NBR-OF-RESOLVED-TRBLS                  02385942
075300     END-IF.                                                      02386078
075400                                                                  02386178
075500     IF (TM001-NOTIF-DATE  NOT = PV-NOTIF-DATE-SAVE)    OR        02386277
075600        (TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR        02386377
075700        (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR        02386475
075800        (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE)          02386577
075900         IF TM001-RPT-UNRESOLVED                                  02386675
076000            ADD 1      TO PA-NBR-UNRESOLVED-TRBLS                 02386775
076100            ADD 1      TO PA-TOT-UNRESLVED-TRBLS                  02386875
076200         END-IF                                                   02386975
076300      END-IF.                                                     02387076
076400                                                                  02387142
076500 2215-EXIT.  EXIT.                                                02387242
076600                                                                  02387342
076700 2230-LOAD-UNRSLVD-TROUBLE-TBL.                                   02387404
076800     EVALUATE TRUE                                                02387542
076900       WHEN TM001-RPT-AREA-BUYING                                 02387642
077000          MOVE PC-AREA-GMM      TO UTT-AREA (UTT-INX)             02387746
077100          MOVE ZEROS            TO UTT-GMM-OR-DC-NBR-RED (UTT-INX)02387898
077200          MOVE PV-GMM-SAVE      TO UTT-GMM-NBR (UTT-INX)          02387995
077300          MOVE PV-GMM-NAME-SAVE TO UTT-GMM-OR-DC-NAME (UTT-INX)   02388046
077400       WHEN TM001-RPT-AREA-ANALYST                                02388199
077500          IF PS-FIRST-ANL                                         02388299
077600             MOVE PC-AREA-GMM      TO UTT-AREA (UTT-INX)          02388399
077700             MOVE ZEROS            TO UTT-GMM-OR-DC-NBR-RED       02388499
077800                                                   (UTT-INX)      02388599
077900             MOVE PV-GMM-SAVE      TO UTT-GMM-NBR (UTT-INX)       02388699
078000             MOVE PV-GMM-NAME-SAVE TO UTT-GMM-OR-DC-NAME (UTT-INX)02388799
078100          END-IF                                                  02389299
078200       WHEN TM001-RPT-AREA-DC                                     02389342
078300          IF PS-FIRST-DC                                          02389446
078400            IF PS-FIRST-ANL                                       02389599
078500               MOVE PC-AREA-GMM    TO UTT-AREA (UTT-INX)          02389699
078600               MOVE ZEROS          TO UTT-GMM-OR-DC-NBR-RED       02389799
078700                                                        (UTT-INX) 02389899
078800               MOVE PV-GMM-SAVE    TO UTT-GMM-NBR (UTT-INX)       02389999
078900               MOVE PV-GMM-NAME-SAVE TO UTT-GMM-OR-DC-NAME        02390199
079000                                                        (UTT-INX) 02390299
079100            ELSE                                                  02390399
079200                MOVE PC-AREA-MERCH    TO UTT-AREA (UTT-INX)       02390499
079300                MOVE SPACE            TO UTT-GMM-OR-DC-NBR        02390699
079400                                                       (UTT-INX)  02390799
079500                MOVE PC-MDS-DESC      TO UTT-GMM-OR-DC-NAME       02390899
079600                                                       (UTT-INX)  02390999
079700            END-IF                                                02391099
079800          ELSE                                                    02391146
079900            MOVE PC-AREA-DC          TO UTT-AREA (UTT-INX)        02391246
080000            MOVE PV-OPER-UNT-ID-SAVE TO PV-OPER-UNT-ID-HOLD       02391351
080100            PERFORM 6100-GET-DC-NAME THRU 6100-EXIT               02391448
080200            MOVE  PV-OPER-UNT-ID-GROUP     TO                     02391556
080300                                       UTT-GMM-OR-DC-NBR (UTT-INX)02391646
080400            MOVE PV-DC-NAME-HOLD     TO UTT-GMM-OR-DC-NAME        02391748
080500                                                 (UTT-INX)        02391846
080600          END-IF                                                  02391955
080700      WHEN PS-FIRST-CM-RECORD                                     02392054
080800            MOVE PC-AREA-DC          TO UTT-AREA (UTT-INX)        02392154
080900            MOVE PV-OPER-UNT-ID-SAVE TO PV-OPER-UNT-ID-HOLD       02392254
081000            PERFORM 6100-GET-DC-NAME THRU 6100-EXIT               02392354
081100            MOVE  PV-OPER-UNT-ID-GROUP TO                         02392456
081200                                       UTT-GMM-OR-DC-NBR (UTT-INX)02392554
081300            MOVE PV-DC-NAME-HOLD     TO UTT-GMM-OR-DC-NAME        02392654
081400                                                 (UTT-INX)        02392754
081500                                                                  02392854
081600     END-EVALUATE                                                 02392942
081700                                                                  02393005
081800          MOVE PV-TRBL-RSN-CDE-SAVE      TO UTT-TRBL-RSN-CDE      02393142
081900                                                 (UTT-INX)        02393205
082000          MOVE PV-TRBL-RSN-CDE-DESC-SAVE TO UTT-TRBL-RSN-CDE-DESC 02393342
082100                                                 (UTT-INX)        02393405
082200          MOVE PA-NBR-UNRESOLVED-TRBLS   TO                       02393542
082300                          UTT-NBR-UNRSLVED-TRBLS  (UTT-INX)       02393607
082400                                                                  02393742
082500          SET UTT-INX  UP BY 1                                    02393836
082600          MOVE 0       TO PA-NBR-UNRESOLVED-TRBLS.                02393943
082700                                                                  02394005
082800 2230-EXIT.  EXIT.                                                02394104
082900                                                                  02394201
083000 2300-TOP-TROUBLES-RPT.                                           02394301
083100     SET PS-TOP-TROUBLES-RPT   TO TRUE                            02394402
083200                                                                  02394522
083300     IF PV-LINE-COUNT > PC-LINE-LIMIT                             02394622
083400        PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT        02394723
083500     END-IF.                                                      02394822
083600                                                                  02394922
083700     IF PS-FIRST-CM-RECORD                                        02395022
083800         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     02395122
083900         SET PS-NOT-FIRST-CM-RECORD  TO TRUE                      02395222
084000     END-IF.                                                      02395322
084100                                                                  02395422
084200     IF PV-TOP-TRBLS-COUNT < 6                                    02395583
084300        IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE          02395607
084400           IF TM001-RTL-RSN-CDE-TOT-QTY > 0                       02395792
084500              PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT     02395892
084600              IF PV-TOP-TRBLS-COUNT = 5                           02395993
084700                 MOVE TM001-RTL-RSN-CDE-TOT-QTY TO                02396093
084800                                         PV-RSN-CDE-TOT-QTY-SAVE  02396193
084900              END-IF                                              02396293
085000              ADD  1  TO PV-TOP-TRBLS-COUNT                       02396393
085100           END-IF                                                 02396493
085200        END-IF                                                    02396502
085300     ELSE                                                         02396683
085400       IF TM001-RTL-RSN-CDE-TOT-QTY = PV-RSN-CDE-TOT-QTY-SAVE     02396784
085500          IF TM001-RTL-RSN-CDE-TOT-QTY > 0                        02396892
085600             PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT      02396992
085700             ADD  1  TO PV-TOP-TRBLS-COUNT                        02397094
085800          END-IF                                                  02397192
085900       END-IF                                                     02397283
086000     END-IF.                                                      02397302
086100 2300-EXIT.  EXIT.                                                02397401
086200                                                                  02397505
086300                                                                  02397601
086400 3000-WRITE-UNRESOLVED-TRBL-RPT.                                  02397707
086500     SET PS-UNRESOLVED-TRBLS-RPT    TO TRUE.                      02397802
086600                                                                  02397925
086700     IF PV-LINE-COUNT > PC-LINE-LIMIT                             02398025
086800        PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT        02398125
086900     END-IF.                                                      02398225
087000                                                                  02398325
087100     IF PS-FIRST-UNRSLVED-DETAIL                                  02398458
087200         MOVE  PA-TOT-UNRESLVED-TRBLS TO TL2-UNRSLVED-TRBL-TOT    02398535
087300         WRITE DAILY-OVERALL-TRBL-RECORD                          02398635
087400                       FROM TL2-TOTAL-LINE-2                      02398735
087500                            AFTER ADVANCING 5 LINES               02398835
087600         ADD 5   TO PV-LINE-COUNT                                 02398935
087700                                                                  02399035
087800         WRITE DAILY-OVERALL-TRBL-RECORD                          02399135
087900                       FROM BL-BLANK-LINE                         02399235
088000                           AFTER ADVANCING 1 LINES                02399335
088100         ADD 1   TO PV-LINE-COUNT                                 02399467
088200         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     02399525
088300         SET PS-NOT-FIRST-UNRSLVD-DETAIL   TO TRUE                02399625
088400     END-IF.                                                      02399725
088500                                                                  02399812
088600     PERFORM VARYING UTT-INX   FROM 1 BY 1                        02399905
088700            UNTIL UTT-INX > 250                                   02400007
088800               OR UTT-UNRESOLVED-TRBL-ENTRY (UTT-INX) = LOW-VALUES02400105
088900        IF PV-LINE-COUNT > PC-LINE-LIMIT                          02400205
089000           PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT            02400310
089100        END-IF                                                    02400405
089200        EVALUATE TRUE                                             02400599
089300           WHEN UTT-AREA (UTT-INX) = PC-AREA-GMM                  02400699
089400                MOVE UTT-GMM-OR-DC-NBR (UTT-INX)                  02400799
089500                                           TO DL-GMM-NBR          02400899
089600                MOVE DL-GMM-INFO    TO DL3-INFO                   02400999
089700           WHEN UTT-AREA (UTT-INX) = PC-AREA-MERCH                02401099
089800                MOVE DL-MDS-INFO    TO DL3-INFO                   02401199
089900           WHEN UTT-AREA (UTT-INX) = PC-AREA-DC                   02401399
090000                MOVE UTT-GMM-OR-DC-NBR (UTT-INX)                  02401499
090100                                           TO DL-DC-NBR           02401599
090200                MOVE DL-DC-INFO     TO DL3-INFO                   02401699
090300        END-EVALUATE                                              02401799
090400*       MOVE UTT-AREA (UTT-INX)          TO DL3-AREA              02401899
090500*       MOVE UTT-GMM-OR-DC-NBR (UTT-INX) TO DL3-GMM-OR-DC-NBR     02401999
090600        MOVE UTT-GMM-OR-DC-NAME (UTT-INX)TO DL3-GMM-OR-DC-NAME    02402005
090700        MOVE UTT-NBR-UNRSLVED-TRBLS (UTT-INX)                     02402114
090800                                         TO DL3-TOT-ASSIGNED-TRBLS02402205
090900         IF  UTT-NBR-UNRSLVED-TRBLS (UTT-INX) NOT = 0             02402369
091000            PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT       02402469
091100         END-IF                                                   02402569
091200     END-PERFORM.                                                 02402605
091300 3000-EXIT.  EXIT.                                                02402701
091400                                                                  02402801
091500 6000-WRITE-DETAIL-LINE.                                          02402902
091600     IF PV-LINE-COUNT > PC-LINE-LIMIT                             02403067
091700        PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT               02403167
091800     END-IF.                                                      02403267
091900                                                                  02403367
092000     EVALUATE TRUE                                                02403401
092100        WHEN PS-TROUBLES-ASSIGNED-RPT                             02403501
092200         PERFORM 6200-CALC-AVG-RESOLVE-TIME THRU 6200-EXIT        02403669
092300         IF   PA-TOT-TRBLS        = 0  AND                        02403769
092400              PV-AVG-TOT-HOURS    = 0  AND                        02403869
092500              PV-AVG-TOT-MINUTES  = 0                             02403969
092600              GO TO 6000-EXIT                                     02404069
092700         END-IF                                                   02404169
092800         IF PV-AREA-SAVE-BUYING                                   02404239
092900            MOVE PV-GMM-SAVE       TO DL-GMM-NBR                  02404399
093000            MOVE DL-GMM-INFO       TO DL1-INFO                    02404499
093100            MOVE PV-GMM-NAME-SAVE  TO DL1-GMM-OR-DC-NAME          02404537
093200         ELSE                                                     02404699
093300            IF PV-AREA-SAVE-MDS                                   02404799
093400               MOVE DL-MDS-INFO    TO DL1-INFO                    02404899
093500               MOVE PC-MDS-DESC    TO DL1-GMM-OR-DC-NAME          02404999
093600            ELSE                                                  02405099
093700              IF NOT PS-FIRST-CM-RECORD                           02405199
093800                 MOVE TM001-OPER-UNT-ID TO PV-OPER-UNT-ID-HOLD    02405299
093900                 MOVE PV-OPER-UNT-ID-HOLD TO PV-OPER-UNT-ID-GROUP 02405399
094000                 MOVE PV-OPER-UNT-ID-GROUP TO  DL-DC-NBR          02405499
094100                 MOVE DL-DC-INFO        TO DL1-INFO               02405599
094200                 PERFORM 6100-GET-DC-NAME  THRU 6100-EXIT         02405799
094300                 MOVE PV-DC-NAME-HOLD       TO DL1-GMM-OR-DC-NAME 02405899
094400              ELSE                                                02405999
094500                 MOVE PV-OPER-UNT-ID-SAVE TO PV-OPER-UNT-ID-GROUP 02406099
094600                 MOVE PV-OPER-UNT-ID-GROUP    TO DL-DC-NBR        02406199
094700                 MOVE DL-DC-INFO          TO DL1-INFO             02406299
094800                 MOVE PV-OPER-UNT-ID-SAVE TO PV-OPER-UNT-ID-HOLD  02406399
094900                 PERFORM 6100-GET-DC-NAME  THRU 6100-EXIT         02406499
095000                 MOVE PV-DC-NAME-HOLD       TO DL1-GMM-OR-DC-NAME 02406599
095100              END-IF                                              02406699
095200           END-IF                                                 02406799
095300         END-IF                                                   02406801
095400         MOVE PA-TOT-TRBLS      TO DL1-TOT-ASSIGNED-TRBLS         02406902
095500         IF PV-TOT-TROUBLE-SAVE > 0                               02407061
095600            COMPUTE PV-PER-TO-TOT = PA-TOT-TRBLS * 100 /          02407161
095700                                           PV-TOT-TROUBLE-SAVE    02407207
095800         ELSE                                                     02407361
095900            MOVE 0   TO PV-TOT-TROUBLE-SAVE                       02407461
096000         END-IF                                                   02407561
096100         MOVE PV-PER-TO-TOT     TO DL1-PER-TO-TOT                 02407602
096200         WRITE DAILY-OVERALL-TRBL-RECORD                          02407702
096300          FROM DL1-DETAIL-LINE-1                                  02407802
096400               AFTER ADVANCING 1 LINE                             02407902
096500          ADD 1   TO PV-LINE-COUNT                                02408067
096600        WHEN PS-TOP-TROUBLES-RPT                                  02408101
096700         MOVE TM001-RTL-TRBL-RSN-CDE    TO DL2-TROUBLE-NBR        02408220
096800         MOVE TM001-RTL-TRBL-RSN-CDE-DESC                         02408320
096900                                        TO DL2-TROUBLE-DESCRIPTION02408420
097000         MOVE TM001-RTL-RSN-CDE-TOT-QTY TO DL2-ASSIGNED-QTY       02408520
097100         IF PV-TOT-TROUBLE-SAVE > 0                               02408672
097200            COMPUTE PV-PER-TO-TOT = TM001-RTL-RSN-CDE-TOT-QTY *   02408773
097300                                 100 / PV-TOT-TROUBLE-SAVE        02408873
097400         ELSE                                                     02408972
097500            MOVE 0   TO PV-PER-TO-TOT                             02409072
097600         END-IF                                                   02409172
097700                                                                  02409272
097800         MOVE PV-PER-TO-TOT            TO DL2-PER-TO-TOTAL        02409302
097900                                                                  02409402
098000         WRITE DAILY-OVERALL-TRBL-RECORD                          02409502
098100             FROM DL2-DETAIL-LINE-2                               02409601
098200                  AFTER ADVANCING 1 LINE                          02409701
098300          ADD 1   TO PV-LINE-COUNT                                02409867
098400        WHEN PS-UNRESOLVED-TRBLS-RPT                              02409901
098500            WRITE DAILY-OVERALL-TRBL-RECORD                       02410001
098600             FROM DL3-DETAIL-LINE-3                               02410101
098700                  AFTER ADVANCING 1 LINE                          02410201
098800          ADD 1   TO PV-LINE-COUNT                                02410367
098900     END-EVALUATE.                                                02410401
099000                                                                  02410501
099100 6000-EXIT.  EXIT.                                                02410601
099200                                                                  02410701
099300 6100-GET-DC-NAME.                                                02410802
099400     INITIALIZE XL071-COMMAREA-REC.                               02410902
099400     MOVE PV-OPER-UNT-ID-HOLD TO XL071-LOCATION-NUMBER.           02410902
099500                                                                  02411002
099600     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         02411102
100200                                                                  02411702
100300     EVALUATE TRUE                                                02411802
100400         WHEN XL071-NO-ERRORS                                     02411902
100500           MOVE XL071-LOC-NM     TO PV-DC-NAME-HOLD               02412005
100600         WHEN XL071-LOC-NOT-FOUND                                 02412102
100700         WHEN XL071-SQLCODE-N = -904                              02412202
100800         WHEN XL071-SQLCODE-N = -913                              02412302
100900             MOVE PC-NOT-FOUND   TO DL1-GMM-OR-DC-NAME            02412402
101000         WHEN XL071-BAD-DB2-RETURN                                02412502
101300              MOVE XL071-SQLCODE TO PV-ABEND-SQLCODE              02412802
101300              DISPLAY '** ABEND ** IN TMKRP007'                   02412802
101400              DISPLAY 'PARAGRAPH:6100-GET-DC-NAME'                02412963
101410              DISPLAY 'SQLCODE: ' PV-ABEND-SQLCODE                02412702
101500              DISPLAY                                             02413002
101600             'MESSAGE:  SQL ERROR SELECTING FROM XLT-LOC'         02413102
101700              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             02413202
101800     END-EVALUATE.                                                02413302
101900 6100-EXIT.  EXIT.                                                02413402
102000                                                                  02413502
102100 6200-CALC-AVG-RESOLVE-TIME.                                      02413607
102200       INITIALIZE                                                 02413702
102300                  DL1-AVG-RESOLVE-HHH                             02413802
102400                  DL1-AVG-RESOLVE-MM.                             02413902
102500                                                                  02414002
102600        IF PA-RESOLVE-HOURS          = 0 AND                      02414102
102700           PA-RESOLVE-MINUTES        = 0 AND                      02414202
102800           PA-NBR-OF-RESOLVED-TRBLS  = 0                          02414307
102900           MOVE 0   TO PV-AVG-TOT-HOURS                           02414402
103000           MOVE 0   TO PV-AVG-TOT-MINUTES                         02414502
103100       ELSE                                                       02414602
103200         MULTIPLY 60 BY PA-RESOLVE-HOURS                          02414702
103300         ADD PA-RESOLVE-HOURS TO PA-RESOLVE-MINUTES               02414802
103400         DIVIDE PA-RESOLVE-MINUTES                                02414902
103500                      BY PA-NBR-OF-RESOLVED-TRBLS                 02415002
103600                  GIVING PV-AVG-MINUTES ROUNDED                   02415102
103700                  ON SIZE ERROR                                   02415202
103800                       MOVE 0 TO PV-AVG-MINUTES                   02415302
103900         END-DIVIDE                                               02415402
104000                                                                  02415502
104100         DIVIDE PV-AVG-MINUTES BY 60                              02415602
104200                GIVING PV-AVG-TOT-HOURS                           02415702
104300                REMAINDER PV-AVG-TOT-MINUTES                      02415802
104400                ON SIZE ERROR                                     02415902
104500                      MOVE 0 TO PV-AVG-TOT-HOURS                  02416002
104600                                PV-AVG-TOT-MINUTES                02416102
104700         END-DIVIDE                                               02416202
104800      END-IF.                                                     02416302
104900                                                                  02416402
105000        MOVE PV-AVG-TOT-HOURS          TO DL1-AVG-RESOLVE-HHH     02416502
105100        MOVE PV-AVG-TOT-MINUTES        TO DL1-AVG-RESOLVE-MM.     02416602
105200                                                                  02416702
105300 6200-EXIT.  EXIT.                                                02416802
105400                                                                  02416902
105500 6900-PRINT-HEADINGS.                                             02417010
105600     PERFORM 6910-PRINT-COMMON-HEADINGS   THRU 6910-EXIT.         02417111
105700     PERFORM 6920-PRINT-SPECIFIC-HEADINGS THRU 6920-EXIT.         02417211
105800                                                                  02418001
105900 6900-EXIT.   EXIT.                                               02420010
106000*                                                                 03100000
106100 6910-PRINT-COMMON-HEADINGS.                                      03101010
106200     MOVE 0                          TO PV-LINE-COUNT             03101110
106300     ADD 1                           TO PV-PAGE-COUNT             03101210
106400     MOVE PV-PAGE-COUNT              TO DP132O-PAGE-NUMBER        03101310
106500                                                                  03101410
106600     WRITE DAILY-OVERALL-TRBL-RECORD                              03101510
106700           FROM DP132O-STANDRD-HEADER-132-COLS                    03101610
106800                AFTER ADVANCING PAGE.                             03101710
106900     WRITE DAILY-OVERALL-TRBL-RECORD                              03101810
107000      FROM HL1-HEADING-LINE-1                                     03101910
107100           AFTER ADVANCING 2 LINES                                03102010
107200     ADD 2  TO PV-LINE-COUNT.                                     03102167
107300 6910-EXIT.  EXIT.                                                03102210
107400                                                                  03103010
107500 6920-PRINT-SPECIFIC-HEADINGS.                                    03104012
107600     EVALUATE TRUE                                                03104110
107700        WHEN PS-TROUBLES-ASSIGNED-RPT                             03104210
107800            WRITE DAILY-OVERALL-TRBL-RECORD                       03104310
107900             FROM HL2-HEADING-LINE-2                              03104410
108000                  AFTER ADVANCING 2 LINES                         03104558
108100            WRITE DAILY-OVERALL-TRBL-RECORD                       03104612
108200             FROM HL3-HEADING-LINE-3                              03104712
108300                  AFTER ADVANCING 1 LINE                          03104812
108400            WRITE DAILY-OVERALL-TRBL-RECORD                       03104912
108500             FROM BL-BLANK-LINE                                   03105012
108600                  AFTER ADVANCING 1 LINE                          03105112
108700           ADD 4  TO PV-LINE-COUNT                                03105258
108800        WHEN PS-TOP-TROUBLES-RPT                                  03105310
108900            WRITE DAILY-OVERALL-TRBL-RECORD                       03105410
109000             FROM HL4-HEADING-LINE-4                              03105512
109100                  AFTER ADVANCING 4 LINES                         03105658
109200            WRITE DAILY-OVERALL-TRBL-RECORD                       03106012
109300             FROM HL5-HEADING-LINE-5                              03106112
109400                  AFTER ADVANCING 2 LINES                         03106212
109500            WRITE DAILY-OVERALL-TRBL-RECORD                       03106312
109600             FROM HL6-HEADING-LINE-6                              03106412
109700                  AFTER ADVANCING 1 LINE                          03106512
109800            WRITE DAILY-OVERALL-TRBL-RECORD                       03106658
109900             FROM BL-BLANK-LINE                                   03106758
110000                  AFTER ADVANCING 1 LINES                         03106858
110100           ADD 8  TO PV-LINE-COUNT                                03106958
110200        WHEN PS-UNRESOLVED-TRBLS-RPT                              03107010
110300            WRITE DAILY-OVERALL-TRBL-RECORD                       03107110
110400             FROM HL7-HEADING-LINE-7                              03107212
110500                  AFTER ADVANCING 2 LINES                         03107312
110600            WRITE DAILY-OVERALL-TRBL-RECORD                       03107412
110700             FROM HL8-HEADING-LINE-8                              03107512
110800                  AFTER ADVANCING 1 LINE                          03107612
110900            WRITE DAILY-OVERALL-TRBL-RECORD                       03107712
111000             FROM BL-BLANK-LINE                                   03107812
111100                  AFTER ADVANCING 1 LINE                          03107912
111200           ADD 4  TO PV-LINE-COUNT                                03108012
111300     END-EVALUATE.                                                03108110
111400 6920-EXIT.  EXIT.                                                03108210
111500                                                                  03109010
111600 9000-END-PROCESS.                                                03110000
111700     WRITE DAILY-OVERALL-TRBL-RECORD                              03110164
111800           FROM ER-END-REPORT-LINE                                03110264
111900                AFTER ADVANCING 2 LINES.                          03110365
112000                                                                  03111064
112100     CLOSE  TROUBLE-EXTRACT-FILE                                  03120000
112200            DAILY-OVERALL-TRBL-RPT.                               03132001
112300 9000-EXIT.  EXIT.                                                03140000
112400                                                                  03150000
112500 9999-SQL-ERROR.                                                  03160000
112600                                                                  03170000
112700     COPY DPPD004.                                                03180000
112800                                                                  03190000
112900     MOVE +4013 TO PV-ABEND-CODE.                                 03200000
113000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03210000
113100 9999-EXIT.   EXIT.                                               03220000
113200                                                                  03230000
