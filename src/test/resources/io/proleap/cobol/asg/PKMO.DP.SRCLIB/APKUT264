000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKUT264.                                        00020001
000300 AUTHOR.         NANCY EILBES.                                    00030001
000400*DATE-WRITTEN.   FEBRUARY 2001.                                   00040001
000500*DATE-COMPILED.                                                   00050001
000600*************************************************************     00060001
000700*    COBOL 2 WITH SQL                                       *     00070001
000800*************************************************************     00080005
000900*                                                           *     00090001
001000*  CREATE INVOICE STATUS CHANGES FROM OPEN INVOICE EXTRACT  *     00100005
001100*                                                           *     00110005
001200*************************************************************     00120005
001300*                                                           *     00130005
001400*    REFORMAT OPEN INVOICE EXTRACT RECORDS INTO THE STATUS  *     00140001
001500*    UPDATE COPYBOOK FORMAT SO THAT THOSE MEETING THE DATE  *     00150001
001600*    CRITERIA, CONTROLLED BY A SORT INCLUDE CONDITION ON    *     00160001
001700*    DAYS DELINQUENT, CAN HAVE THEIR STATUS SET TO 'DE'.    *     00170001
001800*                                                           *     00180001
001900* INPUT:                                                    *     00190001
002000* 1.  OPEN-INVOICE-FILE                     (APRD262)       *     00200005
002100*     INCLUDING ONLY RECORDS WHERE DAYS DELINQUENT IS       *     00210001
002200*     OVER 365 AND THE INVOICE TYPE IS MI.                  *     00220001
002300*                                                           *     00230001
002400* OUTPUT:                                                   *     00240001
002500* 1.  STATUS-UPDATE-FILE                    (APRD067)       *     00250005
002600*************************************************************     00260001
002700* CHANGE LOG:                                               *     00270001
002800*                                                           *     00280001
002900* 02/27/01    INITIAL VERSION.                              *     00290004
003000*                                                           *     00300001
003100* 02/07/2003                                                *     00310005
003200*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00320005
003300*    ADDED PGM TITLE TO MATCH THE SPEC TITLE.               *     00330005
003400*    UPDATED PGM COMMENT BLOCK WITH THE FILENAMES.          *     00340005
003500*    CHANGED -PURCHASE-ORDER TO -PO-NBR FOR THE MODIFIED    *     00350005
003600*    COPYBOOK.                                              *     00360005
003700* MADE BY:  MIKE BESKE                          WR#: 23500  *     00370005
003800*                                                           *     00380005
003810* 03/11/2007                                                *     00381006
003820*    CHANGE MADE: MBDC PROJECT - RECOMPILE                  *     00382006
003870* MADE BY:  GREG WISIALOWSKI                    WR#: 21578  *     00387006
003880*                                                           *     00388006
003890* 06/12/2008                                                *     00389007
003891*    CHANGE MADE: MATCH BY DC PHASE 2 PROJECT.              *     00389108
003892*    RECOMPILED TO PICK UP CHANGES TO COPYBOOK APRD262.     *     00389208
003893* MADE BY:  ROLF NOHE                           WR#: 32804  *     00389308
003894*                                                           *     00389408
003895* DATE  11/14/2014                                          *     00389509
003896*      RECOMPILED THE PROGRAM. CHANGES WERE MADE TO APRD067 *     00389609
003897*      COPYBOOK.                                            *     00389709
003898*      MADE BY: COGNIZANT              WR/IR: CHG0094517    *     00389809
003894*                                                           *     00389910
003895* DATE  08/31/2021                                          *     00390010
003896*      RECOMPILED FOR UPDATED COPYBOOK APRD262              *     00390111
003898*      MADE BY: JEAN KURK              WR/IR: CHG0260549    *     00390310
003900*************************************************************     00391001
004000                                                                  00400001
004100 ENVIRONMENT DIVISION.                                            00410001
004200                                                                  00420001
004300 INPUT-OUTPUT SECTION.                                            00430001
004400                                                                  00440001
004500 FILE-CONTROL.                                                    00450001
004600                                                                  00460001
004700     SELECT OPEN-INVOICE-FILE   ASSIGN TO UT-S-INP01.             00470001
004800     SELECT STATUS-UPDATE-FILE  ASSIGN TO UT-S-OUT01.             00480001
004900                                                                  00490001
005000 DATA DIVISION.                                                   00500001
005100                                                                  00510001
005200 FILE SECTION.                                                    00520001
005300 FD  OPEN-INVOICE-FILE                                            00530001
005400     RECORDING MODE IS F                                          00540001
005500     BLOCK CONTAINS 0 CHARACTERS                                  00550001
005600     LABEL RECORDS ARE STANDARD                                   00560001
005700     DATA RECORD IS OPEN-INVOICE-RECORD.                          00570001
005800                                                                  00580001
005900 01  OPEN-INVOICE-RECORD           PIC X(100).                    00590001
006000                                                                  00600001
006100 FD  STATUS-UPDATE-FILE                                           00610001
006200     RECORDING MODE IS F                                          00620001
006300     LABEL RECORDS ARE STANDARD                                   00630001
006400     DATA RECORD IS STATUS-UPDATE-RECORD.                         00640001
006500                                                                  00650001
006600 01  STATUS-UPDATE-RECORD          PIC X(80).                     00660001
006700                                                                  00670001
006800 EJECT                                                            00680002
006900 WORKING-STORAGE SECTION.                                         00690001
007000                                                                  00700001
007100 01  FILLER                        PIC X(25) VALUE                00710001
007200                             'WS FOR APKUT264 BEGINS==>'.         00720001
007300                                                                  00730001
007400 01  STATUS-CHG-TMST.                                             00740001
007500     05 STATUS-CHG-DATE            PIC X(10) VALUE SPACES.        00750001
007600     05 STATUS-CHG-TIME            PIC X(16) VALUE                00760001
007700                                       '-00.00.00.000000'.        00770001
007800 01  WS-SWITCH-AREA.                                              00780001
007900     05  WS-INVOICES-END-SW        PIC X(03)  VALUE 'NO '.        00790001
008000         88  WS-END-OF-INVOICES               VALUE 'YES'.        00800001
008100         88  WS-NOT-END-OF-INVOICES           VALUE 'NO '.        00810001
008200*                                                                 00820001
008300 01  WS-PROGRAM-COUNTERS.                                         00830001
008400     05  WS-RECORDS-READ         PIC 9(09) VALUE ZERO.            00840001
008500     05  WS-RECORDS-WRITTEN      PIC 9(05) VALUE ZERO.            00850001
008600                                                                  00860001
008700     COPY DPWS004.                                                00870001
008800                                                                  00880001
008900*----------------------------------------------------------------*00890001
009000*    OPEN INVOICE RECORD                                          00900001
009100*----------------------------------------------------------------*00910001
009200     COPY APRD262.                                                00920001
009300                                                                  00930001
009400*----------------------------------------------------------------*00940001
009500*    STATUS UPDATE RECORD                                         00950001
009600*----------------------------------------------------------------*00960001
009700     COPY APRD067.                                                00970001
009800                                                                  00980001
009900 01  FILLER                      PIC X(35)  VALUE                 00990001
010000     'END OF AP WORK RECORD AREA       **'.                       01000001
010100                                                                  01010001
010200 01  WS-ABEND-FIELDS.                                             01020001
010300     05  WS-ABEND-PROGRAM             PIC X(8)  VALUE 'APKUT264'. 01030001
010400     05  WS-ABEND-PARAGRAPH           PIC X(50) VALUE SPACES.     01040001
010500     05  WS-ABEND-OPERATION           PIC X(50) VALUE SPACES.     01050001
010600     05  WS-ABEND-STRUCTURE-1         PIC X(8)  VALUE SPACES.     01060001
010700     05  WS-ABEND-STRUCTURE-2         PIC X(8)  VALUE SPACES.     01070001
010800     05  WS-ABEND-STATUS              PIC XX    VALUE SPACES.     01080001
010900                                                                  01090001
011000 01  ABEND-CODE                    PIC S9(4) COMP SYNC            01100001
011100                                             VALUE ZEROS.         01110001
011200     88 AP-TABLE-FULL              VALUE +4004.                   01120001
011300     88 AP-EMPTY-FILE              VALUE +4005.                   01130001
011400                                                                  01140001
011500                                                                  01150001
011600 01  FILLER                        PIC X(25) VALUE                01160001
011700          '<====WS FOR APKUT264 ENDS'.                            01170001
011800                                                                  01180001
011900 PROCEDURE DIVISION.                                              01190001
012000                                                                  01200001
012100 A100-MAINLINE.                                                   01210001
012200                                                                  01220001
012300     PERFORM B100-INITIAL.                                        01230003
012400                                                                  01240003
012500     PERFORM B200-REFORMAT-INVOICES                               01250003
012600       UNTIL WS-END-OF-INVOICES.                                  01260001
012700                                                                  01270001
012800     PERFORM B300-END-OF-JOB.                                     01280003
012900                                                                  01290001
013000     GOBACK.                                                      01300001
013100        EJECT                                                     01310001
013200                                                                  01320001
013300***************************************************************** 01330001
013400*    CALCULATE DATE USED FOR DELETING INOVICES BASED ON THE     * 01340001
013500*    BTCH_PRC_DTE FROM TAPCNTL TABLE.                           * 01350001
013600***************************************************************** 01360001
013700 B100-INITIAL.                                                    01370004
013800                                                                  01380004
013900     OPEN  INPUT   OPEN-INVOICE-FILE                              01390001
014000           OUTPUT  STATUS-UPDATE-FILE.                            01400001
014100                                                                  01410001
014200     PERFORM R100-READ-OPEN-INVOICES.                             01420003
014300                                                                  01430003
014400     IF   WS-END-OF-INVOICES                                      01440001
014500          DISPLAY '**********************************'            01450001
014600          DISPLAY '*   EMPTY INVOICE FILE           *'            01460001
014700          DISPLAY '*   PROGRAM ** = APKUT264        *'            01470001
014800          DISPLAY '**********************************'            01480001
014900     END-IF.                                                      01490001
015000                                                                  01500001
015100                                                                  01510001
015200***************************************************************** 01520001
015300*              FORMAT INVOICES TO OUTPUT LAYOUT                 * 01530001
015400***************************************************************** 01540001
015500 B200-REFORMAT-INVOICES.                                          01550003
015600                                                                  01560003
015700     MOVE AP262-PAYT-REQ-SEQ-NBR  TO AP067-PAYT-REQ-SEQ-NBR.      01570001
015800     MOVE AP262-PO-NBR            TO AP067-PO-NBR.                01580005
015900     MOVE AP262-INVOICE-NUMBER    TO AP067-INVC-ID.               01590001
016000     MOVE AP262-INVOICE-STATUS    TO AP067-STATUS-CDE.            01600001
016100     MOVE AP262-GROSS-INVOICE-AMT TO AP067-GRO-COST-AMT.          01610001
016200     MOVE ZERO                    TO AP067-STR-NBR.               01620001
016300     MOVE AP262-INVOICE-TYPE      TO AP067-INVC-TYP-CDE           01630001
016400                                                                  01640001
016500     MOVE AP262-DUE-DATE          TO STATUS-CHG-DATE.             01650001
016600     MOVE STATUS-CHG-TMST         TO AP067-STATUS-CHG-TMST        01660001
016700                                                                  01670001
016800     PERFORM W100-WRITE-OUTPUT                                    01680001
016900     PERFORM R100-READ-OPEN-INVOICES.                             01690001
017000                                                                  01700001
017100                                                                  01710004
017200***************************************************************** 01720001
017300*     FINISH THE ERROR PROCESS, REPORT ON NECESSARY TOTALS,       01730001
017400*     AND CLOSE ALL FILES                                         01740001
017500***************************************************************** 01750001
017600 B300-END-OF-JOB.                                                 01760004
017700                                                                  01770004
017800     DISPLAY 'RECORDS READ    = ' WS-RECORDS-READ                 01780001
017900     DISPLAY 'RECORDS WRITTEN = ' WS-RECORDS-WRITTEN              01790001
018000                                                                  01800001
018100     CLOSE OPEN-INVOICE-FILE                                      01810001
018200           STATUS-UPDATE-FILE.                                    01820001
018300                                                                  01830001
018400                                                                  01840001
018500 R100-READ-OPEN-INVOICES.                                         01850001
018600                                                                  01860001
018700     READ OPEN-INVOICE-FILE INTO AP262-INPUT-RECORD               01870001
018800         AT END                                                   01880001
018900             SET WS-END-OF-INVOICES TO TRUE.                      01890001
019000                                                                  01900001
019100     IF NOT WS-END-OF-INVOICES                                    01910001
019200        ADD +1 TO WS-RECORDS-READ                                 01920002
019300     END-IF.                                                      01930001
019400                                                                  01940001
019500                                                                  01950001
019600 W100-WRITE-OUTPUT.                                               01960001
019700                                                                  01970001
019800     WRITE STATUS-UPDATE-RECORD   FROM AP067-RECORD.              01980001
019900                                                                  01990001
020000     ADD 1 TO WS-RECORDS-WRITTEN.                                 02000001
020100                                                                  02010001
020200                                                                  02020001
020300*                                                                 02030001
020400***************************************************************** 02040001
020500*    ABEND ROUTINE                                                02050001
020600***************************************************************** 02060001
020700 9999-ABEND.                                                      02070001
020800                                                                  02080001
020900     MOVE '9999-ABEND' TO WS-ABEND-PARAGRAPH.                     02090002
021000                                                                  02100001
021100     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 02110001
021200     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               02120001
021300     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               02130001
021400     CALL 'ILBOABN0' USING ABEND-CODE.                            02140001
021500                                                                  02150001
