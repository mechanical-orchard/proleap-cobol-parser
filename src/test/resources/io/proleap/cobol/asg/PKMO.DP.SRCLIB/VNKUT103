000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     VNKUT103.                                        00020000
000300 AUTHOR.         MIKE BESKE.                                      00030000
000400 DATE-WRITTEN.   JUNE 2004.                                       00040000
000500*************************************************************     00050000
000600*    COBOL 2 WITH SQL.                                      *     00060000
000700*                                                           *     00070000
000800*  THE PURPOSE OF THIS PROGRAM IS TO PRODUCE AN EXTRACT FILE*     00080000
000900*  THAT INCLUDES INFORMATION FROM THE VENDOR ADDRESS TABLE  *     00090000
001000*  (TBUSLOC).  IT WILL BE USED BY ANYONE THAT WANTS TO      *     00100000
001100*  REPRODUCE THE VENDOR ADDRESS TABLE DATA OUTSIDE THE      *     00110000
001200*  FINANCIAL DOMAIN.                                        *     00120000
001300*                                                           *     00130000
001400*************************************************************     00140000
001500*                                                           *     00150000
001600* DB2 TABLES:                                               *     00160000
001700*  1. VENDOR BUSINESS LOCATION TABLE           (TBUSLOC)    *     00170000
001800*  2. EXTERNAL ENTERPRISE REPRESENTATIVE TABLE (TENTREP)    *     00180000
001900*  3. COUNTRY TABLE                            (XFT00027)   *     00190000
002000*                                                           *     00200000
002100* OUTPUT:                                                   *     00210000
002200*  1. VENDOR ADDRESS EXTRACT FILE              (VNRD103)    *     00220000
002300*  2. VENDOR REPRESENTATIVE EXTRACT FILE       (VNRD106)    *     00230000
002400*  3. VENDOR ADDRESS FUNCTION EXTRACT FILE     (VNRD107)    *     00240000
002500*************************************************************     00250000
002600* CHANGE LOG:                                               *     00260000
002700*                                                           *     00270000
002800* DATE  06/10/2004                                          *     00280000
002900*     CHANGE MADE: INITIAL VERSION CREATED                  *     00290000
003000*     MADE BY: MIKE BESKE              WR/IR #: WR26194     *     00300000
003100*                                                           *     00310000
003200* DATE  02/08/2006                                          *     00320000
003300*     CHANGE MADE: MODIFY VENDOR EXTRACTS TO INCLUDE EMAIL  *     00330000
003400*                  ADDRESS.                                 *     00340000
003500*     MADE BY: ROLF NOHE               WR/IR #: WR30005     *     00350000
003600*                                                           *     00360000
003700* DATE  08/01/2011                                          *     00370000
003800*     CHANGE MADE: MODIFY FOR PEOPLESOFT UPGRADE.           *     00380000
003900*       CHANGED COUNTRY CODE TABLE FROM PS VERSION TO XFT   *     00390000
004000*       VERSION DUE TO PEOPLESOFT TABLE BEING MOVED TO      *     00400000
004010*       ORACLE.  THIS CHANGE IS FOR THE ORACLE REPLATFORM   *     00401000
004020*       THAT IS PART OF THE PEOPLESOFT FINANCIALS UPGRADE.  *     00402000
004030*     MADE BY: STEVE KRIEG             WR/IR #: WR 37038    *     00403000
004040*************************************************************     00404000
004050                                                                  00405000
004060 ENVIRONMENT DIVISION.                                            00406000
004070                                                                  00407000
004080 INPUT-OUTPUT SECTION.                                            00408000
004090                                                                  00409000
004100 FILE-CONTROL.                                                    00410000
004200     SELECT VNDR-ADDR-EXTRACT-FILE        ASSIGN TO OUT01.        00420000
004300     SELECT VNDR-REPR-EXTRACT-FILE        ASSIGN TO OUT02.        00430000
004400     SELECT VNDR-FUNC-EXTRACT-FILE        ASSIGN TO OUT03.        00440000
004500                                                                  00450000
004600 DATA DIVISION.                                                   00460000
004700                                                                  00470000
004800 FILE SECTION.                                                    00480000
004900 FD  VNDR-ADDR-EXTRACT-FILE                                       00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     DATA RECORD IS VNDR-DEPT-EXTRACT-REC.                        00520000
005300 01  VNDR-ADDR-EXTRACT-REC        PIC  X(200).                    00530000
005400*                                                                 00540000
005500 FD  VNDR-REPR-EXTRACT-FILE                                       00550000
005600     RECORDING MODE IS F                                          00560000
005700     LABEL RECORDS ARE STANDARD                                   00570000
005800     DATA RECORD IS VNDR-DEPT-EXTRACT-REC.                        00580000
005900 01  VNDR-REPR-EXTRACT-REC        PIC  X(380).                    00590000
006000*                                                                 00600000
006100 FD  VNDR-FUNC-EXTRACT-FILE                                       00610000
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     DATA RECORD IS VNDR-DEPT-EXTRACT-REC.                        00640000
006500 01  VNDR-FUNC-EXTRACT-REC        PIC  X(27).                     00650000
006600*                                                                 00660000
006700                                                                  00670000
006800/                                                                 00680000
006900 WORKING-STORAGE SECTION.                                         00690000
007000                                                                  00700000
007100 01  FILLER                        PIC X(25)  VALUE               00710000
007200                             'WS FOR VNKUT103 BEGINS==>'.         00720000
007300                                                                  00730000
007400 01  WS-RETRY-COUNTER              PIC S9(4)  COMP VALUE ZERO.    00740000
007500 01  WS-RETRY-MAX                  PIC S9(4)  COMP VALUE 3.       00750000
007600                                                                  00760000
007700 01  PS-SWITCH-AREA.                                              00770000
007800     05  WS-END-OF-CURSOR-SW           PIC X(1)   VALUE 'N'.      00780000
007900         88  WS-END-OF-VENDOR-ADDR-CSR            VALUE 'Y'.      00790000
008000     05  WS-END-OF-REPR-CURSOR-SW      PIC X(1)   VALUE 'N'.      00800000
008100         88  WS-END-OF-VENDOR-REPR-CSR            VALUE 'Y'.      00810000
008200     05  WS-END-OF-FUNC-CURSOR-SW      PIC X(1)   VALUE 'N'.      00820000
008300         88  WS-END-OF-VENDOR-FUNC-CSR            VALUE 'Y'.      00830000
008400                                                                  00840000
008500 01  WS-PROGRAM-COUNTERS.                                         00850000
008600     05  WS-VNDR-REC-ROWS-FETCHED  PIC  9(09) VALUE ZEROS.        00860000
008700     05  WS-VNDR-REC-WRITTEN       PIC  9(09) VALUE ZEROS.        00870000
008800     05  WS-VNDR-REP-ROWS-FETCHED  PIC  9(09) VALUE ZEROS.        00880000
008900     05  WS-VNDR-REP-WRITTEN       PIC  9(09) VALUE ZEROS.        00890000
009000     05  WS-VNDR-FNC-ROWS-FETCHED  PIC  9(09) VALUE ZEROS.        00900000
009100     05  WS-VNDR-FNC-WRITTEN       PIC  9(09) VALUE ZEROS.        00910000
009200     05  PV-COUNTRY-3-COUNT        PIC  9(09) VALUE ZEROS.        00920000
009300                                                                  00930000
009400                                                                  00940000
009500*---------------------------------------------------------------* 00950000
009600* SQLA MESSAGE MODULE                                             00960000
009700*---------------------------------------------------------------* 00970000
009800     COPY DPWS004.                                                00980000
009900                                                                  00990000
010000*---------------------------------------------------------------* 01000000
010100*  OUTPUT FILE COPY BOOK                                          01010000
010200*---------------------------------------------------------------* 01020000
010300     COPY VNRD103.                                                01030000
010400                                                                  01040000
010500*---------------------------------------------------------------* 01050000
010600*  VENDOR REPRESENTATIVE EXTRACT RECORD LAYOUT.                   01060000
010700*---------------------------------------------------------------* 01070000
010800     COPY VNRD106.                                                01080000
010900                                                                  01090000
011000*---------------------------------------------------------------* 01100000
011100*  VENDOR ADDRESS FUNCTION ID EXTRACT RECORD LAYOUT.              01110000
011200*---------------------------------------------------------------* 01120000
011300     COPY VNRD107.                                                01130000
011400                                                                  01140000
011500 01  WS-ABEND-FIELDS.                                             01150000
011600     05  WS-ABEND-PROGRAM          PIC X(8)   VALUE 'VNKUT103'.   01160000
011700     05  WS-ABEND-PARAGRAPH        PIC X(50)  VALUE SPACES.       01170000
011800     05  WS-ABEND-OPERATION        PIC X(50)  VALUE SPACES.       01180000
011900     05  WS-ABEND-STRUCTURE-1      PIC X(8)   VALUE SPACES.       01190000
012000     05  WS-ABEND-STRUCTURE-2      PIC X(8)   VALUE SPACES.       01200000
012100     05  WS-ABEND-STATUS           PIC XX     VALUE SPACES.       01210000
012200                                                                  01220000
012300 01  ABEND-CODE                    PIC S9(4)  COMP SYNC           01230000
012400                                              VALUE ZEROS.        01240000
012500     88 AP-TABLE-FULL              VALUE +4004.                   01250000
012600     88 AP-EMPTY-FILE              VALUE +4005.                   01260000
012700     88 AP-DB2-ERROR               VALUE +4013.                   01270000
012800                                                                  01280000
012900*---------------------------------------------------------------* 01290000
013000*  COMMUNICATIONS AREA2 FOR DB2                                   01300000
013100*---------------------------------------------------------------* 01310000
013200     COPY SQLCA2.                                                 01320000
013300                                                                  01330000
013400*---------------------------------------------------------------* 01340000
013500* SQL COMMUNICATIONS AREA DCLGEN                                  01350000
013600*---------------------------------------------------------------* 01360000
013700     EXEC SQL                                                     01370000
013800          INCLUDE SQLCA                                           01380000
013900     END-EXEC.                                                    01390000
014000                                                                  01400000
014100*---------------------------------------------------------------* 01410000
014200* VENDOR BUSINESS LOCATION TABLE                                  01420000
014300*---------------------------------------------------------------* 01430000
014400     EXEC SQL                                                     01440000
014500          INCLUDE TBUSLOC                                         01450000
014600     END-EXEC.                                                    01460000
014700                                                                  01470000
014800*---------------------------------------------------------------* 01480000
014900* EXTERNAL ENTERPRISE REPRESENTATIVE TABLE                        01490000
015000*---------------------------------------------------------------* 01500000
015100     EXEC SQL                                                     01510000
015200          INCLUDE TENTREP                                         01520000
015300     END-EXEC.                                                    01530000
015400                                                                  01540000
015500*---------------------------------------------------------------* 01550000
015600* EXTERNAL ENTERPRISE BUSINESS FUNCTION TABLE                     01560000
015700*---------------------------------------------------------------* 01570000
015800     EXEC SQL                                                     01580000
015900          INCLUDE TBUSFNC                                         01590000
016000     END-EXEC.                                                    01600000
016100                                                                  01610000
016200*---------------------------------------------------------------* 01620000
016300* COUNTRY TABLE                                                   01630000
016400*---------------------------------------------------------------* 01640000
016500     EXEC SQL                                                     01650000
016600          INCLUDE XFT00027                                        01660000
016700     END-EXEC.                                                    01670000
016800                                                                  01680000
016900                                                                  01690000
017000*---------------------------------------------------------------* 01700000
017100*   THIS IS THE CURSOR THAT RETRIEVES THE VENDOR ADDRESS DATA   * 01710000
017200*   NEEDED FOR THE EXTRACT FILE                                 * 01720000
017300*---------------------------------------------------------------* 01730000
017400     EXEC SQL                                                     01740000
017500        DECLARE VENDOR_ADDR_CSR CURSOR FOR                        01750000
017600          SELECT A.ENT_ID                                         01760000
017700                ,A.SEQ_NBR                                        01770000
017800                ,A.ADDRESS_LINE1_DESC                             01780000
017900                ,A.ADDRESS_LINE2_DESC                             01790000
018000                ,A.CITY_NAME                                      01800000
018100                ,A.CNTRY_CDE                                      01810000
018200                ,A.ST_PROV_CDE                                    01820000
018300                ,A.ZIP_CDE                                        01830000
018400                ,A.LAST_UPDATE_TMST                               01840000
018500                ,A.FUNCTION_ID                                    01850000
018600          FROM TBUSLOC A                                          01860000
018700          ORDER BY A.ENT_ID                                       01870000
018800                  ,A.SEQ_NBR                                      01880000
018900     END-EXEC.                                                    01890000
019000                                                                  01900000
019100*---------------------------------------------------------------* 01910000
019200*   THIS IS THE CURSOR THAT RETRIEVES THE REPRESENTATIVE DATA   * 01920000
019300*   NEEDED FOR THE EXTRACT FILE                                 * 01930000
019400*---------------------------------------------------------------* 01940000
019500     EXEC SQL                                                     01950000
019600        DECLARE VENDOR_REPR_CSR CURSOR FOR                        01960000
019700          SELECT B.ENT_ID                                         01970000
019800                ,B.ENT_BUS_LOC_ID                                 01980000
019900                ,B.SEQ_NBR                                        01990000
020000                ,B.EMAIL_ADDR_ID                                  02000000
020100                ,B.FUNCTION_ID                                    02010000
020200          FROM TENTREP B                                          02020000
020300          ORDER BY B.ENT_ID                                       02030000
020400                  ,B.ENT_BUS_LOC_ID                               02040000
020500                  ,B.SEQ_NBR                                      02050000
020600     END-EXEC.                                                    02060000
020700                                                                  02070000
020800*---------------------------------------------------------------* 02080000
020900*   THIS IS THE CURSOR THAT RETRIEVES THE REPRESENTATIVE DATA   * 02090000
021000*   NEEDED FOR THE EXTRACT FILE                                 * 02100000
021100*---------------------------------------------------------------* 02110000
021200     EXEC SQL                                                     02120000
021300        DECLARE VENDOR_FUNC_CSR CURSOR FOR                        02130000
021400          SELECT C.FUNCTION_ID                                    02140000
021500                ,C.FUNCTION_NAME                                  02150000
021600          FROM TBUSFNC C                                          02160000
021700          ORDER BY C.FUNCTION_ID                                  02170000
021800     END-EXEC.                                                    02180000
021900                                                                  02190000
022000 01  FILLER                        PIC X(25) VALUE                02200000
022100          '<====WS FOR VNKUT103 ENDS'.                            02210000
022200                                                                  02220000
022300                                                                  02230000
022400 PROCEDURE DIVISION.                                              02240000
022500                                                                  02250000
022600 A100-MAINLINE.                                                   02260000
022700                                                                  02270000
022800     PERFORM B100-INITIALIZATION.                                 02280000
022900                                                                  02290000
023000     PERFORM B200-CREATE-VENDOR-ADDR-EXT                          02300000
023100       UNTIL WS-END-OF-VENDOR-ADDR-CSR.                           02310000
023200                                                                  02320000
023300     PERFORM C100-INITIALIZATION.                                 02330000
023400                                                                  02340000
023500     PERFORM C200-CREATE-VENDOR-REPR-EXT                          02350000
023600       UNTIL WS-END-OF-VENDOR-REPR-CSR.                           02360000
023700                                                                  02370000
023800     PERFORM D100-INITIALIZATION.                                 02380000
023900                                                                  02390000
024000     PERFORM D200-CREATE-VENDOR-FUNC-EXT                          02400000
024100       UNTIL WS-END-OF-VENDOR-FUNC-CSR.                           02410000
024200                                                                  02420000
024300     PERFORM B300-END-OF-JOB.                                     02430000
024400                                                                  02440000
024500     GOBACK.                                                      02450000
024600        EJECT                                                     02460000
024700                                                                  02470000
024800*                                                                 02480000
024900***************************************************************** 02490000
025000*  INITIALIZATION AND FETCH THE FIRST ROW FROM THE                02500000
025100*  VENDOR ADDR CURSOR                                             02510000
025200***************************************************************** 02520000
025300*                                                                 02530000
025400 B100-INITIALIZATION.                                             02540000
025500                                                                  02550000
025600     DISPLAY '**********************************'                 02560000
025700     DISPLAY '*   STARTING PROGRAM VNKUT103    *'                 02570000
025800     DISPLAY '**********************************'                 02580000
025900                                                                  02590000
026000     OPEN OUTPUT VNDR-ADDR-EXTRACT-FILE.                          02600000
026100     OPEN OUTPUT VNDR-REPR-EXTRACT-FILE.                          02610000
026200     OPEN OUTPUT VNDR-FUNC-EXTRACT-FILE.                          02620000
026300                                                                  02630000
026400     INITIALIZE DCLTBUSLOC.                                       02640000
026500                                                                  02650000
026600     PERFORM Y100-OPEN-VENDOR-ADDR-CSR.                           02660000
026700                                                                  02670000
026800     PERFORM R100-FETCH-VENDOR-ADDR-CSR.                          02680000
026900                                                                  02690000
027000     IF WS-END-OF-VENDOR-ADDR-CSR                                 02700000
027100        DISPLAY '**********************************'              02710000
027200        DISPLAY '*      PROGRAM = VNKUT103        *'              02720000
027300        DISPLAY '**********************************'              02730000
027400        DISPLAY '* NO ROWS WERE SELECTED FROM     *'              02740000
027500        DISPLAY '* THE VENDOR ADDRESS CURSOR.     *'              02750000
027600        DISPLAY '**********************************'              02760000
027700     END-IF.                                                      02770000
027800                                                                  02780000
027900*                                                                 02790000
028000***************************************************************** 02800000
028100*  PROCESS VENDOR CURSOR RESULTS. MOVES RETRIEVED INFORMATION     02810000
028200*  TO THE COPY BOOK USED TO WRITE THE OUTPUT FILE.                02820000
028300***************************************************************** 02830000
028400*                                                                 02840000
028500 B200-CREATE-VENDOR-ADDR-EXT.                                     02850000
028600                                                                  02860000
028700     MOVE BUSLOC-ENT-ID             TO VN103-ENT-ID.              02870000
028800     MOVE BUSLOC-SEQ-NBR            TO VN103-VND-ADDR-ID.         02880000
028900     MOVE BUSLOC-ADDRESS-LINE1-DESC TO VN103-LNE-1-ADDR.          02890000
029000     MOVE BUSLOC-ADDRESS-LINE2-DESC TO VN103-LNE-2-ADDR.          02900000
029100     MOVE BUSLOC-CITY-NAME          TO VN103-CTY-NM.              02910000
029200     IF BUSLOC-CNTRY-CDE(3:1) NOT = SPACE                         02920000
029300        ADD 1 TO PV-COUNTRY-3-COUNT                               02930000
029400        DISPLAY '3 CHAR COUNTRY-CODE = ' BUSLOC-CNTRY-CDE         02940000
029500        PERFORM S100-CNVRT-3CHAR-CNTRY-CDE                        02950000
029600     ELSE                                                         02960000
029700        MOVE BUSLOC-CNTRY-CDE       TO VN103-CNTRY-CDE            02970000
029800     END-IF.                                                      02980000
029900     MOVE BUSLOC-ST-PROV-CDE        TO VN103-ST-PROV-CDE.         02990000
030000     MOVE BUSLOC-ZIP-CDE            TO VN103-PSTL-CDE.            03000000
030100     MOVE BUSLOC-LAST-UPDATE-TMST   TO VN103-SOR-LAST-UPD-TMST.   03010000
030200     MOVE BUSLOC-FUNCTION-ID        TO VN103-ADDR-TYP-CDE.        03020000
030300                                                                  03030000
030400     PERFORM W100-WRITE-VNDR-EXTRACT-REC.                         03040000
030500                                                                  03050000
030600     PERFORM R100-FETCH-VENDOR-ADDR-CSR.                          03060000
030700                                                                  03070000
030800*                                                                 03080000
030900***************************************************************** 03090000
031000*  END OF PROGRAM PROCESSING.                                     03100000
031100***************************************************************** 03110000
031200*                                                                 03120000
031300 B300-END-OF-JOB.                                                 03130000
031400                                                                  03140000
031500     PERFORM Y200-CLOSE-VNDR-ADDR-CSR.                            03150000
031600     PERFORM Y400-CLOSE-VNDR-REPR-CSR.                            03160000
031700     PERFORM Y600-CLOSE-VNDR-FUNC-CSR.                            03170000
031800                                                                  03180000
031900     CLOSE VNDR-ADDR-EXTRACT-FILE.                                03190000
032000     CLOSE VNDR-REPR-EXTRACT-FILE.                                03200000
032100     CLOSE VNDR-FUNC-EXTRACT-FILE.                                03210000
032200                                                                  03220000
032300     DISPLAY 'VENDOR ROWS FETCHED = ' WS-VNDR-REC-ROWS-FETCHED.   03230000
032400     DISPLAY 'VENDOR RECORDS WRITTEN = ' WS-VNDR-REC-WRITTEN.     03240000
032500     DISPLAY 'COUNT OF CNTRY-CDE W/3 CHARS: ' PV-COUNTRY-3-COUNT. 03250000
032600     DISPLAY 'VENDOR REPR ROWS FETCHED = '                        03260000
032700              WS-VNDR-REP-ROWS-FETCHED.                           03270000
032800     DISPLAY 'VENDOR REPR RECS WRITTEN = '                        03280000
032900              WS-VNDR-REP-WRITTEN.                                03290000
033000     DISPLAY 'VENDOR FUNC ROWS FETCHED = '                        03300000
033100              WS-VNDR-FNC-ROWS-FETCHED.                           03310000
033200     DISPLAY 'VENDOR FUNC RECS WRITTEN = '                        03320000
033300              WS-VNDR-FNC-WRITTEN.                                03330000
033400                                                                  03340000
033500     DISPLAY 'PROGRAM VNKUT103 ENDS NORMALLY '.                   03350000
033600                                                                  03360000
033700*                                                                 03370000
033800***************************************************************** 03380000
033900*  INITIALIZATION AND FETCH THE FIRST ROW FROM THE                03390000
034000*  VENDOR REPR CURSOR                                             03400000
034100***************************************************************** 03410000
034200*                                                                 03420000
034300 C100-INITIALIZATION.                                             03430000
034400                                                                  03440000
034500     INITIALIZE DCLTENTREP.                                       03450000
034600                                                                  03460000
034700     PERFORM Y300-OPEN-VENDOR-REPR-CSR.                           03470000
034800                                                                  03480000
034900     PERFORM R200-FETCH-VENDOR-REPR-CSR.                          03490000
035000                                                                  03500000
035100     IF WS-END-OF-VENDOR-REPR-CSR                                 03510000
035200        DISPLAY '**********************************'              03520000
035300        DISPLAY '*      PROGRAM = VNKUT103        *'              03530000
035400        DISPLAY '**********************************'              03540000
035500        DISPLAY '* NO ROWS WERE SELECTED FROM     *'              03550000
035600        DISPLAY '* THE VENDOR REPR CURSOR.        *'              03560000
035700        DISPLAY '**********************************'              03570000
035800     END-IF.                                                      03580000
035900                                                                  03590000
036000*                                                                 03600000
036100***************************************************************** 03610000
036200*  PROCESS VENDOR REPR CURSOR RESULTS.  MOVES RETRIEVED           03620000
036300*  INFORMATION TO THE COPY BOOK USED TO WRITE THE VENDOR REPR     03630000
036400*  EXTRACT OUTPUT FILE.                                           03640000
036500***************************************************************** 03650000
036600*                                                                 03660000
036700 C200-CREATE-VENDOR-REPR-EXT.                                     03670000
036800                                                                  03680000
036900     MOVE ENTREP-ENT-ID             TO VN106-ENT-ID.              03690000
037000     MOVE ENTREP-ENT-BUS-LOC-ID     TO VN106-VND-ADDR-ID.         03700000
037100     MOVE ENTREP-SEQ-NBR            TO VN106-SEQ-NBR.             03710000
037200     MOVE ENTREP-EMAIL-ADDR-ID      TO VN106-EMAIL-ADDR-ID.       03720000
037300     MOVE ENTREP-FUNCTION-ID        TO VN106-ADDR-TYP-CDE.        03730000
037400                                                                  03740000
037500     PERFORM W200-WRITE-VNDR-REPR-EXT-REC.                        03750000
037600                                                                  03760000
037700     PERFORM R200-FETCH-VENDOR-REPR-CSR.                          03770000
037800                                                                  03780000
037900*                                                                 03790000
038000***************************************************************** 03800000
038100*  INITIALIZATION AND FETCH THE FIRST ROW FROM THE                03810000
038200*  VENDOR FUNC CURSOR                                             03820000
038300***************************************************************** 03830000
038400*                                                                 03840000
038500 D100-INITIALIZATION.                                             03850000
038600                                                                  03860000
038700     INITIALIZE DCLTBUSFNC.                                       03870000
038800                                                                  03880000
038900     PERFORM Y500-OPEN-VENDOR-FUNC-CSR.                           03890000
039000                                                                  03900000
039100     PERFORM R300-FETCH-VENDOR-FUNC-CSR.                          03910000
039200                                                                  03920000
039300     IF WS-END-OF-VENDOR-FUNC-CSR                                 03930000
039400        DISPLAY '**********************************'              03940000
039500        DISPLAY '*      PROGRAM = VNKUT103        *'              03950000
039600        DISPLAY '**********************************'              03960000
039700        DISPLAY '* NO ROWS WERE SELECTED FROM     *'              03970000
039800        DISPLAY '* THE VENDOR FUNC CURSOR.        *'              03980000
039900        DISPLAY '**********************************'              03990000
040000     END-IF.                                                      04000000
040100                                                                  04010000
040200*                                                                 04020000
040300***************************************************************** 04030000
040400*  PROCESS VENDOR REPR CURSOR RESULTS.  MOVES RETRIEVED           04040000
040500*  INFORMATION TO THE COPY BOOK USED TO WRITE THE VENDOR REPR     04050000
040600*  EXTRACT OUTPUT FILE.                                           04060000
040700***************************************************************** 04070000
040800*                                                                 04080000
040900 D200-CREATE-VENDOR-FUNC-EXT.                                     04090000
041000                                                                  04100000
041100     MOVE BUSFNC-FUNCTION-ID        TO VN107-ADDR-FUNCTION-ID.    04110000
041200     MOVE BUSFNC-FUNCTION-NAME      TO VN107-ADDR-FUNCTION-NAME.  04120000
041300                                                                  04130000
041400     PERFORM W300-WRITE-VNDR-FNC-EXT-REC.                         04140000
041500                                                                  04150000
041600     PERFORM R300-FETCH-VENDOR-FUNC-CSR.                          04160000
041700                                                                  04170000
041800*                                                                 04180000
041900*                                                                 04190000
042000***************************************************************** 04200000
042100*  FETCH THE VENDOR REFERENCE INFO FROM THE VENDOR ADDRESS CURSOR.04210000
042200***************************************************************** 04220000
042300*                                                                 04230000
042400 R100-FETCH-VENDOR-ADDR-CSR.                                      04240000
042500                                                                  04250000
042600     EXEC SQL                                                     04260000
042700         FETCH VENDOR_ADDR_CSR                                    04270000
042800          INTO :BUSLOC-ENT-ID                                     04280000
042900              ,:BUSLOC-SEQ-NBR                                    04290000
043000              ,:BUSLOC-ADDRESS-LINE1-DESC                         04300000
043100              ,:BUSLOC-ADDRESS-LINE2-DESC                         04310000
043200              ,:BUSLOC-CITY-NAME                                  04320000
043300              ,:BUSLOC-CNTRY-CDE                                  04330000
043400              ,:BUSLOC-ST-PROV-CDE                                04340000
043500              ,:BUSLOC-ZIP-CDE                                    04350000
043600              ,:BUSLOC-LAST-UPDATE-TMST                           04360000
043700              ,:BUSLOC-FUNCTION-ID                                04370000
043800     END-EXEC.                                                    04380000
043900                                                                  04390000
044000     EVALUATE TRUE                                                04400000
044100         WHEN SQLCODE = ZERO                                      04410000
044200              ADD 1 TO WS-VNDR-REC-ROWS-FETCHED                   04420000
044300         WHEN SQLCODE = +100                                      04430000
044400               SET WS-END-OF-VENDOR-ADDR-CSR TO TRUE              04440000
044500         WHEN SQLWARN0 NOT = SPACES                               04450000
044600         WHEN SQLCODE  NOT = ZERO                                 04460000
044700           MOVE 'R100-FETCH-VENDOR-ADDR-CSR        '              04470000
044800                           TO WS-ABEND-PARAGRAPH                  04480000
044900           MOVE 'UNSUCCESSFUL FETCH '                             04490000
045000                           TO WS-ABEND-OPERATION                  04500000
045100           MOVE 'TBUSLOC'  TO WS-ABEND-STRUCTURE-1                04510000
045200           MOVE '       '  TO WS-ABEND-STRUCTURE-2                04520000
045300           PERFORM Z999-SQL-ERROR                                 04530000
045400     END-EVALUATE.                                                04540000
045500                                                                  04550000
045600                                                                  04560000
045700*                                                                 04570000
045800*                                                                 04580000
045900***************************************************************** 04590000
046000*  FETCH THE VENDOR REFERENCE INFO FROM THE VENDOR                04600000
046100*  REPRESENTATIVE CURSOR.                                         04610000
046200***************************************************************** 04620000
046300*                                                                 04630000
046400 R200-FETCH-VENDOR-REPR-CSR.                                      04640000
046500                                                                  04650000
046600     EXEC SQL                                                     04660000
046700         FETCH VENDOR_REPR_CSR                                    04670000
046800          INTO :ENTREP-ENT-ID                                     04680000
046900              ,:ENTREP-ENT-BUS-LOC-ID                             04690000
047000              ,:ENTREP-SEQ-NBR                                    04700000
047100              ,:ENTREP-EMAIL-ADDR-ID                              04710000
047200              ,:ENTREP-FUNCTION-ID                                04720000
047300     END-EXEC.                                                    04730000
047400                                                                  04740000
047500     EVALUATE TRUE                                                04750000
047600         WHEN SQLCODE = ZERO                                      04760000
047700              ADD 1 TO WS-VNDR-REP-ROWS-FETCHED                   04770000
047800         WHEN SQLCODE = +100                                      04780000
047900               SET WS-END-OF-VENDOR-REPR-CSR TO TRUE              04790000
048000         WHEN SQLWARN0 NOT = SPACES                               04800000
048100         WHEN SQLCODE  NOT = ZERO                                 04810000
048200           MOVE 'R200-FETCH-VENDOR-REPR-CSR        '              04820000
048300                           TO WS-ABEND-PARAGRAPH                  04830000
048400           MOVE 'UNSUCCESSFUL FETCH '                             04840000
048500                           TO WS-ABEND-OPERATION                  04850000
048600           MOVE 'TENTREP'  TO WS-ABEND-STRUCTURE-1                04860000
048700           MOVE '       '  TO WS-ABEND-STRUCTURE-2                04870000
048800           PERFORM Z999-SQL-ERROR                                 04880000
048900     END-EVALUATE.                                                04890000
049000                                                                  04900000
049100*                                                                 04910000
049200*                                                                 04920000
049300***************************************************************** 04930000
049400*  FETCH THE VENDOR REFERENCE INFO FROM THE VENDOR ADDRESS        04940000
049500*  FUNCTION CURSOR.                                               04950000
049600***************************************************************** 04960000
049700*                                                                 04970000
049800 R300-FETCH-VENDOR-FUNC-CSR.                                      04980000
049900                                                                  04990000
050000     EXEC SQL                                                     05000000
050100         FETCH VENDOR_FUNC_CSR                                    05010000
050200          INTO :BUSFNC-FUNCTION-ID                                05020000
050300              ,:BUSFNC-FUNCTION-NAME                              05030000
050400     END-EXEC.                                                    05040000
050500                                                                  05050000
050600     EVALUATE TRUE                                                05060000
050700         WHEN SQLCODE = ZERO                                      05070000
050800              ADD 1 TO WS-VNDR-FNC-ROWS-FETCHED                   05080000
050900         WHEN SQLCODE = +100                                      05090000
051000               SET WS-END-OF-VENDOR-FUNC-CSR TO TRUE              05100000
051100         WHEN SQLWARN0 NOT = SPACES                               05110000
051200         WHEN SQLCODE  NOT = ZERO                                 05120000
051300           MOVE 'R300-FETCH-VENDOR-FUNC-CSR        '              05130000
051400                           TO WS-ABEND-PARAGRAPH                  05140000
051500           MOVE 'UNSUCCESSFUL FETCH '                             05150000
051600                           TO WS-ABEND-OPERATION                  05160000
051700           MOVE 'TBUCFNC'  TO WS-ABEND-STRUCTURE-1                05170000
051800           MOVE '       '  TO WS-ABEND-STRUCTURE-2                05180000
051900           PERFORM Z999-SQL-ERROR                                 05190000
052000     END-EVALUATE.                                                05200000
052100                                                                  05210000
052200                                                                  05220000
052300*                                                                 05230000
052400***************************************************************** 05240000
052500*  CONVERT ANY 3 CHARACTER COUNTRY CODE TO THE 2 CHARACTER CODE   05250000
052600*  FOUND ON THE PEOPLESOFT COUNTRY TABLE.                         05260000
052700***************************************************************** 05270000
052800*                                                                 05280000
052900 S100-CNVRT-3CHAR-CNTRY-CDE.                                      05290000
053000                                                                  05300000
053100     MOVE BUSLOC-CNTRY-CDE TO XFT00027-CNTRY-3-CHAR-CDE.          05310000
053200                                                                  05320000
053300     EXEC SQL                                                     05330000
053400        SELECT CNTRY_CDE                                          05340000
053500         INTO :XFT00027-CNTRY-CDE                                 05350000
053600         FROM XFT_CNTRY                                           05360000
053700         WHERE CNTRY_3_CHAR_CDE = :XFT00027-CNTRY-3-CHAR-CDE      05370000
053800     END-EXEC.                                                    05380000
053900                                                                  05390000
054000     EVALUATE TRUE                                                05400000
054100         WHEN SQLCODE = ZERO                                      05410000
054200              MOVE XFT00027-CNTRY-CDE TO VN103-CNTRY-CDE          05420000
054300              DISPLAY BUSLOC-CNTRY-CDE ' CONVERTED TO '           05430000
054400                      VN103-CNTRY-CDE                             05440000
054500         WHEN SQLCODE = +100                                      05450000
054600         WHEN SQLWARN0 NOT = SPACES                               05460000
054700         WHEN SQLCODE  NOT = ZERO                                 05470000
054800           DISPLAY BUSLOC-CNTRY-CDE ' NOT FOUND!'                 05480000
054900           MOVE 'S100-CNVRT-3CHAR-CNTRY-CDE        '              05490000
055000                           TO WS-ABEND-PARAGRAPH                  05500000
055100           MOVE 'UNSUCCESSFUL SELECT'                             05510000
055200                           TO WS-ABEND-OPERATION                  05520000
055300           MOVE 'XFT00027' TO WS-ABEND-STRUCTURE-1                05530000
055400           MOVE '       '  TO WS-ABEND-STRUCTURE-2                05540000
055500           PERFORM Z999-SQL-ERROR                                 05550000
055600     END-EVALUATE.                                                05560000
055700                                                                  05570000
055800                                                                  05580000
055900*                                                                 05590000
056000***************************************************************** 05600000
056100*  WRITE RETRIEVED INFORMATION TO THE VENDOR DEPT EXTRACT RECORD  05610000
056200***************************************************************** 05620000
056300*                                                                 05630000
056400 W100-WRITE-VNDR-EXTRACT-REC.                                     05640000
056500                                                                  05650000
056600     WRITE VNDR-ADDR-EXTRACT-REC FROM VN103-VENDOR-ADDR-EXT-REC.  05660000
056700                                                                  05670000
056800     ADD 1 TO WS-VNDR-REC-WRITTEN.                                05680000
056900                                                                  05690000
057000*                                                                 05700000
057100***************************************************************** 05710000
057200*  WRITE RETRIEVED INFORMATION TO THE VENDOR REPR EXTRACT RECORD  05720000
057300***************************************************************** 05730000
057400*                                                                 05740000
057500 W200-WRITE-VNDR-REPR-EXT-REC.                                    05750000
057600                                                                  05760000
057700     WRITE VNDR-REPR-EXTRACT-REC FROM VN106-VENDOR-REPR-EXT-REC.  05770000
057800                                                                  05780000
057900     ADD 1 TO WS-VNDR-REP-WRITTEN.                                05790000
058000                                                                  05800000
058100*                                                                 05810000
058200***************************************************************** 05820000
058300*  WRITE RETRIEVED INFORMATION TO THE VENDOR ADDR FUNCTION        05830000
058400*  EXTRACT RECORD.                                                05840000
058500***************************************************************** 05850000
058600*                                                                 05860000
058700 W300-WRITE-VNDR-FNC-EXT-REC.                                     05870000
058800                                                                  05880000
058900     WRITE VNDR-FUNC-EXTRACT-REC FROM VN107-VENDOR-FUNC-EXT-REC.  05890000
059000                                                                  05900000
059100     ADD 1 TO WS-VNDR-FNC-WRITTEN.                                05910000
059200                                                                  05920000
059300*                                                                 05930000
059400***************************************************************** 05940000
059500*  OPEN VENDOR ADDRESS CURSOR.                                    05950000
059600***************************************************************** 05960000
059700*                                                                 05970000
059800 Y100-OPEN-VENDOR-ADDR-CSR.                                       05980000
059900                                                                  05990000
060000     PERFORM WITH TEST AFTER                                      06000000
060100        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      06010000
060200          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   06020000
060300             OR SQLCODE = ZERO                                    06030000
060400                                                                  06040000
060500         EXEC SQL                                                 06050000
060600            OPEN VENDOR_ADDR_CSR                                  06060000
060700         END-EXEC                                                 06070000
060800                                                                  06080000
060900         EVALUATE TRUE                                            06090000
061000             WHEN SQLCODE = ZERO                                  06100000
061100                  CONTINUE                                        06110000
061200             WHEN SQLCODE = -904                                  06120000
061300             WHEN SQLCODE = -913                                  06130000
061400                  CONTINUE                                        06140000
061500             WHEN SQLWARN0 NOT = SPACES                           06150000
061600             WHEN SQLCODE  NOT = ZERO                             06160000
061700                  MOVE 'Y100-OPEN-VENDOR-ADDR-CSR'                06170000
061800                                           TO WS-ABEND-PARAGRAPH  06180000
061900                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  06190000
062000                  MOVE 'TBUSLOC' TO WS-ABEND-STRUCTURE-1          06200000
062100                  MOVE '       ' TO WS-ABEND-STRUCTURE-2          06210000
062200                  PERFORM Z999-SQL-ERROR                          06220000
062300         END-EVALUATE                                             06230000
062400     END-PERFORM.                                                 06240000
062500                                                                  06250000
062600     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           06260000
062700         MOVE 'Y100-OPEN-VENDOR-ADDR-CSR' TO WS-ABEND-PARAGRAPH   06270000
062800         MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION06280000
062900         PERFORM Z999-SQL-ERROR.                                  06290000
063000                                                                  06300000
063100*                                                                 06310000
063200***************************************************************** 06320000
063300*  CLOSE VENDOR ADRESS CURSOR                                     06330000
063400***************************************************************** 06340000
063500*                                                                 06350000
063600 Y200-CLOSE-VNDR-ADDR-CSR.                                        06360000
063700                                                                  06370000
063800         EXEC SQL                                                 06380000
063900            CLOSE VENDOR_ADDR_CSR                                 06390000
064000         END-EXEC.                                                06400000
064100                                                                  06410000
064200         EVALUATE TRUE                                            06420000
064300             WHEN SQLCODE = ZERO                                  06430000
064400                  CONTINUE                                        06440000
064500             WHEN SQLWARN0 NOT = SPACES                           06450000
064600             WHEN SQLCODE  NOT = ZERO                             06460000
064700                  MOVE 'Y200-CLOSE-VNDR-ADDR-CSR         '        06470000
064800                                  TO WS-ABEND-PARAGRAPH           06480000
064900                  MOVE 'UNSUCCESSFUL CLOSE ' TO WS-ABEND-OPERATION06490000
065000                  MOVE 'TBUSLOC'  TO WS-ABEND-STRUCTURE-1         06500000
065100                  MOVE '       '  TO WS-ABEND-STRUCTURE-2         06510000
065200                  PERFORM Z999-SQL-ERROR                          06520000
065300         END-EVALUATE.                                            06530000
065400                                                                  06540000
065500*                                                                 06550000
065600***************************************************************** 06560000
065700*  OPEN VENDOR REPRESENTATIVE CURSOR.                             06570000
065800***************************************************************** 06580000
065900*                                                                 06590000
066000 Y300-OPEN-VENDOR-REPR-CSR.                                       06600000
066100                                                                  06610000
066200     PERFORM WITH TEST AFTER                                      06620000
066300        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      06630000
066400          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   06640000
066500             OR SQLCODE = ZERO                                    06650000
066600                                                                  06660000
066700         EXEC SQL                                                 06670000
066800            OPEN VENDOR_REPR_CSR                                  06680000
066900         END-EXEC                                                 06690000
067000                                                                  06700000
067100         EVALUATE TRUE                                            06710000
067200             WHEN SQLCODE = ZERO                                  06720000
067300                  CONTINUE                                        06730000
067400             WHEN SQLCODE = -904                                  06740000
067500             WHEN SQLCODE = -913                                  06750000
067600                  CONTINUE                                        06760000
067700             WHEN SQLWARN0 NOT = SPACES                           06770000
067800             WHEN SQLCODE  NOT = ZERO                             06780000
067900                  MOVE 'Y300-OPEN-VENDOR-REPR-CSR'                06790000
068000                                           TO WS-ABEND-PARAGRAPH  06800000
068100                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  06810000
068200                  MOVE 'TENTREP' TO WS-ABEND-STRUCTURE-1          06820000
068300                  MOVE '       ' TO WS-ABEND-STRUCTURE-2          06830000
068400                  PERFORM Z999-SQL-ERROR                          06840000
068500         END-EVALUATE                                             06850000
068600     END-PERFORM.                                                 06860000
068700                                                                  06870000
068800     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           06880000
068900         MOVE 'Y300-OPEN-VENDOR-REPR-CSR' TO WS-ABEND-PARAGRAPH   06890000
069000         MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION06900000
069100         PERFORM Z999-SQL-ERROR.                                  06910000
069200                                                                  06920000
069300*                                                                 06930000
069400***************************************************************** 06940000
069500*  CLOSE VENDOR REPRESENTATIVE CURSOR.                            06950000
069600***************************************************************** 06960000
069700*                                                                 06970000
069800 Y400-CLOSE-VNDR-REPR-CSR.                                        06980000
069900                                                                  06990000
070000         EXEC SQL                                                 07000000
070100            CLOSE VENDOR_REPR_CSR                                 07010000
070200         END-EXEC.                                                07020000
070300                                                                  07030000
070400         EVALUATE TRUE                                            07040000
070500             WHEN SQLCODE = ZERO                                  07050000
070600                  CONTINUE                                        07060000
070700             WHEN SQLWARN0 NOT = SPACES                           07070000
070800             WHEN SQLCODE  NOT = ZERO                             07080000
070900                  MOVE 'Y400-CLOSE-VNDR-REPR-CSR         '        07090000
071000                                  TO WS-ABEND-PARAGRAPH           07100000
071100                  MOVE 'UNSUCCESSFUL CLOSE ' TO WS-ABEND-OPERATION07110000
071200                  MOVE 'TENTREP'  TO WS-ABEND-STRUCTURE-1         07120000
071300                  MOVE '       '  TO WS-ABEND-STRUCTURE-2         07130000
071400                  PERFORM Z999-SQL-ERROR                          07140000
071500         END-EVALUATE.                                            07150000
071600                                                                  07160000
071700*                                                                 07170000
071800***************************************************************** 07180000
071900*  OPEN VENDOR ADDRESS FUNCTION CURSOR.                           07190000
072000***************************************************************** 07200000
072100*                                                                 07210000
072200 Y500-OPEN-VENDOR-FUNC-CSR.                                       07220000
072300                                                                  07230000
072400     PERFORM WITH TEST AFTER                                      07240000
072500        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      07250000
072600          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   07260000
072700             OR SQLCODE = ZERO                                    07270000
072800                                                                  07280000
072900         EXEC SQL                                                 07290000
073000            OPEN VENDOR_FUNC_CSR                                  07300000
073100         END-EXEC                                                 07310000
073200                                                                  07320000
073300         EVALUATE TRUE                                            07330000
073400             WHEN SQLCODE = ZERO                                  07340000
073500                  CONTINUE                                        07350000
073600             WHEN SQLCODE = -904                                  07360000
073700             WHEN SQLCODE = -913                                  07370000
073800                  CONTINUE                                        07380000
073900             WHEN SQLWARN0 NOT = SPACES                           07390000
074000             WHEN SQLCODE  NOT = ZERO                             07400000
074100                  MOVE 'Y500-OPEN-VENDOR-FUNC-CSR'                07410000
074200                                           TO WS-ABEND-PARAGRAPH  07420000
074300                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  07430000
074400                  MOVE 'TBUSFNC' TO WS-ABEND-STRUCTURE-1          07440000
074500                  MOVE '       ' TO WS-ABEND-STRUCTURE-2          07450000
074600                  PERFORM Z999-SQL-ERROR                          07460000
074700         END-EVALUATE                                             07470000
074800     END-PERFORM.                                                 07480000
074900                                                                  07490000
075000     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           07500000
075100         MOVE 'Y400-OPEN-VENDOR-FUNC-CSR' TO WS-ABEND-PARAGRAPH   07510000
075200         MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION07520000
075300         PERFORM Z999-SQL-ERROR.                                  07530000
075400                                                                  07540000
075500*                                                                 07550000
075600***************************************************************** 07560000
075700*  CLOSE VENDOR ADRESS FUNCTION CURSOR.                           07570000
075800***************************************************************** 07580000
075900*                                                                 07590000
076000 Y600-CLOSE-VNDR-FUNC-CSR.                                        07600000
076100                                                                  07610000
076200         EXEC SQL                                                 07620000
076300            CLOSE VENDOR_FUNC_CSR                                 07630000
076400         END-EXEC.                                                07640000
076500                                                                  07650000
076600         EVALUATE TRUE                                            07660000
076700             WHEN SQLCODE = ZERO                                  07670000
076800                  CONTINUE                                        07680000
076900             WHEN SQLWARN0 NOT = SPACES                           07690000
077000             WHEN SQLCODE  NOT = ZERO                             07700000
077100                  MOVE 'Y600-CLOSE-VNDR-FUNC-CSR         '        07710000
077200                                  TO WS-ABEND-PARAGRAPH           07720000
077300                  MOVE 'UNSUCCESSFUL CLOSE ' TO WS-ABEND-OPERATION07730000
077400                  MOVE 'TBUSFNC'  TO WS-ABEND-STRUCTURE-1         07740000
077500                  MOVE '       '  TO WS-ABEND-STRUCTURE-2         07750000
077600                  PERFORM Z999-SQL-ERROR                          07760000
077700         END-EVALUATE.                                            07770000
077800                                                                  07780000
077900*                                                                 07790000
078000***************************************************************** 07800000
078100*  PROCESS DB2 ABENDS.                                            07810000
078200***************************************************************** 07820000
078300*                                                                 07830000
078400 Z999-SQL-ERROR.                                                  07840000
078500                                                                  07850000
078600     DISPLAY '*** DB2 ERROR '.                                    07860000
078700     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 07870000
078800     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               07880000
078900     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               07890000
079000     DISPLAY '*** TABLE 1   = ' WS-ABEND-STRUCTURE-1.             07900000
079100     IF WS-ABEND-STRUCTURE-2 > SPACES                             07910000
079200         DISPLAY '*** TABLE 2   = ' WS-ABEND-STRUCTURE-2.         07920000
079300                                                                  07930000
079400     SET AP-DB2-ERROR              TO TRUE.                       07940000
079500                                                                  07950000
079600     COPY DPPD004.                                                07960000
079700     CALL 'ILBOABN0' USING ABEND-CODE.                            07970000
