000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    DLKUT006.                                         00020000
000300 AUTHOR.        PAUL OMAN.                                        00030000
000400                                                                  00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  FEBRUARY 2004.                                    00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 CONFIGURATION SECTION.                                           00100000
001100 SOURCE-COMPUTER. IBM-3090.                                       00110000
001200 OBJECT-COMPUTER. IBM-3090.                                       00120000
001300                                                                  00130000
001310****************************************************************  00180018
001320*  NOTE: THERE IS A BATCH VERSION OF THIS PROGRAM CALLED       *          
001330*        DLKUT027.  ANY CHANGES MADE TO THIS PROGRAM           *          
001340*        SHOULD ALSO BE MADE IN THE BATCH VERSION.             *          
001400****************************************************************  00180018
001500*    COMMAREA INCLUDE - DLWS017                                *  00190018
001600*                                                              *  00200018
001700*    CALLED ONLY WHEN SHIPPING ASSIGNMENTS ARE BEING CLOSED.   *  00210016
001800*        THIS PROGRAM WILL TAKE THE DOOR GROUP TEMPLATE ID     *  00220016
001900*        AND GENERATE A SHIPPING DOOR SUMMARY BUSINESS EVENT   *  00230016
002000*        (PCT00011 OR SUT00037) FOR EVERY DOOR WITHIN THE      *  00240016
002100*        DOOR GROUP TEMPLATE ID.                               *  00250016
002200*                                                              *  00260016
002300*    CALLED BY:                                                *  00270001
002400*        DLKUP002 - ADD OR END ASSOCIATES RELATIONSHIP TO AN   *  00280016
002500*                   ASSIGNMENT.                                *  00290016
002600*        DLKUP003 - CREATE, COPY, AND / OR END ASSIGNMENTS.    *  00300016
002700*                                                              *  00310016
002800*    CALLS:                                                    *  00320016
002900*        XLKUP033 - INSERTS BUSINESS EVENTS                    *  00330016
003000*                                                              *  00340000
003100*                                                              *  00370000
003200*  DB2 ACCESS:                                                 *  00380000
003300*    DLT_DOOR_GP_TMPL (DLT00000) TABLE (DOOR GROUP TEMPLATE)   *  00390029
003400*               SELECTS                                        *  00400000
003500*                                                              *  00410000
003600*    DLT_DOOR_GP (DLT00001) TABLE (DOOR GROUP)                 *  00420029
003700*               SELECTS                                        *  00430000
003800*                                                              *  00440000
003900*    TSUOBTS TABLE (OUTBOUND TRAILER TRIP STATUS)              *  00441029
004000*               SELECTS                                        *  00442029
004100*                                                              *  00443029
004200****************************************************************  00450000
004300                                                                  00460000
004400 DATA DIVISION.                                                   00470000
004500 WORKING-STORAGE SECTION.                                         00480000
004600                                                                  00490000
004700 01  PV-CHARACTER-FIELDS.                                         00500000
004800     05  PV-DOOR-GP-NBR           PIC S9(4)  VALUE 0 COMP.        00530031
004900     05  PV-DC-NBR                PIC S9(4)  VALUE 0 COMP.        00540011
005000                                                                  00550000
005100 01  PV-COMP-FIELDS.                                              00560000
005200     05  PV-RETRY-COUNTER         PIC S9(04) VALUE 0 COMP.        00570000
005300                                                                  00600000
005400 01  PS-SWITCHES.                                                 00610000
005500     05  PS-END-OF-DOOR-CURSOR-SW     PIC X(01)  VALUE SPACE.     00660013
005600         88  PS-END-OF-DOOR-CURSOR               VALUE 'Y'.       00670013
005700         88  PS-NOT-END-OF-DOOR-CURSOR           VALUE 'N'.       00680013
005800     05  PS-END-OF-TRIP-CURSOR-SW     PIC X(01)  VALUE SPACE.     00690022
005900         88  PS-END-OF-TRIP-CURSOR               VALUE 'Y'.       00700022
006000         88  PS-NOT-END-OF-TRIP-CURSOR           VALUE 'N'.       00710022
006100                                                                  00720000
006200 01  PC-CONSTANTS.                                                00730000
006300     05  PC-MAX-RETRIES           PIC S9(04) VALUE +3 COMP.       00740000
006400     05  PC-N                     PIC X      VALUE 'N'.           00750012
006500     05  PC-PROGRAM-NAME          PIC X(08)  VALUE 'DLKUT006'.    00760012
006600     05  PC-SHIPPING              PIC X(08)  VALUE 'SHIPPING'.    00770012
006700     05  PC-DOOR-SUMMARY          PIC X(12)  VALUE                00780012
006800         'DOOR SUMMARY'.                                          00790012
006900                                                                  00800000
007000****************************************************************  00810017
007100*    XLWS072 - XLKUP033 COMMAREA - INSERTS BUSINESS EVENTS.    *  00820017
007200*    PCWS242 - USED TO DEFINE INFORMATION FOR BUSINESS EVENT   *  00821035
007300*              DETAIL ROWS.                                    *  00830035
007400****************************************************************  00840017
007500                                                                  00850017
007600     COPY XLWS072.                                                00860000
007700                                                                  00870000
007800     COPY PCWS242.                                                00880000
007900                                                                  00890000
008000****************************************************************  00900000
008100*    DLT00000 - DOOR GROUP TEMPLATE                            *  00910016
008200*    DLT00001 - DOOR GROUP                                     *  00920016
008300*                                                              *  00930000
008400****************************************************************  00940000
008500                                                                  00950000
008600     EXEC SQL                                                     00960000
008700         INCLUDE DLT00000                                         00970000
008800     END-EXEC.                                                    00980000
008900                                                                  00990000
009000     EXEC SQL                                                     01000000
009100         INCLUDE DLT00001                                         01010000
009200     END-EXEC.                                                    01020000
009300                                                                  01030021
009400     EXEC SQL                                                     01040021
009500         INCLUDE TSUOBTS                                          01050021
009600     END-EXEC.                                                    01060021
009700                                                                  01070000
009800     EXEC SQL                                                     01080000
009900          INCLUDE SQLCA                                           01090000
010000     END-EXEC.                                                    01100000
010100                                                                  01110000
010200                                                                  01120003
010300****************************************************************  01130003
010400*    GROUP-DOORS CURSOR - SELECTS ALL DOORS FOR A SPECIFC DC   *  01140035
010500*         AND DOOR GROUP WITHIN THAT DC.                       *  01141035
010600*                                                              *  01142035
010700*    TRIP-CURSOR - SELECTS ALL TRIP ROWS FOR A SPECIFIC DC AND *  01143035
010800*         A SPECIFIC DOOR SORTED IN DESCENDING ORDER OF THE    *  01150035
010900*         STATUS DATE.                                         *  01151035
011000****************************************************************  01160003
011100                                                                  01170000
011200     EXEC SQL                                                     01180003
011300          DECLARE GROUP-DOORS CURSOR FOR                          01190003
011400           SELECT                                                 01200003
011500                  GP.DOOR_ID                                      01210003
011600             FROM DLT_DOOR_GP       GP                            01220003
011700                 ,DLT_DOOR_GP_TMPL  TMPL                          01230007
011800            WHERE GP.DOOR_GP_NBR     = :PV-DOOR-GP-NBR            01240032
011900              AND TMPL.DC_NBR        = :PV-DC-NBR                 01250010
012000              AND TMPL.ACTV_IND      = 'Y'                        01251033
012100              AND GP.DOOR_GP_TMPL_ID = TMPL.DOOR_GP_TMPL_ID       01260008
012200         ORDER BY GP.DOOR_ID                                      01270003
012300                                                                  01280003
012400     END-EXEC.                                                    01290003
012500                                                                  01300022
012600     EXEC SQL                                                     01310022
012700          DECLARE TRIP-CURSOR CURSOR FOR                          01320022
012800           SELECT                                                 01330022
012900                  OBTS.OTBND_TRIP_ID                              01340025
013000             FROM TSUOBTS           OBTS                          01370022
013100            WHERE OBTS.DOOR_ID          = :DLT00001-DOOR-ID       01380022
013200              AND OBTS.STAT_OPER_UNT_ID = :PV-DC-NBR              01390022
013300         ORDER BY OBTS.OTBND_STAT_TMST  DESC                      01400022
013400                                                                  01410022
013500     END-EXEC.                                                    01420022
013600                                                                  01430003
013700                                                                  01440003
013800 LINKAGE SECTION.                                                 01450000
013900     COPY DLWS017.                                                01460000
014000                                                                  01470000
014100                                                                  01480000
014200 PROCEDURE DIVISION USING DL017-ASGMT-COMMAREA.                   01490000
014300                                                                  01500000
014400     SET DL017-SUCCESSFUL TO TRUE.                                01510000
014500                                                                  01520000
014600     EVALUATE TRUE                                                01530000
014700         WHEN DL017-BY-DOOR-GROUP-ID                              01540001
014800              PERFORM 1000-VALIDATE-INPUT                         01550005
014900                                                                  01560000
015000         WHEN OTHER                                               01570000
015100              SET DL017-INVALID-ACCESS TO TRUE                    01580000
015200                                                                  01590000
015300     END-EVALUATE.                                                01600000
015400                                                                  01610000
015500     MOVE SQLCA                       TO DL017-SQLCA.             01620000
015600                                                                  01630000
015700     GOBACK.                                                      01640000
015800                                                                  01650000
015900****************************************************************  01660000
016000*    VALIDATE THAT ALL REQUIRED FIELDS ARE PRESENT AND THAT    *  01670016
016100*        THEY ARE VALID VALUES.                                *  01680029
016200****************************************************************  01690000
016300                                                                  01700000
016400 1000-VALIDATE-INPUT.                                             01710005
016500                                                                  01720000
016600     EVALUATE TRUE                                                01730000
016700         WHEN DL017-ASGMT-START-DTE = SPACES                      01740012
016800              SET DL017-INPUT-FIELD-01-MISSING TO TRUE            01750030
016900                                                                  01760000
017000         WHEN DL017-ASGMT-NBR-TXT = SPACES                        01770005
017100              SET DL017-INPUT-FIELD-02-MISSING TO TRUE            01780030
017200                                                                  01790005
017300         WHEN DL017-ASGMT-NBR-SEQ-NBR = 0                         01800005
017400              SET DL017-INPUT-FIELD-03-MISSING TO TRUE            01810030
017500                                                                  01820005
017600         WHEN DL017-DOOR-GP-NBR = 0                               01830031
017700              SET DL017-INPUT-FIELD-04-MISSING TO TRUE            01840030
017800                                                                  01850005
017900         WHEN DL017-DC-NBR = 0                                    01860005
018000              SET DL017-INPUT-FIELD-05-MISSING TO TRUE            01870030
018100                                                                  01910005
018200         WHEN DL017-ASGMT-STRT-TMST = SPACES                      01920005
018300              SET DL017-INPUT-FIELD-07-MISSING TO TRUE            01930030
018400                                                                  01940005
018500         WHEN DL017-ASGMT-STOP-TMST = SPACES                      01950005
018600              SET DL017-INPUT-FIELD-08-MISSING TO TRUE            01960030
018700                                                                  01970005
018800         WHEN DL017-BEGIN-DETAIL-SEQ-NBR = 0                      01980005
018900              SET DL017-INPUT-FIELD-09-MISSING TO TRUE            01990030
019000                                                                  02000005
019100         WHEN DL017-NBR-DOORS = 0                                 02010005
019200              SET DL017-INPUT-FIELD-10-MISSING TO TRUE            02020030
019300                                                                  02030005
019400         WHEN DL017-COMMIT-UPDATE OR                              02040005
019500              DL017-DO-NOT-COMMIT-UPDATE                          02050005
019600              SET DL017-COMMIT-CODE-INVALID TO TRUE               02060005
019700                                                                  02070005
019800         WHEN OTHER                                               02080000
019900              PERFORM 2000-PROCESS-DOORS                          02090005
020000                                                                  02100000
020100     END-EVALUATE.                                                02110000
020200                                                                  02120000
020300****************************************************************  02130000
020400*    FETCH EACH OF THE DOORS FOR A SPECIFIC DC AND DOOR GROUP. *  02140035
020500*        PUT OUT A DOOR SUMMARY BUSINESS EVENT FOR EACH DOOR.  *  02150035
020600*                                                              *  02160000
020700****************************************************************  02170000
020800                                                                  02180000
020900 2000-PROCESS-DOORS.                                              02190005
021000                                                                  02200000
021100     MOVE DL017-DC-NBR TO PV-DC-NBR.                              02210020
021200     MOVE DL017-DOOR-GP-NBR TO PV-DOOR-GP-NBR.                    02220031
021300                                                                  02230020
021400     PERFORM 4000-OPEN-DOOR-CURSOR.                               02240005
021500                                                                  02250005
021600     SET PS-NOT-END-OF-DOOR-CURSOR TO TRUE.                       02260005
021700     PERFORM 4200-FETCH-DOORS.                                    02270005
021800                                                                  02280000
021900     PERFORM UNTIL (PS-END-OF-DOOR-CURSOR)                        02290005
022000                                                                  02300005
022100         PERFORM 5000-CALL-XLKUP033                               02310012
022200                                                                  02320005
022300         PERFORM 4200-FETCH-DOORS                                 02330005
022400                                                                  02340005
022500     END-PERFORM.                                                 02350005
022600                                                                  02360005
022700     PERFORM 4400-CLOSE-DOOR-CURSOR.                              02370005
022800                                                                  02380000
022900                                                                  02390003
023000****************************************************************  02400003
023100*                                                              *  02410003
023200*                                                              *  02420003
023300****************************************************************  02430003
023400                                                                  02440003
023500 4000-OPEN-DOOR-CURSOR.                                           02450005
023600                                                                  02460003
023700     EXEC SQL                                                     02470003
023800          OPEN  GROUP-DOORS                                       02480005
023900     END-EXEC.                                                    02490003
024000                                                                  02500003
024100     EVALUATE SQLCODE                                             02510003
024200         WHEN 0                                                   02520003
024300              CONTINUE                                            02530003
024400                                                                  02540003
024500         WHEN +100                                                02550003
024600              SET PS-END-OF-DOOR-CURSOR TO TRUE                   02560014
024700                                                                  02570003
024800         WHEN OTHER                                               02580003
024900              SET DL017-SQL-ERROR TO TRUE                         02590005
025000              MOVE '4000-' TO DL017-SQL-ERROR-PARA                02600005
025100              MOVE SQLCA   TO DL017-SQLCA                         02610005
025200              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 02620005
025300                                                                  02630005
025400     END-EVALUATE.                                                02640003
025500                                                                  02650005
025600****************************************************************  02660005
025700*    FETCH EACH OF THE DOORS FOR THE DC AND DOOR GROUP         *  02670035
025800*                                                              *  02680005
025900****************************************************************  02690005
026000                                                                  02700005
026100 4200-FETCH-DOORS.                                                02710005
026200                                                                  02720005
026300     EXEC SQL                                                     02730005
026400          FETCH GROUP-DOORS                                       02740005
026500           INTO                                                   02750005
026600                 :DLT00001-DOOR-ID                                02760006
026700                                                                  02770005
026800     END-EXEC.                                                    02780005
026900                                                                  02790005
027000     EVALUATE SQLCODE                                             02800005
027100         WHEN 0                                                   02810005
027200              CONTINUE                                            02820005
027300                                                                  02830005
027400         WHEN +100                                                02840005
027500              SET PS-END-OF-DOOR-CURSOR TO TRUE                   02850014
027600                                                                  02860005
027700         WHEN OTHER                                               02870005
027800              SET DL017-SQL-ERROR TO TRUE                         02880005
027900              MOVE '4200-' TO DL017-SQL-ERROR-PARA                02890005
028000              MOVE SQLCA   TO DL017-SQLCA                         02900005
028100              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 02910005
028200                                                                  02920005
028300     END-EVALUATE.                                                02930005
028400                                                                  02940005
028500                                                                  02950012
028600****************************************************************  02960012
028700*                                                              *  02970012
028800*                                                              *  02980012
028900****************************************************************  02990012
029000                                                                  03000012
029100 4400-CLOSE-DOOR-CURSOR.                                          03010013
029200                                                                  03020012
029300     EXEC SQL                                                     03030012
029400          CLOSE GROUP-DOORS                                       03040012
029500     END-EXEC.                                                    03050012
029600                                                                  03060012
029700     EVALUATE SQLCODE                                             03070012
029800         WHEN 0                                                   03080012
029900              CONTINUE                                            03090012
030000                                                                  03100012
030100         WHEN OTHER                                               03110012
030200              SET DL017-SQL-ERROR TO TRUE                         03120012
030300              MOVE '4400-' TO DL017-SQL-ERROR-PARA                03130012
030400              MOVE SQLCA   TO DL017-SQLCA                         03140012
030500              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 03150012
030600                                                                  03160012
030700     END-EVALUATE.                                                03170012
030800                                                                  03180005
030900****************************************************************  03190005
031000*    CALL XLKUP033 TO INSERT THE DOOR SUMMARY BUSINESS EVENTS. *  03200035
031100*                                                              *  03210005
031200****************************************************************  03220005
031300                                                                  03230005
031400 5000-CALL-XLKUP033.                                              03240012
031500                                                                  03250005
031600     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        03260005
031700                                                                  03270005
031800     SET XL072-PC-APP-ID          TO TRUE.                        03280005
031900                                                                  03290005
032000     MOVE PC-SHIPPING             TO XL072-EVNT-OBJ-TXT.          03300005
032100     MOVE PC-DOOR-SUMMARY         TO XL072-EVNT-OBJ-ACTN-TXT.     03310005
032200     MOVE DL017-USR-ID            TO XL072-CRE-BY-USR-ID.         03320021
032300     MOVE PC-PROGRAM-NAME         TO XL072-CRE-PGM-NM.            03330012
032400                                                                  03340021
032500     SET PS-NOT-END-OF-TRIP-CURSOR TO TRUE.                       03350022
032600                                                                  03360022
032700     PERFORM 6000-OPEN-TRIP-CURSOR.                               03370022
032800                                                                  03380022
032900     PERFORM 6200-FETCH-TRIPS.                                    03390022
033000                                                                  03400022
033100     PERFORM 6400-CLOSE-TRIP-CURSOR.                              03410022
033200                                                                  03420022
033300     IF PS-END-OF-TRIP-CURSOR                                     03430027
033400        MOVE 0 TO XL072-EVNT-KY-1-NBR                             03440034
033500     ELSE                                                         03440127
033600        MOVE SUOBTS-OTBND-TRIP-ID TO XL072-EVNT-KY-1-NBR.         03441026
033700                                                                  03450021
033800     MOVE DL017-DC-NBR            TO XL072-EVNT-KY-2-NBR.         03460005
033900     MOVE DL017-DOOR-GP-NBR       TO XL072-EVNT-KY-3-NBR.         03470031
034000     MOVE DLT00001-DOOR-ID        TO XL072-EVNT-KY-1-TXT.         03480012
034100     MOVE DL017-ASGMT-STRT-TMST   TO XL072-EVNT-KY-1-TMST.        03490005
034200     MOVE DL017-ASGMT-STOP-TMST   TO XL072-EVNT-KY-2-TMST.        03500005
034201                                                                  03510005
034202****************************************************************  03220005
034203*    FOLLOWING CHANGE TO MAKE THE LAST 6 SIX POSITIONS OF THE  *  03210005
034204*    EVENT KEY 2 TIMESTAMP WAS REQUESTED BY BUDDY BARNES SO    *  03210005
034205*    THAT THE DATA WOULDN'T BE COUNTED TWICE IN RED PRAIRIE.   *  03210005
034206*                                                              *  03210005
034207****************************************************************  03220005
034210     MOVE '000000' TO XL072-EVNT-KY-2-TMST (21:6).                        
034400                                                                  03520005
034500     SET XL072-DO-NOT-COMMIT-UPDATE TO TRUE.                      03530005
034600     MOVE PC-PROGRAM-NAME         TO XL072-ORIG-CALLING-PGM-NM.   03540013
034700                                                                  03550005
034800     SET XL072-PCWS242-COPYBOOK TO TRUE.                          03560005
034900                                                                  03570005
035000     INITIALIZE PC242-DTL-TXT-AREA.                               03580005
035100     SET  PC242-SUMMARIZE-SHIP-DOOR TO TRUE.                      03590005
035200     MOVE DL017-ASGMT-START-DTE   TO PC242-AE-ASGMT-STRT-DTE.     03600012
035300     MOVE DL017-ASGMT-NBR-TXT     TO PC242-AE-ASGMT-NBR-TXT.      03610005
035400     MOVE DL017-ASGMT-NBR-SEQ-NBR TO PC242-AE-ASGMT-NBR-SEQ-NBR.  03620005
035500     MOVE DL017-BEGIN-DETAIL-SEQ-NBR TO                           03630005
035600                                 PC242-AE-ASGMT-SEQ-DTL-NBR.      03640005
035700     ADD  1 TO DL017-BEGIN-DETAIL-SEQ-NBR.                        03641026
035800                                                                  03650005
035900     MOVE PC242-DTL-TXT-AREA      TO XL072-DTL-TXT.               03660005
036000                                                                  03670005
036100     CALL XL072-USER-PGM USING DFHEIBLK                           03680005
036200                               XL072-COMMAREA                     03690005
036300                               XL072-EAI-EXPORT-COMMAREA.         03700005
036400                                                                  03710005
036500     IF XL072-SUCCESSFUL                                          03720005
036600        CONTINUE                                                  03730005
036700     ELSE                                                         03740005
036800        SET  DL017-CALLED-MODULE-FAILURE TO TRUE                  03750013
036900        MOVE XL072-USER-PGM        TO DL017-CALL-MOD-FAIL-NM      03760013
037000        MOVE XL072-RETURN-CODE     TO DL017-CALL-MOD-FAIL-ERR-CDE 03770013
037100        MOVE XL072-RETURN-SQLCODES TO DL017-RETURN-SQLCODES       03780013
037200     END-IF.                                                      03790005
037300                                                                  03800022
037400****************************************************************  03810022
037500*                                                              *  03820022
037600*                                                              *  03830022
037700****************************************************************  03840022
037800                                                                  03850022
037900 6000-OPEN-TRIP-CURSOR.                                           03860022
038000                                                                  03870022
038100     EXEC SQL                                                     03880022
038200          OPEN  TRIP-CURSOR                                       03890022
038300     END-EXEC.                                                    03900022
038400                                                                  03910022
038500     EVALUATE SQLCODE                                             03920022
038600         WHEN 0                                                   03930022
038700              CONTINUE                                            03940022
038800                                                                  03950022
038900         WHEN +100                                                03960022
039000              SET PS-END-OF-TRIP-CURSOR TO TRUE                   03970022
039100                                                                  03980022
039200         WHEN OTHER                                               03990022
039300              SET DL017-SQL-ERROR TO TRUE                         04000022
039400              MOVE '6000-' TO DL017-SQL-ERROR-PARA                04010022
039500              MOVE SQLCA   TO DL017-SQLCA                         04020022
039600              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 04030022
039700                                                                  04040022
039800     END-EVALUATE.                                                04050022
039900                                                                  04060022
040000****************************************************************  04070022
040100*    FETCHES THE LATEST TRIP INFORMATION FOR A SPECIFIC DOOR   *  04080035
040200*    AND DC.                                                   *  04090035
040300****************************************************************  04100022
040400                                                                  04110022
040500 6200-FETCH-TRIPS.                                                04120022
040600                                                                  04130022
040700     EXEC SQL                                                     04140022
040800          FETCH TRIP-CURSOR                                       04150022
040900           INTO                                                   04160022
041000                 :SUOBTS-OTBND-TRIP-ID                            04170024
041100                                                                  04180022
041200     END-EXEC.                                                    04190022
041300                                                                  04200022
041400     EVALUATE SQLCODE                                             04210022
041500         WHEN 0                                                   04220022
041600              CONTINUE                                            04230022
041700                                                                  04240022
041800         WHEN +100                                                04250022
041900              SET PS-END-OF-TRIP-CURSOR TO TRUE                   04260022
042000                                                                  04270022
042100         WHEN OTHER                                               04280022
042200              SET DL017-SQL-ERROR TO TRUE                         04290022
042300              MOVE '6200-' TO DL017-SQL-ERROR-PARA                04300022
042400              MOVE SQLCA   TO DL017-SQLCA                         04310022
042500              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 04320022
042600                                                                  04330022
042700     END-EVALUATE.                                                04340022
042800                                                                  04350022
042900                                                                  04360022
043000****************************************************************  04370022
043100*                                                              *  04380022
043200*                                                              *  04390022
043300****************************************************************  04400022
043400                                                                  04410022
043500 6400-CLOSE-TRIP-CURSOR.                                          04420022
043600                                                                  04430022
043700     EXEC SQL                                                     04440022
043800          CLOSE TRIP-CURSOR                                       04450022
043900     END-EXEC.                                                    04460022
044000                                                                  04470022
044100     EVALUATE SQLCODE                                             04480022
044200         WHEN 0                                                   04490022
044300              CONTINUE                                            04500022
044400                                                                  04510022
044500         WHEN OTHER                                               04520022
044600              SET DL017-SQL-ERROR TO TRUE                         04530022
044700              MOVE '6400-' TO DL017-SQL-ERROR-PARA                04540022
044800              MOVE SQLCA   TO DL017-SQLCA                         04550022
044900              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 04560022
045000                                                                  04570022
045100     END-EVALUATE.                                                04580022
045200                                                                  04590012
045300****************************************************************  04600012
045400*                                                              *  04610012
045500*                                                              *  04620012
045600****************************************************************  04630012
045700                                                                  04640012
045800 8000-SYNCPOINT.                                                  04650012
045900                                                                  04660012
046000     EXEC CICS                                                    04670012
046100          SYNCPOINT                                               04680012
046200     END-EXEC.                                                    04690012
046300                                                                  04700012
