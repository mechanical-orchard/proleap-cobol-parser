000100 IDENTIFICATION DIVISION.                                         00010009
000200 PROGRAM-ID.      XSKRP011.                                       00020009
000300 AUTHOR.          DOUG JONES / NANCY MARTIN                       00030009
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040009
000500 DATE-WRITTEN.    05/06/2003.                                     00050009
000600 DATE-COMPILED.                                                   00060009
000700******************************************************************00070009
000800**XS DOMAIN TABLE INTEGRITY CHECK - FOR TABLE XST_SKU_LOC         00080009
000900******************************************************************00090009
001000**THIS PROGRAM VALIDATES THE DATA IN THE XS DOMAIN IS THE SAME    00100009
001100**AS THE DATA IN THE SOR                                          00110009
001150**   THIS PROGRAM WAS CLONED FROM XSKRP009/XSKRP013               00120009
001160**   CREATED FOR NEW PROMO SYSTEM WORK WR21428                    00121009
C33751*----------------------------------------------------------       00121312
C33751* DATE:         10/05/2012                                        00121412
C33751* WR/IR#:       CRQ000000033751                                   00121512
C33751* PROGRAMMER:   COGNIZANT                                         00121612
C33751* DESCRIPTION:  REMOVE THE COMPARISON OF ORIG_CLR_DTE FROM        00121712
C33751* INTEGRITY LOGIC                                                 00121812
001200******************************************************************00122109
001300 ENVIRONMENT DIVISION.                                            00123009
001400 CONFIGURATION SECTION.                                           00124009
001500 SOURCE-COMPUTER.        IBM-3090.                                00125009
001600 OBJECT-COMPUTER.        IBM-3090.                                00126009
001700 INPUT-OUTPUT SECTION.                                            00127009
001800 FILE-CONTROL.                                                    00128009
001900                                                                  00129009
002000     SELECT SKIP-RECD-CNTL-FILE                                   00130009
002100            ASSIGN TO INP01.                                      00140009
002400     SELECT SOR-SKU-LOC-EXTRACT-FILE                              00150009
002500            ASSIGN TO INP02.                                      00160009
002600     SELECT XS-SKU-LOC-EXTRACT-FILE                               00170009
002700            ASSIGN TO INP03.                                      00180009
002800     SELECT XS-SKU-LOC-INTEG-RPT-FILE                             00190009
002900            ASSIGN TO RPT01.                                      00200009
003000                                                                  00210009
003100 DATA DIVISION.                                                   00220009
003200 FILE SECTION.                                                    00230009
003300                                                                  00240009
003400 FD  SKIP-RECD-CNTL-FILE                                          00250009
003500     RECORDING MODE F                                             00260009
003600     BLOCK CONTAINS 0 RECORDS                                     00270009
003700     LABEL RECORDS ARE OMITTED                                    00280009
003800     DATA RECORD IS SKIP-RECD-CNTL-RECORD.                        00290009
003900 01  SKIP-RECD-CNTL-RECORD            PIC X(080).                 00300009
004700                                                                  00310009
004800 FD  SOR-SKU-LOC-EXTRACT-FILE                                     00320009
004900     RECORDING MODE F                                             00330009
005000     BLOCK CONTAINS 0 RECORDS                                     00340009
005100     LABEL RECORDS ARE OMITTED                                    00350009
005200     DATA RECORD IS SOR-SKU-LOC-EXTRACT-RECORD.                   00360009
005300 01  SOR-SKU-LOC-EXTRACT-RECORD      PIC X(173).                  00370010
005400                                                                  00380009
005500 FD  XS-SKU-LOC-EXTRACT-FILE                                      00390009
005600     RECORDING MODE F                                             00400009
005700     BLOCK CONTAINS 0 RECORDS                                     00410009
005800     LABEL RECORDS ARE OMITTED                                    00420009
005900     DATA RECORD IS XS-SKU-LOC-EXTRACT-RECORD.                    00430009
006000 01  XS-SKU-LOC-EXTRACT-RECORD       PIC X(119).                  00440009
006100                                                                  00450009
006200 FD  XS-SKU-LOC-INTEG-RPT-FILE                                    00460009
006300     RECORDING MODE IS F                                          00470009
006400     BLOCK CONTAINS 0  RECORDS.                                   00480009
006500 01  XS-SKU-LOC-INTEG-RPT-RECORD     PIC  X(200).                 00490009
006600                                                                  00500009
006700 WORKING-STORAGE SECTION.                                         00510009
006800                                                                  00520009
006900 01  FILLER                              PIC X(41)                00530009
007000     VALUE 'WORKING STORAGE STARTS HERE FOR XSKRP011'.            00540009
007100                                                                  00550009
007200 01  PS-PROGRAM-SWITCHES.                                         00560009
007300     05  PS-END-SKIP-RECD-FILE-SW        PIC X(01) VALUE 'N'.     00570009
007400         88  PS-END-SKIP-RECD-FILE                 VALUE 'Y'.     00580009
007500         88  PS-NOT-END-SKIP-RECD-FILE             VALUE 'N'.     00590009
007900     05  PS-END-OF-SOR-SKU-LOC-SW        PIC X(01) VALUE 'N'.     00600009
008000         88  PS-END-OF-SOR-SKU-LOC                 VALUE 'Y'.     00610009
008100         88  PS-NOT-END-OF-SOR-SKU-LOC             VALUE 'N'.     00620009
008200     05  PS-END-OF-XS-SKU-LOC-SW         PIC X(01) VALUE 'N'.     00630009
008300         88  PS-END-OF-XS-SKU-LOC                  VALUE 'Y'.     00640009
008400         88  PS-NOT-END-OF-XS-SKU-LOC              VALUE 'N'.     00650009
008500     05  PS-VENDOR-DESCRIPTION-ERROR-SW  PIC X(01) VALUE 'N'.     00660009
008600         88  PS-LOC-STR-NBR-ERROR                  VALUE 'Y'.     00670009
008700         88  PS-NO-LOC-STR-NBR-ERROR               VALUE 'N'.     00680009
008800     05  PS-INTR-UPC-ID-ERROR-SW         PIC X(01) VALUE 'N'.     00690009
008900         88  PS-INTR-UPC-ID-ERROR                  VALUE 'Y'.     00700009
009000         88  PS-NO-INTR-UPC-ID-ERROR               VALUE 'N'.     00710009
009100     05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00720009
009200         88  PS-ERROR-FOUND                        VALUE 'Y'.     00730009
009300         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00740009
009400                                                                  00750009
010500 01  PC-PROGRAM-CONSTANTS.                                        00760009
010600     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)  VALUE         00770009
010700                                                    'XSKRP011'.   00780009
010800     05  PC-REPORT-NBR-1                 PIC  9(01) VALUE 1.      00790009
010900     05  PC-ONE                          PIC  9(01) VALUE 1.      00800009
011200     05  PC-MAX-REPORT-LINES             PIC S9(05) VALUE +74     00810009
011300                                                    COMP-3.       00820009
011400                                                                  00830009
011500     05  PC-NO-ERROR-MESSAGE             PIC  X(200) VALUE        00840009
011600         'NO ERRORS'.                                             00850009
011900                                                                  00860009
012000     05  PC-MISMATCHED-INTR-UPC-ID       PIC  X(35) VALUE         00870009
012100         'INTR UPC ID NUMBERS NOT IN SYNCH   '.                   00880009
012200                                                                  00890009
012300     05  PC-MISMATCHED-STR-LOC-NBRS      PIC  X(50) VALUE         00900009
012400         'INTR UPC ID MATCH BUT LOCATION NOT ON BOTH FILES  '.    00910009
012500                                                                  00920009
012300     05  PC-MISMATCHED-BEG-DATE          PIC  X(50) VALUE         00930009
012400         'INTR UPC ID & LOC MATCH BUT DATE DIFFERENCE       '.    00940009
012500                                                                  00950009
012600     05  PC-MISSING-FROM-SOR-SKU-LOC     PIC  X(50) VALUE         00960009
012700         'MATCHING DATA NOT FOUND ON SOR SKU LOC EXTRACT    '.    00970009
012800                                                                  00980009
012900     05  PC-MISSING-FROM-XS-SKU-LOC      PIC  X(50) VALUE         00990009
013000         'MATCHING DATA NOT FOUND ON XS SKU LOC EXTRACT     '.    01000009
013100                                                                  01010009
012600     05  PC-EXTRA-FOUND-SOR-SKU-LOC      PIC  X(50) VALUE         01020009
012700         'ADDITIONAL DATA FOUND FOR SOR SKU LOC EXTRACT     '.    01030009
012800                                                                  01040009
012900     05  PC-EXTRA-FOUND-XS-SKU-LOC       PIC  X(50) VALUE         01050009
013000         'ADDITIONAL DATA FOUND ON XS SKU LOC EXTRACT       '.    01060009
013100                                                                  01070009
013200 01  PV-MISCELANEOUS.                                             01080009
NEMCHG     05  PV-TEMP-INTR-UPC-ID             PIC S9(11) COMP          01090009
NEMCHG                                                    VALUE ZEROS.  01100009
013400     05  PV-PRINT-RECORD                 PIC X(200) VALUE SPACE.  01110009
013500     05  PV-LINE-SPACING                 PIC S9(04) VALUE ZEROES  01120009
013600                                                    COMP SYNC.    01130009
013700     05  PV-CURR-TIME.                                            01140009
013800        10  PV-CURR-TIME-HH              PIC  9(02) VALUE ZEROES. 01150009
013900        10  PV-CURR-TIME-MM              PIC  9(02) VALUE ZEROES. 01160009
014000        10  PV-CURR-TIME-SSHH            PIC  9(04) VALUE ZEROES. 01170009
014100                                                                  01180009
014200     05  PV-CURR-DATE-CCYYMMDD.                                   01190009
014300         10  PV-CURR-DATE-CCYY           PIC  9(04) VALUE ZEROES. 01200009
014400         10  PV-CURR-DATE-MM             PIC  9(02) VALUE ZEROES. 01210009
014500         10  PV-CURR-DATE-DD             PIC  9(02) VALUE ZEROES. 01220009
014600                                                                  01230009
014700 01  PV-PROGRAM-COUNTER.                                          01240009
014800     05  PV-PAGE-CNT                     PIC  9(05) VALUE ZEROS.  01250009
014900     05  PV-LINE-CNT                     PIC S9(07) VALUE ZEROS.  01260009
015000     05  PV-SOR-SKU-LOC-RECS-READ-CNT    PIC  9(09) VALUE ZEROS.  01270009
015100     05  PV-SOR-READ-SKIP-CNT            PIC  9(09) VALUE ZEROS.  01280009
015200     05  PV-XS-EXTRACT-REC-READ-CNT      PIC  9(09) VALUE ZEROS.  01290009
015300     05  PV-ERROR-RECORD-WRITTEN-CNT     PIC  9(09) VALUE ZEROS.  01300009
015400     05  PV-VALID-MATCH-CNT              PIC  9(09) VALUE ZEROS.  01310009
015500                                                                  01320009
015600 01  PV-MISC-ABEND-FIELDS.                                        01330009
015700     05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  01340009
015800     05  PV-OPERATION-MSG-1              PIC  X(40) VALUE SPACE.  01350009
015900     05  PV-OPERATION-MSG-2              PIC  X(40) VALUE SPACE.  01360009
016100                                                                  01370009
016200 01  PV-ABEND-CODE   COMP  SYNC          PIC S9(04) VALUE +0000.  01380009
016300     88  PV-ABEND-4008-DATA-ERROR                   VALUE +4008.  01390009
016400     88  PV-ABEND-4009-CARD-ERROR                   VALUE +4009.  01400009
016700                                                                  01410009
016800******************************************************************01420009
016900*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  01430009
017000******************************************************************01440009
017100     COPY DPWS200.                                                01450009
017200                                                                  01460009
017300 01  HL2-HEADING-LINE-2.                                          01470009
017400     05  FILLER                  PIC X(84)   VALUE SPACES.        01480009
017500     05  FILLER                  PIC X(33)   VALUE                01490009
017600         'XS SKU LOC  DATA INTEGRITY ERRORS'.                     01500009
017700     05  FILLER                  PIC X(83)   VALUE SPACES.        01510009
017800                                                                  01520009
017900 01  HL3-HEADING-LINE-3.                                          01530009
018000     05  FILLER                  PIC X(02)   VALUE SPACES.        01540009
018400     05  FILLER                  PIC X(15)   VALUE                01550009
018500         '----SOR KEY----'.                                       01560009
018600     05  FILLER                  PIC X(02)   VALUE SPACES.        01570009
018700     05  FILLER                  PIC X(15)   VALUE                01580009
018800         '-----XS KEY----'.                                       01590009
018900     05  FILLER                  PIC X(02)   VALUE SPACES.        01600009
019000     05  FILLER                  PIC X(38)   VALUE                01610009
019100         '--KEY DT--***-UNIT RTL-****-UNT COST-*'.                01620009
019000     05  FILLER                  PIC X(39)   VALUE                01630009
019100         'STAT*-STAT DTE-**-RTL DATE-**--GRP ID--'.               01640009
019200     05  FILLER                  PIC X(24)   VALUE                01650009
019300         '*--GRP QTY-*-GRP AMT-*M*'.                              01660009
019000     05  FILLER                  PIC X(36)   VALUE                01670009
019100         '  ----------------- ERROR MESSAGE(S)'.                  01680009
019200     05  FILLER                  PIC X(22)   VALUE                01690009
019300         ' ---------------------'.                                01700009
019500                                                                  01710009
019600******************************************************************01720009
019700*  DETAIL LINE LAYOUT FOR THE ERROR REPORT.                       01730009
019800******************************************************************01740009
019900 01  DL1-DETAIL-LINE-1.                                           01750009
020000     05  FILLER                  PIC X(01)     VALUE SPACES.      01760009
020100     05  DL1-SOR-INTR-UPC-ID     PIC Z(10)-    VALUE ZEROES.      01770009
020200***  05  FILLER                  PIC X(01)     VALUE SPACES.      01780009
020300     05  DL1-SOR-STR-NBR         PIC X(05)     VALUE ZEROES.      01790009
020400     05  FILLER                  PIC X(01)     VALUE SPACES.      01800009
020500     05  DL1-XS-INTR-UPC-ID      PIC Z(10)-    VALUE ZEROES.      01810009
020600***  05  FILLER                  PIC X(01)     VALUE SPACES.      01820009
020700     05  DL1-XS-LOC-NBR          PIC X(05)     VALUE ZEROES.      01830009
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      01840009
020300     05  DL1-BEG-DT              PIC X(10)     VALUE SPACES.      01850009
021200     05  FILLER                  PIC X(93)     VALUE SPACES.      01860009
021100     05  DL1-ERROR-MESSAGE       PIC X(52)     VALUE SPACES.      01870009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      01880009
021300                                                                  01890009
019900 01  DLS-DETAIL-LINE-1-SOR.                                       01900009
020000     05  FILLER                  PIC X(01)     VALUE SPACES.      01910009
020100     05  DLS-SOR-INTR-UPC-ID     PIC Z(10)-    VALUE ZEROES.      01920009
020200***  05  FILLER                  PIC X(01)     VALUE SPACES.      01930009
020300     05  DLS-SOR-STR-NBR         PIC X(05)     VALUE ZEROES.      01940009
020600     05  FILLER                  PIC X(19)     VALUE SPACES.      01950009
020300     05  DLS-SOR-BEG-DT          PIC X(10)     VALUE SPACES.      01960009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      01970009
020300     05  DLS-SOR-UNT-RTL         PIC -Z(7).99  VALUE ZEROES.      01980009
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      01990009
020300     05  DLS-SOR-UNT-COST        PIC -Z(7).999 VALUE ZEROES.      02000009
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      02010009
020300     05  DLS-SOR-SKU-STAT        PIC XX        VALUE SPACES.      02020009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02030009
020300     05  DLS-SOR-SKU-STAT-DT     PIC X(10)     VALUE SPACES.      02040009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02050009
020300     05  DLS-SOR-UNT-RTL-DT      PIC X(10)     VALUE SPACES.      02060009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02070009
020300     05  DLS-SOR-GP-PRIC-ID      PIC -Z(08)9   VALUE ZEROES.      02080009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02090009
020300     05  DLS-SOR-GP-RTL-QTY      PIC -ZZZ9     VALUE ZEROES.      02100009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02110009
020300     05  DLS-SOR-GP-RTL-AMT      PIC -Z(7).99  VALUE ZEROES.      02120009
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02130009
021200     05  DLS-SOR-MKDN-CDE        PIC X(01)     VALUE SPACES.      02140009
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02140109
021200     05  FILLER                  PIC X(03)     VALUE SPACES.      02140209
021100     05  FILLER                  PIC X(09)     VALUE 'MISMATCH'.  02140309
021100     05  DLS-ERR-BEG-DT          PIC X(10)     VALUE SPACES.      02140409
021100     05  DLS-ERR-UNT-RTL         PIC X(10)     VALUE SPACES.      02140509
021100     05  DLS-ERR-UNT-COST        PIC X(10)     VALUE SPACES.      02140609
021100     05  DLS-ERR-UNT-RTL-DT      PIC X(10)     VALUE SPACES.      02140709
021100     05  DLS-ERR-MKDN-CDE        PIC X(08)     VALUE SPACES.      02140809
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02140909
021300                                                                  02141009
019900 01  DLX-DETAIL-LINE-1-XS.                                        02142009
020200     05  FILLER                  PIC X(18)     VALUE SPACES.      02143009
020500     05  DLX-XS-INTR-UPC-ID      PIC Z(10)-    VALUE ZEROES.      02144009
020600***  05  FILLER                  PIC X(01)     VALUE SPACES.      02145009
020700     05  DLX-XS-LOC-NBR          PIC X(05)     VALUE ZEROES.      02146009
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      02147009
020300     05  DLX-XS-BEG-DT           PIC X(10)     VALUE SPACES.      02148009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02149009
020300     05  DLX-XS-UNT-RTL          PIC -Z(7).99  VALUE ZEROES.      02150009
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      02160009
020300     05  DLX-XS-UNT-COST         PIC -Z(7).999 VALUE ZEROES.      02170009
021000     05  FILLER                  PIC X(02)     VALUE SPACES.      02180009
020300     05  DLX-XS-SKU-STAT         PIC XX        VALUE SPACES.      02190009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02200009
020300     05  DLX-XS-SKU-STAT-DT      PIC X(10)     VALUE SPACES.      02210009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02220009
020300     05  DLX-XS-UNT-RTL-DT       PIC X(10)     VALUE SPACES.      02230009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02240009
020300     05  DLX-XS-GP-PRIC-ID       PIC -Z(08)9   VALUE ZEROES.      02250009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02260009
020300     05  DLX-XS-GP-RTL-QTY       PIC -ZZZ9     VALUE ZEROES.      02270009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02280009
020300     05  DLX-XS-GP-RTL-AMT       PIC -Z(7).99  VALUE ZEROES.      02290009
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02300009
021200     05  DLX-XS-MKDN-CDE         PIC X(01)     VALUE SPACES.      02310009
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02320009
021200     05  FILLER                  PIC X(02)     VALUE SPACES.      02330009
021100     05  DLX-ERR-SKU-STAT        PIC X(10)     VALUE SPACES.      02340009
021100     05  DLX-ERR-SKU-STAT-DT     PIC X(10)     VALUE SPACES.      02350009
021100     05  DLX-ERR-GP-PRIC-ID      PIC X(10)     VALUE SPACES.      02360009
021100     05  DLX-ERR-GP-RTL-QTY      PIC X(10)     VALUE SPACES.      02370009
021100     05  DLX-ERR-GP-RTL-AMT      PIC X(09)     VALUE SPACES.      02380009
C33751*    05  DLX-ERR-ORIG-CLR-DTE    PIC X(08)     VALUE SPACES.      02390012
021200     05  FILLER                  PIC X(01)     VALUE SPACES.      02400009
021300                                                                  02410009
021400******************************************************************02420009
021500*  TRAILER LAYOUT FOR THE ERROR REPORT.                           02430009
021600******************************************************************02440009
021700 01  TR1-TRAILER-LINE-1.                                          02450009
021800     05  FILLER                  PIC X(25)   VALUE                02460009
021900         ' TOTAL NUMBER OF ERRORS: '.                             02470009
022000     05  TR1-TOTAL-ERROR-CNT     PIC Z(09)   VALUE ZEROS.         02480009
022100     05  FILLER                  PIC X(166)  VALUE SPACES.        02490009
022200                                                                  02500009
022300******************************************************************02510009
022400**COPYBOOKS                                                       02520009
022500******************************************************************02530009
022600                                                                  02540009
022700***VSM EXTRACT FILE LAYOUT                                        02550009
022800     COPY IMRD057.                                                02560009
022900                                                                  02570009
023000***XS EXTRACT FILE LAYOUT                                         02580009
023100     COPY XSRD028.                                                02590009
023200                                                                  02600009
023210***XS DOMAIN INTEGRITY CONTROL CARD                               02610009
023220     COPY XSRD046.                                                02620009
023230                                                                  02630009
023300***************************************************************** 02640009
023400 PROCEDURE DIVISION.                                              02650009
023500***************************************************************** 02660009
023600 0000-MAINLINE.                                                   02670009
023700                                                                  02680009
023800     PERFORM 1000-INITIALIZATION.                                 02690009
023900                                                                  02700009
024000     PERFORM 2000-PROCESS-RECORDS                                 02710009
024100       UNTIL PS-END-OF-SOR-SKU-LOC                                02720009
024200          OR PS-END-OF-XS-SKU-LOC.                                02730009
024300                                                                  02740009
024400     PERFORM 2200-PROCESS-EXTRA-RECORDS                           02750009
024500       UNTIL PS-END-OF-SOR-SKU-LOC                                02760009
024600         AND PS-END-OF-XS-SKU-LOC.                                02770009
024700                                                                  02780009
024710     IF PV-ERROR-RECORD-WRITTEN-CNT = 0                           02790009
024720         MOVE PC-NO-ERROR-MESSAGE TO DL1-DETAIL-LINE-1            02800009
024730         MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD              02810009
024740         PERFORM 8900-WRITE-REPORT-LINE                           02820009
024750     ELSE                                                         02830009
024760         MOVE PV-ERROR-RECORD-WRITTEN-CNT TO                      02840009
024770                TR1-TOTAL-ERROR-CNT                               02850009
024780         MOVE TR1-TRAILER-LINE-1  TO PV-PRINT-RECORD              02860009
024790         PERFORM 8900-WRITE-REPORT-LINE                           02870009
024791     END-IF.                                                      02880009
024792                                                                  02890009
024800     PERFORM 9000-END-OF-PGM.                                     02900009
024900                                                                  02910009
025000     GOBACK.                                                      02920009
025100                                                                  02930009
025200******************************************************************02940009
025300*1000-INITIALIZATION.                                             02950009
025400* INITIALIZATION AREA                                             02960009
025500******************************************************************02970009
025600 1000-INITIALIZATION.                                             02980009
025700                                                                  02990009
025800     INITIALIZE PV-PROGRAM-COUNTER.                               03000009
025900                                                                  03010009
026000     OPEN INPUT  SKIP-RECD-CNTL-FILE                              03020009
026200                 SOR-SKU-LOC-EXTRACT-FILE                         03030009
026300                 XS-SKU-LOC-EXTRACT-FILE.                         03040009
026400                                                                  03050009
026500     OPEN OUTPUT XS-SKU-LOC-INTEG-RPT-FILE.                       03060009
026600                                                                  03070009
026700     READ SKIP-RECD-CNTL-FILE INTO XS046-CONTROL-CARD             03080009
026800        AT END                                                    03090009
026900           SET PS-END-SKIP-RECD-FILE TO TRUE.                     03100009
027000                                                                  03110009
027100     IF PS-END-SKIP-RECD-FILE                                     03120009
027200         MOVE '1000-INITIALIZE' TO PV-PARAGRAPH-NAME              03130009
027300         MOVE 'NO SKIP RECD CNTL FILE DATA' TO PV-OPERATION-MSG-1 03140009
027400         SET PV-ABEND-4009-CARD-ERROR TO TRUE                     03150009
027500         PERFORM 9999-ABEND                                       03160009
027600     END-IF.                                                      03170009
027700                                                                  03180009
027800     CLOSE SKIP-RECD-CNTL-FILE.                                   03190009
029200                                                                  03200009
029300     PERFORM 7000-READ-SOR-SKU-LOC-EXTRACT                        03210009
029400       UNTIL PV-SOR-READ-SKIP-CNT = XS046-START-POINT             03220009
029500          OR PS-END-OF-SOR-SKU-LOC.                               03230009
029600                                                                  03240009
029700     IF PS-END-OF-SOR-SKU-LOC                                     03250009
029800         MOVE '1000-INITIALIZE' TO PV-PARAGRAPH-NAME              03260009
029900         MOVE 'END OF SOR SKU LOC FILE ON PRIMING READ'           03270009
029950           TO PV-OPERATION-MSG-1                                  03280009
030000         SET PV-ABEND-4008-DATA-ERROR TO TRUE                     03290009
030100         PERFORM 9999-ABEND                                       03300009
030200     END-IF.                                                      03310009
030300                                                                  03320009
030400     IF XS046-READ-FREQUENCY = PC-ONE                             03330009
030500        PERFORM 7100-READ-XS-SKU-LOC-EXTRACT                      03340009
030550          XS046-START-POINT TIMES                                 03350009
030600     ELSE                                                         03360009
030700        PERFORM 7100-READ-XS-SKU-LOC-EXTRACT                      03370009
030800          UNTIL XS028-INTR-UPC-ID >= IM057-INTR-UPC-ID            03380009
030850          OR PS-END-OF-XS-SKU-LOC                                 03390009
030900     END-IF.                                                      03400009
031000                                                                  03410009
031100     ACCEPT PV-CURR-TIME FROM TIME.                               03420009
031200     MOVE PV-CURR-TIME-HH          TO DP200-RUN-HOUR.             03430009
031300     MOVE PV-CURR-TIME-MM          TO DP200-RUN-MINUTE.           03440009
031400                                                                  03450009
031500     MOVE FUNCTION CURRENT-DATE (1:8)                             03460009
031600                                   TO PV-CURR-DATE-CCYYMMDD.      03470009
031700                                                                  03480009
031800     MOVE PV-CURR-DATE-MM          TO DP200-RUN-MONTH.            03490009
031900     MOVE PV-CURR-DATE-DD          TO DP200-RUN-DAY.              03500009
032000     MOVE PV-CURR-DATE-CCYY        TO DP200-RUN-YEAR.             03510009
032100                                                                  03520009
032200     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200-PROGRAM-NAME.         03530009
032300                                                                  03540009
032400     PERFORM 8700-REPORT-HEADER-ROUTINE.                          03550009
032500                                                                  03560009
032600******************************************************************03570009
032700*2000-PROCESS-RECORDS.                                            03580009
032800* THIS SECTION COMPARES RECORDS ON THE SOR ITEM SKU LOC FILE &    03590009
032900* XS DOMAIN SKU LOC ATTR EXTRACT FILE. IF KEYS MATCH, PROGRAM     03600009
033000* DOES NO REPORTING. IF THE KEY (INTERNAL UPC ID & STR) DOES      03610009
033010* NOT APPEAR ON ONE FILE, BUT IS ON THE OTHER FILE THEN AN        03620009
033100* APPROPRIATE MESSAGE WILL BE WRITTEN TO THE ERROR FILE, ALONG    03630009
033200* WITH THE DATA ON THE CORRESPONDING FILES.                       03640009
033300******************************************************************03650009
033400 2000-PROCESS-RECORDS.                                            03660009
033500                                                                  03670009
033600     INITIALIZE DL1-DETAIL-LINE-1                                 03680009
                      DLS-DETAIL-LINE-1-SOR                             03690009
                      DLX-DETAIL-LINE-1-XS                              03700009
033700     MOVE ZEROS TO PV-SOR-READ-SKIP-CNT.                          03710009
033800                                                                  03720009
NEMTST**   DISPLAY '>>> 2000-PROCESS KEYS ARE SOR*'                     03730009
NEMTST**           IM057-INTR-UPC-ID, '-', IM057-STR-NBR                03740009
NEMTST**              '== AND XS*'                                      03750009
NEMTST**           XS028-INTR-UPC-ID, '-', XS028-LOC-NBR, '**'          03760009
033900     EVALUATE TRUE                                                03770009
034000        WHEN IM057-INTR-UPC-ID = XS028-INTR-UPC-ID                03780009
034050           AND IM057-STR-NBR   = XS028-LOC-NBR                    03790009
NEMADD*A          IF IM057-BEG-DATE  = XS028-BEG-DATE                   03800009
034100             PERFORM 2100-COMPARE-FIELDS                          03810009
033700             MOVE ZEROS TO PV-SOR-READ-SKIP-CNT                   03820009
034200             PERFORM 7000-READ-SOR-SKU-LOC-EXTRACT                03830009
034300                UNTIL PV-SOR-READ-SKIP-CNT =                      03840009
034400                       XS046-READ-FREQUENCY OR                    03850009
034500                       PS-END-OF-SOR-SKU-LOC                      03860009
034600             IF XS046-READ-FREQUENCY = PC-ONE                     03870009
034700                PERFORM 7100-READ-XS-SKU-LOC-EXTRACT              03880009
034800                   XS046-READ-FREQUENCY TIMES                     03890009
034900             ELSE                                                 03900009
035000                PERFORM 7100-READ-XS-SKU-LOC-EXTRACT UNTIL        03910009
035100                  (XS028-INTR-UPC-ID >  IM057-INTR-UPC-ID         03920009
035100               OR (XS028-INTR-UPC-ID  = IM057-INTR-UPC-ID         03930009
035150                  AND IM057-STR-NBR  >= XS028-LOC-NBR))           03940009
034500                 OR PS-END-OF-XS-SKU-LOC                          03950009
035200             END-IF                                               03960009
NEMADD*A          ELSE                                                  03970009
NEMADD********  DATE MISMATCH  IM057-BEG-DATE NOT = XS028-BEG-DATE      03980009
035400*A           PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  03990009
035500*A           PERFORM 2400-MOVE-SOR-VALUES                         04000009
035600*A           MOVE PC-MISMATCHED-BEG-DATE                          04010009
035700*A              TO DL1-ERROR-MESSAGE                              04020009
035800*A           MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04030009
035900*A           ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04040009
036000*A           PERFORM 8900-WRITE-REPORT-LINE                       04041009
034200*A           PERFORM 7000-READ-SOR-SKU-LOC-EXTRACT                04042009
034300*A              UNTIL PV-SOR-READ-SKIP-CNT =                      04043009
034400*A                     XS046-READ-FREQUENCY OR                    04044009
034500*A                     PS-END-OF-SOR-SKU-LOC                      04045009
034600*A           IF XS046-READ-FREQUENCY = PC-ONE                     04046009
034700*A              PERFORM 7100-READ-XS-SKU-LOC-EXTRACT              04047009
034800*A                 XS046-START-POINT TIMES                        04048009
034900*A           ELSE                                                 04049009
035000*A              PERFORM 7100-READ-XS-SKU-LOC-EXTRACT UNTIL        04050009
035100*A                (XS028-INTR-UPC-ID >  IM057-INTR-UPC-ID         04051009
035100*A             OR (XS028-INTR-UPC-ID  = IM057-INTR-UPC-ID         04051109
035150*A                AND IM057-STR-NBR  >= XS028-LOC-NBR))           04051209
034500*A               OR PS-END-OF-XS-SKU-LOC                          04051309
035200*A           END-IF                                               04051409
035200*A          END-IF                                                04051509
034000        WHEN IM057-INTR-UPC-ID = XS028-INTR-UPC-ID                04051609
034050           AND IM057-STR-NBR   < XS028-LOC-NBR                    04051709
NEMTST***     DISPLAY '=== SAME UPC LOC MISMATCH XS HIGH SOR*'          04051809
NEMTST***          IM057-INTR-UPC-ID, '-', IM057-STR-NBR                04051909
NEMTST***             '== AND XS*'                                      04052009
NEMTST***          XS028-INTR-UPC-ID, '-', XS028-LOC-NBR, '**'          04053009
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  04054009
035500             PERFORM 2400-MOVE-SOR-VALUES                         04055009
035600             MOVE PC-MISMATCHED-STR-LOC-NBRS                      04056009
035700                TO DL1-ERROR-MESSAGE                              04057009
035800             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04058009
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04059009
036000             PERFORM 8900-WRITE-REPORT-LINE                       04060009
034200             PERFORM 7000-READ-SOR-SKU-LOC-EXTRACT                04070009
034300                UNTIL PV-SOR-READ-SKIP-CNT =                      04080009
034400                       XS046-READ-FREQUENCY OR                    04090009
034500                       PS-END-OF-SOR-SKU-LOC                      04100009
034000        WHEN IM057-INTR-UPC-ID = XS028-INTR-UPC-ID                04110009
034050           AND IM057-STR-NBR   > XS028-LOC-NBR                    04120009
NEMTST***     DISPLAY '=== SAME UPC LOC MISMATCH SOR HIGH SOR*'         04130009
NEMTST***          IM057-INTR-UPC-ID, '-', IM057-STR-NBR                04140009
NEMTST***             '== AND XS*'                                      04150009
NEMTST***          XS028-INTR-UPC-ID, '-', XS028-LOC-NBR, '**'          04160009
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  04170009
035500             PERFORM 2500-MOVE-XS-VALUES                          04180009
035600             MOVE PC-MISMATCHED-STR-LOC-NBRS                      04190009
035700               TO DL1-ERROR-MESSAGE                               04200009
035800             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04210009
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04220009
036000             PERFORM 8900-WRITE-REPORT-LINE                       04230009
037000             PERFORM 7100-READ-XS-SKU-LOC-EXTRACT                 04240009
035300        WHEN IM057-INTR-UPC-ID < XS028-INTR-UPC-ID                04250009
NEMTST***     DISPLAY '=== SOR LOWER *'                                 04260009
NEMTST***          IM057-INTR-UPC-ID, '-', IM057-STR-NBR                04270009
NEMTST***             '== AND XS*'                                      04280009
NEMTST***          XS028-INTR-UPC-ID, '-', XS028-LOC-NBR, '**'          04290009
035400             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  04300009
035500             PERFORM 2400-MOVE-SOR-VALUES                         04310009
035600             MOVE PC-MISSING-FROM-XS-SKU-LOC                      04320009
035700                TO DL1-ERROR-MESSAGE                              04330009
035800             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04340009
035900             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04350009
036000             PERFORM 8900-WRITE-REPORT-LINE                       04360009
036100             PERFORM 7000-READ-SOR-SKU-LOC-EXTRACT                04370009
036200        WHEN IM057-INTR-UPC-ID > XS028-INTR-UPC-ID                04380009
036300             PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                  04390009
036400             PERFORM 2500-MOVE-XS-VALUES                          04400009
036500             MOVE PC-MISSING-FROM-SOR-SKU-LOC                     04410009
036600                TO DL1-ERROR-MESSAGE                              04420009
036700             MOVE DL1-DETAIL-LINE-1 TO PV-PRINT-RECORD            04430009
036800             ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                04440009
036900             PERFORM 8900-WRITE-REPORT-LINE                       04450009
037000             PERFORM 7100-READ-XS-SKU-LOC-EXTRACT                 04460009
037100     END-EVALUATE.                                                04470009
037200                                                                  04480009
037300******************************************************************04490009
037400*2100-COMPARE-FIELDS.                                             04500009
037500* COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   04510009
037600******************************************************************04520009
037700 2100-COMPARE-FIELDS.                                             04530009
037800                                                                  04540009
037900     SET                                                          04550009
038000         PS-NO-INTR-UPC-ID-ERROR                                  04560009
038100         PS-NO-ERROR-FOUND               TO TRUE.                 04570009
038200                                                                  04580009
038300     IF  IM057-INTR-UPC-ID  NOT EQUAL XS028-INTR-UPC-ID           04590009
038400         SET PS-ERROR-FOUND                                       04600009
038500         PS-INTR-UPC-ID-ERROR             TO TRUE                 04610009
038600     END-IF.                                                      04620009
038700                                                                  04630009
038800     IF  IM057-STR-NBR    NOT EQUAL XS028-LOC-NBR                 04640009
038900         SET PS-ERROR-FOUND                                       04650009
039000         PS-LOC-STR-NBR-ERROR             TO TRUE                 04660009
039100     END-IF.                                                      04670009
039200                                                                  04680009
038800     IF  IM057-BEG-DATE   NOT EQUAL XS028-BEG-DATE                04690009
038900         SET PS-ERROR-FOUND  TO TRUE                              04700009
021100         MOVE ' BEGIN DT ' TO  DLS-ERR-BEG-DT                     04710009
039100     END-IF.                                                      04720009
039200                                                                  04730009
038800     IF  IM057-UNT-RTL-AMT NOT EQUAL XS028-UNT-RTL-AMT            04740009
038900         SET PS-ERROR-FOUND  TO TRUE                              04750009
021100         MOVE ' UNIT RTL ' TO  DLS-ERR-UNT-RTL                    04760009
039100     END-IF.                                                      04770009
039200                                                                  04780009
038800     IF  IM057-UNT-COST-AMT NOT EQUAL XS028-UNT-COST-AMT          04790009
038900         SET PS-ERROR-FOUND  TO TRUE                              04800009
021100         MOVE ' UNIT CST ' TO  DLS-ERR-UNT-COST                   04810009
039100     END-IF.                                                      04820009
039200                                                                  04830009
038800     IF  IM057-UNT-RTL-CHG-DTE NOT EQUAL XS028-UNT-RTL-CHG-DTE    04840009
NEMTST***      DISPLAY '**** SOR RTL DATE-',                            04850009
NEMTST***              IM057-UNT-RTL-CHG-DTE                            04860009
NEMTST***              '** XS RTL DATE-',                               04870009
NEMTST***              XS028-UNT-RTL-CHG-DTE                            04880009
NEMTST***              '** ON UPC/LOC-',                                04890009
NEMTST***              IM057-INTR-UPC-ID,                               04900009
NEMTST***              IM057-STR-NBR                                    04910009
038900         SET PS-ERROR-FOUND  TO TRUE                              04920009
021100         MOVE 'UNT RTL DT' TO  DLS-ERR-UNT-RTL-DT                 04930009
039100     END-IF.                                                      04940009
039200                                                                  04950009
038800     IF  IM057-SKU-STAT-CDE NOT EQUAL XS028-LOC-SKU-STAT-CDE      04960009
038900         SET PS-ERROR-FOUND  TO TRUE                              04970009
021100         MOVE ' SKU STAT ' TO   DLX-ERR-SKU-STAT                  04980009
039100     END-IF.                                                      04981009
039200                                                                  04982009
038800     IF  IM057-STAT-CHG-DTE NOT EQUAL XS028-UPC-STAT-CHG-DTE      04983009
038900         SET PS-ERROR-FOUND  TO TRUE                              04984009
021100         MOVE ' STAT DT  ' TO   DLX-ERR-SKU-STAT-DT               04985009
039100     END-IF.                                                      04986009
039200                                                                  04987009
038800     IF  XS028-GP-PRIC-ID-IS-NULL                                 04988009
NEMTST**   DISPLAY '>>> 2100- FOUND NULL GP SOR*'                       04989009
NEMTST**           IM057-INTR-UPC-ID, '-', IM057-STR-NBR                04990009
NEMTST**              '== AND XS*'                                      04991009
NEMTST**           XS028-INTR-UPC-ID, '-', XS028-LOC-NBR, '**'          04991109
NEMTST**           ' XS PRIC ID =', XS028-GP-PRIC-ID                    04991209
NEMTST**           ' SOR GP NBR =', IM057-MEITGP-NBR, '******'          04991309
038850        MOVE ZEROES TO XS028-GP-PRIC-ID                           04991409
038800        IF  IM057-MEITGP-NBR   NOT EQUAL XS028-GP-PRIC-ID         04991509
038900            SET PS-ERROR-FOUND  TO TRUE                           04991609
021100            MOVE ' GP PR ID ' TO   DLX-ERR-GP-PRIC-ID             04991709
039100        END-IF                                                    04991809
039100     END-IF.                                                      04991909
039200                                                                  04992009
038800     IF  XS028-GP-RTL-QTY-IS-NULL                                 04993009
038850         MOVE ZEROES TO XS028-GP-RTL-QTY                          04994009
038800         IF  IM057-GP-RTL-QTY   NOT EQUAL XS028-GP-RTL-QTY        04995009
038900             SET PS-ERROR-FOUND  TO TRUE                          04996009
021100             MOVE ' GP QTY  ' TO  DLX-ERR-GP-RTL-QTY              04997009
039100         END-IF                                                   04998009
039100     END-IF.                                                      04999009
039200                                                                  05000009
038800     IF  XS028-GP-RTL-AMT-IS-NULL                                 05010009
038850         MOVE ZEROES TO XS028-GP-RTL-AMT                          05011009
038800         IF  IM057-GP-RTL-QTY   NOT EQUAL XS028-GP-RTL-AMT        05012009
038900             SET PS-ERROR-FOUND  TO TRUE                          05013009
021100             MOVE ' GP AMT  ' TO  DLX-ERR-GP-RTL-AMT              05014009
039100         END-IF                                                   05015009
039100     END-IF.                                                      05016009
039200                                                                  05017009
038800     IF  XS028-MKDN-CDE-IS-NULL                                   05017109
038850         MOVE SPACES TO XS028-MKDN-CDE                            05017209
039100     END-IF.                                                      05017309
038800     IF  IM057-MKDN-CDE = LOW-VALUES                              05017409
038850         MOVE SPACES TO IM057-MKDN-CDE                            05017509
039100     END-IF.                                                      05017609
                                                                        05017709
038800     IF  IM057-MKDN-CDE   NOT EQUAL XS028-MKDN-CDE                05017809
038900         SET PS-ERROR-FOUND  TO TRUE                              05017909
021100         MOVE ' MKDN CD' TO  DLS-ERR-MKDN-CDE                     05018009
039100     END-IF.                                                      05018109
039200                                                                  05018209
038800     IF  XS028-ORIG-CLR-DTE-IS-NULL                               05018309
038850         MOVE SPACES TO XS028-ORIG-CLR-DTE                        05018409
039100     END-IF.                                                      05018509
038800     IF  IM057-ORIG-CLR-DTE = LOW-VALUES                          05018609
038850         MOVE SPACES TO IM057-ORIG-CLR-DTE                        05018709
039100     END-IF.                                                      05018809
039200                                                                  05018909
C33751*    IF  IM057-ORIG-CLR-DTE  NOT EQUAL XS028-ORIG-CLR-DTE         05019011
C33751*        SET PS-ERROR-FOUND  TO TRUE                              05019111
C33751*        MOVE ' ORIG DT' TO  DLX-ERR-ORIG-CLR-DTE                 05019211
C33751*    END-IF.                                                      05019311
039200                                                                  05019409
039300     IF  PS-ERROR-FOUND                                           05019509
039400         PERFORM 2300-CHECK-IF-NEW-PG-NEEDED                      05019609
039500         PERFORM 2600-MOVE-ALL-VALUES                             05019709
039700         PERFORM 2900-MOVE-ERROR-MSG                              05019809
039800         MOVE DLS-DETAIL-LINE-1-SOR TO PV-PRINT-RECORD            05019909
040000         PERFORM 8900-WRITE-REPORT-LINE                           05020009
039800         MOVE DLX-DETAIL-LINE-1-XS  TO PV-PRINT-RECORD            05030009
039900         ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                    05040009
040000         PERFORM 8900-WRITE-REPORT-LINE                           05050009
040100     ELSE                                                         05060009
040200         ADD +1 TO PV-VALID-MATCH-CNT                             05070009
040300     END-IF.                                                      05080009
040400                                                                  05090009
040500     MOVE ZEROS TO PV-SOR-READ-SKIP-CNT.                          05100009
040600                                                                  05110009
040700******************************************************************05120009
040800**  PROCESSES THRU END OF FILE FOR REMAINING RECORDS              05130009
040900******************************************************************05140009
041000 2200-PROCESS-EXTRA-RECORDS.                                      05150009
041100                                                                  05160009
041200     INITIALIZE DL1-DETAIL-LINE-1.                                05170009
041300     MOVE ZEROS TO PV-SOR-READ-SKIP-CNT.                          05180009
041400                                                                  05190009
041500     IF  PS-NOT-END-OF-SOR-SKU-LOC                                05200009
041600         IF IM057-INTR-UPC-ID NOT = XS028-INTR-UPC-ID             05210009
041700            PERFORM 2400-MOVE-SOR-VALUES                          05220009
041800            MOVE PC-EXTRA-FOUND-SOR-SKU-LOC                       05230009
041900               TO DL1-ERROR-MESSAGE                               05240009
042000            MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD           05250009
042010            ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                 05260009
042100            PERFORM 8900-WRITE-REPORT-LINE                        05270009
042200         ELSE                                                     05280009
042210            IF IM057-STR-NBR NOT = XS028-LOC-NBR                  05290009
042220               PERFORM 2400-MOVE-SOR-VALUES                       05300009
042230               MOVE PC-MISMATCHED-STR-LOC-NBRS                    05310009
042240                    TO DL1-ERROR-MESSAGE                          05320009
042250               MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD        05330009
042260               ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT              05340009
042270               PERFORM 8900-WRITE-REPORT-LINE                     05350009
042200            END-IF                                                05360009
042200         END-IF                                                   05370009
042300         PERFORM 7000-READ-SOR-SKU-LOC-EXTRACT                    05380009
042400     END-IF.                                                      05390009
042500                                                                  05400009
042600     IF  PS-NOT-END-OF-XS-SKU-LOC                                 05410009
042700         IF IM057-INTR-UPC-ID NOT = XS028-INTR-UPC-ID             05420009
042800            PERFORM 2500-MOVE-XS-VALUES                           05430009
042900            MOVE PC-EXTRA-FOUND-XS-SKU-LOC                        05440009
043000                TO DL1-ERROR-MESSAGE                              05450009
043100            MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD           05460009
043110            ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT                 05470009
043200            PERFORM 8900-WRITE-REPORT-LINE                        05480009
043210         ELSE                                                     05490009
042220            IF IM057-STR-NBR NOT = XS028-LOC-NBR                  05500009
042230               PERFORM 2500-MOVE-XS-VALUES                        05510009
042240               MOVE PC-MISMATCHED-STR-LOC-NBRS                    05520009
042250                    TO DL1-ERROR-MESSAGE                          05530009
042260               MOVE DL1-DETAIL-LINE-1   TO PV-PRINT-RECORD        05540009
042270               ADD +1 TO PV-ERROR-RECORD-WRITTEN-CNT              05550009
042280               PERFORM 8900-WRITE-REPORT-LINE                     05560009
042290            END-IF                                                05570009
043300         END-IF                                                   05580009
043400         PERFORM 7100-READ-XS-SKU-LOC-EXTRACT                     05590009
043500     END-IF.                                                      05600009
043600                                                                  05610009
043700******************************************************************05620009
043800* 2300-CHECK-IF-NEW-PG-NEEDED.                                    05630009
043900*     CHECKS TO SEE IF A NEW PAGE IS NEEDED.                      05640009
044000***************************************************************** 05650009
044100 2300-CHECK-IF-NEW-PG-NEEDED.                                     05660009
044200                                                                  05670009
044300     IF PV-LINE-CNT > PC-MAX-REPORT-LINES                         05680009
044400        PERFORM 8700-REPORT-HEADER-ROUTINE                        05690009
044500     END-IF.                                                      05700009
044600                                                                  05710009
044700******************************************************************05720009
044800* 2400-MOVE-SOR-VALUES.                                           05730009
044900*     MOVES THE SOR ITEM SKU LOC VALUES TO THE ERROR RECORD.      05740009
045000***************************************************************** 05750009
045100 2400-MOVE-SOR-VALUES.                                            05760009
045200                                                                  05770009
045300     MOVE IM057-INTR-UPC-ID     TO PV-TEMP-INTR-UPC-ID            05780009
045400     MOVE PV-TEMP-INTR-UPC-ID   TO DL1-SOR-INTR-UPC-ID.           05790009
045500     MOVE IM057-BEG-DATE        TO DL1-BEG-DT.                    05800009
           IF IM057-STR-NBR EQUAL ZEROS                                 05810009
045500        MOVE '   0'             TO DL1-SOR-STR-NBR                05820009
           ELSE                                                         05830009
045500        MOVE IM057-STR-NBR      TO DL1-SOR-STR-NBR                05840009
           END-IF.                                                      05850009
045700                                                                  05860009
045800******************************************************************05870009
045900* 2500-MOVE-XS-VALUES.                                            05880009
046000*     MOVES THE XS SKU LOC ATTR VALUES TO THE ERROR RECORD.       05890009
046100***************************************************************** 05900009
046200 2500-MOVE-XS-VALUES.                                             05910009
046300                                                                  05920009
046400     MOVE XS028-INTR-UPC-ID     TO PV-TEMP-INTR-UPC-ID.           05930009
046500     MOVE PV-TEMP-INTR-UPC-ID   TO DL1-XS-INTR-UPC-ID.            05940009
045500     MOVE XS028-BEG-DATE        TO DL1-BEG-DT.                    05950009
046600     IF XS028-LOC-NBR = ZEROS                                     05960009
              MOVE '    0'            TO DL1-XS-LOC-NBR                 05970009
           ELSE                                                         05971009
046600        MOVE XS028-LOC-NBR      TO DL1-XS-LOC-NBR                 05972009
           END-IF.                                                      05973009
046800                                                                  05974009
045800******************************************************************05975009
045900* 2600-MOVE-ALL-VALUES.                                           05976009
046000*     MOVES THE XS AND SOR VALUES TO THE TWO DETAIL LINES.        05977009
046100***************************************************************** 05978009
046200 2600-MOVE-ALL-VALUES.                                            05979009
046300                                                                  05980009
045300     MOVE IM057-INTR-UPC-ID     TO PV-TEMP-INTR-UPC-ID            05990009
045400     MOVE PV-TEMP-INTR-UPC-ID   TO DLS-SOR-INTR-UPC-ID.           06000009
045500     IF IM057-STR-NBR = ZEROS                                     06010009
              MOVE '    0'            TO DLS-SOR-STR-NBR                06020009
           ELSE                                                         06030009
045500        MOVE IM057-STR-NBR      TO DLS-SOR-STR-NBR                06040009
           END-IF.                                                      06050009
045700                                                                  06060009
046400     MOVE XS028-INTR-UPC-ID     TO PV-TEMP-INTR-UPC-ID.           06070009
046500     MOVE PV-TEMP-INTR-UPC-ID   TO DLX-XS-INTR-UPC-ID.            06080009
046600     IF XS028-LOC-NBR = ZEROS                                     06090009
              MOVE '    0'            TO DLX-XS-LOC-NBR                 06100009
           ELSE                                                         06101009
046600        MOVE XS028-LOC-NBR      TO DLX-XS-LOC-NBR                 06102009
           END-IF.                                                      06103009
046800                                                                  06104009
045500     MOVE XS028-BEG-DATE        TO DLX-XS-BEG-DT.                 06105009
045500     MOVE IM057-BEG-DATE        TO DLS-SOR-BEG-DT.                06106009
045700                                                                  06107009
045500     MOVE XS028-UNT-RTL-AMT     TO DLX-XS-UNT-RTL.                06108009
045500     MOVE IM057-UNT-RTL-AMT     TO DLS-SOR-UNT-RTL.               06109009
045700                                                                  06110009
045500     MOVE XS028-UNT-COST-AMT    TO DLX-XS-UNT-COST.               06120009
045500     MOVE IM057-UNT-COST-AMT    TO DLS-SOR-UNT-COST.              06130009
045700                                                                  06140009
045500     MOVE XS028-LOC-SKU-STAT-CDE TO DLX-XS-SKU-STAT.              06150009
045500     MOVE IM057-SKU-STAT-CDE     TO DLS-SOR-SKU-STAT.             06160009
046800                                                                  06170009
045500     MOVE XS028-UPC-STAT-CHG-DTE TO DLX-XS-SKU-STAT-DT.           06180009
045500     MOVE IM057-STAT-CHG-DTE    TO DLS-SOR-SKU-STAT-DT.           06190009
045700                                                                  06200009
045500     MOVE XS028-UNT-RTL-CHG-DTE TO DLX-XS-UNT-RTL-DT.             06210009
045500     MOVE IM057-UNT-RTL-CHG-DTE TO DLS-SOR-UNT-RTL-DT.            06220009
045700                                                                  06230009
045500     MOVE XS028-GP-PRIC-ID      TO DLX-XS-GP-PRIC-ID.             06240009
045500     MOVE IM057-MEITGP-NBR      TO DLS-SOR-GP-PRIC-ID.            06250009
045700                                                                  06260009
045500     MOVE XS028-GP-RTL-QTY      TO DLX-XS-GP-RTL-QTY.             06270009
045500     MOVE IM057-GP-RTL-QTY      TO DLS-SOR-GP-RTL-QTY.            06280009
045700                                                                  06290009
045500     MOVE XS028-GP-RTL-AMT      TO DLX-XS-GP-RTL-AMT.             06300009
045500     MOVE IM057-GP-AMT          TO DLS-SOR-GP-RTL-AMT.            06310009
045700                                                                  06320009
045500     MOVE XS028-MKDN-CDE        TO DLX-XS-MKDN-CDE.               06330009
045500     MOVE IM057-MKDN-CDE        TO DLS-SOR-MKDN-CDE.              06340009
045700                                                                  06350009
045500*    * ORIG CLR DTE VALUES ARE NOT DISPLAYED ON REPORT.  THEY *   06351009
045500*    * ARE EXPECTED TO BE TEMPORARY.                          *   06352009
045700                                                                  06353009
046900******************************************************************06354009
047000* 2900-MOVE-ERROR-MSG.                                            06355009
047100*     MOVES THE ERROR MESSAGE TO THE ERROR RECORD.                06356009
047200***************************************************************** 06357009
047300 2900-MOVE-ERROR-MSG.                                             06358009
047400                                                                  06359009
047500     IF PS-INTR-UPC-ID-ERROR                                      06360009
047600        MOVE PC-MISMATCHED-INTR-UPC-ID   TO DL1-ERROR-MESSAGE     06370009
047700     ELSE                                                         06380009
047800        IF PS-LOC-STR-NBR-ERROR                                   06390009
047900           MOVE PC-MISMATCHED-STR-LOC-NBRS                        06400009
048000                 TO DL1-ERROR-MESSAGE                             06410009
048100        END-IF                                                    06420009
048300     END-IF.                                                      06430009
048400                                                                  06440009
048500***************************************************************** 06450009
048600*7000-READ-SOR-SKU-LOC-EXTRACT.                                   06460009
048700*  READ SOR ITEM SKU EXTRACT FILE                                 06470009
048800*  READS THE VMS EXTRACT FILE, SKIPPING THE NUMBER OF RECORDS     06480009
048900*  SPECIFIED IN THE START/SKIP RECORD CONTROL CARD.               06490009
049100***************************************************************** 06500009
049200 7000-READ-SOR-SKU-LOC-EXTRACT.                                   06510009
049300                                                                  06520009
049400     IF  PS-NOT-END-OF-SOR-SKU-LOC                                06530009
049500         READ SOR-SKU-LOC-EXTRACT-FILE                            06540009
049550            INTO IM057-ITEM-SKU-LOC-DOMAIN-REC                    06550009
049600              AT END                                              06560009
049700                 SET PS-END-OF-SOR-SKU-LOC TO TRUE                06570009
049800         END-READ                                                 06580009
049900     END-IF.                                                      06590009
050000                                                                  06600009
050100     IF  PS-NOT-END-OF-SOR-SKU-LOC                                06610009
NEMTST***     DISPLAY '=== SYSTEM OF RECORD READ *'                     06620009
NEMTST***          IM057-INTR-UPC-ID, '-', IM057-STR-NBR, '**'          06630009
050900         ADD +1 TO PV-SOR-READ-SKIP-CNT                           06640009
052200         ADD +1 TO PV-SOR-SKU-LOC-RECS-READ-CNT                   06650009
052500     END-IF.                                                      06660009
052600                                                                  06670009
052700***************************************************************** 06680009
052800*7100-READ-XS-SKU-LOC-EXTRACT.                                    06690009
052900* READ XS EXTRACT FILE                                            06700009
053000***************************************************************** 06710009
053100 7100-READ-XS-SKU-LOC-EXTRACT.                                    06720009
053200                                                                  06730009
053300     IF  PS-NOT-END-OF-XS-SKU-LOC                                 06740009
053400         READ XS-SKU-LOC-EXTRACT-FILE                             06750009
053450           INTO XS028-SKU-LOC-UNLOAD                              06760009
053500             AT END                                               06770009
053600                SET PS-END-OF-XS-SKU-LOC TO TRUE                  06780009
053700         END-READ                                                 06790009
053800     END-IF.                                                      06800009
053900                                                                  06810009
054000     IF  PS-NOT-END-OF-XS-SKU-LOC                                 06820009
NEMTST***     DISPLAY '=== XS READ *'                                   06830009
NEMTST***          XS028-INTR-UPC-ID, '-', XS028-LOC-NBR, '**'          06840009
054100         ADD +1                   TO PV-XS-EXTRACT-REC-READ-CNT   06850009
054200     END-IF.                                                      06860009
054300                                                                  06870009
054400******************************************************************06880009
054500* 8700-REPORT-HEADER-ROUTINE.                                     06890009
054600*     PRINT THE HEADINGS FOR THE REPORT.                          06900009
054700******************************************************************06910009
054800 8700-REPORT-HEADER-ROUTINE.                                      06920009
054900                                                                  06930009
055000     MOVE ZEROS                  TO PV-LINE-CNT.                  06940009
055100     ADD +1                      TO PV-PAGE-CNT.                  06950009
055200     MOVE PV-PAGE-CNT            TO DP200-PAGE-NUMBER.            06960009
055300                                                                  06970009
055400     MOVE PC-REPORT-NBR-1        TO DP200-REPORT-NUMBER.          06980009
055500     MOVE DP200-STANDRD-HEADER-200-COLS                           06990009
055600                                 TO PV-PRINT-RECORD.              07000009
055700                                                                  07010009
055800     PERFORM 8800-WRITE-RPT-TOP-OF-PAGE.                          07020009
055900                                                                  07030009
056000     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              07040009
056100     MOVE +2                     TO PV-LINE-SPACING.              07050009
056200     PERFORM 8900-WRITE-REPORT-LINE.                              07060009
056300                                                                  07070009
056400     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              07080009
056500     MOVE +3                     TO PV-LINE-SPACING.              07090009
056600     PERFORM 8900-WRITE-REPORT-LINE.                              07100009
056700                                                                  07110009
056800******************************************************************07120009
056900* 8800-WRITE-RPT-TOP-OF-PAGE                                      07130009
057000*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   07140009
057100******************************************************************07150009
057200 8800-WRITE-RPT-TOP-OF-PAGE.                                      07160009
057300                                                                  07170009
057400     WRITE XS-SKU-LOC-INTEG-RPT-RECORD                            07180009
057500       FROM PV-PRINT-RECORD                                       07190009
057600         AFTER ADVANCING PAGE.                                    07200009
057700                                                                  07210009
057800     MOVE +1 TO PV-LINE-CNT.                                      07220009
057900                                                                  07230009
058000******************************************************************07240009
058100* 8900-WRITE-REPORT-LINE                                          07250009
058200*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             07260009
058300******************************************************************07270009
058400 8900-WRITE-REPORT-LINE.                                          07280009
058500                                                                  07290009
058600     WRITE XS-SKU-LOC-INTEG-RPT-RECORD                            07300009
058700       FROM PV-PRINT-RECORD                                       07310009
058800         AFTER ADVANCING PV-LINE-SPACING.                         07320009
058900                                                                  07330009
059000     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          07340009
059100                                                                  07350009
059200****************************************************************  07360009
059300*END OF PROGRAM ROUTINE                                           07370009
059400****************************************************************  07380009
059500 9000-END-OF-PGM.                                                 07390009
059600                                                                  07400009
060800     DISPLAY '******** XSKRP011 COUNTS *********'.                07410009
060850     DISPLAY ' INTEGRITY CHECK - FOR XST_SKU_LOC '.               07420009
060900     DISPLAY '   SOR REC READ CNT= '                              07430009
060950                     PV-SOR-SKU-LOC-RECS-READ-CNT.                07440009
061000     DISPLAY 'XS SKU LOC READ CNT= ' PV-XS-EXTRACT-REC-READ-CNT.  07450009
061100     DISPLAY ' ERROR MSGS WRITTEN= ' PV-ERROR-RECORD-WRITTEN-CNT. 07460009
061200     DISPLAY '  VALID MATCH COUNT= ' PV-VALID-MATCH-CNT.          07470009
061300     DISPLAY '                              '.                    07480009
061310     DISPLAY ' ==== CONTROL CARD VALUES     '.                    07490009
061400     DISPLAY '    START RECORD POINT= ' XS046-START-POINT.        07500009
061500     DISPLAY ' SKIP RECORD FREQUENCY= ' XS046-READ-FREQUENCY.     07510009
061700     DISPLAY '**********************************'.                07520009
061800                                                                  07530009
061900     IF  PV-ERROR-RECORD-WRITTEN-CNT > 0                          07540009
062000         MOVE 04               TO RETURN-CODE                     07550009
062100     END-IF.                                                      07560009
062200                                                                  07570009
062300     CLOSE SOR-SKU-LOC-EXTRACT-FILE                               07580009
062400           XS-SKU-LOC-EXTRACT-FILE                                07590009
062500           XS-SKU-LOC-INTEG-RPT-FILE.                             07600009
062600                                                                  07610009
062700******************************************************************07620009
062800*     9999-ABEND                                                 *07630009
062900* ==> PROCESSES:                                                 *07640009
063000*     -PERFORMS ABEND PROCESSING FOR NON-SQL-ERRORS.             *07650009
063100******************************************************************07660009
063200 9999-ABEND.                                                      07670009
063300                                                                  07680009
063400     DISPLAY '9999-ABEND'.                                        07690009
063500     DISPLAY '**  ABEND     **', PC-CURRENT-PROGRAM-NAME.         07700009
063600     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               07710009
063700     DISPLAY '**  OPERATION ** ' PV-OPERATION-MSG-1.              07720009
063800     DISPLAY '**            ** ' PV-OPERATION-MSG-2.              07730009
063900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07740009
