000100***************************************************************** 00010008
000200 IDENTIFICATION DIVISION.                                         00020008
000300***************************************************************** 00030008
000400                                                                  00040008
000500 PROGRAM-ID.             SAKRP030.                                00050008
000600 AUTHOR.                 BARB ERTL - SAFENET CONSULTING.          00060008
000700 INSTALLATION.           KOHLS.                                   00070008
000800 DATE-WRITTEN            DECEMBER 1999.                           00080008
000900 DATE-COMPILED.                                                   00090008
001000                                                                  00100008
001100***************************************************************** 00110008
001200* * * *>>>   THIS PROGRAM MUST BE COMPILED COBOL/390   <<<* * * * 00120008
001300***************************************************************** 00130008
001400*                                                                 00140008
001500*  THIS PROGRAM WILL CREATE A WEEKLY POS TO CASH SALES EXCEPTION  00150008
001600*  REPORT.                                                        00160008
001700*                                                                 00170008
001800*   INPUT: INP01 - CONTAINS POS DATE, WHICH IS USED AS THE        00180008
001900*                  PROCESS DATE TO CREATE THE REPORT.             00190008
002000*          INP02 - CONTAINS TABLE OF CTG CODES WITH POSITION      00200008
002100*                  ON REPORT, CODE IN TABLE AND DESCRIPTION       00210008
002200*                                                                 00220008
002300*  OUTPUT: RPT01 - REPORT SHOWING WEEKLY POS TO CASH SALES        00230008
002400*                  EXCEPTIONS BY STORE.                           00240008
002500*                                                                 00250008
002600***************************************************************** 00260008
002700*                                                                 00270008
002800*  THE PROGRAM READS A CONTROL CARD FILE TO GET THE POS DATE.     00280008
002900*                                                                 00290008
003000*  THIS DATE IS PASSED TO THE KOHLS CALENDAR ROUTINE.  THE DATE   00300008
003100*  IS VALIDATED AND RETURNED IN DB2 DATE FORMAT.  ALSO, THE DATES 00310008
003200*  OF THE FIRST AND LAST DAYS OF THE WEEK ARE RETURNED. THESE TWO 00320008
003300*  DAYS WILL BE USED IN THE CURSOR FOR THE TSAADSU TABLE.         00330008
003400*                                                                 00340008
003500******************************************************************00350008
003600* CHANGE LOG:                                                     00360008
003700* DATE:  06-14-00                                                 00370008
003800* PRGMR: PAT DOYLE                                                00380008
003900* WHY:   ADDED CODE TO PROCESS SUM_CTG_CDE OF 'RTX' ON TSASUM     00390008
004000*        TABLE.  THIS IS THE RETURN TAX AMOUNT.  IT MUST BE       00400008
004100*        ADDED TO THE STATE TAXABLE MDSE (STM) AMOUNT TO NET OUT  00410008
004200*        THE TAX AMOUNT FOR RETURNS, BECAUSE STM DOES NOT         00420008
004300*        INCLUDE RETURNS.                                         00430008
004400******************************************************************00440008
004500* CHANGE LOG:                                                     00450008
004600* DATE:  12-16-01            WR# 23086                            00460008
004700* PRGMR: GAYLE HAUPT                                              00470008
004800* WHY:   DEBIT CARD PROJECT INTRODUCES NEW CATEGORY CODES FOR     00480008
004900*        TSAADSU (DBN--DEBIT CARD NET) AND TSASUM (DBS--DEBIT     00490008
005000*        CARD SALES, DBR--DEBIT CARD RETURNS).  THESE WILL BE     00500008
005100*        INCLUDED IN THE REPORT UNDER 'DEBIT'.                    00510008
005200***************************************************************** 00520008
005300*  CHANGED 04/15/08 BY STEVEN NOWAK                               00530008
005400*  BLACK HAWK CHANGES (THIRD PARTY GIFT CARD) FOR NEXT GEN 2      00540008
005500***************************************************************** 00550008
005600******************************************************************00560008
005700*  CHANGED 12/20/10 BY : COGNIZANT                               *00570008
005800*  INCIDENT:INC000001528087                                      *00580008
005900*  DESC: SASUM-CTG-AMT DCLGEN VARIABLE DOESN'T HAVE ENOUGH       *00590008
006000*        LENGTH TO STORE SUM OF SALES AMOUNT VALUE FROM MAIN     *00600008
006100*        FETCH CURSOR.SO NEW VARIABLE PV-SLS-RET-AMT             *00610008
006200*        INTRODUCED WITH INCREASED THE VARIABLE SIZE TO HOLD     *00620008
006300*        ENOUGH SALES VALUES.                                    *00630008
006400*        IF THIS HAPPENS IN FUTURE,PLEASE KEEP INCREASE THE      *00640008
006500*        PV-SLS-RET-AMT FIELD VARIABLE SIZE.                     *00650008
006600******************************************************************00660008
PRB707******************************************************************00661012
PRB707*  CHANGED 06/10/16 BY : COGNIZANT                               *00662012
PRB707*  PRB#: PRB0057707                                              *00663012
PRB707*  DESC: THIS IS TO ADD CORP REFUND(CRI) AND PURCHASE ORDER SALES*00664012
PRB707*        (POS) AND PURCHASE ORDER RETURNS(POR) TO THE REPORT     *00665012
PRB707******************************************************************00669212
SEPHOR*  CHANGED 05/03/21 BY BARB SCHULTZ                              *00669314
SEPHOR*  CHG#: CHG0256426                                              *00669417
SEPHOR*  ADDED SEPHORA CHARGES 'SCN' TO THE REPORT AND DELETED 'ECD'   *00669820
SEPHOR*  EMPLOYEE DISC.                                                *00669920
SEPHOR******************************************************************00670020
PAYVEN*  CHANGED 05/08/23 BY BARB SCHULTZ                              *00670122
PAYVEN*  CHG#: CHG0288283                                              *00670224
PAYVEN*  ADDED PAYPAL 'PPN' AND VENMO 'VMN' TO THE REPORT.             *00670322
PAYVEN******************************************************************00670622
006700                                                                  00671020
006800 ENVIRONMENT DIVISION.                                            00680008
006900 CONFIGURATION SECTION.                                           00690008
007000                                                                  00700008
007100 SOURCE-COMPUTER.        IBM-3090.                                00710008
007200 OBJECT-COMPUTER.        IBM-3090.                                00720008
007300                                                                  00730008
007400 INPUT-OUTPUT SECTION.                                            00740008
007500 FILE-CONTROL.                                                    00750008
007600                                                                  00760008
007700     SELECT POS-DATE-CARD-FILE                                    00770008
007800         ASSIGN TO INP01.                                         00780008
007900                                                                  00790008
008000     SELECT CTG-CDE-FILE                                          00800008
008100         ASSIGN TO INP02.                                         00810008
008200                                                                  00820008
008300     SELECT SUMMARY-REPORT-FILE                                   00830008
008400         ASSIGN TO RPT01.                                         00840008
008500                                                                  00850008
008600 DATA DIVISION.                                                   00860008
008700 FILE SECTION.                                                    00870008
008800                                                                  00880008
008900 FD  POS-DATE-CARD-FILE                                           00890008
009000     RECORDING MODE IS F                                          00900008
009100     BLOCK CONTAINS 0 RECORDS                                     00910008
009200     LABEL RECORDS ARE STANDARD.                                  00920008
009300                                                                  00930008
009400 01  POS-DATE-CARD-RECORD            PIC X(80).                   00940008
009500                                                                  00950008
009600 FD  CTG-CDE-FILE                                                 00960008
009700     RECORDING MODE IS F                                          00970008
009800     BLOCK CONTAINS 0 RECORDS                                     00980008
009900     LABEL RECORDS ARE STANDARD.                                  00990008
010000                                                                  01000008
010100 01  CTG-CDE-RECORD                  PIC X(80).                   01010008
010200                                                                  01020008
010300 FD  SUMMARY-REPORT-FILE                                          01030008
010400     RECORDING MODE IS F                                          01040008
010500     BLOCK CONTAINS 0  RECORDS.                                   01050008
010600                                                                  01060008
010700 01  SUMMARY-REPORT-RECORD           PIC  X(132).                 01070008
010800                                                                  01080008
010900******************************************************************01090008
011000 WORKING-STORAGE SECTION.                                         01100008
011100******************************************************************01110008
011200 01  FILLER                            PIC X(50)  VALUE           01120008
011300     ' *** WORKING STORAGE STARTS HERE FOR SAKRP030 *** '.        01130008
011400                                                                  01140008
011500******************************************************************01150008
011600* RECORD LAYOUT FOR INPUT DATE CARD                               01160008
011700******************************************************************01170008
011800                                                                  01180008
011900 01  CC-CONTROL-CARD.                                             01190008
012000     05  CC-CONTROL-CARD-DISPLAY.                                 01200008
012100         10  CC-DATE-ISO         PIC X(10).                       01210008
012200         10 FILLER               PIC X(70).                       01220008
012300                                                                  01230008
012400******************************************************************01240008
012500* RECORD LAYOUT FOR CTG CODE CARD                                 01250008
012600******************************************************************01260008
012700                                                                  01270008
012800 01  CTG-CDE-CARD.                                                01280008
012900     05  CTG-CDE-CODE            PIC XXX.                         01290008
013000     05  FILLER                  PIC X.                           01300008
013100     05  CTG-CDE-DESC            PIC X(16).                       01310008
013200     05  FILLER                  PIC X(60).                       01320008
013300                                                                  01330008
013400******************************************************************01340008
013500*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01350008
013600******************************************************************01360008
013700     COPY DPWS500.                                                01370008
013800 EJECT                                                            01380008
013900 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01390008
014000                                                  COMP SYNC.      01400008
014100     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01410008
014200     88  AC-DB2-ERROR                             VALUE +4013.    01420008
014300     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    01430008
014400     88  AC-CODE-FILE-ERROR                       VALUE +4025.    01440008
014500                                                                  01450008
014600 01  PS-PROGRAM-SWITCHES.                                         01460008
014700     05  PS-END-OF-SUM-CURSOR-SW       PIC X(01)  VALUE 'N'.      01470008
014800         88  PS-END-OF-SUM-CURSOR                 VALUE 'Y'.      01480008
014900     05  PS-END-OF-ADSU-CURSOR-SW      PIC X(01)  VALUE 'N'.      01490008
015000         88  PS-END-OF-ADSU-CURSOR                VALUE 'Y'.      01500008
015100     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      01510008
015200         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01520008
015300     05  PS-END-OF-CODES-SW            PIC X(01)  VALUE 'N'.      01530008
015400         88  PS-END-OF-CODES                      VALUE 'Y'.      01540008
015500     05  PS-VARIANCE-FOUND-SW          PIC X(01)  VALUE 'N'.      01550008
015600         88  PS-VARIANCE-FOUND                    VALUE 'Y'.      01560008
015700     05  PS-CODE-FOUND-SW              PIC X(01)  VALUE 'N'.      01570008
015800         88  PS-CODE-FOUND                        VALUE 'Y'.      01580008
015900         88  PS-NO-CODE-FOUND                     VALUE 'N'.      01590008
016000                                                                  01600008
016100 01  PC-CONSTANTS.                                                01610008
016200     05  PC-LINE-LIMIT               PIC S9(04)  VALUE +60.       01620008
016300     05  PC-ROW-NOT-FOUND            PIC S9(04)  VALUE +100       01630008
016400                                                 COMP SYNC.       01640008
016500     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            01650008
016600                                                 'SAKRP030'.      01660008
016700     05  PC-REPORT-NBR-1             PIC  9(01)  VALUE 1.         01670008
016800     05  PC-TOTALS-LIT               PIC  X(6)   VALUE 'TOTALS'.  01680008
016900     05  PC-ALL-STORES               PIC  X(10)  VALUE            01690008
017000                                                 'ALL STORES'.    01700008
017100 01  PC-INDEXES.                                                  01710008
017200     05  PC-AMEX-INDEX               PIC S999    COMP.            01720008
017300     05  PC-BANKCARD-INDEX           PIC S999    COMP.            01730008
017400     05  PC-NOVUS-INDEX              PIC S999    COMP.            01740008
017500     05  PC-DEBIT-INDEX              PIC S999    COMP.            01750008
017600     05  PC-KOHLS-CHARGE-INDEX       PIC S999    COMP.            01760008
017700     05  PC-KOHLS-PYMT-INDEX         PIC S999    COMP.            01770008
017800     05  PC-TPC-SALES-INDEX          PIC S999    COMP.            01780008
017900     05  PC-GIFT-CRD-SLD-INDEX       PIC S999    COMP.            01790008
018000     05  PC-GIFT-CRD-TND-INDEX       PIC S999    COMP.            01800008
018100     05  PC-KMRC-ISSUED-INDEX        PIC S999    COMP.            01810008
018200     05  PC-KMRC-TEND-INDEX          PIC S999    COMP.            01820008
018300     05  PC-TAX-INDEX                PIC S999    COMP.            01830008
018500     05  PC-STM-INDEX                PIC S999    COMP.            01850008
PRB707     05  PC-PO-INDEX                 PIC S999    COMP.            01860011
PRB707     05  PC-CRI-INDEX                PIC S999    COMP.            01870011
SEPHOR     05  PC-SEPHORA-INDEX            PIC S999    COMP.            01871015
PAYVEN     05  PC-PAYPAL-INDEX             PIC S999    COMP.            01872023
PAYVEN     05  PC-VENMO-INDEX              PIC S999    COMP.            01873023
018800                                                                  01880008
018900 01  PV-MISC-COUNT-FIELDS            COMP-3.                      01890008
019000     05  PV-PAGE-CNT                 PIC S9(05)    VALUE ZERO.    01900008
019100     05  PV-LINE-CNT                 PIC S9(03)    VALUE +65.     01910008
019200     05  PV-LINE-CNT-AHEAD           PIC S9(03)    VALUE ZERO.    01920008
019300                                                                  01930008
019400 01  PV-MISC-FIELDS.                                              01940008
019500     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACE.   01950008
019600     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     01960008
019700                                                   COMP SYNC.     01970008
019800     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   01980008
019900     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   01990008
020000     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   02000008
020100     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   02010008
020200     05  PV-START-DATE               PIC  X(10).                  02020008
020300     05  PV-END-DATE                 PIC  X(10).                  02030008
020400     05  PV-SLS-RET-AMT                PIC S9(9)V99 COMP-3.       02040008
020500     05  PV-SAVE-STR-NBR             PIC  S9(4)    COMP.          02050008
020600     05  PV-SAVE-STR-PRT             PIC  S9(4)    VALUE 0        02060008
020700                                                   COMP.          02070008
020800     05  PV-SAVE-SLS-DTE             PIC  X(10).                  02080008
020900     05  PV-SUB                      PIC  S9(3)    COMP.          02090008
021000     05  PV-MAX-CODES                PIC  S9(3)    VALUE +30      02100008
021100                                                   COMP-3.        02110008
021200                                                                  02120008
021300                                                                  02130008
021400 01  PV-DATE-AND-TIME-FIELDS.                                     02140008
021500     05  PV-POS-CCYY-MM-DD           PIC X(10)     VALUE SPACE.   02150008
021600     05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      02160008
021700         10  PV-POS-CCYY             PIC X(04).                   02170008
021800         10  FILLER                  PIC X(01).                   02180008
021900         10  PV-POS-MM               PIC X(02).                   02190008
022000         10  FILLER                  PIC X(01).                   02200008
022100         10  PV-POS-DD               PIC X(02).                   02210008
022200     05  PV-CURR-DATE-CCYYMMDD.                                   02220008
022300         10  PV-CURR-DATE-CCYY       PIC  9(04).                  02230008
022400         10  PV-CURR-DATE-MM         PIC  9(02).                  02240008
022500         10  PV-CURR-DATE-DD         PIC  9(02).                  02250008
022600     05  PV-CURR-TIME.                                            02260008
022700         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    02270008
022800         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    02280008
022900         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    02290008
023000     05  PV-HEADER-DATE.                                          02300008
023100         10  PV-HEADER-MM            PIC XX.                      02310008
023200         10  PV-HEADER-SLASH-1       PIC X.                       02320008
023300         10  PV-HEADER-DD            PIC XX.                      02330008
023400         10  PV-HEADER-SLASH-2       PIC X.                       02340008
023500         10  PV-HEADER-CCYY          PIC X(04).                   02350008
023600                                                                  02360008
023700 EJECT                                                            02370008
023800******************************************************************02380008
023900*  TABLES FOR REPORT                                              02390008
024000******************************************************************02400008
024100                                                                  02410008
024200 01  CODE-TABLE.                                                  02420008
024300     05  CODE-ENTRY                  OCCURS 30 TIMES.             02430008
024400         10  CE-CODE                 PIC XXX.                     02440008
024500         10  CE-DESCRIPTION          PIC X(16).                   02450008
024600                                                                  02460008
024700 01  TOTALS-TABLE.                                                02470008
024800     05  TENDER-TOTAL-ENTRY          OCCURS 30 TIMES              02480008
024900                                     INDEXED BY TT-INDEX.         02490008
025000         10  TT-DAILY-SLS-AMT        PIC S9(9)V99  COMP-3.        02500008
025100         10  TT-SLS-CORR-AMT         PIC S9(9)V99  COMP-3.        02510008
025200         10  TT-LATE-SLS-AMT         PIC S9(9)V99  COMP-3.        02520008
025300         10  TT-CASH-SLS-AMT         PIC S9(9)V99  COMP-3.        02530008
025400         10  TT-VARIANCE-AMT         PIC S9(9)V99  COMP-3.        02540008
025500                                                                  02550008
025600 01  COMPANY-TOTALS-TABLE.                                        02560008
025700     05  TENDER-COMP-TOTAL-ENTRY     OCCURS 30 TIMES.             02570008
025800         10  CT-DAILY-SLS-AMT        PIC S9(9)V99  COMP-3.        02580008
025900         10  CT-SLS-CORR-AMT         PIC S9(9)V99  COMP-3.        02590008
026000         10  CT-LATE-SLS-AMT         PIC S9(9)V99  COMP-3.        02600008
026100         10  CT-CASH-SLS-AMT         PIC S9(9)V99  COMP-3.        02610008
026200         10  CT-VARIANCE-AMT         PIC S9(9)V99  COMP-3.        02620008
026300                                                                  02630008
026400                                                                  02640008
026500******************************************************************02650008
026600*  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT.  02660008
026700******************************************************************02670008
026800     COPY DPWS132.                                                02680008
026900                                                                  02690008
027000******************************************************************02700008
027100*  HEADING LINES FOR THE EXCEPTION REPORT.                        02710008
027200******************************************************************02720008
027300                                                                  02730008
027400 01  H2-HEADING-LINE-2.                                           02740008
027500     05  FILLER                  PIC X(49)   VALUE SPACE.         02750008
027600     05  FILLER                  PIC X(35)   VALUE                02760008
027700         'POS TO CASH SALES EXCEPTION REPORT '.                   02770008
027800     05  FILLER                  PIC X(48)   VALUE SPACES.        02780008
027900                                                                  02790008
028000 01  H3-HEADING-LINE-3.                                           02800008
028100     05  FILLER                  PIC X(52)   VALUE SPACE.         02810008
028200     05  FILLER                  PIC X(17)   VALUE                02820008
028300         'FOR WEEK ENDING: '.                                     02830008
028400     05  HDR3-WEEK-END-DTE       PIC X(10)   VALUE SPACE.         02840008
028500     05  FILLER                  PIC X(53)   VALUE SPACES.        02850008
028600                                                                  02860008
028700 01  H4-HEADING-LINE-4.                                           02870008
028800     05  FILLER                  PIC X       VALUE SPACE.         02880008
028900     05  FILLER                  PIC X(5)    VALUE 'STORE'.       02890008
029000     05  FILLER                  PIC X(3)    VALUE SPACE.         02900008
029100     05  FILLER                  PIC X(10)   VALUE                02910008
029200         'SALES DATE'.                                            02920008
029300     05  FILLER                  PIC X(3)    VALUE SPACES.        02930008
029400     05  FILLER                  PIC X(16)   VALUE                02940008
029500         'TENDER          '.                                      02950008
029600     05  FILLER                  PIC XX      VALUE SPACES.        02960008
029700     05  FILLER                  PIC X(15)   VALUE                02970008
029800         '    DAILY SALES'.                                       02980008
029900     05  FILLER                  PIC X(3)    VALUE SPACES.        02990008
030000     05  FILLER                  PIC X(17)   VALUE                03000008
030100         'SALES CORRECTIONS'.                                     03010008
030200     05  FILLER                  PIC X(3)    VALUE SPACES.        03020008
030300     05  FILLER                  PIC X(15)   VALUE                03030008
030400         '     LATE SALES'.                                       03040008
030500     05  FILLER                  PIC X(4)    VALUE SPACES.        03050008
030600     05  FILLER                  PIC X(15)   VALUE                03060008
030700         '     CASH SALES'.                                       03070008
030800     05  FILLER                  PIC X(4)    VALUE SPACES.        03080008
030900     05  FILLER                  PIC X(15)   VALUE                03090008
031000         '       VARIANCE'.                                       03100008
031100     05  FILLER                  PIC XX      VALUE SPACE.         03110008
031200                                                                  03120008
031300******************************************************************03130008
031400*  DETAIL LINE PRINTED FIRST ON THE CORPORATE SUMMARY REPORT.     03140008
031500******************************************************************03150008
031600                                                                  03160008
031700 01  D1-DETAIL-LINE-1.                                            03170008
031800     05  FILLER                  PIC XX.                          03180008
031900     05  DTL1-STORE              PIC X(4).                        03190008
032000     05  FILLER                  PIC X(3)    VALUE SPACES.        03200008
032100     05  DTL1-SLS-DTE            PIC X(10).                       03210008
032200     05  FILLER                  PIC X(3)    VALUE SPACES.        03220008
032300     05  DTL1-TENDER-DESC        PIC X(16)   VALUE SPACES.        03230008
032400     05  FILLER                  PIC X(2)    VALUE SPACES.        03240008
032500     05  DTL1-DAILY-SLS          PIC ----,---,---.99.             03250008
032600     05  FILLER                  PIC X(4)    VALUE SPACES.        03260008
032700     05  DTL1-SLS-CORR           PIC ----,---,---.99.             03270008
032800     05  FILLER                  PIC X(4)    VALUE SPACES.        03280008
032900     05  DTL1-LATE-SLS           PIC ----,---,---.99.             03290008
033000     05  FILLER                  PIC X(4)    VALUE SPACES.        03300008
033100     05  DTL1-CASH-SLS           PIC ----,---,---.99.             03310008
033200     05  FILLER                  PIC X(4)    VALUE SPACES.        03320008
033300     05  DTL1-VARIANCE           PIC ----,---,---.99.             03330008
033400 EJECT                                                            03340008
033500******************************************************************03350008
033600*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            03360008
033700******************************************************************03370008
033800     COPY DPWS004.                                                03380008
033900 EJECT                                                            03390008
034000******************************************************************03400008
034100*  DB2 COMMUNICATION AREA.                                        03410008
034200******************************************************************03420008
034300     EXEC SQL                                                     03430008
034400          INCLUDE SQLCA                                           03440008
034500     END-EXEC.                                                    03450008
034600 EJECT                                                            03460008
034700******************************************************************03470008
034800*  DB2 TABLE DB2PDBA.TSAADSU - ADJUSTED SUMMARY TABLE             03480008
034900******************************************************************03490008
035000     EXEC SQL                                                     03500008
035100          INCLUDE TSAADSU                                         03510008
035200     END-EXEC.                                                    03520008
035300 EJECT                                                            03530008
035400******************************************************************03540008
035500*  DB2 TABLE DB2PDBA.TSASUM - SUMMARY TOTALS TABLE                03550008
035600******************************************************************03560008
035700     EXEC SQL                                                     03570008
035800          INCLUDE TSASUM                                          03580008
035900     END-EXEC.                                                    03590008
036000******************************************************************03600008
036100*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            03610008
036200******************************************************************03620008
036300     EXEC SQL                                                     03630008
036400          INCLUDE TEPPART                                         03640008
036500     END-EXEC.                                                    03650008
036600 EJECT                                                            03660008
036700******************************************************************03670008
036800*  CURSOR FOR FETCHING TSAADSU                                    03680008
036900******************************************************************03690008
037000     EXEC SQL                                                     03700008
037100         DECLARE SUMMARY-CURSOR CURSOR                            03710008
037200         FOR SELECT STR_NBR                                       03720008
037300                   ,SLS_DTE                                       03730008
037400                   ,SUM_CTG_CDE                                   03740008
037500                   ,ADJ_AMT                                       03750008
037600                   ,ADJ_IND                                       03760008
037700         FROM TSAADSU                                             03770008
037800         WHERE SLS_DTE BETWEEN :PV-START-DATE AND :PV-END-DATE    03780008
037900           AND SUM_CTG_CDE IN ('AEN','NCN','BCN','KCN','KCP',     03790008
038000                               'GDS','GDT','KMI','KMT','TAX',     03800008
PRB707                               'STM','DBN','TPC','POS','POR',     03810011
PAYVEN                               'CRI','SCN', 'PPN', 'VMN')         03821025
SEPHOR*                              'CRI','SCN')                       03822023
038300         ORDER BY STR_NBR, SLS_DTE                                03830008
038400         WITH UR                                                  03840008
038500     END-EXEC.                                                    03850008
038600 EJECT                                                            03860008
038700******************************************************************03870008
038800*  CURSOR FOR FETCHING TSASUM                                     03880008
038900******************************************************************03890008
039000     EXEC SQL                                                     03900008
039100         DECLARE TSASUM-CURSOR CURSOR                             03910008
039200         FOR SELECT  A.SUM_TYP_CDE                                03920008
039300                    ,A.SUM_CTG_CDE                                03930008
039400                    ,SUM(A.CTG_AMT)                               03940008
039500         FROM TSASUM A                                            03950008
039600             ,TEPPART B                                           03960008
039700         WHERE B.SLS_DTE   = :PV-SAVE-SLS-DTE                     03970008
039800           AND A.PARTN_NBR = B.PARTN_NBR                          03980008
039900           AND A.STR_NBR   = :PV-SAVE-STR-NBR                     03990008
PRB707           AND SUM_TYP_CDE IN ('D','S')                           04000011
040100           AND SUM_CTG_CDE IN ('GDS','GDT','KMI','KMT','KCS',     04010008
040200                               'KCR','KCP','BCS','BCR','TAX',     04020008
SEPHOR                               'SAL','AXS','AXR','NCS',           04030018
040400                               'NCR','GTS','RTX','DBS','DBR',     04040008
SEPHOR                               'TPC','POS','POR','CRI','SCS',     04051115
PAYVEN                               'SCR','PPS','PPR','VMS','VMR')     04052023
SEPHOR*                              'SCR')                             04053023
040600           AND RGST_ID     <>  0                                  04060008
040700         GROUP BY A.SUM_TYP_CDE, A.SUM_CTG_CDE                    04070008
040800         WITH UR                                                  04080008
040900     END-EXEC.                                                    04090008
041000 EJECT                                                            04100008
041100***************************************************************** 04110008
041200* PROCEDURE DIVISION.                                           * 04120008
041300***************************************************************** 04130008
041400 PROCEDURE DIVISION.                                              04140008
041500 EJECT                                                            04150008
041600******************************************************************04160008
041700* 0000-MAINLINE-PARAGRAPH                                         04170008
041800*      PRODUCE CORPORATE SUMMARY REPORT                           04180008
041900******************************************************************04190008
042000 0000-MAINLINE-PARAGRAPH.                                         04200008
042100                                                                  04210008
042200     PERFORM 1000-INITIALIZE-PROGRAM.                             04220008
042300                                                                  04230008
042400     PERFORM 8000-OPEN-SUMMARY-CURSOR.                            04240008
042500                                                                  04250008
042600     PERFORM 8100-FETCH-SUMMARY-CURSOR.                           04260008
042700                                                                  04270008
042800     MOVE SAADSU-STR-NBR         TO PV-SAVE-STR-NBR.              04280008
042900     MOVE SAADSU-SLS-DTE         TO PV-SAVE-SLS-DTE.              04290008
043000                                                                  04300008
043100     PERFORM 2000-CASH-SALES-REPORT                               04310008
043200       UNTIL PS-END-OF-ADSU-CURSOR.                               04320008
043300                                                                  04330008
043400     PERFORM 8200-CLOSE-SUMMARY-CURSOR.                           04340008
043500                                                                  04350008
043600     PERFORM 7100-PRINT-TOTALS.                                   04360008
043700                                                                  04370008
043800     CLOSE SUMMARY-REPORT-FILE.                                   04380008
043900                                                                  04390008
044000     GOBACK.                                                      04400008
044100                                                                  04410008
044200 EJECT                                                            04420008
044300******************************************************************04430008
044400* 1000-INITIALIZE-PROGRAM                                         04440008
044500*     OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS,   04450008
044600*     OPEN SUMMARY-CURSOR, ATTEMPT FIRST FETCH OF CURSOR.         04460008
044700******************************************************************04470008
044800                                                                  04480008
044900 1000-INITIALIZE-PROGRAM.                                         04490008
045000                                                                  04500008
045100     OPEN INPUT  POS-DATE-CARD-FILE                               04510008
045200                 CTG-CDE-FILE                                     04520008
045300          OUTPUT SUMMARY-REPORT-FILE.                             04530008
045400                                                                  04540008
045500     PERFORM 1100-PROCESS-CONTROL-CARD.                           04550008
045600                                                                  04560008
045700     INITIALIZE CODE-TABLE.                                       04570008
045800     INITIALIZE TOTALS-TABLE.                                     04580008
045900     INITIALIZE COMPANY-TOTALS-TABLE.                             04590008
046000                                                                  04600008
046100     MOVE 0 TO PV-SUB.                                            04610008
046200                                                                  04620008
046300     PERFORM 1400-LOAD-CODE-TABLE THRU 1400-EXIT                  04630008
046400         UNTIL PV-SUB = +30                                       04640008
046500            OR PS-END-OF-CODES.                                   04650008
046600                                                                  04660008
046700     IF PS-END-OF-CODES                                           04670008
046800         MOVE PV-SUB TO PV-MAX-CODES                              04680008
046900                        PV-LINE-CNT-AHEAD                         04690008
047000         IF PV-MAX-CODES = 0                                      04700008
047100             MOVE '1400-LOAD-CODE-TABLE' TO PV-PARAGRAPH-NAME     04710008
047200             MOVE 'NO CTG CODES TO PROCESS' TO PV-OPERATION-MSG-1 04720008
047300             SET AC-CODE-FILE-ERROR TO TRUE                       04730008
047400             PERFORM 9999-ABEND                                   04740008
047500         ELSE                                                     04750008
047600             DISPLAY 'NUMBER OF CTG CODES LOADED ' PV-MAX-CODES   04760008
047700         END-IF.                                                  04770008
047800                                                                  04780008
047900     CLOSE CTG-CDE-FILE.                                          04790008
048000                                                                  04800008
048100     PERFORM 1500-FORMAT-HEADINGS.                                04810008
048200                                                                  04820008
048300******************************************************************04830008
048400* 1100-PROCESS-CONTROL-CARD                                       04840008
048500*     READ CONTROL CARD TO GET POS DATE IN MMDDYY FORMAT.  CALL   04850008
048600*     DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD PROCESS DATE.  04860008
048700******************************************************************04870008
048800                                                                  04880008
048900 1100-PROCESS-CONTROL-CARD.                                       04890008
049000                                                                  04900008
049100     PERFORM 1200-READ-CONTROL-CARD.                              04910008
049200                                                                  04920008
049300     IF PS-END-OF-CARD-FILE                                       04930008
049400         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   04940008
049500         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  04950008
049600         SET AC-CONTROL-CARD-ERROR TO TRUE                        04960008
049700         PERFORM 9999-ABEND                                       04970008
049800     END-IF.                                                      04980008
049900                                                                  04990008
050000     DISPLAY PC-CURRENT-PROGRAM-NAME                              05000008
050100             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY  ')'.  05010008
050200                                                                  05020008
050300     PERFORM 1300-CONVERT-INPUT-DATE.                             05030008
050400 EJECT                                                            05040008
050500******************************************************************05050008
050600* 1200-READ-CONTROL-CARD                                          05060008
050700*     READ DATE CONTROL CARD.                                     05070008
050800******************************************************************05080008
050900                                                                  05090008
051000 1200-READ-CONTROL-CARD.                                          05100008
051100                                                                  05110008
051200     READ POS-DATE-CARD-FILE INTO CC-CONTROL-CARD                 05120008
051300        AT END                                                    05130008
051400           SET PS-END-OF-CARD-FILE TO TRUE.                       05140008
051500                                                                  05150008
051600     CLOSE POS-DATE-CARD-FILE.                                    05160008
051700                                                                  05170008
051800******************************************************************05180008
051900* 1300-CONVERT-INPUT-DATE                                         05190008
052000*     CALL KOHLS CALENDAR ROUTINE:                                05200008
052100*         PASS: CONTROL CARD POS DATE (MMDDYY FORMAT).            05210008
052200*       RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT). 05220008
052300******************************************************************05230008
052400                                                                  05240008
052500 1300-CONVERT-INPUT-DATE.                                         05250008
052600                                                                  05260008
052700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05270008
052800                                                                  05280008
052900     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   05290008
053000     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   05300008
053100     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   05310008
053200     MOVE CC-DATE-ISO                  TO DPG52-LK-DATE-INPUT.    05320008
053300                                                                  05330008
053400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05340008
053500                                             DPG54 DPG55 DPG56.   05350008
053600                                                                  05360008
053700     EVALUATE TRUE                                                05370008
053800         WHEN DPG54-SEVERE-ERROR                                  05380008
053900             MOVE '1300-CONVERT-INPUT-DATE'                       05390008
054000                                           TO PV-PARAGRAPH-NAME   05400008
054100             MOVE 'ERROR CONVERTING INPUT CARD DATE'              05410008
054200                                           TO PV-OPERATION-MSG-1  05420008
054300             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                05430008
054400             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  05440008
054500             PERFORM 9999-ABEND                                   05450008
054600     END-EVALUATE.                                                05460008
054700                                                                  05470008
054800     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      05480008
054900     MOVE DPG55-1ST-WKDY-DB2ISO-FMT    TO PV-START-DATE           05490008
055000     MOVE DPG55-LAST-WKDY-DB2ISO-FMT   TO PV-END-DATE.            05500008
055100 EJECT                                                            05510008
055200******************************************************************05520008
055300* 1400-LOAD-CODE-TABLE.                                           05530008
055400*     LOAD INDEXES, CODES AND DESCRIPTIONS TO TABLE.              05540008
055500******************************************************************05550008
055600 1400-LOAD-CODE-TABLE.                                            05560008
055700                                                                  05570008
055800     READ CTG-CDE-FILE                                            05580008
055900         AT END                                                   05590008
056000             SET PS-END-OF-CODES TO TRUE                          05600008
056100             GO TO 1400-EXIT.                                     05610008
056200                                                                  05620008
056300     MOVE CTG-CDE-RECORD TO CTG-CDE-CARD.                         05630008
056400                                                                  05640008
056500     IF CTG-CDE-CODE GREATER THAN SPACES                          05650008
056600         AND CTG-CDE-CODE NOT = '***'                             05660008
056700         COMPUTE PV-SUB = PV-SUB + 1                              05670008
056800         MOVE CTG-CDE-CODE    TO CE-CODE(PV-SUB)                  05680008
056900         MOVE CTG-CDE-DESC    TO CE-DESCRIPTION(PV-SUB)           05690008
057000                                                                  05700008
057100         EVALUATE CTG-CDE-CODE                                    05710008
057200             WHEN 'AEN'                                           05720008
057300                 MOVE PV-SUB TO PC-AMEX-INDEX                     05730008
057400             WHEN 'BCN'                                           05740008
057500                 MOVE PV-SUB TO PC-BANKCARD-INDEX                 05750008
057600             WHEN 'NCN'                                           05760008
057700                 MOVE PV-SUB TO PC-NOVUS-INDEX                    05770008
057800             WHEN 'DBN'                                           05780008
057900                 MOVE PV-SUB TO PC-DEBIT-INDEX                    05790008
058000             WHEN 'KCN'                                           05800008
058100                 MOVE PV-SUB TO PC-KOHLS-CHARGE-INDEX             05810008
058200             WHEN 'KCP'                                           05820008
058300                 MOVE PV-SUB TO PC-KOHLS-PYMT-INDEX               05830008
058400             WHEN 'GDS'                                           05840008
058500                 MOVE PV-SUB TO PC-GIFT-CRD-SLD-INDEX             05850008
058600             WHEN 'TPC'                                           05860008
058700                 MOVE PV-SUB TO PC-TPC-SALES-INDEX                05870008
058800             WHEN 'GDT'                                           05880008
058900                 MOVE PV-SUB TO PC-GIFT-CRD-TND-INDEX             05890008
059000             WHEN 'KMI'                                           05900008
059100                 MOVE PV-SUB TO PC-KMRC-ISSUED-INDEX              05910008
059200             WHEN 'KMT'                                           05920008
059300                 MOVE PV-SUB TO PC-KMRC-TEND-INDEX                05930008
059400             WHEN 'TAX'                                           05940008
059500                 MOVE PV-SUB TO PC-TAX-INDEX                      05950008
059800             WHEN 'STM'                                           05980008
059900                 MOVE PV-SUB TO PC-STM-INDEX                      05990008
PRB707             WHEN 'CRI'                                           06000011
PRB707                 MOVE PV-SUB TO PC-CRI-INDEX                      06010011
PRB707             WHEN 'PON'                                           06020011
PRB707                 MOVE PV-SUB TO PC-PO-INDEX                       06030011
SEPHOR             WHEN 'SCN'                                           06031013
SEPHOR                 MOVE PV-SUB TO PC-SEPHORA-INDEX                  06032013
PAYVEN             WHEN 'PPN'                                           06033023
PAYVEN                 MOVE PV-SUB TO PC-PAYPAL-INDEX                   06034023
PAYVEN             WHEN 'VMN'                                           06035023
PAYVEN                 MOVE PV-SUB TO PC-VENMO-INDEX                    06036023
060400         END-EVALUATE                                             06040008
060500     END-IF.                                                      06050008
060600                                                                  06060008
060700 1400-EXIT.                                                       06070008
060800     EXIT.                                                        06080008
060900     EJECT                                                        06090008
061000******************************************************************06100008
061100* 1500-FORMAT-HEADINGS                                            06110008
061200*     GET CURRENT DATE AND TIME FROM SYSTEM.                      06120008
061300*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          06130008
061400*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              06140008
061500******************************************************************06150008
061600 1500-FORMAT-HEADINGS.                                            06160008
061700                                                                  06170008
061800     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   06180008
061900     ACCEPT PV-CURR-TIME FROM TIME.                               06190008
062000                                                                  06200008
062100     MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.         06210008
062200     MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.           06220008
062300     MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.          06230008
062400                                                                  06240008
062500     MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.          06250008
062600     MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.        06260008
062700     MOVE PC-CURRENT-PROGRAM-NAME     TO DP132-PROGRAM-NAME.      06270008
062800     MOVE PC-REPORT-NBR-1             TO DP132-REPORT-NUMBER.     06280008
062900                                                                  06290008
063000     MOVE PV-END-DATE                 TO PV-POS-CCYY-MM-DD.       06300008
063100     MOVE PV-POS-MM                   TO PV-HEADER-MM.            06310008
063200     MOVE '/'                         TO PV-HEADER-SLASH-1.       06320008
063300     MOVE PV-POS-DD                   TO PV-HEADER-DD.            06330008
063400     MOVE '/'                         TO PV-HEADER-SLASH-2.       06340008
063500     MOVE PV-POS-CCYY                 TO PV-HEADER-CCYY.          06350008
063600     MOVE PV-HEADER-DATE              TO HDR3-WEEK-END-DTE.       06360008
063700                                                                  06370008
063800                                                                  06380008
063900******************************************************************06390008
064000* 2000-CASH-SALES-REPORT.                                         06400008
064100*     CREATE THE WEEKLY CASH SALES REPORT                         06410008
064200******************************************************************06420008
064300 2000-CASH-SALES-REPORT.                                          06430008
064400                                                                  06440008
064500     PERFORM 3000-PROCESS-TSAADSU                                 06450008
064600       UNTIL PV-SAVE-SLS-DTE NOT = SAADSU-SLS-DTE                 06460008
064700          OR PV-SAVE-STR-NBR NOT = SAADSU-STR-NBR                 06470008
064800          OR PS-END-OF-ADSU-CURSOR.                               06480008
064900                                                                  06490008
065000     PERFORM 8300-OPEN-TSASUM-CURSOR.                             06500008
065100                                                                  06510008
065200     MOVE 'N' TO PS-END-OF-SUM-CURSOR-SW.                         06520008
065300                                                                  06530008
065400     PERFORM 8400-FETCH-TSASUM-CURSOR.                            06540008
065500                                                                  06550008
065600     PERFORM 4000-PROCESS-TSASUM                                  06560008
065700       UNTIL PS-END-OF-SUM-CURSOR.                                06570008
065800                                                                  06580008
065900     PERFORM 8500-CLOSE-TSASUM-CURSOR.                            06590008
066000                                                                  06600008
066100     MOVE 'N' TO PS-VARIANCE-FOUND-SW.                            06610008
066200                                                                  06620008
066300     PERFORM 5000-COMPUTE-VARIANCE                                06630008
066400         VARYING PV-SUB FROM 1 BY 1                               06640008
066500             UNTIL PV-SUB GREATER THAN PV-MAX-CODES.              06650008
066600                                                                  06660008
066700     IF PS-VARIANCE-FOUND                                         06670008
066800         PERFORM 6000-PRINT-TABLE.                                06680008
066900                                                                  06690008
067000     PERFORM 7000-ACCUM-TOTALS                                    06700008
067100         VARYING PV-SUB FROM 1 BY 1                               06710008
067200             UNTIL PV-SUB GREATER THAN PV-MAX-CODES.              06720008
067300                                                                  06730008
067400     MOVE SAADSU-SLS-DTE TO PV-SAVE-SLS-DTE.                      06740008
067500     MOVE SAADSU-STR-NBR TO PV-SAVE-STR-NBR.                      06750008
067600                                                                  06760008
067700     INITIALIZE TOTALS-TABLE.                                     06770008
067800                                                                  06780008
067900******************************************************************06790008
068000* 3000-PROCESS-TSAADSU.                                           06800008
068100******************************************************************06810008
068200 3000-PROCESS-TSAADSU.                                            06820008
068300                                                                  06830008
068400     SET PS-NO-CODE-FOUND TO TRUE.                                06840008
068500                                                                  06850008
PRB707     IF SAADSU-SUM-CTG-CDE = 'POS'                                06860011
PRB707        OR SAADSU-SUM-CTG-CDE = 'POR'                             06870011
PRB707         SET TT-INDEX TO PC-PO-INDEX                              06880011
PRB707         ADD SAADSU-ADJ-AMT TO TT-CASH-SLS-AMT(TT-INDEX)          06890011
PRB707     ELSE                                                         06900011
069100         PERFORM 3100-FIND-CODE                                   06910009
069200             VARYING PV-SUB FROM 1 BY 1                           06920009
069300                 UNTIL PS-CODE-FOUND                              06930009
PRB707                    OR PV-SUB GREATER THAN PV-MAX-CODES           06940011
PRB707     END-IF.                                                      06950011
069600                                                                  06960008
069700     PERFORM 8100-FETCH-SUMMARY-CURSOR.                           06970008
069800                                                                  06980008
069900******************************************************************06990008
070000* 3100-FIND-CODE.                                                 07000008
070100******************************************************************07010008
070200 3100-FIND-CODE.                                                  07020008
070300                                                                  07030008
070400     IF SAADSU-SUM-CTG-CDE = CE-CODE(PV-SUB)                      07040008
070500         SET PS-CODE-FOUND TO TRUE                                07050008
070600         SET TT-INDEX TO PV-SUB                                   07060008
070700         MOVE SAADSU-ADJ-AMT TO TT-CASH-SLS-AMT(TT-INDEX)         07070008
070800     END-IF.                                                      07080008
070900                                                                  07090008
071000******************************************************************07100008
071100* 4000-PROCESS-TSASUM.                                            07110008
071200******************************************************************07120008
071300 4000-PROCESS-TSASUM.                                             07130008
071400                                                                  07140008
071500     IF SASUM-SUM-TYP-CDE = 'D'                                   07150008
071600         PERFORM 4100-PROCESS-DAILY-SALES                         07160008
071700     ELSE                                                         07170008
071800        IF SASUM-SUM-TYP-CDE = 'S'                                07180008
071900           PERFORM 4200-PROCESS-SLS-CORR                          07190008
072000        END-IF                                                    07200008
072100     END-IF.                                                      07210008
072200                                                                  07220008
072300     PERFORM 8400-FETCH-TSASUM-CURSOR.                            07230008
072400                                                                  07240008
072500******************************************************************07250008
072600* 4100-PROCESS-DAILY-SALES.                                       07260008
072700******************************************************************07270008
072800 4100-PROCESS-DAILY-SALES.                                        07280008
072900                                                                  07290008
073000      IF SASUM-SUM-CTG-CDE = 'GDS'                                07300008
073100         SET TT-INDEX             TO PC-GIFT-CRD-SLD-INDEX        07310008
073200         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07320008
073300         SET TT-INDEX             TO PC-STM-INDEX                 07330008
073400         SUBTRACT PV-SLS-RET-AMT FROM TT-DAILY-SLS-AMT(TT-INDEX)  07340008
073500      END-IF.                                                     07350008
073600                                                                  07360008
073700      IF SASUM-SUM-CTG-CDE = 'TPC'                                07370008
073800         SET TT-INDEX             TO PC-TPC-SALES-INDEX           07380008
073900         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07390008
074000         SET TT-INDEX             TO PC-STM-INDEX                 07400008
074100         SUBTRACT PV-SLS-RET-AMT FROM TT-DAILY-SLS-AMT(TT-INDEX)  07410008
074200      END-IF.                                                     07420008
074300                                                                  07430008
074400      IF SASUM-SUM-CTG-CDE = 'GDT'                                07440008
074500         SET TT-INDEX             TO PC-GIFT-CRD-TND-INDEX        07450008
074600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07460008
074700      END-IF.                                                     07470008
074800                                                                  07480008
074900      IF SASUM-SUM-CTG-CDE = 'BCS'                                07490008
075000         SET TT-INDEX             TO PC-BANKCARD-INDEX            07500008
075100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07510008
075200      END-IF.                                                     07520008
075300                                                                  07530008
075400      IF SASUM-SUM-CTG-CDE = 'BCR'                                07540008
075500         SET TT-INDEX             TO PC-BANKCARD-INDEX            07550008
075600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07560008
075700      END-IF.                                                     07570008
075800                                                                  07580008
075900      IF SASUM-SUM-CTG-CDE = 'KCS'                                07590008
076000         SET TT-INDEX             TO PC-KOHLS-CHARGE-INDEX        07600008
076100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07610008
076200      END-IF.                                                     07620008
076300                                                                  07630008
076400      IF SASUM-SUM-CTG-CDE = 'KCR'                                07640008
076500         SET TT-INDEX             TO PC-KOHLS-CHARGE-INDEX        07650008
076600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07660008
076700      END-IF.                                                     07670008
076800                                                                  07680008
076900      IF SASUM-SUM-CTG-CDE = 'KCP'                                07690008
077000         SET TT-INDEX             TO PC-KOHLS-PYMT-INDEX          07700008
077100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07710008
077200      END-IF.                                                     07720008
077300                                                                  07730008
077400      IF SASUM-SUM-CTG-CDE = 'NCS'                                07740008
077500         SET TT-INDEX             TO PC-NOVUS-INDEX               07750008
077600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07760008
077700      END-IF.                                                     07770008
077800                                                                  07780008
077900      IF SASUM-SUM-CTG-CDE = 'NCR'                                07790008
078000         SET TT-INDEX             TO PC-NOVUS-INDEX               07800008
078100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07810008
078200      END-IF                                                      07820008
078300                                                                  07830008
078400      IF SASUM-SUM-CTG-CDE = 'AXS'                                07840008
078500         SET TT-INDEX             TO PC-AMEX-INDEX                07850008
078600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07860008
078700      END-IF.                                                     07870008
078800                                                                  07880008
078900      IF SASUM-SUM-CTG-CDE = 'AXR'                                07890008
079000         SET TT-INDEX             TO PC-AMEX-INDEX                07900008
079100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   07910008
079200      END-IF.                                                     07920008
079300                                                                  07930008
079400      IF SASUM-SUM-CTG-CDE = 'DBS'                                07940008
079500          SET TT-INDEX            TO PC-DEBIT-INDEX               07950008
079600          ADD PV-SLS-RET-AMT      TO TT-DAILY-SLS-AMT(TT-INDEX)   07960008
079700      END-IF.                                                     07970008
079800                                                                  07980008
079900      IF SASUM-SUM-CTG-CDE = 'DBR'                                07990008
080000          SET TT-INDEX            TO PC-DEBIT-INDEX               08000008
080100          ADD PV-SLS-RET-AMT      TO TT-DAILY-SLS-AMT(TT-INDEX)   08010008
080200      END-IF.                                                     08020008
080300                                                                  08030008
080400      IF SASUM-SUM-CTG-CDE = 'KMI'                                08040008
080500         SET TT-INDEX             TO PC-KMRC-ISSUED-INDEX         08050008
080600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08060008
080700      END-IF.                                                     08070008
080800                                                                  08080008
080900      IF SASUM-SUM-CTG-CDE = 'KMT'                                08090008
081000         SET TT-INDEX             TO PC-KMRC-TEND-INDEX           08100008
081100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08110008
081200      END-IF.                                                     08120008
081300                                                                  08130008
081900      IF SASUM-SUM-CTG-CDE = 'SAL'                                08190008
082000         SET TT-INDEX             TO PC-STM-INDEX                 08200008
082100         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08210008
082200      END-IF.                                                     08220008
082300                                                                  08230008
082400      IF SASUM-SUM-CTG-CDE = 'TAX'                                08240008
082500         SET TT-INDEX             TO PC-TAX-INDEX                 08250008
082600         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08260008
082700         SET TT-INDEX             TO PC-STM-INDEX                 08270008
082800         SUBTRACT PV-SLS-RET-AMT                                  08280008
082900                                FROM TT-DAILY-SLS-AMT(TT-INDEX)   08290008
083000      END-IF.                                                     08300008
083100                                                                  08310008
083200      IF SASUM-SUM-CTG-CDE = 'GTS'                                08320008
083300         SET TT-INDEX             TO PC-STM-INDEX                 08330008
083400         SUBTRACT PV-SLS-RET-AMT FROM TT-DAILY-SLS-AMT(TT-INDEX)  08340008
083500      END-IF.                                                     08350008
083600                                                                  08360008
PRB707      IF SASUM-SUM-CTG-CDE = 'CRI'                                08370011
PRB707          SET TT-INDEX            TO PC-CRI-INDEX                 08380011
PRB707          ADD PV-SLS-RET-AMT      TO TT-DAILY-SLS-AMT(TT-INDEX)   08390011
PRB707      END-IF.                                                     08400011
PRB707                                                                  08410011
PRB707      IF SASUM-SUM-CTG-CDE = 'POS'                                08420011
PRB707         SET TT-INDEX             TO PC-PO-INDEX                  08430011
PRB707         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08440011
PRB707      END-IF.                                                     08450011
PRB707                                                                  08460011
PRB707      IF SASUM-SUM-CTG-CDE = 'POR'                                08470011
PRB707         SET TT-INDEX             TO PC-PO-INDEX                  08480011
PRB707         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08490011
PRB707      END-IF.                                                     08500011
SEPHOR                                                                  08510013
SEPHOR      IF SASUM-SUM-CTG-CDE = 'SCS'                                08511015
SEPHOR         SET TT-INDEX             TO PC-SEPHORA-INDEX             08512015
SEPHOR         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08513013
SEPHOR      END-IF.                                                     08514013
SEPHOR                                                                  08514115
SEPHOR      IF SASUM-SUM-CTG-CDE = 'SCR'                                08514215
SEPHOR         SET TT-INDEX             TO PC-SEPHORA-INDEX             08514316
SEPHOR         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08514415
SEPHOR      END-IF.                                                     08514515
PAYVEN                                                                  08514623
PAYVEN      IF SASUM-SUM-CTG-CDE = 'PPS'                                08514723
PAYVEN         SET TT-INDEX             TO PC-PAYPAL-INDEX              08514823
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08514923
PAYVEN      END-IF.                                                     08515023
PAYVEN                                                                  08515123
PAYVEN      IF SASUM-SUM-CTG-CDE = 'PPR'                                08515223
PAYVEN         SET TT-INDEX             TO PC-PAYPAL-INDEX              08515323
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08515423
PAYVEN      END-IF.                                                     08515523
PAYVEN                                                                  08515623
PAYVEN      IF SASUM-SUM-CTG-CDE = 'VMS'                                08515723
PAYVEN         SET TT-INDEX             TO PC-VENMO-INDEX               08515823
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08515923
PAYVEN      END-IF.                                                     08516023
PAYVEN                                                                  08516123
PAYVEN      IF SASUM-SUM-CTG-CDE = 'VMR'                                08516223
PAYVEN         SET TT-INDEX             TO PC-VENMO-INDEX               08516323
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-DAILY-SLS-AMT(TT-INDEX)   08516423
PAYVEN      END-IF.                                                     08516523
085100                                                                  08517023
085200******************************************************************08520008
085300* 4200-PROCESS-SLS-CORR                                           08530008
085400******************************************************************08540008
085500 4200-PROCESS-SLS-CORR.                                           08550008
085600                                                                  08560008
085700      IF SASUM-SUM-CTG-CDE = 'GDS'                                08570008
085800         SET TT-INDEX             TO PC-GIFT-CRD-SLD-INDEX        08580008
085900         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08590008
086000         SET TT-INDEX             TO PC-STM-INDEX                 08600008
086100         SUBTRACT PV-SLS-RET-AMT FROM TT-SLS-CORR-AMT(TT-INDEX)   08610008
086200      END-IF.                                                     08620008
086300                                                                  08630008
086400      IF SASUM-SUM-CTG-CDE = 'TPC'                                08640008
086500         SET TT-INDEX             TO PC-TPC-SALES-INDEX           08650008
086600         ADD PV-SLS-RET-AMT TO TT-SLS-CORR-AMT(TT-INDEX)          08660008
086700         SET TT-INDEX             TO PC-STM-INDEX                 08670008
086800         SUBTRACT PV-SLS-RET-AMT FROM TT-SLS-CORR-AMT(TT-INDEX)   08680008
086900      END-IF.                                                     08690008
087000                                                                  08700008
087100      IF SASUM-SUM-CTG-CDE = 'GDT'                                08710008
087200         SET TT-INDEX             TO PC-GIFT-CRD-TND-INDEX        08720008
087300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08730008
087400      END-IF.                                                     08740008
087500                                                                  08750008
087600      IF SASUM-SUM-CTG-CDE = 'BCS'                                08760008
087700         SET TT-INDEX             TO PC-BANKCARD-INDEX            08770008
087800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08780008
087900      END-IF.                                                     08790008
088000                                                                  08800008
088100      IF SASUM-SUM-CTG-CDE = 'BCR'                                08810008
088200         SET TT-INDEX             TO PC-BANKCARD-INDEX            08820008
088300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08830008
088400      END-IF.                                                     08840008
088500                                                                  08850008
088600      IF SASUM-SUM-CTG-CDE = 'KCS'                                08860008
088700         SET TT-INDEX             TO PC-KOHLS-CHARGE-INDEX        08870008
088800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08880008
088900      END-IF.                                                     08890008
089000                                                                  08900008
089100      IF SASUM-SUM-CTG-CDE = 'KCR'                                08910008
089200         SET TT-INDEX             TO PC-KOHLS-CHARGE-INDEX        08920008
089300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08930008
089400      END-IF.                                                     08940008
089500                                                                  08950008
089600      IF SASUM-SUM-CTG-CDE = 'KCP'                                08960008
089700         SET TT-INDEX             TO PC-KOHLS-PYMT-INDEX          08970008
089800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    08980008
089900      END-IF.                                                     08990008
090000                                                                  09000008
090100      IF SASUM-SUM-CTG-CDE = 'NCS'                                09010008
090200         SET TT-INDEX             TO PC-NOVUS-INDEX               09020008
090300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09030008
090400      END-IF.                                                     09040008
090500                                                                  09050008
090600      IF SASUM-SUM-CTG-CDE = 'NCR'                                09060008
090700         SET TT-INDEX             TO PC-NOVUS-INDEX               09070008
090800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09080008
090900      END-IF                                                      09090008
091000                                                                  09100008
091100      IF SASUM-SUM-CTG-CDE = 'AXS'                                09110008
091200         SET TT-INDEX             TO PC-AMEX-INDEX                09120008
091300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09130008
091400      END-IF.                                                     09140008
091500                                                                  09150008
091600      IF SASUM-SUM-CTG-CDE = 'AXR'                                09160008
091700         SET TT-INDEX             TO PC-AMEX-INDEX                09170008
091800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09180008
091900      END-IF.                                                     09190008
092000                                                                  09200008
092100      IF SASUM-SUM-CTG-CDE = 'DBS'                                09210008
092200          SET TT-INDEX            TO PC-DEBIT-INDEX               09220008
092300          ADD PV-SLS-RET-AMT      TO TT-SLS-CORR-AMT(TT-INDEX)    09230008
092400      END-IF.                                                     09240008
092500                                                                  09250008
092600      IF SASUM-SUM-CTG-CDE = 'DBR'                                09260008
092700          SET TT-INDEX            TO PC-DEBIT-INDEX               09270008
092800          ADD PV-SLS-RET-AMT      TO TT-SLS-CORR-AMT(TT-INDEX)    09280008
092900      END-IF.                                                     09290008
093000                                                                  09300008
093100      IF SASUM-SUM-CTG-CDE = 'KMI'                                09310008
093200         SET TT-INDEX             TO PC-KMRC-ISSUED-INDEX         09320008
093300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09330008
093400      END-IF.                                                     09340008
093500                                                                  09350008
093600      IF SASUM-SUM-CTG-CDE = 'KMT'                                09360008
093700         SET TT-INDEX             TO PC-KMRC-TEND-INDEX           09370008
093800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09380008
093900      END-IF.                                                     09390008
094000                                                                  09400008
094600      IF SASUM-SUM-CTG-CDE = 'SAL'                                09460008
094700         SET TT-INDEX             TO PC-STM-INDEX                 09470008
094800         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09480008
094900      END-IF.                                                     09490008
095000                                                                  09500008
095100      IF SASUM-SUM-CTG-CDE = 'TAX'                                09510008
095200         SET TT-INDEX             TO PC-TAX-INDEX                 09520008
095300         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09530008
095400         SET TT-INDEX         TO PC-STM-INDEX                     09540008
095500         SUBTRACT PV-SLS-RET-AMT                                  09550008
095600                                FROM TT-SLS-CORR-AMT(TT-INDEX)    09560008
095700      END-IF.                                                     09570008
095800                                                                  09580008
095900      IF SASUM-SUM-CTG-CDE = 'RTX'                                09590008
096000         SET TT-INDEX         TO PC-STM-INDEX                     09600008
096100         ADD PV-SLS-RET-AMT   TO TT-SLS-CORR-AMT(TT-INDEX)        09610008
096200      END-IF.                                                     09620008
096300                                                                  09630008
096400      IF SASUM-SUM-CTG-CDE = 'GTS'                                09640008
096500         SET TT-INDEX             TO PC-STM-INDEX                 09650008
096600         SUBTRACT PV-SLS-RET-AMT FROM TT-SLS-CORR-AMT(TT-INDEX)   09660008
PRB707      END-IF.                                                     09670011
PRB707                                                                  09680011
PRB707      IF SASUM-SUM-CTG-CDE = 'CRI'                                09690011
PRB707          SET TT-INDEX            TO PC-CRI-INDEX                 09700011
PRB707          ADD PV-SLS-RET-AMT      TO TT-SLS-CORR-AMT(TT-INDEX)    09710011
PRB707      END-IF.                                                     09720011
PRB707                                                                  09730011
PRB707      IF SASUM-SUM-CTG-CDE = 'POS'                                09740011
PRB707         SET TT-INDEX             TO PC-PO-INDEX                  09750011
PRB707         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09760011
PRB707      END-IF.                                                     09770011
PRB707                                                                  09780011
PRB707      IF SASUM-SUM-CTG-CDE = 'POR'                                09790011
PRB707         SET TT-INDEX             TO PC-PO-INDEX                  09800011
PRB707         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09810011
PRB707      END-IF.                                                     09820011
SEPHOR                                                                  09830013
SEPHOR      IF SASUM-SUM-CTG-CDE = 'SCS'                                09834115
SEPHOR         SET TT-INDEX             TO PC-SEPHORA-INDEX             09834215
SEPHOR         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09834315
SEPHOR      END-IF.                                                     09834415
SEPHOR                                                                  09834515
SEPHOR      IF SASUM-SUM-CTG-CDE = 'SCR'                                09834615
SEPHOR         SET TT-INDEX             TO PC-SEPHORA-INDEX             09834715
SEPHOR         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09834815
SEPHOR      END-IF.                                                     09834915
PAYVEN                                                                  09835023
PAYVEN      IF SASUM-SUM-CTG-CDE = 'PPS'                                09835123
PAYVEN         SET TT-INDEX             TO PC-PAYPAL-INDEX              09835223
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09835323
PAYVEN      END-IF.                                                     09835423
PAYVEN                                                                  09835523
PAYVEN      IF SASUM-SUM-CTG-CDE = 'PPR'                                09835623
PAYVEN         SET TT-INDEX             TO PC-PAYPAL-INDEX              09835723
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09835823
PAYVEN      END-IF.                                                     09835923
PAYVEN                                                                  09836023
PAYVEN      IF SASUM-SUM-CTG-CDE = 'VMS'                                09836123
PAYVEN         SET TT-INDEX             TO PC-VENMO-INDEX               09836223
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09836323
PAYVEN      END-IF.                                                     09836423
PAYVEN                                                                  09836523
PAYVEN      IF SASUM-SUM-CTG-CDE = 'VMR'                                09836623
PAYVEN         SET TT-INDEX             TO PC-VENMO-INDEX               09836723
PAYVEN         ADD PV-SLS-RET-AMT       TO TT-SLS-CORR-AMT(TT-INDEX)    09836823
PAYVEN      END-IF.                                                     09836923
088500                                                                  09837023
098500******************************************************************09850008
098600* 5000-COMPUTE-VARIANCE                                           09860008
098700*     COMPUTE VARIANCE FOR EACH LINE IN TOTALS TABLE.             09870008
098800******************************************************************09880008
098900 5000-COMPUTE-VARIANCE.                                           09890008
099000                                                                  09900008
SEPHOR     COMPUTE TT-VARIANCE-AMT(PV-SUB) = (TT-DAILY-SLS-AMT(PV-SUB)  09940021
SEPHOR                                     + TT-SLS-CORR-AMT(PV-SUB))   09960019
SEPHOR                                     - TT-CASH-SLS-AMT(PV-SUB).   09970019
099800                                                                  09980008
099900     IF TT-VARIANCE-AMT(PV-SUB) NOT EQUAL 0                       09990008
100000         SET PS-VARIANCE-FOUND TO TRUE.                           10000008
100100 EJECT                                                            10010008
100200******************************************************************10020008
100300* 6000-PRINT-TABLE                                                10030008
100400*     PRINT THE ENTRIES IN THE TABLE IF ANY VARIANCE              10040008
100500******************************************************************10050008
100600 6000-PRINT-TABLE.                                                10060008
100700                                                                  10070008
100800     IF PV-LINE-CNT GREATER THAN PC-LINE-LIMIT                    10080008
100900         PERFORM 9000-HEADER-ROUTINE                              10090008
101000     ELSE                                                         10100008
101100         IF PV-SAVE-STR-NBR NOT EQUAL PV-SAVE-STR-PRT             10110008
101200             PERFORM 9000-HEADER-ROUTINE                          10120008
101300         END-IF                                                   10130008
101400     END-IF.                                                      10140008
101500                                                                  10150008
101600     PERFORM 6100-PRINT-DETAIL                                    10160008
101700         VARYING PV-SUB FROM 1 BY 1                               10170008
101800             UNTIL PV-SUB GREATER THAN PV-MAX-CODES.              10180008
101900                                                                  10190008
102000     MOVE SPACES                   TO PV-PRINT-RECORD.            10200008
102100     MOVE +1                       TO PV-LINE-SPACING.            10210008
102200     PERFORM 9900-WRITE-REPORT-LINE.                              10220008
102300 EJECT                                                            10230008
102400******************************************************************10240008
102500* 6100-PRINT-DETAIL                                               10250008
102600*     PRINT THE ENTRIES IN THE TABLE                              10260008
102700******************************************************************10270008
102800 6100-PRINT-DETAIL.                                               10280008
102900                                                                  10290008
103000     IF PV-SUB = 1                                                10300008
103100         MOVE PV-SAVE-STR-NBR TO DTL1-STORE                       10310008
103200         MOVE PV-SAVE-SLS-DTE TO PV-POS-CCYY-MM-DD                10320008
103300         MOVE PV-POS-CCYY     TO PV-HEADER-CCYY                   10330008
103400         MOVE PV-POS-MM       TO PV-HEADER-MM                     10340008
103500         MOVE PV-POS-DD       TO PV-HEADER-DD                     10350008
103600         MOVE PV-HEADER-DATE  TO DTL1-SLS-DTE                     10360008
103700     ELSE                                                         10370008
103800         MOVE SPACES          TO DTL1-STORE                       10380008
103900                                 DTL1-SLS-DTE.                    10390008
104000                                                                  10400008
104100     MOVE CE-DESCRIPTION(PV-SUB)   TO DTL1-TENDER-DESC.           10410008
104200     MOVE TT-DAILY-SLS-AMT(PV-SUB) TO DTL1-DAILY-SLS.             10420008
104300     MOVE TT-SLS-CORR-AMT(PV-SUB)  TO DTL1-SLS-CORR.              10430008
104400     MOVE TT-LATE-SLS-AMT(PV-SUB)  TO DTL1-LATE-SLS.              10440008
104500     MOVE TT-CASH-SLS-AMT(PV-SUB)  TO DTL1-CASH-SLS.              10450008
104600     MOVE TT-VARIANCE-AMT(PV-SUB)  TO DTL1-VARIANCE.              10460008
104700                                                                  10470008
104800     MOVE D1-DETAIL-LINE-1         TO PV-PRINT-RECORD.            10480008
104900     MOVE +1                       TO PV-LINE-SPACING.            10490008
105000     PERFORM 9900-WRITE-REPORT-LINE.                              10500008
105100                                                                  10510008
105200******************************************************************10520008
105300* 7000-ACCUM-TOTALS                                               10530008
105400*     ACCUMULATE TOTALS FOR ALL STORES FOR THE WEEK               10540008
105500******************************************************************10550008
105600 7000-ACCUM-TOTALS.                                               10560008
105700                                                                  10570008
105800     COMPUTE CT-DAILY-SLS-AMT(PV-SUB) = CT-DAILY-SLS-AMT(PV-SUB)  10580008
105900                                      + TT-DAILY-SLS-AMT(PV-SUB). 10590008
106000     COMPUTE CT-SLS-CORR-AMT(PV-SUB)  = CT-SLS-CORR-AMT(PV-SUB)   10600008
106100                                      + TT-SLS-CORR-AMT(PV-SUB).  10610008
106200     COMPUTE CT-LATE-SLS-AMT(PV-SUB)  = CT-LATE-SLS-AMT(PV-SUB)   10620008
106300                                      + TT-LATE-SLS-AMT(PV-SUB).  10630008
106400     COMPUTE CT-CASH-SLS-AMT(PV-SUB)  = CT-CASH-SLS-AMT(PV-SUB)   10640008
106500                                      + TT-CASH-SLS-AMT(PV-SUB).  10650008
106600     COMPUTE CT-VARIANCE-AMT(PV-SUB)  = CT-VARIANCE-AMT(PV-SUB)   10660008
106700                                      + TT-VARIANCE-AMT(PV-SUB).  10670008
106800******************************************************************10680008
106900* 7100-PRINT-TOTALS                                               10690008
107000*     ACCUMULATE TOTALS FOR ALL STORES FOR THE WEEK               10700008
107100******************************************************************10710008
107200 7100-PRINT-TOTALS.                                               10720008
107300                                                                  10730008
107400     PERFORM 9000-HEADER-ROUTINE.                                 10740008
107500                                                                  10750008
107600     PERFORM 7200-PRINT-TOTAL-LINES                               10760008
107700         VARYING PV-SUB FROM 1 BY 1                               10770008
107800             UNTIL PV-SUB GREATER THAN PV-MAX-CODES.              10780008
107900                                                                  10790008
108000******************************************************************10800008
108100* 7200-PRINT-TOTAL-LINES.                                         10810008
108200*     PRINT TOTAL PAGE                                            10820008
108300******************************************************************10830008
108400 7200-PRINT-TOTAL-LINES.                                          10840008
108500                                                                  10850008
108600     IF PV-SUB = 1                                                10860008
108700         MOVE SPACES          TO DTL1-STORE                       10870008
108800         MOVE PC-ALL-STORES   TO DTL1-SLS-DTE                     10880008
108900     ELSE                                                         10890008
109000         MOVE SPACES          TO DTL1-STORE                       10900008
109100                                 DTL1-SLS-DTE.                    10910008
109200                                                                  10920008
109300     MOVE CE-DESCRIPTION(PV-SUB)   TO DTL1-TENDER-DESC.           10930008
109400     MOVE CT-DAILY-SLS-AMT(PV-SUB) TO DTL1-DAILY-SLS.             10940008
109500     MOVE CT-SLS-CORR-AMT(PV-SUB)  TO DTL1-SLS-CORR.              10950008
109600     MOVE CT-LATE-SLS-AMT(PV-SUB)  TO DTL1-LATE-SLS.              10960008
109700     MOVE CT-CASH-SLS-AMT(PV-SUB)  TO DTL1-CASH-SLS.              10970008
109800     MOVE CT-VARIANCE-AMT(PV-SUB)  TO DTL1-VARIANCE.              10980008
109900                                                                  10990008
110000     MOVE D1-DETAIL-LINE-1         TO PV-PRINT-RECORD.            11000008
110100     MOVE +1                       TO PV-LINE-SPACING.            11010008
110200     PERFORM 9900-WRITE-REPORT-LINE.                              11020008
110300                                                                  11030008
110400******************************************************************11040008
110500* 8000-OPEN-SUMMARY-CURSOR.                                       11050008
110600*     OPEN SUMMARY CURSOR                                         11060008
110700******************************************************************11070008
110800 8000-OPEN-SUMMARY-CURSOR.                                        11080008
110900                                                                  11090008
111000     EXEC SQL                                                     11100008
111100          OPEN SUMMARY-CURSOR                                     11110008
111200     END-EXEC.                                                    11120008
111300                                                                  11130008
111400     EVALUATE TRUE                                                11140008
111500         WHEN SQLCODE = ZERO                                      11150008
111600              CONTINUE                                            11160008
111700         WHEN SQLWARN0 NOT EQUAL SPACE                            11170008
111800         WHEN SQLCODE NOT EQUAL ZERO                              11180008
111900             MOVE '8000-OPEN-SUMMARY-CURSOR'                      11190008
112000                                            TO PV-PARAGRAPH-NAME  11200008
112100             MOVE 'ERROR ON OPEN OF SUMMARY-CURSOR'               11210008
112200                                            TO PV-DB2-OPERATION   11220008
112300             PERFORM 9100-SQL-ABEND                               11230008
112400     END-EVALUATE.                                                11240008
112500                                                                  11250008
112600     INITIALIZE TOTALS-TABLE.                                     11260008
112700 EJECT                                                            11270008
112800******************************************************************11280008
112900* 8100-FETCH-SUMMARY-CURSOR                                       11290008
113000******************************************************************11300008
113100 8100-FETCH-SUMMARY-CURSOR.                                       11310008
113200                                                                  11320008
113300     EXEC SQL                                                     11330008
113400          FETCH SUMMARY-CURSOR                                    11340008
113500           INTO :SAADSU-STR-NBR                                   11350008
113600               ,:SAADSU-SLS-DTE                                   11360008
113700               ,:SAADSU-SUM-CTG-CDE                               11370008
113800               ,:SAADSU-ADJ-AMT                                   11380008
113900               ,:SAADSU-ADJ-IND                                   11390008
114000     END-EXEC.                                                    11400008
114100                                                                  11410008
114200     EVALUATE TRUE                                                11420008
114300         WHEN SQLCODE = ZERO                                      11430008
114400             CONTINUE                                             11440008
114500         WHEN SQLCODE = PC-ROW-NOT-FOUND                          11450008
114600             SET PS-END-OF-ADSU-CURSOR TO TRUE                    11460008
114700         WHEN SQLWARN0 NOT EQUAL SPACE                            11470008
114800         WHEN SQLCODE NOT EQUAL ZERO                              11480008
114900             MOVE '8100-FETCH-SUMMARY-CURSOR'                     11490008
115000                                            TO PV-PARAGRAPH-NAME  11500008
115100             MOVE 'ERROR ON FETCH OF SUMMARY-CURSOR'              11510008
115200                                            TO PV-DB2-OPERATION   11520008
115300             PERFORM 9100-SQL-ABEND                               11530008
115400     END-EVALUATE.                                                11540008
115500                                                                  11550008
115600 EJECT                                                            11560008
115700******************************************************************11570008
115800* 8200-CLOSE-SUMMARY-CURSOR                                       11580008
115900******************************************************************11590008
116000 8200-CLOSE-SUMMARY-CURSOR.                                       11600008
116100                                                                  11610008
116200     EXEC SQL                                                     11620008
116300          CLOSE SUMMARY-CURSOR                                    11630008
116400     END-EXEC.                                                    11640008
116500                                                                  11650008
116600     EVALUATE TRUE                                                11660008
116700         WHEN SQLCODE = ZERO                                      11670008
116800              CONTINUE                                            11680008
116900         WHEN SQLWARN0 NOT EQUAL SPACE                            11690008
117000         WHEN SQLCODE NOT EQUAL ZERO                              11700008
117100             MOVE '8200-CLOSE-SUMMARY-CURSOR'                     11710008
117200                                            TO PV-PARAGRAPH-NAME  11720008
117300             MOVE 'ERROR ON CLOSE OF SUMMARY-CURSOR'              11730008
117400                                            TO PV-DB2-OPERATION   11740008
117500             PERFORM 9100-SQL-ABEND                               11750008
117600     END-EVALUATE.                                                11760008
117700 EJECT                                                            11770008
117800******************************************************************11780008
117900* 8300-OPEN-TSASUM-CURSOR.                                        11790008
118000******************************************************************11800008
118100 8300-OPEN-TSASUM-CURSOR.                                         11810008
118200                                                                  11820008
118300     EXEC SQL                                                     11830008
118400          OPEN TSASUM-CURSOR                                      11840008
118500     END-EXEC.                                                    11850008
118600                                                                  11860008
118700     EVALUATE TRUE                                                11870008
118800         WHEN SQLCODE = ZERO                                      11880008
118900              CONTINUE                                            11890008
119000         WHEN SQLWARN0 NOT EQUAL SPACE                            11900008
119100         WHEN SQLCODE NOT EQUAL ZERO                              11910008
119200             MOVE '8300-OPEN-TSASUM-CURSOR'                       11920008
119300                                            TO PV-PARAGRAPH-NAME  11930008
119400             MOVE 'ERROR ON OPEN OF TSASUM-CURSOR'                11940008
119500                                            TO PV-DB2-OPERATION   11950008
119600             PERFORM 9100-SQL-ABEND                               11960008
119700     END-EVALUATE.                                                11970008
119800 EJECT                                                            11980008
119900******************************************************************11990008
120000* 8400-FETCH-TSASUM-CURSOR                                        12000008
120100******************************************************************12010008
120200 8400-FETCH-TSASUM-CURSOR.                                        12020008
120300                                                                  12030008
120400     EXEC SQL                                                     12040008
120500          FETCH TSASUM-CURSOR                                     12050008
120600           INTO :SASUM-SUM-TYP-CDE                                12060008
120700               ,:SASUM-SUM-CTG-CDE                                12070008
120800               ,:PV-SLS-RET-AMT                                   12080008
120900     END-EXEC.                                                    12090008
121000                                                                  12100008
121100     EVALUATE TRUE                                                12110008
121200         WHEN SQLCODE = ZERO                                      12120008
121300             CONTINUE                                             12130008
121400         WHEN SQLCODE = PC-ROW-NOT-FOUND                          12140008
121500             SET PS-END-OF-SUM-CURSOR TO TRUE                     12150008
121600         WHEN SQLWARN0 NOT EQUAL SPACE                            12160008
121700         WHEN SQLCODE NOT EQUAL ZERO                              12170008
121800             MOVE '8400-FETCH-SUM-CURSOR'                         12180008
121900                                            TO PV-PARAGRAPH-NAME  12190008
122000             MOVE 'ERROR ON FETCH OF TSASUM-CURSOR'               12200008
122100                                            TO PV-DB2-OPERATION   12210008
122200             PERFORM 9100-SQL-ABEND                               12220008
122300     END-EVALUATE.                                                12230008
122400                                                                  12240008
122500 EJECT                                                            12250008
122600******************************************************************12260008
122700* 8500-CLOSE-TSASUM-CURSOR                                        12270008
122800******************************************************************12280008
122900 8500-CLOSE-TSASUM-CURSOR.                                        12290008
123000                                                                  12300008
123100     EXEC SQL                                                     12310008
123200          CLOSE TSASUM-CURSOR                                     12320008
123300     END-EXEC.                                                    12330008
123400                                                                  12340008
123500     EVALUATE TRUE                                                12350008
123600         WHEN SQLCODE = ZERO                                      12360008
123700              CONTINUE                                            12370008
123800         WHEN SQLWARN0 NOT EQUAL SPACE                            12380008
123900         WHEN SQLCODE NOT EQUAL ZERO                              12390008
124000             MOVE '8500-CLOSE-TSASUM-CURSOR'                      12400008
124100                                            TO PV-PARAGRAPH-NAME  12410008
124200             MOVE 'ERROR ON CLOSE OF TSASUM-CURSOR'               12420008
124300                                            TO PV-DB2-OPERATION   12430008
124400             PERFORM 9100-SQL-ABEND                               12440008
124500     END-EVALUATE.                                                12450008
124600 EJECT                                                            12460008
124700******************************************************************12470008
124800* 9000-HEADER-ROUTINE                                             12480008
124900*     PRINT THE HEADINGS FOR THE REPORT.                          12490008
125000******************************************************************12500008
125100                                                                  12510008
125200 9000-HEADER-ROUTINE.                                             12520008
125300                                                                  12530008
125400     ADD +1                      TO PV-PAGE-CNT.                  12540008
125500     MOVE PV-PAGE-CNT TO DP132-PAGE-NUMBER.                       12550008
125600     MOVE DP132-STANDRD-HEADER-132-COLS                           12560008
125700                                 TO PV-PRINT-RECORD.              12570008
125800     PERFORM 9800-WRITE-RPT-TOP-OF-PAGE.                          12580008
125900                                                                  12590008
126000     MOVE H2-HEADING-LINE-2      TO PV-PRINT-RECORD.              12600008
126100     MOVE +1                     TO PV-LINE-SPACING.              12610008
126200     PERFORM 9900-WRITE-REPORT-LINE.                              12620008
126300                                                                  12630008
126400     MOVE H3-HEADING-LINE-3      TO PV-PRINT-RECORD.              12640008
126500     MOVE +1                     TO PV-LINE-SPACING.              12650008
126600     PERFORM 9900-WRITE-REPORT-LINE.                              12660008
126700                                                                  12670008
126800     MOVE H4-HEADING-LINE-4      TO PV-PRINT-RECORD.              12680008
126900     MOVE +2                     TO PV-LINE-SPACING.              12690008
127000     PERFORM 9900-WRITE-REPORT-LINE.                              12700008
127100                                                                  12710008
127200     MOVE PV-SAVE-STR-NBR        TO PV-SAVE-STR-PRT.              12720008
127300 EJECT                                                            12730008
127400******************************************************************12740008
127500* 9800-WRITE-RPT-TOP-OF-PAGE                                      12750008
127600*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   12760008
127700******************************************************************12770008
127800 9800-WRITE-RPT-TOP-OF-PAGE.                                      12780008
127900                                                                  12790008
128000     WRITE SUMMARY-REPORT-RECORD                                  12800008
128100       FROM PV-PRINT-RECORD                                       12810008
128200         AFTER ADVANCING PAGE.                                    12820008
128300     MOVE PV-LINE-CNT-AHEAD TO PV-LINE-CNT.                       12830008
128400 EJECT                                                            12840008
128500******************************************************************12850008
128600* 9900-WRITE-REPORT-LINE                                          12860008
128700*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             12870008
128800******************************************************************12880008
128900 9900-WRITE-REPORT-LINE.                                          12890008
129000                                                                  12900008
129100     WRITE SUMMARY-REPORT-RECORD                                  12910008
129200       FROM PV-PRINT-RECORD                                       12920008
129300         AFTER ADVANCING PV-LINE-SPACING.                         12930008
129400                                                                  12940008
129500     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          12950008
129600 EJECT                                                            12960008
129700******************************************************************12970008
129800* 9100-SQL-ABEND                                                  12980008
129900*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.12990008
130000******************************************************************13000008
130100 9100-SQL-ABEND.                                                  13010008
130200     DISPLAY '** ABEND     **'.                                   13020008
130300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        13030008
130400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              13040008
130500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               13050008
130600                                                                  13060008
130700******************************************************************13070008
130800* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     13080008
130900* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      13090008
131000******************************************************************13100008
131100     COPY DPPD004.                                                13110008
131200                                                                  13120008
131300     SET AC-DB2-ERROR TO TRUE.                                    13130008
131400     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         13140008
131500                                                                  13150008
131600******************************************************************13160008
131700* 9999-ABEND                                                      13170008
131800*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  13180008
131900******************************************************************13190008
132000 9999-ABEND.                                                      13200008
132100     DISPLAY '** ABEND           **'.                             13210008
132200     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  13220008
132300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        13230008
132400     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       13240008
132500     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       13250008
132600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         13260008
