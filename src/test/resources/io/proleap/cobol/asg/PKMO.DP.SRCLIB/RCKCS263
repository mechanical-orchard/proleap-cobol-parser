000100*-----------------------*                                         00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300*-----------------------*                                         00030003
000400 PROGRAM-ID.    RCKCS263.                                         00040003
000500 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00050003
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060003
000700 DATE-WRITTEN.  03-31-95.                                         00070003
000800 DATE-COMPILED.                                                   00080003
000900                                                                  00090003
001000*---------------------------------------------------------------* 00100003
001100*    E263 - SHIPMENT AUDIT TRAIL LIST                           * 00110003
001200*                                                               * 00120003
001300*    THIS PROGRAM DISPLAYS THE AUDIT INFORMATION FOR A          * 00130003
001400*    SHIPMENT.                                                  * 00140003
001500*                                                               * 00150003
001600*---------------------------------------------------------------* 00160003
001700* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00170003
001800* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00180003
001900* MAKING THE CALL DYNAMIC VS STATIC.                              00190003
002000*---------------------------------------------------------------* 00200003
002100                                                                  00210003
002200 ENVIRONMENT DIVISION.                                            00220003
002300                                                                  00230003
002400 DATA DIVISION.                                                   00240003
002500                                                                  00250003
002600 WORKING-STORAGE SECTION.                                         00260003
002700                                                                  00270003
002800 01  PC-PROGRAM-CONSTANTS.                                        00280003
002900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00290003
003000                                                    'RC263A  '.   00300003
003100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00310003
003200                                                    'RCKM263 '.   00320003
003300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00330003
003400                                                    'RCKCS263'.   00340003
003500     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00350003
003600     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00360003
003700     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00370003
003800     05  PC-FORCAST-SHIPMT-FORMAT       PIC  X(01)  VALUE '1'.    00380003
003900     05  PC-SHIPMT-LIST-FORMAT          PIC  X(01)  VALUE '2'.    00390003
004000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00400003
004100                                                    COMP SYNC.    00410003
004200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00420003
004300                                                    COMP SYNC.    00430003
004400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00440003
004500                                                    +1000000      00450003
004600                                                    COMP-3.       00460003
004700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00470003
004800                                                    COMP SYNC.    00480003
004900     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00490003
005000                                                     COMP-3.      00500003
005100     05  PC-DEFAULT-DATE                PIC X(10)      VALUE      00510003
005200                                        '0001-01-01'.             00520003
005300     05  PC-DEFAULT-TIME                PIC X(08)      VALUE      00530003
005400                                        '00.00.00'.               00540003
005500                                                                  00550003
005600 01  DK-DB2-KEYS.                                                 00560003
005700     05  DK-SHIPT-ID                    PIC S9(9) COMP VALUE +0.  00570003
005800                                                                  00580003
005900 01  PC-TSYMSG-NUMBERS.                                           00590003
006000     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00600003
006100     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00610003
006200     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00620003
006300     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00630003
006400     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00640003
006500     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00650003
006600     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  00660003
006700     05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  00670003
006800                                                                  00680003
006900 01  PS-PROGRAM-SUBSCRIPTS.                                       00690003
007000     05  PS-SUB                         PIC S9(04)   VALUE +0     00700003
007100                                                     COMP SYNC.   00710003
007200                                                                  00720003
007300 01  PS-PROGRAM-SWITCHES.                                         00730003
007400     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00740003
007500         88  PS-NO-ERROR                             VALUE 'Y'.   00750003
007600         88  PS-ERROR                                VALUE 'N'.   00760003
007700     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   00770003
007800         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00780003
007900         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00790003
008000     05  PS-LIST-END-SW                 PIC X(01)    VALUE 'N'.   00800003
008100         88  PS-LIST-END                             VALUE 'Y'.   00810003
008200         88  PS-NO-LIST-END                          VALUE 'N'.   00820003
008300     EJECT                                                        00830003
008400 01  PV-PROGRAM-VARIABLES.                                        00840003
008500     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     00850003
008600                                                     COMP SYNC.   00860003
008700     05  PV-RETRY-COUNTER               PIC S9(04)   VALUE +0     00870003
008800                                                     COMP SYNC.   00880003
008900     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     00890003
009000                                                     COMP-3.      00900003
009100     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     00910003
009200                                                     COMP-3.      00920003
009300     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     00930003
009400                                                     COMP-3.      00940003
009500     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     00950003
009600                                                     COMP SYNC.   00960003
009700     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     00970003
009800                                                     COMP SYNC.   00980003
009900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     00990003
010000                                                     COMP SYNC.   01000003
010100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01010003
010200                                                     COMP SYNC.   01020003
010300     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01030003
010400     05  PV-DB2-DATE.                                             01040003
010500         10  PV-DB2-DATE-CCYY           PIC  X(04).               01050003
010600         10  FILLER                     PIC  X(01).               01060003
010700         10  PV-DB2-DATE-MM             PIC  X(02).               01070003
010800         10  FILLER                     PIC  X(01).               01080003
010900         10  PV-DB2-DATE-DD             PIC  X(02).               01090003
011000     05  PV-DB2-TIME.                                             01100003
011100         10  PV-DB2-TIME-HH             PIC  X(02).               01110003
011200         10  FILLER                     PIC  X(01).               01120003
011300         10  PV-DB2-TIME-MM             PIC  X(02).               01130003
011400         10  FILLER                     PIC  X(01).               01140003
011500         10  PV-DB2-TIME-SS             PIC  X(02).               01150003
011600                                                                  01160003
011700 01  PV-DB2-CRITERIA-AREA.                                        01170003
011800     15  PV-DB2-MESSAGE-NUMBER          PIC S9(05)  VALUE ZERO    01180003
011900                                                    COMP-3.       01190003
012000                                                                  01200003
012100 EJECT                                                            01210003
012200*---------------------------------------------------------------* 01220003
012300*    PARAMETERS FOR OBTAINING USER INFORMATION    (XLKUT067).   * 01230003
012400*---------------------------------------------------------------* 01240003
012500                                                                  01250003
012600     COPY XLWS067.                                                01260003
012700 EJECT                                                            01270003
012800******************************************************************01280004
012900** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **01290004
012910** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01291004
013000******************************************************************01300004
013100                                                                  01310003
013200     COPY DPWS030.                                                01320003
013210     COPY DPWS930.                                                01321004
013300 EJECT                                                            01330003
013400*---------------------------------------------------------------* 01340003
013500*    STANDARD COMMAREA.                                         * 01350003
013600*---------------------------------------------------------------* 01360003
013700                                                                  01370003
013800     COPY DPWS020.                                                01380003
013900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01390003
014000                                                                  01400003
014100*---------------------------------------------------------------* 01410003
014200*    INTER-APPLICATION COMMAREA.                                * 01420003
014300*---------------------------------------------------------------* 01430003
014400                                                                  01440003
014500         10  INTER-APPL-COMM-AREA       PIC X(200).               01450003
014600     COPY TRWS001.                                                01460003
014700     COPY RCWS015.                                                01470003
014800*---------------------------------------------------------------* 01480003
014900*    SPECIFIC COMMMAREA FOR RCKCS263.                           * 01490003
015000*---------------------------------------------------------------* 01500003
015100         10  ASC-SPECIFIC-COMMAREA.                               01510003
015200             15  ASC-LIST-KEYS.                                   01520003
015300                 20  ASC-KEY-SHIPT-ID                PIC S9(09)   01530003
015400                                                         COMP.    01540003
015500                 20  ASC-KEY-LAST-UPD-UID            PIC  X(08).  01550003
015600                 20  ASC-KEY-USER-NAME               PIC  X(30).  01560003
015700                 20  ASC-KEY-PRO-SCAC-ID             PIC  X(04).  01570003
015800                 20  ASC-KEY-PRO-NBR                 PIC  X(22).  01580003
015900                 20  ASC-KEY-BOL-NBR                 PIC  X(30).  01590003
016000                 20  ASC-KEY-ORIG-SCAC-ID            PIC  X(04).  01600003
016100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                01610003
016200                 20  ASC-ITEM-ARRAY.                              01620003
016300                                                                  01630003
016400                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        01640003
016500                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    01650003
016600                                                     COMP-3.      01660003
016700                         30  ASC-STATUS              PIC X(02).   01670003
016800                         30  ASC-ASN-CARTON          PIC 9(06).   01680003
016900                         30  ASC-ASN-DATE            PIC X(05).   01690003
017000                         30  ASC-ASN-TIME            PIC X(05).   01700003
017100                         30  ASC-FORECAST-CARTON     PIC 9(06).   01710003
017200                         30  ASC-FORECAST-DATE       PIC X(05).   01720003
017300                         30  ASC-FORECAST-TIME       PIC X(05).   01730003
017400                         30  ASC-CONFIRM-CARTON      PIC 9(06).   01740003
017500                         30  ASC-CONFIRM-DATE        PIC X(05).   01750003
017600                         30  ASC-CONFIRM-TIME        PIC X(05).   01760003
017700                         30  ASC-USER-ID             PIC X(08).   01770003
017800                                                                  01780003
017900             15  ASC-BLK-SUB                         PIC S9(04)   01790003
018000                                                         COMP     01800003
018100                                                         SYNC.    01810003
018200             15  ASC-ITEM-SUB                        PIC S9(04)   01820003
018300                                                         COMP     01830003
018400                                                         SYNC.    01840003
018500             15  ASC-SEL-SUB                         PIC S9(04)   01850003
018600                                                         COMP.    01860003
018700             15  ASC-SEL-ITEM                        PIC S9(04)   01870003
018800                                                         COMP.    01880003
018900             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   01890003
019000                                                         COMP-3.  01900003
019100             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   01910003
019200                                                         COMP-3.  01920003
019300             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   01930003
019400                                                         COMP-3.  01940003
019500             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   01950003
019600                                                         COMP-3.  01960003
019700             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   01970003
019800                                                         COMP-3.  01980003
019900             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   01990003
020000                                                         COMP-3.  02000003
020100             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   02010003
020200                                                         COMP     02020003
020300                                                         SYNC.    02030003
020400             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   02040003
020500                                                         COMP-3.  02050003
020600             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   02060003
020700                                                         COMP-3.  02070003
020800             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  02080003
020900                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 02090003
021000                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 02100003
021100             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  02110003
021200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02120003
021300             15  ASC-DESC-LINE-IND                   PIC  X(01).  02130003
021400                 88  ASC-DESC-LINE-DONE                VALUE 'Y'. 02140003
021500             15  ASC-CORR-LINE-IND                   PIC  X(01).  02150003
021600                 88  ASC-CORR-LINE-DONE                VALUE 'Y'. 02160003
021700             15  ASC-LIST-QUEUE-NAME.                             02170003
021800                 20  ASC-LIST-TERM-ID                PIC  X(04).  02180003
021900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   02190003
022000                                                         COMP-3.  02200003
022100                 20  ASC-LIST-SEQ                    PIC  9(01).  02210003
022200             15  ASC-SEL-QUEUE-NAME.                              02220003
022300                 20  ASC-SEL-TERM-ID                 PIC  X(04).  02230003
022400                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   02240003
022500                                                          COMP-3. 02250003
022600                 20  ASC-SEL-SEQ                     PIC  9(01).  02260003
022700             15  ASC-DTL-QUEUE-NAME.                              02270003
022800                 20  ASC-DTL-TERM-ID                 PIC  X(04).  02280003
022900                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   02290003
023000                                                         COMP-3.  02300003
023100                 20  ASC-DTL-SEQ                     PIC  9(01).  02310003
023200                                                                  02320003
023300             15  ASC-START-ITEM-REQUEST.                          02330003
023400                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  02340003
023500                                                                  02350003
023600     EJECT                                                        02360003
023700*---------------------------------------------------------------* 02370003
023800*    MESSAGE SELECTION TSQ B QUEUE RECORD LAYOUT.               * 02380003
023900*---------------------------------------------------------------* 02390003
024000                                                                  02400003
024100     COPY RCWS013.                                                02410003
024200                                                                  02420003
024300     EJECT                                                        02430003
024400*---------------------------------------------------------------* 02440003
024500*    ABEND PROCESSING COPYBOOK.                                 * 02450003
024600*---------------------------------------------------------------* 02460003
024700                                                                  02470003
024800     COPY DPWS013.                                                02480003
024900                                                                  02490003
025000     EJECT                                                        02500003
025100*---------------------------------------------------------------* 02510003
025200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02520003
025300*---------------------------------------------------------------* 02530003
025400                                                                  02540003
025500     COPY DPWS015.                                                02550003
025600                                                                  02560003
025700*---------------------------------------------------------------* 02570003
025800*    FUNCTION KEYS COPYBOOK.                                    * 02580003
025900*---------------------------------------------------------------* 02590003
026000                                                                  02600003
026100     COPY DPWS016.                                                02610003
026200                                                                  02620003
026300*---------------------------------------------------------------* 02630003
026400*    NUMERIC EDIT LAYOUT.                                       * 02640003
026500*---------------------------------------------------------------* 02650003
026600                                                                  02660003
026700     COPY DPWS010I.                                               02670003
026800                                                                  02680003
026900*---------------------------------------------------------------* 02690003
027000*    MAP LAYOUT                                                 * 02700003
027100*---------------------------------------------------------------* 02710003
027200                                                                  02720003
027300     COPY RCKM263.                                                02730003
027400                                                                  02740003
027500 01  MR-OCCURS-LAYOUT          REDEFINES  RC263AO.                02750003
027600     05  FILLER                PIC X(151).                        02760003
027700     05  MR-SCROLL-AREA OCCURS 13 TIMES.                          02770003
027800         10  MR-STATUSL        PIC S9(04) COMP.                   02780003
027900         10  MR-STATUSA        PIC  X(01).                        02790003
028000         10  MR-STATUSC        PIC  X(01).                        02800003
028100         10  MR-STATUSH        PIC  X(01).                        02810003
028200         10  MR-STATUS         PIC  X(02).                        02820003
028300                                                                  02830003
028400         10  MR-ASN-CARTONL    PIC S9(04) COMP.                   02840003
028500         10  MR-ASN-CARTONA    PIC  X(01).                        02850003
028600         10  MR-ASN-CARTONC    PIC  X(01).                        02860003
028700         10  MR-ASN-CARTONH    PIC  X(01).                        02870003
028800         10  MR-ASN-CARTON-X.                                     02880003
028900             15  MR-ASN-CARTON     PIC  ZZZZZ9.                   02890003
029000                                                                  02900003
029100         10  MR-ASN-DATEL      PIC S9(04) COMP.                   02910003
029200         10  MR-ASN-DATEA      PIC  X(01).                        02920003
029300         10  MR-ASN-DATEC      PIC  X(01).                        02930003
029400         10  MR-ASN-DATEH      PIC  X(01).                        02940003
029500         10  MR-ASN-DATE       PIC  X(05).                        02950003
029600                                                                  02960003
029700         10  MR-ASN-TIMEL      PIC S9(04) COMP.                   02970003
029800         10  MR-ASN-TIMEA      PIC  X(01).                        02980003
029900         10  MR-ASN-TIMEC      PIC  X(01).                        02990003
030000         10  MR-ASN-TIMEH      PIC  X(01).                        03000003
030100         10  MR-ASN-TIME       PIC  X(05).                        03010003
030200                                                                  03020003
030300         10  MR-FOR-CARTONL    PIC S9(04) COMP.                   03030003
030400         10  MR-FOR-CARTONA    PIC  X(01).                        03040003
030500         10  MR-FOR-CARTONC    PIC  X(01).                        03050003
030600         10  MR-FOR-CARTONH    PIC  X(01).                        03060003
030700         10  MR-FOR-CARTON-X.                                     03070003
030800             15  MR-FOR-CARTON     PIC  ZZZZZ9.                   03080003
030900                                                                  03090003
031000         10  MR-FOR-DATEL      PIC S9(04) COMP.                   03100003
031100         10  MR-FOR-DATEA      PIC  X(01).                        03110003
031200         10  MR-FOR-DATEC      PIC  X(01).                        03120003
031300         10  MR-FOR-DATEH      PIC  X(01).                        03130003
031400         10  MR-FOR-DATE       PIC  X(05).                        03140003
031500                                                                  03150003
031600         10  MR-FOR-TIMEL      PIC S9(04) COMP.                   03160003
031700         10  MR-FOR-TIMEA      PIC  X(01).                        03170003
031800         10  MR-FOR-TIMEC      PIC  X(01).                        03180003
031900         10  MR-FOR-TIMEH      PIC  X(01).                        03190003
032000         10  MR-FOR-TIME       PIC  X(05).                        03200003
032100                                                                  03210003
032200         10  MR-CON-CARTONL    PIC S9(04) COMP.                   03220003
032300         10  MR-CON-CARTONA    PIC  X(01).                        03230003
032400         10  MR-CON-CARTONC    PIC  X(01).                        03240003
032500         10  MR-CON-CARTONH    PIC  X(01).                        03250003
032600         10  MR-CON-CARTON-X.                                     03260003
032700             15  MR-CON-CARTON     PIC  ZZZZZ9.                   03270003
032800                                                                  03280003
032900         10  MR-CON-DATEL      PIC S9(04) COMP.                   03290003
033000         10  MR-CON-DATEA      PIC  X(01).                        03300003
033100         10  MR-CON-DATEC      PIC  X(01).                        03310003
033200         10  MR-CON-DATEH      PIC  X(01).                        03320003
033300         10  MR-CON-DATE       PIC  X(05).                        03330003
033400                                                                  03340003
033500         10  MR-CON-TIMEL      PIC S9(04) COMP.                   03350003
033600         10  MR-CON-TIMEA      PIC  X(01).                        03360003
033700         10  MR-CON-TIMEC      PIC  X(01).                        03370003
033800         10  MR-CON-TIMEH      PIC  X(01).                        03380003
033900         10  MR-CON-TIME       PIC  X(05).                        03390003
034000                                                                  03400003
034100         10  MR-USER-IDL       PIC S9(04) COMP.                   03410003
034200         10  MR-USER-IDA       PIC  X(01).                        03420003
034300         10  MR-USER-IDC       PIC  X(01).                        03430003
034400         10  MR-USER-IDH       PIC  X(01).                        03440003
034500         10  MR-USER-ID        PIC  X(08).                        03450003
034600                                                                  03460003
034700 EJECT                                                            03470003
034800*---------------------------------------------------------------* 03480003
034900*    DB2 AREA FOR AUDIT SHIPMENT TABLE                          * 03490003
035000*---------------------------------------------------------------* 03500003
035100     EXEC SQL                                                     03510003
035200          INCLUDE TAUSHIP                                         03520003
035300     END-EXEC.                                                    03530003
035400                                                                  03540003
035500*---------------------------------------------------------------* 03550003
035600*    DB2 AREA FOR SHIPMENT TABLE                                * 03560003
035700*---------------------------------------------------------------* 03570003
035800     EXEC SQL                                                     03580003
035900          INCLUDE TSHIPMT                                         03590003
036000     END-EXEC.                                                    03600003
036100                                                                  03610003
036200*---------------------------------------------------------------* 03620003
036300*    DB2 AREA FOR COMMUNICATIONS                                * 03630003
036400*---------------------------------------------------------------* 03640003
036500     EXEC SQL                                                     03650003
036600          INCLUDE SQLCA                                           03660003
036700     END-EXEC.                                                    03670003
036800                                                                  03680003
036900*---------------------------------------------------------------* 03690003
037000*    CURSOR TO OBTAIN LONG DESCRIPTION AND CORRECTIVE ACTION    * 03700003
037100*---------------------------------------------------------------* 03710003
037200                                                                  03720003
037300     EXEC SQL                                                     03730003
037400          DECLARE AUSHIP-CSR CURSOR                               03740003
037500          FOR SELECT                                              03750003
037600                LAST_UPD_DTE                                      03760003
037700              , LAST_UPD_TME                                      03770003
037800              , LAST_UPD_UID                                      03780003
037900              , EXPTED_PKG_QTY                                    03790003
038000              , CARR_CART_CT                                      03800003
038100              , CARR_LAST_UPD_DTE                                 03810003
038200              , CARR_LAST_UPD_TIME                                03820003
038300              , VEND_CART_CT                                      03830003
038400              , VEND_LAST_UPD_DTE                                 03840003
038500              , VEND_LAST_UPD_TIME                                03850003
038600              , AUD_STATUS_CDE                                    03860003
038700          FROM                                                    03870003
038800                TAUSHIP                                           03880003
038900          WHERE                                                   03890003
039000                SHIPT_ID       = :DK-SHIPT-ID                     03900003
039100          ORDER BY                                                03910003
039200                LAST_UPD_DTE                                      03920003
039300              , LAST_UPD_TME                                      03930003
039400              , VEND_LAST_UPD_DTE                                 03940003
039500              , VEND_LAST_UPD_TIME                                03950003
039600              , CARR_LAST_UPD_DTE                                 03960003
039700              , CARR_LAST_UPD_TIME                                03970003
039800     END-EXEC.                                                    03980003
039900                                                                  03990003
040000 EJECT                                                            04000003
040100 LINKAGE SECTION.                                                 04010003
040200                                                                  04020003
040300 01  DFHCOMMAREA.                                                 04030003
040400     05  FILLER                         OCCURS  1 TO 4072 TIMES   04040003
040500                                        DEPENDING ON EIBCALEN.    04050003
040600         10  FILLER                     PIC X.                    04060003
040700                                                                  04070003
040800 EJECT                                                            04080003
040900 PROCEDURE DIVISION.                                              04090003
041000                                                                  04100003
041100 0000-MAIN-MODULE.                                                04110003
041200                                                                  04120003
041300     INITIALIZE DP030-CICS-API-FIELDS.                            04130003
041400     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04140003
041500     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04150003
041600     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04160003
041700     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04170003
041800     MOVE LENGTH OF RC263AI       TO DP030-MAP-LENGTH (1).        04180003
041900     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04190003
042000     PERFORM 0001-CALL-CICS-ARCH-API.                             04200003
042100                                                                  04210003
042200     PERFORM 1000-CONTROL-PROCESSING.                             04220003
042300                                                                  04230003
042400     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      04240003
042500     PERFORM 0001-CALL-CICS-ARCH-API.                             04250003
042600                                                                  04260003
042700*----------------------------------------------------------------*04270003
042800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *04280003
042900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *04290003
043000*----------------------------------------------------------------*04300003
043100                                                                  04310003
043200 0001-CALL-CICS-ARCH-API.                                         04320003
043300                                                                  04330003
043410     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04341004
043500                                    DFHCOMMAREA                   04350004
043600                                    DP030-CICS-API-FIELDS         04360004
043700                                    DP020-STANDARD-COMMAREA       04370004
043800                                    RC263AI.                      04380004
043900                                                                  04390003
044000     IF  DP030-RC-CALL-SUCCESSFUL                                 04400003
044100         CONTINUE                                                 04410003
044200     ELSE                                                         04420003
044300         SET DP013-NO-ROLLBACK TO TRUE                            04430003
044400         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   04440003
044500         SET DP013-CICS-ABEND TO TRUE                             04450003
044600         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        04460003
044620         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O04462004
044630-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04463004
044900         MOVE DP030-RETURN-CODE                                   04490003
045000                               TO DP013-MESSAGE-TEXT (3)          04500003
045100         PERFORM DP013-0000-PROCESS-ABEND                         04510003
045200     END-IF.                                                      04520003
045300                                                                  04530003
045400*----------------------------------------------------------------*04540003
045500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04550003
045600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04560003
045700*                                                                *04570003
045800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04580003
045900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04590003
046000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04600003
046100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *04610003
046200*----------------------------------------------------------------*04620003
046300                                                                  04630003
046400 1000-CONTROL-PROCESSING.                                         04640003
046500                                                                  04650003
046600     EVALUATE TRUE                                                04660003
046700         WHEN DP020-NEXT-ACT-INITIAL                              04670003
046800             MOVE EIBTRMID          TO ASC-DTL-TERM-ID            04680003
046900             MOVE DP020-SRC-TASK-NUMBER                           04690003
047000                                    TO ASC-DTL-TASK-NUMBER        04700003
047100             MOVE PC-DTL-QUEUE-SEQ  TO ASC-DTL-SEQ                04710003
047200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04720003
047300***-----$TEMPLATE NOTE$-------------------------------------------04730003
047400*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,04740003
047500*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  04750003
047600*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.04760003
047700***---------------------------------------------------------------04770003
047800             IF  PS-COMMAREA-NOT-VALID                            04780003
047900                 SET DP020-NEXT-ACT-APPL-ERROR                    04790003
048000                               TO  TRUE                           04800003
048100             ELSE                                                 04810003
048200                 PERFORM 2050-DELETE-DETAIL-QUEUE                 04820003
048300                 PERFORM 4000-BUILD-INITIAL-PANEL                 04830003
048400             END-IF                                               04840003
048500                                                                  04850003
048600         WHEN DP020-NEXT-ACT-READ-MAP                             04860003
048700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        04870003
048800                               TO PV-TOP-ITEM                     04880003
048900             PERFORM 2000-PROCESS-PANEL                           04890003
049000                                                                  04900003
049100         WHEN DP020-NEXT-ACT-RETURN                               04910003
049200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        04920003
049300                               TO PV-TOP-ITEM                     04930003
049400             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        04940003
049500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04950003
049600                                                                  04960003
049700         WHEN OTHER                                               04970003
049800             SET DP013-LOGIC-ABEND TO TRUE                        04980003
049900             SET DP013-NO-ROLLBACK TO TRUE                        04990003
050000             MOVE '1000-CONTROL-PROCESSING'                       05000003
050100                               TO  DP013-PARAGRAPH                05010003
050200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05020003
050300                               TO  DP013-MESSAGE-TEXT(1)          05030003
050400             PERFORM DP013-0000-PROCESS-ABEND                     05040003
050500     END-EVALUATE.                                                05050003
050600                                                                  05060003
050700 EJECT                                                            05070003
050800*----------------------------------------------------------------*05080003
050900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05090003
051000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05100003
051100*----------------------------------------------------------------*05110003
051200                                                                  05120003
051300 1100-PROCESS-INTER-APPL-COMM.                                    05130003
051400                                                                  05140003
051500     SET PS-COMMAREA-VALID     TO TRUE.                           05150003
051600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05160003
051700     MOVE SPACE                TO ASC-START-ITEM-REQUEST.         05170003
051800     EVALUATE DP020-INT-APPL-FORMAT-IND                           05180003
051900         WHEN PC-FORCAST-SHIPMT-FORMAT                            05190003
052000             IF TR001-SHIPT-ID > ZERO                             05200003
052100                 MOVE TR001-SHIPT-ID                              05210003
052200                               TO ASC-KEY-SHIPT-ID                05220003
052300                                  DK-SHIPT-ID                     05230003
052400             ELSE                                                 05240003
052500                 MOVE PC-TSYMSG-00148                             05250003
052600                               TO DP020-MSG-NUMBER                05260003
052700                 SET DP020-MSG-FATAL TO TRUE                      05270003
052800                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            05280003
052900             END-IF                                               05290003
053000         WHEN PC-SHIPMT-LIST-FORMAT                               05300003
053100             SET ASC-USE-SELECTION-QUEUE TO TRUE                  05310003
053200             MOVE RC015-NUMBER-OF-TS-ITEMS                        05320003
053300                               TO ASC-NUMBER-OF-TS-ITEMS          05330003
053400             MOVE RC015-SEL-QUEUE-NAME                            05340003
053500                               TO ASC-SEL-QUEUE-NAME              05350003
053600             PERFORM 1120-PREPARE-LIST-ENTRY                      05360003
053700         WHEN OTHER                                               05370003
053800             MOVE PC-TSYMSG-00148                                 05380003
053900                           TO DP020-MSG-NUMBER                    05390003
054000             SET DP020-MSG-FATAL TO TRUE                          05400003
054100             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                05410003
054200     END-EVALUATE.                                                05420003
054300                                                                  05430003
054400*----------------------------------------------------------------*05440003
054500*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *05450003
054600*----------------------------------------------------------------*05460003
054700                                                                  05470003
054800 1120-PREPARE-LIST-ENTRY.                                         05480003
054900                                                                  05490003
055000     MOVE RC013-MAX-ITEMS TO ASC-SEL-SUB.                         05500003
055100     MOVE ZERO            TO ASC-SEL-ITEM.                        05510003
055200     PERFORM 2140-GET-NEXT-RECORD.                                05520003
055300 EJECT                                                            05530003
055400*----------------------------------------------------------------*05540003
055500*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *05550003
055600*    ON WHAT FUNCTION KEY WAS SELECTED.                          *05560003
055700*----------------------------------------------------------------*05570003
055800                                                                  05580003
055900 2000-PROCESS-PANEL.                                              05590003
056000                                                                  05600003
056100     EVALUATE TRUE                                                05610003
056200         WHEN DP020-SRC-AID = DP016-CLEAR                         05620003
056300             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                05630003
056400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05640003
056500             PERFORM 3200-RESET-ATTRIBUTES                        05650003
056600                                                                  05660003
056700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    05670003
056800             MOVE ASC-KEY-SHIPT-ID                                05680003
056900                           TO DK-SHIPT-ID                         05690003
057000             PERFORM 2050-DELETE-DETAIL-QUEUE                     05700003
057100             PERFORM 4000-BUILD-INITIAL-PANEL                     05710003
057200             PERFORM 3200-RESET-ATTRIBUTES                        05720003
057300                                                                  05730003
057400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05740003
057500             IF  ASC-USE-SELECTION-QUEUE                          05750003
057600                 PERFORM 2140-GET-NEXT-RECORD                     05760003
057700                 IF PS-LIST-END                                   05770003
057800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         05780003
057900                     SET PS-NO-LIST-END TO TRUE                   05790003
058000                 ELSE                                             05800003
058100                     PERFORM 2050-DELETE-DETAIL-QUEUE             05810003
058200                     PERFORM 4000-BUILD-INITIAL-PANEL             05820003
058300                 END-IF                                           05830003
058400                 PERFORM 3200-RESET-ATTRIBUTES                    05840003
058500             ELSE                                                 05850003
058600                 MOVE PC-TSYMSG-00070                             05860003
058700                                  TO DP020-MSG-NUMBER             05870003
058800                 SET DP020-MSG-INFORMATIONAL TO TRUE              05880003
058900             END-IF                                               05890003
059000                                                                  05900003
059100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             05910003
059200             IF  ASC-USE-SELECTION-QUEUE                          05920003
059300                 PERFORM 2150-GET-PREV-RECORD                     05930003
059400                 IF PS-LIST-END                                   05940003
059500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         05950003
059600                     SET PS-NO-LIST-END TO TRUE                   05960003
059700                 ELSE                                             05970003
059800                     PERFORM 2050-DELETE-DETAIL-QUEUE             05980003
059900                     PERFORM 4000-BUILD-INITIAL-PANEL             05990003
060000                 END-IF                                           06000003
060100                 PERFORM 3200-RESET-ATTRIBUTES                    06010003
060200             ELSE                                                 06020003
060300                 MOVE PC-TSYMSG-00069                             06030003
060400                                  TO DP020-MSG-NUMBER             06040003
060500                 SET DP020-MSG-INFORMATIONAL TO TRUE              06050003
060600             END-IF                                               06060003
060700                                                                  06070003
060800         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06080003
060900             MOVE +1 TO PV-TOP-ITEM                               06090003
061000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06100003
061100             PERFORM 3200-RESET-ATTRIBUTES                        06110003
061200                                                                  06120003
061300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06130003
061400             PERFORM 2110-BROWSE-BACKWARD                         06140003
061500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06150003
061600             PERFORM 3200-RESET-ATTRIBUTES                        06160003
061700                                                                  06170003
061800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06180003
061900             PERFORM 2120-BROWSE-FORWARD                          06190003
062000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06200003
062100             PERFORM 3200-RESET-ATTRIBUTES                        06210003
062200                                                                  06220003
062300         WHEN DP020-SRC-AID = DP016-ENTER                         06230003
062400             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06240003
062500             IF  PS-ERROR                                         06250003
062600                 CONTINUE                                         06260003
062700             ELSE                                                 06270003
062800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06280003
062900                 PERFORM 3200-RESET-ATTRIBUTES                    06290003
063000             END-IF                                               06300003
063100                                                                  06310003
063200         WHEN OTHER                                               06320003
063300             SET DP013-NO-ROLLBACK TO TRUE                        06330003
063400             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               06340003
063500             SET DP013-CICS-ABEND TO TRUE                         06350003
063600             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    06360003
063700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06370003
063800                                   TO DP013-MESSAGE-TEXT (1)      06380003
063900             PERFORM DP013-0000-PROCESS-ABEND                     06390003
064000                                                                  06400003
064100     END-EVALUATE.                                                06410003
064200 EJECT                                                            06420003
064300*----------------------------------------------------------------*06430003
064400*    DELETE THE TEMPORARY STORAGE QUEUE.                         *06440003
064500*----------------------------------------------------------------*06450003
064600                                                                  06460003
064700 2050-DELETE-DETAIL-QUEUE.                                        06470003
064800                                                                  06480003
064900     EXEC CICS                                                    06490003
065000         DELETEQ TS                                               06500003
065100             QUEUE (ASC-DTL-QUEUE-NAME)                           06510003
065200             RESP  (PV-CICS-RESP)                                 06520003
065300     END-EXEC.                                                    06530003
065400                                                                  06540003
065500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06550003
065600        (PV-CICS-RESP = DFHRESP(QIDERR))                          06560003
065700         CONTINUE                                                 06570003
065800     ELSE                                                         06580003
065900         SET DP013-CICS-ABEND TO TRUE                             06590003
066000         SET DP013-NO-ROLLBACK TO TRUE                            06600003
066100                                                                  06610003
066200         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       06620003
066300         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  06630003
066400                        TO DP013-MESSAGE-TEXT (1)                 06640003
066500         PERFORM DP013-0000-PROCESS-ABEND                         06650003
066600     END-IF.                                                      06660003
066700                                                                  06670003
066800     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        06680003
066900 EJECT                                                            06690003
067000*----------------------------------------------------------------*06700003
067100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06710003
067200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06720003
067300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06730003
067400*    MESSAGE.                                                    *06740003
067500*----------------------------------------------------------------*06750003
067600                                                                  06760003
067700 2110-BROWSE-BACKWARD.                                            06770003
067800                                                                  06780003
067900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    06790003
068000         GIVING PV-TOP-ITEM.                                      06800003
068100                                                                  06810003
068200     IF  PV-TOP-ITEM < +1                                         06820003
068300         MOVE +1              TO PV-TOP-ITEM                      06830003
068400*        -- TOP OF LIST --                                        06840003
068500         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 06850003
068600         SET DP020-MSG-INFORMATIONAL TO TRUE                      06860003
068700     END-IF.                                                      06870003
068800                                                                  06880003
068900 EJECT                                                            06890003
069000                                                                  06900003
069100*----------------------------------------------------------------*06910003
069200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *06920003
069300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *06930003
069400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *06940003
069500*----------------------------------------------------------------*06950003
069600                                                                  06960003
069700 2120-BROWSE-FORWARD.                                             06970003
069800                                                                  06980003
069900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              06990003
070000         GIVING PV-TOP-ITEM.                                      07000003
070100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07010003
070200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07020003
070300                                   TO PV-TOP-ITEM                 07030003
070400*        -- BOTTOM OF LIST --                                     07040003
070500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07050003
070600         SET DP020-MSG-INFORMATIONAL                              07060003
070700                                   TO TRUE                        07070003
070800     ELSE                                                         07080003
070900         COMPUTE PV-BOTTOM-ITEM =                                 07090003
071000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07100003
071100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07110003
071200*            -- BOTTOM OF LIST --                                 07120003
071300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07130003
071400             SET DP020-MSG-INFORMATIONAL                          07140003
071500                                   TO TRUE                        07150003
071600         END-IF                                                   07160003
071700     END-IF.                                                      07170003
071800 EJECT                                                            07180003
071900*----------------------------------------------------------------*07190003
072000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07200003
072100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07210003
072200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07220003
072300*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *07230003
072400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07240003
072500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07250003
072600*----------------------------------------------------------------*07260003
072700                                                                  07270003
072800 2130-CHECK-FOR-JUMP-BROWSE.                                      07280003
072900                                                                  07290003
073000     IF ASTRTITL > ZERO                                           07300003
073100         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      07310003
073200     ELSE                                                         07320003
073300         IF ASTRTITF = DP015-ERASE-EOF                            07330003
073400             INITIALIZE ASC-START-ITEM-REQUEST                    07340003
073500         END-IF                                                   07350003
073600     END-IF.                                                      07360003
073700                                                                  07370003
073800     SET PS-NO-ERROR               TO TRUE.                       07380003
073900     IF (ASC-START-ITEM-REQUEST = SPACE)                          07390003
074000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07400003
074100                                   TO PV-TOP-ITEM                 07410003
074200     ELSE                                                         07420003
074300         MOVE ASC-START-ITEM-REQUEST                              07430003
074400                                   TO DP010I-UNEDITED-FIELD       07440003
074500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07450003
074600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07460003
074700         SET DP010I-NEGATIVE-NOT-ALLOWED                          07470003
074800                                   TO TRUE                        07480003
074900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07490003
075000              USING DP010I-NUMERIC-EDIT-AREA                      07500003
075100                                                                  07510003
075200         IF  NOT DP010I-ERROR-DETECTED                            07520003
075300             MOVE DP010I-NUMERIC-FIELD                            07530003
075400                                   TO  ASC-START-ITEM-REQUEST-N   07540003
075500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07550003
075600                 IF  ASC-START-ITEM-REQUEST-N >                   07560003
075700                                          ASC-NUMBER-OF-ITEMS-READ07570003
075800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07580003
075900                     COMPUTE PV-TOP-ITEM =                        07590003
076000                             ASC-NUMBER-OF-ITEMS-READ             07600003
076100                             - PC-ITEMS-PER-PANEL + 1             07610003
076200                     IF  PV-TOP-ITEM < +1                         07620003
076300                         MOVE +1   TO PV-TOP-ITEM                 07630003
076400                         MOVE PC-TSYMSG-00070                     07640003
076500                                   TO DP020-MSG-NUMBER            07650003
076600                         SET DP020-MSG-INFORMATIONAL              07660003
076700                                   TO TRUE                        07670003
076800                     END-IF                                       07680003
076900                 ELSE                                             07690003
077000                     MOVE ASC-START-ITEM-REQUEST-N                07700003
077100                                   TO PV-TOP-ITEM                 07710003
077200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07720003
077300                     COMPUTE PV-BOTTOM-ITEM =                     07730003
077400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07740003
077500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07750003
077600*                        -- BOTTOM OF LIST --                     07760003
077700                         MOVE PC-TSYMSG-00070                     07770003
077800                                   TO DP020-MSG-NUMBER            07780003
077900                         SET DP020-MSG-INFORMATIONAL              07790003
078000                                   TO TRUE                        07800003
078100                     END-IF                                       07810003
078200                 END-IF                                           07820003
078300             ELSE                                                 07830003
078400*                --- VALUE OUT OF RANGE ----                      07840003
078500                 MOVE PC-TSYMSG-00101                             07850003
078600                                   TO DP020-MSG-NUMBER            07860003
078700                 MOVE -1           TO ASTRTITL                    07870003
078800                 SET DP030-SET-CURSOR-APPL-1                      07880003
078900                                   TO TRUE                        07890003
079000                 MOVE DP015-REVERSE                               07900003
079100                                   TO ASTRTITH                    07910003
079200                 MOVE DP015-RED    TO ASTRTITC                    07920003
079300                 MOVE DP015-UNP-NUM-BRT-MDT                       07930003
079400                                   TO ASTRTITA                    07940003
079500                 SET DP020-MSG-FATAL                              07950003
079600                                   TO TRUE                        07960003
079700                 SET PS-ERROR      TO TRUE                        07970003
079800             END-IF                                               07980003
079900                                                                  07990003
080000         ELSE                                                     08000003
080100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08010003
080200             MOVE -1               TO ASTRTITL                    08020003
080300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08030003
080400             MOVE DP015-REVERSE    TO ASTRTITH                    08040003
080500             MOVE DP015-RED        TO ASTRTITC                    08050003
080600             MOVE DP015-UNP-NUM-BRT-MDT                           08060003
080700                                   TO ASTRTITA                    08070003
080800             SET DP020-MSG-FATAL   TO TRUE                        08080003
080900             SET PS-ERROR          TO TRUE                        08090003
081000         END-IF                                                   08100003
081100     END-IF.                                                      08110003
081200 EJECT                                                            08120003
081300                                                                  08130003
081400*----------------------------------------------------------------*08140003
081500*    GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         *08150003
081600*    PROCESSED.                                                  *08160003
081700*----------------------------------------------------------------*08170003
081800                                                                  08180003
081900 2140-GET-NEXT-RECORD.                                            08190003
082000                                                                  08200003
082100     ADD +1                       TO ASC-SEL-SUB.                 08210003
082200     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            08220003
082300         ADD +1                   TO ASC-SEL-ITEM                 08230003
082400         MOVE +1                  TO ASC-SEL-SUB                  08240003
082500     END-IF.                                                      08250003
082600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08260003
082700         PERFORM 9100-READ-SEL-QUEUE                              08270003
082800         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      08280003
082900             MOVE RC013-SHIPT-ID (ASC-SEL-SUB)                    08290003
083000                                  TO ASC-KEY-SHIPT-ID             08300003
083100                                     DK-SHIPT-ID                  08310003
083200             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  08320003
083300             PERFORM 9200-REWRITE-SEL-QUEUE                       08330003
083400         ELSE                                                     08340003
083500             SUBTRACT +1 FROM ASC-SEL-SUB                         08350003
083600             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08360003
083700             SET DP020-MSG-INFORMATIONAL TO TRUE                  08370003
083800             SET PS-LIST-END             TO TRUE                  08380003
083900         END-IF                                                   08390003
084000     ELSE                                                         08400003
084100         SUBTRACT +1 FROM ASC-SEL-ITEM                            08410003
084200         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  08420003
084300         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             08430003
084400         SET DP020-MSG-INFORMATIONAL TO TRUE                      08440003
084500         SET PS-LIST-END             TO TRUE                      08450003
084600     END-IF.                                                      08460003
084700                                                                  08470003
084800*----------------------------------------------------------------*08480003
084900*    GET THE PREVIOUS MESSAGE IF A LIST OF MESSAGES IS BEING     *08490003
085000*    PROCESSED.                                                  *08500003
085100*----------------------------------------------------------------*08510003
085200                                                                  08520003
085300 2150-GET-PREV-RECORD.                                            08530003
085400                                                                  08540003
085500     SUBTRACT +1 FROM ASC-SEL-SUB.                                08550003
085600     IF  ASC-SEL-SUB < +1                                         08560003
085700         SUBTRACT +1 FROM ASC-SEL-ITEM                            08570003
085800         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  08580003
085900     END-IF.                                                      08590003
086000                                                                  08600003
086100     IF  ASC-SEL-ITEM > ZERO                                      08610003
086200         PERFORM 9100-READ-SEL-QUEUE                              08620003
086300         MOVE RC013-SHIPT-ID (ASC-SEL-SUB)                        08630003
086400                                  TO ASC-KEY-SHIPT-ID             08640003
086500                                     DK-SHIPT-ID                  08650003
086600     ELSE                                                         08660003
086700         MOVE +1                  TO ASC-SEL-ITEM                 08670003
086800                                     ASC-SEL-SUB                  08680003
086900         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             08690003
087000         SET DP020-MSG-INFORMATIONAL TO TRUE                      08700003
087100         SET PS-LIST-END             TO TRUE                      08710003
087200     END-IF.                                                      08720003
087300                                                                  08730003
087400 EJECT                                                            08740003
087500*----------------------------------------------------------------*08750003
087600*    RESET ATTRIBUTES.                                           *08760003
087700*----------------------------------------------------------------*08770003
087800                                                                  08780003
087900 3200-RESET-ATTRIBUTES.                                           08790003
088000                                                                  08800003
088100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   08810003
088200     MOVE DP015-GREEN              TO ASTRTITC.                   08820003
088300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   08830003
088400     MOVE -1                       TO ASTRTITL.                   08840003
088500     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08850003
088600                                                                  08860003
088700 EJECT                                                            08870003
088800                                                                  08880003
088900*----------------------------------------------------------------*08890003
089000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *08900003
089100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *08910003
089200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *08920003
089300*    DISPLAY THE PANEL TO USER.                                  *08930003
089400*----------------------------------------------------------------*08940003
089500                                                                  08950003
089600 4000-BUILD-INITIAL-PANEL.                                        08960003
089700                                                                  08970003
089800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            08980003
089900                                 ASC-BLOCK-ENTRIES (2).           08990003
090000     MOVE +1                 TO  ASC-BLK-SUB.                     09000003
090100     SET ASC-ITEMS-LEFT-ON-DB                                     09010003
090200                             TO  TRUE.                            09020003
090300                                                                  09030003
090400     MOVE +0                 TO  ASC-ITEM-SUB                     09040003
090500                                 ASC-NUMBER-OF-ITEMS-READ         09050003
090600                                 ASC-NUMBER-OF-SELECTED-ITEMS     09060003
090700                                 ASC-HIGHEST-BLOCK-WRITTEN        09070003
090800                                 ASC-START-OF-SELECTED-RANGE      09080003
090900                                 ASC-END-OF-SELECTED-RANGE        09090003
091000                                 ASC-ITEM-AT-TOP-OF-PANEL.        09100003
091100                                                                  09110003
091200     MOVE SPACE              TO  ASC-DESC-LINE-IND                09120003
091300                                 ASC-CORR-LINE-IND.               09130003
091400                                                                  09140003
091500     PERFORM 4010-OPEN-CURSOR.                                    09150003
091600                                                                  09160003
091700     PERFORM 4300-READ-ITEMS-FROM-DB.                             09170003
091800                                                                  09180003
091900     PERFORM 4020-CLOSE-CURSOR.                                   09190003
092000                                                                  09200003
092100     MOVE +1                 TO  PV-TOP-ITEM.                     09210003
092200     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          09220003
092300         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    09230003
092400         SET DP020-MSG-FATAL   TO  TRUE                           09240003
092500         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               09250003
092600     ELSE                                                         09260003
092700         MOVE -1             TO ASTRTITL                          09270003
092800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      09280003
092900         PERFORM 6000-SELECT-TSHIPMT                              09290003
093000         IF SQLCODE = 0                                           09300003
093100             PERFORM 7000-SELECT-USER-INFO                        09310003
093200         END-IF                                                   09320003
093300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09330003
093400     END-IF.                                                      09340003
093500 EJECT                                                            09350003
093600*----------------------------------------------------------------*09360003
093700* OPEN THE CURSOR.                                               *09370003
093800*----------------------------------------------------------------*09380003
093900                                                                  09390003
094000 4010-OPEN-CURSOR.                                                09400003
094100                                                                  09410003
094200     EXEC SQL                                                     09420003
094300          OPEN AUSHIP-CSR                                         09430003
094400     END-EXEC.                                                    09440003
094500                                                                  09450003
094600     EVALUATE TRUE                                                09460003
094700         WHEN SQLCODE = ZERO                                      09470003
094800              CONTINUE                                            09480003
094900         WHEN SQLWARN0 NOT EQUAL SPACE                            09490003
095000         WHEN SQLCODE NOT EQUAL ZERO                              09500003
095100              MOVE '4010-OPEN-CURSOR'                             09510003
095200                           TO  DP013-PARAGRAPH                    09520003
095300              MOVE 'OPEN MESSAGE CURSOR'                          09530003
095400                           TO  DP013-MESSAGE-TEXT (1)             09540003
095500              MOVE SQLCA   TO  DP013-SQLCA                        09550003
095600              SET DP013-DB2-ABEND                                 09560003
095700                           TO  TRUE                               09570003
095800              PERFORM DP013-0000-PROCESS-ABEND                    09580003
095900     END-EVALUATE.                                                09590003
096000                                                                  09600003
096100 EJECT                                                            09610003
096200*----------------------------------------------------------------*09620003
096300* CLOSE THE CURSOR.                                              *09630003
096400*----------------------------------------------------------------*09640003
096500                                                                  09650003
096600 4020-CLOSE-CURSOR.                                               09660003
096700                                                                  09670003
096800     EXEC SQL                                                     09680003
096900         CLOSE AUSHIP-CSR                                         09690003
097000     END-EXEC.                                                    09700003
097100                                                                  09710003
097200     EVALUATE TRUE                                                09720003
097300         WHEN SQLCODE = ZERO                                      09730003
097400              CONTINUE                                            09740003
097500         WHEN SQLWARN0 NOT EQUAL SPACE                            09750003
097600         WHEN SQLCODE NOT EQUAL ZERO                              09760003
097700              MOVE '4020-CLOSE-CURSOR'                            09770003
097800                           TO  DP013-PARAGRAPH                    09780003
097900              MOVE 'CLOSE MESSAGE CURSOR'                         09790003
098000                           TO  DP013-MESSAGE-TEXT (1)             09800003
098100              MOVE SQLCA   TO  DP013-SQLCA                        09810003
098200              SET DP013-DB2-ABEND                                 09820003
098300                           TO  TRUE                               09830003
098400              PERFORM DP013-0000-PROCESS-ABEND                    09840003
098500     END-EVALUATE.                                                09850003
098600                                                                  09860003
098700 EJECT                                                            09870003
098800*----------------------------------------------------------------*09880003
098900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *09890003
099000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *09900003
099100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *09910003
099200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *09920003
099300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *09930003
099400*                                                                *09940003
099500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *09950003
099600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *09960003
099700*    UPON INITIALIZATION.                                        *09970003
099800*----------------------------------------------------------------*09980003
099900                                                                  09990003
100000 4300-READ-ITEMS-FROM-DB.                                         10000003
100100                                                                  10010003
100200     PERFORM                                                      10020003
100300         VARYING PV-READ-COUNT                                    10030003
100400         FROM 1 BY 1                                              10040003
100500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    10050003
100600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         10060003
100700                                                                  10070003
100800         PERFORM 4310-FETCH                                       10080003
100900                                                                  10090003
101000         IF  ASC-ITEMS-LEFT-ON-DB                                 10100003
101100             PERFORM 4320-GET-SUB                                 10110003
101200             MOVE AUSHIP-LAST-UPD-DTE                             10120003
101300                               TO  PV-DB2-DATE                    10130003
101400             IF PV-DB2-DATE = PC-DEFAULT-DATE                     10140003
101500                 MOVE SPACES   TO  ASC-CONFIRM-DATE               10150003
101600                                       (ASC-BLK-SUB               10160003
101700                                        ASC-ITEM-SUB)             10170003
101800             ELSE                                                 10180003
101900                 STRING  PV-DB2-DATE-MM DELIMITED BY SIZE         10190003
102000                     '/' DELIMITED BY SIZE                        10200003
102100                     PV-DB2-DATE-DD DELIMITED BY SIZE             10210003
102200                             INTO  ASC-CONFIRM-DATE               10220003
102300                                       (ASC-BLK-SUB               10230003
102400                                        ASC-ITEM-SUB)             10240003
102500             END-IF                                               10250003
102600             MOVE AUSHIP-LAST-UPD-TME                             10260003
102700                               TO  PV-DB2-TIME                    10270003
102800             IF PV-DB2-TIME = PC-DEFAULT-TIME                     10280003
102900                 MOVE SPACES   TO  ASC-CONFIRM-TIME               10290003
103000                                       (ASC-BLK-SUB               10300003
103100                                        ASC-ITEM-SUB)             10310003
103200             ELSE                                                 10320003
103300                 STRING  PV-DB2-TIME-HH DELIMITED BY SIZE         10330003
103400                     ':' DELIMITED BY SIZE                        10340003
103500                     PV-DB2-TIME-MM DELIMITED BY SIZE             10350003
103600                             INTO  ASC-CONFIRM-TIME               10360003
103700                                       (ASC-BLK-SUB               10370003
103800                                        ASC-ITEM-SUB)             10380003
103900             END-IF                                               10390003
104000             MOVE AUSHIP-LAST-UPD-UID                             10400003
104100                               TO  ASC-USER-ID                    10410003
104200                                       (ASC-BLK-SUB               10420003
104300                                        ASC-ITEM-SUB)             10430003
104400             MOVE AUSHIP-EXPTED-PKG-QTY                           10440003
104500                               TO  ASC-CONFIRM-CARTON             10450003
104600                                       (ASC-BLK-SUB               10460003
104700                                        ASC-ITEM-SUB)             10470003
104800             MOVE AUSHIP-CARR-CART-CT                             10480003
104900                               TO  ASC-FORECAST-CARTON            10490003
105000                                       (ASC-BLK-SUB               10500003
105100                                        ASC-ITEM-SUB)             10510003
105200             MOVE AUSHIP-CARR-LAST-UPD-DTE                        10520003
105300                               TO  PV-DB2-DATE                    10530003
105400             IF PV-DB2-DATE = PC-DEFAULT-DATE                     10540003
105500                 MOVE SPACES   TO  ASC-FORECAST-DATE              10550003
105600                                       (ASC-BLK-SUB               10560003
105700                                        ASC-ITEM-SUB)             10570003
105800             ELSE                                                 10580003
105900                 STRING  PV-DB2-DATE-MM DELIMITED BY SIZE         10590003
106000                     '/' DELIMITED BY SIZE                        10600003
106100                     PV-DB2-DATE-DD DELIMITED BY SIZE             10610003
106200                             INTO  ASC-FORECAST-DATE              10620003
106300                                       (ASC-BLK-SUB               10630003
106400                                        ASC-ITEM-SUB)             10640003
106500             END-IF                                               10650003
106600             MOVE AUSHIP-CARR-LAST-UPD-TIME                       10660003
106700                               TO  PV-DB2-TIME                    10670003
106800             IF PV-DB2-TIME = PC-DEFAULT-TIME                     10680003
106900                 MOVE SPACES   TO  ASC-FORECAST-TIME              10690003
107000                                       (ASC-BLK-SUB               10700003
107100                                        ASC-ITEM-SUB)             10710003
107200             ELSE                                                 10720003
107300                 STRING  PV-DB2-TIME-HH DELIMITED BY SIZE         10730003
107400                     ':' DELIMITED BY SIZE                        10740003
107500                     PV-DB2-TIME-MM DELIMITED BY SIZE             10750003
107600                             INTO  ASC-FORECAST-TIME              10760003
107700                                       (ASC-BLK-SUB               10770003
107800                                        ASC-ITEM-SUB)             10780003
107900             END-IF                                               10790003
108000             MOVE AUSHIP-VEND-CART-CT                             10800003
108100                               TO  ASC-ASN-CARTON                 10810003
108200                                       (ASC-BLK-SUB               10820003
108300                                        ASC-ITEM-SUB)             10830003
108400             MOVE AUSHIP-VEND-LAST-UPD-DTE                        10840003
108500                               TO  PV-DB2-DATE                    10850003
108600             IF PV-DB2-DATE = PC-DEFAULT-DATE                     10860003
108700                 MOVE SPACES   TO  ASC-ASN-DATE                   10870003
108800                                       (ASC-BLK-SUB               10880003
108900                                        ASC-ITEM-SUB)             10890003
109000             ELSE                                                 10900003
109100                 STRING  PV-DB2-DATE-MM DELIMITED BY SIZE         10910003
109200                     '/' DELIMITED BY SIZE                        10920003
109300                     PV-DB2-DATE-DD DELIMITED BY SIZE             10930003
109400                             INTO  ASC-ASN-DATE                   10940003
109500                                       (ASC-BLK-SUB               10950003
109600                                        ASC-ITEM-SUB)             10960003
109700             END-IF                                               10970003
109800             MOVE AUSHIP-VEND-LAST-UPD-TIME                       10980003
109900                               TO  PV-DB2-TIME                    10990003
110000             IF PV-DB2-TIME = PC-DEFAULT-TIME                     11000003
110100                 MOVE SPACES   TO  ASC-ASN-TIME                   11010003
110200                                       (ASC-BLK-SUB               11020003
110300                                        ASC-ITEM-SUB)             11030003
110400             ELSE                                                 11040003
110500                 STRING  PV-DB2-TIME-HH DELIMITED BY SIZE         11050003
110600                     ':' DELIMITED BY SIZE                        11060003
110700                     PV-DB2-TIME-MM DELIMITED BY SIZE             11070003
110800                             INTO  ASC-ASN-TIME                   11080003
110900                                       (ASC-BLK-SUB               11090003
111000                                        ASC-ITEM-SUB)             11100003
111100             END-IF                                               11110003
111200             MOVE AUSHIP-AUD-STATUS-CDE                           11120003
111300                               TO  ASC-STATUS                     11130003
111400                                       (ASC-BLK-SUB               11140003
111500                                        ASC-ITEM-SUB)             11150003
111600         END-IF                                                   11160003
111700     END-PERFORM.                                                 11170003
111800                                                                  11180003
111900     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           11190003
112000         MOVE +1                 TO ASC-BLK-SUB                   11200003
112100                                                                  11210003
112200         PERFORM 5100-WRITE-TEMP-STORAGE                          11220003
112300                                                                  11230003
112400         ADD +1                  TO ASC-BLK-SUB                   11240003
112500                                                                  11250003
112600         PERFORM 5100-WRITE-TEMP-STORAGE                          11260003
112700                                                                  11270003
112800         MOVE +1                 TO ASC-BLK-SUB                   11280003
112900                                    PV-BLOCK-NUMBER               11290003
113000                                                                  11300003
113100         PERFORM 4410-READ-TEMP-STORAGE                           11310003
113200                                                                  11320003
113300         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         11330003
113400             MOVE +2             TO ASC-BLK-SUB                   11340003
113500                                    PV-BLOCK-NUMBER               11350003
113600                                                                  11360003
113700             PERFORM 4410-READ-TEMP-STORAGE                       11370003
113800         END-IF                                                   11380003
113900     END-IF.                                                      11390003
114000                                                                  11400003
114100                                                                  11410003
114200 EJECT                                                            11420003
114300*----------------------------------------------------------------*11430003
114400*    FETCH THE TEXT CURSOR.                                      *11440003
114500*----------------------------------------------------------------*11450003
114600                                                                  11460003
114700 4310-FETCH.                                                      11470003
114800                                                                  11480003
114900     PERFORM                                                      11490003
115000         WITH TEST AFTER                                          11500003
115100         VARYING PV-SQL-SUB                                       11510003
115200         FROM 1 BY 1                                              11520003
115300         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             11530003
115400            OR SQLCODE = 0                                        11540003
115500            OR SQLCODE = +100                                     11550003
115600                                                                  11560003
115700         EXEC SQL                                                 11570003
115800              FETCH AUSHIP-CSR                                    11580003
115900              INTO  :AUSHIP-LAST-UPD-DTE                          11590003
116000                   ,:AUSHIP-LAST-UPD-TME                          11600003
116100                   ,:AUSHIP-LAST-UPD-UID                          11610003
116200                   ,:AUSHIP-EXPTED-PKG-QTY                        11620003
116300                   ,:AUSHIP-CARR-CART-CT                          11630003
116400                   ,:AUSHIP-CARR-LAST-UPD-DTE                     11640003
116500                   ,:AUSHIP-CARR-LAST-UPD-TIME                    11650003
116600                   ,:AUSHIP-VEND-CART-CT                          11660003
116700                   ,:AUSHIP-VEND-LAST-UPD-DTE                     11670003
116800                   ,:AUSHIP-VEND-LAST-UPD-TIME                    11680003
116900                   ,:AUSHIP-AUD-STATUS-CDE                        11690003
117000         END-EXEC                                                 11700003
117100                                                                  11710003
117200         EVALUATE TRUE                                            11720003
117300             WHEN SQLCODE = ZERO                                  11730003
117400             WHEN SQLCODE = +100                                  11740003
117500             WHEN SQLCODE = -904                                  11750003
117600             WHEN SQLCODE = -913                                  11760003
117700                  CONTINUE                                        11770003
117800             WHEN SQLWARN0 NOT EQUAL SPACE                        11780003
117900             WHEN SQLCODE NOT EQUAL ZERO                          11790003
118000                  MOVE '4310-FETCH-CURSOR'                        11800003
118100                               TO  DP013-PARAGRAPH                11810003
118200                  MOVE 'FETCH MESSAGE CURSOR'                     11820003
118300                               TO  DP013-MESSAGE-TEXT (1)         11830003
118400                  MOVE SQLCA   TO  DP013-SQLCA                    11840003
118500                  SET DP013-DB2-ABEND                             11850003
118600                               TO  TRUE                           11860003
118700                  PERFORM DP013-0000-PROCESS-ABEND                11870003
118800         END-EVALUATE                                             11880003
118900     END-PERFORM.                                                 11890003
119000                                                                  11900003
119100     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   11910003
119200         MOVE '4310-FETCH-CURSOR'                                 11920003
119300                               TO  DP013-PARAGRAPH                11930003
119400         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             11940003
119500                               TO  DP013-MESSAGE-TEXT (1)         11950003
119600         MOVE SQLCA            TO  DP013-SQLCA                    11960003
119700         SET DP013-DB2-ABEND   TO  TRUE                           11970003
119800         PERFORM DP013-0000-PROCESS-ABEND                         11980003
119900     END-IF.                                                      11990003
120000                                                                  12000003
120100     IF  SQLCODE EQUAL +100                                       12010003
120200         SET ASC-NO-ITEMS-LEFT-ON-DB                              12020003
120300                               TO  TRUE                           12030003
120400     END-IF.                                                      12040003
120500                                                                  12050003
120600 EJECT                                                            12060003
120700*----------------------------------------------------------------*12070003
120800*    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *12080003
120900*----------------------------------------------------------------*12090003
121000                                                                  12100003
121100 4320-GET-SUB.                                                    12110003
121200                                                                  12120003
121300     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        12130003
121400         ADD +1            TO  ASC-ITEM-SUB                       12140003
121500     ELSE                                                         12150003
121600         ADD +1            TO  ASC-BLK-SUB                        12160003
121700         MOVE +1           TO  ASC-ITEM-SUB                       12170003
121800                                                                  12180003
121900         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 12190003
122000             MOVE +1       TO  ASC-BLK-SUB                        12200003
122100             PERFORM 5100-WRITE-TEMP-STORAGE                      12210003
122200             MOVE ASC-BLOCK-ENTRIES                               12220003
122300                       (PC-MAX-BLOCKS-IN-ARRAY)                   12230003
122400             TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  12240003
122500             ADD +1        TO  ASC-BLK-SUB                        12250003
122600             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           12260003
122700         END-IF                                                   12270003
122800     END-IF.                                                      12280003
122900                                                                  12290003
123000     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               12300003
123100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        12310003
123200                                      (ASC-BLK-SUB                12320003
123300                                       ASC-ITEM-SUB).             12330003
123400                                                                  12340003
123500*----------------------------------------------------------------*12350003
123600*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *12360003
123700*----------------------------------------------------------------*12370003
123800                                                                  12380003
123900 4400-MOVE-COMMAREA-TO-SCREEN.                                    12390003
124000                                                                  12400003
124100     MOVE ASC-KEY-PRO-SCAC-ID    TO AOWSCACO.                     12410003
124200*    MOVE ASC-KEY-ORIG-SCAC      TO AOWSCACO.                     12420003
124300     MOVE ASC-KEY-LAST-UPD-UID   TO AUPDUIDO.                     12430003
124400     MOVE ASC-KEY-USER-NAME      TO AUPDNMEO.                     12440003
124500     MOVE ASC-KEY-PRO-NBR        TO AFBO.                         12450003
124600     MOVE ASC-KEY-BOL-NBR        TO ABOLO.                        12460003
124700                                                                  12470003
124800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             12480003
124900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          12490003
125000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          12500003
125100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             12510003
125200                 GIVING PV-BLOCK-NUMBER                           12520003
125300                 REMAINDER PV-REMAINDER                           12530003
125400             IF  PV-REMAINDER > ZERO                              12540003
125500                 ADD +1 TO PV-BLOCK-NUMBER                        12550003
125600             END-IF                                               12560003
125700             MOVE +1    TO ASC-BLK-SUB                            12570003
125800             PERFORM 4410-READ-TEMP-STORAGE                       12580003
125900             ADD +1     TO ASC-BLK-SUB                            12590003
126000                           PV-BLOCK-NUMBER                        12600003
126100             PERFORM 4410-READ-TEMP-STORAGE                       12610003
126200     END-IF.                                                      12620003
126300     MOVE +1                       TO ASC-BLK-SUB.                12630003
126400     COMPUTE ASC-ITEM-SUB =                                       12640003
126500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              12650003
126600         + PC-ITEMS-PER-PANEL).                                   12660003
126700                                                                  12670003
126800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        12680003
126900         ADD +1   TO ASC-BLK-SUB                                  12690003
127000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12700003
127100     END-IF.                                                      12710003
127200                                                                  12720003
127300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           12730003
127400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                12740003
127500     PERFORM 4420-FORMAT-LIST-LINES                               12750003
127600         VARYING PS-SUB                                           12760003
127700         FROM PC-ITEMS-PER-PANEL BY -1                            12770003
127800         UNTIL PS-SUB < +1.                                       12780003
127900                                                                  12790003
128000     COMPUTE ASC-ITEMS-DISPLAYED =                                12800003
128100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          12810003
128200     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    12820003
128300                                      ASTRTITO.                   12830003
128400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    12840003
128500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    12850003
128600                                                                  12860003
128700     IF  DP020-MSG-NUMBER-X = SPACE                               12870003
128800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  12880003
128900*            --- MORE ITEMS TO DISPLAY ----                       12890003
129000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            12900003
129100             SET DP020-MSG-INFORMATIONAL TO TRUE                  12910003
129200         END-IF                                                   12920003
129300     END-IF.                                                      12930003
129400                                                                  12940003
129500*----------------------------------------------------------------*12950003
129600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *12960003
129700*----------------------------------------------------------------*12970003
129800                                                                  12980003
129900 4410-READ-TEMP-STORAGE.                                          12990003
130000                                                                  13000003
130100     EXEC CICS                                                    13010003
130200         READQ TS                                                 13020003
130300             QUEUE (ASC-DTL-QUEUE-NAME)                           13030003
130400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               13040003
130500             ITEM  (PV-BLOCK-NUMBER)                              13050003
130600             RESP  (PV-CICS-RESP)                                 13060003
130700     END-EXEC.                                                    13070003
130800                                                                  13080003
130900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       13090003
131000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     13100003
131100         CONTINUE                                                 13110003
131200     ELSE                                                         13120003
131300         SET DP013-CICS-ABEND TO  TRUE                            13130003
131400         SET DP013-NO-ROLLBACK TO  TRUE                           13140003
131500         MOVE '4410-READ-TEMP-STORAGE'                            13150003
131600                               TO  DP013-PARAGRAPH                13160003
131700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      13170003
131800                               TO  DP013-MESSAGE-TEXT(1)          13180003
131900         PERFORM DP013-0000-PROCESS-ABEND                         13190003
132000     END-IF.                                                      13200003
132100                                                                  13210003
132200*    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             13220003
132300                                                                  13230003
132400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         13240003
132500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               13250003
132600     END-IF.                                                      13260003
132700 EJECT                                                            13270003
132800*----------------------------------------------------------------*13280003
132900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *13290003
133000*----------------------------------------------------------------*13300003
133100                                                                  13310003
133200 4420-FORMAT-LIST-LINES.                                          13320003
133300                                                                  13330003
133400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      13340003
133500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                13350003
133600         MOVE SPACE              TO MR-STATUS       (PS-SUB)      13360003
133700                                    MR-ASN-CARTON-X (PS-SUB)      13370003
133800                                    MR-ASN-DATE     (PS-SUB)      13380003
133900                                    MR-ASN-TIME     (PS-SUB)      13390003
134000                                    MR-FOR-CARTON-X (PS-SUB)      13400003
134100                                    MR-FOR-DATE     (PS-SUB)      13410003
134200                                    MR-FOR-TIME     (PS-SUB)      13420003
134300                                    MR-CON-CARTON-X (PS-SUB)      13430003
134400                                    MR-CON-DATE     (PS-SUB)      13440003
134500                                    MR-CON-TIME     (PS-SUB)      13450003
134600                                    MR-USER-ID      (PS-SUB)      13460003
134700     ELSE                                                         13470003
134800         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           13480003
134900             MOVE ASC-STATUS          (ASC-BLK-SUB ASC-ITEM-SUB)  13490003
135000                                 TO MR-STATUS     (PS-SUB)        13500003
135100             MOVE ASC-ASN-CARTON      (ASC-BLK-SUB ASC-ITEM-SUB)  13510003
135200                                 TO MR-ASN-CARTON (PS-SUB)        13520003
135300             MOVE ASC-ASN-DATE        (ASC-BLK-SUB ASC-ITEM-SUB)  13530003
135400                                 TO MR-ASN-DATE   (PS-SUB)        13540003
135500             MOVE ASC-ASN-TIME        (ASC-BLK-SUB ASC-ITEM-SUB)  13550003
135600                                 TO MR-ASN-TIME   (PS-SUB)        13560003
135700             MOVE ASC-FORECAST-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  13570003
135800                                 TO MR-FOR-CARTON (PS-SUB)        13580003
135900             MOVE ASC-FORECAST-DATE   (ASC-BLK-SUB ASC-ITEM-SUB)  13590003
136000                                 TO MR-FOR-DATE   (PS-SUB)        13600003
136100             MOVE ASC-FORECAST-TIME   (ASC-BLK-SUB ASC-ITEM-SUB)  13610003
136200                                 TO MR-FOR-TIME   (PS-SUB)        13620003
136300             MOVE ASC-CONFIRM-CARTON  (ASC-BLK-SUB ASC-ITEM-SUB)  13630003
136400                                 TO MR-CON-CARTON (PS-SUB)        13640003
136500             MOVE ASC-CONFIRM-DATE    (ASC-BLK-SUB ASC-ITEM-SUB)  13650003
136600                                 TO MR-CON-DATE   (PS-SUB)        13660003
136700             MOVE ASC-CONFIRM-TIME    (ASC-BLK-SUB ASC-ITEM-SUB)  13670003
136800                                 TO MR-CON-TIME   (PS-SUB)        13680003
136900             MOVE ASC-USER-ID         (ASC-BLK-SUB ASC-ITEM-SUB)  13690003
137000                                 TO MR-USER-ID    (PS-SUB)        13700003
137100         END-IF                                                   13710003
137200     END-IF.                                                      13720003
137300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               13730003
137400     IF  ASC-ITEM-SUB < + 1                                       13740003
137500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  13750003
137600         MOVE +1                 TO ASC-BLK-SUB                   13760003
137700     END-IF.                                                      13770003
137800                                                                  13780003
137900*----------------------------------------------------------------*13790003
138000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *13800003
138100*----------------------------------------------------------------*13810003
138200                                                                  13820003
138300 5100-WRITE-TEMP-STORAGE.                                         13830003
138400                                                                  13840003
138500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     13850003
138600                               TO  PV-LIST-ITEM-NUMBER.           13860003
138700     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           13870003
138800         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           13880003
138900                                                                  13890003
139000     EXEC CICS                                                    13900003
139100         WRITEQ TS                                                13910003
139200             QUEUE (ASC-DTL-QUEUE-NAME)                           13920003
139300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               13930003
139400             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     13940003
139500             RESP  (PV-CICS-RESP)                                 13950003
139600     END-EXEC.                                                    13960003
139700                                                                  13970003
139800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      13980003
139900         SET DP013-CICS-ABEND                                     13990003
140000                       TO  TRUE                                   14000003
140100         SET DP013-NO-ROLLBACK                                    14010003
140200                       TO  TRUE                                   14020003
140300         MOVE '5100-WRITE-TEMP-STORAGE'                           14030003
140400                       TO  DP013-PARAGRAPH                        14040003
140500         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       14050003
140600                       TO  DP013-MESSAGE-TEXT(1)                  14060003
140700         PERFORM DP013-0000-PROCESS-ABEND                         14070003
140800     END-IF.                                                      14080003
140900     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             14090003
141000                                                                  14100003
141100 EJECT                                                            14110003
141200*----------------------------------------------------------------*14120003
141300* READ AN CURRENT SHIPMENT ROW FROM THE TSHIPMT TABLE.           *14130003
141400*----------------------------------------------------------------*14140003
141500                                                                  14150003
141600 6000-SELECT-TSHIPMT.                                             14160003
141700     PERFORM                                                      14170003
141800         WITH TEST AFTER                                          14180003
141900         VARYING PV-RETRY-COUNTER                                 14190003
142000         FROM 1 BY 1                                              14200003
142100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14210003
142200             OR (SQLCODE = +0))                                   14220003
142300                                                                  14230003
142400         EXEC SQL                                                 14240003
142500             SELECT  LAST_UPD_UID                                 14250003
142600                    ,PRO_SCAC_ID                                  14260003
142700                    ,PRO_NBR                                      14270003
142800                    ,BOL_NBR                                      14280003
142900                    ,ORIG_SCAC_ID                                 14290003
143000            INTO     :SHIPMT-LAST-UPD-UID                         14300003
143100                    ,:SHIPMT-PRO-SCAC-ID                          14310003
143200                    ,:SHIPMT-PRO-NBR                              14320003
143300                    ,:SHIPMT-BOL-NBR                              14330003
143400                    ,:SHIPMT-ORIG-SCAC-ID                         14340003
143500           FROM   TSHIPMT                                         14350003
143600           WHERE  SHIPT_ID = :DK-SHIPT-ID                         14360003
143700         END-EXEC                                                 14370003
143800                                                                  14380003
143900         EVALUATE TRUE                                            14390003
144000             WHEN SQLCODE = +0                                    14400003
144100             WHEN SQLCODE = -904                                  14410003
144200             WHEN SQLCODE = -913                                  14420003
144300                 CONTINUE                                         14430003
144400                                                                  14440003
144500             WHEN SQLWARN0 NOT = SPACES                           14450003
144600             WHEN SQLCODE < +0                                    14460003
144700             WHEN SQLCODE > +0                                    14470003
144800                 MOVE '6000-SELECT-TSHIPMT'                       14480003
144900                                   TO DP013-PARAGRAPH             14490003
145000                 MOVE 'SELECT A TSHIPMT ROW   '                   14500003
145100                                   TO DP013-MESSAGE-TEXT(1)       14510003
145200                 MOVE SQLCA        TO DP013-SQLCA                 14520003
145300                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    14530003
145400                 SET DP013-DB2-ABEND                              14540003
145500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14550003
145600                 PERFORM DP013-0000-PROCESS-ABEND                 14560003
145700         END-EVALUATE                                             14570003
145800     END-PERFORM.                                                 14580003
145900                                                                  14590003
146000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14600003
146100         MOVE '6000-SELECT-TSHIPMT '                              14610003
146200                                   TO DP013-PARAGRAPH             14620003
146300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              14630003
146400                                   TO DP013-MESSAGE-TEXT (1)      14640003
146500         MOVE 'TO SELECT A TSHIPMT ROW'                           14650003
146600                                   TO DP013-MESSAGE-TEXT (2)      14660003
146700         MOVE SQLCA                TO DP013-SQLCA                 14670003
146800         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    14680003
146900         SET DP013-DB2-ABEND                                      14690003
147000             DP013-XCTL-DISPLAY-RESTART                           14700003
147100                                   TO TRUE                        14710003
147200         PERFORM DP013-0000-PROCESS-ABEND                         14720003
147300     END-IF.                                                      14730003
147400     IF SQLCODE = +0                                              14740003
147500         MOVE SHIPMT-LAST-UPD-UID  TO ASC-KEY-LAST-UPD-UID        14750003
147600         MOVE SHIPMT-PRO-SCAC-ID   TO ASC-KEY-PRO-SCAC-ID         14760003
147700         MOVE SHIPMT-PRO-NBR       TO ASC-KEY-PRO-NBR             14770003
147800         MOVE SHIPMT-BOL-NBR       TO ASC-KEY-BOL-NBR             14780003
147900         MOVE SHIPMT-ORIG-SCAC-ID  TO ASC-KEY-ORIG-SCAC-ID        14790003
148000     END-IF.                                                      14800003
148100                                                                  14810003
148200 EJECT                                                            14820003
148300*----------------------------------------------------------------*14830003
148400* CALL XLKUT067 TO OBTAIN THE USER NAME IN PROPER FORMAT         *14840003
148500*----------------------------------------------------------------*14850003
148600                                                                  14860003
148700 7000-SELECT-USER-INFO.                                           14870003
148800     INITIALIZE XL067-USER-COMMAREA.                              14880003
148900                                                                  14890003
149000     SET XL067-BY-USER-ID                                         14900003
149100         XL067-SELECT-KOHLS-USER TO TRUE                          14910003
149200     MOVE ASC-KEY-LAST-UPD-UID   TO XL067-KEY-USER-ID             14920003
149300                                                                  14930003
149400     CALL XL067-USER-PGM USING DFHEIBLK                           14940003
149500                               XL067-COMMAREA                     14950003
149600                               XL067-USER-COMMAREA.               14960003
149700                                                                  14970003
149800     EVALUATE TRUE                                                14980003
149900         WHEN XL067-SUCCESSFUL                                    14990003
150000             MOVE SPACES TO ASC-KEY-USER-NAME                     15000003
150100             MOVE XL067-COMBINED-NAME-2 TO ASC-KEY-USER-NAME      15010003
150200         WHEN XL067-KOHLS-NOT-FOUND                               15020003
150300         WHEN XL067-KOHLS-CONTENTION                              15030003
150400             MOVE SPACES TO ASC-KEY-USER-NAME                     15040003
150500             MOVE SPACES TO ASC-KEY-LAST-UPD-UID                  15050003
150600         WHEN OTHER                                               15060003
150700             MOVE '7000-SELECT-USER-INFO' TO DP013-PARAGRAPH      15070003
150800             MOVE 'CALL XLKUT067 '  TO DP013-MESSAGE-TEXT(1)      15080003
150900             STRING 'USER ID:  '      DELIMITED BY SIZE           15090003
151000                    XL067-KEY-USER-ID DELIMITED BY SIZE           15100003
151100                                      INTO DP013-MESSAGE-TEXT(2)  15110003
151200             MOVE XL067-SQLCA       TO DP013-SQLCA                15120003
151300             MOVE 'XLT_USR'         TO DP013-DB2-TABLE-NAME (1)   15130003
151400             SET DP013-DB2-ABEND                                  15140003
151500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15150003
151600             PERFORM DP013-0000-PROCESS-ABEND                     15160003
151700     END-EVALUATE.                                                15170003
151800                                                                  15180003
151900 EJECT                                                            15190003
152000*----------------------------------------------------------------*15200003
152100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *15210003
152200*----------------------------------------------------------------*15220003
152300                                                                  15230003
152400 9100-READ-SEL-QUEUE.                                             15240003
152500     EXEC CICS                                                    15250003
152600         READQ TS                                                 15260003
152700             QUEUE (ASC-SEL-QUEUE-NAME)                           15270003
152800             INTO  (RC013-DC-SELECT-RECORD)                       15280003
152900             ITEM  (ASC-SEL-ITEM)                                 15290003
153000             RESP  (PV-CICS-RESP)                                 15300003
153100     END-EXEC.                                                    15310003
153200                                                                  15320003
153300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       15330003
153400         CONTINUE                                                 15340003
153500     ELSE                                                         15350003
153600         SET DP013-LOGIC-ABEND                                    15360003
153700             DP013-NO-ROLLBACK     TO TRUE                        15370003
153800         MOVE '9100-READ-SEL-QUEUE'                               15380003
153900                                   TO DP013-PARAGRAPH             15390003
154000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   15400003
154100                                   TO DP013-MESSAGE-TEXT (1)      15410003
154200         PERFORM DP013-0000-PROCESS-ABEND                         15420003
154300     END-IF.                                                      15430003
154400*----------------------------------------------------------------*15440003
154500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *15450003
154600*----------------------------------------------------------------*15460003
154700 9200-REWRITE-SEL-QUEUE.                                          15470003
154800     EXEC CICS                                                    15480003
154900          WRITEQ TS                                               15490003
155000              QUEUE  (ASC-SEL-QUEUE-NAME)                         15500003
155100              FROM   (RC013-DC-SELECT-RECORD)                     15510003
155200              ITEM   (ASC-SEL-ITEM)                               15520003
155300              RESP   (PV-CICS-RESP)                               15530003
155400              REWRITE                                             15540003
155500     END-EXEC.                                                    15550003
155600                                                                  15560003
155700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   15570003
155800         SET DP013-CICS-ABEND                                     15580003
155900             DP013-NO-ROLLBACK     TO TRUE                        15590003
156000         MOVE '9200-REWRITE-SEL-QUEUE'                            15600003
156100                                   TO DP013-PARAGRAPH             15610003
156200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   15620003
156300                                   TO DP013-MESSAGE-TEXT (1)      15630003
156400         PERFORM DP013-0000-PROCESS-ABEND                         15640003
156500     END-IF.                                                      15650003
156600                                                                  15660003
156700 EJECT                                                            15670003
156800*----------------------------------------------------------------*15680003
156900*    ABEND PROCESSOR MODULE                                      *15690003
157000*----------------------------------------------------------------*15700003
157100                                                                  15710003
157200     COPY DPPD013.                                                15720003
