000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000500 PROGRAM-ID.             SUKRP039.                                00040000
000600 AUTHOR.                 XXXXXXXXXXXXXXX.                         00050000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000800 DATE-WRITTEN            JANUARY 2005.                            00070000
000900 DATE-COMPILED.                                                   00080000
001100***************************************************************** 00090000
001200*  THIS PROGRAM WILL CREATE THE DAILY TRAILER SUSPENSE REPORT - * 00100000
001300*  SHIPPED BUT NOT OPENED AT STORE REPORT.                      * 00110000
001500***************************************************************** 00120000
001600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00130000
001700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00140000
001900***************************************************************** 00150000
002000***************************************************************** 00160000
002100 ENVIRONMENT DIVISION.                                            00170000
002200***************************************************************** 00180000
002400 CONFIGURATION SECTION.                                           00190000
002600 SOURCE-COMPUTER.        IBM-3090.                                00200000
002700 OBJECT-COMPUTER.        IBM-3090.                                00210000
002800                                                                  00220000
002900 INPUT-OUTPUT SECTION.                                            00230000
003100 FILE-CONTROL.                                                    00240000
003200*                                                                 00250000
003600     SELECT INPUT-FILE                                            00260000
003700         ASSIGN TO INP01.                                         00270000
003200*                                                                 00280000
004500     SELECT REPORT-FILE                                           00290000
004600         ASSIGN TO RPT01.                                         00300000
004700*                                                                 00310000
004800***************************************************************** 00320000
004900 DATA DIVISION.                                                   00330000
005000***************************************************************** 00340000
005200 FILE SECTION.                                                    00350000
002700*                                                                 00360000
002800 FD  INPUT-FILE                                                   00370000
002900     RECORDING MODE IS F                                          00380000
003000     LABEL RECORDS ARE STANDARD                                   00390000
003200     BLOCK CONTAINS 0 RECORDS                                     00400000
003100     RECORD CONTAINS 106 CHARACTERS.                              00410016
003400 01  INPUT-RECORD                    PIC  X(106).                 00420016
005400*                                                                 00430000
007300 FD  REPORT-FILE                                                  00440000
007400     RECORDING MODE IS F                                          00450000
007500     BLOCK CONTAINS 0  RECORDS.                                   00460000
007600 01  REPORT-RECORD                   PIC  X(132).                 00470000
007700*                                                                 00480000
008900***************************************************************** 00490000
009000 WORKING-STORAGE SECTION.                                         00500000
009100*                                                                 00510000
012000 01  PROGRAM-SWITCHES.                                            00520000
012100     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00530000
012200         88  PS-END-OF-INPUT                   VALUE 'Y'.         00540000
012300         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00550000
015800*                                                                 00560000
015900 01  PV-PROGRAM-CONSTANTS.                                        00570000
           05  PV-TIMESTAMP                PIC X(26).                   00580019
                                                                        00590019
095400     05  PC-SUKRP039                 PIC X(08) VALUE  'SUKRP039'. 00600000
094700     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00610000
015800*                                                                 00620000
015900 01  PV-PROGRAM-VARIABLES.                                        00630000
           05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00640000
026400     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00650000
026500                                                   COMP-3.        00660000
026000     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00670000
026100                                                   COMP-3.        00680000
017000     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00690000
017100                                                   COMP-3.        00700000
026400     05  PV-OPER-UNT-ID              PIC S9(04) VALUE ZERO        00710000
017100                                                   COMP.          00720000
026400     05  PV-STR-NBR                  PIC S9(04) VALUE ZERO        00730000
017100                                                   COMP.          00740000
036300     05  PV-TODAYS-DATE.                                          00750000
036400         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        00760000
036500         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        00770000
036600         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        00780000
036700     05  PV-TODAYS-TIME.                                          00790000
036800         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        00800000
036900         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        00810000
037000         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        00820000
037100         10  FILLER                  PIC 9(02) VALUE ZERO.        00830000
036300     05  PV-COMPARE-DATE.                                         00840000
036400         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        00850000
036400         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        00860000
036420         10  FILLER                  PIC X(01) VALUE '-'.         00870000
036500         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        00880000
015200         10  FILLER                  PIC X(01) VALUE '-'.         00890000
036600         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        00900000
036300     05  PV-PLAN-INV-DTE.                                         00910013
036400         10  PV-PLAN-INV-DTE-CCYY    PIC 9(04) VALUE ZERO.        00920011
036420         10  FILLER                  PIC X(01) VALUE '-'.         00930011
036500         10  PV-PLAN-INV-DTE-MM      PIC 9(02) VALUE ZERO.        00940011
036420         10  FILLER                  PIC X(01) VALUE '-'.         00950011
036500         10  PV-PLAN-INV-DTE-DD      PIC 9(02) VALUE ZERO.        00960011
042900*                                                                 00970000
015000 01  PV-DATE-TIME.                                                00980000
015500     05  PV-DATE-TIME-CCYY            PIC X(04) VALUE SPACE.      00990000
015600     05  FILLER                       PIC X(01) VALUE SPACE.      01000000
015100     05  PV-DATE-TIME-MM              PIC X(02) VALUE SPACE.      01010000
015200     05  FILLER                       PIC X(01) VALUE SPACE.      01020000
015300     05  PV-DATE-TIME-DD              PIC X(02) VALUE SPACE.      01030000
015400     05  FILLER                       PIC X(01) VALUE SPACE.      01040000
015500     05  PV-DATE-TIME-HH              PIC X(02) VALUE SPACE.      01050000
015600     05  FILLER                       PIC X(01) VALUE SPACE.      01060000
015100     05  PV-DATE-TIME-MN              PIC X(02) VALUE SPACE.      01070000
015200     05  FILLER                       PIC X(01) VALUE SPACE.      01080000
015300     05  PV-DATE-TIME-SS              PIC X(02) VALUE SPACE.      01090000
015400     05  FILLER                       PIC X(07) VALUE SPACE.      01100000
042900*                                                                 01110000
015000 01  PV-DISPLAY-DATE.                                             01120000
015100     05  PV-DISPLAY-MM                PIC X(02) VALUE SPACE.      01130000
015200     05  FILLER                       PIC X(01) VALUE '/'.        01140000
015300     05  PV-DISPLAY-DD                PIC X(02) VALUE SPACE.      01150000
015400     05  FILLER                       PIC X(01) VALUE '/'.        01160000
015500     05  PV-DISPLAY-CCYY              PIC X(04) VALUE SPACE.      01170000
042900*                                                                 01180000
015000 01  PV-DISPLAY-TIME.                                             01190000
015100     05  PV-DISPLAY-HH                PIC X(02) VALUE SPACE.      01200000
015200     05  FILLER                       PIC X(01) VALUE ':'.        01210000
015300     05  PV-DISPLAY-MN                PIC X(02) VALUE SPACE.      01220000
042900*                                                                 01230000
015900 01  DK-DB2-KEY-FIELDS.                                           01240000
095400     05  DK-OPER-UNT-ID              PIC S9(04) COMP VALUE ZEROES.01250000
042900*                                                                 01260000
015900 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01270000
                                                       COMP SYNC.       01280000
042900*                                                                 01290000
043000******************************************************************01300000
043100* COPY BOOK FOR TRAILER SUSPENSE - SHIPPED BUT NOT OPENED AT STORE01310000
043200******************************************************************01320000
043400     COPY SURD055.                                                01330000
043600*                                                                 01340000
044900******************************************************************01350000
045000*  DB2 FORMATTED MESSAGE AREA                                     01360000
045100******************************************************************01370000
045200     COPY DPWS004.                                                01380000
045300*                                                                 01390000
045400******************************************************************01400000
045500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01410000
045600******************************************************************01420000
045700     COPY DPWS132O.                                               01430000
045900*                                                                 01440000
046000 01  HEADING-LINES.                                               01450000
046100     05  HEADING-LINE-1.                                          01460000
046500         10  FILLER                  PIC  X(54)    VALUE SPACES.  01470000
046300         10  FILLER                  PIC  X(23)    VALUE          01480000
046400             'TRAILER SUSPENSE REPORT'.                           01490000
046500         10  FILLER                  PIC  X(55)    VALUE SPACES.  01500002
046600*                                                                 01510000
046100     05  HEADING-LINE-2.                                          01520000
046500         10  FILLER                  PIC  X(47)    VALUE SPACES.  01530002
046300         10  FILLER                  PIC  X(37)    VALUE          01540001
046400             'INVENTORY STORES WITH CLOSED TRAILERS'.             01550001
046500         10  FILLER                  PIC  X(48)    VALUE SPACES.  01560002
049100*                                                                 01570000
052000     05  HEADING-LINE-4.                                          01580000
047400         10  FILLER                  PIC  X(71)    VALUE SPACES.  01590002
047500         10  FILLER                  PIC  X(07)    VALUE          01600001
047600             'TRAILER'.                                           01610001
047400         10  FILLER                  PIC  X(05)    VALUE SPACES.  01620002
047500         10  FILLER                  PIC  X(07)    VALUE          01630001
047600             'TRAILER'.                                           01640001
047400         10  FILLER                  PIC  X(08)    VALUE SPACES.  01650033
047500         10  FILLER                  PIC  X(14)    VALUE          01660001
047600             'TRAILER STATUS'.                                    01670001
049000         10  FILLER                  PIC  X(06)    VALUE SPACES.  01680034
047500         10  FILLER                  PIC  X(07)    VALUE          01690001
047600             'PLANNED'.                                           01700001
049000         10  FILLER                  PIC  X(09)    VALUE SPACES.  01710002
051900*                                                                 01720000
052000     05  HEADING-LINE-5.                                          01730000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  01740026
047400         10  FILLER                  PIC  X(05)    VALUE          01750001
047600             'STORE'.                                             01760001
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  01770002
047500         10  FILLER                  PIC  X(02)    VALUE          01780001
047600             'DC'.                                                01790001
047400         10  FILLER                  PIC  X(13)    VALUE SPACES.  01800002
047500         10  FILLER                  PIC  X(10)    VALUE          01810001
047600             'STORE NAME'.                                        01820001
047400         10  FILLER                  PIC  X(12)    VALUE SPACES.  01830002
047500         10  FILLER                  PIC  X(04)    VALUE          01840001
047600             'SCAC'.                                              01850001
047400         10  FILLER                  PIC  X(05)    VALUE SPACES.  01860002
047500         10  FILLER                  PIC  X(10)    VALUE          01870001
047600             'TRAILER ID'.                                        01880001
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  01890024
047500         10  FILLER                  PIC  X(06)    VALUE          01900001
047600             'SERIAL'.                                            01910001
047400         10  FILLER                  PIC  X(06)    VALUE SPACES.  01920002
047500         10  FILLER                  PIC  X(08)    VALUE          01930001
047600             '# STATUS'.                                          01940001
047400         10  FILLER                  PIC  X(09)    VALUE SPACES.  01950033
047500         10  FILLER                  PIC  X(09)    VALUE          01960001
047600             'DATE/TIME'.                                         01970001
047400         10  FILLER                  PIC  X(09)    VALUE SPACES.  01980002
047500         10  FILLER                  PIC  X(08)    VALUE          01990000
047600             'INV DATE'.                                          02000001
049000         10  FILLER                  PIC  X(08)    VALUE SPACES.  02010002
051900*                                                                 02020000
052000     05  HEADING-LINE-6.                                          02030000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02040025
047400         10  FILLER                  PIC  X(05)    VALUE          02050001
047600             '-----'.                                             02060001
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02070002
047500         10  FILLER                  PIC  X(04)    VALUE          02080001
047600             '----'.                                              02090001
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02100001
047500         10  FILLER                  PIC  X(30)    VALUE          02110023
047600             '------------------------------'.                    02120023
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02130002
047500         10  FILLER                  PIC  X(04)    VALUE          02140001
047600             '----'.                                              02150001
047400         10  FILLER                  PIC  X(05)    VALUE SPACES.  02160028
047500         10  FILLER                  PIC  X(10)    VALUE          02170001
047600             '----------'.                                        02180001
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02190030
047500         10  FILLER                  PIC  X(09)    VALUE          02200029
047600             '---------'.                                         02210029
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02220031
047500         10  FILLER                  PIC  X(10)    VALUE          02230031
047600             '----------'.                                        02240031
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02250002
047500         10  FILLER                  PIC  X(17)    VALUE          02260001
047600             '-----------------'.                                 02270001
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02280002
047500         10  FILLER                  PIC  X(10)    VALUE          02290034
047600             '----------'.                                        02300034
049000         10  FILLER                  PIC  X(07)    VALUE SPACES.  02310002
053700*                                                                 02320000
069600 01  DETAIL-LINES.                                                02330000
069700     05  DETAIL-LINE1.                                            02340000
070500         10  FILLER                 PIC  X(02)     VALUE SPACES.  02350027
069800         10  DL1-STR-NBR            PIC  Z(04)     VALUE SPACES.  02360000
071800         10  FILLER                 PIC  X(04)     VALUE SPACES.  02370002
071700         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.  02380001
071800         10  FILLER                 PIC  X(02)     VALUE SPACES.  02390001
071700         10  DL1-STORE-NM           PIC  X(30)     VALUE SPACES.  02400002
071800         10  FILLER                 PIC  X(02)     VALUE SPACES.  02410002
071700         10  DL1-SCAC               PIC  X(04)     VALUE SPACES.  02420000
071800         10  FILLER                 PIC  X(06)     VALUE SPACES.  02430002
071700         10  DL1-TRLR-ID            PIC  X(12)     VALUE SPACES.  02440000
071800         10  FILLER                 PIC  X(01)     VALUE SPACES.  02450002
071700         10  DL1-TRLR-SRL-NBR       PIC  X(09)     VALUE SPACES.  02460000
071800         10  FILLER                 PIC  X(03)     VALUE SPACES.  02470032
071700         10  DL1-TRLR-STATUS        PIC  X(10)     VALUE SPACES.  02480001
071800         10  FILLER                 PIC  X(04)     VALUE SPACES.  02490032
071700         10  DL1-DATE               PIC  X(10)     VALUE SPACES.  02500001
071800         10  FILLER                 PIC  X(02)     VALUE SPACES.  02510001
071700         10  DL1-TIME               PIC  X(05)     VALUE SPACES.  02520001
071800         10  FILLER                 PIC  X(03)     VALUE SPACES.  02530002
071700         10  DL1-PLAN-INV-DT        PIC  X(10)     VALUE SPACES.  02540011
066200*                                                                 02550000
066400 01  MISCELLANEOUS-LINES.                                         02560000
066500     05  BLANK-LINE.                                              02570000
066600         10  FILLER                  PIC  X(132)   VALUE SPACES.  02580000
066500     05  NO-DATA-LINE.                                            02590000
066600         10  FILLER                  PIC  X(42)    VALUE SPACES.  02600000
066700         10  FILLER                  PIC  X(47)    VALUE          02610000
066800             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.   02620000
066900         10  FILLER                  PIC  X(43)    VALUE SPACES.  02630000
067000     05  END-OF-REPORT-LINE.                                      02640000
067100         10  FILLER                  PIC  X(54)    VALUE SPACES.  02650000
067200         10  FILLER                  PIC  X(44)    VALUE          02660000
067300             '  ** END OF REPORT **                       '.      02670000
067100         10  FILLER                  PIC  X(44)    VALUE SPACES.  02680000
080200*                                                                 02690000
068600******************************************************************02700038
080100*  COPY BOOK FOR THE TABLE TSUOBSC                                02710038
068600******************************************************************02720038
080300     EXEC SQL                                                     02730038
080400          INCLUDE TSUOBSC                                         02740038
080500     END-EXEC.                                                    02750038
080200*                                                                 02760038
084400***************************************************************** 02770000
087310*  DB2 COMMUNICATION AREA                                         02780000
084400***************************************************************** 02790000
087500     EXEC SQL                                                     02800000
087600         INCLUDE SQLCA                                            02810000
087700     END-EXEC.                                                    02820000
087800                                                                  02830000
084400***************************************************************** 02840000
087900*  DB2 COMMUNICATION AREA2                                        02850000
084400***************************************************************** 02860000
088100     COPY SQLCA2.                                                 02870000
088200                                                                  02880000
088400                                                                  02890000
084400***************************************************************** 02900000
088500 PROCEDURE DIVISION.                                              02910000
088600*                                                                 02920000
088700 0000-MAINLINE-PROCESSING.                                        02930000
088800******************************************************************02940000
088900**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      02950000
089000******************************************************************02960000
003600     DISPLAY '****** STARTING SUKRP039 ******'.                   02970000
089800*                                                                 02980000
003800*OPEN FILES.                                                      02990000
003600     OPEN INPUT INPUT-FILE                                        03000000
004500          OUTPUT REPORT-FILE.                                     03010000
                                                                        03020019
           EXEC SQL SET :PV-TIMESTAMP = CURRENT TIMESTAMP               03030019
           END-EXEC.                                                    03040019
089800*                                                                 03050000
003800*PREPARE REPORT.                                                  03060000
089700     PERFORM 1000-INITIALIZATION.                                 03070000
089800*                                                                 03080000
089800*READ FIRST RECORD.                                               03090000
090000     SET PS-NOT-END-OF-INPUT TO TRUE.                             03100000
                                                                        03110022
090100     READ INPUT-FILE                                              03120000
             INTO SU055-EXTRACT-RECORD                                  03130008
               AT END                                                   03140000
090000           SET PS-END-OF-INPUT TO TRUE.                           03150000
090200*                                                                 03160000
089800*PROCESS INPUT FILE.                                              03170000
090000     IF PS-END-OF-INPUT                                           03180000
           ADD +1                  TO PV-PAGE-COUNT                     03190000
           MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER                03200000
091000     WRITE REPORT-RECORD                                          03210000
091100       FROM DP132O-STANDRD-HEADER-132-COLS                        03220000
091200         AFTER ADVANCING PAGE                                     03230000
 91000     WRITE REPORT-RECORD                                          03240000
091100       FROM HEADING-LINE-1                                        03250000
091200         AFTER ADVANCING 2 LINES                                  03260000
091000     WRITE REPORT-RECORD                                          03270000
091100       FROM HEADING-LINE-2                                        03280000
091200         AFTER ADVANCING 1 LINE                                   03290000
091000     WRITE REPORT-RECORD                                          03300000
091100       FROM NO-DATA-LINE                                          03310000
091200         AFTER ADVANCING 2 LINES                                  03320000
           ELSE                                                         03330000
091000         PERFORM 1500-PAGE-BREAK                                  03340022
090300         PERFORM 2000-PROCESS-INPUT UNTIL PS-END-OF-INPUT         03350000
           END-IF.                                                      03360000
090500*                                                                 03370000
090500*FINISH REPORT.                                                   03380000
091000     WRITE REPORT-RECORD                                          03390000
091100       FROM END-OF-REPORT-LINE                                    03400000
091200         AFTER ADVANCING 2 LINES.                                 03410000
091300*                                                                 03420000
091300*CLOSE FILES.                                                     03430000
003600     CLOSE INPUT-FILE                                             03440000
004500           REPORT-FILE.                                           03450000
092500*                                                                 03460000
092600     GOBACK.                                                      03470000
092800*                                                                 03480000
092800******************************************************************03490000
092900 1000-INITIALIZATION.                                             03500000
093000******************************************************************03510000
093100**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03520000
093200******************************************************************03530000
094100     ACCEPT PV-TODAYS-DATE                                        03540000
094200       FROM DATE.                                                 03550000
094300*                                                                 03560000
094400     ACCEPT PV-TODAYS-TIME                                        03570000
094500       FROM TIME.                                                 03580000
094600*                                                                 03590000
094800     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  03600000
                                      PV-COMPARE-DATE-MM.               03610000
094900     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    03620000
                                      PV-COMPARE-DATE-DD.               03630000
095000     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   03640000
                                      PV-COMPARE-DATE-YY.               03650000
095000     IF PV-COMPARE-DATE-YY  >  80                                 03660000
0950           MOVE  19            TO PV-COMPARE-DATE-CC                03670000
095000     ELSE                                                         03680000
0950           MOVE  20            TO PV-COMPARE-DATE-CC                03690000
095000     END-IF.                                                      03700000
095100*                                                                 03710000
095200     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  03720000
095300     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                03730000
095100*                                                                 03740000
095400     MOVE PC-SUKRP039        TO DP132O-PROGRAM-NAME.              03750000
094700     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             03760000
095500*                                                                 03770000
           MOVE +0                 TO PV-PAGE-COUNT.                    03780000
      *                                                                 03790000
095500*                                                                 03800000
112300******************************************************************03810000
112400**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03820000
112500**  PAGES (AS NEEDED).                                            03830000
112700******************************************************************03840000
112200 1500-PAGE-BREAK.                                                 03850022
      *                                                                 03860000
           ADD +1                  TO PV-PAGE-COUNT.                    03870021
           MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               03880021
      *                                                                 03890021
091000     WRITE REPORT-RECORD                                          03900021
091100       FROM DP132O-STANDRD-HEADER-132-COLS                        03910021
091200         AFTER ADVANCING PAGE.                                    03920021
095500*                                                                 03930021
091000     WRITE REPORT-RECORD                                          03940021
091100       FROM HEADING-LINE-1                                        03950021
091200         AFTER ADVANCING 2 LINES.                                 03960021
095500*                                                                 03970021
091000     WRITE REPORT-RECORD                                          03980021
091100       FROM HEADING-LINE-2                                        03990021
091200         AFTER ADVANCING 1 LINE.                                  04000021
095500*                                                                 04010021
095500*                                                                 04020021
091000     WRITE REPORT-RECORD                                          04030021
091100       FROM HEADING-LINE-4                                        04040021
091200         AFTER ADVANCING 2 LINE.                                  04050021
095500*                                                                 04060021
091000     WRITE REPORT-RECORD                                          04070021
091100       FROM HEADING-LINE-5                                        04080021
091200         AFTER ADVANCING 1 LINE.                                  04090021
095500*                                                                 04100021
091000     WRITE REPORT-RECORD                                          04110021
091100       FROM HEADING-LINE-6                                        04120021
091200         AFTER ADVANCING 1 LINE.                                  04130021
095500*                                                                 04140021
           MOVE +7                 TO PV-LINE-COUNT.                    04150022
095500*                                                                 04160022
095500*                                                                 04170000
121500******************************************************************04180000
121600**  READ INPUT-FILE, WHEN DC CHANGES, TO A PAGE BREAK             04190000
121800******************************************************************04200000
090300 2000-PROCESS-INPUT.                                              04210000
           IF SU055-PLND-INV-DTE  NOT = PV-PLAN-INV-DTE                 04220036
               MOVE SU055-PLND-INV-DTE TO PV-PLAN-INV-DTE               04230036
091000         WRITE REPORT-RECORD                                      04240036
091100          FROM BLANK-LINE                                         04250036
091200         AFTER ADVANCING 1 LINE                                   04260036
               ADD +1                  TO PV-LINE-COUNT                 04270040
               PERFORM 2100-PRINT-DETAIL-LINE                           04280036
           ELSE                                                         04290036
               PERFORM 2100-PRINT-DETAIL-LINE.                          04300036
                                                                        04310020
122300     PERFORM 3000-READ-EXTRACT-FILE.                              04320017
                                                                        04330017
097900*                                                                 04340000
121800******************************************************************04350000
113000 2100-PRINT-DETAIL-LINE.                                          04360000
097900*                                                                 04370000
071700     MOVE SU055-LOC-NBR            TO DL1-STR-NBR.                04380008
071700     MOVE SU055-ORGN-OPER-UNT-ID   TO DL1-OPER-UNT.               04390010
071700     MOVE SU055-LOC-NM             TO DL1-STORE-NM.               04400008
071700     MOVE SU055-SHIP-SCAC-CDE      TO DL1-SCAC.                   04410009
071700     MOVE SU055-TRLR-ID            TO DL1-TRLR-ID.                04420008
071700     MOVE SU055-TRLR-SRL-NBR       TO DL1-TRLR-SRL-NBR.           04430008
071700*    MOVE SU055-TRIP-STAT-CDE      TO DL1-TRLR-STATUS.            04440037
071700     MOVE SU055-OTBND-STAT-TMST    TO PV-DATE-TIME.               04450010
071700     MOVE PV-DATE-TIME-CCYY        TO PV-DISPLAY-CCYY.            04460035
071700     MOVE PV-DATE-TIME-MM          TO PV-DISPLAY-MM.              04470035
071700     MOVE PV-DATE-TIME-DD          TO PV-DISPLAY-DD.              04480035
071700     MOVE PV-DATE-TIME-HH          TO PV-DISPLAY-HH.              04490035
071700     MOVE PV-DATE-TIME-MN          TO PV-DISPLAY-MN.              04500035
071700     MOVE PV-DISPLAY-DATE          TO DL1-DATE.                   04510035
071700     MOVE PV-DISPLAY-TIME          TO DL1-TIME.                   04520035
           MOVE PV-DISPLAY-DATE          TO DL1-DATE.                   04530011
           MOVE PV-DISPLAY-TIME          TO DL1-TIME.                   04540011
071700     MOVE SU055-PLND-INV-DTE       TO DL1-PLAN-INV-DT.            04550012
071700                                                                  04560037
071700     PERFORM 2200-GET-TRLR-STATUS.                                04570037
097900*                                                                 04580000
           ADD +1 TO PV-LINE-COUNT.                                     04590000
           IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         04600000
               PERFORM 1500-PAGE-BREAK                                  04610022
           END-IF.                                                      04620000
097900*                                                                 04630000
091000     WRITE REPORT-RECORD                                          04640000
091100       FROM DETAIL-LINE1                                          04650000
091200         AFTER ADVANCING 1 LINE.                                  04660011
095500*                                                                 04670000
121800******************************************************************04680037
199933 2200-GET-TRLR-STATUS.                                            04690037
199934                                                                  04700037
199935     EXEC SQL                                                     04710037
199936          SELECT STAT_SHRT_DESC                                   04720037
199937            INTO :SUOBSC-STAT-SHRT-DESC                           04730037
199938            FROM TSUOBSC                                          04740037
199939           WHERE TRIP_STAT_CDE  =  :SU055-TRIP-STAT-CDE           04750037
199940     END-EXEC.                                                    04760037
199941                                                                  04770037
199942     EVALUATE TRUE                                                04780037
199943         WHEN SQLCODE EQUAL 0                                     04790037
199944              MOVE  SUOBSC-STAT-SHRT-DESC TO  DL1-TRLR-STATUS     04800037
199945                                                                  04810037
199946         WHEN OTHER                                               04820041
199944              MOVE  'UNKNOWN'             TO  DL1-TRLR-STATUS     04830041
199955     END-EVALUATE.                                                04840037
259500*                                                                 04850000
243800******************************************************************04860000
243900*  READ A RECORD FROM THE TRAILER SUSPENSE UNLOAD FILE.          *04870000
244000******************************************************************04880000
122300 3000-READ-EXTRACT-FILE.                                          04890000
244200     READ INPUT-FILE                                              04900000
244300       INTO SU055-EXTRACT-RECORD                                  04910008
244400         AT END                                                   04920000
244500           SET PS-END-OF-INPUT TO TRUE.                           04930000
095500*                                                                 04940000
277000******************************************************************04950000
277100*     SQL WARNING OR ERROR PROCESSING                            *04960000
277200******************************************************************04970000
277500 Z999-SQL-ERROR.                                                  04980000
277800     MOVE SQLCODE    TO SQLCODE2.                                 04990000
277900     MOVE SQLERRD(3) TO SQLERRD3.                                 05000000
278000     DISPLAY '** ABEND **       ** = SQLERROR'.                   05010000
278100     DISPLAY '** PROGRAM        ** = SUKRP039'.                   05020000
278200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  05030000
278300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  05040000
278400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   05050000
278500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  05060000
278600*                                                                 05070000
278700******************************************************************05080000
278800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    05090000
278900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         05100000
279000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     05110000
279100* FORMAT.                                                         05120000
279200******************************************************************05130000
279300     COPY DPPD004.                                                05140000
279400*                                                                 05150000
279500     MOVE +4003 TO  ABEND-CODE.                                   05160000
279600     CALL 'ILBOABN0' USING ABEND-CODE.                            05170000
279200******************************************************************05180000
