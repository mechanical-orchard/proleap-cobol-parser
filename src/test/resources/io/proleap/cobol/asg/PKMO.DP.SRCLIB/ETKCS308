000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    ETKCS308.                                         00020000
000300 AUTHOR.        MARC BLAZICH. G&R.                                00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  01-21-94.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - E308                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100000
001100*    DESCRIPTION - TRADING PARTNER MAINTENANCE                  * 00110000
001200*    MAPSET      - EDKM308                                      * 00120000
001300*                                                               * 00130000
001400*    THIS PROGRAM WILL ADD, UPDATE, AND DELETE TRADING PARTNER  * 00140000
001500*    RELATIONSHIPS.                                             * 00150000
001600*                                                               * 00160000
001700*---------------------------------------------------------------* 00170000
001800* CHANGES:                                                        00180000
001900*  5/31/2000                                                      00190000
002000*    ADD A NEW MESSAGE WHICH DISPLAYS A WARNING WHEN A DUPLICATE  00200000
002100*    TRADING PARTNER WAS ADDED WITH THE SAME EXCHANGE IDS.        00210000
002200*    MADE BY: ROD JANSSEN            WR/IR #: 99999               00220000
002300******************************************************************00230000
002400*  DATE  05/14/03                                                 00240000
002500*  CHANGE MADE:                                                   00250000
002600*   ADDED CODE TO SEND ENT-ID IN MQSERIES UPDATE OF RMS/SUPPLIER. 00260000
002700*  MADE BY: JON FIEDLER             WR# : 24663                   00270000
002800******************************************************************00280000
002900*  DATE  06/16/03                                                 00290000
003000*  CHANGE MADE:                                                   00300000
003100*  FIXED ISSUE WITH INCORRECT PO AND ASN INDICATORS BEING SENT    00310000
003200*  OVER TO THE RMS/SUPPLIER SYSTEM. THIS ISSUE INVOLVES VENDORS   00320000
003300*  WHO HAVE MULTIPLE IDS. THE CHECK FOR PO AND ASN SETUP ONLY     00330000
003400*  LOOKED AT THE CURRENT TP_DKEY BEING ADDED, UPDATED, OR DELETED.00340000
003500*  THE CODE WILL NOW LOOK AT PO AND ASN SETUP FOR A PARTICULAR    00350000
003600*  ENT_ID AND WILL CHECK ALL TP_DKEYS INVOLVING ONE VENDOR FOR    00360000
003700*  PO AND ASN SETUP.                                              00370000
003800*  MADE BY: JON FIEDLER             WR# : 23521                   00380000
003900******************************************************************00390000
004000*  DATE  06/26/2003                                               00400000
004100*  CHANGE MADE:                                                   00410000
004200*   CHANGED THE PO/ASN SETUP CHECK TO EXTRACT BOTH TEST AND       00420000
004300*   PRODUCTION TRANSACTION SETS.                                  00430000
004400*  MADE BY: JON FIEDLER             WR# : 23521                   00440000
004500******************************************************************00450000
004600******************************************************************00460000
004700*  DATE  12/28/2005                                               00470000
004800*  CHANGE MADE:                                                   00480000
004900*   CORRECTED THE PROBLEM OF 2ND TRADING PARTNER BEING            00490000
005000*   OVERLAYED WHEN NETWORK IS CHANGED                             00500000
005100*  MADE BY: WADE GROVE              WR# : 27805                   00510000
005101******************************************************************00510102
005110* 10/11/2021 GERMAN BANDA                    WR/IR #: CHG0262418* 00511002
005120*            - CHANGE CALL OF DPKUT100 TO                       * 00512002
005130*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00513002
005140*              MAKING THE CALL DYNAMIC VS STATIC                * 00514002
005150*                                                               * 00515002
005200******************************************************************00520000
CICS  *  CHANGED 10/25/2022    BY BARB SCHULTZ    WR: CHG0277210        00530004
CICS  *                                                                 00531003
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     00532003
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      00533003
CICS  ******************************************************************00535003
005400 ENVIRONMENT DIVISION.                                            00540000
005500 DATA DIVISION.                                                   00550000
005600                                                                  00560000
005700/                                                                 00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900                                                                  00590000
006000 01  WS-DUPL-KEY-WARN-MSG-SW          PIC X(01) VALUE 'N'.        00600000
006100     88  DUPLICATE-WARNING-SUCCESS              VALUE 'Y'.        00610000
006200                                                                  00620000
006300 01  DK-DB2-KEYS.                                                 00630000
006400     05  DK-ENT-ID                    PIC S9(09) VALUE +0         00640000
006500                                                 COMP.            00650000
006600     05  DK-TP-DKEY-LOW               PIC S9(09) VALUE +0         00660000
006700                                                 COMP.            00670000
006800     05  DK-TP-DKEY-HIGH              PIC S9(09) VALUE +0         00680000
006900                                                 COMP.            00690000
007000     05  DK-VEND-INCHG-ID             PIC  X(15).                 00700000
007100     05  DK-VEND-INCHG-ID-HIGH        PIC  X(15).                 00710000
007200     05  DK-VEND-INCHG-ID-QUAL        PIC  X(02).                 00720000
007300     05  DK-VEND-INCHG-ID-QUAL-HIGH   PIC  X(02).                 00730000
007400     05  DK-NETWK-ID                  PIC  X(01).                 00740000
007500     05  DK-NETWK-ID-LOW              PIC  X(01).                 00750000
007600     05  DK-NETWK-ID-HIGH             PIC  X(01).                 00760000
007700                                                                  00770000
007800 01  PC-PROGRAM-CONSTANTS.                                        00780000
007900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00790000
008000                                                    'ET308A  '.   00800000
008100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00810000
008200                                                    'ETKM308 '.   00820000
008300     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00830000
008400                                                    COMP.         00840000
008500     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00850000
008600                                                    'ETKCS308'.   00860000
008700     05  PC-DPKUT100                    PIC  X(08)  VALUE         00870000
008800                                                    'DPKUT100'.   00880000
008900     05  PC-DPKUT500                    PIC  X(08)  VALUE         00890000
009000                                                    'DPKUT500'.   00900000
009100     05  PC-NULL-DATE                   PIC  X(10)  VALUE         00910000
009200                                                    '9999-09-09'. 00920000
009300     05  PC-PRIME1                      PIC S9(05)   COMP-3       00930000
009400                                            VALUE +38543.         00940000
009500     05  PC-PRIME2                      PIC S9(05)   COMP-3       00950000
009600                                            VALUE +58889.         00960000
009700     05  PC-ONE-BILLION                 PIC S9(11)   COMP-3       00970000
009800                                            VALUE +1000000000.    00980000
009900     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00990000
010000                                                    COMP-3.       01000000
010100     05  PC-SER-LVL                     PIC  X(03).               01010000
010200         88  PC-VALID-SER-LVL           VALUE 'INT' 'DOC'         01020000
010300                                              'ANY' 'FAX' '   '.  01030000
010400     05  PC-VNKCS024                    PIC X(08) VALUE           01040000
010500                                                    'VNKCS024'.   01050000
010600     05  PC-TSYMSG-NUMBERS.                                       01060000
010700         10  PC-TSYMSG-00004            PIC  9(05)  VALUE  00004. 01070000
010800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE  00005. 01080000
010900         10  PC-TSYMSG-00007            PIC  9(05)  VALUE  00007. 01090000
011000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE  00008. 01100000
011100         10  PC-TSYMSG-00009            PIC  9(05)  VALUE  00009. 01110000
011200         10  PC-TSYMSG-00016            PIC  9(05)  VALUE  00016. 01120000
011300         10  PC-TSYMSG-00034            PIC  9(05)  VALUE  00034. 01130000
011400         10  PC-TSYMSG-00046            PIC  9(05)  VALUE  00046. 01140000
011500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE  00057. 01150000
011600         10  PC-TSYMSG-00059            PIC  9(05)  VALUE  00059. 01160000
011700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE  00069. 01170000
011800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE  00070. 01180000
011900         10  PC-TSYMSG-00112            PIC  9(05)  VALUE  00112. 01190000
012000         10  PC-TSYMSG-00115            PIC  9(05)  VALUE  00115. 01200000
012100         10  PC-TSYMSG-00116            PIC  9(05)  VALUE  00116. 01210000
012200         10  PC-TSYMSG-00117            PIC  9(05)  VALUE  00117. 01220000
012300         10  PC-TSYMSG-00134            PIC  9(05)  VALUE  00134. 01230000
012400         10  PC-TSYMSG-00148            PIC  9(05)  VALUE  00148. 01240000
012500         10  PC-TSYMSG-00158            PIC  9(05)  VALUE  00158. 01250000
012600         10  PC-TSYMSG-00164            PIC  9(05)  VALUE  00164. 01260000
012700         10  PC-TSYMSG-00165            PIC  9(05)  VALUE  00165. 01270000
012800         10  PC-TSYMSG-00224            PIC  9(05)  VALUE  00224. 01280000
012900         10  PC-TSYMSG-00231            PIC  9(05)  VALUE  00231. 01290000
013000         10  PC-TSYMSG-00349            PIC  9(05)  VALUE  00349. 01300000
013100         10  PC-TSYMSG-00396            PIC  9(05)  VALUE  00396. 01310000
013200         10  PC-TSYMSG-00757            PIC  9(05)  VALUE  00757. 01320000
013300         10  PC-TSYMSG-00758            PIC  9(05)  VALUE  00758. 01330000
013400         10  PC-TSYMSG-00759            PIC  9(05)  VALUE  00759. 01340000
013500         10  PC-TSYMSG-00760            PIC  9(05)  VALUE  00760. 01350000
013600         10  PC-TSYMSG-00761            PIC  9(05)  VALUE  00761. 01360000
013700         10  PC-TSYMSG-00762            PIC  9(05)  VALUE  00762. 01370000
013800         10  PC-TSYMSG-00832            PIC  9(05)  VALUE  00832. 01380000
013900         10  PC-TSYMSG-00833            PIC  9(05)  VALUE  00833. 01390000
014000         10  PC-TSYMSG-00834            PIC  9(05)  VALUE  00834. 01400000
014100         10  PC-TSYMSG-00835            PIC  9(05)  VALUE  00835. 01410000
014200         10  PC-TSYMSG-00839            PIC  9(05)  VALUE  00839. 01420000
014300         10  PC-TSYMSG-02491            PIC  9(05)  VALUE  02491. 01430000
014400                                                                  01440000
014500 01  PV-PROGRAM-VARIABLES.                                        01450000
014600     05  PV-INT-APPL-FORMAT-IND         PIC  X(01).               01460000
014700         88  PV-INTER-APPL-CRIT-ADD                 VALUE ' '.    01470000
014800         88  PV-INTER-APPL-LIST-UPDATE              VALUE '4'.    01480000
014900         88  PV-INTER-APPL-LIST-DELETE              VALUE '5'.    01490000
015000                                                                  01500000
015100     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      01510000
015200                                                    COMP SYNC.    01520000
015300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01530000
015400                                                    COMP SYNC.    01540000
015500     05  PV-WORK-FIELD                   PIC S9(17)   COMP-3      01550000
015600                                                      VALUE +0.   01560000
015700     05  PV-WORK-FIELD2                  PIC S9(17)   COMP-3      01570000
015800                                                      VALUE +0.   01580000
015900     05  PV-RANDOM-NUMBER                PIC S9(11)   COMP-3      01590000
016000                                                      VALUE +0.   01600000
016100     05  PV-SEED                         PIC 9(8).                01610000
016200     05  FILLER REDEFINES PV-SEED.                                01620000
016300         10  PV-SEED-BYTE-1-2            PIC 9(02).               01630000
016400         10  PV-SEED-BYTE-3-4            PIC 9(02).               01640000
016500         10  PV-SEED-BYTE-5-6            PIC 9(02).               01650000
016600         10  PV-SEED-BYTE-7-8            PIC 9(02).               01660000
016700                                                                  01670000
016800     05  PV-CCYYMMDD-DATE               PIC  X(10).               01680000
016900     05  PV-CCYYMMDD-DATE-RDF           REDEFINES                 01690000
017000         PV-CCYYMMDD-DATE.                                        01700000
017100         10  PV-CCYY                    PIC  X(04).               01710000
017200         10  PV-CCYY-9   REDEFINES PV-CCYY                        01720000
017300                                        PIC  9(04).               01730000
017400         10  PV-CCYY-RDF REDEFINES PV-CCYY.                       01740000
017500             15  PV-CC                  PIC  9(02).               01750000
017600             15  PV-YY                  PIC  9(02).               01760000
017700         10  PV-DASH1                   PIC  X(01).               01770000
017800         10  PV-MM                      PIC  X(02).               01780000
017900         10  PV-MM-9     REDEFINES PV-MM                          01790000
018000                                        PIC  9(02).               01800000
018100         10  PV-DASH2                   PIC  X(01).               01810000
018200         10  PV-DD                      PIC  X(02).               01820000
018300         10  PV-DD-9     REDEFINES PV-DD                          01830000
018400                                        PIC  9(02).               01840000
018500     05  PV-DUP-COUNTER                 PIC S9(04) COMP.          01850000
018600     05  PV-TRAN-SET-CDE                PIC  X(03).               01860000
018700     05  PV-PROD-TEST-IND               PIC  X(01).               01870000
018800                                                                  01880000
018900 01  PS-PROGRAM-SWITCHES.                                         01890000
019000     05  PS-EDIT-KOHLS-TP-SW            PIC  X(01).               01900000
019100         88  PS-DO-KOHLS-TP-EDIT                    VALUE 'Y'.    01910000
019200         88  PS-SKIP-KOHLS-TP-EDIT                  VALUE 'N'.    01920000
019300     05  PS-TP-ID-OK-SW                 PIC  X(01).               01930000
019400         88  PS-TP-ID-OK                            VALUE 'Y'.    01940000
019500         88  PS-TP-ID-ERR                           VALUE 'N'.    01950000
019600     05  PS-HEX-FIELD-OK-SW             PIC  X(01).               01960000
019700         88  PS-HEX-FIELD-OK                        VALUE 'Y'.    01970000
019800         88  PS-HEX-FIELD-ERR                       VALUE 'N'.    01980000
019900     05  PS-VALID-DATE-SW               PIC  X(01).               01990000
020000         88  PS-VALID-DATE                          VALUE 'Y'.    02000000
020100         88  PS-INVALID-DATE                        VALUE 'N'.    02010000
020200     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02020000
020300         88  PS-NO-ERROR                            VALUE 'Y'.    02030000
020400         88  PS-ERROR                               VALUE 'N'.    02040000
020500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02050000
020600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02060000
020700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02070000
020800     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02080000
020900         88  PS-DONE                                VALUE 'Y'.    02090000
021000         88  PS-NOT-DONE                            VALUE 'N'.    02100000
021100     05  PS-KOHLS-TP-INFO-FILLED-IN-SW  PIC  X(01).               02110000
021200         88  PS-KOHLS-TP-INFO-FILLED-IN             VALUE 'Y'.    02120000
021300         88  PS-KOHLS-TP-INFO-BLANK                 VALUE 'N'.    02130000
021400     05  PS-VENDOR-TP-INFO-FILLED-IN-SW PIC  X(01).               02140000
021500         88  PS-VENDOR-TP-INFO-FILLED-IN            VALUE 'Y'.    02150000
021600         88  PS-VENDOR-TP-INFO-BLANK                VALUE 'N'.    02160000
021700     05  PS-MQ-SEND-SW                  PIC  X(01)  VALUE 'N'.    02170000
021800         88  PS-SEND                                VALUE 'Y'.    02180000
021900         88  PS-DONT-SEND                           VALUE 'N'.    02190000
022000     05  PS-DELETE-SW                   PIC  X(01)  VALUE 'N'.    02200000
022100         88  PS-DELETE                              VALUE 'Y'.    02210000
022200         88  PS-NON-DELETE                          VALUE 'N'.    02220000
022300     05  PS-INACTIVE-SW                 PIC  X(01)  VALUE 'N'.    02230000
022400         88  PS-INACTIVE                            VALUE 'Y'.    02240000
022500         88  PS-ACTIVE                              VALUE 'N'.    02250000
022600     05  PS-PO-SETUP-SW                 PIC  X(01)  VALUE 'N'.    02260000
022700         88  PS-PO-SETUP                            VALUE 'Y'.    02270000
022800         88  PS-PO-NOT-SETUP                        VALUE 'N'.    02280000
022900     05  PS-ASN-SETUP-SW                PIC  X(01)  VALUE 'N'.    02290000
023000         88  PS-ASN-SETUP                           VALUE 'Y'.    02300000
023100         88  PS-ASN-NOT-SETUP                       VALUE 'N'.    02310000
023200     05  PS-POCHG-SETUP-SW              PIC  X(01)  VALUE 'N'.    02320000
023300         88  PS-POCHG-SETUP                         VALUE 'Y'.    02330000
023400         88  PS-POCHG-NOT-SETUP                     VALUE 'N'.    02340000
023500                                                                  02350000
023600*----------------------------------------------------------------*02360000
023700*      EDI INTERCHANGE SEPARATOR AND SEGMENT TERMINATOR TABLE    *02370000
023800*---------------------------------------------------------------* 02380000
023900                                                                  02390000
024000     COPY MPWS023I.                                               02400000
024100                                                                  02410000
024200/                                                                 02420000
024300*---------------------------------------------------------------* 02430000
024400*  RECORD LAYOUT FOR THE TP ID QUALIFIER VALIDATION             * 02440000
024500*---------------------------------------------------------------* 02450000
024600                                                                  02460000
024700     COPY ETWS305.                                                02470000
024800                                                                  02480000
024900/                                                                 02490000
025000*---------------------------------------------------------------* 02500000
025100*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02510000
025200*---------------------------------------------------------------* 02520000
025300                                                                  02530000
025400     COPY ETWS301.                                                02540000
025500                                                                  02550000
025600/                                                                 02560000
025700*---------------------------------------------------------------* 02570000
025800*    MAP LAYOUT                                                 * 02580000
025900*---------------------------------------------------------------* 02590000
026000                                                                  02600000
026100     COPY ETKM308.                                                02610000
026200                                                                  02620000
026300/                                                                 02630000
026400*---------------------------------------------------------------* 02640000
026500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02650000
026600*---------------------------------------------------------------* 02660000
026700                                                                  02670000
026800     COPY DPWS015.                                                02680000
026900                                                                  02690000
027000*---------------------------------------------------------------* 02700000
027100*    FUNCTION KEYS COPYBOOK.                                    * 02710000
027200*---------------------------------------------------------------* 02720000
027300                                                                  02730000
027400     COPY DPWS016.                                                02740000
027500                                                                  02750000
027600**--------------------------------------------------------------* 02760000
027700** COMMAREA FOR VNKCS024                                        * 02770000
027800**--------------------------------------------------------------* 02780000
027900 01 VN007-COMMAREA.                                               02790000
028000     COPY VNWS007.                                                02800000
028100 EJECT                                                            02810000
028200*---------------------------------------------------------------* 02820000
028300*  WORK AREA PASSED IN CALL TO DPKUT500 DATE ROUTINE            * 02830000
028400*---------------------------------------------------------------* 02840000
028500     COPY DPWS500.                                                02850000
028600                                                                  02860000
028700/                                                                 02870000
028800*---------------------------------------------------------------* 02880000
028900*  WORK AREA FOR NUMERIC EDIT ROUTINE - DPKUT100                * 02890000
029000*---------------------------------------------------------------* 02900000
029100     COPY DPWS010I.                                               02910000
029200                                                                  02920000
029300/                                                                 02930000
029400*---------------------------------------------------------------* 02940000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02950003
029600*---------------------------------------------------------------* 02960000
029700                                                                  02970000
029800     COPY DPWS030.                                                02980000
CICS       COPY DPWS930.                                                02981003
029900                                                                  02990000
030000/                                                                 03000000
030100*---------------------------------------------------------------* 03010000
030200*    STANDARD COMMAREA.                                         * 03020000
030300*---------------------------------------------------------------* 03030000
030400                                                                  03040000
030500     COPY DPWS020.                                                03050000
030600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03060000
030700                                                                  03070000
030800         10  INTER-APPL-COMM-AREA       PIC X(200).               03080000
030900     COPY ETWS300.                                                03090000
031000***************************************************************** 03100000
031100*  INTER-APPLICATION COMMAREA FOR VENDOR BUSINESS LIST          * 03110000
031200***************************************************************** 03120000
031300                                                                  03130000
031400     COPY VNWS001.                                                03140000
031500                                                                  03150000
031600*---------------------------------------------------------------* 03160000
031700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03170000
031800*---------------------------------------------------------------* 03180000
031900         10  ASC-SPECIFIC-COMMAREA.                               03190000
032000             15  ASC-INT-APPL-FORMAT-IND    PIC X(01).            03200000
032100             15  ASC-ACTION-SW              PIC X(03).            03210000
032200                 88  ASC-ADD-PENDING        VALUE 'ADD'.          03220000
032300                 88  ASC-DELETE-PENDING     VALUE 'DEL'.          03230000
032400                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          03240000
032500             15  ASC-DELETE-SUCCESSFUL-SW   PIC X(01).            03250000
032600                 88  ASC-DELETE-SUCCESSFUL  VALUE 'Y'.            03260000
032700             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).            03270000
032800                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.            03280000
032900                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.            03290000
033000             15  ASC-FIELDS-CHANGED-SW      PIC X(01).            03300000
033100                 88  ASC-FIELDS-CHANGED     VALUE 'Y'.            03310000
033200             15  ASC-NETWK-INFO-FOUND-SW    PIC X(01).            03320000
033300                 88  ASC-NETWK-INFO-FOUND   VALUE 'Y'.            03330000
033400                 88  ASC-NETWK-INFO-NOT-FOUND                     03340000
033500                                            VALUE 'N'.            03350000
033600             15  ASC-VENDOR-INFO-FOUND-SW   PIC X(01).            03360000
033700                 88  ASC-VENDOR-INFO-FOUND  VALUE 'Y'.            03370000
033800                 88  ASC-VENDOR-INFO-NOT-FOUND                    03380000
033900                                            VALUE 'N'.            03390000
034000             15  ASC-KEY-FIELDS.                                  03400000
034100                 20  ASC-KEY-TP-DKEY               PIC S9(9) COMP.03410000
034200                 20  ASC-KEY-ENT-ID                PIC S9(9) COMP.03420000
034300                 20  ASC-KEY-VENDOR-NAME           PIC X(35).     03430000
034400                 20  ASC-KEY-VEND-INCHG-ID-QUAL    PIC X(02).     03440000
034500                 20  ASC-KEY-VEND-INCHG-ID         PIC X(15).     03450000
034600                 20  ASC-KEY-NETWK-ID              PIC X(01).     03460000
034700             15  ASC-ORIGINAL-FIELD-VALUES.                       03470000
034800                 20  ASC-SER-LVL-CDE               PIC  X(03).    03480000
034900                 20  ASC-VEND-INCHG-ID-QUAL        PIC  X(02).    03490000
035000                 20  ASC-VEND-INCHG-ID             PIC  X(15).    03500000
035100                 20  ASC-NETWK-ID                  PIC  X(01).    03510000
035200                 20  ASC-KOHL-INCHG-ID             PIC  X(15).    03520000
035300                 20  ASC-KOHL-INCHG-ID-QUAL        PIC  X(02).    03530000
035400                 20  ASC-INTRCONN-NETWK-IND        PIC  X(01).    03540000
035500                 20  ASC-FA-COMM-MTHD              PIC  X(01).    03550000
035600                 20  ASC-LAST-SEND-CNTL-NBRX.                     03560000
035700                     25  ASC-LAST-SEND-CNTL-NBR     PIC 9(09).    03570000
035800                 20  ASC-SEND-CNTL-NBR-CDE         PIC  X(01).    03580000
035900                 20  ASC-SEND-FMT-VER-CDE          PIC  X(05).    03590000
036000                 20  ASC-SEND-FMT-NME              PIC  X(01).    03600000
036100                 20  ASC-OVRRD-SND-CNTL-NBRX.                     03610000
036200                     25  ASC-OVRRD-SND-CNTL-NBR     PIC 9(09).    03620000
036300                 20  ASC-OVRRD-SND-CNTL-ID         PIC  X(01).    03630000
036400                 20  ASC-LAST-RECV-CNTL-NBRX.                     03640000
036500                     25  ASC-LAST-RECV-CNTL-NBR     PIC 9(09).    03650000
036600                 20  ASC-RECV-CNTL-NBR-CDE         PIC  X(01).    03660000
036700                 20  ASC-RECV-FMT-VER-CDE          PIC  X(05).    03670000
036800                 20  ASC-RECV-FMT-NME              PIC  X(01).    03680000
036900                 20  ASC-OVRRD-RCV-CNTL-NBRX.                     03690000
037000                     25  ASC-OVRRD-RCV-CNTL-NBR     PIC 9(09).    03700000
037100                 20  ASC-OVRRD-RCV-CNTL-ID         PIC  X(01).    03710000
037200                 20  ASC-ACTV-DTE                 PIC X(10).      03720000
037300                 20  ASC-ACTV-DTE-RDF             REDEFINES       03730000
037400                     ASC-ACTV-DTE.                                03740000
037500                     25  ASC-ACTV-DTE-YY          PIC X(04).      03750000
037600                     25  FILLER                   PIC X(01).      03760000
037700                     25  ASC-ACTV-DTE-MM          PIC X(02).      03770000
037800                     25  FILLER                   PIC X(01).      03780000
037900                     25  ASC-ACTV-DTE-DD          PIC X(02).      03790000
038000                 20  ASC-INACTV-DTE               PIC X(10).      03800000
038100                 20  ASC-INACTV-DTE-RDF           REDEFINES       03810000
038200                     ASC-INACTV-DTE.                              03820000
038300                     25  ASC-INACTV-DTE-YY        PIC X(04).      03830000
038400                     25  FILLER                   PIC X(01).      03840000
038500                     25  ASC-INACTV-DTE-MM        PIC X(02).      03850000
038600                     25  FILLER                   PIC X(01).      03860000
038700                     25  ASC-INACTV-DTE-DD        PIC X(02).      03870000
038800                 20  ASC-LAST-CALL-DTE            PIC X(10).      03880000
038900                 20  ASC-LAST-CALL-DTE-RDF        REDEFINES       03890000
039000                     ASC-LAST-CALL-DTE.                           03900000
039100                     25  ASC-LAST-CALL-DTE-YY     PIC X(04).      03910000
039200                     25  FILLER                   PIC X(01).      03920000
039300                     25  ASC-LAST-CALL-DTE-MM     PIC X(02).      03930000
039400                     25  FILLER                   PIC X(01).      03940000
039500                     25  ASC-LAST-CALL-DTE-DD     PIC X(02).      03950000
039600                 20  ASC-NEXT-CALL-DTE            PIC X(10).      03960000
039700                 20  ASC-NEXT-CALL-DTE-RDF        REDEFINES       03970000
039800                     ASC-NEXT-CALL-DTE.                           03980000
039900                     25  ASC-NEXT-CALL-DTE-YY     PIC X(04).      03990000
040000                     25  FILLER                   PIC X(01).      04000000
040100                     25  ASC-NEXT-CALL-DTE-MM     PIC X(02).      04010000
040200                     25  FILLER                   PIC X(01).      04020000
040300                     25  ASC-NEXT-CALL-DTE-DD     PIC X(02).      04030000
040400                 20  ASC-SEND-DATA-ELEM-IND       PIC X(02).      04040000
040500                 20  ASC-SEND-SEG-TERM-IND        PIC X(02).      04050000
040600                 20  ASC-SEND-SUB-ELEM-IND        PIC X(02).      04060000
040700                 20  ASC-NOTES-TXT                PIC X(80).      04070000
040800                 20  ASC-NOTES-TXT-RDF        REDEFINES           04080000
040900                     ASC-NOTES-TXT.                               04090000
041000                     25  ASC-SEND-NOTE1           PIC X(40).      04100000
041100                     25  ASC-SEND-NOTE2           PIC X(40).      04110000
041200             15  ASC-NEWLY-ENTERED-FIELD-VALUES.                  04120000
041300                 20  ASC-SER-LVL-CDE-NEW           PIC  X(03).    04130000
041400                 20  ASC-VEND-INCHG-ID-QUAL-NEWX   PIC  X(02).    04140000
041500                 20  ASC-VEND-INCHG-ID-QUAL-NEW    REDEFINES      04150000
041600                     ASC-VEND-INCHG-ID-QUAL-NEWX.                 04160000
041700                     25  ASC-VEND-INCHG-ID-QUAL1-NEW PIC X(01).   04170000
041800                     25  ASC-VEND-INCHG-ID-QUAL2-NEW PIC X(01).   04180000
041900                 20  ASC-VEND-INCHG-ID-NEW         PIC  X(15).    04190000
042000                 20  ASC-NETWK-ID-NEW              PIC  X(01).    04200000
042100                 20  ASC-KOHL-INCHG-ID-NEW         PIC  X(15).    04210000
042200                 20  ASC-KOHL-INCHG-ID-QUAL-NEW.                  04220000
042300                     25  ASC-KOHL-INCHG-ID-QUAL1-NEW PIC X(01).   04230000
042400                     25  ASC-KOHL-INCHG-ID-QUAL2-NEW PIC X(01).   04240000
042500                 20  ASC-INTRCONN-NETWK-IND-NEW    PIC  X(01).    04250000
042600                 20  ASC-FA-COMM-MTHD-NEW          PIC  X(01).    04260000
042700                 20  ASC-LAST-SEND-CNTL-NBR-NEWX.                 04270000
042800                     25  ASC-LAST-SEND-CNTL-NBR-NEW PIC 9(09).    04280000
042900                 20  ASC-SEND-CNTL-NBR-CDE-NEW     PIC  X(01).    04290000
043000                 20  ASC-SEND-FMT-VER-CDE-NEW PIC       X(05).    04300000
043100                 20  ASC-SEND-FMT-NME-NEW          PIC  X(01).    04310000
043200                 20  ASC-OVRRD-SND-CNTL-NBR-NEWX.                 04320000
043300                     25  ASC-OVRRD-SND-CNTL-NBR-NEW PIC 9(09).    04330000
043400                 20  ASC-OVRRD-SND-CNTL-ID-NEW     PIC  X(01).    04340000
043500                 20  ASC-LAST-RECV-CNTL-NBR-NEWX.                 04350000
043600                     25  ASC-LAST-RECV-CNTL-NBR-NEW PIC 9(09).    04360000
043700                 20  ASC-RECV-CNTL-NBR-CDE-NEW     PIC  X(01).    04370000
043800                 20  ASC-RECV-FMT-VER-CDE-NEW PIC       X(05).    04380000
043900                 20  ASC-RECV-FMT-NME-NEW          PIC  X(01).    04390000
044000                 20  ASC-OVRRD-RCV-CNTL-NBR-NEWX.                 04400000
044100                     25  ASC-OVRRD-RCV-CNTL-NBR-NEW PIC 9(09).    04410000
044200                 20  ASC-OVRRD-RCV-CNTL-ID-NEW     PIC  X(01).    04420000
044300                 20  ASC-ACTV-DTE-NEW             PIC X(10).      04430000
044400                 20  ASC-ACTV-DTE-RDF-NEW         REDEFINES       04440000
044500                     ASC-ACTV-DTE-NEW.                            04450000
044600                     25  ASC-ACTV-DTE-YY-NEW      PIC X(04).      04460000
044700                     25  FILLER                   PIC X(01).      04470000
044800                     25  ASC-ACTV-DTE-MM-NEW      PIC X(02).      04480000
044900                     25  FILLER                   PIC X(01).      04490000
045000                     25  ASC-ACTV-DTE-DD-NEW      PIC X(02).      04500000
045100                 20  ASC-INACTV-DTE-NEW           PIC X(10).      04510000
045200                 20  ASC-INACTV-DTE-RDF-NEW       REDEFINES       04520000
045300                     ASC-INACTV-DTE-NEW.                          04530000
045400                     25  ASC-INACTV-DTE-YY-NEW    PIC X(04).      04540000
045500                     25  FILLER                   PIC X(01).      04550000
045600                     25  ASC-INACTV-DTE-MM-NEW    PIC X(02).      04560000
045700                     25  FILLER                   PIC X(01).      04570000
045800                     25  ASC-INACTV-DTE-DD-NEW    PIC X(02).      04580000
045900                 20  ASC-LAST-CALL-DTE-NEW        PIC X(10).      04590000
046000                 20  ASC-LAST-CALL-DTE-RDF-NEW    REDEFINES       04600000
046100                     ASC-LAST-CALL-DTE-NEW.                       04610000
046200                     25  ASC-LAST-CALL-DTE-YY-NEW PIC X(04).      04620000
046300                     25  FILLER                   PIC X(01).      04630000
046400                     25  ASC-LAST-CALL-DTE-MM-NEW PIC X(02).      04640000
046500                     25  FILLER                   PIC X(01).      04650000
046600                     25  ASC-LAST-CALL-DTE-DD-NEW PIC X(02).      04660000
046700                 20  ASC-NEXT-CALL-DTE-NEW        PIC X(10).      04670000
046800                 20  ASC-NEXT-CALL-DTE-RDF-NEW    REDEFINES       04680000
046900                     ASC-NEXT-CALL-DTE-NEW.                       04690000
047000                     25  ASC-NEXT-CALL-DTE-YY-NEW PIC X(04).      04700000
047100                     25  FILLER                   PIC X(01).      04710000
047200                     25  ASC-NEXT-CALL-DTE-MM-NEW PIC X(02).      04720000
047300                     25  FILLER                   PIC X(01).      04730000
047400                     25  ASC-NEXT-CALL-DTE-DD-NEW PIC X(02).      04740000
047500                 20  ASC-SEND-DATA-ELEM-IND-NEW   PIC X(02).      04750000
047600                 20  ASC-SEND-SEG-TERM-IND-NEW    PIC X(02).      04760000
047700                 20  ASC-SEND-SUB-ELEM-IND-NEW    PIC X(02).      04770000
047800                 20  ASC-NOTES-TXT-NEW            PIC X(80).      04780000
047900                 20  ASC-NOTES-TXT-RDF-NEW    REDEFINES           04790000
048000                     ASC-NOTES-TXT-NEW.                           04800000
048100                     25  ASC-SEND-NOTE1-NEW       PIC X(40).      04810000
048200                     25  ASC-SEND-NOTE2-NEW       PIC X(40).      04820000
048300             15  ASC-OTHER-FIELDS.                                04830000
048400                 20  ASC-NETWK-NME            PIC X(15).          04840000
048500                 20  ASC-INTRCONN-NETWK-NME   PIC X(15).          04850000
048600                 20  ASC-FA-COMM-MTHD-NME     PIC X(05).          04860000
048700                 20  ASC-SETUP-DTE            PIC X(10).          04870000
048800                 20  ASC-SETUP-DTE-RDF        REDEFINES           04880000
048900                     ASC-SETUP-DTE.                               04890000
049000                     25  ASC-SETUP-DTE-YY     PIC X(04).          04900000
049100                     25  FILLER               PIC X(01).          04910000
049200                     25  ASC-SETUP-DTE-MM     PIC X(02).          04920000
049300                     25  FILLER               PIC X(01).          04930000
049400                     25  ASC-SETUP-DTE-DD     PIC X(02).          04940000
049500                 20  ASC-LAST-CHG-DTE         PIC X(10).          04950000
049600                 20  ASC-LAST-CHG-DTE-RDF     REDEFINES           04960000
049700                     ASC-LAST-CHG-DTE.                            04970000
049800                     25  ASC-LAST-CHG-DTE-YY  PIC X(04).          04980000
049900                     25  FILLER               PIC X(01).          04990000
050000                     25  ASC-LAST-CHG-DTE-MM  PIC X(02).          05000000
050100                     25  FILLER               PIC X(01).          05010000
050200                     25  ASC-LAST-CHG-DTE-DD  PIC X(02).          05020000
050300                 20  ASC-LAST-CHG-UID         PIC X(08).          05030000
050400                 20  ASC-SEND-DATA-ELEM-PRT   PIC X(01).          05040000
050500                 20  ASC-SEND-SEG-TERM-PRT    PIC X(01).          05050000
050600                 20  ASC-SEND-SUB-ELEM-PRT    PIC X(01).          05060000
050700                 20  ASC-CURRENT-TIMESTAMP    PIC X(26).          05070000
050800                 20  ASC-CURRENT-TS-RDF       REDEFINES           05080000
050900                     ASC-CURRENT-TIMESTAMP.                       05090000
051000                     25  ASC-CURRENT-DATE     PIC X(10).          05100000
051100                     25  FILLER               PIC X(01).          05110000
051200                     25  ASC-CURRENT-TIME.                        05120000
051300                         30  ASC-HH           PIC 9(02).          05130000
051400                         30  FILLER           PIC X(01).          05140000
051500                         30  ASC-MIN          PIC 9(02).          05150000
051600                         30  FILLER           PIC X(01).          05160000
051700                         30  ASC-SEC          PIC 9(02).          05170000
051800                         30  FILLER           PIC X(01).          05180000
051900                         30  ASC-MILLI-SEC    PIC 9(06).          05190000
052000                                                                  05200000
052100             15  ASC-USE-SELECTION-QUEUE-IND                      05210000
052200                                        PIC  X(01).               05220000
052300                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    05230000
052400             15  ASC-SEL-QUEUE-NAME     PIC  X(08).               05240000
052500             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       05250000
052600             15  ASC-NUMBER-OF-SELECTED-ITEMS                     05260000
052700                                        PIC S9(09)  COMP-3.       05270000
052800             15  ASC-SEL-SUB            PIC S9(04)  COMP.         05280000
052900             15  ASC-SEL-ITEM           PIC S9(04)  COMP.         05290000
053000             15  ASC-INTER-APPL-COPY    PIC X(200).               05300000
053100                                                                  05310000
053200/                                                                 05320000
053300*---------------------------------------------------------------* 05330000
053400*    ABEND PROCESSING COPYBOOK.                                 * 05340000
053500*---------------------------------------------------------------* 05350000
053600                                                                  05360000
053700     COPY DPWS013.                                                05370000
053800                                                                  05380000
053900/                                                                 05390000
054000*----------------------------------------------------------------*05400000
054100*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE TABLE              05410000
054200*----------------------------------------------------------------*05420000
054300     EXEC SQL                                                     05430000
054400          INCLUDE TEXTENT                                         05440000
054500     END-EXEC.                                                    05450000
054600/                                                                 05460000
054700*---------------------------------------------------------------* 05470000
054800*    DB2 AREA FOR THE TRADING PARTNERSHIP DB                    * 05480000
054900*---------------------------------------------------------------* 05490000
055000     EXEC SQL                                                     05500000
055100          INCLUDE TTRDPRT                                         05510000
055200     END-EXEC.                                                    05520000
055300                                                                  05530000
055400/                                                                 05540000
055500*---------------------------------------------------------------* 05550000
055600*    DB2 AREA FOR THE TRADING PARTNERSHIP TRANSACTION SETS      * 05560000
055700*---------------------------------------------------------------* 05570000
055800     EXEC SQL                                                     05580000
055900          INCLUDE TTRDTRN                                         05590000
056000     END-EXEC.                                                    05600000
056100                                                                  05610000
056200/                                                                 05620000
056300*---------------------------------------------------------------* 05630000
056400*    DB2 AREA FOR THE TRADING PARTNER FUNCTIONAL GROUPS         * 05640000
056500*---------------------------------------------------------------* 05650000
056600     EXEC SQL                                                     05660000
056700          INCLUDE TTRDFNC                                         05670000
056800     END-EXEC.                                                    05680000
056900                                                                  05690000
057000/                                                                 05700000
057100*---------------------------------------------------------------* 05710000
057200*    DB2 AREA FOR THE NETWORK DB                                * 05720000
057300*---------------------------------------------------------------* 05730000
057400     EXEC SQL                                                     05740000
057500          INCLUDE TNETWRK                                         05750000
057600     END-EXEC.                                                    05760000
057700/                                                                 05770000
057800*---------------------------------------------------------------* 05780000
057900*    DB2 AREA FOR THE VENDOR NAME DATABASE                      * 05790000
058000*---------------------------------------------------------------* 05800000
058100     EXEC SQL                                                     05810000
058200          INCLUDE TENTNME                                         05820000
058300     END-EXEC.                                                    05830000
058400/                                                                 05840000
058500*---------------------------------------------------------------* 05850000
058600*    DB2 AREA FOR COMMUNICATIONS                                * 05860000
058700*---------------------------------------------------------------* 05870000
058800     EXEC SQL                                                     05880000
058900          INCLUDE SQLCA                                           05890000
059000     END-EXEC.                                                    05900000
059100                                                                  05910000
059200/                                                                 05920000
059300 LINKAGE SECTION.                                                 05930000
059400                                                                  05940000
059500 01  DFHCOMMAREA.                                                 05950000
059600     05  FILLER                         OCCURS  1 TO 4072 TIMES   05960000
059700                                        DEPENDING ON EIBCALEN.    05970000
059800         10  FILLER                     PIC X.                    05980000
059900                                                                  05990000
060000/                                                                 06000000
060100 PROCEDURE DIVISION.                                              06010000
060200*---------------------------------------------------------------* 06020000
060300*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 06030000
060400*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 06040000
060500*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 06050000
060600*---------------------------------------------------------------* 06060000
060700 0000-MAIN-MODULE.                                                06070000
060800                                                                  06080000
060900     INITIALIZE DP030-CICS-API-FIELDS.                            06090000
061000                                                                  06100000
061100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06110000
061200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06120000
061300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06130000
061400                                                                  06140000
061500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06150000
061600                                                                  06160000
061700     MOVE LENGTH OF ET308AI        TO DP030-MAP-LENGTH (1).       06170000
061800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06180000
061900                                                                  06190000
062000     PERFORM 0001-CALL-CICS-ARCH-API.                             06200000
062100     PERFORM 1000-CONTROL-PROCESSING                              06210000
062200                                                                  06220000
062300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06230000
062400     PERFORM 0001-CALL-CICS-ARCH-API.                             06240000
062500                                                                  06250000
062600*---------------------------------------------------------------* 06260000
062700*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 06270000
062800*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 06280000
062900*---------------------------------------------------------------* 06290000
063000 0001-CALL-CICS-ARCH-API.                                         06300000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06310003
063200                                    DFHCOMMAREA                   06320003
063300                                    DP030-CICS-API-FIELDS         06330003
063400                                    DP020-STANDARD-COMMAREA       06340003
063500                                    ET308AI.                      06350003
063600                                                                  06360000
063700     IF  DP030-RC-CALL-SUCCESSFUL                                 06370000
063800         CONTINUE                                                 06380000
063900     ELSE                                                         06390000
064000         SET DP013-NO-ROLLBACK                                    06400000
064100             DP013-XCTL-DISPLAY-RESTART                           06410000
064200             DP013-CICS-ABEND      TO TRUE                        06420000
064300         MOVE '0001-CALL-CICS-ARCH-API'                           06430000
064400                                   TO DP013-PARAGRAPH             06440000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06450003
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06460003
064700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06470000
064800         PERFORM DP013-0000-PROCESS-ABEND                         06480000
064900     END-IF.                                                      06490000
065000                                                                  06500000
065100*---------------------------------------------------------------- 06510000
065200* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT       06520000
065300* COURSE OF ACTION IS FOR THIS TRANSACTION.                       06530000
065400*---------------------------------------------------------------- 06540000
065500                                                                  06550000
065600 1000-CONTROL-PROCESSING.                                         06560000
065700                                                                  06570000
065800     EVALUATE TRUE                                                06580000
065900         WHEN DP020-NEXT-ACT-INITIAL                              06590000
066000              PERFORM 1100-FIND-OBJECT-KEYS                       06600000
066100              IF  PS-ERROR                                        06610000
066200                  CONTINUE                                        06620000
066300              ELSE                                                06630000
066400                  PERFORM 4000-BUILD-INITIAL-PANEL                06640000
066500                  PERFORM 3200-RESET-ATTRIBUTES                   06650000
066600                  PERFORM 3500-SAVE-SCREEN-FIELDS                 06660000
066700                  IF  SQLCODE = +100                              06670000
066800                  AND NOT ASC-ADD-PENDING                         06680000
066900                      SET DP020-NEXT-ACT-APPL-ERROR               06690000
067000                                     TO TRUE                      06700000
067100                      MOVE PC-TSYMSG-00148                        06710000
067200                                     TO DP020-MSG-NUMBER          06720000
067300                      SET DP020-MSG-INFORMATIONAL                 06730000
067400                                     TO TRUE                      06740000
067500                  ELSE                                            06750000
067600                      IF  ASC-DELETE-PENDING                      06760000
067700*-->                      ** PRESS PF2 TO CONFIRM DELETE **       06770000
067800                          MOVE PC-TSYMSG-00004                    06780000
067900                                     TO DP020-MSG-NUMBER          06790000
068000                          SET DP020-MSG-INFORMATIONAL             06800000
068100                                     TO TRUE                      06810000
068200                      END-IF                                      06820000
068300                  END-IF                                          06830000
068400              END-IF                                              06840000
068500                                                                  06850000
068600         WHEN DP020-NEXT-ACT-READ-MAP                             06860000
068700             MOVE ASC-INTER-APPL-COPY TO INTER-APPL-COMM-AREA     06870000
068800             PERFORM 2000-PROCESS-PANEL                           06880000
068900                                                                  06890000
069000         WHEN DP020-NEXT-ACT-RETURN                               06900000
069100             MOVE ASC-INTER-APPL-COPY TO INTER-APPL-COMM-AREA     06910000
069200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06920000
069300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06930000
069400                                                                  06940000
069500         WHEN OTHER                                               06950000
069600             SET DP013-LOGIC-ABEND TO TRUE                        06960000
069700             SET DP013-NO-ROLLBACK TO TRUE                        06970000
069800             MOVE '1000-CONTROL-PROCESSING'                       06980000
069900                                   TO DP013-PARAGRAPH             06990000
070000             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   07000000
070100                                   TO DP013-MESSAGE-TEXT(1)       07010000
070200             MOVE DP020-NEXT-APPL-ACTIVITY                        07020000
070300                                   TO DP013-MESSAGE-TEXT(2)       07030000
070400             PERFORM DP013-0000-PROCESS-ABEND                     07040000
070500     END-EVALUATE.                                                07050000
070600                                                                  07060000
070700*    *------------------------------------------------------------07070000
070800*    * IF CONTROL IS BEING PASSED TO THE VENDOR BUSINESS FUNCTION 07080000
070900*    * LIST (PF21) THE INTER-APPL COMMAREA HAS ALREADY BEEN SAVED 07090000
071000*    * IN ASC-INTER-APPL-COPY AND THE INTER-APPL COMMAREA NOW     07100000
071100*    * CONTAINS THE DATA EXPECTED BY THE VENDOR BUSINESS FUNCTION 07110000
071200*    * LIST.                                                      07120000
071300*    *------------------------------------------------------------07130000
071400     IF  DP020-SRC-AID = DP016-PF21                               07140000
071500         CONTINUE                                                 07150000
071600     ELSE                                                         07160000
071700         MOVE INTER-APPL-COMM-AREA TO ASC-INTER-APPL-COPY         07170000
071800     END-IF.                                                      07180000
071900                                                                  07190000
072000*---------------------------------------------------------------- 07200000
072100*  DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE     07210000
072200*  INTER-APPLICATION FORMAT CODE.                                 07220000
072300*---------------------------------------------------------------- 07230000
072400 1100-FIND-OBJECT-KEYS.                                           07240000
072500                                                                  07250000
072600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07260000
072700                                                                  07270000
072800     MOVE DP020-INT-APPL-FORMAT-IND                               07280000
072900                                 TO ASC-INT-APPL-FORMAT-IND.      07290000
073000                                                                  07300000
073100     MOVE ET300-TP-DKEY          TO                               07310000
073200          ASC-KEY-TP-DKEY                                         07320000
073300     MOVE ET300-ENT-ID           TO                               07330000
073400          ASC-KEY-ENT-ID                                          07340000
073500     MOVE ET300-VEND-INCHG-ID    TO                               07350000
073600          ASC-KEY-VEND-INCHG-ID                                   07360000
073700     MOVE ET300-VEND-INCHG-QUAL  TO                               07370000
073800          ASC-KEY-VEND-INCHG-ID-QUAL                              07380000
073900     MOVE ET300-NETWK-ID         TO                               07390000
074000          ASC-KEY-NETWK-ID                                        07400000
074100     MOVE ET300-VENDOR-NAME      TO                               07410000
074200          ASC-KEY-VENDOR-NAME                                     07420000
074300                                                                  07430000
074400     MOVE DP020-INT-APPL-FORMAT-IND TO                            07440000
074500          PV-INT-APPL-FORMAT-IND                                  07450000
074600                                                                  07460000
074700     EVALUATE TRUE                                                07470000
074800                                                                  07480000
074900         WHEN PV-INTER-APPL-CRIT-ADD                              07490000
075000             IF ((ET300-VEND-INCHG-ID    > SPACES AND             07500000
075100                  ET300-VEND-INCHG-QUAL  > SPACES AND             07510000
075200                  ET300-NETWK-ID         > SPACES)                07520000
075300                                                                  07530000
075400                  OR                                              07540000
075500                                                                  07550000
075600                 (ET300-VEND-INCHG-ID    = SPACES AND             07560000
075700                  ET300-VEND-INCHG-QUAL  = SPACES AND             07570000
075800                  ET300-NETWK-ID         = SPACES))               07580000
075900                 SET ASC-ADD-PENDING TO TRUE                      07590000
076000             ELSE                                                 07600000
076100*                ** FILL IN EITHER ALL OF THE FIELDS OR NONE **   07610000
076200*                ** OF THE FIELDS                            **   07620000
076300                 MOVE PC-TSYMSG-00832 TO DP020-MSG-NUMBER         07630000
076400                 SET DP020-MSG-FATAL                              07640000
076500                     DP020-NEXT-ACT-APPL-ERROR                    07650000
076600                     PS-ERROR        TO TRUE                      07660000
076700             END-IF                                               07670000
076800                                                                  07680000
076900         WHEN PV-INTER-APPL-LIST-UPDATE                           07690000
077000         WHEN PV-INTER-APPL-LIST-DELETE                           07700000
077100             IF PV-INTER-APPL-LIST-UPDATE                         07710000
077200                 SET ASC-UPDATE-PENDING                           07720000
077300                             TO TRUE                              07730000
077400             ELSE                                                 07740000
077500                 SET ASC-DELETE-PENDING                           07750000
077600                             TO TRUE                              07760000
077700             END-IF                                               07770000
077800             SET ASC-USE-SELECTION-QUEUE                          07780000
077900                             TO TRUE                              07790000
078000             MOVE ET300-NBR-SELECTED-ITEMS                        07800000
078100                             TO ASC-NUMBER-OF-SELECTED-ITEMS      07810000
078200             MOVE ET300-NUMBER-OF-TS-ITEMS                        07820000
078300                             TO ASC-NUMBER-OF-TS-ITEMS            07830000
078400             MOVE ET300-SEL-QUEUE-NAME                            07840000
078500                             TO ASC-SEL-QUEUE-NAME                07850000
078600             PERFORM 1120-PREPARE-LIST-ENTRY                      07860000
078700                                                                  07870000
078800         WHEN OTHER                                               07880000
078900             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             07890000
079000             SET DP020-MSG-FATAL                                  07900000
079100                 DP020-NEXT-ACT-APPL-ERROR                        07910000
079200                 PS-ERROR        TO TRUE                          07920000
079300     END-EVALUATE.                                                07930000
079400                                                                  07940000
079500/                                                                 07950000
079600*---------------------------------------------------------------- 07960000
079700* ENTRY IS FROM A LIST.  GET THE FORMAT NUMBER FROM THE TEMP      07970000
079800* STORAGE QUEUE PASSED FROM THE LIST.                             07980000
079900*---------------------------------------------------------------- 07990000
080000 1120-PREPARE-LIST-ENTRY.                                         08000000
080100                                                                  08010000
080200     MOVE ET301-MAX-ITEMS          TO ASC-SEL-SUB.                08020000
080300     MOVE ZERO                     TO ASC-SEL-ITEM.               08030000
080400     PERFORM 2110-GET-NEXT-RECORD.                                08040000
080500                                                                  08050000
080600/                                                                 08060000
080700*---------------------------------------------------------------- 08070000
080800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA    08080000
080900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT    08090000
081000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST   08100000
081100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID       08110000
081200* FUNCTION KEYS CAN GET THIS FAR.                                 08120000
081300*---------------------------------------------------------------- 08130000
081400                                                                  08140000
081500 2000-PROCESS-PANEL.                                              08150000
081600                                                                  08160000
081700     EVALUATE TRUE                                                08170000
081800         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    08180000
081900             IF  ASC-DELETE-SUCCESSFUL                            08190000
082000                 MOVE PC-TSYMSG-00116                             08200000
082100                                   TO DP020-MSG-NUMBER            08210000
082200                 SET DP020-MSG-FATAL                              08220000
082300                     PS-ERROR      TO TRUE                        08230000
082400                 PERFORM 3200-RESET-ATTRIBUTES                    08240000
082500             ELSE                                                 08250000
082600                 SET DP030-CONTINUE-GO                            08260000
082700                                   TO TRUE                        08270000
082800                 PERFORM 7000-DELETE-TTRDPRT                      08280000
082900                 MOVE 'Y' TO PS-DELETE-SW                         08290000
083000                 PERFORM 8000-CHECK-PO-ASN-IND                    08300000
083100                 PERFORM 8050-CHECK-EDI-PO-ASN-IND                08310000
083200             END-IF                                               08320000
083300                                                                  08330000
083400         WHEN DP020-SRC-AID = DP016-CLEAR                         08340000
083500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08350000
083600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08360000
083700                                                                  08370000
083800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08380000
083900             SET DP030-DONT-ERASE                                 08390000
084000                 DP030-SEND-DATAONLY (PC-APPL-MAP)                08400000
084100                               TO TRUE                            08410000
084200             PERFORM 4000-BUILD-INITIAL-PANEL                     08420000
084300             PERFORM 3200-RESET-ATTRIBUTES                        08430000
084400             PERFORM 3500-SAVE-SCREEN-FIELDS                      08440000
084500                                                                  08450000
084600         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08460000
084700             IF  ASC-USE-SELECTION-QUEUE                          08470000
084800                 PERFORM 2110-GET-NEXT-RECORD                     08480000
084900                 PERFORM 4000-BUILD-INITIAL-PANEL                 08490000
085000                 PERFORM 3200-RESET-ATTRIBUTES                    08500000
085100                 PERFORM 3500-SAVE-SCREEN-FIELDS                  08510000
085200             ELSE                                                 08520000
085300*                --- BOTTOM OF LIST ---                           08530000
085400                 MOVE PC-TSYMSG-00070                             08540000
085500                                   TO DP020-MSG-NUMBER            08550000
085600                 SET DP020-MSG-INFORMATIONAL                      08560000
085700                                   TO TRUE                        08570000
085800             END-IF                                               08580000
085900                                                                  08590000
086000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08600000
086100             IF  ASC-USE-SELECTION-QUEUE                          08610000
086200                 PERFORM 2120-GET-PREV-RECORD                     08620000
086300                 PERFORM 4000-BUILD-INITIAL-PANEL                 08630000
086400                 PERFORM 3200-RESET-ATTRIBUTES                    08640000
086500                 PERFORM 3500-SAVE-SCREEN-FIELDS                  08650000
086600             ELSE                                                 08660000
086700*                --- TOP OF LIST ---                              08670000
086800                 MOVE PC-TSYMSG-00069                             08680000
086900                                   TO DP020-MSG-NUMBER            08690000
087000                 SET DP020-MSG-INFORMATIONAL                      08700000
087100                                   TO TRUE                        08710000
087200             END-IF                                               08720000
087300                                                                  08730000
087400         WHEN DP020-SRC-AID = DP016-PF21                          08740000
087500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08750000
087600             MOVE INTER-APPL-COMM-AREA TO ASC-INTER-APPL-COPY     08760000
087700             INITIALIZE VN001-INTER-APPL-COMMAREA                 08770000
087800             MOVE ASC-KEY-VENDOR-NAME TO VN001-VENDOR-NAME        08780000
087900                                                                  08790000
088000         WHEN OTHER                                               08800000
088100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08810000
088200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08820000
088300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08830000
088400             IF  PS-NO-ERROR                                      08840000
088500                 SET DP030-CONTINUE-GO                            08850000
088600                                   TO TRUE                        08860000
088700                 PERFORM 2100-CHECK-FUNCTION-KEY                  08870000
088800             ELSE                                                 08880000
088900                 SET DP030-OVERRIDE-GO                            08890000
089000                                   TO TRUE                        08900000
089100             END-IF                                               08910000
089200     END-EVALUATE.                                                08920000
089300                                                                  08930000
089400/                                                                 08940000
089500*---------------------------------------------------------------- 08950000
089600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST. 08960000
089700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE   08970000
089800* CICS ARCHITECTURE API.                                          08980000
089900*---------------------------------------------------------------- 08990000
090000 2100-CHECK-FUNCTION-KEY.                                         09000000
090100                                                                  09010000
090200     EVALUATE TRUE                                                09020000
090300         WHEN DP020-SRC-AID = DP016-ENTER                         09030000
090400             CONTINUE                                             09040000
090500                                                                  09050000
090600         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 09060000
090700                                                                  09070000
090800             MOVE ASC-KEY-ENT-ID      TO ET300-ENT-ID             09080000
090900             MOVE ASC-KEY-VENDOR-NAME TO ET300-VENDOR-NAME        09090000
091000             MOVE ASC-VEND-INCHG-ID-NEW                           09100000
091100                                  TO ET300-VEND-INCHG-ID          09110000
091200                                                                  09120000
091300             MOVE ASC-VEND-INCHG-ID-QUAL-NEW                      09130000
091400                                  TO ET300-VEND-INCHG-QUAL        09140000
091500             MOVE ASC-NETWK-ID-NEW    TO ET300-NETWK-ID           09150000
091600             MOVE ASC-NETWK-NME       TO ET300-NETWORK-NAME       09160000
091700                                                                  09170000
091800             IF ASC-ADD-PENDING                                   09180000
091900                 PERFORM 5000-ADD-TTRDPRT                         09190000
092000                 SET ET300-ADD TO TRUE                            09200000
092100             END-IF                                               09210000
092200                                                                  09220000
092300             MOVE ASC-KEY-TP-DKEY     TO ET300-TP-DKEY            09230000
092400                                                                  09240000
092500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09250000
092600             IF ASC-UPDATE-PENDING                                09260000
092700                 PERFORM 3600-CHECK-IF-FIELDS-CHANGED             09270000
092800                 IF  ASC-FIELDS-CHANGED                           09280000
092900                     SET DP030-CONTINUE-GO                        09290000
093000                                     TO TRUE                      09300000
093100                     IF ASC-INACTV-DTE = SPACES AND               09310000
093200                     ASC-INACTV-DTE-NEW NOT = SPACES              09320000
093300                        MOVE 'Y' TO PS-INACTIVE-SW                09330000
093400                     ELSE                                         09340000
093500                        IF ASC-INACTV-DTE NOT = SPACES            09350000
093600                        AND ASC-INACTV-DTE-NEW = SPACES           09360000
093700                           MOVE 'N' TO PS-INACTIVE-SW             09370000
093800                        END-IF                                    09380000
093900                     END-IF                                       09390000
094000                     PERFORM 6000-UPDATE-TTRDPRT                  09400000
094100                     INITIALIZE PS-MQ-SEND-SW                     09410000
094200                     PERFORM 8000-CHECK-PO-ASN-IND                09420000
094300                     PERFORM 8050-CHECK-EDI-PO-ASN-IND            09430000
094400                     MOVE ASC-VEND-INCHG-ID-NEW                   09440000
094500                                     TO ASC-KEY-VEND-INCHG-ID     09450000
094600                     MOVE ASC-VEND-INCHG-ID-QUAL-NEW              09460000
094700                                     TO ASC-KEY-VEND-INCHG-ID-QUAL09470000
094800                     MOVE ASC-NETWK-ID-NEW                        09480000
094900                                     TO ASC-KEY-NETWK-ID          09490000
095000                 ELSE                                             09500000
095100                     MOVE PC-TSYMSG-00046                         09510000
095200                                     TO DP020-MSG-NUMBER          09520000
095300                     SET DP020-MSG-INFORMATIONAL                  09530000
095400                                     TO TRUE                      09540000
095500                 END-IF                                           09550000
095600             END-IF                                               09560000
095700                                                                  09570000
095800         WHEN OTHER                                               09580000
095900             SET DP013-NO-ROLLBACK                                09590000
096000                 DP013-XCTL-DISPLAY-RESTART                       09600000
096100                 DP013-CICS-ABEND  TO TRUE                        09610000
096200             MOVE '2100-CHECK-FUNCTION-KEY'                       09620000
096300                                   TO DP013-PARAGRAPH             09630000
096400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09640000
096500                                   TO DP013-MESSAGE-TEXT (1)      09650000
096600             PERFORM DP013-0000-PROCESS-ABEND                     09660000
096700     END-EVALUATE.                                                09670000
096800                                                                  09680000
096900/                                                                 09690000
097000 2110-GET-NEXT-RECORD.                                            09700000
097100                                                                  09710000
097200     ADD +1                        TO ASC-SEL-SUB.                09720000
097300     IF  ASC-SEL-SUB > ET301-MAX-ITEMS                            09730000
097400         ADD +1                    TO ASC-SEL-ITEM                09740000
097500         MOVE +1                   TO ASC-SEL-SUB                 09750000
097600     END-IF.                                                      09760000
097700                                                                  09770000
097800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09780000
097900         PERFORM 9100-READ-SEL-QUEUE                              09790000
098000         IF  ET301-ITEM (ASC-SEL-SUB) > ZERO                      09800000
098100             MOVE ET301-TP-DKEY     (ASC-SEL-SUB)                 09810000
098200                                   TO ASC-KEY-TP-DKEY             09820000
098300             MOVE ET301-ENT-ID   (ASC-SEL-SUB)                    09830000
098400                                   TO ASC-KEY-ENT-ID              09840000
098500             MOVE ET301-VENDOR-NAME   (ASC-SEL-SUB)               09850000
098600                                   TO ASC-KEY-VENDOR-NAME         09860000
098700             MOVE ET301-VEND-INCHG-ID (ASC-SEL-SUB)               09870000
098800                                   TO ASC-KEY-VEND-INCHG-ID       09880000
098900             MOVE ET301-VEND-INCHG-QUAL (ASC-SEL-SUB)             09890000
099000                                   TO ASC-KEY-VEND-INCHG-ID-QUAL  09900000
099100             MOVE ET301-NETWK-ID        (ASC-SEL-SUB)             09910000
099200                                   TO ASC-KEY-NETWK-ID            09920000
099300*-->         IT'S POSSIBLE THAT THE USER DID AN UPDATE, DID A     09930000
099400*-->         "PREV", AND DID A NEXT TO RE-DISPLAY THIS RECORD.    09940000
099500*-->         IF SO, ET301-ACTION-SW WOULD EQUAL 'U', AND SHOULD   09950000
099600*-->         STAY THAT WAY.  THAT WAY, WHEN PF3'ING BACK TO THE   09960000
099700*-->         LIST, "UPD" WILL SHOW UP BESIDE THE UPDATED REC.     09970000
099800             IF ET301-ACTION-SW (ASC-SEL-SUB) > SPACES            09980000
099900                 CONTINUE                                         09990000
100000             ELSE                                                 10000000
100100                 SET ET301-INQ (ASC-SEL-SUB)                      10010000
100200                                       TO TRUE                    10020000
100300                 PERFORM 9200-REWRITE-LIST-QUEUE                  10030000
100400             END-IF                                               10040000
100500         ELSE                                                     10050000
100600             SUBTRACT +1 FROM ASC-SEL-SUB                         10060000
100700*            --- BOTTOM OF LIST ---                               10070000
100800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10080000
100900             SET DP020-MSG-INFORMATIONAL                          10090000
101000                                   TO TRUE                        10100000
101100         END-IF                                                   10110000
101200     ELSE                                                         10120000
101300         SUBTRACT +1 FROM ASC-SEL-ITEM                            10130000
101400         MOVE ET301-MAX-ITEMS      TO ASC-SEL-SUB                 10140000
101500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10150000
101600         SET DP020-MSG-INFORMATIONAL                              10160000
101700                                   TO TRUE                        10170000
101800     END-IF.                                                      10180000
101900                                                                  10190000
102000/                                                                 10200000
102100 2120-GET-PREV-RECORD.                                            10210000
102200                                                                  10220000
102300     SUBTRACT +1 FROM ASC-SEL-SUB.                                10230000
102400     IF  ASC-SEL-SUB < +1                                         10240000
102500         SUBTRACT +1 FROM ASC-SEL-ITEM                            10250000
102600         MOVE ET301-MAX-ITEMS      TO ASC-SEL-SUB                 10260000
102700     END-IF.                                                      10270000
102800                                                                  10280000
102900     IF  ASC-SEL-ITEM > ZERO                                      10290000
103000         PERFORM 9100-READ-SEL-QUEUE                              10300000
103100         MOVE ET301-TP-DKEY     (ASC-SEL-SUB)                     10310000
103200                               TO ASC-KEY-TP-DKEY                 10320000
103300         MOVE ET301-ENT-ID   (ASC-SEL-SUB)                        10330000
103400                               TO ASC-KEY-ENT-ID                  10340000
103500         MOVE ET301-VENDOR-NAME   (ASC-SEL-SUB)                   10350000
103600                               TO ASC-KEY-VENDOR-NAME             10360000
103700         MOVE ET301-VEND-INCHG-ID (ASC-SEL-SUB)                   10370000
103800                               TO ASC-KEY-VEND-INCHG-ID           10380000
103900         MOVE ET301-VEND-INCHG-QUAL    (ASC-SEL-SUB)              10390000
104000                               TO ASC-KEY-VEND-INCHG-ID-QUAL      10400000
104100         MOVE ET301-NETWK-ID        (ASC-SEL-SUB)                 10410000
104200                               TO ASC-KEY-NETWK-ID                10420000
104300     ELSE                                                         10430000
104400         MOVE +1                   TO ASC-SEL-ITEM                10440000
104500                                      ASC-SEL-SUB                 10450000
104600*        --- TOP OF LIST ---                                      10460000
104700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10470000
104800         SET DP020-MSG-INFORMATIONAL                              10480000
104900                                   TO TRUE                        10490000
105000     END-IF.                                                      10500000
105100                                                                  10510000
105200/                                                                 10520000
105300*---------------------------------------------------------------- 10530000
105400*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE      10540000
105500*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.   10550000
105600*---------------------------------------------------------------- 10560000
105700 2200-MOVE-SCREEN-TO-COMMAREA.                                    10570000
105800                                                                  10580000
105900       IF SVCLVLL >      ZERO                                     10590000
106000           MOVE SVCLVLI TO ASC-SER-LVL-CDE-NEW                    10600000
106100       ELSE                                                       10610000
106200           IF SVCLVLF = DP015-ERASE-EOF                           10620000
106300               MOVE SPACES TO ASC-SER-LVL-CDE-NEW                 10630000
106400           END-IF                                                 10640000
106500       END-IF                                                     10650000
106600                                                                  10660000
106700       IF VTPIDQL >      ZERO                                     10670000
106800           MOVE VTPIDQI TO ASC-VEND-INCHG-ID-QUAL-NEW             10680000
106900       ELSE                                                       10690000
107000           IF VTPIDQF = DP015-ERASE-EOF                           10700000
107100               MOVE SPACES TO ASC-VEND-INCHG-ID-QUAL-NEW          10710000
107200           END-IF                                                 10720000
107300       END-IF                                                     10730000
107400                                                                  10740000
107500       IF VTPIDL >       ZERO                                     10750000
107600           MOVE VTPIDI TO ASC-VEND-INCHG-ID-NEW                   10760000
107700       ELSE                                                       10770000
107800           IF VTPIDF  = DP015-ERASE-EOF                           10780000
107900               MOVE SPACES TO ASC-VEND-INCHG-ID-NEW               10790000
108000           END-IF                                                 10800000
108100       END-IF                                                     10810000
108200                                                                  10820000
108300       IF NTWKCDEL >      ZERO                                    10830000
108400           MOVE NTWKCDEI TO ASC-NETWK-ID-NEW                      10840000
108500           MOVE SPACES TO ASC-NETWK-NME                           10850000
108600       ELSE                                                       10860000
108700           IF NTWKCDEF = DP015-ERASE-EOF                          10870000
108800               MOVE SPACES TO ASC-NETWK-ID-NEW                    10880000
108900               MOVE SPACES TO ASC-NETWK-NME                       10890000
109000           END-IF                                                 10900000
109100       END-IF                                                     10910000
109200                                                                  10920000
109300       IF KTPIDQL >      ZERO                                     10930000
109400           MOVE KTPIDQI TO ASC-KOHL-INCHG-ID-QUAL-NEW             10940000
109500       ELSE                                                       10950000
109600           IF KTPIDQF = DP015-ERASE-EOF                           10960000
109700               MOVE SPACES TO ASC-KOHL-INCHG-ID-QUAL-NEW          10970000
109800           END-IF                                                 10980000
109900       END-IF                                                     10990000
110000                                                                  11000000
110100       IF KTPIDL  >      ZERO                                     11010000
110200           MOVE KTPIDI  TO ASC-KOHL-INCHG-ID-NEW                  11020000
110300       ELSE                                                       11030000
110400           IF KTPIDQF = DP015-ERASE-EOF                           11040000
110500               MOVE SPACES TO ASC-KOHL-INCHG-ID-NEW               11050000
110600           END-IF                                                 11060000
110700       END-IF                                                     11070000
110800                                                                  11080000
110900       IF INTRCCDL >      ZERO                                    11090000
111000           MOVE INTRCCDI TO ASC-INTRCONN-NETWK-IND-NEW            11100000
111100           MOVE SPACES TO ASC-INTRCONN-NETWK-NME                  11110000
111200       ELSE                                                       11120000
111300           IF INTRCCDF = DP015-ERASE-EOF                          11130000
111400               MOVE SPACES TO ASC-INTRCONN-NETWK-IND-NEW          11140000
111500               MOVE SPACES TO ASC-INTRCONN-NETWK-NME              11150000
111600           END-IF                                                 11160000
111700       END-IF                                                     11170000
111800                                                                  11180000
111900       IF FACMTHL  >      ZERO                                    11190000
112000           MOVE FACMTHI TO ASC-FA-COMM-MTHD-NEW                   11200000
112100           MOVE SPACES TO ASC-FA-COMM-MTHD-NME                    11210000
112200       ELSE                                                       11220000
112300           IF FACMTHF = DP015-ERASE-EOF                           11230000
112400               MOVE SPACES TO ASC-FA-COMM-MTHD-NEW                11240000
112500               MOVE SPACES TO ASC-FA-COMM-MTHD-NME                11250000
112600           END-IF                                                 11260000
112700       END-IF                                                     11270000
112800                                                                  11280000
112900       IF LSNBRL >        ZERO                                    11290000
113000           MOVE LSNBRI TO ASC-LAST-SEND-CNTL-NBR-NEWX             11300000
113100       ELSE                                                       11310000
113200           IF LSNBRF = DP015-ERASE-EOF                            11320000
113300               MOVE ZEROS  TO ASC-LAST-SEND-CNTL-NBR-NEW          11330000
113400           END-IF                                                 11340000
113500       END-IF                                                     11350000
113600                                                                  11360000
113700       IF LSMCDL >        ZERO                                    11370000
113800           MOVE LSMCDI TO ASC-SEND-CNTL-NBR-CDE-NEW               11380000
113900       ELSE                                                       11390000
114000           IF LSMCDF = DP015-ERASE-EOF                            11400000
114100               MOVE SPACES TO ASC-SEND-CNTL-NBR-CDE-NEW           11410000
114200           END-IF                                                 11420000
114300       END-IF                                                     11430000
114400                                                                  11440000
114500       IF LSINTVRL >      ZERO                                    11450000
114600           MOVE LSINTVRI TO ASC-SEND-FMT-VER-CDE-NEW              11460000
114700       ELSE                                                       11470000
114800           IF LSINTVRF = DP015-ERASE-EOF                          11480000
114900               MOVE SPACES TO ASC-SEND-FMT-VER-CDE-NEW            11490000
115000           END-IF                                                 11500000
115100       END-IF                                                     11510000
115200                                                                  11520000
115300       IF LSINTNML >      ZERO                                    11530000
115400           MOVE LSINTNMI TO ASC-SEND-FMT-NME-NEW                  11540000
115500       ELSE                                                       11550000
115600           IF LSINTVRF = DP015-ERASE-EOF                          11560000
115700               MOVE SPACES TO ASC-SEND-FMT-NME-NEW                11570000
115800           END-IF                                                 11580000
115900       END-IF                                                     11590000
116000                                                                  11600000
116100       IF LSOVRL >        ZERO                                    11610000
116200           MOVE LSOVRI TO ASC-OVRRD-SND-CNTL-NBR-NEWX             11620000
116300       ELSE                                                       11630000
116400           IF LSOVRF = DP015-ERASE-EOF                            11640000
116500               MOVE ZEROS  TO ASC-OVRRD-SND-CNTL-NBR-NEW          11650000
116600           END-IF                                                 11660000
116700       END-IF                                                     11670000
116800                                                                  11680000
116900       IF LSOVRIDL >     ZERO                                     11690000
117000           MOVE LSOVRIDI TO ASC-OVRRD-SND-CNTL-ID-NEW             11700000
117100       ELSE                                                       11710000
117200           IF LSOVRIDF = DP015-ERASE-EOF                          11720000
117300               MOVE SPACES TO ASC-OVRRD-SND-CNTL-ID-NEW           11730000
117400           END-IF                                                 11740000
117500       END-IF                                                     11750000
117600                                                                  11760000
117700       IF LRMCDL >        ZERO                                    11770000
117800           MOVE LRMCDI TO ASC-RECV-CNTL-NBR-CDE-NEW               11780000
117900       ELSE                                                       11790000
118000           IF LRMCDF = DP015-ERASE-EOF                            11800000
118100               MOVE SPACES TO ASC-RECV-CNTL-NBR-CDE-NEW           11810000
118200           END-IF                                                 11820000
118300       END-IF                                                     11830000
118400                                                                  11840000
118500       IF LRINTVRL >      ZERO                                    11850000
118600           MOVE LRINTVRI   TO ASC-RECV-FMT-VER-CDE-NEW            11860000
118700       ELSE                                                       11870000
118800           IF LRINTVRF = DP015-ERASE-EOF                          11880000
118900               MOVE SPACES TO ASC-RECV-FMT-VER-CDE-NEW            11890000
119000           END-IF                                                 11900000
119100       END-IF                                                     11910000
119200                                                                  11920000
119300******************************************************************11930000
119400       IF LRINTNML >      ZERO                                    11940000
119500           MOVE LRINTNMI TO ASC-RECV-FMT-NME-NEW                  11950000
119600       ELSE                                                       11960000
119700           IF LRINTVRF = DP015-ERASE-EOF                          11970000
119800               MOVE SPACES TO ASC-RECV-FMT-NME-NEW                11980000
119900           END-IF                                                 11990000
120000       END-IF                                                     12000000
120100                                                                  12010000
120200       IF LRNBRL >        ZERO                                    12020000
120300           MOVE LRNBRI TO ASC-LAST-RECV-CNTL-NBR-NEWX             12030000
120400       ELSE                                                       12040000
120500           IF LRNBRF = DP015-ERASE-EOF                            12050000
120600               MOVE ZEROS  TO ASC-LAST-RECV-CNTL-NBR-NEW          12060000
120700           END-IF                                                 12070000
120800       END-IF                                                     12080000
120900                                                                  12090000
121000******************************************************************12100000
121100       IF LROVRL >        ZERO                                    12110000
121200           MOVE LROVRI TO ASC-OVRRD-RCV-CNTL-NBR-NEWX             12120000
121300       ELSE                                                       12130000
121400           IF LROVRF = DP015-ERASE-EOF                            12140000
121500               MOVE ZEROS  TO ASC-OVRRD-RCV-CNTL-NBR-NEW          12150000
121600           END-IF                                                 12160000
121700       END-IF                                                     12170000
121800                                                                  12180000
121900       IF LROVRIDL >     ZERO                                     12190000
122000           MOVE LROVRIDI TO ASC-OVRRD-RCV-CNTL-ID-NEW             12200000
122100       ELSE                                                       12210000
122200           IF LROVRIDF = DP015-ERASE-EOF                          12220000
122300               MOVE SPACES TO ASC-OVRRD-RCV-CNTL-ID-NEW           12230000
122400           END-IF                                                 12240000
122500       END-IF                                                     12250000
122600                                                                  12260000
122700******************************************************************12270000
122800       IF ACTVMTHL >      ZERO                                    12280000
122900           MOVE ACTVMTHI TO ASC-ACTV-DTE-MM-NEW                   12290000
123000       ELSE                                                       12300000
123100           IF ACTVMTHF = DP015-ERASE-EOF                          12310000
123200               MOVE SPACES TO ASC-ACTV-DTE-MM-NEW                 12320000
123300           END-IF                                                 12330000
123400       END-IF                                                     12340000
123500                                                                  12350000
123600       IF ACTVDAYL >      ZERO                                    12360000
123700           MOVE ACTVDAYI TO ASC-ACTV-DTE-DD-NEW                   12370000
123800       ELSE                                                       12380000
123900           IF ACTVDAYF = DP015-ERASE-EOF                          12390000
124000               MOVE SPACES TO ASC-ACTV-DTE-DD-NEW                 12400000
124100           END-IF                                                 12410000
124200       END-IF                                                     12420000
124300                                                                  12430000
124400       IF ACTVYRL >      ZERO                                     12440000
124500           MOVE ACTVYRI TO ASC-ACTV-DTE-YY-NEW                    12450000
124600       ELSE                                                       12460000
124700           IF ACTVYRF = DP015-ERASE-EOF                           12470000
124800               MOVE SPACES TO ASC-ACTV-DTE-YY-NEW                 12480000
124900           END-IF                                                 12490000
125000       END-IF                                                     12500000
125100                                                                  12510000
125200       IF INACTVML >      ZERO                                    12520000
125300           MOVE INACTVMI   TO ASC-INACTV-DTE-MM-NEW               12530000
125400       ELSE                                                       12540000
125500           IF INACTVMF = DP015-ERASE-EOF                          12550000
125600               MOVE SPACES TO ASC-INACTV-DTE-MM-NEW               12560000
125700           END-IF                                                 12570000
125800       END-IF                                                     12580000
125900                                                                  12590000
126000       IF INACTVDL >      ZERO                                    12600000
126100           MOVE INACTVDI   TO ASC-INACTV-DTE-DD-NEW               12610000
126200       ELSE                                                       12620000
126300           IF INACTVDF = DP015-ERASE-EOF                          12630000
126400               MOVE SPACES TO ASC-INACTV-DTE-DD-NEW               12640000
126500           END-IF                                                 12650000
126600       END-IF                                                     12660000
126700                                                                  12670000
126800       IF INACTVYL >      ZERO                                    12680000
126900           MOVE INACTVYI   TO ASC-INACTV-DTE-YY-NEW               12690000
127000       ELSE                                                       12700000
127100           IF INACTVYF = DP015-ERASE-EOF                          12710000
127200               MOVE SPACES TO ASC-INACTV-DTE-YY-NEW               12720000
127300           END-IF                                                 12730000
127400       END-IF                                                     12740000
127500                                                                  12750000
127600       IF LCALMTHL >      ZERO                                    12760000
127700           MOVE LCALMTHI TO ASC-LAST-CALL-DTE-MM-NEW              12770000
127800       ELSE                                                       12780000
127900           IF LCALMTHF = DP015-ERASE-EOF                          12790000
128000               MOVE SPACES TO ASC-LAST-CALL-DTE-MM-NEW            12800000
128100           END-IF                                                 12810000
128200       END-IF                                                     12820000
128300                                                                  12830000
128400       IF LCALDAYL >      ZERO                                    12840000
128500           MOVE LCALDAYI TO ASC-LAST-CALL-DTE-DD-NEW              12850000
128600       ELSE                                                       12860000
128700           IF LCALDAYF = DP015-ERASE-EOF                          12870000
128800               MOVE SPACES TO ASC-LAST-CALL-DTE-DD-NEW            12880000
128900           END-IF                                                 12890000
129000       END-IF                                                     12900000
129100                                                                  12910000
129200       IF LCALYRL >      ZERO                                     12920000
129300           MOVE LCALYRI TO ASC-LAST-CALL-DTE-YY-NEW               12930000
129400       ELSE                                                       12940000
129500           IF LCALYRF = DP015-ERASE-EOF                           12950000
129600               MOVE SPACES TO ASC-LAST-CALL-DTE-YY-NEW            12960000
129700           END-IF                                                 12970000
129800       END-IF                                                     12980000
129900                                                                  12990000
130000       IF NCALMTHL >      ZERO                                    13000000
130100           MOVE NCALMTHI TO ASC-NEXT-CALL-DTE-MM-NEW              13010000
130200       ELSE                                                       13020000
130300           IF NCALMTHF = DP015-ERASE-EOF                          13030000
130400               MOVE SPACES TO ASC-NEXT-CALL-DTE-MM-NEW            13040000
130500           END-IF                                                 13050000
130600       END-IF                                                     13060000
130700                                                                  13070000
130800       IF NCALDAYL >      ZERO                                    13080000
130900           MOVE NCALDAYI   TO ASC-NEXT-CALL-DTE-DD-NEW            13090000
131000       ELSE                                                       13100000
131100           IF NCALDAYF = DP015-ERASE-EOF                          13110000
131200               MOVE SPACES TO ASC-NEXT-CALL-DTE-DD-NEW            13120000
131300           END-IF                                                 13130000
131400       END-IF                                                     13140000
131500                                                                  13150000
131600       IF NCALYRL >      ZERO                                     13160000
131700           MOVE NCALYRI TO ASC-NEXT-CALL-DTE-YY-NEW               13170000
131800       ELSE                                                       13180000
131900           IF NCALYRF = DP015-ERASE-EOF                           13190000
132000               MOVE SPACES TO ASC-NEXT-CALL-DTE-YY-NEW            13200000
132100           END-IF                                                 13210000
132200       END-IF                                                     13220000
132300                                                                  13230000
132400       IF SNDLMSPL >      ZERO                                    13240000
132500           MOVE SNDLMSPI TO ASC-SEND-DATA-ELEM-IND-NEW            13250000
132600       ELSE                                                       13260000
132700           IF SNDLMSPF = DP015-ERASE-EOF                          13270000
132800               MOVE SPACES   TO ASC-SEND-DATA-ELEM-IND-NEW        13280000
132900           END-IF                                                 13290000
133000       END-IF                                                     13300000
133100                                                                  13310000
133200       IF SEGTRML >       ZERO                                    13320000
133300           MOVE SEGTRMI TO ASC-SEND-SEG-TERM-IND-NEW              13330000
133400       ELSE                                                       13340000
133500           IF SEGTRMF = DP015-ERASE-EOF                           13350000
133600               MOVE SPACES TO ASC-SEND-SEG-TERM-IND-NEW           13360000
133700           END-IF                                                 13370000
133800       END-IF                                                     13380000
133900                                                                  13390000
134000       IF SUBLMSPL >      ZERO                                    13400000
134100           MOVE SUBLMSPI TO ASC-SEND-SUB-ELEM-IND-NEW             13410000
134200       ELSE                                                       13420000
134300           IF SUBLMSPF = DP015-ERASE-EOF                          13430000
134400               MOVE SPACES TO ASC-SEND-SUB-ELEM-IND-NEW           13440000
134500           END-IF                                                 13450000
134600       END-IF                                                     13460000
134700                                                                  13470000
134800       IF NOTES1L >      ZERO                                     13480000
134900           MOVE NOTES1I TO ASC-SEND-NOTE1-NEW                     13490000
135000       ELSE                                                       13500000
135100           IF NOTES1F = DP015-ERASE-EOF                           13510000
135200               MOVE SPACES TO ASC-SEND-NOTE1-NEW                  13520000
135300           END-IF                                                 13530000
135400       END-IF                                                     13540000
135500                                                                  13550000
135600       IF NOTES2L >      ZERO                                     13560000
135700           MOVE NOTES2I TO ASC-SEND-NOTE2-NEW                     13570000
135800       ELSE                                                       13580000
135900           IF NOTES2F = DP015-ERASE-EOF                           13590000
136000               MOVE SPACES TO ASC-SEND-NOTE2-NEW                  13600000
136100           END-IF                                                 13610000
136200       END-IF.                                                    13620000
136300                                                                  13630000
136400/                                                                 13640000
136500*---------------------------------------------------------------- 13650000
136600*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE        13660000
136700*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).   13670000
136800*---------------------------------------------------------------- 13680000
136900 3000-EDIT-DATA-IN-COMMAREA.                                      13690000
137000                                                                  13700000
137100     SET PS-DO-KOHLS-TP-EDIT                                      13710000
137200         PS-NO-ERROR                                              13720000
137300         PS-KOHLS-TP-INFO-BLANK                                   13730000
137400         PS-VENDOR-TP-INFO-BLANK                                  13740000
137500                                 TO TRUE.                         13750000
137600                                                                  13760000
137700     PERFORM 3200-RESET-ATTRIBUTES.                               13770000
137800                                                                  13780000
137900     EVALUATE TRUE                                                13790000
138000       WHEN ASC-ADD-PENDING                                       13800000
138100         PERFORM 3010-ADD-EDITS                                   13810000
138200       WHEN ASC-UPDATE-PENDING                                    13820000
138300         PERFORM 3020-UPDATE-EDITS                                13830000
138400     END-EVALUATE.                                                13840000
138500/                                                                 13850000
138600 3010-ADD-EDITS.                                                  13860000
138700                                                                  13870000
138800     IF ASC-KEY-VEND-INCHG-ID-QUAL > SPACES AND                   13880000
138900        ASC-KEY-VEND-INCHG-ID      > SPACES AND                   13890000
139000        ASC-KEY-NETWK-ID           > SPACES                       13900000
139100         SET PS-VENDOR-TP-INFO-FILLED-IN TO TRUE                  13910000
139200     END-IF.                                                      13920000
139300                                                                  13930000
139400     PERFORM 3100-EDIT-SERVICE-LEVEL.                             13940000
139500     PERFORM 3115-EDIT-KOHLS-TP.                                  13950000
139600     PERFORM 3120-EDIT-INTERCONNECT.                              13960000
139700     PERFORM 3123-EDIT-FA-COMM-MTHD.                              13970000
139800     PERFORM 3125-EDIT-SENT-CNTL.                                 13980000
139900     PERFORM 3130-EDIT-RECV-CNTL.                                 13990000
140000     PERFORM 3135-EDIT-ACTIVE-DATE.                               14000000
140100     PERFORM 3145-EDIT-LAST-NEXT-CALL-DATE.                       14010000
140200     PERFORM 3150-EDIT-HEX-FIELDS.                                14020000
140300     IF PS-NO-ERROR                                               14030000
140400         PERFORM 3160-EDIT-FOR-EXISTANCE                          14040000
140500     END-IF.                                                      14050000
140600                                                                  14060000
140700 3020-UPDATE-EDITS.                                               14070000
140800                                                                  14080000
140900     PERFORM 3100-EDIT-SERVICE-LEVEL.                             14090000
141000     PERFORM 3105-EDIT-VENDOR-TP.                                 14100000
141100     PERFORM 3110-EDIT-NETWORK.                                   14110000
141200                                                                  14120000
141300     IF PS-SKIP-KOHLS-TP-EDIT                                     14130000
141400         CONTINUE                                                 14140000
141500     ELSE                                                         14150000
141600         PERFORM 3115-EDIT-KOHLS-TP                               14160000
141700     END-IF                                                       14170000
141800                                                                  14180000
141900     PERFORM 3120-EDIT-INTERCONNECT.                              14190000
142000     PERFORM 3123-EDIT-FA-COMM-MTHD.                              14200000
142100     PERFORM 3125-EDIT-SENT-CNTL.                                 14210000
142200     PERFORM 3130-EDIT-RECV-CNTL.                                 14220000
142300     PERFORM 3135-EDIT-ACTIVE-DATE.                               14230000
142400     PERFORM 3140-EDIT-INACTIVE-DATE.                             14240000
142500     PERFORM 3145-EDIT-LAST-NEXT-CALL-DATE.                       14250000
142600     PERFORM 3150-EDIT-HEX-FIELDS.                                14260000
142700     IF PS-NO-ERROR                                               14270000
142800         PERFORM 3160-EDIT-FOR-EXISTANCE                          14280000
142900     END-IF.                                                      14290000
143000                                                                  14300000
143100 3100-EDIT-SERVICE-LEVEL.                                         14310000
143200                                                                  14320000
143300     MOVE ASC-SER-LVL-CDE-NEW TO PC-SER-LVL                       14330000
143400                                                                  14340000
143500     IF PC-VALID-SER-LVL                                          14350000
143600         CONTINUE                                                 14360000
143700     ELSE                                                         14370000
143800         SET DP020-MSG-FATAL       TO TRUE                        14380000
143900         MOVE DP015-UNP-ALP-BRT-MDT                               14390000
144000                                   TO SVCLVLA                     14400000
144100         MOVE DP015-RED            TO SVCLVLC                     14410000
144200         MOVE DP015-REVERSE        TO SVCLVLH                     14420000
144300         IF PS-NO-ERROR                                           14430000
144400             SET PS-ERROR              TO TRUE                    14440000
144500             MOVE PC-TSYMSG-00757      TO DP020-MSG-NUMBER        14450000
144600             MOVE -1                   TO SVCLVLL                 14460000
144700         END-IF                                                   14470000
144800         SET DP030-SET-CURSOR-APPL-1                              14480000
144900                                   TO TRUE                        14490000
145000     END-IF.                                                      14500000
145100                                                                  14510000
145200 3105-EDIT-VENDOR-TP.                                             14520000
145300                                                                  14530000
145400     IF ASC-NETWK-ID-NEW > SPACES                                 14540000
145500     OR (ASC-NETWK-ID-NEW = SPACES AND                            14550000
145600         ASC-NETWK-ID     > SPACES)                               14560000
145700         SET PS-TP-ID-ERR TO TRUE                                 14570000
145800         IF ASC-VEND-INCHG-ID-QUAL-NEW > SPACES                   14580000
145900             SET  ET305-IDX TO +1                                 14590000
146000             SEARCH ET305-TP-ID-ENTRY                             14600000
146100                 AT END                                           14610000
146200                    SET PS-TP-ID-ERR TO TRUE                      14620000
146300                 WHEN ET305-TP-ID (ET305-IDX) =                   14630000
146400                      ASC-VEND-INCHG-ID-QUAL-NEW                  14640000
146500                         SET PS-TP-ID-OK  TO TRUE                 14650000
146600             END-SEARCH                                           14660000
146700         END-IF                                                   14670000
146800         IF PS-TP-ID-ERR                                          14680000
146900             SET DP020-MSG-FATAL       TO TRUE                    14690000
147000             MOVE DP015-UNP-ALP-BRT-MDT                           14700000
147100                                       TO VTPIDQA                 14710000
147200             MOVE DP015-RED            TO VTPIDQC                 14720000
147300             MOVE DP015-REVERSE        TO VTPIDQH                 14730000
147400             IF PS-NO-ERROR                                       14740000
147500                 MOVE -1               TO VTPIDQL                 14750000
147600                 SET PS-ERROR              TO TRUE                14760000
147700                 IF ASC-VEND-INCHG-ID-QUAL-NEW = SPACES           14770000
147800*                    ** REQUIRED ENTRY **                         14780000
147900                     MOVE PC-TSYMSG-00007                         14790000
148000                                       TO DP020-MSG-NUMBER        14800000
148100                 ELSE                                             14810000
148200*                    ** INVALID VALUE **                          14820000
148300                     MOVE PC-TSYMSG-00005                         14830000
148400                                       TO DP020-MSG-NUMBER        14840000
148500                 END-IF                                           14850000
148600             END-IF                                               14860000
148700             SET DP030-SET-CURSOR-APPL-1                          14870000
148800                                       TO TRUE                    14880000
148900         END-IF                                                   14890000
149000         IF ASC-VEND-INCHG-ID-NEW > SPACES                        14900000
149100             IF PS-TP-ID-OK                                       14910000
149200                 SET PS-VENDOR-TP-INFO-FILLED-IN TO TRUE          14920000
149300             ELSE                                                 14930000
149400                 CONTINUE                                         14940000
149500             END-IF                                               14950000
149600         ELSE                                                     14960000
149700             SET DP020-MSG-FATAL       TO TRUE                    14970000
149800             MOVE DP015-UNP-ALP-BRT-MDT                           14980000
149900                                       TO VTPIDA                  14990000
150000             MOVE DP015-RED            TO VTPIDC                  15000000
150100             MOVE DP015-REVERSE        TO VTPIDH                  15010000
150200             IF PS-NO-ERROR                                       15020000
150300                 MOVE -1               TO VTPIDL                  15030000
150400                 MOVE PC-TSYMSG-00007                             15040000
150500                                       TO DP020-MSG-NUMBER        15050000
150600                 SET PS-ERROR          TO TRUE                    15060000
150700             END-IF                                               15070000
150800             SET DP030-SET-CURSOR-APPL-1                          15080000
150900                                       TO TRUE                    15090000
151000         END-IF                                                   15100000
151100     ELSE                                                         15110000
151200*        CAN'T ENTER ANY VENDOR INFO IF THE NETWORK IS            15120000
151300*        BLANK                                                    15130000
151400         IF ASC-VEND-INCHG-ID-QUAL-NEW > SPACES                   15140000
151500             SET DP020-MSG-FATAL       TO TRUE                    15150000
151600             MOVE DP015-UNP-ALP-BRT-MDT                           15160000
151700                                       TO VTPIDQA                 15170000
151800             MOVE DP015-RED            TO VTPIDQC                 15180000
151900             MOVE DP015-REVERSE        TO VTPIDQH                 15190000
152000             IF PS-NO-ERROR                                       15200000
152100                 MOVE -1               TO VTPIDQL                 15210000
152200                 MOVE PC-TSYMSG-00005                             15220000
152300                                       TO DP020-MSG-NUMBER        15230000
152400                 SET PS-ERROR          TO TRUE                    15240000
152500             END-IF                                               15250000
152600             SET DP030-SET-CURSOR-APPL-1                          15260000
152700                                       TO TRUE                    15270000
152800         END-IF                                                   15280000
152900         IF ASC-VEND-INCHG-ID-NEW > SPACES                        15290000
153000             SET DP020-MSG-FATAL       TO TRUE                    15300000
153100             MOVE DP015-UNP-ALP-BRT-MDT                           15310000
153200                                       TO VTPIDA                  15320000
153300             MOVE DP015-RED            TO VTPIDC                  15330000
153400             MOVE DP015-REVERSE        TO VTPIDH                  15340000
153500             IF PS-NO-ERROR                                       15350000
153600                 MOVE -1               TO VTPIDL                  15360000
153700                 MOVE PC-TSYMSG-00005                             15370000
153800                                       TO DP020-MSG-NUMBER        15380000
153900                 SET PS-ERROR          TO TRUE                    15390000
154000             END-IF                                               15400000
154100             SET DP030-SET-CURSOR-APPL-1                          15410000
154200                                       TO TRUE                    15420000
154300         END-IF                                                   15430000
154400     END-IF.                                                      15440000
154500                                                                  15450000
154600 3110-EDIT-NETWORK.                                               15460000
154700                                                                  15470000
154800     IF NTWKCDEL > ZERO                                           15480000
154900         IF ASC-NETWK-ID-NEW > SPACES                             15490000
155000             MOVE ASC-NETWK-ID-NEW TO DK-NETWK-ID                 15500000
155100             PERFORM 4350-SELECT-TNETWRK                          15510000
155200             IF SQLCODE = +0                                      15520000
155300*  ADDED TEMPORARY LOGIC TO NOT ALLOW A PRIMARY NETWORK OF IBM    15530000
155400                AND DK-NETWK-ID NOT = '4'                         15540000
155500                 MOVE NETWRK-NETWK-NME          TO                15550000
155600                      ASC-NETWK-NME                               15560000
155700*                MOVE NETWRK-DFLT-INCHG-ID      TO                15570000
155800*                     ASC-KOHL-INCHG-ID-NEW                       15580000
155900*                MOVE NETWRK-DFLT-INCHG-ID-DESC TO                15590000
156000*                     ASC-KOHL-INCHG-ID-QUAL-NEW                  15600000
156100                 SET PS-SKIP-KOHLS-TP-EDIT      TO TRUE           15610000
156200                 SET PS-KOHLS-TP-INFO-FILLED-IN TO TRUE           15620000
156300             ELSE                                                 15630000
156400                 SET DP020-MSG-FATAL       TO TRUE                15640000
156500                 MOVE DP015-UNP-ALP-BRT-MDT                       15650000
156600                                           TO NTWKCDEA            15660000
156700                 MOVE DP015-RED            TO NTWKCDEC            15670000
156800                 MOVE DP015-REVERSE        TO NTWKCDEH            15680000
156900                 IF PS-NO-ERROR                                   15690000
157000                     MOVE -1               TO NTWKCDEL            15700000
157100                     MOVE PC-TSYMSG-00758  TO DP020-MSG-NUMBER    15710000
157200                     SET PS-ERROR          TO TRUE                15720000
157300                 END-IF                                           15730000
157400                 SET DP030-SET-CURSOR-APPL-1                      15740000
157500                                           TO TRUE                15750000
157600             END-IF                                               15760000
157700         ELSE                                                     15770000
157800*            *----------------------------------------------------15780000
157900*            * IF THE TRADING PARTNER ALREADY HAS A NETWORK       15790000
158000*            * ASSIGNED, IT CANNOT BE BLANKED OUT.                15800000
158100*            *----------------------------------------------------15810000
158200             IF ASC-NETWK-ID > SPACE                              15820000
158300                 SET DP020-MSG-FATAL        TO TRUE               15830000
158400                 MOVE DP015-UNP-ALP-BRT-MDT                       15840000
158500                                            TO NTWKCDEA           15850000
158600                 MOVE DP015-RED             TO NTWKCDEC           15860000
158700                 MOVE DP015-REVERSE         TO NTWKCDEH           15870000
158800                 IF PS-NO-ERROR                                   15880000
158900                     MOVE -1                TO NTWKCDEL           15890000
159000                     MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER   15900000
159100                     SET PS-ERROR           TO TRUE               15910000
159200                 END-IF                                           15920000
159300                 SET DP030-SET-CURSOR-APPL-1                      15930000
159400                                            TO TRUE               15940000
159500                 MOVE SPACES                TO ASC-NETWK-NME      15950000
159600             ELSE                                                 15960000
159700                 MOVE SPACES                TO                    15970000
159800                      ASC-NETWK-NME                               15980000
159900                      ASC-KOHL-INCHG-ID-NEW                       15990000
160000                      ASC-KOHL-INCHG-ID-QUAL-NEW                  16000000
160100                 SET  PS-SKIP-KOHLS-TP-EDIT    TO TRUE            16010000
160200             END-IF                                               16020000
160300         END-IF                                                   16030000
160400     END-IF.                                                      16040000
160500                                                                  16050000
160600 3115-EDIT-KOHLS-TP.                                              16060000
160700                                                                  16070000
160800     IF ASC-NETWK-ID-NEW > SPACES                                 16080000
160900     OR (ASC-NETWK-ID-NEW = SPACES AND                            16090000
161000         ASC-NETWK-ID     > SPACES)                               16100000
161100         SET PS-TP-ID-ERR TO TRUE                                 16110000
161200         IF ASC-KOHL-INCHG-ID-QUAL-NEW > SPACES                   16120000
161300             SET  ET305-IDX TO +1                                 16130000
161400             SEARCH ET305-TP-ID-ENTRY                             16140000
161500                 AT END                                           16150000
161600                    SET PS-TP-ID-ERR TO TRUE                      16160000
161700                 WHEN ET305-TP-ID (ET305-IDX) =                   16170000
161800                      ASC-KOHL-INCHG-ID-QUAL-NEW                  16180000
161900                         SET PS-TP-ID-OK  TO TRUE                 16190000
162000             END-SEARCH                                           16200000
162100         END-IF                                                   16210000
162200         IF PS-TP-ID-ERR                                          16220000
162300             SET DP020-MSG-FATAL       TO TRUE                    16230000
162400             MOVE DP015-UNP-ALP-BRT-MDT                           16240000
162500                                       TO KTPIDQA                 16250000
162600             MOVE DP015-RED            TO KTPIDQC                 16260000
162700             MOVE DP015-REVERSE        TO KTPIDQH                 16270000
162800             IF PS-NO-ERROR                                       16280000
162900                 MOVE -1                   TO KTPIDQL             16290000
163000                 SET PS-ERROR              TO TRUE                16300000
163100                 IF ASC-KOHL-INCHG-ID-QUAL-NEW = SPACES           16310000
163200*                    ** REQUIRED ENTRY **                         16320000
163300                     MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER16330000
163400                 ELSE                                             16340000
163500*                    ** INVALID VALUE **                          16350000
163600                     MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER16360000
163700                 END-IF                                           16370000
163800             END-IF                                               16380000
163900             SET DP030-SET-CURSOR-APPL-1                          16390000
164000                                       TO TRUE                    16400000
164100         END-IF                                                   16410000
164200         IF ASC-KOHL-INCHG-ID-NEW > SPACES                        16420000
164300             IF PS-TP-ID-OK                                       16430000
164400                 SET PS-KOHLS-TP-INFO-FILLED-IN TO TRUE           16440000
164500             ELSE                                                 16450000
164600                 CONTINUE                                         16460000
164700             END-IF                                               16470000
164800         ELSE                                                     16480000
164900             SET DP020-MSG-FATAL       TO TRUE                    16490000
165000             MOVE DP015-UNP-ALP-BRT-MDT                           16500000
165100                                       TO KTPIDA                  16510000
165200             MOVE DP015-RED            TO KTPIDC                  16520000
165300             MOVE DP015-REVERSE        TO KTPIDH                  16530000
165400             IF PS-NO-ERROR                                       16540000
165500                 MOVE -1                   TO KTPIDL              16550000
165600                 MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER    16560000
165700                 SET PS-ERROR              TO TRUE                16570000
165800             END-IF                                               16580000
165900             SET DP030-SET-CURSOR-APPL-1                          16590000
166000                                       TO TRUE                    16600000
166100         END-IF                                                   16610000
166200     ELSE                                                         16620000
166300         IF ASC-KOHL-INCHG-ID-QUAL-NEW > SPACES                   16630000
166400             SET DP020-MSG-FATAL       TO TRUE                    16640000
166500             MOVE DP015-UNP-ALP-BRT-MDT                           16650000
166600                                       TO KTPIDQA                 16660000
166700             MOVE DP015-RED            TO KTPIDQC                 16670000
166800             MOVE DP015-REVERSE        TO KTPIDQH                 16680000
166900             IF PS-NO-ERROR                                       16690000
167000                 MOVE -1                   TO KTPIDQL             16700000
167100                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    16710000
167200                 SET PS-ERROR              TO TRUE                16720000
167300             END-IF                                               16730000
167400             SET DP030-SET-CURSOR-APPL-1                          16740000
167500                                       TO TRUE                    16750000
167600         END-IF                                                   16760000
167700         IF ASC-KOHL-INCHG-ID-NEW > SPACES                        16770000
167800             SET DP020-MSG-FATAL       TO TRUE                    16780000
167900             MOVE DP015-UNP-ALP-BRT-MDT                           16790000
168000                                       TO KTPIDA                  16800000
168100             MOVE DP015-RED            TO KTPIDC                  16810000
168200             MOVE DP015-REVERSE        TO KTPIDH                  16820000
168300             IF PS-NO-ERROR                                       16830000
168400                 MOVE -1                   TO KTPIDL              16840000
168500                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    16850000
168600                 SET PS-ERROR              TO TRUE                16860000
168700             END-IF                                               16870000
168800             SET DP030-SET-CURSOR-APPL-1                          16880000
168900                                       TO TRUE                    16890000
169000         END-IF                                                   16900000
169100     END-IF.                                                      16910000
169200                                                                  16920000
169300 3120-EDIT-INTERCONNECT.                                          16930000
169400                                                                  16940000
169500     IF INTRCCDL > ZERO                                           16950000
169600         IF ASC-INTRCONN-NETWK-IND-NEW = SPACES                   16960000
169700             MOVE SPACES TO ASC-INTRCONN-NETWK-NME                16970000
169800         ELSE                                                     16980000
169900             PERFORM 3122-GET-INTRCONN-NETWK-NME                  16990000
170000         END-IF                                                   17000000
170100     END-IF.                                                      17010000
170200                                                                  17020000
170300     IF ASC-INTRCONN-NETWK-IND-NEW = ASC-NETWK-ID-NEW  AND        17030000
170400        ASC-NETWK-ID-NEW > SPACES                                 17040000
170500         SET DP020-MSG-FATAL       TO TRUE                        17050000
170600         MOVE DP015-UNP-ALP-BRT-MDT                               17060000
170700                                   TO INTRCCDA                    17070000
170800         MOVE DP015-RED            TO INTRCCDC                    17080000
170900         MOVE DP015-REVERSE        TO INTRCCDH                    17090000
171000         IF PS-NO-ERROR                                           17100000
171100             MOVE -1               TO INTRCCDL                    17110000
171200             MOVE PC-TSYMSG-00759  TO DP020-MSG-NUMBER            17120000
171300             SET PS-ERROR          TO TRUE                        17130000
171400         END-IF                                                   17140000
171500         SET DP030-SET-CURSOR-APPL-1                              17150000
171600                                   TO TRUE                        17160000
171700     END-IF.                                                      17170000
171800                                                                  17180000
171900 3122-GET-INTRCONN-NETWK-NME.                                     17190000
172000                                                                  17200000
172100     MOVE ASC-INTRCONN-NETWK-IND-NEW TO DK-NETWK-ID               17210000
172200     PERFORM 4350-SELECT-TNETWRK                                  17220000
172300                                                                  17230000
172400     IF SQLCODE = +0                                              17240000
172500         MOVE NETWRK-NETWK-NME          TO                        17250000
172600              ASC-INTRCONN-NETWK-NME                              17260000
172700     ELSE                                                         17270000
172800         SET DP020-MSG-FATAL       TO TRUE                        17280000
172900         MOVE DP015-UNP-ALP-BRT-MDT                               17290000
173000                                   TO INTRCCDA                    17300000
173100         MOVE DP015-RED            TO INTRCCDC                    17310000
173200         MOVE DP015-REVERSE        TO INTRCCDH                    17320000
173300         IF PS-NO-ERROR                                           17330000
173400             MOVE -1               TO INTRCCDL                    17340000
173500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            17350000
173600             SET PS-ERROR          TO TRUE                        17360000
173700         END-IF                                                   17370000
173800         SET DP030-SET-CURSOR-APPL-1                              17380000
173900                                   TO TRUE                        17390000
174000     END-IF.                                                      17400000
174100/                                                                 17410000
174200 3123-EDIT-FA-COMM-MTHD.                                          17420000
174300                                                                  17430000
174400     IF FACMTHL > ZERO                                            17440000
174500         IF ASC-FA-COMM-MTHD-NEW = SPACES                         17450000
174600             MOVE SPACES TO ASC-FA-COMM-MTHD-NME                  17460000
174700         ELSE                                                     17470000
174800             PERFORM 3124-GET-FA-COMM-MTHD-NME                    17480000
174900         END-IF                                                   17490000
175000     END-IF.                                                      17500000
175100                                                                  17510000
175200     IF ASC-FA-COMM-MTHD-NEW NOT = 'V' AND                        17520000
175300        ASC-FA-COMM-MTHD-NEW NOT = 'F' AND                        17530000
175400        ASC-FA-COMM-MTHD-NEW NOT = 'A' AND                        17540000
175500        ASC-FA-COMM-MTHD-NEW NOT = 'E'                            17550000
175600         SET DP020-MSG-FATAL       TO TRUE                        17560000
175700         MOVE DP015-UNP-ALP-BRT-MDT                               17570000
175800                                   TO FACMTHA                     17580000
175900         MOVE DP015-RED            TO FACMTHC                     17590000
176000         MOVE DP015-REVERSE        TO FACMTHH                     17600000
176100         IF PS-NO-ERROR                                           17610000
176200             MOVE -1               TO FACMTHL                     17620000
176300             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            17630000
176400             SET PS-ERROR          TO TRUE                        17640000
176500         END-IF                                                   17650000
176600         SET DP030-SET-CURSOR-APPL-1                              17660000
176700                                   TO TRUE                        17670000
176800     END-IF.                                                      17680000
176900                                                                  17690000
177000 3124-GET-FA-COMM-MTHD-NME.                                       17700000
177100                                                                  17710000
177200     MOVE SPACES TO ASC-FA-COMM-MTHD-NME.                         17720000
177300     IF ASC-FA-COMM-MTHD-NEW = 'V'                                17730000
177400         MOVE 'VAN  ' TO ASC-FA-COMM-MTHD-NME                     17740000
177500     ELSE                                                         17750000
177600         IF ASC-FA-COMM-MTHD-NEW = 'F'                            17760000
177700             MOVE 'FTP  ' TO ASC-FA-COMM-MTHD-NME                 17770000
177800         ELSE                                                     17780000
177900             IF ASC-FA-COMM-MTHD-NEW = 'E'                        17790000
178000                MOVE 'EMAIL' TO ASC-FA-COMM-MTHD-NME              17800000
178100             ELSE                                                 17810000
178200                 IF ASC-FA-COMM-MTHD-NEW = 'A'                    17820000
178300                     MOVE 'AS2  ' TO ASC-FA-COMM-MTHD-NME         17830000
178400                 END-IF                                           17840000
178500             END-IF                                               17850000
178600         END-IF                                                   17860000
178700     END-IF.                                                      17870000
178800                                                                  17880000
178900 3125-EDIT-SENT-CNTL.                                             17890000
179000                                                                  17900000
179100     IF ASC-LAST-SEND-CNTL-NBR-NEWX > SPACES                      17910000
179200         MOVE ASC-LAST-SEND-CNTL-NBR-NEWX                         17920000
179300                                     TO DP010I-UNEDITED-FIELD     17930000
179400         MOVE 9                      TO DP010I-MAXIMUM-DIGITS     17940000
179500         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   17950000
179600         SET DP010I-NEGATIVE-NOT-ALLOWED                          17960000
179700                                     TO TRUE                      17970000
179810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17981001
179820                         USING DP010I-NUMERIC-EDIT-AREA           17982001
179900         IF DP010I-ERROR-DETECTED                                 17990000
180000             MOVE DP015-REVERSE      TO LSNBRH                    18000000
180100             MOVE DP015-RED          TO LSNBRC                    18010000
180200             MOVE DP015-UNP-ALP-BRT-MDT                           18020000
180300                                     TO LSNBRA                    18030000
180400             IF PS-NO-ERROR                                       18040000
180500                 SET PS-ERROR        TO TRUE                      18050000
180600                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         18060000
180700                 MOVE -1             TO LSNBRL                    18070000
180800             END-IF                                               18080000
180900             SET DP030-SET-CURSOR-APPL-1                          18090000
181000                                       TO TRUE                    18100000
181100         ELSE                                                     18110000
181200             MOVE DP010I-NUMERIC-FIELD                            18120000
181300                                     TO ASC-LAST-SEND-CNTL-NBR-NEW18130000
181400         END-IF                                                   18140000
181500     ELSE                                                         18150000
181600         MOVE ZERO TO ASC-LAST-SEND-CNTL-NBR-NEW                  18160000
181700     END-IF                                                       18170000
181800                                                                  18180000
181900     IF ASC-SEND-CNTL-NBR-CDE-NEW = '0' OR '1'                    18190000
182000         CONTINUE                                                 18200000
182100     ELSE                                                         18210000
182200         SET DP020-MSG-FATAL       TO TRUE                        18220000
182300         MOVE DP015-UNP-ALP-BRT-MDT                               18230000
182400                                   TO LSMCDA                      18240000
182500         MOVE DP015-RED            TO LSMCDC                      18250000
182600         MOVE DP015-REVERSE        TO LSMCDH                      18260000
182700         IF PS-NO-ERROR                                           18270000
182800             MOVE -1                   TO LSMCDL                  18280000
182900             MOVE PC-TSYMSG-00760      TO DP020-MSG-NUMBER        18290000
183000             SET PS-ERROR              TO TRUE                    18300000
183100         END-IF                                                   18310000
183200         SET DP030-SET-CURSOR-APPL-1                              18320000
183300                                   TO TRUE                        18330000
183400     END-IF.                                                      18340000
183500                                                                  18350000
183600     MOVE '00200' TO ASC-SEND-FMT-VER-CDE-NEW                     18360000
183700     MOVE 'U'     TO ASC-SEND-FMT-NME-NEW.                        18370000
183800                                                                  18380000
183900     IF ASC-OVRRD-SND-CNTL-NBR-NEWX > SPACES                      18390000
184000         MOVE ASC-OVRRD-SND-CNTL-NBR-NEWX                         18400000
184100                                     TO DP010I-UNEDITED-FIELD     18410000
184200         MOVE 9                      TO DP010I-MAXIMUM-DIGITS     18420000
184300         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   18430000
184400         SET DP010I-NEGATIVE-NOT-ALLOWED                          18440000
184500                                     TO TRUE                      18450000
184610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18461001
184620                         USING DP010I-NUMERIC-EDIT-AREA           18462001
184700         IF DP010I-ERROR-DETECTED                                 18470000
184800             MOVE DP015-REVERSE      TO LSOVRH                    18480000
184900             MOVE DP015-RED          TO LSOVRC                    18490000
185000             MOVE DP015-UNP-ALP-BRT-MDT                           18500000
185100                                     TO LSOVRA                    18510000
185200             IF PS-NO-ERROR                                       18520000
185300                 SET PS-ERROR        TO TRUE                      18530000
185400                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         18540000
185500                 MOVE -1             TO LSOVRL                    18550000
185600             END-IF                                               18560000
185700             SET DP030-SET-CURSOR-APPL-1                          18570000
185800                                       TO TRUE                    18580000
185900         ELSE                                                     18590000
186000             MOVE DP010I-NUMERIC-FIELD                            18600000
186100                                     TO ASC-OVRRD-SND-CNTL-NBR-NEW18610000
186200         END-IF                                                   18620000
186300     ELSE                                                         18630000
186400         MOVE ZERO TO ASC-OVRRD-SND-CNTL-NBR-NEW                  18640000
186500     END-IF                                                       18650000
186600                                                                  18660000
186700     IF ASC-OVRRD-SND-CNTL-ID-NEW = 'Y' OR 'N'                    18670000
186800         CONTINUE                                                 18680000
186900     ELSE                                                         18690000
187000         SET DP020-MSG-FATAL       TO TRUE                        18700000
187100         MOVE DP015-UNP-ALP-BRT-MDT                               18710000
187200                                   TO LSOVRIDA                    18720000
187300         MOVE DP015-RED            TO LSOVRIDC                    18730000
187400         MOVE DP015-REVERSE        TO LSOVRIDH                    18740000
187500         IF PS-NO-ERROR                                           18750000
187600             MOVE -1                   TO LSOVRIDL                18760000
187700             MOVE PC-TSYMSG-00349      TO DP020-MSG-NUMBER        18770000
187800             SET PS-ERROR              TO TRUE                    18780000
187900         END-IF                                                   18790000
188000         SET DP030-SET-CURSOR-APPL-1                              18800000
188100                                   TO TRUE                        18810000
188200     END-IF.                                                      18820000
188300                                                                  18830000
188400 3130-EDIT-RECV-CNTL.                                             18840000
188500                                                                  18850000
188600     IF ASC-LAST-RECV-CNTL-NBR-NEWX > SPACES                      18860000
188700         MOVE ASC-LAST-RECV-CNTL-NBR-NEWX                         18870000
188800                                     TO DP010I-UNEDITED-FIELD     18880000
188900         MOVE 9                      TO DP010I-MAXIMUM-DIGITS     18890000
189000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   18900000
189100         SET DP010I-NEGATIVE-NOT-ALLOWED                          18910000
189200                                     TO TRUE                      18920000
189310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18931001
189320                         USING DP010I-NUMERIC-EDIT-AREA           18932001
189400         IF DP010I-ERROR-DETECTED                                 18940000
189500             MOVE DP015-REVERSE      TO LRNBRH                    18950000
189600             MOVE DP015-RED          TO LRNBRC                    18960000
189700             MOVE DP015-UNP-ALP-BRT-MDT                           18970000
189800                                     TO LRNBRA                    18980000
189900             IF PS-NO-ERROR                                       18990000
190000                 SET PS-ERROR        TO TRUE                      19000000
190100                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         19010000
190200                 MOVE -1             TO LRNBRL                    19020000
190300             END-IF                                               19030000
190400             SET DP030-SET-CURSOR-APPL-1                          19040000
190500                                       TO TRUE                    19050000
190600         ELSE                                                     19060000
190700             MOVE DP010I-NUMERIC-FIELD                            19070000
190800                                     TO ASC-LAST-RECV-CNTL-NBR-NEW19080000
190900         END-IF                                                   19090000
191000     ELSE                                                         19100000
191100         MOVE ZERO TO ASC-LAST-RECV-CNTL-NBR-NEW                  19110000
191200     END-IF                                                       19120000
191300                                                                  19130000
191400     IF ASC-RECV-CNTL-NBR-CDE-NEW = '0' OR '1'                    19140000
191500         CONTINUE                                                 19150000
191600     ELSE                                                         19160000
191700         SET DP020-MSG-FATAL       TO TRUE                        19170000
191800         MOVE DP015-UNP-ALP-BRT-MDT                               19180000
191900                                   TO LRMCDA                      19190000
192000         MOVE DP015-RED            TO LRMCDC                      19200000
192100         MOVE DP015-REVERSE        TO LRMCDH                      19210000
192200         IF PS-NO-ERROR                                           19220000
192300             MOVE -1                   TO LRMCDL                  19230000
192400             MOVE PC-TSYMSG-00760      TO DP020-MSG-NUMBER        19240000
192500             SET PS-ERROR              TO TRUE                    19250000
192600         END-IF                                                   19260000
192700         SET DP030-SET-CURSOR-APPL-1                              19270000
192800                                   TO TRUE                        19280000
192900     END-IF.                                                      19290000
193000                                                                  19300000
193100     MOVE '00200' TO ASC-RECV-FMT-VER-CDE-NEW                     19310000
193200     MOVE 'U'     TO ASC-RECV-FMT-NME-NEW.                        19320000
193300                                                                  19330000
193400     IF ASC-OVRRD-RCV-CNTL-NBR-NEWX > SPACES                      19340000
193500         MOVE ASC-OVRRD-RCV-CNTL-NBR-NEWX                         19350000
193600                                     TO DP010I-UNEDITED-FIELD     19360000
193700         MOVE 9                      TO DP010I-MAXIMUM-DIGITS     19370000
193800         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   19380000
193900         SET DP010I-NEGATIVE-NOT-ALLOWED                          19390000
194000                                     TO TRUE                      19400000
194110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19411001
194120                         USING DP010I-NUMERIC-EDIT-AREA           19412001
194200         IF DP010I-ERROR-DETECTED                                 19420000
194300             MOVE DP015-REVERSE      TO LROVRH                    19430000
194400             MOVE DP015-RED          TO LROVRC                    19440000
194500             MOVE DP015-UNP-ALP-BRT-MDT                           19450000
194600                                     TO LROVRA                    19460000
194700             IF PS-NO-ERROR                                       19470000
194800                 SET PS-ERROR        TO TRUE                      19480000
194900                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         19490000
195000                 MOVE -1             TO LROVRL                    19500000
195100             END-IF                                               19510000
195200             SET DP030-SET-CURSOR-APPL-1                          19520000
195300                                       TO TRUE                    19530000
195400         ELSE                                                     19540000
195500             MOVE DP010I-NUMERIC-FIELD                            19550000
195600                                     TO ASC-OVRRD-RCV-CNTL-NBR-NEW19560000
195700         END-IF                                                   19570000
195800     ELSE                                                         19580000
195900         MOVE ZERO TO ASC-OVRRD-RCV-CNTL-NBR-NEW                  19590000
196000     END-IF                                                       19600000
196100                                                                  19610000
196200     IF ASC-OVRRD-RCV-CNTL-ID-NEW = 'Y' OR 'N'                    19620000
196300         CONTINUE                                                 19630000
196400     ELSE                                                         19640000
196500         SET DP020-MSG-FATAL       TO TRUE                        19650000
196600         MOVE DP015-UNP-ALP-BRT-MDT                               19660000
196700                                   TO LROVRIDA                    19670000
196800         MOVE DP015-RED            TO LROVRIDC                    19680000
196900         MOVE DP015-REVERSE        TO LROVRIDH                    19690000
197000         IF PS-NO-ERROR                                           19700000
197100             MOVE -1                   TO LROVRIDL                19710000
197200             MOVE PC-TSYMSG-00349      TO DP020-MSG-NUMBER        19720000
197300             SET PS-ERROR              TO TRUE                    19730000
197400         END-IF                                                   19740000
197500         SET DP030-SET-CURSOR-APPL-1                              19750000
197600                                   TO TRUE                        19760000
197700     END-IF.                                                      19770000
197800                                                                  19780000
197900 3135-EDIT-ACTIVE-DATE.                                           19790000
198000                                                                  19800000
198100     IF ASC-ACTV-DTE-MM-NEW = SPACES AND                          19810000
198200        ASC-ACTV-DTE-DD-NEW = SPACES AND                          19820000
198300        ASC-ACTV-DTE-YY-NEW = SPACES                              19830000
198400         MOVE SPACE TO ASC-ACTV-DTE-NEW                           19840000
198500     END-IF                                                       19850000
198600                                                                  19860000
198700     SET PS-VALID-DATE TO TRUE                                    19870000
198800                                                                  19880000
198900     IF  ASC-ACTV-DTE-NEW = SPACE                                 19890000
199000         CONTINUE                                                 19900000
199100     ELSE                                                         19910000
199200         IF PS-KOHLS-TP-INFO-BLANK                                19920000
199300         OR PS-VENDOR-TP-INFO-BLANK                               19930000
199400             SET PS-INVALID-DATE TO TRUE                          19940000
199500             IF PS-NO-ERROR                                       19950000
199600                 MOVE PC-TSYMSG-00839                             19960000
199700                                       TO DP020-MSG-NUMBER        19970000
199800                 MOVE -1               TO ACTVMTHL                19980000
199900                 SET PS-ERROR          TO TRUE                    19990000
200000             END-IF                                               20000000
200100         ELSE                                                     20010000
200200             MOVE ASC-ACTV-DTE-NEW TO PV-CCYYMMDD-DATE            20020000
200300             PERFORM 3195-EDIT-DATE                               20030000
200400             MOVE PV-CCYYMMDD-DATE TO ASC-ACTV-DTE-NEW            20040000
200500             IF PS-VALID-DATE                                     20050000
200600                 IF  PV-CCYYMMDD-DATE >= ASC-SETUP-DTE            20060000
200700                     CONTINUE                                     20070000
200800                 ELSE                                             20080000
200900                     SET PS-INVALID-DATE       TO TRUE            20090000
201000                     IF PS-NO-ERROR                               20100000
201100                         MOVE PC-TSYMSG-00835                     20110000
201200                                               TO DP020-MSG-NUMBER20120000
201300                         MOVE -1               TO ACTVMTHL        20130000
201400                         SET PS-ERROR          TO TRUE            20140000
201500                     END-IF                                       20150000
201600                 END-IF                                           20160000
201700             END-IF                                               20170000
201800         END-IF                                                   20180000
201900     END-IF                                                       20190000
202000                                                                  20200000
202100     IF PS-INVALID-DATE                                           20210000
202200         SET DP020-MSG-FATAL       TO TRUE                        20220000
202300         MOVE DP015-UNP-ALP-BRT-MDT                               20230000
202400                                   TO ACTVMTHA                    20240000
202500                                      ACTVDAYA                    20250000
202600                                      ACTVYRA                     20260000
202700         MOVE DP015-RED            TO ACTVMTHC                    20270000
202800                                      ACTVDAYC                    20280000
202900                                      ACTVYRC                     20290000
203000         MOVE DP015-REVERSE        TO ACTVMTHH                    20300000
203100                                      ACTVDAYH                    20310000
203200                                      ACTVYRH                     20320000
203300         IF PS-NO-ERROR                                           20330000
203400             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        20340000
203500             MOVE -1                   TO ACTVMTHL                20350000
203600             SET PS-ERROR              TO TRUE                    20360000
203700         END-IF                                                   20370000
203800         SET DP030-SET-CURSOR-APPL-1                              20380000
203900                                   TO TRUE                        20390000
204000     END-IF.                                                      20400000
204100                                                                  20410000
204200 3140-EDIT-INACTIVE-DATE.                                         20420000
204300                                                                  20430000
204400     IF ASC-INACTV-DTE-MM-NEW = SPACES AND                        20440000
204500        ASC-INACTV-DTE-DD-NEW = SPACES AND                        20450000
204600        ASC-INACTV-DTE-YY-NEW = SPACES                            20460000
204700         MOVE SPACE TO ASC-INACTV-DTE-NEW                         20470000
204800     END-IF                                                       20480000
204900                                                                  20490000
205000     SET PS-VALID-DATE TO TRUE                                    20500000
205100                                                                  20510000
205200     IF ASC-INACTV-DTE-NEW = SPACE                                20520000
205300         CONTINUE                                                 20530000
205400     ELSE                                                         20540000
205500         IF PS-KOHLS-TP-INFO-BLANK                                20550000
205600         OR PS-VENDOR-TP-INFO-BLANK                               20560000
205700             SET PS-INVALID-DATE TO TRUE                          20570000
205800             IF PS-NO-ERROR                                       20580000
205900                 MOVE PC-TSYMSG-00839                             20590000
206000                                       TO DP020-MSG-NUMBER        20600000
206100                 MOVE -1               TO INACTVML                20610000
206200                 SET PS-ERROR          TO TRUE                    20620000
206300             END-IF                                               20630000
206400         ELSE                                                     20640000
206500             IF ASC-ACTV-DTE-NEW = SPACE                          20650000
206600                 SET DP020-MSG-FATAL        TO TRUE               20660000
206700                 MOVE DP015-UNP-ALP-BRT-MDT TO ACTVMTHA           20670000
206800                                               ACTVDAYA           20680000
206900                                               ACTVYRA            20690000
207000                 MOVE DP015-RED             TO ACTVMTHC           20700000
207100                                               ACTVDAYC           20710000
207200                                               ACTVYRC            20720000
207300                 MOVE DP015-REVERSE         TO ACTVMTHH           20730000
207400                                               ACTVDAYH           20740000
207500                                               ACTVYRH            20750000
207600                 IF PS-NO-ERROR                                   20760000
207700                     MOVE PC-TSYMSG-00833   TO DP020-MSG-NUMBER   20770000
207800                     MOVE -1                TO ACTVMTHL           20780000
207900                     SET PS-ERROR           TO TRUE               20790000
208000                 END-IF                                           20800000
208100                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             20810000
208200             END-IF                                               20820000
208300             MOVE ASC-INACTV-DTE-NEW TO PV-CCYYMMDD-DATE          20830000
208400             PERFORM 3195-EDIT-DATE                               20840000
208500             MOVE PV-CCYYMMDD-DATE TO ASC-INACTV-DTE-NEW          20850000
208600             IF PS-VALID-DATE                                     20860000
208700                 IF ASC-ACTV-DTE-NEW = SPACE                      20870000
208800                     CONTINUE                                     20880000
208900                 ELSE                                             20890000
209000                     IF PV-CCYYMMDD-DATE >= ASC-ACTV-DTE-NEW      20900000
209100                         CONTINUE                                 20910000
209200                     ELSE                                         20920000
209300                         SET PS-INVALID-DATE   TO TRUE            20930000
209400                         IF PS-NO-ERROR                           20940000
209500                             MOVE PC-TSYMSG-00165                 20950000
209600                                               TO DP020-MSG-NUMBER20960000
209700                             MOVE -1           TO INACTVML        20970000
209800                             SET PS-ERROR      TO TRUE            20980000
209900                         END-IF                                   20990000
210000                     END-IF                                       21000000
210100                 END-IF                                           21010000
210200             END-IF                                               21020000
210300         END-IF                                                   21030000
210400     END-IF                                                       21040000
210500                                                                  21050000
210600     IF PS-INVALID-DATE                                           21060000
210700         SET DP020-MSG-FATAL       TO TRUE                        21070000
210800         MOVE DP015-UNP-ALP-BRT-MDT                               21080000
210900                                   TO INACTVMA                    21090000
211000                                      INACTVDA                    21100000
211100                                      INACTVYA                    21110000
211200         MOVE DP015-RED            TO INACTVMC                    21120000
211300                                      INACTVDC                    21130000
211400                                      INACTVYC                    21140000
211500         MOVE DP015-REVERSE        TO INACTVMH                    21150000
211600                                      INACTVDH                    21160000
211700                                      INACTVYH                    21170000
211800         IF PS-NO-ERROR                                           21180000
211900             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        21190000
212000             MOVE -1                   TO INACTVML                21200000
212100             SET PS-ERROR              TO TRUE                    21210000
212200         END-IF                                                   21220000
212300         SET DP030-SET-CURSOR-APPL-1                              21230000
212400                                   TO TRUE                        21240000
212500     END-IF.                                                      21250000
212600                                                                  21260000
212700 3145-EDIT-LAST-NEXT-CALL-DATE.                                   21270000
212800                                                                  21280000
212900     IF ASC-LAST-CALL-DTE-MM-NEW = SPACES AND                     21290000
213000        ASC-LAST-CALL-DTE-DD-NEW = SPACES AND                     21300000
213100        ASC-LAST-CALL-DTE-YY-NEW = SPACES                         21310000
213200         MOVE SPACE TO ASC-LAST-CALL-DTE-NEW                      21320000
213300     END-IF                                                       21330000
213400                                                                  21340000
213500     SET PS-VALID-DATE TO TRUE                                    21350000
213600                                                                  21360000
213700     IF ASC-LAST-CALL-DTE-NEW = SPACE                             21370000
213800         CONTINUE                                                 21380000
213900     ELSE                                                         21390000
214000         MOVE ASC-LAST-CALL-DTE-NEW TO PV-CCYYMMDD-DATE           21400000
214100         PERFORM 3195-EDIT-DATE                                   21410000
214200         MOVE PV-CCYYMMDD-DATE TO ASC-LAST-CALL-DTE-NEW           21420000
214300         IF  PS-VALID-DATE                                        21430000
214400             IF ASC-LAST-CALL-DTE-NEW <= ASC-CURRENT-DATE         21440000
214500                 CONTINUE                                         21450000
214600             ELSE                                                 21460000
214700                 SET PS-INVALID-DATE TO TRUE                      21470000
214800                 IF PS-NO-ERROR                                   21480000
214900                     MOVE PC-TSYMSG-00396  TO DP020-MSG-NUMBER    21490000
215000                 END-IF                                           21500000
215100             END-IF                                               21510000
215200         ELSE                                                     21520000
215300             IF PS-NO-ERROR                                       21530000
215400                 MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER    21540000
215500             END-IF                                               21550000
215600         END-IF                                                   21560000
215700     END-IF.                                                      21570000
215800                                                                  21580000
215900     IF PS-INVALID-DATE                                           21590000
216000         MOVE DP015-UNP-ALP-BRT-MDT      TO LCALMTHA              21600000
216100                                            LCALDAYA              21610000
216200                                            LCALYRA               21620000
216300         MOVE DP015-RED                  TO LCALMTHC              21630000
216400                                            LCALDAYC              21640000
216500                                            LCALYRC               21650000
216600         MOVE DP015-REVERSE              TO LCALMTHH              21660000
216700                                            LCALDAYH              21670000
216800                                            LCALYRH               21680000
216900         IF PS-NO-ERROR                                           21690000
217000             SET DP020-MSG-FATAL         TO TRUE                  21700000
217100             MOVE -1                     TO LCALMTHL              21710000
217200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21720000
217300             SET PS-ERROR                TO TRUE                  21730000
217400         END-IF                                                   21740000
217500     END-IF                                                       21750000
217600                                                                  21760000
217700     SET PS-VALID-DATE TO TRUE                                    21770000
217800                                                                  21780000
217900     IF ASC-NEXT-CALL-DTE-MM-NEW = SPACES AND                     21790000
218000        ASC-NEXT-CALL-DTE-DD-NEW = SPACES AND                     21800000
218100        ASC-NEXT-CALL-DTE-YY-NEW = SPACES                         21810000
218200         MOVE SPACE TO ASC-NEXT-CALL-DTE-NEW                      21820000
218300     END-IF                                                       21830000
218400                                                                  21840000
218500     IF ASC-NEXT-CALL-DTE-NEW = SPACE                             21850000
218600         CONTINUE                                                 21860000
218700     ELSE                                                         21870000
218800         IF ASC-LAST-CALL-DTE-NEW = SPACE                         21880000
218900             MOVE DP015-UNP-ALP-BRT-MDT      TO LCALMTHA          21890000
219000                                                LCALDAYA          21900000
219100                                                LCALYRA           21910000
219200             MOVE DP015-RED                  TO LCALMTHC          21920000
219300                                                LCALDAYC          21930000
219400                                                LCALYRC           21940000
219500             MOVE DP015-REVERSE              TO LCALMTHH          21950000
219600                                                LCALDAYH          21960000
219700                                                LCALYRH           21970000
219800             IF PS-NO-ERROR                                       21980000
219900                 MOVE PC-TSYMSG-00834      TO DP020-MSG-NUMBER    21990000
220000                 SET DP020-MSG-FATAL       TO TRUE                22000000
220100                 MOVE -1                   TO LCALMTHL            22010000
220200                 SET DP030-SET-CURSOR-APPL-1                      22020000
220300                                           TO TRUE                22030000
220400                 SET PS-ERROR              TO TRUE                22040000
220500             END-IF                                               22050000
220600         END-IF                                                   22060000
220700         MOVE ASC-NEXT-CALL-DTE-NEW TO PV-CCYYMMDD-DATE           22070000
220800         PERFORM 3195-EDIT-DATE                                   22080000
220900         MOVE PV-CCYYMMDD-DATE TO ASC-NEXT-CALL-DTE-NEW           22090000
221000         IF PS-VALID-DATE                                         22100000
221100             IF ASC-NEXT-CALL-DTE-NEW > ASC-LAST-CALL-DTE-NEW     22110000
221200                AND                                               22120000
221300                ASC-NEXT-CALL-DTE-NEW >= ASC-CURRENT-DATE         22130000
221400                 CONTINUE                                         22140000
221500             ELSE                                                 22150000
221600                 SET PS-INVALID-DATE       TO TRUE                22160000
221700                 IF PS-NO-ERROR                                   22170000
221800                     MOVE PC-TSYMSG-00762 TO DP020-MSG-NUMBER     22180000
221900                 END-IF                                           22190000
222000             END-IF                                               22200000
222100         ELSE                                                     22210000
222200             IF PS-NO-ERROR                                       22220000
222300                 MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER         22230000
222400             END-IF                                               22240000
222500         END-IF                                                   22250000
222600     END-IF                                                       22260000
222700                                                                  22270000
222800     IF PS-INVALID-DATE                                           22280000
222900         SET DP020-MSG-FATAL       TO TRUE                        22290000
223000         MOVE -1                   TO NCALMTHL                    22300000
223100         SET PS-ERROR              TO TRUE                        22310000
223200         MOVE DP015-UNP-ALP-BRT-MDT                               22320000
223300                                   TO NCALMTHA                    22330000
223400                                      NCALDAYA                    22340000
223500                                      NCALYRA                     22350000
223600         MOVE DP015-RED            TO NCALMTHC                    22360000
223700                                      NCALDAYC                    22370000
223800                                      NCALYRC                     22380000
223900         MOVE DP015-REVERSE        TO NCALMTHH                    22390000
224000                                      NCALDAYH                    22400000
224100                                      NCALYRH                     22410000
224200         SET DP030-SET-CURSOR-APPL-1                              22420000
224300                                   TO TRUE                        22430000
224400     END-IF.                                                      22440000
224500                                                                  22450000
224600 3150-EDIT-HEX-FIELDS.                                            22460000
224700                                                                  22470000
224800     SET PS-HEX-FIELD-OK TO TRUE                                  22480000
224900                                                                  22490000
225000     SET MP023I-IDX TO +1                                         22500000
225100     SEARCH MP023I-TABLE-ENTRY                                    22510000
225200         AT END                                                   22520000
225300             SET PS-HEX-FIELD-ERR TO TRUE                         22530000
225400         WHEN ((MP023I-HEX(MP023I-IDX) =                          22540000
225500                ASC-SEND-DATA-ELEM-IND-NEW) AND                   22550000
225600                MP023I-DATA-ELEM-SEP-FLAG(MP023I-IDX) = 'Y')      22560000
225700             MOVE MP023I-PRINT(MP023I-IDX) TO                     22570000
225800                  ASC-SEND-DATA-ELEM-PRT                          22580000
225900     END-SEARCH                                                   22590000
226000                                                                  22600000
226100     IF PS-HEX-FIELD-ERR                                          22610000
226200         MOVE SPACE                    TO ASC-SEND-DATA-ELEM-PRT  22620000
226300         SET DP020-MSG-FATAL           TO TRUE                    22630000
226400         MOVE DP015-UNP-ALP-BRT-MDT    TO SNDLMSPA                22640000
226500         MOVE DP015-RED                TO SNDLMSPC                22650000
226600         MOVE DP015-REVERSE            TO SNDLMSPH                22660000
226700         IF PS-NO-ERROR                                           22670000
226800             MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER        22680000
226900             MOVE -1                   TO SNDLMSPL                22690000
227000             SET PS-ERROR              TO TRUE                    22700000
227100         END-IF                                                   22710000
227200         SET DP030-SET-CURSOR-APPL-1                              22720000
227300                                   TO TRUE                        22730000
227400     END-IF                                                       22740000
227500                                                                  22750000
227600     SET PS-HEX-FIELD-OK TO TRUE                                  22760000
227700                                                                  22770000
227800     SET MP023I-IDX TO +1                                         22780000
227900     SEARCH MP023I-TABLE-ENTRY                                    22790000
228000         AT END                                                   22800000
228100             SET PS-HEX-FIELD-ERR TO TRUE                         22810000
228200         WHEN ((MP023I-HEX(MP023I-IDX) =                          22820000
228300                ASC-SEND-SEG-TERM-IND-NEW) AND                    22830000
228400                MP023I-SEG-TERM-FLAG(MP023I-IDX) = 'Y')           22840000
228500              MOVE MP023I-PRINT(MP023I-IDX) TO                    22850000
228600                   ASC-SEND-SEG-TERM-PRT                          22860000
228700     END-SEARCH                                                   22870000
228800                                                                  22880000
228900     IF PS-HEX-FIELD-ERR                                          22890000
229000         MOVE SPACE                    TO ASC-SEND-SEG-TERM-PRT   22900000
229100         SET DP020-MSG-FATAL           TO TRUE                    22910000
229200         MOVE DP015-UNP-ALP-BRT-MDT    TO SEGTRMA                 22920000
229300         MOVE DP015-RED                TO SEGTRMC                 22930000
229400         MOVE DP015-REVERSE            TO SEGTRMH                 22940000
229500         IF PS-NO-ERROR                                           22950000
229600             MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER        22960000
229700             MOVE -1                   TO SEGTRML                 22970000
229800             SET PS-ERROR              TO TRUE                    22980000
229900         END-IF                                                   22990000
230000         SET DP030-SET-CURSOR-APPL-1                              23000000
230100                                   TO TRUE                        23010000
230200     END-IF                                                       23020000
230300                                                                  23030000
230400     SET MP023I-IDX TO +1                                         23040000
230500     SEARCH MP023I-TABLE-ENTRY                                    23050000
230600         AT END                                                   23060000
230700             SET PS-HEX-FIELD-ERR TO TRUE                         23070000
230800         WHEN ((MP023I-HEX(MP023I-IDX) =                          23080000
230900                ASC-SEND-SUB-ELEM-IND-NEW) AND                    23090000
231000                MP023I-SUB-ELEM-SEP-FLAG(MP023I-IDX) = 'Y')       23100000
231100              MOVE MP023I-PRINT(MP023I-IDX) TO                    23110000
231200                   ASC-SEND-SUB-ELEM-PRT                          23120000
231300     END-SEARCH                                                   23130000
231400                                                                  23140000
231500     IF PS-HEX-FIELD-ERR                                          23150000
231600         MOVE SPACE                    TO ASC-SEND-SUB-ELEM-PRT   23160000
231700         SET DP020-MSG-FATAL           TO TRUE                    23170000
231800         MOVE DP015-UNP-ALP-BRT-MDT    TO SUBLMSPA                23180000
231900         MOVE DP015-RED                TO SUBLMSPC                23190000
232000         MOVE DP015-REVERSE            TO SUBLMSPH                23200000
232100         IF PS-NO-ERROR                                           23210000
232200             MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER        23220000
232300             MOVE -1                   TO SUBLMSPL                23230000
232400             SET PS-ERROR              TO TRUE                    23240000
232500         END-IF                                                   23250000
232600         SET DP030-SET-CURSOR-APPL-1                              23260000
232700                                   TO TRUE                        23270000
232800     END-IF.                                                      23280000
232900/                                                                 23290000
233000*---------------------------------------------------------------- 23300000
233100*  IF ANY KEY FIELDS ARE CHANGED, SEE IF ONE ALREADY EXISTS ON    23310000
233200*  THE DATABASE.  THERE IS NOT AN INDEX TO ENFORCE UNIQUENESS ON  23320000
233300*  THE FOLLOWING FIELDS.  TP_DKEY IS THE ONLY UNIQUE INDEX, SO    23330000
233400*  WE MUST MANUALLY CHECK TO SEE IF THE ADD/UPDATE WILL RESULT    23340000
233500*  IN A DUPLICATE.  KEY FIELDS ARE:                               23350000
233600*                                                                 23360000
233700*      ENT_ID                * STATIC - PASSED TO THIS PGM *      23370000
233800*      VEND_INCHG_ID         * CAN BE MODIFIED IN THIS PGM *      23380000
233900*      VEND_INCHG_ID_DESC    * CAN BE MODIFIED IN THIS PGM *      23390000
234000*      NETWK_ID              * CAN BE MODIFIED IN THIS PGM *      23400000
234100*---------------------------------------------------------------- 23410000
234200                                                                  23420000
234300 3160-EDIT-FOR-EXISTANCE.                                         23430000
234400                                                                  23440000
234500     IF ASC-UPDATE-PENDING                                        23450000
234600                                                                  23460000
234700         IF (ASC-VEND-INCHG-ID-NEW      NOT =                     23470000
234800             ASC-VEND-INCHG-ID)                                   23480000
234900             OR                                                   23490000
235000            (ASC-VEND-INCHG-ID-QUAL-NEW NOT =                     23500000
235100             ASC-VEND-INCHG-ID-QUAL)                              23510000
235200                                                                  23520000
235300             PERFORM 3165-COUNT-TTRDPRT                           23530000
235400                                                                  23540000
235500         END-IF                                                   23550000
235600     ELSE                                                         23560000
235700         PERFORM 3165-COUNT-TTRDPRT                               23570000
235800     END-IF.                                                      23580000
235900/                                                                 23590000
236000*---------------------------------------------------------------- 23600000
236100*    CHECKING FOR A LOGICAL DUPLICATE                             23610000
236200*---------------------------------------------------------------- 23620000
236300                                                                  23630000
236400 3165-COUNT-TTRDPRT.                                              23640000
236500                                                                  23650000
236600     PERFORM                                                      23660000
236700         WITH TEST AFTER                                          23670000
236800         VARYING PV-RETRY-COUNTER                                 23680000
236900         FROM 1 BY 1                                              23690000
237000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23700000
237100            OR (SQLCODE = +0))                                    23710000
237200                                                                  23720000
237300         MOVE +0 TO PV-DUP-COUNTER                                23730000
237400                                                                  23740000
237500         EXEC SQL                                                 23750000
237600           SELECT COUNT(*)                                        23760000
237700           INTO   :PV-DUP-COUNTER                                 23770000
237800           FROM   TTRDPRT                                         23780000
237900           WHERE  ENT_ID             = :ASC-KEY-ENT-ID            23790000
238000             AND  VEND_INCHG_ID_DESC =                            23800000
238100                 :ASC-VEND-INCHG-ID-QUAL-NEWX                     23810000
238200             AND  VEND_INCHG_ID      = :ASC-VEND-INCHG-ID-NEW     23820000
238300         END-EXEC                                                 23830000
238400                                                                  23840000
238500         EVALUATE TRUE                                            23850000
238600             WHEN SQLCODE = +0                                    23860000
238700             WHEN SQLCODE = -904                                  23870000
238800             WHEN SQLCODE = -913                                  23880000
238900                 CONTINUE                                         23890000
239000                                                                  23900000
239100             WHEN SQLWARN0 NOT = SPACES                           23910000
239200             WHEN SQLCODE < ZERO                                  23920000
239300             WHEN SQLCODE > ZERO                                  23930000
239400                 MOVE '3165-COUNT-TTRDPRT'                        23940000
239500                                   TO DP013-PARAGRAPH             23950000
239600                 MOVE 'SELECT ON TTRDPRT'                         23960000
239700                                   TO DP013-MESSAGE-TEXT (1)      23970000
239800                 MOVE SQLCA        TO DP013-SQLCA                 23980000
239900                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    23990000
240000                 SET DP013-DB2-ABEND                              24000000
240100                     DP013-XCTL-DISPLAY-RESTART                   24010000
240200                                   TO TRUE                        24020000
240300                 PERFORM DP013-0000-PROCESS-ABEND                 24030000
240400         END-EVALUATE                                             24040000
240500     END-PERFORM.                                                 24050000
240600                                                                  24060000
240700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24070000
240800         MOVE '3165-COUNT-TTRDPRT'                                24080000
240900                                   TO DP013-PARAGRAPH             24090000
241000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     24100000
241100                                   TO DP013-MESSAGE-TEXT (1)      24110000
241200         MOVE 'A TTRDPRT ROW   '   TO DP013-MESSAGE-TEXT (2)      24120000
241300         MOVE SQLCA                TO DP013-SQLCA                 24130000
241400         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    24140000
241500         SET DP013-DB2-ABEND                                      24150000
241600             DP013-XCTL-DISPLAY-RESTART                           24160000
241700                                   TO TRUE                        24170000
241800         PERFORM DP013-0000-PROCESS-ABEND                         24180000
241900     END-IF.                                                      24190000
242000                                                                  24200000
242100     IF PV-DUP-COUNTER > +0                                       24210000
242200         SET PS-ERROR                   TO TRUE                   24220000
242300         SET DP020-MSG-FATAL            TO TRUE                   24230000
242400         MOVE PC-TSYMSG-00231           TO DP020-MSG-NUMBER       24240000
242500         SET DP030-SET-CURSOR-TRAILER   TO TRUE                   24250000
242600         IF (ASC-VEND-INCHG-ID-QUAL-NEW NOT =                     24260000
242700             ASC-VEND-INCHG-ID-QUAL)                              24270000
242800             MOVE DP015-UNP-ALP-BRT-MDT TO VTPIDQA                24280000
242900             MOVE DP015-RED             TO VTPIDQC                24290000
243000             MOVE DP015-REVERSE         TO VTPIDQH                24300000
243100             MOVE -1                    TO VTPIDQL                24310000
243200             SET DP030-SET-CURSOR-APPL-1                          24320000
243300                                        TO TRUE                   24330000
243400         END-IF                                                   24340000
243500         IF (ASC-VEND-INCHG-ID-NEW      NOT =                     24350000
243600             ASC-VEND-INCHG-ID)                                   24360000
243700             MOVE DP015-UNP-ALP-BRT-MDT TO VTPIDA                 24370000
243800             MOVE DP015-RED             TO VTPIDC                 24380000
243900             MOVE DP015-REVERSE         TO VTPIDH                 24390000
244000             MOVE -1                    TO VTPIDL                 24400000
244100             SET DP030-SET-CURSOR-APPL-1                          24410000
244200                                        TO TRUE                   24420000
244300         END-IF                                                   24430000
244400     END-IF.                                                      24440000
244500/                                                                 24450000
244600 3195-EDIT-DATE.                                                  24460000
244700                                                                  24470000
244800     IF PV-MM NUMERIC                                             24480000
244900     OR PV-MM = SPACE                                             24490000
245000         CONTINUE                                                 24500000
245100     ELSE                                                         24510000
245200         MOVE PV-MM                  TO DP010I-UNEDITED-FIELD     24520000
245300         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     24530000
245400         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   24540000
245500         SET DP010I-NEGATIVE-NOT-ALLOWED                          24550000
245600                                     TO TRUE                      24560000
245710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         24571001
245720                         USING DP010I-NUMERIC-EDIT-AREA           24572001
245800         IF DP010I-ERROR-DETECTED                                 24580000
245900             CONTINUE                                             24590000
246000         ELSE                                                     24600000
246100             MOVE DP010I-NUMERIC-FIELD                            24610000
246200                                     TO PV-MM-9                   24620000
246300         END-IF                                                   24630000
246400     END-IF                                                       24640000
246500                                                                  24650000
246600     IF PV-DD NUMERIC                                             24660000
246700     OR PV-DD = SPACE                                             24670000
246800         CONTINUE                                                 24680000
246900     ELSE                                                         24690000
247000         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     24700000
247100         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     24710000
247200         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   24720000
247300         SET DP010I-NEGATIVE-NOT-ALLOWED                          24730000
247400                                     TO TRUE                      24740000
247510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         24751001
247520                         USING DP010I-NUMERIC-EDIT-AREA           24752001
247600         IF DP010I-ERROR-DETECTED                                 24760000
247700             CONTINUE                                             24770000
247800         ELSE                                                     24780000
247900             MOVE DP010I-NUMERIC-FIELD                            24790000
248000                                     TO PV-DD-9                   24800000
248100         END-IF                                                   24810000
248200     END-IF                                                       24820000
248300                                                                  24830000
248400     IF PV-CCYY NUMERIC                                           24840000
248500     OR PV-CCYY = SPACE                                           24850000
248600         CONTINUE                                                 24860000
248700     ELSE                                                         24870000
248800         MOVE PV-CCYY                TO DP010I-UNEDITED-FIELD     24880000
248900         MOVE 4                      TO DP010I-MAXIMUM-DIGITS     24890000
249000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   24900000
249100         SET DP010I-NEGATIVE-NOT-ALLOWED                          24910000
249200                                     TO TRUE                      24920000
249310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         24931001
249320                         USING DP010I-NUMERIC-EDIT-AREA           24932001
249400         IF DP010I-ERROR-DETECTED                                 24940000
249500             CONTINUE                                             24950000
249600         ELSE                                                     24960000
249700             MOVE DP010I-NUMERIC-FIELD                            24970000
249800                                     TO PV-CCYY-9                 24980000
249900*-->         ALLOW THEM TO ENTER A TWO DIGIT YEAR W/OUT CENTURY   24990000
250000             IF PV-CCYY-9 < 75                                    25000000
250100                 MOVE 20             TO PV-CC                     25010000
250200             ELSE                                                 25020000
250300                 IF PV-CCYY-9 > 1999                              25030000
250400                     CONTINUE                                     25040000
250500                 ELSE                                             25050000
250600                     MOVE 19         TO PV-CC                     25060000
250700                 END-IF                                           25070000
250800             END-IF                                               25080000
250900         END-IF                                                   25090000
251000     END-IF                                                       25100000
251100                                                                  25110000
251200     SET PS-VALID-DATE TO TRUE                                    25120000
251300                                                                  25130000
251400     INITIALIZE DPG51                                             25140000
251500                DPG52                                             25150000
251600                DPG53                                             25160000
251700                DPG54                                             25170000
251800                DPG55                                             25180000
251900                DPG56                                             25190000
252000                                                                  25200000
252100     MOVE 'F2'                 TO DPG51-CALENDAR-TYPE             25210000
252200                                                                  25220000
252300     SET DPG51-DO-NOT-INCR-DECR-DATE                              25230000
252400         DPG52-LK-DTE-ISO-FMT  TO TRUE                            25240000
252500                                                                  25250000
252600     IF PV-CCYY NUMERIC AND                                       25260000
252700        PV-MM   NUMERIC AND                                       25270000
252800        PV-DD   NUMERIC                                           25280000
252900         MOVE '-'      TO PV-DASH1                                25290000
253000                          PV-DASH2                                25300000
253100         MOVE PV-CCYYMMDD-DATE  TO DPG52-LK-DATE-INPUT            25310000
253200                                                                  25320000
253300         CALL PC-DPKUT500                                         25330000
253400             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            25340000
253500                                                                  25350000
253600         IF (DPG54-DATE-INVALID OR                                25360000
253700             DPG54-SEVERE-ERROR)                                  25370000
253800             SET PS-INVALID-DATE TO TRUE                          25380000
253900         END-IF                                                   25390000
254000     ELSE                                                         25400000
254100         SET PS-INVALID-DATE    TO TRUE                           25410000
254200     END-IF.                                                      25420000
254300/                                                                 25430000
254400 3200-RESET-ATTRIBUTES.                                           25440000
254500                                                                  25450000
254600         MOVE DP015-PRO-NOR-OFF     TO VDRNAMEA                   25460000
254700                                       SVCLVLA                    25470000
254800                                       VTPIDQA                    25480000
254900                                       VTPIDA                     25490000
255000                                       NTWKCDEA                   25500000
255100                                       KTPIDQA                    25510000
255200                                       KTPIDA                     25520000
255300                                       INTRCCDA                   25530000
255400                                       FACMTHA                    25540000
255500                                       LSNBRA                     25550000
255600                                       LSMCDA                     25560000
255700                                       LSINTVRA                   25570000
255800                                       LSINTNMA                   25580000
255900                                       LSOVRA                     25590000
256000                                       LSOVRIDA                   25600000
256100                                       LRNBRA                     25610000
256200                                       LRMCDA                     25620000
256300                                       LRINTVRA                   25630000
256400                                       LRINTNMA                   25640000
256500                                       LROVRA                     25650000
256600                                       LROVRIDA                   25660000
256700                                       SETMTHA                    25670000
256800                                       SETDAYA                    25680000
256900                                       SETYRA                     25690000
257000                                       LCHGMTHA                   25700000
257100                                       LCHGDAYA                   25710000
257200                                       LCHGYRA                    25720000
257300                                       USERIDA                    25730000
257400                                       ACTVMTHA                   25740000
257500                                       ACTVDAYA                   25750000
257600                                       ACTVYRA                    25760000
257700                                       INACTVDA                   25770000
257800                                       INACTVMA                   25780000
257900                                       INACTVYA                   25790000
258000                                       LCALMTHA                   25800000
258100                                       LCALDAYA                   25810000
258200                                       LCALYRA                    25820000
258300                                       NCALMTHA                   25830000
258400                                       NCALDAYA                   25840000
258500                                       NCALYRA                    25850000
258600                                       SNDLMSPA                   25860000
258700                                       SEGTRMA                    25870000
258800                                       SUBLMSPA                   25880000
258900                                       NOTES1A                    25890000
259000                                       NOTES2A                    25900000
259100         MOVE DP015-BLUE            TO VDRNAMEC                   25910000
259200                                       SVCLVLC                    25920000
259300                                       VTPIDQC                    25930000
259400                                       VTPIDC                     25940000
259500                                       NTWKCDEC                   25950000
259600                                       NTWKNMEC                   25960000
259700                                       KTPIDQC                    25970000
259800                                       KTPIDC                     25980000
259900                                       INTRCCDC                   25990000
260000                                       INTRCNMC                   26000000
260100                                       FACMTHC                    26010000
260200                                       FACNMEC                    26020000
260300                                       LSNBRC                     26030000
260400                                       LSMCDC                     26040000
260500                                       LSMTXTC                    26050000
260600                                       LSINTVRC                   26060000
260700                                       LSINTNMC                   26070000
260800                                       LSOVRC                     26080000
260900                                       LSOVRIDC                   26090000
261000                                       LRNBRC                     26100000
261100                                       LRMCDC                     26110000
261200                                       LRINTVRC                   26120000
261300                                       LRINTNMC                   26130000
261400                                       LROVRC                     26140000
261500                                       LROVRIDC                   26150000
261600                                       SETMTHC                    26160000
261700                                       SETDAYC                    26170000
261800                                       SETYRC                     26180000
261900                                       LCHGMTHC                   26190000
262000                                       LCHGDAYC                   26200000
262100                                       LCHGYRC                    26210000
262200                                       USERIDC                    26220000
262300                                       ACTVMTHC                   26230000
262400                                       ACTVDAYC                   26240000
262500                                       ACTVYRC                    26250000
262600                                       INACTVDC                   26260000
262700                                       INACTVMC                   26270000
262800                                       INACTVYC                   26280000
262900                                       LCALMTHC                   26290000
263000                                       LCALDAYC                   26300000
263100                                       LCALYRC                    26310000
263200                                       NCALMTHC                   26320000
263300                                       NCALDAYC                   26330000
263400                                       NCALYRC                    26340000
263500                                       SNDLMSPC                   26350000
263600                                       SEGTRMC                    26360000
263700                                       SUBLMSPC                   26370000
263800                                       NOTES1C                    26380000
263900                                       NOTES2C                    26390000
264000         MOVE DP015-HL-OFF          TO VDRNAMEH                   26400000
264100                                       SVCLVLH                    26410000
264200                                       VTPIDQH                    26420000
264300                                       VTPIDH                     26430000
264400                                       NTWKCDEH                   26440000
264500                                       NTWKNMEH                   26450000
264600                                       KTPIDQH                    26460000
264700                                       KTPIDH                     26470000
264800                                       INTRCCDH                   26480000
264900                                       INTRCNMH                   26490000
265000                                       FACMTHH                    26500000
265100                                       FACNMEH                    26510000
265200                                       LSNBRH                     26520000
265300                                       LSMCDH                     26530000
265400                                       LSMTXTH                    26540000
265500                                       LSINTVRH                   26550000
265600                                       LSINTNMH                   26560000
265700                                       LSOVRH                     26570000
265800                                       LSOVRIDH                   26580000
265900                                       LRNBRH                     26590000
266000                                       LRMCDH                     26600000
266100                                       LRINTVRH                   26610000
266200                                       LRINTNMH                   26620000
266300                                       LROVRH                     26630000
266400                                       LROVRIDH                   26640000
266500                                       SETMTHH                    26650000
266600                                       SETDAYH                    26660000
266700                                       SETYRH                     26670000
266800                                       LCHGMTHH                   26680000
266900                                       LCHGDAYH                   26690000
267000                                       LCHGYRH                    26700000
267100                                       USERIDH                    26710000
267200                                       ACTVMTHH                   26720000
267300                                       ACTVDAYH                   26730000
267400                                       ACTVYRH                    26740000
267500                                       INACTVDH                   26750000
267600                                       INACTVMH                   26760000
267700                                       INACTVYH                   26770000
267800                                       LCALMTHH                   26780000
267900                                       LCALDAYH                   26790000
268000                                       LCALYRH                    26800000
268100                                       NCALMTHH                   26810000
268200                                       NCALDAYH                   26820000
268300                                       NCALYRH                    26830000
268400                                       SNDLMSPH                   26840000
268500                                       SEGTRMH                    26850000
268600                                       SUBLMSPH                   26860000
268700                                       NOTES1H                    26870000
268800                                       NOTES2H                    26880000
268900     IF  ASC-ADD-PENDING  OR                                      26890000
269000         ASC-UPDATE-PENDING                                       26900000
269100         MOVE DP015-UNP-ALP-NOR-OFF TO SVCLVLA                    26910000
269200                                       KTPIDQA                    26920000
269300                                       KTPIDA                     26930000
269400                                       INTRCCDA                   26940000
269500                                       FACMTHA                    26950000
269600                                       LSNBRA                     26960000
269700                                       LSMCDA                     26970000
269800                                       LSOVRA                     26980000
269900                                       LSOVRIDA                   26990000
270000                                       LRNBRA                     27000000
270100                                       LRMCDA                     27010000
270200                                       LROVRA                     27020000
270300                                       LROVRIDA                   27030000
270400                                       ACTVMTHA                   27040000
270500                                       ACTVDAYA                   27050000
270600                                       ACTVYRA                    27060000
270700                                       LCALMTHA                   27070000
270800                                       LCALDAYA                   27080000
270900                                       LCALYRA                    27090000
271000                                       NCALMTHA                   27100000
271100                                       NCALDAYA                   27110000
271200                                       NCALYRA                    27120000
271300                                       SNDLMSPA                   27130000
271400                                       SEGTRMA                    27140000
271500                                       SUBLMSPA                   27150000
271600                                       NOTES1A                    27160000
271700                                       NOTES2A                    27170000
271800         MOVE DP015-GREEN           TO SVCLVLC                    27180000
271900                                       KTPIDQC                    27190000
272000                                       KTPIDC                     27200000
272100                                       INTRCCDC                   27210000
272200                                       FACMTHC                    27220000
272300                                       LSNBRC                     27230000
272400                                       LSMCDC                     27240000
272500                                       LSOVRC                     27250000
272600                                       LSOVRIDC                   27260000
272700                                       LRNBRC                     27270000
272800                                       LRMCDC                     27280000
272900                                       LROVRC                     27290000
273000                                       LROVRIDC                   27300000
273100                                       ACTVMTHC                   27310000
273200                                       ACTVDAYC                   27320000
273300                                       ACTVYRC                    27330000
273400                                       LCALMTHC                   27340000
273500                                       LCALDAYC                   27350000
273600                                       LCALYRC                    27360000
273700                                       NCALMTHC                   27370000
273800                                       NCALDAYC                   27380000
273900                                       NCALYRC                    27390000
274000                                       SNDLMSPC                   27400000
274100                                       SEGTRMC                    27410000
274200                                       SUBLMSPC                   27420000
274300                                       NOTES1C                    27430000
274400                                       NOTES2C                    27440000
274500         MOVE DP015-UNDERLINE       TO SVCLVLH                    27450000
274600                                       KTPIDQH                    27460000
274700                                       KTPIDH                     27470000
274800                                       INTRCCDH                   27480000
274900                                       FACMTHH                    27490000
275000                                       LSNBRH                     27500000
275100                                       LSMCDH                     27510000
275200                                       LSOVRH                     27520000
275300                                       LSOVRIDH                   27530000
275400                                       LRNBRH                     27540000
275500                                       LRMCDH                     27550000
275600                                       LROVRH                     27560000
275700                                       LROVRIDH                   27570000
275800                                       ACTVMTHH                   27580000
275900                                       ACTVDAYH                   27590000
276000                                       ACTVYRH                    27600000
276100                                       LCALMTHH                   27610000
276200                                       LCALDAYH                   27620000
276300                                       LCALYRH                    27630000
276400                                       NCALMTHH                   27640000
276500                                       NCALDAYH                   27650000
276600                                       NCALYRH                    27660000
276700                                       SNDLMSPH                   27670000
276800                                       SEGTRMH                    27680000
276900                                       SUBLMSPH                   27690000
277000                                       NOTES1H                    27700000
277100                                       NOTES2H                    27710000
277200     END-IF                                                       27720000
277300                                                                  27730000
277400     IF  ASC-ADD-PENDING                                          27740000
277500         IF ASC-NETWK-ID-NEW = SPACES                             27750000
277600             MOVE DP015-PRO-NOR-OFF     TO KTPIDQA                27760000
277700                                           KTPIDA                 27770000
277800                                           ACTVMTHA               27780000
277900                                           ACTVDAYA               27790000
278000                                           ACTVYRA                27800000
278100             MOVE DP015-HL-OFF          TO KTPIDQH                27810000
278200                                           KTPIDH                 27820000
278300                                           ACTVMTHH               27830000
278400                                           ACTVDAYH               27840000
278500                                           ACTVYRH                27850000
278600             MOVE DP015-BLUE            TO ACTVMTHC               27860000
278700                                           ACTVDAYC               27870000
278800                                           ACTVYRC                27880000
278900         END-IF                                                   27890000
279000     END-IF                                                       27900000
279100                                                                  27910000
279200     IF  ASC-UPDATE-PENDING                                       27920000
279300         MOVE DP015-UNP-ALP-NOR-OFF TO SVCLVLA                    27930000
279400                                       VTPIDQA                    27940000
279500                                       VTPIDA                     27950000
279600                                       NTWKCDEA                   27960000
279700                                       INACTVDA                   27970000
279800                                       INACTVMA                   27980000
279900                                       INACTVYA                   27990000
280000         MOVE DP015-GREEN           TO SVCLVLC                    28000000
280100                                       VTPIDQC                    28010000
280200                                       VTPIDC                     28020000
280300                                       NTWKCDEC                   28030000
280400                                       INACTVDC                   28040000
280500                                       INACTVMC                   28050000
280600                                       INACTVYC                   28060000
280700         MOVE DP015-UNDERLINE       TO SVCLVLH                    28070000
280800                                       VTPIDQH                    28080000
280900                                       VTPIDH                     28090000
281000                                       NTWKCDEH                   28100000
281100                                       INACTVDH                   28110000
281200                                       INACTVMH                   28120000
281300                                       INACTVYH                   28130000
281400     END-IF.                                                      28140000
281500                                                                  28150000
281600/                                                                 28160000
281700*---------------------------------------------------------------- 28170000
281800*    SAVE SCREEN FIELDS FOR LATER COMPARISONS                     28180000
281900*---------------------------------------------------------------- 28190000
282000                                                                  28200000
282100 3500-SAVE-SCREEN-FIELDS.                                         28210000
282200                                                                  28220000
282300     MOVE ASC-NEWLY-ENTERED-FIELD-VALUES  TO                      28230000
282400          ASC-ORIGINAL-FIELD-VALUES.                              28240000
282500/                                                                 28250000
282600*---------------------------------------------------------------- 28260000
282700*  CHECK TO SEE IF ANY FIELDS CHANGED.                            28270000
282800*---------------------------------------------------------------- 28280000
282900                                                                  28290000
283000 3600-CHECK-IF-FIELDS-CHANGED.                                    28300000
283100                                                                  28310000
283200     MOVE 'N'                    TO ASC-FIELDS-CHANGED-SW.        28320000
283300                                                                  28330000
283400     IF  ASC-SER-LVL-CDE-NEW            =                         28340000
283500         ASC-SER-LVL-CDE                                          28350000
283600     AND ASC-VEND-INCHG-ID-QUAL-NEW     =                         28360000
283700         ASC-VEND-INCHG-ID-QUAL                                   28370000
283800     AND ASC-VEND-INCHG-ID-NEW          =                         28380000
283900         ASC-VEND-INCHG-ID                                        28390000
284000     AND ASC-NETWK-ID-NEW               =                         28400000
284100         ASC-NETWK-ID                                             28410000
284200     AND ASC-KOHL-INCHG-ID-NEW          =                         28420000
284300         ASC-KOHL-INCHG-ID                                        28430000
284400     AND ASC-KOHL-INCHG-ID-QUAL-NEW     =                         28440000
284500         ASC-KOHL-INCHG-ID-QUAL                                   28450000
284600     AND ASC-INTRCONN-NETWK-IND-NEW     =                         28460000
284700         ASC-INTRCONN-NETWK-IND                                   28470000
284800     AND ASC-FA-COMM-MTHD-NEW           =                         28480000
284900         ASC-FA-COMM-MTHD                                         28490000
285000     AND ASC-LAST-SEND-CNTL-NBR-NEWX    =                         28500000
285100         ASC-LAST-SEND-CNTL-NBRX                                  28510000
285200     AND ASC-LAST-SEND-CNTL-NBR-NEWX    =                         28520000
285300         ASC-LAST-SEND-CNTL-NBRX                                  28530000
285400     AND ASC-SEND-CNTL-NBR-CDE-NEW      =                         28540000
285500         ASC-SEND-CNTL-NBR-CDE                                    28550000
285600     AND ASC-SEND-CNTL-NBR-CDE-NEW      =                         28560000
285700         ASC-SEND-CNTL-NBR-CDE                                    28570000
285800     AND ASC-SEND-FMT-VER-CDE-NEW       =                         28580000
285900         ASC-SEND-FMT-VER-CDE                                     28590000
286000     AND ASC-SEND-FMT-VER-CDE-NEW       =                         28600000
286100         ASC-SEND-FMT-VER-CDE                                     28610000
286200     AND ASC-SEND-FMT-NME-NEW           =                         28620000
286300         ASC-SEND-FMT-NME                                         28630000
286400     AND ASC-SEND-FMT-NME-NEW           =                         28640000
286500         ASC-SEND-FMT-NME                                         28650000
286600     AND ASC-OVRRD-SND-CNTL-NBR-NEWX    =                         28660000
286700         ASC-OVRRD-SND-CNTL-NBRX                                  28670000
286800     AND ASC-OVRRD-SND-CNTL-ID-NEW      =                         28680000
286900         ASC-OVRRD-SND-CNTL-ID                                    28690000
287000     AND ASC-RECV-CNTL-NBR-CDE-NEW      =                         28700000
287100         ASC-RECV-CNTL-NBR-CDE                                    28710000
287200     AND ASC-RECV-FMT-VER-CDE-NEW       =                         28720000
287300         ASC-RECV-FMT-VER-CDE                                     28730000
287400     AND ASC-RECV-FMT-NME-NEW           =                         28740000
287500         ASC-RECV-FMT-NME                                         28750000
287600     AND ASC-LAST-RECV-CNTL-NBR-NEWX    =                         28760000
287700         ASC-LAST-RECV-CNTL-NBRX                                  28770000
287800     AND ASC-OVRRD-RCV-CNTL-NBR-NEWX    =                         28780000
287900         ASC-OVRRD-RCV-CNTL-NBRX                                  28790000
288000     AND ASC-OVRRD-RCV-CNTL-ID-NEW      =                         28800000
288100         ASC-OVRRD-RCV-CNTL-ID                                    28810000
288200     AND ASC-ACTV-DTE-MM-NEW            =                         28820000
288300         ASC-ACTV-DTE-MM                                          28830000
288400     AND ASC-ACTV-DTE-DD-NEW            =                         28840000
288500         ASC-ACTV-DTE-DD                                          28850000
288600     AND ASC-ACTV-DTE-YY-NEW            =                         28860000
288700         ASC-ACTV-DTE-YY                                          28870000
288800     AND ASC-INACTV-DTE-MM-NEW          =                         28880000
288900         ASC-INACTV-DTE-MM                                        28890000
289000     AND ASC-INACTV-DTE-DD-NEW          =                         28900000
289100         ASC-INACTV-DTE-DD                                        28910000
289200     AND ASC-INACTV-DTE-YY-NEW          =                         28920000
289300         ASC-INACTV-DTE-YY                                        28930000
289400     AND ASC-LAST-CALL-DTE-MM-NEW       =                         28940000
289500         ASC-LAST-CALL-DTE-MM                                     28950000
289600     AND ASC-LAST-CALL-DTE-DD-NEW       =                         28960000
289700         ASC-LAST-CALL-DTE-DD                                     28970000
289800     AND ASC-LAST-CALL-DTE-YY           =                         28980000
289900         ASC-LAST-CALL-DTE-YY-NEW                                 28990000
290000     AND ASC-NEXT-CALL-DTE-MM           =                         29000000
290100         ASC-NEXT-CALL-DTE-MM-NEW                                 29010000
290200     AND ASC-NEXT-CALL-DTE-DD           =                         29020000
290300         ASC-NEXT-CALL-DTE-DD-NEW                                 29030000
290400     AND ASC-NEXT-CALL-DTE-YY           =                         29040000
290500         ASC-NEXT-CALL-DTE-YY-NEW                                 29050000
290600     AND ASC-SEND-DATA-ELEM-IND-NEW     =                         29060000
290700         ASC-SEND-DATA-ELEM-IND                                   29070000
290800     AND ASC-SEND-SEG-TERM-IND-NEW      =                         29080000
290900         ASC-SEND-SEG-TERM-IND                                    29090000
291000     AND ASC-SEND-SUB-ELEM-IND-NEW      =                         29100000
291100         ASC-SEND-SUB-ELEM-IND                                    29110000
291200     AND ASC-SEND-NOTE1-NEW             =                         29120000
291300         ASC-SEND-NOTE1                                           29130000
291400     AND ASC-SEND-NOTE2-NEW             =                         29140000
291500         ASC-SEND-NOTE2                                           29150000
291600         CONTINUE                                                 29160000
291700     ELSE                                                         29170000
291800         SET ASC-FIELDS-CHANGED  TO TRUE                          29180000
291900     END-IF.                                                      29190000
292000                                                                  29200000
292100/                                                                 29210000
292200*---------------------------------------------------------------- 29220000
292300*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST      29230000
292400*    ENTRY.                                                       29240000
292500*---------------------------------------------------------------- 29250000
292600                                                                  29260000
292700 4000-BUILD-INITIAL-PANEL.                                        29270000
292800                                                                  29280000
292900     INITIALIZE DCLTTRDPRT                                        29290000
293000                DCLTNETWRK                                        29300000
293100                DK-DB2-KEYS                                       29310000
293200                ASC-NEWLY-ENTERED-FIELD-VALUES                    29320000
293300                ASC-ORIGINAL-FIELD-VALUES                         29330000
293400                ASC-OTHER-FIELDS.                                 29340000
293500                                                                  29350000
293600     EXEC SQL                                                     29360000
293700         SET :ASC-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           29370000
293800     END-EXEC                                                     29380000
293900                                                                  29390000
294000     EVALUATE TRUE                                                29400000
294100         WHEN SQLCODE = 0                                         29410000
294200             CONTINUE                                             29420000
294300         WHEN OTHER                                               29430000
294400             MOVE '4000-BUILD-INITIAL-PANEL'                      29440000
294500                               TO DP013-PARAGRAPH                 29450000
294600             MOVE 'SET VARIABLE TO CURRENT TIMESTAMP'             29460000
294700                               TO DP013-MESSAGE-TEXT(1)           29470000
294800             MOVE SQLCA        TO DP013-SQLCA                     29480000
294900             MOVE 'N/A    '    TO DP013-DB2-TABLE-NAME (1)        29490000
295000             SET DP013-DB2-ABEND                                  29500000
295100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29510000
295200             PERFORM DP013-0000-PROCESS-ABEND                     29520000
295300     END-EVALUATE.                                                29530000
295400                                                                  29540000
295500     MOVE ASC-KEY-VEND-INCHG-ID       TO DK-VEND-INCHG-ID.        29550000
295600     MOVE ASC-KEY-VEND-INCHG-ID-QUAL  TO DK-VEND-INCHG-ID-QUAL.   29560000
295700     IF ASC-ADD-PENDING                                           29570000
295800         MOVE LOW-VALUES              TO DK-NETWK-ID-LOW          29580000
295900         MOVE HIGH-VALUES             TO DK-NETWK-ID-HIGH         29590000
296000     ELSE                                                         29600000
296100         MOVE ASC-KEY-NETWK-ID        TO DK-NETWK-ID-LOW          29610000
296200                                         DK-NETWK-ID-HIGH         29620000
296300     END-IF.                                                      29630000
296400                                                                  29640000
296500     IF ASC-KEY-TP-DKEY > +0                                      29650000
296600         MOVE ASC-KEY-TP-DKEY     TO DK-TP-DKEY-LOW               29660000
296700                                     DK-TP-DKEY-HIGH              29670000
296800     ELSE                                                         29680000
296900         MOVE +0                  TO DK-TP-DKEY-LOW               29690000
297000         MOVE +999999999          TO DK-TP-DKEY-HIGH              29700000
297100     END-IF.                                                      29710000
297200                                                                  29720000
297300     SET  ASC-NETWK-INFO-FOUND                                    29730000
297400          ASC-VENDOR-INFO-FOUND   TO TRUE                         29740000
297500                                                                  29750000
297600     IF ASC-KEY-ENT-ID = ZERO  AND                                29760000
297700        ASC-KEY-VENDOR-NAME > SPACES                              29770000
297800           PERFORM 4200-SELECT-TENTNME                            29780000
297900           MOVE ENTNME-ENT-ID TO ASC-KEY-ENT-ID                   29790000
298000     END-IF                                                       29800000
298100                                                                  29810000
298200     MOVE ASC-KEY-ENT-ID             TO DK-ENT-ID                 29820000
298300                                                                  29830000
298400     IF ASC-VENDOR-INFO-FOUND                                     29840000
298500         PERFORM 4300-SELECT-TTRDPRT                              29850000
298600     END-IF                                                       29860000
298700                                                                  29870000
298800     MOVE ASC-KEY-VEND-INCHG-ID      TO ASC-VEND-INCHG-ID-NEW     29880000
298900     MOVE ASC-KEY-VEND-INCHG-ID-QUAL TO ASC-VEND-INCHG-ID-QUAL-NEW29890000
299000     MOVE ASC-KEY-NETWK-ID           TO ASC-NETWK-ID-NEW          29900000
299100                                                                  29910000
299200     IF ASC-VENDOR-INFO-FOUND                                     29920000
299300         IF ASC-KEY-NETWK-ID > SPACES                             29930000
299400             MOVE ASC-KEY-NETWK-ID TO DK-NETWK-ID                 29940000
299500             PERFORM 4350-SELECT-TNETWRK                          29950000
299600             IF SQLCODE = +0                                      29960000
299700*  ADDED TEMPORARY LOGIC TO NOT ALLOW A PRIMARY NETWORK OF IBM    29970000
299800                AND DK-NETWK-ID NOT = '4'                         29980000
299900                 MOVE NETWRK-NETWK-NME         TO ASC-NETWK-NME   29990000
300000                 IF ASC-ADD-PENDING                               30000000
300100                     MOVE NETWRK-DFLT-INCHG-ID      TO            30010000
300200                          ASC-KOHL-INCHG-ID-NEW                   30020000
300300                     MOVE NETWRK-DFLT-INCHG-ID-DESC TO            30030000
300400                          ASC-KOHL-INCHG-ID-QUAL-NEW              30040000
300500                 END-IF                                           30050000
300600             END-IF                                               30060000
300700         END-IF                                                   30070000
300800     END-IF                                                       30080000
300900                                                                  30090000
301000     IF ASC-VENDOR-INFO-NOT-FOUND OR                              30100000
301100        ASC-NETWK-INFO-NOT-FOUND                                  30110000
301200         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              30120000
301300             SET PS-ERROR                                         30130000
301400                 DP020-MSG-FATAL                                  30140000
301500                 DP020-NEXT-ACT-APPL-ERROR                        30150000
301600                                   TO TRUE                        30160000
301700                 SET DP030-OVERRIDE-APPL-ERROR                    30170000
301800                                   TO TRUE                        30180000
301900                                                                  30190000
302000     ELSE                                                         30200000
302100                                                                  30210000
302200         PERFORM 4100-GENERAL-DEFAULTS                            30220000
302300                                                                  30230000
302400         IF ASC-ADD-PENDING                                       30240000
302500             PERFORM 4150-ADD-DEFAULTS                            30250000
302600         ELSE                                                     30260000
302700             PERFORM 4160-UPD-DEL-DEFAULTS                        30270000
302800         END-IF                                                   30280000
302900                                                                  30290000
303000         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     30300000
303100                                                                  30310000
303200     END-IF.                                                      30320000
303300                                                                  30330000
303400 4100-GENERAL-DEFAULTS.                                           30340000
303500                                                                  30350000
303600     MOVE '00200'  TO                                             30360000
303700          ASC-SEND-FMT-VER-CDE-NEW                                30370000
303800          ASC-RECV-FMT-VER-CDE-NEW                                30380000
303900                                                                  30390000
304000     MOVE 'U'      TO                                             30400000
304100          ASC-SEND-FMT-NME-NEW                                    30410000
304200          ASC-RECV-FMT-NME-NEW.                                   30420000
304300                                                                  30430000
304400                                                                  30440000
304500 4150-ADD-DEFAULTS.                                               30450000
304600                                                                  30460000
304700     MOVE ASC-CURRENT-DATE   TO ASC-SETUP-DTE                     30470000
304800                                ASC-LAST-CHG-DTE                  30480000
304900     MOVE DP020-USERID       TO ASC-LAST-CHG-UID                  30490000
305000                                                                  30500000
305100     IF ASC-KEY-VEND-INCHG-ID-QUAL > SPACES AND                   30510000
305200        ASC-KEY-VEND-INCHG-ID      > SPACES AND                   30520000
305300        ASC-KEY-NETWK-ID           > SPACES                       30530000
305400         MOVE ASC-CURRENT-DATE   TO ASC-ACTV-DTE-NEW              30540000
305500     END-IF.                                                      30550000
305600                                                                  30560000
305700     MOVE 'V' TO ASC-FA-COMM-MTHD-NEW.                            30570000
305800     MOVE 'VAN  ' TO ASC-FA-COMM-MTHD-NME.                        30580000
305900                                                                  30590000
306000     MOVE 'N' TO ASC-OVRRD-SND-CNTL-ID-NEW                        30600000
306100                 ASC-OVRRD-RCV-CNTL-ID-NEW.                       30610000
306200     MOVE '1' TO ASC-SEND-CNTL-NBR-CDE-NEW.                       30620000
306300                                                                  30630000
306400* HEX 2F                                                          30640000
306500     MOVE MP023I-HEX(1)            TO                             30650000
306600          ASC-SEND-DATA-ELEM-IND-NEW                              30660000
306700     MOVE MP023I-PRINT(1)          TO                             30670000
306800          ASC-SEND-DATA-ELEM-PRT.                                 30680000
306900                                                                  30690000
307000* HEX 15                                                          30700000
307100     MOVE MP023I-HEX(4)            TO                             30710000
307200          ASC-SEND-SEG-TERM-IND-NEW                               30720000
307300     MOVE MP023I-PRINT(4)          TO                             30730000
307400          ASC-SEND-SEG-TERM-PRT.                                  30740000
307500                                                                  30750000
307600* HEX 6E                                                          30760000
307700     MOVE MP023I-HEX(3)            TO                             30770000
307800          ASC-SEND-SUB-ELEM-IND-NEW                               30780000
307900     MOVE MP023I-PRINT(3)          TO                             30790000
308000          ASC-SEND-SUB-ELEM-PRT.                                  30800000
308100                                                                  30810000
308200 4160-UPD-DEL-DEFAULTS.                                           30820000
308300                                                                  30830000
308400     MOVE SPACES TO ASC-INTRCONN-NETWK-NME                        30840000
308500     IF ASC-INTRCONN-NETWK-IND-NEW > SPACES                       30850000
308600         MOVE ASC-INTRCONN-NETWK-IND-NEW TO                       30860000
308700              DK-NETWK-ID                                         30870000
308800         PERFORM 4350-SELECT-TNETWRK                              30880000
308900         MOVE NETWRK-NETWK-NME           TO                       30890000
309000              ASC-INTRCONN-NETWK-NME                              30900000
309100     END-IF.                                                      30910000
309200                                                                  30920000
309300     PERFORM 3124-GET-FA-COMM-MTHD-NME.                           30930000
309400                                                                  30940000
309500                                                                  30950000
309600     SET MP023I-IDX TO +1                                         30960000
309700     SEARCH MP023I-TABLE-ENTRY                                    30970000
309800         AT END                                                   30980000
309900             MOVE SPACE TO                                        30990000
310000                   ASC-SEND-DATA-ELEM-PRT                         31000000
310100         WHEN MP023I-HEX(MP023I-IDX) =                            31010000
310200              ASC-SEND-DATA-ELEM-IND-NEW                          31020000
310300              MOVE MP023I-PRINT(MP023I-IDX) TO                    31030000
310400                   ASC-SEND-DATA-ELEM-PRT                         31040000
310500     END-SEARCH                                                   31050000
310600                                                                  31060000
310700     SET MP023I-IDX TO +1                                         31070000
310800     SEARCH MP023I-TABLE-ENTRY                                    31080000
310900         AT END                                                   31090000
311000             MOVE SPACE TO                                        31100000
311100                   ASC-SEND-SEG-TERM-PRT                          31110000
311200         WHEN MP023I-HEX(MP023I-IDX) =                            31120000
311300              ASC-SEND-SEG-TERM-IND-NEW                           31130000
311400              MOVE MP023I-PRINT(MP023I-IDX) TO                    31140000
311500                   ASC-SEND-SEG-TERM-PRT                          31150000
311600     END-SEARCH                                                   31160000
311700                                                                  31170000
311800     SET MP023I-IDX TO +1                                         31180000
311900     SEARCH MP023I-TABLE-ENTRY                                    31190000
312000         AT END                                                   31200000
312100             MOVE SPACE TO                                        31210000
312200                   ASC-SEND-SUB-ELEM-PRT                          31220000
312300         WHEN MP023I-HEX(MP023I-IDX) =                            31230000
312400              ASC-SEND-SUB-ELEM-IND-NEW                           31240000
312500              MOVE MP023I-PRINT(MP023I-IDX) TO                    31250000
312600                   ASC-SEND-SUB-ELEM-PRT                          31260000
312700     END-SEARCH.                                                  31270000
312800/                                                                 31280000
312900 4200-SELECT-TENTNME.                                             31290000
313000                                                                  31300000
313100     PERFORM                                                      31310000
313200         WITH TEST AFTER                                          31320000
313300         VARYING PV-RETRY-COUNTER                                 31330000
313400         FROM 1 BY 1                                              31340000
313500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31350000
313600            OR (SQLCODE = +0)                                     31360000
313700            OR (SQLCODE = +100))                                  31370000
313800                                                                  31380000
313900         EXEC SQL                                                 31390000
314000           SELECT    ENT_ID                                       31400000
314100             INTO    :ENTNME-ENT-ID                               31410000
314200             FROM    TENTNME                                      31420000
314300            WHERE    ENT_NAME_DESC  = :ASC-KEY-VENDOR-NAME        31430000
314400              AND    TYPE_CDE = '01'                              31440000
314500         END-EXEC                                                 31450000
314600                                                                  31460000
314700         EVALUATE TRUE                                            31470000
314800             WHEN SQLCODE = +0                                    31480000
314900             WHEN SQLCODE = -904                                  31490000
315000             WHEN SQLCODE = -913                                  31500000
315100                 CONTINUE                                         31510000
315200                                                                  31520000
315300             WHEN SQLCODE = +100                                  31530000
315400                                                                  31540000
315500                 SET ASC-VENDOR-INFO-NOT-FOUND TO TRUE            31550000
315600                                                                  31560000
315700             WHEN SQLWARN0 NOT = SPACES                           31570000
315800             WHEN SQLCODE < ZERO                                  31580000
315900             WHEN SQLCODE > ZERO                                  31590000
316000                 MOVE '4200-SELECT-TENTNME'                       31600000
316100                                   TO DP013-PARAGRAPH             31610000
316200                 MOVE 'SELECT ON TENTNME'                         31620000
316300                                   TO DP013-MESSAGE-TEXT (1)      31630000
316400                 MOVE SQLCA        TO DP013-SQLCA                 31640000
316500                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    31650000
316600                 SET DP013-DB2-ABEND                              31660000
316700                     DP013-XCTL-DISPLAY-RESTART                   31670000
316800                                   TO TRUE                        31680000
316900                 PERFORM DP013-0000-PROCESS-ABEND                 31690000
317000         END-EVALUATE                                             31700000
317100     END-PERFORM.                                                 31710000
317200                                                                  31720000
317300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31730000
317400         MOVE '4200-SELECT-TENTNME'                               31740000
317500                                   TO DP013-PARAGRAPH             31750000
317600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     31760000
317700                                   TO DP013-MESSAGE-TEXT (1)      31770000
317800         MOVE 'A TENTNME ROW   '   TO DP013-MESSAGE-TEXT (2)      31780000
317900         MOVE SQLCA                TO DP013-SQLCA                 31790000
318000         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    31800000
318100         SET DP013-DB2-ABEND                                      31810000
318200             DP013-XCTL-DISPLAY-RESTART                           31820000
318300                                   TO TRUE                        31830000
318400         PERFORM DP013-0000-PROCESS-ABEND                         31840000
318500     END-IF.                                                      31850000
318600                                                                  31860000
318700/                                                                 31870000
318800*---------------------------------------------------------------- 31880000
318900* SELECT A TRADING PARTNERSHIP                                    31890000
319000*---------------------------------------------------------------- 31900000
319100 4300-SELECT-TTRDPRT.                                             31910000
319200                                                                  31920000
319300     PERFORM                                                      31930000
319400         WITH TEST AFTER                                          31940000
319500         VARYING PV-RETRY-COUNTER                                 31950000
319600         FROM 1 BY 1                                              31960000
319700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31970000
319800            OR (SQLCODE = +0)                                     31980000
319900            OR (SQLCODE = +100)                                   31990000
320000            OR (SQLCODE = -811))                                  32000000
320100                                                                  32010000
320200         EXEC SQL                                                 32020000
320300             SELECT         VEND_INCHG_ID                         32030000
320400                           ,VEND_INCHG_ID_DESC                    32040000
320500                           ,NETWK_ID                              32050000
320600                           ,KOHL_INCHG_ID                         32060000
320700                           ,KOHL_INCHG_ID_DESC                    32070000
320800                           ,SEND_FMT_VER_CDE                      32080000
320900                           ,SEND_FMT_NME                          32090000
321000                           ,LAST_SEND_CNTL_NBR                    32100000
321100                           ,SEND_CNTL_NBR_CDE                     32110000
321200                           ,OVRRD_SND_CNTL_NBR                    32120000
321300                           ,OVRRD_SND_CNTL_ID                     32130000
321400                           ,RECV_FMT_VER_CDE                      32140000
321500                           ,RECV_FMT_NME                          32150000
321600                           ,LAST_RECV_CNTL_NBR                    32160000
321700                           ,RECV_CNTL_NBR_CDE                     32170000
321800                           ,OVRRD_RCV_CNTL_NBR                    32180000
321900                           ,OVRRD_RCV_CNTL_ID                     32190000
322000                           ,SETUP_DTE                             32200000
322100                           ,LAST_CHG_DTE                          32210000
322200                           ,LAST_CHG_UID                          32220000
322300                           ,ACTV_DTE                              32230000
322400                           ,INACTV_DTE                            32240000
322500                           ,SER_LVL_CDE                           32250000
322600                           ,NOTES_TXT                             32260000
322700                           ,LAST_CALL_DTE                         32270000
322800                           ,NEXT_CALL_DTE                         32280000
322900                           ,SEND_DATA_ELEM_IND                    32290000
323000                           ,SEND_SEG_TERM_IND                     32300000
323100                           ,SEND_SUB_ELEM_IND                     32310000
323200                           ,SEND_ACK_REQD_IND                     32320000
323300                           ,INTRCONN_NETWK_IND                    32330000
323400                           ,FA_COM_MTHD_CDE                       32340000
323500             INTO           :TRDPRT-VEND-INCHG-ID                 32350000
323600                           ,:TRDPRT-VEND-INCHG-ID-DESC            32360000
323700                           ,:TRDPRT-NETWK-ID                      32370000
323800                           ,:TRDPRT-KOHL-INCHG-ID                 32380000
323900                           ,:TRDPRT-KOHL-INCHG-ID-DESC            32390000
324000                           ,:TRDPRT-SEND-FMT-VER-CDE              32400000
324100                           ,:TRDPRT-SEND-FMT-NME                  32410000
324200                           ,:TRDPRT-LAST-SEND-CNTL-NBR            32420000
324300                           ,:TRDPRT-SEND-CNTL-NBR-CDE             32430000
324400                           ,:TRDPRT-OVRRD-SND-CNTL-NBR            32440000
324500                           ,:TRDPRT-OVRRD-SND-CNTL-ID             32450000
324600                           ,:TRDPRT-RECV-FMT-VER-CDE              32460000
324700                           ,:TRDPRT-RECV-FMT-NME                  32470000
324800                           ,:TRDPRT-LAST-RECV-CNTL-NBR            32480000
324900                           ,:TRDPRT-RECV-CNTL-NBR-CDE             32490000
325000                           ,:TRDPRT-OVRRD-RCV-CNTL-NBR            32500000
325100                           ,:TRDPRT-OVRRD-RCV-CNTL-ID             32510000
325200                           ,:TRDPRT-SETUP-DTE                     32520000
325300                           ,:TRDPRT-LAST-CHG-DTE                  32530000
325400                           ,:TRDPRT-LAST-CHG-UID                  32540000
325500                           ,:TRDPRT-ACTV-DTE                      32550000
325600                           ,:TRDPRT-INACTV-DTE                    32560000
325700                           ,:TRDPRT-SER-LVL-CDE                   32570000
325800                           ,:TRDPRT-NOTES-TXT                     32580000
325900                           ,:TRDPRT-LAST-CALL-DTE                 32590000
326000                           ,:TRDPRT-NEXT-CALL-DTE                 32600000
326100                           ,:TRDPRT-SEND-DATA-ELEM-IND            32610000
326200                           ,:TRDPRT-SEND-SEG-TERM-IND             32620000
326300                           ,:TRDPRT-SEND-SUB-ELEM-IND             32630000
326400                           ,:TRDPRT-SEND-ACK-REQD-IND             32640000
326500                           ,:TRDPRT-INTRCONN-NETWK-IND            32650000
326600                           ,:TRDPRT-FA-COM-MTHD-CDE               32660000
326700           FROM   TTRDPRT                                         32670000
326800           WHERE  ENT_ID              = :DK-ENT-ID                32680000
326900             AND  VEND_INCHG_ID       = :DK-VEND-INCHG-ID         32690000
327000             AND  VEND_INCHG_ID_DESC  = :DK-VEND-INCHG-ID-QUAL    32700000
327100             AND  NETWK_ID      BETWEEN :DK-NETWK-ID-LOW          32710000
327200                                    AND :DK-NETWK-ID-HIGH         32720000
327300             AND  TP_DKEY       BETWEEN :DK-TP-DKEY-LOW           32730000
327400                                    AND :DK-TP-DKEY-HIGH          32740000
327500         END-EXEC                                                 32750000
327600                                                                  32760000
327700         EVALUATE TRUE                                            32770000
327800             WHEN SQLCODE = +0                                    32780000
327900             WHEN SQLCODE = +100                                  32790000
328000             WHEN SQLCODE = -811                                  32800000
328100             WHEN SQLCODE = -904                                  32810000
328200             WHEN SQLCODE = -913                                  32820000
328300                 CONTINUE                                         32830000
328400                                                                  32840000
328500             WHEN SQLWARN0 NOT = SPACES                           32850000
328600             WHEN SQLCODE < ZERO                                  32860000
328700             WHEN SQLCODE > ZERO                                  32870000
328800                 MOVE '4300-SELECT-TTRDPRT'                       32880000
328900                                   TO DP013-PARAGRAPH             32890000
329000                 MOVE 'SELECT ON TTRDPRT'                         32900000
329100                                   TO DP013-MESSAGE-TEXT (1)      32910000
329200                 MOVE SQLCA        TO DP013-SQLCA                 32920000
329300                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    32930000
329400                 SET DP013-DB2-ABEND                              32940000
329500                     DP013-XCTL-DISPLAY-RESTART                   32950000
329600                                   TO TRUE                        32960000
329700                 PERFORM DP013-0000-PROCESS-ABEND                 32970000
329800         END-EVALUATE                                             32980000
329900     END-PERFORM.                                                 32990000
330000                                                                  33000000
330100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33010000
330200         MOVE '4300-SELECT-TTRDPRT'                               33020000
330300                                   TO DP013-PARAGRAPH             33030000
330400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     33040000
330500                                   TO DP013-MESSAGE-TEXT (1)      33050000
330600         MOVE 'A TTRDPRT ROW   '   TO DP013-MESSAGE-TEXT (2)      33060000
330700         MOVE SQLCA                TO DP013-SQLCA                 33070000
330800         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    33080000
330900         SET DP013-DB2-ABEND                                      33090000
331000             DP013-XCTL-DISPLAY-RESTART                           33100000
331100                                   TO TRUE                        33110000
331200         PERFORM DP013-0000-PROCESS-ABEND                         33120000
331300     END-IF.                                                      33130000
331400                                                                  33140000
331500     IF SQLCODE = +0                                              33150000
331600         EVALUATE TRUE                                            33160000
331700           WHEN ASC-ADD-PENDING                                   33170000
331800               MOVE PC-TSYMSG-00117    TO DP020-MSG-NUMBER        33180000
331900               SET PS-ERROR                                       33190000
332000                   DP020-MSG-FATAL                                33200000
332100                   DP020-NEXT-ACT-APPL-ERROR                      33210000
332200                                       TO TRUE                    33220000
332300           WHEN ASC-UPDATE-PENDING                                33230000
332400           WHEN ASC-DELETE-PENDING                                33240000
332500               MOVE TRDPRT-VEND-INCHG-ID          TO              33250000
332600                    ASC-VEND-INCHG-ID-NEW                         33260000
332700               MOVE TRDPRT-VEND-INCHG-ID-DESC     TO              33270000
332800                    ASC-VEND-INCHG-ID-QUAL-NEW                    33280000
332900               MOVE TRDPRT-NETWK-ID               TO              33290000
333000                    ASC-NETWK-ID-NEW                              33300000
333100               MOVE TRDPRT-KOHL-INCHG-ID          TO              33310000
333200                    ASC-KOHL-INCHG-ID-NEW                         33320000
333300               MOVE TRDPRT-KOHL-INCHG-ID-DESC     TO              33330000
333400                    ASC-KOHL-INCHG-ID-QUAL-NEW                    33340000
333500               MOVE TRDPRT-SEND-FMT-VER-CDE       TO              33350000
333600                    ASC-SEND-FMT-VER-CDE-NEW                      33360000
333700               MOVE TRDPRT-SEND-FMT-NME           TO              33370000
333800                    ASC-SEND-FMT-NME-NEW                          33380000
333900               MOVE TRDPRT-LAST-SEND-CNTL-NBR     TO              33390000
334000                    ASC-LAST-SEND-CNTL-NBR-NEW                    33400000
334100               MOVE TRDPRT-SEND-CNTL-NBR-CDE      TO              33410000
334200                    ASC-SEND-CNTL-NBR-CDE-NEW                     33420000
334300               MOVE TRDPRT-OVRRD-SND-CNTL-NBR     TO              33430000
334400                    ASC-OVRRD-SND-CNTL-NBR-NEW                    33440000
334500               MOVE TRDPRT-OVRRD-SND-CNTL-ID      TO              33450000
334600                    ASC-OVRRD-SND-CNTL-ID-NEW                     33460000
334700               MOVE TRDPRT-RECV-FMT-VER-CDE       TO              33470000
334800                    ASC-RECV-FMT-VER-CDE-NEW                      33480000
334900               MOVE TRDPRT-RECV-FMT-NME           TO              33490000
335000                    ASC-RECV-FMT-NME-NEW                          33500000
335100               MOVE TRDPRT-LAST-RECV-CNTL-NBR     TO              33510000
335200                    ASC-LAST-RECV-CNTL-NBR-NEW                    33520000
335300               MOVE TRDPRT-RECV-CNTL-NBR-CDE      TO              33530000
335400                    ASC-RECV-CNTL-NBR-CDE-NEW                     33540000
335500               MOVE TRDPRT-OVRRD-RCV-CNTL-NBR     TO              33550000
335600                    ASC-OVRRD-RCV-CNTL-NBR-NEW                    33560000
335700               MOVE TRDPRT-OVRRD-RCV-CNTL-ID      TO              33570000
335800                    ASC-OVRRD-RCV-CNTL-ID-NEW                     33580000
335900               MOVE TRDPRT-SETUP-DTE              TO              33590000
336000                    ASC-SETUP-DTE                                 33600000
336100               MOVE TRDPRT-LAST-CHG-DTE           TO              33610000
336200                    ASC-LAST-CHG-DTE                              33620000
336300               MOVE TRDPRT-LAST-CHG-UID           TO              33630000
336400                    ASC-LAST-CHG-UID                              33640000
336500               IF TRDPRT-ACTV-DTE = PC-NULL-DATE                  33650000
336600                   MOVE SPACE                     TO              33660000
336700                       ASC-ACTV-DTE-NEW                           33670000
336800               ELSE                                               33680000
336900                   MOVE TRDPRT-ACTV-DTE           TO              33690000
337000                        ASC-ACTV-DTE-NEW                          33700000
337100               END-IF                                             33710000
337200               IF TRDPRT-INACTV-DTE = PC-NULL-DATE                33720000
337300                   MOVE SPACE                     TO              33730000
337400                        ASC-INACTV-DTE-NEW                        33740000
337500               ELSE                                               33750000
337600                   MOVE TRDPRT-INACTV-DTE         TO              33760000
337700                        ASC-INACTV-DTE-NEW                        33770000
337800               END-IF                                             33780000
337900               MOVE TRDPRT-SER-LVL-CDE            TO              33790000
338000                    ASC-SER-LVL-CDE-NEW                           33800000
338100               MOVE TRDPRT-NOTES-TXT              TO              33810000
338200                    ASC-NOTES-TXT-NEW                             33820000
338300               IF TRDPRT-LAST-CALL-DTE = PC-NULL-DATE             33830000
338400                   MOVE SPACE                     TO              33840000
338500                       ASC-LAST-CALL-DTE-NEW                      33850000
338600               ELSE                                               33860000
338700                   MOVE TRDPRT-LAST-CALL-DTE      TO              33870000
338800                        ASC-LAST-CALL-DTE-NEW                     33880000
338900               END-IF                                             33890000
339000               IF TRDPRT-NEXT-CALL-DTE = PC-NULL-DATE             33900000
339100                   MOVE SPACE                     TO              33910000
339200                        ASC-NEXT-CALL-DTE-NEW                     33920000
339300               ELSE                                               33930000
339400                   MOVE TRDPRT-NEXT-CALL-DTE      TO              33940000
339500                        ASC-NEXT-CALL-DTE-NEW                     33950000
339600               END-IF                                             33960000
339700               MOVE TRDPRT-SEND-DATA-ELEM-IND     TO              33970000
339800                    ASC-SEND-DATA-ELEM-IND-NEW                    33980000
339900               MOVE TRDPRT-SEND-SEG-TERM-IND      TO              33990000
340000                    ASC-SEND-SEG-TERM-IND-NEW                     34000000
340100               MOVE TRDPRT-SEND-SUB-ELEM-IND      TO              34010000
340200                    ASC-SEND-SUB-ELEM-IND-NEW                     34020000
340300               MOVE TRDPRT-INTRCONN-NETWK-IND     TO              34030000
340400                    ASC-INTRCONN-NETWK-IND-NEW                    34040000
340500               MOVE TRDPRT-FA-COM-MTHD-CDE        TO              34050000
340600                    ASC-FA-COMM-MTHD-NEW                          34060000
340700         END-EVALUATE                                             34070000
340800     END-IF                                                       34080000
340900                                                                  34090000
341000     IF SQLCODE = +100                                            34100000
341100         IF ASC-UPDATE-PENDING OR                                 34110000
341200            ASC-DELETE-PENDING                                    34120000
341300             SET PS-ERROR                                         34130000
341400                 DP020-MSG-FATAL                                  34140000
341500                 DP030-SET-CURSOR-TRAILER TO TRUE                 34150000
341600*-->         ** DETAIL DOESN'T EXIST **                           34160000
341700             IF ASC-UPDATE-PENDING                                34170000
341800                 MOVE PC-TSYMSG-00134    TO DP020-MSG-NUMBER      34180000
341900             ELSE                                                 34190000
342000                 SET ASC-DELETE-SUCCESSFUL TO TRUE                34200000
342100                 MOVE PC-TSYMSG-00116    TO DP020-MSG-NUMBER      34210000
342200             END-IF                                               34220000
342300         END-IF                                                   34230000
342400     ELSE                                                         34240000
342500         IF  ASC-DELETE-PENDING                                   34250000
342600             MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER            34260000
342700             SET DP020-MSG-INFORMATIONAL                          34270000
342800                                   TO TRUE                        34280000
342900             IF  ASC-DELETE-SUCCESSFUL                            34290000
343000                 MOVE SPACES       TO ASC-DELETE-SUCCESSFUL-SW    34300000
343100             END-IF                                               34310000
343200         END-IF                                                   34320000
343300     END-IF.                                                      34330000
343400/                                                                 34340000
343500*---------------------------------------------------------------- 34350000
343600*    GET NETWORK INFO                                             34360000
343700*---------------------------------------------------------------- 34370000
343800                                                                  34380000
343900 4350-SELECT-TNETWRK.                                             34390000
344000                                                                  34400000
344100     PERFORM                                                      34410000
344200         WITH TEST AFTER                                          34420000
344300         VARYING PV-RETRY-COUNTER                                 34430000
344400         FROM 1 BY 1                                              34440000
344500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34450000
344600            OR  (SQLCODE = +100)                                  34460000
344700            OR  (SQLCODE = +0))                                   34470000
344800                                                                  34480000
344900         EXEC SQL                                                 34490000
345000             SELECT    NETWK_ID                                   34500000
345100                      ,NETWK_NME                                  34510000
345200                      ,DFLT_INCHG_ID                              34520000
345300                      ,DFLT_INCHG_ID_DESC                         34530000
345400               INTO    :NETWRK-NETWK-ID                           34540000
345500                      ,:NETWRK-NETWK-NME                          34550000
345600                      ,:NETWRK-DFLT-INCHG-ID                      34560000
345700                      ,:NETWRK-DFLT-INCHG-ID-DESC                 34570000
345800              FROM  TNETWRK                                       34580000
345900             WHERE  NETWK_ID    = :DK-NETWK-ID                    34590000
346000         END-EXEC                                                 34600000
346100                                                                  34610000
346200         EVALUATE TRUE                                            34620000
346300             WHEN SQLCODE = +0                                    34630000
346400             WHEN SQLCODE = -904                                  34640000
346500             WHEN SQLCODE = -913                                  34650000
346600                  CONTINUE                                        34660000
346700                                                                  34670000
346800             WHEN SQLCODE = +100                                  34680000
346900                  SET ASC-NETWK-INFO-NOT-FOUND TO TRUE            34690000
347000                                                                  34700000
347100             WHEN SQLWARN0 NOT = SPACE                            34710000
347200             WHEN SQLCODE < +0                                    34720000
347300             WHEN SQLCODE > +0                                    34730000
347400                  MOVE '4350-SELECT-TNETWRK'                      34740000
347500                                   TO DP013-PARAGRAPH             34750000
347600                  MOVE 'SELECT ON TNETWRK'                        34760000
347700                                   TO DP013-MESSAGE-TEXT (1)      34770000
347800                  MOVE SQLCA       TO DP013-SQLCA                 34780000
347900                  MOVE 'TNETWRK'   TO DP013-DB2-TABLE-NAME (1)    34790000
348000                  SET DP013-DB2-ABEND                             34800000
348100                      DP013-XCTL-DISPLAY-RESTART                  34810000
348200                                   TO TRUE                        34820000
348300                  PERFORM DP013-0000-PROCESS-ABEND                34830000
348400         END-EVALUATE                                             34840000
348500     END-PERFORM.                                                 34850000
348600                                                                  34860000
348700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34870000
348800         MOVE '4350-SELECT-TNETWRK'                               34880000
348900                                   TO DP013-PARAGRAPH             34890000
349000         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   34900000
349100                                   TO DP013-MESSAGE-TEXT (1)      34910000
349200         MOVE 'ON TABLE TNETWRK '  TO DP013-MESSAGE-TEXT (2)      34920000
349300         MOVE SQLCA                TO DP013-SQLCA                 34930000
349400         SET DP013-DB2-ABEND                                      34940000
349500             DP013-XCTL-DISPLAY-RESTART                           34950000
349600                                   TO TRUE                        34960000
349700         PERFORM DP013-0000-PROCESS-ABEND                         34970000
349800     END-IF.                                                      34980000
349900                                                                  34990000
350000                                                                  35000000
350100/                                                                 35010000
350200*---------------------------------------------------------------- 35020000
350300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.      35030000
350400*---------------------------------------------------------------- 35040000
350500                                                                  35050000
350600 4400-MOVE-COMMAREA-TO-SCREEN.                                    35060000
350700                                                                  35070000
350800     MOVE ASC-KEY-VENDOR-NAME           TO VDRNAMEO               35080000
350900     MOVE ASC-SER-LVL-CDE-NEW           TO SVCLVLO                35090000
351000                                                                  35100000
351100     MOVE ASC-VEND-INCHG-ID-QUAL-NEW    TO VTPIDQO                35110000
351200     MOVE ASC-VEND-INCHG-ID-NEW         TO VTPIDO                 35120000
351300     MOVE ASC-NETWK-ID-NEW              TO NTWKCDEO               35130000
351400     MOVE ASC-NETWK-NME                 TO NTWKNMEO               35140000
351500                                                                  35150000
351600     MOVE ASC-KOHL-INCHG-ID-QUAL-NEW    TO KTPIDQO                35160000
351700     MOVE ASC-KOHL-INCHG-ID-NEW         TO KTPIDO                 35170000
351800                                                                  35180000
351900     MOVE ASC-INTRCONN-NETWK-IND-NEW    TO INTRCCDO               35190000
352000     MOVE ASC-INTRCONN-NETWK-NME        TO INTRCNMO               35200000
352100                                                                  35210000
352200     MOVE ASC-FA-COMM-MTHD-NEW          TO FACMTHO                35220000
352300     MOVE ASC-FA-COMM-MTHD-NME          TO FACNMEO                35230000
352400                                                                  35240000
352500     MOVE ASC-LAST-SEND-CNTL-NBR-NEWX   TO LSNBRO                 35250000
352600     MOVE ASC-SEND-CNTL-NBR-CDE-NEW     TO LSMCDO                 35260000
352700                                                                  35270000
352800     EVALUATE ASC-SEND-CNTL-NBR-CDE-NEW                           35280000
352900        WHEN '0'                                                  35290000
353000           MOVE 'NOTRK'                 TO LSMTXTO                35300000
353100        WHEN '1'                                                  35310000
353200           MOVE 'TRACK'                 TO LSMTXTO                35320000
353300        WHEN OTHER                                                35330000
353400           MOVE SPACES                  TO LSMTXTO                35340000
353500     END-EVALUATE                                                 35350000
353600                                                                  35360000
353700     MOVE ASC-SEND-FMT-VER-CDE-NEW      TO LSINTVRO               35370000
353800     MOVE ASC-SEND-FMT-NME-NEW          TO LSINTNMO               35380000
353900     MOVE ASC-OVRRD-SND-CNTL-NBR-NEWX   TO LSOVRO                 35390000
354000     MOVE ASC-OVRRD-SND-CNTL-ID-NEW     TO LSOVRIDO               35400000
354100                                                                  35410000
354200     MOVE ASC-LAST-RECV-CNTL-NBR-NEWX   TO LRNBRO                 35420000
354300     MOVE ASC-RECV-CNTL-NBR-CDE-NEW     TO LRMCDO                 35430000
354400                                                                  35440000
354500     EVALUATE ASC-RECV-CNTL-NBR-CDE-NEW                           35450000
354600        WHEN '0'                                                  35460000
354700           MOVE 'NOTRK'                 TO LRMTXTO                35470000
354800        WHEN '1'                                                  35480000
354900           MOVE 'TRACK'                 TO LRMTXTO                35490000
355000*5/2    WHEN '3'                                                  35500000
355100*5/2       MOVE 'RETAIL'                TO LRMTXTO                35510000
355200        WHEN OTHER                                                35520000
355300           MOVE SPACES                  TO LRMTXTO                35530000
355400     END-EVALUATE                                                 35540000
355500                                                                  35550000
355600     MOVE ASC-RECV-FMT-VER-CDE-NEW      TO LRINTVRO               35560000
355700     MOVE ASC-RECV-FMT-NME-NEW          TO LRINTNMO               35570000
355800                                                                  35580000
355900     MOVE ASC-LAST-RECV-CNTL-NBR-NEWX   TO LRNBRO                 35590000
356000                                                                  35600000
356100     MOVE ASC-OVRRD-RCV-CNTL-NBR-NEWX   TO LROVRO                 35610000
356200     MOVE ASC-OVRRD-RCV-CNTL-ID-NEW     TO LROVRIDO               35620000
356300                                                                  35630000
356400     MOVE ASC-SETUP-DTE-MM              TO SETMTHO                35640000
356500     MOVE ASC-SETUP-DTE-DD              TO SETDAYO                35650000
356600     MOVE ASC-SETUP-DTE-YY              TO SETYRO                 35660000
356700                                                                  35670000
356800     MOVE ASC-LAST-CHG-DTE-MM           TO LCHGMTHO               35680000
356900     MOVE ASC-LAST-CHG-DTE-DD           TO LCHGDAYO               35690000
357000     MOVE ASC-LAST-CHG-DTE-YY           TO LCHGYRO                35700000
357100                                                                  35710000
357200     MOVE ASC-LAST-CHG-UID              TO USERIDO.               35720000
357300                                                                  35730000
357400     MOVE ASC-ACTV-DTE-MM-NEW           TO ACTVMTHO               35740000
357500     MOVE ASC-ACTV-DTE-DD-NEW           TO ACTVDAYO               35750000
357600     MOVE ASC-ACTV-DTE-YY-NEW           TO ACTVYRO                35760000
357700                                                                  35770000
357800     MOVE ASC-INACTV-DTE-MM-NEW         TO INACTVMO               35780000
357900     MOVE ASC-INACTV-DTE-DD-NEW         TO INACTVDO               35790000
358000     MOVE ASC-INACTV-DTE-YY-NEW         TO INACTVYO               35800000
358100                                                                  35810000
358200     MOVE ASC-LAST-CALL-DTE-MM-NEW      TO LCALMTHO               35820000
358300     MOVE ASC-LAST-CALL-DTE-DD-NEW      TO LCALDAYO               35830000
358400     MOVE ASC-LAST-CALL-DTE-YY-NEW      TO LCALYRO                35840000
358500                                                                  35850000
358600     MOVE ASC-NEXT-CALL-DTE-MM-NEW      TO NCALMTHO               35860000
358700     MOVE ASC-NEXT-CALL-DTE-DD-NEW      TO NCALDAYO               35870000
358800     MOVE ASC-NEXT-CALL-DTE-YY-NEW      TO NCALYRO                35880000
358900                                                                  35890000
359000     MOVE ASC-SEND-DATA-ELEM-IND-NEW    TO SNDLMSPO               35900000
359100     MOVE ASC-SEND-DATA-ELEM-PRT        TO SNDLMSXO               35910000
359200     MOVE ASC-SEND-SEG-TERM-IND-NEW     TO SEGTRMO                35920000
359300     MOVE ASC-SEND-SEG-TERM-PRT         TO SEGTRMXO               35930000
359400     MOVE ASC-SEND-SUB-ELEM-IND-NEW     TO SUBLMSPO               35940000
359500     MOVE ASC-SEND-SUB-ELEM-PRT         TO SUBLMSXO               35950000
359600                                                                  35960000
359700     MOVE ASC-SEND-NOTE1-NEW            TO NOTES1O                35970000
359800     MOVE ASC-SEND-NOTE2-NEW            TO NOTES2O                35980000
359900                                                                  35990000
360000     IF PS-NO-ERROR                                               36000000
360100         IF ASC-DELETE-PENDING                                    36010000
360200             CONTINUE                                             36020000
360300         ELSE                                                     36030000
360400             SET DP030-SET-CURSOR-APPL-1                          36040000
360500                                        TO TRUE                   36050000
360600             MOVE -1                    TO SVCLVLL                36060000
360700         END-IF                                                   36070000
360800     END-IF.                                                      36080000
360900/                                                                 36090000
361000*---------------------------------------------------------------- 36100000
361100* ADD A TRADING PARTNER RELATIONSHIP                              36110000
361200*---------------------------------------------------------------- 36120000
361300 5000-ADD-TTRDPRT.                                                36130000
361400                                                                  36140000
361500     MOVE 'N'           TO WS-DUPL-KEY-WARN-MSG-SW.               36150000
361600                                                                  36160000
361700     MOVE ASC-MILLI-SEC TO PV-SEED-BYTE-1-2.                      36170000
361800     MOVE ASC-SEC       TO PV-SEED-BYTE-3-4.                      36180000
361900     MOVE ASC-MIN       TO PV-SEED-BYTE-5-6.                      36190000
362000     MOVE ASC-HH        TO PV-SEED-BYTE-7-8.                      36200000
362100                                                                  36210000
362200     COMPUTE PV-WORK-FIELD    =                                   36220000
362300            ((PV-SEED + PC-PRIME1) * PC-PRIME2).                  36230000
362400                                                                  36240000
362500     DIVIDE PV-WORK-FIELD BY  PC-ONE-BILLION                      36250000
362600            GIVING PV-WORK-FIELD2                                 36260000
362700            REMAINDER PV-RANDOM-NUMBER.                           36270000
362800                                                                  36280000
362900     PERFORM 6100-PREPARE-TTRDPRT.                                36290000
363000     MOVE PV-RANDOM-NUMBER       TO      TRDPRT-TP-DKEY           36300000
363100                                         ASC-KEY-TP-DKEY.         36310000
363200                                                                  36320000
363300     PERFORM                                                      36330000
363400         WITH TEST AFTER                                          36340000
363500         VARYING PV-RETRY-COUNTER                                 36350000
363600         FROM 1 BY 1                                              36360000
363700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36370000
363800             OR (SQLCODE = +0))                                   36380000
363900         EXEC SQL                                                 36390000
364000             INSERT INTO TTRDPRT                                  36400000
364100                           (TP_DKEY                               36410000
364200                           ,ENT_ID                                36420000
364300                           ,VEND_INCHG_ID                         36430000
364400                           ,VEND_INCHG_ID_DESC                    36440000
364500                           ,NETWK_ID                              36450000
364600                           ,KOHL_INCHG_ID                         36460000
364700                           ,KOHL_INCHG_ID_DESC                    36470000
364800                           ,SEND_FMT_VER_CDE                      36480000
364900                           ,SEND_FMT_NME                          36490000
365000                           ,LAST_SEND_CNTL_NBR                    36500000
365100                           ,SEND_CNTL_NBR_CDE                     36510000
365200                           ,OVRRD_SND_CNTL_NBR                    36520000
365300                           ,OVRRD_SND_CNTL_ID                     36530000
365400                           ,RECV_FMT_VER_CDE                      36540000
365500                           ,RECV_FMT_NME                          36550000
365600                           ,LAST_RECV_CNTL_NBR                    36560000
365700                           ,RECV_CNTL_NBR_CDE                     36570000
365800                           ,OVRRD_RCV_CNTL_NBR                    36580000
365900                           ,OVRRD_RCV_CNTL_ID                     36590000
366000                           ,SETUP_DTE                             36600000
366100                           ,LAST_CHG_DTE                          36610000
366200                           ,LAST_CHG_UID                          36620000
366300                           ,ACTV_DTE                              36630000
366400                           ,INACTV_DTE                            36640000
366500                           ,SER_LVL_CDE                           36650000
366600                           ,NOTES_TXT                             36660000
366700                           ,LAST_CALL_DTE                         36670000
366800                           ,NEXT_CALL_DTE                         36680000
366900                           ,SEND_AUTH_INFO_ID                     36690000
367000                           ,SEND_AUTH_INF_DESC                    36700000
367100                           ,SEND_SEC_INFO_ID                      36710000
367200                           ,SEND_SEC_INFO_DESC                    36720000
367300                           ,SEND_DATA_ELEM_IND                    36730000
367400                           ,SEND_SEG_TERM_IND                     36740000
367500                           ,SEND_SUB_ELEM_IND                     36750000
367600                           ,SEND_ACK_REQD_IND                     36760000
367700                           ,INTRCONN_NETWK_IND                    36770000
367800                           ,FA_COM_MTHD_CDE)                      36780000
367900             VALUES        (:TRDPRT-TP-DKEY                       36790000
368000                           ,:TRDPRT-ENT-ID                        36800000
368100                           ,:TRDPRT-VEND-INCHG-ID                 36810000
368200                           ,:TRDPRT-VEND-INCHG-ID-DESC            36820000
368300                           ,:TRDPRT-NETWK-ID                      36830000
368400                           ,:TRDPRT-KOHL-INCHG-ID                 36840000
368500                           ,:TRDPRT-KOHL-INCHG-ID-DESC            36850000
368600                           ,:TRDPRT-SEND-FMT-VER-CDE              36860000
368700                           ,:TRDPRT-SEND-FMT-NME                  36870000
368800                           ,:TRDPRT-LAST-SEND-CNTL-NBR            36880000
368900                           ,:TRDPRT-SEND-CNTL-NBR-CDE             36890000
369000                           ,:TRDPRT-OVRRD-SND-CNTL-NBR            36900000
369100                           ,:TRDPRT-OVRRD-SND-CNTL-ID             36910000
369200                           ,:TRDPRT-RECV-FMT-VER-CDE              36920000
369300                           ,:TRDPRT-RECV-FMT-NME                  36930000
369400                           ,:TRDPRT-LAST-RECV-CNTL-NBR            36940000
369500                           ,:TRDPRT-RECV-CNTL-NBR-CDE             36950000
369600                           ,:TRDPRT-OVRRD-RCV-CNTL-NBR            36960000
369700                           ,:TRDPRT-OVRRD-RCV-CNTL-ID             36970000
369800                           ,:TRDPRT-SETUP-DTE                     36980000
369900                           ,:TRDPRT-LAST-CHG-DTE                  36990000
370000                           ,:TRDPRT-LAST-CHG-UID                  37000000
370100                           ,:TRDPRT-ACTV-DTE                      37010000
370200                           ,:TRDPRT-INACTV-DTE                    37020000
370300                           ,:TRDPRT-SER-LVL-CDE                   37030000
370400                           ,:TRDPRT-NOTES-TXT                     37040000
370500                           ,:TRDPRT-LAST-CALL-DTE                 37050000
370600                           ,:TRDPRT-NEXT-CALL-DTE                 37060000
370700                           ,:TRDPRT-SEND-AUTH-INFO-ID             37070000
370800                           ,:TRDPRT-SEND-AUTH-INF-DESC            37080000
370900                           ,:TRDPRT-SEND-SEC-INFO-ID              37090000
371000                           ,:TRDPRT-SEND-SEC-INFO-DESC            37100000
371100                           ,:TRDPRT-SEND-DATA-ELEM-IND            37110000
371200                           ,:TRDPRT-SEND-SEG-TERM-IND             37120000
371300                           ,:TRDPRT-SEND-SUB-ELEM-IND             37130000
371400                           ,:TRDPRT-SEND-ACK-REQD-IND             37140000
371500                           ,:TRDPRT-INTRCONN-NETWK-IND            37150000
371600                           ,:TRDPRT-FA-COM-MTHD-CDE)              37160000
371700         END-EXEC                                                 37170000
371800                                                                  37180000
371900         EVALUATE TRUE                                            37190000
372000             WHEN SQLCODE = +0                                    37200000
372100                 SET ASC-ADD-SUCCESSFUL TO TRUE                   37210000
372200             WHEN SQLCODE = -904                                  37220000
372300             WHEN SQLCODE = -913                                  37230000
372400                 CONTINUE                                         37240000
372500                                                                  37250000
372600             WHEN SQLCODE = -803                                  37260000
372700                 MOVE 'Y' TO WS-DUPL-KEY-WARN-MSG-SW              37270000
372800                 ADD ASC-MILLI-SEC TO TRDPRT-TP-DKEY              37280000
372900                                                                  37290000
373000             WHEN SQLWARN0 NOT = SPACES                           37300000
373100             WHEN SQLCODE < +0                                    37310000
373200             WHEN SQLCODE > +0                                    37320000
373300                 MOVE '5000-ADD-TTRDPRT'                          37330000
373400                                   TO DP013-PARAGRAPH             37340000
373500                 MOVE 'INSERT A ROW ON TTRDPRT'                   37350000
373600                                   TO DP013-MESSAGE-TEXT(1)       37360000
373700                 MOVE SQLCA        TO DP013-SQLCA                 37370000
373800                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    37380000
373900                 SET DP013-DB2-ABEND                              37390000
374000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37400000
374100                 PERFORM DP013-0000-PROCESS-ABEND                 37410000
374200         END-EVALUATE                                             37420000
374300     END-PERFORM.                                                 37430000
374400                                                                  37440000
374500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37450000
374600         MOVE '5000-ADD-TTRDPRT'   TO DP013-PARAGRAPH             37460000
374700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              37470000
374800                                   TO DP013-MESSAGE-TEXT (1)      37480000
374900         MOVE 'TO INSERT A TTRDPRT ROW'                           37490000
375000                                   TO DP013-MESSAGE-TEXT (2)      37500000
375100         MOVE SQLCA                TO DP013-SQLCA                 37510000
375200         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    37520000
375300         SET DP013-DB2-ABEND                                      37530000
375400             DP013-XCTL-DISPLAY-RESTART                           37540000
375500                                   TO TRUE                        37550000
375600         PERFORM DP013-0000-PROCESS-ABEND                         37560000
375700     END-IF.                                                      37570000
375800                                                                  37580000
375900     MOVE PC-TSYMSG-02491        TO DP020-MSG-NUMBER              37590000
376000     IF DUPLICATE-WARNING-SUCCESS                                 37600000
376100         MOVE PC-TSYMSG-00224    TO DP020-MSG-NUMBER.             37610000
376200                                                                  37620000
376300     SET DP020-MSG-INFORMATIONAL TO TRUE.                         37630000
376400                                                                  37640000
376500/                                                                 37650000
376600*---------------------------------------------------------------- 37660000
376700* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS   37670000
376800* OBJECT WAS UPDATED.                                             37680000
376900*---------------------------------------------------------------- 37690000
377000                                                                  37700000
377100 5200-UPDATE-SELECTION-QUEUE.                                     37710000
377200                                                                  37720000
377300     PERFORM 9100-READ-SEL-QUEUE.                                 37730000
377400                                                                  37740000
377500     IF  ASC-DELETE-SUCCESSFUL                                    37750000
377600         SET ET301-DEL (ASC-SEL-SUB)     TO TRUE                  37760000
377700     ELSE                                                         37770000
377800**       THEY MAY HAVE UPDATED THE NETWORK OR VENDOR INCHG INFO,  37780000
377900**       SO BE SURE TO UPDATE THE CORRESPONDING TS REC TOO.       37790000
378000         MOVE ASC-VEND-INCHG-ID-QUAL-NEW TO                       37800000
378100              ET301-VEND-INCHG-QUAL (ASC-SEL-SUB)                 37810000
378200         MOVE ASC-VEND-INCHG-ID-NEW      TO                       37820000
378300              ET301-VEND-INCHG-ID   (ASC-SEL-SUB)                 37830000
378400         MOVE ASC-NETWK-ID-NEW           TO                       37840000
378500              ET301-NETWK-ID        (ASC-SEL-SUB)                 37850000
378600         MOVE ASC-NETWK-NME              TO                       37860000
378700              ET301-NETWK-NAME      (ASC-SEL-SUB)                 37870000
378800         SET ET301-UPD (ASC-SEL-SUB)     TO TRUE                  37880000
378900     END-IF.                                                      37890000
379000                                                                  37900000
379100     PERFORM 9200-REWRITE-LIST-QUEUE.                             37910000
379200                                                                  37920000
379300/                                                                 37930000
379400*---------------------------------------------------------------- 37940000
379500* UPDATE A TRADING PARTNERSHIP ROW                                37950000
379600*---------------------------------------------------------------- 37960000
379700 6000-UPDATE-TTRDPRT.                                             37970000
379800                                                                  37980000
379900     PERFORM 6100-PREPARE-TTRDPRT.                                37990000
380000                                                                  38000000
380100     PERFORM                                                      38010000
380200         WITH TEST AFTER                                          38020000
380300         VARYING PV-RETRY-COUNTER                                 38030000
380400         FROM 1 BY 1                                              38040000
380500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38050000
380600             OR (SQLCODE = +0))                                   38060000
380700                                                                  38070000
380800         EXEC SQL UPDATE TTRDPRT                                  38080000
380900            SET VEND_INCHG_ID       = :TRDPRT-VEND-INCHG-ID       38090000
381000               ,VEND_INCHG_ID_DESC  = :TRDPRT-VEND-INCHG-ID-DESC  38100000
381100               ,NETWK_ID            = :TRDPRT-NETWK-ID            38110000
381200               ,KOHL_INCHG_ID       = :TRDPRT-KOHL-INCHG-ID       38120000
381300               ,KOHL_INCHG_ID_DESC  = :TRDPRT-KOHL-INCHG-ID-DESC  38130000
381400               ,SEND_FMT_VER_CDE    = :TRDPRT-SEND-FMT-VER-CDE    38140000
381500               ,SEND_FMT_NME        = :TRDPRT-SEND-FMT-NME        38150000
381600               ,LAST_SEND_CNTL_NBR  = :TRDPRT-LAST-SEND-CNTL-NBR  38160000
381700               ,SEND_CNTL_NBR_CDE   = :TRDPRT-SEND-CNTL-NBR-CDE   38170000
381800               ,OVRRD_SND_CNTL_NBR  = :TRDPRT-OVRRD-SND-CNTL-NBR  38180000
381900               ,OVRRD_SND_CNTL_ID   = :TRDPRT-OVRRD-SND-CNTL-ID   38190000
382000               ,RECV_FMT_VER_CDE    = :TRDPRT-RECV-FMT-VER-CDE    38200000
382100               ,RECV_FMT_NME        = :TRDPRT-RECV-FMT-NME        38210000
382200               ,LAST_RECV_CNTL_NBR  = :TRDPRT-LAST-RECV-CNTL-NBR  38220000
382300               ,RECV_CNTL_NBR_CDE   = :TRDPRT-RECV-CNTL-NBR-CDE   38230000
382400               ,OVRRD_RCV_CNTL_NBR  = :TRDPRT-OVRRD-RCV-CNTL-NBR  38240000
382500               ,OVRRD_RCV_CNTL_ID   = :TRDPRT-OVRRD-RCV-CNTL-ID   38250000
382600               ,LAST_CHG_DTE        = :TRDPRT-LAST-CHG-DTE        38260000
382700               ,LAST_CHG_UID        = :TRDPRT-LAST-CHG-UID        38270000
382800               ,ACTV_DTE            = :TRDPRT-ACTV-DTE            38280000
382900               ,INACTV_DTE          = :TRDPRT-INACTV-DTE          38290000
383000               ,SER_LVL_CDE         = :TRDPRT-SER-LVL-CDE         38300000
383100               ,NOTES_TXT           = :TRDPRT-NOTES-TXT           38310000
383200               ,LAST_CALL_DTE       = :TRDPRT-LAST-CALL-DTE       38320000
383300               ,NEXT_CALL_DTE       = :TRDPRT-NEXT-CALL-DTE       38330000
383400               ,SEND_DATA_ELEM_IND  = :TRDPRT-SEND-DATA-ELEM-IND  38340000
383500               ,SEND_SEG_TERM_IND   = :TRDPRT-SEND-SEG-TERM-IND   38350000
383600               ,SEND_SUB_ELEM_IND   = :TRDPRT-SEND-SUB-ELEM-IND   38360000
383700               ,INTRCONN_NETWK_IND  = :TRDPRT-INTRCONN-NETWK-IND  38370000
383800               ,FA_COM_MTHD_CDE     = :TRDPRT-FA-COM-MTHD-CDE     38380000
383900                                                                  38390000
384000          WHERE TP_DKEY = :ASC-KEY-TP-DKEY                        38400000
384100                                                                  38410000
384200         END-EXEC                                                 38420000
384300                                                                  38430000
384400         EVALUATE TRUE                                            38440000
384500             WHEN SQLCODE = +0                                    38450000
384600             WHEN SQLCODE = -904                                  38460000
384700             WHEN SQLCODE = -913                                  38470000
384800                 CONTINUE                                         38480000
384900                                                                  38490000
385000             WHEN SQLWARN0 NOT = SPACES                           38500000
385100             WHEN SQLCODE < +0                                    38510000
385200             WHEN SQLCODE > +0                                    38520000
385300                 MOVE '6000-UPDATE-TTRDPRT'                       38530000
385400                                   TO DP013-PARAGRAPH             38540000
385500                 MOVE 'UPDATE A ROW ON TTRDPRT'                   38550000
385600                                   TO DP013-MESSAGE-TEXT(1)       38560000
385700                 MOVE SQLCA        TO DP013-SQLCA                 38570000
385800                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    38580000
385900                 SET DP013-DB2-ABEND                              38590000
386000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38600000
386100                 PERFORM DP013-0000-PROCESS-ABEND                 38610000
386200         END-EVALUATE                                             38620000
386300     END-PERFORM.                                                 38630000
386400                                                                  38640000
386500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38650000
386600         MOVE '6000-UPDATE-TTRDPRT' TO DP013-PARAGRAPH            38660000
386700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38670000
386800                                   TO DP013-MESSAGE-TEXT (1)      38680000
386900         MOVE 'TO UPDATE A TTRDPRT ROW'                           38690000
387000                                   TO DP013-MESSAGE-TEXT (2)      38700000
387100         MOVE SQLCA                TO DP013-SQLCA                 38710000
387200         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    38720000
387300         SET DP013-DB2-ABEND                                      38730000
387400             DP013-XCTL-DISPLAY-RESTART                           38740000
387500                                   TO TRUE                        38750000
387600         PERFORM DP013-0000-PROCESS-ABEND                         38760000
387700     END-IF.                                                      38770000
387800                                                                  38780000
387900**   IF EITHER THE ACTIVATE OR INACTIVATE DATES CHANGED, UPDATE   38790000
388000**   TRANSACTION SET ROW(S) ACCORDINGLY.                          38800000
388100                                                                  38810000
388200     IF ASC-ACTV-DTE-NEW   NOT = ASC-ACTV-DTE                     38820000
388300         PERFORM 6200-UPDATE-TTRDTRN-ACTV-DTE                     38830000
388400     END-IF                                                       38840000
388500                                                                  38850000
388600     IF ASC-INACTV-DTE-NEW NOT = ASC-INACTV-DTE                   38860000
388700         PERFORM 6250-UPDATE-TTRDTRN-INACTV-DTE                   38870000
388800     END-IF                                                       38880000
388900                                                                  38890000
389000     MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER              38900000
389100     SET DP020-MSG-INFORMATIONAL TO TRUE                          38910000
389200                                                                  38920000
389300     IF  ASC-USE-SELECTION-QUEUE                                  38930000
389400         PERFORM 5200-UPDATE-SELECTION-QUEUE                      38940000
389500     END-IF.                                                      38950000
389600                                                                  38960000
389700     PERFORM 3500-SAVE-SCREEN-FIELDS.                             38970000
389800                                                                  38980000
389900     MOVE DP020-USERID          TO ASC-LAST-CHG-UID               38990000
390000                                   USERIDO.                       39000000
390100                                                                  39010000
390200     MOVE ASC-CURRENT-DATE      TO ASC-LAST-CHG-DTE               39020000
390300     MOVE ASC-LAST-CHG-DTE-MM   TO LCHGMTHO                       39030000
390400     MOVE ASC-LAST-CHG-DTE-DD   TO LCHGDAYO                       39040000
390500     MOVE ASC-LAST-CHG-DTE-YY   TO LCHGYRO.                       39050000
390600                                                                  39060000
390700 6100-PREPARE-TTRDPRT.                                            39070000
390800                                                                  39080000
390900     INITIALIZE DCLTTRDPRT.                                       39090000
391000                                                                  39100000
391100     MOVE ASC-KEY-ENT-ID             TO TRDPRT-ENT-ID             39110000
391200     MOVE ASC-VEND-INCHG-ID-NEW      TO TRDPRT-VEND-INCHG-ID      39120000
391300     MOVE ASC-VEND-INCHG-ID-QUAL-NEW TO TRDPRT-VEND-INCHG-ID-DESC 39130000
391400                                                                  39140000
391500     MOVE ASC-NETWK-ID-NEW           TO TRDPRT-NETWK-ID           39150000
391600                                                                  39160000
391700     MOVE ASC-KOHL-INCHG-ID-NEW      TO TRDPRT-KOHL-INCHG-ID      39170000
391800     MOVE ASC-KOHL-INCHG-ID-QUAL-NEW TO TRDPRT-KOHL-INCHG-ID-DESC 39180000
391900     MOVE ASC-SEND-FMT-VER-CDE-NEW   TO TRDPRT-SEND-FMT-VER-CDE   39190000
392000     MOVE ASC-SEND-FMT-NME-NEW       TO TRDPRT-SEND-FMT-NME       39200000
392100     MOVE ASC-LAST-SEND-CNTL-NBR-NEW TO TRDPRT-LAST-SEND-CNTL-NBR 39210000
392200     MOVE ASC-SEND-CNTL-NBR-CDE-NEW  TO TRDPRT-SEND-CNTL-NBR-CDE  39220000
392300     MOVE ASC-OVRRD-SND-CNTL-NBR-NEW TO TRDPRT-OVRRD-SND-CNTL-NBR 39230000
392400     MOVE ASC-OVRRD-SND-CNTL-ID-NEW  TO TRDPRT-OVRRD-SND-CNTL-ID  39240000
392500     MOVE ASC-RECV-FMT-VER-CDE-NEW   TO TRDPRT-RECV-FMT-VER-CDE   39250000
392600     MOVE ASC-RECV-FMT-NME-NEW       TO TRDPRT-RECV-FMT-NME       39260000
392700     MOVE ASC-LAST-RECV-CNTL-NBR-NEW TO TRDPRT-LAST-RECV-CNTL-NBR 39270000
392800     MOVE ASC-RECV-CNTL-NBR-CDE-NEW  TO TRDPRT-RECV-CNTL-NBR-CDE  39280000
392900     MOVE ASC-OVRRD-RCV-CNTL-NBR-NEW TO TRDPRT-OVRRD-RCV-CNTL-NBR 39290000
393000     MOVE ASC-OVRRD-RCV-CNTL-ID-NEW  TO TRDPRT-OVRRD-RCV-CNTL-ID  39300000
393100     MOVE ASC-CURRENT-DATE           TO TRDPRT-SETUP-DTE          39310000
393200                                        TRDPRT-LAST-CHG-DTE       39320000
393300     MOVE DP020-USERID               TO TRDPRT-LAST-CHG-UID       39330000
393400                                                                  39340000
393500     IF ASC-ACTV-DTE-NEW = SPACES                                 39350000
393600         MOVE PC-NULL-DATE           TO TRDPRT-ACTV-DTE           39360000
393700     ELSE                                                         39370000
393800         MOVE ASC-ACTV-DTE-NEW       TO TRDPRT-ACTV-DTE           39380000
393900     END-IF                                                       39390000
394000                                                                  39400000
394100     IF ASC-INACTV-DTE-NEW = SPACES                               39410000
394200         MOVE PC-NULL-DATE           TO TRDPRT-INACTV-DTE         39420000
394300     ELSE                                                         39430000
394400         MOVE ASC-INACTV-DTE-NEW     TO TRDPRT-INACTV-DTE         39440000
394500     END-IF                                                       39450000
394600                                                                  39460000
394700     MOVE ASC-SER-LVL-CDE-NEW        TO TRDPRT-SER-LVL-CDE        39470000
394800     MOVE ASC-NOTES-TXT-NEW          TO TRDPRT-NOTES-TXT          39480000
394900                                                                  39490000
395000     IF ASC-LAST-CALL-DTE-NEW = SPACES                            39500000
395100         MOVE PC-NULL-DATE           TO TRDPRT-LAST-CALL-DTE      39510000
395200     ELSE                                                         39520000
395300         MOVE ASC-LAST-CALL-DTE-NEW  TO TRDPRT-LAST-CALL-DTE      39530000
395400     END-IF                                                       39540000
395500                                                                  39550000
395600     IF ASC-NEXT-CALL-DTE-NEW = SPACES                            39560000
395700         MOVE PC-NULL-DATE           TO TRDPRT-NEXT-CALL-DTE      39570000
395800     ELSE                                                         39580000
395900         MOVE ASC-NEXT-CALL-DTE-NEW  TO TRDPRT-NEXT-CALL-DTE      39590000
396000     END-IF                                                       39600000
396100                                                                  39610000
396200     MOVE ASC-SEND-DATA-ELEM-IND-NEW TO TRDPRT-SEND-DATA-ELEM-IND 39620000
396300     MOVE ASC-SEND-SEG-TERM-IND-NEW  TO TRDPRT-SEND-SEG-TERM-IND  39630000
396400     MOVE ASC-SEND-SUB-ELEM-IND-NEW  TO TRDPRT-SEND-SUB-ELEM-IND  39640000
396500                                                                  39650000
396600     MOVE ASC-INTRCONN-NETWK-IND-NEW TO TRDPRT-INTRCONN-NETWK-IND.39660000
396700                                                                  39670000
396800     MOVE ASC-FA-COMM-MTHD-NEW TO TRDPRT-FA-COM-MTHD-CDE.         39680000
396900                                                                  39690000
397000     MOVE ZEROS                      TO TRDPRT-SEND-AUTH-INF-DESC 39700000
397100                                        TRDPRT-SEND-SEC-INFO-DESC 39710000
397200                                        TRDPRT-SEND-ACK-REQD-IND. 39720000
397300/                                                                 39730000
397400 6200-UPDATE-TTRDTRN-ACTV-DTE.                                    39740000
397500                                                                  39750000
397600     PERFORM                                                      39760000
397700         WITH TEST AFTER                                          39770000
397800         VARYING PV-RETRY-COUNTER                                 39780000
397900         FROM 1 BY 1                                              39790000
398000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39800000
398100             OR (SQLCODE = +0)                                    39810000
398200             OR (SQLCODE = +100) )                                39820000
398300                                                                  39830000
398400         EXEC SQL UPDATE TTRDTRN                                  39840000
398500            SET LAST_CHG_DTE        = :TRDPRT-LAST-CHG-DTE        39850000
398600               ,LAST_CHG_UID        = :TRDPRT-LAST-CHG-UID        39860000
398700               ,ACTV_DTE            = :TRDPRT-ACTV-DTE            39870000
398800                                                                  39880000
398900          WHERE TP_DKEY  = :ASC-KEY-TP-DKEY                       39890000
399000            AND ACTV_DTE < :TRDPRT-ACTV-DTE                       39900000
399100                                                                  39910000
399200         END-EXEC                                                 39920000
399300                                                                  39930000
399400         EVALUATE TRUE                                            39940000
399500             WHEN SQLCODE = +0                                    39950000
399600             WHEN SQLCODE = +100                                  39960000
399700             WHEN SQLCODE = -904                                  39970000
399800             WHEN SQLCODE = -913                                  39980000
399900                 CONTINUE                                         39990000
400000                                                                  40000000
400100             WHEN SQLWARN0 NOT = SPACES                           40010000
400200             WHEN SQLCODE < +0                                    40020000
400300             WHEN SQLCODE > +0                                    40030000
400400                 MOVE '6200-UPDATE-TTRDTRN-ACTV-DTE'              40040000
400500                                   TO DP013-PARAGRAPH             40050000
400600                 MOVE 'UPDATE A ROW ON TTRDTRN'                   40060000
400700                                   TO DP013-MESSAGE-TEXT(1)       40070000
400800                 MOVE SQLCA        TO DP013-SQLCA                 40080000
400900                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    40090000
401000                 SET DP013-DB2-ABEND                              40100000
401100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40110000
401200                 PERFORM DP013-0000-PROCESS-ABEND                 40120000
401300         END-EVALUATE                                             40130000
401400     END-PERFORM.                                                 40140000
401500                                                                  40150000
401600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40160000
401700         MOVE '6200-UPDATE-TTRDTRN-ACTV-DTE'                      40170000
401800                                   TO DP013-PARAGRAPH             40180000
401900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              40190000
402000                                   TO DP013-MESSAGE-TEXT (1)      40200000
402100         MOVE 'TO UPDATE A TTRDTRN TABLE'                         40210000
402200                                   TO DP013-MESSAGE-TEXT (2)      40220000
402300         MOVE SQLCA                TO DP013-SQLCA                 40230000
402400         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    40240000
402500         SET DP013-DB2-ABEND                                      40250000
402600             DP013-XCTL-DISPLAY-RESTART                           40260000
402700                                   TO TRUE                        40270000
402800         PERFORM DP013-0000-PROCESS-ABEND                         40280000
402900     END-IF.                                                      40290000
403000                                                                  40300000
403100 6250-UPDATE-TTRDTRN-INACTV-DTE.                                  40310000
403200                                                                  40320000
403300     PERFORM                                                      40330000
403400         WITH TEST AFTER                                          40340000
403500         VARYING PV-RETRY-COUNTER                                 40350000
403600         FROM 1 BY 1                                              40360000
403700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40370000
403800             OR (SQLCODE = +0)                                    40380000
403900             OR (SQLCODE = +100) )                                40390000
404000                                                                  40400000
404100         IF TRDPRT-INACTV-DTE = PC-NULL-DATE                      40410000
404200             EXEC SQL UPDATE TTRDTRN                              40420000
404300                SET LAST_CHG_DTE        = :TRDPRT-LAST-CHG-DTE    40430000
404400                   ,LAST_CHG_UID        = :TRDPRT-LAST-CHG-UID    40440000
404500                   ,INACTV_DTE          = :TRDPRT-INACTV-DTE      40450000
404600                                                                  40460000
404700              WHERE TP_DKEY     = :ASC-KEY-TP-DKEY                40470000
404800                                                                  40480000
404900             END-EXEC                                             40490000
405000         ELSE                                                     40500000
405100             EXEC SQL UPDATE TTRDTRN                              40510000
405200                SET LAST_CHG_DTE        = :TRDPRT-LAST-CHG-DTE    40520000
405300                   ,LAST_CHG_UID        = :TRDPRT-LAST-CHG-UID    40530000
405400                   ,INACTV_DTE          = :TRDPRT-INACTV-DTE      40540000
405500                                                                  40550000
405600              WHERE TP_DKEY     = :ASC-KEY-TP-DKEY                40560000
405700                AND INACTV_DTE  > :TRDPRT-INACTV-DTE              40570000
405800                                                                  40580000
405900             END-EXEC                                             40590000
406000         END-IF                                                   40600000
406100                                                                  40610000
406200         EVALUATE TRUE                                            40620000
406300             WHEN SQLCODE = +0                                    40630000
406400             WHEN SQLCODE = +100                                  40640000
406500             WHEN SQLCODE = -904                                  40650000
406600             WHEN SQLCODE = -913                                  40660000
406700                 CONTINUE                                         40670000
406800                                                                  40680000
406900             WHEN SQLWARN0 NOT = SPACES                           40690000
407000             WHEN SQLCODE < +0                                    40700000
407100             WHEN SQLCODE > +0                                    40710000
407200                 MOVE '6250-UPDATE-TTRDTRN-INACTV-DTE'            40720000
407300                                   TO DP013-PARAGRAPH             40730000
407400                 MOVE 'UPDATE A ROW ON TTRDTRN'                   40740000
407500                                   TO DP013-MESSAGE-TEXT(1)       40750000
407600                 MOVE SQLCA        TO DP013-SQLCA                 40760000
407700                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    40770000
407800                 SET DP013-DB2-ABEND                              40780000
407900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40790000
408000                 PERFORM DP013-0000-PROCESS-ABEND                 40800000
408100         END-EVALUATE                                             40810000
408200     END-PERFORM.                                                 40820000
408300                                                                  40830000
408400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40840000
408500         MOVE '6250-UPDATE-TTRDTRN-INACTV-DTE'                    40850000
408600                                   TO DP013-PARAGRAPH             40860000
408700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              40870000
408800                                   TO DP013-MESSAGE-TEXT (1)      40880000
408900         MOVE 'TO UPDATE A TTRDTRN TABLE'                         40890000
409000                                   TO DP013-MESSAGE-TEXT (2)      40900000
409100         MOVE SQLCA                TO DP013-SQLCA                 40910000
409200         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    40920000
409300         SET DP013-DB2-ABEND                                      40930000
409400             DP013-XCTL-DISPLAY-RESTART                           40940000
409500                                   TO TRUE                        40950000
409600         PERFORM DP013-0000-PROCESS-ABEND                         40960000
409700     END-IF.                                                      40970000
409800                                                                  40980000
409900*---------------------------------------------------------------- 40990000
410000* DELETE A TRADING PARTNERSHIP ROW.  MUST FIRST DELETE ANY        41000000
410100* RELATED (VIA RI) ROWS IN REVERSE ORDER.                         41010000
410200*---------------------------------------------------------------- 41020000
410300 7000-DELETE-TTRDPRT.                                             41030000
410400                                                                  41040000
410500     PERFORM 7100-DELETE-TTRDTRN                                  41050000
410600     PERFORM 7200-DELETE-TTRDFNC                                  41060000
410700                                                                  41070000
410800     PERFORM                                                      41080000
410900         WITH TEST AFTER                                          41090000
411000         VARYING PV-RETRY-COUNTER                                 41100000
411100         FROM 1 BY 1                                              41110000
411200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41120000
411300             OR (SQLCODE = +0))                                   41130000
411400                                                                  41140000
411500         EXEC SQL DELETE FROM TTRDPRT                             41150000
411600                                                                  41160000
411700          WHERE TP_DKEY = :ASC-KEY-TP-DKEY                        41170000
411800                                                                  41180000
411900         END-EXEC                                                 41190000
412000                                                                  41200000
412100         EVALUATE TRUE                                            41210000
412200             WHEN SQLCODE = +0                                    41220000
412300             WHEN SQLCODE = -904                                  41230000
412400             WHEN SQLCODE = -913                                  41240000
412500                 CONTINUE                                         41250000
412600                                                                  41260000
412700             WHEN SQLWARN0 NOT = SPACES                           41270000
412800             WHEN SQLCODE < +0                                    41280000
412900             WHEN SQLCODE > +0                                    41290000
413000                 MOVE '7000-DELETE-TTRDPRT'                       41300000
413100                                   TO DP013-PARAGRAPH             41310000
413200                 MOVE 'UPDATE A ROW ON TTRDPRT'                   41320000
413300                                   TO DP013-MESSAGE-TEXT(1)       41330000
413400                 MOVE SQLCA        TO DP013-SQLCA                 41340000
413500                 MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    41350000
413600                 SET DP013-DB2-ABEND                              41360000
413700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41370000
413800                 PERFORM DP013-0000-PROCESS-ABEND                 41380000
413900         END-EVALUATE                                             41390000
414000     END-PERFORM.                                                 41400000
414100                                                                  41410000
414200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41420000
414300         MOVE '7000-DELETE-TTRDPRT' TO DP013-PARAGRAPH            41430000
414400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              41440000
414500                                   TO DP013-MESSAGE-TEXT (1)      41450000
414600         MOVE 'TO DELETE A TTRDPRT ROW'                           41460000
414700                                   TO DP013-MESSAGE-TEXT (2)      41470000
414800         MOVE SQLCA                TO DP013-SQLCA                 41480000
414900         MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    41490000
415000         SET DP013-DB2-ABEND                                      41500000
415100             DP013-XCTL-DISPLAY-RESTART                           41510000
415200                                   TO TRUE                        41520000
415300         PERFORM DP013-0000-PROCESS-ABEND                         41530000
415400     END-IF.                                                      41540000
415500                                                                  41550000
415600     MOVE PC-TSYMSG-00115        TO DP020-MSG-NUMBER.             41560000
415700     SET DP020-MSG-INFORMATIONAL                                  41570000
415800         ASC-DELETE-SUCCESSFUL   TO TRUE.                         41580000
415900                                                                  41590000
416000     IF  ASC-USE-SELECTION-QUEUE                                  41600000
416100         PERFORM 5200-UPDATE-SELECTION-QUEUE                      41610000
416200     END-IF.                                                      41620000
416300/                                                                 41630000
416400 7100-DELETE-TTRDTRN.                                             41640000
416500                                                                  41650000
416600     PERFORM                                                      41660000
416700         WITH TEST AFTER                                          41670000
416800         VARYING PV-RETRY-COUNTER                                 41680000
416900         FROM 1 BY 1                                              41690000
417000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41700000
417100             OR (SQLCODE = +0)                                    41710000
417200             OR (SQLCODE = +100) )                                41720000
417300                                                                  41730000
417400         EXEC SQL DELETE FROM TTRDTRN                             41740000
417500                                                                  41750000
417600          WHERE TP_DKEY = :ASC-KEY-TP-DKEY                        41760000
417700                                                                  41770000
417800         END-EXEC                                                 41780000
417900                                                                  41790000
418000         EVALUATE TRUE                                            41800000
418100             WHEN SQLCODE = +0                                    41810000
418200             WHEN SQLCODE = +100                                  41820000
418300             WHEN SQLCODE = -904                                  41830000
418400             WHEN SQLCODE = -913                                  41840000
418500                 CONTINUE                                         41850000
418600                                                                  41860000
418700             WHEN SQLWARN0 NOT = SPACES                           41870000
418800             WHEN SQLCODE < +0                                    41880000
418900             WHEN SQLCODE > +0                                    41890000
419000                 MOVE '7100-DELETE-TTRDTRN'                       41900000
419100                                   TO DP013-PARAGRAPH             41910000
419200                 MOVE 'DELETE ROW(S) FROM TTRDTRN'                41920000
419300                                   TO DP013-MESSAGE-TEXT(1)       41930000
419400                 MOVE SQLCA        TO DP013-SQLCA                 41940000
419500                 MOVE 'TTRDTRN'    TO DP013-DB2-TABLE-NAME (1)    41950000
419600                 SET DP013-DB2-ABEND                              41960000
419700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41970000
419800                 PERFORM DP013-0000-PROCESS-ABEND                 41980000
419900         END-EVALUATE                                             41990000
420000     END-PERFORM.                                                 42000000
420100                                                                  42010000
420200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42020000
420300         MOVE '7100-DELETE-TTRDTRN' TO DP013-PARAGRAPH            42030000
420400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42040000
420500                                   TO DP013-MESSAGE-TEXT (1)      42050000
420600         MOVE 'TO UPDATE A TTRDTRN TABLE'                         42060000
420700                                   TO DP013-MESSAGE-TEXT (2)      42070000
420800         MOVE SQLCA                TO DP013-SQLCA                 42080000
420900         MOVE 'TTRDTRN'            TO DP013-DB2-TABLE-NAME (1)    42090000
421000         SET DP013-DB2-ABEND                                      42100000
421100             DP013-XCTL-DISPLAY-RESTART                           42110000
421200                                   TO TRUE                        42120000
421300         PERFORM DP013-0000-PROCESS-ABEND                         42130000
421400     END-IF.                                                      42140000
421500/                                                                 42150000
421600 7200-DELETE-TTRDFNC.                                             42160000
421700                                                                  42170000
421800     PERFORM                                                      42180000
421900         WITH TEST AFTER                                          42190000
422000         VARYING PV-RETRY-COUNTER                                 42200000
422100         FROM 1 BY 1                                              42210000
422200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42220000
422300             OR (SQLCODE = +0)                                    42230000
422400             OR (SQLCODE = +100) )                                42240000
422500                                                                  42250000
422600         EXEC SQL DELETE FROM TTRDFNC                             42260000
422700                                                                  42270000
422800          WHERE TP_DKEY = :ASC-KEY-TP-DKEY                        42280000
422900                                                                  42290000
423000         END-EXEC                                                 42300000
423100                                                                  42310000
423200         EVALUATE TRUE                                            42320000
423300             WHEN SQLCODE = +0                                    42330000
423400             WHEN SQLCODE = +100                                  42340000
423500             WHEN SQLCODE = -904                                  42350000
423600             WHEN SQLCODE = -913                                  42360000
423700                 CONTINUE                                         42370000
423800                                                                  42380000
423900             WHEN SQLWARN0 NOT = SPACES                           42390000
424000             WHEN SQLCODE < +0                                    42400000
424100             WHEN SQLCODE > +0                                    42410000
424200                 MOVE '7200-DELETE-TTRDFNC'                       42420000
424300                                   TO DP013-PARAGRAPH             42430000
424400                 MOVE 'DELETE ROW(S) FROM TTRDFNC'                42440000
424500                                   TO DP013-MESSAGE-TEXT(1)       42450000
424600                 MOVE SQLCA        TO DP013-SQLCA                 42460000
424700                 MOVE 'TTRDFNC'    TO DP013-DB2-TABLE-NAME (1)    42470000
424800                 SET DP013-DB2-ABEND                              42480000
424900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42490000
425000                 PERFORM DP013-0000-PROCESS-ABEND                 42500000
425100         END-EVALUATE                                             42510000
425200     END-PERFORM.                                                 42520000
425300                                                                  42530000
425400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42540000
425500         MOVE '7200-DELETE-TTRDFNC' TO DP013-PARAGRAPH            42550000
425600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42560000
425700                                   TO DP013-MESSAGE-TEXT (1)      42570000
425800         MOVE 'TO DELETE FROM THE TTRDFNC TABLE'                  42580000
425900                                   TO DP013-MESSAGE-TEXT (2)      42590000
426000         MOVE SQLCA                TO DP013-SQLCA                 42600000
426100         MOVE 'TTRDFNC'            TO DP013-DB2-TABLE-NAME (1)    42610000
426200         SET DP013-DB2-ABEND                                      42620000
426300             DP013-XCTL-DISPLAY-RESTART                           42630000
426400                                   TO TRUE                        42640000
426500         PERFORM DP013-0000-PROCESS-ABEND                         42650000
426600     END-IF.                                                      42660000
426700/                                                                 42670000
426800*---------------------------------------------------------------  42680000
426900* GET THE VENDOR NUMBER FOR SENDING MQ MESSAGE TO SUPPLIER SYSTEM 42690000
427000*---------------------------------------------------------------- 42700000
427100 7300-GET-VENDOR-NUMBER.                                          42710000
427200     PERFORM                                                      42720000
427300         WITH TEST AFTER                                          42730000
427400         VARYING PV-RETRY-COUNTER                                 42740000
427500         FROM 1 BY 1                                              42750000
427600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42760000
427700            OR (SQLCODE = +0 OR +100))                            42770000
427800                                                                  42780000
427900         EXEC SQL                                                 42790000
428000             SELECT B.DUN_NBR,                                    42800000
428100                    B.PRTNR_IND                                   42810000
428200              INTO  :EXTENT-DUN-NBR,                              42820000
428300                    :EXTENT-PRTNR-IND                             42830000
428400              FROM  TENTNME A                                     42840000
428500                 ,  TEXTENT B                                     42850000
428600              WHERE A.ENT_ID   = :ASC-KEY-ENT-ID                  42860000
428700                AND A.ENT_ID   = B.ENT_ID                         42870000
428800                AND A.TYPE_CDE = '01'                             42880000
428900                AND VND_IN_RMS_IND = 'Y'                          42890000
429000         END-EXEC                                                 42900000
429100                                                                  42910000
429200         EVALUATE TRUE                                            42920000
429300             WHEN SQLCODE = +0                                    42930000
429400             WHEN SQLCODE = +100                                  42940000
429500             WHEN SQLCODE = -904                                  42950000
429600             WHEN SQLCODE = -913                                  42960000
429700                 CONTINUE                                         42970000
429800             WHEN SQLWARN0 NOT = SPACE                            42980000
429900             WHEN SQLCODE < +0                                    42990000
430000             WHEN SQLCODE > +0                                    43000000
430100                 MOVE '7300-GET-VENDOR-NUMBER'                    43010000
430200                                 TO DP013-PARAGRAPH               43020000
430300                 MOVE 'SELECT ON TEXTENT TABLE'                   43030000
430400                                 TO DP013-MESSAGE-TEXT (1)        43040000
430500                 MOVE SQLCA      TO DP013-SQLCA                   43050000
430600                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      43060000
430700                     SET DP013-DB2-ABEND                          43070000
430800                         DP013-XCTL-DISPLAY-RESTART               43080000
430900                                 TO TRUE                          43090000
431000                 PERFORM DP013-0000-PROCESS-ABEND                 43100000
431100         END-EVALUATE                                             43110000
431200     END-PERFORM.                                                 43120000
431300                                                                  43130000
431400     IF SQLCODE = -904 OR -913                                    43140000
431500        MOVE '7300-GET-VENDOR-NUMBER'                             43150000
431600                        TO DP013-PARAGRAPH                        43160000
431700        MOVE 'SELECT ON TEXTENT TABLE'                            43170000
431800                        TO DP013-MESSAGE-TEXT (1)                 43180000
431900        MOVE SQLCA      TO DP013-SQLCA                            43190000
432000        MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)               43200000
432100            SET DP013-DB2-ABEND                                   43210000
432200                DP013-XCTL-DISPLAY-RESTART                        43220000
432300                        TO TRUE                                   43230000
432400        PERFORM DP013-0000-PROCESS-ABEND                          43240000
432500     END-IF.                                                      43250000
432600                                                                  43260000
432700*-----------------------------------------------------------------43270000
432800* CHECK TO SEE IF THE VENDOR RECENTLY UPDATED OR DELETED IS SET   43280000
432900* UP FOR EDI PURCHASE ORDERS OR ASNS.                             43290000
433000*-----------------------------------------------------------------43300000
433100 7400-CHECK-PO-ASN-STATUS.                                        43310000
433200     PERFORM                                                      43320000
433300         WITH TEST AFTER                                          43330000
433400         VARYING PV-RETRY-COUNTER                                 43340000
433500         FROM 1 BY 1                                              43350000
433600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43360000
433700            OR (SQLCODE = +0 OR +100 OR -811))                    43370000
433800                                                                  43380000
433900         EXEC SQL                                                 43390000
434000             SELECT A.TP_DKEY                                     43400000
434100              INTO  :TRDTRN-TP-DKEY                               43410000
434200              FROM  TTRDTRN A                                     43420000
434300                  , TTRDPRT B                                     43430000
434400              WHERE ENT_ID  = :ASC-KEY-ENT-ID                     43440000
434500                AND A.TP_DKEY = B.TP_DKEY                         43450000
434600                AND TRAN_SET_CDE = :PV-TRAN-SET-CDE               43460000
434700                AND A.INACTV_DTE = '9999-09-09'                   43470000
434800                AND B.INACTV_DTE = '9999-09-09'                   43480000
434900*               AND PROD_TEST_IND = 'P'                           43490000
435000         END-EXEC                                                 43500000
435100                                                                  43510000
435200         EVALUATE TRUE                                            43520000
435300             WHEN SQLCODE = +0                                    43530000
435400             WHEN SQLCODE = -811                                  43540000
435500             WHEN SQLCODE = -904                                  43550000
435600             WHEN SQLCODE = -913                                  43560000
435700             WHEN SQLCODE = +100                                  43570000
435800                 CONTINUE                                         43580000
435900             WHEN SQLWARN0 NOT = SPACE                            43590000
436000             WHEN SQLCODE < +0                                    43600000
436100             WHEN SQLCODE > +0                                    43610000
436200                 MOVE '7400-CHECK-PO-ASN-STATUS'                  43620000
436300                                 TO DP013-PARAGRAPH               43630000
436400                 MOVE 'SELECT ON TTRDTRN TABLE'                   43640000
436500                                 TO DP013-MESSAGE-TEXT (1)        43650000
436600                 MOVE SQLCA      TO DP013-SQLCA                   43660000
436700                 MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)      43670000
436800                     SET DP013-DB2-ABEND                          43680000
436900                         DP013-XCTL-DISPLAY-RESTART               43690000
437000                                 TO TRUE                          43700000
437100                 PERFORM DP013-0000-PROCESS-ABEND                 43710000
437200         END-EVALUATE                                             43720000
437300     END-PERFORM.                                                 43730000
437400                                                                  43740000
437500     IF SQLCODE = -904 OR -913                                    43750000
437600        MOVE '7400-CHECK-PO-ASN-STATUS'                           43760000
437700                        TO DP013-PARAGRAPH                        43770000
437800        MOVE 'SELECT ON TTRDTRN TABLE'                            43780000
437900                        TO DP013-MESSAGE-TEXT (1)                 43790000
438000        MOVE SQLCA      TO DP013-SQLCA                            43800000
438100        MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)               43810000
438200            SET DP013-DB2-ABEND                                   43820000
438300                DP013-XCTL-DISPLAY-RESTART                        43830000
438400                        TO TRUE                                   43840000
438500        PERFORM DP013-0000-PROCESS-ABEND                          43850000
438600     END-IF.                                                      43860000
438700                                                                  43870000
438800*-----------------------------------------------------------------43880000
438900* CHECK TO SEE IF THE VENDOR RECENTLY UPDATED OR DELETED IS SET   43890000
439000* UP FOR EDI PURCHASE ORDERS OR ASNS.                             43900000
439100*-----------------------------------------------------------------43910000
439200 7500-CHECK-TEST-PROD-STATUS.                                     43920000
439300     PERFORM                                                      43930000
439400         WITH TEST AFTER                                          43940000
439500         VARYING PV-RETRY-COUNTER                                 43950000
439600         FROM 1 BY 1                                              43960000
439700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43970000
439800            OR (SQLCODE = +0 OR +100 OR -811))                    43980000
439900                                                                  43990000
440000         EXEC SQL                                                 44000000
440100             SELECT A.TP_DKEY                                     44010000
440200              INTO  :TRDTRN-TP-DKEY                               44020000
440300              FROM  TTRDTRN A                                     44030000
440400                  , TTRDPRT B                                     44040000
440500              WHERE ENT_ID  = :ASC-KEY-ENT-ID                     44050000
440600                AND A.TP_DKEY = B.TP_DKEY                         44060000
440700                AND TRAN_SET_CDE = :PV-TRAN-SET-CDE               44070000
440800                AND A.INACTV_DTE = '9999-09-09'                   44080000
440900                AND B.INACTV_DTE = '9999-09-09'                   44090000
441000                AND PROD_TEST_IND = :PV-PROD-TEST-IND             44100000
441100         END-EXEC                                                 44110000
441200                                                                  44120000
441300         EVALUATE TRUE                                            44130000
441400             WHEN SQLCODE = +0                                    44140000
441500             WHEN SQLCODE = -811                                  44150000
441600             WHEN SQLCODE = -904                                  44160000
441700             WHEN SQLCODE = -913                                  44170000
441800             WHEN SQLCODE = +100                                  44180000
441900                 CONTINUE                                         44190000
442000             WHEN SQLWARN0 NOT = SPACE                            44200000
442100             WHEN SQLCODE < +0                                    44210000
442200             WHEN SQLCODE > +0                                    44220000
442300                 MOVE '7500-CHECK-TEST-PROD-STATUS'               44230000
442400                                 TO DP013-PARAGRAPH               44240000
442500                 MOVE 'SELECT ON TTRDTRN TABLE'                   44250000
442600                                 TO DP013-MESSAGE-TEXT (1)        44260000
442700                 MOVE SQLCA      TO DP013-SQLCA                   44270000
442800                 MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)      44280000
442900                     SET DP013-DB2-ABEND                          44290000
443000                         DP013-XCTL-DISPLAY-RESTART               44300000
443100                                 TO TRUE                          44310000
443200                 PERFORM DP013-0000-PROCESS-ABEND                 44320000
443300         END-EVALUATE                                             44330000
443400     END-PERFORM.                                                 44340000
443500                                                                  44350000
443600     IF SQLCODE = -904 OR -913                                    44360000
443700        MOVE '7500-CHECK-TEST-PROD-STATUS'                        44370000
443800                        TO DP013-PARAGRAPH                        44380000
443900        MOVE 'SELECT ON TTRDTRN TABLE'                            44390000
444000                        TO DP013-MESSAGE-TEXT (1)                 44400000
444100        MOVE SQLCA      TO DP013-SQLCA                            44410000
444200        MOVE 'TTRDTRN'  TO DP013-DB2-TABLE-NAME (1)               44420000
444300            SET DP013-DB2-ABEND                                   44430000
444400                DP013-XCTL-DISPLAY-RESTART                        44440000
444500                        TO TRUE                                   44450000
444600        PERFORM DP013-0000-PROCESS-ABEND                          44460000
444700     END-IF.                                                      44470000
444800                                                                  44480000
444900*---------------------------------------------------------------  44490000
445000* CHECK THAT A VENDOR IS SET UP FOR PO'S AND ASNS                 44500000
445100* IF THAT VENDOR'S INFORMATION HAS BEEN UPDATED OR DELETED.       44510000
445200*---------------------------------------------------------------- 44520000
445300 8000-CHECK-PO-ASN-IND.                                           44530000
445400                                                                  44540000
445500     INITIALIZE VN007-SENDING-FIELDS.                             44550000
445600                                                                  44560000
445700*    MOVE '850' TO PV-TRAN-SET-CDE.                               44570000
445800*    PERFORM 7400-CHECK-PO-ASN-STATUS.                            44580000
445900*    IF SQLCODE = +000 OR -811                                    44590000
446000*       MOVE 'Y' TO VN007-EDI-PO-IND                              44600000
446100*       MOVE 'Y' TO PS-MQ-SEND-SW                                 44610000
446200*       MOVE 'Y' TO PS-PO-SETUP-SW                                44620000
446300*    ELSE                                                         44630000
446400*       IF SQLCODE = +100                                         44640000
446500*          MOVE 'N' TO VN007-EDI-PO-IND                           44650000
446600*          MOVE 'Y' TO PS-MQ-SEND-SW                              44660000
446700*          MOVE 'Y' TO PS-PO-SETUP-SW                             44670000
446800*       END-IF                                                    44680000
446900*    END-IF.                                                      44690000
447000                                                                  44700000
447100     MOVE '850' TO PV-TRAN-SET-CDE.                               44710000
447200     MOVE 'P' TO PV-PROD-TEST-IND.                                44720000
447300     PERFORM 7500-CHECK-TEST-PROD-STATUS.                         44730000
447400     IF SQLCODE = +000 OR -811                                    44740000
447500        MOVE 'Y' TO VN007-EDI-PO-PROD-IND                         44750000
447600        MOVE 'Y' TO PS-MQ-SEND-SW                                 44760000
447700        MOVE 'Y' TO PS-PO-SETUP-SW                                44770000
447800     ELSE                                                         44780000
447900        IF SQLCODE = +100                                         44790000
448000           MOVE 'N' TO VN007-EDI-PO-PROD-IND                      44800000
448100           MOVE 'Y' TO PS-MQ-SEND-SW                              44810000
448200           MOVE 'Y' TO PS-PO-SETUP-SW                             44820000
448300        END-IF                                                    44830000
448400     END-IF.                                                      44840000
448500                                                                  44850000
448600     MOVE '850' TO PV-TRAN-SET-CDE.                               44860000
448700     MOVE 'T' TO PV-PROD-TEST-IND.                                44870000
448800     PERFORM 7500-CHECK-TEST-PROD-STATUS.                         44880000
448900     IF SQLCODE = +000 OR -811                                    44890000
449000        MOVE 'Y' TO VN007-EDI-PO-TEST-IND                         44900000
449100        MOVE 'Y' TO PS-MQ-SEND-SW                                 44910000
449200        MOVE 'Y' TO PS-PO-SETUP-SW                                44920000
449300     ELSE                                                         44930000
449400        IF SQLCODE = +100                                         44940000
449500           MOVE 'N' TO VN007-EDI-PO-TEST-IND                      44950000
449600           MOVE 'Y' TO PS-MQ-SEND-SW                              44960000
449700           MOVE 'Y' TO PS-PO-SETUP-SW                             44970000
449800        END-IF                                                    44980000
449900     END-IF.                                                      44990000
450000                                                                  45000000
450100     IF VN007-EDI-PO-PROD-IND = 'Y' OR                            45010000
450200        VN007-EDI-PO-TEST-IND = 'Y'                               45020000
450300           MOVE 'Y' TO VN007-EDI-PO-IND                           45030000
450400     ELSE                                                         45040000
450500        MOVE 'N' TO VN007-EDI-PO-IND.                             45050000
450600                                                                  45060000
450700     MOVE '856' TO PV-TRAN-SET-CDE.                               45070000
450800     PERFORM 7400-CHECK-PO-ASN-STATUS.                            45080000
450900     IF SQLCODE = +000 OR -811                                    45090000
451000        MOVE 'Y' TO VN007-EDI-ASN-IND                             45100000
451100        MOVE 'Y' TO PS-MQ-SEND-SW                                 45110000
451200        MOVE 'Y' TO PS-ASN-SETUP-SW                               45120000
451300     ELSE                                                         45130000
451400        IF SQLCODE = +100                                         45140000
451500           MOVE 'N' TO VN007-EDI-ASN-IND                          45150000
451600           MOVE 'Y' TO PS-MQ-SEND-SW                              45160000
451700           MOVE 'Y' TO PS-ASN-SETUP-SW                            45170000
451800        END-IF                                                    45180000
451900     END-IF.                                                      45190000
452000                                                                  45200000
452100     MOVE '860' TO PV-TRAN-SET-CDE.                               45210000
452200     MOVE 'P' TO PV-PROD-TEST-IND.                                45220000
452300     PERFORM 7500-CHECK-TEST-PROD-STATUS.                         45230000
452400     IF SQLCODE = +000 OR -811                                    45240000
452500        MOVE 'Y' TO VN007-EDI-POCHG-PROD-IND                      45250000
452600        MOVE 'Y' TO PS-MQ-SEND-SW                                 45260000
452700        MOVE 'Y' TO PS-POCHG-SETUP-SW                             45270000
452800     ELSE                                                         45280000
452900        IF SQLCODE = +100                                         45290000
453000           MOVE 'N' TO VN007-EDI-POCHG-PROD-IND                   45300000
453100           MOVE 'Y' TO PS-MQ-SEND-SW                              45310000
453200           MOVE 'Y' TO PS-POCHG-SETUP-SW                          45320000
453300        END-IF                                                    45330000
453400     END-IF.                                                      45340000
453500                                                                  45350000
453600     MOVE '860' TO PV-TRAN-SET-CDE.                               45360000
453700     MOVE 'T' TO PV-PROD-TEST-IND.                                45370000
453800     PERFORM 7500-CHECK-TEST-PROD-STATUS.                         45380000
453900     IF SQLCODE = +000 OR -811                                    45390000
454000        MOVE 'Y' TO VN007-EDI-POCHG-TEST-IND                      45400000
454100        MOVE 'Y' TO PS-MQ-SEND-SW                                 45410000
454200        MOVE 'Y' TO PS-POCHG-SETUP-SW                             45420000
454300     ELSE                                                         45430000
454400        IF SQLCODE = +100                                         45440000
454500           MOVE 'N' TO VN007-EDI-POCHG-TEST-IND                   45450000
454600           MOVE 'Y' TO PS-MQ-SEND-SW                              45460000
454700           MOVE 'Y' TO PS-POCHG-SETUP-SW                          45470000
454800        END-IF                                                    45480000
454900     END-IF.                                                      45490000
455000                                                                  45500000
455100     IF VN007-EDI-POCHG-PROD-IND = 'Y' OR                         45510000
455200        VN007-EDI-POCHG-TEST-IND = 'Y'                            45520000
455300           MOVE 'Y' TO VN007-EDI-POCHG-IND                        45530000
455400     ELSE                                                         45540000
455500        MOVE 'N' TO VN007-EDI-POCHG-IND.                          45550000
455600                                                                  45560000
455700     IF PS-PO-NOT-SETUP AND PS-ASN-NOT-SETUP                      45570000
455800     AND PS-POCHG-NOT-SETUP                                       45580000
455900        MOVE 'N' TO PS-MQ-SEND-SW.                                45590000
456000                                                                  45600000
456100*-----------------------------------------------------------------45610000
456200* CHECK IF PO AND ASN INDICATOR SHOULD BE SENT TO SUPPLIER SYSTEM 45620000
456300*-----------------------------------------------------------------45630000
456400 8050-CHECK-EDI-PO-ASN-IND.                                       45640000
456500                                                                  45650000
456600     IF PS-SEND                                                   45660000
456700        PERFORM 8100-SEND-MQ-MESSAGE                              45670000
456800     END-IF.                                                      45680000
456900                                                                  45690000
457000     INITIALIZE PS-MQ-SEND-SW.                                    45700000
457100                                                                  45710000
457200*---------------------------------------------------------------  45720000
457300* SEND MQSERIES MESSAGE TO VNKCS024 WHEN VENDOR INFORMATION HAS   45730000
457400* BEEN  UPDATED OR DELETED FOR VENDORS SET UP FOR PO              45740000
457500* AND ASN DOCUMENTS. VNKCS024 WILL FORMAT AND SEND INFORMATION    45750000
457600* TO RMS SUPPLIER SYSTEM.                                         45760000
457700*---------------------------------------------------------------- 45770000
457800 8100-SEND-MQ-MESSAGE.                                            45780000
457900                                                                  45790000
458000     PERFORM 7300-GET-VENDOR-NUMBER.                              45800000
458100     IF SQLCODE = +0                                              45810000
458200        MOVE EXTENT-DUN-NBR TO VN007-VND-NBR                      45820000
458300        MOVE ASC-KEY-ENT-ID TO VN007-ENT-ID                       45830000
458400        IF EXTENT-PRTNR-IND = 'Y'                                 45840000
458500           MOVE 'P' TO VN007-EDI-VNDR-TYPE-IND                    45850000
458600        ELSE                                                      45860000
458700           MOVE 'S' TO VN007-EDI-VNDR-TYPE-IND                    45870000
458800        END-IF                                                    45880000
458900                                                                  45890000
459000        EXEC CICS LINK PROGRAM (PC-VNKCS024)                      45900000
459100                      COMMAREA (VN007-COMMAREA)                   45910000
459200                          RESP (PV-CICS-RESPONSE)                 45920000
459300        END-EXEC                                                  45930000
459400                                                                  45940000
459500        IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                45950000
459600            CONTINUE                                              45960000
459700        ELSE                                                      45970000
459800           MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM             45980000
459900           MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH           45990000
460000           MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT (1)    46000000
460100           MOVE VN007-REASON-CODE    TO DP013-SQLCA               46010000
460200           SET DP013-DB2-ABEND                                    46020000
460300               DP013-ROLLBACK                                     46030000
460400               DP013-XCTL-DISPLAY-RESTART TO TRUE                 46040000
460500           PERFORM DP013-0000-PROCESS-ABEND                       46050000
460600        END-IF                                                    46060000
460700     END-IF.                                                      46070000
460800                                                                  46080000
460900*---------------------------------------------------------------- 46090000
461000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.        46100000
461100*---------------------------------------------------------------- 46110000
461200                                                                  46120000
461300 9100-READ-SEL-QUEUE.                                             46130000
461400     EXEC CICS                                                    46140000
461500         READQ TS                                                 46150000
461600             QUEUE (ASC-SEL-QUEUE-NAME)                           46160000
461700             INTO  (ET301-SELECTED-VNDRS)                         46170000
461800             ITEM  (ASC-SEL-ITEM)                                 46180000
461900             RESP  (PV-CICS-RESPONSE)                             46190000
462000     END-EXEC.                                                    46200000
462100                                                                  46210000
462200     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   46220000
462300         CONTINUE                                                 46230000
462400     ELSE                                                         46240000
462500         SET DP013-LOGIC-ABEND                                    46250000
462600             DP013-NO-ROLLBACK     TO TRUE                        46260000
462700         MOVE '9100-READ-SEL-QUEUE'                               46270000
462800                                   TO DP013-PARAGRAPH             46280000
462900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46290000
463000                                   TO DP013-MESSAGE-TEXT (1)      46300000
463100         PERFORM DP013-0000-PROCESS-ABEND                         46310000
463200     END-IF.                                                      46320000
463300                                                                  46330000
463400/                                                                 46340000
463500*---------------------------------------------------------------- 46350000
463600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.        46360000
463700*---------------------------------------------------------------- 46370000
463800 9200-REWRITE-LIST-QUEUE.                                         46380000
463900                                                                  46390000
464000     EXEC CICS                                                    46400000
464100          WRITEQ TS                                               46410000
464200              QUEUE  (ASC-SEL-QUEUE-NAME)                         46420000
464300              FROM   (ET301-SELECTED-VNDRS)                       46430000
464400              ITEM   (ASC-SEL-ITEM)                               46440000
464500              RESP   (PV-CICS-RESPONSE)                           46450000
464600              REWRITE                                             46460000
464700     END-EXEC.                                                    46470000
464800                                                                  46480000
464900     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               46490000
465000         SET DP013-CICS-ABEND                                     46500000
465100             DP013-NO-ROLLBACK     TO TRUE                        46510000
465200         MOVE '9200-REWRITE-LIST-QUEUE'                           46520000
465300                                   TO DP013-PARAGRAPH             46530000
465400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   46540000
465500                                   TO DP013-MESSAGE-TEXT (1)      46550000
465600         PERFORM DP013-0000-PROCESS-ABEND                         46560000
465700     END-IF.                                                      46570000
465800                                                                  46580000
465900/                                                                 46590000
466000*---------------------------------------------------------------- 46600000
466100*    ABEND PROCESSOR MODULE                                       46610000
466200*---------------------------------------------------------------- 46620000
466300                                                                  46630000
466400     COPY DPPD013.                                                46640000
