000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      MRKRP023.                                       00040000
000500 AUTHOR.          DAVID PHELPS.                                   00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    10/12/93.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900****************************************************************  00090000
001000* THIS PROGRAM WILL PRINT A SUMMARY OF THE ORDER OVERRIDES     *  00100000
001100* FROM THE PURCHASE ORDER SYSTEM. THIS REPRESENTS ORDERS THAT  *  00110000
001200* HAVE BEEN GENERATED BUT NOT SUBMITTED.                       *  00120000
001300*                                                                 00130000
001400****PLEASE NOTE**PLEASE NOTE**PLEASE NOTE**PLEASE NOTE**********  00140000
001500* 03/08/2005  THIS PROGRAM HAS CHANGED TO SOURCE FROM             00150000
001600*             THE SG ORACLE TABLES.                               00160000
001700*             THE CRITERIA FOR WHICH ORDERS ARE ON THE REPORT     00170000
001800*             ARE (1)WHEN THE STAGING STATUS CODE (STG_ST_CDE)    00180000
001900*             IS EQUAL TO 'A' (ACCEPTED) OR 'C' (CREATED) AND     00190000
002000*             (2)THAT THE ORDER RUN DATE IS GREATER THAN OR       00200000
002100*             EQUAL TO THE CURRENT BEGIN OF WEEK DATE.            00210000
002200****PLEASE NOTE**PLEASE NOTE**PLEASE NOTE**PLEASE NOTE**********  00220000
002300*                                                                 00230000
002400* DAVID PHELPS                                                    00240000
002500* 10/12/93 - CREATED AS NEW                                       00250000
002600*                                                                 00260000
002700****************************************************************  00270000
002800*  08/28/98 - MAINTENANCE              BY : PATRICK MCGRAW        00280000
002900*           CHANGE DATE LOGIC USING WINDOWING TO MAKE THIS PROGRAM00290000
003000*           Y2K COMPLIANT.  CHANGED THE PROGRAM TO USE DP132      00300000
003100*           REPORT HEADER FROM THE DP132O HEADER FOR Y2K          00310000
003200*           COMPLIANCE. EXPANDED CD-CPU-YEAR BY ADDING CD-CPU-CC  00320000
003300*           FOR THE CENTURY TO BE Y2K COMPLIANT. EXPANDED         00330000
003400*           THE PRT-CREATED FIELD TO 10 BYTES TO ALLOW FOR CENT.  00340000
003500******************************************************************00350000
003600*  08/28/98 - MAINTENANCE              BY : PATRICK MCGRAW        00360000
003700*           REMOVED THE MBS SUBROUTINE CALLS WITH DB2 CALLS TO    00370000
003800*           GET DMM, GMM, AND DPT INFO.                           00380000
003900******************************************************************00390000
004000*  03/08/2005 - WR#26352               BY : MARIA KLAMIK          00400000
004100*           CHANGED PROGRAM TO SOURCE FROM THE SG ORACLE TABLES   00410000
004200******************************************************************00420000
070941*  07/30/2018 - CHG0204126             BY : COGNIZANT             00422004
070941*           ORACLE LOGON STANDARDS PROGRAM CHANGE                 00423004
070941******************************************************************00426004
004300 ENVIRONMENT DIVISION.                                            00430000
004400******************************************************************00440000
004500*                                                                 00450000
004600 CONFIGURATION SECTION.                                           00460000
004700 SOURCE-COMPUTER. IBM-3090.                                       00470000
004800 OBJECT-COMPUTER. IBM-3090.                                       00480000
004900*                                                                 00490000
005000 INPUT-OUTPUT SECTION.                                            00500000
005100 FILE-CONTROL.                                                    00510000
005200                                                                  00520000
005300     SELECT DATE-CONTROL-CARD-FILE                                00530000
005400         ASSIGN                       TO INP01.                   00540000
005500                                                                  00550000
005600     SELECT SYS-ID1-CONTROL-CARD-FILE                             00560000
005700         ASSIGN                       TO INP02.                   00570000
005800                                                                  00580000
005900     SELECT SYS-ID2-CONTROL-CARD-FILE                             00590000
006000         ASSIGN                       TO INP03.                   00600000
006100                                                                  00610000
006200     SELECT SYS-ID3-CONTROL-CARD-FILE                             00620000
006300         ASSIGN                       TO INP04.                   00630000
006400                                                                  00640000
006500     SELECT SYS-ID4-CONTROL-CARD-FILE                             00650000
006600         ASSIGN                       TO INP05.                   00660000
006700                                                                  00670000
006800     SELECT SYS-ID5-CONTROL-CARD-FILE                             00680000
006900         ASSIGN                       TO INP06.                   00690000
007000                                                                  00700000
007100     SELECT SYS-ID6-CONTROL-CARD-FILE                             00710000
007200         ASSIGN                       TO INP07.                   00720000
007300                                                                  00730000
007400     SELECT SYS-ID7-CONTROL-CARD-FILE                             00740000
007500         ASSIGN                       TO INP08.                   00750000
007600                                                                  00760000
007700     SELECT DEPT-ID-CARD-FILE                                     00770000
007800         ASSIGN                       TO INP09.                   00780000
007900                                                                  00790000
008000     SELECT PRINT-REPORT                                          00800000
008100         ASSIGN                       TO RPT01.                   00810000
008200                                                                  00820001
008300     SELECT ORACLE-LOGON-FILE                                     00830001
008400         ASSIGN                       TO ORALOGON.                00840001
008500                                                                  00850000
008600     EJECT                                                        00860000
008700*                                                                 00870000
008800***************                                                   00880000
008900 DATA DIVISION.                                                   00890000
009000***************                                                   00900000
009100*                                                                 00910000
009200 FILE SECTION.                                                    00920000
009300*                                                                 00930000
009400 FD  DATE-CONTROL-CARD-FILE                                       00940000
009500     RECORDING MODE IS F                                          00950000
009600     BLOCK CONTAINS 0 RECORDS.                                    00960000
009700 01  DATE-CONTROL-CARD-RECORD        PIC  X(80).                  00970000
009800                                                                  00980000
009900 FD  SYS-ID1-CONTROL-CARD-FILE                                    00990000
010000     RECORDING MODE IS F                                          01000000
010100     BLOCK CONTAINS 0 RECORDS.                                    01010000
010200 01  SYS-ID1-CONTROL-CARD-RECORD     PIC  X(80).                  01020000
010300                                                                  01030000
010400 FD  SYS-ID2-CONTROL-CARD-FILE                                    01040000
010500     RECORDING MODE IS F                                          01050000
010600     BLOCK CONTAINS 0 RECORDS.                                    01060000
010700 01  SYS-ID2-CONTROL-CARD-RECORD     PIC  X(80).                  01070000
010800                                                                  01080000
010900 FD  SYS-ID3-CONTROL-CARD-FILE                                    01090000
011000     RECORDING MODE IS F                                          01100000
011100     BLOCK CONTAINS 0 RECORDS.                                    01110000
011200 01  SYS-ID3-CONTROL-CARD-RECORD     PIC  X(80).                  01120000
011300                                                                  01130000
011400 FD  SYS-ID4-CONTROL-CARD-FILE                                    01140000
011500     RECORDING MODE IS F                                          01150000
011600     BLOCK CONTAINS 0 RECORDS.                                    01160000
011700 01  SYS-ID4-CONTROL-CARD-RECORD     PIC  X(80).                  01170000
011800                                                                  01180000
011900 FD  SYS-ID5-CONTROL-CARD-FILE                                    01190000
012000     RECORDING MODE IS F                                          01200000
012100     BLOCK CONTAINS 0 RECORDS.                                    01210000
012200 01  SYS-ID5-CONTROL-CARD-RECORD     PIC  X(80).                  01220000
012300                                                                  01230000
012400 FD  SYS-ID6-CONTROL-CARD-FILE                                    01240000
012500     RECORDING MODE IS F                                          01250000
012600     BLOCK CONTAINS 0 RECORDS.                                    01260000
012700 01  SYS-ID6-CONTROL-CARD-RECORD     PIC  X(80).                  01270000
012800                                                                  01280000
012900 FD  SYS-ID7-CONTROL-CARD-FILE                                    01290000
013000     RECORDING MODE IS F                                          01300000
013100     BLOCK CONTAINS 0 RECORDS.                                    01310000
013200 01  SYS-ID7-CONTROL-CARD-RECORD     PIC  X(80).                  01320000
013300                                                                  01330000
013400 FD  DEPT-ID-CARD-FILE                                            01340000
013500     RECORDING MODE IS F                                          01350000
013600     BLOCK CONTAINS 0 RECORDS.                                    01360000
013700 01  DEPT-ID-CARD-RECORD             PIC  X(80).                  01370000
013800                                                                  01380000
013900 FD  PRINT-REPORT                                                 01390000
014000     RECORDING MODE F                                             01400000
014100     BLOCK CONTAINS 0 RECORDS                                     01410000
014200     RECORD CONTAINS 132 CHARACTERS                               01420000
014300     LABEL RECORDS ARE OMITTED                                    01430000
014400     DATA RECORD IS PRINT-LINE.                                   01440000
014500                                                                  01450000
014600 01  PRINT-LINE                      PIC X(132).                  01460000
014700                                                                  01470000
014800 FD  ORACLE-LOGON-FILE                                            01480001
014900     RECORDING MODE IS F                                          01490001
015000     LABEL RECORDS ARE STANDARD                                   01500001
015100     BLOCK CONTAINS 0 RECORDS                                     01510001
015200     RECORD CONTAINS 80 CHARACTERS                                01520001
015300     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      01530001
015400                                                                  01540001
015500 01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       01550001
015600                                                                  01560001
015700     EJECT                                                        01570000
015800                                                                  01580000
015900 WORKING-STORAGE SECTION.                                         01590000
016000                                                                  01600000
016100 01 PV-PROGRAM-VARIABLES.                                         01610000
016200     05  PV-ORACLE-USERID-LEN       PIC S9(4) VALUE ZEROS         01620001
016300                                              COMP SYNC.          01630001
016400     05  PV-ORACLE-PASSWORD-LEN     PIC S9(4) VALUE ZEROS         01640001
016500                                              COMP SYNC.          01650001
016600     05 PV-LINE-CNT                                  PIC S9(3)    01660000
016700                                                     VALUE +0     01670000
016800                                                     COMP-3.      01680000
016900     05 PV-PAGE-CNT                                  PIC 9(3)     01690000
017000                                                     VALUE ZEROS  01700000
017100                                                     COMP-3.      01710000
017200     05 PV-CSR-FETCHED-CNT                           PIC 9(8)     01720000
017300                                                     VALUE ZEROS. 01730000
017400     05 PV-EX-DEPT-CNT                               PIC 9(8)     01740000
017500                                                     VALUE ZEROS. 01750000
017600     05 PV-DETAIL-LINE-CNT                           PIC 9(8)     01760000
017700                                                     VALUE ZEROS. 01770000
017800     05 PV-PARAGRAPH-NAME             PIC X(30)   VALUE SPACES.   01780000
017900     05 PV-OPERATION                  PIC X(30)   VALUE SPACES.   01790000
018000     05  PV-YYMMDD-DATE.                                          01800000
018100         10  PV-YYMMDD-YY             PIC  X(02)    VALUE SPACE.  01810000
018200         10  PV-YYMMDD-MM             PIC  X(02)    VALUE SPACE.  01820000
018300         10  PV-YYMMDD-DD             PIC  X(02)    VALUE SPACE.  01830000
018400     05  PV-YEAR.                                                 01840000
018500         15  PV-YEAR-CC               PIC  X(02)    VALUE SPACE.  01850000
018600         15  PV-YEAR-YY               PIC  X(02)    VALUE SPACE.  01860000
018700     05  PV-TIME-HHMMSS.                                          01870000
018800         10  PV-TIME-HHMMSS-HH        PIC  X(02)    VALUE SPACES. 01880000
018900         10  PV-TIME-HHMMSS-MM        PIC  X(02)    VALUE SPACES. 01890000
019000         10  PV-TIME-HHMMSS-SS        PIC  X(02)    VALUE SPACES. 01900000
019100     05  PV-BOW-DATE-FMT.                                         01910000
019200         10 PV-BOW-DATE               PIC  X(10)    VALUE SPACES. 01920000
019300         10 FILLER                    PIC  X(09)                  01930000
019400                                           VALUE '.00.00.01'.     01940000
019500     05  PV-ORD-RN-DATE               PIC  X(10)    VALUE SPACES. 01950000
019600     05  PV-ORACLE-BOW-DATE           PIC  X(19)    VALUE SPACES. 01960000
019700     05  PV-GMA-NBR                   PIC  X(02)    VALUE SPACES. 01970000
019800     05  PV-DMA-NBR                   PIC  X(02)    VALUE SPACES. 01980000
019900     05  PV-HOLD-GMA                  PIC  X(02)    VALUE SPACES. 01990000
020000     05  PV-HOLD-DMA                  PIC  X(02)    VALUE SPACES. 02000000
020100     05  PV-GMA-NAME                  PIC  X(18)    VALUE SPACES. 02010000
020200     05  PV-DMA-NAME                  PIC  X(18)    VALUE SPACES. 02020000
020300     05  PV-SKU-CNT                   PIC S9(9)     COMP-3        02030000
020400                                                    VALUE ZERO.   02040000
020500     05  PV-ORD-QTY-CNT               PIC S9(8)     COMP-3        02050000
020600                                                    VALUE ZERO.   02060000
020700     05  PV-SUM-RTL-AMT               PIC S9(9)V99  COMP-3        02070000
020800                                                    VALUE ZERO.   02080000
020900     05  PV-SUM-COST-AMT              PIC S9(9)V99  COMP-3        02090000
021000                                                    VALUE ZERO.   02100000
021100     05  PV-DEPT-NBR                  PIC X(03)    VALUE SPACES.  02110000
021200*                                                                 02120000
021300 01 PV-TOTAL-VARIABLES.                                           02130000
021400     05 PV-TOT1-ORDER-LINES                          PIC S9(9)V99 02140000
021500                                                       COMP-3.    02150000
021600     05 PV-TOT1-TOTORDQTY                            PIC S9(8)    02160000
021700                                                       COMP-3.    02170000
021800     05 PV-TOT1-TOTCOST                              PIC S9(9)V99 02180000
021900                                                       COMP-3.    02190000
022000     05 PV-TOT1-TOTRETAIL                            PIC S9(9)V99 02200000
022100                                                       COMP-3.    02210000
022200     05 PV-TOT2-ORDER-LINES                          PIC S9(9)V99 02220000
022300                                                       COMP-3.    02230000
022400     05 PV-TOT2-TOTORDQTY                            PIC S9(8)    02240000
022500                                                       COMP-3.    02250000
022600     05 PV-TOT2-TOTCOST                              PIC S9(9)V99 02260000
022700                                                       COMP-3.    02270000
022800     05 PV-TOT2-TOTRETAIL                            PIC S9(9)V99 02280000
022900                                                       COMP-3.    02290000
023000******************************************************************02300000
023100* WORKING-STORAGE FOR CALENDAR ROUTINE                            02310000
023200******************************************************************02320000
023300     COPY DPWS500.                                                02330000
023400******************************************************************02340000
023500* STANDARD HEADER LINE - KOHLS 132 COL                            02350000
023600******************************************************************02360000
023700     COPY DPWS132.                                                02370000
023800******************************************************************02380000
023900* DATE CONTROL CARD                                               02390000
024000******************************************************************02400000
024100 01  CC-DATE-CONTROL-CARD.                                        02410000
024200     05  CC-DATE.                                                 02420000
024300         10  CC-DATE-CC               PIC  X(02)     VALUE SPACE. 02430000
024400         10  CC-DATE-YY               PIC  X(02)     VALUE SPACE. 02440000
024500         10  CC-DATE-DASH1            PIC  X         VALUE SPACE. 02450000
024600         10  CC-DATE-MM               PIC  X(02)     VALUE SPACE. 02460000
024700         10  CC-DATE-DASH2            PIC  X         VALUE SPACE. 02470000
024800         10  CC-DATE-DD               PIC  X(02)     VALUE SPACE. 02480000
024900     05  FILLER                       PIC  X(70)     VALUE SPACE. 02490000
025000                                                                  02500000
025100 01  CC-SYS-ID1                       PIC  X(02)     VALUE SPACE. 02510000
025200 01  CC-SYS-ID2                       PIC  X(02)     VALUE SPACE. 02520000
025300 01  CC-SYS-ID3                       PIC  X(02)     VALUE SPACE. 02530000
025400 01  CC-SYS-ID4                       PIC  X(02)     VALUE SPACE. 02540000
025500 01  CC-SYS-ID5                       PIC  X(02)     VALUE SPACE. 02550000
025600 01  CC-SYS-ID6                       PIC  X(02)     VALUE SPACE. 02560000
025700 01  CC-SYS-ID7                       PIC  X(02)     VALUE SPACE. 02570000
025800                                                                  02580000
025900******************************************************************02590000
026000* EXCLUDED DEPT CONTROL CARD                                      02600000
026100******************************************************************02610000
026200*JL                                                               02620000
026300 01  CC-DEPT-RECORD.                                              02630000
026400     05  CC-DEPT-ID1                  PIC  X(03) VALUE SPACE.     02640000
026500     05  FILLER                       PIC  X(01) VALUE SPACE.     02650000
026600     05  CC-DEPT-ID2                  PIC  X(03) VALUE SPACE.     02660000
026700     05  FILLER                       PIC  X(01) VALUE SPACE.     02670000
026800     05  CC-DEPT-ID3                  PIC  X(03) VALUE SPACE.     02680000
026900     05  FILLER                       PIC  X(01) VALUE SPACE.     02690000
027000     05  CC-DEPT-ID4                  PIC  X(03) VALUE SPACE.     02700000
027100     05  FILLER                       PIC  X(01) VALUE SPACE.     02710000
027200     05  CC-DEPT-ID5                  PIC  X(03) VALUE SPACE.     02720000
027300                                                                  02730000
027400 01  DB-KEY-DEPT.                                                 02740000
027500     05  DB-DEPT-ID1                  PIC X(3) VALUE SPACE.       02750000
027600     05  DB-DEPT-ID2                  PIC X(3) VALUE SPACE.       02760000
027700     05  DB-DEPT-ID3                  PIC X(3) VALUE SPACE.       02770000
027800     05  DB-DEPT-ID4                  PIC X(3) VALUE SPACE.       02780000
027900     05  DB-DEPT-ID5                  PIC X(3) VALUE SPACE.       02790000
028000                                                                  02800000
028100******************************************************************02810000
028200                                                                  02820000
028300 01  EMPTY-REPORT-LINE.                                           02830000
028400     05  FILLER                       PIC X(48)      VALUE        02840000
028500         '          ** NO RECORDS WERE FOUND **         '.        02850000
028600*                                                                 02860000
028700 01  HL-HEADING-BLANK.                                            02870000
028800     05  FILLER                       PIC X(20)      VALUE        02880000
028900         '                    '.                                  02890000
029000*                                                                 02900000
029100 01  HL-HEADING-LINE1.                                            02910000
029200     05  FILLER                       PIC X(49)      VALUE SPACES.02920000
029300     05  FILLER                       PIC X(37)      VALUE        02930000
029400         ' ORDERS GENERATED BUT NOT SUBMITTED  '.                 02940000
029500     05  FILLER                       PIC X(56)      VALUE SPACE. 02950000
029600*                                                                 02960000
029700 01  HL-HEADING-LINE2.                                            02970000
029800     05  FILLER                       PIC X(05)      VALUE        02980000
029900         'GMM: '.                                                 02990000
030000     05  PRT-GMM                      PIC X(02).                  03000000
030100     05  FILLER                       PIC X(02)      VALUE SPACES.03010000
030200     05  PRT-GMM-NAME                 PIC X(32).                  03020000
030300     05  FILLER                       PIC X(07)      VALUE        03030000
030400         '  DMM: '.                                               03040000
030500     05  PRT-DMM                      PIC X(02).                  03050000
030600     05  FILLER                       PIC X(02)      VALUE SPACES.03060000
030700     05  PRT-DMM-NAME                 PIC X(32).                  03070000
030800     05  FILLER                       PIC X(48)      VALUE SPACES.03080000
030900*                                                                 03090000
031000 01  HL-HEADING-LINE3.                                            03100000
031100     05  FILLER                       PIC X(02)      VALUE SPACES.03110000
031200     05  FILLER                       PIC X(16)      VALUE        03120000
031300         'REFERENCE NUMBER'.                                      03130000
031400     05  FILLER                       PIC X(08)      VALUE SPACE. 03140000
031500     05  FILLER                       PIC X(11)      VALUE        03150000
031600         'VENDOR NAME'.                                           03160000
031700     05  FILLER                       PIC X(12)      VALUE SPACE. 03170000
031800     05  FILLER                       PIC X(09)      VALUE        03180000
031900         '  SYSID  '.                                             03190000
032000     05  FILLER                       PIC X(06)      VALUE SPACE. 03200000
032100     05  FILLER                       PIC X(07)      VALUE        03210000
032200         'CREATED'.                                               03220000
032300     05  FILLER                       PIC X(06)      VALUE SPACE. 03230000
032400     05  FILLER                       PIC X(08)      VALUE        03240000
032500         '  SKUS  '.                                              03250000
032600     05  FILLER                       PIC X(04)      VALUE SPACE. 03260000
032700     05  FILLER                       PIC X(09)      VALUE        03270000
032800         'ORDER QTY'.                                             03280000
032900     05  FILLER                       PIC X(05)      VALUE SPACE. 03290000
033000     05  FILLER                       PIC X(10)      VALUE        03300000
033100         'TOTAL COST'.                                            03310000
033200     05  FILLER                       PIC X(03)      VALUE SPACE. 03320000
033300     05  FILLER                       PIC X(12)      VALUE        03330000
033400         'TOTAL RETAIL'.                                          03340000
033500     05  FILLER                       PIC X(04)      VALUE SPACE. 03350000
033600*                                                                 03360000
033700 01  DETAIL-LINE.                                                 03370000
033800     05  FILLER                       PIC X(02)      VALUE SPACES.03380000
033900     05  PRT-REF-NBR                  PIC X(15).                  03390000
034000     05  FILLER                       PIC X(05)      VALUE SPACE. 03400000
034100     05  PRT-VENDOR-NAME              PIC X(25).                  03410000
034200     05  FILLER                       PIC X(05)      VALUE SPACE. 03420000
034300     05  PRT-SYSID                    PIC X(02).                  03430000
034400     05  FILLER                       PIC X(10)      VALUE SPACE. 03440000
034500     05  PRT-CREATED                  PIC X(10).                  03450000
034600     05  FILLER                       PIC X(03)      VALUE SPACE. 03460000
034700     05  PRT-LINES                    PIC ZZ,ZZ9.                 03470000
034800     05  FILLER                       PIC X(05)      VALUE SPACE. 03480000
034900     05  PRT-TOTAL-QTY                PIC ZZ,ZZZ,ZZ9.             03490000
035000     05  FILLER                       PIC X(02)      VALUE SPACE. 03500000
035100     05  PRT-TOTAL-COST               PIC ZZ,ZZZ,ZZ9.99.          03510000
035200     05  FILLER                       PIC X(01)      VALUE SPACE. 03520000
035300     05  PRT-TOTAL-RETAIL             PIC ZZZ,ZZZ,ZZ9.99.         03530000
035400     05  FILLER                       PIC X(04)      VALUE SPACE. 03540000
035500*                                                                 03550000
035600 01  DETAIL-END.                                                  03560000
035700     05  FILLER                       PIC X(20)      VALUE        03570000
035800         '** END OF REPORT ** '.                                  03580000
035900*                                                                 03590000
036000 01  HL-TOTAL-LINE1.                                              03600000
036100     05  FILLER                       PIC X(31)      VALUE        03610000
036200         'TOTAL OF DIVISION NOT SUBMITTED'.                       03620000
036300     05  FILLER                       PIC X(43)      VALUE SPACE. 03630000
036400     05  TOT1-ORDER-LINES             PIC Z,ZZZ,ZZ9.              03640000
036500     05  FILLER                       PIC X(05)      VALUE SPACE. 03650000
036600     05  TOT1-TOTORD-QTY              PIC ZZ,ZZZ,ZZ9.             03660000
036700     05  FILLER                       PIC X(02)      VALUE SPACE. 03670000
036800     05  TOT1-TOTCOST                 PIC ZZ,ZZZ,ZZZ.99.          03680000
036900     05  FILLER                       PIC X(01)      VALUE SPACE. 03690000
037000     05  TOT1-TOTRETAIL               PIC ZZZ,ZZZ,ZZZ.99.         03700000
037100     05  FILLER                       PIC X(04)      VALUE SPACE. 03710000
037200*                                                                 03720000
037300 01  HL-TOTAL-LINE2.                                              03730000
037400     05  FILLER                       PIC X(30)      VALUE        03740000
037500         'TOTAL OF GMM NOT SUBMITTED   '.                         03750000
037600     05  FILLER                       PIC X(44)      VALUE SPACE. 03760000
037700     05  TOT2-ORDER-LINES             PIC Z,ZZZ,ZZ9.              03770000
037800     05  FILLER                       PIC X(05)      VALUE SPACE. 03780000
037900     05  TOT2-TOTORD-QTY              PIC ZZ,ZZZ,ZZ9.             03790000
038000     05  FILLER                       PIC X(02)      VALUE SPACE. 03800000
038100     05  TOT2-TOTCOST                 PIC ZZ,ZZZ,ZZZ.99.          03810000
038200     05  FILLER                       PIC X(01)      VALUE SPACE. 03820000
038300     05  TOT2-TOTRETAIL               PIC ZZZ,ZZZ,ZZZ.99.         03830000
038400     05  FILLER                       PIC X(04)      VALUE SPACE. 03840000
038500*                                                                 03850000
038600 01  PC-PROGRAM-CONSTANTS.                                        03860000
038700     05  PC-PROGRAM-NAME                 PIC X(08)   VALUE        03870000
038800                                                     'MRKRP023'.  03880000
038900     05  PC-OP-CO-NMBR                   PIC X(02)   VALUE '03'.  03890000
039000     05  PC-LEVEL-DPT                    PIC  X(3)   VALUE 'DPT'. 03900000
039100     05  PC-TYPES.                                                03910000
039200         10 PC-BUYER                     PIC X(03)   VALUE 'BYR'. 03920000
039300         10 PC-DMM                       PIC X(03)   VALUE 'DMM'. 03930000
039400         10 PC-GMM                       PIC X(03)   VALUE 'GMM'. 03940000
039500         10 PC-DMA                       PIC X(03)   VALUE 'DMA'. 03950000
039600         10 PC-GMA                       PIC X(03)   VALUE 'GMA'. 03960000
039700     05  PC-SPACE                        PIC  X(1)   VALUE SPACE. 03970000
039800     05  PC-MAX-LINES                 PIC S9(3)      VALUE +52    03980000
039900                                                     COMP-3.      03990000
040000*                                                                 04000000
040100 01  PS-PROGRAM-SWITCHES.                                         04010000
040200     05  PS-END-OF-LOGON-FILE-SW      PIC X(01)      VALUE 'N'.   04020001
040300         88  PS-END-OF-LOGON-FILE                    VALUE 'Y'.   04030001
040400     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(01)      VALUE 'N'.   04040001
040500         88  PS-ORA-SRC-EMPTY                        VALUE 'Y'.   04050001
040600     05  PS-RECORDS-SW                PIC X(01)      VALUE 'N'.   04060000
040700         88  PS-END-OF-RECORDS                       VALUE 'Y'.   04070000
040800         88  PS-FIRST-RECORD                         VALUE 'F'.   04080000
040900     05  PS-GMA-DMA-TOTAL-SW          PIC X(01)      VALUE 'N'.   04090000
041000         88  PS-GMA-DMA-TOTAL                        VALUE 'Y'.   04100000
041100         88  PS-NOT-GMA-DMA-TOTAL                    VALUE 'N'.   04110000
041200     05  PS-EXCLUDED-REC-SW           PIC X(01)      VALUE 'N'.   04120000
041300         88  PS-NOT-EXCLUDED                         VALUE 'Y'.   04130000
041400         88  PS-EXCLUDED                             VALUE 'N'.   04140000
041500                                                                  04150001
041600                                                                  04160001
041700 01  CC-ORACLE-CONNECTION.                                        04170001
041800     05  CC-ORACLE-USERID             PIC X(40).                  04180001
041900         88 CC-AUTO-LOGON                            VALUE '/'.   04190001
042000     05  CC-ORACLE-PASSWORD           PIC X(40).                  04200001
042100                                                                  04210001
042200******************************************************************04220000
042300*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        04230000
042400******************************************************************04240000
042500     COPY DPWS004.                                                04250000
042600****************************************************************  04260000
042700**ORACLE DECLARE SECTION                                          04270000
042800****************************************************************  04280000
042900     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     04290000
043000                                                                  04300000
043100 01  USERNAME                    PIC  X(10)  VARYING.             04310000
043200 01  PASSWD                      PIC  X(10)  VARYING.             04320000
043300 01  PV-ORACLE-ID                PIC  X(01)  VALUE '/'.           04330000
043400 01  PV-SUM-ORD-NULL             PIC S9(04)   COMP VALUE 0.       04340000
043500 01  PV-SUM-RTL-NULL             PIC S9(04)   COMP VALUE 0.       04350000
043600 01  PV-SUM-COST-NULL            PIC S9(04)   COMP VALUE 0.       04360000
043700                                                                  04370000
043800******************************************************************04380000
043900* COBOL DECLARATION FOR TABLE SGT_STG_PO                          04390000
044000******************************************************************04400000
044100     EXEC SQL                                                     04410000
044200         INCLUDE SGT00001                                         04420000
044300     END-EXEC.                                                    04430000
044400******************************************************************04440000
044500* COBOL DECLARATION FOR TABLE SGT_STG_RPLNT_PO                    04450000
044600******************************************************************04460000
044700     EXEC SQL                                                     04470000
044800         INCLUDE SGT00002                                         04480000
044900     END-EXEC.                                                    04490000
045000******************************************************************04500000
045100* COBOL DECLARATION FOR TABLE SGT_STG_PO_SKU                      04510000
045200******************************************************************04520000
045300     EXEC SQL                                                     04530000
045400         INCLUDE SGT00003                                         04540000
045500     END-EXEC.                                                    04550000
045600******************************************************************04560000
045700* COBOL DECLARATION FOR TABLE SGT_STG_AUD                         04570000
045800******************************************************************04580000
045900     EXEC SQL                                                     04590000
046000         INCLUDE SGT00005                                         04600000
046100     END-EXEC.                                                    04610000
046200******************************************************************04620000
046300* COBOL DECLARATION FOR TABLE TMDSEAR                             04630000
046400******************************************************************04640000
046500     EXEC SQL                                                     04650000
046600         INCLUDE TMDSEAR                                          04660000
046700     END-EXEC.                                                    04670000
046800                                                                  04680000
046900******************************************************************04690000
047000* COBOL DECLARATION FOR TABLE TRSPBAR                             04700000
047100******************************************************************04710000
047200     EXEC SQL                                                     04720000
047300         INCLUDE TRSPBAR                                          04730000
047400     END-EXEC.                                                    04740000
047500******************************************************************04750000
047600* COBOL DECLARATION FOR TABLE XMT_VND                             04760000
047700******************************************************************04770000
047800 01  XMTVND.                                                      04780000
047900     05 XMTVND-ENT-ID                 PIC   S9(9) COMP.           04790000
048000     05 XMTVND-PRIM-VND-NM            PIC   X(30).                04800000
048100     05 XMTVND-VND-NBR                PIC   X(9).                 04810000
048200     05 XMTVND-STAT-CDE               PIC   X(1).                 04820000
048300     05 XMTVND-VND-CRE-TMST           PIC   X(26).                04830000
048400     05 XMTVND-VND-LAST-UPD-TMST      PIC   X(26).                04840000
048500                                                                  04850000
048600     EXEC SQL END DECLARE SECTION END-EXEC.                       04860000
048700     EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       04870000
048800                                                                  04880000
048900******************************************************************04890000
049000*  ERROR PROCESSING VARIABLES                                     04900000
049100******************************************************************04910000
049200                                                                  04920000
049300 01  ABEND-CODE                          PIC S9(04)  VALUE +0     04930000
049400                                                     COMP SYNC.   04940000
049500*                                                                 04950000
049600****************************************************************  04960000
049700 PROCEDURE DIVISION.                                              04970000
049800****************************************************************  04980000
049900* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  04990000
050000* PROGRAM.                                                     *  05000000
050100****************************************************************  05010000
050200 0000-PROGRAM-MAINLINE.                                           05020000
050300                                                                  05030000
050400     PERFORM 1000-PREPROCESSOR.                                   05040000
050500                                                                  05050000
050600     IF PS-END-OF-RECORDS                                         05060000
050700        WRITE PRINT-LINE FROM EMPTY-REPORT-LINE                   05070000
050800              AFTER ADVANCING 2                                   05080000
050900        PERFORM 1400-CLOSE-CURSOR                                 05090000
051000        CLOSE DATE-CONTROL-CARD-FILE                              05100000
051100              SYS-ID1-CONTROL-CARD-FILE                           05110000
051200              SYS-ID2-CONTROL-CARD-FILE                           05120000
051300              SYS-ID3-CONTROL-CARD-FILE                           05130000
051400              SYS-ID4-CONTROL-CARD-FILE                           05140000
051500              SYS-ID5-CONTROL-CARD-FILE                           05150000
051600              SYS-ID6-CONTROL-CARD-FILE                           05160000
051700              SYS-ID7-CONTROL-CARD-FILE                           05170000
051800              PRINT-REPORT                                        05180000
051900     ELSE                                                         05190000
052000        PERFORM 2000-PROCESS-CURSOR                               05200000
052100          UNTIL PS-END-OF-RECORDS                                 05210000
052200        PERFORM 1900-EOF-PROCESSING                               05220000
052300     END-IF.                                                      05230000
052400                                                                  05240000
052500     STOP RUN.                                                    05250000
052600                                                                  05260000
052700****************************************************************  05270000
052800* 1000-PREPROCESSOR OPENS ALL FILES ASSOCIATED WITH THE JOB,   *  05280000
052900* READS THE DATE CONTROL CARD FILE AND LOGS INTO THE ORACLE    *  05290000
053000* DATABASE.                                                    *  05300000
053100****************************************************************  05310000
053200 1000-PREPROCESSOR.                                               05320000
053300                                                                  05330000
053400     DISPLAY '** START OF MRKRP023 **'.                           05340000
053500     OPEN INPUT  DATE-CONTROL-CARD-FILE                           05350000
053600                 SYS-ID1-CONTROL-CARD-FILE                        05360000
053700                 SYS-ID2-CONTROL-CARD-FILE                        05370000
053800                 SYS-ID3-CONTROL-CARD-FILE                        05380000
053900                 SYS-ID4-CONTROL-CARD-FILE                        05390000
054000                 SYS-ID5-CONTROL-CARD-FILE                        05400000
054100                 SYS-ID6-CONTROL-CARD-FILE                        05410000
054200                 SYS-ID7-CONTROL-CARD-FILE                        05420000
054300                 DEPT-ID-CARD-FILE.                               05430000
054400     OPEN OUTPUT PRINT-REPORT.                                    05440000
054500                                                                  05450000
054600     INITIALIZE PV-PROGRAM-VARIABLES.                             05460000
054700     INITIALIZE PV-TOTAL-VARIABLES.                               05470000
054800     MOVE 'N' TO PS-RECORDS-SW.                                   05480000
054900     MOVE SPACES TO PV-HOLD-GMA                                   05490000
055000                    PV-HOLD-DMA.                                  05500000
055100                                                                  05510000
055200     ACCEPT PV-YYMMDD-DATE FROM DATE.                             05520000
055300     MOVE PV-YYMMDD-YY          TO PV-YEAR-YY.                    05530000
055400                                                                  05540000
055500     IF PV-YYMMDD-YY > 80                                         05550000
055600        MOVE 19 TO PV-YEAR-CC                                     05560000
055700     ELSE                                                         05570000
055800        MOVE 20 TO PV-YEAR-CC                                     05580000
055900     END-IF.                                                      05590000
056000                                                                  05600000
056100     MOVE PV-YEAR               TO DP132-RUN-YEAR.                05610000
056200     MOVE PV-YYMMDD-MM          TO DP132-RUN-MONTH.               05620000
056300     MOVE PV-YYMMDD-DD          TO DP132-RUN-DAY.                 05630000
056400                                                                  05640000
056500     ACCEPT PV-TIME-HHMMSS FROM TIME.                             05650000
056600     MOVE PV-TIME-HHMMSS-HH     TO DP132-RUN-HOUR.                05660000
056700     MOVE PV-TIME-HHMMSS-MM     TO DP132-RUN-MINUTE.              05670000
056800                                                                  05680000
056900     MOVE 1                           TO DP132-REPORT-NUMBER.     05690000
057000     MOVE 'MRKRP023'                  TO DP132-PROGRAM-NAME.      05700000
057100                                                                  05710000
057200                                                                  05720000
057300     SET PS-NOT-GMA-DMA-TOTAL TO TRUE.                            05730000
057400                                                                  05740000
057500     PERFORM 1050-PROCESS-CONTROL-CARD.                           05750000
057600                                                                  05760000
057700     PERFORM 9000-ORACLE-SETUP.                                   05770000
057800                                                                  05780000
057900     PERFORM 1200-DECLARE-OPEN-CURSOR.                            05790000
058000                                                                  05800000
058100     PERFORM 2500-FETCH-CURSOR                                    05810000
058200         UNTIL (PS-NOT-EXCLUDED                                   05820000
058300             OR PS-END-OF-RECORDS).                               05830000
058400                                                                  05840000
058500     SET PS-EXCLUDED TO TRUE.                                     05850000
058600                                                                  05860000
058700     PERFORM 3000-REPORT-HEADINGS.                                05870000
058800                                                                  05880000
058900     MOVE PV-GMA-NBR      TO PV-HOLD-GMA.                         05890000
059000     MOVE PV-DMA-NBR      TO PV-HOLD-DMA.                         05900000
059100                                                                  05910000
059200     IF PS-END-OF-RECORDS                                         05920000
059300        CONTINUE                                                  05930000
059400     ELSE                                                         05940000
059500        PERFORM 2600-PROCESS-DETAIL                               05950000
059600     END-IF.                                                      05960000
059700                                                                  05970000
059800****************************************************************  05980000
059900* VALIDATE THE CONTROL CARD DATE                                  05990000
060000****************************************************************  06000000
060100 1050-PROCESS-CONTROL-CARD.                                       06010000
060200                                                                  06020000
060300     READ DATE-CONTROL-CARD-FILE INTO CC-DATE-CONTROL-CARD        06030000
060400         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         06040000
060500                DISPLAY '** DATE-CONTROL-CARD-FILE EMPTY'         06050000
060600                MOVE +4003 TO ABEND-CODE                          06060000
060700                CALL 'ILBOABN0' USING ABEND-CODE.                 06070000
060800                                                                  06080000
060900     DISPLAY SPACES.                                              06090000
061000     DISPLAY '** MRKRP023 CONTROL-CARD: ' CC-DATE.                06100000
061100                                                                  06110000
061200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06120000
061300     SET DPG51-FISCAL-JAN-DEC-F2                                  06130000
061400         DPG51-DO-NOT-INCR-DECR-DATE                              06140000
061500         DPG52-LK-DTE-ISO-FMT        TO TRUE.                     06150000
061600     MOVE CC-DATE TO DPG52-LK-DATE-INPUT                          06160000
061700                                                                  06170000
061800     CALL DP500-KOHLS-CALENDAR-ROUTINE                            06180000
061900         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               06190000
062000                                                                  06200000
062100     IF DPG54-DATE-INVALID                                        06210000
062200         DISPLAY '** ABEND ** IN MRKRP023'                        06220000
062300         DISPLAY '** PARAGRAPH: 1050-PROCESS-CONTROL-CARD.'       06230000
062400         DISPLAY '** INVALID PROCESS DATE ON CONTROL CARD.'       06240000
062500         DISPLAY '** CALENDAR ROUTINE ERROR MESSAGE = '           06250000
062600                     DPG54-ERROR-MESSAGE                          06260000
062700         DISPLAY '** DPG51 = ' DPG51                              06270000
062800         DISPLAY '** DPG52 = ' DPG52                              06280000
062900         DISPLAY '** DPG53 = ' DPG53                              06290000
063000         DISPLAY '** DPG54 = ' DPG54                              06300000
063100         DISPLAY '** DPG55 = ' DPG55                              06310000
063200         DISPLAY '** DPG56 = ' DPG56                              06320000
063300         MOVE +4003 TO ABEND-CODE                                 06330000
063400         CALL 'ILBOABN0' USING ABEND-CODE                         06340000
063500     ELSE                                                         06350000
063600         IF DPG54-SEVERE-ERROR                                    06360000
063700             DISPLAY '** ABEND ** IN MRKRP023'                    06370000
063800             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.'   06380000
063900             DISPLAY '** CALLED BY 1050-PROCESS-CONTROL-CARD.'    06390000
064000             DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE    06400000
064100             DISPLAY '** DPG51 = ' DPG51                          06410000
064200             DISPLAY '** DPG52 = ' DPG52                          06420000
064300             DISPLAY '** DPG53 = ' DPG53                          06430000
064400             DISPLAY '** DPG54 = ' DPG54                          06440000
064500             DISPLAY '** DPG55 = ' DPG55                          06450000
064600             DISPLAY '** DPG56 = ' DPG56                          06460000
064700             MOVE +4003 TO ABEND-CODE                             06470000
064800             CALL 'ILBOABN0' USING ABEND-CODE                     06480000
064900         ELSE                                                     06490000
065000             IF DPG54-WARNING-ERROR                               06500000
065100                 DISPLAY                                          06510000
065200                       '** WARNING RETURNED BY CALENDAR ROUTINE.' 06520000
065300                 DISPLAY                                          06530000
065400                       '** CALLED BY 1050-PROCESS-CONTROL-CARD.'  06540000
065500                 DISPLAY                                          06550000
065600                       '** WARNING MESSAGE = ' DPG54-ERROR-MESSAGE06560000
065700             END-IF                                               06570000
065800         END-IF                                                   06580000
065900     END-IF.                                                      06590000
066000                                                                  06600000
066100     MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO  PV-BOW-DATE.              06610000
066200     MOVE PV-BOW-DATE-FMT           TO  PV-ORACLE-BOW-DATE.       06620000
066300                                                                  06630000
066400     DISPLAY SPACES.                                              06640000
066500     DISPLAY '** BEGIN OF WEEK DATE: ' PV-BOW-DATE.               06650000
066600                                                                  06660000
066700     READ SYS-ID1-CONTROL-CARD-FILE INTO CC-SYS-ID1               06670000
066800         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         06680000
066900                DISPLAY '** SYS-ID1-CONTROL-CARD-FILE EMPTY'      06690000
067000                MOVE +4003 TO ABEND-CODE                          06700000
067100                CALL 'ILBOABN0' USING ABEND-CODE.                 06710000
067200                                                                  06720000
067300     DISPLAY SPACES.                                              06730000
067400     DISPLAY '** MRKRP023 SYSTEM-ID 1 : ' CC-SYS-ID1.             06740000
067500                                                                  06750000
067600     READ SYS-ID2-CONTROL-CARD-FILE INTO CC-SYS-ID2               06760000
067700         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         06770000
067800                DISPLAY '** SYS-ID2-CONTROL-CARD-FILE EMPTY'      06780000
067900                MOVE +4003 TO ABEND-CODE                          06790000
068000                CALL 'ILBOABN0' USING ABEND-CODE.                 06800000
068100                                                                  06810000
068200     DISPLAY SPACES.                                              06820000
068300     DISPLAY '** MRKRP023 SYSTEM-ID 2 : ' CC-SYS-ID2.             06830000
068400                                                                  06840000
068500     READ SYS-ID3-CONTROL-CARD-FILE INTO CC-SYS-ID3               06850000
068600         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         06860000
068700                DISPLAY '** SYS-ID1-CONTROL-CARD-FILE EMPTY'      06870000
068800                MOVE +4003 TO ABEND-CODE                          06880000
068900                CALL 'ILBOABN0' USING ABEND-CODE.                 06890000
069000                                                                  06900000
069100     DISPLAY SPACES.                                              06910000
069200     DISPLAY '** MRKRP023 SYSTEM-ID 3 : ' CC-SYS-ID3.             06920000
069300                                                                  06930000
069400     READ SYS-ID4-CONTROL-CARD-FILE INTO CC-SYS-ID4               06940000
069500         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         06950000
069600                DISPLAY '** SYS-ID4-CONTROL-CARD-FILE EMPTY'      06960000
069700                MOVE +4003 TO ABEND-CODE                          06970000
069800                CALL 'ILBOABN0' USING ABEND-CODE.                 06980000
069900                                                                  06990000
070000     DISPLAY SPACES.                                              07000000
070100     DISPLAY '** MRKRP023 SYSTEM-ID 4 : ' CC-SYS-ID4.             07010000
070200                                                                  07020000
070300     READ SYS-ID5-CONTROL-CARD-FILE INTO CC-SYS-ID5               07030000
070400         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         07040000
070500                DISPLAY '** SYS-ID5-CONTROL-CARD-FILE EMPTY'      07050000
070600                MOVE +4003 TO ABEND-CODE                          07060000
070700                CALL 'ILBOABN0' USING ABEND-CODE.                 07070000
070800                                                                  07080000
070900     DISPLAY SPACES.                                              07090000
071000     DISPLAY '** MRKRP023 SYSTEM-ID 5 : ' CC-SYS-ID5.             07100000
071100                                                                  07110000
071200     READ SYS-ID6-CONTROL-CARD-FILE INTO CC-SYS-ID6               07120000
071300         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         07130000
071400                DISPLAY '** SYS-ID6-CONTROL-CARD-FILE EMPTY'      07140000
071500                MOVE +4003 TO ABEND-CODE                          07150000
071600                CALL 'ILBOABN0' USING ABEND-CODE.                 07160000
071700                                                                  07170000
071800     DISPLAY SPACES.                                              07180000
071900     DISPLAY '** MRKRP023 SYSTEM-ID 6 : ' CC-SYS-ID6.             07190000
072000                                                                  07200000
072100     READ SYS-ID7-CONTROL-CARD-FILE INTO CC-SYS-ID7               07210000
072200         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP023'         07220000
072300                DISPLAY '** SYS-ID7-CONTROL-CARD-FILE EMPTY'      07230000
072400                MOVE +4003 TO ABEND-CODE                          07240000
072500                CALL 'ILBOABN0' USING ABEND-CODE.                 07250000
072600                                                                  07260000
072700     DISPLAY SPACES.                                              07270000
072800     DISPLAY '** MRKRP023 SYSTEM-ID 7 : ' CC-SYS-ID7.             07280000
072900                                                                  07290000
073000     READ DEPT-ID-CARD-FILE INTO CC-DEPT-RECORD                   07300000
073100         AT END DISPLAY '** NO EXCLUDED DEPARTMENTS'.             07310000
073200                                                                  07320000
073300     DISPLAY SPACES.                                              07330000
073400     DISPLAY '** MRKRP140 DEPT-ID1   : ' CC-DEPT-ID1.             07340000
073500     DISPLAY SPACES.                                              07350000
073600     DISPLAY '** MRKRP140 DEPT-ID2   : ' CC-DEPT-ID2.             07360000
073700     DISPLAY SPACES.                                              07370000
073800     DISPLAY '** MRKRP140 DEPT-ID3   : ' CC-DEPT-ID3.             07380000
073900     DISPLAY SPACES.                                              07390000
074000     DISPLAY '** MRKRP140 DEPT-ID4   : ' CC-DEPT-ID4.             07400000
074100     DISPLAY SPACES.                                              07410000
074200     DISPLAY '** MRKRP140 DEPT-ID5   : ' CC-DEPT-ID5.             07420000
074300                                                                  07430000
074400     MOVE CC-DEPT-ID1  TO  DB-DEPT-ID1.                           07440000
074500     MOVE CC-DEPT-ID2  TO  DB-DEPT-ID2.                           07450000
074600     MOVE CC-DEPT-ID3  TO  DB-DEPT-ID3.                           07460000
074700     MOVE CC-DEPT-ID4  TO  DB-DEPT-ID4.                           07470000
074800     MOVE CC-DEPT-ID5  TO  DB-DEPT-ID5.                           07480000
074900                                                                  07490000
075000****************************************************************  07500000
075100* DECLARES THE SUGGESTED ORDER CURSOR.                         *  07510000
075200* THE FOLLOWING CURSOR WILL SELECT ORDERS IN AN 'A' - ACCEPTED *  07520000
075300* OR 'C' - CREATED STAGING STATUS CODE.                        *  07530000
075400* OPEN THE SUGGESTED ORDER CURSOR.                             *  07540000
075500****************************************************************  07550000
075600 1200-DECLARE-OPEN-CURSOR.                                        07560000
075700                                                                  07570000
075800     EXEC SQL                                                     07580000
075900        DECLARE SUGG_ORD_CSR CURSOR FOR                           07590000
076000           SELECT /*+ ORDERED */ A.STG_PO_ID                      07600000
076100                 ,F.GMA_NBR                                       07610000
076200                 ,F.DMA_NBR                                       07620000
076300                 ,A.SRC_SYS_KY_TXT                                07630000
076400                 ,E.PRIM_VND_NM                                   07640000
076500                 ,D.MR_SYS_CDE                                    07650000
076600                 ,TO_CHAR(D.ORD_RN_DTE,'MM-DD-YYYY')              07660000
076700                 ,F.DEPT_NBR                                      07670000
076800             FROM SGT_STG_AUD A                                   07680000
076900                 ,SGT_STG_PO B                                    07690000
077000                 ,SGT_STG_RPLNT_PO D                              07700000
077100                 ,XMT_VND E                                       07710000
077200                 ,TMDSEAR F                                       07720000
077300            WHERE A.STG_PO_ID = B.STG_PO_ID                       07730000
077400              AND B.STG_PO_ID = D.STG_PO_ID                       07740000
077500              AND B.ENT_ID = E.ENT_ID                             07750000
077600              AND A.STG_ST_CDE IN ('A','C')                       07760000
077700              AND A.CRE_DTE >= TO_DATE(:PV-ORACLE-BOW-DATE,       07770000
077800                                        'YYYY-MM-DD.HH24.MI.SS')  07780000
077900              AND F.OPERCO_NBR = '03'                             07790000
078000              AND F.DEPT_NBR = B.DEPT_NBR                         07800000
078100              AND (D.MR_SYS_CDE = :CC-SYS-ID1                     07810000
078200                OR D.MR_SYS_CDE = :CC-SYS-ID2                     07820000
078300                OR D.MR_SYS_CDE = :CC-SYS-ID3                     07830000
078400                OR D.MR_SYS_CDE = :CC-SYS-ID4                     07840000
078500                OR D.MR_SYS_CDE = :CC-SYS-ID5                     07850000
078600                OR D.MR_SYS_CDE = :CC-SYS-ID6                     07860000
078700                OR D.MR_SYS_CDE = :CC-SYS-ID7)                    07870000
078800              AND F.MDSELV_CDE = :PC-LEVEL-DPT                    07880000
078900              AND SYSDATE < F.END_DTE                             07890000
079000         ORDER BY F.GMA_NBR                                       07900000
079100                 ,F.DMA_NBR                                       07910000
079200                 ,A.SRC_SYS_KY_TXT                                07920000
079300                 ,D.MR_SYS_CDE                                    07930000
079400                 ,D.ORD_RN_DTE                                    07940000
079500                 ,E.PRIM_VND_NM                                   07950000
079600     END-EXEC.                                                    07960000
079700                                                                  07970000
079800     EXEC SQL                                                     07980000
079900         OPEN SUGG_ORD_CSR                                        07990000
080000     END-EXEC.                                                    08000000
080100                                                                  08010000
080200     EVALUATE TRUE                                                08020000
080300         WHEN SQLCODE = ZERO                                      08030000
080400             CONTINUE                                             08040000
080500         WHEN SQLCODE = 1403                                      08050000
080600             SET PS-END-OF-RECORDS TO TRUE                        08060000
080700         WHEN OTHER                                               08070000
080800             MOVE '1200-DECLARE-OPEN-CURSOR'                      08080000
080900                                        TO PV-PARAGRAPH-NAME      08090000
081000             MOVE 'DECLARE/OPEN CSR '   TO PV-OPERATION           08100000
081100             PERFORM 9900-SQL-ERROR                               08110000
081200     END-EVALUATE.                                                08120000
081300****************************************************************  08130000
081400* CLOSE THE SUGGESTED ORDER CURSOR.                            *  08140000
081500****************************************************************  08150000
081600 1400-CLOSE-CURSOR.                                               08160000
081700                                                                  08170000
081800     EXEC SQL                                                     08180000
081900         CLOSE SUGG_ORD_CSR                                       08190000
082000     END-EXEC.                                                    08200000
082100                                                                  08210000
082200     EVALUATE TRUE                                                08220000
082300         WHEN SQLCODE = ZERO                                      08230000
082400             CONTINUE                                             08240000
082500         WHEN OTHER                                               08250000
082600             MOVE '1400-CLOSE-CURSOR'                             08260000
082700                                        TO PV-PARAGRAPH-NAME      08270000
082800             MOVE 'CLOSE SUGG_ORD_CSR'  TO PV-OPERATION           08280000
082900             PERFORM 9900-SQL-ERROR                               08290000
083000     END-EVALUATE.                                                08300000
083100******************************************************************08310000
083200* 1900-EOF-PROCESSING - CLOSES ALL FILES ASSOCIATED WITH THE JOB *08320000
083300******************************************************************08330000
083400                                                                  08340000
083500 1900-EOF-PROCESSING.                                             08350000
083600                                                                  08360000
083700     PERFORM 5000-PRINT-DMM-TOTAL.                                08370000
083800     PERFORM 5100-PRINT-GMM-TOTAL.                                08380000
083900                                                                  08390000
084000     WRITE PRINT-LINE FROM DETAIL-END                             08400000
084100         AFTER ADVANCING 2.                                       08410000
084200                                                                  08420000
084300     PERFORM 1400-CLOSE-CURSOR.                                   08430000
084400                                                                  08440000
084500     CLOSE DATE-CONTROL-CARD-FILE                                 08450000
084600           PRINT-REPORT.                                          08460000
084700                                                                  08470000
084800     DISPLAY SPACES.                                              08480000
084900     DISPLAY '** NUMBER OF ROWS FETCHED: ' PV-CSR-FETCHED-CNT.    08490000
085000     DISPLAY SPACES.                                              08500000
085100     DISPLAY '** NUMBER OF ROWS EXCLUDED:' PV-EX-DEPT-CNT.        08510000
085200     DISPLAY SPACES.                                              08520000
085300     DISPLAY '** NUMBER OF DETAIL LINES WRITTEN: '                08530000
085400                                           PV-DETAIL-LINE-CNT.    08540000
085500     DISPLAY SPACES.                                              08550000
085600     DISPLAY '** END OF MRKRP023   **'.                           08560000
085700                                                                  08570000
085800****************************************************************  08580000
085900* THIS PARAGRAPH WILL PROCESS THE CURSOR TO PRINT THE REPORT.  *  08590000
086000****************************************************************  08600000
086100 2000-PROCESS-CURSOR.                                             08610000
086200                                                                  08620000
086300     PERFORM 2500-FETCH-CURSOR                                    08630000
086400         UNTIL (PS-NOT-EXCLUDED                                   08640000
086500             OR PS-END-OF-RECORDS).                               08650000
086600                                                                  08660000
086700     IF PS-END-OF-RECORDS                                         08670000
086800        CONTINUE                                                  08680000
086900     ELSE                                                         08690000
087000        SET PS-EXCLUDED TO TRUE                                   08700000
087100        PERFORM 2600-PROCESS-DETAIL                               08710000
087200     END-IF.                                                      08720000
087300                                                                  08730000
087400****************************************************************  08740000
087500* THIS PARAGRAPH WILL FETCH THE SUGGESTED ORDER CURSOR VALUES. *  08750000
087600****************************************************************  08760000
087700 2500-FETCH-CURSOR.                                               08770000
087800                                                                  08780000
087900     EXEC SQL                                                     08790000
088000         FETCH SUGG_ORD_CSR                                       08800000
088100          INTO :SGT00005.STG-PO-ID                                08810000
088200              ,:PV-GMA-NBR                                        08820000
088300              ,:PV-DMA-NBR                                        08830000
088400              ,:SGT00005.SRC-SYS-KY-TXT                           08840000
088500              ,:XMTVND-PRIM-VND-NM                                08850000
088600              ,:SGT00002.MR-SYS-CDE                               08860000
088700              ,:PV-ORD-RN-DATE                                    08870000
088800              ,:PV-DEPT-NBR                                       08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089100     EVALUATE TRUE                                                08910000
089200        WHEN SQLCODE = ZERO                                       08920000
089300            ADD +1 TO PV-CSR-FETCHED-CNT                          08930000
089400            EVALUATE TRUE                                         08940000
089500                WHEN MR-SYS-CDE IN SGT00002 = '1A'                08950000
089600                WHEN MR-SYS-CDE IN SGT00002 = '1B'                08960000
089700                WHEN MR-SYS-CDE IN SGT00002 = '1C'                08970000
089800                WHEN MR-SYS-CDE IN SGT00002 = '1D'                08980000
089900                WHEN MR-SYS-CDE IN SGT00002 = '02'                08990000
090000                WHEN ((MR-SYS-CDE IN SGT00002 = '2A')             09000000
090100                    AND ((PV-DEPT-NBR = DB-DEPT-ID1)              09010000
090200                     OR  (PV-DEPT-NBR = DB-DEPT-ID2)              09020000
090300                     OR  (PV-DEPT-NBR = DB-DEPT-ID3)              09030000
090400                     OR  (PV-DEPT-NBR = DB-DEPT-ID4)              09040000
090500                     OR  (PV-DEPT-NBR = DB-DEPT-ID5)))            09050000
090600                         SET PS-NOT-EXCLUDED TO TRUE              09060000
090700                WHEN OTHER                                        09070000
090800                    ADD +1 TO PV-EX-DEPT-CNT                      09080000
090900                    SET PS-EXCLUDED TO TRUE                       09090000
091000            END-EVALUATE                                          09100000
091100        WHEN SQLCODE = 1403                                       09110000
091200             SET PS-END-OF-RECORDS TO TRUE                        09120000
091300        WHEN OTHER                                                09130000
091400             MOVE '2500-FETCH-CURSOR'                             09140000
091500                                        TO PV-PARAGRAPH-NAME      09150000
091600             MOVE 'FETCH SUGG_ORD_CSR'  TO PV-OPERATION           09160000
091700             PERFORM 9900-SQL-ERROR                               09170000
091800     END-EVALUATE.                                                09180000
091900                                                                  09190000
092000****************************************************************  09200000
092100* THIS PARAGRAPH WILL MOVE THE CURSOR VALUES TO THE DETAIL     *  09210000
092200* LINES, CALL THE PARAGRAPHS TO GET THE QUANTITY AND AMOUNT    *  09220000
092300* DETAIL, MOVE THAT DETAIL AND INCREMENT THE TOTAL BUCKETS.    *  09230000
092400****************************************************************  09240000
092500 2600-PROCESS-DETAIL.                                             09250000
092600                                                                  09260000
092700     IF PV-GMA-NBR = PV-HOLD-GMA                                  09270000
092800        IF PV-DMA-NBR = PV-HOLD-DMA                               09280000
092900           PERFORM 3300-GET-PO-VALUES                             09290000
093000           PERFORM 2700-MOVE-ITEM-DETAIL                          09300000
093100           PERFORM 4000-PRINT-ITEM-DETAIL                         09310000
093200        ELSE                                                      09320000
093300           PERFORM 2800-DMA-BREAK                                 09330000
093400           PERFORM 3300-GET-PO-VALUES                             09340000
093500           PERFORM 2700-MOVE-ITEM-DETAIL                          09350000
093600           PERFORM 4000-PRINT-ITEM-DETAIL                         09360000
093700           MOVE PV-DMA-NBR TO PV-HOLD-DMA                         09370000
093800        END-IF                                                    09380000
093900     ELSE                                                         09390000
094000        PERFORM 2900-GMA-BREAK                                    09400000
094100        PERFORM 3300-GET-PO-VALUES                                09410000
094200        PERFORM 2700-MOVE-ITEM-DETAIL                             09420000
094300        PERFORM 4000-PRINT-ITEM-DETAIL                            09430000
094400        MOVE PV-GMA-NBR TO PV-HOLD-GMA                            09440000
094500        MOVE PV-DMA-NBR TO PV-HOLD-DMA                            09450000
094600     END-IF.                                                      09460000
094700                                                                  09470000
094800****************************************************************  09480000
094900* THIS PARAGRAPH WILL MOVE THE CURSOR VALUES TO THE DETAIL     *  09490000
095000* LINES, CALL THE PARAGRAPHS TO GET THE QUANTITY AND AMOUNT    *  09500000
095100* DETAIL, MOVE THAT DETAIL AND INCREMENT THE TOTAL BUCKETS.    *  09510000
095200****************************************************************  09520000
095300 2700-MOVE-ITEM-DETAIL.                                           09530000
095400                                                                  09540000
095500     MOVE SRC-SYS-KY-TXT IN SGT00005    TO PRT-REF-NBR.           09550000
095600     MOVE XMTVND-PRIM-VND-NM            TO PRT-VENDOR-NAME.       09560000
095700     MOVE MR-SYS-CDE IN SGT00002        TO PRT-SYSID.             09570000
095800     MOVE PV-ORD-RN-DATE                TO PRT-CREATED.           09580000
095900     MOVE PV-SKU-CNT                    TO PRT-LINES.             09590000
096000     MOVE PV-ORD-QTY-CNT                TO PRT-TOTAL-QTY.         09600000
096100     MOVE PV-SUM-COST-AMT               TO PRT-TOTAL-COST.        09610000
096200     MOVE PV-SUM-RTL-AMT                TO PRT-TOTAL-RETAIL.      09620000
096300                                                                  09630000
096400     ADD PV-SKU-CNT                     TO PV-TOT1-ORDER-LINES    09640000
096500                                           PV-TOT2-ORDER-LINES.   09650000
096600     ADD PV-ORD-QTY-CNT                 TO PV-TOT1-TOTORDQTY      09660000
096700                                           PV-TOT2-TOTORDQTY.     09670000
096800     ADD PV-SUM-RTL-AMT                 TO PV-TOT1-TOTRETAIL      09680000
096900                                           PV-TOT2-TOTRETAIL.     09690000
097000     ADD PV-SUM-COST-AMT                TO PV-TOT1-TOTCOST        09700000
097100                                           PV-TOT2-TOTCOST.       09710000
097200                                                                  09720000
097300****************************************************************  09730000
097400* PROCESS A CHANGE IN THE DMM NUMBER.                          *  09740000
097500****************************************************************  09750000
097600 2800-DMA-BREAK.                                                  09760000
097700                                                                  09770000
097800     PERFORM 5000-PRINT-DMM-TOTAL.                                09780000
097900     PERFORM 3000-REPORT-HEADINGS.                                09790000
098000                                                                  09800000
098100****************************************************************  09810000
098200* PROCESS A CHANGE IN THE GMM NUMBER.                          *  09820000
098300****************************************************************  09830000
098400 2900-GMA-BREAK.                                                  09840000
098500                                                                  09850000
098600     PERFORM 5000-PRINT-DMM-TOTAL.                                09860000
098700     PERFORM 5100-PRINT-GMM-TOTAL.                                09870000
098800     PERFORM 3000-REPORT-HEADINGS.                                09880000
098900                                                                  09890000
099000****************************************************************  09900000
099100* 3000-REPORT-HEADINGS -      WRITES THE HEADING LINES FOR THE *  09910000
099200* REPORT WHEN THERE IS A CHANGE IN REFERENCE NUMBERS OR WHEN   *  09920000
099300* THE PAGE IS FULL.                                            *  09930000
099400****************************************************************  09940000
099500 3000-REPORT-HEADINGS.                                            09950000
099600*  GET THE GMM,AND DMM NAMES FROM THE DB2 MERCHANDISE AREA TABLES 09960000
099700     IF PS-GMA-DMA-TOTAL                                          09970000
099800        CONTINUE                                                  09980000
099900     ELSE                                                         09990000
100000        PERFORM 3100-GET-GMA-LAST-NAME                            10000000
100100        PERFORM 3200-GET-DMA-LAST-NAME                            10010000
100200     END-IF.                                                      10020000
100300                                                                  10030000
100400     ADD +1                           TO PV-PAGE-CNT              10040000
100500     MOVE PV-PAGE-CNT                 TO DP132-PAGE-NUMBER        10050000
100600     WRITE PRINT-LINE FROM DP132-STANDRD-HEADER-132-COLS          10060000
100700         AFTER ADVANCING PAGE                                     10070000
100800     WRITE PRINT-LINE FROM HL-HEADING-LINE1                       10080000
100900         AFTER ADVANCING 1                                        10090000
101000     WRITE PRINT-LINE FROM HL-HEADING-LINE2                       10100000
101100         AFTER ADVANCING 2                                        10110000
101200     WRITE PRINT-LINE FROM HL-HEADING-LINE3                       10120000
101300         AFTER ADVANCING 2                                        10130000
101400     WRITE PRINT-LINE FROM HL-HEADING-BLANK                       10140000
101500         AFTER ADVANCING 1                                        10150000
101600     MOVE 4                           TO PV-LINE-CNT.             10160000
101700                                                                  10170000
101800****************************************************************  10180000
101900* GET THE GMA'S LAST NAME.                                     *  10190000
102000****************************************************************  10200000
102100 3100-GET-GMA-LAST-NAME.                                          10210000
102200                                                                  10220000
102300     EXEC SQL                                                     10230000
102400           SELECT B.WORKER_LAST_NAME                              10240000
102500             INTO :PV-GMA-NAME                                    10250000
102600             FROM TMDSEAR A                                       10260000
102700                 ,TRSPBAR B                                       10270000
102800            WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                   10280000
102900              AND A.OPERCO_NBR = :PC-OP-CO-NMBR                   10290000
103000              AND A.GMA_NBR = :PV-GMA-NBR                         10300000
103100              AND A.MDSELV_CDE = :PC-GMA                          10310000
103200              AND B.RSPLVL_CDE = :PC-GMM                          10320000
103300              AND SYSDATE < A.END_DTE                             10330000
103400              AND (SYSDATE BETWEEN B.WORKER_STRT_DTE              10340000
103500                               AND B.WORKER_END_DTE)              10350000
103600     END-EXEC.                                                    10360000
103700                                                                  10370000
103800     EVALUATE TRUE                                                10380000
103900         WHEN SQLCODE = ZERO                                      10390000
104000             MOVE PV-GMA-NBR               TO PRT-GMM             10400000
104100             MOVE PV-GMA-NAME              TO PRT-GMM-NAME        10410000
104200         WHEN SQLCODE = 1403                                      10420000
104300             MOVE SPACES                   TO PRT-GMM             10430000
104400             MOVE SPACES                   TO PRT-GMM-NAME        10440000
104500         WHEN OTHER                                               10450000
104600             MOVE '3100-GET-GMA-LAST-NAME'                        10460000
104700                                        TO PV-PARAGRAPH-NAME      10470000
104800             MOVE 'SELECT GMA NAME '    TO PV-OPERATION           10480000
104900             PERFORM 9900-SQL-ERROR                               10490000
105000     END-EVALUATE.                                                10500000
105100                                                                  10510000
105200****************************************************************  10520000
105300* GET THE DMA'S LAST NAME.                                     *  10530000
105400****************************************************************  10540000
105500 3200-GET-DMA-LAST-NAME.                                          10550000
105600                                                                  10560000
105700     EXEC SQL                                                     10570000
105800           SELECT B.WORKER_LAST_NAME                              10580000
105900             INTO :PV-DMA-NAME                                    10590000
106000             FROM TMDSEAR A                                       10600000
106100                 ,TRSPBAR B                                       10610000
106200            WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                   10620000
106300              AND A.OPERCO_NBR = :PC-OP-CO-NMBR                   10630000
106400              AND A.DMA_NBR = :PV-DMA-NBR                         10640000
106500              AND A.MDSELV_CDE = :PC-DMA                          10650000
106600              AND B.RSPLVL_CDE = :PC-DMM                          10660000
106700              AND SYSDATE < A.END_DTE                             10670000
106800              AND (SYSDATE BETWEEN B.WORKER_STRT_DTE              10680000
106900                               AND B.WORKER_END_DTE)              10690000
107000     END-EXEC.                                                    10700000
107100                                                                  10710000
107200     EVALUATE TRUE                                                10720000
107300         WHEN SQLCODE = ZERO                                      10730000
107400             MOVE PV-DMA-NBR               TO PRT-DMM             10740000
107500             MOVE PV-DMA-NAME              TO PRT-DMM-NAME        10750000
107600         WHEN SQLCODE = 1403                                      10760000
107700             MOVE SPACES                   TO PRT-DMM             10770000
107800             MOVE SPACES                   TO PRT-DMM-NAME        10780000
107900         WHEN OTHER                                               10790000
108000             MOVE '3200-GET-DMA-LAST-NAME'                        10800000
108100                                        TO PV-PARAGRAPH-NAME      10810000
108200             MOVE 'SELECT DMA NAME '    TO PV-OPERATION           10820000
108300             PERFORM 9900-SQL-ERROR                               10830000
108400     END-EVALUATE.                                                10840000
108500                                                                  10850000
108600***************************************************************** 10860000
108700* SELECT COUNT OF SKUS ON PURCHASE ORDER, SELECT SUM OF ORDER   * 10870000
108800* QUANITY, SELECT SUM OF UNIT RETAIL AMOUNT AND SELECT SUM OF   * 10880000
108900* UNIT COST AMOUNT.                                             * 10890000
109000***************************************************************** 10900000
109100 3300-GET-PO-VALUES.                                              10910000
109200                                                                  10920000
109300     EXEC SQL                                                     10930000
109400           SELECT COUNT(SKU_NBR)                                  10940000
109500                 ,SUM(ORD_QTY)                                    10950000
109600                 ,SUM(UNT_RTL_AMT * ORD_QTY)                      10960000
109700                 ,SUM(UNT_COST_AMT * ORD_QTY)                     10970000
109800             INTO :PV-SKU-CNT                                     10980000
109900                 ,:PV-ORD-QTY-CNT :PV-SUM-ORD-NULL                10990000
110000                 ,:PV-SUM-RTL-AMT :PV-SUM-RTL-NULL                11000000
110100                 ,:PV-SUM-COST-AMT :PV-SUM-COST-NULL              11010000
110200             FROM SGT_STG_PO_SKU                                  11020000
110300            WHERE STG_PO_ID = :SGT00005.STG-PO-ID                 11030000
110400     END-EXEC.                                                    11040000
110500                                                                  11050000
110600     EVALUATE TRUE                                                11060000
110700         WHEN SQLCODE = ZERO                                      11070000
110800             IF PV-SUM-ORD-NULL = -1                              11080000
110900                MOVE ZERO TO PV-ORD-QTY-CNT                       11090000
111000             END-IF                                               11100000
111100             IF PV-SUM-RTL-NULL = -1                              11110000
111200                MOVE ZERO TO PV-SUM-RTL-AMT                       11120000
111300             END-IF                                               11130000
111400             IF PV-SUM-COST-NULL = -1                             11140000
111500                MOVE ZERO TO PV-SUM-COST-AMT                      11150000
111600             END-IF                                               11160000
111700         WHEN SQLCODE = 1403                                      11170000
111800                MOVE ZERO TO PV-SKU-CNT                           11180000
111900                MOVE ZERO TO PV-ORD-QTY-CNT                       11190000
112000                MOVE ZERO TO PV-SUM-RTL-AMT                       11200000
112100                MOVE ZERO TO PV-SUM-COST-AMT                      11210000
112200         WHEN OTHER                                               11220000
112300             MOVE '3300-GET-PO-VALUES'                            11230000
112400                                        TO PV-PARAGRAPH-NAME      11240000
112500             MOVE 'SELECT PO VALUES'    TO PV-OPERATION           11250000
112600             PERFORM 9900-SQL-ERROR                               11260000
112700     END-EVALUATE.                                                11270000
112800                                                                  11280000
112900***************************************************************** 11290000
113000* WRITE OUT THE DETAIL RECORD                                   * 11300000
113100***************************************************************** 11310000
113200 4000-PRINT-ITEM-DETAIL.                                          11320000
113300                                                                  11330000
113400     IF PV-LINE-CNT > PC-MAX-LINES                                11340000
113500         PERFORM 3000-REPORT-HEADINGS                             11350000
113600     END-IF.                                                      11360000
113700                                                                  11370000
113800     WRITE PRINT-LINE FROM DETAIL-LINE                            11380000
113900        AFTER ADVANCING 1                                         11390000
114000     ADD 1 TO PV-LINE-CNT.                                        11400000
114100     ADD 1 TO PV-DETAIL-LINE-CNT.                                 11410000
114200                                                                  11420000
114300***************************************************************** 11430000
114400* PRINT OUT THE DMM TOTAL LINE.                                 * 11440000
114500***************************************************************** 11450000
114600 5000-PRINT-DMM-TOTAL.                                            11460000
114700                                                                  11470000
114800     SET PS-GMA-DMA-TOTAL TO TRUE.                                11480000
114900                                                                  11490000
115000     MOVE  PV-TOT1-ORDER-LINES   TO TOT1-ORDER-LINES.             11500000
115100     MOVE  PV-TOT1-TOTORDQTY     TO TOT1-TOTORD-QTY.              11510000
115200     MOVE  PV-TOT1-TOTCOST       TO TOT1-TOTCOST.                 11520000
115300     MOVE  PV-TOT1-TOTRETAIL     TO TOT1-TOTRETAIL.               11530000
115400                                                                  11540000
115500     IF PV-LINE-CNT > PC-MAX-LINES                                11550000
115600         PERFORM 3000-REPORT-HEADINGS                             11560000
115700     END-IF.                                                      11570000
115800                                                                  11580000
115900     WRITE PRINT-LINE FROM HL-TOTAL-LINE1                         11590000
116000          AFTER ADVANCING 2                                       11600000
116100     WRITE PRINT-LINE FROM HL-HEADING-BLANK                       11610000
116200          AFTER ADVANCING 1                                       11620000
116300     ADD 3                            TO PV-LINE-CNT.             11630000
116400                                                                  11640000
116500     MOVE  ZEROS                 TO PV-TOT1-ORDER-LINES.          11650000
116600     MOVE  ZEROS                 TO PV-TOT1-TOTORDQTY.            11660000
116700     MOVE  ZEROS                 TO PV-TOT1-TOTCOST.              11670000
116800     MOVE  ZEROS                 TO PV-TOT1-TOTRETAIL.            11680000
116900                                                                  11690000
117000     SET PS-NOT-GMA-DMA-TOTAL TO TRUE.                            11700000
117100                                                                  11710000
117200***************************************************************** 11720000
117300* PRINT OUT THE GMM TOTAL LINE.                                 * 11730000
117400***************************************************************** 11740000
117500 5100-PRINT-GMM-TOTAL.                                            11750000
117600                                                                  11760000
117700     SET PS-GMA-DMA-TOTAL TO TRUE.                                11770000
117800*                                                                 11780000
117900     MOVE  PV-TOT2-ORDER-LINES   TO TOT2-ORDER-LINES.             11790000
118000     MOVE  PV-TOT2-TOTORDQTY     TO TOT2-TOTORD-QTY.              11800000
118100     MOVE  PV-TOT2-TOTCOST       TO TOT2-TOTCOST.                 11810000
118200     MOVE  PV-TOT2-TOTRETAIL     TO TOT2-TOTRETAIL.               11820000
118300                                                                  11830000
118400                                                                  11840000
118500     IF PV-LINE-CNT > PC-MAX-LINES                                11850000
118600         PERFORM 3000-REPORT-HEADINGS                             11860000
118700     END-IF.                                                      11870000
118800                                                                  11880000
118900     WRITE PRINT-LINE FROM HL-TOTAL-LINE2                         11890000
119000          AFTER ADVANCING 2                                       11900000
119100     ADD 2                            TO PV-LINE-CNT.             11910000
119200                                                                  11920000
119300     MOVE  ZEROS                 TO PV-TOT2-ORDER-LINES.          11930000
119400     MOVE  ZEROS                 TO PV-TOT2-TOTORDQTY.            11940000
119500     MOVE  ZEROS                 TO PV-TOT2-TOTCOST.              11950000
119600     MOVE  ZEROS                 TO PV-TOT2-TOTRETAIL.            11960000
119700                                                                  11970000
119800     SET PS-NOT-GMA-DMA-TOTAL TO TRUE.                            11980000
119900                                                                  11990000
120000****************************************************************  12000000
120100* CONNECT TO ORACLE.                                              12010000
120200****************************************************************  12020000
120300 9000-ORACLE-SETUP.                                               12030000
120400                                                                  12040001
120500     OPEN INPUT ORACLE-LOGON-FILE.                                12050001
120600                                                                  12060001
120700     PERFORM 9100-READ-ORACLE-LOGON.                              12070002
120800                                                                  12080001
120900     CLOSE ORACLE-LOGON-FILE.                                     12090001
121000                                                                  12100001
121100     IF ((PS-END-OF-LOGON-FILE)                                   12110001
121200             OR (CC-ORACLE-CONNECTION = SPACES))                  12120001
121300         DISPLAY '** ABEND **'                                    12130001
121400         DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  12140001
121500                   'NOT PROVIDED'                                 12150001
121600         SET PS-ORA-SRC-EMPTY TO TRUE                             12160001
121700         CALL 'ILBOABN0' USING ABEND-CODE                         12170001
121800     END-IF.                                                      12180001
121900                                                                  12190001
122000     IF CC-AUTO-LOGON                                             12200001
122100         DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        12210001
122200         EXEC SQL                                                 12220001
122300              CONNECT :USERNAME                                   12230001
122400         END-EXEC                                                 12240001
122500     ELSE                                                         12250001
122600         INITIALIZE PV-ORACLE-USERID-LEN                          12260001
122700                    PV-ORACLE-PASSWORD-LEN                        12270001
122800         INSPECT CC-ORACLE-USERID                                 12280001
122900             TALLYING PV-ORACLE-USERID-LEN                        12290001
123000          FOR CHARACTERS BEFORE INITIAL SPACE                     12300001
123100      INSPECT CC-ORACLE-PASSWORD                                  12310001
123200          TALLYING PV-ORACLE-PASSWORD-LEN                         12320001
123300          FOR CHARACTERS BEFORE INITIAL SPACE                     12330001
123400      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           12340001
123500                USERNAME-ARR                                      12350001
123600      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   12360001
123700      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       12370001
123800                PASSWD-ARR                                        12380001
123900      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   12390001
124000      DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '       12400001
124100                USERNAME-ARR                                      12410001
124200      EXEC SQL                                                    12420001
124300        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   12430001
124400      END-EXEC                                                    12440001
124500      INITIALIZE CC-ORACLE-PASSWORD                               12450001
124600                 PASSWD                                           12460001
124700      END-IF.                                                     12470001
124800                                                                  12480001
124900     IF (SQLCODE NOT = 0)                                         12490001
125000         MOVE '9000-ORACLE-SETUP' TO PV-PARAGRAPH-NAME            12500001
125100         MOVE 'CONNECT TO ORACLE' TO PV-OPERATION                 12510001
125200         DISPLAY PV-PARAGRAPH-NAME                                12520001
125300         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  12530001
125400         PERFORM 9900-SQL-ERROR                                   12540001
125500     END-IF.                                                      12550001
125600                                                                  12560001
125700     EXEC SQL                                                     12570000
125800      ALTER SESSION                                               12580000
125900          SET NLS_DATE_FORMAT = 'YYYY-MM-DD-HH24.MI.SS'           12590000
126000     END-EXEC.                                                    12600000
126100                                                                  12610000
126200***************************************************************** 12620002
126300*  B120-READ-ORACLE-LOGON.                                      * 12630002
126400* ==> PROCESSES:                                                * 12640002
126500*   - READ ORCALE CONTROL CARD                                  * 12650002
126600* ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 12660002
126700***************************************************************** 12670002
126800 9100-READ-ORACLE-LOGON.                                          12680002
126900                                                                  12690002
127000     READ ORACLE-LOGON-FILE                                       12700002
127100         INTO CC-ORACLE-CONNECTION                                12710002
127200         AT END                                                   12720002
127300             SET PS-END-OF-LOGON-FILE TO TRUE                     12730002
127400     END-READ.                                                    12740002
127500                                                                  12750002
127600******************************************************************12760000
127700*    ABEND ON A SQL ERROR.                                        12770000
127800******************************************************************12780000
127900 9900-SQL-ERROR.                                                  12790000
128000                                                                  12800000
128100     DISPLAY '*** ABEND ***'.                                     12810000
128200     DISPLAY '** MRKRP023 - SQL ERROR'.                           12820000
128300     DISPLAY '** PROGRAM          ** = ' PC-PROGRAM-NAME.         12830000
128400     DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.       12840000
128500     DISPLAY '** OPERATION        ** = ' PV-OPERATION.            12850000
128600                                                                  12860000
128700*    THE FOLLOWING COPYBOOK UTILIZES MODULE DSNTIAR TO FORMAT     12870000
128800*    THE INFO IN SQLCA INTO UNDERSTANDABLE VERBAGE.               12880000
128900     COPY DPPD004.                                                12890000
129000                                                                  12900000
129100     MOVE +4013 TO ABEND-CODE.                                    12910000
129200     CALL 'ILBOABN0' USING ABEND-CODE.                            12920000
129300                                                                  12930000
129400 EJECT                                                            12940000
