000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT980.                                00050000
000600 AUTHOR.                 STEPHANIE HERON.                         00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            FEBRUARY 2004.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL READ THE PO AND RECEIVER NUMBER (OPTIONAL)   00130000
001400*  AND RESET ANY RECEIVERS THAT ARE VERIFIED BACK TO INPROCESS    00140000
001410*  THE FOLLOWING TABLES ARE AFFECTED:                             00141007
001420*                         TRECDIS                                 00142007
001430*                         TRECITM                                 00143007
001440*                         TRECEIV                                 00144007
001441*                         TRECDVS                                 00144107
001442*                         TDISTHD - SETS PRCG_STAT_CDE TO R       00144200
001443***************************************************************** 00144307
001444*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00144407
001445*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00144507
001446*                                                               * 00144607
001447***************************************************************** 00144707
001448***************************************************************** 00144807
001449 ENVIRONMENT DIVISION.                                            00144907
001450***************************************************************** 00145007
001460                                                                  00146007
001470 CONFIGURATION SECTION.                                           00147007
001480                                                                  00148007
001490 SOURCE-COMPUTER.        IBM-3090.                                00149007
001500 OBJECT-COMPUTER.        IBM-3090.                                00150007
001600                                                                  00160007
001700 INPUT-OUTPUT SECTION.                                            00170007
001800                                                                  00180007
001900 FILE-CONTROL.                                                    00190007
002000*                                                                 00200007
002100     SELECT PO-RECEIVER-FILE                                      00210007
002200         ASSIGN TO INP01.                                         00220007
002300                                                                  00230007
002400*                                                                 00240007
002500***************************************************************** 00250007
002600 DATA DIVISION.                                                   00260007
002700***************************************************************** 00270007
002800*                                                                 00280007
002900 FILE SECTION.                                                    00290007
003000*                                                                 00300007
003100 FD  PO-RECEIVER-FILE                                             00310007
003200     LABEL RECORDS ARE STANDARD                                   00320007
003300     RECORDING MODE IS F                                          00330007
003400     BLOCK CONTAINS 0 RECORDS                                     00340007
003500     RECORD CONTAINS 80 CHARACTERS.                               00350007
003600                                                                  00360007
003700 01  PO-RECEIVER-RECORD              PIC X(80).                   00370007
003800*                                                                 00380007
003900                                                                  00390007
004000 WORKING-STORAGE SECTION.                                         00400007
004100*                                                                 00410007
004200 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00420007
004300                                                   COMP SYNC.     00430007
004400*                                                                 00440007
004500 01  PROGRAM-SWITCHES.                                            00450007
004600     05  PS-DATA-IND                 PIC  X(01)  VALUE 'N'.       00460007
004700         88  PS-DATA                             VALUE 'Y'.       00470007
004800         88  PS-NO-DATA                          VALUE 'N'.       00480007
004900     05  PS-END-OF-RECDIS-CSR-SW     PIC  X(01)    VALUE 'N'.     00490007
005000         88  PS-END-OF-RECDIS-CSR                  VALUE 'Y'.     00500007
005100         88  PS-NOT-END-OF-RECDIS-CSR             VALUE 'N'.      00510007
005200     05  PS-END-OF-TRIP-CURSOR-SW  PIC  X(01)      VALUE 'N'.     00520019
006300         88  PS-END-OF-TRIP-CURSOR                 VALUE 'Y'.     00630009
006400         88  PS-NOT-END-OF-TRIP-CURSOR            VALUE 'N'.      00640009
006401     05  PS-END-OF-INPUT-FILE-SW    PIC   X(01)    VALUE 'N'.     00640119
006402         88  PS-END-OF-INPUT-FILE                  VALUE 'Y'.     00640207
006403         88  PS-NOT-END-OF-INPUT-FILE              VALUE 'N'.     00640307
006404     05  PS-END-OF-TABLE-SW         PIC   X(01)    VALUE 'N'.     00640411
006405         88  PS-EOT-DISTDT                         VALUE 'Y'.     00640511
006406         88  PS-NOT-EOT-DISTDT                     VALUE 'N'.     00640611
006407*                                                                 00640707
006408 01  WS-LOCAL-SERVER.                                             00640822
006409     05  WS-SUBSYS                   PIC X(04)  VALUE SPACES.     00640922
006410     05  FILLER                      PIC X(12)  VALUE SPACES.     00641022
006411*                                                                 00641122
006412 01  PC-CONSTANTS.                                                00641207
006413     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00641307
006414     05  PC-1                        PIC S9(03)    VALUE +1       00641407
006415                                                   COMP-3.        00641507
006416     05  PC-13                       PIC S9(03)    VALUE +13      00641607
006417                                                   COMP-3.        00641707
006418     05  PC-90                       PIC S9(04)    COMP           00641822
006419                                                   VALUE 90.      00641922
006420     05  PC-A                        PIC  X(01)    VALUE 'A'.     00642007
006421     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00642107
006430     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   00643007
006500     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00650007
006600         'SUKUT980'.                                              00660007
006610     05  PC-KHL                      PIC  X(03)    VALUE 'KHL'.   00661022
006620     05  PC-PRDCHK                   PIC  X(06)    VALUE 'PRDCHK'.00662022
006630     05  PC-PARM-TEXT                PIC  X(25)    VALUE          00663022
006640         'LOWER LEVEL ONLY         '.                             00664022
006700*                                                                 00670007
006800 01  PV-MISC-FIELDS.                                              00680007
006900     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00690007
007000                                                   COMP SYNC.     00700007
007100     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00710007
007200     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00720007
007300     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00730007
007400     05  PV-TRIP-ID-X                PIC  X(09).                  00740007
007500     05  PV-TRIP-ID REDEFINES PV-TRIP-ID-X                        00750007
007600                                     PIC  9(09).                  00760007
007700     05  PV-WRITE-COUNT              PIC S9(09)    COMP.          00770007
007710     05  PV-PROCESS-COUNTER          PIC S9(09)    COMP.          00771010
007800     05  PV-QTY-RECV                 PIC S9(09)    COMP.          00780007
007900     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP.          00790007
008000     05  PV-HOLD-REC-SEQ-NBR         PIC S9(09)    COMP.          00800007
008100*                                                                 00810007
008200     05  PV-DISPLAY-FIELD            PIC 9(18).                   00820007
008300*                                                                 00830007
008400     05  PV-DEL-UNLO-XREF-OTBND      PIC X(01).                   00840007
008500     05  PV-UPD-TLBVRDA              PIC X(01).                   00850007
008600     05  PV-DEL-TLBVRMG              PIC X(01).                   00860007
008700     05  PV-DEL-TSUNAUD              PIC X(01).                   00870007
008800     05  PV-DEL-TSUATRN              PIC X(01).                   00880007
008900     05  PV-DEL-TSUAUPC              PIC X(01).                   00890007
009000     05  PV-DEL-SUT-PO-AUD-REQ       PIC X(01).                   00900007
009100     05  PV-DISP-SQLD-P2L-128        PIC X(01).                   00910021
009110     05  PV-DISP-SQL                 PIC -999.                    00911021
009200 EJECT                                                            00920007
009300*                                                                 00930007
009400 01  DK-DB-KEYS.                                                  00940007
009500    05  DK-SHIPT-UNT-ID             PIC S9(18) COMP-3.            00950007
009600    05  DK-TRIP-ID                  PIC S9(09) COMP.              00960007
009700    05  DK-PO-NBR                   PIC S9(09) COMP.              00970007
009800    05  DK-RECEIVER                 PIC S9(09) COMP.              00980007
009900    05  DK-AUD-CNTL-NBR             PIC S9(09) COMP.              00990007
010000                                                                  01000007
010100 01  INPUT-RECORD.                                                01010007
010200     05  DR-PO-NBR                   PIC 9(09).                   01020007
010300     05  FILLER                      PIC X(01).                   01030007
010400     05  DR-RECEIVER                 PIC 9(09).                   01040007
010500     05  FILLER                      PIC 9(01).                   01050007
010600     05  DR-TRIP-ID                  PIC 9(09).                   01060019
011200     05  FILLER                      PIC X(01).                   01120007
011300     05  FILLER                      PIC X(01).                   01130007
011400     05  FILLER                      PIC X(01).                   01140007
011500     05  FILLER                      PIC X(07).                   01150007
011600     05  FILLER                      PIC X(41).                   01160007
011700                                                                  01170022
012700******************************************************************01270007
012800*  DB2 FORMATTED MESSAGE AREA                                     01280007
012900******************************************************************01290007
013000     COPY DPWS004.                                                01300007
013100*                                                                 01310007
013200*                                                                 01320007
013300*  COPY BOOK FOR DB2 TABLE                                        01330007
013400*                                                                 01340007
013500     EXEC SQL                                                     01350007
013600          INCLUDE TKRPRPM                                         01360022
013700     END-EXEC.                                                    01370007
013800                                                                  01380007
013801     EXEC SQL                                                     01380122
013802          INCLUDE TRECEIV                                         01380222
013803     END-EXEC.                                                    01380322
013804                                                                  01380422
013805     EXEC SQL                                                     01380522
013806          INCLUDE TVHTRIP                                         01380622
013807     END-EXEC.                                                    01380722
013808                                                                  01380822
013809     EXEC SQL                                                     01380922
013810          INCLUDE TSHIPMT                                         01381022
013811     END-EXEC.                                                    01381122
013812                                                                  01381222
013813     EXEC SQL                                                     01381322
013814          INCLUDE TSHPTPO                                         01381422
013815     END-EXEC.                                                    01381522
013816                                                                  01381622
013900     EXEC SQL                                                     01390007
014000          INCLUDE TDISTHD                                         01400007
014100     END-EXEC.                                                    01410007
014200                                                                  01420007
014210     EXEC SQL                                                     01421008
014220          INCLUDE TDISTDT                                         01422008
014230     END-EXEC.                                                    01423008
014240                                                                  01424008
014300*  COPY BOOK FOR DB2 TABLE                                        01430007
014400*                                                                 01440007
014500     EXEC SQL                                                     01450007
014600          INCLUDE TRECITM                                         01460007
014700     END-EXEC.                                                    01470007
014800                                                                  01480007
014900*  COPY BOOK FOR DB2 TABLE                                        01490007
015000*                                                                 01500007
015100     EXEC SQL                                                     01510007
015200          INCLUDE TRECDIS                                         01520007
015300     END-EXEC.                                                    01530007
015400*  COPY BOOK FOR DB2 TABLE                                        01540007
015500*                                                                 01550007
015600     EXEC SQL                                                     01560007
015700          INCLUDE TRECDVS                                         01570007
015800     END-EXEC.                                                    01580007
015900                                                                  01590007
016000 EJECT                                                            01600007
016100*  DB2 COMMUNICATION AREA                                         01610007
016200*                                                                 01620007
016300     EXEC SQL                                                     01630007
016400         INCLUDE SQLCA                                            01640007
016500     END-EXEC.                                                    01650007
016600 EJECT                                                            01660007
016700*  DB2 COMMUNICATION AREA2                                        01670007
016800*                                                                 01680007
016900     COPY SQLCA2.                                                 01690007
017000 EJECT                                                            01700007
017100                                                                  01710007
023110     EXEC SQL                                                     02311019
023120       DECLARE TRIP-RCVR-CSR   CURSOR WITH HOLD FOR               02312019
023121             SELECT                                               02312119
023122                  C.PO_NBR                                        02312219
023123                , C.REC_SEQ_NBR                                   02312319
023124            FROM  TVHTRIP A                                       02312419
023125                , TSHIPMT B                                       02312519
023126                , TSHPTPO C                                       02312619
023127                , TRECEIV D                                       02312719
023128            WHERE A.TRIP_ID           = :DK-TRIP-ID               02312819
023129              AND A.TRIP_ID           = B.TRIP_ID                 02312919
023130              AND C.SHIPT_ID          = B.SHIPT_ID                02313019
023131              AND C.PO_NBR          = D.ORD_NBR                   02313119
023132              AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR               02313219
023133              AND D.VER_STATUS_CDE  = 'A'                         02313319
023160     END-EXEC.                                                    02316019
023170                                                                  02317019
023171     EXEC SQL                                                     02317119
023172       DECLARE RECDIS-RCVR-CSR CURSOR FOR                         02317207
023173         SELECT REC_SEQ_NBR                                       02317307
023174               ,ORD_LNE_NBR                                       02317407
023175               ,STR_NBR                                           02317507
023176               ,EXPTED_ITM_QTY                                    02317607
023177          FROM  TRECDIS                                           02317707
023178          WHERE ORD_NBR            = :DK-PO-NBR                   02317807
023179            AND REC_SEQ_NBR        = :DK-RECEIVER                 02317907
023180     END-EXEC.                                                    02318007
023181                                                                  02318107
023182     EXEC SQL                                                     02318207
023183       DECLARE RECDIS-PO-CSR CURSOR FOR                           02318307
023184         SELECT REC_SEQ_NBR                                       02318407
023185               ,ORD_LNE_NBR                                       02318507
023186               ,STR_NBR                                           02318607
023187               ,EXPTED_ITM_QTY                                    02318707
023188          FROM  TRECDIS                                           02318807
023189          WHERE ORD_NBR            = :DK-PO-NBR                   02318907
023190     END-EXEC.                                                    02319007
023191*                                                                 02319107
023192     EXEC SQL                                                     02319211
023193       DECLARE DISTDT-RCVR-CSR CURSOR WITH HOLD FOR               02319312
023194         SELECT ORD_NBR                                           02319411
023195               ,ORD_LNE_NBR                                       02319511
023196               ,RCVR_SEQ_NBR                                      02319611
023197          FROM  TDISTDT                                           02319713
023198          WHERE ORD_NBR            = :DK-PO-NBR                   02319811
023199            AND RCVR_SEQ_NBR       = :DK-RECEIVER                 02319911
023200     END-EXEC.                                                    02320011
023201*                                                                 02320111
023202     EXEC SQL                                                     02320211
023203       DECLARE DISTDT-PO-CSR CURSOR FOR                           02320311
023204         SELECT ORD_NBR                                           02320411
023205               ,ORD_LNE_NBR                                       02320511
023206               ,RCVR_SEQ_NBR                                      02320611
023207          FROM  TDISTDT                                           02320713
023208          WHERE ORD_NBR            = :DK-PO-NBR                   02320811
023209            AND RCVR_SEQ_NBR       = :DK-RECEIVER                 02320911
023210     END-EXEC.                                                    02321011
023211*                                                                 02321111
023212*                                                                 02321211
023213 PROCEDURE DIVISION.                                              02321307
023214*                                                                 02321407
023215 0000-MAINLINE-PROCESSING.                                        02321507
023216******************************************************************02321607
023217**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      02321707
023218******************************************************************02321807
023219*                                                                 02321907
023220     PERFORM 1000-INITIALIZATION.                                 02322007
023221*                                                                 02322107
023222     IF PS-NOT-END-OF-INPUT-FILE                                  02322207
023223         PERFORM 2000-PROCESS-CARTON                              02322307
023224            UNTIL PS-END-OF-INPUT-FILE                            02322407
023225     END-IF.                                                      02322507
023226     PERFORM 9000-EOJ-ROUTINE.                                    02322607
023227*                                                                 02322707
023228     GOBACK.                                                      02322807
023229*                                                                 02322907
023230*                                                                 02323007
023231 1000-INITIALIZATION.                                             02323107
023232******************************************************************02323207
023233**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               02323307
023234******************************************************************02323407
023235                                                                  02323507
023237     PERFORM 1100-GET-DB2-INSTANCE.                               02323722
023238     PERFORM 1200-CHECK-IF-PRODUCTION.                            02323822
023239                                                                  02323922
023240     OPEN INPUT  PO-RECEIVER-FILE                                 02324007
023241                                                                  02324107
023242     PERFORM 7000-READ-INPUT-FILE.                                02324207
023244                                                                  02324407
023245                                                                  02324507
023246 1100-GET-DB2-INSTANCE.                                           02324622
023247                                                                  02324722
023248     MOVE '1100-GET-DB2-INSTANCE'                                 02324822
023249          TO PV-PARAGRAPH-NAME.                                   02324922
023250     MOVE 'GET DB2 INSTANCE'                                      02325022
023251          TO PV-DB2-OPERATION-ATTEMPTED.                          02325122
023252                                                                  02325222
023253     EXEC SQL                                                     02325322
023254         SELECT CURRENT SERVER INTO :WS-LOCAL-SERVER              02325422
023255             FROM SYSIBM.SYSDUMMY1 WITH UR                        02325522
023256     END-EXEC.                                                    02325622
023257                                                                  02325722
023258     EVALUATE TRUE                                                02325822
023259         WHEN SQLCODE = +0                                        02325922
023260             CONTINUE                                             02326022
023261         WHEN SQLWARN0 NOT = SPACES                               02326122
023262         WHEN SQLCODE < +0                                        02326222
023263         WHEN SQLCODE > +0                                        02326322
023264             PERFORM 9100-SQL-ABEND                               02326422
023265     END-EVALUATE.                                                02326522
023266*                                                                 02326622
023267 1200-CHECK-IF-PRODUCTION.                                        02326722
023268                                                                  02326822
023269     MOVE '1200-CHECK-IF-PRODUCTION'                              02326922
023270          TO PV-PARAGRAPH-NAME.                                   02327022
023271     MOVE 'SELECT PRDCHK TKRPRPM '                                02327122
023272          TO PV-DB2-OPERATION-ATTEMPTED.                          02327222
023273                                                                  02327322
023274     EXEC SQL                                                     02327422
023275       SELECT FUNC_TXT                                            02327522
023276         INTO :KRPRPM-FUNC-TXT                                    02327622
023277       FROM   TKRPRPM                                             02327722
023278       WHERE  SYS_PRC_FUNC_CDE  = :PC-PRDCHK                      02327822
023279         AND  INTFC_SYS_CDE     = :PC-KHL                         02327922
023280         AND  LOC_ID            = :PC-90                          02328022
023281         AND  FUNC_TXT          = :PC-PARM-TEXT                   02328122
023282     END-EXEC                                                     02328222
023283                                                                  02328322
023284     EVALUATE TRUE                                                02328422
023285         WHEN SQLCODE = +0                                        02328522
023286             CONTINUE                                             02328622
023287         WHEN SQLCODE = +100                                      02328722
023288             DISPLAY '*******************************************'02328822
023289             DISPLAY '** ABEND - DO NOT RUN THIS SUKUT980 PROGRAM'02328922
023290             DISPLAY '** ABEND - AGAINST PRODUCTION'              02329022
023291             DISPLAY '** ABEND - THIS SHOULD ONLY EVER BE'        02329122
023292             DISPLAY '** ABEND - RUN AGAINST TEST DATA'           02329222
023293             DISPLAY '*******************************************'02329322
023294             DISPLAY '** ABEND - THIS RUN IS GOING AGAINST'       02329422
023295             DISPLAY '** ABEND - DB2 INSTANCE:  '                 02329522
023296                     WS-LOCAL-SERVER                              02329622
023297             DISPLAY '*******************************************'02329722
023298             PERFORM 9100-SQL-ABEND                               02329822
023299                                                                  02329922
023300         WHEN SQLWARN0 NOT = SPACES                               02330022
023301         WHEN SQLCODE < +0                                        02330122
023302         WHEN SQLCODE > +0                                        02330222
023303             PERFORM 9100-SQL-ABEND                               02330322
023304     END-EVALUATE.                                                02330422
023305                                                                  02330522
023306*                                                                 02330607
023307 2000-PROCESS-CARTON.                                             02330707
023308                                                                  02330807
023309      IF DK-TRIP-ID > 0                                           02330919
023310         PERFORM 2002-PROCESS-BY-TRIP                             02331019
023311      ELSE                                                        02331119
023312         PERFORM 2001-PROCESS-RECEIVER                            02331219
023313      END-IF.                                                     02331319
023314                                                                  02331410
023315      PERFORM 7000-READ-INPUT-FILE.                               02331519
023316                                                                  02331610
023317 2001-PROCESS-RECEIVER.                                           02331707
023318        IF DK-RECEIVER > 0                                        02331807
023319           PERFORM 2100-UPDATE-TRECDIS-RCVR                       02331907
023320           PERFORM 2150-UPDATE-TRECITM-RCVR                       02332007
023321           PERFORM 2200-UPDATE-TRECEIV-RCVR                       02332107
023322           PERFORM 2248-PROCESS-DIST-TABLES                       02332211
023323           PERFORM 2250-DEL-TRECDVS                               02332307
023324        ELSE                                                      02332407
023330           PERFORM 2300-UPDATE-TRECDIS-PO                         02333007
023400           PERFORM 2350-UPDATE-TRECITM-PO                         02340007
023500           PERFORM 2400-UPDATE-TRECEIV-PO                         02350007
023600           PERFORM 2450-UPDATE-TDISTHD-PO                         02360007
023610           PERFORM 2455-UPDATE-TDISTDT-PO                         02361008
023700           PERFORM 2250-DEL-TRECDVS                               02370007
023800        END-IF.                                                   02380007
023900                                                                  02390007
024000 2002-PROCESS-BY-TRIP.                                            02400019
024100     SET PS-NOT-END-OF-TRIP-CURSOR TO TRUE.                       02410019
024200     PERFORM 2101-OPEN-TRIP-CURSOR.                               02420019
024300     PERFORM 2102-FETCH-TRIP-CURSOR                               02430019
024400           UNTIL PS-END-OF-TRIP-CURSOR                            02440019
024500     PERFORM 2103-CLOSE-TRIP-CURSOR.                              02450019
024501                                                                  02450119
024502 2100-UPDATE-TRECDIS-RCVR.                                        02450207
024503                                                                  02450307
024504     SET  PS-NOT-END-OF-RECDIS-CSR TO TRUE.                       02450407
024505                                                                  02450507
024600     PERFORM 2120-OPEN-RECDIS-RCVR-CSR.                           02460007
024700     PERFORM 2122-FETCH-RECDIS-RCVR-CSR.                          02470007
024800                                                                  02480007
024900     PERFORM UNTIL PS-END-OF-RECDIS-CSR                           02490007
025000          PERFORM 2126-UPDATE-VERIFY-QTY                          02500007
025100          PERFORM 2122-FETCH-RECDIS-RCVR-CSR                      02510007
025200     END-PERFORM.                                                 02520007
025300                                                                  02530007
025400     PERFORM 2121-CLOSE-RECDIS-RCVR-CSR.                          02540007
025500                                                                  02550007
025600 2101-OPEN-TRIP-CURSOR.                                           02560019
025700     MOVE '2101-OPEN-TRIP-CURSOR   '                              02570019
029800                                 TO PV-ABEND-PARAGRAPH.           02980009
029900     EXEC SQL                                                     02990009
030000         OPEN TRIP-RCVR-CSR                                       03000019
030100     END-EXEC.                                                    03010009
030200     EVALUATE TRUE                                                03020009
030300         WHEN SQLCODE = ZERO                                      03030010
030310         WHEN SQLCODE = -904                                      03031010
030400         WHEN SQLCODE = -911                                      03040009
030500             CONTINUE                                             03050009
030600         WHEN SQLWARN0 NOT = SPACES                               03060009
030700         WHEN SQLCODE < ZERO                                      03070009
030800         WHEN SQLCODE > ZERO                                      03080009
030900             MOVE '2101-OPEN-TRIP-CURSOR           '              03090009
031000                             TO PV-PARAGRAPH-NAME                 03100009
031100             MOVE 'OPEN THE TRIP-RCVR-CSR         '               03110009
031200                             TO PV-DB2-OPERATION-ATTEMPTED        03120009
031300             DISPLAY 'TRIP  ' DK-TRIP-ID                          03130019
031400             PERFORM 9100-SQL-ABEND                               03140009
031500     END-EVALUATE.                                                03150009
031600                                                                  03160009
031700 2102-FETCH-TRIP-CURSOR.                                          03170019
031800     MOVE '2102-FETCH-TRIP-CURSOR   '                             03180019
031900                                 TO PV-ABEND-PARAGRAPH.           03190009
032000     EXEC SQL                                                     03200009
032100          FETCH TRIP-RCVR-CSR                                     03210019
032200          INTO  :SHPTPO-PO-NBR                                    03220009
032210              , :SHPTPO-REC-SEQ-NBR                               03221019
032300     END-EXEC.                                                    03230009
032400                                                                  03240009
032500     EVALUATE TRUE                                                03250009
032600       WHEN SQLCODE = ZEROS                                       03260009
032700           MOVE SHPTPO-PO-NBR TO DK-PO-NBR                        03270019
032800           MOVE SHPTPO-REC-SEQ-NBR TO DK-RECEIVER                 03280019
032810           PERFORM 2001-PROCESS-RECEIVER                          03281019
032900       WHEN SQLCODE = +100                                        03290009
033000           SET PS-END-OF-TRIP-CURSOR TO TRUE                      03300019
033100       WHEN SQLWARN0 NOT = SPACES                                 03310009
033200       WHEN SQLCODE < ZERO                                        03320009
033300       WHEN SQLCODE > ZERO                                        03330009
033400           MOVE '2102-FETCH-TRIP-CURSOR  '                        03340009
033500                               TO PV-PARAGRAPH-NAME               03350009
033600           MOVE 'FETCH TRIP   CURSOR '                            03360009
033700                               TO PV-DB2-OPERATION-ATTEMPTED      03370009
033710             DISPLAY 'TRIP  ' DK-TRIP-ID                          03371019
033900           PERFORM 9100-SQL-ABEND                                 03390009
034000     END-EVALUATE.                                                03400009
034100                                                                  03410009
037997 2103-CLOSE-TRIP-CURSOR.                                          03799719
037998     MOVE '2103-CLOSE-TRIP-CURSOR   '                             03799819
038100                                 TO PV-ABEND-PARAGRAPH.           03810009
038200     EXEC SQL                                                     03820009
038300         CLOSE TRIP-RCVR-CSR                                      03830019
038400     END-EXEC.                                                    03840009
038500     EVALUATE TRUE                                                03850009
038600         WHEN SQLCODE = -904                                      03860009
038700         WHEN SQLCODE = -911                                      03870009
038800             CONTINUE                                             03880009
038900         WHEN SQLWARN0 NOT = SPACES                               03890009
039000         WHEN SQLCODE < ZERO                                      03900009
039100         WHEN SQLCODE > ZERO                                      03910009
039200             MOVE '2103-CLOSE-CURSOR '                            03920009
039300                             TO PV-PARAGRAPH-NAME                 03930009
039400             MOVE 'CLOSE THE TRIP-RCVR-CURSOR     '               03940009
039500                             TO PV-DB2-OPERATION-ATTEMPTED        03950009
039600             PERFORM 9100-SQL-ABEND                               03960009
039700          WHEN SQLCODE = ZERO                                     03970009
039800              CONTINUE                                            03980009
039900     END-EVALUATE.                                                03990009
040000*                                                                 04000009
040001 2120-OPEN-RECDIS-RCVR-CSR.                                       04000119
040002     MOVE '2120-OPEN-RECDIS-RCVR-CSR '                            04000207
040003                                 TO PV-ABEND-PARAGRAPH.           04000307
040004     EXEC SQL                                                     04000407
040005         OPEN RECDIS-RCVR-CSR                                     04000507
040006     END-EXEC.                                                    04000607
040007     EVALUATE TRUE                                                04000707
040008         WHEN SQLCODE = ZERO                                      04000807
040009         WHEN SQLCODE = -904                                      04000907
040010         WHEN SQLCODE = -911                                      04001007
040011             CONTINUE                                             04001107
040012         WHEN SQLWARN0 NOT = SPACES                               04001207
040013         WHEN SQLCODE < ZERO                                      04001307
040014         WHEN SQLCODE > ZERO                                      04001407
040015               MOVE '2120-OPEN-RECDIS-RCVR-CSR '                  04001507
040016                             TO PV-PARAGRAPH-NAME                 04001607
040017             MOVE 'OPEN THE RECDIS-RCVR-CSR       '               04001707
040018                             TO PV-DB2-OPERATION-ATTEMPTED        04001807
040019             DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '             04001907
040020                                                 DK-RECEIVER      04002007
040021             PERFORM 9100-SQL-ABEND                               04002107
040022     END-EVALUATE.                                                04002207
040023                                                                  04002307
040024                                                                  04002407
040025 2121-CLOSE-RECDIS-RCVR-CSR.                                      04002507
040026     MOVE '2121-CLOSE-RECDIS-RCVR-CSR '                           04002607
040027                                 TO PV-ABEND-PARAGRAPH.           04002707
040028     EXEC SQL                                                     04002807
040029         CLOSE RECDIS-RCVR-CSR                                    04002907
040030     END-EXEC.                                                    04003007
040031     EVALUATE TRUE                                                04003107
040032         WHEN SQLCODE = ZERO                                      04003207
040033         WHEN SQLCODE = -904                                      04003307
040034         WHEN SQLCODE = -911                                      04003407
040035             CONTINUE                                             04003507
040036         WHEN SQLWARN0 NOT = SPACES                               04003607
040037         WHEN SQLCODE < ZERO                                      04003707
040038         WHEN SQLCODE > ZERO                                      04003807
040039               MOVE '2121-CLOSE-RECDIS-RCVR-CSR '                 04003907
040040                             TO PV-PARAGRAPH-NAME                 04004007
040041             MOVE 'CLSOE THE RECDIS-RCVR-CSR       '              04004107
040042                             TO PV-DB2-OPERATION-ATTEMPTED        04004207
040043             DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '             04004307
040044                                                 DK-RECEIVER      04004407
040045             PERFORM 9100-SQL-ABEND                               04004507
040046     END-EVALUATE.                                                04004607
040047                                                                  04004707
040048 2122-FETCH-RECDIS-RCVR-CSR.                                      04004807
040049     MOVE '2122-FETCH-RECDIS-RCVR-CSR '                           04004907
040050                                 TO PV-ABEND-PARAGRAPH.           04005007
040051     EXEC SQL                                                     04005107
040052          FETCH RECDIS-RCVR-CSR                                   04005207
040053           INTO :RECDIS-REC-SEQ-NBR                               04005307
040054               ,:RECDIS-ORD-LNE-NBR                               04005407
040055               ,:RECDIS-STR-NBR                                   04005507
040056               ,:RECDIS-EXPTED-ITM-QTY                            04005607
040057     END-EXEC.                                                    04005707
040058                                                                  04005807
040059     EVALUATE TRUE                                                04005907
040060       WHEN SQLCODE = ZEROS                                       04006007
040061          CONTINUE                                                04006107
040062       WHEN SQLCODE = +100                                        04006207
040063           SET PS-END-OF-RECDIS-CSR TO TRUE                       04006307
040064       WHEN SQLWARN0 NOT = SPACES                                 04006407
040065       WHEN SQLCODE < ZERO                                        04006507
040066       WHEN SQLCODE > ZERO                                        04006607
040067            MOVE '2122-FETCH-RECDIS-RCVR-CSR '                    04006707
040068                               TO PV-PARAGRAPH-NAME               04006807
040069            MOVE 'FETCH RECDIS-RCVR CURSOR '                      04006907
040070                               TO PV-DB2-OPERATION-ATTEMPTED      04007007
040071            DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '              04007107
040072                               DK-RECEIVER                        04007207
040073           PERFORM 9100-SQL-ABEND                                 04007307
040074     END-EVALUATE.                                                04007407
040075                                                                  04007507
040076                                                                  04007607
040077 2123-OPEN-RECDIS-PO-CSR.                                         04007707
040078     MOVE '2123-OPEN-RECDIS-PO-CSR '                              04007807
040079                                 TO PV-ABEND-PARAGRAPH.           04007907
040080     EXEC SQL                                                     04008007
040081         OPEN RECDIS-PO-CSR                                       04008107
040082     END-EXEC.                                                    04008207
040083     EVALUATE TRUE                                                04008307
040084         WHEN SQLCODE = ZERO                                      04008407
040085         WHEN SQLCODE = -904                                      04008507
040086         WHEN SQLCODE = -911                                      04008607
040087             CONTINUE                                             04008707
040088         WHEN SQLWARN0 NOT = SPACES                               04008807
040089         WHEN SQLCODE < ZERO                                      04008907
040090         WHEN SQLCODE > ZERO                                      04009007
040091               MOVE '2123-OPEN-RECDIS-PO-CSR '                    04009107
040092                             TO PV-PARAGRAPH-NAME                 04009207
040093             MOVE 'OPEN THE RECDIS-PO-CSR       '                 04009307
040094                             TO PV-DB2-OPERATION-ATTEMPTED        04009407
040095             DISPLAY 'PO NBR ' DK-PO-NBR                          04009507
040096             PERFORM 9100-SQL-ABEND                               04009607
040097     END-EVALUATE.                                                04009707
040098                                                                  04009807
040099                                                                  04009907
040100 2124-CLOSE-RECDIS-PO-CSR.                                        04010007
040101     MOVE '2124-CLOSE-RECDIS-PO-CSR '                             04010107
040102                                 TO PV-ABEND-PARAGRAPH.           04010207
040103     EXEC SQL                                                     04010307
040104         CLOSE RECDIS-PO-CSR                                      04010407
040105     END-EXEC.                                                    04010507
040106     EVALUATE TRUE                                                04010607
040107         WHEN SQLCODE = ZERO                                      04010707
040108         WHEN SQLCODE = -904                                      04010807
040109         WHEN SQLCODE = -911                                      04010907
040110             CONTINUE                                             04011007
040111         WHEN SQLWARN0 NOT = SPACES                               04011107
040112         WHEN SQLCODE < ZERO                                      04011207
040113         WHEN SQLCODE > ZERO                                      04011307
040114               MOVE '2124-CLOSE-RECDIS-PO-CSR '                   04011407
040115                             TO PV-PARAGRAPH-NAME                 04011507
040116             MOVE 'CLOSE THE RECDIS-PO-CSR       '                04011607
040117                             TO PV-DB2-OPERATION-ATTEMPTED        04011707
040118             DISPLAY 'PO NBR ' DK-PO-NBR                          04011807
040119             PERFORM 9100-SQL-ABEND                               04011907
040120     END-EVALUATE.                                                04012007
040121                                                                  04012107
040122 2125-FETCH-RECDIS-PO-CSR.                                        04012207
040123     MOVE '2125-FETCH-RECDIS-PO-CSR '                             04012307
040124                                 TO PV-ABEND-PARAGRAPH.           04012407
040125     EXEC SQL                                                     04012507
040126          FETCH RECDIS-PO-CSR                                     04012607
040127           INTO :RECDIS-REC-SEQ-NBR                               04012707
040128               ,:RECDIS-ORD-LNE-NBR                               04012807
040129               ,:RECDIS-STR-NBR                                   04012907
040130               ,:RECDIS-EXPTED-ITM-QTY                            04013007
040131     END-EXEC.                                                    04013107
040132                                                                  04013207
040133     EVALUATE TRUE                                                04013307
040134       WHEN SQLCODE = ZEROS                                       04013407
040135          CONTINUE                                                04013507
040136       WHEN SQLCODE = +100                                        04013607
040137           SET PS-END-OF-RECDIS-CSR TO TRUE                       04013707
040138       WHEN SQLWARN0 NOT = SPACES                                 04013807
040139       WHEN SQLCODE < ZERO                                        04013907
040140       WHEN SQLCODE > ZERO                                        04014007
040141            MOVE '2125-FETCH-RECDIS-PO-CSR '                      04014107
040142                               TO PV-PARAGRAPH-NAME               04014207
040143            MOVE 'FETCH RECDIS-PO CURSOR '                        04014307
040144                               TO PV-DB2-OPERATION-ATTEMPTED      04014407
040145            DISPLAY 'PO NBR ' DK-PO-NBR                           04014507
040146           PERFORM 9100-SQL-ABEND                                 04014607
040200     END-EVALUATE.                                                04020007
040300                                                                  04030007
040400                                                                  04040007
040500 2126-UPDATE-VERIFY-QTY.                                          04050007
040600     MOVE '2126-UPDATE-VERIFY-QTY   '                             04060007
040700                                 TO PV-ABEND-PARAGRAPH.           04070007
040800     EXEC SQL                                                     04080007
040900          UPDATE TRECDIS                                          04090007
041000           SET  VERIFY_ITM_QTY    =  :RECDIS-EXPTED-ITM-QTY       04100007
041100               ,AP_VERIFY_ITM_QTY = 0                             04110007
041200               ,AP_PRC_CDE = ' '                                  04120007
041300               ,AP_PRC_DTE = '9999-09-09'                         04130007
041400          WHERE  ORD_NBR        =  :DK-PO-NBR                     04140007
041500            AND  REC_SEQ_NBR    =  :RECDIS-REC-SEQ-NBR            04150007
041600            AND  ORD_LNE_NBR    =  :RECDIS-ORD-LNE-NBR            04160007
041700            AND  STR_NBR        =  :RECDIS-STR-NBR                04170007
041800     END-EXEC.                                                    04180007
041900                                                                  04190007
042000     EVALUATE TRUE                                                04200007
042100       WHEN SQLCODE = ZEROS                                       04210007
042200       WHEN SQLCODE = +100                                        04220007
042300          CONTINUE                                                04230007
042400       WHEN SQLWARN0 NOT = SPACES                                 04240007
042500       WHEN SQLCODE < ZERO                                        04250007
042600       WHEN SQLCODE > ZERO                                        04260007
042700            MOVE '2126-UPDATE-VERIFY-QTY   '                      04270007
042800                               TO PV-PARAGRAPH-NAME               04280007
042900            MOVE 'UPDATE VERIFY QTY ON RECDIS '                   04290007
043000                               TO PV-DB2-OPERATION-ATTEMPTED      04300007
043100            DISPLAY 'PO NBR ' DK-PO-NBR ' REC SEQ NBR '           04310007
043200            RECDIS-REC-SEQ-NBR ' LINE NBR ' RECDIS-ORD-LNE-NBR    04320007
043300           PERFORM 9100-SQL-ABEND                                 04330007
043400     END-EVALUATE.                                                04340007
043500                                                                  04350007
043600                                                                  04360007
043700 2150-UPDATE-TRECITM-RCVR.                                        04370007
043800     EXEC SQL                                                     04380007
043900          UPDATE TRECITM                                          04390007
044000          SET                                                     04400007
044100                 STATUS_CDE     = 'IP'                            04410007
044200                ,VERFYD_TMST    = '9999-09-09-09.09.09.999999'    04420007
044300                ,UPD_TMST       = CURRENT TIMESTAMP               04430007
044400                ,UPD_UID        = 'SUKUT980'                      04440007
044500                ,UPD_PGM_ID     = 'SUKUT980'                      04450007
044600                ,VRFD_USR_ID    = ' '                             04460007
044700          WHERE  ORD_NBR     = :DK-PO-NBR                         04470007
044800            AND  REC_SEQ_NBR = :DK-RECEIVER                       04480007
044900     END-EXEC.                                                    04490007
045000                                                                  04500007
045100     EVALUATE TRUE                                                04510007
045200       WHEN SQLCODE = ZEROS                                       04520007
045300       WHEN SQLCODE = +100                                        04530007
045400          CONTINUE                                                04540007
045500       WHEN SQLWARN0 NOT = SPACES                                 04550007
045600       WHEN SQLCODE < ZERO                                        04560007
045700       WHEN SQLCODE > ZERO                                        04570007
045800           MOVE '2150-UPDATE-TRECITM-RCVR  '                      04580007
045900                                 TO PV-ABEND-PARAGRAPH            04590007
046000           MOVE '2150-UPDATE-TRECITM-RCVR  '                      04600007
046100                               TO PV-PARAGRAPH-NAME               04610007
046200           MOVE 'UPDATE TRECITM     '                             04620007
046300                               TO PV-DB2-OPERATION-ATTEMPTED      04630007
046400           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04640007
046500                                                 DK-RECEIVER      04650007
046600           PERFORM 9100-SQL-ABEND                                 04660007
046700     END-EVALUATE.                                                04670007
046701                                                                  04670107
046702 2200-UPDATE-TRECEIV-RCVR.                                        04670200
046703     EXEC SQL                                                     04670300
046704          UPDATE TRECEIV                                          04670400
046705          SET                                                     04670507
046706                 STATUS_CDE     = 'IP'                            04670607
046707                ,VERFYD_TMST    = '9999-09-09-09.09.09.999999'    04670707
046708                ,UPD_TMST       = CURRENT TIMESTAMP               04670807
046709                ,UPD_UID        = 'SUKUT980'                      04670907
046710                ,UPD_PGM_ID     = 'SUKUT980'                      04671007
046720                ,VRFD_USR_ID    = ' '                             04672007
046730                ,ML_POST_TMST   = '9999-09-09-09.09.09.999999'    04673007
046740                ,FS_POST_TMST   = '9999-09-09-09.09.09.999999'    04674007
046750                ,AP_PRC_CDE     = ' '                             04675007
046760                ,AP_PRC_DTE     = '9999-09-09'                    04676007
046770          WHERE  ORD_NBR     = :DK-PO-NBR                         04677007
046771            AND  REC_SEQ_NBR = :DK-RECEIVER                       04677107
046772     END-EXEC.                                                    04677200
046773                                                                  04677300
046774     EVALUATE TRUE                                                04677407
046775       WHEN SQLCODE = ZEROS                                       04677507
046776       WHEN SQLCODE = +100                                        04677607
046777          CONTINUE                                                04677707
046778       WHEN SQLWARN0 NOT = SPACES                                 04677807
046779       WHEN SQLCODE < ZERO                                        04677907
046780       WHEN SQLCODE > ZERO                                        04678007
046781           MOVE '2200-UPDATE-TRECEIV-RCVR  '                      04678107
046782                                 TO PV-ABEND-PARAGRAPH            04678200
046783           MOVE '2200-UPDATE-TRECEIV-RCVR  '                      04678307
046784                               TO PV-PARAGRAPH-NAME               04678407
046785           MOVE 'UPDATE TRECITM     '                             04678507
046786                               TO PV-DB2-OPERATION-ATTEMPTED      04678607
046787           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04678707
046788                                                 DK-RECEIVER      04678807
046789           PERFORM 9100-SQL-ABEND                                 04678907
046790     END-EVALUATE.                                                04679007
046791                                                                  04679107
046792 2248-PROCESS-DIST-TABLES.                                        04679211
046793                                                                  04679311
046794     PERFORM 2248A-OPEN-DISTDT-RCVR-CSR.                          04679411
046795                                                                  04679511
046796     SET PS-NOT-EOT-DISTDT TO TRUE.                               04679611
046797                                                                  04679711
046798     PERFORM UNTIL PS-EOT-DISTDT                                  04679811
046799        PERFORM 2248B-FETCH-DISTDT-RCVR-CSR                       04679911
046810        EXEC SQL                                                  04681011
046820            COMMIT                                                04682011
046821        END-EXEC                                                  04682111
046822        IF SQLCODE NOT = +0                                       04682211
046823            DISPLAY '### COMMIT FAILED ! ###'                     04682311
046824            PERFORM 9100-SQL-ABEND                                04682411
046825        END-IF                                                    04682511
046826     END-PERFORM.                                                 04682611
046827                                                                  04682711
046828     PERFORM 2248C-CLOSE-DISTDT-RCVR-CSR.                         04682811
046829     PERFORM 2249-UPDATE-TDISTHD-RCVR.                            04682911
046831                                                                  04683111
046832 2248A-OPEN-DISTDT-RCVR-CSR.                                      04683211
046833                                                                  04683311
046834     EXEC SQL                                                     04683411
046835          OPEN DISTDT-RCVR-CSR                                    04683514
046836     END-EXEC.                                                    04683611
046837                                                                  04683711
046838     EVALUATE TRUE                                                04683811
046839       WHEN SQLCODE = ZEROS                                       04683911
046840       WHEN SQLCODE = +100                                        04684011
046841          CONTINUE                                                04684111
046842       WHEN SQLWARN0 NOT = SPACES                                 04684211
046843       WHEN SQLCODE < ZERO                                        04684311
046844       WHEN SQLCODE > ZERO                                        04684411
046845           MOVE '2248A-OPEN-DISTDT-RCVR-CSR'                      04684511
046846                                 TO PV-ABEND-PARAGRAPH            04684611
046847           MOVE '2248A-OPEN-DISTDT-RCVR-CSR'                      04684711
046848                               TO PV-PARAGRAPH-NAME               04684811
046849           MOVE 'OPEN DISTDT CURSOR '                             04684911
046850                               TO PV-DB2-OPERATION-ATTEMPTED      04685011
046851           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04685111
046852                                                 DK-RECEIVER      04685211
046853           PERFORM 9100-SQL-ABEND                                 04685311
046854     END-EVALUATE.                                                04685411
046855                                                                  04685511
046856                                                                  04685611
046857 2248B-FETCH-DISTDT-RCVR-CSR.                                     04685711
046858                                                                  04685811
046859     EXEC SQL                                                     04685911
046860          FETCH DISTDT-RCVR-CSR                                   04686014
046861          INTO                                                    04686111
046862               :DISTDT-ORD-NBR                                    04686211
046863             , :DISTDT-ORD-LNE-NBR                                04686311
046864             , :DISTDT-RCVR-SEQ-NBR                               04686411
046865                                                                  04686511
046866     END-EXEC.                                                    04686611
046867                                                                  04686711
046868     EVALUATE TRUE                                                04686811
046869       WHEN SQLCODE = ZEROS                                       04686911
046870          PERFORM 2249A-UPDATE-TDISTDT-RCVR                       04687011
046871       WHEN SQLCODE = +100                                        04687111
046872          SET PS-EOT-DISTDT TO TRUE                               04687211
046873       WHEN SQLWARN0 NOT = SPACES                                 04687311
046874       WHEN SQLCODE < ZERO                                        04687411
046875       WHEN SQLCODE > ZERO                                        04687511
046876           MOVE '2248B-FETCH-DISTDT-RCVR-CSR'                     04687611
046877                                 TO PV-ABEND-PARAGRAPH            04687711
046878           MOVE '2248B-FETCH-DISTDT-RCVR-CSR'                     04687811
046879                               TO PV-PARAGRAPH-NAME               04687911
046880           MOVE 'FETCH DISTDT CURSOR '                            04688011
046881                               TO PV-DB2-OPERATION-ATTEMPTED      04688111
046882           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04688211
046883                                                 DK-RECEIVER      04688311
046884           PERFORM 9100-SQL-ABEND                                 04688411
046885     END-EVALUATE.                                                04688511
046886                                                                  04688611
046887                                                                  04688711
046888 2248C-CLOSE-DISTDT-RCVR-CSR.                                     04688811
046889                                                                  04688911
046890     EXEC SQL                                                     04689011
046891          CLOSE DISTDT-RCVR-CSR                                   04689114
046892     END-EXEC.                                                    04689211
046893                                                                  04689311
046894     EVALUATE TRUE                                                04689411
046895       WHEN SQLCODE = ZEROS                                       04689511
046896       WHEN SQLCODE = +100                                        04689611
046897          CONTINUE                                                04689711
046898       WHEN SQLWARN0 NOT = SPACES                                 04689811
046899       WHEN SQLCODE < ZERO                                        04689911
046900       WHEN SQLCODE > ZERO                                        04690011
046901           MOVE '2248C-CLOSE-DISTDT-RCVR-CSR'                     04690111
046902                                 TO PV-ABEND-PARAGRAPH            04690211
046903           MOVE '2248C-CLOSE-DISTDT-RCVR-CSR'                     04690311
046904                               TO PV-PARAGRAPH-NAME               04690411
046905           MOVE 'CLOSE DISTDT CURSOR '                            04690511
046906                               TO PV-DB2-OPERATION-ATTEMPTED      04690611
046907           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04690711
046908                                                 DK-RECEIVER      04690811
046909           PERFORM 9100-SQL-ABEND                                 04690911
046910     END-EVALUATE.                                                04691011
046911                                                                  04691111
046912 2249-UPDATE-TDISTHD-RCVR.                                        04691211
046913     EXEC SQL                                                     04691311
046914          UPDATE TDISTHD                                          04691411
046915          SET                                                     04691511
046916                 PRCG_STAT_CDE  = 'R'                             04691611
046917                ,VRFD_TMST = '9999-09-09-09.09.09.999999'         04691711
046918          WHERE  ORD_NBR     = :DK-PO-NBR                         04691811
046919            AND  RCVR_SEQ_NBR = :DK-RECEIVER                      04691911
046920            AND  PRCG_STAT_CDE = 'V'                              04692011
046921     END-EXEC.                                                    04692111
046922                                                                  04692211
046923     EVALUATE TRUE                                                04692311
046924       WHEN SQLCODE = ZEROS                                       04692411
046925       WHEN SQLCODE = +100                                        04692511
046926          CONTINUE                                                04692611
046927       WHEN SQLWARN0 NOT = SPACES                                 04692711
046928       WHEN SQLCODE < ZERO                                        04692811
046929       WHEN SQLCODE > ZERO                                        04692911
046930           MOVE '2249-UPDATE-TDISTHD-RCVR  '                      04693011
046931                                 TO PV-ABEND-PARAGRAPH            04693111
046932           MOVE '2249-UPDATE-TDISTHD-RCVR  '                      04693211
046933                               TO PV-PARAGRAPH-NAME               04693311
046934           MOVE 'UPDATE TDISTHD     '                             04693411
046935                               TO PV-DB2-OPERATION-ATTEMPTED      04693511
046936           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04693611
046937                                                 DK-RECEIVER      04693711
046938           PERFORM 9100-SQL-ABEND                                 04693811
046940     END-EVALUATE.                                                04694007
047000                                                                  04700007
047010 2249A-UPDATE-TDISTDT-RCVR.                                       04701008
047020     EXEC SQL                                                     04702008
047030          UPDATE TDISTDT                                          04703008
047040          SET    RCVG_PSTD_STAT_CDE = 'N'                         04704008
047070          WHERE  ORD_NBR     = :DK-PO-NBR                         04707008
047080            AND  RCVR_SEQ_NBR = :DK-RECEIVER                      04708008
047081            AND  ORD_LNE_NBR = :DISTDT-ORD-LNE-NBR                04708111
047090            AND  RCVG_PSTD_STAT_CDE = 'P'                         04709009
047091     END-EXEC.                                                    04709108
047092                                                                  04709208
047093     EVALUATE TRUE                                                04709308
047094       WHEN SQLCODE = ZEROS                                       04709408
047095       WHEN SQLCODE = +100                                        04709508
047096          CONTINUE                                                04709608
047097       WHEN SQLWARN0 NOT = SPACES                                 04709708
047098       WHEN SQLCODE < ZERO                                        04709808
047099       WHEN SQLCODE > ZERO                                        04709908
047100           MOVE '2249A-UPDATE-TDISTDT-RCVR '                      04710008
047101                                 TO PV-ABEND-PARAGRAPH            04710108
047102           MOVE '2249A-UPDATE-TDISTDT-RCVR '                      04710208
047103                               TO PV-PARAGRAPH-NAME               04710308
047104           MOVE 'UPDATE TDISTDT     '                             04710408
047105                               TO PV-DB2-OPERATION-ATTEMPTED      04710508
047106           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04710608
047107                                                 DK-RECEIVER      04710708
047108           PERFORM 9100-SQL-ABEND                                 04710808
047109     END-EVALUATE.                                                04710908
047110                                                                  04711008
047111                                                                  04711108
047112 2250-DEL-TRECDVS.                                                04711208
047113     EXEC SQL                                                     04711308
047114          DELETE                                                  04711408
047115          FROM   TRECDVS                                          04711508
047116          WHERE  ORD_NBR     = :DK-PO-NBR                         04711608
047117            AND  REC_SEQ_NBR = :DK-RECEIVER                       04711708
047118     END-EXEC.                                                    04711808
047119                                                                  04711908
047120     EVALUATE TRUE                                                04712008
047121       WHEN SQLCODE = ZEROS                                       04712108
047122       WHEN SQLCODE = +100                                        04712208
047123          CONTINUE                                                04712308
047124       WHEN SQLWARN0 NOT = SPACES                                 04712408
047125       WHEN SQLCODE < ZERO                                        04712508
047126       WHEN SQLCODE > ZERO                                        04712608
047127           MOVE '2200-UPDATE-TRECEIV-RCVR  '                      04712708
047128                                 TO PV-ABEND-PARAGRAPH            04712808
047129           MOVE '2200-UPDATE-TRECEIV-RCVR  '                      04712908
047130                               TO PV-PARAGRAPH-NAME               04713008
047131           MOVE 'UPDATE TRECITM     '                             04713108
047132                               TO PV-DB2-OPERATION-ATTEMPTED      04713208
047140           DISPLAY 'PO NBR ' DK-PO-NBR ' RECEIVER '               04714007
047150                                                 DK-RECEIVER      04715007
047160           PERFORM 9100-SQL-ABEND                                 04716007
047170     END-EVALUATE.                                                04717007
047180                                                                  04718007
047190                                                                  04719007
047200 2300-UPDATE-TRECDIS-PO.                                          04720007
047300                                                                  04730007
047400     SET  PS-NOT-END-OF-RECDIS-CSR TO TRUE.                       04740007
047500                                                                  04750007
047600     PERFORM 2123-OPEN-RECDIS-PO-CSR.                             04760007
047700     PERFORM 2125-FETCH-RECDIS-PO-CSR.                            04770007
047800                                                                  04780007
047900     PERFORM UNTIL PS-END-OF-RECDIS-CSR                           04790007
048000          PERFORM 2126-UPDATE-VERIFY-QTY                          04800007
048100          PERFORM 2125-FETCH-RECDIS-PO-CSR                        04810007
048200     END-PERFORM.                                                 04820007
048300                                                                  04830007
048400     PERFORM 2124-CLOSE-RECDIS-PO-CSR.                            04840007
048500                                                                  04850007
048501 2350-UPDATE-TRECITM-PO.                                          04850107
048502     EXEC SQL                                                     04850200
048503          UPDATE TRECITM                                          04850300
048504          SET                                                     04850407
048505                 STATUS_CDE     = 'IP'                            04850507
048506                ,VERFYD_TMST    = '9999-09-09-09.09.09.999999'    04850607
048507                ,UPD_TMST       = CURRENT TIMESTAMP               04850707
048508                ,UPD_UID        = 'SUKUT980'                      04850807
048509                ,UPD_PGM_ID     = 'SUKUT980'                      04850907
048510                ,VRFD_USR_ID    = ' '                             04851007
048511          WHERE  ORD_NBR     = :DK-PO-NBR                         04851107
048512     END-EXEC.                                                    04851200
048513                                                                  04851300
048514     EVALUATE TRUE                                                04851400
048515       WHEN SQLCODE = ZEROS                                       04851500
048516       WHEN SQLCODE = +100                                        04851600
048517          CONTINUE                                                04851707
048518       WHEN SQLWARN0 NOT = SPACES                                 04851800
048519       WHEN SQLCODE < ZERO                                        04851900
048520       WHEN SQLCODE > ZERO                                        04852000
048521           MOVE '2350-UPDATE-TRECITM-PO    '                      04852107
048522                                 TO PV-ABEND-PARAGRAPH            04852200
048523           MOVE '2350-UPDATE-TRECITM-PO    '                      04852307
048524                               TO PV-PARAGRAPH-NAME               04852400
048525           MOVE 'UPDATE TRECITM     '                             04852500
048526                               TO PV-DB2-OPERATION-ATTEMPTED      04852600
048527           DISPLAY 'PO NBR ' DK-PO-NBR                            04852707
048528           PERFORM 9100-SQL-ABEND                                 04852800
048529     END-EVALUATE.                                                04852900
048530                                                                  04853000
048531 2400-UPDATE-TRECEIV-PO.                                          04853107
048532     EXEC SQL                                                     04853200
048533          UPDATE TRECEIV                                          04853300
048534          SET                                                     04853407
048535                 STATUS_CDE     = 'IP'                            04853507
048536                ,VERFYD_TMST    = '9999-09-09-09.09.09.999999'    04853607
048537                ,UPD_TMST       = CURRENT TIMESTAMP               04853707
048538                ,UPD_UID        = 'SUKUT980'                      04853807
048539                ,UPD_PGM_ID     = 'SUKUT980'                      04853907
048540                ,VRFD_USR_ID    = ' '                             04854007
048550                ,ML_POST_TMST   = '9999-09-09-09.09.09.999999'    04855007
048560                ,FS_POST_TMST   = '9999-09-09-09.09.09.999999'    04856007
048561          WHERE  ORD_NBR     = :DK-PO-NBR                         04856107
048562     END-EXEC.                                                    04856200
048563                                                                  04856300
048564     EVALUATE TRUE                                                04856400
048565       WHEN SQLCODE = ZEROS                                       04856500
048566       WHEN SQLCODE = +100                                        04856600
048567          CONTINUE                                                04856707
048568       WHEN SQLWARN0 NOT = SPACES                                 04856800
048569       WHEN SQLCODE < ZERO                                        04856900
048570       WHEN SQLCODE > ZERO                                        04857000
048571           MOVE '2400-UPDATE-TRECEIV-PO    '                      04857107
048572                                 TO PV-ABEND-PARAGRAPH            04857200
048573           MOVE '2400-UPDATE-TRECEIV-PO    '                      04857307
048574                               TO PV-PARAGRAPH-NAME               04857400
048575           MOVE 'UPDATE TRECITM     '                             04857500
048576                               TO PV-DB2-OPERATION-ATTEMPTED      04857600
048577           DISPLAY 'PO NBR ' DK-PO-NBR                            04857707
048578           PERFORM 9100-SQL-ABEND                                 04857800
048579     END-EVALUATE.                                                04857900
048580                                                                  04858000
048590                                                                  04859007
048591 2450-UPDATE-TDISTHD-PO.                                          04859107
048593     EXEC SQL                                                     04859300
048594          UPDATE TDISTHD                                          04859400
048595          SET                                                     04859507
048596                 PRCG_STAT_CDE  = 'R'                             04859607
048597                ,VRFD_TMST = '9999-09-09-09.09.09.999999'         04859707
048598          WHERE  ORD_NBR     = :DK-PO-NBR                         04859807
048599            AND  PRCG_STAT_CDE = 'V'                              04859907
048600     END-EXEC.                                                    04860000
048601                                                                  04860100
048602     EVALUATE TRUE                                                04860200
048603       WHEN SQLCODE = ZEROS                                       04860300
048604       WHEN SQLCODE = +100                                        04860400
048605          CONTINUE                                                04860507
048606       WHEN SQLWARN0 NOT = SPACES                                 04860600
048607       WHEN SQLCODE < ZERO                                        04860700
048608       WHEN SQLCODE > ZERO                                        04860800
048609           MOVE '2450-UPDATE-TDISTHD-PO    '                      04860907
048610                                 TO PV-ABEND-PARAGRAPH            04861000
048611           MOVE '2450-UPDATE-TDISTHD-PO    '                      04861107
048612                               TO PV-PARAGRAPH-NAME               04861200
048613           MOVE 'UPDATE TDISTHD     '                             04861300
048614                               TO PV-DB2-OPERATION-ATTEMPTED      04861400
048615           DISPLAY 'PO NBR ' DK-PO-NBR                            04861507
048616           PERFORM 9100-SQL-ABEND                                 04861600
048617     END-EVALUATE.                                                04861700
048618                                                                  04861800
048619 2455-UPDATE-TDISTDT-PO.                                          04861908
048620     EXEC SQL                                                     04862008
048621          UPDATE TDISTDT                                          04862108
048622          SET   RCVG_PSTD_STAT_CDE = 'N'                          04862208
048625          WHERE  ORD_NBR     = :DK-PO-NBR                         04862508
048626            AND  RCVG_PSTD_STAT_CDE = 'P'                         04862609
048627     END-EXEC.                                                    04862708
048628                                                                  04862808
048629     EVALUATE TRUE                                                04862908
048630       WHEN SQLCODE = ZEROS                                       04863008
048631       WHEN SQLCODE = +100                                        04863108
048632          CONTINUE                                                04863208
048633       WHEN SQLWARN0 NOT = SPACES                                 04863308
048634       WHEN SQLCODE < ZERO                                        04863408
048635       WHEN SQLCODE > ZERO                                        04863508
048636           MOVE '2455-UPDATE-TDISTDT-PO    '                      04863608
048637                                 TO PV-ABEND-PARAGRAPH            04863708
048638           MOVE '2455-UPDATE-TDISTDT-PO    '                      04863808
048639                               TO PV-PARAGRAPH-NAME               04863908
048640           MOVE 'UPDATE TDISTDT     '                             04864008
048641                               TO PV-DB2-OPERATION-ATTEMPTED      04864108
048642           DISPLAY 'PO NBR ' DK-PO-NBR                            04864208
048643           PERFORM 9100-SQL-ABEND                                 04864308
048644     END-EVALUATE.                                                04864408
048645                                                                  04864508
048646                                                                  04864608
048647 7000-READ-INPUT-FILE.                                            04864708
048648******************************************************************04864808
048649                                                                  04864908
048650     READ PO-RECEIVER-FILE INTO INPUT-RECORD                      04865008
048651        AT END                                                    04865108
048660           SET PS-END-OF-INPUT-FILE TO TRUE.                      04866007
048670                                                                  04867007
048680     IF PS-NOT-END-OF-INPUT-FILE                                  04868007
048690        DISPLAY 'PO NUMBER: '  DR-PO-NBR                          04869007
048700        ' RECEIVER NBR: '      DR-RECEIVER                        04870007
048710        ' TRIP ID: '           DR-TRIP-ID                         04871019
048800        MOVE DR-PO-NBR             TO DK-PO-NBR                   04880007
048900        MOVE DR-RECEIVER           TO DK-RECEIVER                 04890007
048910        MOVE DR-TRIP-ID            TO DK-TRIP-ID                  04891019
049000                                                                  04900007
049100     END-IF.                                                      04910007
049200*                                                                 04920007
049300*                                                                 04930007
049400 9000-EOJ-ROUTINE.                                                04940007
049500                                                                  04950007
049600     CLOSE PO-RECEIVER-FILE.                                      04960007
049700                                                                  04970007
049800 9100-SQL-ABEND.                                                  04980007
049900******************************************************************04990007
050000*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    05000007
050100*  ERROR OR WARNING CODE OCCURS.                                  05010007
050200******************************************************************05020007
050300     DISPLAY '** ABEND     **'.                                   05030007
050400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        05040007
050500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              05050007
050600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     05060007
050700                                                                  05070007
050800******************************************************************05080007
050900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    05090007
051000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         05100007
051100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     05110007
051200* FORMAT.                                                         05120007
051300******************************************************************05130007
051400     COPY DPPD004.                                                05140007
051500                                                                  05150007
051600     MOVE +4013                  TO ABEND-CODE.                   05160007
051700     CALL 'ILBOABN0' USING ABEND-CODE.                            05170007
