000100 IDENTIFICATION DIVISION.                                         00010018
000200 PROGRAM-ID.  APKRP181.                                           00020018
000300 AUTHOR.  CAROLYN GIFFORD.                                        00030018
000400 DATE-WRITTEN.  AUGUST 1999.                                      00040018
000500 DATE-COMPILED.                                                   00050018
000600*************************************************************     00060018
000700*    COBOL 2                                                *     00070018
000800*                                                           *     00080018
000900*    UNJOURNALIZED RECEIPT BY DIVISION REPORT               *     00090021
001000*                                                           *     00100018
001100*   INPUT:                                                  *     00110021
001200*  1) INTRANSIT-FILE                      (APRD042)         *     00120021
001300*                                                           *     00130021
001400*   OUTPUT:                                                 *     00140021
001500*  1) REPORT-FILE                         (DPWS132O)        *     00150021
001600*                                                           *     00160021
001700*************************************************************     00170018
001800*************************************************************     00180018
001900* CHANGE LOG:                                               *     00190018
002000*                                                           *     00200018
002100*   12/30/01      BY NANCY EILBES              PITS # 440167*     00210020
002200*     INCREASED ENTRIES IN STORE TOTALS TABLE TO 1000.      *     00220019
002300*                                                           *     00230021
002400* 02/04/2003                                                *     00240021
002500*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00250021
002600*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC PROGRAM    *     00260021
002700*    TITLE. UPDATED THE FILE NAMES IN THE PROGRAM COMMENT   *     00270021
002800*    BLOCK. RECOMPILED THE PROGRAM TO PICK UP THE UPDATED   *     00280021
002900*    COPYBOOK.                                              *     00290021
003000* MADE BY:  MIKE BESKE                          WR#: 23500  *     00300021
003010*                                                           *     00301022
003020* 03/31/2004                                                *     00302022
003030*    CHANGE MADE: INCREASED THE W/S STORE FIELDS FROM 3 TO  *     00303022
003040*    4 CHARS.                                               *     00304022
003050* MADE BY:  MIKE BESKE                          WR#: 25805  *     00305022
003051*                                                           *     00305124
003060* 07/20/2008                                                *     00306024
003070*     INCREASED ENTRIES IN STORE TOTALS TABLE TO 1500.      *     00307024
003072* MADE BY: SCOTT KRUSCHKA          WR/IR #: INC000000448984 *     00307224
003080*                                                           *     00308024
003060* 09/07/2021                                                *     00309125
003070*     RECOMPILE FOR NEW VERSION OF APRD042                  *     00309225
003072* MADE BY: JEAN KURK               WR/IR #: CHG0260549      *     00309325
003100*************************************************************     00310018
003200 ENVIRONMENT DIVISION.                                            00320018
003300*************************************************************     00330018
003400 CONFIGURATION SECTION.                                           00340018
003500 INPUT-OUTPUT SECTION.                                            00350018
003600 FILE-CONTROL.                                                    00360018
003700     SELECT INTRANSIT-FILE ASSIGN TO UT-S-INP01.                  00370018
003800                                                                  00380018
003900     SELECT REPORT-FILE ASSIGN    TO UT-S-RPT01.                  00390018
004000                                                                  00400018
004100 DATA DIVISION.                                                   00410018
004200 FILE SECTION.                                                    00420018
004300 FD  INTRANSIT-FILE RECORDING MODE IS F                           00430018
004400                                 LABEL RECORDS ARE STANDARD       00440018
004500                                 BLOCK CONTAINS 0 RECORDS         00450018
004600                                 DATA RECORD IS REPORT-RECORD.    00460018
004700 01  INTRANSIT-RECORD            PIC X(120).                      00470018
004800                                                                  00480018
004900 FD  REPORT-FILE                 RECORDING MODE IS F              00490018
005000                                 LABEL RECORDS ARE STANDARD       00500018
005100                                 BLOCK CONTAINS 0 RECORDS         00510018
005200                                 DATA RECORD IS REPORT-RECORD.    00520018
005300 01  REPORT-RECORD               PIC X(132).                      00530018
005400                                                                  00540018
005500                                                                  00550018
005600*************************************************************     00560018
005700 WORKING-STORAGE SECTION.                                         00570018
005800                                                                  00580018
005900 01  PV-PROGRAM-SWITCHES.                                         00590018
006000     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKRP181'.  00600018
006100     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      00610018
006200     05  PV-CURRENT-DATE.                                         00620018
006300         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00630018
006400         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00640018
006500         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00650018
006600     05  PV-CURRENT-TIME.                                         00660018
006700         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00670018
006800         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00680018
006900         10  FILLER              PIC  9(02)  VALUE ZEROS.         00690018
007000     05  PV-PREV-DMM-NBR         PIC  9(03)  VALUE ZEROES.        00700018
007100     05  PV-REC-DATE.                                             00710018
007200         10 PV-REC-DT-CC         PIC  X(02).                      00720018
007300         10 PV-REC-DT-YY         PIC  X(02).                      00730018
007400         10 FILLER               PIC  X(01).                      00740018
007500         10 PV-REC-DT-MM         PIC  X(02).                      00750018
007600         10 FILLER               PIC  X(01).                      00760018
007700         10 PV-REC-DT-DD         PIC  X(02).                      00770018
007800     05  PV-REC-DT-MDY.                                           00780018
007900         10 PV-REC-MDY-MM        PIC  X(02).                      00790018
008000         10 FILLER               PIC  X(01) VALUE '/'.            00800018
008100         10 PV-REC-MDY-DD        PIC  X(02).                      00810018
008200         10 FILLER               PIC  X(01) VALUE '/'.            00820018
008300         10 PV-REC-MDY-YY        PIC  X(02).                      00830018
008400                                                                  00840018
008500 01  PC-PROGRAM-COUNTERS.                                         00850018
008600     05  PC-LINE-COUNT           PIC S9(03)    VALUE ZEROES       00860018
008700                                               COMP-3.            00870018
008800     05  PC-MAX-LINES            PIC S9(03)    VALUE +60          00880018
008900                                               COMP-3.            00890018
009000     05  PC-PAGE-COUNT           PIC S9(06)    VALUE ZEROES       00900018
009100                                               COMP-3.            00910018
009200     05  PC-DATA-RECS-READ       PIC 9(10)     VALUE ZEROES.      00920018
009300     05  PC-FIN-TOT-COUNT        PIC S9(04)  VALUE +0 COMP SYNC.  00930018
009400                                                                  00940018
009500 01  SW-PROGRAM-SWITCHES.                                         00950018
009600     05  SW-END-OF-INTRANSIT-DATA       PIC  X(01)  VALUE 'N'.    00960018
009700         88 END-OF-INTRANSIT-DATA                   VALUE 'Y'.    00970018
009800     05  SW-STORE-NOT-FOUND             PIC  X(01)  VALUE 'N'.    00980018
009900         88 STORE-NOT-FOUND                         VALUE 'N'.    00990018
010000         88 STORE-FOUND                             VALUE 'Y'.    01000018
010100     05  SW-ALL-STORES-MOVED            PIC  X(01)  VALUE 'N'.    01010018
010200         88 ALL-STORES-MOVED                        VALUE 'Y'.    01020018
010300         88 ALL-STORES-NOT-MOVED                    VALUE 'N'.    01030018
010400     05  WS-BBL-SORT-SW                 PIC  X(01)  VALUE 'N'.    01040018
010500         88  WS-BBL-SORT-COMPLETE                   VALUE 'Y'.    01050018
010600         88  WS-BBL-SORT-NOT-COMPLETE               VALUE 'N'.    01060018
010700                                                                  01070018
010800 01  STR-TOTALS.                                                  01080018
010900     05  STR-TOT-RETAIL      PIC S9(11)V99 COMP-3 VALUE ZEROES.   01090018
011000     05  STR-TOT-COST        PIC S9(11)V99 COMP-3 VALUE ZEROES.   01100018
011100                                                                  01110018
011200 01  GRD-TOTALS.                                                  01120018
011300     05  FIN-GR-TTL-RETAIL   PIC S9(13)V99 COMP-3 VALUE ZEROES.   01130018
011400     05  FIN-GR-TTL-COST     PIC S9(13)V99 COMP-3 VALUE ZEROES.   01140018
011500                                                                  01150018
011600 01 WS-MISC-COUNTS.                                               01160018
011700     05  WS-COMPARISONS      PIC S9(04)  VALUE +0    COMP SYNC.   01170018
011800     05  WS-FIN-TOT-MAX      PIC S9(04)  VALUE +1500 COMP SYNC.   01180023
011900     05  WS-TABLE-SORT-DATA.                                      01190018
012000         10  WS-TBL-STR       PIC X(04).                          01200022
012100         10  WS-TBL-RETAIL    PIC S9(13)V99 COMP-3.               01210018
012200         10  WS-TBL-COST      PIC S9(13)V99 COMP-3.               01220018
012300     05  WS-ABEND-CODE        PIC S9(04)  VALUE +0    COMP.       01230018
012400                                                                  01240018
012500 01  STORE-GRAND-TOTALS-TBL.                                      01250018
012600     05  GR-TOTALS-BY-STORE OCCURS 1500 TIMES                     01260023
012700              INDEXED BY STORE-INDX.                              01270018
012800         10  GR-STORE         PIC X(04).                          01280022
012900         10  GR-TOT-RETAIL    PIC S9(13)V99 COMP-3.               01290018
013000         10  GR-TOT-COST      PIC S9(13)V99 COMP-3.               01300018
013100                                                                  01310018
013200 01  REPORT1-HEADER-1.                                            01320018
013300     05  FILLER               PIC X(42)   VALUE SPACES.           01330018
013400     05  FILLER               PIC X(49)   VALUE                   01340018
013500         '   UNJOURNALIZED RECEIPTS REPORT - BY DIVISION   '.     01350018
013600     05  FILLER               PIC X(42)   VALUE SPACES.           01360018
013700                                                                  01370018
013800 01  REPORT1-HEADER-2.                                            01380018
013900     05  FILLER               PIC  X(30)  VALUE SPACES.           01390018
014000     05  RPT1-TITLE-DIVISION  PIC  X(08)  VALUE 'DIVISION'.       01400018
014100     05  FILLER               PIC  X(01)  VALUE SPACE.            01410018
014200     05  RPT1-DIVISION        PIC  X(03)  VALUE SPACE.            01420018
014300     05  FILLER               PIC  X(01)  VALUE SPACE.            01430018
014400     05  RPT1-TITLE-REST      PIC  X(15)  VALUE 'TOTALS BY STORE'.01440018
014500                                                                  01450018
014600 01  REPORT1-TTL-HDG-2.                                           01460018
014700     05  FILLER               PIC  X(27)  VALUE SPACES.           01470018
014800     05  RPT1-TTL-HEADING     PIC  X(33)  VALUE                   01480018
014900              'TOTALS FOR ALL DIVISIONS BY STORE'.                01490018
015000                                                                  01500018
015100 01  REPORT1-HEADER-3.                                            01510018
015200     05  FILLER               PIC X(83)   VALUE SPACES.           01520018
015300     05  FILLER               PIC X(5)    VALUE 'STORE'.          01530018
015400     05  FILLER               PIC X(9)    VALUE SPACES.           01540018
015500     05  FILLER               PIC X(6)    VALUE 'RETAIL'.         01550018
015600     05  FILLER               PIC X(12)   VALUE SPACES.           01560018
015700     05  FILLER               PIC X(4)    VALUE 'COST'.           01570018
015800     05  FILLER               PIC X(13)   VALUE SPACES.           01580018
015900                                                                  01590018
016000 01  REPORT1-DETAIL.                                              01600018
016100     05  FILLER               PIC X(83)   VALUE SPACES.           01610022
016200     05  RPT1-STORE           PIC X(04)   VALUE SPACE.            01620022
016300     05  FILLER               PIC X(6)    VALUE SPACES.           01630018
016400     05  RPT1-RETAIL          PIC ZZZ,ZZZ,ZZ9.                    01640018
016500     05  FILLER               PIC X(6)    VALUE SPACES.           01650018
016600     05  RPT1-COST            PIC ZZZ,ZZZ,ZZ9.                    01660018
016700     05  FILLER               PIC X(12)   VALUE SPACES.           01670018
016800                                                                  01680018
016900 01  REPORT1-DIVISION-TOTAL.                                      01690018
017000     05  FILLER               PIC X(67)   VALUE SPACES.           01700018
017100     05  FILLER               PIC X(14)   VALUE 'DIVISION TOTAL'. 01710018
017200     05  FILLER               PIC X(9)    VALUE SPACES.           01720018
017300     05  GRAND-RETAIL-TOTAL   PIC ZZ,ZZZ,ZZZ,ZZ9.                 01730018
017400     05  FILLER               PIC X(3)    VALUE SPACES.           01740018
017500     05  GRAND-COST-TOTAL     PIC ZZ,ZZZ,ZZZ,ZZ9.                 01750018
017600     05  FILLER               PIC X(09)   VALUE SPACES.           01760018
017700                                                                  01770018
017800 01  REPORT1-FINAL-TOTALS.                                        01780018
017900     05  FILLER               PIC  X(30)  VALUE SPACES.           01790018
018000     05  RPT1-TITLE-DIVISION  PIC  X(33)  VALUE                   01800018
018100        'TOTAL FOR ALL DIVISIONS BY STORE '.                      01810018
018200     05  FILLER               PIC  X(69)  VALUE SPACE.            01820018
018300                                                                  01830018
018400 01  REPORT1-STORE-TOTALS.                                        01840018
018500     05  FILLER               PIC X(83)   VALUE SPACES.           01850022
018600     05  GRAND-STR-NBR        PIC X(04)   VALUE SPACES.           01860022
018700     05  FILLER               PIC X(3)    VALUE SPACES.           01870018
018800     05  GRAND-STR-RETL-TTL   PIC ZZ,ZZZ,ZZZ,ZZ9.                 01880018
018900     05  FILLER               PIC X(3)    VALUE SPACES.           01890018
019000     05  GRAND-STR-COST-TTL   PIC ZZ,ZZZ,ZZZ,ZZ9.                 01900018
019100     05  FILLER               PIC X(09)   VALUE SPACES.           01910018
019200                                                                  01920018
019300 01  REPORT1-GRAND-TOTALS.                                        01930018
019400     05  FILLER               PIC X(62)   VALUE SPACES.           01940018
019500     05  FILLER               PIC X(19)   VALUE                   01950018
019600                            'ALL DIVISION TOTALS'.                01960018
019700     05  FILLER               PIC X(9)    VALUE SPACES.           01970018
019800     05  FIN-GR-RETAIL-TTL    PIC ZZ,ZZZ,ZZZ,ZZ9.                 01980018
019900     05  FILLER               PIC X(3)    VALUE SPACES.           01990018
020000     05  FIN-GR-COST-TTL      PIC ZZ,ZZZ,ZZZ,ZZ9.                 02000018
020100     05  FILLER               PIC X(09)   VALUE SPACES.           02010018
020200                                                                  02020018
020300***** REPORT LAYOUT                                               02030018
020400     COPY DPWS132O.                                               02040018
020500                                                                  02050018
020600***** INPUT FILE LAYOUT                                           02060018
020700     COPY APRD042.                                                02070018
020800                                                                  02080018
020900 PROCEDURE DIVISION.                                              02090018
021000 A100-MAINLINE.                                                   02100018
021100     PERFORM B100-INITIALIZATION.                                 02110018
021200                                                                  02120018
021300     PERFORM B200-PROCESS-VENDOR-DATA                             02130018
021400             UNTIL END-OF-INTRANSIT-DATA.                         02140018
021500                                                                  02150018
021600     PERFORM W300-WRITE-DIV-GRAND-TTLS.                           02160018
021700     PERFORM W100-WRITE-REPORT-HEADINGS.                          02170018
021800                                                                  02180018
021900** SORT FINAL TOTAL TABLE IN STORE ORDER                          02190018
022000     SET WS-BBL-SORT-NOT-COMPLETE TO TRUE.                        02200018
022100     COMPUTE WS-COMPARISONS = PC-FIN-TOT-COUNT - 1.               02210018
022200     PERFORM C300-SORT-FIN-TOTAL-TABLE                            02220018
022300         UNTIL WS-BBL-SORT-COMPLETE                               02230018
022400            OR WS-COMPARISONS = 0.                                02240018
022500                                                                  02250018
022600     PERFORM W400-WRITE-FINAL-GRAND-TOTALS                        02260018
022700         VARYING STORE-INDX FROM 1 BY 1 UNTIL                     02270018
022800           STORE-INDX > PC-FIN-TOT-COUNT.                         02280018
022900                                                                  02290018
023000     PERFORM W500-WRITE-ALL-DIV-TTLS.                             02300018
023100                                                                  02310018
023200     PERFORM B300-TERMINATION.                                    02320018
023300                                                                  02330018
023400     GOBACK.                                                      02340018
023500                                                                  02350018
023600******************************************************************02360018
023700** OPEN INPUT FILE, INITIALIZE VARIABLES, AND DO A PRIMING READ **02370018
023800** ON THE INTRANSIT DATA FILE.                                  **02380018
023900******************************************************************02390018
024000 B100-INITIALIZATION.                                             02400018
024100     OPEN INPUT  INTRANSIT-FILE                                   02410018
024200          OUTPUT REPORT-FILE.                                     02420018
024300                                                                  02430018
024400     INITIALIZE AP042-EXTRACT-FILE                                02440018
024500                PV-PREV-DMM-NBR                                   02450018
024600                STORE-GRAND-TOTALS-TBL                            02460018
024700                PC-DATA-RECS-READ                                 02470018
024800                PC-FIN-TOT-COUNT                                  02480018
024900                GRD-TOTALS                                        02490018
025000                STR-TOTALS.                                       02500018
025100                                                                  02510018
025200     MOVE 'N' TO SW-END-OF-INTRANSIT-DATA.                        02520018
025300                                                                  02530018
025400     ACCEPT PV-CURRENT-DATE FROM DATE.                            02540018
025500     MOVE PV-CURRENT-MONTH            TO DP132O-RUN-MONTH.        02550018
025600     MOVE PV-CURRENT-DAY              TO DP132O-RUN-DAY.          02560018
025700     MOVE PV-CURRENT-YEAR             TO DP132O-RUN-YEAR.         02570018
025800                                                                  02580018
025900     ACCEPT PV-CURRENT-TIME FROM TIME.                            02590018
026000     MOVE PV-CURRENT-HOUR             TO DP132O-RUN-HOUR.         02600018
026100     MOVE PV-CURRENT-MINUTE           TO DP132O-RUN-MINUTE.       02610018
026200     MOVE PV-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     02620018
026300     MOVE 1                           TO DP132O-REPORT-NUMBER.    02630018
026400                                                                  02640018
026500                                                                  02650018
026600     PERFORM R100-READ-INTRANSIT-FILE.                            02660018
026700                                                                  02670018
026800     MOVE AP042-DMM-NBR       TO RPT1-DIVISION.                   02680018
026900     PERFORM W100-WRITE-REPORT-HEADINGS.                          02690018
027000                                                                  02700018
027100 B200-PROCESS-VENDOR-DATA.                                        02710018
027200     IF AP042-DMM-NBR NOT = PV-PREV-DMM-NBR AND                   02720018
027300        PV-PREV-DMM-NBR NOT = ZEROES                              02730018
027400                                                                  02740018
027500* WHEN MAXIMUM NUMBER OF STORES IS REACHED ABEND PROGRAM          02750018
027600* TABLE SIZE WILL NEED TO BE INCREASED                            02760018
027700        IF STORE-INDX > WS-FIN-TOT-MAX                            02770018
027800           DISPLAY '**** ABEND ---- PROGRAM APKRP181'             02780018
027900           DISPLAY '**** FINAL TOTAL TABLE OVERFLOW'              02790018
028000           MOVE +4004     TO WS-ABEND-CODE                        02800018
028100           CALL 'ILBOABN0' USING WS-ABEND-CODE                    02810018
028200        END-IF                                                    02820018
028300                                                                  02830018
028400        PERFORM W300-WRITE-DIV-GRAND-TTLS                         02840018
028500        MOVE AP042-DMM-NBR       TO RPT1-DIVISION                 02850018
028600        PERFORM W100-WRITE-REPORT-HEADINGS                        02860018
028700        PERFORM C100-MOVES-TO-DETAIL                              02870018
028800        MOVE AP042-DMM-NBR  TO PV-PREV-DMM-NBR                    02880018
028900                                                                  02890018
029000        PERFORM W200-WRITE-DIVISION-TOTALS                        02900018
029100                                                                  02910018
029200        SET STORE-NOT-FOUND TO TRUE                               02920018
029300        PERFORM C200-ADD-DIVISION-TO-FINAL                        02930018
029400           VARYING STORE-INDX FROM 1 BY 1                         02940018
029500               UNTIL STORE-FOUND OR STORE-INDX > WS-FIN-TOT-MAX   02950018
029600                                                                  02960018
029700     ELSE                                                         02970018
029800        PERFORM C100-MOVES-TO-DETAIL                              02980018
029900        IF PV-PREV-DMM-NBR = ZEROES                               02990018
030000           MOVE AP042-DMM-NBR  TO PV-PREV-DMM-NBR                 03000018
030100                                  RPT1-DIVISION                   03010018
030200        END-IF                                                    03020018
030300        PERFORM W200-WRITE-DIVISION-TOTALS                        03030018
030400                                                                  03040018
030500        SET STORE-NOT-FOUND TO TRUE                               03050018
030600        PERFORM C200-ADD-DIVISION-TO-FINAL                        03060018
030700           VARYING STORE-INDX FROM 1 BY 1                         03070018
030800               UNTIL STORE-FOUND OR STORE-INDX > WS-FIN-TOT-MAX.  03080018
030900                                                                  03090018
031000     PERFORM R100-READ-INTRANSIT-FILE.                            03100018
031100                                                                  03110018
031200******************************************************************03120018
031300**  CLOSE THE OUTPUT FILES.                                     **03130018
031400******************************************************************03140018
031500 B300-TERMINATION.                                                03150018
031600                                                                  03160018
031700     DISPLAY '**** PROGRAM APKRP181 COMPLETED NORMALLY **'.       03170018
031800     DISPLAY ' INTRANSIT RECS READ   =  ' PC-DATA-RECS-READ.      03180018
031900                                                                  03190018
032000     CLOSE INTRANSIT-FILE                                         03200018
032100           REPORT-FILE.                                           03210018
032200                                                                  03220018
032300 C100-MOVES-TO-DETAIL.                                            03230018
032400     MOVE AP042-STR-NBR             TO RPT1-STORE.                03240018
032500     MOVE AP042-CALCD-VRFD-RTL-AMT  TO RPT1-RETAIL.               03250018
032600     MOVE AP042-CALCD-VRFD-COST-AMT TO RPT1-COST.                 03260018
032700                                                                  03270018
032800     ADD AP042-CALCD-VRFD-RTL-AMT   TO STR-TOT-RETAIL.            03280018
032900     ADD AP042-CALCD-VRFD-COST-AMT  TO STR-TOT-COST.              03290018
033000                                                                  03300018
033100 C200-ADD-DIVISION-TO-FINAL.                                      03310018
033200     IF GR-STORE (STORE-INDX) = AP042-STR-NBR                     03320018
033300       ADD AP042-CALCD-VRFD-RTL-AMT  TO GR-TOT-RETAIL (STORE-INDX)03330018
033400       ADD AP042-CALCD-VRFD-COST-AMT TO GR-TOT-COST (STORE-INDX)  03340018
033500       SET STORE-FOUND TO TRUE                                    03350018
033600     ELSE                                                         03360018
033700     IF GR-STORE (STORE-INDX) = SPACES                            03370018
033800       MOVE AP042-STR-NBR TO GR-STORE (STORE-INDX)                03380018
033900       ADD AP042-CALCD-VRFD-RTL-AMT  TO GR-TOT-RETAIL (STORE-INDX)03390018
034000       ADD AP042-CALCD-VRFD-COST-AMT TO GR-TOT-COST (STORE-INDX)  03400018
034100       ADD +1                        TO PC-FIN-TOT-COUNT          03410018
034200       SET STORE-FOUND TO TRUE.                                   03420018
034300                                                                  03430018
034400******************************************************************03440018
034500**         BUBBLE SORT THE FINAL TOTAL TABLE BY STORE           **03450018
034600******************************************************************03460018
034700 C300-SORT-FIN-TOTAL-TABLE.                                       03470018
034800     SET WS-BBL-SORT-COMPLETE TO TRUE.                            03480018
034900     SET STORE-INDX           TO 1.                               03490018
035000     PERFORM C400-COMPARE-TABLE-ENTRIES                           03500018
035100         UNTIL STORE-INDX > WS-COMPARISONS.                       03510018
035200     SUBTRACT 1 FROM WS-COMPARISONS.                              03520018
035300                                                                  03530018
035400 C400-COMPARE-TABLE-ENTRIES.                                      03540018
035500     IF  GR-STORE (STORE-INDX) > GR-STORE (STORE-INDX + 1)        03550018
035600         MOVE GR-TOTALS-BY-STORE (STORE-INDX)                     03560018
035700                            TO WS-TABLE-SORT-DATA                 03570018
035800         MOVE GR-TOTALS-BY-STORE (STORE-INDX + 1)                 03580018
035900                            TO GR-TOTALS-BY-STORE (STORE-INDX)    03590018
036000         MOVE WS-TABLE-SORT-DATA                                  03600018
036100                            TO GR-TOTALS-BY-STORE                 03610018
036200                                                 (STORE-INDX + 1) 03620018
036300         SET WS-BBL-SORT-NOT-COMPLETE TO TRUE                     03630018
036400     END-IF.                                                      03640018
036500     SET STORE-INDX UP BY 1.                                      03650018
036600                                                                  03660018
036700 R100-READ-INTRANSIT-FILE.                                        03670018
036800     INITIALIZE AP042-EXTRACT-FILE.                               03680018
036900                                                                  03690018
037000     READ INTRANSIT-FILE INTO AP042-EXTRACT-FILE                  03700018
037100        AT END                                                    03710018
037200        SET END-OF-INTRANSIT-DATA TO TRUE.                        03720018
037300                                                                  03730018
037400     IF NOT END-OF-INTRANSIT-DATA                                 03740018
037500        ADD 1 TO PC-DATA-RECS-READ.                               03750018
037600                                                                  03760018
037700******************************************************************03770018
037800**               WRITE REPORT HEADINGS                          **03780018
037900******************************************************************03790018
038000 W100-WRITE-REPORT-HEADINGS.                                      03800018
038100                                                                  03810018
038200     ADD 1                            TO PC-PAGE-COUNT.           03820018
038300     MOVE PC-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      03830018
038400                                                                  03840018
038500     WRITE REPORT-RECORD                                          03850018
038600           FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.        03860018
038700     WRITE REPORT-RECORD FROM REPORT1-HEADER-1 AFTER 1.           03870018
038800                                                                  03880018
038900                                                                  03890018
039000     IF END-OF-INTRANSIT-DATA                                     03900018
039100       WRITE REPORT-RECORD     FROM REPORT1-TTL-HDG-2 AFTER 2     03910018
039200     ELSE                                                         03920018
039300       WRITE REPORT-RECORD     FROM REPORT1-HEADER-2 AFTER 2.     03930018
039400                                                                  03940018
039500     WRITE REPORT-RECORD       FROM REPORT1-HEADER-3 AFTER 1.     03950018
039600                                                                  03960018
039700     MOVE SPACES TO REPORT-RECORD.                                03970018
039800     WRITE REPORT-RECORD AFTER 1.                                 03980018
039900     MOVE 5  TO PC-LINE-COUNT.                                    03990018
040000                                                                  04000018
040100 W200-WRITE-DIVISION-TOTALS.                                      04010018
040200     IF PC-LINE-COUNT > PC-MAX-LINES                              04020018
040300         MOVE AP042-DMM-NBR       TO RPT1-DIVISION                04030018
040400         PERFORM W100-WRITE-REPORT-HEADINGS                       04040018
040500     END-IF.                                                      04050018
040600                                                                  04060018
040700     WRITE REPORT-RECORD FROM REPORT1-DETAIL AFTER 1.             04070018
040800                                                                  04080018
040900     ADD 1 TO PC-LINE-COUNT.                                      04090018
041000                                                                  04100018
041100     INITIALIZE REPORT1-DETAIL.                                   04110018
041200                                                                  04120018
041300 W300-WRITE-DIV-GRAND-TTLS.                                       04130018
041400     IF PC-LINE-COUNT > PC-MAX-LINES                              04140018
041500         MOVE PV-PREV-DMM-NBR     TO RPT1-DIVISION                04150018
041600         PERFORM W100-WRITE-REPORT-HEADINGS                       04160018
041700     END-IF.                                                      04170018
041800                                                                  04180018
041900     MOVE STR-TOT-RETAIL TO GRAND-RETAIL-TOTAL.                   04190018
042000     MOVE STR-TOT-COST   TO GRAND-COST-TOTAL.                     04200018
042100     INITIALIZE STR-TOTALS.                                       04210018
042200                                                                  04220018
042300     WRITE REPORT-RECORD FROM REPORT1-DIVISION-TOTAL AFTER 2.     04230018
042400                                                                  04240018
042500     ADD 2 TO PC-LINE-COUNT.                                      04250018
042600                                                                  04260018
042700     INITIALIZE REPORT1-DIVISION-TOTAL.                           04270018
042800                                                                  04280018
042900 W400-WRITE-FINAL-GRAND-TOTALS.                                   04290018
043000     IF PC-LINE-COUNT > PC-MAX-LINES                              04300018
043100         PERFORM W100-WRITE-REPORT-HEADINGS                       04310018
043200     END-IF.                                                      04320018
043300                                                                  04330018
043400     MOVE GR-STORE (STORE-INDX)      TO GRAND-STR-NBR.            04340018
043500     MOVE GR-TOT-RETAIL (STORE-INDX) TO GRAND-STR-RETL-TTL.       04350018
043600     MOVE GR-TOT-COST (STORE-INDX)   TO GRAND-STR-COST-TTL.       04360018
043700                                                                  04370018
043800     ADD GR-TOT-RETAIL (STORE-INDX)  TO FIN-GR-TTL-RETAIL.        04380018
043900     ADD GR-TOT-COST (STORE-INDX)    TO FIN-GR-TTL-COST.          04390018
044000                                                                  04400018
044100     WRITE REPORT-RECORD FROM REPORT1-STORE-TOTALS AFTER 1.       04410018
044200                                                                  04420018
044300     ADD 1 TO PC-LINE-COUNT.                                      04430018
044400                                                                  04440018
044500     INITIALIZE REPORT1-STORE-TOTALS.                             04450018
044600                                                                  04460018
044700 W500-WRITE-ALL-DIV-TTLS.                                         04470018
044800     IF PC-LINE-COUNT > PC-MAX-LINES                              04480018
044900         PERFORM W100-WRITE-REPORT-HEADINGS                       04490018
045000     END-IF.                                                      04500018
045100                                                                  04510018
045200     MOVE FIN-GR-TTL-RETAIL TO FIN-GR-RETAIL-TTL.                 04520018
045300     MOVE FIN-GR-TTL-COST   TO FIN-GR-COST-TTL.                   04530018
045400                                                                  04540018
045500     WRITE REPORT-RECORD FROM REPORT1-GRAND-TOTALS AFTER 2.       04550018
045600                                                                  04560018
