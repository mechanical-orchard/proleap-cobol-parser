       IDENTIFICATION DIVISION.                                         00010091
       PROGRAM-ID.      XSKUT013.                                       00020091
       AUTHOR.          KOHLS DEPARTMENT STORES.                        00030091
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040091
       DATE-WRITTEN.    09/26/2002.                                     00050091
       DATE-COMPILED.                                                   00060091
      ******************************************************************00070091
      **XS MQ RMS MERCHANDISE HIERACRHY MESSAGING UPDATES FOR TABLES:   00080091
      **                          XST_BUS_AREA                          00090091
      **                          XST_BUS_GP                            00100091
      **                          XST_DEPT                              00110091
091004**                          XST_MAJ_CL                            00120091
      **                          XST_SUB_CL                            00130091
      ******************************************************************00140091
      **THIS PROGRAM EVALUATES THE TABLE TO BE UPDATED SENT BY RMS IN   00150091
      **     COPYBOOK FORMAT HMRD001 CALLS THE PROGRAM TO EXECUTE THE   00160091
      **     UPDATE/INSERT/DELETE FOR THAT TABLE.                       00170091
      ******************************************************************00180091
      *DATE:09/03/2002   MADE BY:JULIE SMITH INITIAL PROGRAM WRITE      00190091
110602*DATE:11/06/2002   MADE BY:JULIE SMITH CHANGE END OF DAY MESSAGE  00200091
111302*DATE:11/13/2002   MADE BY:JULIE SMITH ADD CORRELID TO PUT        00210091
121402*DATE:12/14/2002   MADE BY:JULIE SMITH ADDITIONAL TIMESTAMPS      00220091
091004*DATE:09/10/2004   MADE BY:JULIE TEWES ADD XST_MAJ_CL TABLE MSGS  00230091
121609*DATE:12/16/2009   MADE BY:JIM ARENDT  IF THE CALL TO XSKUP027    00240092
121609*                          RESULTS IN A BUSINESS GROUP DELETE OR  00250092
121609*                          ADD, EXIT WITH A RETURN CODE OF 4051.  00260092
      ******************************************************************00270091
       ENVIRONMENT DIVISION.                                            00280091
       CONFIGURATION SECTION.                                           00290091
       SOURCE-COMPUTER.        IBM-3090.                                00300091
       OBJECT-COMPUTER.        IBM-3090.                                00310091
       INPUT-OUTPUT SECTION.                                            00320091
       FILE-CONTROL.                                                    00330091
                                                                        00340091
           SELECT CONTROL-CARD-1                                        00350091
                  ASSIGN TO INP01.                                      00360091
           SELECT CONTROL-CARD-2                                        00370091
                  ASSIGN TO INP02.                                      00380091
           SELECT CONTROL-CARD-3                                        00390091
                  ASSIGN TO INP03.                                      00400091
           SELECT MESSAGE-LOG                                           00410091
                  ASSIGN TO OUT01.                                      00420091
                                                                        00430091
       DATA DIVISION.                                                   00440091
       FILE SECTION.                                                    00450091
                                                                        00460091
       FD  CONTROL-CARD-1                                               00470091
           RECORDING MODE F                                             00480091
           BLOCK CONTAINS 0 RECORDS                                     00490091
           LABEL RECORDS ARE OMITTED                                    00500091
           DATA RECORD IS CONTROL-CARD-1-RECORD.                        00510091
       01  CONTROL-CARD-1-RECORD           PIC X(080).                  00520091
                                                                        00530091
       FD  CONTROL-CARD-2                                               00540091
           RECORDING MODE F                                             00550091
           BLOCK CONTAINS 0 RECORDS                                     00560091
           LABEL RECORDS ARE OMITTED                                    00570091
           DATA RECORD IS CONTROL-CARD-2-RECORD.                        00580091
       01  CONTROL-CARD-2-RECORD           PIC X(080).                  00590091
                                                                        00600091
       FD  CONTROL-CARD-3                                               00610091
           RECORDING MODE F                                             00620091
           BLOCK CONTAINS 0 RECORDS                                     00630091
           LABEL RECORDS ARE OMITTED                                    00640091
           DATA RECORD IS CONTROL-CARD-3-RECORD.                        00650091
       01  CONTROL-CARD-3-RECORD           PIC X(080).                  00660091
                                                                        00670091
       FD  MESSAGE-LOG                                                  00680091
           RECORDING MODE F                                             00690091
           BLOCK CONTAINS 0 RECORDS                                     00700091
           LABEL RECORDS ARE OMITTED                                    00710091
           DATA RECORD IS MESSAGE-LOG-RECORD.                           00720091
       01  MESSAGE-LOG-RECORD              PIC X(500).                  00730091
                                                                        00740091
       WORKING-STORAGE SECTION.                                         00750091
      ******************************************************************00760091
      **PROGRAM SWITCHES                                                00770091
      ******************************************************************00780091
       01  PS-PROGRAM-SWITCHES.                                         00790091
           05  PS-PROCESS-INDICATOR-SW         PIC X(01)   VALUE 'Y'.   00800091
               88  PS-PROCESS-COMPLETE                     VALUE 'N'.   00810091
               88  PS-PROCESS-CONTINUE                     VALUE 'Y'.   00820091
121609     05  PS-SEND-EMAIL-SW                PIC X(01)   VALUE 'N'.   00830092
121609         88  PS-SEND-EMAIL-NO                        VALUE 'N'.   00840092
121609         88  PS-SEND-EMAIL-YES                       VALUE 'Y'.   00850092
                                                                        00860093
      ******************************************************************00870091
      **CONTROL CARD 1 RECORD LAYOUT - QUEUE MANAGER NAME               00880091
      ******************************************************************00890091
       01  CC-CONTROL-CARD-1-LAYOUT.                                    00900091
           05  CC-QUEUE-MANAGER-NAME      PIC X(48)   VALUE SPACES.     00910091
           05  FILLER                     PIC X(32)   VALUE SPACES.     00920091
                                                                        00930093
      ******************************************************************00940091
      **CONTROL CARD 2 RECORD LAYOUT - MERCH HIER QUEUE NAME            00950091
      ******************************************************************00960091
       01  CC-CONTROL-CARD-2-LAYOUT.                                    00970091
           05  CC-MERCH-HIER-QUEUE-NAME   PIC X(48)   VALUE SPACES.     00980091
           05  FILLER                     PIC X(32)   VALUE SPACES.     00990091
                                                                        01000093
      ******************************************************************01010091
      **CONTROL CARD 3 RECORD LAYOUT - MERCH HIER ERROR QUEUE NAME      01020091
      ******************************************************************01030091
       01  CC-CONTROL-CARD-3-LAYOUT.                                    01040091
           05  CC-MRH-HR-ERROR-QUEUE-NAME PIC X(48)   VALUE SPACES.     01050091
           05  FILLER                     PIC X(32)   VALUE SPACES.     01060091
                                                                        01070093
      ******************************************************************01080091
      **PROGRAM CONSTANTS                                               01090091
      ******************************************************************01100091
       01  PC-PROGRAM-CONSTANTS.                                        01110091
           05  PC-CURRENT-PROGRAM-NAME    PIC X(08)   VALUE 'XSKUT013'. 01120091
           05  PC-CALLED-PROGRAM          PIC X(08).                    01130091
               88  PC-CALLED-XSKUP017                 VALUE 'XSKUP017'. 01140091
               88  PC-CALLED-XSKUP018                 VALUE 'XSKUP018'. 01150091
               88  PC-CALLED-XSKUP026                 VALUE 'XSKUP026'. 01160091
               88  PC-CALLED-XSKUP027                 VALUE 'XSKUP027'. 01170091
               88  PC-CALLED-XSKUP029                 VALUE 'XSKUP029'. 01180091
               88  PC-CALLED-XSKUP030                 VALUE 'XSKUP030'. 01190091
091004         88  PC-CALLED-XSKUP086                 VALUE 'XSKUP086'. 01200091
                                                                        01210093
      ******************************************************************01220091
      **COPYBOOK FIELDS                                                 01230091
      ******************************************************************01240091
       01  CF-COPYOOK-FIELDS.                                           01250091
           05  CF-HM001-RMS-TBL-NAME      PIC X(30).                    01260091
               88  PC-HM001-TBL-NAME-SCLASS                             01270091
                             VALUE 'SUBCLASS                      '.    01280091
               88  PC-HM001-TBL-NAME-SCLASS-ATTR                        01290091
                             VALUE 'K_EMT_SUBCLASS_ATTRIBUTES     '.    01300091
091004         88  PC-HM001-TBL-NAME-MCLASS                             01310091
091004                       VALUE 'CLASS                         '.    01320091
               88  PC-HM001-TBL-NAME-DEPS                               01330091
                             VALUE 'DEPS                          '.    01340091
               88  PC-HM001-TBL-NAME-DEPS-ATTR                          01350091
                             VALUE 'K_EMT_DEPS_ATTRIBUTES         '.    01360091
               88  PC-HM001-TBL-NAME-BUS-GROUPS                         01370091
                             VALUE 'K_EMT_BUSINESS_GROUP          '.    01380091
               88  PC-HM001-TBL-NAME-BUS-AREA                           01390091
                             VALUE 'K_EMT_BUSINESS_AREA           '.    01400091
               88  PC-HM001-TBL-NAME-END-OF-DAY                         01410091
110602                       VALUE 'END RUN OF PROGRAM            '.    01420091
                                                                        01430093
      ******************************************************************01440091
      **MQ WORKING STORAGE                                              01450091
      ******************************************************************01460091
       01  MQV-WORKING-STORAGE.                                         01470091
           05  MQV-MQCONN                 PIC  X(08) VALUE 'CSQBCONN'.  01480091
           05  MQV-MQOPEN                 PIC  X(08) VALUE 'CSQBOPEN'.  01490091
           05  MQV-MQPUT                  PIC  X(08) VALUE 'CSQBPUT'.   01500091
           05  MQV-MQGET                  PIC  X(08) VALUE 'CSQBGET'.   01510091
           05  MQV-MQCMIT                 PIC  X(08) VALUE 'CSQBCOMM'.  01520091
           05  MQV-MQBACK                 PIC  X(08) VALUE 'CSQBBACK'.  01530091
           05  MQV-MQCLOSE                PIC  X(08) VALUE 'CSQBCLOS'.  01540091
           05  MQV-MQDISC                 PIC  X(08) VALUE 'CSQBDISC'.  01550091
           05  MQV-MQCHECK                PIC  X(08) VALUE 'MQR2C'.     01560091
           05  MQV-HCONN                  PIC S9(09) BINARY VALUE 0.    01570091
           05  MQV-COMPLETION-CODE        PIC S9(09) BINARY.            01580091
           05  MQV-REASON                 PIC S9(09) BINARY.            01590091
           05  MQV-OPEN-OPTIONS           PIC S9(09) BINARY.            01600091
           05  MQV-ITEM-HANDLE            PIC S9(09) BINARY VALUE 0.    01610091
           05  MQV-ERROR-HANDLE           PIC S9(09) BINARY VALUE 0.    01620091
           05  MQV-REASON-TEXT            PIC X(30)  VALUE SPACES.      01630091
           05  MQV-MSGBUFFER              PIC X(450) VALUE SPACES.      01640091
           05  MQV-MSG                    PIC X(450) VALUE SPACES.      01650091
           05  MQV-ERRMSGBUF              PIC X(500) VALUE SPACES.      01660091
           05  MQV-MSG-LENGTH             PIC S9(09) BINARY VALUE +500. 01670091
           05  MQV-DATA-LENGTH            PIC S9(09) BINARY.            01680091
                                                                        01690093
      ******************************************************************01700091
      **COPYBOOKS                                                       01710091
      ******************************************************************01720091
      ***INPUT FILE LAYOUT - MERCH HIER MESSAGE COPYBOOK                01730091
           COPY HMRD001.                                                01740091
      ***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        01750091
           COPY DPWS004.                                                01760091
      ***DB2 ABEND COPYBOOK                                             01770091
           COPY DPWS900.                                                01780091
      ***DB2 MESSAGE AREA                                               01790091
           COPY SQLCA2.                                                 01800091
      ***OBJECT-DESCRIPTOR.                                             01810091
       01  MQM-OBJECT-DESCRIPTOR.                                       01820091
           COPY CMQODV.                                                 01830091
      ***MESSAGE-DESCRIPTOR.                                            01840091
       01  MQM-MESSAGE-DESCRIPTOR.                                      01850091
           COPY CMQMDV.                                                 01860091
      ***GET-MESSAGE-OPTIONS.                                           01870091
       01  MQM-GET-MESSAGE-OPTIONS.                                     01880091
           COPY CMQGMOV.                                                01890091
      ***PUT-MESSAGE-OPTIONS.                                           01900091
       01  MQM-PUT-MESSAGE-OPTIONS.                                     01910091
           COPY CMQPMOV.                                                01920091
      ***CONSTANTS.                                                     01930091
       01  MQM-CONSTANTS.                                               01940091
           COPY CMQV.                                                   01950091
                                                                        01960093
      ******************************************************************01970091
      **PROGRAM COUNTERS                                                01980091
      ******************************************************************01990091
       01  PC-PROGRAM-COUNTERS.                                         02000091
           05  PC-MESSAGE-FROM-QUEUE        PIC 9(06) VALUE ZEROS.      02010091
           05  PC-MESSAGES-WRITTEN-TO-FILE  PIC 9(06) VALUE ZEROS.      02020091
           05  PC-MESSAGES-TO-ERROR-QUEUE   PIC 9(06) VALUE ZEROS.      02030091
091004     05  PC-MESSAGE-MAJCLASS          PIC 9(06) VALUE ZEROS.      02040091
           05  PC-MESSAGE-SUBCLASS          PIC 9(06) VALUE ZEROS.      02050091
           05  PC-MESSAGE-SUBCLASS-ATTR     PIC 9(06) VALUE ZEROS.      02060091
           05  PC-MESSAGE-DEPS              PIC 9(06) VALUE ZEROS.      02070091
           05  PC-MESSAGE-DEPS-ATTR         PIC 9(06) VALUE ZEROS.      02080091
           05  PC-MESSAGE-BUS-GROUP         PIC 9(06) VALUE ZEROS.      02090091
           05  PC-MESSAGE-BUS-AREA          PIC 9(06) VALUE ZEROS.      02100091
                                                                        02110093
      ******************************************************************02120091
      **ERROR HANDLING                                                  02130091
      ******************************************************************02140091
       01  PV-MISC-ABEND-FIELDS.                                        02150091
           05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      02160091
           05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      02170091
           05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      02180091
           05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      02190091
                                                                        02200093
       01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 02210091
           88  ABEND-4001-WRITE-ERROR            VALUE +4001.           02220091
           88  ABEND-4002-READ-ERROR             VALUE +4002.           02230091
           88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           02240091
           88  ABEND-4004-TABLE-ERROR            VALUE +4004.           02250091
           88  ABEND-4005-OPEN-ERROR             VALUE +4005.           02260091
           88  ABEND-4006-CLOSE-ERROR            VALUE +4006.           02270091
           88  ABEND-4007-SEQUENCE-ERROR         VALUE +4007.           02280091
           88  ABEND-4008-DATA-ERROR             VALUE +4008.           02290091
           88  ABEND-4009-KEY-DATA-ERROR         VALUE +4009.           02300091
           88  ABEND-4013-DB2-ERROR              VALUE +4013.           02310091
           88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           02320091
           88  ABEND-4444-FORCED-ABEND           VALUE +4444.           02330091
                                                                        02340093
      ******************************************************************02350091
      **TABLE INCLUSIONS                                                02360091
      ******************************************************************02370091
      ***DB2 COMMUNICATIONS AREA                                        02380091
           EXEC SQL                                                     02390091
                INCLUDE SQLCA                                           02400091
           END-EXEC.                                                    02410091
                                                                        02420093
      ***TABLE XST_SUB_CL                                               02430091
           EXEC SQL                                                     02440091
                INCLUDE XST00014                                        02450091
           END-EXEC.                                                    02460091
                                                                        02470093
      ***TABLE XST_DEPT                                                 02480091
           EXEC SQL                                                     02490091
                INCLUDE XST00015                                        02500091
           END-EXEC.                                                    02510091
                                                                        02520093
      ***TABLE XST_BUS_GP                                               02530091
           EXEC SQL                                                     02540091
                INCLUDE XST00016                                        02550091
           END-EXEC.                                                    02560091
                                                                        02570093
      ***TABLE XST_BUS_AREA                                             02580091
           EXEC SQL                                                     02590091
                INCLUDE XST00024                                        02600091
           END-EXEC.                                                    02610091
                                                                        02620093
091004***TABLE XST_MAJ_CL                                               02630091
091004     EXEC SQL                                                     02640091
091004          INCLUDE XST00071                                        02650091
091004     END-EXEC.                                                    02660091
                                                                        02670093
      ******************************************************************02680091
      **LINKAGE VARIABLES                                               02690091
      ******************************************************************02700091
       01  LV-LINKAGE-VARIABLES.                                        02710091
           05  LV-RETURN-CODE               PIC S9(04) VALUE ZEROS.     02720091
           05  LV-CURRENT-TIMESTAMP         PIC X(26)  VALUE SPACES.    02730091
           05  LV-HMRD001-RECORD            PIC X(500) VALUE SPACES.    02740091
                                                                        02750091
       PROCEDURE DIVISION.                                              02760091
      ***************************************************************** 02770091
                                                                        02780091
           PERFORM 1000-INITIALIZATION.                                 02790091
           PERFORM 2000-PROCESS-RECORDS                                 02800091
                   UNTIL PS-PROCESS-COMPLETE.                           02810091
           PERFORM 9999-WRAPUP.                                         02820091
           GOBACK.                                                      02830091
                                                                        02840091
       EJECT.                                                           02850091
      ******************************************************************02860091
      **INITIALIZATION AREA - SETUP QUEUES FOR PROCESSING               02870091
      ******************************************************************02880091
       1000-INITIALIZATION.                                             02890091
                                                                        02900091
           MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             02910091
121609     DISPLAY ' '.                                                 02920094
                                                                        02930091
           OPEN INPUT  CONTROL-CARD-1                                   02940091
                       CONTROL-CARD-2                                   02950091
                       CONTROL-CARD-3                                   02960091
                OUTPUT MESSAGE-LOG.                                     02970091
                                                                        02980091
           PERFORM 9999-READ-CONTROL-CARD-1.                            02990091
           PERFORM 9999-READ-CONTROL-CARD-2.                            03000091
           PERFORM 9999-READ-CONTROL-CARD-3.                            03010091
                                                                        03020091
           IF  CC-QUEUE-MANAGER-NAME    =  SPACES                       03030091
            OR CC-MERCH-HIER-QUEUE-NAME =  SPACES                       03040091
            OR CC-MRH-HR-ERROR-QUEUE-NAME =  SPACES                     03050091
               DISPLAY 'EMPTY CONTROL CARD'                             03060091
               DISPLAY 'QUEUE MANAGER NAME    ' CC-QUEUE-MANAGER-NAME   03070091
               DISPLAY 'MERCH HIER QUEUE NAME ' CC-MERCH-HIER-QUEUE-NAME03080091
               DISPLAY 'MERCH HIER ERROR QUEUE NAME '                   03090091
                                         CC-MRH-HR-ERROR-QUEUE-NAME     03100091
               PERFORM 9999-MQ-ABEND                                    03110091
           END-IF.                                                      03120091
                                                                        03130091
           PERFORM 1100-CONNECT-TO-QMGR.                                03140091
           PERFORM 1200-OPEN-MERCH-QUEUE.                               03150091
           PERFORM 1300-OPEN-MRCH-HR-ERROR-QUEUE.                       03160091
                                                                        03170091
           PERFORM 9999-RETRIEVE-MESSAGE.                               03180091
                                                                        03190091
       EJECT.                                                           03200091
      ******************************************************************03210091
      **CONNECT TO THE QUEUE MANAGER                                    03220091
      ******************************************************************03230091
       1100-CONNECT-TO-QMGR.                                            03240091
                                                                        03250091
           MOVE '1100-CONNECT-TO-QMGR'       TO PV-PARAGRAPH-NAME.      03260091
                                                                        03270091
           CALL MQV-MQCONN USING CC-QUEUE-MANAGER-NAME                  03280091
                                 MQV-HCONN                              03290091
                                 MQV-COMPLETION-CODE                    03300091
                                 MQV-REASON.                            03310091
                                                                        03320091
           EVALUATE TRUE                                                03330091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        03340091
                   DISPLAY 'SUCCESSFULLY CONNECTED TO: '                03350091
                                                  CC-QUEUE-MANAGER-NAME 03360091
              WHEN OTHER                                                03370091
                   CALL MQV-MQCHECK USING MQV-REASON                    03380091
                                          MQV-REASON-TEXT               03390091
                   DISPLAY 'UNABLE TO CONNECT TO ' CC-QUEUE-MANAGER-NAME03400091
                   MOVE 'UNABLE TO CONNECT'  TO PV-OPERATION-MSG-1      03410091
                   PERFORM 9999-MQ-ABEND                                03420091
           END-EVALUATE.                                                03430091
                                                                        03440091
       EJECT.                                                           03450091
      ******************************************************************03460091
      **OPEN THE MERCH HIER QUEUE                                       03470091
      ******************************************************************03480091
       1200-OPEN-MERCH-QUEUE.                                           03490091
                                                                        03500091
           MOVE '1200-OPEN-MERCH-QUEUE' TO PV-PARAGRAPH-NAME.           03510091
                                                                        03520091
           MOVE CC-MERCH-HIER-QUEUE-NAME TO MQOD-OBJECTNAME             03530091
           MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        03540091
                                                                        03550091
           COMPUTE MQV-OPEN-OPTIONS      = MQOO-INPUT-SHARED            03560091
                                         + MQOO-OUTPUT                  03570091
                                         + MQOO-SET-IDENTITY-CONTEXT    03580091
                                         + MQOO-FAIL-IF-QUIESCING.      03590091
                                                                        03600091
           CALL MQV-MQOPEN USING MQV-HCONN                              03610091
                                 MQM-OBJECT-DESCRIPTOR                  03620091
                                 MQV-OPEN-OPTIONS                       03630091
                                 MQV-ITEM-HANDLE                        03640091
                                 MQV-COMPLETION-CODE                    03650091
                                 MQV-REASON.                            03660091
                                                                        03670091
           EVALUATE TRUE                                                03680091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        03690091
                   DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                03700091
                                              CC-MERCH-HIER-QUEUE-NAME  03710091
              WHEN OTHER                                                03720091
                   CALL MQV-MQCHECK USING MQV-REASON                    03730091
                                         MQV-REASON-TEXT                03740091
                   DISPLAY 'CANNOT OPEN QUEUE ' CC-MERCH-HIER-QUEUE-NAME03750091
                   MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      03760091
                   PERFORM 9999-DISCONNECT-QMGR                         03770091
                   PERFORM 9999-MQ-ABEND                                03780091
           END-EVALUATE.                                                03790091
                                                                        03800091
       EJECT.                                                           03810091
      ******************************************************************03820091
      **OPEN THE MERCH HIER ERROR QUEUE                                 03830091
      ******************************************************************03840091
       1300-OPEN-MRCH-HR-ERROR-QUEUE.                                   03850091
                                                                        03860091
           MOVE '1300-OPEN-MRCH-HIER-ERROR-QUEUE' TO  PV-PARAGRAPH-NAME.03870091
                                                                        03880091
           MOVE CC-MRH-HR-ERROR-QUEUE-NAME  TO MQOD-OBJECTNAME          03890091
           MOVE CC-QUEUE-MANAGER-NAME       TO MQOD-OBJECTQMGRNAME.     03900091
                                                                        03910091
           COMPUTE MQV-OPEN-OPTIONS      = MQOO-INPUT-SHARED            03920091
                                         + MQOO-OUTPUT                  03930091
                                         + MQOO-SET-IDENTITY-CONTEXT    03940091
                                         + MQOO-FAIL-IF-QUIESCING.      03950091
                                                                        03960091
           CALL MQV-MQOPEN USING MQV-HCONN                              03970091
                                 MQM-OBJECT-DESCRIPTOR                  03980091
                                 MQV-OPEN-OPTIONS                       03990091
                                 MQV-ERROR-HANDLE                       04000091
                                 MQV-COMPLETION-CODE                    04010091
                                 MQV-REASON.                            04020091
                                                                        04030091
           EVALUATE TRUE                                                04040091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        04050091
                   DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                04060091
                                            CC-MRH-HR-ERROR-QUEUE-NAME  04070091
              WHEN OTHER                                                04080091
                   CALL MQV-MQCHECK USING MQV-REASON                    04090091
                                          MQV-REASON-TEXT               04100091
                   MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      04110091
                   DISPLAY 'CANNOT OPEN QUEUE '                         04120091
                                            CC-MRH-HR-ERROR-QUEUE-NAME  04130091
                   PERFORM 9999-DISCONNECT-QMGR                         04140091
                   PERFORM 9999-MQ-ABEND                                04150091
           END-EVALUATE.                                                04160091
                                                                        04170091
       EJECT.                                                           04180091
      ******************************************************************04190091
      **READ ITEM MESSAGE AND BASED ON BUSINESS EVENT CALL PROGRAM      04200091
      **     TO EXECUTE BUSINESS LOGIC.                                 04210091
      ******************************************************************04220091
       2000-PROCESS-RECORDS.                                            04230091
                                                                        04240091
           MOVE '2000-PROCESS-RECORDS'         TO PV-PARAGRAPH-NAME.    04250091
                                                                        04260091
      *INITIALIZE VARIABLES FOR EACH MESSAGE RETRIEVED                  04270091
           INITIALIZE MESSAGE-LOG-RECORD.                               04280091
           INITIALIZE LV-LINKAGE-VARIABLES.                             04290091
           INITIALIZE DCLXST00014.                                      04300091
           INITIALIZE DCLXST00015.                                      04310091
           INITIALIZE DCLXST00016.                                      04320091
           INITIALIZE DCLXST00024.                                      04330091
091004     INITIALIZE DCLXST00071.                                      04340091
                                                                        04350091
           MOVE HM001-RMS-TBL-NAME             TO CF-HM001-RMS-TBL-NAME.04360091
                                                                        04370091
           EVALUATE TRUE                                                04380091
              WHEN PC-HM001-TBL-NAME-SCLASS                             04390091
                   ADD +1                  TO PC-MESSAGE-SUBCLASS       04400091
                   SET PC-CALLED-XSKUP017  TO TRUE                      04410091
                   PERFORM 2100-CALL-PROGRAM                            04420091
              WHEN PC-HM001-TBL-NAME-SCLASS-ATTR                        04430091
                   ADD +1                  TO PC-MESSAGE-SUBCLASS-ATTR  04440091
                   SET PC-CALLED-XSKUP018  TO TRUE                      04450091
                   PERFORM 2100-CALL-PROGRAM                            04460091
              WHEN PC-HM001-TBL-NAME-DEPS                               04470091
                   ADD +1                  TO PC-MESSAGE-DEPS           04480091
                   SET PC-CALLED-XSKUP029  TO TRUE                      04490091
                   PERFORM 2100-CALL-PROGRAM                            04500091
              WHEN PC-HM001-TBL-NAME-DEPS-ATTR                          04510091
                   ADD +1                  TO PC-MESSAGE-DEPS-ATTR      04520091
                   SET PC-CALLED-XSKUP030  TO TRUE                      04530091
                   PERFORM 2100-CALL-PROGRAM                            04540091
              WHEN PC-HM001-TBL-NAME-BUS-GROUPS                         04550091
                   ADD +1                  TO PC-MESSAGE-BUS-GROUP      04560091
                   SET PC-CALLED-XSKUP027  TO TRUE                      04570091
                   PERFORM 2100-CALL-PROGRAM                            04580091
              WHEN PC-HM001-TBL-NAME-BUS-AREA                           04590091
                   ADD +1                  TO PC-MESSAGE-BUS-AREA       04600091
                   SET PC-CALLED-XSKUP026  TO TRUE                      04610091
                   PERFORM 2100-CALL-PROGRAM                            04620091
091004        WHEN PC-HM001-TBL-NAME-MCLASS                             04630091
091004             ADD +1                  TO PC-MESSAGE-MAJCLASS       04640091
091004             SET PC-CALLED-XSKUP086  TO TRUE                      04650091
091004             PERFORM 2100-CALL-PROGRAM                            04660091
              WHEN PC-HM001-TBL-NAME-END-OF-DAY                         04670091
                   SET PS-PROCESS-COMPLETE TO TRUE                      04680091
                   DISPLAY 'END PROGRAM MESSAGE RETRIEVED'              04690091
110602*       WHEN OTHER                                                04700091
110602*            CONTINUE                                             04710091
           END-EVALUATE.                                                04720091
                                                                        04730091
           IF  PS-PROCESS-CONTINUE                                      04740091
               PERFORM 9999-RETRIEVE-MESSAGE                            04750091
           END-IF.                                                      04760091
                                                                        04770091
       EJECT.                                                           04780091
      ******************************************************************04790091
      **CALL PROGRAM TO EXECUTE MESSAGE                                 04800091
      ******************************************************************04810091
       2100-CALL-PROGRAM.                                               04820091
                                                                        04830091
           MOVE '2100-CALL-PROGRAM' TO PV-PARAGRAPH-NAME.               04840091
                                                                        04850091
121502     PERFORM 2150-SELECT-TIMESTAMP.                               04860091
                                                                        04870091
           MOVE HMRD001-RECORD      TO LV-HMRD001-RECORD.               04880091
121609     MOVE ZEROES              TO LV-RETURN-CODE.                  04890094
                                                                        04900091
           CALL PC-CALLED-PROGRAM USING LV-HMRD001-RECORD               04910091
                                        LV-RETURN-CODE,                 04920091
121402                                  LV-CURRENT-TIMESTAMP.           04930091
                                                                        04940091
           EVALUATE TRUE                                                04950091
              WHEN LV-RETURN-CODE EQUAL ZEROS                           04960091
                   PERFORM 2200-COMMIT-DATA                             04970091
                   PERFORM 2300-COMMIT-MESSAGE                          04980091
                   PERFORM 2400-BACKUP-MESSAGE                          04990091
121609        WHEN LV-RETURN-CODE EQUAL 4051                            05000092
121609             PERFORM 2200-COMMIT-DATA                             05010092
121609             PERFORM 2300-COMMIT-MESSAGE                          05020092
121609             PERFORM 2400-BACKUP-MESSAGE                          05030092
121609             SET PS-SEND-EMAIL-YES TO TRUE                        05040092
              WHEN LV-RETURN-CODE NOT EQUAL ZEROS                       05050091
                   PERFORM 2500-PUT-ON-ERROR-QUEUE                      05060091
                   PERFORM 2300-COMMIT-MESSAGE                          05070091
           END-EVALUATE.                                                05080091
                                                                        05090091
       EJECT.                                                           05100091
      ******************************************************************05110091
      **RETRIEVE TIME FROM DB2                                          05120091
      ******************************************************************05130091
121402 2150-SELECT-TIMESTAMP.                                           05140091
                                                                        05150091
121402     MOVE '2150-SELECT-TIMESTAMP' TO PV-PARAGRAPH-NAME.           05160091
                                                                        05170091
121402     EXEC SQL                                                     05180091
121402          SELECT CURRENT TIMESTAMP                                05190091
121402          INTO  :LV-CURRENT-TIMESTAMP                             05200091
121402          FROM   SYSIBM.SYSDUMMY1                                 05210091
121402     END-EXEC.                                                    05220091
                                                                        05230091
121402     EVALUATE TRUE                                                05240091
121402        WHEN  SQLCODE = ZEROS                                     05250091
121402              CONTINUE                                            05260091
121402        WHEN  OTHER                                               05270091
121402              PERFORM 9999-SQL-ABEND-ROUTINE                      05280091
121402     END-EVALUATE.                                                05290091
                                                                        05300091
121402 EJECT.                                                           05310091
      ****************************************************************  05320091
      *COMMIT DATA TO DB                                                05330091
      ****************************************************************  05340091
       2200-COMMIT-DATA.                                                05350091
                                                                        05360091
           MOVE '2200-COMMIT-DATA' TO PV-PARAGRAPH-NAME.                05370091
                                                                        05380091
           EXEC SQL                                                     05390091
                COMMIT                                                  05400091
           END-EXEC.                                                    05410091
                                                                        05420091
           EVALUATE TRUE                                                05430091
              WHEN SQLCODE = 0                                          05440091
                   CONTINUE                                             05450091
              WHEN OTHER                                                05460091
                   DISPLAY 'UNABLE TO COMMIT DATA'                      05470091
                   PERFORM 9999-BACK-OUT-MQV-CHANGES                    05480091
                   PERFORM 9999-DISCONNECT-QMGR                         05490091
                   PERFORM 9999-SQL-ABEND-ROUTINE                       05500091
           END-EVALUATE.                                                05510091
                                                                        05520091
       EJECT.                                                           05530091
      ******************************************************************05540091
      **REMOVES MESSAGE FROM QUEUE                                      05550091
      ******************************************************************05560091
       2300-COMMIT-MESSAGE.                                             05570091
                                                                        05580091
           MOVE '2300-COMMIT-MESSAGE'          TO PV-PARAGRAPH-NAME.    05590091
                                                                        05600091
           CALL MQV-MQCMIT USING MQV-HCONN                              05610091
                                 MQV-COMPLETION-CODE                    05620091
                                 MQV-REASON.                            05630091
                                                                        05640091
           EVALUATE TRUE                                                05650091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        05660091
                   CONTINUE                                             05670091
              WHEN OTHER                                                05680091
                   CALL MQV-MQCHECK USING MQV-REASON                    05690091
                                          MQV-REASON-TEXT               05700091
                   MOVE 'ERROR COMMITING DATA' TO PV-OPERATION-MSG-1    05710091
                   PERFORM 9999-BACK-OUT-MQV-CHANGES                    05720091
                   PERFORM 9999-DISCONNECT-QMGR                         05730091
                   PERFORM 9999-MQ-ABEND                                05740091
           END-EVALUATE.                                                05750091
                                                                        05760091
       EJECT.                                                           05770091
      ******************************************************************05780091
      **WRITES MESSAGE TO A LOG IN CASE RECOVERY IS NEEDED              05790091
      ******************************************************************05800091
       2400-BACKUP-MESSAGE.                                             05810091
                                                                        05820091
           MOVE '2400-BACKUP-MESSAGE' TO PV-PARAGRAPH-NAME.             05830091
                                                                        05840091
           MOVE MQV-MSGBUFFER         TO MESSAGE-LOG-RECORD.            05850091
           WRITE MESSAGE-LOG-RECORD.                                    05860091
           ADD +1                     TO PC-MESSAGES-WRITTEN-TO-FILE.   05870091
                                                                        05880091
       EJECT.                                                           05890091
      ******************************************************************05900091
      **PUTS MESSAGE THAT HAD ERROR ON ERROR QUEUE                      05910091
      ******************************************************************05920091
       2500-PUT-ON-ERROR-QUEUE.                                         05930091
                                                                        05940091
           MOVE '2500-PUT-ON-ERROR-QUEUE' TO PV-PARAGRAPH-NAME.         05950091
                                                                        05960091
           MOVE CC-MRH-HR-ERROR-QUEUE-NAME TO MQOD-OBJECTNAME           05970091
           MOVE CC-QUEUE-MANAGER-NAME     TO MQOD-OBJECTQMGRNAME.       05980091
                                                                        05990091
           MOVE HMRD001-RECORD            TO MQV-ERRMSGBUF.             06000091
                                                                        06010091
           MOVE MQMI-NONE                 TO MQMD-MSGID.                06020091
111302     MOVE MQCI-NONE                 TO MQMD-CORRELID.             06030091
           MOVE MQFMT-STRING              TO MQMD-FORMAT.               06040091
           COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT.                   06050091
                                                                        06060091
                                                                        06070091
           CALL MQV-MQPUT USING MQV-HCONN                               06080091
                                MQV-ERROR-HANDLE                        06090091
                                MQM-MESSAGE-DESCRIPTOR                  06100091
                                MQM-PUT-MESSAGE-OPTIONS                 06110091
                                MQV-MSG-LENGTH                          06120091
                                MQV-ERRMSGBUF                           06130091
                                MQV-COMPLETION-CODE                     06140091
                                MQV-REASON.                             06150091
                                                                        06160091
           EVALUATE TRUE                                                06170091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        06180091
                   ADD +1                 TO PC-MESSAGES-TO-ERROR-QUEUE 06190091
              WHEN OTHER                                                06200091
                   DISPLAY 'UNABLE TO WRITE TO ITEM ERROR QUEUE'        06210091
                   CALL MQV-MQCHECK USING MQV-REASON                    06220091
                                          MQV-REASON-TEXT               06230091
                   MOVE 'MQBACK ERROR'      TO PV-OPERATION-MSG-1       06240091
                   PERFORM 9999-DISCONNECT-QMGR                         06250091
                   PERFORM 9999-MQ-ABEND                                06260091
           END-EVALUATE.                                                06270091
                                                                        06280091
       EJECT.                                                           06290091
      ******************************************************************06300091
      **RETRIEVES NEXT MESSAGE FROM THE ITEM QUEUE                      06310091
      ******************************************************************06320091
       9999-RETRIEVE-MESSAGE.                                           06330091
                                                                        06340091
           MOVE '9999-RETRIEVE-MESSAGE' TO PV-PARAGRAPH-NAME.           06350091
                                                                        06360091
           INITIALIZE MQV-MSGBUFFER                                     06370091
                      MQV-ERRMSGBUF                                     06380091
                      MQV-MSG.                                          06390091
                                                                        06400091
           MOVE MQMI-NONE            TO MQMD-MSGID.                     06410091
           MOVE MQCI-NONE            TO MQMD-CORRELID.                  06420091
           MOVE MQFMT-STRING         TO MQMD-FORMAT.                    06430091
           MOVE MQWI-UNLIMITED       TO MQGMO-WAITINTERVAL.             06440091
                                                                        06450091
           COMPUTE MQGMO-OPTIONS  =  MQGMO-SYNCPOINT +                  06460091
                                     MQGMO-CONVERT   +                  06470091
                                     MQGMO-WAIT.                        06480091
                                                                        06490091
           CALL MQV-MQGET USING MQV-HCONN                               06500091
                                MQV-ITEM-HANDLE                         06510091
                                MQM-MESSAGE-DESCRIPTOR                  06520091
                                MQM-GET-MESSAGE-OPTIONS                 06530091
                                MQV-MSG-LENGTH                          06540091
                                MQV-MSGBUFFER                           06550091
                                MQV-DATA-LENGTH                         06560091
                                MQV-COMPLETION-CODE                     06570091
                                MQV-REASON.                             06580091
                                                                        06590091
           IF  MQV-COMPLETION-CODE = MQCC-OK                            06600091
               ADD +1             TO PC-MESSAGE-FROM-QUEUE              06610091
               INITIALIZE HMRD001-RECORD                                06620091
               MOVE MQV-MSGBUFFER TO HMRD001-RECORD                     06630091
           ELSE                                                         06640091
               EVALUATE TRUE                                            06650091
                  WHEN MQV-REASON = MQRC-NO-MSG-AVAILABLE               06660091
                       CONTINUE                                         06670091
                  WHEN OTHER                                            06680091
                       CALL MQV-MQCHECK USING MQV-REASON                06690091
                                              MQV-REASON-TEXT           06700091
                       MOVE 'ERROR RETRIEVING MESSAGE'                  06710091
                                             TO PV-OPERATION-MSG-1      06720091
                       PERFORM 9999-BACK-OUT-MQV-CHANGES                06730091
                       PERFORM 9999-DISCONNECT-QMGR                     06740091
                       PERFORM 9999-MQ-ABEND                            06750091
               END-EVALUATE                                             06760091
           END-IF.                                                      06770091
                                                                        06780091
       EJECT.                                                           06790091
      ***************************************************************** 06800091
      **ROLLBACK MQ CHANGES                                             06810091
      ***************************************************************** 06820091
       9999-BACK-OUT-MQV-CHANGES.                                       06830091
                                                                        06840091
           CALL MQV-MQBACK USING MQV-HCONN                              06850091
                                 MQV-COMPLETION-CODE                    06860091
                                 MQV-REASON.                            06870091
                                                                        06880091
           EVALUATE TRUE                                                06890091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        06900091
                   CONTINUE                                             06910091
              WHEN OTHER                                                06920091
                   CALL MQV-MQCHECK USING MQV-REASON                    06930091
                                          MQV-REASON-TEXT               06940091
                   MOVE 'MQBACK ERROR'  TO PV-OPERATION-MSG-1           06950091
                   PERFORM 9999-DISCONNECT-QMGR                         06960091
                   PERFORM 9999-MQ-ABEND                                06970091
           END-EVALUATE.                                                06980091
                                                                        06990091
       EJECT.                                                           07000091
      ***************************************************************** 07010091
      **DISCONNECT FROM THE QUEUE MANAGER                               07020091
      ***************************************************************** 07030091
       9999-DISCONNECT-QMGR.                                            07040091
                                                                        07050091
           CALL MQV-MQDISC USING MQV-HCONN                              07060091
                                 MQV-COMPLETION-CODE                    07070091
                                 MQV-REASON.                            07080091
                                                                        07090091
           EVALUATE TRUE                                                07100091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        07110091
                   CONTINUE                                             07120091
              WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                07130091
                   CALL MQV-MQCHECK USING MQV-REASON                    07140091
                                          MQV-REASON-TEXT               07150091
                   MOVE 'MQDISC ERROR'       TO PV-OPERATION-MSG-1      07160091
                   PERFORM 9999-MQ-ABEND                                07170091
           END-EVALUATE.                                                07180091
                                                                        07190091
       EJECT.                                                           07200091
      ***************************************************************** 07210091
      **CLOSE XS ITEM AND XS ITEM ERROR QUEUE                           07220091
      ***************************************************************** 07230091
       9999-CLOSE-QUEUES.                                               07240091
                                                                        07250091
           CALL MQV-MQCLOSE USING MQV-HCONN                             07260091
                                  MQV-ITEM-HANDLE                       07270091
                                  MQCO-NONE                             07280091
                                  MQV-COMPLETION-CODE                   07290091
                                  MQV-REASON.                           07300091
                                                                        07310091
           EVALUATE TRUE                                                07320091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        07330091
                   CONTINUE                                             07340091
              WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                07350091
                   CALL MQV-MQCHECK USING MQV-REASON                    07360091
                                          MQV-REASON-TEXT               07370091
                   MOVE 'CANNOT CLOSE ITEM QUEUE' TO PV-OPERATION-MSG-1 07380091
                   PERFORM 9999-MQ-ABEND                                07390091
           END-EVALUATE.                                                07400091
                                                                        07410091
           CALL MQV-MQCLOSE USING MQV-HCONN                             07420091
                                  MQV-ERROR-HANDLE                      07430091
                                  MQCO-NONE                             07440091
                                  MQV-COMPLETION-CODE                   07450091
                                  MQV-REASON.                           07460091
                                                                        07470091
           EVALUATE TRUE                                                07480091
              WHEN MQV-COMPLETION-CODE = MQCC-OK                        07490091
                   CONTINUE                                             07500091
              WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                07510091
                   CALL MQV-MQCHECK USING MQV-REASON                    07520091
                                          MQV-REASON-TEXT               07530091
                   MOVE 'CANNOT CLOSE ERROR QUEUE' TO PV-OPERATION-MSG-107540091
                   PERFORM 9999-MQ-ABEND                                07550091
           END-EVALUATE.                                                07560091
                                                                        07570091
       EJECT.                                                           07580091
      ***************************************************************** 07590091
      **READ CONTROL CARD 1                                             07600091
      ***************************************************************** 07610091
       9999-READ-CONTROL-CARD-1.                                        07620091
                                                                        07630091
           READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1-LAYOUT.           07640091
                                                                        07650091
       EJECT.                                                           07660091
      ***************************************************************** 07670091
      **READ CONTROL CARD 2                                             07680091
      ***************************************************************** 07690091
       9999-READ-CONTROL-CARD-2.                                        07700091
                                                                        07710091
           READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2-LAYOUT.           07720091
                                                                        07730091
       EJECT.                                                           07740091
      ***************************************************************** 07750091
      **READ CONTROL CARD 3                                             07760091
      ***************************************************************** 07770091
       9999-READ-CONTROL-CARD-3.                                        07780091
                                                                        07790091
           READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3-LAYOUT.           07800091
                                                                        07810091
       EJECT.                                                           07820091
      ****************************************************************  07830091
      *END OF PROGRAM ROUTINE                                           07840091
      ****************************************************************  07850091
       9999-WRAPUP.                                                     07860091
                                                                        07870091
           PERFORM 9999-CLOSE-QUEUES.                                   07880091
           PERFORM 9999-DISCONNECT-QMGR.                                07890091
                                                                        07900091
           PERFORM 9999-DISPLAY-STATISTICS.                             07910091
                                                                        07920091
121609     IF PS-SEND-EMAIL-YES                                         07930092
121609        MOVE 4051  TO RETURN-CODE                                 07940092
121609     END-IF.                                                      07950092
                                                                        07960092
           CLOSE CONTROL-CARD-1                                         07970094
                 CONTROL-CARD-2                                         07980094
                 CONTROL-CARD-3                                         07990094
                 MESSAGE-LOG.                                           08000094
                                                                        08010094
       EJECT.                                                           08020091
      ****************************************************************  08030091
      *DISPLAY PROGRAM STATISTICS FOR THIS RUN                          08040091
      ****************************************************************  08050091
       9999-DISPLAY-STATISTICS.                                         08060091
                                                                        08070091
           DISPLAY ' '.                                                 08080094
           DISPLAY '*********************************************'.     08090094
           DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            08100091
           DISPLAY '*********************************************'.     08110091
           DISPLAY 'MESSAGES FROM QUEUE: ' PC-MESSAGE-FROM-QUEUE.       08120091
           DISPLAY 'MESSAGES WRITTEN TO FILE: '                         08130091
                                        PC-MESSAGES-WRITTEN-TO-FILE.    08140091
           DISPLAY 'MESSAGES WRITTEN TO ERROR QUEUE: '                  08150091
                                        PC-MESSAGES-TO-ERROR-QUEUE.     08160091
           DISPLAY 'MAJCLASS MESSAGES:' PC-MESSAGE-MAJCLASS.            08170091
           DISPLAY 'SUBCLASS MESSAGES:' PC-MESSAGE-SUBCLASS.            08180091
           DISPLAY 'SUBCLASS ATTRIBUTES MESSAGES: '                     08190091
                                        PC-MESSAGE-SUBCLASS-ATTR.       08200091
           DISPLAY 'DEPARTMENT ATTRIBUTES MESSGES: '                    08210091
                                        PC-MESSAGE-DEPS-ATTR.           08220091
           DISPLAY 'BUSINESS GROUP MESSAGES: ' PC-MESSAGE-BUS-GROUP.    08230091
           DISPLAY 'BUSINESS AREA MESSAGES: '  PC-MESSAGE-BUS-AREA.     08240091
           DISPLAY '*********************************************'.     08250091
                                                                        08260091
       EJECT.                                                           08270091
      ******************************************************************08280091
      **MQ ABEND ROUTINE                                                08290091
      ******************************************************************08300091
       9999-MQ-ABEND.                                                   08310091
                                                                        08320091
           DISPLAY '**** ABEND *************************************'.  08330091
           DISPLAY '** MQSERIES ERROR **'.                              08340091
           DISPLAY '** PROGRAM:    ' PC-CURRENT-PROGRAM-NAME.           08350091
           DISPLAY '** ABEND CODE: ' ABEND-CODE.                        08360091
           DISPLAY '** PARAGRAPH:  ' PV-PARAGRAPH-NAME.                 08370091
           DISPLAY '** MESSAGE:    ' PV-OPERATION-MSG-1.                08380091
           DISPLAY '** COMP CODE:  ' MQV-COMPLETION-CODE.               08390091
           DISPLAY '** RSN CODE:   ' MQV-REASON.                        08400091
           DISPLAY '** RSN TEXT:   ' MQV-REASON-TEXT.                   08410091
           DISPLAY '************************************************'.  08420091
           MOVE +4013 TO ABEND-CODE.                                    08430091
           CALL 'ILBOABN0' USING ABEND-CODE.                            08440091
                                                                        08450091
       EJECT.                                                           08460091
      ******************************************************************08470091
      **SQL ABEND ROUTINE                                               08480091
      ******************************************************************08490091
       9999-SQL-ABEND-ROUTINE.                                          08500091
                                                                        08510091
           DISPLAY '** ABEND     **'.                                   08520091
           DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08530091
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              08540091
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               08550091
      ******************************************************************08560091
      * COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     08570091
      * TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      08580091
      ******************************************************************08590091
           COPY DPPD004.                                                08600091
           SET ABEND-4013-DB2-ERROR TO TRUE.                            08610091
           CALL 'ILBOABN0' USING ABEND-CODE.                            08620091
                                                                        08630091
       EJECT.                                                           08640091
