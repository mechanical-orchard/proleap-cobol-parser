000100******************************************************************00030001
000200 IDENTIFICATION DIVISION.                                         00040001
000300******************************************************************00050001
000400                                                                  00060001
000500 PROGRAM-ID.             ARKUT074.                                00070001
000600 AUTHOR.                 CHERI PARMLEY.                           00080001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00090001
000800 DATE-WRITTEN            10-21-2016.                              00100001
000900 DATE-COMPILED.                                                   00110001
001000                                                                  00120001
001100******************************************************************00130001
001200* THIS PROGRAM WILL TAKE IN THE WORKDAY ASSOC-SSN FILE AND CHECK  00140006
001300* FOR DUPLICATES ON THE SSN COLUMN. IF THERE IS A DUPLICATE IT    00150001
001400* WILL WRITE IT TO A DUPLICATE FILE AND ELIMINATE IT FROM THE     00160004
001400* FILE GOING TO ARKUT072.                                         00170004
001700******************************************************************00190001
002000* NOTE: IF THE AR100 RECORD CHANGES IN ANYWAY YOU MUST LOOK AT    00460032
002000*       05 PV-LAST-REC-WRITTEN                                    00461032
002000*       05 PV-HOLD-EMP-REC                                        00462032
002000*       TO KEEP THIS IN SYNC SO THE COMPARE WILL WORK             00463032
002100******************************************************************00470001
002200 ENVIRONMENT DIVISION.                                            00480001
002300******************************************************************00490001
002400                                                                  00500001
002500 CONFIGURATION SECTION.                                           00510001
002600                                                                  00520001
002700 SOURCE-COMPUTER.        IBM-3090.                                00530001
002800 OBJECT-COMPUTER.        IBM-3090.                                00540001
002900                                                                  00550001
003000 INPUT-OUTPUT SECTION.                                            00560001
003100                                                                  00570001
003200 FILE-CONTROL.                                                    00580001
003300                                                                  00590001
003400     SELECT WD-EMPLOYEE-IN-FILE                                   00600009
003500         ASSIGN TO INP01.                                         00610001
003600                                                                  00620001
004300     SELECT EMPLOYEE-NON-DUP-FILE                                 00630004
004400         ASSIGN TO OUT01.                                         00640005
004500                                                                  00650004
004300     SELECT DUPLICATE-SSN-FILE                                    00750001
004400         ASSIGN TO OUT02.                                         00760005
004500                                                                  00770001
004600******************************************************************00780001
004700 DATA DIVISION.                                                   00790001
004800******************************************************************00800001
004900                                                                  00810001
005000 FILE SECTION.                                                    00820001
005100                                                                  00830001
005200 FD WD-EMPLOYEE-IN-FILE                                           00840008
005300     RECORDING MODE IS F                                          00850001
005400     BLOCK CONTAINS 0 RECORDS                                     00860001
005500     LABEL RECORDS ARE STANDARD.                                  00870001
005600 01 WD-EMPLOYEE-IN-REC                PIC X(200).                 00880034
005700                                                                  00890001
005200 FD EMPLOYEE-NON-DUP-FILE                                         01221004
005300     RECORDING MODE IS F                                          01222004
005400     BLOCK CONTAINS 0 RECORDS                                     01223004
005500     LABEL RECORDS ARE STANDARD.                                  01224004
005600 01 EMPLOYEE-NON-DUP-REC              PIC X(200).                 01225034
005700                                                                  01226004
007800 FD DUPLICATE-SSN-FILE                                            01227004
007900     RECORDING MODE IS F                                          01230001
008000     BLOCK CONTAINS 0 RECORDS                                     01240001
008100     LABEL RECORDS ARE STANDARD.                                  01250001
008200 01 DUPLICATE-SSN-REC                 PIC X(200).                 01260034
008300                                                                  01270001
008400 WORKING-STORAGE SECTION.                                         01280001
008500******************************************************************01290001
008600*                        ABEND CODES                              01300001
008700******************************************************************01310001
008800     COPY ARWS052.                                                01320001
008900                                                                  01330001
009000******************************************************************01340001
009100*                        SWITCHES                                 01350001
009200******************************************************************01360001
009300 01 PS-PROGRAM-SWITCHES.                                          01370001
010600    05 PS-PROCESSING-SW               PIC X      VALUE SPACES.    01500001
010700       88 PS-CONTINUE-PROCESSING                 VALUE 'Y'.       01510001
010800       88 PS-STOP-PROCESSING                     VALUE 'N'.       01520001
011800                                                                  01660001
011900******************************************************************01670001
012000*                        CONSTANTS                                01680001
012100******************************************************************01690001
012200 01 PC-PROGRAM-CONSTANTS.                                         01700001
013300    05 PC-PROGRAM-NAME                PIC X(8)   VALUE 'ARKUT074'.01840001
013500                                                                  01860001
013600******************************************************************01870001
013700*                        VARIABLES                                01880001
013800******************************************************************01890001
013900 01 PV-PROGRAM-VARIABLES.                                         01900001
015000    05 PV-READ-COUNT                  PIC S9(9)  VALUE ZEROES     02030001
015100                                                 COMP.            02040001
015000    05 PV-DUPS-COUNT                  PIC S9(9)  VALUE ZEROES     02050001
015100                                                 COMP.            02060001
015200    05 PV-DUPSSN-COUNT                PIC S9(9)  VALUE ZEROES     02070001
015300                                                 COMP.            02080001
015900                                                                  02140001
015200    05 PV-WRITTEN-COUNT               PIC S9(9)  VALUE ZEROES     02141004
015300                                                 COMP.            02142004
00001     05 PV-LAST-REC-WRITTEN                PIC   X(300).           02460031
00001     05 PV-HOLD-EMP-REC.                                           02461016
00002        10 PV-HOLD-EMP-ID                  PIC   X(07).            02470033
00003        10 PV-HOLD-SSN-NBR                 PIC   X(09).            02471015
00004        10 PV-HOLD-EMP-STAT-CDE            PIC   X(01).            02472015
00005        10 PV-HOLD-EMP-NM                  PIC   X(88).            02473015
00006        10 PV-HOLD-EMP-TYP-CDE             PIC   X(01).            02474015
00007        10 PV-HOLD-DISC-DTE                PIC   X(10).            02475015
00008        10 PV-HOLD-TERM-DTE                PIC   X(10).            02476015
00009        10 PV-HOLD-LOC-NBR                 PIC   9(04).            02477015
00010        10 PV-HOLD-LIFE-DISC-ACTV          PIC   X(01).            02478017
00008        10 FILLER                          PIC   X(56).            02479034
019000                                                                  02480001
018100 01 PV-HEAD-DUP-SSN-REC.                                          02490001
018200    05 HED-ASSOC-ID                  PIC  X(08) VALUE 'EMP ID  '. 02500011
          05 FILLER                        PIC  X(04) VALUE SPACES.     02501020
018200    05 HED-FILLER1                   PIC  X(01) VALUE '|'.        02510008
018200    05 HED-SS-NBR                    PIC  X(09) VALUE             02520008
                                                      'SSN NBR  '.      02530008
          05 FILLER                        PIC  X(01) VALUE SPACES.     02531020
018200    05 HED-FILLER2                   PIC  X(01) VALUE '|'.        02540008
018200    05 HED-EMPT-STAT-CDE             PIC  X(09) VALUE 'EMP  STAT'.02550011
018200    05 HED-FILLER3                   PIC  X(01) VALUE '|'.        02570008
018200    05 HED-ASSOC-ENTIR-NM            PIC  X(08) VALUE 'EMP NM  '. 02580011
018200    05 FILLER                        PIC  X(80) VALUE SPACES.     02581008
018200    05 HED-FILLER4                   PIC  X(01) VALUE '|'.        02590008
018200    05 HED-EMPT-TYP                  PIC  X(07) VALUE 'EMP TYP'.  02592030
018200    05 HED-FILLER41                  PIC  X(01) VALUE '|'.        02593022
018200    05 HED-HIR-DTE                   PIC  X(07) VALUE 'DISC DT'.  02600011
018200    05 FILLER                        PIC  X(03) VALUE SPACES.     02601026
018200    05 HED-FILLER5                   PIC  X(01) VALUE '|'.        02610008
018200    05 HED-LAST-EMPT-DTE             PIC  X(08) VALUE 'TERM DT '. 02620011
018200    05 FILLER                        PIC  X(02) VALUE SPACES.     02630008
018200    05 HED-FILLER6                   PIC  X(01) VALUE '|'.        02640008
018200    05 HED-LOC-NBR                   PIC  X(07) VALUE             02650008
                                                       'LOC NBR'.       02660008
018200    05 HED-FILLER7                    PIC  X(01) VALUE '|'.       02670001
018200    05 HED-LIFETIME-DISC-ACTV         PIC  X(13) VALUE            02680008
                                                       'LIFETIME DISC'. 02690008
018200    05 HED-FILLER8                    PIC  X(01) VALUE '|'.       02700001
018200                                                                  02710001
018100 01 PV-TEMP-DUP-SSN-REC.                                          02720001
018200    05 OUT-EMP-ID                     PIC  X(11) VALUE SPACES.    02730012
018300    05 FILLER                         PIC  X(01) VALUE SPACES.    02740008
018300    05 OUT-FILLER1                    PIC  X(01) VALUE '|'.       02750001
018200    05 OUT-SSN-NBR                    PIC  X(09) VALUE SPACES.    02760012
018300    05 FILLER                         PIC  X(01) VALUE SPACES.    02770008
018300    05 OUT-FILLER2                    PIC  X(01) VALUE '|'.       02780001
018200    05 OUT-EMP-STAT-CDE               PIC  X(01) VALUE SPACES.    02790012
018300    05 FILLER                         PIC  X(08) VALUE SPACES.    02791022
018300    05 OUT-FILLER3                    PIC  X(01) VALUE '|'.       02800021
018200    05 OUT-EMP-NM                     PIC  X(88) VALUE SPACES.    02810012
018300    05 OUT-FILLER4                    PIC  X(01) VALUE '|'.       02811023
018200    05 OUT-EMP-TYP-CDE                PIC  X(01) VALUE SPACES.    02821012
018300    05 FILLER                         PIC  X(06) VALUE SPACES.    02822026
018300    05 OUT-FILLER5                    PIC  X(01) VALUE '|'.       02830009
018200    05 OUT-DISC-DTE                   PIC  X(10) VALUE SPACES.    02840027
018300    05 OUT-FILLER6                    PIC  X(01) VALUE '|'.       02860009
018400    05 OUT-TERM-DTE                   PIC  X(10) VALUE SPACES.    02870012
018300    05 OUT-FILLER7                    PIC  X(01) VALUE '|'.       02880009
018400    05 OUT-LOC-NBR                    PIC  Z999  VALUE SPACES.    02890029
018300    05 FILLER                         PIC  X(03) VALUE SPACES.    02900029
018300    05 OUT-FILLER8                    PIC  X(01) VALUE '|'.       02910009
018400    05 OUT-LIFE-DISC-ACTV             PIC  X(01) VALUE SPACES.    02920017
018300    05 FILLER                         PIC  X(12) VALUE SPACES.    02930001
018300    05 OUT-FILLER9                    PIC  X(01) VALUE '|'.       02940009
                                                                        02950001
019800******************************************************************03030001
019900*                        COPYBOOKS                                03040001
020000******************************************************************03050001
020100                                                                  03060001
020200******************************************************************03070001
020300* WORKDAY EMPLOYEE DELTA FILE RECORD LAYOUT                       03080008
020400******************************************************************03090001
020500     COPY ARRD100.                                                03100008
020600                                                                  03110001
026300******************************************************************03710001
026400 PROCEDURE DIVISION.                                              03720001
026500******************************************************************03730001
026600*--------------*                                                  03740001
026700 0000-MAINLINE.                                                   03750001
026800*--------------*                                                  03760001
026900                                                                  03770001
027000     PERFORM Z050-INITIALIZE.                                     03780001
027100                                                                  03790001
027200     PERFORM 1000-PROCESS-EMP-ACCT-FILE.                          03800001
027300                                                                  03810001
027400     PERFORM Z100-END-PROC.                                       03820001
027500                                                                  03830001
027600     STOP RUN.                                                    03840001
027700                                                                  03850001
027800*-------------------------------*                                 03860001
027900 1000-PROCESS-EMP-ACCT-FILE.                                      03870001
028000*-------------------------------*                                 03880001
028100     SET PS-CONTINUE-PROCESSING TO TRUE.                          03890001
028200                                                                  03900001
028300     PERFORM 4010-READ-EMPL-ACCT.                                 03910001
           MOVE AR100-WD-EMPLOYEE-REC TO PV-HOLD-EMP-REC.               03911015
028300     PERFORM 4010-READ-EMPL-ACCT.                                 03912015
028400                                                                  03920001
028500     PERFORM 2000-PROCESS-EMP-SSN                                 03930001
028600       UNTIL PS-STOP-PROCESSING.                                  03940001
028700                                                                  03950001
028800*-------------------------------*                                 03960001
028900 2000-PROCESS-EMP-SSN.                                            03970001
029000*-------------------------------*                                 03980001
029100** DETERMINE IF THE SSN'S ARE THE SAME                            03990001
029200     IF AR100-SSN-NBR   = PV-HOLD-SSN-NBR                         04000014
029300        PERFORM 5200-WRITE-DUP-SSN                                04010001
           ELSE                                                         04020004
054100        PERFORM 5000-WRITE-NON-DUP-SSN                            04030004
029600     END-IF.                                                      04040001
                                                                        04040304
           MOVE AR100-WD-EMPLOYEE-REC TO PV-HOLD-EMP-REC.               04041017
028300     PERFORM 4010-READ-EMPL-ACCT.                                 04042002
029700                                                                  04050001
039900*-------------------------------*                                 05360001
040000 4010-READ-EMPL-ACCT.                                             05370003
040100*-------------------------------*                                 05380001
040300                                                                  05400001
040400     READ WD-EMPLOYEE-IN-FILE                                     05410009
040500        INTO AR100-WD-EMPLOYEE-REC                                05420013
040600        AT END                                                    05430001
040700           SET PS-STOP-PROCESSING TO TRUE                         05440001
040800     END-READ.                                                    05450001
040900                                                                  05460001
041000     IF NOT PS-STOP-PROCESSING                                    05470001
041100        ADD 1 TO PV-READ-COUNT                                    05480001
041200     END-IF.                                                      05490001
041300                                                                  05500001
054000*-----------------------------*                                   05510004
054100 5000-WRITE-NON-DUP-SSN.                                          05520004
054200*-----------------------------*                                   05530004
           IF PV-WRITTEN-COUNT = 0                                      05580037
               WRITE EMPLOYEE-NON-DUP-REC FROM PV-HOLD-EMP-REC          05660037
               ADD 1 TO PV-WRITTEN-COUNT                                05660137
           END-IF.                                                      05660237
           WRITE EMPLOYEE-NON-DUP-REC FROM AR100-WD-EMPLOYEE-REC.       05661037
           ADD 1 TO PV-WRITTEN-COUNT.                                   05670037
                                                                        05680037
       5000-EXIT.  EXIT.                                                05690035
054000*-----------------------------*                                   06230001
054100 5200-WRITE-DUP-SSN.                                              06240001
054200*-----------------------------*                                   06250001
      *NEEDS TO WRITE ALL THE DUPS FOR THE SSN NOT JUST THE ONES        06251016
      *FOLLOWING THE 1ST DUPLICATE                                      06252016
                                                                        06253016
           IF PV-DUPSSN-COUNT = 0                                       06260001
              WRITE DUPLICATE-SSN-REC FROM PV-HEAD-DUP-SSN-REC          06270001
           END-IF.                                                      06280001
           IF PV-HOLD-EMP-REC = PV-LAST-REC-WRITTEN                     06290016
               MOVE AR100-EMP-ID                  TO OUT-EMP-ID         06290116
               MOVE AR100-SSN-NBR                 TO OUT-SSN-NBR        06290216
               MOVE AR100-EMP-STAT-CDE            TO OUT-EMP-STAT-CDE   06290316
               MOVE AR100-EMP-NM                  TO OUT-EMP-NM         06290416
               MOVE AR100-EMP-TYP-CDE             TO OUT-EMP-TYP-CDE    06290516
               MOVE AR100-DISC-DTE                TO OUT-DISC-DTE       06290616
               MOVE AR100-TERM-DTE                TO OUT-TERM-DTE       06290716
               MOVE AR100-LOC-NBR                 TO OUT-LOC-NBR        06290828
               MOVE AR100-LIFETIME-DISC-ACTV      TO OUT-LIFE-DISC-ACTV 06290927
               WRITE DUPLICATE-SSN-REC FROM PV-TEMP-DUP-SSN-REC         06291027
               MOVE AR100-WD-EMPLOYEE-REC TO PV-LAST-REC-WRITTEN        06291127
               ADD 1 TO PV-DUPSSN-COUNT                                 06291227
           ELSE                                                         06291327
               MOVE PV-HOLD-EMP-ID                  TO OUT-EMP-ID       06300016
               MOVE PV-HOLD-SSN-NBR                 TO OUT-SSN-NBR      06310016
               MOVE PV-HOLD-EMP-STAT-CDE            TO OUT-EMP-STAT-CDE 06320016
               MOVE PV-HOLD-EMP-NM                  TO OUT-EMP-NM       06330016
               MOVE PV-HOLD-EMP-TYP-CDE             TO OUT-EMP-TYP-CDE  06340016
               MOVE PV-HOLD-DISC-DTE                TO OUT-DISC-DTE     06350016
               MOVE PV-HOLD-TERM-DTE                TO OUT-TERM-DTE     06360016
               MOVE PV-HOLD-LOC-NBR                 TO OUT-LOC-NBR      06361027
               MOVE PV-HOLD-LIFE-DISC-ACTV         TO OUT-LIFE-DISC-ACTV06370017
               WRITE DUPLICATE-SSN-REC FROM PV-TEMP-DUP-SSN-REC         06380016
               ADD 1 TO PV-DUPSSN-COUNT                                 06390016
               MOVE AR100-EMP-ID                  TO OUT-EMP-ID         06391016
               MOVE AR100-SSN-NBR                 TO OUT-SSN-NBR        06392016
               MOVE AR100-EMP-STAT-CDE            TO OUT-EMP-STAT-CDE   06393016
               MOVE AR100-EMP-NM                  TO OUT-EMP-NM         06394016
               MOVE AR100-EMP-TYP-CDE             TO OUT-EMP-TYP-CDE    06395016
               MOVE AR100-DISC-DTE                TO OUT-DISC-DTE       06396016
               MOVE AR100-TERM-DTE                TO OUT-TERM-DTE       06397016
               MOVE AR100-LOC-NBR                 TO OUT-LOC-NBR        06397128
               MOVE AR100-LIFETIME-DISC-ACTV      TO OUT-LIFE-DISC-ACTV 06398017
               WRITE DUPLICATE-SSN-REC FROM PV-TEMP-DUP-SSN-REC         06399016
               MOVE AR100-WD-EMPLOYEE-REC TO PV-LAST-REC-WRITTEN        06399117
               ADD 1 TO PV-DUPSSN-COUNT                                 06399216
            END-IF.                                                     06399318
       5200-EXIT.  EXIT.                                                06410001
075000                                                                  08310001
076600******************************************************************08470001
076700* Z050 - INITIALIZE                                               08480001
076800******************************************************************08490001
076900 Z050-INITIALIZE.                                                 08500001
                                                                        08530001
077100     OPEN INPUT WD-EMPLOYEE-IN-FILE                               08560008
 77400     OPEN OUTPUT DUPLICATE-SSN-FILE                               08610004
                       EMPLOYEE-NON-DUP-FILE.                           08620004
                                                                        08800001
080400******************************************************************08950001
080500* Z100 - PREFORMS TASK TERMINATION PROCESSING                     08960001
080600******************************************************************08970001
080700 Z100-END-PROC.                                                   08980001
080800                                                                  08990001
081200     DISPLAY ' '.                                                 09030001
081300     DISPLAY '**********************'.                            09040001
081400     DISPLAY '   ARKUT074 CONTROLS  '.                            09050001
081500     DISPLAY '**********************'.                            09060001
081800     DISPLAY '======================'.                            09090001
081900     DISPLAY ' '.                                                 09100001
082000     DISPLAY 'RECORDS READ     : ' PV-READ-COUNT.                 09110001
082100     DISPLAY 'DUPS WRITTEN     : ' PV-DUPSSN-COUNT.               09120002
082100     DISPLAY 'NON DUPS WRITTEN : ' PV-WRITTEN-COUNT.              09130004
083000                                                                  09220001
083100     CLOSE WD-EMPLOYEE-IN-FILE                                    09230008
083400           EMPLOYEE-NON-DUP-FILE                                  09270004
083400           DUPLICATE-SSN-FILE.                                    09271004
083500                                                                  09280001
