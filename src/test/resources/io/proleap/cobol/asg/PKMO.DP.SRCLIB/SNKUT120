000600 IDENTIFICATION DIVISION.                                         00010000
000700 PROGRAM-ID.             SNKUT120.                                00020099
000800 AUTHOR.                 MIKE MACHNIK.                            00030023
000900 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
001000 DATE-WRITTEN.           NOVEMBER 2005.                           00050023
001100 DATE-COMPILED.                                                   00060000
002100******************************************************************00070099
002100*CHANGE HISTORY                                                  *00080099
002100******************************************************************00090099
001300* 11/04/14 TKMAJC7 - PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)         *00100099
001300*          CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF PO#  *00110099
001300*          FROM 7 DIGITS TO 8 DIGITS.  TAGGED WITH *PS 11/04/2014*00120099
002100******************************************************************00130099
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00132099
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00133099
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00134099
002100******************************************************************00136099
001200                                                                  00140023
005100 ENVIRONMENT DIVISION.                                            00150000
005200                                                                  00160023
005300 CONFIGURATION SECTION.                                           00170000
005400 SOURCE-COMPUTER.        IBM-3090.                                00180000
005500 OBJECT-COMPUTER.        IBM-3090.                                00190000
005600 INPUT-OUTPUT SECTION.                                            00200099
005700                                                                  00210099
005800 FILE-CONTROL.                                                    00220099
005900                                                                  00230099
005910     SELECT SN-PARM-CARD                                          00240099
005920         ASSIGN TO INP01.                                         00250099
005930                                                                  00260099
005940     SELECT SN-ASN-FILE                                           00270099
005950         ASSIGN TO OUT01.                                         00280099
005960                                                                  00290099
005910     SELECT SN-CNTL-ID-FILE                                       00300099
005920         ASSIGN TO OUT02.                                         00310099
006900*                                                                 00320099
007000 DATA DIVISION.                                                   00330099
007100*                                                                 00340099
007200*                                                                 00350099
007300 FILE SECTION.                                                    00360099
007301                                                                  00370099
007310 FD  SN-PARM-CARD                                                 00380099
007320     RECORDING MODE IS F                                          00390099
007330     LABEL RECORDS ARE STANDARD                                   00400099
007340     BLOCK CONTAINS 0 RECORDS                                     00410099
007350     RECORD CONTAINS 80 CHARACTERS                                00420099
007360     DATA RECORD IS SN-PARM-RECORD.                               00430099
007370                                                                  00440099
007380 01  SN-PARM-RECORD                     PIC X(80).                00450099
007390                                                                  00460099
007391 FD  SN-ASN-FILE                                                  00470099
007392     RECORDING MODE IS F                                          00480099
007393     LABEL RECORDS ARE STANDARD                                   00490099
007394     BLOCK CONTAINS 0 RECORDS                                     00500099
007395     RECORD CONTAINS 350 CHARACTERS                               00510099
007396     DATA RECORD IS SN-ASN-FILE-RECORD.                           00520099
007397                                                                  00530099
007398 01  SN-ASN-FILE-RECORD                 PIC X(350).               00540099
007400                                                                  00550099
007310 FD  SN-CNTL-ID-FILE                                              00560099
007320     RECORDING MODE IS F                                          00570099
007330     LABEL RECORDS ARE STANDARD                                   00580099
007340     BLOCK CONTAINS 0 RECORDS                                     00590099
007350     RECORD CONTAINS 20 CHARACTERS                                00600099
007360     DATA RECORD IS SN-CNTL-ID-RECORD.                            00610099
007370                                                                  00620099
007380 01  SN-CNTL-ID-RECORD                  PIC X(20).                00630099
007760                                                                  00640099
009400 WORKING-STORAGE SECTION.                                         00650000
009600 01  PS-PROGRAM-SWITCHES.                                         00660006
009601     05  PS-END-OF-CNTL-CSR-SW         PIC  X(01)    VALUE 'N'.   00670099
009602         88  PS-END-OF-CNTL-CSR-YES                  VALUE 'Y'.   00680099
009603         88  PS-END-OF-CNTL-CSR-NO                   VALUE 'N'.   00690099
009604     05  PS-END-OF-XFER-CSR-SW         PIC  X(01)    VALUE 'N'.   00700099
009605         88  PS-END-OF-XFER-CSR-YES                  VALUE 'Y'.   00710099
009606         88  PS-END-OF-XFER-CSR-NO                   VALUE 'N'.   00720099
009607     05  PS-END-OF-PO-CSR-SW           PIC  X(01)    VALUE 'N'.   00730099
009608         88  PS-END-OF-PO-CSR-YES                    VALUE 'Y'.   00740099
009609         88  PS-END-OF-PO-CSR-NO                     VALUE 'N'.   00750099
009610     05  PS-HALLMARK-SW                PIC  X(01)    VALUE 'N'.   00760099
009611         88  PS-HALLMARK-ON-HOLD                     VALUE 'Y'.   00770099
009612         88  PS-HALLMARK-NOT-ON-HOLD                 VALUE 'N'.   00780099
009613     05  EOF-SW           PIC X VALUE 'N'.                        00790099
009614         88  EOF                VALUE 'Y'.                        00800099
009620         88  NOT-EOF            VALUE 'N'.                        00810099
009621     05  PS-VENDOR-FOUND-SW            PIC X         VALUE 'N'.   00820099
009622         88  PS-VENDOR-FOUND                         VALUE 'Y'.   00830099
009623         88  PS-VENDOR-NOT-FOUND                     VALUE 'N'.   00840099
009630 01  PV-ABEND-VARIABLES.                                          00850099
009640     05  PV-ABEND-CODE               PIC S9(4) VALUE +0 COMP SYNC.00860099
009650     05  PV-RETRY-COUNTER            PIC S9(4) VALUE +0 COMP.     00870099
009660     05  PV-SQLCODE                  PIC S9(9).                   00880099
009670     05  PV-DISPLAY-SQLCODE          PIC -------999.              00890099
           05  PV-DISPLAY-CNTL-ID          PIC 9(9).                    00900099
009680     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SNKUP104'.  00910099
009690     05  PV-ABEND-PARAGRAPH          PIC X(25) VALUE SPACES.      00920099
009700     05  PV-ABEND-OPERATION          PIC X(20) VALUE SPACES.      00930099
009800     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      00940099
009900     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      00950099
011800                                                                  00960006
011900 01  PC-PROGRAM-CONSTANTS.                                        00970006
012000     05  PC-MAX-RETRIES              PIC S9(03) VALUE +5 COMP-3.  00980006
012010     05  PC-SNKUP120                 PIC  X(08) VALUE 'SNKUP120'. 00990051
012020     05  PC-SNKUP135                 PIC  X(08) VALUE 'SNKUP135'. 01000082
012030     05  PC-SNKUP145                 PIC  X(08) VALUE 'SNKUP145'. 01010051
012040     05  PC-SNKUT150                 PIC  X(08) VALUE 'SNKUT150'. 01020099
012100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08) VALUE 'SNKSP001'. 01030048
012101*PS 11/04/2014 CHANGE STARTS                                      01040099
012101     05  WS-PO-NUMBER                PIC 9(8)   VALUE 0.          01050099
012101*PS 11/04/2014 CHANGE ENDS                                        01060099
012110     05  PC-NEG-1                    PIC S9(03) VALUE -1 COMP-3.  01070099
012200     05  PC-C                        PIC  X(01) VALUE 'C'.        01080031
012300     05  PC-H                        PIC  X(01) VALUE 'H'.        01090031
012310     05  PC-E                        PIC  X(01) VALUE 'E'.        01100031
012400     05  PC-DEFAULT-TMST             PIC  X(26) VALUE             01110006
012500                                    '0001-01-01-00.00.00.000000'. 01120006
012800                                                                  01130006
012900 01  ABEND-CODE                      PIC S9(04) VALUE +0          01140006
013000                                                COMP SYNC.        01150006
013028 01  WS-ORACLE-TRANSFER-AREA.                                     01160099
013029     05  WS-ORACLE-PO                PIC 9(8).                    01170099
013032     05  WS-ORACLE-SUPPLIER          PIC 9(10).                   01180099
013035     05  WS-ORACLE-RC                PIC 9(1).                    01190099
013036 01  WS-PO-TABLE.                                                 01200099
013037     05  WS-PO-TBL OCCURS 10000 TIMES.                            01210099
013038*PS 11/04/2014 CHANGE STARTS                                      01220099
013038         10  WS-PO                   PIC 9(8).                    01230099
013038*PS 11/04/2014 CHANGE ENDS                                        01240099
013039         10  WS-VEND                 PIC 9(10).                   01250099
013040         10  WS-VEND-X REDEFINES WS-VEND                          01260099
013050                                     PIC X(10).                   01270099
013100 01  PV-PROGRAM-VARIABLES.                                        01280006
013200     05  SUB                         PIC  9(7)  VALUE 0.          01290031
013201     05  SUB1                        PIC  9(7)  VALUE 0.          01300032
013202     05  SUB2                        PIC  9(7)  VALUE 0.          01310076
013203     05  SUB3                        PIC  9(7)  VALUE 0.          01320076
013204     05  WS-PO-COUNT                 PIC  9(7)  VALUE 0.          01330099
013205     05  WS-ASN-COUNT                PIC  9(7)  VALUE 0.          01340099
013205     05  WS-CNTL-ID-COUNT            PIC  9(7)  VALUE 0.          01350099
013206     05  WS-NUMERIC-1                PIC  S9(11) VALUE 0.         01360099
013207     05  WS-NUMERIC-2                PIC  S9(11) VALUE 0.         01370099
013208     05  WS-NUMERIC-3                PIC  S9(9) VALUE 0.          01380099
013210     05  WS-NUMERIC-4                PIC  S9(7) VALUE 0.          01390099
013214     05  WS-CURR-ELEMENT             PIC  9(7)  VALUE 0.          01400099
013215     05  WS-CURR-ASN1-OFF            PIC  9(7)  VALUE 0.          01410099
013220*PS 11/04/2014 CHANGE STARTS                                      01420099
013220     05  PW-PO-NBR-N                 PIC 9(8)   VALUE 0.          01430099
013220*PS 11/04/2014 CHANGE ENDS                                        01440099
013300     05  PV-PARAGRAPH                PIC  X(48) VALUE SPACES.     01450006
013400     05  PV-REC-SEQ-NBR              PIC S9(09) VALUE +0 COMP.    01460006
013500     05  PV-MSG-LENGTH               PIC S9(09) BINARY.           01470006
013510     05  WS-HOLD-ASN-HDR-ID          PIC S9(9)  VALUE 0  COMP.    01480099
013520     05  WS-HOLD-SHIPT-HDR-ID        PIC S9(9)  VALUE 0  COMP.    01490099
013600     05  PV-DATA-LENGTH              PIC S9(09) BINARY.           01500006
013700     05  PV-HOLD-COMPLETION-CODE     PIC S9(09) BINARY.           01510006
013800     05  PV-HOLD-REASON              PIC S9(09) BINARY.           01520006
013900     05  PV-HOLD-CORRELID            PIC  X(24) VALUE SPACES.     01530006
014000     05  PV-RETRY-COUNTER            PIC S9(04) VALUE +0          01540006
014100                                                COMP SYNC.        01550006
014200     05  PV-CURRENT-PRC-CNTL-TMST    PIC  X(26) VALUE SPACES.     01560006
014210     05  WS-BSN03-SHIPT-DTE.                                      01570099
014220         10  WS-BSN03-YY             PIC  X(2)  VALUE SPACES.     01580099
014230         10  WS-BSN03-MM             PIC  X(2)  VALUE SPACES.     01590099
014240         10  WS-BSN03-DD             PIC  X(2)  VALUE SPACES.     01600099
014250     05  WS-BSN03-SHIPT-DTE-REDEF.                                01610099
014251         10  WS-BSN03-REDEF-CC       PIC  X(2)  VALUE SPACES.     01620099
014252         10  WS-BSN03-REDEF-YY       PIC  X(2)  VALUE SPACES.     01630099
014253         10  FILLER                  PIC  X(1)  VALUE '-'.        01640099
014260         10  WS-BSN03-REDEF-MM       PIC  X(2)  VALUE SPACES.     01650099
014261         10  FILLER                  PIC  X(1)  VALUE '-'.        01660099
014270         10  WS-BSN03-REDEF-DD       PIC  X(2)  VALUE SPACES.     01670099
014291     05  WS-BSN04-SHIPT-TIME.                                     01680099
014292         10  WS-BSN04-HH             PIC  X(2)  VALUE SPACES.     01690099
014293         10  WS-BSN04-MM             PIC  X(2)  VALUE SPACES.     01700099
014295     05  WS-BSN04-SHIPT-TIME-REDEF.                               01710099
014296         10  WS-BSN04-REDEF-HH       PIC  X(2)  VALUE SPACES.     01720099
014297         10  FILLER                  PIC  X(1)  VALUE '.'.        01730099
014298         10  WS-BSN04-REDEF-MM       PIC  X(2)  VALUE SPACES.     01740099
014299         10  FILLER                  PIC  X(1)  VALUE '.'.        01750099
014300         10  WS-BSN04-REDEF-SS       PIC  X(2)  VALUE SPACES.     01760099
014400     05  WS-DTM02-SHIPT-DTE.                                      01770099
014500         10  WS-DTM02-YY             PIC  X(2)  VALUE SPACES.     01780099
014600         10  WS-DTM02-MM             PIC  X(2)  VALUE SPACES.     01790099
014700         10  WS-DTM02-DD             PIC  X(2)  VALUE SPACES.     01800099
014800     05  WS-DTM02-SHIPT-DTE-REDEF.                                01810099
014900         10  WS-DTM02-REDEF-CC       PIC  X(2)  VALUE SPACES.     01820099
015000         10  WS-DTM02-REDEF-YY       PIC  X(2)  VALUE SPACES.     01830099
015100         10  FILLER                  PIC  X(1)  VALUE '-'.        01840099
015200         10  WS-DTM02-REDEF-MM       PIC  X(2)  VALUE SPACES.     01850099
015300         10  FILLER                  PIC  X(1)  VALUE '-'.        01860099
015400         10  WS-DTM02-REDEF-DD       PIC  X(2)  VALUE SPACES.     01870099
015500     05  WS-DTM03-SHIPT-TIME.                                     01880099
015600         10  WS-DTM03-HH             PIC  X(2)  VALUE SPACES.     01890099
015601         10  WS-DTM03-MM             PIC  X(2)  VALUE SPACES.     01900099
015602     05  WS-DTM03-SHIPT-TIME-REDEF.                               01910099
015603         10  WS-DTM03-REDEF-HH       PIC  X(2)  VALUE SPACES.     01920099
015604         10  FILLER                  PIC  X(1)  VALUE '.'.        01930099
015605         10  WS-DTM03-REDEF-MM       PIC  X(2)  VALUE SPACES.     01940099
015606         10  FILLER                  PIC  X(1)  VALUE '.'.        01950099
015607         10  WS-DTM03-REDEF-SS       PIC  X(2)  VALUE SPACES.     01960099
015610 01  WS-NULL-INDICATORS.                                          01970099
015620     05  WS-INCHG-ID-QUAL-CDE-NULL   PIC S9(04) VALUE +0 COMP.    01980099
015630     05  WS-INCHG-SNDR-ID-NULL       PIC S9(04) VALUE +0 COMP.    01990099
015640     05  WS-ERR-ROW-ID-NULL          PIC S9(04) VALUE +0 COMP.    02000099
015650     05  WS-EQUIP-DESC-CDE-NULL      PIC S9(04) VALUE +0 COMP.    02010099
015660     05  WS-WT-QTY-NULL              PIC S9(04) VALUE +0 COMP.    02020099
015670     05  WS-RTEG-SEQ-CDE-NULL        PIC S9(04) VALUE +0 COMP.    02030099
015680     05  WS-TRANS-MTHD-TYP-CDE-NULL  PIC S9(04) VALUE +0 COMP.    02040099
015690     05  WS-RTEG-DESC-TXT-NULL       PIC S9(04) VALUE +0 COMP.    02050099
015691******************************************************************02060099
015692*  SYSTEM DATE AND TIME STORAGE AREA                              02070099
015693******************************************************************02080099
015694                                                                  02090099
015695 01  WS-PARM-REC.                                                 02100099
015696     05  WS-ASN-LIMIT-PARM               PIC 9(7).                02110099
015697     05  FILLER                          PIC X(73).               02120099
015698                                                                  02130099
015699 01  WS-TODAYS-DATE.                                              02140099
015700     05  WS-YY                           PIC 9(02)   VALUE ZEROES.02150099
015701     05  WS-MO                           PIC 9(02)   VALUE ZEROES.02160099
015702     05  WS-DD                           PIC 9(02)   VALUE ZEROES.02170099
015703                                                                  02180099
015704 01  WS-TODAYS-DATE-DB2.                                          02190099
015705     05  WS-CC-DB2                       PIC 9(02)   VALUE 19.    02200099
015706     05  WS-YY-DB2                       PIC 9(02)   VALUE ZEROES.02210099
015707     05  FILLER                          PIC X(01)   VALUE '-'.   02220099
015708     05  WS-MO-DB2                       PIC 9(02)   VALUE ZEROES.02230099
015709     05  FILLER                          PIC X(01)   VALUE '-'.   02240099
015710     05  WS-DD-DB2                       PIC 9(02)   VALUE ZEROES.02250099
015711                                                                  02260099
015712 01  WS-TODAYS-TIME.                                              02270099
015713     05  WS-HH                           PIC 9(02)   VALUE ZEROES.02280099
015714     05  WS-MM                           PIC 9(02)   VALUE ZEROES.02290099
015715     05  WS-SS                           PIC 9(02)   VALUE ZEROES.02300099
015716                                                                  02310099
015717 01  WS-PO-NUM-DIG                       PIC S9(09)  COMP.        02320099
015718                                                                  02330099
015719 01  PV-PROGRAM-VARIABLES.                                        02340099
015720     05  PV-PARAGRAPH-NAME               PIC X(30).               02350099
015721     05  PV-DB2-OPER-ATTEMPTED           PIC X(30).               02360099
015722     05  PV-COUNTER                      PIC S9(4) COMP.          02370099
015723                                                                  02380099
015724 01  PS-PROGRAM-SWITCHES.                                         02390099
015725     05  PS-ENT-ID-SW                    PIC X(01).               02400099
015726         88  PS-ENT-ID-FOUND                VALUE 'Y'.            02410099
015727         88  PS-ENT-ID-NOT-FOUND            VALUE 'N'.            02420099
015728     05  PS-MULTIPLE-ENT-ID-SW           PIC X(01).               02430099
015729         88  PS-MULTIPLE-ENT-ID             VALUE 'Y'.            02440099
015730         88  PS-SINGLE-ENT-ID               VALUE 'N'.            02450099
015731     05  PS-END-OF-FILE-SW               PIC X(01).               02460099
015732         88  PS-END-OF-FILE                 VALUE 'Y'.            02470099
015733         88  PS-NOT-END-OF-FILE             VALUE 'N'.            02480099
015734     05  PS-TP-SETUP-SW                  PIC X(01).               02490099
015735         88  PS-TP-SETUP                    VALUE 'Y'.            02500099
015736         88  PS-TP-NOT-SETUP                VALUE 'N'.            02510099
015737     05  PS-HALLMARK-SW                  PIC X(01).               02520099
015738         88  PS-HALLMARK                    VALUE 'Y'.            02530099
015739         88  PS-NO-HALLMARK                 VALUE 'N'.            02540099
015740                                                                  02550099
015774                                                                  02560099
015780******************************************************************02570099
015800*    REVERSE PO PARTICIPANTS                                      02580099
015900******************************************************************02590099
016000     COPY SNWS002.                                                02600099
016100******************************************************************02610099
016200*    NUMERIC EDIT ROUTINE                                         02620099
016300******************************************************************02630099
016400     COPY DPWS010I.                                               02640099
016500                                                                  02650099
016600* COMMUNICATIONS AREA FOR DB2                                     02660099
016610     EXEC SQL                                                     02670099
016620         INCLUDE SQLCA                                            02680099
016630     END-EXEC.                                                    02690099
016640                                                                  02700099
016720* DB2 TABLE DECLARATION                                           02710099
016730* (SNT_DAT_CNTL - ASN DATA TRANSFER CONTROL TABLE)                02720099
016740     EXEC SQL                                                     02730099
016750         INCLUDE SNT00000                                         02740099
016760     END-EXEC.                                                    02750099
016770                                                                  02760099
016780* DB2 TABLE DECLARATION                                           02770099
016790* (SNT_DAT_XFER - ASN DATA TRANSFER DETAIL TABLE)                 02780099
016791     EXEC SQL                                                     02790099
016792         INCLUDE SNT00001                                         02800099
016793     END-EXEC.                                                    02810099
016794                                                                  02820099
016795* DB2 TABLE DECLARATION                                           02830099
016796* (TPURCHS - PO TABLE)                                            02840099
016797     EXEC SQL                                                     02850099
016798         INCLUDE TPURCHS                                          02860099
016799     END-EXEC.                                                    02870099
016800                                                                  02880099
016801* DB2 TABLE DECLARATION                                           02890099
016802* (XLT_VND DOMAIN VENDOR)                                         02900099
016803     EXEC SQL                                                     02910099
016804         INCLUDE XLT00035                                         02920099
016805     END-EXEC.                                                    02930099
016806                                                                  02940099
016807* INPUT LAYOUT - ASN DTL INPUT REPOSITORY TABLE.                  02950099
016810     COPY SNRD005.                                                02960099
016811* INPUT LAYOUT - ASN DTL RECORD COPYBOOK.                         02970099
016812     COPY SNRD001I.                                               02980099
016807* OUTPUT LAYOUT                                                   02990099
016810     COPY SNRD006.                                                03000099
016820                                                                  03010099
016830*  DB2 FORMATTED MESSAGE AREA.                                    03020099
016840     COPY DPWS004.                                                03030099
016850                                                                  03040099
017020     EXEC SQL                                                     03050099
017021         DECLARE CNTL CURSOR WITH HOLD FOR                        03060099
017022            SELECT DAT_XFER_CNTL_ID                               03070099
017023                 , CRE_TMST                                       03080099
017024                 , STAT_CDE                                       03090099
017025            FROM SNT_DAT_CNTL                                     03100099
017026            WHERE STAT_CDE    = 'R'  AND                          03110099
017027                  ASN_TYP_CDE = 'R'                               03120099
017029*           FOR UPDATE OF STAT_CDE, END_PRC_TMST                  03130099
017030     END-EXEC.                                                    03140099
017040     EXEC SQL                                                     03150099
017050         DECLARE XFER CURSOR WITH HOLD FOR                        03160099
017060            SELECT PRC_LOD_SEQ_NBR,                               03170099
017061                   LOD_DAT_TXT                                    03180099
017070            FROM SNT_DAT_XFER                                     03190099
017080            WHERE DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID   03200099
017082            ORDER BY PRC_LOD_SEQ_NBR                              03210099
017090     END-EXEC.                                                    03220099
017091     EXEC SQL                                                     03230099
017092         DECLARE PO CURSOR FOR                                    03240099
017093            SELECT DAT_CTG_CDE,                                   03250099
017094                   LOD_DAT_TXT                                    03260099
017095            FROM SNT_DAT_XFER                                     03270099
017096            WHERE DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID   03280099
017098              AND DAT_CTG_CDE      = 'PRF'                        03290099
017099     END-EXEC.                                                    03300099
017100     EXEC SQL                                                     03310099
017110         DECLARE CHKPO CURSOR FOR                                 03320099
017120            SELECT PO_NBR,                                        03330099
017130                   ENT_ID                                         03340099
017140            FROM TPURCHS                                          03350099
017150            WHERE PO_NBR = :PURCHS-PO-NBR                         03360099
017170     END-EXEC.                                                    03370099
017200                                                                  03380099
023000                                                                  03390025
032900 PROCEDURE DIVISION.                                              03400099
032910 0000-MAINLINE.                                                   03410099
032911                                                                  03420099
032912     PERFORM 1000-INITIALIZE.                                     03430099
032913                                                                  03440099
032924     PERFORM 1100-PROCESS-ASNS                                    03450099
032930        UNTIL PS-END-OF-CNTL-CSR-YES.                             03460099
032932                                                                  03470099
032933     PERFORM 9000-EOJ-ROUTINE.                                    03480099
032934                                                                  03490099
032935     CLOSE SN-PARM-CARD                                           03500099
032936           SN-ASN-FILE                                            03510099
                 SN-CNTL-ID-FILE.                                       03520099
032937                                                                  03530099
032970     GOBACK.                                                      03540099
032980                                                                  03550099
033000 1000-INITIALIZE.                                                 03560099
033100     MOVE '1000-INITIALIZE'        TO PV-PARAGRAPH.               03570099
033110                                                                  03580099
033111     OPEN INPUT  SN-PARM-CARD                                     03590099
033112          OUTPUT SN-ASN-FILE                                      03600099
                       SN-CNTL-ID-FILE.                                 03610099
                                                                        03620099
           INITIALIZE SN006-CONTROL-RECORD.                             03630099
033113                                                                  03640099
033120     SET PS-END-OF-CNTL-CSR-NO TO TRUE.                           03650099
033130     SET PS-END-OF-XFER-CSR-NO TO TRUE.                           03660099
033160                                                                  03670099
033170     READ SN-PARM-CARD INTO WS-PARM-REC.                          03680099
033174                                                                  03690099
033180 1100-PROCESS-ASNS.                                               03700099
033190     MOVE '1100-PROCESS-ASNS' TO PV-PARAGRAPH.                    03710099
033191                                                                  03720099
033192     INITIALIZE DCLSNT00000.                                      03730099
033193                                                                  03740099
033194     PERFORM 1200-OPEN-CNTL-CSR.                                  03750099
033195     PERFORM 1300-FETCH-CNTL-CSR                                  03760099
033196        UNTIL PS-END-OF-CNTL-CSR-YES                              03770099
033198     PERFORM 1400-CLOSE-CNTL-CSR.                                 03780099
033210                                                                  03790099
033220 1200-OPEN-CNTL-CSR.                                              03800099
033230     MOVE '1200-OPEN-CNTL-CSR' TO PV-PARAGRAPH.                   03810099
033240                                                                  03820099
033250     EXEC SQL                                                     03830099
033260          OPEN CNTL                                               03840099
033270     END-EXEC.                                                    03850099
033280                                                                  03860099
033290     EVALUATE TRUE                                                03870099
033291       WHEN SQLCODE = 0                                           03880099
033292          CONTINUE                                                03890099
033293       WHEN OTHER                                                 03900099
033294           DISPLAY '**************************************'       03910099
033295           DISPLAY '** ABEND                             *'       03920099
033296           DISPLAY '** PROGRAM = SNKSP001                *'       03930099
033297           DISPLAY '** PARAGRAPH = 1200-OPEN-CNTL-CSR    *'       03940099
033298           DISPLAY '** OPEN CNTL CURSOR                  *'       03950099
033299           DISPLAY '**************************************'       03960099
033300           PERFORM 9100-SQL-ABEND                                 03970099
033310     END-EVALUATE.                                                03980099
033320                                                                  03990099
033330 1300-FETCH-CNTL-CSR.                                             04000099
033340     MOVE '1300-FETCH-CNTL-CSR' TO PV-PARAGRAPH.                  04010099
033350                                                                  04020099
033360     EXEC SQL                                                     04030099
033370          FETCH CNTL                                              04040099
033380          INTO                                                    04050099
033390                :SNT00000-DAT-XFER-CNTL-ID                        04060099
033391               ,:SNT00000-CRE-TMST                                04070099
033392               ,:SNT00000-STAT-CDE                                04080099
033393     END-EXEC.                                                    04090099
033394                                                                  04100099
033395     EVALUATE TRUE                                                04110099
033396       WHEN SQLCODE = 0                                           04120099
033397           ADD 1 TO WS-ASN-COUNT                                  04130099
033398           PERFORM 2000-LOAD-ASN                                  04140099
033399           IF WS-ASN-COUNT >= WS-ASN-LIMIT-PARM                   04150099
033400              SET PS-END-OF-CNTL-CSR-YES TO TRUE                  04160099
033410           END-IF                                                 04170099
033440       WHEN SQLCODE = +100                                        04180099
033450           SET PS-END-OF-CNTL-CSR-YES TO TRUE                     04190099
033460       WHEN OTHER                                                 04200099
033470           DISPLAY '**************************************'       04210099
033480           DISPLAY '** ABEND                             *'       04220099
033490           DISPLAY '** PROGRAM = SNKSP001                *'       04230099
033491           DISPLAY '** PARAGRAPH = 1300-FETCH-CNTL-CSR   *'       04240099
033492           DISPLAY '** FETCH CNTL CURSOR                 *'       04250099
033493           DISPLAY '**************************************'       04260099
033494           PERFORM 9100-SQL-ABEND                                 04270099
033495     END-EVALUATE.                                                04280099
033496                                                                  04290099
033497 1400-CLOSE-CNTL-CSR.                                             04300099
033498     MOVE '1400-CLOSE-CNTL-CSR' TO PV-PARAGRAPH.                  04310099
033499                                                                  04320099
033500     EXEC SQL                                                     04330099
033510          CLOSE CNTL                                              04340099
033520     END-EXEC.                                                    04350099
033530                                                                  04360099
033540     EVALUATE TRUE                                                04370099
033550       WHEN SQLCODE = 0                                           04380099
033560           CONTINUE                                               04390099
033570       WHEN OTHER                                                 04400099
033580           DISPLAY '**************************************'       04410099
033590           DISPLAY '** ABEND                             *'       04420099
033591           DISPLAY '** PROGRAM = SNKSP001                *'       04430099
033592           DISPLAY '** PARAGRAPH = 1400-CLOSE-CNTL-CSR   *'       04440099
033593           DISPLAY '** CLOSE CNTL CURSOR                 *'       04450099
033594           DISPLAY '**************************************'       04460099
033595           PERFORM 9100-SQL-ABEND                                 04470099
033596     END-EVALUATE.                                                04480099
033597                                                                  04490099
033598 1500-OPEN-XFER-CSR.                                              04500099
033599     MOVE '1500-OPEN-XFER-CSR' TO PV-PARAGRAPH.                   04510099
033600                                                                  04520099
033610     EXEC SQL                                                     04530099
033620          OPEN XFER                                               04540099
033630     END-EXEC.                                                    04550099
033640                                                                  04560099
033650     EVALUATE TRUE                                                04570099
033660       WHEN SQLCODE = 0                                           04580099
033661           CONTINUE                                               04590099
033680       WHEN OTHER                                                 04600099
033690           DISPLAY '**************************************'       04610099
033691           DISPLAY '** ABEND                             *'       04620099
033692           DISPLAY '** PROGRAM = SNKSP001                *'       04630099
033693           DISPLAY '** PARAGRAPH = 1500-OPEN-XFER-CSR    *'       04640099
033694           DISPLAY '** OPEN XFER CURSOR                  *'       04650099
033695           DISPLAY '**************************************'       04660099
033696           PERFORM 9100-SQL-ABEND                                 04670099
033697     END-EVALUATE.                                                04680099
033698                                                                  04690099
033699 1600-FETCH-XFER-CSR.                                             04700099
033700     MOVE '1600-FETCH-XFER-CSR' TO PV-PARAGRAPH.                  04710099
033710                                                                  04720099
033720     EXEC SQL                                                     04730099
033730          FETCH XFER                                              04740099
033740          INTO                                                    04750099
033741             :SNT00001-PRC-LOD-SEQ-NBR,                           04760099
033750             :SNT00001-LOD-DAT-TXT                                04770099
033760     END-EXEC.                                                    04780099
033770                                                                  04790099
033780     EVALUATE TRUE                                                04800099
033790       WHEN SQLCODE = 0                                           04810099
033791           PERFORM 2100-PUT-ASN-IN-TABLE                          04820099
033795       WHEN SQLCODE = +100                                        04830099
033796           SET PS-END-OF-XFER-CSR-YES TO TRUE                     04840099
033797       WHEN OTHER                                                 04850099
033798           DISPLAY '**************************************'       04860099
033799           DISPLAY '** ABEND                             *'       04870099
033800           DISPLAY '** PROGRAM = SNKSP001                *'       04880099
033801           DISPLAY '** PARAGRAPH = 1600-FETCH-XFER-CSR   *'       04890099
033802           DISPLAY '** FETCH XFER CURSOR                 *'       04900099
033810           DISPLAY '**************************************'       04910099
033820           PERFORM 9100-SQL-ABEND                                 04920099
033830     END-EVALUATE.                                                04930099
033840                                                                  04940099
033850 1700-CLOSE-XFER-CSR.                                             04950099
033860     MOVE '1700-CLOSE-XFER-CSR' TO PV-PARAGRAPH.                  04960099
033870                                                                  04970099
033880     EXEC SQL                                                     04980099
033890          CLOSE XFER                                              04990099
033891     END-EXEC.                                                    05000099
033892                                                                  05010099
033893     EVALUATE TRUE                                                05020099
033894       WHEN SQLCODE = 0                                           05030099
033895           CONTINUE                                               05040099
033896       WHEN OTHER                                                 05050099
033897           DISPLAY '**************************************'       05060099
033898           DISPLAY '** ABEND                             *'       05070099
033899           DISPLAY '** PROGRAM = SNKSP001                *'       05080099
033900           DISPLAY '** PARAGRAPH = 1700-CLOSE-XFER-CSR   *'       05090099
033910           DISPLAY '** CLOSE XFER CURSOR                 *'       05100099
033920           DISPLAY '**************************************'       05110099
033930           PERFORM 9100-SQL-ABEND                                 05120099
033940     END-EVALUATE.                                                05130099
033950                                                                  05140099
033960*1800-UPDATE-CNTL-STAT-CMPLT.                                     05150099
033970*    MOVE '1800-UPDATE-CNTL-STAT-CDE' TO PV-PARAGRAPH.            05160099
033980                                                                  05170099
033990*    EXEC SQL                                                     05180099
033991*        UPDATE SNT_DAT_CNTL                                      05190099
033992*           SET STAT_CDE         = :PC-C,                         05200099
033993*               END_PRC_TMST     = CURRENT TIMESTAMP              05210099
033994*         WHERE CURRENT OF CNTL                                   05220099
033995*    END-EXEC.                                                    05230099
033996                                                                  05240099
033997*    EVALUATE TRUE                                                05250099
033998*      WHEN SQLCODE = 0                                           05260099
033999*          CONTINUE                                               05270099
034000*      WHEN OTHER                                                 05280099
034001*          DISPLAY '**************************************'       05290099
034010*          DISPLAY '** ABEND                             *'       05300099
034020*          DISPLAY '** PROGRAM = SNKSP001                *'       05310099
034030*          DISPLAY '** PARAGRAPH = 1800-UPDATE-CNTL-STAT-CMPLT'   05320099
034040*          DISPLAY '** UPDATE SNT_DAT_CNTL               *'       05330099
034050*          DISPLAY '**************************************'       05340099
034060*          PERFORM 9100-SQL-ABEND                                 05350099
034070*    END-EVALUATE.                                                05360099
034080                                                                  05370099
034090*1850-UPDATE-CNTL-STAT-HOLD.                                      05380099
034091*    MOVE '1850-UPDATE-CNTL-STAT-CDE' TO PV-PARAGRAPH.            05390099
034092                                                                  05400099
034093*    EXEC SQL                                                     05410099
034094*        UPDATE SNT_DAT_CNTL                                      05420099
034095*           SET STAT_CDE         = :PC-H                          05430099
034096*         WHERE DAT_XFER_CNTL_ID = :SNT00000-DAT-XFER-CNTL-ID     05440099
034097*    END-EXEC.                                                    05450099
034098                                                                  05460099
034099*    EVALUATE TRUE                                                05470099
034100*      WHEN SQLCODE = 0                                           05480099
034110*          CONTINUE                                               05490099
034120*      WHEN OTHER                                                 05500099
034130*          DISPLAY '**************************************'       05510099
034140*          DISPLAY '** ABEND                             *'       05520099
034150*          DISPLAY '** PROGRAM = SNKSP001                *'       05530099
034160*          DISPLAY '** PARAGRAPH = 1850-UPDATE-CNTL-STAT-HOLD'    05540099
034170*          DISPLAY '** UPDATE SNT_DAT_CNTL               *'       05550099
034180*          DISPLAY '**************************************'       05560099
034190*          PERFORM 9100-SQL-ABEND                                 05570099
034191*    END-EVALUATE.                                                05580099
034192                                                                  05590099
034296******************************************************************05600099
034297* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     05610099
034298******************************************************************05620099
034299*1950-DB2-COMMIT.                                                 05630099
034300*    MOVE '1950-DB2-COMMIT'          TO PV-PARAGRAPH.             05640099
034310                                                                  05650099
034320*    EXEC SQL                                                     05660099
034330*        COMMIT                                                   05670099
034340*    END-EXEC.                                                    05680099
034350                                                                  05690099
034360*    EVALUATE TRUE                                                05700099
034370*      WHEN SQLCODE = +0                                          05710099
034380*          CONTINUE                                               05720099
034390*      WHEN OTHER                                                 05730099
034391*          DISPLAY '****************************'                 05740099
034392*          DISPLAY '** ABEND                  **'                 05750099
034393*          DISPLAY '** PROGRAM = SNKSP001     **'                 05760099
034394*          DISPLAY '** PARAGRAPH = 1950-COMMIT**'                 05770099
034395*          DISPLAY '** UNSUCCESSFUL COMMIT    **'                 05780099
034396*          DISPLAY '****************************'                 05790099
034397*          PERFORM 9100-SQL-ABEND                                 05800099
034398*    END-EVALUATE.                                                05810099
034399                                                                  05820099
034400 2000-LOAD-ASN.                                                   05830099
034401                                                                  05840099
034402     SET PS-END-OF-XFER-CSR-NO TO TRUE.                           05850099
034403                                                                  05860099
034404     INITIALIZE DCLSNT00001.                                      05870099
034405                                                                  05880099
034406     MOVE SNT00000-DAT-XFER-CNTL-ID TO SNT00001-DAT-XFER-CNTL-ID. 05890099
                                                                        05900099
           MOVE SNT00000-DAT-XFER-CNTL-ID TO PV-DISPLAY-CNTL-ID         05910099
           DISPLAY PV-DISPLAY-CNTL-ID                                   05920099
034407                                                                  05930099
034408     PERFORM 1500-OPEN-XFER-CSR.                                  05940099
034410     PERFORM 1600-FETCH-XFER-CSR                                  05950099
034420        UNTIL PS-END-OF-XFER-CSR-YES.                             05960099
034440     PERFORM 1700-CLOSE-XFER-CSR.                                 05970099
034441                                                                  05980099
034442     IF PS-HALLMARK-ON-HOLD                                       05990099
034443        SET PS-HALLMARK-NOT-ON-HOLD TO TRUE                       06000099
034444     ELSE                                                         06010099
034445*       PERFORM 1800-UPDATE-CNTL-STAT-CMPLT                       06020099
              MOVE PC-C                   TO SN006-STAT-CDE             06030099
034445        PERFORM 8010-WRITE-ASN-CNTL-ID-FILE                       06040099
034446     END-IF.                                                      06050099
034447                                                                  06060099
034448*    PERFORM 1950-DB2-COMMIT.                                     06070099
034449                                                                  06080099
034450 2100-PUT-ASN-IN-TABLE.                                           06090099
034451                                                                  06100099
034452     INITIALIZE SN005-ASN-UNPACKED.                               06110099
034453     INITIALIZE ADVANCE-SHIP-NOTICE-DTL-RECORD.                   06120099
034470     MOVE SNT00001-LOD-DAT-TXT-TEXT TO                            06130099
034480        SN005-ASN-UNPACKED.                                       06140099
034483     EVALUATE SN005-REC-TYP-CDE                                   06150099
034484        WHEN 'ID '                                                06160099
034485           STRING SN005-ISA-ID-QUAL                               06170099
034486                  SN005-ISA-ID                                    06180099
034487                  DELIMITED BY SIZE                               06190099
034488                  INTO WS-HOLD-PO-MEMBERS                         06200099
034489           INITIALIZE WS-PO-TABLE                                 06210099
034490           SET PS-END-OF-PO-CSR-NO TO TRUE                        06220099
034491           PERFORM 7400-OPEN-PO-CSR                               06230099
034492           PERFORM 7500-FETCH-PO-CSR                              06240099
034493              VARYING SUB FROM 1 BY 1                             06250099
034494              UNTIL PS-END-OF-PO-CSR-YES                          06260099
034495           PERFORM 7600-CLOSE-PO-CSR                              06270099
034513           IF VALID-HOLD-PO-MEMBER                                06280099
034514              PERFORM                                             06290099
034515                 VARYING SUB FROM 1 BY 1                          06300099
034516                 UNTIL SUB > 10000 OR                             06310099
034517                       SUB > WS-PO-COUNT OR                       06320099
034518                       PS-HALLMARK-ON-HOLD                        06330099
034519                 IF WS-VEND(SUB) > 0                              06340099
034520                    CONTINUE                                      06350099
034521                 ELSE                                             06360099
034522                    SET PS-HALLMARK-ON-HOLD TO TRUE               06370099
034524                 END-IF                                           06380099
034525              END-PERFORM                                         06390099
034526           END-IF                                                 06400099
034527           IF PS-HALLMARK-ON-HOLD                                 06410099
034528*             PERFORM 1850-UPDATE-CNTL-STAT-HOLD                  06420099
                    MOVE PC-H                  TO SN006-STAT-CDE        06430099
034445              PERFORM 8010-WRITE-ASN-CNTL-ID-FILE                 06440099
034529              SET PS-END-OF-XFER-CSR-YES TO TRUE                  06450099
034530              DISPLAY 'HOLDING ...ASN => '                        06460099
034531                       SN005-BSN02-SHIPT-ID                       06470099
034533           ELSE                                                   06480099
034537              MOVE SN005-ASN-UNPACKED TO                          06490099
034538                 ADVANCE-SHIP-NOTICE-DTL-RECORD                   06500099
034539              MOVE SPACES TO SN001I-EDI-VEND-ID                   06510099
034540              SET PS-VENDOR-NOT-FOUND TO TRUE                     06520099
034547              PERFORM                                             06530099
034548                 VARYING SUB FROM 1 BY 1                          06540099
034549                 UNTIL SUB > 10000 OR                             06550099
034550                       SUB > WS-PO-COUNT OR                       06560099
034551                       PS-VENDOR-FOUND                            06570099
034553                 IF WS-VEND(SUB) > 0                              06580099
034554                    MOVE WS-VEND-X(SUB)(1:9) TO                   06590099
034555                       SN001I-VEND-DUNNS-NBR                      06600099
034556                    SET PS-VENDOR-FOUND TO TRUE                   06610099
034557                 END-IF                                           06620099
034561              END-PERFORM                                         06630099
034562              DISPLAY 'PROCESSING ...ASN/VENDOR => '              06640099
034563                       SN001I-BSN02-SHIPT-ID '/'                  06650099
034564                       SN001I-VEND-DUNNS-NBR                      06660099
034565              PERFORM 8000-WRITE-ASN-FILE                         06670099
034566           END-IF                                                 06680099
034567        WHEN 'PO4'                                                06690099
034568           INITIALIZE DP010I-UNEDITED-FIELD                       06700099
034569           INITIALIZE WS-NUMERIC-4                                06710099
034570           MOVE SN005-PO401-PKG-SIZE-QTY TO DP010I-UNEDITED-FIELD 06720099
034571           PERFORM 7100-NUMERIC-4                                 06730099
034572           MOVE WS-NUMERIC-4 TO SN001I-PO401-PKG-SIZE-QTY         06740099
034573           INITIALIZE DP010I-UNEDITED-FIELD                       06750099
034574           INITIALIZE WS-NUMERIC-1                                06760099
034575           MOVE SN005-PO402-SIZE-MSMT TO DP010I-UNEDITED-FIELD    06770099
034576           PERFORM 7000-NUMERIC-1                                 06780099
034577           IF WS-NUMERIC-1 > 0                                    06790099
034578              COMPUTE SN001I-PO402-SIZE-MSMT =                    06800099
034579                 WS-NUMERIC-1 / 100                               06810099
034580              END-COMPUTE                                         06820099
034581           ELSE                                                   06830099
034582              MOVE 0 TO SN001I-PO402-SIZE-MSMT                    06840099
034583           END-IF                                                 06850099
034584           INITIALIZE DP010I-UNEDITED-FIELD                       06860099
034585           INITIALIZE WS-NUMERIC-1                                06870099
034586           MOVE SN005-PO406-GRO-WGHT-MSMT TO DP010I-UNEDITED-FIELD06880099
034587           PERFORM 7000-NUMERIC-1                                 06890099
034588           COMPUTE SN001I-PO406-GRO-WGHT-MSMT =                   06900099
034589              WS-NUMERIC-1 / 100                                  06910099
034590           END-COMPUTE                                            06920099
034591           INITIALIZE DP010I-UNEDITED-FIELD                       06930099
034592           INITIALIZE WS-NUMERIC-1                                06940099
034593           MOVE SN005-PO408-GRO-VOL-MSMT TO DP010I-UNEDITED-FIELD 06950099
034594           PERFORM 7000-NUMERIC-1                                 06960099
034595           COMPUTE SN001I-PO408-GRO-VOL-MSMT =                    06970099
034596              WS-NUMERIC-1 / 100                                  06980099
034597           END-COMPUTE                                            06990099
034598           INITIALIZE DP010I-UNEDITED-FIELD                       07000099
034599           INITIALIZE WS-NUMERIC-1                                07010099
034600           MOVE SN005-PO410-LEN-MSMT TO DP010I-UNEDITED-FIELD     07020099
034601           PERFORM 7000-NUMERIC-1                                 07030099
034602           IF WS-NUMERIC-1 > 0                                    07040099
034603              COMPUTE SN001I-PO410-LEN-MSMT =                     07050099
034604                 WS-NUMERIC-1 / 100                               07060099
034605              END-COMPUTE                                         07070099
034606           ELSE                                                   07080099
034607              MOVE 0 TO SN001I-PO410-LEN-MSMT                     07090099
034608           END-IF                                                 07100099
034609           INITIALIZE DP010I-UNEDITED-FIELD                       07110099
034610           INITIALIZE WS-NUMERIC-1                                07120099
034611           MOVE SN005-PO411-WDTH-MSMT TO DP010I-UNEDITED-FIELD    07130099
034612           PERFORM 7000-NUMERIC-1                                 07140099
034613           IF WS-NUMERIC-1 > 0                                    07150099
034614              COMPUTE SN001I-PO411-WDTH-MSMT =                    07160099
034615                 WS-NUMERIC-1 / 100                               07170099
034616              END-COMPUTE                                         07180099
034617           ELSE                                                   07190099
034618              MOVE 0 TO SN001I-PO411-WDTH-MSMT                    07200099
034619           END-IF                                                 07210099
034620           INITIALIZE DP010I-UNEDITED-FIELD                       07220099
034621           INITIALIZE WS-NUMERIC-1                                07230099
034622           MOVE SN005-PO412-HT-MSMT TO DP010I-UNEDITED-FIELD      07240099
034623           PERFORM 7000-NUMERIC-1                                 07250099
034624           IF WS-NUMERIC-1 > 0                                    07260099
034625              COMPUTE SN001I-PO412-HT-MSMT =                      07270099
034626                 WS-NUMERIC-1 / 100                               07280099
034627              END-COMPUTE                                         07290099
034628           ELSE                                                   07300099
034629              MOVE 0 TO SN001I-PO412-HT-MSMT                      07310099
034630           END-IF                                                 07320099
034631           MOVE SN005-PO4-ID TO SN001I-PO4-ID                     07330099
034632           MOVE SN005-PO403-SIZE-UM-CDE TO                        07340099
034633              SN001I-PO403-SIZE-UM-CDE                            07350099
034634           MOVE SN005-PO405-WGHT-QUAL-CDE TO                      07360099
034635              SN001I-PO405-WGHT-QUAL-CDE                          07370099
034636           MOVE SN005-PO407-WGHT-UM-CDE TO                        07380099
034637              SN001I-PO407-WGHT-UM-CDE                            07390099
034638           MOVE SN005-PO409-VOL-UM-CDE TO                         07400099
034639              SN001I-PO409-VOL-UM-CDE                             07410099
034640           MOVE SN005-PO413-UM-CDE TO                             07420099
034641              SN001I-PO413-UM-CDE                                 07430099
034642           MOVE SN005-PO414-INPK-EA-QTY TO                        07440099
034643              SN001I-PO414-INPK-EA-QTY                            07450099
034644           MOVE SPACE TO SN001I-PO4-FILLER                        07460099
034645           PERFORM 8000-WRITE-ASN-FILE                            07470099
034646        WHEN 'TD1'                                                07480099
034647           INITIALIZE DP010I-UNEDITED-FIELD                       07490099
034648           INITIALIZE WS-NUMERIC-4                                07500099
034649           MOVE SN005-TD102-SHIPT-QTY TO DP010I-UNEDITED-FIELD    07510099
034650           PERFORM 7100-NUMERIC-4                                 07520099
034651           MOVE WS-NUMERIC-4 TO SN001I-TD102-SHIPT-QTY            07530099
034652           INITIALIZE DP010I-UNEDITED-FIELD                       07540099
034653           INITIALIZE WS-NUMERIC-1                                07550099
034654           MOVE SN005-TD107-WGHT-MSMT TO DP010I-UNEDITED-FIELD    07560099
034655           PERFORM 7000-NUMERIC-1                                 07570099
034656           IF WS-NUMERIC-1 > 0                                    07580099
034657              COMPUTE SN001I-TD107-WGHT-MSMT =                    07590099
034658                 WS-NUMERIC-1 / 100                               07600099
034659              END-COMPUTE                                         07610099
034660           ELSE                                                   07620099
034661              MOVE 0 TO SN001I-TD107-WGHT-MSMT                    07630099
034662           END-IF                                                 07640099
034663           MOVE SN005-TD1-ID TO SN001I-TD1-ID                     07650099
034664           MOVE SN005-TD101-PKG-CDE TO SN001I-TD101-PKG-CDE       07660099
034665           MOVE SN005-TD106-WGHT-QUAL-CDE TO                      07670099
034666              SN001I-TD106-WGHT-QUAL-CDE                          07680099
034667           MOVE SN005-TD108-UM-CDE TO                             07690099
034668              SN001I-TD108-UM-CDE                                 07700099
034669           MOVE SPACES TO SN001I-TD1-FILLER                       07710099
034670           PERFORM 8000-WRITE-ASN-FILE                            07720099
034671        WHEN 'TD5'                                                07730099
034672           INITIALIZE DP010I-UNEDITED-FIELD                       07740099
034673           INITIALIZE WS-NUMERIC-3                                07750099
034674           MOVE SN005-TD511-TRNST-TIME TO DP010I-UNEDITED-FIELD   07760099
034675           PERFORM 7200-NUMERIC-3                                 07770099
034676           IF WS-NUMERIC-3 > 0                                    07780099
034677              COMPUTE SN001I-TD511-TRNST-TIME =                   07790099
034678                 WS-NUMERIC-3 / 100000                            07800099
034679              END-COMPUTE                                         07810099
034680           ELSE                                                   07820099
034681              MOVE 0 TO SN001I-TD511-TRNST-TIME                   07830099
034682           END-IF                                                 07840099
034683           MOVE SN005-TD5-ID TO                                   07850099
034684              SN001I-TD5-ID                                       07860099
034685           MOVE SN005-TD501-RTE-SEQ-CDE TO                        07870099
034686              SN001I-TD501-RTE-SEQ-CDE                            07880099
034687           MOVE SN005-TD502-CARR-ID-QUAL-CDE TO                   07890099
034688              SN001I-TD502-CARR-ID-QUAL-CDE                       07900099
034689           MOVE SN005-TD503-CARR-ID-CDE TO                        07910099
034690              SN001I-TD503-CARR-ID-CDE                            07920099
034691           MOVE SN005-TD504-TRANS-MTHD-CDE TO                     07930099
034692              SN001I-TD504-TRANS-MTHD-CDE                         07940099
034693           MOVE SN005-TD505-CARR-NME TO                           07950099
034694              SN001I-TD505-CARR-NME                               07960099
034695           MOVE SN005-TD506-STATUS-CDE TO                         07970099
034696              SN001I-TD506-STATUS-CDE                             07980099
034697           MOVE SN005-TD507-LOC-QUAL TO                           07990099
034698              SN001I-TD507-LOC-QUAL                               08000099
034699           MOVE SN005-TD508-LOC-ID TO                             08010099
034700              SN001I-TD508-LOC-ID                                 08020099
034701           MOVE SN005-TD510-TRNS-TME-QUAL-CDE TO                  08030099
034702              SN001I-TD510-TRNS-TME-QUAL-CDE                      08040099
034703           MOVE SPACES TO SN001I-TD5-FILLER                       08050099
034704           PERFORM 8000-WRITE-ASN-FILE                            08060099
034705        WHEN 'CUR'                                                08070099
034706           INITIALIZE DP010I-UNEDITED-FIELD                       08080099
034707           INITIALIZE WS-NUMERIC-2                                08090099
034708           MOVE SN005-CUR03-EXCH-FCTR TO DP010I-UNEDITED-FIELD    08100099
034709           PERFORM 7300-NUMERIC-2                                 08110099
034710           IF WS-NUMERIC-2 > 0                                    08120099
034711              COMPUTE SN001I-CUR03-EXCH-FCTR =                    08130099
034712                 WS-NUMERIC-2 / 100000                            08140099
034713              END-COMPUTE                                         08150099
034714           ELSE                                                   08160099
034715              MOVE 0 TO SN001I-CUR03-EXCH-FCTR                    08170099
034716           END-IF                                                 08180099
034717           MOVE SN005-CUR-ID TO                                   08190099
034718              SN001I-CUR-ID                                       08200099
034719           MOVE SN005-CUR01-ID-CDE TO                             08210099
034720              SN001I-CUR01-ID-CDE                                 08220099
034721           MOVE SN005-CUR02-CURR-CDE TO                           08230099
034722              SN001I-CUR02-CURR-CDE                               08240099
034723           MOVE SN005-CUR04-ID-CDE TO                             08250099
034724              SN001I-CUR04-ID-CDE                                 08260099
034725           MOVE SN005-CUR05-CURR-CDE TO                           08270099
034726              SN001I-CUR05-CURR-CDE                               08280099
034727           MOVE SPACES TO SN001I-CUR-FILLER                       08290099
034728           PERFORM 8000-WRITE-ASN-FILE                            08300099
034729        WHEN 'SN1'                                                08310099
034730           INITIALIZE DP010I-UNEDITED-FIELD                       08320099
034731           INITIALIZE WS-NUMERIC-4                                08330099
034732           MOVE SN005-SN102-SHIP-QTY TO DP010I-UNEDITED-FIELD     08340099
034733           PERFORM 7100-NUMERIC-4                                 08350099
034734           MOVE WS-NUMERIC-4 TO SN001I-SN102-SHIP-QTY             08360099
034735           INITIALIZE DP010I-UNEDITED-FIELD                       08370099
034736           INITIALIZE WS-NUMERIC-4                                08380099
034737           MOVE SN005-SN104-SHIPT-DTE-QTY TO DP010I-UNEDITED-FIELD08390099
034738           PERFORM 7100-NUMERIC-4                                 08400099
034739           MOVE WS-NUMERIC-4 TO SN001I-SN104-SHIPT-DTE-QTY        08410099
034740           INITIALIZE DP010I-UNEDITED-FIELD                       08420099
034741           INITIALIZE WS-NUMERIC-4                                08430099
034742           MOVE SN005-SN105-ORD-QTY TO DP010I-UNEDITED-FIELD      08440099
034743           PERFORM 7100-NUMERIC-4                                 08450099
034744           MOVE WS-NUMERIC-4 TO SN001I-SN105-ORD-QTY              08460099
034745           MOVE SN005-SN1-ID TO                                   08470099
034746              SN001I-SN1-ID                                       08480099
034747           MOVE SN005-SN101-ID-CDE TO                             08490099
034748              SN001I-SN101-ID-CDE                                 08500099
034749           MOVE SN005-SN103-SHIP-UM-CDE TO                        08510099
034750              SN001I-SN103-SHIP-UM-CDE                            08520099
034751           PERFORM 8000-WRITE-ASN-FILE                            08530099
034752        WHEN 'SLN'                                                08540099
034753           INITIALIZE DP010I-UNEDITED-FIELD                       08550099
034754           INITIALIZE WS-NUMERIC-4                                08560099
034755           MOVE SN005-SLN04-QTY TO DP010I-UNEDITED-FIELD          08570099
034756           PERFORM 7100-NUMERIC-4                                 08580099
034757           MOVE WS-NUMERIC-4 TO SN001I-SLN04-QTY                  08590099
034758           INITIALIZE DP010I-UNEDITED-FIELD                       08600099
034759           INITIALIZE WS-NUMERIC-1                                08610099
034760           MOVE SN005-SLN06-UNIT-PRICE-AMT TO                     08620099
034761              DP010I-UNEDITED-FIELD                               08630099
034762           PERFORM 7000-NUMERIC-1                                 08640099
034763           IF WS-NUMERIC-1 > 0                                    08650099
034764              COMPUTE SN001I-SLN06-UNIT-PRICE-AMT =               08660099
034765                 WS-NUMERIC-1 / 100                               08670099
034766              END-COMPUTE                                         08680099
034767           ELSE                                                   08690099
034768              MOVE 0 TO SN001I-SLN06-UNIT-PRICE-AMT               08700099
034769           END-IF                                                 08710099
034770           MOVE SN005-SLN-ID TO                                   08720099
034771              SN001I-SLN-ID                                       08730099
034772           MOVE SN005-SLN01-ID TO                                 08740099
034773              SN001I-SLN01-ID                                     08750099
034774           MOVE SN005-SLN03-CONFIG-CDE TO                         08760099
034775              SN001I-SLN03-CONFIG-CDE                             08770099
034776           MOVE SN005-SLN05-UM-CDE TO                             08780099
034777              SN001I-SLN05-UM-CDE                                 08790099
034778           MOVE SN005-SLN07-UNIT-PRICE-CDE TO                     08800099
034779              SN001I-SLN07-UNIT-PRICE-CDE                         08810099
034780           MOVE SN005-SLN08-PRICE-CD TO                           08820099
034781              SN001I-SLN08-PRICE-CD                               08830099
034782           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(1) TO                08840099
034783              SN001I-SLN09-PROD-ID-QUAL-CDE(1)                    08850099
034784           MOVE SN005-SLN10-PROD-ID(1) TO                         08860099
034785              SN001I-SLN10-PROD-ID(1)                             08870099
034786           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(2) TO                08880099
034787              SN001I-SLN09-PROD-ID-QUAL-CDE(2)                    08890099
034788           MOVE SN005-SLN10-PROD-ID(2) TO                         08900099
034789              SN001I-SLN10-PROD-ID(2)                             08910099
034790           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(3) TO                08920099
034791              SN001I-SLN09-PROD-ID-QUAL-CDE(3)                    08930099
034792           MOVE SN005-SLN10-PROD-ID(3) TO                         08940099
034793              SN001I-SLN10-PROD-ID(3)                             08950099
034794           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(4) TO                08960099
034795              SN001I-SLN09-PROD-ID-QUAL-CDE(4)                    08970099
034796           MOVE SN005-SLN10-PROD-ID(4) TO                         08980099
034797              SN001I-SLN10-PROD-ID(4)                             08990099
034798           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(5) TO                09000099
034799              SN001I-SLN09-PROD-ID-QUAL-CDE(5)                    09010099
034800           MOVE SN005-SLN10-PROD-ID(5) TO                         09020099
034801              SN001I-SLN10-PROD-ID(5)                             09030099
034802           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(6) TO                09040099
034803              SN001I-SLN09-PROD-ID-QUAL-CDE(6)                    09050099
034804           MOVE SN005-SLN10-PROD-ID(6) TO                         09060099
034805              SN001I-SLN10-PROD-ID(6)                             09070099
034806           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(7) TO                09080099
034807              SN001I-SLN09-PROD-ID-QUAL-CDE(7)                    09090099
034808           MOVE SN005-SLN10-PROD-ID(7) TO                         09100099
034809              SN001I-SLN10-PROD-ID(7)                             09110099
034810           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(8) TO                09120099
034811              SN001I-SLN09-PROD-ID-QUAL-CDE(8)                    09130099
034812           MOVE SN005-SLN10-PROD-ID(8) TO                         09140099
034813              SN001I-SLN10-PROD-ID(8)                             09150099
034814           MOVE SN005-SLN09-PROD-ID-QUAL-CDE(9) TO                09160099
034815              SN001I-SLN09-PROD-ID-QUAL-CDE(9)                    09170099
034816           MOVE SN005-SLN10-PROD-ID(9) TO                         09180099
034817              SN001I-SLN10-PROD-ID(9)                             09190099
034818           MOVE SPACES TO SN001I-SLN09-PROD-ID-QUAL-CDE(10)       09200099
034819           MOVE SPACES TO SN001I-SLN10-PROD-ID(10)                09210099
034820           MOVE SPACES TO SN001I-SLN-FILLER                       09220099
034821           PERFORM 8000-WRITE-ASN-FILE                            09230099
034822        WHEN OTHER                                                09240099
034823           MOVE SN005-ASN-UNPACKED                                09250099
034823                             TO ADVANCE-SHIP-NOTICE-DTL-RECORD    09260099
034824           PERFORM 8000-WRITE-ASN-FILE                            09270099
034825     END-EVALUATE.                                                09280099
034826                                                                  09290099
034827 7000-NUMERIC-1.                                                  09300099
034828     MOVE 11 TO DP010I-MAXIMUM-DIGITS                             09310099
034829     MOVE 0 TO DP010I-MAXIMUM-DECIMALS                            09320099
034830     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      09330099
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09341099
263627          USING DP010I-NUMERIC-EDIT-AREA                          09342099
034900     IF DP010I-ERROR-DETECTED                                     09350099
035000         MOVE ZEROES TO WS-NUMERIC-1                              09360099
035100     ELSE                                                         09370099
035200         MOVE DP010I-NUMERIC-FIELD TO WS-NUMERIC-1                09380099
035300     END-IF.                                                      09390099
035400 7100-NUMERIC-4.                                                  09400099
035500     MOVE 7 TO DP010I-MAXIMUM-DIGITS                              09410099
035600     MOVE 0 TO DP010I-MAXIMUM-DECIMALS                            09420099
035700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      09430099
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09441099
263627          USING DP010I-NUMERIC-EDIT-AREA                          09442099
035900     IF DP010I-ERROR-DETECTED                                     09450099
036000         MOVE ZEROES TO WS-NUMERIC-4                              09460099
036100     ELSE                                                         09470099
036200         MOVE DP010I-NUMERIC-FIELD TO WS-NUMERIC-4                09480099
036300     END-IF.                                                      09490099
036400 7200-NUMERIC-3.                                                  09500099
036500     MOVE 9 TO DP010I-MAXIMUM-DIGITS                              09510099
036600     MOVE 0 TO DP010I-MAXIMUM-DECIMALS                            09520099
036700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      09530099
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09541099
263627          USING DP010I-NUMERIC-EDIT-AREA                          09542099
036900     IF DP010I-ERROR-DETECTED                                     09550099
037000         MOVE ZEROES TO WS-NUMERIC-3                              09560099
037100     ELSE                                                         09570099
037200         MOVE DP010I-NUMERIC-FIELD TO WS-NUMERIC-3                09580099
037300     END-IF.                                                      09590099
037400 7300-NUMERIC-2.                                                  09600099
037500     MOVE 11 TO DP010I-MAXIMUM-DIGITS                             09610099
037600     MOVE 0 TO DP010I-MAXIMUM-DECIMALS                            09620099
037700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      09630099
263627     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09641099
263627          USING DP010I-NUMERIC-EDIT-AREA                          09642099
037900     IF DP010I-ERROR-DETECTED                                     09650099
038000         MOVE ZEROES TO WS-NUMERIC-2                              09660099
038100     ELSE                                                         09670099
038200         MOVE DP010I-NUMERIC-FIELD TO WS-NUMERIC-2                09680099
038300     END-IF.                                                      09690099
038400 7400-OPEN-PO-CSR.                                                09700099
038500     MOVE '7400-OPEN-PO-CSR' TO PV-PARAGRAPH.                     09710099
038600                                                                  09720099
038700     EXEC SQL                                                     09730099
038800          OPEN PO                                                 09740099
038900     END-EXEC.                                                    09750099
039000                                                                  09760099
039100     EVALUATE TRUE                                                09770099
039200       WHEN SQLCODE = 0                                           09780099
039300          MOVE 0 TO WS-PO-COUNT                                   09790099
039400       WHEN OTHER                                                 09800099
039500           DISPLAY '**************************************'       09810099
039600           DISPLAY '** ABEND                             *'       09820099
039700           DISPLAY '** PROGRAM = SNKUT120                *'       09830099
039800           DISPLAY '** PARAGRAPH = 7400-OPEN-PO-CSR'              09840099
039900           DISPLAY '** OPEN PO CURSOR                    *'       09850099
040000           DISPLAY '**************************************'       09860099
040100           PERFORM 9100-SQL-ABEND                                 09870099
040200     END-EVALUATE.                                                09880099
040300                                                                  09890099
040400 7500-FETCH-PO-CSR.                                               09900099
040500     MOVE '7500-FETCH-PO-CSR' TO PV-PARAGRAPH.                    09910099
040600                                                                  09920099
040700     EXEC SQL                                                     09930099
040800          FETCH PO                                                09940099
040900          INTO                                                    09950099
041000             :SNT00001-DAT-CTG-CDE,                               09960099
041100             :SNT00001-LOD-DAT-TXT                                09970099
041200     END-EXEC.                                                    09980099
041300                                                                  09990099
041400     EVALUATE TRUE                                                10000099
041500       WHEN SQLCODE = 0                                           10010099
041600          MOVE SNT00001-LOD-DAT-TXT-TEXT TO                       10020099
041700             ADVANCE-SHIP-NOTICE-DTL-RECORD                       10030099
041800          MOVE SN001I-PRF01-PO-NBR(1:17) TO                       10040099
041900             DP010I-UNEDITED-FIELD                                10050099
042000*PS 11/04/2014 CHANGE STARTS                                      10060099
042000          MOVE 8 TO DP010I-MAXIMUM-DIGITS                         10070099
042000*PS 11/04/2014 CHANGE STARTS                                      10080099
042100          MOVE 0 TO DP010I-MAXIMUM-DECIMALS                       10090099
042200          SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                 10100099
263627          CALL DP010I-NUMERIC-EDIT-ROUTINE                        10111099
263627               USING DP010I-NUMERIC-EDIT-AREA                     10112099
042400          IF DP010I-ERROR-DETECTED                                10120099
042500              MOVE ZEROES TO WS-PO-NUMBER                         10130099
042600          ELSE                                                    10140099
042700              MOVE DP010I-NUMERIC-FIELD TO WS-PO-NUMBER           10150099
042800          END-IF                                                  10160099
042801          INITIALIZE DCLTPURCHS                                   10170099
042802          MOVE WS-PO-NUMBER TO PURCHS-PO-NBR                      10180099
042803          PERFORM 7700-OPEN-CHKPO-CSR                             10190099
042804          PERFORM 7800-FETCH-CHKPO-CSR                            10200099
042805          PERFORM 7900-CLOSE-CHKPO-CSR                            10210099
042810*         INITIALIZE WS-ORACLE-TRANSFER-AREA                      10220099
042900*         MOVE WS-PO-NUMBER TO WS-ORACLE-PO                       10230099
044594*         CALL PC-SNKUT150 USING WS-ORACLE-TRANSFER-AREA          10240099
044596*         IF WS-ORACLE-RC = 0 AND WS-ORACLE-SUPPLIER > 0          10250099
044597*            MOVE WS-ORACLE-SUPPLIER TO WS-VEND(SUB)              10260099
044599*         ELSE                                                    10270099
044600*            MOVE 0 TO WS-VEND(SUB)                               10280099
044607*         END-IF                                                  10290099
044608          ADD 1 TO WS-PO-COUNT                                    10300099
044609       WHEN SQLCODE = +100                                        10310099
044611           SET PS-END-OF-PO-CSR-YES TO TRUE                       10320099
044620       WHEN OTHER                                                 10330099
044700           DISPLAY '**************************************'       10340099
044800           DISPLAY '** ABEND                             *'       10350099
044900           DISPLAY '** PROGRAM = SNKUT120                *'       10360099
045000           DISPLAY '** PARAGRAPH = 7500-FETCH-PO-CSR'             10370099
045100           DISPLAY '** FETCH XFER CURSOR                 *'       10380099
045200           DISPLAY '**************************************'       10390099
045300           PERFORM 9100-SQL-ABEND                                 10400099
045400     END-EVALUATE.                                                10410099
045500                                                                  10420099
045600 7600-CLOSE-PO-CSR.                                               10430099
045700     MOVE '7600-CLOSE-PO-CSR' TO PV-PARAGRAPH.                    10440099
045800                                                                  10450099
045900     EXEC SQL                                                     10460099
046000          CLOSE PO                                                10470099
046100     END-EXEC.                                                    10480099
046200                                                                  10490099
046300     EVALUATE TRUE                                                10500099
046400       WHEN SQLCODE = 0                                           10510099
046500           CONTINUE                                               10520099
046600       WHEN OTHER                                                 10530099
046700           DISPLAY '**************************************'       10540099
046800           DISPLAY '** ABEND                             *'       10550099
046900           DISPLAY '** PROGRAM = SNKUT120                *'       10560099
047000           DISPLAY '** PARAGRAPH = 7600-CLOSE-PO-CSR'             10570099
047100           DISPLAY '** CLOSE PO CURSOR                   *'       10580099
047200           DISPLAY '**************************************'       10590099
047300           PERFORM 9100-SQL-ABEND                                 10600099
047400     END-EVALUATE.                                                10610099
047500 7700-OPEN-CHKPO-CSR.                                             10620099
047600     MOVE '7700-OPEN-CHKPO-CSR' TO PV-PARAGRAPH.                  10630099
047700                                                                  10640099
047800     EXEC SQL                                                     10650099
047900          OPEN CHKPO                                              10660099
048000     END-EXEC.                                                    10670099
048100                                                                  10680099
048200     EVALUATE TRUE                                                10690099
048300       WHEN SQLCODE = 0                                           10700099
048400          CONTINUE                                                10710099
048500       WHEN OTHER                                                 10720099
048600           DISPLAY '**************************************'       10730099
048700           DISPLAY '** ABEND                             *'       10740099
048800           DISPLAY '** PROGRAM = SNKUT120                *'       10750099
048900           DISPLAY '** PARAGRAPH = 7700-OPEN-CHKPO-CSR'           10760099
049000           DISPLAY '** OPEN CHKPO CURSOR                 *'       10770099
049100           DISPLAY '**************************************'       10780099
049200           PERFORM 9100-SQL-ABEND                                 10790099
049300     END-EVALUATE.                                                10800099
049400                                                                  10810099
049500 7800-FETCH-CHKPO-CSR.                                            10820099
049600     MOVE '7800-FETCH-CHKPO-CSR' TO PV-PARAGRAPH.                 10830099
049800     EXEC SQL                                                     10840099
049900          FETCH CHKPO                                             10850099
050000          INTO                                                    10860099
050100             :PURCHS-PO-NBR,                                      10870099
050200             :PURCHS-ENT-ID                                       10880099
050300     END-EXEC.                                                    10890099
050400                                                                  10900099
050500     EVALUATE TRUE                                                10910099
050600       WHEN SQLCODE = 0                                           10920099
050601          INITIALIZE DCLXLT00035                                  10930099
050602          PERFORM 8100-GET-XLT-VND                                10940099
050610       WHEN SQLCODE = +100                                        10950099
050700          MOVE 0 TO WS-VEND(SUB)                                  10960099
053300       WHEN OTHER                                                 10970099
053400           DISPLAY '**************************************'       10980099
053500           DISPLAY '** ABEND                             *'       10990099
053600           DISPLAY '** PROGRAM = SNKUT120                *'       11000099
053700           DISPLAY '** PARAGRAPH = 7800-FETCH-CHKPO-CSR'          11010099
053800           DISPLAY '** FETCH CHKPO CURSOR                *'       11020099
053900           DISPLAY '**************************************'       11030099
054000           PERFORM 9100-SQL-ABEND                                 11040099
054100     END-EVALUATE.                                                11050099
054200                                                                  11060099
054300 7900-CLOSE-CHKPO-CSR.                                            11070099
054400     MOVE '7900-CLOSE-CHKPO-CSR' TO PV-PARAGRAPH.                 11080099
054500                                                                  11090099
054600     EXEC SQL                                                     11100099
054700          CLOSE CHKPO                                             11110099
054800     END-EXEC.                                                    11120099
054900                                                                  11130099
055000     EVALUATE TRUE                                                11140099
055100       WHEN SQLCODE = 0                                           11150099
055200           CONTINUE                                               11160099
055300       WHEN OTHER                                                 11170099
055400           DISPLAY '**************************************'       11180099
055500           DISPLAY '** ABEND                             *'       11190099
055600           DISPLAY '** PROGRAM = SNKUT120                *'       11200099
055700           DISPLAY '** PARAGRAPH = 7900-CLOSE-CHKPO-CSR'          11210099
055800           DISPLAY '** CLOSE CHKPO CURSOR                *'       11220099
055900           DISPLAY '**************************************'       11230099
056000           PERFORM 9100-SQL-ABEND                                 11240099
056100     END-EVALUATE.                                                11250099
058900                                                                  11260099
063900 8000-WRITE-ASN-FILE.                                             11270099
064000******************************************************************11280099
064100*  WRITE THE OUTPUT FILE FOR SNK000                               11290099
064400******************************************************************11300099
064500*    DISPLAY '8000-WRITE-ASN-FILE'.                               11310099
064600                                                                  11320099
064700     WRITE SN-ASN-FILE-RECORD                                     11330099
064800         FROM ADVANCE-SHIP-NOTICE-DTL-RECORD.                     11340099
                                                                        11350099
063900 8010-WRITE-ASN-CNTL-ID-FILE.                                     11360099
064000******************************************************************11370099
064100*  WRITE THE OUTPUT FILE FOR SNKUP026 INPUT                       11380099
064400******************************************************************11390099
064500*    DISPLAY '8010-WRITE-ASN-CNTL-ID-FILE'.                       11400099
064600                                                                  11410099
           MOVE SNT00000-DAT-XFER-CNTL-ID TO SN006-DAT-XFER-CNTL-ID     11420099
064700     WRITE SN-CNTL-ID-RECORD                                      11430099
064800         FROM SN006-CONTROL-RECORD.                               11440099
           ADD 1 TO WS-CNTL-ID-COUNT.                                   11450099
064900                                                                  11460099
064901 8100-GET-XLT-VND.                                                11470099
064902******************************************************************11480099
064903*  GET VENDOR                                                     11490099
064904******************************************************************11500099
064905*    DISPLAY '8100-GET-XLT-VND'.                                  11510099
064910     EXEC SQL                                                     11520099
064930        SELECT VND_NBR                                            11530099
064940           INTO :XLT00035-VND-NBR                                 11540099
064950           FROM XLT_VND                                           11550099
064960           WHERE ENT_ID = :PURCHS-ENT-ID                          11560099
064970     END-EXEC.                                                    11570099
064971                                                                  11580099
064980     EVALUATE TRUE                                                11590099
064990       WHEN SQLCODE = 0                                           11600099
064991           MOVE XLT00035-VND-NBR TO WS-VEND-X(SUB)                11610099
064993       WHEN SQLCODE = +100                                        11620099
064994           MOVE 0 TO WS-VEND(SUB)                                 11630099
064996       WHEN OTHER                                                 11640099
064997           DISPLAY '**************************************'       11650099
064998           DISPLAY '** ABEND                             *'       11660099
064999           DISPLAY '** PROGRAM = SNKUT120                *'       11670099
065000           DISPLAY '** PARAGRAPH = 8100-GET-XLT-VND'              11680099
065001           DISPLAY '** SELECT XLT_VND                    *'       11690099
065002           DISPLAY '**************************************'       11700099
065003           PERFORM 9100-SQL-ABEND                                 11710099
065004     END-EVALUATE.                                                11720099
065010******************************************************************11730099
065100*                   E O J   P R O C E S S I N G                  *11740099
065200******************************************************************11750099
065300 9000-EOJ-ROUTINE.                                                11760099
065400                                                                  11770099
065600     DISPLAY ' '.                                                 11780099
065700     DISPLAY '*************************************'.             11790099
065800     DISPLAY '   * SNKUT120 SUMMARY STATISTICS *    '.            11800099
065900     DISPLAY ' '.                                                 11810099
066000     DISPLAY '   ------------------------------ '.                11820099
066100     DISPLAY '         ASN FILE CREATION        '.                11830099
066200     DISPLAY '   ------------------------------ '.                11840099
066900     DISPLAY ' NUMBER OF ASNS PROCESSED = ' WS-ASN-COUNT.         11850099
066900     DISPLAY ' CONTROL ID OUTPUT COUNT  = ' WS-CNTL-ID-COUNT.     11860099
067000     DISPLAY '*************************************'.             11870099
067100                                                                  11880099
133700******************************************************************11890099
133800* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      11900099
133900* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 11910099
134000******************************************************************11920099
134100 9100-SQL-ABEND.                                                  11930099
134200                                                                  11940099
134210     MOVE SQLCODE    TO PV-SQLCODE.                               11950099
134220     MOVE PV-SQLCODE TO PV-DISPLAY-SQLCODE.                       11960099
134230     DISPLAY '*** DB2 ERROR ***'.                                 11970099
134240     DISPLAY '*** SQLCODE   = ' PV-DISPLAY-SQLCODE.               11980099
134250     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 11990099
134260     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               12000099
134270     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               12010099
134280     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       12020099
134290     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             12030099
134291                                                                  12040099
134300* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    12050099
134400* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         12060099
134500* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     12070099
134600* FORMAT                                                          12080099
134700     COPY DPPD004.                                                12090099
134701                                                                  12100099
134710     IF SQLCODE NOT = -911                                        12110099
134720         EXEC SQL                                                 12120099
134730             ROLLBACK                                             12130099
134740         END-EXEC                                                 12140099
134750     END-IF.                                                      12150099
134800                                                                  12160099
136300     MOVE +4013 TO ABEND-CODE.                                    12170099
136400     CALL 'ILBOABN0' USING ABEND-CODE.                            12180099
136500                                                                  12190099
136600                                                                  12200099
136700******************************************************************12210099
136800*                       END OF PROGRAM                            12220099
136900******************************************************************12230099
