000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUP254.                                        00020000
000300 AUTHOR.         MARY KING.                                       00030000
000400 DATE-WRITTEN.   07/05/1994.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600******************************************************************00060000
000700*    COBOL 2 WITH SQL                                            *00070000
000800*                                                                *00080000
000900*    CLASS DISTRIBUTION PROCESS                                  *00090000
001000*                                                                *00100000
001100*    THIS PROGRAM DISTRIBUTES THE INVOICE COSTS ACROSS THE       *00110000
001200*    RECEIPTS FOR A MATCHED PURCHASE ORDER.  THE DISTRIBUTION    *00120000
001300*    IS CALCULATED AT THE PO/RECEIVER/STORE/ITEM LEVEL OF DETAIL.*00130000
001400*    TRANSACTIONS FOR THESE DISTRIBUTIONS ARE CREATED IN THE     *00140000
001500*    APRD045 DETAIL FORMAT, AND INSERTED INTO THE ADJUSTMENT     *00150000
001600*    JOURNAL TRANSACTION FILE DB2 TABLE.  ADDITIONALLY, RECORDS  *00160000
001700*    ARE CREATED FOR THE RECEIVER UPDATES FILE AND FOR THE       *00170000
001800*    RECONCILIATION RESULTS REPORT FILE.  ANY ERRORS THAT ARE    *00180000
001900*    FOUND WHERE THE TOTAL OF THE RECEIPT DISTRIBUTIONS DO NOT   *00190000
002000*    BALANCE TO THE TOTAL OF THE INVOICES PROCESSED WILL BE      *00200000
002100*    WRITTEN TO THE CLASS DISTRIBUTION EXCEPTION REPORT.         *00210000
002200*                                                                *00220000
002300* INPUT:                                                         *00230000
002400*  DATASETS:                                                     *00240000
002500*  1. POSTORE-INVOICE-FILE             (APRD058)                 *00250000
002600*  2. PO-LINES-FILE                    (APRD100)                 *00260000
002700*  3. RECEIPTS-SUM-FILE                (APRD101)                 *00270000
002800*  4. RECEIPTS-FILE                    (APRD105)                 *00280000
002900*                                                                *00290000
003000*  DB2 TABLES:                                                   *00300000
003100*  1. RELEASED PO/STORES TABLE         (TPOSTRR)                 *00310000
003200*  2. EXTERNAL ENTERPRISE TABLE        (TEXTENT)                 *00320000
003300*  3. EXTERNAL ENTERPRISE NAME TABLE   (TENTNME)                 *00330000
003400*  4. PURCHASE TABLE                   (TPURCHS)                 *00340000
003500*  5. NON-INVOICED RECEIPT TABLE       (TNINREC)                 *00350000
003600*  6. PURCHASE ORDER ITEM TABLE        (TPURITM)                 *00360000
003700*  7. PRICE CLAIM ADJUSTMENTS TABLE    (TPRCCLM)                 *00370000
003800*  8. AP CONTROL TABLE                 (TAPCNTL)                 *00380000
003900*  9. AP TRANSACTION CODE TABLE        (TTRNCDE)                 *00390000
004000* 10. AP NSD CONTROL TABLE             (APT00000)                *00400000
004100* 12. VENDOR AGREEMENT TABLE           (TVNDAGR)                 *00410000
004110* 13. MERCHANDISE AGREEMENT TABLE      (TMDSEAR)                 *00411052
004120* 13. VENDOR CAPABILITY VND_VNT_CPLB   (VNT00001)                *00412048
004200*                                                                *00420000
004300* OUTPUT:                                                        *00430000
004400*  1. ADJUSTMENT JOURNAL TRANSACTION FILE TABLE (TOUTAP1)        *00440000
004500*                                               (APRD045)        *00450000
004600*                                                                *00460000
004700*  2. RECONCILIATION RESULTS FILE TABLE         (TOUTAP2)        *00470000
004800*                                               (APRD263)        *00480000
004900*                                                                *00490000
005000*  3. RECEIVER UPDATES FILE TABLE               (TOUTAP3)        *00500000
005100*                                               (APRD254)        *00510000
005200*                                                                *00520000
005300*  4. CLASS DISTRIBUTION ERROR FILE TABLE       (TOUTAP4)        *00530000
005400*                                                                *00540000
005500******************************************************************00550000
005600******************************************************************00560000
005700*   CHANGES:                                                     *00570000
005800*                                                                *00580000
005900*   NOTE: REMOVED ALL CHANGE LOG ENTRIES PRIOR TO 1998 - SEE     *00590000
006000*         MEMBER IN PKMO.PGMDOC.SOURCE FOR FULL RECORD OF        *00600000
006100*         CHANGES.                                               *00610000
006200*                                                                *00620000
006300*02/03/98   ROBIN BERNOSKI                  WR/IR #: WR5703      *00630000
006400*           - MODIFIED THE MANNER IN WHICH THE STANDARD DATE     *00640000
006500*             ROUTINE, DPKUT500, IS TO BE CALLED WITHIN A        *00650000
006600*             PROGRAM SO THAT THE CALL IS DYNAMIC.               *00660000
006700*                                                                *00670000
006800*10/09/98   MIKE BESKE                      WR/IR #: 5998        *00680000
006900*           - CORRECTED THE PROBLEM WHERE ADJUSTMENTS ARE        *00690000
007000*             BEING CREATED FOR THE 4109 ACCOUNT WHEN THE        *00700000
007100*             RECEIVER BEING PROCESSED IS A NON-INVOICED         *00710000
007200*             RECEIPT.  THE ADJUSTMENTS WILL BE CREATED FOR      *00720000
007300*             THE MERCHANDISE DEPT.  IF A NINREC IS BEING        *00730000
007400*             PROCESSED AND THE STORE NUMBER IS ZERO, THEN       *00740000
007500*             '085' WILL BE USED AS THE STORE NUMBER. OTHER-     *00750000
007600*             WISE THE RECEIVER STORE NUMBER IS USED.  THE       *00760000
007700*             DEPARTMENT NUMBER WILL ALWAYS BE USED FOR THIS     *00770000
007800*             SITUATION, NEVER THE EXPENSE NUMBER. (PARAS        *00780000
007900*             MODIFIED J100-, J400-, J600-)                      *00790000
008000*                                                                *00800000
008100*   11/12/98  MIKE BESKE                         WR# 5998        *00810000
008200*           - PEOPLESOFT CONVERSION.  CHANGED THE OUTPUT         *00820000
008300*             COPYBOOK FROM APTRAN TO APRD045.  REMOVED ALL      *00830000
008400*             JULIAN DATE PROCESSING.  MODIFIED DISTRIBUTION     *00840000
008500*             FROM CLASS LEVEL TO SKU LEVEL.  ADDED THE          *00850000
008600*             TTRNCDE TABLE TO ACCESS/VERIFY INFORMATION         *00860000
008700*             ABOUT TRANSACTIONS BEING GENERATED.                *00870000
008800*                                                                *00880000
008900*   08/11/99  MIKE BESKE                         WR# 5998        *00890000
009000*           - PEOPLESOFT CONVERSION.  REMOVED THE DISCOUNT       *00900000
009100*             DISTRIBUTION (K400-) FROM THE J100- AND J400-      *00910000
009200*             PARAGRAPHS.  THIS WILL CORRECT THE PROBLEM OF      *00920000
009300*             TRYING TO DISTRIBUTE SMALL DOLLAR AMOUNTS          *00930000
009400*             ACROSS HUNDREDS OR MORE ADJUSTMENTS WHERE THE      *00940000
009500*             ACTUAL DISTRIB-AMOUNT IS LESS THAN A PENNY.        *00950000
009600*             THIS CAUSED THE LEFT OVER DISTRIBUTED AMOUNT       *00960000
009700*             TO BE INCORRECTLY DISTRIBUTED ON THE LAST          *00970000
009800*             RECEIVER CLASS/SKU ENCOUNTERED.  THE NEW           *00980000
009900*             CORRECTION WILL ALLOW ITHE AMOUNT TO BE DIS-       *00990000
010000*             TRIBUTED TO THE CORRECT CLASS REGARDLESS OF        *01000000
010100*             SKU.                                               *01010000
010200*                                                                *01020000
010300*   08/12/99  MIKE BESKE                         WR# 5998        *01030000
010400*           - PEOPLESOFT CONVERSION.  PER USER REQUEST, THE      *01040000
010500*             DNP CHARGES WILL BE PLACED INTO THE MISC           *01050000
010600*             CHARGES BUCKET INSTEAD OF THE GROSS COST AMT.      *01060000
010700*             PARA J600-.                                        *01070000
010800*                                                                *01080000
010900*   08/16/99  MIKE BESKE                         WR# 5998        *01090000
011000*           - PEOPLESOFT CONVERSION.  PER USER REQUEST, TRAN     *01100000
011100*             CODE 75 WILL NO LONGER HAVE TRAN CODE 17 & 18      *01110000
011200*             CREATED IN ASSOCIATION WITH IT.  TRAN 28 WILL      *01120000
011300*             INSTEAD BE CREATED TO CARRY ANY DISCOUNTS.         *01130000
011400*             THIS ELIMINATED THE NEED FOR PARAGRAPH J360-.      *01140000
011500*             TRAN CODE 76 WILL NO LONGER CARRY ANY DISCOUNT     *01150000
011600*             EITHER.  THIS MEANS THAT TRAN CODE 28 WILL         *01160000
011700*             HAVE INVOICE DISCOUNTS ALLOCATED TO IT FOR ALL     *01170000
011800*             TYPES OF TRANSACTIONS.                             *01180000
011900*             PARAS J300-, J700-.                                *01190000
012000*                                                                *01200000
012100*   08/17/99  MIKE BESKE                         WR# 5998        *01210000
012200*           - PEOPLESOFT CONVERSION.  PER USER REQUEST,          *01220000
012300*             AP045-ENTR-ID WILL ALWAYS CARRY THE PROGRAM        *01230000
012400*             NAME AS ITS VALUE WHEN ADJUSTMENTS ARE CREATED     *01240000
012500*             ADDED A CHECK IN J250- TO SEE IF A NINREC          *01250000
012600*             ADJUSTMENT IS BEING CREATED.  IF IT IS AND THE     *01260000
012700*             STORE NUMBER IS ZERO, THEN '085' WILL BE USED      *01270000
012800*             AS THE STORE NUMBER FOR THE ADJUSTMENT. OTHER-     *01280000
012900*             WISE THE ACTUAL STORE NUMBER WILL BE USED FOR      *01290000
013000*             THE ADJUSTMENT STORE NUMBER.                       *01300000
013100*             PARAS J250-, L200-.                                *01310000
013200*                                                                *01320000
013300*   08/30/99  MIKE BESKE                         WR# 5998        *01330000
013400*           - PEOPLESOFT CONVERSION.  CORRECTED CODE TO          *01340000
013500*             CARRY THE OVER THE LEFTOVER DISCOUNT AMOUNT        *01350000
013600*             ON THE LAST TRAN CODE 28 REC THAT IS WRITTEN       *01360000
013700*             WHEN THE PO BEING PROCESSED HAS NO MORE RE-        *01370000
013800*             CEIVERS.                                           *01380000
013900*             PARAS J250-, K400-.                                *01390000
014000*                                                                *01400000
014100*   08/10/2000 JILL JUEL                         WR# 20704       *01410000
014200*           - CHANGED CODE TO ONLY USE THE PROCESS DATE          *01420000
014300*             FOR THE INVOICE CUTOFF DATE, SO WHEN THE           *01430000
014400*             JOB RUNS AFTER MIDNIGHT ON SATURDAYS THE           *01440000
014500*             TRANSACTION WILL BE PULLED INTO THE CORRECT        *01450000
014600*             WEEK.                                              *01460000
014700*                                                                *01470000
014800*   11/10/2000 JILL JUEL                   WR/IR#:  20224        *01480000
014900*      THE PROGRAM WAS CHANGED TO ALLOW THE NEW MARK OUT         *01490000
015000*      OF STOCK(MOS), ADVERTISING(ADV), AND TRADE DISCOUNTS      *01500000
015100*      THAT ARE BEING ADDED TO THE VENDOR MANAGEMENT AND         *01510000
015200*      PO SYSTEMS TO BE PROCESSED THROUGH AP, ALONG WITH         *01520000
015300*      THE ADDITIONAL EXTENDED THAT CAN BE ADDED TO THE PO       *01530000
015400*      PAYMENTS TERMS. TO CREATE THE NEW EXPENSE ADJUSTMENT      *01540000
015500*      FOR THE ADVERTISING DISCOUNTS AND TO ALLOW FOR THE        *01550000
015600*      CHANGES TO THE APRD045 AND APRD058 COPYBOOKS.             *01560000
015700*                                                                *01570000
015800*   07/23/2001 ALEXIS KEIKER               WR/IR#:  22467        *01580000
015900*      INCREASED VALUE OF PC-AP045-LEN FROM 400 TO 500.          *01590000
016000*      THIS CHANGE WAS MADE TO REFLECT THE CHANGES MADE TO       *01600000
016100*      THE APRD045 COPYBOOK WHICH WAS INCREASED TO 500 AND       *01610000
016200*      THE TOUTAP1 TABLE.                                        *01620000
016300*                                                                *01630000
016400*   05/16/2002 KEVIN CATLIN                WR/IR #: 21278        *01640000
016500*      CHANGE MADE:  NI-SKU CHANGES.  THE 3 BYTE SKU-SEQ         *01650000
016600*      FIELD IS REPLACED WITH A NUMERIC 8 BYTE SKU FIELD.        *01660000
016700*      CHANGES MADE TO WORKING STORAGE FIELDS AND TO PARA-       *01670000
016800*      GRAPHS J100, J200, J250, J275, J350, J400, J500,          *01680000
016900*      AND J600.  INITIALIZED AP045-SKU-NBR FOR EXPENSE          *01690000
017000*      TRANSACTIONS IN PARAGRAPHS J300, J700, J800, & J900.      *01700000
017100*                                                                *01710000
017200*      INCORPORATED WITH ABOVE CHANGES, BY NANCY EILBES:         *01720000
017300*      REMOVED ALL REFERENCES TO INVOICE TABLES TINVOIC,         *01730000
017400*      TPAYREQ, TMDINVC AND TALCHRG, AND REMOVED COPYBOOKS       *01740000
017500*      APWS053 AND APPD053.  THE LATTER CONTAINED THE SQL        *01750000
017600*      USING THE ABOVE TABLES TO GET THE VENDOR FREIGHT TO       *01760000
017700*      BE ALLOCATED.  THIS WAS NOT NECESSARY, SINCE THE          *01770000
017800*      AMOUNT WAS AVAILABLE ON THE AP058 INPUT RECORD.           *01780000
017900*      MODIFIED THE VENDOR FREIGHT CALCULATIONS TO USE           *01790000
018000*      THE INPUT DATA INSTEAD.                                   *01800000
018100*                                                                *01810000
018200* 02/06/2003                                                     *01820000
018300*    CHANGE MADE: ARKPO PHASE3 PROJECT.                          *01830000
018400*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.          *01840000
018500*    UPDATED PGM COMMENT BLOCK WITH THE INPUT FILENAMES.         *01850000
018600*    CHANGED THE PURCHASE-ORDER FIELD NAME WITH PREFIXES OF      *01860000
018700*    AP058-, AP100-, AP101-, AP105- & AP263- TO -PO-NBR.         *01870000
018800*    REMOVE CODE REFERENCING AP058-INVOIC-ENTR-MTHD-CDE.         *01880000
018900*    REMOVED ID-ENTRY-METHOD BECAUSE IT WAS NOT BEING USED       *01890000
019000*    OTHER THAN BEING POPULATED BASED ON AP058-INVOIC-ENTR-      *01900000
019100*    MTHD-CDE. REMOVED PV-PO-X FROM W/S BECAUSE IT WAS ONLY      *01910000
019200*    7 BYTES LONG. IT AND PV-PO-IN-PROCESS-X WAS REPLACED        *01920000
019300*    BY PV-PO-9-X.  CODED J950-CREATE-ADJ-DOC-NBR TO CREATE      *01930000
019400*    THE AP045-DOC-NBR FOR THE VARIOUS ADJUSTMENTS CREATED       *01940000
019500*    IN THE J###- PARAGRAPHS.                                    *01950000
019600* MADE BY:  MIKE BESKE                          WR#: 23500       *01960000
019700*                                                                *01970000
019800* 05/12/2003                                                     *01980000
019900*    CHANGE MADE: NI-SKU PROJECT.                                *01990000
020000*    REPLACED THE RD-SKU-SEQ-NBR AND PL-SKU-SEQ-NBR WITH         *02000000
020100*    RD-SKU-NBR AND PL-SKU-NBR IN W/S AND ALL REFERENCES TO      *02010000
020200*    THEM.  REPLACED THE STRINGING OF DEPT/CLASS/SEQ WITH        *02020000
020300*    RD-SKU-NBR IN MOST OF THE J###-BUILD PARAGRAPHS. THIS       *02030000
020400*    IS THE FIELD THAT WILL POPULATE AP045-SKU-NBR.              *02040000
020500* MADE BY:  MIKE BESKE                          WR#: 23500       *02050000
020600*                                                                *02060000
020700*   DATE  09/17/2003                                             *02070000
020800*       CHANGE MADE: RECOMPILE FROM PRODUCTION TO PICK UP        *02080000
020900*       CHANGE TO COPYBOOK APRD045.                              *02090000
021000*       MADE BY: MIKE BESKE              WR/IR #: WR21316        *02100000
021100*                                                                *02110000
021200*   DATE  04/22/2004                                             *02120000
021300*       CHANGE MADE: INCREASED THE LEN OF ID-DEFAULT-STR-X       *02130000
021400*       FROM X(3) TO 9(4).  REMOVED THE REDEFINES RD-STR-X       *02140000
021500*       OF RD-STR-NBR.  CHANGED THE HARDCODED STORE NUMBER       *02150000
021600*       FROM ALPHA TO NUMERIC IN THE VARIOUS PARAGRAPHS THAT     *02160000
021700*       CREATE ADJUSTMENT RECORDS.  ALSO REPLACED RD-STR-X       *02170000
021800*       WITH RD-STR-NBR IN THOSE SAME PARAGRAPHS.  THIS IS       *02180000
021900*       PART OF THE STORE CONSTRAINTS PROJECT.                   *02190000
022000*       MADE BY: MIKE BESKE              WR/IR #: WR25805        *02200000
022100*                                                                *02210000
022200*   DATE  06/21/2004                                             *02220000
022300*       CHANGE MADE: NEW STORE DISCOUNT AUTOMATION PROJECT.      *02230000
022400*       CHANGED D100 TO HANDLE THE NEW AP058 FIELDS FOR HOLD     *02240000
022500*       INDICATOR AND PAYMENT DUE DATE, WHICH REPLACED TERMS     *02250000
022600*       SELECT AND ENTER DATE, WHICH WERE NO LONGER BEING USED.  *02260000
022700*       THE EARLIEST DUE DATE IS SAVED, AND THE NEW ID FIELDS ARE*02270000
022800*       USED WHEN CREATING THE NSD DEDUCTIONS.  ADDED            *02280000
022900*       S300-CHECK-FOR-EARNED-NSD AND J280-BUILD-AUTO-NSD-AJ,    *02290000
023000*       WHICH WILL DETERMINE IF A NSD IS TO BE CREATED AND THEN  *02300000
023100*       CREATES THEM WHEN NEEDED.  ADDED S200-GET-NEXT-DOC-NBR,  *02310000
023200*       BECAUSE THE NSD TRANSACTIONS WILL USE THE NEXT AVAILABLE *02320000
023300*       DOC NUMBER.  ALL TRANSACTIONS FOR THE SAME PO WILL GET   *02330000
023400*       THE SAME DOC NUMBER SO THAT THEY WILL GET RELATED        *02340000
023500*       TOGETHER AND LOADED TO THE ADJUSTMENT DATABASE AS ONE    *02350000
023600*       TRANSACTION WITH MULTIPLE DISTRIBS.  ADDED NEXT_BTCH_    *02360000
023700*       PRC_DTE TO THE SELECT FROM TAPCNTL - THIS IS THE DATE    *02370000
023800*       THAT WILL BE USED ON NSD TRANSACTIONS.  MADE SOME MISC.  *02380000
023900*       CHANGES TO IMPROVE FLOW AND READABILITY THROUGHOUT THE   *02390000
024000*       PROGRAM.                                                 *02400000
024100*       MADE BY: NANCY EILBES            WR/IR #: WR26679        *02410000
024200*   DATE  10/28/2004                                             *02420000
024300*       CHANGE MADE: INCREASED PO-LINES TABLE FROM 5000 TO       *02430000
024400*       9999.                                                    *02440000
024500*       MADE BY: L SCHALLHORN            WR/IR #: P000705927     *02450000
024600*   DATE  10/28/2004                                             *02460000
024700*       CHANGE MADE: DECREASED PO-LINES TABLE FROM 9999 TO       *02470000
024800*       7500.                                                    *02480000
024900*       MADE BY: L SCHALLHORN            WR/IR #: P000705927     *02490000
025000*                                                                *02500000
025100*   DATE  10/28/2004                                             *02510000
025200*      CHANGE MADE: CHANGED THE PIC OF WORK FIELD RD-TOTAL-COST  *02520000
025300*      TO HAVE 3 DIGITS AFTER THE DECIMAL POINT.  MODIFIED LOGIC *02530000
025400*      USING THIS FIELD TO REMOVE THE 'ROUNDED' CLAUSE. EACH     *02540000
025500*      STATEMENT WHERE RD-TOTAL-COST WAS BEING MOVED TO AN OUTPUT*02550000
025600*      RECORD OR OTHER WORK FIELD WAS MODIFIED TO COMPUTE THE    *02560000
025700*      TARGET FIELD = RD-TOTAL-COST + .005.                      *02570000
025800*      MADE BY: NANCY EILBES            WR/IR #: WR28327         *02580000
025900*                                                                *02590000
026000*   DATE  03/28/2005                                             *02600000
026100*      CHANGE MADE: OFF-INVOICE BROADCAST ALLOWANCES             *02610000
026200*      ADDED LOGIC TO THE PROGRAM SO THAT OFF-INVOICE BROADCAST  *02620000
026300*      ALLOWANCES ARE CREDITED TO THE BUYER (ML) INSTEAD OF TO A *02630000
026400*      GL ACCOUNT.  CREATED WORKING STORAGE FIELD                *02640000
026500*      PV-BROADCAST-AMT, ALTERED PARAGRAPH J900- TO BUILD THE    *02650000
026600*      BROADCAST ADJUSTMENT, AND EDITED PARAGRAPHS J200- TO CALL *02660000
026700*      J900- AND B200- TO ACCUMULATE THE BROADCAST AMOUNTS.      *02670000
026800*      MADE BY: KRYSTEN LEARY           WR/IR #: WR28472         *02680000
026900*                                                                *02690000
027000*   DATE  03/30/2005                                             *02700000
027100*      CHANGE MADE: E-COMM DIRECT TO CONSUMER PROJECT            *02710000
027200*      MODIFIED THE PROGRAM TO CREATE PURCHASE ADJUSTMENTS FOR   *02720000
027300*      THE CONSUMER DIRECT HANDLING CHARGES AND TO CREATE GL     *02730000
027400*      TRANSACTIONS FOR THE GIFT WRAP CHARGES.  CREATED WORKING  *02740000
027500*      STORAGE FIELDS TO ACCUMULATE COSTS, PARAGRAPH K300- TO    *02750000
027600*      BUILD THE HANDLING CHARGE ADJUSTMENT, AND PARAGRAPH J925- *02760000
027700*      TO BUILD THE GIFT WRAP EXPENSE ADJUSTMENT.  ALSO EDITED   *02770000
027800*      PARAGRAPHS B200- TO CALL J925-, D100- TO ACCUMULATE THE   *02780000
027900*      HANDLING AND GIFT WRAP CHARGES, AND J200- TO CALL K300-.  *02790000
028000*      MADE BY: KRYSTEN LEARY           WR/IR #: WR28461         *02800000
028100*                                                                *02810000
028200*   DATE  04/20/2005                                             *02820000
028300*      CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES     *02830000
028400*      MODIFIED THE PROGRAM TO PRODUCE A NEW GL ENTRY FOR CO-OP  *02840000
028500*      ADVERTISING TAKEN OFF INVOICE.  CREATED WORKING STORAGE   *02850000
028600*      FIELD TO ACCUMULATE THE COST AND CREATED PARAGRAPH J850-  *02860000
028700*      TO BUILD CO-OP ADVERTISING ADJUSTMENTS. EDITED PARAGRAPHS *02870000
028800*      B200- TO CALL J850-, C100- TO SUBTRACT THE REMAINDER      *02880000
028900*      CO-OP AMOUNT FROM THE TOTAL CO-OP ADVERTISING AMOUNT, AND *02890000
029000*      D100- TO ACCUMULATE CO-OP ADVERTISING COSTS.              *02900000
029100*      MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         *02910000
029200*                                                                *02920000
029300*   DATE  05/10/2005                                             *02930000
029400*      CHANGE MADE:                                              *02940000
029500*      ADDED A PERFORM PARA J900- TO PARA J300-.                 *02950000
029600*      THIS CORRECTS THE PROBLEM WHERE TRANCODE '5A' WAS NOT     *02960000
029700*      BEING CREATED FOR POS THAT ONLY HAD NON-INVOICED RECEIPTS.*02970000
029800*      MADE BY: MIKE BESKE              WR/IR #: P000761521      *02980000
029900*   DATE  10/28/2005                                             *02990000
030000*      CHANGE MADE:                                              *03000000
030100*      GOING BACK TO VERSION CHECKING FOR -811 IN S300.          *03010000
030200*      MADE BY: NANCY EILBES            WR/IR #: P000??????      *03020000
030300*                                                                *03030000
030400*   DATE  03/13/2006                                             *03040000
030500*      CHANGE MADE:                                              *03050000
030600*      MODIFYING PRICE CLAIM CURSOR AND PROCESSING FOR NEW       *03060000
030700*      OFF-INVOICE ALLOWANCES.  ADDED FIELDS IN WORKING STORAGE  *03070000
030800*      FOR ACCUMULATION OF NEW ALLOWANCES.                       *03080000
030900*      MADE BY: GREG WISIALOWSKI        WR/IR #: WR30028         *03090000
031000*                                                                *03100000
031100*   DATE  05/30/2006                                             *03110000
031200*      CHANGE MADE:                                              *03120000
031300*      MODIFIED LOGIC IN D100 SO THAT PAYMENT DUE DATE AND HOLD  *03130000
031400*      FLAG WILL ONLY BE HANDLED FOR APRD058 RECORDS THAT ARE    *03140000
031500*      TYPE 'INVOICE'.  THE PAYMENT DUE DATE WAS BEING OVERLAID  *03150000
031600*      WITH LOW-VALUES WHEN A PRICE CLAIM OR SHORTAGE RECORD     *03160000
031700*      WAS BEING PROCESSED AND THIS CAUSED AN ISSUE ON THE '0B'  *03170000
031800*      TRANSACTIONS WHEN THEY WERE INTERFACED TO PEOPLESOFT.     *03180000
031900*      MADE BY: NANCY EILBES            WR/IR #: P00884627       *03190000
032000*                                                                *03200000
032100*   DATE  03/11/2007                                             *03210000
032200*      CHANGE MADE: MATCH BY DC PROJECT.                         *03220000
032300*                                                                *03230000
032400*      CREATED NEW INVOICED-BY-DC SWITCH.                        *03240000
032500*                                                                *03250000
032600*      MODIFIED B200- TO CHECK POSTRR-MTCH-LVL-CDE TO SET THE    *03260000
032700*      PROPER INVOICED-BY ('P' = BULK, 'S' = BY STORE AND 'D' =  *03270000
032800*      BY DC).                                                   *03280000
032900*                                                                *03290000
033000*      MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR21578         *03300000
033100*                                                                *03310000
033200*   DATE  03/11/2007                                             *03320000
033300*      CHANGE MADE: MATCH BY DC PROJECT.                         *03330000
033400*      CREATED NEW PARAGRAPH J955 TO CREATE DOC NUMBER FOR NIR.  *03340000
033500*      MODIFIED J300 AND J700 TO PERFORM THIS NEW PARAGRAPH      *03350000
033600*      INSTEAD OF MOVING THE NIR SEQUENCE NUMBER TO THE DOC      *03360000
033700*      NUMBER.                                                   *03370000
033800*      MADE BY: NANCY EILBES            WR/IR #: WR21578         *03380000
033900*                                                                *03390000
034000*   DATE  03/27/2007                                             *03400000
034100*      CHANGE MADE: ADDED SIGNS TO ALL ID-TOTAL AMOUNT FIELDS    *03410000
034200*      THAT DID NOT HAVE THEM.  A PROBLEM OCCURRED ON A PO       *03420000
034300*      WHERE A SHORTAGE WAS CREATED THAT WAS MANY TIMES LARGER   *03430000
034400*      THAN THE INPUT INVOICES AND THE DISCOUNT WITH THEM SHOULD *03440000
034500*      HAVE BEEN NEGATIVE, BUT THE SIGN WAS LOST.                *03450000
034600*      MADE BY: NANCY EILBES            WR/IR #: P00999409       *03460000
034700*                                                                *03470059
034800* DATE  05/17/2007                                               *03480059
034900*     CHANGE MADE: INSTALL AN AUTOMATED DO NOT PAY TRANS CODE    *03490059
035000*     15 TO TRAN CODE 6C AND A NEW REVERSAL TRAN CODE, 6K, FOR   *03500059
035100*     CUSTOMER DIRECT GIFTWRAP CHARGES, (CDG).                   *03510059
035200*     MADE BY: ROLF NOHE               WR/IR #: WR31075          *03520059
035300*                                                                *03530059
035400* DATE  09/21/2007                                               *03540059
035500*     CHANGE MADE: REMOVED TRAN CODE '02' IN PARAGRAPH           *03550059
035600*     J200-BUILD-RCVR-AJ SINCE IT IS NOW OBSOLETE.               *03560059
035700*     MADE BY: ROLF NOHE               WR/IR #: INC000000075017  *03570059
035800*                                                                *03580059
035900* DATE  12/14/2007                                               *03590059
036000*     CHANGE MADE: GENERATE PRIVATE LOAD ADJUSTMENTS WHEN        *03600059
036100*     QUALIFYING PO IS BEING JOURNALIZED,                        *03610059
036200*     MADE BY: CHRISTINE TWIEHAUS      WR/IR #: WR32664          *03620059
036300*                                                                *03630059
036400* DATE  04/10/2008                                               *03640059
036500*     CHANGE MADE: CORRECTED STRING STATEMENT IN J952-CREATE-    *03650059
036600*     PLA-DOC-NBR SO THAT SPACES WOULD NO LONGER BE EMBEDDED     *03660059
036700*     IN THE DOC NUMBER.                                         *03670059
036800*     MADE BY: NANCY EILBES            WR/IR #: WR34276          *03680059
036900*                                                                *03690059
037000* DATE  05/08/2008                                               *03700059
037100*     CHANGE MADE: PRIVATE LABEL GIVEBACK PROJECT.               *03710059
037200*     DURING POST-GIVEBACK VALIDATION, IT WAS DETERMINED THAT    *03720059
037300*     TOO MUCH LOAD WAS BEING COLLECTED FOR DOMESTIC PRIVATE     *03730059
037400*     LABEL POS THAT HAD MIXED BRAND ITEMS.  MODIFIED APRD105    *03740059
037500*     AND PROGRAM APKUT105 TO ADD AND POPULATE A NEW COST FIELD  *03750059
037600*     WHICH WILL CONTAIN THE TOTAL 'LOADED' COST.                *03760059
037700*     MODIFIED CALCULATION OF LOAD AMOUNT IN J290 TO SUBTRACT    *03770059
037800*     THE TOTAL RECEIPT COST FROM THE TOTAL LOADED RECEIPT COST. *03780059
037900*     THIS CHANGE ENSURES THAT LOAD WILL NOT BE GENERATED FOR    *03790059
038000*     NON-PRIVATE LABEL ITEMS ON PRIVATE LABEL POS.              *03800059
038100*     REMOVED TABLES TDTATTR AND XMT00022.  REMOVED PARAGRAPHS   *03810059
038200*     S400 & S500 TO SELECT FROM THESE TABLES; NO LONGER NEEDED  *03820059
038300*     TO CALCULATE THE PRIVATE LABEL LOAD.                       *03830059
038400*     MADE BY: NANCY EILBES            WR/IR #: WR34309          *03840059
038500*                                                                *03850059
038600* DATE  06/10/2008                                               *03860059
038700*     CHANGE MADE: THE CREATION OF A HANDLING CHARGE WAS NOT     *03870059
038800*     BEING PERFORMED WHEN A NON-INVOICED RECEIPT ADJUSTMENT     *03880059
038900*     WAS BEING PROCESSED.  THE EXECUTION OF K300- WAS ADDED     *03890059
039000*     TO THE J300- PARAGRAPH TO CORRECT THIS ISSUE.              *03900059
039100*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: INC000000392706  *03910059
039200*                                                                *03920059
039300* DATE  08/31/2010                                               *03930059
039400*     CHANGE MADE: BREAKDOWN AP TRAN CODES TO LOCATION LEVEL.    *03940059
039500*     ADDED LOGIC TO WRITE COSTS TO APRD058 FORMAT FILE          *03950059
039600*     WHICH WILL BE USED TO GENERATE TRAN CODES 37, 40, AND      *03960059
039700*     4A.  THE ACTUAL GENERATION OF TRAN CODES IS THEN DONE      *03970059
039800*     IN APKUP254.                                               *03980059
039900*     A NEW SEGMENT WAS ADDED TO APRD058 FOR THE ACTUAL LANDED   *03990059
040000*     COST, THE PRIVATE LABEL LOAD, AND THE FIRST COST LOAD      *04000059
040100*     AMOUNTS.  AMOUNTS IN THESE FIELDS ARE USED TO GENERATE THE *04010059
040200*     APPROPRIAT TRANS CODE AND IS ALSO DISTRIBUTED DOWN TO      *04020059
040300*     LOCATION/SKU LEVEL.  CHANGES WERE MADE IN THE FOLLOWING    *04030059
040400*     PARAGRAPHS - D100-, D500-, K960-, K970-, K980-, AND        *04040059
040500*     L200-.                                                     *04050059
040600*     MADE BY: ROLF NOHE               WR/IR #: WR38002          *04060059
040700*                                                                *04070059
040800* DATE  09/23/2010                                               *04080059
040900*     CHANGE MADE: ADDED CODE FOR EVERY NTH RECORD               *04090059
041000*     (IE: INITIAL SETTING 25) TO PERFORM A COMMIT TO REDUCE     *04100059
041100*     THE LOG WRITE I/O TIMES BY REDUCING THE COMMIT FREQUENCY   *04110059
041200*     TO HELP THIS PROGRAM RUN FASTER PER DBA SUGGESTION. THE    *04120059
041300*     W/S FIELD PC-HOW-OFTEN-TO-COMMIT HAS THE VALUE SET TO 25.  *04130059
041400*     THIS FIELD CAN BE UPDATED IN THE FUTURE TO CONTROL HOW     *04140059
041500*     MANY POS PROCESSED BEFORE PERFORMING A COMMIT.             *04150059
041600*     MODIFIED PARAS B200-, B300-, Z100-.                        *04160059
041700*     NEW PARAS D800-.                                           *04170059
041800*     MADE BY: MIKE BESKE              WR/IR #: PKE000000005178  *04180059
041900*                                                                *04190059
042000* DATE  10/04/2010                                               *04200059
042100*     CHANGE MADE:  WHEN DEPARTMENT IS 836 OR 830                *04210059
042200*     DO NOT PERFORM  K970-BUILD-PRVT-LBL-LOAD-AD                *04220059
042300*     DO NOT PERFORM  K980-BUILD-FIRST-COST-LOAD-ADJ             *04230059
042400*     DO NOT APPLY-PRVT-LBL-LOAD TO TRUE                         *04240059
042500*     MADE BY: TOM MARTIN              WR/IR #: WR38253          *04250059
042510*                                                                *04251059
042520* DATE  12/08/2011                                               *04252059
042530*     CHANGE MADE:  EXPANDED PL-PO-LINE INTERNAL TABLE FROM 7500 *04253059
042540*     ENTRIES TO 81,000 ENTRIES TO ACCOMMODATE PO 7265352.       *04254059
042570*     MADE BY: NANCY EILBES            WR/IR #: CRQ000000016613  *04257059
042571*                                                                *04257159
042580* DATE  11/04/2014                                               *04258059
042590*     CHANGE MADE: PO EXTENDED DIGIT CHANGES.                    *04259059
042591*     EXTENDED PO# FROM 7 TO 9.                                  *04259159
042592*     MADE BY: COGNIZANT               WR/IR #: CHG0094517       *04259259
042593*                                                                *04259359
042594* DATE  09/25/2020                                               *04259459
042595*     CHANGE MADE: DIRECT SHIP COST TO SHIP PROJECT. A NEW ID    *04259559
042596*     TOTAL WORK FIELD WAS ADDED TO ALLOW ACCUMULATION OF        *04259659
042597*     FREIGHT CHARGES SPECIFIC TO CD TYPE POS. LOGIC WAS ADDED   *04259759
042598*     IN D100-PROCESS-EACH-INVOICE TO ADD THE FREIGHT AMOUNT     *04259859
042599*     INTO THIS NEW WORK FIELD WHEN THE PO TYPE IS CD AND TO     *04259959
042600*     ZERO THE CURRENT ID-TOTAL-FREIGHT-CHARGES FIELD.  A NEW    *04260059
042601*     PARGRAPH, K940-BUILD-DIRECT-SHIP-EXP-ADJ WAS ADDED TO      *04260159
042602*     BUILD A NEW TRANSACTION USING AP TRANCODE QR, WHICH WILL   *04260259
042603*     ENSURE THE FREIGHT COST IS POSTED TO GL EXPENSE INSTEAD    *04260359
042604*     OF ML.  THIS NEW PARAGRAPH IS PERFORMED FROM B200.         *04260459
042605*     MADE BY: NANCY EILBES            WR/IR #: CHG0249255       *04260559
042606*                                                                *04260659
042607* DATE  05/11/2021                                               *04260759
042608*     CHANGE MADE: ADD LOGIC FOR SEPHORA                         *04260859
042610*     MADE BY: JEAN KURK               WR/IR #: CHG0256545       *04261059
042611*                                                                *04261159
042613* DATE  10/29/2021                                               *04261359
042614*     CHANGE MADE: ADD LOGIC IN R200-GET-DEPT TO SET THE         *04261459
042615*     APPLY-PRVT-LBL-LOAD FOR EXCLUSIVE BRAND POS ALONG WITH     *04261559
042616*     PRIVATE BRAND POS.  THIS WILL ALLOW THE LOAD TRANSACTIONS  *04261659
042617*     TO BE GENERATED FOR EXCLUSIVE BRANDS.                      *04261759
042618*     MADE BY: NANCY EILBES            WR/IR #: CHG0263376       *04261859
042619*                                                                *04261959
042620* DATE  04/18/2022                                               *04262073
042621*     CHANGE MADE: CHANGE COMMIT COUNT FROM 25 TO 5 TO REDUCE    *04262160
042622*     THE AMOUNT OF ROWS THAT ARE BEING HELD BY THE PROGRAM      *04262260
042625*     MADE BY: JEAN KURK               WR/IR #: CHG0268937       *04262560
042626*                                                                *04262660
042627* DATE  06/01/2022                                               *04262764
042628*     CHANGE MADE: CHANGE COMMIT COUNT FROM 2 TO 1 TO REDUCE     *04262864
042629*     THE AMOUNT OF ROWS THAT ARE BEING HELD BY THE PROGRAM      *04262962
042630*     MADE BY: JEAN KURK               WR/IR #: CHG0270407       *04263064
042631*                                                                *04263162
042637* DATE  01/18/2023                                               *04263765
042638*     CHANGE MADE: ADD DESCRIPTION OF 'NEW STORE DISCOUNT' TO    *04263865
042639*     THE '0B' TRANS                                             *04263965
042640*     MADE BY: JEAN KURK               WR/IR #: CHG0279333       *04264065
042641*                                                                *04264165
042642*   DATE  02/21/2023                                             *04264272
042643*       CHANGE MADE: CHANGE CALL TO DPKUP151 FROM STATIC TO      *04264372
042644*                    DYNAMIC                                     *04264472
042645*       MADE BY: JEAN KURK               WR/IR #: CHG0282641     *04264572
042646*                                                                *04264676
042647*   DATE  03/07/2024                                             *04264776
042648*       CHANGE MADE: PEPSI INVOICING - MODIFIED LOGIC TO PROCESS *04264876
042649*       BOTTLE DEPOSITS IN THE ID TOTALS AND ADDED PARAGRAPH     *04264976
042650*       K945-BUILD-BOTTLE-DEPOSIT-ADJ TO GENERATE A NEW AP       *04265076
042651*       TRANCODE, AD, FOR THESE COSTS. INCREASED RECORD LENGTH   *04265176
042652*       FOR THE APRD058 RECORD.                                  *04265276
042653*       MADE BY: NANCY EILBES            WR/IR #: CHG0301938     *04265377
042660******************************************************************04266076
042700                                                                  04270000
042800 ENVIRONMENT DIVISION.                                            04280000
042900 CONFIGURATION SECTION.                                           04290000
043000 SOURCE-COMPUTER.    IBM-3090.                                    04300000
043100 OBJECT-COMPUTER.    IBM-3090.                                    04310000
043200                                                                  04320000
043300 INPUT-OUTPUT SECTION.                                            04330000
043400 FILE-CONTROL.                                                    04340000
043500     SELECT POSTORE-INVOICE-FILE ASSIGN TO UT-S-INP01.            04350000
043600     SELECT PO-LINES-FILE        ASSIGN TO UT-S-INP02.            04360000
043700     SELECT RECEIPTS-SUM-FILE    ASSIGN TO UT-S-INP03.            04370000
043800     SELECT RECEIPTS-FILE        ASSIGN TO UT-S-INP04.            04380000
043900                                                                  04390000
044000 DATA DIVISION.                                                   04400000
044100 FILE SECTION.                                                    04410000
044200                                                                  04420000
044300 FD  POSTORE-INVOICE-FILE                                         04430000
044400     RECORDING MODE IS F                                          04440000
044500     LABEL RECORDS ARE STANDARD                                   04450000
044600     BLOCK CONTAINS 0 RECORDS                                     04460000
044700     DATA RECORD IS POSTORE-INVOICE-REC.                          04470000
044800 01  POSTORE-INVOICE-REC         PIC X(125).                      04480074
044900                                                                  04490000
045000 FD  PO-LINES-FILE                                                04500000
045100     RECORDING MODE IS F                                          04510000
045200     BLOCK CONTAINS 0 CHARACTERS                                  04520000
045300     LABEL RECORDS ARE STANDARD                                   04530000
045400     DATA RECORD IS PO-LINES-RECORD.                              04540000
045500 01  PO-LINES-RECORD             PIC X(60).                       04550000
045600                                                                  04560000
045700 FD  RECEIPTS-SUM-FILE                                            04570000
045800     RECORDING MODE IS F                                          04580000
045900     BLOCK CONTAINS 0 CHARACTERS                                  04590000
046000     LABEL RECORDS ARE STANDARD                                   04600000
046100     DATA RECORD IS RECEIPTS-SUM-RECORD.                          04610000
046200 01  RECEIPTS-SUM-RECORD         PIC X(20).                       04620000
046300                                                                  04630000
046400 FD  RECEIPTS-FILE                                                04640000
046500     RECORDING MODE IS F                                          04650000
046600     BLOCK CONTAINS 0 CHARACTERS                                  04660000
046700     LABEL RECORDS ARE STANDARD                                   04670000
046800     DATA RECORD IS RECEIPTS-RECORD.                              04680000
046900 01  RECEIPTS-RECORD             PIC X(200).                      04690000
047000                                                                  04700000
047100 EJECT                                                            04710000
047200 WORKING-STORAGE SECTION.                                         04720000
047300                                                                  04730000
047400 01  PV-PROGRAM-VARIABLES.                                        04740000
047500     05  FILLER                        PIC X(30) VALUE            04750000
047600         '** BEGINING OF APKUP254 W/S **'.                        04760000
047700     05  PV-PROGRAM-NAME               PIC X(8)  VALUE 'APKUP254'.04770000
047800                                                                  04780000
047900     05  PV-DATE-TIME-FIELDS.                                     04790000
048000         10  PV-CURR-DB2-DATE.                                    04800000
048100             15  PV-CURR-DB2-CENT       PIC 9(2)  VALUE 19.       04810000
048200             15  PV-CURR-DB2-YEAR       PIC 9(2)  VALUE ZERO.     04820000
048300             15  FILLER                 PIC X     VALUE '-'.      04830000
048400             15  PV-CURR-DB2-MONTH      PIC 9(2)  VALUE ZERO.     04840000
048500             15  FILLER                 PIC X     VALUE '-'.      04850000
048600             15  PV-CURR-DB2-DAY        PIC 9(2)  VALUE ZERO.     04860000
048700         10  PV-CURR-DB2-DATE-X REDEFINES PV-CURR-DB2-DATE        04870000
048800                                        PIC X(10).                04880000
048900     05  PV-OTB-BEGIN-DTE-FIELDS.                                 04890000
049000         10  PV-OTB-BEG-DT.                                       04900000
049100             15  PV-OTB-BEG-DT-YYYY  PIC  X(04).                  04910000
049200             15  PV-OTB-BEG-DT-MM    PIC  X(02).                  04920000
049300         10  PV-OTB-BEG-DT-N REDEFINES PV-OTB-BEG-DT.             04930000
049400             15  PV-OTB-BEG-DT-9999  PIC  9(04).                  04940000
049500             15  PV-OTB-BEG-DT-99    PIC  9(02).                  04950000
049600                                                                  04960000
049700         10  PV-RECDIS-AP-PRC-DTE       PIC X(10) VALUE SPACES.   04970000
049800         10  PV-PAYT-RLSE-DATE.                                   04980000
049900             15  PV-PAYT-RLSE-CENT      PIC 9(2)  VALUE ZERO.     04990000
050000             15  PV-PAYT-RLSE-YEAR      PIC 9(2)  VALUE ZERO.     05000000
050100             15  FILLER                 PIC X     VALUE SPACE.    05010000
050200             15  PV-PAYT-RLSE-MONTH     PIC 9(2)  VALUE ZERO.     05020000
050300             15  FILLER                 PIC X     VALUE SPACE.    05030000
050400             15  PV-PAYT-RLSE-DAY       PIC 9(2)  VALUE ZERO.     05040000
050500         10  PV-INVEN-CUTOFF-DTE        PIC 9(5).                 05050000
050600         10  PV-INVEN-CUTOFF-DTE-X REDEFINES PV-INVEN-CUTOFF-DTE  05060000
050700                                        PIC X(5).                 05070000
050800         10  PV-CONVERT-DATE.                                     05080000
050900             15  PV-CONVERT-MONTH       PIC X(2) VALUE ZERO.      05090000
051000             15  PV-CONVERT-DAY         PIC X(2) VALUE ZERO.      05100000
051100             15  PV-CONVERT-YEAR        PIC X(2) VALUE ZERO.      05110000
051200         10  PV-BTCH-NBR                PIC X(15).                05120000
051300         10  PV-BTCH-NBR-RED REDEFINES PV-BTCH-NBR.               05130000
051400             15  PV-BTCH-NBR-DTE        PIC X(10).                05140000
051500             15  PV-BTCH-NBR-SRC-CDE    PIC X(3).                 05150000
051600             15  PV-BTCH-NBR-SEQ-NBR    PIC X(2).                 05160000
051700                                                                  05170000
051800     05  PV-PO-STR-CLS-FIELDS.                                    05180000
051900         10  PV-PO-IN-PROCESS           PIC S9(9) VALUE ZERO COMP.05190000
052000         10  HOLD-NSD-PO                PIC S9(9) VALUE ZERO COMP.05200000
052100         10  HOLD-PRVT-LBL-PO           PIC S9(9) VALUE ZERO COMP.05210000
052200         10  PV-PO-IN-PROCESS-9         PIC 9(9)  VALUE ZERO.     05220000
052300         10  PV-PO-9-X REDEFINES PV-PO-IN-PROCESS-9               05230000
052400                                        PIC X(9).                 05240000
052500         10  PV-PO-IN-PROCESS-X REDEFINES PV-PO-IN-PROCESS-9.     05250000
052700             15  PV-PO-X                PIC X(09).                05270028
052800         10  PV-PO-NBR-X                PIC X(9)  VALUE SPACES.   05280000
052900         10  PV-START                   PIC S9(4) VALUE ZERO COMP.05290000
053000         10  PV-STORE-IN-PROCESS        PIC S9(4) VALUE ZERO COMP.05300000
053100         10  PV-STORE-IN-PROCESS-9      PIC 9(4) VALUE ZERO.      05310000
053200         10  PV-STR-9-X REDEFINES PV-STORE-IN-PROCESS-9           05320000
053300                                        PIC X(4).                 05330000
053400         10  PV-STR-NBR-X               PIC X(4)  VALUE SPACES.   05340000
053500         10  PV-SAVED-STORE             PIC S9(4) VALUE ZERO COMP.05350000
053600         10  PV-MTCH-LVL-CDE-IN-PROCESS                           05360000
053700                                        PIC X(01) VALUE SPACE.    05370000
053800         10  PV-PO-LINE-NO              PIC 9(9).                 05380000
053900         10  PV-PO-LINE-NO-X REDEFINES PV-PO-LINE-NO.             05390000
054000             15  FILLER                 PIC X(5).                 05400000
054100             15  PV-PO-LINE-X           PIC X(4).                 05410000
054200         10  PV-CLASSNO                 PIC X(3).                 05420000
054300 EJECT                                                            05430000
054400     05  PV-HOST-FIELDS.                                          05440000
054500         10  PV-RECEIPT-TYPE            PIC X(2) VALUE SPACES.    05450000
054600             88 PV-RECEIVER                    VALUE 'RV'.        05460000
054700             88 PV-NON-INVC-RECEIPT            VALUE 'NR'.        05470000
054800         10  PV-PRCCLM-DIFFERENCE       PIC S9(7)V999 VALUE ZERO  05480000
054900                                                 COMP-3.          05490000
055000         10  PV-PRCCLM-TOTAL            PIC S9(9)V999 VALUE ZERO  05500000
055100                                                 COMP-3.          05510000
055200         10  PV-NULL-IND                PIC S9(4) VALUE ZERO COMP.05520000
055300         10  PV-REC-SEQ-NBR             PIC S9(9) VALUE ZERO COMP.05530000
055400         10  PV-PO-LNE-NBR              PIC S9(9) VALUE ZERO COMP.05540000
055500         10  PV-OPER-UNT-ID             PIC S9(4) VALUE ZERO COMP.05550000
055600         10  PV-FCLTY-ID                PIC S9(4) VALUE ZERO COMP.05560000
055700         10  PV-STR-FCLTY-ID            PIC S9(4) VALUE ZERO COMP.05570000
055800         10  PV-RECDIS-TMST             PIC X(26) VALUE SPACES.   05580000
055900         10  PV-VER-NBR                 PIC S9(9) VALUE ZERO COMP.05590000
056000         10  PV-WORK-DISCOUNT-PCT       PIC S9(3)V99 VALUE ZERO   05600000
056100                                                 COMP-3.          05610000
056400         10  PV-AP-TRN-CDE              PIC X(2) VALUE SPACES.    05640000
056500         10  PV-TRN-TYP-CDE             PIC X(3) VALUE SPACES.    05650000
056600             88 PV-MERCHANDISE                   VALUE 'MDS'.     05660000
056700         10  PV-PSTG-TYP-CDE            PIC X(2) VALUE SPACES.    05670000
056800             88 PV-CREDIT                        VALUE 'CR'.      05680000
056900         10  PV-STR-NBR                 PIC 9(5) VALUE ZERO.      05690000
057000         10  PV-DOC-SUFFIX              PIC  X(03) VALUE SPACES.  05700000
057100                                                                  05710000
057200     05  PV-AMT-FIELDS.                                           05720000
057300         10  PV-DECIMAL-8        PIC S9(9)V9(8) COMP-3 VALUE ZERO.05730000
057400         10  PV-TOTAL-COST       PIC S9(9)V999  COMP-3 VALUE ZERO.05740000
057410         10  PV-CALC-COST        PIC S9(9)V999  COMP-3 VALUE ZERO.05741050
057500         10  PV-TOTAL-NR-COST    PIC S9(9)V999  COMP-3 VALUE ZERO.05750000
057600         10  PV-TOTAL-RETAIL     PIC S9(7)V99   COMP-3 VALUE ZERO.05760000
057700         10  PV-TOTAL-VARIANCE   PIC S9(9)V99   COMP-3 VALUE ZERO.05770000
057800         10  PV-TOT-FRT-ADJ-AMT  PIC S9(7)V99   COMP-3 VALUE ZERO.05780000
057900         10  PV-VEND-FRT-ADJ-AMT PIC S9(7)V99   COMP-3 VALUE ZERO.05790000
058000         10  PV-MISC-ADJ-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05800000
058100         10  PV-TOLR-ADJ-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05810000
058200         10  PV-DNP-ADJ-AMT      PIC S9(7)V99   COMP-3 VALUE ZERO.05820000
058300         10  PV-HANDLING-ADJ-AMT PIC S9(7)V99   COMP-3 VALUE ZERO.05830000
058400         10  PV-TOTAL-DISC-AMT   PIC S9(7)V99   COMP-3 VALUE ZERO.05840000
058500         10  PV-DISTR-DISC-AMT   PIC S9(7)V99   COMP-3 VALUE ZERO.05850000
058600         10  PV-NEW-DISC-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05860000
058700         10  PV-ORIG-DISC-AMT    PIC S9(7)V99   COMP-3 VALUE ZERO.05870000
058800         10  PV-GRO-COST-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05880000
058900         10  PV-BROADCAST-AMT    PIC S9(7)V99   COMP-3 VALUE ZERO.05890000
059000         10  PV-NEW-STR-AMT      PIC S9(7)V99   COMP-3 VALUE ZERO.05900000
059100         10  PV-MOS-DISC-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05910000
059200         10  PV-TRD-DISC-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05920000
059300         10  PV-ALW-DISC-AMT     PIC S9(7)V99   COMP-3 VALUE ZERO.05930000
059400         10  PV-MISC-DISC-AMT    PIC S9(7)V99   COMP-3 VALUE ZERO.05940000
059500         10  PV-ACTL-LANDED-COST-AMT                              05950000
059600                                 PIC S9(7)V99   COMP-3 VALUE ZERO.05960000
059700         10  PV-PRIVATE-LBL-LOAD-AMT                              05970000
059800                                 PIC S9(7)V99   COMP-3 VALUE ZERO.05980000
059900         10  PV-FIRST-COST-LOAD-AMT                               05990000
060000                                 PIC S9(7)V99   COMP-3 VALUE ZERO.06000000
060100                                                                  06010000
060200     05  PV-COUNTERS.                                             06020000
060300         10  PV-COUNTER                 PIC 9(2) VALUE ZERO.      06030000
060400         10  PV-SEQ-MI-COUNT            PIC 9(3) VALUE ZERO.      06040000
060500         10  PV-SEQ-DM-COUNT            PIC 9(3) VALUE ZERO.      06050000
060600         10  PV-SEQ-CM-COUNT            PIC 9(3) VALUE ZERO.      06060000
060700         10  PV-PO-COUNT                PIC 9(9) VALUE ZERO.      06070001
060800         10  PV-COMMIT-COUNT            PIC 9(9) VALUE ZERO.      06080001
060900         10  PV-NTH-MULTIPLE            PIC 9(9) VALUE ZERO.      06090001
061000         10  PV-NTH-REMAINDER           PIC 9(9) VALUE ZERO.      06100001
061100         10  PV-ERROR-COUNT             PIC 9(5) VALUE ZERO.      06110000
061200         10  PV-ZERO-AMTS-AP045-COUNT   PIC 9(9) VALUE ZERO.      06120000
061300                                                                  06130000
061400 01  PC-PROGRAM-CONSTANTS.                                        06140000
061500     05  PC-RETRY-MAX            PIC S9(4)   VALUE +3             06150000
061600                                             COMP SYNC.           06160000
061700     05  PC-RETRY-COUNT          PIC S9(4)   VALUE ZERO.          06170000
061800     05  PC-MAX-LINES            PIC S9(3)   VALUE +60            06180000
061900                                             COMP-3.              06190000
062000     05  PC-AP045-LEN            PIC S9(4)   VALUE 500    COMP.   06200000
062100     05  PC-AUTO-MODE            PIC X       VALUE 'A'.           06210000
062200     05  PC-ONLINE-MODE          PIC X       VALUE 'O'.           06220000
062300     05  PC-DEFAULT-STORE        PIC 9(9)    VALUE 900.           06230000
062400     05  PC-DEFAULT-EXPNO        PIC X(7)    VALUE '0004109'.     06240000
062500     05  PC-WRITEOFF-EXPNO       PIC X(7)    VALUE '0001290'.     06250000
062600     05  PC-CREDIT-MEMO          PIC X(2)    VALUE 'CM'.          06260000
062700     05  PC-DEBIT-MEMO           PIC X(2)    VALUE 'DM'.          06270000
062800     05  PC-CREDIT-AJ            PIC X(2)    VALUE 'CP'.          06280000
062900     05  PC-DEBIT-AJ             PIC X(2)    VALUE 'DP'.          06290000
063000     05  PC-WRITE-OFF            PIC X       VALUE 'W'.           06300000
063100     05  PC-JOURNALIZED          PIC X       VALUE 'J'.           06310000
063200     05  PC-DS-TYP-CDE           PIC X(2)    VALUE 'DS'.          06320000
063300*    05  PC-HOW-OFTEN-TO-COMMIT  PIC 9(9)    VALUE 25.            06330060
063310*    05  PC-HOW-OFTEN-TO-COMMIT  PIC 9(9)    VALUE 5.             06331062
063320*    05  PC-HOW-OFTEN-TO-COMMIT  PIC 9(9)    VALUE 2.             06332064
063330     05  PC-HOW-OFTEN-TO-COMMIT  PIC 9(9)    VALUE 1.             06333064
063340     05  PC-0B-DESCR-TXT         PIC X(50)   VALUE                06334065
063350                                  'NEW STORE DISCOUNT'.           06335065
063400 EJECT                                                            06340000
063500 01  PS-PROGRAM-SWITCHES.                                         06350000
063600     05  PS-OUT-OF-POS-SW        PIC X       VALUE 'M'.           06360000
063700         88  OUT-OF-POS                      VALUE 'O'.           06370000
063800         88  MORE-POS                        VALUE 'M'.           06380000
063900     05  PS-OUT-OF-INVOICES-SW   PIC X       VALUE 'M'.           06390000
064000         88  OUT-OF-INVOICES                 VALUE 'O'.           06400000
064100         88  MORE-INVOICES                   VALUE 'M'.           06410000
064200     05  PS-OUT-OF-ALCHRG-SW     PIC X       VALUE 'M'.           06420000
064300         88  OUT-OF-ALCHRG                   VALUE 'O'.           06430000
064400         88  MORE-ALCHRG                     VALUE 'M'.           06440000
064500     05  PS-OUT-OF-RECEIPTS-SW   PIC X       VALUE 'M'.           06450000
064600         88  OUT-OF-RECEIPTS                 VALUE 'O'.           06460000
064700         88  MORE-RECEIPTS                   VALUE 'M'.           06470000
064800     05  PS-RECEIPTS-EOF-SW      PIC X       VALUE ' '.           06480000
064900         88  RECEIPTS-EOF                    VALUE 'Y'.           06490000
065000         88  RECEIPTS-NOT-EOF                VALUE ' '.           06500000
065100     05  PS-OUT-OF-RECEIPTS-SUM-SW                                06510000
065200                                 PIC X       VALUE 'M'.           06520000
065300         88  OUT-OF-RECEIPTS-SUM             VALUE 'O'.           06530000
065400         88  MORE-RECEIPTS-SUM               VALUE 'M'.           06540000
065500     05  PS-OUT-OF-PRCCLMS-SW    PIC X       VALUE 'M'.           06550000
065600         88  OUT-OF-PRCCLMS                  VALUE 'O'.           06560000
065700         88  MORE-PRCCLMS                    VALUE 'M'.           06570000
065800     05  PS-OUT-OF-PO-LINES-SW   PIC X       VALUE 'M'.           06580000
065900         88  OUT-OF-PO-LINES                 VALUE 'O'.           06590000
066000         88  MORE-PO-LINES                   VALUE 'M'.           06600000
066100     05  PS-PO-LINES-EOF-SW      PIC X       VALUE ' '.           06610000
066200         88  PO-LINES-EOF                    VALUE 'Y'.           06620000
066300         88  PO-LINES-NOT-EOF                VALUE ' '.           06630000
066400     05  PS-PROCESS-PO-LINES-SW  PIC X       VALUE 'P'.           06640000
066500         88  STOP-PROCESSING-PO-LINES        VALUE 'S'.           06650000
066600         88  PROCESS-PO-LINES                VALUE 'P'.           06660000
066700     05  PS-OUT-OF-TODAYS-NR-SW  PIC X       VALUE 'M'.           06670000
066800         88  OUT-OF-TODAYS-NR                VALUE 'O'.           06680000
066900         88  MORE-TODAYS-NR                  VALUE 'M'.           06690000
067000     05  PS-OUT-OF-TODAYS-RI-SW  PIC X       VALUE 'F'.           06700000
067100         88  OUT-OF-TODAYS-RI                VALUE 'O'.           06710000
067200         88  FOUND-TODAYS-RI                 VALUE 'F'.           06720000
067300     05  PS-INVOICED-BY-SW       PIC X       VALUE 'B'.           06730000
067400         88  INVOICED-BY-BULK                VALUE 'B'.           06740000
067500         88  INVOICED-BY-STORE               VALUE 'S'.           06750000
067600         88  INVOICED-BY-DC                  VALUE 'D'.           06760000
067700     05  PS-FIRST-RECEIPT-SW     PIC X       VALUE '1'.           06770000
067800         88  FIRST-RECEIPT                   VALUE '1'.           06780000
067900         88  NOT-FIRST-RECEIPT               VALUE '2'.           06790000
068000     05  PS-NSD-EARNED-SW        PIC X      VALUE 'N'.            06800000
068100         88  NSD-EARNED                     VALUE 'Y'.            06810000
068200         88  NSD-NOT-EARNED                 VALUE 'N'.            06820000
068300     05  PS-PRVT-LBL-SW            PIC X    VALUE 'N'.            06830000
068400         88  APPLY-PRVT-LBL-LOAD            VALUE 'Y'.            06840000
068500         88  NO-PRVT-LBL-LOAD               VALUE 'N'.            06850000
068510     05  PS-SBS-CPBL-SW            PIC X    VALUE 'N'.            06851035
068520         88  PS-SBS-CPBL-YES                VALUE 'Y'.            06852035
068530         88  PS-SBS-CPBL-NO                 VALUE 'N'.            06853035
068600                                                                  06860000
068700*----------------------------------------------------------------*06870000
068800*  HOLDS INVOICE DATA PERTAINING TO THE PO IN PROCESS            *06880000
068900*----------------------------------------------------------------*06890000
069000 01  ID-INVOICE-DATA-ALL.                                         06900000
069100     05  ID-DEFAULT-STORE        PIC 9(9)      VALUE ZERO.        06910000
069200     05  ID-DEFAULT-STORE-X REDEFINES ID-DEFAULT-STORE.           06920000
069300         10  FILLER              PIC X(5).                        06930000
069400         10  ID-DEFAULT-STR-X    PIC 9(4).                        06940000
069500     05  ID-INVOICE-DATA.                                         06950000
069600         10  ID-DISCOUNT-PCT     PIC S9(3)V99 VALUE ZERO          06960000
069700                                               COMP-3.            06970000
069800         10  ID-TOTAL-GROSS      PIC S9(9)V99 VALUE ZERO          06980000
069900                                               COMP-3.            06990000
070000         10  ID-TOTAL-RI         PIC S9(9)V99 VALUE ZERO          07000000
070100                                               COMP-3.            07010000
070200         10  ID-TOTAL-PC         PIC S9(9)V99 VALUE ZERO          07020000
070300                                               COMP-3.            07030000
070400         10  ID-TOTAL-VENDOR-FRT PIC S9(7)V99 VALUE ZERO.         07040000
070500         10  ID-TOTAL-FREIGHT-CHARGES                             07050000
070600                                 PIC S9(7)V99 VALUE ZERO.         07060000
070700         10  ID-TOTAL-MISC-CHARGES                                07070000
070800                                 PIC S9(7)V99 VALUE ZERO.         07080000
070900         10  ID-TOTAL-DNP-CHARGES                                 07090000
071000                                 PIC S9(7)V99 VALUE ZERO.         07100000
071010         10  ID-TOTAL-DIRECT-SHIP-COST                            07101030
071020                                 PIC S9(7)V99 VALUE ZERO.         07102030
071030         10  ID-TOTAL-BOTTLE-DEPOSIT                              07103074
071040                                 PIC S9(7)V99 VALUE ZERO.         07104074
071100         10  ID-PYMT-HOLD-CDE    PIC X.                           07110000
071200             88  ID-DOC-HLD                    VALUE 'D'.         07120000
071300             88  ID-NOT-ON-HLD                 VALUE 'N'.         07130000
071400         10  ID-PYMT-DUE-DTE     PIC X(10)     VALUE '9999-09-09'.07140000
071500         10  ID-WRITE-OFF-IND    PIC X         VALUE SPACES.      07150000
071600             88  ID-WRITE-OFF-INVC             VALUE 'Y'.         07160000
071700             88  NOT-ID-WRITE-OFF-INVC         VALUE ' '.         07170000
071800         10  ID-TOTAL-ADV-DISC-AMT                                07180000
071900                                 PIC S9(7)V99 VALUE ZERO.         07190000
072000         10  ID-TOTAL-NEW-STR-AMT                                 07200000
072100                                 PIC S9(7)V99 VALUE ZERO.         07210000
072200         10  ID-TOTAL-COOP-ADV-AMT                                07220000
072300                                 PIC S9(7)V99 VALUE ZERO.         07230000
072400         10  ID-TOTAL-MOS-DISC-AMT                                07240000
072500                                 PIC S9(7)V99 VALUE ZERO.         07250000
072600         10  ID-TOTAL-TRD-DISC-AMT                                07260000
072700                                 PIC S9(7)V99 VALUE ZERO.         07270000
072800         10  ID-TOTAL-ALW-DISC-AMT                                07280000
072900                                 PIC S9(7)V99 VALUE ZERO.         07290000
073000         10  ID-TOTAL-MISC-DISC-AMT                               07300000
073100                                 PIC S9(7)V99 VALUE ZERO.         07310000
073200         10  ID-CD-GIFT-WRAP-AMT                                  07320000
073300                                 PIC S9(7)V99 VALUE ZERO.         07330000
073400         10  ID-CD-HANDLING-AMT                                   07340000
073500                                 PIC S9(7)V99 VALUE ZERO.         07350000
073600         10  ID-ACTL-LANDED-COST-AMT                              07360000
073700                                 PIC S9(7)V99 VALUE ZERO.         07370000
073800         10  ID-PRIVATE-LBL-LOAD-AMT                              07380000
073900                                 PIC S9(7)V99 VALUE ZERO.         07390000
074000         10  ID-FIRST-COST-LOAD-AMT                               07400000
074100                                 PIC S9(7)V99 VALUE ZERO.         07410000
074110         10  ID-TOTAL-SEPHORA-INVC-AMT                            07411045
074120                                 PIC S9(9)V99 VALUE ZERO.         07412045
074130         10  ID-TOTAL-REPAY-SHTG-AMT                              07413045
074140                                 PIC S9(9)V99 VALUE ZERO.         07414045
074150         10  ID-SEPHORA-TERMS-DISC-PCT                            07415045
074160                                 PIC S9(3)V99 VALUE ZERO.         07416045
074170         10  ID-SEPHORA-REPAY-DISC-PCT                            07417045
074180                                 PIC S9(3)V99 VALUE ZERO.         07418045
074200 EJECT                                                            07420000
074300*----------------------------------------------------------------*07430000
074400*  HOLDS RECEIVER AND NON-INVOICED RECEIPT DATA.  CERTAIN FIELDS *07440000
074500*  (UNIT QUANTITY, TOTAL COST, AND TOTAL RETAIL) ARE ACCUMULATED *07450000
074600*  WITHIN A CLASS, SEQUENCE NUMBER, STORE NUMBER, AND RECEIPT    *07460000
074700*  TYPE.                                                         *07470000
074800*----------------------------------------------------------------*07480000
074900 01  RD-SUB-LIMIT                PIC S9(4)     VALUE +1000        07490000
075000                                               COMP SYNC.         07500000
075100 01  RD-RECEIPT-DATA.                                             07510000
075200     05  RD-TOTAL-REC-COST       PIC S9(9)V99 VALUE ZERO          07520000
075300                                               COMP-3.            07530000
075400     05  RD-TOTAL-CP             PIC S9(9)V99 VALUE ZERO          07540000
075500                                               COMP-3.            07550000
075600     05  RD-TOTAL-DP             PIC S9(9)V99 VALUE ZERO          07560000
075700                                               COMP-3.            07570000
075800     05  RD-TOTAL-DM             PIC S9(9)V99 VALUE ZERO          07580000
075900                                               COMP-3.            07590000
076000     05  RD-CLASS-SEQ-STR-DATA.                                   07600000
076100         10  RD-CLASS-NBR        PIC X(2)      VALUE SPACES.      07610000
076200         10  RD-REC-SEQ-NBR      PIC 9(9)      VALUE ZERO.        07620000
076300         10  RD-REC-SEQ-NBR-X REDEFINES RD-REC-SEQ-NBR.           07630000
076400             15  FILLER          PIC X.                           07640000
076500             15  RD-REC-SEQ-X    PIC X(8).                        07650000
076600         10  RD-STR-NBR          PIC 9(4)      VALUE ZERO.        07660000
076700         10  RD-LOC-NBR          PIC S9(4) COMP VALUE ZERO.       07670000
076800         10  RD-OPER-UNT-TYP-CDE PIC X(2)      VALUE SPACES.      07680000
076900         10  RD-RECEIPT-TYPE     PIC X(2)      VALUE SPACES.      07690000
077000             88 RD-RECEIVER                    VALUE 'RV'.        07700000
077100             88 RD-NON-INVC-RECEIPT            VALUE 'NR'.        07710000
077200         10  RD-TOTAL-QTY        PIC S9(9)     VALUE ZERO         07720000
077300                                               COMP.              07730000
077400         10  RD-TOTAL-COST       PIC S9(9)V999 VALUE ZERO         07740000
077500                                               COMP-3.            07750000
077600         10  RD-TOTAL-RETAIL     PIC S9(7)V99 VALUE ZERO          07760000
077700                                               COMP-3.            07770000
077800         10  RD-TOTAL-REC-RETAIL PIC S9(9)V99 VALUE ZERO          07780000
077900                                               COMP-3.            07790000
078000         10  RD-TOTAL-LOAD-COST  PIC S9(9)V999 VALUE ZERO         07800000
078100                                               COMP-3.            07810000
078200         10  RD-REC-TMST         PIC X(26)     VALUE SPACES.      07820000
078300         10  FILLER REDEFINES RD-REC-TMST.                        07830000
078400             15  RD-REC-DATE     PIC X(10).                       07840000
078500             15  FILLER          PIC X(16).                       07850000
078600         10  RD-VERFYD-TMST      PIC X(26)     VALUE SPACES.      07860000
078700         10  RD-RECEIV-CRE-TMST  PIC X(26)     VALUE SPACES.      07870000
078800         10  RD-ORIG-DISC-PCT    PIC  SV9(4)   VALUE ZERO         07880000
078900                                               COMP-3.            07890000
079000         10  RD-SKU-NBR          PIC 9(8)      VALUE ZERO.        07900000
079100                                                                  07910000
079200         10  RD-SUB              PIC S9(4)     VALUE ZERO         07920000
079300                                               COMP SYNC.         07930000
079400         10  RD-SUB-MAX          PIC S9(4)     VALUE ZERO         07940000
079500                                               COMP SYNC.         07950000
079600         10  RD-MULTIPLES OCCURS 1000 TIMES.                      07960000
079700             15  RD-PO-LNE-NBR   PIC S9(9)     COMP.              07970000
079800             15  RD-OPER-UNT-ID  PIC S9(4)     COMP.              07980000
079900             15  RD-FCLTY-ID     PIC S9(4)     COMP.              07990000
080000             15  RD-STR-FCLTY-ID PIC S9(4)     COMP.              08000000
080100             15  RD-RECDIS-TMST  PIC X(26).                       08010000
080200 EJECT                                                            08020000
080300*----------------------------------------------------------------*08030000
080400*  HOLDS PO/STORE PO LINES RECEIPT DATA FOR A PO LINE NUMBER TO  *08040000
080500*  BE USED FOR EACH ENTRY OF THE PRCCLM CURSOR.                  *08050000
080600*----------------------------------------------------------------*08060000
080700 01  PL-SUB                      PIC S9(5)     VALUE +0           08070015
080800                                               COMP SYNC.         08080000
080900*01  PL-SUB-LIMIT                PIC S9(4)     VALUE +7500        08090013
080910 01  PL-SUB-LIMIT                PIC S9(5)     VALUE +81000       08091014
081000                                               COMP SYNC.         08100000
081100*01  PL-RECS-LOADED              PIC S9(4)     VALUE +0           08110014
081110 01  PL-RECS-LOADED              PIC S9(5)     VALUE +0           08111014
081200                                               COMP SYNC.         08120000
081300 01  PL-PO-LINE-NUMBER           PIC S9(9)     VALUE +0           08130000
081400                                               COMP SYNC.         08140000
081500 01  PL-RECEIPT-TABLE.                                            08150000
081600     05 PL-RECEIPT-DATA OCCURS 81000 TIMES.                       08160013
081610**   05 PL-RECEIPT-DATA OCCURS 7500 TIMES.                        08161013
081700         10  PL-CLASS-NUMBER     PIC X(2).                        08170000
081800         10  PL-RECEIVER-SEQ-NUMBER PIC S9(9) COMP.               08180000
081900         10  PL-STR-NBR          PIC S9(4)     COMP.              08190000
082000         10  PL-RECEIPT-TYPE     PIC X(2).                        08200000
082100             88 PL-RECEIVER                    VALUE 'RV'.        08210000
082200             88 PL-NON-INVC-RECEIPT            VALUE 'NR'.        08220000
082300         10  PL-NR-NON-INVC-UNT-QTY PIC S9(9) COMP.               08230000
082400         10  PL-SKU-NBR             PIC 9(8).                     08240000
082500 EJECT                                                            08250000
082600*----------------------------------------------------------------*08260000
082700*  WORKING STORAGE AREA FOR DPKUT500, DATE MANIPULATION ROUTINE  *08270000
082800*----------------------------------------------------------------*08280000
082900     COPY DPWS500.                                                08290000
083000 EJECT                                                            08300000
083100*----------------------------------------------------------------*08310000
083200*  REPORT FIELDS                                                 *08320000
083300*----------------------------------------------------------------*08330000
083400 01  RV-REPORT-VARIABLES.                                         08340000
083500     05  RV-COST-MISMATCH        PIC X(31) VALUE                  08350000
083600         'COST MISMATCH'.                                         08360000
083700     05  RV-NO-PRCCLM-REC        PIC X(31) VALUE                  08370000
083800         'PRCCLM LINE# NOT FOUND IN RCVR'.                        08380000
083900     05  RV-MISSING-PRCCLM       PIC X(31) VALUE                  08390000
084000         'MISSING PRCCLM LN# MATCH W/RCVR'.                       08400000
084100     05  RV-COST-FIELDS.                                          08410000
084200         10  RV-REC-TOT-HDR      PIC X(14) VALUE                  08420000
084300             'RECEIVER TOT: '.                                    08430000
084400         10  RV-REC-TOT          PIC 9(9)V99                      08440000
084500                                            VALUE ZERO.           08450000
084600         10  RV-INVC-TOT-HDR     PIC X(10) VALUE                  08460000
084700             'INVC TOT: '.                                        08470000
084800         10  RV-INVC-TOT         PIC 9(9)V99                      08480000
084900                                            VALUE ZERO.           08490000
085000         10  RV-VAR-HDR          PIC X(10) VALUE                  08500000
085100             'VARIANCE: '.                                        08510000
085200         10  RV-VARIANCE         PIC 9(9)V99                      08520000
085300                                            VALUE ZERO.           08530000
085400     05  RV-PRCCLM-FIELDS.                                        08540000
085500         10  RV-PO-LINE-HDR      PIC X(9) VALUE                   08550000
085600             'PO LINE: '.                                         08560000
085700         10  RV-PO-LINE          PIC 9(9) VALUE ZERO.             08570000
085800         10  RV-INVC-NBR-HDR     PIC X(10) VALUE                  08580000
085900             'INVOICE#: '.                                        08590000
086000         10  RV-INVC-NBR         PIC X(22) VALUE SPACES.          08600000
086100         10  RV-PRCCLM-AMT-HDR   PIC X(12) VALUE                  08610000
086200             'PRCCLM AMT: '.                                      08620000
086300                                                                  08630000
086400 01  D1-DETAIL1.                                                  08640000
086500     05  FILLER                  PIC X       VALUE SPACE.         08650000
086600     05  D1-PO-NBR               PIC 9(9)    VALUE ZERO.          08660000
086700     05  FILLER                  PIC X(2)    VALUE SPACES.        08670000
086800     05  D1-STORE-NBR            PIC 9(4)    VALUE ZERO.          08680000
086900     05  FILLER                  PIC X(3)    VALUE SPACES.        08690000
087000     05  D1-ERROR-MSG            PIC X(31)   VALUE SPACES.        08700000
087100     05  FILLER                  PIC X       VALUE SPACES.        08710000
087200     05  D1-COST-FIELDS.                                          08720000
087300         10  D1-REC-TOT-HDR      PIC X(14) VALUE SPACES.          08730000
087400         10  D1-REC-TOT          PIC 9(9)V99 VALUE ZEROES.        08740000
087500         10  FILLER              PIC X(5) VALUE SPACES.           08750000
087600         10  D1-INVC-TOT-HDR     PIC X(10) VALUE SPACES.          08760000
087700         10  D1-INVC-TOT         PIC 9(9)V99 VALUE ZEROES.        08770000
087800         10  FILLER              PIC X(6) VALUE SPACES.           08780000
087900         10  D1-VAR-HDR          PIC X(10) VALUE SPACES.          08790000
088000         10  FILLER              PIC X(3) VALUE SPACES.           08800000
088100         10  D1-VARIANCE         PIC 9(9)V99 VALUE ZEROES.        08810000
088200         10  FILLER              PIC X      VALUE SPACES.         08820000
088300     05  D1-PRCCLM-FIELDS REDEFINES D1-COST-FIELDS.               08830000
088400         10  D1-PO-LINE-HDR      PIC X(9).                        08840000
088500         10  D1-PO-LINE          PIC 9(9).                        08850000
088600         10  FILLER              PIC X(3).                        08860000
088700         10  D1-INVC-NBR-HDR     PIC X(10).                       08870000
088800         10  D1-INVC-NBR         PIC X(22).                       08880000
088900         10  FILLER              PIC X(2).                        08890000
089000         10  D1-PRCCLM-AMT-HDR   PIC X(12).                       08900000
089100         10  FILLER              PIC X(3).                        08910000
089200         10  D1-PRCCLM-AMT       PIC 9(9)V99.                     08920000
089300         10  FILLER              PIC X.                           08930000
089400                                                                  08940000
089500 01  D2-DETAIL2.                                                  08950000
089600     05  FILLER                  PIC X(19)   VALUE SPACE.         08960000
089700     05  D2-MESSAGE              PIC X(32)   VALUE                08970000
089800         'THERE ARE NO ERRORS TODAY       '.                      08980000
089900     05  FILLER                  PIC X(81)   VALUE SPACE.         08990000
090000 EJECT                                                            09000000
090010                                                                  09001034
090100*----------------------------------------------------------------*09010000
090200*  COMMUNICATIONS AREA2 FOR DB2                                  *09020000
090300*----------------------------------------------------------------*09030000
090400     COPY SQLCA2.                                                 09040000
090500                                                                  09050000
090600                                                                  09060000
090700     EXEC SQL                                                     09070000
090800          INCLUDE SQLCA                                           09080000
090900     END-EXEC.                                                    09090000
091000 EJECT                                                            09100000
091100*----------------------------------------------------------------*09110000
091200*  RELEASED PO/STORES TABLE                                      *09120000
091300*----------------------------------------------------------------*09130000
091400     EXEC SQL                                                     09140000
091500          INCLUDE TPOSTRR                                         09150000
091600     END-EXEC.                                                    09160000
091700 EJECT                                                            09170000
091800*----------------------------------------------------------------*09180000
091900*  EXTERNAL ENTERPRISE TABLE                                     *09190000
092000*----------------------------------------------------------------*09200000
092100     EXEC SQL                                                     09210000
092200          INCLUDE TEXTENT                                         09220000
092300     END-EXEC.                                                    09230000
092400 EJECT                                                            09240000
092500*----------------------------------------------------------------*09250000
092600*  EXTERNAL ENTERPRISE NAME TABLE                                *09260000
092700*----------------------------------------------------------------*09270000
092800     EXEC SQL                                                     09280000
092900          INCLUDE TENTNME                                         09290000
093000     END-EXEC.                                                    09300000
093100 EJECT                                                            09310000
093200*----------------------------------------------------------------*09320000
093300*  PURCHASE TABLE                                                *09330000
093400*----------------------------------------------------------------*09340000
093500     EXEC SQL                                                     09350000
093600          INCLUDE TPURCHS                                         09360000
093700     END-EXEC.                                                    09370000
093800 EJECT                                                            09380000
093900*----------------------------------------------------------------*09390000
094000*  PURCHASE ORDER ITEMS TABLE                                    *09400000
094100*----------------------------------------------------------------*09410000
094200     EXEC SQL                                                     09420000
094300          INCLUDE TPURITM                                         09430000
094400     END-EXEC.                                                    09440000
094500 EJECT                                                            09450000
094600*----------------------------------------------------------------*09460000
094700*  NON-INVOICED RECEIPT TABLE                                    *09470000
094800*----------------------------------------------------------------*09480000
094900     EXEC SQL                                                     09490000
095000          INCLUDE TNINREC                                         09500000
095100     END-EXEC.                                                    09510000
095200 EJECT                                                            09520000
095300*----------------------------------------------------------------*09530000
095400*  PRICE CLAIM ADJUSTMENTS TABLE                                 *09540000
095500*----------------------------------------------------------------*09550000
095600     EXEC SQL                                                     09560000
095700          INCLUDE TPRCCLM                                         09570000
095800     END-EXEC.                                                    09580000
095900 EJECT                                                            09590000
096000*----------------------------------------------------------------*09600000
096100*  AP CONTROL TABLE                                              *09610000
096200*----------------------------------------------------------------*09620000
096300     EXEC SQL                                                     09630000
096400          INCLUDE TAPCNTL                                         09640000
096500     END-EXEC.                                                    09650000
096600 EJECT                                                            09660000
096700*----------------------------------------------------------------*09670000
096800*  AP TRANSACTION CODE TABLE                                     *09680000
096900*----------------------------------------------------------------*09690000
097000     EXEC SQL                                                     09700000
097100          INCLUDE TTRNCDE                                         09710000
097200     END-EXEC.                                                    09720000
097300 EJECT                                                            09730000
097400*----------------------------------------------------------------*09740000
097500*  AP NEW STORE DISCOUNT CONTROL TABLE                           *09750000
097600*----------------------------------------------------------------*09760000
097700     EXEC SQL                                                     09770000
097800          INCLUDE APT00000                                        09780000
097900     END-EXEC.                                                    09790000
098000 EJECT                                                            09800000
098100*----------------------------------------------------------------*09810000
098200*  VENDOR AGREEMENT TABLE                                        *09820000
098300*----------------------------------------------------------------*09830000
098400     EXEC SQL                                                     09840000
098500          INCLUDE TVNDAGR                                         09850000
098600     END-EXEC.                                                    09860000
098700 EJECT                                                            09870000
098800*----------------------------------------------------------------*09880000
098900*  AP ADJUSTMENT JOURNAL TRANSACTION FILE TABLE                  *09890000
099000*----------------------------------------------------------------*09900000
099100     EXEC SQL                                                     09910000
099200          INCLUDE TOUTAP1                                         09920000
099300     END-EXEC.                                                    09930000
099400 EJECT                                                            09940000
099500*----------------------------------------------------------------*09950000
099600*  AP RECONCILIATION RESULTS FILE TABLE                          *09960000
099700*----------------------------------------------------------------*09970000
099800     EXEC SQL                                                     09980000
099900          INCLUDE TOUTAP2                                         09990000
100000     END-EXEC.                                                    10000000
100100                                                                  10010000
100200*----------------------------------------------------------------*10020000
100300*  AP RECEIVER UPDATES FILE TABLE                                *10030000
100400*----------------------------------------------------------------*10040000
100500     EXEC SQL                                                     10050000
100600          INCLUDE TOUTAP3                                         10060000
100700     END-EXEC.                                                    10070000
100800                                                                  10080000
100900*----------------------------------------------------------------*10090000
101000*  AP CLASS DISTRIBUTION ERROR FILE TABLE                        *10100000
101100*----------------------------------------------------------------*10110000
101200     EXEC SQL                                                     10120000
101300          INCLUDE TOUTAP4                                         10130000
101400     END-EXEC.                                                    10140000
101500                                                                  10150000
101600*----------------------------------------------------------------*10160036
101700*  MB MERCHANDISE AREA TABLE                                     *10170036
101800*----------------------------------------------------------------*10180036
101900     EXEC SQL                                                     10190036
102000          INCLUDE TMDSEAR                                         10200036
102100     END-EXEC.                                                    10210036
102200                                                                  10220036
102300*----------------------------------------------------------------*10230036
102310*  EX VENDOR CAPABILITY TABLE - VNT_VND_CPBL                     *10231036
102320*----------------------------------------------------------------*10232036
102330     EXEC SQL                                                     10233036
102340          INCLUDE VNT00001                                        10234036
102350     END-EXEC.                                                    10235036
102360                                                                  10236036
102400*----------------------------------------------------------------*10240000
102500* PO_CSR GETS ALL THE POS THAT ARE SET UP FOR THE OPEN TO PAY    *10250000
102600* PROCESS.  (NOTE: THE 'WITH HOLD' CLAUSE ALLOWS THE CURSOR      *10260000
102700* TO REMAIN OPEN WHEN THE COMMIT IS PERFORMED.)                  *10270000
102800*----------------------------------------------------------------*10280000
102900     EXEC SQL                                                     10290000
103000       DECLARE PO_CSR CURSOR WITH HOLD FOR                        10300000
103100         SELECT                                                   10310000
103200             PO_NBR                                               10320000
103300            ,STR_NBR                                              10330000
103400            ,PAYT_RLSE_TMST                                       10340000
103500            ,CRE_PRC_CDE                                          10350000
103600            ,TOLR_ADJ_CDE                                         10360000
103700            ,TOLR_ADJ_AMT                                         10370000
103800            ,WEIGHTED_DISC_PCT                                    10380000
103900            ,TOTAL_DISC_AMT                                       10390000
104000            ,MTCH_LVL_CDE                                         10400000
104100          FROM TPOSTRR                                            10410000
104200          WHERE STATUS_CDE = ' '                                  10420000
104300          ORDER BY PO_NBR, STR_NBR                                10430000
104400     END-EXEC.                                                    10440000
104500 EJECT                                                            10450000
104600*----------------------------------------------------------------*10460000
104700* PRCCLM_CSR RETREIVES ALL PRICE CLAIM ROWS ASSOCIATED WITH A    *10470000
104800* PO/STORE.  (NOTE: THE STORE ON TPRCCLM WILL BE ZERO FOR BULK.) *10480000
104900*----------------------------------------------------------------*10490000
105000     EXEC SQL                                                     10500000
105100       DECLARE PRCCLM_CSR CURSOR FOR                              10510000
105200         SELECT INVC_ID,                                          10520000
105300                PO_LNE_NBR,                                       10530000
105400                DOC_TYP_CDE,                                      10540000
105500                UNT_QTY,                                          10550000
105600                ADJ_COST_AMT,                                     10560000
105700                UNT_COST_AMT,                                     10570000
105800                (ADJ_COST_AMT - UNT_COST_AMT)                     10580000
105900         FROM TPRCCLM                                             10590000
106000         WHERE PO_NBR  = :PV-PO-IN-PROCESS                        10600000
106100           AND STR_NBR = :PV-STORE-IN-PROCESS                     10610000
106200           AND DOC_TYP_CDE IN ('CP','DP')                         10620000
106300         ORDER BY PO_LNE_NBR                                      10630000
106400     END-EXEC.                                                    10640000
106500 EJECT                                                            10650000
106600*----------------------------------------------------------------*10660000
106700* TODAYS_NINREC_CSR RETRIEVES ALL NON-INVOICED RECEIPTS THAT     *10670000
106800* HAVE BEEN CREATED TODAY TO GENERATE ADJUSTMENT JOURNAL         *10680000
106900* TRANSACTIONS.  NON-INVOICED RECEIPTS THAT HAVE BEEN            *10690000
107000* CREATED TODAY WILL HAVE A STATUS OF SPACES AND A TIMESTAMP     *10700000
107100* OF NINES.  (NOTE: THE STORE ON TNINREC WILL BE ZERO FOR BULK.) *10710000
107200*----------------------------------------------------------------*10720000
107300     EXEC SQL                                                     10730000
107400       DECLARE TODAYS_NINREC_CSR CURSOR FOR                       10740000
107500         SELECT                                                   10750000
107600             PI.CL_NBR,                                           10760000
107700             NR.NON_INVC_SEQ_NBR,                                 10770000
107800             NR.UNT_COST_AMT,                                     10780000
107900             NR.PO_LNE_NBR,                                       10790000
108000             NR.NON_INVC_UNT_QTY,                                 10800000
108100            (NR.NON_INVC_UNT_QTY * NR.UNT_COST_AMT),              10810000
108200             NR.ORIG_DISC_PCT                                     10820000
108300                                                                  10830000
108400         FROM                                                     10840000
108500             TNINREC NR,                                          10850000
108600             TPURITM PI                                           10860000
108700                                                                  10870000
108800         WHERE NR.PO_NBR          = :PV-PO-IN-PROCESS             10880000
108900           AND NR.PO_NBR          = PI.PO_NBR                     10890000
109000           AND NR.STR_NBR         = :PV-STORE-IN-PROCESS          10900000
109100           AND NR.PO_LNE_NBR      = PI.APP_PO_LNE_NBR             10910000
109200           AND NR.STATUS_CDE      = ' '                           10920000
109300           AND PI.VER_STATUS_CDE  = 'A'                           10930000
109400           AND NR.PAYT_RLSE_TMST  = '9999-09-09-09.09.09.999999'  10940000
109500     END-EXEC.                                                    10950000
109600                                                                  10960000
109800*----------------------------------------------------------------*10980000
109900*  PO/STORE INVOICE LAYOUT                                       *10990000
110000*----------------------------------------------------------------*11000000
110100     COPY APRD058.                                                11010000
110200 EJECT                                                            11020000
110300*----------------------------------------------------------------*11030000
110400*  PO/STORE PO LINES FILE LAYOUT                                 *11040000
110500*----------------------------------------------------------------*11050000
110600     COPY APRD100.                                                11060000
110700 EJECT                                                            11070000
110800*----------------------------------------------------------------*11080000
110900*  PO/STORE RECEIPTS SUM FILE LAYOUT                             *11090000
111000*----------------------------------------------------------------*11100000
111100     COPY APRD101.                                                11110000
111200 EJECT                                                            11120000
111300*----------------------------------------------------------------*11130000
111400*  PO/STORE RECEIPTS FILE LAYOUT                                 *11140000
111500*----------------------------------------------------------------*11150000
111600     COPY APRD105.                                                11160000
111700 EJECT                                                            11170000
111800*----------------------------------------------------------------*11180000
111900*  ADJUSTMENT JOURNAL TRANSACTION LAYOUT                         *11190000
112000*----------------------------------------------------------------*11200000
112100     COPY APRD045.                                                11210000
112200 EJECT                                                            11220000
112300*----------------------------------------------------------------*11230000
112400*  RECONCILIATION RESULTS LAYOUT                                 *11240000
112500*----------------------------------------------------------------*11250000
112600     COPY APRD263.                                                11260000
112700 EJECT                                                            11270000
112800*----------------------------------------------------------------*11280000
112900*  TRECEIV UPDATE LAYOUT                                         *11290000
113000*----------------------------------------------------------------*11300000
113100     COPY APRD254.                                                11310000
113200 EJECT                                                            11320000
113300*---------------------------------------------------------------- 11330000
113400*  WORKING STORAGE AREA FOR DPKUP151                              11340000
113500*---------------------------------------------------------------- 11350000
113600     COPY APWS151.                                                11360000
113601     COPY DPWS951.                                                11360173
113610*---------------------------------------------------------------- 11361042
113620*  WORKING STORAGE AREA FOR SEPHORA @ KOHLS                       11362042
113630*---------------------------------------------------------------- 11363042
113640     COPY APWS021.                                                11364042
113700 EJECT                                                            11370000
113800*----------------------------------------------------------------*11380000
113900*  ABEND DATA AREAS                                              *11390000
114000*----------------------------------------------------------------*11400000
114100 01  ABEND-CODE                  PIC S9(4)   VALUE ZERO           11410000
114200                                             COMP SYNC.           11420000
114300     88  AC-TABLE-OVERFLOW                   VALUE +4004.         11430000
114400     88  AC-PO-LINES-OVERFLOW                VALUE +4004.         11440000
114500     88  AC-BAD-DATA                         VALUE +4008.         11450000
114600     88  AC-DB2-ERROR                        VALUE +4013.         11460000
114700     88  AC-DATE-ERROR                       VALUE +4019.         11470000
114800                                                                  11480000
114900                                                                  11490000
115000 01  ABEND-AREAS.                                                 11500000
115100     05  AA-ABEND-LIT            PIC X(40)   VALUE                11510000
115200             '*****       ABEND'.                                 11520000
115300     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                11530000
115400             '*****   PROGRAM: APKUP254'.                         11540000
115500     05  AA-PARAGRAPH-LIT.                                        11550000
115600         10  FILLER              PIC X(17)   VALUE                11560000
115700             '***** PARAGRAPH: '.                                 11570000
115800         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        11580000
115900     05  AA-MESSAGE-LINE.                                         11590000
116000         10  FILLER              PIC X(6)    VALUE '*****'.       11600000
116100         10  AA-MESSAGE          PIC X(127) VALUE SPACES.         11610000
116200         10  FILLER REDEFINES AA-MESSAGE.                         11620000
116300             15 AA-MESSAGE-1     PIC X(45).                       11630000
116400             15 AA-MESSAGE-2     PIC X(45).                       11640000
116500             15 AA-MESSAGE-3     PIC X(37).                       11650000
116600     05  AA-NO-INVOICES-ERRMSG.                                   11660000
116700         10  FILLER              PIC X(29)   VALUE                11670000
116800             'NO INVOICES RETRIEVED FOR PO '.                     11680000
116900         10  AA-NO-INV-ERRM-PO   PIC X(9)    VALUE SPACES.        11690000
117000     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                11700000
117100             '*****    DB2 ERROR'.                                11710000
117200     05  AA-DB2-OPERATION-LIT.                                    11720000
117300         10  FILLER              PIC X(17)   VALUE                11730000
117400             '***** OPERATION: '.                                 11740000
117500         10  AA-DB2-OPERATION.                                    11750000
117600             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        11760000
117700             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        11770000
117800     05  AA-DB2-TABLE-1          PIC X(8)    VALUE SPACES.        11780000
117900     05  AA-DB2-TABLE-2          PIC X(8)    VALUE SPACES.        11790000
118000     05  AA-DB2-TABLE-3          PIC X(8)    VALUE SPACES.        11800000
118100     05  AA-DB2-TABLE-4          PIC X(8)    VALUE SPACES.        11810000
118200     05  AA-DB2-TABLE-5          PIC X(8)    VALUE SPACES.        11820000
118300                                                                  11830000
118400                                                                  11840000
118500     COPY DPWS004.                                                11850000
118600 EJECT                                                            11860000
118700 PROCEDURE DIVISION.                                              11870000
118800 A100-MAIN.                                                       11880000
118900                                                                  11890000
119000     DISPLAY '***********  START OF APKUP254 *************'       11900000
119100                                                                  11910000
119200     PERFORM B100-INITIALIZE.                                     11920000
119300                                                                  11930000
119400     PERFORM B200-PROCESS-POS                                     11940000
119500         UNTIL OUT-OF-POS.                                        11950000
119600                                                                  11960000
119700     PERFORM B300-END-PROGRAM.                                    11970000
119800                                                                  11980000
119900     GOBACK.                                                      11990000
120000 EJECT                                                            12000000
120100*----------------------------------------------------------------*12010000
120200*    INITIALIZATION PROCESSING                                   *12020000
120300*    CALLED FROM A100-MAIN                                       *12030000
120400*----------------------------------------------------------------*12040000
120500 B100-INITIALIZE.                                                 12050000
120600                                                                  12060000
120700                                                                  12070000
120800     INITIALIZE DCLTPOSTRR                                        12080000
120900                DCLTEXTENT                                        12090000
121000                DCLTENTNME                                        12100000
121100                DCLTPURCHS                                        12110000
121200                DCLTNINREC                                        12120000
121300                DCLTPURITM                                        12130000
121400                DCLTPRCCLM                                        12140000
121500                DCLTAPCNTL                                        12150000
121600                DCLTTRNCDE                                        12160000
121700                DCLTOUTAP1                                        12170000
121800                DCLTOUTAP2                                        12180000
121900                DCLTOUTAP3                                        12190000
122000                DCLTOUTAP4                                        12200000
122100                AP045-TRANSACTION-FILE                            12210000
122200                AP100-RECORD                                      12220000
122300                AP101-RECORD                                      12230000
122400                AP105-RECORD                                      12240000
122500                AP254-RECORD                                      12250000
122600                RD-RECEIPT-DATA.                                  12260000
122700                                                                  12270000
122800     EXEC SQL                                                     12280000
122900         LOCK TABLE TOUTAP1 IN EXCLUSIVE MODE                     12290000
123000     END-EXEC.                                                    12300000
123100                                                                  12310000
123200     OPEN INPUT POSTORE-INVOICE-FILE                              12320000
123300                PO-LINES-FILE                                     12330000
123400                RECEIPTS-SUM-FILE                                 12340000
123500                RECEIPTS-FILE.                                    12350000
123600                                                                  12360000
123700     PERFORM R800-GET-AP-CNTL-DATA.                               12370000
123800     MOVE APCNTL-BTCH-PRC-DTE TO PV-CURR-DB2-DATE                 12380000
123900                                 PV-RECDIS-AP-PRC-DTE             12390000
124000                                 PV-BTCH-NBR-DTE.                 12400000
124100                                                                  12410000
124200     MOVE '00'                TO PV-BTCH-NBR-SEQ-NBR.             12420000
124300                                                                  12430000
124310                                                                  12431034
124311     MOVE PV-PROGRAM-NAME    TO SA-PROGRAM-NAME.                  12431142
124312     PERFORM S100-GET-SEPHORA-DEPT.                               12431242
124330                                                                  12433034
124400     PERFORM R400-READ-PO-LINES.                                  12440000
124500                                                                  12450000
124600     PERFORM Y100-OPEN-PO-CSR.                                    12460000
124700     PERFORM R100-FETCH-PO-DATA.                                  12470000
124800                                                                  12480000
124900 EJECT                                                            12490000
125000*----------------------------------------------------------------*12500000
125100*    CONTROLS THE PROCESSING OF EACH PO SET UP AS OPEN TO PAY    *12510000
125200*    ON THE RELEASED PO/STORES TABLE.                            *12520000
125300*    CALLED FROM A100-MAIN                                       *12530000
125400*----------------------------------------------------------------*12540000
125500 B200-PROCESS-POS.                                                12550000
125600                                                                  12560000
125700                                                                  12570000
125800     IF POSTRR-PO-NBR = PV-PO-IN-PROCESS                          12580000
125900         CONTINUE                                                 12590000
126000     ELSE                                                         12600000
126100         MOVE ZERO           TO PV-SEQ-CM-COUNT                   12610000
126200                                PV-SEQ-DM-COUNT                   12620000
126300                                PV-SEQ-MI-COUNT                   12630000
126400         MOVE POSTRR-PO-NBR  TO PV-PO-IN-PROCESS                  12640000
126500                                PV-PO-IN-PROCESS-9                12650000
126600         SET NO-PRVT-LBL-LOAD TO TRUE                             12660000
126700                                                                  12670000
126800         PERFORM R200-GET-DEPT                                    12680000
126900         PERFORM R250-GET-VENDOR                                  12690000
126910         MOVE PURCHS-DEPT-NBR    TO PV-DEPT-NBR                   12691042
126911         MOVE PURCHS-ENT-ID      TO PV-ENT-ID                     12691142
126912         PERFORM S500-CHECK-FOR-SEPHORA                           12691242
127000     END-IF.                                                      12700000
127100                                                                  12710000
127200     MOVE POSTRR-STR-NBR     TO PV-STORE-IN-PROCESS               12720000
127300                                PV-STORE-IN-PROCESS-9.            12730000
127400                                                                  12740000
127500     MOVE POSTRR-MTCH-LVL-CDE TO PV-MTCH-LVL-CDE-IN-PROCESS.      12750000
127600                                                                  12760000
127700     IF POSTRR-MTCH-LVL-CDE = 'P'                                 12770000
127800        SET INVOICED-BY-BULK TO TRUE                              12780000
127900     ELSE                                                         12790000
128000       IF POSTRR-MTCH-LVL-CDE = 'S'                               12800000
128100         SET INVOICED-BY-STORE TO TRUE                            12810000
128200       ELSE                                                       12820000
128300         SET INVOICED-BY-DC TO TRUE                               12830000
128400       END-IF                                                     12840000
128500     END-IF.                                                      12850000
128600                                                                  12860000
128700                                                                  12870000
128800* READ FILE UNTIL WE ENCOUNTER A MATCHING STORE FOR THE PO ON     12880000
128900* THE POSTRR TABLE                                                12890000
129000     PERFORM R300-READ-INVOICES                                   12900000
129100         UNTIL (AP058-PO-NBR = PV-PO-IN-PROCESS                   12910000
129200                AND AP058-STORE-NUMBER >= PV-STORE-IN-PROCESS)    12920000
129300            OR (AP058-PO-NBR > PV-PO-IN-PROCESS)                  12930000
129400            OR   OUT-OF-INVOICES.                                 12940000
129500                                                                  12950000
129600     IF ((AP058-PO-NBR = PV-PO-IN-PROCESS                         12960000
129700           AND AP058-STORE-NUMBER > PV-STORE-IN-PROCESS)          12970000
129800       OR (AP058-PO-NBR > PV-PO-IN-PROCESS))                      12980000
129900         SET OUT-OF-INVOICES TO TRUE                              12990000
130000     END-IF.                                                      13000000
130100                                                                  13010000
130200     IF OUT-OF-INVOICES                                           13020000
130300         MOVE 'B200-PROCESS-POS'    TO AA-PARAGRAPH-NAME          13030000
130400         MOVE PV-PO-9-X             TO AA-NO-INV-ERRM-PO          13040000
130500         MOVE AA-NO-INVOICES-ERRMSG TO AA-MESSAGE                 13050000
130600         PERFORM Z999-ABEND                                       13060000
130700     END-IF.                                                      13070000
130800                                                                  13080000
130900     PERFORM C100-GET-DEFAULT-DATA.                               13090000
131000                                                                  13100000
131100     MOVE ID-TOTAL-FREIGHT-CHARGES TO PV-TOT-FRT-ADJ-AMT.         13110000
131200     MOVE ID-TOTAL-VENDOR-FRT      TO PV-VEND-FRT-ADJ-AMT.        13120000
131300     MOVE ID-TOTAL-MISC-CHARGES    TO PV-MISC-ADJ-AMT.            13130000
131400     MOVE POSTRR-TOLR-ADJ-AMT      TO PV-TOLR-ADJ-AMT.            13140000
131500     MOVE ID-TOTAL-DNP-CHARGES     TO PV-DNP-ADJ-AMT.             13150000
131600     MOVE POSTRR-TOTAL-DISC-AMT    TO PV-TOTAL-DISC-AMT.          13160000
131700     MOVE ID-CD-HANDLING-AMT       TO PV-HANDLING-ADJ-AMT.        13170000
131800     MOVE ID-TOTAL-ADV-DISC-AMT    TO PV-BROADCAST-AMT.           13180000
131900     MOVE ID-TOTAL-NEW-STR-AMT     TO PV-NEW-STR-AMT.             13190000
132000     MOVE ID-TOTAL-MOS-DISC-AMT    TO PV-MOS-DISC-AMT.            13200000
132100     MOVE ID-TOTAL-TRD-DISC-AMT    TO PV-TRD-DISC-AMT.            13210000
132200     MOVE ID-TOTAL-ALW-DISC-AMT    TO PV-ALW-DISC-AMT.            13220000
132300     MOVE ID-TOTAL-MISC-DISC-AMT   TO PV-MISC-DISC-AMT.           13230000
132400     MOVE ID-ACTL-LANDED-COST-AMT  TO PV-ACTL-LANDED-COST-AMT.    13240000
132500     MOVE ID-PRIVATE-LBL-LOAD-AMT  TO PV-PRIVATE-LBL-LOAD-AMT.    13250000
132600     MOVE ID-FIRST-COST-LOAD-AMT   TO PV-FIRST-COST-LOAD-AMT.     13260000
132700                                                                  13270000
132800     IF POSTRR-CRE-PRC-CDE = PC-ONLINE-MODE OR PC-AUTO-MODE       13280000
132900         PERFORM Y500-OPEN-PRCCLM-CSR                             13290000
133000         PERFORM R700-FETCH-PRCCLMS                               13300000
133100         PERFORM C200-PROCESS-PRCCLMS                             13310000
133200             UNTIL OUT-OF-PRCCLMS                                 13320000
133300         PERFORM Y510-CLOSE-PRCCLM-CSR                            13330000
133400         INITIALIZE RD-CLASS-SEQ-STR-DATA                         13340000
133500                    PL-PO-LINE-NUMBER                             13350000
133600     END-IF.                                                      13360000
133700                                                                  13370000
133800     PERFORM Y700-OPEN-TODAYS-NR-CSR.                             13380000
133900     PERFORM R900-FETCH-TODAYS-NINREC.                            13390000
134000     PERFORM WITH TEST BEFORE                                     13400000
134100         UNTIL OUT-OF-TODAYS-NR                                   13410000
134200             PERFORM J700-BUILD-TODAYS-NR-AJ                      13420000
134300             PERFORM M300-BUILD-TODAYS-NR-RR                      13430000
134400             PERFORM R900-FETCH-TODAYS-NINREC                     13440000
134500     END-PERFORM.                                                 13450000
134600     PERFORM Y710-CLOSE-TODAYS-NR-CSR.                            13460000
134700                                                                  13470000
134800     PERFORM R500-READ-RECEIPTS-SUM                               13480000
134900         UNTIL (AP101-PO-NBR = PV-PO-IN-PROCESS                   13490000
135000                AND AP101-STORE-NUMBER >= PV-STORE-IN-PROCESS)    13500000
135100            OR (AP101-PO-NBR > PV-PO-IN-PROCESS)                  13510000
135200            OR   OUT-OF-RECEIPTS-SUM.                             13520000
135300                                                                  13530000
135400     IF AP101-PO-NBR = PV-PO-IN-PROCESS                           13540000
135500       AND AP101-STORE-NUMBER = PV-STORE-IN-PROCESS               13550000
135600         ADD AP101-TOTAL-REC-COST TO RD-TOTAL-REC-COST ROUNDED    13560000
135700     END-IF.                                                      13570000
135800                                                                  13580000
135900     IF POSTRR-TOLR-ADJ-AMT NOT = ZERO                            13590000
136000         IF POSTRR-TOLR-ADJ-CDE = PC-CREDIT-AJ                    13600000
136100             ADD POSTRR-TOLR-ADJ-AMT TO RD-TOTAL-CP ROUNDED       13610000
136200         ELSE                                                     13620000
136300             ADD POSTRR-TOLR-ADJ-AMT TO RD-TOTAL-DP ROUNDED       13630000
136400         END-IF                                                   13640000
136500     END-IF.                                                      13650000
136600                                                                  13660000
136700     PERFORM R600-READ-RECEIPTS                                   13670000
136800         UNTIL (AP105-PO-NBR = PV-PO-IN-PROCESS                   13680000
136900                AND AP105-STORE-NUMBER >= PV-STORE-IN-PROCESS)    13690000
137000            OR (AP105-PO-NBR > PV-PO-IN-PROCESS)                  13700000
137100            OR   OUT-OF-RECEIPTS                                  13710000
137200            OR   RECEIPTS-EOF.                                    13720000
137300                                                                  13730000
137400     IF ((AP105-PO-NBR = PV-PO-IN-PROCESS                         13740000
137500          AND AP105-STORE-NUMBER > PV-STORE-IN-PROCESS)           13750000
137600       OR (AP105-PO-NBR > PV-PO-IN-PROCESS))                      13760000
137700       OR RECEIPTS-EOF                                            13770000
137800         SET OUT-OF-RECEIPTS TO TRUE                              13780000
137900     END-IF.                                                      13790000
138000                                                                  13800000
138100     IF OUT-OF-RECEIPTS                                           13810000
138200         CONTINUE                                                 13820000
138300     ELSE                                                         13830000
138400         SET FIRST-RECEIPT TO TRUE                                13840000
138500         PERFORM C300-PROCESS-RECEIPTS                            13850000
138600             UNTIL OUT-OF-RECEIPTS                                13860000
138700         PERFORM C500-UPDT-RECEIPTS                               13870000
138800           VARYING RD-SUB FROM 1 BY 1                             13880000
138900             UNTIL RD-SUB > RD-SUB-MAX                            13890000
139000         PERFORM D500-BUILD-RECS                                  13900000
139100     END-IF.                                                      13910000
139200                                                                  13920000
139300                                                                  13930000
139400     IF ID-WRITE-OFF-INVC                                         13940000
139500        PERFORM J800-BUILD-WRITE-OFF-DEBIT                        13950000
139600     END-IF.                                                      13960000
139700                                                                  13970000
139800     IF ID-CD-GIFT-WRAP-AMT NOT = ZERO                            13980000
139900        PERFORM J925-BUILD-GIFT-WRAP-EXP-AJ                       13990000
140000        PERFORM J930-BUILD-GIFT-WRAP-EXP-REV                      14000000
140100     END-IF.                                                      14010000
140200                                                                  14020000
140300     IF ID-TOTAL-COOP-ADV-AMT NOT = ZERO                          14030000
140400        PERFORM J850-BUILD-COOP-ADV-ADJ                           14040000
140500     END-IF.                                                      14050000
140600                                                                  14060000
140700     IF ID-TOTAL-ALW-DISC-AMT NOT = ZERO                          14070000
140800        PERFORM K950-BUILD-ALW-DISC-ADJ                           14080000
140900     END-IF.                                                      14090000
141000                                                                  14100000
141010     IF ID-TOTAL-DIRECT-SHIP-COST NOT = ZERO                      14101030
141020        PERFORM K940-BUILD-DIRECT-SHIP-EXP-ADJ                    14102030
141030     END-IF.                                                      14103030
141040                                                                  14104030
141041     IF ID-TOTAL-BOTTLE-DEPOSIT NOT = ZERO                        14104174
141042        PERFORM K945-BUILD-BOTTLE-DEPOSIT-ADJ                     14104274
141043     END-IF.                                                      14104374
141044                                                                  14104474
141050     IF PS-SEPHORA-AT-KOHLS                                       14105055
141051                                                                  14105156
141052        IF ID-SEPHORA-TERMS-DISC-PCT NOT = ZERO                   14105255
141053           AND ID-TOTAL-SEPHORA-INVC-AMT NOT = ZERO               14105355
141060           PERFORM L400-BUILD-SEPHORA-DISC                        14106055
141061           PERFORM L500-BUILD-SEPHORA-DISC-OFFSET                 14106155
141070        END-IF                                                    14107055
141080                                                                  14108039
141091        IF ID-TOTAL-SEPHORA-INVC-AMT NOT = ZERO                   14109155
141093           PERFORM L300-BUILD-SEPHORA-PPD-RVRSL                   14109355
141094        END-IF                                                    14109455
141095                                                                  14109545
141100        IF ID-TOTAL-RI NOT = ZERO                                 14110055
141101           PERFORM L600-BUILD-SEPHORA-RI-DISC-ADJ                 14110155
141102        END-IF                                                    14110255
141103                                                                  14110345
141104        IF ID-TOTAL-PC NOT = ZERO                                 14110455
141105           PERFORM L700-BUILD-SEPHORA-PC-DISC-ADJ                 14110555
141106        END-IF                                                    14110655
141107                                                                  14110745
141108        IF ID-TOTAL-REPAY-SHTG-AMT NOT = ZERO                     14110855
141109           AND ID-SEPHORA-REPAY-DISC-PCT NOT = ZERO               14110955
141110           PERFORM L800-BLD-SEPHORA-REPAY-DSC-ADJ                 14111055
141112        END-IF                                                    14111255
141113                                                                  14111345
141114     END-IF.                                                      14111455
141115                                                                  14111555
141120     PERFORM C400-COMPARE-TOTALS.                                 14112000
141200                                                                  14120000
141300     PERFORM U500-UPDATE-POSTRR.                                  14130000
141400                                                                  14140000
141500     PERFORM D800-DETERMINE-COMMIT.                               14150001
141600                                                                  14160000
141700     INITIALIZE ID-INVOICE-DATA                                   14170000
141800                RD-RECEIPT-DATA.                                  14180000
141900     MOVE '9999-09-09' TO ID-PYMT-DUE-DTE.                        14190000
142000                                                                  14200075
142100     SET MORE-INVOICES                                            14210000
142200         MORE-RECEIPTS                                            14220000
142300         MORE-PO-LINES                                            14230000
142400         MORE-PRCCLMS                                             14240000
142500         MORE-TODAYS-NR                                           14250000
142600         FOUND-TODAYS-RI TO TRUE.                                 14260000
142700                                                                  14270000
142800     PERFORM R100-FETCH-PO-DATA.                                  14280000
142900 EJECT                                                            14290000
143000*----------------------------------------------------------------*14300000
143100*    ENDING PROCESSING: DISPLAYS COUNT OF POS AND CLOSES FILES.  *14310000
143200*    CALLED FROM A100-MAIN                                       *14320000
143300*----------------------------------------------------------------*14330000
143400 B300-END-PROGRAM.                                                14340000
143500                                                                  14350000
143600                                                                  14360000
143700     PERFORM Y110-CLOSE-PO-CSR.                                   14370000
143800                                                                  14380000
143900     IF PV-ERROR-COUNT = 0                                        14390000
144000         MOVE D2-DETAIL2 TO D1-DETAIL1                            14400000
144100         PERFORM U400-INSERT-ERROR                                14410000
144200     END-IF.                                                      14420000
144300                                                                  14430000
144400     PERFORM Z100-COMMIT.                                         14440001
144500                                                                  14450001
144600     DISPLAY 'POS PROCESSED        = ' PV-PO-COUNT.               14460001
144700     DISPLAY 'NUMBER OF COMMITS    = ' PV-COMMIT-COUNT.           14470001
144800     DISPLAY PV-ZERO-AMTS-AP045-COUNT ' AP045 RECS WITH NO AMTS'  14480001
144900             ' NOT WRITTEN OUT'.                                  14490001
145000                                                                  14500001
145100     CLOSE POSTORE-INVOICE-FILE                                   14510000
145200           PO-LINES-FILE                                          14520000
145300           RECEIPTS-SUM-FILE                                      14530000
145400           RECEIPTS-FILE.                                         14540000
145500                                                                  14550000
145600     DISPLAY '************** END OF APKUP254 *************'.      14560000
145700 EJECT                                                            14570000
145800*----------------------------------------------------------------*14580000
145900*    SETS DEFAULT VALUES FOR INVOICE DATA BASED ON THE FIRST     *14590000
146000*    INVOICE RETRIEVED.                                          *14600000
146100*    CALLED FROM B200-PROCESS-POS                                *14610000
146200*----------------------------------------------------------------*14620000
146300 C100-GET-DEFAULT-DATA.                                           14630000
146400                                                                  14640000
146500     MULTIPLY POSTRR-WEIGHTED-DISC-PCT BY 100                     14650000
146600         GIVING ID-DISCOUNT-PCT.                                  14660000
146700                                                                  14670000
146800     SET NOT-ID-WRITE-OFF-INVC TO TRUE.                           14680000
146900                                                                  14690000
147000                                                                  14700000
147100     PERFORM D100-PROCESS-EACH-INVOICE                            14710000
147200         UNTIL OUT-OF-INVOICES.                                   14720000
147300                                                                  14730000
147400                                                                  14740000
147500 EJECT                                                            14750000
147600*----------------------------------------------------------------*14760000
147700*    IF A PRICE CLAIM IS A DEBIT OR CREDIT MEMO, IT GETS         *14770000
147800*    ACCUMULATED FOR USE IN CALCULATING THE TOTAL GROSS AMOUNT.  *14780000
147900*    IF A PRICE CLAIM IS A DEBIT OR CREDIT TO THE ADJUSTMENT     *14790000
148000*    JOURNAL, SEARCH FOR MATCHING RECEIVER PO LINES.             *14800000
148100*    CALLED FROM B200-PROCESS-POS                                *14810000
148200*----------------------------------------------------------------*14820000
148300 C200-PROCESS-PRCCLMS.                                            14830000
148400                                                                  14840000
148500                                                                  14850000
148600     IF PV-PRCCLM-DIFFERENCE < 0                                  14860000
148700         COMPUTE PV-PRCCLM-DIFFERENCE = PV-PRCCLM-DIFFERENCE * -1 14870000
148800     END-IF.                                                      14880000
148900     COMPUTE PV-PRCCLM-TOTAL = PV-PRCCLM-DIFFERENCE               14890000
149000                               * PRCCLM-UNT-QTY.                  14900000
149100                                                                  14910000
149200     EVALUATE TRUE                                                14920000
149300                                                                  14930000
149400         WHEN PRCCLM-DOC-TYP-CDE = PC-CREDIT-AJ                   14940000
149500             COMPUTE RD-TOTAL-CP ROUNDED = RD-TOTAL-CP            14950000
149600                 + (PRCCLM-UNT-QTY * PV-PRCCLM-DIFFERENCE)        14960000
149700             PERFORM D700-BUILD-PRCCLM-TRANS                      14970000
149800                                                                  14980000
149900         WHEN PRCCLM-DOC-TYP-CDE = PC-DEBIT-AJ                    14990000
150000             COMPUTE RD-TOTAL-DP ROUNDED = RD-TOTAL-DP            15000000
150100                 + (PRCCLM-UNT-QTY * PV-PRCCLM-DIFFERENCE)        15010000
150200             PERFORM D700-BUILD-PRCCLM-TRANS                      15020000
150300                                                                  15030000
150400     END-EVALUATE.                                                15040000
150500                                                                  15050000
150600     PERFORM R700-FETCH-PRCCLMS.                                  15060000
150700 EJECT                                                            15070000
150800*----------------------------------------------------------------*15080000
150900*    LOADS THE INTERNAL RECEIPT ARRAY.  QUANTITIES AND COSTS     *15090000
151000*    ARE ACCUMULATED WHEN THE SKU, CLASS, SEQUENCE NUMBER,       *15100000
151100*    STORE NUMBER AND RECEIPT TYPE MATCH FOR RECEIVER PURCHASE   *15110000
151200*    TRANSACTIONS.                                               *15120000
151300*    CALLED FROM B200-PROCESS-POS                                *15130000
151400*----------------------------------------------------------------*15140000
151500 C300-PROCESS-RECEIPTS.                                           15150000
151600                                                                  15160000
151700                                                                  15170000
151800     PERFORM D200-COMPUTE-TOTRETL.                                15180000
151900                                                                  15190000
152000     IF AP105-SKU-NBR              = RD-SKU-NBR                   15200000
152100     AND AP105-CLASS-NUMBER        = RD-CLASS-NBR                 15210000
152200     AND AP105-RECEIVER-SEQ-NUMBER = RD-REC-SEQ-NBR               15220000
152300     AND AP105-STR-NBR             = RD-STR-NBR                   15230000
152400     AND AP105-RECEIPT-TYPE        = RD-RECEIPT-TYPE              15240000
152500                                                                  15250000
152600         ADD AP105-TOTAL-COST        TO RD-TOTAL-COST             15260000
152700         ADD PV-TOTAL-RETAIL         TO RD-TOTAL-RETAIL           15270000
152800                                        RD-TOTAL-REC-RETAIL       15280000
152900         ADD AP105-NR-NON-INVC-UNT-QTY TO RD-TOTAL-QTY            15290000
153000         ADD AP105-EXTD-LOAD-COST    TO RD-TOTAL-LOAD-COST        15300000
153100                                                                  15310000
153200         ADD 1 TO RD-SUB-MAX                                      15320000
153300                  RD-SUB                                          15330000
153400                                                                  15340000
153500         IF RD-SUB-MAX > RD-SUB-LIMIT                             15350000
153600             MOVE 'C300-PROCESS-RECEIPTS' TO AA-PARAGRAPH-NAME    15360000
153700             MOVE 'RD-MULTIPLES SUBSCRIPT EXCEEDS LIMIT'          15370000
153800                                        TO AA-MESSAGE             15380000
153900             SET AC-TABLE-OVERFLOW      TO TRUE                   15390000
154000             PERFORM Z999-ABEND                                   15400000
154100         END-IF                                                   15410000
154200                                                                  15420000
154300         MOVE AP105-NR-PO-LNE-NBR   TO RD-PO-LNE-NBR   (RD-SUB)   15430000
154400         MOVE AP105-RD-OPER-UNT-ID  TO RD-OPER-UNT-ID  (RD-SUB)   15440000
154500         MOVE AP105-RD-FCLTY-ID     TO RD-FCLTY-ID     (RD-SUB)   15450000
154600         MOVE AP105-RD-STR-FCLTY-ID TO RD-STR-FCLTY-ID (RD-SUB)   15460000
154700         MOVE AP105-RD-CRE-TMST     TO RD-RECDIS-TMST  (RD-SUB)   15470000
154800                                                                  15480000
154900     ELSE                                                         15490000
155000                                                                  15500000
155100         IF FIRST-RECEIPT                                         15510000
155200             SET NOT-FIRST-RECEIPT TO TRUE                        15520000
155300                                                                  15530000
155400         ELSE                                                     15540000
155500             PERFORM C500-UPDT-RECEIPTS                           15550000
155600                 VARYING RD-SUB FROM 1 BY 1                       15560000
155700                 UNTIL RD-SUB > RD-SUB-MAX                        15570000
155800             PERFORM D500-BUILD-RECS                              15580000
155900         END-IF                                                   15590000
156000                                                                  15600000
156100         PERFORM D600-MOVE-RECEIPT-DATA                           15610000
156200                                                                  15620000
156300     END-IF.                                                      15630000
156400                                                                  15640000
156500     PERFORM R600-READ-RECEIPTS.                                  15650000
156600                                                                  15660000
156700     IF ((AP105-PO-NBR = PV-PO-IN-PROCESS                         15670000
156800          AND AP105-STORE-NUMBER > PV-STORE-IN-PROCESS)           15680000
156900       OR (AP105-PO-NBR > PV-PO-IN-PROCESS))                      15690000
157000       OR RECEIPTS-EOF                                            15700000
157100         SET OUT-OF-RECEIPTS TO TRUE                              15710000
157200     END-IF.                                                      15720000
157300                                                                  15730000
157400 EJECT                                                            15740000
157500*----------------------------------------------------------------*15750000
157600*    FIGURES IN ALL THE ADJUSTMENTS MADE TO THE INVOICES AND     *15760000
157700*    RECEIVERS FOR A PO/STORE AND COMPARES THE TOTALS.  IF       *15770000
157800*    THE TOTALS DO NOT MATCH EXACTLY, A RECORD IS WRITTEN TO     *15780000
157900*    THE ERROR REPORT.                                           *15790000
158000*    CALLED FROM B200-PROCESS-POS                                *15800000
158100*----------------------------------------------------------------*15810000
158200 C400-COMPARE-TOTALS.                                             15820000
158300                                                                  15830000
158400                                                                  15840000
158500     COMPUTE ID-TOTAL-GROSS                                       15850000
158600         = ID-TOTAL-GROSS                                         15860000
158700         - ID-TOTAL-RI                                            15870000
158800         - ID-TOTAL-PC.                                           15880000
158900                                                                  15890000
159000     COMPUTE RD-TOTAL-REC-COST                                    15900000
159100         = RD-TOTAL-REC-COST                                      15910000
159200         + RD-TOTAL-CP                                            15920000
159300         - RD-TOTAL-DP                                            15930000
159400         - RD-TOTAL-DM.                                           15940000
159500                                                                  15950000
159600     IF RD-TOTAL-REC-COST NOT = ID-TOTAL-GROSS                    15960000
159700         MOVE SPACES                TO D1-COST-FIELDS             15970000
159800         MOVE RV-COST-MISMATCH      TO D1-ERROR-MSG               15980000
159900         MOVE RV-REC-TOT-HDR        TO D1-REC-TOT-HDR             15990000
160000         MOVE RD-TOTAL-REC-COST     TO D1-REC-TOT                 16000000
160100         MOVE RV-INVC-TOT-HDR       TO D1-INVC-TOT-HDR            16010000
160200         MOVE ID-TOTAL-GROSS        TO D1-INVC-TOT                16020000
160300         MOVE RV-VAR-HDR            TO D1-VAR-HDR                 16030000
160400         SUBTRACT ID-TOTAL-GROSS FROM RD-TOTAL-REC-COST           16040000
160500               GIVING PV-TOTAL-VARIANCE                           16050000
160600         IF PV-TOTAL-VARIANCE < 0                                 16060000
160700              COMPUTE PV-TOTAL-VARIANCE = PV-TOTAL-VARIANCE * -1  16070000
160800         END-IF                                                   16080000
160900         MOVE PV-TOTAL-VARIANCE     TO D1-VARIANCE                16090000
161000         MOVE PV-PO-9-X             TO D1-PO-NBR                  16100000
161100         MOVE PV-STORE-IN-PROCESS   TO D1-STORE-NBR               16110000
161200         PERFORM U400-INSERT-ERROR                                16120000
161300     END-IF.                                                      16130000
161400 EJECT                                                            16140000
161500*----------------------------------------------------------------*16150000
161600*    CONTROLS UPDATING OF THE DISTRIBUTIONS AND NON-INVOICED     *16160000
161700*    RECEIPTS.                                                   *16170000
161800*    CALLED FROM B200-PROCESS-POS                                *16180000
161900*                C300-PROCESS-RECEIPTS                           *16190000
162000*----------------------------------------------------------------*16200000
162100 C500-UPDT-RECEIPTS.                                              16210000
162200                                                                  16220000
162300                                                                  16230000
162400     IF ID-WRITE-OFF-INVC                                         16240000
162500        MOVE PC-WRITE-OFF          TO AP254-AP-PRC-CDE            16250000
162600     ELSE                                                         16260000
162700        MOVE PC-JOURNALIZED        TO AP254-AP-PRC-CDE            16270000
162800     END-IF.                                                      16280000
162900                                                                  16290000
163000     IF RD-RECEIPT-TYPE = 'RV'                                    16300000
163100                                                                  16310000
163200         MOVE 1                        TO AP254-RECORD-TYPE       16320000
163300         MOVE PV-PO-IN-PROCESS         TO AP254-RD-PURCHASE-ORDER 16330000
163400         MOVE RD-PO-LNE-NBR   (RD-SUB) TO AP254-RD-PO-LNE-NBR     16340000
163500         MOVE RD-REC-SEQ-NBR           TO AP254-RD-REC-SEQ-NBR    16350000
163600         MOVE RD-OPER-UNT-ID  (RD-SUB) TO AP254-RD-OPER-UNIT-ID   16360000
163700         MOVE RD-FCLTY-ID     (RD-SUB) TO AP254-RD-FACILITY-ID    16370000
163800         MOVE RD-STR-NBR               TO AP254-RD-STORE-NBR      16380000
163900         MOVE RD-STR-FCLTY-ID (RD-SUB) TO AP254-RD-STORE-FCLTY-ID 16390000
164000         MOVE RD-RECDIS-TMST  (RD-SUB) TO AP254-RD-CRE-TMST       16400000
164100         MOVE PV-RECDIS-AP-PRC-DTE     TO AP254-AP-PRC-DTE        16410000
164200         PERFORM U300-INSERT-RECEIV-UPDATE                        16420000
164300         INITIALIZE AP254-RECORD                                  16430000
164400                                                                  16440000
164500     ELSE                                                         16450000
164600                                                                  16460000
164700     IF RD-RECEIPT-TYPE = 'NR'                                    16470000
164800                                                                  16480000
164900         MOVE 3                        TO AP254-RECORD-TYPE       16490000
165000         MOVE PV-PO-IN-PROCESS         TO AP254-NR-PURCHASE-ORDER 16500000
165100         MOVE RD-PO-LNE-NBR   (RD-SUB) TO AP254-NR-PO-LNE-NBR     16510000
165200         MOVE RD-REC-SEQ-NBR           TO AP254-NR-NINVC-SEQ-NBR  16520000
165300                                                                  16530000
165400         PERFORM U300-INSERT-RECEIV-UPDATE                        16540000
165500         INITIALIZE AP254-RECORD                                  16550000
165600                                                                  16560000
165700     END-IF.                                                      16570000
165800 EJECT                                                            16580000
165900*----------------------------------------------------------------*16590000
166000*    GATHERS THE NECESSARY INVOICE DATA.                         *16600000
166100*    CALLED FROM C100-GET-DEFAULT-DATA                           *16610000
166200*----------------------------------------------------------------*16620000
166300 D100-PROCESS-EACH-INVOICE.                                       16630000
166400                                                                  16640000
166500     IF AP058-WRITE-OFF-INVC                                      16650000
166600         SET ID-WRITE-OFF-INVC TO TRUE                            16660000
166700     END-IF.                                                      16670000
166800                                                                  16680000
166900     IF  AP058-INVOICE-REC                                        16690000
167000         ADD AP058-INVOIC-GRO-COST-AMT  TO ID-TOTAL-GROSS         16700000
167100         ADD AP058-TOTAL-FREIGHT-CHRG TO ID-TOTAL-FREIGHT-CHARGES 16710000
167200         ADD AP058-TOTAL-MISC-CHRG      TO ID-TOTAL-MISC-CHARGES  16720000
167300         ADD AP058-TOTAL-DNP-CHRG       TO ID-TOTAL-DNP-CHARGES   16730000
167400         ADD AP058-TOTAL-VENDOR-FRT     TO ID-TOTAL-VENDOR-FRT    16740000
167500         ADD AP058-ADV-DISC-AMT         TO ID-TOTAL-ADV-DISC-AMT  16750000
167600         ADD AP058-COOP-ADV-ALLOW-AMT   TO ID-TOTAL-COOP-ADV-AMT  16760000
167700         ADD AP058-NEW-STR-ALLOW-AMT    TO ID-TOTAL-NEW-STR-AMT   16770000
167800         ADD AP058-MOS-DISC-ALLOW-AMT   TO ID-TOTAL-MOS-DISC-AMT  16780000
167900         ADD AP058-TRD-DISC-ALLOW-AMT   TO ID-TOTAL-TRD-DISC-AMT  16790000
168000         ADD AP058-ALW-DISC-ALLOW-AMT   TO ID-TOTAL-ALW-DISC-AMT  16800000
168100         ADD AP058-MISC-DISC-ALLOW-AMT  TO ID-TOTAL-MISC-DISC-AMT 16810000
168110         ADD AP058-BOTTLE-DEPOSIT-AMT   TO ID-TOTAL-BOTTLE-DEPOSIT16811074
168200         ADD AP058-CD-GIFT-WRAP-AMT     TO ID-CD-GIFT-WRAP-AMT    16820000
168300         ADD AP058-CD-HANDLING-AMT      TO ID-CD-HANDLING-AMT     16830000
168301                                                                  16830130
168310         IF  PURCHS-PO-TYP-CDE = 'CD'                             16831030
168311             ADD AP058-TOTAL-FREIGHT-CHRG                         16831130
168320                                     TO ID-TOTAL-DIRECT-SHIP-COST 16832030
168330             MOVE ZERO TO ID-TOTAL-FREIGHT-CHARGES                16833030
168340         END-IF                                                   16834030
168350                                                                  16835030
168400         IF  AP058-PYMT-DUE-DTE < ID-PYMT-DUE-DTE                 16840000
168500             MOVE AP058-PYMT-DUE-DTE    TO ID-PYMT-DUE-DTE        16850000
168600         END-IF                                                   16860000
168610                                                                  16861047
168700         IF  AP058-PYMT-HOLD-CDE = 'Y'                            16870000
168800             SET ID-DOC-HLD TO TRUE                               16880000
168900         ELSE                                                     16890000
169000             IF ID-DOC-HLD                                        16900000
169100                CONTINUE                                          16910000
169200             ELSE                                                 16920000
169300                 SET ID-NOT-ON-HLD TO TRUE                        16930000
169400             END-IF                                               16940000
169500         END-IF                                                   16950000
169510         IF PS-SEPHORA-AT-KOHLS                                   16951045
169600             EVALUATE TRUE                                        16960045
169601                 WHEN AP058-REMAINDER-INVC                        16960145
169603                     ADD AP058-INVOIC-GRO-COST-AMT TO             16960345
169604                                     ID-TOTAL-REPAY-SHTG-AMT      16960445
169605                     COMPUTE ID-SEPHORA-REPAY-DISC-PCT =          16960545
169606                                 AP058-TERM-DISC-PCT              16960650
169607                 WHEN AP058-MERCH-INVC                            16960745
169608                     ADD AP058-INVOIC-GRO-COST-AMT TO             16960845
169609                                     ID-TOTAL-SEPHORA-INVC-AMT    16960945
169610                     COMPUTE ID-SEPHORA-TERMS-DISC-PCT =          16961045
169611                                 AP058-TERM-DISC-PCT              16961150
169612             END-EVALUATE                                         16961245
169613         END-IF                                                   16961347
169620     END-IF.                                                      16962045
169700                                                                  16970000
169800     IF  AP058-PRICE-CLAIM-REC                                    16980000
169900         MOVE AP058-PC-GRO-COST-AMT TO ID-TOTAL-PC                16990000
170000         SUBTRACT AP058-PC-ADV-DISC-AMT FROM ID-TOTAL-ADV-DISC-AMT17000000
170100         SUBTRACT AP058-PC-COOP-ADV-ALLOW-AMT                     17010000
170200                                    FROM ID-TOTAL-COOP-ADV-AMT    17020000
170300         SUBTRACT AP058-PC-NEW-STR-ALLOW-AMT                      17030000
170400                                    FROM ID-TOTAL-NEW-STR-AMT     17040000
170500         SUBTRACT AP058-PC-MOS-DISC-ALLOW-AMT                     17050000
170600                                    FROM ID-TOTAL-MOS-DISC-AMT    17060000
170700         SUBTRACT AP058-PC-TRD-DISC-ALLOW-AMT                     17070000
170800                                    FROM ID-TOTAL-TRD-DISC-AMT    17080000
170900         SUBTRACT AP058-PC-ALW-DISC-ALLOW-AMT                     17090000
171000                                    FROM ID-TOTAL-ALW-DISC-AMT    17100000
171100         SUBTRACT AP058-PC-MISC-DISC-ALLOW-AMT                    17110000
171200                                    FROM ID-TOTAL-MISC-DISC-AMT   17120000
171300     END-IF.                                                      17130000
171400                                                                  17140000
171500     IF  AP058-REMAINDER-INV-REC                                  17150000
171600         MOVE AP058-RI-GRO-COST-AMT TO ID-TOTAL-RI                17160000
171700         SUBTRACT AP058-RI-ADV-DISC-AMT FROM ID-TOTAL-ADV-DISC-AMT17170000
171800         SUBTRACT AP058-RI-COOP-ADV-ALLOW-AMT                     17180000
171900             FROM ID-TOTAL-COOP-ADV-AMT                           17190000
172000         SUBTRACT AP058-RI-NEW-STR-ALLOW-AMT                      17200000
172100             FROM ID-TOTAL-NEW-STR-AMT                            17210000
172200         SUBTRACT AP058-RI-MOS-DISC-ALLOW-AMT                     17220000
172300             FROM ID-TOTAL-MOS-DISC-AMT                           17230000
172400         SUBTRACT AP058-RI-TRD-DISC-ALLOW-AMT                     17240000
172500             FROM ID-TOTAL-TRD-DISC-AMT                           17250000
172600         SUBTRACT AP058-RI-ALW-DISC-ALLOW-AMT                     17260000
172700             FROM ID-TOTAL-ALW-DISC-AMT                           17270000
172800         SUBTRACT AP058-RI-MISC-DISC-ALLOW-AMT                    17280000
172900             FROM ID-TOTAL-MISC-DISC-AMT                          17290000
173000     END-IF.                                                      17300000
173100                                                                  17310000
173200     IF  AP058-IMPORT-COST-INV-REC                                17320000
173300         ADD AP058-IC-ACTL-LANDED-COST-AMT                        17330000
173400               TO ID-ACTL-LANDED-COST-AMT                         17340000
173500         ADD AP058-IC-PRIVATE-LBL-LOAD-AMT                        17350000
173600               TO ID-PRIVATE-LBL-LOAD-AMT                         17360000
173700         ADD AP058-IC-FIRST-COST-LOAD-AMT                         17370000
173800               TO ID-FIRST-COST-LOAD-AMT                          17380000
173900     END-IF.                                                      17390000
174000                                                                  17400000
174100     PERFORM R300-READ-INVOICES.                                  17410000
174200                                                                  17420000
174300     IF ((AP058-PO-NBR = PV-PO-IN-PROCESS                         17430000
174400          AND AP058-STORE-NUMBER > PV-STORE-IN-PROCESS)           17440000
174500       OR (AP058-PO-NBR > PV-PO-IN-PROCESS))                      17450000
174600         SET OUT-OF-INVOICES  TO TRUE                             17460000
174700     END-IF.                                                      17470000
174800                                                                  17480000
174900 EJECT                                                            17490000
175000*----------------------------------------------------------------*17500000
175100*    CALCULATES THE TOTAL RETAIL COST FOR A RECEIVING.           *17510000
175200*    CALLED FROM C300-PROCESS-RECEIPTS                           *17520000
175300*----------------------------------------------------------------*17530000
175400 D200-COMPUTE-TOTRETL.                                            17540000
175500                                                                  17550000
175600                                                                  17560000
175700     IF AP105-PI-GP-QTY > +1                                      17570000
175800     AND AP105-PI-GP-RTL-AMT > ZERO                               17580000
175900         COMPUTE PV-TOTAL-RETAIL =                                17590000
176000             AP105-NR-NON-INVC-UNT-QTY *                          17600000
176100            (AP105-PI-GP-RTL-AMT / AP105-PI-GP-QTY)               17610000
176200     ELSE                                                         17620000
176300         COMPUTE PV-TOTAL-RETAIL =                                17630000
176400             AP105-NR-NON-INVC-UNT-QTY * AP105-PI-UNT-RTL-PR-AMT  17640000
176500     END-IF.                                                      17650000
176600 EJECT                                                            17660000
176700*----------------------------------------------------------------*17670000
176800*    FOR A PRICE CLAIM, SEARCH THE RECEIPTS TABLES FOR MATCHING  *17680000
176900*    PO LINES.  FOR EACH ONE FOUND, AN ADJUSTMENT JOURNAL ENTRY  *17690000
177000*    IS GENERATED.  IF NO MATCH IS FOUND, AN ERROR IS WRITTEN    *17700000
177100*    TO THE ERROR REPORT.                                        *17710000
177200*    CALLED FROM D700-BUILD-PRCCLM-TRANS                         *17720000
177300*----------------------------------------------------------------*17730000
177400 D300-MATCH-PO-LINE.                                              17740000
177500                                                                  17750000
177600                                                                  17760000
177700     MOVE PL-SKU-NBR (PL-SUB)       TO RD-SKU-NBR.                17770000
177800     MOVE PL-CLASS-NUMBER (PL-SUB)  TO RD-CLASS-NBR.              17780000
177900     MOVE PL-RECEIVER-SEQ-NUMBER (PL-SUB)                         17790000
178000                                    TO RD-REC-SEQ-NBR.            17800000
178100     MOVE PL-STR-NBR (PL-SUB)       TO RD-STR-NBR.                17810000
178200     MOVE PL-RECEIPT-TYPE (PL-SUB)  TO RD-RECEIPT-TYPE.           17820000
178300     MOVE PL-NR-NON-INVC-UNT-QTY (PL-SUB)                         17830000
178400                                    TO RD-TOTAL-QTY.              17840000
178500                                                                  17850000
178600     PERFORM J100-BUILD-PRCCLM-AJ.                                17860000
178700                                                                  17870000
178800                                                                  17880000
178900*----------------------------------------------------------------*17890000
179000*    IF NO PO LINE MATCH IS FOUND, AN ERROR IS WRITTEN TO THE    *17900000
179100*    ERROR REPORT.                                               *17910000
179200*    CALLED FROM D700-BUILD-PRCCLM-TRANS                         *17920000
179300*----------------------------------------------------------------*17930000
179400 D400-PREPARE-PRCCLM-ERROR.                                       17940000
179500                                                                  17950000
179600                                                                  17960000
179700     MOVE RV-PO-LINE-HDR      TO D1-PO-LINE-HDR.                  17970000
179800     MOVE PRCCLM-PO-LNE-NBR   TO D1-PO-LINE.                      17980000
179900     MOVE RV-INVC-NBR-HDR     TO D1-INVC-NBR-HDR.                 17990000
180000     MOVE PRCCLM-INVC-ID      TO D1-INVC-NBR.                     18000000
180100     MOVE RV-PRCCLM-AMT-HDR   TO D1-PRCCLM-AMT-HDR.               18010000
180200     MOVE PV-PRCCLM-TOTAL     TO D1-PRCCLM-AMT.                   18020000
180300     MOVE PV-PO-9-X           TO D1-PO-NBR.                       18030000
180400     MOVE PV-STORE-IN-PROCESS TO D1-STORE-NBR.                    18040000
180500     PERFORM U400-INSERT-ERROR.                                   18050000
180600 EJECT                                                            18060000
180700*----------------------------------------------------------------*18070000
180800*    THIS PARAGRAPH IS CALLED WHEN RECEIPTS COSTS AND QUANTITIES *18080000
180900*    HAVE BEEN TOTALLED FOR A SKU/CLASS/RECEIVER SEQUENCE/STORE/ *18090000
181000*    RECEIPT TYPE COMBINATION.                                   *18100000
181100*                                                                *18110000
181200*    A RECORD IS WRITTEN OUT TO THE RECEIVER UPDATE FILE FOR     *18120000
181300*    EACH NEW RECEIVER SEQUENCE NUMBER                           *18130000
181400*                                                                *18140000
181500*    A RECONCILIATION RESULTS RECORD IS WRITTEN FOR:             *18150000
181600*      - EACH SKU/CLASS/REC SEQ/STORE/RECEIPT TYPE COMBINATION   *18160000
181700*        WHEN THE TPOSTRR ENTRY WAS GENERATED THROUGH ONLINE     *18170000
181800*        RECONCILIATION PROCESSING                               *18180000
181900*                                                                *18190000
182000*   AN ADJUSTMENT JOURNAL TRANSACTIONS IS WRITTEN FOR:           *18200000
182100*      - EACH SKU/CLASS/REC SEQ/STORE/RECEIPT TYPE COMBINATION   *18210000
182200*      - A TOLERANCE DIFFERENCE ON THE TPOSTRR TABLE WHICH IS    *18220000
182300*        PRORATED ACROSS RELATED SKU/CLASS/REC SEQ/STORE/RECEIPT *18230000
182400*        TYPE COMBINATIONS                                       *18240000
182500*      - FREIGHT CHARGES GREATER THAN ZERO WHICH ARE PRORATED    *18250000
182600*        ACROSS RELATED SKU/CLASS/REC SEQ/STORE/RECEIPT TYPE     *18260000
182700*        COMBINATIONS                                            *18270000
182800*      - DO NOT PAY CHARGES GREATER THAN ZERO WHICH ARE          *18280000
182900*        PRORATED ACROSS RELATED SKU/CLASS/REC SEQ/STORE/RECEIPT *18290000
183000*        TYPE COMBINATIONS                                       *18300000
183100*                                                                *18310000
183200*    CALLED FROM B200-PROCESS-POS                                *18320000
183300*                C300-PROCESS-RECEIPTS                           *18330000
183400*----------------------------------------------------------------*18340000
183500 D500-BUILD-RECS.                                                 18350000
183600                                                                  18360000
183700                                                                  18370000
183800     IF ID-WRITE-OFF-INVC                                         18380000
183900        MOVE PC-WRITE-OFF          TO AP254-AP-PRC-CDE            18390000
184000     ELSE                                                         18400000
184100        MOVE PC-JOURNALIZED        TO AP254-AP-PRC-CDE            18410000
184200     END-IF.                                                      18420000
184300                                                                  18430000
184400     MOVE 2                        TO AP254-RECORD-TYPE.          18440000
184500     MOVE PV-PO-IN-PROCESS         TO AP254-RC-PURCHASE-ORDER.    18450000
184600     MOVE RD-REC-SEQ-NBR           TO AP254-RC-RECVR-SEQ-NBR.     18460000
184700     MOVE RD-RECEIV-CRE-TMST       TO AP254-RC-CRE-TMST.          18470000
184800     MOVE PV-RECDIS-AP-PRC-DTE     TO AP254-AP-PRC-DTE.           18480000
184900                                                                  18490000
185000*** IF NOT INVOICED BY BULK OR BY STORE THAN IT WILL BE           18500000
185100*** INVOICED BY DC.                                               18510000
185200                                                                  18520000
185300     IF INVOICED-BY-BULK                                          18530000
185400         SET AP254-BULK-PO    TO TRUE                             18540000
185500     ELSE                                                         18550000
185600         IF INVOICED-BY-STORE                                     18560000
185700           SET AP254-STORE-PO TO TRUE                             18570000
185800         ELSE                                                     18580000
185900           SET AP254-DC-PO    TO TRUE                             18590000
186000         END-IF                                                   18600000
186100     END-IF.                                                      18610000
186200                                                                  18620000
186300     IF RD-RECEIVER                                               18630000
186400         PERFORM U300-INSERT-RECEIV-UPDATE                        18640000
186500     END-IF.                                                      18650000
186600                                                                  18660000
186700     INITIALIZE AP254-RECORD.                                     18670000
186800                                                                  18680000
186900     IF POSTRR-CRE-PRC-CDE = PC-ONLINE-MODE OR PC-AUTO-MODE       18690000
187000         PERFORM M100-BUILD-RCVR-RR                               18700000
187100     END-IF.                                                      18710000
187200                                                                  18720000
187300     IF POSTRR-TOLR-ADJ-AMT NOT = ZERO                            18730000
187400         PERFORM J400-BUILD-TOLR-ADJ-AJ                           18740000
187500     END-IF.                                                      18750000
187600                                                                  18760000
187700     IF RD-RECEIVER                                               18770000
187800         PERFORM J200-BUILD-RCVR-AJ                               18780000
187900     ELSE                                                         18790000
188000         PERFORM J300-BUILD-NR-AJ                                 18800000
188100     END-IF.                                                      18810000
188200                                                                  18820000
188300     IF PV-VEND-FRT-ADJ-AMT NOT = ZERO                            18830000
188400         PERFORM J500-BUILD-FREIGHT-AJ                            18840000
188500     END-IF.                                                      18850000
188600                                                                  18860000
188700     IF ID-TOTAL-DNP-CHARGES NOT = ZERO                           18870000
188800         PERFORM J600-BUILD-DNP-AJ                                18880000
188900     END-IF.                                                      18890000
189000                                                                  18900000
189100     IF ID-ACTL-LANDED-COST-AMT NOT = ZERO                        18910000
189200        PERFORM K960-BUILD-ACTL-LND-CST-ADJ                       18920000
189300     END-IF.                                                      18930000
189400                                                                  18940000
189500     IF ID-PRIVATE-LBL-LOAD-AMT NOT = ZERO                        18950000
189600     AND PURCHS-DEPT-NBR NOT = '836'                              18960011
189610     AND PURCHS-DEPT-NBR NOT = '830'                              18961011
189700        PERFORM K970-BUILD-PRVT-LBL-LOAD-ADJ                      18970000
189800     END-IF.                                                      18980000
189900                                                                  18990000
190000     IF ID-FIRST-COST-LOAD-AMT NOT = ZERO                         19000000
190100     AND PURCHS-DEPT-NBR NOT = '836'                              19010011
190110     AND PURCHS-DEPT-NBR NOT = '830'                              19011011
190200        PERFORM K980-BUILD-FIRST-COST-LOAD-ADJ                    19020000
190300     END-IF.                                                      19030000
190400                                                                  19040000
190500     INITIALIZE RD-CLASS-SEQ-STR-DATA.                            19050000
190600 EJECT                                                            19060000
190700*----------------------------------------------------------------*19070000
190800*    LOADS THE RECEIPT INFORMATION INTO WORKING STORAGE.         *19080000
190900*    CALLED FROM C300-PROCESS-RECEIPTS                           *19090000
191000*----------------------------------------------------------------*19100000
191100 D600-MOVE-RECEIPT-DATA.                                          19110000
191200                                                                  19120000
191300                                                                  19130000
191400     MOVE AP105-SKU-NBR             TO RD-SKU-NBR.                19140000
191500     MOVE AP105-CLASS-NUMBER        TO RD-CLASS-NBR.              19150000
191600     MOVE AP105-RECEIVER-SEQ-NUMBER TO RD-REC-SEQ-NBR.            19160000
191700     MOVE AP105-STR-NBR             TO RD-STR-NBR                 19170000
191800                                       RD-LOC-NBR.                19180000
191900     MOVE AP105-RV-OPER-UNT-TYP-CDE TO RD-OPER-UNT-TYP-CDE.       19190000
192000     MOVE AP105-RECEIPT-TYPE        TO RD-RECEIPT-TYPE.           19200000
192100     MOVE AP105-NR-NON-INVC-UNT-QTY TO RD-TOTAL-QTY.              19210000
192200     ADD  AP105-TOTAL-COST          TO RD-TOTAL-COST.             19220000
192300     MOVE PV-TOTAL-RETAIL           TO RD-TOTAL-RETAIL            19230000
192400                                       RD-TOTAL-REC-RETAIL.       19240000
192500     ADD  AP105-EXTD-LOAD-COST      TO RD-TOTAL-LOAD-COST.        19250000
192600                                                                  19260000
192700     MOVE AP105-NR-REC-TMST         TO RD-REC-TMST.               19270000
192800     MOVE AP105-RV-VERFYD-TMST      TO RD-VERFYD-TMST.            19280000
192900     MOVE AP105-RV-CRE-TMST         TO RD-RECEIV-CRE-TMST.        19290000
193000     MOVE AP105-NR-ORIG-DISC-PCT    TO RD-ORIG-DISC-PCT.          19300000
193100                                                                  19310000
193200     MOVE 1 TO RD-SUB-MAX                                         19320000
193300               RD-SUB.                                            19330000
193400                                                                  19340000
193500     MOVE AP105-NR-PO-LNE-NBR   TO RD-PO-LNE-NBR   (RD-SUB).      19350000
193600     MOVE AP105-RD-OPER-UNT-ID  TO RD-OPER-UNT-ID  (RD-SUB).      19360000
193700     MOVE AP105-RD-FCLTY-ID     TO RD-FCLTY-ID     (RD-SUB).      19370000
193800     MOVE AP105-RD-STR-FCLTY-ID TO RD-STR-FCLTY-ID (RD-SUB).      19380000
193900     MOVE AP105-RD-CRE-TMST     TO RD-RECDIS-TMST  (RD-SUB).      19390000
194000 EJECT                                                            19400000
194100*----------------------------------------------------------------*19410000
194200*    IF A PRICE CLAIM IS A DEBIT OR CREDIT TO THE ADJUSTMENT     *19420000
194300*    JOURNAL, WRITE OUT A RECONCILIATION RESULTS RECORD AND      *19430000
194400*    FIND MATCHING PO LINES ON THE RECEIVER TABLES FOR ADJUSTMENT*19440000
194500*    JOURNAL TRANSACTIONS.                                       *19450000
194600*    CALLED FROM C200-PROCESS-PRCCLMS                            *19460000
194700*----------------------------------------------------------------*19470000
194800 D700-BUILD-PRCCLM-TRANS.                                         19480000
194900                                                                  19490000
195000                                                                  19500000
195100     PERFORM M200-BUILD-PRCCLM-RR.                                19510000
195200                                                                  19520000
195300     IF PRCCLM-PO-LNE-NBR > PL-PO-LINE-NUMBER                     19530000
195400                                                                  19540000
195500*  IF AT END OF PO LINES FILE OR PAST MATCHING RECORD, SET        19550000
195600*  PO LINES EOF SWITCH.                                           19560000
195700         IF PO-LINES-EOF                                          19570000
195800           OR (AP100-PO-NBR = PV-PO-IN-PROCESS                    19580000
195900               AND AP100-STORE-NUMBER = PV-STORE-IN-PROCESS       19590000
196000               AND AP100-PO-LINE-NUMBER > PRCCLM-PO-LNE-NBR)      19600000
196100           OR (AP100-PO-NBR = PV-PO-IN-PROCESS                    19610000
196200               AND AP100-STORE-NUMBER > PV-STORE-IN-PROCESS)      19620000
196300           OR (AP100-PO-NBR > PV-PO-IN-PROCESS)                   19630000
196400             SET OUT-OF-PO-LINES TO TRUE                          19640000
196500                                                                  19650000
196600         ELSE                                                     19660000
196700             SET MORE-PO-LINES TO TRUE                            19670000
196800             MOVE ZERO TO PL-RECS-LOADED                          19680000
196900                                                                  19690000
197000*  READ UNTIL A MATCH IS FOUND OR PAST MATCHING RECORD            19700000
197100             PERFORM R400-READ-PO-LINES                           19710000
197200               UNTIL (AP100-PO-NBR = PV-PO-IN-PROCESS             19720000
197300                    AND AP100-STORE-NUMBER = PV-STORE-IN-PROCESS  19730000
197400                    AND AP100-PO-LINE-NUMBER >= PRCCLM-PO-LNE-NBR)19740000
197500                  OR (AP100-PO-NBR = PV-PO-IN-PROCESS             19750000
197600                    AND AP100-STORE-NUMBER > PV-STORE-IN-PROCESS) 19760000
197700                  OR (AP100-PO-NBR > PV-PO-IN-PROCESS)            19770000
197800                  OR PO-LINES-EOF                                 19780000
197900                                                                  19790000
198000*  IF A MATCH IS FOUND, PROCESS ALL MATCHING RECORDS              19800000
198100             IF (AP100-PO-NBR            = PV-PO-IN-PROCESS       19810000
198200                AND AP100-STORE-NUMBER   = PV-STORE-IN-PROCESS    19820000
198300                AND AP100-PO-LINE-NUMBER = PRCCLM-PO-LNE-NBR)     19830000
198400                                                                  19840000
198500                 PERFORM D750-LOAD-PO-LINES-TABLE                 19850000
198600                   UNTIL (AP100-PO-NBR = PV-PO-IN-PROCESS         19860000
198700                        AND AP100-STORE-NUMBER                    19870000
198800                                         = PV-STORE-IN-PROCESS    19880000
198900                        AND AP100-PO-LINE-NUMBER                  19890000
199000                                         > PRCCLM-PO-LNE-NBR)     19900000
199100                      OR (AP100-PO-NBR = PV-PO-IN-PROCESS         19910000
199200                        AND AP100-STORE-NUMBER                    19920000
199300                                         > PV-STORE-IN-PROCESS)   19930000
199400                      OR (AP100-PO-NBR >         PV-PO-IN-PROCESS)19940000
199500                      OR PO-LINES-EOF                             19950000
199600                                                                  19960000
199700                 IF PL-RECS-LOADED = ZERO                         19970000
199800                     SET OUT-OF-PO-LINES TO TRUE                  19980000
199900                 END-IF                                           19990000
200000                                                                  20000000
200100             END-IF                                               20010000
200200         END-IF                                                   20020000
200300                                                                  20030000
200400         MOVE PRCCLM-PO-LNE-NBR TO PL-PO-LINE-NUMBER              20040000
200500     END-IF.                                                      20050000
200600                                                                  20060000
200700     IF OUT-OF-PO-LINES                                           20070000
200800         MOVE SPACES TO D1-COST-FIELDS                            20080000
200900         MOVE RV-NO-PRCCLM-REC TO D1-ERROR-MSG                    20090000
201000         PERFORM D400-PREPARE-PRCCLM-ERROR                        20100000
201100     ELSE                                                         20110000
201200         SET PROCESS-PO-LINES TO TRUE                             20120000
201300         PERFORM D300-MATCH-PO-LINE                               20130000
201400             VARYING PL-SUB FROM 1 BY 1                           20140000
201500             UNTIL PL-SUB > PL-RECS-LOADED                        20150000
201600               OR STOP-PROCESSING-PO-LINES                        20160000
201700     END-IF.                                                      20170000
201800                                                                  20180000
201900*----------------------------------------------------------------*20190000
202000* IF PV-PRCCLM-TOTAL IS GREATER THAN ZERO (ACTUAL CHECK IS FOR   *20200000
202100* 0.10 BECAUSE OF ROUNDING AND A DROPPED DECIMAL) ONCE ALL       *20210000
202200* RECEIVERS HAVE BEEN MATCHED ON PO LINE, WE ARE MISSING A       *20220000
202300* RECEIVER MATCH AND AN ERROR MESSAGE IS GENERATED.              *20230000
202400*----------------------------------------------------------------*20240000
202500     IF PV-PRCCLM-TOTAL > 0.1                                     20250000
202600         MOVE SPACES TO D1-COST-FIELDS                            20260000
202700         MOVE RV-MISSING-PRCCLM TO D1-ERROR-MSG                   20270000
202800         PERFORM D400-PREPARE-PRCCLM-ERROR                        20280000
202900     END-IF.                                                      20290000
203000 EJECT                                                            20300000
203100*----------------------------------------------------------------*20310000
203200*    ALL PO/STORE PO LINES RECORDS FOR A PO, STORE, PO LINE      *20320000
203300*    NUMBER ARE LOADED INTO THE PL-RECEIPT-DATA TABLE.  THIS IS  *20330000
203400*    DONE BECAUSE THERE CAN BE MULTIPLE PRICE CLAIM ENTRIES FOR  *20340000
203500*    A GIVEN PO, STORE, PO LINE NUMBER.                          *20350000
203600*    CALLED FROM D700-BUILD-PRCCLM-TRANS.                        *20360000
203700*----------------------------------------------------------------*20370000
203800 D750-LOAD-PO-LINES-TABLE.                                        20380000
203900                                                                  20390000
204000                                                                  20400000
204100     IF PL-RECS-LOADED = PL-SUB-LIMIT                             20410000
204200         MOVE 'D750-LOAD-PO-LINES-TABLE' TO AA-PARAGRAPH-NAME     20420000
204300         MOVE 'MORE THAN 7500 PO LINES FOR A PO/STORE'            20430000
204400                                         TO AA-MESSAGE            20440000
204500         SET AC-PO-LINES-OVERFLOW        TO TRUE                  20450000
204600*        DISPLAY 'PO =' PV-PO-9-X                                 20460061
204700         PERFORM Z999-ABEND                                       20470000
204800     END-IF.                                                      20480000
204900                                                                  20490000
205000     ADD +1 TO PL-RECS-LOADED.                                    20500000
205100     MOVE AP100-SKU-NBR       TO PL-SKU-NBR (PL-RECS-LOADED).     20510000
205200     MOVE AP100-CLASS-NUMBER  TO PL-CLASS-NUMBER (PL-RECS-LOADED).20520000
205300     MOVE AP100-RECEIVER-SEQ-NUMBER                               20530000
205400                       TO PL-RECEIVER-SEQ-NUMBER (PL-RECS-LOADED).20540000
205500     MOVE AP100-STR-NBR       TO PL-STR-NBR (PL-RECS-LOADED).     20550000
205600     MOVE AP100-RECEIPT-TYPE  TO PL-RECEIPT-TYPE (PL-RECS-LOADED).20560000
205700     MOVE AP100-NR-NON-INVC-UNT-QTY                               20570000
205800                       TO PL-NR-NON-INVC-UNT-QTY (PL-RECS-LOADED).20580000
205900                                                                  20590000
206000     PERFORM R400-READ-PO-LINES.                                  20600000
206100 EJECT                                                            20610000
206200*----------------------------------------------------------------*20620000
206300*    EVERY NTH RECORD (IE: INITIAL SETTING 25)  PERFORM A COMMIT *20630002
206400*    TO REDUCE THE LOG WRITE I/O TIMES BY REDUCING THE COMMIT    *20640001
206500*    FREQUENCY TO HELP THIS PROGRAM RUN FASTER PER DBA SUGGESTION*20650001
206600*NOTE:                                                           *20660003
206700*    THE FIELD PC-HOW-OFTEN-TO-COMMIT HAS THE VALUE SET TO 25.   *20670003
206800*    THIS FIELD CAN BE UPDATED IN THE FUTURE TO CONTROL HOW      *20680003
206900*    MANY POS PROCESSED BEFORE PERFORMING A COMMIT.              *20690003
207000*    CALLED FROM B200-PROCESS-POS                                *20700001
207100*----------------------------------------------------------------*20710000
207200 D800-DETERMINE-COMMIT.                                           20720001
207300                                                                  20730001
207400                                                                  20740001
207500     MOVE ZERO TO PV-NTH-MULTIPLE                                 20750001
207600                  PV-NTH-REMAINDER.                               20760001
207700                                                                  20770001
207800     DIVIDE    PV-PO-COUNT                                        20780001
207900        BY        PC-HOW-OFTEN-TO-COMMIT                          20790001
208000        GIVING    PV-NTH-MULTIPLE                                 20800001
208100        REMAINDER PV-NTH-REMAINDER.                               20810001
208200                                                                  20820001
208300     IF PV-NTH-REMAINDER = ZERO                                   20830001
208400        PERFORM Z100-COMMIT                                       20840001
208500     END-IF.                                                      20850001
208600                                                                  20860001
208700                                                                  20870001
208800 EJECT                                                            20880001
208900*----------------------------------------------------------------*20890001
209000*    PREPARES THE ADJUSTMENT JOURNAL FIELDS UNIQUE TO PRICE CLAIM*20900001
209100*    ENTRIES.                                                    *20910001
209200*    CALLED FROM D300-MATCH-PO-LINE                              *20920001
209300*----------------------------------------------------------------*20930001
209400 J100-BUILD-PRCCLM-AJ.                                            20940001
209500                                                                  20950001
209600                                                                  20960001
209700     EVALUATE TRUE                                                20970000
209800         WHEN PRCCLM-DOC-TYP-CDE = PC-CREDIT-AJ                   20980000
209900             MOVE '37'               TO AP045-AP-TRN-CDE          20990000
210000         WHEN PRCCLM-DOC-TYP-CDE = PC-DEBIT-AJ                    21000000
210100             MOVE '36'               TO AP045-AP-TRN-CDE          21010000
210200     END-EVALUATE.                                                21020000
210300                                                                  21030000
210400     PERFORM J950-CREATE-ADJ-DOC-NBR.                             21040000
210500                                                                  21050000
210600     IF RD-NON-INVC-RECEIPT                                       21060000
210700         IF RD-STR-NBR = 0                                        21070000
210800            MOVE 85                  TO AP045-STR-NBR             21080000
210900         ELSE                                                     21090000
211000            MOVE RD-STR-NBR          TO AP045-STR-NBR             21100000
211100         END-IF                                                   21110000
211200     ELSE                                                         21120000
211300         MOVE RD-STR-NBR             TO AP045-STR-NBR             21130000
211400     END-IF.                                                      21140000
211500                                                                  21150000
211600     PERFORM S100-SELECT-TTRNCDE-DATA.                            21160000
211700                                                                  21170000
211800     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        21180000
211900     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       21190000
212000     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        21200000
212100     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      21210000
212200     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        21220000
212300     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           21230000
212400     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             21240000
212500     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            21250000
212600                                                                  21260000
212700*----------------------------------------------------------------*21270000
212800* IN THIS CASE, THE TOTAL AMOUNT IS NOT PRORATED.  THE TOTAL     *21280000
212900* AMOUNT SHOULD BE MET BY THE SUM OF EACH RECEIVER'S QUANTITY    *21290000
213000* TIMES THE CALCULATED PRICE CLAIM DIFFERENCE AMOUNT.  IF THE    *21300000
213100* CALCULATED AMOUNT IS GREATER, THAT MEANS THE RECEIVER QUANTITY *21310000
213200* IS GREATER THAN THE QUANTITY THE PRICE CLAIM WAS GENERATED FOR.*21320000
213300* IF THIS IS THE CASE, USE THE REMAINING PRICE CLAIM AMOUNT AND  *21330000
213400* STOP GENERATING PRICE CLAIM TRANSACTIONS.  IF THERE IS AN      *21340000
213500* AMOUNT LEFT IN PV-PRCCLM-TOTAL ONCE ALL RECEIVERS HAVE BEEN    *21350000
213600* MATCHED ON PO LINE, THIS MEANS THERE IS A MISSING PO LINE      *21360000
213700* MATCH AND AN ERROR IS WRITTEN TO THE ERROR REPORT.             *21370000
213800*----------------------------------------------------------------*21380000
213900     COMPUTE AP045-GRO-COST-AMT = (RD-TOTAL-QTY *                 21390000
214000                   PV-PRCCLM-DIFFERENCE) + .005.                  21400000
214100                                                                  21410000
214200     IF AP045-GRO-COST-AMT > PV-PRCCLM-TOTAL                      21420000
214300         MOVE PV-PRCCLM-TOTAL TO AP045-GRO-COST-AMT               21430000
214400         MOVE ZERO            TO PV-PRCCLM-TOTAL                  21440000
214500         SET STOP-PROCESSING-PO-LINES TO TRUE                     21450000
214600     ELSE                                                         21460000
214700         SUBTRACT AP045-GRO-COST-AMT FROM PV-PRCCLM-TOTAL         21470000
214800     END-IF.                                                      21480000
214900                                                                  21490000
215000     MOVE AP045-GRO-COST-AMT         TO PV-GRO-COST-AMT.          21500000
215100     MOVE AP045-AP-TRN-CDE           TO PV-AP-TRN-CDE.            21510000
215200     MOVE AP045-STR-NBR              TO PV-STR-NBR.               21520000
215300     MOVE AP045-PSTG-TYP-CDE         TO PV-PSTG-TYP-CDE.          21530000
215400     MOVE AP045-TRN-TYP-CDE          TO PV-TRN-TYP-CDE.           21540000
215500                                                                  21550000
215600     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        21560000
215700                                                                  21570000
215800     MOVE ZERO                       TO AP045-RETL-AMT            21580000
215900                                        AP045-FRGT-AMT            21590000
216000                                        AP045-MISC-CHRG-AMT       21600000
216100                                        AP045-NW-STR-DISC-PCT     21610000
216200                                        AP045-TRD-DISC-PCT        21620000
216300                                        AP045-DTL-NW-STR-DISC-AMT 21630000
216400                                        AP045-DTL-TRD-DISC-AMT    21640000
216500                                        AP045-TERM-DISC-PCT       21650000
216600                                        AP045-DTL-TERM-DISC-AMT   21660000
216700                                        AP045-MOS-DISC-PCT        21670000
216800                                        AP045-DTL-MOS-DISC-AMT.   21680000
216900                                                                  21690000
217000     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     21700000
217100                                                                  21710000
217200     IF AP045-GRO-COST-AMT > ZERO                                 21720000
217300         PERFORM L200-FILL-AJ-FIELDS                              21730000
217400     END-IF.                                                      21740000
217500 EJECT                                                            21750000
217600*----------------------------------------------------------------*21760000
217700*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO RECEIVING TRANSACTIONS  *21770000
217800*    ARE PREPARED FOR EACH GROUPING OF SKU/CLASS/RECEIVER SEQ/   *21780000
217900*    STORE.  DESCRIPTIONS OF AMOUNT FIELDS:                      *21790000
218000*        TR-TOTRETL CONTAINS CALCULATED RETAIL AMOUNT            *21800000
218100*        AP045-GRO-COST-AMT CONTAINS COST TIMES QUANTITY         *21810000
218200*                                                                *21820000
218300*    CALLED FROM D500-BUILD-RECS                                 *21830000
218400*----------------------------------------------------------------*21840000
218500 J200-BUILD-RCVR-AJ.                                              21850000
218600                                                                  21860000
218700     MOVE '01'                       TO AP045-AP-TRN-CDE.         21870000
218800                                                                  21880000
218900     PERFORM J950-CREATE-ADJ-DOC-NBR.                             21890000
219000                                                                  21900000
219100     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            21910000
219200                                                                  21920000
219300     PERFORM S100-SELECT-TTRNCDE-DATA.                            21930000
219400                                                                  21940000
219500     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        21950000
219600     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       21960000
219700     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        21970000
219800     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      21980000
219900     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        21990000
220000     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           22000000
220100     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             22010000
220200     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            22020000
220300                                                                  22030000
220400     MOVE RD-TOTAL-RETAIL            TO AP045-RETL-AMT.           22040000
220500     COMPUTE AP045-GRO-COST-AMT = RD-TOTAL-COST + .005.           22050000
220600                                                                  22060000
220700     MOVE SPACE TO AP045-GL-ACCT-NBR.                             22070000
220800                                                                  22080000
220900     MOVE ZERO TO AP045-TERM-DISC-PCT,    AP045-NW-STR-DISC-PCT,  22090000
221000                   AP045-TRD-DISC-PCT,           AP045-FRGT-AMT,  22100000
221100                   AP045-MISC-CHRG-AMT, AP045-DTL-TERM-DISC-AMT,  22110000
221200                   AP045-DTL-NW-STR-DISC-AMT, AP045-MOS-DISC-PCT, 22120000
221300                   AP045-DTL-TRD-DISC-AMT, AP045-DTL-MOS-DISC-AMT.22130000
221400                                                                  22140000
221500     MOVE PV-CURR-DB2-DATE TO AP045-INV-CUTOFF-DTE.               22150000
221600     PERFORM L200-FILL-AJ-FIELDS.                                 22160000
221700                                                                  22170000
221800     PERFORM S300-CHECK-FOR-EARNED-NSD.                           22180000
221900     IF  NSD-EARNED                                               22190000
222000         PERFORM J280-BUILD-AUTO-NSD-AJ                           22200000
222100     END-IF.                                                      22210000
222200                                                                  22220000
222300*----------------------------------------------------------------*22230000
222400* APPLY PRIVATE LABEL SWITCH IS SET WHEN PO INFO IS SELECTED.    *22240000
222500* SWITCH IS BASED ON THE OTB PERIOD, PO TYPE AND DERIVED LABEL   *22250000
222600* TYPE CODE.                                                     *22260000
222700*----------------------------------------------------------------*22270000
222800*                                                                 22280000
222900     IF  APPLY-PRVT-LBL-LOAD                                      22290000
223000         PERFORM J290-BUILD-PRVT-LBL-LOAD-AJ                      22300000
223100     END-IF.                                                      22310000
223200                                                                  22320000
223300*    PERFORM J250-BUILD-DISCOUNT-ON-INV-AJ.                       22330039
223310     IF PS-SEPHORA-AT-KOHLS                                       22331054
223320         CONTINUE                                                 22332054
223321     ELSE                                                         22332154
223322         PERFORM J250-BUILD-DISCOUNT-ON-INV-AJ                    22332254
223330     END-IF.                                                      22333039
223400                                                                  22340000
223500     PERFORM J275-BUILD-INV-CHARGES-AJ.                           22350000
223600     IF ID-CD-HANDLING-AMT NOT = ZERO                             22360000
223700        PERFORM K300-BUILD-HANDLING-CHRG-AJ                       22370000
223800     END-IF.                                                      22380000
223900                                                                  22390000
224000     IF ID-TOTAL-ADV-DISC-AMT NOT = ZERO                          22400000
224100        PERFORM J900-BUILD-BROADCAST-ADJ                          22410000
224200     END-IF.                                                      22420000
224300                                                                  22430000
224400     IF ID-TOTAL-NEW-STR-AMT NOT = ZERO                           22440000
224500        PERFORM K500-BUILD-NEW-STR-ADJ                            22450000
224600     END-IF.                                                      22460000
224700                                                                  22470000
224800     IF ID-TOTAL-MOS-DISC-AMT NOT = ZERO                          22480000
224900        PERFORM K600-BUILD-MOS-DISC-ADJ                           22490000
225000     END-IF.                                                      22500000
225100                                                                  22510000
225200     IF ID-TOTAL-TRD-DISC-AMT NOT = ZERO                          22520000
225300        PERFORM K700-BUILD-TRD-DISC-ADJ                           22530000
225400     END-IF.                                                      22540000
225500                                                                  22550000
225600     IF ID-TOTAL-ALW-DISC-AMT NOT = ZERO                          22560000
225700        PERFORM K800-BUILD-ALW-DISC-ADJ                           22570000
225800     END-IF.                                                      22580000
225900                                                                  22590000
226000     IF ID-TOTAL-MISC-DISC-AMT NOT = ZERO                         22600000
226100        PERFORM K900-BUILD-MISC-DISC-ADJ                          22610000
226200     END-IF.                                                      22620000
226300 EJECT                                                            22630000
226400*----------------------------------------------------------------*22640000
226500*  THIS PARAGRAPH BUILDS DISCOUNT TRANSACTIONS ON THE CALCULATED *22650000
226600*  TOTAL COST FOR EACH GROUPING OF SKU/CLASS/RECEIVER SEQ/STORE. *22660000
226700*                                                                *22670000
226800*    CALLED FROM J200-BUILD-RCVR-AJ                              *22680000
226900*                J300-BUILD-NR-AJ.                               *22690000
227000*----------------------------------------------------------------*22700000
227100 J250-BUILD-DISCOUNT-ON-INV-AJ.                                   22710000
227200                                                                  22720000
227300                                                                  22730000
227400     MOVE '28'                       TO AP045-AP-TRN-CDE.         22740000
227500                                                                  22750000
227600     PERFORM J950-CREATE-ADJ-DOC-NBR.                             22760000
227700                                                                  22770000
227800     IF RD-NON-INVC-RECEIPT                                       22780000
227900         IF RD-STR-NBR = 0                                        22790000
228000            MOVE 85                  TO AP045-STR-NBR             22800000
228100         ELSE                                                     22810000
228200            MOVE RD-STR-NBR          TO AP045-STR-NBR             22820000
228300         END-IF                                                   22830000
228400     ELSE                                                         22840000
228500         MOVE RD-STR-NBR             TO AP045-STR-NBR             22850000
228600     END-IF.                                                      22860000
228700                                                                  22870000
228800     PERFORM S100-SELECT-TTRNCDE-DATA.                            22880000
228900                                                                  22890000
229000     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        22900000
229100     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       22910000
229200     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        22920000
229300     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      22930000
229400     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        22940000
229500     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           22950000
229600     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             22960000
229700     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            22970000
229800                                                                  22980000
229900     MOVE SPACE TO AP045-GL-ACCT-NBR.                             22990000
230000                                                                  23000000
230100     MOVE ZERO TO AP045-TERM-DISC-PCT,    AP045-NW-STR-DISC-PCT,  23010000
230200                   AP045-TRD-DISC-PCT,           AP045-FRGT-AMT,  23020000
230300                   AP045-MISC-CHRG-AMT, AP045-DTL-TERM-DISC-AMT,  23030000
230400                   AP045-DTL-NW-STR-DISC-AMT,    AP045-RETL-AMT,  23040000
230500                   AP045-DTL-TRD-DISC-AMT,   AP045-GRO-COST-AMT,  23050000
230600                   AP045-MOS-DISC-PCT,  AP045-DTL-MOS-DISC-AMT.   23060000
230700                                                                  23070000
230800     MOVE PV-CURR-DB2-DATE TO AP045-INV-CUTOFF-DTE.               23080000
230900                                                                  23090000
231000     MOVE ID-DISCOUNT-PCT            TO PV-WORK-DISCOUNT-PCT.     23100000
231100     MOVE AP045-TRN-TYP-CDE          TO PV-TRN-TYP-CDE.           23110000
231200     MOVE AP045-PSTG-TYP-CDE         TO PV-PSTG-TYP-CDE.          23120000
231300     COMPUTE PV-GRO-COST-AMT = RD-TOTAL-COST + .005.              23130000
231400     MOVE AP045-STR-NBR              TO PV-STR-NBR.               23140000
231500     MOVE AP045-AP-TRN-CDE           TO PV-AP-TRN-CDE.            23150000
231600     PERFORM K400-VERIFY-DISCOUNT-AMT.                            23160000
231700     COMPUTE AP045-TERM-DISC-PCT     = PV-WORK-DISCOUNT-PCT * .01.23170000
231800     IF OUT-OF-RECEIPTS                                           23180000
231900        MOVE PV-TOTAL-DISC-AMT       TO AP045-DTL-TERM-DISC-AMT   23190000
232000        MOVE ZERO                    TO PV-TOTAL-DISC-AMT         23200000
232100                                        PV-WORK-DISCOUNT-PCT      23210000
232200     ELSE                                                         23220000
232300        COMPUTE AP045-DTL-TERM-DISC-AMT = (AP045-TERM-DISC-PCT *  23230000
232400                                          RD-TOTAL-COST) + .005   23240000
232500     END-IF.                                                      23250000
232600                                                                  23260000
232700     MOVE ZERO                       TO AP045-NW-STR-DISC-PCT     23270000
232800                                        AP045-TRD-DISC-PCT        23280000
232900                                        AP045-MOS-DISC-PCT.       23290000
233000                                                                  23300000
233100     PERFORM L200-FILL-AJ-FIELDS.                                 23310000
233200                                                                  23320000
233300 EJECT                                                            23330000
233400*----------------------------------------------------------------*23340000
233500*  THIS PARAGRAPH BUILDS TRANASCATIONS CONTAINING THE FREIGHT AND*23350000
233600*  MISC CHARGES FOR EACH GROUPING OF SKU/CLASS/RECEIVER SEQ/STORE*23360000
233700*                                                                *23370000
233800*    CALLED FROM J200-BUILD-RCVR-AJ.                             *23380000
233900*----------------------------------------------------------------*23390000
234000 J275-BUILD-INV-CHARGES-AJ.                                       23400000
234100                                                                  23410000
234200                                                                  23420000
234300     MOVE '29'                       TO AP045-AP-TRN-CDE.         23430000
234400                                                                  23440000
234500     PERFORM J950-CREATE-ADJ-DOC-NBR.                             23450000
234600                                                                  23460000
234700     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            23470000
234800                                                                  23480000
234900     PERFORM S100-SELECT-TTRNCDE-DATA.                            23490000
235000                                                                  23500000
235100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        23510000
235200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       23520000
235300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        23530000
235400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      23540000
235500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        23550000
235600     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           23560000
235700     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             23570000
235800     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            23580000
235900                                                                  23590000
236000     MOVE SPACE TO AP045-GL-ACCT-NBR.                             23600000
236100                                                                  23610000
236200     MOVE ZERO TO AP045-TERM-DISC-PCT,    AP045-NW-STR-DISC-PCT,  23620000
236300                   AP045-TRD-DISC-PCT,           AP045-FRGT-AMT,  23630000
236400                   AP045-MISC-CHRG-AMT, AP045-DTL-TERM-DISC-AMT,  23640000
236500                   AP045-DTL-NW-STR-DISC-AMT,    AP045-RETL-AMT,  23650000
236600                   AP045-DTL-TRD-DISC-AMT,   AP045-GRO-COST-AMT,  23660000
236700                   AP045-MOS-DISC-PCT, AP045-DTL-MOS-DISC-AMT.    23670000
236800                                                                  23680000
236900     MOVE PV-CURR-DB2-DATE TO AP045-INV-CUTOFF-DTE.               23690000
237000                                                                  23700000
237100     PERFORM K100-PRORATE-FRAMT.                                  23710000
237200                                                                  23720000
237300     PERFORM K200-PRORATE-MISCAMT.                                23730000
237400     PERFORM L200-FILL-AJ-FIELDS.                                 23740000
237500                                                                  23750000
237600 EJECT                                                            23760000
237700*----------------------------------------------------------------*23770000
237800*  THIS PARAGRAPH BUILDS NEW STORE DISCOUNT TRANSACTIONS FOR     *23780000
237900*  NEW STORE RECEIPTS WHERE THE DISCOUNT IS NOT ON THE INVOICES. *23790000
238000*                                                                *23800000
238100*    CALLED FROM J200-BUILD-RCVR-AJ                              *23810000
238200*----------------------------------------------------------------*23820000
238300 J280-BUILD-AUTO-NSD-AJ.                                          23830000
238400                                                                  23840000
238500     MOVE '0B'                       TO AP045-AP-TRN-CDE.         23850000
238600                                                                  23860000
238700     PERFORM S100-SELECT-TTRNCDE-DATA.                            23870000
238800                                                                  23880000
238900     IF  PV-PO-IN-PROCESS = HOLD-NSD-PO                           23890000
239000         CONTINUE                                                 23900000
239100     ELSE                                                         23910000
239200         PERFORM S200-GET-NEXT-DOC-NBR                            23920000
239300         MOVE PV-PO-IN-PROCESS TO HOLD-NSD-PO                     23930000
239400     END-IF.                                                      23940000
239500                                                                  23950000
239600     MOVE WS151-NEXT-DOC-NBR         TO AP045-DOC-NBR.            23960000
239700     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            23970000
239800     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        23980000
239900     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       23990000
240000     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        24000000
240100     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      24010000
240200     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        24020000
240300     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           24030000
240400     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             24040000
240500     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            24050000
240600     MOVE ID-PYMT-DUE-DTE            TO AP045-PYMT-DUE-DTE.       24060000
240700     MOVE ID-PYMT-HOLD-CDE           TO AP045-DOC-HLD-CDE.        24070000
240710     MOVE PC-0B-DESCR-TXT            TO AP045-RSN-1ST-LNE-TXT.    24071065
240800                                                                  24080000
240900     MOVE SPACE TO AP045-GL-ACCT-NBR.                             24090000
241000                                                                  24100000
241100     MOVE ZERO TO AP045-TERM-DISC-PCT, AP045-TRD-DISC-PCT,        24110000
241200                   AP045-FRGT-AMT, AP045-MISC-CHRG-AMT,           24120000
241300                   AP045-DTL-TERM-DISC-AMT, AP045-RETL-AMT,       24130000
241400                   AP045-DTL-TRD-DISC-AMT, AP045-GRO-COST-AMT,    24140000
241500                   AP045-MOS-DISC-PCT, AP045-DTL-MOS-DISC-AMT.    24150000
241600                                                                  24160000
241700     MOVE PV-CURR-DB2-DATE TO AP045-INV-CUTOFF-DTE.               24170000
241800                                                                  24180000
241900     MOVE AP045-TRN-TYP-CDE          TO PV-TRN-TYP-CDE.           24190000
242000     MOVE AP045-PSTG-TYP-CDE         TO PV-PSTG-TYP-CDE.          24200000
242100     MOVE AP045-STR-NBR              TO PV-STR-NBR.               24210000
242200     MOVE AP045-AP-TRN-CDE           TO PV-AP-TRN-CDE.            24220000
242300                                                                  24230000
242400     COMPUTE AP045-DTL-NW-STR-DISC-AMT =                          24240000
242500             (RD-TOTAL-COST * VNDAGR-DISCOUNT-PCT) + .005.        24250000
242600     MOVE VNDAGR-DISCOUNT-PCT        TO AP045-NW-STR-DISC-PCT.    24260000
242700     PERFORM L200-FILL-AJ-FIELDS.                                 24270000
242800                                                                  24280000
242900 J290-BUILD-PRVT-LBL-LOAD-AJ.                                     24290000
243000                                                                  24300000
243100     MOVE '4F'                       TO AP045-AP-TRN-CDE.         24310000
243200                                                                  24320000
243300     PERFORM S100-SELECT-TTRNCDE-DATA.                            24330000
243400                                                                  24340000
243500     PERFORM J952-CREATE-PLA-DOC-NBR.                             24350000
243600                                                                  24360000
243700     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            24370000
243800     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        24380000
243900     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       24390000
244000     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        24400000
244100     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      24410000
244200     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        24420000
244300     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           24430000
244400     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             24440000
244500     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            24450000
244600     MOVE ID-PYMT-DUE-DTE            TO AP045-PYMT-DUE-DTE.       24460000
244700     MOVE ID-PYMT-HOLD-CDE           TO AP045-DOC-HLD-CDE.        24470000
244800                                                                  24480000
244900     MOVE SPACE TO AP045-GL-ACCT-NBR.                             24490000
245000                                                                  24500000
245100     MOVE ZERO TO AP045-TERM-DISC-PCT,     AP045-TRD-DISC-PCT,    24510000
245200                  AP045-FRGT-AMT,          AP045-MISC-CHRG-AMT,   24520000
245300                  AP045-DTL-TERM-DISC-AMT, AP045-RETL-AMT,        24530000
245400                  AP045-DTL-TRD-DISC-AMT,  AP045-GRO-COST-AMT,    24540000
245500                  AP045-MOS-DISC-PCT,      AP045-DTL-MOS-DISC-AMT 24550000
245600                  AP045-DTL-NW-STR-DISC-AMT.                      24560000
245700                                                                  24570000
245800     MOVE PV-CURR-DB2-DATE TO AP045-INV-CUTOFF-DTE.               24580000
245900                                                                  24590000
246000     MOVE AP045-TRN-TYP-CDE          TO PV-TRN-TYP-CDE.           24600000
246100     MOVE AP045-PSTG-TYP-CDE         TO PV-PSTG-TYP-CDE.          24610000
246200     MOVE AP045-STR-NBR              TO PV-STR-NBR.               24620000
246300     MOVE AP045-AP-TRN-CDE           TO PV-AP-TRN-CDE.            24630000
246400                                                                  24640000
246500     COMPUTE AP045-GRO-COST-AMT =                                 24650000
246600             (RD-TOTAL-LOAD-COST - RD-TOTAL-COST) + .005.         24660000
246700*****        (RD-TOTAL-COST * PV-PRVT-LBL-LOAD-PCT).              24670000
246800     PERFORM L200-FILL-AJ-FIELDS.                                 24680000
246900                                                                  24690000
247000*----------------------------------------------------------------*24700000
247100*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO NON-INVOICED RECEIPT    *24710000
247200*    TRANSACTIONS ARE PREPARED FOR EACH GROUPING OF CLASS/       *24720000
247300*    RECEIVER SEQUENCE/STORE.  DESCRIPTIONS OF AMOUNT FIELDS:    *24730000
247400*        TR-TOTRETL CONTAINS CALCULATED RETAIL AMOUNT            *24740000
247500*        AP045-GRO-COST-AMT CONTAINS COST TIMES QUANTITY         *24750000
247600*        AP045-FRGT-AMT CONTAINS ZERO (AMOUNT IS ON 01/02 TRAN)  *24760000
247700*        AP045-MISC-CHRG-AMT CONTAINS ZERO (AMOUNT IS ON 01/02   *24770000
247800*         TRAN)                                                  *24780000
247900*                                                                *24790000
248000*    CALLED FROM D500-BUILD-RECS                                 *24800000
248100*----------------------------------------------------------------*24810000
248200 J300-BUILD-NR-AJ.                                                24820000
248300                                                                  24830000
248400     MOVE '75'                   TO AP045-AP-TRN-CDE.             24840000
248500     MOVE SPACE                  TO AP045-DEPT-NBR,               24850000
248600                                    AP045-DOC-NBR.                24860000
248700                                                                  24870000
248800     PERFORM J955-CREATE-NIR-DOC-NBR.                             24880000
248900                                                                  24890000
249000     MOVE ID-DEFAULT-STR-X       TO AP045-STR-NBR.                24900000
249100                                                                  24910000
249200     PERFORM S100-SELECT-TTRNCDE-DATA.                            24920000
249300                                                                  24930000
249400     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        24940000
249500     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       24950000
249600     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        24960000
249700     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      24970000
249800     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        24980000
249900     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        24990000
250000                                                                  25000000
250100     MOVE RD-TOTAL-RETAIL            TO AP045-RETL-AMT.           25010000
250200     COMPUTE AP045-GRO-COST-AMT = RD-TOTAL-COST + .005.           25020000
250300                                                                  25030000
250400     MOVE ZERO                       TO AP045-FRGT-AMT            25040000
250500                                        AP045-MISC-CHRG-AMT       25050000
250600                                        AP045-TERM-DISC-PCT       25060000
250700                                        AP045-NW-STR-DISC-PCT     25070000
250800                                        AP045-TRD-DISC-PCT        25080000
250900                                        AP045-DTL-TERM-DISC-AMT   25090000
251000                                        AP045-DTL-NW-STR-DISC-AMT 25100000
251100                                        AP045-DTL-TRD-DISC-AMT    25110000
251200                                        AP045-MOS-DISC-PCT        25120000
251300                                        AP045-DTL-MOS-DISC-AMT    25130000
251400                                        AP045-SKU-NBR.            25140000
251500                                                                  25150000
251600     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     25160000
251700     PERFORM L200-FILL-AJ-FIELDS.                                 25170000
251800                                                                  25180000
251900     IF PV-TOT-FRT-ADJ-AMT > 0                                    25190000
252000     OR PV-MISC-ADJ-AMT    > 0                                    25200000
252100         PERFORM J350-BUILD-NR-CHRG-AJ                            25210000
252200     END-IF.                                                      25220000
252300                                                                  25230000
252400*    PERFORM J250-BUILD-DISCOUNT-ON-INV-AJ.                       25240039
252410     IF PS-SEPHORA-AT-KOHLS                                       25241054
252420         CONTINUE                                                 25242054
252421     ELSE                                                         25242154
252422         PERFORM J250-BUILD-DISCOUNT-ON-INV-AJ                    25242254
252430     END-IF.                                                      25243039
252500                                                                  25250000
252600     IF ID-CD-HANDLING-AMT NOT = ZERO                             25260000
252700        PERFORM K300-BUILD-HANDLING-CHRG-AJ                       25270000
252800     END-IF.                                                      25280000
252900                                                                  25290000
253000     IF ID-TOTAL-ADV-DISC-AMT NOT = ZERO                          25300000
253100        PERFORM J900-BUILD-BROADCAST-ADJ                          25310000
253200     END-IF.                                                      25320000
253300                                                                  25330000
253400     IF ID-TOTAL-NEW-STR-AMT NOT = ZERO                           25340000
253500        PERFORM K500-BUILD-NEW-STR-ADJ                            25350000
253600     END-IF.                                                      25360000
253700                                                                  25370000
253800     IF ID-TOTAL-MOS-DISC-AMT NOT = ZERO                          25380000
253900        PERFORM K600-BUILD-MOS-DISC-ADJ                           25390000
254000     END-IF.                                                      25400000
254100                                                                  25410000
254200     IF ID-TOTAL-TRD-DISC-AMT NOT = ZERO                          25420000
254300        PERFORM K700-BUILD-TRD-DISC-ADJ                           25430000
254400     END-IF.                                                      25440000
254500                                                                  25450000
254600     IF ID-TOTAL-ALW-DISC-AMT NOT = ZERO                          25460000
254700        PERFORM K800-BUILD-ALW-DISC-ADJ                           25470000
254800     END-IF.                                                      25480000
254900                                                                  25490000
255000     IF ID-TOTAL-MISC-DISC-AMT NOT = ZERO                         25500000
255100        PERFORM K900-BUILD-MISC-DISC-ADJ                          25510000
255200     END-IF.                                                      25520000
255300                                                                  25530000
255400 EJECT                                                            25540000
255500*----------------------------------------------------------------*25550000
255600*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO NON-INVOICED RELATED    *25560000
255700*    CHARGES ARE PREPARED FOR EACH NON-INVOICED RECEIPT TRANS.   *25570000
255800*    (EACH TRANSACTION 75 MAY ALSO GENERATE AN 01 OR 02 CHARGE   *25580000
255900*    TRANSACTION.)  DESCRIPTIONS OF AMOUNT FIELDS:               *25590000
256000*        TR-TOTRETL CONTAINS ZERO (AMOUNT IS ON 75 TRAN)         *25600000
256100*        AP045-GRO-COST-AMT CONTAINS ZERO (AMOUNT IS ON 75 TRAN) *25610000
256200*        AP045-FRGT-AMT CONTAINS PRORATED FREIGHT AMOUNT         *25620000
256300*        AP045-MISC-CHRG-AMT CONTAINS PRORATED MISC AMOUNT       *25630000
256400*                                                                *25640000
256500*    CALLED FROM J300-BUILD-NR-AJ                                *25650000
256600*----------------------------------------------------------------*25660000
256700 J350-BUILD-NR-CHRG-AJ.                                           25670000
256800                                                                  25680000
256900                                                                  25690000
257000     MOVE '29'                       TO AP045-AP-TRN-CDE.         25700000
257100                                                                  25710000
257200     MOVE SPACE                      TO AP045-DOC-NBR.            25720000
257300     MOVE 'INVCHGS'                  TO AP045-DOC-NBR.            25730000
257400     MOVE 85                         TO AP045-STR-NBR.            25740000
257500                                                                  25750000
257600     PERFORM S100-SELECT-TTRNCDE-DATA.                            25760000
257700                                                                  25770000
257800     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        25780000
257900     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       25790000
258000     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        25800000
258100     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      25810000
258200     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        25820000
258300     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           25830000
258400     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             25840000
258500     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            25850000
258600                                                                  25860000
258700     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        25870000
258800                                                                  25880000
258900     MOVE ZERO                       TO AP045-RETL-AMT            25890000
259000                                        AP045-GRO-COST-AMT        25900000
259100                                        AP045-TERM-DISC-PCT       25910000
259200                                        AP045-NW-STR-DISC-PCT     25920000
259300                                        AP045-TRD-DISC-PCT        25930000
259400                                        AP045-DTL-TERM-DISC-AMT   25940000
259500                                        AP045-DTL-NW-STR-DISC-AMT 25950000
259600                                        AP045-DTL-TRD-DISC-AMT    25960000
259700                                        AP045-MOS-DISC-PCT        25970000
259800                                        AP045-DTL-MOS-DISC-AMT.   25980000
259900                                                                  25990000
260000     PERFORM K100-PRORATE-FRAMT.                                  26000000
260100     PERFORM K200-PRORATE-MISCAMT.                                26010000
260200                                                                  26020000
260300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     26030000
260400     PERFORM L200-FILL-AJ-FIELDS.                                 26040000
260500 EJECT                                                            26050000
260600*----------------------------------------------------------------*26060000
260700*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO TOLERANCE ADJUSTMENT    *26070000
260800*    TRANSACTIONS ARE PREPARED FOR EACH GROUPING OF CLASS/       *26080000
260900*    RECEIVER SEQUENCE/STORE.  AP045-GRO-COST-AMT IS CALCULATED  *26090000
261000*    USING THE PRORATION FORMULA:                                *26100000
261100*          (CLASS-RECSEQ-STORE TOTAL / TOTAL ALL RECEIVING)      *26110000
261200*                * POSTRR TOLERANCE ADJUSTMENT AMOUNT            *26120000
261300*                                                                *26130000
261400*    EACH TIME PRORATION IS CALCULATED, THE CALCULATED AMOUNT    *26140000
261500*    IS COMPARED TO A RUNNING BALANCE OF THE REMAINING ADJUST-   *26150000
261600*    MENT AMOUNT.  WHEN THE PRORATION AMOUNT IS GREATER THAN     *26160000
261700*    THE AMOUNT BALANCE, THE AMOUNT BALANCE IS USED INSTEAD OF   *26170000
261800*    THE CALCULATED PRORATION AMOUNT.  THIS ENSURES THAT THE     *26180000
261900*    TOTAL TO BE PRORATED IS THE AMOUNT ACTUALLY PRORATED        *26190000
262000*    INSTEAD OF DIFFERENCES DUE TO ROUNDING.                     *26200000
262100*                                                                *26210000
262200*    CALLED FROM D500-BUILD-RECS                                 *26220000
262300*----------------------------------------------------------------*26230000
262400 J400-BUILD-TOLR-ADJ-AJ.                                          26240000
262500                                                                  26250000
262600                                                                  26260000
262700     EVALUATE TRUE                                                26270000
262800         WHEN POSTRR-TOLR-ADJ-CDE = PC-CREDIT-AJ                  26280000
262900             MOVE '35'               TO AP045-AP-TRN-CDE          26290000
263000         WHEN POSTRR-TOLR-ADJ-CDE = PC-DEBIT-AJ                   26300000
263100             MOVE '34'               TO AP045-AP-TRN-CDE          26310000
263200     END-EVALUATE.                                                26320000
263300                                                                  26330000
263400     PERFORM J950-CREATE-ADJ-DOC-NBR.                             26340000
263500                                                                  26350000
263600     IF RD-NON-INVC-RECEIPT                                       26360000
263700         IF RD-STR-NBR = 0                                        26370000
263800            MOVE 85                  TO AP045-STR-NBR             26380000
263900         ELSE                                                     26390000
264000            MOVE RD-STR-NBR          TO AP045-STR-NBR             26400000
264100         END-IF                                                   26410000
264200     ELSE                                                         26420000
264300         MOVE RD-STR-NBR             TO AP045-STR-NBR             26430000
264400     END-IF.                                                      26440000
264500                                                                  26450000
264600     PERFORM S100-SELECT-TTRNCDE-DATA.                            26460000
264700                                                                  26470000
264800     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        26480000
264900     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       26490000
265000     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        26500000
265100     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      26510000
265200     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        26520000
265300     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           26530000
265400     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             26540000
265500     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            26550000
265600                                                                  26560000
265700     IF RD-TOTAL-REC-COST > 0                                     26570000
265800         COMPUTE PV-DECIMAL-8 =                                   26580000
265900             (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                 26590000
266000         COMPUTE AP045-GRO-COST-AMT = (PV-DECIMAL-8 *             26600000
266100                        POSTRR-TOLR-ADJ-AMT) + .005               26610000
266200     ELSE                                                         26620000
266300         MOVE ZERO TO AP045-GRO-COST-AMT                          26630000
266400     END-IF.                                                      26640000
266500                                                                  26650000
266600                                                                  26660000
266700*----------------------------------------------------------------*26670000
266800* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *26680000
266900* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *26690000
267000* USE THE REMAINING TOTAL.                                       *26700000
267100*----------------------------------------------------------------*26710000
267200     IF MORE-RECEIPTS                                             26720000
267300         IF AP045-GRO-COST-AMT > PV-TOLR-ADJ-AMT                  26730000
267400             MOVE PV-TOLR-ADJ-AMT TO AP045-GRO-COST-AMT           26740000
267500         END-IF                                                   26750000
267600                                                                  26760000
267700     ELSE                                                         26770000
267800*----------------------------------------------------------------*26780000
267900* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *26790000
268000*----------------------------------------------------------------*26800000
268100         MOVE PV-TOLR-ADJ-AMT TO AP045-GRO-COST-AMT               26810000
268200     END-IF.                                                      26820000
268300                                                                  26830000
268400     IF PV-TOLR-ADJ-AMT > 0                                       26840000
268500         SUBTRACT AP045-GRO-COST-AMT FROM PV-TOLR-ADJ-AMT         26850000
268600     END-IF.                                                      26860000
268700                                                                  26870000
268800     MOVE AP045-TRN-TYP-CDE          TO PV-TRN-TYP-CDE.           26880000
268900     MOVE AP045-PSTG-TYP-CDE         TO PV-PSTG-TYP-CDE.          26890000
269000     MOVE AP045-GRO-COST-AMT         TO PV-GRO-COST-AMT.          26900000
269100     MOVE AP045-STR-NBR              TO PV-STR-NBR.               26910000
269200     MOVE AP045-AP-TRN-CDE           TO PV-AP-TRN-CDE.            26920000
269300                                                                  26930000
269400     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        26940000
269500                                                                  26950000
269600     MOVE ZERO                       TO AP045-RETL-AMT            26960000
269700                                        AP045-FRGT-AMT            26970000
269800                                        AP045-MISC-CHRG-AMT       26980000
269900                                        AP045-NW-STR-DISC-PCT     26990000
270000                                        AP045-TRD-DISC-PCT        27000000
270100                                        AP045-DTL-NW-STR-DISC-AMT 27010000
270200                                        AP045-DTL-TRD-DISC-AMT    27020000
270300                                        AP045-TERM-DISC-PCT       27030000
270400                                        AP045-DTL-TERM-DISC-AMT   27040000
270500                                        AP045-MOS-DISC-PCT        27050000
270600                                        AP045-DTL-MOS-DISC-AMT.   27060000
270700                                                                  27070000
270800     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     27080000
270900                                                                  27090000
271000     IF AP045-GRO-COST-AMT > ZERO                                 27100000
271100         PERFORM L200-FILL-AJ-FIELDS                              27110000
271200     END-IF.                                                      27120000
271300 EJECT                                                            27130000
271400*----------------------------------------------------------------*27140000
271500*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO FREIGHT ADJUSTMENT      *27150000
271600*    TRANSACTIONS ARE PREPARED FOR EACH GROUPING OF CLASS/       *27160000
271700*    RECEIVER SEQUENCE/STORE.  AP045-GRO-COST-AMT IS CALCULATED  *27170000
271800*    USING THE PRORATION FORMULA:                                *27180000
271900*        (CLASS-RECSEQ-STORE TOTAL / TOTAL ALL RECEIVING)        *27190000
272000*   * (DEFAULT VENDOR FREIGHT PERCENT * TOTAL FREIGHT CHARGES)   *27200000
272100*                                                                *27210000
272200*    EACH TIME PRORATION IS CALCULATED, THE CALCULATED AMOUNT    *27220000
272300*    IS COMPARED TO A RUNNING BALANCE OF THE REMAINING ADJUST-   *27230000
272400*    MENT AMOUNT.  WHEN THE PRORATION AMOUNT IS GREATER THAN     *27240000
272500*    THE AMOUNT BALANCE, THE AMOUNT BALANCE IS USED INSTEAD OF   *27250000
272600*    THE CALCULATED PRORATION AMOUNT.  THIS ENSURES THAT THE     *27260000
272700*    TOTAL TO BE PRORATED IS THE AMOUNT ACTUALLY PRORATED        *27270000
272800*    INSTEAD OF DIFFERENCES DUE TO ROUNDING.                     *27280000
272900*                                                                *27290000
273000*    CALLED FROM D500-BUILD-RECS                                 *27300000
273100*----------------------------------------------------------------*27310000
273200 J500-BUILD-FREIGHT-AJ.                                           27320000
273300                                                                  27330000
273400                                                                  27340000
273500     MOVE '13'                       TO AP045-AP-TRN-CDE.         27350000
273600                                                                  27360000
273700     IF RD-NON-INVC-RECEIPT                                       27370000
273800         MOVE 85                     TO AP045-STR-NBR             27380000
273900         MOVE SPACE                  TO AP045-DOC-NBR             27390000
274000         MOVE 'INVCHGS'              TO AP045-DOC-NBR             27400000
274100     ELSE                                                         27410000
274200         PERFORM J950-CREATE-ADJ-DOC-NBR                          27420000
274300         MOVE RD-STR-NBR             TO AP045-STR-NBR             27430000
274400     END-IF.                                                      27440000
274500                                                                  27450000
274600     PERFORM S100-SELECT-TTRNCDE-DATA.                            27460000
274700                                                                  27470000
274800     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        27480000
274900     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       27490000
275000     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        27500000
275100     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      27510000
275200     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        27520000
275300     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           27530000
275400     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             27540000
275500     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            27550000
275600                                                                  27560000
275700     IF RD-TOTAL-REC-COST > 0                                     27570000
275800         COMPUTE PV-DECIMAL-8 =                                   27580000
275900               (RD-TOTAL-COST /  RD-TOTAL-REC-COST)               27590000
276000         COMPUTE AP045-FRGT-AMT = (PV-DECIMAL-8 *                 27600000
276100                 ID-TOTAL-VENDOR-FRT) + .005                      27610000
276200     ELSE                                                         27620000
276300         MOVE ZERO TO AP045-FRGT-AMT                              27630000
276400     END-IF.                                                      27640000
276500                                                                  27650000
276600*----------------------------------------------------------------*27660000
276700* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *27670000
276800* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *27680000
276900* USE THE REMAINING TOTAL.                                       *27690000
277000*----------------------------------------------------------------*27700000
277100     IF MORE-RECEIPTS                                             27710000
277200         IF AP045-FRGT-AMT > PV-VEND-FRT-ADJ-AMT                  27720000
277300             MOVE PV-VEND-FRT-ADJ-AMT TO AP045-FRGT-AMT           27730000
277400         END-IF                                                   27740000
277500                                                                  27750000
277600     ELSE                                                         27760000
277700*----------------------------------------------------------------*27770000
277800* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *27780000
277900*----------------------------------------------------------------*27790000
278000         MOVE PV-VEND-FRT-ADJ-AMT TO AP045-FRGT-AMT               27800000
278100     END-IF.                                                      27810000
278200                                                                  27820000
278300     IF PV-VEND-FRT-ADJ-AMT > 0                                   27830000
278400         SUBTRACT AP045-FRGT-AMT FROM PV-VEND-FRT-ADJ-AMT         27840000
278500     END-IF.                                                      27850000
278600                                                                  27860000
278700                                                                  27870000
278800     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        27880000
278900                                                                  27890000
279000     MOVE ZERO                       TO AP045-RETL-AMT            27900000
279100                                        AP045-GRO-COST-AMT        27910000
279200                                        AP045-MISC-CHRG-AMT       27920000
279300                                        AP045-TERM-DISC-PCT       27930000
279400                                        AP045-NW-STR-DISC-PCT     27940000
279500                                        AP045-TRD-DISC-PCT        27950000
279600                                        AP045-DTL-TERM-DISC-AMT   27960000
279700                                        AP045-DTL-NW-STR-DISC-AMT 27970000
279800                                        AP045-DTL-TRD-DISC-AMT    27980000
279900                                        AP045-MOS-DISC-PCT        27990000
280000                                        AP045-DTL-MOS-DISC-AMT.   28000000
280100                                                                  28010000
280200     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     28020000
280300                                                                  28030000
280400     IF AP045-FRGT-AMT > ZERO                                     28040000
280500         PERFORM L200-FILL-AJ-FIELDS                              28050000
280600     END-IF.                                                      28060000
280700 EJECT                                                            28070000
280800*----------------------------------------------------------------*28080000
280900*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO DNP ADJUSTMENT          *28090000
281000*    TRANSACTIONS ARE PREPARED FOR EACH GROUPING OF CLASS/       *28100000
281100*    RECEIVER SEQUENCE/STORE.  AP045-GRO-COST-AMT IS CALCULATED  *28110000
281200*    USING THE PRORATION FORMULA:                                *28120000
281300*        (CLASS-RECSEQ-STORE TOTAL / TOTAL ALL RECEIVING)        *28130000
281400*                 * TOTAL DO-NOT-PAY CHARGES                     *28140000
281500*                                                                *28150000
281600*    EACH TIME PRORATION IS CALCULATED, THE CALCULATED AMOUNT    *28160000
281700*    IS COMPARED TO A RUNNING BALANCE OF THE REMAINING ADJUST-   *28170000
281800*    MENT AMOUNT.  WHEN THE PRORATION AMOUNT IS GREATER THAN     *28180000
281900*    THE AMOUNT BALANCE, THE AMOUNT BALANCE IS USED INSTEAD OF   *28190000
282000*    THE CALCULATED PRORATION AMOUNT.  THIS ENSURES THAT THE     *28200000
282100*    TOTAL TO BE PRORATED IS THE AMOUNT ACTUALLY PRORATED        *28210000
282200*    INSTEAD OF DIFFERENCES DUE TO ROUNDING.                     *28220000
282300*                                                                *28230000
282400*    CALLED FROM D500-BUILD-RECS                                 *28240000
282500*----------------------------------------------------------------*28250000
282600 J600-BUILD-DNP-AJ.                                               28260000
282700                                                                  28270000
282800     MOVE '15'                       TO AP045-AP-TRN-CDE.         28280000
282900                                                                  28290000
283000     PERFORM J950-CREATE-ADJ-DOC-NBR.                             28300000
283100                                                                  28310000
283200     IF RD-NON-INVC-RECEIPT                                       28320000
283300         IF RD-STR-NBR = 0                                        28330000
283400            MOVE 85                  TO AP045-STR-NBR             28340000
283500         ELSE                                                     28350000
283600            MOVE RD-STR-NBR          TO AP045-STR-NBR             28360000
283700         END-IF                                                   28370000
283800     ELSE                                                         28380000
283900         MOVE RD-STR-NBR             TO AP045-STR-NBR             28390000
284000     END-IF.                                                      28400000
284100                                                                  28410000
284200     PERFORM S100-SELECT-TTRNCDE-DATA.                            28420000
284300                                                                  28430000
284400     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        28440000
284500     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       28450000
284600     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        28460000
284700     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      28470000
284800     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        28480000
284900     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           28490000
285000     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             28500000
285100     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            28510000
285200                                                                  28520000
285300     IF RD-TOTAL-REC-COST > 0                                     28530000
285400       COMPUTE PV-DECIMAL-8 =                                     28540000
285500           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   28550000
285600       COMPUTE AP045-MISC-CHRG-AMT = (PV-DECIMAL-8 *              28560000
285700                        ID-TOTAL-DNP-CHARGES) + .005              28570000
285800     ELSE                                                         28580000
285900         MOVE ZERO TO AP045-MISC-CHRG-AMT                         28590000
286000     END-IF.                                                      28600000
286100                                                                  28610000
286200*----------------------------------------------------------------*28620000
286300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *28630000
286400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *28640000
286500* USE THE REMAINING TOTAL.                                       *28650000
286600*----------------------------------------------------------------*28660000
286700     IF MORE-RECEIPTS                                             28670000
286800         IF AP045-MISC-CHRG-AMT > PV-DNP-ADJ-AMT                  28680000
286900             MOVE PV-DNP-ADJ-AMT TO AP045-MISC-CHRG-AMT           28690000
287000         END-IF                                                   28700000
287100                                                                  28710000
287200     ELSE                                                         28720000
287300*----------------------------------------------------------------*28730000
287400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *28740000
287500*----------------------------------------------------------------*28750000
287600         MOVE PV-DNP-ADJ-AMT TO AP045-MISC-CHRG-AMT               28760000
287700     END-IF.                                                      28770000
287800                                                                  28780000
287900     IF PV-DNP-ADJ-AMT > 0                                        28790000
288000         SUBTRACT AP045-MISC-CHRG-AMT FROM PV-DNP-ADJ-AMT         28800000
288100     END-IF.                                                      28810000
288200                                                                  28820000
288300                                                                  28830000
288400     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        28840000
288500                                                                  28850000
288600     MOVE ZERO                       TO AP045-RETL-AMT            28860000
288700                                        AP045-GRO-COST-AMT        28870000
288800                                        AP045-FRGT-AMT            28880000
288900                                        AP045-TERM-DISC-PCT       28890000
289000                                        AP045-NW-STR-DISC-PCT     28900000
289100                                        AP045-TRD-DISC-PCT        28910000
289200                                        AP045-DTL-TERM-DISC-AMT   28920000
289300                                        AP045-DTL-NW-STR-DISC-AMT 28930000
289400                                        AP045-DTL-TRD-DISC-AMT    28940000
289500                                        AP045-MOS-DISC-PCT        28950000
289600                                        AP045-DTL-MOS-DISC-AMT.   28960000
289700                                                                  28970000
289800     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     28980000
289900                                                                  28990000
290000     IF AP045-MISC-CHRG-AMT > ZERO                                29000000
290100         PERFORM L200-FILL-AJ-FIELDS                              29010000
290200     END-IF.                                                      29020000
290300 EJECT                                                            29030000
290400*----------------------------------------------------------------*29040000
290500*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO ADJUSTMENT TRANSACTIONS *29050000
290600*    FOR TODAY'S NON-INVOICE RECEIPTS ARE PREPARED FOR EACH      *29060000
290700*    ONE OF THE NON-INVOICED RECEIPTS GENERATED TODAY.           *29070000
290800*    CALLED FROM B200-PROCESS-POS                                *29080000
290900*----------------------------------------------------------------*29090000
291000 J700-BUILD-TODAYS-NR-AJ.                                         29100000
291100                                                                  29110000
291200                                                                  29120000
291300     MOVE '76'                       TO AP045-AP-TRN-CDE.         29130000
291400     MOVE SPACE                      TO AP045-DEPT-NBR,           29140000
291500                                        AP045-DOC-NBR.            29150000
291600                                                                  29160000
291700     PERFORM J955-CREATE-NIR-DOC-NBR.                             29170000
291800                                                                  29180000
291900     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            29190000
292000                                                                  29200000
292100     PERFORM S100-SELECT-TTRNCDE-DATA.                            29210000
292200                                                                  29220000
292300     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        29230000
292400     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       29240000
292500     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        29250000
292600     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      29260000
292700     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        29270000
292800     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        29280000
292900                                                                  29290000
293000     COMPUTE RD-TOTAL-DM ROUNDED                                  29300000
293100         = RD-TOTAL-DM + PV-TOTAL-NR-COST.                        29310000
293200                                                                  29320000
293300     COMPUTE AP045-GRO-COST-AMT = PV-TOTAL-NR-COST + .005.        29330000
293400                                                                  29340000
293500     MOVE ZERO                       TO AP045-RETL-AMT            29350000
293600                                        AP045-FRGT-AMT            29360000
293700                                        AP045-MISC-CHRG-AMT       29370000
293800                                        AP045-TERM-DISC-PCT       29380000
293900                                        AP045-NW-STR-DISC-PCT     29390000
294000                                        AP045-TRD-DISC-PCT        29400000
294100                                        AP045-DTL-TERM-DISC-AMT   29410000
294200                                        AP045-DTL-NW-STR-DISC-AMT 29420000
294300                                        AP045-DTL-TRD-DISC-AMT    29430000
294400                                        AP045-MOS-DISC-PCT        29440000
294500                                        AP045-DTL-MOS-DISC-AMT    29450000
294600                                        AP045-SKU-NBR.            29460000
294700                                                                  29470000
294800     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     29480000
294900                                                                  29490000
295000     IF AP045-GRO-COST-AMT > ZERO                                 29500000
295100         PERFORM L200-FILL-AJ-FIELDS                              29510000
295200     END-IF.                                                      29520000
295300 EJECT                                                            29530000
295400*----------------------------------------------------------------*29540000
295500*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO ADJUSTMENT TRANSACTIONS *29550000
295600*----------------------------------------------------------------*29560000
295700 J800-BUILD-WRITE-OFF-DEBIT.                                      29570000
295800                                                                  29580000
295900                                                                  29590000
296000     MOVE '72'                       TO AP045-AP-TRN-CDE.         29600000
296100     MOVE SPACE                      TO AP045-DEPT-NBR.           29610000
296200                                                                  29620000
296300     PERFORM J950-CREATE-ADJ-DOC-NBR.                             29630000
296400                                                                  29640000
296500     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            29650000
296600                                                                  29660000
296700     PERFORM S100-SELECT-TTRNCDE-DATA.                            29670000
296800                                                                  29680000
296900     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        29690000
297000     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       29700000
297100     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        29710000
297200     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      29720000
297300     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        29730000
297400     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        29740000
297500                                                                  29750000
297600     MOVE RD-TOTAL-REC-COST          TO AP045-GRO-COST-AMT.       29760000
297700     MOVE RD-TOTAL-REC-RETAIL        TO AP045-RETL-AMT.           29770000
297800                                                                  29780000
297900     MOVE ZERO                       TO AP045-FRGT-AMT            29790000
298000                                        AP045-MISC-CHRG-AMT.      29800000
298100                                                                  29810000
298200     MOVE ZERO                       TO AP045-TERM-DISC-PCT       29820000
298300                                        AP045-NW-STR-DISC-PCT     29830000
298400                                        AP045-TRD-DISC-PCT        29840000
298500                                        AP045-DTL-TERM-DISC-AMT   29850000
298600                                        AP045-DTL-NW-STR-DISC-AMT 29860000
298700                                        AP045-DTL-TRD-DISC-AMT    29870000
298800                                        AP045-MOS-DISC-PCT        29880000
298900                                        AP045-DTL-MOS-DISC-AMT    29890000
299000                                        AP045-SKU-NBR.            29900000
299100                                                                  29910000
299200                                                                  29920000
299300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     29930000
299400                                                                  29940000
299500     IF AP045-GRO-COST-AMT > ZERO                                 29950000
299600         PERFORM L200-FILL-AJ-FIELDS                              29960000
299700     END-IF.                                                      29970000
299800 EJECT                                                            29980000
299900                                                                  29990000
300000*----------------------------------------------------------------*30000000
300100*    BUILD CO-OP ADVERTISING ALLOWANCE ADJUSTMENTS               *30010000
300200*----------------------------------------------------------------*30020000
300300 J850-BUILD-COOP-ADV-ADJ.                                         30030000
300400                                                                  30040000
300500     MOVE '7A'                       TO AP045-AP-TRN-CDE.         30050000
300600     MOVE SPACE                      TO AP045-DEPT-NBR.           30060000
300700                                                                  30070000
300800     PERFORM J950-CREATE-ADJ-DOC-NBR.                             30080000
300900                                                                  30090000
301000     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            30100000
301100                                                                  30110000
301200     PERFORM S100-SELECT-TTRNCDE-DATA.                            30120000
301300                                                                  30130000
301400     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        30140000
301500     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       30150000
301600     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        30160000
301700     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      30170000
301800     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        30180000
301900     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        30190000
302000                                                                  30200000
302100     MOVE ID-TOTAL-COOP-ADV-AMT      TO AP045-GRO-COST-AMT.       30210000
302200     MOVE ZEROES                     TO AP045-RETL-AMT.           30220000
302300                                                                  30230000
302400     MOVE ZERO                       TO AP045-FRGT-AMT            30240000
302500                                        AP045-MISC-CHRG-AMT.      30250000
302600                                                                  30260000
302700     MOVE ZERO                       TO AP045-TERM-DISC-PCT       30270000
302800                                        AP045-NW-STR-DISC-PCT     30280000
302900                                        AP045-TRD-DISC-PCT        30290000
303000                                        AP045-DTL-TERM-DISC-AMT   30300000
303100                                        AP045-DTL-NW-STR-DISC-AMT 30310000
303200                                        AP045-DTL-TRD-DISC-AMT    30320000
303300                                        AP045-MOS-DISC-PCT        30330000
303400                                        AP045-DTL-MOS-DISC-AMT    30340000
303500                                        AP045-SKU-NBR.            30350000
303600                                                                  30360000
303700                                                                  30370000
303800     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     30380000
303900                                                                  30390000
304000     IF AP045-GRO-COST-AMT > ZERO                                 30400000
304100         PERFORM L200-FILL-AJ-FIELDS                              30410000
304200     END-IF.                                                      30420000
304300                                                                  30430000
304400*----------------------------------------------------------------*30440000
304500*    BUILD BROADCAST ADJUSTMENT TRANSACTIONS                     *30450000
304600*----------------------------------------------------------------*30460000
304700 J900-BUILD-BROADCAST-ADJ.                                        30470000
304800                                                                  30480000
304900     MOVE '5A'                       TO AP045-AP-TRN-CDE.         30490000
305000                                                                  30500000
305100     PERFORM J950-CREATE-ADJ-DOC-NBR.                             30510000
305200                                                                  30520000
305300     IF RD-NON-INVC-RECEIPT                                       30530000
305400         IF RD-STR-NBR = 0                                        30540000
305500            MOVE 85                  TO AP045-STR-NBR             30550000
305600         ELSE                                                     30560000
305700            MOVE RD-STR-NBR          TO AP045-STR-NBR             30570000
305800         END-IF                                                   30580000
305900     ELSE                                                         30590000
306000         MOVE RD-STR-NBR             TO AP045-STR-NBR             30600000
306100     END-IF.                                                      30610000
306200                                                                  30620000
306300     PERFORM S100-SELECT-TTRNCDE-DATA.                            30630000
306400                                                                  30640000
306500     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        30650000
306600     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       30660000
306700     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        30670000
306800     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      30680000
306900     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        30690000
307000     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           30700000
307100     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             30710000
307200     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            30720000
307300                                                                  30730000
307400     IF RD-TOTAL-REC-COST > 0                                     30740000
307500       COMPUTE PV-DECIMAL-8 =                                     30750000
307600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   30760000
307700       COMPUTE AP045-GRO-COST-AMT = (PV-DECIMAL-8 *               30770000
307800                        ID-TOTAL-ADV-DISC-AMT) + .005             30780000
307900     ELSE                                                         30790000
308000         MOVE ZERO TO AP045-GRO-COST-AMT                          30800000
308100     END-IF.                                                      30810000
308200*----------------------------------------------------------------*30820000
308300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *30830000
308400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *30840000
308500* USE THE REMAINING TOTAL.                                       *30850000
308600*----------------------------------------------------------------*30860000
308700     IF MORE-RECEIPTS                                             30870000
308800         IF AP045-GRO-COST-AMT > PV-BROADCAST-AMT                 30880000
308900             MOVE PV-BROADCAST-AMT TO AP045-GRO-COST-AMT          30890000
309000         END-IF                                                   30900000
309100                                                                  30910000
309200     ELSE                                                         30920000
309300*----------------------------------------------------------------*30930000
309400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *30940000
309500*----------------------------------------------------------------*30950000
309600         MOVE PV-BROADCAST-AMT TO AP045-GRO-COST-AMT              30960000
309700     END-IF.                                                      30970000
309800                                                                  30980000
309900     IF PV-BROADCAST-AMT > 0                                      30990000
310000         SUBTRACT AP045-GRO-COST-AMT FROM PV-BROADCAST-AMT        31000000
310100     END-IF.                                                      31010000
310200                                                                  31020000
310300     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        31030000
310400     MOVE ZERO                       TO AP045-RETL-AMT            31040000
310500                                        AP045-MISC-CHRG-AMT       31050000
310600                                        AP045-FRGT-AMT            31060000
310700                                        AP045-TERM-DISC-PCT       31070000
310800                                        AP045-NW-STR-DISC-PCT     31080000
310900                                        AP045-TRD-DISC-PCT        31090000
311000                                        AP045-DTL-TERM-DISC-AMT   31100000
311100                                        AP045-DTL-NW-STR-DISC-AMT 31110000
311200                                        AP045-DTL-TRD-DISC-AMT    31120000
311300                                        AP045-MOS-DISC-PCT        31130000
311400                                        AP045-DTL-MOS-DISC-AMT.   31140000
311500                                                                  31150000
311600     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     31160000
311700                                                                  31170000
311800     IF AP045-GRO-COST-AMT > ZERO                                 31180000
311900         PERFORM L200-FILL-AJ-FIELDS                              31190000
312000     END-IF.                                                      31200000
312100 EJECT                                                            31210000
312200                                                                  31220000
312300*----------------------------------------------------------------*31230000
312400*    BUILD GIFT WRAP EXPENSE ADJUSTMENT TRANSACTIONS             *31240000
312500*----------------------------------------------------------------*31250000
312600 J925-BUILD-GIFT-WRAP-EXP-AJ.                                     31260000
312700                                                                  31270000
312800     MOVE '6C'                       TO AP045-AP-TRN-CDE.         31280000
312900     MOVE SPACE                      TO AP045-DEPT-NBR.           31290000
313000                                                                  31300000
313100     PERFORM J950-CREATE-ADJ-DOC-NBR.                             31310000
313200                                                                  31320000
313300     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            31330000
313400                                                                  31340000
313500     PERFORM S100-SELECT-TTRNCDE-DATA.                            31350000
313600                                                                  31360000
313700     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        31370000
313800     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       31380000
313900     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        31390000
314000     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      31400000
314100     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        31410000
314200     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        31420000
314300                                                                  31430000
314400     MOVE ID-CD-GIFT-WRAP-AMT        TO AP045-GRO-COST-AMT.       31440000
314500     MOVE ZEROES                     TO AP045-RETL-AMT.           31450000
314600                                                                  31460000
314700     MOVE ZERO                       TO AP045-FRGT-AMT            31470000
314800                                        AP045-MISC-CHRG-AMT.      31480000
314900                                                                  31490000
315000     MOVE ZERO                       TO AP045-TERM-DISC-PCT       31500000
315100                                        AP045-NW-STR-DISC-PCT     31510000
315200                                        AP045-TRD-DISC-PCT        31520000
315300                                        AP045-DTL-TERM-DISC-AMT   31530000
315400                                        AP045-DTL-NW-STR-DISC-AMT 31540000
315500                                        AP045-DTL-TRD-DISC-AMT    31550000
315600                                        AP045-MOS-DISC-PCT        31560000
315700                                        AP045-DTL-MOS-DISC-AMT    31570000
315800                                        AP045-SKU-NBR.            31580000
315900                                                                  31590000
316000                                                                  31600000
316100     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     31610000
316200                                                                  31620000
316300     IF AP045-GRO-COST-AMT > ZERO                                 31630000
316400         PERFORM L200-FILL-AJ-FIELDS                              31640000
316500     END-IF.                                                      31650000
316600                                                                  31660000
316700*----------------------------------------------------------------*31670000
316800*    BUILD GIFT WRAP EXPENSE REVERSAL TRANSACTIONS.              *31680000
316900*----------------------------------------------------------------*31690000
317000 J930-BUILD-GIFT-WRAP-EXP-REV.                                    31700000
317100                                                                  31710000
317200     MOVE '6K'                       TO AP045-AP-TRN-CDE.         31720000
317300     MOVE SPACE                      TO AP045-DEPT-NBR.           31730000
317400                                                                  31740000
317500     PERFORM J950-CREATE-ADJ-DOC-NBR.                             31750000
317600                                                                  31760000
317700     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            31770000
317800                                                                  31780000
317900     PERFORM S100-SELECT-TTRNCDE-DATA.                            31790000
318000                                                                  31800000
318100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        31810000
318200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       31820000
318300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        31830000
318400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      31840000
318500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        31850000
318600     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        31860000
318700                                                                  31870000
318800     MOVE ID-CD-GIFT-WRAP-AMT        TO AP045-GRO-COST-AMT.       31880000
318900     MOVE ZEROES                     TO AP045-RETL-AMT.           31890000
319000                                                                  31900000
319100     MOVE ZERO                       TO AP045-FRGT-AMT            31910000
319200                                        AP045-MISC-CHRG-AMT.      31920000
319300                                                                  31930000
319400     MOVE ZERO                       TO AP045-TERM-DISC-PCT       31940000
319500                                        AP045-NW-STR-DISC-PCT     31950000
319600                                        AP045-TRD-DISC-PCT        31960000
319700                                        AP045-DTL-TERM-DISC-AMT   31970000
319800                                        AP045-DTL-NW-STR-DISC-AMT 31980000
319900                                        AP045-DTL-TRD-DISC-AMT    31990000
320000                                        AP045-MOS-DISC-PCT        32000000
320100                                        AP045-DTL-MOS-DISC-AMT    32010000
320200                                        AP045-SKU-NBR.            32020000
320300                                                                  32030000
320400                                                                  32040000
320500     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     32050000
320600                                                                  32060000
320700     IF AP045-GRO-COST-AMT > ZERO                                 32070000
320800         PERFORM L200-FILL-AJ-FIELDS                              32080000
320900     END-IF.                                                      32090000
321000                                                                  32100000
321100*----------------------------------------------------------------*32110000
321200*    CREATE THE ADJUSTMENT DOC NUMBER FROM THE PO NUMBER.        *32120000
321300*----------------------------------------------------------------*32130000
321400 J950-CREATE-ADJ-DOC-NBR.                                         32140000
321500                                                                  32150000
321600     MOVE SPACE TO AP045-DOC-NBR                                  32160000
321700                   PV-PO-NBR-X.                                   32170000
321800     INITIALIZE PV-START.                                         32180000
321900                                                                  32190000
322000     INSPECT PV-PO-9-X TALLYING PV-START FOR LEADING ZERO.        32200000
322100                                                                  32210000
322200     MOVE PV-PO-9-X (PV-START + 1 : 9 - PV-START) TO PV-PO-NBR-X. 32220000
322300                                                                  32230000
322400     STRING 'P'         DELIMITED BY SIZE                         32240000
322500            PV-PO-NBR-X DELIMITED BY SIZE                         32250000
322600                        INTO AP045-DOC-NBR.                       32260000
322700                                                                  32270000
322800                                                                  32280000
322900*----------------------------------------------------------------*32290000
323000*    CREATE THE PRIVATE LABEL LOAD DOCUMENT NUMBER.              *32300000
323100*----------------------------------------------------------------*32310000
323200 J952-CREATE-PLA-DOC-NBR.                                         32320000
323300                                                                  32330000
323400     MOVE SPACE TO AP045-DOC-NBR                                  32340000
323500                   PV-PO-NBR-X.                                   32350000
323600     INITIALIZE PV-START.                                         32360000
323700                                                                  32370000
323800     INSPECT PV-PO-9-X TALLYING PV-START FOR LEADING ZERO.        32380000
323900                                                                  32390000
324000     MOVE PV-PO-9-X (PV-START + 1 : 9 - PV-START) TO PV-PO-NBR-X. 32400000
324100                                                                  32410000
324200     STRING 'P'         DELIMITED BY SIZE                         32420000
324300            PV-PO-NBR-X DELIMITED BY SPACE                        32430000
324400            'PLA'       DELIMITED BY SIZE                         32440000
324500                        INTO AP045-DOC-NBR.                       32450000
324600                                                                  32460000
324700                                                                  32470000
324800*----------------------------------------------------------------*32480000
324900*    CREATE THE ADJUSTMENT DOC NUMBER FROM THE PO NUMBER.        *32490000
325000*----------------------------------------------------------------*32500000
325100 J955-CREATE-NIR-DOC-NBR.                                         32510000
325200                                                                  32520000
325300     MOVE SPACE TO AP045-DOC-NBR                                  32530000
325400                   PV-PO-NBR-X                                    32540000
325500                   PV-STR-NBR-X.                                  32550000
325600     INITIALIZE PV-START.                                         32560000
325700                                                                  32570000
325800     INSPECT PV-PO-9-X TALLYING PV-START FOR LEADING ZERO.        32580000
325900                                                                  32590000
326000     MOVE PV-PO-9-X (PV-START + 1 : 9 - PV-START) TO PV-PO-NBR-X. 32600000
326100                                                                  32610000
326200     INITIALIZE PV-START.                                         32620000
326300     INSPECT PV-STR-9-X TALLYING PV-START FOR LEADING ZERO.       32630000
326400                                                                  32640000
326500     IF  PV-START = 0                                             32650000
326600         MOVE 'ALL' TO PV-STR-NBR-X                               32660000
326700     ELSE                                                         32670000
326800         MOVE PV-STR-9-X (PV-START + 1 : 4 - PV-START)            32680000
326900              TO PV-STR-NBR-X                                     32690000
327000     END-IF.                                                      32700000
327100                                                                  32710000
327200     STRING 'NIR'        DELIMITED BY SIZE                        32720000
327300            PV-PO-NBR-X  DELIMITED BY SPACE                       32730000
327400            '/'          DELIMITED BY SIZE                        32740000
327500            PV-STR-NBR-X DELIMITED BY SIZE                        32750000
327600                         INTO AP045-DOC-NBR.                      32760000
327700                                                                  32770000
327800                                                                  32780000
327900                                                                  32790000
328000 EJECT                                                            32800000
328100*----------------------------------------------------------------*32810000
328200*    PARAGRAPHS K100 AND K200 USE THE FOLLOWING PRORATION        *32820000
328300*    FORMULA TO PRORATE CHARGES ACROSS RECEIVINGS:               *32830000
328400*          (CLASS-RECSEQ-STORE TOTAL / TOTAL ALL RECEIVING)      *32840000
328500*                  * TOTAL FREIGHT OR MISC CHARGES               *32850000
328600*                                                                *32860000
328700*    EACH TIME PRORATION IS CALCULATED, THE CALCULATED AMOUNT    *32870000
328800*    IS COMPARED TO A RUNNING BALANCE OF THE REMAINING ADJUST-   *32880000
328900*    MENT AMOUNT.  WHEN THE PRORATION AMOUNT IS GREATER THAN     *32890000
329000*    THE AMOUNT BALANCE, THE AMOUNT BALANCE IS USED INSTEAD OF   *32900000
329100*    THE CALCULATED PRORATION AMOUNT.  THIS ENSURES THAT THE     *32910000
329200*    TOTAL TO BE PRORATED IS THE AMOUNT ACTUALLY PRORATED        *32920000
329300*    INSTEAD OF DIFFERENCES DUE TO ROUNDING.                     *32930000
329400*----------------------------------------------------------------*32940000
329500 K100-PRORATE-FRAMT.                                              32950000
329600                                                                  32960000
329700     IF RD-TOTAL-REC-COST > 0                                     32970000
329800         COMPUTE PV-DECIMAL-8 =                                   32980000
329900             (RD-TOTAL-COST  /  RD-TOTAL-REC-COST)                32990000
330000         COMPUTE AP045-FRGT-AMT = (PV-DECIMAL-8 *                 33000000
330100                        ID-TOTAL-FREIGHT-CHARGES) + .005          33010000
330200     ELSE                                                         33020000
330300         MOVE ZERO TO AP045-FRGT-AMT                              33030000
330400     END-IF.                                                      33040000
330500                                                                  33050000
330600*----------------------------------------------------------------*33060000
330700* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *33070000
330800* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *33080000
330900* USE THE REMAINING TOTAL.                                       *33090000
331000*----------------------------------------------------------------*33100000
331100     IF MORE-RECEIPTS                                             33110000
331200         IF AP045-FRGT-AMT > PV-TOT-FRT-ADJ-AMT                   33120000
331300             MOVE PV-TOT-FRT-ADJ-AMT TO AP045-FRGT-AMT            33130000
331400         END-IF                                                   33140000
331500                                                                  33150000
331600     ELSE                                                         33160000
331700*----------------------------------------------------------------*33170000
331800* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *33180000
331900*----------------------------------------------------------------*33190000
332000         MOVE PV-TOT-FRT-ADJ-AMT TO AP045-FRGT-AMT                33200000
332100     END-IF.                                                      33210000
332200                                                                  33220000
332300     IF PV-TOT-FRT-ADJ-AMT > 0                                    33230000
332400         SUBTRACT AP045-FRGT-AMT FROM PV-TOT-FRT-ADJ-AMT          33240000
332500     END-IF.                                                      33250000
332600                                                                  33260000
332700                                                                  33270000
332800 K200-PRORATE-MISCAMT.                                            33280000
332900                                                                  33290000
333000     IF RD-TOTAL-REC-COST > 0                                     33300000
333100         COMPUTE PV-DECIMAL-8 =                                   33310000
333200             (RD-TOTAL-COST  /  RD-TOTAL-REC-COST)                33320000
333300         COMPUTE AP045-MISC-CHRG-AMT = (PV-DECIMAL-8 *            33330000
333400                        ID-TOTAL-MISC-CHARGES) + .005             33340000
333500     ELSE                                                         33350000
333600         MOVE ZERO TO AP045-MISC-CHRG-AMT                         33360000
333700     END-IF.                                                      33370000
333800                                                                  33380000
333900*----------------------------------------------------------------*33390000
334000* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *33400000
334100* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *33410000
334200* USE THE REMAINING TOTAL.                                       *33420000
334300*----------------------------------------------------------------*33430000
334400     IF MORE-RECEIPTS                                             33440000
334500         IF AP045-MISC-CHRG-AMT > PV-MISC-ADJ-AMT                 33450000
334600             MOVE PV-MISC-ADJ-AMT TO AP045-MISC-CHRG-AMT          33460000
334700         END-IF                                                   33470000
334800                                                                  33480000
334900     ELSE                                                         33490000
335000*----------------------------------------------------------------*33500000
335100* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *33510000
335200*----------------------------------------------------------------*33520000
335300         MOVE PV-MISC-ADJ-AMT TO AP045-MISC-CHRG-AMT              33530000
335400     END-IF.                                                      33540000
335500                                                                  33550000
335600     IF PV-MISC-ADJ-AMT > 0                                       33560000
335700         SUBTRACT AP045-MISC-CHRG-AMT FROM PV-MISC-ADJ-AMT        33570000
335800     END-IF.                                                      33580000
335900                                                                  33590000
336000 EJECT                                                            33600000
336100*----------------------------------------------------------------*33610000
336200*    ADJUSTMENT JOURNAL FIELDS UNIQUE TO HANDLING ADJUSTMENT     *33620000
336300*    TRANSACTIONS ARE PREPARED FOR EACH GROUPING OF CLASS/       *33630000
336400*    RECEIVER SEQUENCE/STORE.  AP045-GRO-COST-AMT IS CALCULATED  *33640000
336500*    USING THE PRORATION FORMULA:                                *33650000
336600*        (CLASS-RECSEQ-STORE TOTAL / TOTAL ALL RECEIVING)        *33660000
336700*                 * TOTAL HANDLING CHARGES                       *33670000
336800*                                                                *33680000
336900*    EACH TIME PRORATION IS CALCULATED, THE CALCULATED AMOUNT    *33690000
337000*    IS COMPARED TO A RUNNING BALANCE OF THE REMAINING ADJUST-   *33700000
337100*    MENT AMOUNT.  WHEN THE PRORATION AMOUNT IS GREATER THAN     *33710000
337200*    THE AMOUNT BALANCE, THE AMOUNT BALANCE IS USED INSTEAD OF   *33720000
337300*    THE CALCULATED PRORATION AMOUNT.  THIS ENSURES THAT THE     *33730000
337400*    TOTAL TO BE PRORATED IS THE AMOUNT ACTUALLY PRORATED        *33740000
337500*    INSTEAD OF DIFFERENCES DUE TO ROUNDING.                     *33750000
337600*                                                                *33760000
337700*    CALLED FROM J200-BUILD-RCVR-AJ                              *33770000
337800*----------------------------------------------------------------*33780000
337900 K300-BUILD-HANDLING-CHRG-AJ.                                     33790000
338000                                                                  33800000
338100     MOVE '0E'                       TO AP045-AP-TRN-CDE.         33810000
338200                                                                  33820000
338300     PERFORM J950-CREATE-ADJ-DOC-NBR.                             33830000
338400                                                                  33840000
338500     IF RD-NON-INVC-RECEIPT                                       33850000
338600         IF RD-STR-NBR = 0                                        33860000
338700            MOVE 85                  TO AP045-STR-NBR             33870000
338800         ELSE                                                     33880000
338900            MOVE RD-STR-NBR          TO AP045-STR-NBR             33890000
339000         END-IF                                                   33900000
339100     ELSE                                                         33910000
339200         MOVE RD-STR-NBR             TO AP045-STR-NBR             33920000
339300     END-IF.                                                      33930000
339400                                                                  33940000
339500     PERFORM S100-SELECT-TTRNCDE-DATA.                            33950000
339600                                                                  33960000
339700     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        33970000
339800     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       33980000
339900     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        33990000
340000     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      34000000
340100     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        34010000
340200     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           34020000
340300     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             34030000
340400     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            34040000
340500                                                                  34050000
340600     IF RD-TOTAL-REC-COST > 0                                     34060000
340700       COMPUTE PV-DECIMAL-8 =                                     34070000
340800           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   34080000
340900       COMPUTE AP045-MISC-CHRG-AMT = (PV-DECIMAL-8 *              34090000
341000                        ID-CD-HANDLING-AMT) + .005                34100000
341100     ELSE                                                         34110000
341200         MOVE ZERO TO AP045-MISC-CHRG-AMT                         34120000
341300     END-IF.                                                      34130000
341400                                                                  34140000
341500*----------------------------------------------------------------*34150000
341600* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *34160000
341700* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *34170000
341800* USE THE REMAINING TOTAL.                                       *34180000
341900*----------------------------------------------------------------*34190000
342000     IF MORE-RECEIPTS                                             34200000
342100         IF AP045-MISC-CHRG-AMT > PV-HANDLING-ADJ-AMT             34210000
342200             MOVE PV-HANDLING-ADJ-AMT TO AP045-MISC-CHRG-AMT      34220000
342300         END-IF                                                   34230000
342400                                                                  34240000
342500     ELSE                                                         34250000
342600*----------------------------------------------------------------*34260000
342700* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *34270000
342800*----------------------------------------------------------------*34280000
342900         MOVE PV-HANDLING-ADJ-AMT TO AP045-MISC-CHRG-AMT          34290000
343000     END-IF.                                                      34300000
343100                                                                  34310000
343200     IF PV-HANDLING-ADJ-AMT > 0                                   34320000
343300         SUBTRACT AP045-MISC-CHRG-AMT FROM PV-HANDLING-ADJ-AMT    34330000
343400     END-IF.                                                      34340000
343500                                                                  34350000
343600                                                                  34360000
343700     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        34370000
343800                                                                  34380000
343900     MOVE ZERO                       TO AP045-RETL-AMT            34390000
344000                                        AP045-GRO-COST-AMT        34400000
344100                                        AP045-FRGT-AMT            34410000
344200                                        AP045-TERM-DISC-PCT       34420000
344300                                        AP045-NW-STR-DISC-PCT     34430000
344400                                        AP045-TRD-DISC-PCT        34440000
344500                                        AP045-DTL-TERM-DISC-AMT   34450000
344600                                        AP045-DTL-NW-STR-DISC-AMT 34460000
344700                                        AP045-DTL-TRD-DISC-AMT    34470000
344800                                        AP045-MOS-DISC-PCT        34480000
344900                                        AP045-DTL-MOS-DISC-AMT.   34490000
345000                                                                  34500000
345100     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     34510000
345200                                                                  34520000
345300     IF AP045-MISC-CHRG-AMT > ZERO                                34530000
345400         PERFORM L200-FILL-AJ-FIELDS                              34540000
345500     END-IF.                                                      34550000
345600 EJECT                                                            34560000
345700*----------------------------------------------------------------*34570000
345800* VERIFY THAT THE DISCOUNT AMOUNT BEING DISTRIBUTED DOES NOT     *34580000
345900* EXCEED THE TOTAL DISCOUNT AMOUNT AVAILABLE.                    *34590000
346000* CALLED FROM J250-BUILD-DISCOUNT-ON-INV-AJ                      *34600000
346100*----------------------------------------------------------------*34610000
346200 K400-VERIFY-DISCOUNT-AMT.                                        34620000
346300                                                                  34630000
346400                                                                  34640000
346500     COMPUTE PV-DISTR-DISC-AMT =                                  34650000
346600        (PV-GRO-COST-AMT * PV-WORK-DISCOUNT-PCT * .01) + .005.    34660000
346700                                                                  34670000
346800     IF OUT-OF-RECEIPTS                                           34680000
346900         CONTINUE                                                 34690000
347000     ELSE                                                         34700000
347100         IF PV-DISTR-DISC-AMT > ZERO                              34710000
347200             IF PV-CREDIT OR PV-MERCHANDISE                       34720000
347300                 IF PV-DISTR-DISC-AMT > PV-TOTAL-DISC-AMT         34730000
347400                     IF PV-GRO-COST-AMT NOT = ZERO                34740000
347500                         COMPUTE PV-DECIMAL-8 =                   34750000
347600                             (PV-TOTAL-DISC-AMT / PV-GRO-COST-AMT)34760000
347700                         COMPUTE PV-WORK-DISCOUNT-PCT = .005 +    34770000
347800                             (PV-DECIMAL-8 * 100)                 34780000
347900                         MOVE ZERO TO PV-TOTAL-DISC-AMT           34790000
348000                     ELSE                                         34800000
348100                         DISPLAY '*** PV-GRO-COST-AMT = 0 '       34810000
348200                         DISPLAY 'PO/STR = ' PV-PO-IN-PROCESS     34820000
348300                                        ' '  PV-STR-NBR           34830000
348400                         DISPLAY 'PV-TOTAL-DISC-AMT = '           34840000
348500                                  PV-TOTAL-DISC-AMT               34850000
348600                         MOVE ZERO TO PV-WORK-DISCOUNT-PCT        34860000
348700                         MOVE ZERO TO PV-TOTAL-DISC-AMT           34870000
348800                     END-IF                                       34880000
348900                 ELSE                                             34890000
349000                     SUBTRACT PV-DISTR-DISC-AMT FROM              34900000
349100                         PV-TOTAL-DISC-AMT                        34910000
349200                 END-IF                                           34920000
349300             ELSE                                                 34930000
349400                 ADD PV-DISTR-DISC-AMT TO PV-TOTAL-DISC-AMT       34940000
349500             END-IF                                               34950000
349600         END-IF                                                   34960000
349700     END-IF.                                                      34970000
349800                                                                  34980000
349900 EJECT                                                            34990000
350000*----------------------------------------------------------------*35000000
350100*    BUILD NEW STORE DISCOUNT   TRANSACTIONS                     *35010000
350200*----------------------------------------------------------------*35020000
350300 K500-BUILD-NEW-STR-ADJ.                                          35030000
350400                                                                  35040000
350500     MOVE '2A'                       TO AP045-AP-TRN-CDE.         35050000
350600                                                                  35060000
350700     PERFORM J950-CREATE-ADJ-DOC-NBR.                             35070000
350800                                                                  35080000
350900     IF RD-NON-INVC-RECEIPT                                       35090000
351000         IF RD-STR-NBR = 0                                        35100000
351100            MOVE 85                  TO AP045-STR-NBR             35110000
351200         ELSE                                                     35120000
351300            MOVE RD-STR-NBR          TO AP045-STR-NBR             35130000
351400         END-IF                                                   35140000
351500     ELSE                                                         35150000
351600         MOVE RD-STR-NBR             TO AP045-STR-NBR             35160000
351700     END-IF.                                                      35170000
351800                                                                  35180000
351900     PERFORM S100-SELECT-TTRNCDE-DATA.                            35190000
352000                                                                  35200000
352100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        35210000
352200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       35220000
352300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        35230000
352400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      35240000
352500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        35250000
352600     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           35260000
352700     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             35270000
352800     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            35280000
352900                                                                  35290000
353000     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        35300000
353100     MOVE ZERO                       TO AP045-RETL-AMT            35310000
353200                                        AP045-GRO-COST-AMT        35320000
353300                                        AP045-MISC-CHRG-AMT       35330000
353400                                        AP045-FRGT-AMT            35340000
353500                                        AP045-TERM-DISC-PCT       35350000
353600                                        AP045-NW-STR-DISC-PCT     35360000
353700                                        AP045-TRD-DISC-PCT        35370000
353800                                        AP045-DTL-TERM-DISC-AMT   35380000
353900                                        AP045-DTL-NW-STR-DISC-AMT 35390000
354000                                        AP045-DTL-TRD-DISC-AMT    35400000
354100                                        AP045-MOS-DISC-PCT        35410000
354200                                        AP045-DTL-MOS-DISC-AMT.   35420000
354300                                                                  35430000
354400     IF RD-TOTAL-REC-COST > 0                                     35440000
354500       COMPUTE PV-DECIMAL-8 =                                     35450000
354600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   35460000
354700       COMPUTE AP045-DTL-TERM-DISC-AMT = (PV-DECIMAL-8 *          35470000
354800                        ID-TOTAL-NEW-STR-AMT) + .005              35480000
354900     ELSE                                                         35490000
355000         MOVE ZERO TO AP045-DTL-TERM-DISC-AMT                     35500000
355100     END-IF.                                                      35510000
355200*----------------------------------------------------------------*35520000
355300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *35530000
355400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *35540000
355500* USE THE REMAINING TOTAL.                                       *35550000
355600*----------------------------------------------------------------*35560000
355700     IF MORE-RECEIPTS                                             35570000
355800         IF AP045-DTL-TERM-DISC-AMT > PV-NEW-STR-AMT              35580000
355900             MOVE PV-NEW-STR-AMT TO AP045-DTL-TERM-DISC-AMT       35590000
356000         END-IF                                                   35600000
356100                                                                  35610000
356200     ELSE                                                         35620000
356300*----------------------------------------------------------------*35630000
356400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *35640000
356500*----------------------------------------------------------------*35650000
356600         MOVE PV-NEW-STR-AMT TO AP045-DTL-TERM-DISC-AMT           35660000
356700     END-IF.                                                      35670000
356800                                                                  35680000
356900     IF PV-NEW-STR-AMT > 0                                        35690000
357000         SUBTRACT AP045-DTL-TERM-DISC-AMT FROM PV-NEW-STR-AMT     35700000
357100     END-IF.                                                      35710000
357200                                                                  35720000
357300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     35730000
357400                                                                  35740000
357500     IF AP045-DTL-TERM-DISC-AMT > ZERO                            35750000
357600         PERFORM L200-FILL-AJ-FIELDS                              35760000
357700     END-IF.                                                      35770000
357800 EJECT                                                            35780000
357900                                                                  35790000
358000*----------------------------------------------------------------*35800000
358100*    BUILD MOS DISCOUNT TRANSACTION                              *35810000
358200*----------------------------------------------------------------*35820000
358300 K600-BUILD-MOS-DISC-ADJ.                                         35830000
358400                                                                  35840000
358500     MOVE '2B'                       TO AP045-AP-TRN-CDE.         35850000
358600                                                                  35860000
358700     PERFORM J950-CREATE-ADJ-DOC-NBR.                             35870000
358800                                                                  35880000
358900     IF RD-NON-INVC-RECEIPT                                       35890000
359000         IF RD-STR-NBR = 0                                        35900000
359100            MOVE 85                  TO AP045-STR-NBR             35910000
359200         ELSE                                                     35920000
359300            MOVE RD-STR-NBR          TO AP045-STR-NBR             35930000
359400         END-IF                                                   35940000
359500     ELSE                                                         35950000
359600         MOVE RD-STR-NBR             TO AP045-STR-NBR             35960000
359700     END-IF.                                                      35970000
359800                                                                  35980000
359900     PERFORM S100-SELECT-TTRNCDE-DATA.                            35990000
360000                                                                  36000000
360100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        36010000
360200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       36020000
360300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        36030000
360400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      36040000
360500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        36050000
360600     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           36060000
360700     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             36070000
360800     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            36080000
360900                                                                  36090000
361000     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        36100000
361100     MOVE ZERO                       TO AP045-RETL-AMT            36110000
361200                                        AP045-GRO-COST-AMT        36120000
361300                                        AP045-MISC-CHRG-AMT       36130000
361400                                        AP045-FRGT-AMT            36140000
361500                                        AP045-TERM-DISC-PCT       36150000
361600                                        AP045-NW-STR-DISC-PCT     36160000
361700                                        AP045-TRD-DISC-PCT        36170000
361800                                        AP045-DTL-TERM-DISC-AMT   36180000
361900                                        AP045-DTL-NW-STR-DISC-AMT 36190000
362000                                        AP045-DTL-TRD-DISC-AMT    36200000
362100                                        AP045-MOS-DISC-PCT        36210000
362200                                        AP045-DTL-MOS-DISC-AMT.   36220000
362300                                                                  36230000
362400     IF RD-TOTAL-REC-COST > 0                                     36240000
362500       COMPUTE PV-DECIMAL-8 =                                     36250000
362600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   36260000
362700       COMPUTE AP045-DTL-TERM-DISC-AMT = (PV-DECIMAL-8 *          36270000
362800                        ID-TOTAL-MOS-DISC-AMT) + .005             36280000
362900     ELSE                                                         36290000
363000         MOVE ZERO TO AP045-DTL-TERM-DISC-AMT                     36300000
363100     END-IF.                                                      36310000
363200*----------------------------------------------------------------*36320000
363300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *36330000
363400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *36340000
363500* USE THE REMAINING TOTAL.                                       *36350000
363600*----------------------------------------------------------------*36360000
363700     IF MORE-RECEIPTS                                             36370000
363800         IF AP045-DTL-TERM-DISC-AMT > PV-MOS-DISC-AMT             36380000
363900             MOVE PV-MOS-DISC-AMT TO AP045-DTL-TERM-DISC-AMT      36390000
364000         END-IF                                                   36400000
364100                                                                  36410000
364200     ELSE                                                         36420000
364300*----------------------------------------------------------------*36430000
364400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *36440000
364500*----------------------------------------------------------------*36450000
364600         MOVE PV-MOS-DISC-AMT TO AP045-DTL-TERM-DISC-AMT          36460000
364700     END-IF.                                                      36470000
364800                                                                  36480000
364900     IF PV-MOS-DISC-AMT > 0                                       36490000
365000         SUBTRACT AP045-DTL-TERM-DISC-AMT FROM PV-MOS-DISC-AMT    36500000
365100     END-IF.                                                      36510000
365200                                                                  36520000
365300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     36530000
365400                                                                  36540000
365500     IF AP045-DTL-TERM-DISC-AMT > ZERO                            36550000
365600         PERFORM L200-FILL-AJ-FIELDS                              36560000
365700     END-IF.                                                      36570000
365800 EJECT                                                            36580000
365900                                                                  36590000
366000*----------------------------------------------------------------*36600000
366100*    BUILD TRD DISCOUNT TRANSACTION                              *36610000
366200*----------------------------------------------------------------*36620000
366300 K700-BUILD-TRD-DISC-ADJ.                                         36630000
366400                                                                  36640000
366500     MOVE '2C'                       TO AP045-AP-TRN-CDE.         36650000
366600                                                                  36660000
366700     PERFORM J950-CREATE-ADJ-DOC-NBR.                             36670000
366800                                                                  36680000
366900     IF RD-NON-INVC-RECEIPT                                       36690000
367000         IF RD-STR-NBR = 0                                        36700000
367100            MOVE 85                  TO AP045-STR-NBR             36710000
367200         ELSE                                                     36720000
367300            MOVE RD-STR-NBR          TO AP045-STR-NBR             36730000
367400         END-IF                                                   36740000
367500     ELSE                                                         36750000
367600         MOVE RD-STR-NBR             TO AP045-STR-NBR             36760000
367700     END-IF.                                                      36770000
367800                                                                  36780000
367900     PERFORM S100-SELECT-TTRNCDE-DATA.                            36790000
368000                                                                  36800000
368100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        36810000
368200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       36820000
368300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        36830000
368400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      36840000
368500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        36850000
368600     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           36860000
368700     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             36870000
368800     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            36880000
368900                                                                  36890000
369000     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        36900000
369100     MOVE ZERO                       TO AP045-RETL-AMT            36910000
369200                                        AP045-GRO-COST-AMT        36920000
369300                                        AP045-MISC-CHRG-AMT       36930000
369400                                        AP045-FRGT-AMT            36940000
369500                                        AP045-TERM-DISC-PCT       36950000
369600                                        AP045-NW-STR-DISC-PCT     36960000
369700                                        AP045-TRD-DISC-PCT        36970000
369800                                        AP045-DTL-TERM-DISC-AMT   36980000
369900                                        AP045-DTL-NW-STR-DISC-AMT 36990000
370000                                        AP045-DTL-TRD-DISC-AMT    37000000
370100                                        AP045-MOS-DISC-PCT        37010000
370200                                        AP045-DTL-MOS-DISC-AMT.   37020000
370300                                                                  37030000
370400     IF RD-TOTAL-REC-COST > 0                                     37040000
370500       COMPUTE PV-DECIMAL-8 =                                     37050000
370600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   37060000
370700       COMPUTE AP045-DTL-TERM-DISC-AMT = (PV-DECIMAL-8 *          37070000
370800                        ID-TOTAL-TRD-DISC-AMT) + .005             37080000
370900     ELSE                                                         37090000
371000         MOVE ZERO TO AP045-DTL-TERM-DISC-AMT                     37100000
371100     END-IF.                                                      37110000
371200*----------------------------------------------------------------*37120000
371300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *37130000
371400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *37140000
371500* USE THE REMAINING TOTAL.                                       *37150000
371600*----------------------------------------------------------------*37160000
371700     IF MORE-RECEIPTS                                             37170000
371800         IF AP045-DTL-TERM-DISC-AMT > PV-TRD-DISC-AMT             37180000
371900             MOVE PV-TRD-DISC-AMT TO AP045-DTL-TERM-DISC-AMT      37190000
372000         END-IF                                                   37200000
372100                                                                  37210000
372200     ELSE                                                         37220000
372300*----------------------------------------------------------------*37230000
372400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *37240000
372500*----------------------------------------------------------------*37250000
372600         MOVE PV-TRD-DISC-AMT TO AP045-DTL-TERM-DISC-AMT          37260000
372700     END-IF.                                                      37270000
372800                                                                  37280000
372900     IF PV-TRD-DISC-AMT > 0                                       37290000
373000         SUBTRACT AP045-DTL-TERM-DISC-AMT FROM PV-TRD-DISC-AMT    37300000
373100     END-IF.                                                      37310000
373200                                                                  37320000
373300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     37330000
373400                                                                  37340000
373500     IF AP045-DTL-TERM-DISC-AMT > ZERO                            37350000
373600         PERFORM L200-FILL-AJ-FIELDS                              37360000
373700     END-IF.                                                      37370000
373800 EJECT                                                            37380000
373900                                                                  37390000
374000*----------------------------------------------------------------*37400000
374100*    BUILD ALW DISCOUNT TRANSACTION                              *37410000
374200*----------------------------------------------------------------*37420000
374300 K800-BUILD-ALW-DISC-ADJ.                                         37430000
374400                                                                  37440000
374500     MOVE '2D'                       TO AP045-AP-TRN-CDE.         37450000
374600                                                                  37460000
374700     PERFORM J950-CREATE-ADJ-DOC-NBR.                             37470000
374800                                                                  37480000
374900     IF RD-NON-INVC-RECEIPT                                       37490000
375000         IF RD-STR-NBR = 0                                        37500000
375100            MOVE 85                  TO AP045-STR-NBR             37510000
375200         ELSE                                                     37520000
375300            MOVE RD-STR-NBR          TO AP045-STR-NBR             37530000
375400         END-IF                                                   37540000
375500     ELSE                                                         37550000
375600         MOVE RD-STR-NBR             TO AP045-STR-NBR             37560000
375700     END-IF.                                                      37570000
375800                                                                  37580000
375900     PERFORM S100-SELECT-TTRNCDE-DATA.                            37590000
376000                                                                  37600000
376100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        37610000
376200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       37620000
376300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        37630000
376400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      37640000
376500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        37650000
376600     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           37660000
376700     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             37670000
376800     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            37680000
376900                                                                  37690000
377000     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        37700000
377100     MOVE ZERO                       TO AP045-RETL-AMT            37710000
377200                                        AP045-GRO-COST-AMT        37720000
377300                                        AP045-MISC-CHRG-AMT       37730000
377400                                        AP045-FRGT-AMT            37740000
377500                                        AP045-TERM-DISC-PCT       37750000
377600                                        AP045-NW-STR-DISC-PCT     37760000
377700                                        AP045-TRD-DISC-PCT        37770000
377800                                        AP045-DTL-TERM-DISC-AMT   37780000
377900                                        AP045-DTL-NW-STR-DISC-AMT 37790000
378000                                        AP045-DTL-TRD-DISC-AMT    37800000
378100                                        AP045-MOS-DISC-PCT        37810000
378200                                        AP045-DTL-MOS-DISC-AMT.   37820000
378300                                                                  37830000
378400     IF RD-TOTAL-REC-COST > 0                                     37840000
378500       COMPUTE PV-DECIMAL-8 =                                     37850000
378600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   37860000
378700       COMPUTE AP045-DTL-TERM-DISC-AMT = (PV-DECIMAL-8 *          37870000
378800                        ID-TOTAL-ALW-DISC-AMT) + .005             37880000
378900     ELSE                                                         37890000
379000         MOVE ZERO TO AP045-DTL-TERM-DISC-AMT                     37900000
379100     END-IF.                                                      37910000
379200*----------------------------------------------------------------*37920000
379300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *37930000
379400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *37940000
379500* USE THE REMAINING TOTAL.                                       *37950000
379600*----------------------------------------------------------------*37960000
379700     IF MORE-RECEIPTS                                             37970000
379800         IF AP045-DTL-TERM-DISC-AMT > PV-ALW-DISC-AMT             37980000
379900             MOVE PV-ALW-DISC-AMT TO AP045-DTL-TERM-DISC-AMT      37990000
380000         END-IF                                                   38000000
380100                                                                  38010000
380200     ELSE                                                         38020000
380300*----------------------------------------------------------------*38030000
380400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *38040000
380500*----------------------------------------------------------------*38050000
380600         MOVE PV-ALW-DISC-AMT TO AP045-DTL-TERM-DISC-AMT          38060000
380700     END-IF.                                                      38070000
380800                                                                  38080000
380900     IF PV-ALW-DISC-AMT > 0                                       38090000
381000         SUBTRACT AP045-DTL-TERM-DISC-AMT FROM PV-ALW-DISC-AMT    38100000
381100     END-IF.                                                      38110000
381200                                                                  38120000
381300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     38130000
381400                                                                  38140000
381500     IF AP045-DTL-TERM-DISC-AMT > ZERO                            38150000
381600         PERFORM L200-FILL-AJ-FIELDS                              38160000
381700     END-IF.                                                      38170000
381800 EJECT                                                            38180000
381900                                                                  38190000
382000*----------------------------------------------------------------*38200000
382100*    BUILD MISC DISCOUNT TRANSACTION                             *38210000
382200*----------------------------------------------------------------*38220000
382300 K900-BUILD-MISC-DISC-ADJ.                                        38230000
382400                                                                  38240000
382500     MOVE '2E'                       TO AP045-AP-TRN-CDE.         38250000
382600                                                                  38260000
382700     PERFORM J950-CREATE-ADJ-DOC-NBR.                             38270000
382800                                                                  38280000
382900     IF RD-NON-INVC-RECEIPT                                       38290000
383000         IF RD-STR-NBR = 0                                        38300000
383100            MOVE 85                  TO AP045-STR-NBR             38310000
383200         ELSE                                                     38320000
383300            MOVE RD-STR-NBR          TO AP045-STR-NBR             38330000
383400         END-IF                                                   38340000
383500     ELSE                                                         38350000
383600         MOVE RD-STR-NBR             TO AP045-STR-NBR             38360000
383700     END-IF.                                                      38370000
383800                                                                  38380000
383900     PERFORM S100-SELECT-TTRNCDE-DATA.                            38390000
384000                                                                  38400000
384100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        38410000
384200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       38420000
384300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        38430000
384400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      38440000
384500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        38450000
384600     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           38460000
384700     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             38470000
384800     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            38480000
384900                                                                  38490000
385000     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        38500000
385100     MOVE ZERO                       TO AP045-RETL-AMT            38510000
385200                                        AP045-GRO-COST-AMT        38520000
385300                                        AP045-MISC-CHRG-AMT       38530000
385400                                        AP045-FRGT-AMT            38540000
385500                                        AP045-TERM-DISC-PCT       38550000
385600                                        AP045-NW-STR-DISC-PCT     38560000
385700                                        AP045-TRD-DISC-PCT        38570000
385800                                        AP045-DTL-TERM-DISC-AMT   38580000
385900                                        AP045-DTL-NW-STR-DISC-AMT 38590000
386000                                        AP045-DTL-TRD-DISC-AMT    38600000
386100                                        AP045-MOS-DISC-PCT        38610000
386200                                        AP045-DTL-MOS-DISC-AMT.   38620000
386300                                                                  38630000
386400     IF RD-TOTAL-REC-COST > 0                                     38640000
386500       COMPUTE PV-DECIMAL-8 =                                     38650000
386600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   38660000
386700       COMPUTE AP045-DTL-TERM-DISC-AMT = (PV-DECIMAL-8 *          38670000
386800                        ID-TOTAL-MISC-DISC-AMT) + .005            38680000
386900     ELSE                                                         38690000
387000         MOVE ZERO TO AP045-DTL-TERM-DISC-AMT                     38700000
387100     END-IF.                                                      38710000
387200*----------------------------------------------------------------*38720000
387300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *38730000
387400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *38740000
387500* USE THE REMAINING TOTAL.                                       *38750000
387600*----------------------------------------------------------------*38760000
387700     IF MORE-RECEIPTS                                             38770000
387800         IF AP045-DTL-TERM-DISC-AMT > PV-MISC-DISC-AMT            38780000
387900             MOVE PV-MISC-DISC-AMT TO AP045-DTL-TERM-DISC-AMT     38790000
388000         END-IF                                                   38800000
388100                                                                  38810000
388200     ELSE                                                         38820000
388300*----------------------------------------------------------------*38830000
388400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *38840000
388500*----------------------------------------------------------------*38850000
388600         MOVE PV-MISC-DISC-AMT TO AP045-DTL-TERM-DISC-AMT         38860000
388700     END-IF.                                                      38870000
388800                                                                  38880000
388900     IF PV-MISC-DISC-AMT > 0                                      38890000
389000         SUBTRACT AP045-DTL-TERM-DISC-AMT FROM PV-MISC-DISC-AMT   38900000
389100     END-IF.                                                      38910000
389200                                                                  38920000
389300     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     38930000
389400                                                                  38940000
389500     IF AP045-DTL-TERM-DISC-AMT > ZERO                            38950000
389600         PERFORM L200-FILL-AJ-FIELDS                              38960000
389700     END-IF.                                                      38970000
389800 EJECT                                                            38980000
389900                                                                  38990000
390000*----------------------------------------------------------------*39000000
390100*    BUILD DIRECT SHIP COST TO SHIP EXPENSE TRANSACTION          *39010030
390200*----------------------------------------------------------------*39020000
390300 K940-BUILD-DIRECT-SHIP-EXP-ADJ.                                  39030030
390400                                                                  39040000
390500     MOVE 'QR'                       TO AP045-AP-TRN-CDE.         39050031
390600     MOVE SPACE                      TO AP045-DEPT-NBR.           39060000
390700                                                                  39070000
390800     PERFORM J950-CREATE-ADJ-DOC-NBR.                             39080000
390900                                                                  39090000
391000     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            39100000
391100                                                                  39110000
391200     PERFORM S100-SELECT-TTRNCDE-DATA.                            39120000
391300                                                                  39130000
391400     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        39140000
391500     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       39150000
391600     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        39160000
391700     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      39170000
391800     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        39180000
391900     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        39190000
392000                                                                  39200000
392100     MOVE ID-TOTAL-DIRECT-SHIP-COST  TO AP045-GRO-COST-AMT.       39210030
392200     MOVE ZEROES                     TO AP045-RETL-AMT.           39220000
392300                                                                  39230000
392400     MOVE ZERO                       TO AP045-FRGT-AMT            39240000
392500                                        AP045-MISC-CHRG-AMT.      39250000
392600                                                                  39260000
392700     MOVE ZERO                       TO AP045-TERM-DISC-PCT       39270000
392800                                        AP045-NW-STR-DISC-PCT     39280000
392900                                        AP045-TRD-DISC-PCT        39290000
393000                                        AP045-DTL-TERM-DISC-AMT   39300000
393100                                        AP045-DTL-NW-STR-DISC-AMT 39310000
393200                                        AP045-DTL-TRD-DISC-AMT    39320000
393300                                        AP045-MOS-DISC-PCT        39330000
393400                                        AP045-DTL-MOS-DISC-AMT    39340000
393500                                        AP045-SKU-NBR.            39350000
393600                                                                  39360000
393700                                                                  39370000
393800     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     39380000
393900                                                                  39390000
394000     IF AP045-GRO-COST-AMT > ZERO                                 39400000
394100         PERFORM L200-FILL-AJ-FIELDS                              39410000
394200     END-IF.                                                      39420000
394300                                                                  39430000
394400 EJECT                                                            39440000
394410*----------------------------------------------------------------*39441074
394420*    BUILD PEPSI BOTTLE DEPOSIT EXPENSE TRANSACTION              *39442074
394430*----------------------------------------------------------------*39443074
394440 K945-BUILD-BOTTLE-DEPOSIT-ADJ.                                   39444074
394441                                                                  39444174
394442     MOVE 'AD'                       TO AP045-AP-TRN-CDE.         39444274
394443     MOVE SPACE                      TO AP045-DEPT-NBR.           39444374
394444                                                                  39444474
394445     PERFORM J950-CREATE-ADJ-DOC-NBR.                             39444574
394446                                                                  39444674
394447     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            39444774
394448                                                                  39444874
394449     PERFORM S100-SELECT-TTRNCDE-DATA.                            39444974
394450                                                                  39445074
394451     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        39445174
394452     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       39445274
394453     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        39445374
394454     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      39445474
394455     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        39445574
394456     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        39445674
394457                                                                  39445774
394458     MOVE ID-TOTAL-BOTTLE-DEPOSIT    TO AP045-GRO-COST-AMT.       39445874
394459     MOVE ZEROES                     TO AP045-RETL-AMT.           39445974
394460                                                                  39446074
394461     MOVE ZERO                       TO AP045-FRGT-AMT            39446174
394462                                        AP045-MISC-CHRG-AMT.      39446274
394463                                                                  39446374
394464     MOVE ZERO                       TO AP045-TERM-DISC-PCT       39446474
394465                                        AP045-NW-STR-DISC-PCT     39446574
394466                                        AP045-TRD-DISC-PCT        39446674
394467                                        AP045-DTL-TERM-DISC-AMT   39446774
394468                                        AP045-DTL-NW-STR-DISC-AMT 39446874
394469                                        AP045-DTL-TRD-DISC-AMT    39446974
394470                                        AP045-MOS-DISC-PCT        39447074
394471                                        AP045-DTL-MOS-DISC-AMT    39447174
394472                                        AP045-SKU-NBR.            39447274
394473                                                                  39447374
394474                                                                  39447474
394475     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     39447574
394476                                                                  39447674
394477     IF AP045-GRO-COST-AMT > ZERO                                 39447774
394478         PERFORM L200-FILL-AJ-FIELDS                              39447874
394479     END-IF.                                                      39447974
394480                                                                  39448074
394481 EJECT                                                            39448174
394482                                                                  39448274
394483*----------------------------------------------------------------*39448374
394484*    BUILD ALW DISCOUNT GL RECORD                                *39448474
394485*----------------------------------------------------------------*39448574
394486 K950-BUILD-ALW-DISC-ADJ.                                         39448674
394487                                                                  39448774
394488     MOVE '7B'                       TO AP045-AP-TRN-CDE.         39448874
394489     MOVE SPACE                      TO AP045-DEPT-NBR.           39448974
394490                                                                  39449030
394491     PERFORM J950-CREATE-ADJ-DOC-NBR.                             39449130
394492                                                                  39449230
394493     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            39449330
394494                                                                  39449430
394495     PERFORM S100-SELECT-TTRNCDE-DATA.                            39449530
394496                                                                  39449630
394497     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        39449730
394498     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       39449830
394499     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        39449930
394500     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      39450030
394501     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        39450130
394502     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        39450230
394503                                                                  39450330
394504     MOVE ID-TOTAL-ALW-DISC-AMT      TO AP045-GRO-COST-AMT.       39450430
394505     MOVE ZEROES                     TO AP045-RETL-AMT.           39450530
394506                                                                  39450630
394507     MOVE ZERO                       TO AP045-FRGT-AMT            39450730
394508                                        AP045-MISC-CHRG-AMT.      39450830
394509                                                                  39450930
394510     MOVE ZERO                       TO AP045-TERM-DISC-PCT       39451030
394511                                        AP045-NW-STR-DISC-PCT     39451130
394512                                        AP045-TRD-DISC-PCT        39451230
394513                                        AP045-DTL-TERM-DISC-AMT   39451330
394514                                        AP045-DTL-NW-STR-DISC-AMT 39451430
394515                                        AP045-DTL-TRD-DISC-AMT    39451530
394516                                        AP045-MOS-DISC-PCT        39451630
394517                                        AP045-DTL-MOS-DISC-AMT    39451730
394518                                        AP045-SKU-NBR.            39451830
394519                                                                  39451930
394520                                                                  39452030
394521     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     39452130
394522                                                                  39452230
394523     IF AP045-GRO-COST-AMT > ZERO                                 39452330
394524         PERFORM L200-FILL-AJ-FIELDS                              39452430
394525     END-IF.                                                      39452530
394526                                                                  39452630
394527 EJECT                                                            39452730
394618*----------------------------------------------------------------*39461830
394620*    BUILD ACTUAL LANDED COST ADJUSTMENT - TRAN CODE 37          *39462000
394700*                                                                *39470000
394800*    CALLED FROM B200-PROCESS-POS                                *39480000
394900*----------------------------------------------------------------*39490000
395000 K960-BUILD-ACTL-LND-CST-ADJ.                                     39500000
395100                                                                  39510000
395200     MOVE '37'                       TO AP045-AP-TRN-CDE.         39520000
395300                                                                  39530000
395400     MOVE 'ALC'                      TO PV-DOC-SUFFIX.            39540000
395500     STRING PV-PO-X        DELIMITED BY SIZE                      39550018
395600            PV-DOC-SUFFIX  DELIMITED BY SIZE                      39560000
395700                           INTO AP045-DOC-NBR.                    39570000
395800                                                                  39580000
395900     PERFORM S100-SELECT-TTRNCDE-DATA.                            39590000
396000                                                                  39600000
396100     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        39610000
396200     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       39620000
396300     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        39630000
396400     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      39640000
396500     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        39650000
396600     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            39660000
396700     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           39670000
396800     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             39680000
396900     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            39690000
397000                                                                  39700000
397100     IF RD-TOTAL-REC-COST > 0                                     39710000
397200       COMPUTE PV-DECIMAL-8 =                                     39720000
397300           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   39730000
397400       COMPUTE AP045-GRO-COST-AMT = (PV-DECIMAL-8 *               39740000
397500                        ID-ACTL-LANDED-COST-AMT) + .005           39750000
397600     ELSE                                                         39760000
397700         MOVE ZERO TO AP045-GRO-COST-AMT                          39770000
397800     END-IF.                                                      39780000
397900                                                                  39790000
398000*----------------------------------------------------------------*39800000
398100* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *39810000
398200* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *39820000
398300* USE THE REMAINING TOTAL.                                       *39830000
398400*----------------------------------------------------------------*39840000
398500     IF MORE-RECEIPTS                                             39850000
398600         IF AP045-GRO-COST-AMT > PV-ACTL-LANDED-COST-AMT          39860000
398700             MOVE PV-ACTL-LANDED-COST-AMT TO AP045-GRO-COST-AMT   39870000
398800         END-IF                                                   39880000
398900                                                                  39890000
399000     ELSE                                                         39900000
399100*----------------------------------------------------------------*39910000
399200* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *39920000
399300*----------------------------------------------------------------*39930000
399400         MOVE PV-ACTL-LANDED-COST-AMT TO AP045-GRO-COST-AMT       39940000
399500     END-IF.                                                      39950000
399600                                                                  39960000
399700     IF PV-ACTL-LANDED-COST-AMT > 0                               39970000
399800         SUBTRACT AP045-GRO-COST-AMT                              39980000
399900             FROM PV-ACTL-LANDED-COST-AMT                         39990000
400000     END-IF.                                                      40000000
400100                                                                  40010000
400200                                                                  40020000
400300     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        40030000
400400                                                                  40040000
400500     MOVE ZERO                       TO AP045-RETL-AMT            40050000
400600                                        AP045-FRGT-AMT            40060000
400700                                        AP045-MISC-CHRG-AMT       40070000
400800                                        AP045-TERM-DISC-PCT       40080000
400900                                        AP045-NW-STR-DISC-PCT     40090000
401000                                        AP045-TRD-DISC-PCT        40100000
401100                                        AP045-DTL-TERM-DISC-AMT   40110000
401200                                        AP045-DTL-NW-STR-DISC-AMT 40120000
401300                                        AP045-DTL-TRD-DISC-AMT    40130000
401400                                        AP045-MOS-DISC-PCT        40140000
401500                                        AP045-DTL-MOS-DISC-AMT.   40150000
401600                                                                  40160000
401700     MOVE SPACES                     TO AP045-BAR-CDE.            40170000
401800     MOVE '00'                       TO AP045-PS-BTCH-SEQ-NBR.    40180000
401900     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE      40190000
402000                                        AP045-PS-BTCH-DTE.        40200000
402100     SET AP045-ORGN-IMPORT           TO TRUE.                     40210000
402200                                                                  40220000
402300     IF AP045-GRO-COST-AMT > ZERO                                 40230000
402400         PERFORM L200-FILL-AJ-FIELDS                              40240000
402500     END-IF.                                                      40250000
402600                                                                  40260000
402700*----------------------------------------------------------------*40270000
402800*    BUILD PRIVATE LABEL LOAD ADJUSTMENT - TRAN CODE 4A          *40280000
402900*                                                                *40290000
403000*    CALLED FROM B200-PROCESS-POS                                *40300000
403100*----------------------------------------------------------------*40310000
403200 K970-BUILD-PRVT-LBL-LOAD-ADJ.                                    40320000
403300                                                                  40330000
403400     MOVE '4A'                       TO AP045-AP-TRN-CDE.         40340000
403500                                                                  40350000
403600     MOVE 'LDP'                      TO PV-DOC-SUFFIX.            40360000
403700     STRING PV-PO-X        DELIMITED BY SIZE                      40370018
403800            PV-DOC-SUFFIX  DELIMITED BY SIZE                      40380000
403900                           INTO AP045-DOC-NBR.                    40390000
404000                                                                  40400000
404100     PERFORM S100-SELECT-TTRNCDE-DATA.                            40410000
404200                                                                  40420000
404300     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        40430000
404400     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       40440000
404500     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        40450000
404600     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      40460000
404700     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        40470000
404800     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            40480000
404900     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           40490000
405000     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             40500000
405100     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            40510000
405200                                                                  40520000
405300     IF RD-TOTAL-REC-COST > 0                                     40530000
405400       COMPUTE PV-DECIMAL-8 =                                     40540000
405500           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   40550000
405600       COMPUTE AP045-GRO-COST-AMT = (PV-DECIMAL-8 *               40560000
405700                        ID-PRIVATE-LBL-LOAD-AMT) + .005           40570000
405800     ELSE                                                         40580000
405900         MOVE ZERO TO AP045-GRO-COST-AMT                          40590000
406000     END-IF.                                                      40600000
406100                                                                  40610000
406200*----------------------------------------------------------------*40620000
406300* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *40630000
406400* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *40640000
406500* USE THE REMAINING TOTAL.                                       *40650000
406600*----------------------------------------------------------------*40660000
406700     IF MORE-RECEIPTS                                             40670000
406800         IF AP045-GRO-COST-AMT > PV-PRIVATE-LBL-LOAD-AMT          40680000
406900             MOVE PV-PRIVATE-LBL-LOAD-AMT TO AP045-GRO-COST-AMT   40690000
407000         END-IF                                                   40700000
407100                                                                  40710000
407200     ELSE                                                         40720000
407300*----------------------------------------------------------------*40730000
407400* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *40740000
407500*----------------------------------------------------------------*40750000
407600         MOVE PV-PRIVATE-LBL-LOAD-AMT TO AP045-GRO-COST-AMT       40760000
407700     END-IF.                                                      40770000
407800                                                                  40780000
407900     IF PV-PRIVATE-LBL-LOAD-AMT > 0                               40790000
408000         SUBTRACT AP045-GRO-COST-AMT FROM PV-PRIVATE-LBL-LOAD-AMT 40800000
408100     END-IF.                                                      40810000
408200                                                                  40820000
408300                                                                  40830000
408400     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        40840000
408500                                                                  40850000
408600     MOVE ZERO                       TO AP045-RETL-AMT            40860000
408700                                        AP045-FRGT-AMT            40870000
408800                                        AP045-MISC-CHRG-AMT       40880000
408900                                        AP045-TERM-DISC-PCT       40890000
409000                                        AP045-NW-STR-DISC-PCT     40900000
409100                                        AP045-TRD-DISC-PCT        40910000
409200                                        AP045-DTL-TERM-DISC-AMT   40920000
409300                                        AP045-DTL-NW-STR-DISC-AMT 40930000
409400                                        AP045-DTL-TRD-DISC-AMT    40940000
409500                                        AP045-MOS-DISC-PCT        40950000
409600                                        AP045-DTL-MOS-DISC-AMT.   40960000
409700                                                                  40970000
409800     MOVE SPACES                     TO AP045-BAR-CDE.            40980000
409900     MOVE '00'                       TO AP045-PS-BTCH-SEQ-NBR.    40990000
410000     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE      41000000
410100                                        AP045-PS-BTCH-DTE.        41010000
410200     SET AP045-ORGN-IMPORT           TO TRUE.                     41020000
410300                                                                  41030000
410400     IF AP045-GRO-COST-AMT > ZERO                                 41040000
410500         PERFORM L200-FILL-AJ-FIELDS                              41050000
410600     END-IF.                                                      41060000
410700                                                                  41070000
410800*----------------------------------------------------------------*41080000
410900*    BUILD FIRST COST LOAD ADJUSTMENT - TRAN CODE 40             *41090000
411000*                                                                *41100000
411100*    CALLED FROM B200-PROCESS-POS                                *41110000
411200*----------------------------------------------------------------*41120000
411300 K980-BUILD-FIRST-COST-LOAD-ADJ.                                  41130000
411400                                                                  41140000
411500     MOVE '40'                       TO AP045-AP-TRN-CDE.         41150000
411600                                                                  41160000
411700     MOVE 'LD1'                      TO PV-DOC-SUFFIX.            41170000
411800     STRING PV-PO-X        DELIMITED BY SIZE                      41180018
411900            PV-DOC-SUFFIX  DELIMITED BY SIZE                      41190000
412000                           INTO AP045-DOC-NBR.                    41200000
412100                                                                  41210000
412200     PERFORM S100-SELECT-TTRNCDE-DATA.                            41220000
412300                                                                  41230000
412400     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        41240000
412500     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       41250000
412600     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        41260000
412700     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      41270000
412800     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        41280000
412900     MOVE RD-STR-NBR                 TO AP045-STR-NBR.            41290000
413000     MOVE PURCHS-DEPT-NBR            TO AP045-DEPT-NBR.           41300000
413100     MOVE RD-CLASS-NBR               TO AP045-CL-NBR.             41310000
413200     MOVE RD-SKU-NBR                 TO AP045-SKU-NBR.            41320000
413300                                                                  41330000
413400     IF RD-TOTAL-REC-COST > 0                                     41340000
413500       COMPUTE PV-DECIMAL-8 =                                     41350000
413600           (RD-TOTAL-COST /  RD-TOTAL-REC-COST)                   41360000
413700       COMPUTE AP045-GRO-COST-AMT = (PV-DECIMAL-8 *               41370000
413800                        ID-FIRST-COST-LOAD-AMT) + .005            41380000
413900     ELSE                                                         41390000
414000         MOVE ZERO TO AP045-GRO-COST-AMT                          41400000
414100     END-IF.                                                      41410000
414200                                                                  41420000
414300*----------------------------------------------------------------*41430000
414400* IF THERE ARE MORE RECEIPTS TO PROCESS, CHECK TO SEE IF THE     *41440000
414500* CALCULATED AMOUNT IS MORE THAN THE REMAINING TOTAL AND IF SO   *41450000
414600* USE THE REMAINING TOTAL.                                       *41460000
414700*----------------------------------------------------------------*41470000
414800     IF MORE-RECEIPTS                                             41480000
414900         IF AP045-GRO-COST-AMT > PV-FIRST-COST-LOAD-AMT           41490000
415000             MOVE PV-FIRST-COST-LOAD-AMT TO AP045-GRO-COST-AMT    41500000
415100         END-IF                                                   41510000
415200                                                                  41520000
415300     ELSE                                                         41530000
415400*----------------------------------------------------------------*41540000
415500* IF THIS IS THE LAST RECEIPT, USE THE REMAINING PRORATED AMOUNT *41550000
415600*----------------------------------------------------------------*41560000
415700         MOVE PV-FIRST-COST-LOAD-AMT TO AP045-GRO-COST-AMT        41570000
415800     END-IF.                                                      41580000
415900                                                                  41590000
416000     IF PV-FIRST-COST-LOAD-AMT > 0                                41600000
416100         SUBTRACT AP045-GRO-COST-AMT FROM PV-FIRST-COST-LOAD-AMT  41610000
416200     END-IF.                                                      41620000
416300                                                                  41630000
416400                                                                  41640000
416500     MOVE SPACE                      TO AP045-GL-ACCT-NBR.        41650000
416600                                                                  41660000
416700     MOVE ZERO                       TO AP045-RETL-AMT            41670000
416800                                        AP045-FRGT-AMT            41680000
416900                                        AP045-MISC-CHRG-AMT       41690000
417000                                        AP045-TERM-DISC-PCT       41700000
417100                                        AP045-NW-STR-DISC-PCT     41710000
417200                                        AP045-TRD-DISC-PCT        41720000
417300                                        AP045-DTL-TERM-DISC-AMT   41730000
417400                                        AP045-DTL-NW-STR-DISC-AMT 41740000
417500                                        AP045-DTL-TRD-DISC-AMT    41750000
417600                                        AP045-MOS-DISC-PCT        41760000
417700                                        AP045-DTL-MOS-DISC-AMT.   41770000
417800                                                                  41780000
417900     MOVE SPACES                     TO AP045-BAR-CDE.            41790000
418000     MOVE '00'                       TO AP045-PS-BTCH-SEQ-NBR.    41800000
418100     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE      41810000
418200                                        AP045-PS-BTCH-DTE.        41820000
418300     SET AP045-ORGN-IMPORT           TO TRUE.                     41830000
418400                                                                  41840000
418500     IF AP045-GRO-COST-AMT > ZERO                                 41850000
418600         PERFORM L200-FILL-AJ-FIELDS                              41860000
418700     END-IF.                                                      41870000
418800 EJECT                                                            41880000
418900*----------------------------------------------------------------*41890000
419000*    THE ADJUSTMENT JOURNAL FIELDS ARE FILLED AND THE RECORD IS  *41900000
419100*    WRITTEN OUT.                                                *41910000
419200*    CALLED FROM EACH PARAGRAPH THAT IS BUILDING AN ADJUSTMENT   *41920031
419300*    OUTPUT RECORD TO FILL THE COMMON FIELDS ON THE RECORD.      *41930031
420500*----------------------------------------------------------------*42050000
420600 L200-FILL-AJ-FIELDS.                                             42060000
420700                                                                  42070000
420800                                                                  42080000
420900     MOVE EXTENT-DUN-NBR               TO AP045-VND-NBR.          42090000
421000     MOVE PV-PO-9-X                    TO AP045-PO-NBR.           42100000
421100     MOVE PV-CURR-DB2-DATE             TO AP045-DOC-DTE.          42110000
421200                                                                  42120000
421300     IF  AP045-AP-TRN-CDE = '0B'                                  42130000
421400         MOVE APCNTL-NEXT-BTCH-PRC-DTE TO AP045-ENTR-DTE          42140000
421500         MOVE 'Y'                      TO AP045-AUTO-OTP-PSTG-IND 42150000
421600     ELSE                                                         42160000
421700         MOVE PV-CURR-DB2-DATE         TO AP045-ENTR-DTE          42170000
421800         MOVE 'N'                      TO AP045-AUTO-OTP-PSTG-IND 42180000
421900     END-IF.                                                      42190000
422000                                                                  42200000
422100     MOVE '-22.00.00.000000'           TO AP045-ENTR-TME.         42210000
422200                                                                  42220000
422300     SET AP045-DETAIL-RECORD           TO TRUE.                   42230000
422400                                                                  42240000
422500     IF AP045-ORGN-CDE = 'I'                                      42250000
422600        IF PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF')             42260000
422700           CONTINUE                                               42270000
422800        ELSE                                                      42280000
422900           SET AP045-ORGN-MDSE         TO TRUE                    42290000
423000        END-IF                                                    42300000
423100     ELSE                                                         42310000
423200        SET AP045-ORGN-MDSE            TO TRUE                    42320000
423300     END-IF.                                                      42330000
423400                                                                  42340000
423500     MOVE PV-PROGRAM-NAME              TO AP045-ENTR-ID.          42350000
423600                                                                  42360000
423700     MOVE PURCHS-ENT-ID                TO AP045-ENT-ID.           42370000
423800     MOVE ENTNME-ENT-NAME-DESC         TO AP045-ENT-NME-DESC.     42380000
423900                                                                  42390000
424000     MOVE APCNTL-CURR-PSTG-FYR-NBR     TO AP045-PSTG-FYR-NBR.     42400000
424100     MOVE APCNTL-CURR-PSTG-FMN-NBR     TO AP045-PSTG-FMN-NBR.     42410000
424200     MOVE APCNTL-CURR-PSTG-FWK-NBR     TO AP045-PSTG-FWK-NBR.     42420000
424300                                                                  42430000
424400     COMPUTE AP045-NET-COST-AMT = (AP045-GRO-COST-AMT             42440000
424500                  + AP045-FRGT-AMT + AP045-MISC-CHRG-AMT          42450000
424600                  - AP045-DTL-TERM-DISC-AMT                       42460000
424700                  - AP045-DTL-NW-STR-DISC-AMT                     42470000
424800                  - AP045-DTL-TRD-DISC-AMT                        42480000
424900                  - AP045-DTL-MOS-DISC-AMT).                      42490000
425000                                                                  42500000
425100     IF AP045-CREDIT                                              42510000
425200        IF AP045-NET-COST-AMT > 0                                 42520000
425300           MULTIPLY -1 BY AP045-NET-COST-AMT                      42530000
425400        END-IF                                                    42540000
425500        IF AP045-GRO-COST-AMT > 0                                 42550000
425600           MULTIPLY -1 BY AP045-GRO-COST-AMT                      42560000
425700        END-IF                                                    42570000
425800        IF AP045-FRGT-AMT > 0                                     42580000
425900           MULTIPLY -1 BY AP045-FRGT-AMT                          42590000
426000        END-IF                                                    42600000
426100        IF AP045-MISC-CHRG-AMT > 0                                42610000
426200           MULTIPLY -1 BY AP045-MISC-CHRG-AMT                     42620000
426300        END-IF                                                    42630000
426400        IF AP045-DTL-TERM-DISC-AMT > 0                            42640000
426500           MULTIPLY -1 BY AP045-DTL-TERM-DISC-AMT                 42650000
426600        END-IF                                                    42660000
426700        IF AP045-DTL-NW-STR-DISC-AMT > 0                          42670000
426800           MULTIPLY -1 BY AP045-DTL-NW-STR-DISC-AMT               42680000
426900        END-IF                                                    42690000
427000        IF AP045-DTL-TRD-DISC-AMT > 0                             42700000
427100           MULTIPLY -1 BY AP045-DTL-TRD-DISC-AMT                  42710000
427200        END-IF                                                    42720000
427300        IF AP045-DTL-MOS-DISC-AMT > 0                             42730000
427400           MULTIPLY -1 BY AP045-DTL-MOS-DISC-AMT                  42740000
427500        END-IF                                                    42750000
427600     END-IF.                                                      42760000
427700                                                                  42770000
427800     IF  AP045-TERM-DISC-PCT       = 0                            42780000
427900     AND AP045-NW-STR-DISC-PCT     = 0                            42790000
428000     AND AP045-TRD-DISC-PCT        = 0                            42800000
428100     AND AP045-RETL-AMT            = 0                            42810000
428200     AND AP045-GRO-COST-AMT        = 0                            42820024
428300     AND AP045-FRGT-AMT            = 0                            42830000
428400     AND AP045-MISC-CHRG-AMT       = 0                            42840000
428500     AND AP045-NET-COST-AMT        = 0                            42850000
428600     AND AP045-DTL-TERM-DISC-AMT   = 0                            42860000
428700     AND AP045-DTL-NW-STR-DISC-AMT = 0                            42870000
428800     AND AP045-DTL-TRD-DISC-AMT    = 0                            42880000
428900     AND AP045-MOS-DISC-PCT        = 0                            42890000
429000     AND AP045-DTL-MOS-DISC-AMT    = 0                            42900000
429100         ADD 1 TO PV-ZERO-AMTS-AP045-COUNT                        42910000
429200     ELSE                                                         42920000
429300         PERFORM U100-INSERT-ADJ-JRNL-TRAN                        42930000
429400     END-IF.                                                      42940000
429500                                                                  42950000
429600     INITIALIZE AP045-TRANSACTION-FILE.                           42960000
429700 EJECT                                                            42970000
429710*----------------------------------------------------------------*42971040
429720*   BUILD THE TRANSACTION TO REVERSE THE INVOICE GROSS COST FROM *42972040
429730*   THE SEPHORA PREPAID GL ACCOUNT.                              *42973040
429740*----------------------------------------------------------------*42974040
429750 L300-BUILD-SEPHORA-PPD-RVRSL.                                    42975043
429760                                                                  42976040
429770     MOVE 'QT'                       TO AP045-AP-TRN-CDE.         42977045
429780     MOVE SPACE                      TO AP045-DEPT-NBR.           42978040
429790                                                                  42979040
429791     PERFORM J950-CREATE-ADJ-DOC-NBR.                             42979140
429792                                                                  42979240
429793     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            42979340
429794                                                                  42979440
429795     PERFORM S100-SELECT-TTRNCDE-DATA.                            42979540
429796                                                                  42979640
429797     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        42979740
429798     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       42979840
429799     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        42979940
429800     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      42980040
429801     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        42980140
429802     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        42980240
429803                                                                  42980340
429804     MOVE ID-TOTAL-SEPHORA-INVC-AMT  TO AP045-GRO-COST-AMT.       42980445
429805     MOVE ZEROES                     TO AP045-RETL-AMT.           42980540
429806                                                                  42980640
429807     MOVE ZERO                       TO AP045-FRGT-AMT            42980740
429808                                        AP045-MISC-CHRG-AMT.      42980840
429809                                                                  42980940
429810     MOVE ZERO                       TO AP045-TERM-DISC-PCT       42981040
429811                                        AP045-NW-STR-DISC-PCT     42981140
429812                                        AP045-TRD-DISC-PCT        42981240
429813                                        AP045-DTL-TERM-DISC-AMT   42981340
429814                                        AP045-DTL-NW-STR-DISC-AMT 42981440
429815                                        AP045-DTL-TRD-DISC-AMT    42981540
429816                                        AP045-MOS-DISC-PCT        42981640
429817                                        AP045-DTL-MOS-DISC-AMT    42981740
429818                                        AP045-SKU-NBR.            42981840
429819                                                                  42981940
429820                                                                  42982040
429821     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     42982140
429822                                                                  42982240
429823     IF AP045-GRO-COST-AMT > ZERO                                 42982340
429824         PERFORM L200-FILL-AJ-FIELDS                              42982440
429825     END-IF.                                                      42982540
429826                                                                  42982640
429827 EJECT                                                            42982740
429828*----------------------------------------------------------------*42982840
429829*    BUILD THE SEPHORA EXPENSE TRANSACTION FOR THE DISCOUNT      *42982945
429830*----------------------------------------------------------------*42983040
429831 L400-BUILD-SEPHORA-DISC.                                         42983143
429833                                                                  42983340
429834     MOVE 'QV'                       TO AP045-AP-TRN-CDE.         42983445
429835     MOVE SPACE                      TO AP045-DEPT-NBR.           42983540
429836                                                                  42983640
429837     PERFORM J950-CREATE-ADJ-DOC-NBR.                             42983740
429838                                                                  42983840
429839     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            42983940
429840                                                                  42984040
429841     PERFORM S100-SELECT-TTRNCDE-DATA.                            42984140
429842                                                                  42984240
429843     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        42984340
429844     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       42984440
429845     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        42984540
429846     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      42984640
429847     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        42984740
429848     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        42984840
429849                                                                  42984940
429850     MULTIPLY ID-SEPHORA-TERMS-DISC-PCT BY                        42985045
429851             ID-TOTAL-SEPHORA-INVC-AMT                            42985145
429854                               GIVING   AP045-GRO-COST-AMT.       42985450
429855     MOVE ZEROES                     TO AP045-RETL-AMT.           42985550
429856                                                                  42985650
429857     MOVE ZERO                       TO AP045-FRGT-AMT            42985750
429858                                        AP045-MISC-CHRG-AMT.      42985850
429859                                                                  42985950
429862*    MOVE ID-DISCOUNT-PCT            TO AP045-TERM-DISC-PCT       42986250
429863     MOVE ZERO                       TO AP045-NW-STR-DISC-PCT     42986350
429864                                        AP045-TERM-DISC-PCT       42986450
429865                                        AP045-TRD-DISC-PCT        42986550
429866                                        AP045-DTL-TERM-DISC-AMT   42986650
429867                                        AP045-DTL-NW-STR-DISC-AMT 42986750
429868                                        AP045-DTL-TRD-DISC-AMT    42986850
429869                                        AP045-MOS-DISC-PCT        42986950
429870                                        AP045-DTL-MOS-DISC-AMT    42987050
429871                                        AP045-SKU-NBR.            42987150
429872                                                                  42987250
429873                                                                  42987350
429874     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     42987450
429875                                                                  42987550
429876     IF AP045-GRO-COST-AMT > ZERO                                 42987650
429877         PERFORM L200-FILL-AJ-FIELDS                              42987750
429878     END-IF.                                                      42987850
429879                                                                  42987950
429880 EJECT                                                            42988050
429881*----------------------------------------------------------------*42988150
429882*    BUILD THE SEPHORA EXPENSE TRAN FOR THE DISCOUNT OFFSET      *42988250
429883*----------------------------------------------------------------*42988350
429884 L500-BUILD-SEPHORA-DISC-OFFSET.                                  42988450
429887                                                                  42988750
429890     MOVE 'QU'                       TO AP045-AP-TRN-CDE.         42989045
429900     MOVE SPACE                      TO AP045-DEPT-NBR.           42990045
429910                                                                  42991045
429911     PERFORM J950-CREATE-ADJ-DOC-NBR.                             42991145
429912     STRING AP045-DOC-NBR, 'OFF '                                 42991245
429913       DELIMITED BY ' '                                           42991345
429914       INTO AP045-DOC-NBR                                         42991445
429915     END-STRING.                                                  42991545
429916                                                                  42991645
429917     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            42991745
429918                                                                  42991845
429919     PERFORM S100-SELECT-TTRNCDE-DATA.                            42991945
429920                                                                  42992045
429921     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        42992145
429922     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       42992245
429923     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        42992345
429924     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      42992445
429925     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        42992545
429926     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        42992645
429927                                                                  42992745
429928     MULTIPLY ID-SEPHORA-TERMS-DISC-PCT BY                        42992845
429929             ID-TOTAL-SEPHORA-INVC-AMT                            42992945
429932                               GIVING   AP045-GRO-COST-AMT.       42993245
429933     MOVE ZEROES                     TO AP045-RETL-AMT.           42993345
429934                                                                  42993445
429935     MOVE ZERO                       TO AP045-FRGT-AMT            42993545
429936                                        AP045-MISC-CHRG-AMT.      42993645
429937                                                                  42993745
429940*    MOVE ID-DISCOUNT-PCT            TO AP045-TERM-DISC-PCT       42994049
429941     MOVE ZERO                       TO AP045-NW-STR-DISC-PCT     42994145
429942                                        AP045-TERM-DISC-PCT       42994250
429943                                        AP045-TRD-DISC-PCT        42994345
429944                                        AP045-DTL-TERM-DISC-AMT   42994445
429945                                        AP045-DTL-NW-STR-DISC-AMT 42994545
429946                                        AP045-DTL-TRD-DISC-AMT    42994645
429947                                        AP045-MOS-DISC-PCT        42994745
429948                                        AP045-DTL-MOS-DISC-AMT    42994845
429949                                        AP045-SKU-NBR.            42994945
429950                                                                  42995045
429951                                                                  42995145
429952     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     42995245
429953                                                                  42995345
429954     IF AP045-GRO-COST-AMT > ZERO                                 42995445
429955         PERFORM L200-FILL-AJ-FIELDS                              42995545
429956     END-IF.                                                      42995645
429957                                                                  42995745
429958                                                                  42995840
429959 EJECT                                                            42995940
429960*----------------------------------------------------------------*42996045
429961*    BUILD SEPHORA ADJUSTMENT TO DISCOUNT - THIS IS WHEN THE     *42996145
429962*     PO RECONCILIATION IDENTIFIED A SHORTAGE AND CREATED A      *42996250
429963*     CHARGEBACK TO THE VENDOR.                                  *42996350
429964*    CALC FOR AP045-GRO-COST-AMT DIVIDES BY 100 BECAUSE          *42996450
429965*     ID-DISCOUNT-PCT IS POSTRR-WEIGHTED-DISC-PCT * 100          *42996550
429966*----------------------------------------------------------------*42996650
429967 L600-BUILD-SEPHORA-RI-DISC-ADJ.                                  42996750
429969                                                                  42996950
429970     MOVE 'QW'                       TO AP045-AP-TRN-CDE.         42997050
429971     MOVE SPACE                      TO AP045-DEPT-NBR.           42997150
429972                                                                  42997250
429973     PERFORM J950-CREATE-ADJ-DOC-NBR.                             42997350
429974                                                                  42997450
429975     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            42997550
429976                                                                  42997650
429977     PERFORM S100-SELECT-TTRNCDE-DATA.                            42997750
429978                                                                  42997850
429979     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        42997950
429980     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       42998050
429981     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        42998150
429982     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      42998250
429983     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        42998350
429984     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        42998450
429985                                                                  42998550
429986     MULTIPLY ID-DISCOUNT-PCT BY ID-TOTAL-RI                      42998650
429987                               GIVING   PV-CALC-COST.             42998750
429988     DIVIDE PV-CALC-COST BY 100                                   42998850
429989                               GIVING   AP045-GRO-COST-AMT.       42998950
429990     MOVE ZEROES                     TO AP045-RETL-AMT.           42999050
429991                                                                  42999150
429992     MOVE ZERO                       TO AP045-FRGT-AMT            42999250
429993                                        AP045-MISC-CHRG-AMT.      42999350
429994                                                                  42999450
429995*    MOVE ID-DISCOUNT-PCT            TO AP045-TERM-DISC-PCT       42999550
429996     MOVE ZERO                       TO AP045-NW-STR-DISC-PCT     42999645
429997                                        AP045-TERM-DISC-PCT       42999750
429998                                        AP045-TRD-DISC-PCT        42999845
429999                                        AP045-DTL-TERM-DISC-AMT   42999945
430000                                        AP045-DTL-NW-STR-DISC-AMT 43000045
430001                                        AP045-DTL-TRD-DISC-AMT    43000145
430002                                        AP045-MOS-DISC-PCT        43000245
430003                                        AP045-DTL-MOS-DISC-AMT    43000345
430004                                        AP045-SKU-NBR.            43000445
430006                                                                  43000645
430007     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     43000745
430008                                                                  43000845
430009     IF AP045-GRO-COST-AMT > ZERO                                 43000945
430010         PERFORM L200-FILL-AJ-FIELDS                              43001045
430011     END-IF.                                                      43001145
430012                                                                  43001245
430013 EJECT                                                            43001345
430014*----------------------------------------------------------------*43001445
430015*    BUILD SEPHORA ADJUSTMENT TO DISCOUNT - THIS IS WHEN THE     *43001545
430016*     PO RECONCILIATION IDENTIFIED A PRICE CLAIM AND CREATED A   *43001650
430017*     CHARGEBACK TO THE VENDOR                                   *43001750
430018*    CALC FOR AP045-GRO-COST-AMT DIVIDES BY 100 BECAUSE          *43001850
430019*     ID-DISCOUNT-PCT IS POSTRR-WEIGHTED-DISC-PCT * 100          *43001950
430020*----------------------------------------------------------------*43002045
430021 L700-BUILD-SEPHORA-PC-DISC-ADJ.                                  43002145
430023                                                                  43002345
430024     MOVE 'QW'                       TO AP045-AP-TRN-CDE.         43002445
430025     MOVE SPACE                      TO AP045-DEPT-NBR.           43002545
430026                                                                  43002645
430027     PERFORM J950-CREATE-ADJ-DOC-NBR.                             43002745
430028                                                                  43002845
430029     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            43002945
430030                                                                  43003045
430031     PERFORM S100-SELECT-TTRNCDE-DATA.                            43003145
430032                                                                  43003245
430033     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        43003345
430034     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       43003445
430035     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        43003545
430036     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      43003645
430037     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        43003745
430038     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        43003845
430039                                                                  43003945
430040     MULTIPLY ID-DISCOUNT-PCT BY ID-TOTAL-PC                      43004052
430041                               GIVING   PV-CALC-COST.             43004150
430042     DIVIDE PV-CALC-COST BY 100                                   43004250
430043                               GIVING   AP045-GRO-COST-AMT.       43004345
430044     MOVE ZEROES                     TO AP045-RETL-AMT.           43004445
430045                                                                  43004545
430046     MOVE ZERO                       TO AP045-FRGT-AMT            43004645
430047                                        AP045-MISC-CHRG-AMT.      43004745
430048                                                                  43004845
430049*    MOVE ID-DISCOUNT-PCT            TO AP045-TERM-DISC-PCT       43004950
430050     MOVE ZERO                       TO AP045-NW-STR-DISC-PCT     43005045
430051                                        AP045-TERM-DISC-PCT       43005150
430052                                        AP045-TRD-DISC-PCT        43005245
430053                                        AP045-DTL-TERM-DISC-AMT   43005345
430054                                        AP045-DTL-NW-STR-DISC-AMT 43005445
430055                                        AP045-DTL-TRD-DISC-AMT    43005545
430056                                        AP045-MOS-DISC-PCT        43005645
430057                                        AP045-DTL-MOS-DISC-AMT    43005745
430058                                        AP045-SKU-NBR.            43005845
430059                                                                  43005945
430060                                                                  43006045
430061     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     43006145
430062                                                                  43006245
430063     IF AP045-GRO-COST-AMT > ZERO                                 43006345
430064         PERFORM L200-FILL-AJ-FIELDS                              43006445
430065     END-IF.                                                      43006545
430066                                                                  43006645
430067 EJECT                                                            43006745
430068*----------------------------------------------------------------*43006845
430069*    BUILD SEPHORA ADJUSTMENT TO DISCOUNT - THIS IS WHEN THE     *43006945
430070*    PO RECONCILIATION IDENTIFIED A SHORTAGE CHARGEBACK IS       *43007045
430071*    REPAID TO THE VENDOR                                        *43007145
430072*----------------------------------------------------------------*43007245
430073 L800-BLD-SEPHORA-REPAY-DSC-ADJ.                                  43007346
430075                                                                  43007545
430076     MOVE 'QX'                       TO AP045-AP-TRN-CDE.         43007645
430077     MOVE SPACE                      TO AP045-DEPT-NBR.           43007745
430078                                                                  43007845
430079     PERFORM J950-CREATE-ADJ-DOC-NBR.                             43007945
430080                                                                  43008045
430081     MOVE ID-DEFAULT-STR-X           TO AP045-STR-NBR.            43008145
430082                                                                  43008245
430083     PERFORM S100-SELECT-TTRNCDE-DATA.                            43008345
430084                                                                  43008445
430085     MOVE TRNCDE-TRN-TYP-CDE         TO AP045-TRN-TYP-CDE.        43008545
430086     MOVE TRNCDE-PSTG-TYP-CDE        TO AP045-PSTG-TYP-CDE.       43008645
430087     MOVE TRNCDE-AP-PSTG-IND         TO AP045-AP-PSTG-IND.        43008745
430088     MOVE TRNCDE-BTCH-SRC-CDE        TO PV-BTCH-NBR-SRC-CDE.      43008845
430089     MOVE PV-BTCH-NBR                TO AP045-PS-BTCH-NBR.        43008945
430090     MOVE TRNCDE-GL-ACCT-NBR         TO AP045-GL-ACCT-NBR.        43009045
430091                                                                  43009145
430092     MULTIPLY ID-SEPHORA-REPAY-DISC-PCT BY                        43009245
430093              ID-TOTAL-REPAY-SHTG-AMT                             43009345
430094                               GIVING   AP045-GRO-COST-AMT.       43009445
430095     MOVE ZEROES                     TO AP045-RETL-AMT.           43009545
430096                                                                  43009645
430097     MOVE ZERO                       TO AP045-FRGT-AMT            43009745
430098                                        AP045-MISC-CHRG-AMT.      43009845
430099                                                                  43009945
430102     MOVE ID-SEPHORA-REPAY-DISC-PCT  TO AP045-TERM-DISC-PCT       43010250
430103     MOVE ZERO                       TO AP045-NW-STR-DISC-PCT     43010345
430104                                        AP045-TRD-DISC-PCT        43010445
430105                                        AP045-DTL-TERM-DISC-AMT   43010545
430106                                        AP045-DTL-NW-STR-DISC-AMT 43010645
430107                                        AP045-DTL-TRD-DISC-AMT    43010745
430108                                        AP045-MOS-DISC-PCT        43010845
430109                                        AP045-DTL-MOS-DISC-AMT    43010945
430110                                        AP045-SKU-NBR.            43011045
430111                                                                  43011145
430112                                                                  43011245
430113     MOVE PV-CURR-DB2-DATE           TO AP045-INV-CUTOFF-DTE.     43011345
430114                                                                  43011445
430115     IF AP045-GRO-COST-AMT > ZERO                                 43011545
430116         PERFORM L200-FILL-AJ-FIELDS                              43011645
430117     END-IF.                                                      43011745
430118                                                                  43011845
430119 EJECT                                                            43011945
430120*----------------------------------------------------------------*43012045
430121*    THE RECONCILIATION RESULTS RECORD IS BUILT WITH RECEIVER    *43012145
430122*    DATA.                                                       *43012245
430130*    CALLED FROM D500-BUILD-RECS                                 *43013000
430200*----------------------------------------------------------------*43020000
430300 M100-BUILD-RCVR-RR.                                              43030000
430400                                                                  43040000
430500                                                                  43050000
430600     MOVE PURCHS-DEPT-NBR           TO AP263-DEPT-NBR.            43060000
430700     MOVE PV-PO-IN-PROCESS-9        TO AP263-PO-NBR.              43070000
430800     MOVE PV-STORE-IN-PROCESS       TO AP263-STR-NBR.             43080000
430900     MOVE PV-MTCH-LVL-CDE-IN-PROCESS                              43090000
431000                                   TO AP263-MTCH-LVL-CDE.         43100000
431100     SET RECEIVER-RECORD            TO TRUE.                      43110000
431200     MOVE RD-REC-SEQ-NBR            TO AP263-RECVR-SEQ-NBR.       43120000
431300     MOVE RD-RECEIPT-TYPE           TO AP263-RECVR-TYPE.          43130000
431400                                                                  43140000
431500     MOVE RD-TOTAL-QTY              TO AP263-RECVR-QTY.           43150000
431600     COMPUTE AP263-RECVR-AMT = RD-TOTAL-COST + .005.              43160000
431700     MOVE RD-STR-NBR                TO AP263-RECVR-STR-NBR.       43170000
431800                                                                  43180000
431900     PERFORM U200-INSERT-RECON-RESULTS.                           43190000
432000     MOVE SPACES TO AP263-RECORD.                                 43200000
432100 EJECT                                                            43210000
432200*----------------------------------------------------------------*43220000
432300*    THE RECONCILIATION RESULTS RECORD IS BUILT WITH PRICE       *43230000
432400*    CLAIM DATA.                                                 *43240000
432500*    CALLED FROM D700-BUILD-PRCCLM-TRANS                         *43250000
432600*----------------------------------------------------------------*43260000
432700 M200-BUILD-PRCCLM-RR.                                            43270000
432800                                                                  43280000
432900                                                                  43290000
433000     MOVE PURCHS-DEPT-NBR            TO AP263-DEPT-NBR.           43300000
433100     MOVE PV-PO-IN-PROCESS-9         TO AP263-PO-NBR.             43310000
433200     MOVE PV-STORE-IN-PROCESS        TO AP263-STR-NBR.            43320000
433300     MOVE PV-MTCH-LVL-CDE-IN-PROCESS TO AP263-MTCH-LVL-CDE.       43330000
433400                                                                  43340000
433500     EVALUATE TRUE                                                43350000
433600                                                                  43360000
433700         WHEN PRCCLM-DOC-TYP-CDE = PC-CREDIT-AJ                   43370000
433800             SET RECEIVER-ADJ-RECORD TO TRUE                      43380000
433900             SET CREDIT-ADJ          TO TRUE                      43390000
434000             MOVE 37                 TO AP263-TRAN-CODE           43400000
434100                                                                  43410000
434200         WHEN PRCCLM-DOC-TYP-CDE = PC-DEBIT-AJ                    43420000
434300             SET RECEIVER-ADJ-RECORD TO TRUE                      43430000
434400             SET DEBIT-ADJ           TO TRUE                      43440000
434500             MOVE 36                 TO AP263-TRAN-CODE           43450000
434600                                                                  43460000
434700     END-EVALUATE.                                                43470000
434800                                                                  43480000
434900     MOVE SPACES                     TO AP263-DOC-NBR.            43490000
435000                                                                  43500000
435100     MOVE PRCCLM-INVC-ID            TO AP263-RELATED-INV-NBR.     43510000
435200     MOVE PRCCLM-PO-LNE-NBR         TO PV-PO-LINE-NO.             43520000
435300     MOVE PV-PO-LINE-X              TO AP263-PO-LINE-NBR.         43530000
435400     MOVE PRCCLM-UNT-QTY            TO AP263-UNIT-QTY.            43540000
435500     MOVE PRCCLM-UNT-COST-AMT       TO AP263-UNIT-COST.           43550000
435600     MOVE PRCCLM-ADJ-COST-AMT       TO AP263-REC-COST.            43560000
435700     COMPUTE AP263-EXTD-COST ROUNDED                              43570000
435800         = PRCCLM-UNT-QTY * PV-PRCCLM-DIFFERENCE.                 43580000
435900                                                                  43590000
436000     PERFORM U200-INSERT-RECON-RESULTS.                           43600000
436100     MOVE SPACES TO AP263-RECORD.                                 43610000
436200 EJECT                                                            43620000
436300*----------------------------------------------------------------*43630000
436400*    THE RECONCILIATION RESULTS RECORD IS BUILT WITH TODAY'S     *43640000
436500*    NON-INVOICED RECEIPT DATA.                                  *43650000
436600*    CALLED FROM B200-PROCESS-POS                                *43660000
436700*----------------------------------------------------------------*43670000
436800 M300-BUILD-TODAYS-NR-RR.                                         43680000
436900                                                                  43690000
437000                                                                  43700000
437100     MOVE PURCHS-DEPT-NBR           TO AP263-DEPT-NBR.            43710000
437200     MOVE PV-PO-IN-PROCESS-9        TO AP263-PO-NBR.              43720000
437300     MOVE PV-STORE-IN-PROCESS       TO AP263-STR-NBR.             43730000
437400     MOVE PV-MTCH-LVL-CDE-IN-PROCESS TO AP263-MTCH-LVL-CDE.       43740000
437500                                                                  43750000
437600     SET RECEIVER-ADJ-RECORD        TO TRUE.                      43760000
437700     SET DEBIT-ADJ                  TO TRUE.                      43770000
437800     MOVE 76                        TO AP263-TRAN-CODE.           43780000
437900                                                                  43790000
438000     MOVE SPACES                    TO AP263-DOC-NBR.             43800000
438100                                                                  43810000
438200     MOVE SPACES                    TO AP263-RELATED-INV-NBR.     43820000
438300     MOVE NINREC-PO-LNE-NBR         TO PV-PO-LINE-NO.             43830000
438400     MOVE PV-PO-LINE-X              TO AP263-PO-LINE-NBR.         43840000
438500     MOVE NINREC-NON-INVC-UNT-QTY   TO AP263-UNIT-QTY.            43850000
438600     MOVE NINREC-UNT-COST-AMT       TO AP263-UNIT-COST.           43860000
438700     MOVE ZERO                      TO AP263-REC-COST.            43870000
438800                                                                  43880000
438900     COMPUTE AP263-EXTD-COST ROUNDED = PV-TOTAL-NR-COST.          43890000
439000                                                                  43900000
439100                                                                  43910000
439200     PERFORM U200-INSERT-RECON-RESULTS.                           43920000
439300     MOVE SPACES TO AP263-RECORD.                                 43930000
439400 EJECT                                                            43940000
439500*----------------------------------------------------------------*43950000
439600*    RETRIEVES THE PO NUMBERS TO BE PROCESSED.                   *43960000
439700*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE RESULTS       *43970000
439800*           IN THE OUT OF POS SWITCH BEING SET.                  *43980000
439900*    CALLED FROM B100-INITIALIZE                                 *43990000
440000*                B200-PROCESS-POS                                *44000000
440100*----------------------------------------------------------------*44010000
440200 R100-FETCH-PO-DATA.                                              44020000
440300                                                                  44030000
440400     EXEC SQL                                                     44040000
440500         FETCH PO_CSR                                             44050000
440600         INTO                                                     44060000
440700              :POSTRR-PO-NBR                                      44070000
440800             ,:POSTRR-STR-NBR                                     44080000
440900             ,:POSTRR-PAYT-RLSE-TMST                              44090000
441000             ,:POSTRR-CRE-PRC-CDE                                 44100000
441100             ,:POSTRR-TOLR-ADJ-CDE                                44110000
441200             ,:POSTRR-TOLR-ADJ-AMT                                44120000
441300             ,:POSTRR-WEIGHTED-DISC-PCT                           44130000
441400             ,:POSTRR-TOTAL-DISC-AMT                              44140000
441500             ,:POSTRR-MTCH-LVL-CDE                                44150000
441600     END-EXEC.                                                    44160000
441700                                                                  44170000
441800     EVALUATE TRUE                                                44180000
441900         WHEN SQLCODE = ZERO                                      44190000
442000              ADD 1 TO PV-PO-COUNT                                44200000
442100         WHEN SQLCODE = +100                                      44210000
442200              SET OUT-OF-POS TO TRUE                              44220000
442300         WHEN OTHER                                               44230000
442400             MOVE 'R100-FETCH-PO-DATA'     TO AA-PARAGRAPH-NAME   44240000
442500             MOVE 'FETCH FAILED ON PO_CSR' TO AA-DB2-OPERATION    44250000
442600             MOVE 'TPOSTRR'                TO AA-DB2-TABLE-1      44260000
442700             PERFORM Z998-DB2-ABEND                               44270000
442800     END-EVALUATE.                                                44280000
442900                                                                  44290000
443000*----------------------------------------------------------------*44300000
443100*    RETRIEVES THE DEPARTMENT.                                   *44310000
443200*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE WILL RESULT   *44320000
443300*           IN DEFAULT VALUES BEING PLACED IN THE REQUESTED      *44330000
443400*           FIELDS.                                              *44340000
443500*    CALLED FROM B200-PROCESS-POS                                *44350000
443600*----------------------------------------------------------------*44360000
443700 R200-GET-DEPT.                                                   44370000
443800                                                                  44380000
443900     EXEC SQL                                                     44390000
444000         SELECT PU.DEPT_NBR                                       44400000
444100               ,PU.PO_TYP_CDE                                     44410000
444200               ,PU.OTB_PER_NBR                                    44420000
444300               ,PU.DERVD_LBL_TYP_CDE                              44430000
444400           INTO :PURCHS-DEPT-NBR                                  44440000
444500               ,:PURCHS-PO-TYP-CDE                                44450000
444600               ,:PURCHS-OTB-PER-NBR                               44460000
444700               ,:PURCHS-DERVD-LBL-TYP-CDE                         44470000
444800           FROM TPURCHS PU                                        44480000
444900          WHERE PU.PO_NBR         = :PV-PO-IN-PROCESS             44490000
445000            AND PU.VER_STATUS_CDE = 'A'                           44500000
445100     END-EXEC.                                                    44510000
445200                                                                  44520000
445300     EVALUATE TRUE                                                44530000
445400         WHEN SQLCODE = ZERO                                      44540000
445500            IF  PURCHS-PO-TYP-CDE = ('IM' OR 'IE' OR 'IF' OR 'CD')44550000
445600                CONTINUE                                          44560000
445700            ELSE                                                  44570000
445800                IF  PURCHS-OTB-PER-NBR > '200801'                 44580000
445900                AND (PURCHS-DERVD-LBL-TYP-CDE = 'P'               44590057
445910                    OR PURCHS-DERVD-LBL-TYP-CDE = 'E')            44591057
446000                AND PURCHS-DEPT-NBR NOT = '836'                   44600012
446010                AND PURCHS-DEPT-NBR NOT = '830'                   44601012
446100                    SET APPLY-PRVT-LBL-LOAD TO TRUE               44610000
446200                END-IF                                            44620000
446300            END-IF                                                44630000
446400         WHEN OTHER                                               44640000
446500             MOVE 'R200-GET-DEPT       ' TO AA-PARAGRAPH-NAME     44650000
446600             MOVE 'UNSUCCESSFUL SELECT'  TO AA-DB2-OPERATION      44660000
446700             MOVE 'TPURCHS'              TO AA-DB2-TABLE-1        44670000
446800             PERFORM Z998-DB2-ABEND                               44680000
446900     END-EVALUATE.                                                44690000
447000 EJECT                                                            44700000
447100*----------------------------------------------------------------*44710000
447200*    RETRIEVES THE VENDOR NAME AND DUNS NUMBER.                  *44720000
447300*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE WILL RESULT   *44730000
447400*           IN DEFAULT VALUES BEING PLACED IN THE REQUESTED      *44740000
447500*           FIELDS.                                              *44750000
447600*    CALLED FROM B200-PROCESS-POS                                *44760000
447700*----------------------------------------------------------------*44770000
447800 R250-GET-VENDOR.                                                 44780000
447900                                                                  44790000
448000     EXEC SQL                                                     44800000
448100         SELECT EN.ENT_NAME_DESC                                  44810000
448200              , EE.DUN_NBR                                        44820000
448300              , PU.ENT_ID                                         44830000
448400           INTO :ENTNME-ENT-NAME-DESC                             44840000
448500              , :EXTENT-DUN-NBR                                   44850000
448600              , :PURCHS-ENT-ID                                    44860000
448700           FROM TENTNME EN                                        44870000
448800              , TEXTENT EE                                        44880000
448900              , TPURCHS PU                                        44890000
449000          WHERE PU.PO_NBR         = :PV-PO-IN-PROCESS             44900000
449100            AND PU.VER_STATUS_CDE = 'A'                           44910000
449200            AND PU.ENT_ID         = EE.ENT_ID                     44920000
449300            AND PU.ENT_ID         = EN.ENT_ID                     44930000
449400            AND EN.TYPE_CDE       = '01'                          44940000
449500     END-EXEC.                                                    44950000
449600                                                                  44960000
449700     EVALUATE TRUE                                                44970000
449800         WHEN SQLCODE = ZERO                                      44980000
449900             CONTINUE                                             44990000
450000         WHEN SQLCODE = +100                                      45000000
450100             MOVE 'NO VENDOR FOUND' TO ENTNME-ENT-NAME-DESC       45010000
450200             MOVE '999999999'       TO EXTENT-DUN-NBR             45020000
450300         WHEN OTHER                                               45030000
450400             MOVE 'R250-GET-VENDOR     '  TO AA-PARAGRAPH-NAME    45040000
450500             MOVE 'UNSUCCESSFUL SELECT'   TO AA-DB2-OPERATION     45050000
450600             MOVE 'TENTNME'               TO AA-DB2-TABLE-1       45060000
450700             MOVE 'TEXTENT'               TO AA-DB2-TABLE-2       45070000
450800             MOVE 'TPURCHS'               TO AA-DB2-TABLE-3       45080000
450900             PERFORM Z998-DB2-ABEND                               45090000
451000     END-EVALUATE.                                                45100000
451100 EJECT                                                            45110000
451230*----------------------------------------------------------------*45123000
451300*    READS THE RELEASED INVOICES FILE FOR THE PURCHASE ORDER/    *45130000
451400*    STORE BEING PROCESSED.                                      *45140000
451500*    NOTE:  A PO/STORE NOT FOUND IN THIS INSTANCE RESULTS        *45150000
451600*           IN THE OUT OF INVOICES SWITCH BEING SET.             *45160000
451700*    CALLED FROM B200-PROCESS-POS                                *45170000
451800*                D100-PROCESS-EACH-INVOICE                       *45180000
451900*----------------------------------------------------------------*45190000
452000 R300-READ-INVOICES.                                              45200000
452100                                                                  45210000
452200     READ POSTORE-INVOICE-FILE INTO AP058-RECORD                  45220000
452300        AT END SET OUT-OF-INVOICES TO TRUE                        45230000
452400               SET OUT-OF-TODAYS-RI TO TRUE.                      45240000
452500                                                                  45250000
452600*----------------------------------------------------------------*45260000
452700*    READS THE PO/STORES PO LINES FILE FOR THE PURCHASE ORDER/   *45270000
452800*    STORE BEING PROCESSED.                                      *45280000
452900*    CALLED FROM B200-PROCESS-POS                                *45290000
453000*----------------------------------------------------------------*45300000
453100 R400-READ-PO-LINES.                                              45310000
453200                                                                  45320000
453300     READ PO-LINES-FILE INTO AP100-RECORD                         45330000
453400        AT END SET PO-LINES-EOF TO TRUE.                          45340000
453500                                                                  45350000
453600*----------------------------------------------------------------*45360000
453700*    READS THE PO/STORES RECEIPTS SUM FILE FOR THE PURCHASE      *45370000
453800*    ORDER/STORE BEING PROCESSED.                                *45380000
453900*    CALLED FROM B200-PROCESS-POS                                *45390000
454000*----------------------------------------------------------------*45400000
454100 R500-READ-RECEIPTS-SUM.                                          45410000
454200                                                                  45420000
454300     READ RECEIPTS-SUM-FILE INTO AP101-RECORD                     45430000
454400        AT END SET OUT-OF-RECEIPTS-SUM TO TRUE.                   45440000
454500                                                                  45450000
454600*----------------------------------------------------------------*45460000
454700*    READS THE PO/STORES RECEIPTS FILE FOR THE PURCHASE ORDER/   *45470000
454800*    STORE BEING PROCESSED.                                      *45480000
454900*    CALLED FROM B200-PROCESS-POS                                *45490000
455000*----------------------------------------------------------------*45500000
455100 R600-READ-RECEIPTS.                                              45510000
455200                                                                  45520000
455300     READ RECEIPTS-FILE INTO AP105-RECORD                         45530000
455400        AT END SET RECEIPTS-EOF TO TRUE.                          45540000
455500                                                                  45550000
455600 EJECT                                                            45560000
455700*----------------------------------------------------------------*45570000
455800*    RETRIEVES PRICE CLAIM ADJUSTMENTS DATA FOR PO/STORE.        *45580000
455900*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE RESULTS       *45590000
456000*           IN THE OUT OF PRICE CLAIMS SWITCH BEING SET.         *45600000
456100*    CALLED FROM B200-PROCESS-POS                                *45610000
456200*                C200-PROCESS-PRCCLMS                            *45620000
456300*----------------------------------------------------------------*45630000
456400 R700-FETCH-PRCCLMS.                                              45640000
456500                                                                  45650000
456600     EXEC SQL                                                     45660000
456700         FETCH PRCCLM_CSR                                         45670000
456800          INTO :PRCCLM-INVC-ID                                    45680000
456900             , :PRCCLM-PO-LNE-NBR                                 45690000
457000             , :PRCCLM-DOC-TYP-CDE                                45700000
457100             , :PRCCLM-UNT-QTY                                    45710000
457200             , :PRCCLM-ADJ-COST-AMT                               45720000
457300             , :PRCCLM-UNT-COST-AMT                               45730000
457400             , :PV-PRCCLM-DIFFERENCE                              45740000
457500     END-EXEC.                                                    45750000
457600                                                                  45760000
457700     EVALUATE TRUE                                                45770000
457800         WHEN SQLCODE = ZERO                                      45780000
457900              CONTINUE                                            45790000
458000         WHEN SQLCODE = +100                                      45800000
458100            SET OUT-OF-PRCCLMS TO TRUE                            45810000
458200         WHEN OTHER                                               45820000
458300             MOVE 'R700-FETCH-PRCCLMS'        TO AA-PARAGRAPH-NAME45830000
458400             MOVE 'FETCH FAILED ON PRCCLM_CSR' TO AA-DB2-OPERATION45840000
458500             MOVE 'TPRCCLM'                    TO AA-DB2-TABLE-1  45850000
458600             PERFORM Z998-DB2-ABEND                               45860000
458700     END-EVALUATE.                                                45870000
458800 EJECT                                                            45880000
458900*----------------------------------------------------------------*45890000
459000*    RETRIEVES THE ADJUSTMENT STORE NUMBER FROM THE AP CONTROL   *45900000
459100*    TABLE FOR USE ON ADJUSTMENT JOURNAL NON-INVOICED RECEIPT    *45910000
459200*    ENTRIES.                                                    *45920000
459300*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE WILL RESULT   *45930000
459400*           IN A SUBSTITUTE DEFAULT STORE NUMBER BEING USED.     *45940000
459500*    CALLED FROM B100-INITIALIZE.                                *45950000
459600*----------------------------------------------------------------*45960000
459700 R800-GET-AP-CNTL-DATA.                                           45970000
459800                                                                  45980000
459900     EXEC SQL                                                     45990000
460000         SELECT ADJ_STR_NBR                                       46000000
460100              , BTCH_PRC_DTE                                      46010000
460200              , CURR_PSTG_FYR_NBR                                 46020000
460300              , CURR_PSTG_FMN_NBR                                 46030000
460400              , CURR_PSTG_FWK_NBR                                 46040000
460500              , NEXT_BTCH_PRC_DTE                                 46050000
460600           INTO :APCNTL-ADJ-STR-NBR                               46060000
460700              , :APCNTL-BTCH-PRC-DTE                              46070000
460800              , :APCNTL-CURR-PSTG-FYR-NBR                         46080000
460900              , :APCNTL-CURR-PSTG-FMN-NBR                         46090000
461000              , :APCNTL-CURR-PSTG-FWK-NBR                         46100000
461100              , :APCNTL-NEXT-BTCH-PRC-DTE                         46110000
461200         FROM TAPCNTL                                             46120000
461300     END-EXEC.                                                    46130000
461400                                                                  46140000
461500                                                                  46150000
461600     EVALUATE TRUE                                                46160000
461700         WHEN SQLCODE = ZERO                                      46170000
461800              MOVE APCNTL-ADJ-STR-NBR TO ID-DEFAULT-STORE         46180000
461900         WHEN SQLCODE = +100                                      46190000
462000              MOVE PC-DEFAULT-STORE TO ID-DEFAULT-STORE           46200000
462100         WHEN OTHER                                               46210000
462200             MOVE 'R800-GET-AP-CNTL-DATA' TO AA-PARAGRAPH-NAME    46220000
462300             MOVE 'UNSUCCESSFUL SELECT'   TO AA-DB2-OPERATION     46230000
462400             MOVE 'TAPCNTL'               TO AA-DB2-TABLE-1       46240000
462500             PERFORM Z998-DB2-ABEND                               46250000
462600     END-EVALUATE.                                                46260000
462700 EJECT                                                            46270000
462800*----------------------------------------------------------------*46280000
462900*    FETCHES NON-INVOICED RECEIPTS FOR A PO/STORE THAT WERE      *46290000
463000*    CREATED TODAY.                                              *46300000
463100*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE RESULTS       *46310000
463200*           IN THE OUT OF TODAY'S NINREC SWITCH BEING SET.       *46320000
463300*    CALLED FROM B200-PROCESS-POS                                *46330000
463400*----------------------------------------------------------------*46340000
463500 R900-FETCH-TODAYS-NINREC.                                        46350000
463600                                                                  46360000
463700     EXEC SQL                                                     46370000
463800         FETCH TODAYS_NINREC_CSR                                  46380000
463900          INTO :PURITM-CL-NBR                                     46390000
464000             , :NINREC-NON-INVC-SEQ-NBR                           46400000
464100             , :NINREC-UNT-COST-AMT                               46410000
464200             , :NINREC-PO-LNE-NBR                                 46420000
464300             , :NINREC-NON-INVC-UNT-QTY                           46430000
464400             , :PV-TOTAL-NR-COST                                  46440000
464500             , :NINREC-ORIG-DISC-PCT                              46450000
464600     END-EXEC.                                                    46460000
464700                                                                  46470000
464800     EVALUATE TRUE                                                46480000
464900         WHEN SQLCODE = ZERO                                      46490000
465000              CONTINUE                                            46500000
465100         WHEN SQLCODE = +100                                      46510000
465200            SET OUT-OF-TODAYS-NR TO TRUE                          46520000
465300         WHEN OTHER                                               46530000
465400             MOVE 'R900-FETCH-TODAYS-NINREC' TO AA-PARAGRAPH-NAME 46540000
465500             MOVE 'FETCH FAILED ON TODAYS_NINREC_CSR'             46550000
465600                                             TO AA-DB2-OPERATION  46560000
465700             MOVE 'TNINREC'                  TO AA-DB2-TABLE-1    46570000
465800             MOVE 'TPURITM'                  TO AA-DB2-TABLE-2    46580000
465900             PERFORM Z998-DB2-ABEND                               46590000
466000     END-EVALUATE.                                                46600000
466100 EJECT                                                            46610000
466200*----------------------------------------------------------------*46620000
466300*    RETRIEVES THE FOLLOWING DATA FROM THE TTRNCDE TABLE:        *46630000
466400*      1) POSTING TYPE CODE                                      *46640000
466500*      2) GL ACCOUNT NUMBER                                      *46650000
466600*      3) TRANSACTION TYPE CODE                                  *46660000
466700*    CALLED FROM MULTIPLE J###- PARAGRAPHS.                      *46670000
466800*----------------------------------------------------------------*46680000
466900 S100-SELECT-TTRNCDE-DATA.                                        46690000
467000                                                                  46700000
467100     EXEC SQL                                                     46710000
467200         SELECT PSTG_TYP_CDE                                      46720000
467300              , TRN_TYP_CDE                                       46730000
467400              , GL_ACCT_NBR                                       46740000
467500              , BTCH_SRC_CDE                                      46750000
467600              , AP_PSTG_IND                                       46760000
467700           INTO :TRNCDE-PSTG-TYP-CDE                              46770000
467800              , :TRNCDE-TRN-TYP-CDE                               46780000
467900              , :TRNCDE-GL-ACCT-NBR                               46790000
468000              , :TRNCDE-BTCH-SRC-CDE                              46800000
468100              , :TRNCDE-AP-PSTG-IND                               46810000
468200           FROM TTRNCDE                                           46820000
468300          WHERE AP_TRN_CDE   =  :AP045-AP-TRN-CDE                 46830000
468400            AND EFF_STRT_DTE <= :PV-CURR-DB2-DATE-X               46840000
468500            AND EFF_END_DTE  >  :PV-CURR-DB2-DATE-X               46850000
468600     END-EXEC.                                                    46860000
468700                                                                  46870000
468800     EVALUATE TRUE                                                46880000
468900         WHEN SQLCODE = ZERO                                      46890000
469000             CONTINUE                                             46900000
469100         WHEN OTHER                                               46910000
469200             DISPLAY 'TRAN CODE = ' AP045-AP-TRN-CDE              46920000
469300             DISPLAY 'DOC NBR   = ' AP045-DOC-NBR                 46930000
469400             DISPLAY 'STORE NBR = ' AP045-STR-NBR                 46940000
469500             MOVE 'S100-SELECT-TTRNCDE-DATA' TO AA-PARAGRAPH-NAME 46950000
469600             MOVE 'UNSUCCESSFUL SELECT'      TO AA-DB2-OPERATION  46960000
469700             MOVE 'TTRNCDE'                  TO AA-DB2-TABLE-1    46970000
469800             PERFORM Z998-DB2-ABEND                               46980000
469900     END-EVALUATE.                                                46990000
470000 EJECT                                                            47000000
470100*---------------------------------------------------------------* 47010000
470200*  GET NEXT DOCUMENT NUMBER FROM TAPCNTL TABLE                  * 47020000
470300*---------------------------------------------------------------* 47030000
470400 S200-GET-NEXT-DOC-NBR.                                           47040000
470500                                                                  47050000
470600     CALL DP951-AJ-NEXT-DOC-NBR-ROUTINE                           47060073
470610                     USING WS151-DOC-NBR-PARAMETERS.              47061072
470700                                                                  47070000
470800     IF WS151-ERRORS-FOUND                                        47080000
470900        SET AC-BAD-DATA TO TRUE                                   47090000
471000        MOVE 'S200-GET-NEXT-DOC-NBR     ' TO AA-PARAGRAPH-NAME    47100000
471100        MOVE WS151-ERROR-MESSAGE          TO AA-MESSAGE-1         47110000
471200        MOVE WS151-SQLCODE                TO AA-MESSAGE-2         47120000
471300        PERFORM Z998-DB2-ABEND                                    47130000
471400     END-IF.                                                      47140000
471500                                                                  47150000
471600*----------------------------------------------------------------*47160000
471700*    DETERMINES IF A NEW STORE DISCOUNT TRANSACTIONS SHOULD BE   *47170000
471800*    GENERATED BASED ON WHETHER OR NOT A SUCCESSFUL SELECT IS    *47180000
471900*    DONE AGAINST THE NSD CONTROL TABLE AND THE VENDOR AGREEMENT *47190000
472000*    TABLE FOR THE PO/STORE AND DATE CRITERIA.                   *47200000
472100*----------------------------------------------------------------*47210000
472200 S300-CHECK-FOR-EARNED-NSD.                                       47220000
472300                                                                  47230000
472400     EXEC SQL                                                     47240000
472500         SELECT DISCOUNT_PCT                                      47250000
472600           INTO :VNDAGR-DISCOUNT-PCT                              47260000
472700           FROM APTW_NW_STR_DISC N                                47270000
472800              , TVNDAGR V                                         47280000
472900          WHERE N.PO_NBR       = :PV-PO-IN-PROCESS                47290000
473000            AND N.LOC_NBR      = :RD-LOC-NBR                      47300000
473100            AND N.ENT_ID       = V.ENT_ID                         47310000
473200            AND N.DEPT_NBR     = INTEGER(V.DEPT_NBR)              47320000
473300            AND V.AGRMT_TYP_ID = '5'                              47330000
473400            AND V.TYP_CDE      = 1                                47340000
473500            AND V.DISCOUNT_PCT > 0                                47350000
473600            AND N.GRND_OPN_DTE BETWEEN V.EFFECTIVE_DATE           47360000
473700                                   AND V.EXPIRATION_DATE          47370000
473800            AND ((N.GRND_OPN_DTE + 39 DAYS) > N.CNCL_DTE          47380000
473900                 OR (N.GRND_OPN_DTE + 39 DAYS) > :RD-REC-DATE)    47390000
474000     END-EXEC.                                                    47400000
474100                                                                  47410000
474200     EVALUATE TRUE                                                47420000
474300         WHEN SQLCODE = ZERO                                      47430000
474400         WHEN SQLCODE = -811                                      47440000
474500             SET NSD-EARNED TO TRUE                               47450000
474600         WHEN SQLCODE = +100                                      47460000
474700             SET NSD-NOT-EARNED TO TRUE                           47470000
474800         WHEN OTHER                                               47480000
474900             DISPLAY 'PO NUMBER = ' PV-PO-IN-PROCESS-9            47490000
475000             DISPLAY 'STORE NBR = ' RD-STR-NBR                    47500000
475100             MOVE 'S300-CHECK-FOR-EARNED-NSD' TO AA-PARAGRAPH-NAME47510000
475200             MOVE 'UNSUCCESSFUL SELECT'      TO AA-DB2-OPERATION  47520000
475300             MOVE 'APT00000'                 TO AA-DB2-TABLE-1    47530000
475400             MOVE 'TVNDAGR '                 TO AA-DB2-TABLE-2    47540000
475500             PERFORM Z998-DB2-ABEND                               47550000
475600     END-EVALUATE.                                                47560000
475700                                                                  47570000
475800 EJECT                                                            47580000
475900*----------------------------------------------------------------*47590000
476000*    INSERTS AN ADJUSTMENT JOURNAL TRANSACTION RECORD TO THE     *47600000
476100*    ADJUSTMENT JOURNAL TRANSACTION FILE TABLE (TOUTAP1).        *47610000
476200*    CALLED FROM L200-FILL-AJ-FIELDS                             *47620000
476300*----------------------------------------------------------------*47630000
476400 U100-INSERT-ADJ-JRNL-TRAN.                                       47640000
476500                                                                  47650000
476600     MOVE PC-AP045-LEN               TO OUTAP1-AJ-TRAN-ODR-LEN.   47660000
476700     MOVE AP045-TRANSACTION-FILE     TO OUTAP1-AJ-TRAN-ODR-TEXT.  47670000
476800                                                                  47680000
476900     EXEC SQL                                                     47690000
477000         INSERT INTO TOUTAP1                                      47700000
477100                 (AJ_TRAN_ODR)                                    47710000
477200         VALUES  (:OUTAP1-AJ-TRAN-ODR)                            47720000
477300     END-EXEC.                                                    47730000
477400                                                                  47740000
477500     EVALUATE TRUE                                                47750000
477600         WHEN SQLCODE = ZERO                                      47760000
477700              CONTINUE                                            47770000
477800         WHEN OTHER                                               47780000
477900             MOVE 'U100-INSERT-ADJ-JRNL-TRAN' TO AA-PARAGRAPH-NAME47790000
478000             MOVE 'UNSUCCESSFUL INSERT'       TO AA-DB2-OPERATION 47800000
478100             MOVE 'TOUTAP1'                   TO AA-DB2-TABLE-1   47810000
478200             PERFORM Z998-DB2-ABEND                               47820000
478300     END-EVALUATE.                                                47830000
478400                                                                  47840000
478500 EJECT                                                            47850000
478600*----------------------------------------------------------------*47860000
478700*    INSERTS A RECONCILIATION RESULTS RECORD TO THE              *47870000
478800*    RECONCILIATION RESULTS FILE TABLE (TOUTAP2).                *47880000
478900*    CALLED FROM M100-BUILD-RCVR-RR                              *47890000
479000*                M200-BUILD-PRCCLM-RR                            *47900000
479100*                M300-BUILD-TODAYS-NR-RR                         *47910000
479200*----------------------------------------------------------------*47920000
479300 U200-INSERT-RECON-RESULTS.                                       47930000
479400                                                                  47940000
479500     MOVE AP263-RECORD        TO OUTAP2-RECNCL-RSLT-ODR.          47950000
479600                                                                  47960000
479700     EXEC SQL                                                     47970000
479800         INSERT INTO TOUTAP2                                      47980000
479900                 (RECNCL_RSLT_ODR)                                47990000
480000         VALUES  (:OUTAP2-RECNCL-RSLT-ODR)                        48000000
480100     END-EXEC.                                                    48010000
480200                                                                  48020000
480300     EVALUATE TRUE                                                48030000
480400         WHEN SQLCODE = ZERO                                      48040000
480500             CONTINUE                                             48050000
480600         WHEN OTHER                                               48060000
480700             MOVE 'U200-INSERT-RECON-RESULTS' TO AA-PARAGRAPH-NAME48070000
480800             MOVE 'UNSUCCESSFUL INSERT'       TO AA-DB2-OPERATION 48080000
480900             MOVE 'TOUTAP2'                   TO AA-DB2-TABLE-1   48090000
481000             PERFORM Z998-DB2-ABEND                               48100000
481100     END-EVALUATE.                                                48110000
481200                                                                  48120000
481300 EJECT                                                            48130000
481400*----------------------------------------------------------------*48140000
481500*    INSERTS A STATUS UPDATE RECORD TO THE RECEIVING UPDATE FILE *48150000
481600*    TABLE (TOUTAP3).                                            *48160000
481700*    CALLED FROM D500-BUILD-RECS                                 *48170000
481800*                C500-UPDT-RECEIPTS                              *48180000
481900*----------------------------------------------------------------*48190000
482000 U300-INSERT-RECEIV-UPDATE.                                       48200000
482100                                                                  48210000
482200     MOVE AP254-RECORD                TO OUTAP3-RCVR-UPD-ODR.     48220000
482300                                                                  48230000
482400     EXEC SQL                                                     48240000
482500         INSERT INTO TOUTAP3                                      48250000
482600                 (RCVR_UPD_ODR)                                   48260000
482700         VALUES  (:OUTAP3-RCVR-UPD-ODR)                           48270000
482800     END-EXEC.                                                    48280000
482900                                                                  48290000
483000     EVALUATE TRUE                                                48300000
483100         WHEN SQLCODE = ZERO                                      48310000
483200             CONTINUE                                             48320000
483300         WHEN OTHER                                               48330000
483400             MOVE 'U300-INSERT-RECEIV-UPDATE' TO AA-PARAGRAPH-NAME48340000
483500             MOVE 'UNSUCCESSFUL INSERT'       TO AA-DB2-OPERATION 48350000
483600             MOVE 'TOUTAP3'                   TO AA-DB2-TABLE-1   48360000
483700             PERFORM Z998-DB2-ABEND                               48370000
483800     END-EVALUATE.                                                48380000
483900                                                                  48390000
484000 EJECT                                                            48400000
484100*----------------------------------------------------------------*48410000
484200*    INSERTS THE ERROR REPORT DETAIL LINE TO THE CLASS           *48420000
484300*    DISTRIBUTION ERROR TABLE (TOUTAP4).                         *48430000
484400*    CALLED FROM B300-END-PROGRAM                                *48440000
484500*                C400-COMPARE-TOTALS                             *48450000
484600*                D400-PREPARE-PRCCLM-ERROR                       *48460000
484700*----------------------------------------------------------------*48470000
484800 U400-INSERT-ERROR.                                               48480000
484900                                                                  48490000
485000     MOVE D1-DETAIL1                  TO OUTAP4-CL-DISTRB-ERR-ODR 48500000
485100     INITIALIZE D1-DETAIL1.                                       48510000
485200     ADD +1 TO PV-ERROR-COUNT.                                    48520000
485300                                                                  48530000
485400     EXEC SQL                                                     48540000
485500         INSERT INTO TOUTAP4                                      48550000
485600                 (CL_DISTRB_ERR_ODR)                              48560000
485700         VALUES  (:OUTAP4-CL-DISTRB-ERR-ODR)                      48570000
485800     END-EXEC.                                                    48580000
485900                                                                  48590000
486000     EVALUATE TRUE                                                48600000
486100         WHEN SQLCODE = ZERO                                      48610000
486200             CONTINUE                                             48620000
486300         WHEN OTHER                                               48630000
486400             MOVE 'U400-INSERT-ERROR'   TO AA-PARAGRAPH-NAME      48640000
486500             MOVE 'UNSUCCESSFUL INSERT' TO AA-DB2-OPERATION       48650000
486600             MOVE 'TOUTAP4'             TO AA-DB2-TABLE-1         48660000
486700             PERFORM Z998-DB2-ABEND                               48670000
486800     END-EVALUATE.                                                48680000
486900                                                                  48690000
487000 EJECT                                                            48700000
487100*----------------------------------------------------------------*48710000
487200*    UPDATES THE RELEASED PO STORES TABLE.  THE STATUS CODE      *48720000
487300*    IS SET TO 'P' (PROCESSED).                                  *48730000
487400*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE SHOULD NEVER  *48740000
487500*           OCCUR SINCE THE PO INFORMATION WAS ORIGINALLY        *48750000
487600*           RETRIEVED FROM THIS TABLE.  IF A NOT FOUND           *48760000
487700*           CONDITION DOES OCCUR, IT SIGNALS A PROBLEM AND THE   *48770000
487800*           PROGRAM WILL ABEND.                                  *48780000
487900*    CALLED FROM B200-PROCESS-POS                                *48790000
488000*----------------------------------------------------------------*48800000
488100 U500-UPDATE-POSTRR.                                              48810000
488200                                                                  48820000
488300     EXEC SQL                                                     48830000
488400         UPDATE TPOSTRR                                           48840000
488500         SET STATUS_CDE = 'P'                                     48850000
488600         WHERE PO_NBR         = :PV-PO-IN-PROCESS                 48860000
488700           AND STR_NBR        = :PV-STORE-IN-PROCESS              48870000
488800           AND STATUS_CDE     = ' '                               48880000
488900     END-EXEC.                                                    48890000
489000                                                                  48900000
489100     EVALUATE TRUE                                                48910000
489200         WHEN SQLCODE = ZERO                                      48920000
489300              CONTINUE                                            48930000
489400         WHEN OTHER                                               48940000
489500             MOVE 'U500-UPDATE-POSTRR'  TO AA-PARAGRAPH-NAME      48950000
489600             MOVE 'UNSUCCESSFUL UPDATE' TO AA-DB2-OPERATION       48960000
489700             MOVE 'TPOSTRR'             TO AA-DB2-TABLE-1         48970000
489800             PERFORM Z998-DB2-ABEND                               48980000
489900     END-EVALUATE.                                                48990000
490000 EJECT                                                            49000000
490100*----------------------------------------------------------------*49010000
490200*    OPENS THE PURCHASE ORDER CURSOR.                            *49020000
490300*    CALLED FROM B100-INITIALIZE                                 *49030000
490400*----------------------------------------------------------------*49040000
490500 Y100-OPEN-PO-CSR.                                                49050000
490600                                                                  49060000
490700     EXEC SQL                                                     49070000
490800         OPEN PO_CSR                                              49080000
490900     END-EXEC.                                                    49090000
491000                                                                  49100000
491100     EVALUATE TRUE                                                49110000
491200         WHEN SQLCODE = ZERO                                      49120000
491300              CONTINUE                                            49130000
491400         WHEN OTHER                                               49140000
491500             MOVE 'Y100-OPEN-PO-CSR'      TO AA-PARAGRAPH-NAME    49150000
491600             MOVE 'OPEN FAILED ON PO_CSR' TO AA-DB2-OPERATION     49160000
491700             MOVE 'TPOSTRR'               TO AA-DB2-TABLE-1       49170000
491800             PERFORM Z998-DB2-ABEND                               49180000
491900     END-EVALUATE.                                                49190000
492000                                                                  49200000
492100*----------------------------------------------------------------*49210000
492200*    CLOSES THE PURCHASE ORDER CURSOR.                           *49220000
492300*    CALLED FROM B300-END-PROGRAM                                *49230000
492400*----------------------------------------------------------------*49240000
492500 Y110-CLOSE-PO-CSR.                                               49250000
492600                                                                  49260000
492700     EXEC SQL                                                     49270000
492800         CLOSE PO_CSR                                             49280000
492900     END-EXEC.                                                    49290000
493000                                                                  49300000
493100     EVALUATE TRUE                                                49310000
493200         WHEN SQLCODE = ZERO                                      49320000
493300              CONTINUE                                            49330000
493400         WHEN OTHER                                               49340000
493500             MOVE 'Y110-CLOSE-PO-CSR'      TO AA-PARAGRAPH-NAME   49350000
493600             MOVE 'CLOSE FAILED ON PO_CSR' TO AA-DB2-OPERATION    49360000
493700             MOVE 'TPOSTRR'                TO AA-DB2-TABLE-1      49370000
493800             PERFORM Z998-DB2-ABEND                               49380000
493900     END-EVALUATE.                                                49390000
494000 EJECT                                                            49400000
494100*----------------------------------------------------------------*49410000
494200*    OPENS THE PRICE CLAIM CURSOR.                               *49420000
494300*    CALLED FROM B200-PROCESS-POS                                *49430000
494400*----------------------------------------------------------------*49440000
494500 Y500-OPEN-PRCCLM-CSR.                                            49450000
494600                                                                  49460000
494700     EXEC SQL                                                     49470000
494800         OPEN PRCCLM_CSR                                          49480000
494900     END-EXEC.                                                    49490000
495000                                                                  49500000
495100     EVALUATE TRUE                                                49510000
495200         WHEN SQLCODE = ZERO                                      49520000
495300              CONTINUE                                            49530000
495400         WHEN OTHER                                               49540000
495500             MOVE 'Y500-OPEN-PRCCLM-CSR'      TO AA-PARAGRAPH-NAME49550000
495600             MOVE 'OPEN FAILED ON PRCCLM_CSR' TO AA-DB2-OPERATION 49560000
495700             MOVE 'TPRCCLM'                   TO AA-DB2-TABLE-1   49570000
495800             PERFORM Z998-DB2-ABEND                               49580000
495900     END-EVALUATE.                                                49590000
496000                                                                  49600000
496100*----------------------------------------------------------------*49610000
496200*    CLOSES THE PRICE CLAIM CURSOR.                              *49620000
496300*    CALLED FROM B200-PROCESS-POS                                *49630000
496400*----------------------------------------------------------------*49640000
496500 Y510-CLOSE-PRCCLM-CSR.                                           49650000
496600                                                                  49660000
496700     EXEC SQL                                                     49670000
496800         CLOSE PRCCLM_CSR                                         49680000
496900     END-EXEC.                                                    49690000
497000                                                                  49700000
497100     EVALUATE TRUE                                                49710000
497200         WHEN SQLCODE = ZERO                                      49720000
497300              CONTINUE                                            49730000
497400         WHEN OTHER                                               49740000
497500             MOVE 'Y510-CLOSE-PRCCLM-CSR'     TO AA-PARAGRAPH-NAME49750000
497600             MOVE 'CLOSE FAILED - PRCCLM_CSR' TO AA-DB2-OPERATION 49760000
497700             MOVE 'TPRCCLM'                   TO AA-DB2-TABLE-1   49770000
497800             PERFORM Z998-DB2-ABEND                               49780000
497900     END-EVALUATE.                                                49790000
498000 EJECT                                                            49800000
498100*----------------------------------------------------------------*49810000
498200*    OPENS THE TODAY'S NON-INVOICED RECEIPT CURSOR.              *49820000
498300*    CALLED FROM B200-PROCESS-POS                                *49830000
498400*----------------------------------------------------------------*49840000
498500 Y700-OPEN-TODAYS-NR-CSR.                                         49850000
498600                                                                  49860000
498700     EXEC SQL                                                     49870000
498800         OPEN TODAYS_NINREC_CSR                                   49880000
498900     END-EXEC.                                                    49890000
499000                                                                  49900000
499100     EVALUATE TRUE                                                49910000
499200         WHEN SQLCODE = ZERO                                      49920000
499300              CONTINUE                                            49930000
499400         WHEN OTHER                                               49940000
499500             MOVE 'Y700-OPEN-TODAYS-NR-CSR' TO AA-PARAGRAPH-NAME  49950000
499600             MOVE 'OPEN FAILED '            TO AA-DB2-OPERATION   49960000
499700             MOVE 'TNINREC'                 TO AA-DB2-TABLE-1     49970000
499800             MOVE 'TPURITM'                 TO AA-DB2-TABLE-2     49980000
499900             PERFORM Z998-DB2-ABEND                               49990000
500000     END-EVALUATE.                                                50000000
500100                                                                  50010000
500200*----------------------------------------------------------------*50020000
500300*    CLOSES THE TODAY'S NON-INVOICED RECEIPT CURSOR.             *50030000
500400*    CALLED FROM B200-PROCESS-POS                                *50040000
500500*----------------------------------------------------------------*50050000
500600 Y710-CLOSE-TODAYS-NR-CSR.                                        50060000
500700                                                                  50070000
500800     EXEC SQL                                                     50080000
500900         CLOSE TODAYS_NINREC_CSR                                  50090000
501000     END-EXEC.                                                    50100000
501100                                                                  50110000
501200     EVALUATE TRUE                                                50120000
501300         WHEN SQLCODE = ZERO                                      50130000
501400              CONTINUE                                            50140000
501500         WHEN OTHER                                               50150000
501600             MOVE 'Y710-CLOSE-TODAYS-NR-CSR' TO AA-PARAGRAPH-NAME 50160000
501700             MOVE 'CLOSE FAILED'             TO AA-DB2-OPERATION  50170000
501800             MOVE 'TNINREC'                  TO AA-DB2-TABLE-1    50180000
501900             MOVE 'TPURITM'                  TO AA-DB2-TABLE-2    50190000
502000             PERFORM Z998-DB2-ABEND                               50200000
502100     END-EVALUATE.                                                50210000
502200                                                                  50220000
502300 EJECT                                                            50230000
502511                                                                  50251134
502512*----------------------------------------------------------------*50251200
502520*    COMMITS DB2 UPDATES FOR THE PO PROCESSED.                   *50252000
502600*    CALLED FROM B300-END-PROGRAM                                *50260001
502700*                D800-DETERMINE-COMMIT                           *50270001
502800*----------------------------------------------------------------*50280000
502900 Z100-COMMIT.                                                     50290000
503000                                                                  50300000
503100     EXEC SQL                                                     50310000
503200         COMMIT                                                   50320000
503300     END-EXEC.                                                    50330000
503400                                                                  50340000
503500     EVALUATE TRUE                                                50350000
503600         WHEN SQLCODE = ZERO                                      50360000
503700             ADD 1 TO PV-COMMIT-COUNT                             50370001
503800         WHEN OTHER                                               50380000
503900             MOVE 'Z100-COMMIT'          TO AA-PARAGRAPH-NAME     50390000
504000             MOVE 'UNSUCCESSFUL COMMIT'  TO AA-DB2-OPERATION      50400000
504100             PERFORM Z998-DB2-ABEND                               50410000
504200     END-EVALUATE.                                                50420000
504300                                                                  50430000
504400*----------------------------------------------------------------*50440000
504500*    ABEND ROUTINE FOR DB2 ERRORS                                *50450000
504600*    CALLED FROM B200-PROCESS-POS                                *50460000
504700*                C100-GET-DEFAULT-DATA                           *50470000
504800*                R100-FETCH-PO-DATA                              *50480000
504900*                R200-GET-DEPT                                   *50490000
505000*                R250-GET-VENDOR                                 *50500000
505100*                R400-GET-PO-DISC-PCT                            *50510000
505200*                R450-GET-INVOICE-DISC-PCT                       *50520000
505300*                R700-FETCH-PRCCLMS                              *50530000
505400*                R800-GET-AP-CNTL-DATA                           *50540000
505500*                R900-FETCH-TODAYS-NINREC                        *50550000
505600*                U200-UPDATE-NINREC                              *50560000
505700*                U500-UPDATE-POSTRR                              *50570000
505800*                Y100-OPEN-PO-CSR                                *50580000
505900*                Y110-CLOSE-PO-CSR                               *50590000
506000*                Y500-OPEN-PRCCLM-CSR                            *50600000
506100*                Y510-CLOSE-PRCCLM-CSR                           *50610000
506200*                Y700-OPEN-TODAYS-NR-CSR                         *50620000
506300*                Y710-CLOSE-TODAYS-NR-CSR                        *50630000
506400*                Z100-COMMIT                                     *50640000
506500*----------------------------------------------------------------*50650000
506600 Z998-DB2-ABEND.                                                  50660000
506700                                                                  50670000
506800     CLOSE POSTORE-INVOICE-FILE.                                  50680000
506900     DISPLAY AA-ABEND-LIT.                                        50690000
507000     DISPLAY AA-DB2-ERROR-LIT.                                    50700000
507100     DISPLAY AA-PROGRAM-LIT.                                      50710000
507200     DISPLAY AA-PARAGRAPH-LIT.                                    50720000
507300     DISPLAY AA-DB2-OPERATION-LIT.                                50730000
507400     DISPLAY AA-DB2-TABLE-1.                                      50740000
507500     DISPLAY AA-DB2-TABLE-2.                                      50750000
507600     DISPLAY AA-DB2-TABLE-3.                                      50760000
507700     DISPLAY AA-DB2-TABLE-4.                                      50770000
507800     DISPLAY AA-DB2-TABLE-5.                                      50780000
507900     SET AC-DB2-ERROR TO TRUE.                                    50790000
508000                                                                  50800000
508100     COPY DPPD004.                                                50810000
508200                                                                  50820000
508300     CALL 'ILBOABN0' USING ABEND-CODE.                            50830000
508400 EJECT                                                            50840000
508500*----------------------------------------------------------------*50850000
508600*    ABEND ROUTINE                                               *50860000
508700*    CALLED FROM B100-INITIALIZE                                 *50870000
508800*                C300-PROCESS-RECEIPTS                           *50880000
508900*                E100-FORMAT-RLSE-DATE                           *50890000
509000*                J200-BUILD-RCVR-AJ                              *50900000
509100*                J100-BUILD-PRCCLM-AJ                            *50910000
509200*                J400-BUILD-TOLR-ADJ-AJ                          *50920000
509300*                J500-BUILD-FREIGHT-AJ                           *50930000
509400*                J600-BUILD-DNP-AJ                               *50940000
509500*                J700-BUILD-TODAYS-NR-AJ                         *50950000
509600*                M200-BUILD-PRCCLM-RR                            *50960000
509700*                M100-BUILD-RCVR-RR                              *50970000
509800*                M300-BUILD-TODAYS-NR-RR                         *50980000
509900*----------------------------------------------------------------*50990000
510000 Z999-ABEND.                                                      51000000
510100                                                                  51010000
510200     CLOSE POSTORE-INVOICE-FILE.                                  51020000
510300     DISPLAY AA-ABEND-LIT.                                        51030000
510400     DISPLAY AA-PROGRAM-LIT.                                      51040000
510500     DISPLAY AA-PARAGRAPH-LIT.                                    51050000
510600     DISPLAY AA-MESSAGE-LINE.                                     51060000
510800*---------------------------------------------------------------- 51080042
510900*  PROCEDURE DIVISION COPYBOOK FOR SEPHORA @ KOHLS                51090042
511000*---------------------------------------------------------------- 51100042
511100     COPY APPD021.                                                51110042
