000100 IDENTIFICATION DIVISION.                                         00010003
000200 TITLE 'SUMMARIZE THE TRAILER'.                                   00020003
000300 PROGRAM-ID.    SUKCS574.                                         00030003
000400 AUTHOR.        LARRY SCHLEICHER.                                 00040003
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050003
000600 DATE-WRITTEN.  SEPT, 2001.                                       00060003
000700 DATE-COMPILED.                                                   00070003
000800******************************************************************00080003
000900*  THIS PROGRAM WILL SUMMARIZE ALL OF THE ITEMS FOR A TRAILER AND 00090003
001000*  INSERT THE INFORMATION INTO THE SUMMARY TABLES                 00100003
001100******************************************************************00110003
001200*  07/07/2015 - CHERI PARMLEY                                     00120030
001300*  CHANGES WERE MADE TO INCLUDE THE XLT_BRND AND SUT_BRND_MDSE_SUM00130014
001400*  BRAND GOING FORWARD IS REPLACING THE MDSE PROGRAM ID.          00140020
001500******************************************************************00150014
001600*  10/16/2017 - JIM HUNTER                         CHG0181045   * 00160029
001700*               ALLOW FOR  PV-STARTCODE = 'U' WHEN DETERMINING  * 00170029
001800*               WHERE INPUT IS FROM (REQUIRED FOR WEB SERVICE   * 00180029
001900*               PROGRAM SUKCS808).   (FIND 181045)              * 00190029
002000*---------------------------------------------------------------* 00200029
002100 ENVIRONMENT DIVISION.                                            00210003
002200 CONFIGURATION SECTION.                                           00220003
002300 SOURCE-COMPUTER. IBM-3090.                                       00230003
002400 OBJECT-COMPUTER. IBM-3090.                                       00240003
002500                                                                  00250003
002600 DATA DIVISION.                                                   00260003
002700 WORKING-STORAGE SECTION.                                         00270003
002800                                                                  00280003
002900                                                                  00290003
003000 01  DK-FIELDS.                                                   00300003
003100     05  DK-TRIP-OCRNC-ID                   PIC S9(09)  COMP.     00310003
003200     05  DK-OTBND-TRIP-ID                   PIC S9(09)  COMP.     00320003
003300                                                                  00330003
003400 01  PROGRAM-VARIABLES.                                           00340003
003500     05  PV-AD-EVNT-DTE                     PIC  X(10).           00350003
003600     05  PV-PREV-TRIP-OCRNC-ID              PIC S9(09)  COMP.     00360003
003700     05  PV-HANG-CDE-COUNT                  PIC S9(09)  COMP.     00370003
003800     05  PV-FOLD-CDE-COUNT                  PIC S9(09)  COMP.     00380003
003900     05  PV-NEW-IND-COUNT                   PIC S9(09)  COMP.     00390003
004000     05  PV-RETAIL                          PIC  9(08).           00400003
004100     05  PV-RETAIL-X REDEFINES PV-RETAIL    PIC X(08).            00410003
004200     05  PV-CICS-MSG-AREA                   PIC  X(80).           00420003
004300     05  PV-UNIT-QTY-SUM                    PIC S9(09) COMP.      00430003
004400     05  PV-COMMAREA-LENGTH                 PIC S9(04)  VALUE +0  00440003
004500                                               COMP SYNC.         00450003
004600     05  PV-RETAIL-SUM                      PIC S9(13)V99 COMP-3. 00460003
004700     05  PV-COST-SUM                        PIC S9(13)V99 COMP-3. 00470003
004800     05  PV-SKU-COUNT                       PIC S9(04) COMP.      00480003
004900     05  PV-UNT-QTY                         PIC S9(09) COMP.      00490003
005000     05  PV-RTL-DOL-AMT                     PIC S9(13)V9(2)       00500003
005100                                                     COMP-3.      00510003
005200     05  PV-COST-DOL-AMT                    PIC S9(13)V9(2)       00520003
005300                                                     COMP-3.      00530003
005400     05  PV-UNT-RTL-AMT                     PIC S9(07)V9(2)       00540003
005500                                                     COMP-3.      00550003
005600     05  PV-UNT-COST-AMT                    PIC S9(07)V9(3)       00560003
005700                                                     COMP-3.      00570003
005800     05  PV-CARTON-COUNT                    PIC S9(04) COMP.      00580003
005900     05  PV-RANDOM-NUMBER                   PIC  9(09)            00590003
006000                                                 VALUE ZEROES.    00600003
006100     05  PV-USERID                          PIC  X(08).           00610003
006200     05  PV-STARTCODE                       PIC  X(02).           00620003
006300     05  PV-CURRENT-TIMESTAMP               PIC  X(26).           00630003
006400     05  PV-PARAGRAPH-NAME                  PIC  X(30)            00640003
006500                                                   VALUE SPACES.  00650003
006600     05  PV-DB2-OPERATION-ATTEMPTED         PIC  X(30)            00660003
006700                                                   VALUE SPACES.  00670003
006800     05  PV-ITEM-NMBR                       PIC S9(09)  COMP.     00680003
006900     05  PV-SHIPT-UNT-ID                    PIC  9(18).           00690003
007000     05  PV-SKU-NBR                         PIC  9(08).           00700003
007100     05  PV-FIELD-VALUE                     PIC -9(18).           00710003
007200     05  PV-FIELD-VALUE-1                   PIC -9(09).           00720003
007300     05  PV-FIELD-VALUE-2                   PIC -9(09).           00730003
007400     05  PV-CICS-RESP                       PIC S9(09) COMP       00740003
007500                                                 VALUE ZERO.      00750003
007600     05  PV-DISP-UPC                        PIC  9(15).           00760003
007700     05  PV-DISP-TRIP                       PIC  9(09).           00770003
007800     05  PV-DISP-SQLCODE                    PIC  -9(03).          00780003
007900     05  PV-SAVE-BUS-AREA-ID                PIC  S9(2)V COMP-3.   00790003
008000     05  PV-SAVE-DEPT-NBR                   PIC  S9(4)V COMP-3.   00800003
008100*CLP 07/07/2015 START                                             00810014
008200     05  PV-SAVE-BRND-ID                    PIC  S9(4) COMP.      00820030
008300*CLP 07/07/2015 END                                               00830014
008400     05  PV-SAVE-UPC-NBR                    PIC  S9(15)V COMP-3.  00840003
008500     05  PV-SAVE-SKU-NBR                    PIC  S9(8)V COMP-3.   00850003
008600     05  PV-SAVE-TRN-NBR                    PIC  S9(9) COMP.      00860003
008700     05  PV-SAVE-TRN-LNE-NBR                PIC  S9(9) COMP.      00870003
008800                                                                  00880003
008900 01  PV-LOG-MSG.                                                  00890003
009000     05  FILLER                       PIC X(10) VALUE             00900003
009100         ' SUKCS574-'.                                            00910003
009200     05  PV-LOG-PARA                  PIC X(05) VALUE SPACES.     00920003
009300     05  FILLER                       PIC X(05) VALUE             00930003
009400         '-BY: '.                                                 00940003
009500     05  PV-LOG-CALLING-PGM           PIC X(08) VALUE SPACES.     00950003
009600     05  FILLER                       PIC X(04) VALUE             00960003
009700         ' AT '.                                                  00970003
009800     05  PV-TIME-PARM                 PIC X(08).                  00980003
009900     05  FILLER                       PIC X(10) VALUE             00990003
010000         ' SQLCODE= '.                                            01000003
010100     05  PV-LOG-SQLCODE               PIC -999.                   01010003
010200     05  FILLER                       PIC X(06) VALUE             01020003
010300         ' TASK='.                                                01030003
010400     05  PV-LOG-TASK                  PIC ZZZ9.                   01040003
010500     05  FILLER                       PIC X(06) VALUE             01050003
010600         ' TRIP='.                                                01060003
010700     05  PV-LOG-TRIP                  PIC 9(09) VALUE ZERO.       01070003
010800     05  FILLER                       PIC X(01) VALUE SPACES.     01080003
010900     05  PV-LOG-TEXT                  PIC X(20) VALUE SPACES.     01090003
011000                                                                  01100003
011100                                                                  01110003
011200 01  PC-PROGRAM-CONSTANTS.                                        01120003
011300     05  PC-RANDOM-PGM                      PIC  X(08)            01130003
011400                                               VALUE  'DPKUT902'. 01140003
011500     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.01150003
011600     05  PC-DK-START-TMST        PIC X(26)     VALUE              01160003
011700                                '0001-01-01-01.01.01.000001'.     01170003
011800     05  PC-HANG                     PIC X(20)  VALUE             01180003
011900         'HANG                '.                                  01190003
012000     05  PC-FOLD                     PIC X(20)  VALUE             01200003
012100         'FOLD                '.                                  01210003
012200     05  PC-RF                       PIC X(02)  VALUE  'RF'.      01220003
012300     05  PC-B                        PIC X(01)  VALUE  'B'.       01230003
012400     05  PC-F                        PIC X(01)  VALUE  'F'.       01240003
012500     05  PC-H                        PIC X(01)  VALUE  'H'.       01250003
012600                                                                  01260003
012700 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01270003
012800                                                   COMP SYNC.     01280003
012900 01  PROGRAM-SWITCHES.                                            01290003
013000*CLP 07/07/2015 START                                             01300020
013100     05  PS-EXISTS                    PIC S9 COMP-3 VALUE ZERO.   01310020
013200         88  PS-ROW-EXISTS-YES              VALUE 1.              01320020
013300         88  PS-ROW-EXISTS-NO               VALUE ZERO.           01330020
013400*CLP 07/07/2015 END                                               01340020
013500     05  PS-TRIP-USED-SW                    PIC X(01).            01350003
013600         88  PS-TRIP-ALREADY-USED           VALUE 'Y'.            01360003
013700         88  PS-TRIP-NOT-USED               VALUE 'N'.            01370003
013800     05  PS-INSERT-DONE-SW                  PIC X(01).            01380003
013900         88  PS-NO-INSERT-DONE              VALUE 'N'.            01390003
014000         88  PS-INSERT-DONE                 VALUE 'Y'.            01400003
014100     05  PS-DEPT-FOUND-SW                   PIC X(01).            01410003
014200         88  PS-DEPT-NOT-FOUND              VALUE 'N'.            01420003
014300         88  PS-DEPT-FOUND                  VALUE 'Y'.            01430003
014400     05  PS-CARTON-INFO-SW                  PIC X(01).            01440003
014500         88  PS-NO-CARTON-INFO              VALUE 'N'.            01450003
014600         88  PS-CARTON-INFO                 VALUE 'Y'.            01460003
014700     05  PS-EOF-DATE-CSR-SW                 PIC X(01).            01470003
014800         88  PS-NOT-EOF-DATE-CSR            VALUE 'N'.            01480003
014900         88  PS-EOF-DATE-CSR                VALUE 'Y'.            01490003
015000     05  PS-EOF-SKU-CURSOR-SW               PIC X(01).            01500003
015100         88  PS-NOT-EOF-SKU-CURSOR          VALUE 'N'.            01510003
015200         88  PS-EOF-SKU-CURSOR              VALUE 'Y'.            01520003
015300     05  PS-EOF-UNT-DOL-CLASS-CSR-SW        PIC X(01).            01530003
015400         88  PS-NOT-EOF-UNT-DOL-CLASS-CSR   VALUE 'N'.            01540003
015500         88  PS-EOF-UNT-DOL-CLASS-CSR       VALUE 'Y'.            01550003
015600     05  PS-EOF-UNT-DOL-MDSE-CSR-SW         PIC X(01).            01560003
015700         88  PS-NOT-EOF-UNT-DOL-MDSE-CSR    VALUE 'N'.            01570003
015800         88  PS-EOF-UNT-DOL-MDSE-CSR        VALUE 'Y'.            01580003
015900     05  PS-NOT-EOF-ITEM-DET-CSR-SW         PIC X(01).            01590003
016000         88  PS-NOT-EOF-ITEM-DET-CSR        VALUE 'N'.            01600003
016100         88  PS-EOF-ITEM-DET-CSR            VALUE 'Y'.            01610003
016200     05  PS-FIRST-TIME-THRU-CSR-SW          PIC X(01).            01620003
016300         88  PS-NOT-FIRST-TIME-THRU-CSR     VALUE 'N'.            01630003
016400         88  PS-FIRST-TIME-THRU-CSR         VALUE 'Y'.            01640003
016500     05  PS-UPC-FOUND-SW                    PIC X(01).            01650003
016600         88  PS-NOT-UPC-FOUND               VALUE 'N'.            01660003
016700         88  PS-UPC-FOUND                   VALUE 'Y'.            01670003
016800                                                                  01680003
016900******************************************************************01690003
017000* PCWS049 - WORK FIELDS USED TO DETERMINE TRAILER CONTENTS        01700003
017100******************************************************************01710003
017200     COPY PCWS049.                                                01720003
017300                                                                  01730003
017400******************************************************************01740011
017500*  COMMAREA LAYOUT TO PASS THE TRAILER TRIP ID TO PCKCS714        01750011
017600*  AND RETURN THE COUNT OF CARTONS ON THE TRAILER                 01760011
017700******************************************************************01770011
017800     COPY PCWS047.                                                01780003
017900                                                                  01790003
018000     COPY DPWS004.                                                01800003
018100                                                                  01810003
018200*----------------------------------------------------------------*01820003
018300*  RANDOM NUMBER AREA                                             01830003
018400*----------------------------------------------------------------*01840003
018500     COPY DPWS902.                                                01850003
018600                                                                  01860003
018700*CLP 07/07/2015 START                                             01870016
018800******************************************************************01880003
018900* XLT_BRND           BRAND TABLE                                  01890016
019000******************************************************************01900003
019100     EXEC SQL                                                     01910003
019200          INCLUDE XLT00043                                        01920016
019300     END-EXEC.                                                    01930003
019400*CLP 07/07/2015 END                                               01940016
019500                                                                  01950003
019600******************************************************************01960003
019700* SUT_OTBND_LOC - OUTBOUND SHIPPING UNIT LOCATION TABLE           01970003
019800******************************************************************01980003
019900     EXEC SQL                                                     01990003
020000          INCLUDE SUT00027                                        02000003
020100     END-EXEC.                                                    02010003
020200                                                                  02020003
020300******************************************************************02030003
020400* SUT_OTBND_CARTON - OTBND SHIPPING UNIT CARTON TABLE             02040003
020500******************************************************************02050003
020600     EXEC SQL                                                     02060003
020700          INCLUDE SUT00024                                        02070003
020800     END-EXEC.                                                    02080003
020900                                                                  02090003
021000******************************************************************02100003
021100* SUT_TRIP_DTL_SUM - TRIP DETAIL SUMMARY TABLE                    02110003
021200******************************************************************02120003
021300     EXEC SQL                                                     02130003
021400          INCLUDE SUT00095                                        02140003
021500     END-EXEC.                                                    02150003
021600                                                                  02160003
021700*CLP 07/07/2015 START                                             02170017
021800******************************************************************02180017
021900* SUT_BRND_MDSE_SUM - BRND MERCHANDISE SUM TABLE                  02190017
022000******************************************************************02200017
022100     EXEC SQL                                                     02210017
022200          INCLUDE SUT00066                                        02220017
022300     END-EXEC.                                                    02230017
022400*CLP 07/07/2015 END                                               02240017
022500                                                                  02250017
022600******************************************************************02260003
022700* SUT_PRC_MSG_CDE  - PRC MESSAGE CODE TABLE                       02270003
022800******************************************************************02280003
022900     EXEC SQL                                                     02290003
023000          INCLUDE SUT00094                                        02300003
023100     END-EXEC.                                                    02310003
023200                                                                  02320003
023300******************************************************************02330003
023400* TSUCDOT - CARTON DIVERT/OUTBOUND TRIP ASSOCIATION TABLE         02340003
023500******************************************************************02350003
023600     EXEC SQL                                                     02360003
023700          INCLUDE TSUCDOT                                         02370003
023800     END-EXEC.                                                    02380003
023900                                                                  02390003
024000******************************************************************02400003
024100* TSUOBTR - OUTBOUND TRAILER TRIP TABLE                           02410003
024200******************************************************************02420003
024300     EXEC SQL                                                     02430003
024400          INCLUDE TSUOBTR                                         02440003
024500     END-EXEC.                                                    02450003
024600                                                                  02460003
024700******************************************************************02470003
024800* TSUOBTR - OUTBOUND TRAILER TRIP STATUS TABLE                    02480003
024900******************************************************************02490003
025000     EXEC SQL                                                     02500003
025100          INCLUDE TSUOBTS                                         02510003
025200     END-EXEC.                                                    02520003
025300                                                                  02530003
025400******************************************************************02540003
025500* TSUOBSC - OUTBOUND TRAILER TRIP STATUS CODE TABLE               02550003
025600******************************************************************02560003
025700     EXEC SQL                                                     02570003
025800          INCLUDE TSUOBSC                                         02580003
025900     END-EXEC.                                                    02590003
026000                                                                  02600003
026100******************************************************************02610003
026200* TSUCRDV - CARTON DIVERTS FROM CONVEYOR SYSTEM TABLE             02620003
026300******************************************************************02630003
026400     EXEC SQL                                                     02640003
026500          INCLUDE TSUCRDV                                         02650003
026600     END-EXEC.                                                    02660003
026700                                                                  02670003
026800******************************************************************02680003
026900* TCNDCDR - DISTRIBUTION CENTER DOOR TABLE                        02690003
027000******************************************************************02700003
027100     EXEC SQL                                                     02710003
027200          INCLUDE TCNDCDR                                         02720003
027300     END-EXEC.                                                    02730003
027400                                                                  02740003
027500******************************************************************02750003
027600* TCNDRST - DISTRIBUTION CENTER DOOR TO STORE ASSOCIATION TABLE   02760003
027700******************************************************************02770003
027800     EXEC SQL                                                     02780003
027900          INCLUDE TCNDRST                                         02790003
028000     END-EXEC.                                                    02800003
028100                                                                  02810003
028200* XLT_BUS_GP                                                      02820010
028300     EXEC SQL                                                     02830003
028400          INCLUDE XLT00001                                        02840003
028500     END-EXEC.                                                    02850003
028600                                                                  02860003
028700* XLT_DEPT                                                        02870010
028800     EXEC SQL                                                     02880003
028900          INCLUDE XLT00002                                        02890003
029000     END-EXEC.                                                    02900003
029100                                                                  02910003
029200* XLT_SKU                                                         02920010
029300     EXEC SQL                                                     02930003
029400          INCLUDE XLT00003                                        02940003
029500     END-EXEC.                                                    02950003
029600                                                                  02960003
029700* XLT_VND_STYL                                                    02970010
029800     EXEC SQL                                                     02980003
029900          INCLUDE XLT00004                                        02990003
030000     END-EXEC.                                                    03000003
030100                                                                  03010003
030200* * * XLT_UPC                                                     03020009
030300     EXEC SQL                                                     03030003
030400          INCLUDE XLT00006                                        03040003
030500     END-EXEC.                                                    03050003
030600                                                                  03060003
030700* * * XLV_SKU_STR                                                 03070003
030800     EXEC SQL                                                     03080003
030900          INCLUDE XLV00002                                        03090003
031000     END-EXEC.                                                    03100003
031100                                                                  03110003
031200* SUT_OTBND_UPC                                                   03120010
031300     EXEC SQL                                                     03130003
031400          INCLUDE SUT00028                                        03140003
031500     END-EXEC.                                                    03150003
031600                                                                  03160003
031700     EXEC SQL                                                     03170003
031800          INCLUDE TPURITM                                         03180003
031900     END-EXEC.                                                    03190003
032000                                                                  03200003
032100* SUT_TRIP_WKRK_AUD                                               03210010
032200     EXEC SQL                                                     03220010
032300          INCLUDE SUT00006                                        03230010
032400     END-EXEC.                                                    03240010
032500                                                                  03250010
032600* SUT_TRIP_SUM                                                    03260010
032700     EXEC SQL                                                     03270003
032800          INCLUDE SUT00007                                        03280003
032900     END-EXEC.                                                    03290003
033000                                                                  03300010
033100* SUT_BUS_AREA_SUM                                                03310010
033200     EXEC SQL                                                     03320003
033300          INCLUDE SUT00008                                        03330003
033400     END-EXEC.                                                    03340003
033500                                                                  03350003
033600* SUT_DEPT_SUM                                                    03360010
033700     EXEC SQL                                                     03370003
033800          INCLUDE SUT00009                                        03380003
033900     END-EXEC.                                                    03390003
034000                                                                  03400003
034100* SUT_MAJ_CL_SUM                                                  03410010
034200     EXEC SQL                                                     03420003
034300          INCLUDE SUT00010                                        03430003
034400     END-EXEC.                                                    03440003
034500                                                                  03450003
034600* SUT_MAJ_CL_AD_DTE                                               03460010
034700     EXEC SQL                                                     03470003
034800          INCLUDE SUT00011                                        03480003
034900     END-EXEC.                                                    03490003
035000                                                                  03500003
035100* *  CENTRAL STOCK - PULL LINE ITEM TABLE                         03510003
035200     EXEC SQL                                                     03520003
035300          INCLUDE TCEPLIT                                         03530003
035400     END-EXEC.                                                    03540003
035500                                                                  03550003
035600     EXEC SQL                                                     03560003
035700          INCLUDE SQLCA                                           03570003
035800     END-EXEC.                                                    03580003
035900                                                                  03590003
036000******************************************************************03600003
036100* PCWS050 - CURSOR USED TO DETERMINE TRAILER CONTENTS             03610003
036200******************************************************************03620003
036300     COPY PCWS050.                                                03630003
036400                                                                  03640003
036500     EXEC SQL                                                     03650003
036600         DECLARE AD-DATE-CSR CURSOR FOR                           03660003
036700         SELECT DISTINCT                                          03670003
036800               BUS_AREA_ID                                        03680003
036900            ,  DEPT_NBR                                           03690003
037000            ,  MAJ_CL_NBR                                         03700003
037100            ,  AD_DTE                                             03710003
037200         FROM SUT_TRIP_DTL_SUM                                    03720003
037300         WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                  03730003
037400          AND  AD_DTE                <> '0001-01-01'              03740003
037500        WITH UR                                                   03750003
037600     END-EXEC.                                                    03760003
037700                                                                  03770003
037800     EXEC SQL                                                     03780003
037900         DECLARE UNT-DOL-CLASS-CSR CURSOR FOR                     03790003
038000         SELECT                                                   03800003
038100               BUS_AREA_ID                                        03810003
038200            ,  DEPT_NBR                                           03820003
038300            ,  MAJ_CL_NBR                                         03830003
038400            ,  SUM(UNT_QTY)                                       03840003
038500            ,  SUM(RTL_DOL_AMT)                                   03850003
038600            ,  SUM(COST_DOL_AMT)                                  03860003
038700         FROM SUT_TRIP_DTL_SUM                                    03870003
038800         WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                  03880003
038900         GROUP BY                                                 03890003
039000               BUS_AREA_ID                                        03900003
039100            ,  DEPT_NBR                                           03910003
039200            ,  MAJ_CL_NBR                                         03920003
039300         ORDER BY                                                 03930003
039400               BUS_AREA_ID                                        03940003
039500            ,  DEPT_NBR                                           03950003
039600            ,  MAJ_CL_NBR                                         03960003
039700        WITH UR                                                   03970003
039800     END-EXEC.                                                    03980003
039900                                                                  03990003
040000*CLP 07/07/2015 START                                             04000015
040100     EXEC SQL                                                     04010015
040200         DECLARE UNT-DOL-BRND-CSR CURSOR FOR                      04020015
040300         SELECT                                                   04030015
040400               BUS_AREA_ID                                        04040015
040500            ,  BRND_ID                                            04050015
040600            ,  SUM(UNT_QTY)                                       04060015
040700            ,  SUM(RTL_DOL_AMT)                                   04070015
040800            ,  SUM(COST_DOL_AMT)                                  04080015
040900         FROM SUT_TRIP_DTL_SUM                                    04090015
041000         WHERE TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                  04100015
041100         GROUP BY                                                 04110015
041200               BUS_AREA_ID                                        04120015
041300            ,  BRND_ID                                            04130015
041400         ORDER BY                                                 04140015
041500               BUS_AREA_ID                                        04150015
041600            ,  BRND_ID                                            04160015
041700        WITH UR                                                   04170015
041800     END-EXEC.                                                    04180015
041900*CLP 07/07/2015 END                                               04190015
042000                                                                  04200015
042100 LINKAGE SECTION.                                                 04210003
042200 01  DFHCOMMAREA.                                                 04220003
042300       05  FILLER                         OCCURS  1 TO 4072 TIMES 04230003
042400                                          DEPENDING ON EIBCALEN.  04240003
042500           10  FILLER                 PIC X.                      04250003
042600/                                                                 04260003
042700 PROCEDURE DIVISION.                                              04270003
042800                                                                  04280003
042900 0000-PROGRAM-MAINLINE.                                           04290003
043000                                                                  04300003
043100     PERFORM 1000-INITIALIZE.                                     04310003
043200                                                                  04320003
043300     PERFORM 2000-PROCESS-TRIP-CARTONS.                           04330003
043400                                                                  04340003
043500     PERFORM 4000-PROCESS-TEMP-TABLE.                             04350003
043600                                                                  04360003
043700     PERFORM 9000-FINIS.                                          04370003
043800                                                                  04380003
043900******************************************************************04390003
044000*                                                                 04400003
044100******************************************************************04410003
044200 1000-INITIALIZE.                                                 04420003
044300                                                                  04430003
044400     EXEC CICS                                                    04440003
044500         ASSIGN USERID(PV-USERID)                                 04450003
044600     END-EXEC.                                                    04460003
044700                                                                  04470003
044800     EXEC CICS                                                    04480003
044900         ASSIGN STARTCODE(PV-STARTCODE)                           04490003
045000     END-EXEC.                                                    04500003
045100                                                                  04510003
045200***   THIS PROGRAM CAN BE STARTED BY EITHER A 'LINK' OR A         04520003
045300***   'START'.  WHEN A LINK IS USED, THE PREVIOUS ASSIGN          04530003
045400***   WILL RETURN A VALUE OF 'TD' TO THE PV-STARTCODE FIELD.      04540003
045500***   ELSE THE PROGRAM WAS 'START'ED AND A RETRIEVE IS NEEDED     04550003
045600***   TO ACCESS THE COMMAREA DATA.                                04560003
045700                                                                  04570003
045800     IF PV-STARTCODE = 'TD' OR 'U'                                04580029
045900**   IF PV-STARTCODE = 'TD'                                       04590028
046000         INITIALIZE PC047-COMMAREA                                04600003
046100         MOVE DFHCOMMAREA                 TO PC047-COMMAREA       04610003
046200     ELSE                                                         04620003
046300         MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH   04630003
046400                                                                  04640003
046500         EXEC CICS                                                04650003
046600             RETRIEVE INTO(PC047-COMMAREA)                        04660003
046700                                       LENGTH(PV-COMMAREA-LENGTH) 04670003
046800         END-EXEC                                                 04680003
046900     END-IF.                                                      04690003
047000                                                                  04700003
047100*                                                                 04710010
047200*** DMH BEGIN - 7/25/13                                           04720010
047300*                                                                 04730010
047400     PERFORM 7990-INSERT-WRKR-AUD.                                04740010
047500*                                                                 04750010
047600*** DMH END - 7/25/13                                             04760010
047700*                                                                 04770010
047800                                                                  04780010
047900     PERFORM 8900-SELECT-CURRENT-DATE.                            04790003
048000     MOVE 'START'                     TO PV-LOG-PARA.             04800003
048100                                                                  04810003
048200     PERFORM 9999-WRITE-TO-CSSL.                                  04820003
048300                                                                  04830003
048400     MOVE PC047-OPER-UNT-ID           TO PC049-DK-OPER-UNT-ID.    04840003
048500     MOVE PC047-DOOR-ID               TO PC049-DK-DOOR-ID.        04850003
048600     MOVE PC047-DEST-OPER-UNT-ID      TO PC049-DK-TRLR-DEST.      04860003
048700     MOVE PC047-DOOR-TYPE-CDE         TO PC049-DK-TRLR-TYPE.      04870004
048800     PERFORM P3000-DOOR-STR-CSR.                                  04880003
048900     MOVE PC047-OTBND-TRIP-ID         TO PC049-DK-OTBND-TRIP-ID   04890003
049000                                         DK-OTBND-TRIP-ID.        04900003
049100     PERFORM P4000-STRT-END-DVRT.                                 04910003
049200                                                                  04920003
049300     IF PC049-DIVERT-CUTOFFS-NO                                   04930003
049400         MOVE PC-DK-START-TMST       TO PC049-DK-START-TMST       04940003
049500         MOVE PC049-PC-DEFAULT-TMST  TO PC049-DK-END-TMST         04950003
049600     END-IF.                                                      04960003
049700                                                                  04970003
049800 2000-PROCESS-TRIP-CARTONS.                                       04980003
049900     MOVE 0    TO  PV-SAVE-UPC-NBR                                04990003
050000                   PV-SAVE-TRN-NBR                                05000003
050100                   PV-SAVE-TRN-LNE-NBR                            05010003
050200                   PV-SAVE-SKU-NBR.                               05020003
050300     PERFORM 5000-CREATE-TRIP-OCCURENCE-ID.                       05030003
050400     MOVE DK-TRIP-OCRNC-ID       TO SUT00007-TRIP-OCRNC-ID.       05040003
050500     MOVE DK-OTBND-TRIP-ID       TO SUT00007-OTBND-TRIP-ID.       05050003
050600     MOVE 0                      TO SUT00007-UNT-QTY              05060003
050700                                    SUT00007-SKU-QTY              05070003
050800                                    SUT00007-CART-QTY             05080003
050900                                    SUT00007-RTL-DOL-AMT          05090003
051000                                    SUT00007-COST-DOL-AMT.        05100003
051100     PERFORM 8860-INSERT-SUT00007                                 05110003
051200             UNTIL PS-INSERT-DONE.                                05120003
051300                                                                  05130003
051400     SET PC049-NOT-EOF-SHP-ACTV-CRT-UPC                           05140004
051500         PC049-NOT-EOF-SHL-ACTV-CRT-UPC                           05150006
051600         PS-DEPT-NOT-FOUND    TO TRUE.                            05160004
051700                                                                  05170004
051800     IF  PC049-DK-SHIPPING-TRLR                                   05180004
051900         PERFORM P7360-OPEN-SHP-ACV-CR-UPC-CSR                    05190004
052000         PERFORM 2100-FETCH-TRIP-CARTONS                          05200004
052100            UNTIL PC049-EOF-SHP-ACTV-CRTN-UPC                     05210004
052200         PERFORM P7380-CLOSE-SHP-ACV-CR-UPC-CSR                   05220004
052300     ELSE                                                         05230004
052400         PERFORM P7390-OPEN-SHL-ACV-CR-UPC-CSR                    05240007
052500         PERFORM 2100-FETCH-TRIP-CARTONS                          05250004
052600            UNTIL PC049-EOF-SHL-ACTV-CRTN-UPC                     05260005
052700         PERFORM P7410-CLOSE-SHL-ACV-CR-UPC-CSR                   05270007
052800     END-IF.                                                      05280004
052900                                                                  05290003
053000 2100-FETCH-TRIP-CARTONS.                                         05300003
053100                                                                  05310004
053200     IF  PC049-DK-SHIPPING-TRLR                                   05320004
053300         PERFORM P7370-FETCH-SHP-ACV-CR-UPC-CSR                   05330004
053400         IF  PC049-NOT-EOF-SHP-ACTV-CRT-UPC                       05340008
053500             PERFORM 3000-DET-CARTON-CHARACTERISTCS               05350008
053600         END-IF                                                   05360008
053700     ELSE                                                         05370004
053800         PERFORM P7400-FETCH-SHL-ACV-CR-UPC-CSR                   05380007
053900         IF  PC049-NOT-EOF-SHL-ACTV-CRT-UPC                       05390008
054000             PERFORM 3000-DET-CARTON-CHARACTERISTCS               05400008
054100         END-IF                                                   05410008
054200     END-IF.                                                      05420004
054300                                                                  05430004
054400                                                                  05440003
054500 3000-DET-CARTON-CHARACTERISTCS.                                  05450003
054600                                                                  05460003
054700*** FOR TESTING ONLY                                              05470003
054800*    IF PC049-PV-REC-TYPE = 'B'                                   05480003
054900*        STRING 'B '                     DELIMITED BY SIZE        05490003
055000*               SUCRDV-BRCDE-NBR         DELIMITED BY SIZE        05500003
055100*                                       INTO PV-CICS-MSG-AREA     05510003
055200*        PERFORM 9997-CSSL                                        05520003
055300*    END-IF.                                                      05530003
055400*** FOR TESTING ONLY                                              05540003
055500                                                                  05550004
055600     SET PS-NO-CARTON-INFO       TO TRUE.                         05560003
055700     PERFORM 7000-SELECT-CARTON-INFO.                             05570003
055800     PERFORM 3100-PROCESS-ITEMS.                                  05580003
055900                                                                  05590003
056000 3100-PROCESS-ITEMS.                                              05600003
056100     IF SUT00028-UPC-NBR NOT = PV-SAVE-UPC-NBR                    05610003
056200         PERFORM 7230-SELECT-DEPT                                 05620003
056300     END-IF.                                                      05630003
056400***                                                               05640003
056500     IF  SUT00028-UPC-NBR = ZEROES                                05650003
056600         MOVE ZEROES  TO  XLT00003-SKU-NBR                        05660003
056700                          XLT00004-DEPT-NBR                       05670003
056800                          XLT00004-MAJ-CL-NBR                     05680003
056900                          XLT00001-BUS-AREA-ID                    05690003
057000         MOVE SPACES  TO  XLT00004-HNG-FOLD-DESC                  05700003
057100         MOVE 'H'     TO  XLT00002-MDSE-LNE-CDE                   05710003
057200     END-IF.                                                      05720003
057300***                                                               05730003
057400*CLP 07/07/2015 START - GET BRAND ID                              05740014
057500     IF XLT00003-SKU-NBR NOT = PV-SAVE-SKU-NBR                    05750003
057600         PERFORM 7280-SELECT-BRAND-ID                             05760014
057700     END-IF.                                                      05770003
057800                                                                  05780014
057900     IF PS-DEPT-NOT-FOUND                                         05790003
058000         PERFORM 3200-PROCESS-DUMMY-CARTON                        05800003
058100     ELSE                                                         05810003
058200         IF (SUT00028-TRN-NBR = 0 AND                             05820003
058300             SUT00028-TRN-LNE-NBR = 0)                            05830003
058400            OR SUT00024-CART-SRC-CDE = 'FXR'                      05840003
058500            OR PS-NO-CARTON-INFO                                  05850003
058600             MOVE '0001-01-01' TO PV-AD-EVNT-DTE                  05860003
058700             MOVE 0   TO PURITM-UNT-RTL-PR-AMT                    05870003
058800                         PURITM-UNT-COST-AMT                      05880003
058900******* ADDED TO FIX INC000001759369 - 7/12/11                    05890003
059000                         PV-UNT-RTL-AMT                           05900003
059100                         PV-UNT-COST-AMT                          05910003
059200         ELSE                                                     05920003
059300             IF SUT00028-UPC-NBR NOT = PV-SAVE-UPC-NBR OR         05930003
059400                SUT00028-TRN-NBR NOT = PV-SAVE-TRN-NBR OR         05940003
059500                SUT00028-TRN-LNE-NBR NOT = PV-SAVE-TRN-LNE-NBR    05950003
059600                 MOVE SUT00028-UPC-NBR TO PV-SAVE-UPC-NBR         05960003
059700                 MOVE SUT00028-TRN-NBR TO PV-SAVE-TRN-NBR         05970003
059800                 MOVE SUT00028-TRN-LNE-NBR TO PV-SAVE-TRN-LNE-NBR 05980003
059900                 MOVE ZERO          TO PV-UNT-RTL-AMT             05990003
060000                                       PV-UNT-COST-AMT            06000003
060100                 IF SUT00024-CART-SRC-CDE NOT = 'RDM'             06010003
060200                     PERFORM 7260-SELECT-TPURITM                  06020003
060300                     MOVE PURITM-UNT-RTL-PR-AMT                   06030003
060400                                    TO PV-UNT-RTL-AMT             06040003
060500                     MOVE PURITM-UNT-COST-AMT                     06050003
060600                                    TO PV-UNT-COST-AMT            06060003
060700                 ELSE                                             06070003
060800                     MOVE '0001-01-01' TO PV-AD-EVNT-DTE          06080003
060900                     PERFORM 7250-RDM-COST-AND-RETAIL             06090003
061000                     MOVE CEPLIT-UNT-RTL-AMT                      06100003
061100                                    TO PV-UNT-RTL-AMT             06110003
061200                     MOVE XLV00002-UNT-COST-AMT                   06120003
061300                                    TO PV-UNT-COST-AMT            06130003
061400                 END-IF                                           06140003
061500             END-IF                                               06150003
061600         END-IF                                                   06160003
061700         PERFORM 7270-PRC-MSG-CDE                                 06170003
061800         MOVE XLT00004-DEPT-NBR     TO SUT00095-DEPT-NBR          06180003
061900         MOVE XLT00004-MAJ-CL-NBR   TO SUT00095-MAJ-CL-NBR        06190003
062000         MOVE XLT00001-BUS-AREA-ID  TO SUT00095-BUS-AREA-ID       06200003
062100         MOVE SUT00028-SHPD-UNT-QTY TO SUT00095-UNT-QTY           06210003
062200         COMPUTE SUT00095-RTL-DOL-AMT =                           06220003
062300*             PURITM-UNT-RTL-PR-AMT * SUT00028-SHPD-UNT-QTY       06230003
062400              PV-UNT-RTL-AMT  * SUT00028-SHPD-UNT-QTY             06240003
062500         COMPUTE SUT00095-COST-DOL-AMT  =                         06250003
062600*             PURITM-UNT-COST-AMT   * SUT00028-SHPD-UNT-QTY       06260003
062700              PV-UNT-COST-AMT * SUT00028-SHPD-UNT-QTY             06270003
062800         MOVE XLT00003-SKU-NBR      TO SUT00095-SKU-NBR           06280003
062900                                       PV-SAVE-SKU-NBR            06290003
063000         MOVE SUCRDV-SHIPT-UNT-ID   TO SUT00095-SHIPT-UNT-ID      06300003
063100         MOVE PV-AD-EVNT-DTE        TO SUT00095-AD-DTE            06310003
063200         MOVE XLT00002-MDSE-LNE-CDE TO SUT00095-MDSE-LNE-CDE      06320003
063300         MOVE DK-TRIP-OCRNC-ID      TO SUT00095-TRIP-OCRNC-ID     06330003
063400         EVALUATE XLT00004-HNG-FOLD-DESC                          06340003
063500             WHEN PC-HANG                                         06350003
063600                 MOVE 1            TO SUT00095-HNG-FOLD-SEQ-NBR   06360003
063700             WHEN PC-FOLD                                         06370003
063800                 MOVE 2            TO SUT00095-HNG-FOLD-SEQ-NBR   06380003
063900             WHEN OTHER                                           06390003
064000                 MOVE 0            TO SUT00095-HNG-FOLD-SEQ-NBR   06400003
064100         END-EVALUATE                                             06410003
064200*CLP 07/07/2015 START                                             06420014
064300         MOVE XLT00043-BRND-ID      TO SUT00095-BRND-ID           06430014
064400*CLP 07/07/2015 END                                               06440014
064500         MOVE SUT00024-EAS-TAG-IND  TO SUT00095-EAS-TAG-IND       06450003
064600         MOVE SUT00094-PRC-MSG-CDE  TO SUT00095-PRC-MSG-CDE       06460003
064700         MOVE SUCRDV-DIVERT-TMST    TO SUT00095-DIVERT-TMST       06470003
064800         PERFORM 7900-INSERT-SUT00095                             06480003
064900     END-IF.                                                      06490003
065000                                                                  06500003
065100*CLP 07/07/2015 START                                             06510014
065200 3111-FIND-NEW-IND.                                               06520014
065300                                                                  06530014
065400     MOVE ZERO TO PS-EXISTS.                                      06540020
065500                                                                  06550020
065600     EXEC SQL                                                     06560014
065700         SELECT 1                                                 06570020
065800         INTO  :PS-EXISTS                                         06580020
065900         FROM SUT_TRIP_DTL_SUM                                    06590014
066000        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    06600014
066100         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       06610014
066200         AND   BRND_ID               = :PV-SAVE-BRND-ID           06620014
066300         AND   PRC_MSG_CDE           = :PC-RF                     06630014
066400           FETCH FIRST 1 ROWS ONLY                                06640020
066500        WITH UR                                                   06650014
066600     END-EXEC.                                                    06660014
066700                                                                  06670014
066800     EVALUATE TRUE                                                06680014
066900         WHEN SQLCODE = ZERO                                      06690014
067000              IF PS-ROW-EXISTS-YES                                06700020
067100                 MOVE 'Y'    TO  SUT00066-PRC-MSG-RPLN-NEW-IND    06710020
067200              ELSE                                                06720026
067300                 MOVE 'N'    TO  SUT00066-PRC-MSG-RPLN-NEW-IND    06730026
067400              END-IF                                              06740014
067500         WHEN SQLCODE = +100                                      06750026
067600                 MOVE 'N'    TO  SUT00066-PRC-MSG-RPLN-NEW-IND    06760026
067700         WHEN SQLWARN0 NOT = SPACE                                06770014
067800         WHEN SQLCODE  NOT = +0                                   06780014
067900              MOVE '3111-FIND-NEW-IND'                            06790014
068000                                   TO PV-PARAGRAPH-NAME           06800014
068100              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  06810014
068200              MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         06820014
068300              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              06830014
068400              PERFORM 9200-SQL-ABEND                              06840014
068500     END-EVALUATE.                                                06850014
068600*CLP 07/07/2015 END                                               06860014
068700                                                                  06870014
068800                                                                  06880003
068900*CLP 07/07/2015 - START                                           06890014
069000 3121-FIND-HANG-CDE.                                              06900014
069100     EXEC SQL                                                     06910014
069200         SELECT COUNT(HNG_FOLD_SEQ_NBR)                           06920014
069300         INTO  :PV-HANG-CDE-COUNT                                 06930014
069400         FROM SUT_TRIP_DTL_SUM                                    06940014
069500        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    06950014
069600         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       06960014
069700         AND   BRND_ID               = :PV-SAVE-BRND-ID           06970014
069800         AND   HNG_FOLD_SEQ_NBR      = 1                          06980014
069900        WITH UR                                                   06990014
070000     END-EXEC.                                                    07000014
070100                                                                  07010014
070200     EVALUATE TRUE                                                07020014
070300         WHEN SQLCODE = ZERO                                      07030014
070400              CONTINUE                                            07040014
070500         WHEN SQLWARN0 NOT = SPACE                                07050014
070600         WHEN SQLCODE  NOT = +0                                   07060014
070700              MOVE '3121-FIND-HANG-CDE'                           07070014
070800                                   TO PV-PARAGRAPH-NAME           07080014
070900              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  07090014
071000              MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         07100014
071100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              07110014
071200              PERFORM 9200-SQL-ABEND                              07120014
071300     END-EVALUATE.                                                07130014
071400*CLP 07/07/2015 END                                               07140014
071500                                                                  07150014
071600*CLP 07/07/2015 START                                             07160014
071700 3131-FIND-FOLD-CDE.                                              07170014
071800     EXEC SQL                                                     07180014
071900         SELECT COUNT(HNG_FOLD_SEQ_NBR)                           07190014
072000         INTO  :PV-FOLD-CDE-COUNT                                 07200014
072100         FROM SUT_TRIP_DTL_SUM                                    07210014
072200        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    07220014
072300         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       07230014
072400         AND   BRND_ID               = :PV-SAVE-BRND-ID           07240014
072500         AND   HNG_FOLD_SEQ_NBR      = 2                          07250014
072600        WITH UR                                                   07260014
072700     END-EXEC.                                                    07270014
072800                                                                  07280014
072900     EVALUATE TRUE                                                07290014
073000         WHEN SQLCODE = ZERO                                      07300014
073100              CONTINUE                                            07310014
073200         WHEN SQLWARN0 NOT = SPACE                                07320014
073300         WHEN SQLCODE  NOT = +0                                   07330014
073400              MOVE '3131-FIND-FOLD-CDE'                           07340014
073500                                   TO PV-PARAGRAPH-NAME           07350014
073600              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  07360014
073700              MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         07370014
073800              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              07380014
073900              PERFORM 9200-SQL-ABEND                              07390014
074000     END-EVALUATE.                                                07400014
074100                                                                  07410031
074200                                                                  07420014
074300 3200-PROCESS-DUMMY-CARTON.                                       07430003
074400     MOVE 9999                  TO SUT00095-DEPT-NBR.             07440003
074500     MOVE 9999                  TO SUT00095-MAJ-CL-NBR.           07450003
074600     MOVE 9999                  TO SUT00095-BUS-AREA-ID.          07460003
074700     MOVE 0                     TO SUT00095-UNT-QTY.              07470003
074800     MOVE 0                     TO SUT00095-RTL-DOL-AMT.          07480003
074900     MOVE 0                     TO SUT00095-COST-DOL-AMT.         07490003
075000     MOVE 0                     TO SUT00095-SKU-NBR.              07500003
075100     MOVE SUCRDV-SHIPT-UNT-ID   TO SUT00095-SHIPT-UNT-ID.         07510003
075200     MOVE '0001-01-01'          TO SUT00095-AD-DTE.               07520003
075300     MOVE SPACES                TO SUT00095-MDSE-LNE-CDE.         07530003
075400     MOVE 0                     TO SUT00095-HNG-FOLD-SEQ-NBR.     07540003
075500                                                                  07550031
075600     MOVE 9999999999            TO SUT00095-BRND-ID.              07560014
075700                                                                  07570031
075800     MOVE SUT00024-EAS-TAG-IND  TO SUT00095-EAS-TAG-IND.          07580003
075900     PERFORM 7270-PRC-MSG-CDE.                                    07590003
076000     MOVE SUT00094-PRC-MSG-CDE  TO SUT00095-PRC-MSG-CDE.          07600003
076100     MOVE SUCRDV-DIVERT-TMST    TO SUT00095-DIVERT-TMST.          07610003
076110                                                                  07611031
076120     MOVE DK-TRIP-OCRNC-ID      TO SUT00095-TRIP-OCRNC-ID.        07612031
076130                                                                  07613031
076200     PERFORM 7900-INSERT-SUT00095.                                07620003
076300                                                                  07630003
076400 4000-PROCESS-TEMP-TABLE.                                         07640003
076500                                                                  07650003
076600     PERFORM 8600-SUMM-TRIP-QTY-DOL.                              07660003
076700     PERFORM 8700-SELECT-SKU-CNT-TRIP.                            07670003
076800     PERFORM 8750-SELECT-CARTON-CNT-TRIP.                         07680003
076900     MOVE DK-TRIP-OCRNC-ID       TO SUT00007-TRIP-OCRNC-ID.       07690003
077000     MOVE DK-OTBND-TRIP-ID       TO SUT00007-OTBND-TRIP-ID.       07700003
077100     MOVE PV-UNIT-QTY-SUM        TO SUT00007-UNT-QTY.             07710003
077200     MOVE PV-SKU-COUNT           TO SUT00007-SKU-QTY.             07720003
077300     MOVE PV-CARTON-COUNT        TO SUT00007-CART-QTY.            07730003
077400     MOVE PV-RETAIL-SUM          TO SUT00007-RTL-DOL-AMT.         07740003
077500     MOVE PV-COST-SUM            TO SUT00007-COST-DOL-AMT.        07750003
077600     PERFORM 8870-UPDATE-SUT00007.                                07760003
077700                                                                  07770003
077800     MOVE 0          TO PV-SAVE-BUS-AREA-ID                       07780003
077900                        PV-SAVE-DEPT-NBR                          07790003
078000*CLP 07/07/2015 START                                             07800020
078100                        PV-SAVE-BRND-ID.                          07810020
078200                                                                  07820003
078300     SET PS-NOT-EOF-UNT-DOL-CLASS-CSR TO TRUE.                    07830021
078400     PERFORM 8000-OPEN-SKU-QTY-CLASS-CURSOR.                      07840021
078500     PERFORM 4100-DETERMINE-CLASS-VALUES                          07850021
078600         UNTIL PS-EOF-UNT-DOL-CLASS-CSR.                          07860021
078700     PERFORM 8060-CLOSE-SKU-QTY-CLASS-CSR.                        07870021
078800                                                                  07880021
078900     MOVE 0          TO PV-SAVE-BUS-AREA-ID                       07890021
079000                        PV-SAVE-BRND-ID.                          07900021
079100                                                                  07910021
079200     SET PS-NOT-EOF-UNT-DOL-MDSE-CSR TO TRUE.                     07920014
079300     PERFORM 8101-OPEN-SKU-QTY-BRND-CURSOR.                       07930014
079400     PERFORM 4201-DETERMINE-BRND-MDSE-VALUE                       07940018
079500         UNTIL PS-EOF-UNT-DOL-MDSE-CSR.                           07950014
079600     PERFORM 8161-CLOSE-SKU-QTY-BRND-CSR.                         07960014
079700*CLP 07/07/2015 END                                               07970014
079800                                                                  07980003
079900     SET PS-NOT-EOF-DATE-CSR TO TRUE.                             07990003
080000     PERFORM 7300-OPEN-AD-DATE-CURSOR.                            08000003
080100     PERFORM 4400-PROCESS-DATE-CURSOR                             08010003
080200         UNTIL PS-EOF-DATE-CSR.                                   08020003
080300     PERFORM 7500-CLOSE-AD-DATE.                                  08030003
080400                                                                  08040003
080500                                                                  08050003
080600 4100-DETERMINE-CLASS-VALUES.                                     08060003
080700     PERFORM 8030-FETCH-SKU-QTY-CLASS-CSR.                        08070003
080800     IF PS-NOT-EOF-UNT-DOL-CLASS-CSR                              08080003
080900         PERFORM 8200-SELECT-SKU-CNT-CLASS                        08090003
081000         PERFORM 8250-SELECT-CARTON-CNT-CLASS                     08100003
081100         MOVE DK-TRIP-OCRNC-ID       TO SUT00010-TRIP-OCRNC-ID    08110003
081200         MOVE SUT00095-BUS-AREA-ID   TO SUT00010-BUS-AREA-ID      08120003
081300         MOVE SUT00095-DEPT-NBR      TO SUT00010-DEPT-NBR         08130003
081400         MOVE SUT00095-MAJ-CL-NBR    TO SUT00010-MAJ-CL-NBR       08140003
081500         MOVE PV-UNIT-QTY-SUM        TO SUT00010-UNT-QTY          08150003
081600         MOVE PV-SKU-COUNT           TO SUT00010-SKU-QTY          08160003
081700         MOVE PV-CARTON-COUNT        TO SUT00010-CART-QTY         08170003
081800         MOVE PV-RETAIL-SUM          TO SUT00010-RTL-DOL-AMT      08180003
081900         MOVE PV-COST-SUM            TO SUT00010-COST-DOL-AMT     08190003
082000         IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID        08200003
082100             IF PV-SAVE-BUS-AREA-ID > 0                           08210003
082200                 PERFORM 8550-SELECT-CARTON-CNT-BUS-GP            08220003
082300                 MOVE PV-CARTON-COUNT        TO SUT00008-CART-QTY 08230003
082400                 PERFORM 8845-UPDATE-SUT00008                     08240003
082500             END-IF                                               08250003
082600             INITIALIZE DCLSUT00008                               08260003
082700             MOVE DK-TRIP-OCRNC-ID     TO SUT00008-TRIP-OCRNC-ID  08270003
082800             MOVE SUT00095-BUS-AREA-ID TO SUT00008-BUS-AREA-ID    08280003
082900             PERFORM 8840-INSERT-SUT00008                         08290003
083000         END-IF                                                   08300003
083100         IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID OR     08310003
083200            SUT00095-DEPT-NBR    NOT = PV-SAVE-DEPT-NBR           08320003
083300             IF PV-SAVE-BUS-AREA-ID > 0 AND                       08330003
083400                PV-SAVE-DEPT-NBR > 0                              08340003
083500                 PERFORM 8350-SELECT-CARTON-CNT-DEPT              08350003
083600                 MOVE PV-CARTON-COUNT        TO SUT00009-CART-QTY 08360003
083700                 PERFORM 8825-UPDATE-SUT00009                     08370003
083800             END-IF                                               08380003
083900             INITIALIZE DCLSUT00009                               08390003
084000             MOVE DK-TRIP-OCRNC-ID     TO SUT00009-TRIP-OCRNC-ID  08400003
084100             MOVE SUT00095-BUS-AREA-ID TO SUT00009-BUS-AREA-ID    08410003
084200             MOVE SUT00095-DEPT-NBR    TO SUT00009-DEPT-NBR       08420003
084300             PERFORM 8820-INSERT-SUT00009                         08430003
084400         END-IF                                                   08440003
084500         PERFORM 8800-INSERT-SUT00010                             08450003
084600                                                                  08460003
084700         IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID OR     08470003
084800            SUT00095-DEPT-NBR    NOT = PV-SAVE-DEPT-NBR           08480003
084900             MOVE DK-TRIP-OCRNC-ID       TO SUT00009-TRIP-OCRNC-ID08490003
085000             MOVE SUT00095-BUS-AREA-ID   TO SUT00009-BUS-AREA-ID  08500003
085100             MOVE SUT00095-DEPT-NBR      TO SUT00009-DEPT-NBR     08510003
085200             MOVE PV-UNIT-QTY-SUM        TO SUT00009-UNT-QTY      08520003
085300             MOVE PV-SKU-COUNT           TO SUT00009-SKU-QTY      08530003
085400             MOVE PV-CARTON-COUNT        TO SUT00009-CART-QTY     08540003
085500             MOVE PV-RETAIL-SUM          TO SUT00009-RTL-DOL-AMT  08550003
085600             MOVE PV-COST-SUM            TO SUT00009-COST-DOL-AMT 08560003
085700             IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID    08570003
085800                 MOVE DK-TRIP-OCRNC-ID                            08580003
085900                                         TO SUT00008-TRIP-OCRNC-ID08590003
086000                 MOVE SUT00095-BUS-AREA-ID TO SUT00008-BUS-AREA-ID08600003
086100                 MOVE PV-UNIT-QTY-SUM      TO SUT00008-UNT-QTY    08610003
086200                 MOVE PV-SKU-COUNT         TO SUT00008-SKU-QTY    08620003
086300                 MOVE PV-RETAIL-SUM        TO SUT00008-RTL-DOL-AMT08630003
086400                 MOVE PV-COST-SUM         TO SUT00008-COST-DOL-AMT08640003
086500             ELSE                                                 08650003
086600                 ADD  PV-UNIT-QTY-SUM      TO SUT00008-UNT-QTY    08660003
086700                 ADD  PV-SKU-COUNT         TO SUT00008-SKU-QTY    08670003
086800                 ADD  PV-RETAIL-SUM        TO SUT00008-RTL-DOL-AMT08680003
086900                 ADD  PV-COST-SUM         TO SUT00008-COST-DOL-AMT08690003
087000             END-IF                                               08700003
087100             MOVE SUT00095-BUS-AREA-ID    TO PV-SAVE-BUS-AREA-ID  08710003
087200             MOVE SUT00095-DEPT-NBR       TO PV-SAVE-DEPT-NBR     08720003
087300         ELSE                                                     08730003
087400             ADD  PV-UNIT-QTY-SUM        TO SUT00009-UNT-QTY      08740003
087500             ADD  PV-SKU-COUNT           TO SUT00009-SKU-QTY      08750003
087600             ADD  PV-CARTON-COUNT        TO SUT00009-CART-QTY     08760003
087700             ADD  PV-RETAIL-SUM          TO SUT00009-RTL-DOL-AMT  08770003
087800             ADD  PV-COST-SUM            TO SUT00009-COST-DOL-AMT 08780003
087900             ADD  PV-UNIT-QTY-SUM        TO SUT00008-UNT-QTY      08790003
088000             ADD  PV-SKU-COUNT           TO SUT00008-SKU-QTY      08800003
088100             ADD  PV-RETAIL-SUM          TO SUT00008-RTL-DOL-AMT  08810003
088200             ADD  PV-COST-SUM            TO SUT00008-COST-DOL-AMT 08820003
088300         END-IF                                                   08830003
088400     ELSE                                                         08840003
088500         IF PV-SAVE-DEPT-NBR > 0                                  08850003
088600             PERFORM 8350-SELECT-CARTON-CNT-DEPT                  08860003
088700             MOVE PV-CARTON-COUNT        TO SUT00009-CART-QTY     08870003
088800             PERFORM 8825-UPDATE-SUT00009                         08880003
088900         END-IF                                                   08890003
089000         IF PV-SAVE-BUS-AREA-ID > 0                               08900003
089100             PERFORM 8550-SELECT-CARTON-CNT-BUS-GP                08910003
089200             MOVE PV-CARTON-COUNT        TO SUT00008-CART-QTY     08920003
089300             PERFORM 8845-UPDATE-SUT00008                         08930003
089400         END-IF                                                   08940003
089500     END-IF.                                                      08950003
089600                                                                  08960003
089700*CLP 07/07/2015 START                                             08970014
089800* NEW SET OF PARA'S FOR BRAND                                     08980014
089900 4201-DETERMINE-BRND-MDSE-VALUE.                                  08990018
090000     PERFORM 8131-FETCH-SKU-QTY-BRND-CSR.                         09000014
090100     IF PS-NOT-EOF-UNT-DOL-MDSE-CSR                               09010014
090200         INITIALIZE DCLSUT00066                                   09020020
090300         MOVE SUT00095-BUS-AREA-ID   TO PV-SAVE-BUS-AREA-ID       09030014
090400         MOVE SUT00095-BRND-ID       TO PV-SAVE-BRND-ID           09040014
090500         PERFORM 8451-SELECT-CARTON-CNT-BRND                      09050014
090600         MOVE PV-CARTON-COUNT        TO SUT00066-CART-QTY         09060017
090700         PERFORM 8401-SELECT-SKU-CNT-BRND                         09070014
090800         MOVE PV-SKU-COUNT           TO SUT00066-SKU-QTY          09080017
090900         MOVE DK-TRIP-OCRNC-ID       TO SUT00066-TRIP-OCRNC-ID    09090017
091000         MOVE SUT00095-BUS-AREA-ID   TO SUT00066-BUS-AREA-ID      09100017
091100         MOVE SUT00095-BRND-ID       TO SUT00066-BRND-ID          09110017
091200         MOVE PV-UNIT-QTY-SUM        TO SUT00066-UNT-QTY          09120017
091300         MOVE PV-RETAIL-SUM          TO SUT00066-RTL-DOL-AMT      09130017
091400         MOVE PV-COST-SUM            TO SUT00066-COST-DOL-AMT     09140017
091500         MOVE ZEROES                TO PV-NEW-IND-COUNT           09150014
091600                                       PV-HANG-CDE-COUNT          09160014
091700                                       PV-FOLD-CDE-COUNT          09170014
091800         PERFORM 3111-FIND-NEW-IND                                09180014
091900         PERFORM 3121-FIND-HANG-CDE                               09190014
092000         PERFORM 3131-FIND-FOLD-CDE                               09200014
092100         EVALUATE TRUE                                            09210014
092200            WHEN (PV-HANG-CDE-COUNT > 0  AND                      09220014
092300                  PV-FOLD-CDE-COUNT > 0)                          09230014
092400                 MOVE PC-B  TO SUT00066-HNG-FOLD-CDE              09240017
092500            WHEN (PV-HANG-CDE-COUNT = 0  AND                      09250014
092600                  PV-FOLD-CDE-COUNT = 0)                          09260014
092700                 MOVE SPACE TO SUT00066-HNG-FOLD-CDE              09270017
092800            WHEN (PV-HANG-CDE-COUNT > 0  AND                      09280014
092900                  PV-FOLD-CDE-COUNT = 0)                          09290014
093000                 MOVE PC-H  TO SUT00066-HNG-FOLD-CDE              09300017
093100            WHEN (PV-HANG-CDE-COUNT = 0  AND                      09310014
093200                  PV-FOLD-CDE-COUNT > 0)                          09320014
093300                 MOVE PC-F  TO SUT00066-HNG-FOLD-CDE              09330017
093400            WHEN OTHER                                            09340014
093500                 DISPLAY 'SOMETHING WRONG HERE'                   09350014
093600         END-EVALUATE                                             09360014
093700         PERFORM 8891-INSERT-SUT00066                             09370017
093800     END-IF.                                                      09380014
093900*CLP 07/07/2015 END                                               09390014
094000                                                                  09400003
094100 4400-PROCESS-DATE-CURSOR.                                        09410003
094200     PERFORM 7400-FETCH-AD-DATE.                                  09420003
094300     IF PS-NOT-EOF-DATE-CSR                                       09430003
094400         MOVE DK-TRIP-OCRNC-ID       TO SUT00011-TRIP-OCRNC-ID    09440003
094500         MOVE SUT00095-BUS-AREA-ID   TO SUT00011-BUS-AREA-ID      09450003
094600         MOVE SUT00095-DEPT-NBR      TO SUT00011-DEPT-NBR         09460003
094700         MOVE SUT00095-MAJ-CL-NBR    TO SUT00011-MAJ-CL-NBR       09470003
094800         MOVE SUT00095-AD-DTE        TO SUT00011-AD-EVNT-DTE      09480003
094900         PERFORM 8880-INSERT-SUT00011                             09490003
095000     END-IF.                                                      09500003
095100                                                                  09510003
095200                                                                  09520003
095300 5000-CREATE-TRIP-OCCURENCE-ID.                                   09530003
095400     CALL PC-RANDOM-PGM USING DFHEIBLK                            09540003
095500                              DFHCOMMAREA                         09550003
095600                              DP902-RANDNBR-ROUTINE-FIELDS.       09560003
095700                                                                  09570003
095800     IF DP902-SUCCESSFUL                                          09580003
095900         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          09590003
096000         MOVE PV-RANDOM-NUMBER       TO DK-TRIP-OCRNC-ID          09600003
096100         IF DK-TRIP-OCRNC-ID  > 300000000                         09610003
096200            CONTINUE                                              09620003
096300         ELSE                                                     09630003
096400            ADD  300000000           TO  DK-TRIP-OCRNC-ID         09640003
096500         END-IF                                                   09650003
096600                                                                  09660003
096700     ELSE                                                         09670003
096800         MOVE ' SUKCS574 - ERROR GENERATING RANDOM NBR'           09680003
096900                                     TO PV-CICS-MSG-AREA          09690003
097000         PERFORM 9997-CSSL                                        09700003
097100     END-IF.                                                      09710003
097200                                                                  09720003
097300                                                                  09730003
097400 7000-SELECT-CARTON-INFO.                                         09740003
097500     EXEC SQL                                                     09750003
097600         SELECT CART_SRC_CDE                                      09760003
097700            ,   EAS_TAG_IND                                       09770003
097800            ,   CRE_DTE                                           09780003
097900         INTO   :SUT00024-CART-SRC-CDE                            09790003
098000            ,   :SUT00024-EAS-TAG-IND                             09800003
098100            ,   :SUT00024-CRE-DTE                                 09810003
098200         FROM                                                     09820003
098300              SUT_OTBND_CART                                      09830003
098400         WHERE                                                    09840003
098500               SHIPT_UNT_ID          = :SUCRDV-SHIPT-UNT-ID       09850003
098600     END-EXEC.                                                    09860003
098700                                                                  09870003
098800     EVALUATE TRUE                                                09880003
098900         WHEN SQLCODE = ZEROS                                     09890003
099000              SET PS-CARTON-INFO   TO TRUE                        09900003
099100         WHEN SQLCODE = +100                                      09910003
099200              MOVE SPACES TO SUT00024-CART-SRC-CDE                09920003
099300                                                                  09930003
099400         WHEN OTHER                                               09940003
099500              MOVE '7000-SELECT-CARTON-INFO'                      09950003
099600                                   TO PV-PARAGRAPH-NAME           09960003
099700              MOVE 'SELECT FROM SUT_OTBND_CART'                   09970003
099800                                   TO PV-DB2-OPERATION-ATTEMPTED  09980003
099900              MOVE SUCRDV-SHIPT-UNT-ID                            09990003
100000                                    TO PV-SHIPT-UNT-ID            10000003
100100              MOVE PV-SHIPT-UNT-ID  TO PV-FIELD-VALUE             10010003
100200              MOVE SQLCODE          TO PV-DISP-SQLCODE            10020003
100300              PERFORM 9200-SQL-ABEND                              10030003
100400     END-EVALUATE.                                                10040003
100500                                                                  10050003
100600                                                                  10060003
100700 7210-DISPLAY-INFO.                                               10070003
100800     MOVE SPACES                     TO PV-CICS-MSG-AREA.         10080003
100900     STRING ' SUKCS574 - '           DELIMITED BY SIZE            10090003
101000            PV-PARAGRAPH-NAME        DELIMITED BY SIZE            10100003
101100                                        INTO PV-CICS-MSG-AREA.    10110003
101200     PERFORM 9997-CSSL.                                           10120003
101300     MOVE SPACES                     TO PV-CICS-MSG-AREA.         10130003
101400     MOVE SUT00028-UPC-NBR            TO PV-DISP-UPC.             10140003
101500     STRING ' SUKCS574 - '           DELIMITED BY SIZE            10150003
101600          PV-DB2-OPERATION-ATTEMPTED DELIMITED BY SIZE            10160003
101700          ' '                        DELIMITED BY SIZE            10170003
101800          PV-DISP-UPC                DELIMITED BY SIZE            10180003
101900                                        INTO PV-CICS-MSG-AREA.    10190003
102000     PERFORM 9997-CSSL.                                           10200003
102100                                                                  10210003
102200 7230-SELECT-DEPT.                                                10220003
102300     EXEC SQL                                                     10230003
102400         SELECT B.SKU_NBR                                         10240003
102500           ,    C.DEPT_NBR                                        10250003
102600           ,    C.MAJ_CL_NBR                                      10260003
102700           ,    C.HNG_FOLD_DESC                                   10270003
102800           ,    D.MDSE_LNE_CDE                                    10280003
102900           ,    E.BUS_AREA_ID                                     10290003
103000         INTO  :XLT00003-SKU-NBR                                  10300003
103100           ,   :XLT00004-DEPT-NBR                                 10310003
103200           ,   :XLT00004-MAJ-CL-NBR                               10320003
103300           ,   :XLT00004-HNG-FOLD-DESC                            10330003
103400           ,   :XLT00002-MDSE-LNE-CDE                             10340003
103500           ,   :XLT00001-BUS-AREA-ID                              10350003
103600         FROM  XLT_UPC  A                                         10360003
103700           ,   XLT_SKU  B                                         10370003
103800           ,   XLT_VND_STYL C                                     10380003
103900           ,   XLT_DEPT D                                         10390003
104000           ,   XLT_BUS_GP E                                       10400003
104100        WHERE  A.UPC_NBR             = :SUT00028-UPC-NBR          10410003
104200          AND  A.INTR_UPC_ID         = B.INTR_UPC_ID              10420003
104300          AND  B.STYL_ID             = C.STYL_ID                  10430003
104400          AND  C.DEPT_NBR            = D.DEPT_NBR                 10440003
104500          AND  D.BUS_GP_NBR          = E.BUS_GP_NBR               10450003
104600     END-EXEC.                                                    10460003
104700                                                                  10470003
104800                                                                  10480003
104900     EVALUATE TRUE                                                10490003
105000         WHEN SQLCODE = ZERO                                      10500003
105100              SET PS-DEPT-FOUND    TO TRUE                        10510003
105200         WHEN SQLCODE = +100                                      10520003
105300              SET PS-DEPT-NOT-FOUND    TO TRUE                    10530003
105400               MOVE ZEROES  TO  XLT00003-SKU-NBR                  10540003
105500                                XLT00004-DEPT-NBR                 10550003
105600                                XLT00004-MAJ-CL-NBR               10560003
105700                                XLT00001-BUS-AREA-ID              10570003
105800               MOVE SPACES  TO  XLT00004-HNG-FOLD-DESC            10580003
105900               MOVE 'H'     TO  XLT00002-MDSE-LNE-CDE             10590003
106000         WHEN SQLWARN0 NOT = SPACE                                10600003
106100         WHEN SQLCODE  NOT = +0                                   10610003
106200              MOVE '7230-SELECT-DEPT'                             10620003
106300                                   TO PV-PARAGRAPH-NAME           10630003
106400              MOVE 'READ 5 XLT TABL' TO PV-DB2-OPERATION-ATTEMPTED10640003
106500              MOVE SUT00028-UPC-NBR  TO PV-DISP-UPC               10650003
106600              MOVE PV-DISP-UPC     TO PV-FIELD-VALUE              10660003
106700              PERFORM 9200-SQL-ABEND                              10670003
106800     END-EVALUATE.                                                10680003
106900                                                                  10690003
107000 7250-RDM-COST-AND-RETAIL.                                        10700003
107100                                                                  10710003
107200     EXEC SQL                                                     10720003
107300         SELECT UNT_RTL_AMT                                       10730003
107400           INTO :CEPLIT-UNT-RTL-AMT                               10740003
107500           FROM TCEPLIT                                           10750003
107600          WHERE CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR              10760003
107700            AND PL_LNE_NBR       = :SUT00028-TRN-LNE-NBR          10770003
107800     END-EXEC                                                     10780003
107900                                                                  10790003
108000     EVALUATE TRUE                                                10800003
108100         WHEN SQLCODE = ZERO                                      10810003
108200             CONTINUE                                             10820003
108300         WHEN SQLCODE = +100                                      10830003
108400             MOVE 0                  TO CEPLIT-UNT-RTL-AMT        10840003
108500         WHEN SQLWARN0 NOT = SPACE                                10850003
108600         WHEN SQLCODE  NOT = +0                                   10860003
108700              MOVE '7250-RDM-COST-AND-RETAIL'                     10870003
108800                                     TO PV-PARAGRAPH-NAME         10880003
108900              MOVE 'SELECT FROM TCEPLIT '                         10890003
109000                                     TO PV-DB2-OPERATION-ATTEMPTED10900003
109100              MOVE SUT00028-TRN-NBR  TO PV-FIELD-VALUE-1          10910003
109200              MOVE SUT00028-TRN-LNE-NBR                           10920003
109300                                     TO PV-FIELD-VALUE-2          10930003
109400              PERFORM 9200-SQL-ABEND                              10940003
109500     END-EVALUATE.                                                10950003
109600                                                                  10960003
109700     EXEC SQL                                                     10970003
109800         SELECT DISTINCT                                          10980003
109900                INTR_UPC_ID                                       10990003
110000           INTO :XLV00002-INTR-UPC-ID                             11000003
110100           FROM XLT_UPC                                           11010003
110200          WHERE UPC_NBR  = :SUT00028-UPC-NBR                      11020003
110300     END-EXEC                                                     11030003
110400                                                                  11040003
110500     EVALUATE TRUE                                                11050003
110600         WHEN SQLCODE = ZERO                                      11060003
110700             SET PS-UPC-FOUND        TO TRUE                      11070003
110800         WHEN SQLCODE = +100                                      11080003
110900             SET PS-NOT-UPC-FOUND    TO TRUE                      11090003
111000             MOVE 0                  TO XLV00002-UNT-COST-AMT     11100003
111100         WHEN SQLWARN0 NOT = SPACE                                11110003
111200         WHEN SQLCODE  NOT = +0                                   11120003
111300              MOVE '7250-RDM-COST-AND-RETAIL'                     11130003
111400                                     TO PV-PARAGRAPH-NAME         11140003
111500              MOVE 'SELECT FROM XLT_UPC '                         11150003
111600                                     TO PV-DB2-OPERATION-ATTEMPTED11160003
111700              MOVE SUT00028-UPC-NBR  TO PV-FIELD-VALUE            11170003
111800              PERFORM 9200-SQL-ABEND                              11180003
111900     END-EVALUATE.                                                11190003
112000                                                                  11200003
112100     IF PS-UPC-FOUND                                              11210003
112200         PERFORM 7252-RDM-COST-AMT                                11220003
112300     END-IF.                                                      11230003
112400                                                                  11240003
112500 7252-RDM-COST-AMT.                                               11250003
112600                                                                  11260003
112700     EXEC SQL                                                     11270003
112800         SELECT  UNT_COST_AMT                                     11280003
112900         INTO   :XLV00002-UNT-COST-AMT                            11290003
113000         FROM                                                     11300003
113100         XLV_SKU_STR                                              11310003
113200         WHERE STR_NBR       = 0                                  11320003
113300           AND INTR_UPC_ID   = :XLV00002-INTR-UPC-ID              11330003
113400          WITH UR                                                 11340009
113500     END-EXEC.                                                    11350003
113600                                                                  11360003
113700     EVALUATE TRUE                                                11370003
113800         WHEN SQLCODE = ZERO                                      11380003
113900             CONTINUE                                             11390003
114000         WHEN SQLCODE = +100                                      11400003
114100             SET PS-NOT-UPC-FOUND TO TRUE                         11410003
114200             MOVE 0                  TO XLV00002-UNT-COST-AMT     11420003
114300         WHEN SQLWARN0 NOT = SPACE                                11430003
114400         WHEN SQLCODE  NOT = +0                                   11440003
114500              MOVE '7252-COST-AND-RETAIL'                         11450003
114600                                     TO PV-PARAGRAPH-NAME         11460003
114700              MOVE 'SELECT FROM XLV_SKU_STR'                      11470003
114800                                     TO PV-DB2-OPERATION-ATTEMPTED11480003
114900              MOVE XLV00002-INTR-UPC-ID TO PV-FIELD-VALUE         11490003
115000              PERFORM 9200-SQL-ABEND                              11500003
115100     END-EVALUATE.                                                11510003
115200                                                                  11520003
115300 7260-SELECT-TPURITM.                                             11530003
115400     EXEC SQL                                                     11540003
115500         SELECT AD_EVNT_DTE                                       11550003
115600         ,      UNT_RTL_PR_AMT                                    11560003
115700         ,      UNT_COST_AMT                                      11570003
115800         INTO  :PV-AD-EVNT-DTE                                    11580003
115900         ,     :PURITM-UNT-RTL-PR-AMT                             11590003
116000         ,     :PURITM-UNT-COST-AMT                               11600003
116100         FROM  TPURITM                                            11610003
116200         WHERE PO_NBR              = :SUT00028-TRN-NBR            11620003
116300           AND APP_PO_LNE_NBR      = :SUT00028-TRN-LNE-NBR        11630003
116400           AND VER_STATUS_CDE      = 'A'                          11640003
116500     END-EXEC.                                                    11650003
116600                                                                  11660003
116700                                                                  11670003
116800     EVALUATE TRUE                                                11680003
116900         WHEN SQLCODE = ZERO                                      11690003
117000              CONTINUE                                            11700003
117100         WHEN SQLCODE = +100                                      11710003
117200              MOVE '0001-01-01' TO PV-AD-EVNT-DTE                 11720003
117300              MOVE 0   TO PURITM-UNT-RTL-PR-AMT                   11730003
117400                          PURITM-UNT-COST-AMT                     11740003
117500         WHEN SQLWARN0 NOT = SPACE                                11750003
117600         WHEN SQLCODE  NOT = +0                                   11760003
117700              MOVE '7260-SELECT-TPURITM'                          11770003
117800                                   TO PV-PARAGRAPH-NAME           11780003
117900              MOVE 'READ TPURITM ' TO PV-DB2-OPERATION-ATTEMPTED  11790003
118000              MOVE SUT00028-TRN-NBR TO PV-ITEM-NMBR               11800003
118100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              11810003
118200              PERFORM 9200-SQL-ABEND                              11820003
118300     END-EVALUATE.                                                11830003
118400                                                                  11840003
118500 7270-PRC-MSG-CDE.                                                11850003
118600                                                                  11860003
118700     EXEC SQL                                                     11870003
118800         SELECT DISTINCT(PRC_MSG_CDE)                             11880003
118900         INTO  :SUT00094-PRC-MSG-CDE                              11890003
119000         FROM  SUT_PRC_MSG_CNTL A                                 11900003
119100         WHERE SHIPT_UNT_ID        = :SUCRDV-SHIPT-UNT-ID         11910003
119200         FETCH FIRST 1 ROW ONLY                                   11920003
119300     END-EXEC.                                                    11930003
119400                                                                  11940003
119500                                                                  11950003
119600     EVALUATE TRUE                                                11960003
119700         WHEN SQLCODE = ZERO                                      11970003
119800         WHEN SQLCODE = -811                                      11980003
119900              CONTINUE                                            11990003
120000         WHEN SQLCODE = +100                                      12000003
120100              MOVE SPACES       TO SUT00094-PRC-MSG-CDE           12010003
120200         WHEN SQLWARN0 NOT = SPACE                                12020003
120300         WHEN SQLCODE  NOT = +0                                   12030003
120400              MOVE '7270-PRC-MSG-CDE'                             12040003
120500                                   TO PV-PARAGRAPH-NAME           12050003
120600              MOVE 'READ PROCESS MSG'                             12060003
120700                                     TO PV-DB2-OPERATION-ATTEMPTED12070003
120800              MOVE SUCRDV-SHIPT-UNT-ID                            12080003
120900                                    TO PV-SHIPT-UNT-ID            12090003
121000              MOVE PV-SHIPT-UNT-ID TO PV-FIELD-VALUE              12100003
121100              PERFORM 9200-SQL-ABEND                              12110003
121200     END-EVALUATE.                                                12120003
121300                                                                  12130003
121400***************************************************************** 12140027
121500* STYLES WITH '0' BRND_ID ARE ACTUALLY NO BRAND ASSIGNED AND    * 12150027
121600* ARE GIVEN A DESCRIPTION OF 'UNKNOWN' ON THE XLT_BRND TABLE    * 12160027
121700* THEY WILL BE FOUND IN A SQLCODE OF 0 CONDITION                * 12170027
121800***************************************************************** 12180027
121900 7280-SELECT-BRAND-ID.                                            12190014
122000* CLP 07/07/2015 START                                            12200014
122100                                                                  12210003
122200     EXEC SQL                                                     12220014
122300        SELECT  B.BRND_ID                                         12230014
122400         INTO   :XLT00043-BRND-ID                                 12240024
122500          FROM  XLT_SKU      A                                    12250014
122600             ,  XLT_VND_STYL B                                    12260014
122700             ,  XLT_BRND     C                                    12270014
122800         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            12280014
122900           AND  A.STYL_ID         =  B.STYL_ID                    12290014
123000           AND  B.BRND_ID         =  C.BRND_ID                    12300014
123100     END-EXEC.                                                    12310014
123200                                                                  12320003
123300     EVALUATE TRUE                                                12330003
123400         WHEN SQLCODE = ZERO                                      12340003
123500         WHEN SQLCODE = -811                                      12350003
123600              CONTINUE                                            12360003
123700         WHEN SQLCODE = +100                                      12370003
123800              MOVE 0          TO XLT00043-BRND-ID                 12380027
123900* CLP 07/07/2015 END                                              12390014
124000         WHEN SQLWARN0 NOT = SPACE                                12400003
124100         WHEN SQLCODE  NOT = +0                                   12410003
124200              MOVE '7280-SELECT-BRAND-ID'                         12420014
124300                                   TO PV-PARAGRAPH-NAME           12430003
124400              MOVE 'READ XLT00043' TO PV-DB2-OPERATION-ATTEMPTED  12440014
124500              MOVE XLT00003-SKU-NBR TO PV-SKU-NBR                 12450003
124600              MOVE PV-SKU-NBR      TO PV-FIELD-VALUE              12460003
124700              PERFORM 9200-SQL-ABEND                              12470003
124800     END-EVALUATE.                                                12480003
124900                                                                  12490003
125000 7300-OPEN-AD-DATE-CURSOR.                                        12500003
125100                                                                  12510003
125200     EXEC SQL                                                     12520003
125300         OPEN AD-DATE-CSR                                         12530003
125400     END-EXEC.                                                    12540003
125500                                                                  12550003
125600     EVALUATE TRUE                                                12560003
125700         WHEN SQLCODE = ZEROS                                     12570003
125800              SET PS-NOT-EOF-DATE-CSR TO TRUE                     12580003
125900                                                                  12590003
126000         WHEN OTHER                                               12600003
126100              MOVE '7300-OPEN-AD-DATE-CURSOR   '                  12610003
126200                                   TO PV-PARAGRAPH-NAME           12620003
126300              MOVE 'OPEN AD-DATE-CSR'                             12630003
126400                                   TO PV-DB2-OPERATION-ATTEMPTED  12640003
126500              MOVE SQLCODE         TO PV-DISP-SQLCODE             12650003
126600              PERFORM 9200-SQL-ABEND                              12660003
126700     END-EVALUATE.                                                12670003
126800                                                                  12680003
126900                                                                  12690003
127000 7400-FETCH-AD-DATE.                                              12700003
127100     EXEC SQL                                                     12710003
127200         FETCH AD-DATE-CSR                                        12720003
127300         INTO                                                     12730003
127400             :SUT00095-BUS-AREA-ID                                12740003
127500          ,  :SUT00095-DEPT-NBR                                   12750003
127600          ,  :SUT00095-MAJ-CL-NBR                                 12760003
127700          ,  :SUT00095-AD-DTE                                     12770003
127800     END-EXEC.                                                    12780003
127900                                                                  12790003
128000     EVALUATE TRUE                                                12800003
128100         WHEN SQLCODE = ZERO                                      12810003
128200              CONTINUE                                            12820003
128300         WHEN SQLCODE = +100                                      12830003
128400              SET PS-EOF-DATE-CSR TO TRUE                         12840003
128500         WHEN SQLWARN0 NOT = SPACE                                12850003
128600         WHEN SQLCODE  NOT = +0                                   12860003
128700              MOVE '7400-FETCH-AD-DATE'                           12870003
128800                                   TO PV-PARAGRAPH-NAME           12880003
128900              MOVE 'FETCH AD-DATE-CSR'                            12890003
129000                                   TO PV-DB2-OPERATION-ATTEMPTED  12900003
129100              MOVE SQLCODE         TO PV-DISP-SQLCODE             12910003
129200              PERFORM 9200-SQL-ABEND                              12920003
129300     END-EVALUATE.                                                12930003
129400                                                                  12940003
129500 7500-CLOSE-AD-DATE.                                              12950003
129600                                                                  12960003
129700     EXEC SQL                                                     12970003
129800         CLOSE AD-DATE-CSR                                        12980003
129900     END-EXEC.                                                    12990003
130000                                                                  13000003
130100     EVALUATE TRUE                                                13010003
130200         WHEN SQLCODE = ZEROS                                     13020003
130300              CONTINUE                                            13030003
130400                                                                  13040003
130500         WHEN OTHER                                               13050003
130600              MOVE '7500-CLOSE-AD-DATE         '                  13060003
130700                                   TO PV-PARAGRAPH-NAME           13070003
130800              MOVE 'CLOSE AD-DATE-CSR'                            13080003
130900                                   TO PV-DB2-OPERATION-ATTEMPTED  13090003
131000              MOVE SQLCODE         TO PV-DISP-SQLCODE             13100003
131100              PERFORM 9200-SQL-ABEND                              13110003
131200     END-EVALUATE.                                                13120003
131300                                                                  13130003
131400                                                                  13140003
131500                                                                  13150003
131600 7900-INSERT-SUT00095.                                            13160003
131700                                                                  13170003
131800     EXEC SQL                                                     13180003
131900          INSERT INTO SUT_TRIP_DTL_SUM                            13190003
132000                 (TRIP_OCRNC_ID                                   13200003
132100               ,  SHIPT_UNT_ID                                    13210003
132200               ,  SKU_NBR                                         13220003
132300               ,  BUS_AREA_ID                                     13230003
132400               ,  DEPT_NBR                                        13240003
132500               ,  MAJ_CL_NBR                                      13250003
132600               ,  MDSE_LNE_CDE                                    13260003
132700               ,  HNG_FOLD_SEQ_NBR                                13270003
132800*CLP 07/07/2015 START                                             13280014
132900               ,  BRND_ID                                         13290014
133000               ,  EAS_TAG_IND                                     13300003
133100               ,  PRC_MSG_CDE                                     13310003
133200               ,  DIVERT_TMST                                     13320003
133300               ,  UNT_QTY                                         13330003
133400               ,  RTL_DOL_AMT                                     13340003
133500               ,  AD_DTE                                          13350003
133600               ,  COST_DOL_AMT)                                   13360003
133700          VALUES (                                                13370003
133800                 :SUT00095-TRIP-OCRNC-ID                          13380003
133900              ,  :SUT00095-SHIPT-UNT-ID                           13390003
134000              ,  :SUT00095-SKU-NBR                                13400003
134100              ,  :SUT00095-BUS-AREA-ID                            13410003
134200              ,  :SUT00095-DEPT-NBR                               13420003
134300              ,  :SUT00095-MAJ-CL-NBR                             13430003
134400              ,  :SUT00095-MDSE-LNE-CDE                           13440003
134500              ,  :SUT00095-HNG-FOLD-SEQ-NBR                       13450003
134600              ,  :SUT00095-BRND-ID                                13460014
134700*CLP 07/07/2015 END                                               13470014
134800              ,  :SUT00095-EAS-TAG-IND                            13480003
134900              ,  :SUT00095-PRC-MSG-CDE                            13490003
135000              ,  :SUT00095-DIVERT-TMST                            13500003
135100              ,  :SUT00095-UNT-QTY                                13510003
135200              ,  :SUT00095-RTL-DOL-AMT                            13520003
135300              ,  :SUT00095-AD-DTE                                 13530003
135400              ,  :SUT00095-COST-DOL-AMT)                          13540003
135500     END-EXEC.                                                    13550003
135600                                                                  13560003
135700     EVALUATE TRUE                                                13570003
135800         WHEN SQLCODE = +0                                        13580003
135900              CONTINUE                                            13590003
136000                                                                  13600003
136100         WHEN SQLCODE = -803                                      13610003
136200              PERFORM 7930-PROCESS-UPDATE                         13620003
136300                                                                  13630003
136400         WHEN SQLWARN0 NOT = SPACES                               13640003
136500         WHEN SQLCODE < +0                                        13650003
136600         WHEN SQLCODE > +0                                        13660003
136700             MOVE '7900-INSERT-SUT00095          '                13670003
136800                                  TO PV-PARAGRAPH-NAME            13680003
136900             MOVE 'INSERT SUT_TRIP_DTL_SUM'                       13690003
137000                               TO PV-DB2-OPERATION-ATTEMPTED      13700003
137100             MOVE SQLCODE      TO PV-DISP-SQLCODE                 13710003
137200             PERFORM 9200-SQL-ABEND                               13720003
137300     END-EVALUATE.                                                13730003
137400                                                                  13740003
137500 7930-PROCESS-UPDATE.                                             13750003
137600     PERFORM 7950-SELECT-DETAIL-SUM.                              13760003
137700     ADD PV-UNT-QTY       TO SUT00095-UNT-QTY.                    13770003
137800     ADD PV-RTL-DOL-AMT   TO SUT00095-RTL-DOL-AMT.                13780003
137900     ADD PV-COST-DOL-AMT  TO SUT00095-COST-DOL-AMT.               13790003
138000     PERFORM 7970-UPDATE-DETAIL-SUM.                              13800003
138100                                                                  13810003
138200 7950-SELECT-DETAIL-SUM.                                          13820003
138300                                                                  13830003
138400     EXEC SQL                                                     13840003
138500         SELECT UNT_QTY                                           13850003
138600             ,  RTL_DOL_AMT                                       13860003
138700             ,  COST_DOL_AMT                                      13870003
138800         INTO  :PV-UNT-QTY                                        13880003
138900            ,  :PV-RTL-DOL-AMT                                    13890003
139000            ,  :PV-COST-DOL-AMT                                   13900003
139100         FROM SUT_TRIP_DTL_SUM                                    13910003
139200        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    13920003
139300         AND   SHIPT_UNT_ID          = :SUT00095-SHIPT-UNT-ID     13930003
139400         AND   SKU_NBR               = :SUT00095-SKU-NBR          13940003
139500     END-EXEC.                                                    13950003
139600                                                                  13960003
139700     EVALUATE TRUE                                                13970003
139800         WHEN SQLCODE = ZERO                                      13980003
139900              CONTINUE                                            13990003
140000         WHEN SQLWARN0 NOT = SPACE                                14000003
140100         WHEN SQLCODE  NOT = +0                                   14010003
140200              MOVE '7950-SELECT-DETAIL-SUM '                      14020003
140300                                   TO PV-PARAGRAPH-NAME           14030003
140400              MOVE 'SELECT SUT00095' TO PV-DB2-OPERATION-ATTEMPTED14040003
140500              MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         14050003
140600              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              14060003
140700              MOVE SUT00095-SHIPT-UNT-ID  TO PV-ITEM-NMBR         14070003
140800              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            14080003
140900              MOVE SUT00095-SKU-NBR       TO PV-ITEM-NMBR         14090003
141000              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-2            14100003
141100              PERFORM 9200-SQL-ABEND                              14110003
141200     END-EVALUATE.                                                14120003
141300                                                                  14130003
141400                                                                  14140003
141500 7970-UPDATE-DETAIL-SUM.                                          14150003
141600                                                                  14160003
141700     EXEC SQL                                                     14170003
141800          UPDATE SUT_TRIP_DTL_SUM                                 14180003
141900            SET UNT_QTY            = :SUT00095-UNT-QTY            14190003
142000             ,  RTL_DOL_AMT        = :SUT00095-RTL-DOL-AMT        14200003
142100             ,  COST_DOL_AMT       = :SUT00095-COST-DOL-AMT       14210003
142200        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    14220003
142300         AND   SHIPT_UNT_ID          = :SUT00095-SHIPT-UNT-ID     14230003
142400         AND   SKU_NBR               = :SUT00095-SKU-NBR          14240003
142500     END-EXEC.                                                    14250003
142600                                                                  14260003
142700     EVALUATE TRUE                                                14270003
142800         WHEN SQLCODE = ZERO                                      14280003
142900              CONTINUE                                            14290003
143000         WHEN SQLWARN0 NOT = SPACE                                14300003
143100         WHEN SQLCODE  NOT = +0                                   14310003
143200              MOVE '7970-UPDATE-DETAIL-SUM '                      14320003
143300                                   TO PV-PARAGRAPH-NAME           14330003
143400              MOVE 'UPDATE SUT00095' TO PV-DB2-OPERATION-ATTEMPTED14340003
143500              MOVE SUT00095-TRIP-OCRNC-ID TO PV-ITEM-NMBR         14350003
143600              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              14360003
143700              MOVE SUT00095-SHIPT-UNT-ID  TO PV-ITEM-NMBR         14370003
143800              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            14380003
143900              MOVE SUT00095-SKU-NBR       TO PV-ITEM-NMBR         14390003
144000              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-2            14400003
144100              PERFORM 9200-SQL-ABEND                              14410003
144200     END-EVALUATE.                                                14420003
144300                                                                  14430003
144400**************************************************************    14440010
144500* INSERT ROW INTO SUT_TRIP_WRKR_AUD TO SHOW WHO REQUESTED A  *    14450010
144600* TRAILER SUMMARIZATION                                      *    14460010
144700* 7/25/13                                                    *    14470010
144800**************************************************************    14480010
144900 7990-INSERT-WRKR-AUD.                                            14490010
145000                                                                  14500010
145100     MOVE  PC047-OTBND-TRIP-ID  TO  SUT00006-OTBND-TRIP-ID.       14510012
145200     MOVE  PV-USERID            TO  SUT00006-USR-ID.              14520012
145300                                                                  14530012
145400     EXEC SQL                                                     14540012
145500          INSERT INTO SUT_TRIP_WRKR_AUD                           14550012
145600                 (                                                14560012
145700                   OTBND_TRIP_ID                                  14570012
145800                  ,USR_ID                                         14580012
145900                  ,CRE_TMST                                       14590012
146000                  ,CRE_BY_PGM_NM                                  14600012
146100                 )                                                14610010
146200          VALUES (                                                14620010
146300                   :SUT00006-OTBND-TRIP-ID                        14630010
146400                  ,:SUT00006-USR-ID                               14640010
146500                  , CURRENT TIMESTAMP                             14650010
146600                  ,'SUKCS574'                                     14660010
146700                 )                                                14670010
146800     END-EXEC.                                                    14680010
146900                                                                  14690010
147000     EVALUATE TRUE                                                14700010
147100         WHEN SQLCODE = +0                                        14710010
147200              CONTINUE                                            14720010
147300                                                                  14730010
147400                                                                  14740010
147500         WHEN SQLWARN0 NOT = SPACES                               14750010
147600         WHEN SQLCODE < +0                                        14760010
147700         WHEN SQLCODE > +0                                        14770010
147800             MOVE '7990-INSERT-WRKR-AUD          '                14780010
147900                                  TO PV-PARAGRAPH-NAME            14790010
148000             MOVE 'INSERT SUT_TRIP_WRKR_AUD'                      14800010
148100                               TO PV-DB2-OPERATION-ATTEMPTED      14810010
148200             MOVE SQLCODE      TO PV-DISP-SQLCODE                 14820010
148300             PERFORM 9200-SQL-ABEND                               14830010
148400     END-EVALUATE.                                                14840010
148500                                                                  14850010
148600                                                                  14860010
148700 8000-OPEN-SKU-QTY-CLASS-CURSOR.                                  14870003
148800                                                                  14880003
148900     EXEC SQL                                                     14890003
149000         OPEN UNT-DOL-CLASS-CSR                                   14900003
149100     END-EXEC.                                                    14910003
149200                                                                  14920003
149300     EVALUATE TRUE                                                14930003
149400         WHEN SQLCODE = ZEROS                                     14940003
149500              SET PS-NOT-EOF-UNT-DOL-CLASS-CSR TO TRUE            14950003
149600                                                                  14960003
149700         WHEN OTHER                                               14970003
149800              MOVE '8000-OPEN-SKU-QTY-CLASS-CURSOR'               14980003
149900                                   TO PV-PARAGRAPH-NAME           14990003
150000              MOVE 'OPEN UNT-DOL-CLASS-CSR'                       15000003
150100                                   TO PV-DB2-OPERATION-ATTEMPTED  15010003
150200              MOVE SQLCODE         TO PV-DISP-SQLCODE             15020003
150300              PERFORM 9200-SQL-ABEND                              15030003
150400     END-EVALUATE.                                                15040003
150500                                                                  15050003
150600 8030-FETCH-SKU-QTY-CLASS-CSR.                                    15060003
150700     EXEC SQL                                                     15070003
150800         FETCH UNT-DOL-CLASS-CSR                                  15080003
150900         INTO  :SUT00095-BUS-AREA-ID                              15090003
151000            ,  :SUT00095-DEPT-NBR                                 15100003
151100            ,  :SUT00095-MAJ-CL-NBR                               15110003
151200            ,  :PV-UNIT-QTY-SUM                                   15120003
151300            ,  :PV-RETAIL-SUM                                     15130003
151400            ,  :PV-COST-SUM                                       15140003
151500     END-EXEC.                                                    15150003
151600                                                                  15160003
151700     EVALUATE TRUE                                                15170003
151800         WHEN SQLCODE = ZERO                                      15180003
151900              CONTINUE                                            15190003
152000         WHEN SQLCODE = +100                                      15200003
152100              SET PS-EOF-UNT-DOL-CLASS-CSR TO TRUE                15210003
152200         WHEN SQLWARN0 NOT = SPACE                                15220003
152300         WHEN SQLCODE  NOT = +0                                   15230003
152400              MOVE '8030-FETCH-SKU-QTY-CLASS-CSR'                 15240003
152500                                   TO PV-PARAGRAPH-NAME           15250003
152600              MOVE 'FETCH UNT-DOL-CLASS-CSR'                      15260003
152700                                   TO PV-DB2-OPERATION-ATTEMPTED  15270003
152800              MOVE SQLCODE         TO PV-DISP-SQLCODE             15280003
152900              PERFORM 9200-SQL-ABEND                              15290003
153000     END-EVALUATE.                                                15300003
153100                                                                  15310003
153200 8060-CLOSE-SKU-QTY-CLASS-CSR.                                    15320003
153300                                                                  15330003
153400     EXEC SQL                                                     15340003
153500         CLOSE UNT-DOL-CLASS-CSR                                  15350003
153600     END-EXEC.                                                    15360003
153700                                                                  15370003
153800     EVALUATE TRUE                                                15380003
153900         WHEN SQLCODE = ZEROS                                     15390003
154000              CONTINUE                                            15400003
154100                                                                  15410003
154200         WHEN OTHER                                               15420003
154300              MOVE '8060-CLOSE-SKU-QTY-CLASS-CURSOR'              15430003
154400                                   TO PV-PARAGRAPH-NAME           15440003
154500              MOVE 'CLOSE UNT-DOL-CLASS-CSR'                      15450003
154600                                   TO PV-DB2-OPERATION-ATTEMPTED  15460003
154700              MOVE SQLCODE         TO PV-DISP-SQLCODE             15470003
154800              PERFORM 9200-SQL-ABEND                              15480003
154900     END-EVALUATE.                                                15490003
155000                                                                  15500003
155100 8101-OPEN-SKU-QTY-BRND-CURSOR.                                   15510014
155200                                                                  15520014
155300     EXEC SQL                                                     15530014
155400         OPEN UNT-DOL-BRND-CSR                                    15540014
155500     END-EXEC.                                                    15550014
155600                                                                  15560014
155700     EVALUATE TRUE                                                15570014
155800         WHEN SQLCODE = ZEROS                                     15580014
155900              SET PS-NOT-EOF-UNT-DOL-MDSE-CSR TO TRUE             15590014
156000                                                                  15600014
156100         WHEN OTHER                                               15610014
156200              MOVE '8101-OPEN-SKU-QTY-BRND-CURSOR'                15620014
156300                                   TO PV-PARAGRAPH-NAME           15630014
156400              MOVE 'OPEN UNT-DOL-BRND-CSR'                        15640014
156500                                   TO PV-DB2-OPERATION-ATTEMPTED  15650014
156600              MOVE SQLCODE         TO PV-DISP-SQLCODE             15660014
156700              PERFORM 9200-SQL-ABEND                              15670014
156800     END-EVALUATE.                                                15680014
156900                                                                  15690014
157000*CLP 07/07/2015 START                                             15700014
157100 8131-FETCH-SKU-QTY-BRND-CSR.                                     15710014
157200     EXEC SQL                                                     15720014
157300         FETCH UNT-DOL-BRND-CSR                                   15730022
157400         INTO  :SUT00095-BUS-AREA-ID                              15740014
157500            ,  :SUT00095-BRND-ID                                  15750014
157600            ,  :PV-UNIT-QTY-SUM                                   15760014
157700            ,  :PV-RETAIL-SUM                                     15770014
157800            ,  :PV-COST-SUM                                       15780014
157900     END-EXEC.                                                    15790014
158000                                                                  15800014
158100     EVALUATE TRUE                                                15810014
158200         WHEN SQLCODE = ZERO                                      15820014
158300              CONTINUE                                            15830014
158400         WHEN SQLCODE = +100                                      15840014
158500              SET PS-EOF-UNT-DOL-MDSE-CSR TO TRUE                 15850014
158600         WHEN SQLWARN0 NOT = SPACE                                15860014
158700         WHEN SQLCODE  NOT = +0                                   15870014
158800              MOVE '8131-FETCH-SKU-QTY-BRND-CSR'                  15880014
158900                                   TO PV-PARAGRAPH-NAME           15890014
159000              MOVE 'FETCH UNT-DOL-BRND-CSR'                       15900014
159100                                   TO PV-DB2-OPERATION-ATTEMPTED  15910014
159200              MOVE SQLCODE         TO PV-DISP-SQLCODE             15920014
159300              PERFORM 9200-SQL-ABEND                              15930014
159400     END-EVALUATE.                                                15940014
159500*CLP 07/07/2015 END                                               15950014
159600                                                                  15960014
159700*CLP 07/07/2015 START                                             15970018
159800 8161-CLOSE-SKU-QTY-BRND-CSR.                                     15980018
159900                                                                  15990018
160000     EXEC SQL                                                     16000018
160100         CLOSE UNT-DOL-BRND-CSR                                   16010018
160200     END-EXEC.                                                    16020018
160300                                                                  16030018
160400     EVALUATE TRUE                                                16040018
160500         WHEN SQLCODE = ZEROS                                     16050018
160600              CONTINUE                                            16060018
160700                                                                  16070018
160800         WHEN OTHER                                               16080018
160900              MOVE '8161-CLOSE-SKU-QTY-BRND-CURSOR'               16090018
161000                                   TO PV-PARAGRAPH-NAME           16100018
161100              MOVE 'CLOSE UNT-DOL-BRND-CSR'                       16110018
161200                                   TO PV-DB2-OPERATION-ATTEMPTED  16120018
161300              MOVE SQLCODE         TO PV-DISP-SQLCODE             16130018
161400              PERFORM 9200-SQL-ABEND                              16140018
161500     END-EVALUATE.                                                16150018
161600*CLP 07/07/2015 END                                               16160018
161700                                                                  16170018
161800 8200-SELECT-SKU-CNT-CLASS.                                       16180003
161900                                                                  16190003
162000                                                                  16200003
162100     EXEC SQL                                                     16210003
162200         SELECT COUNT(DISTINCT SKU_NBR)                           16220003
162300         INTO  :PV-SKU-COUNT                                      16230003
162400         FROM SUT_TRIP_DTL_SUM                                    16240003
162500        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          16250003
162600         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      16260003
162700         AND   DEPT_NBR              = :SUT00095-DEPT-NBR         16270003
162800         AND   MAJ_CL_NBR            = :SUT00095-MAJ-CL-NBR       16280003
162900        WITH UR                                                   16290003
163000     END-EXEC.                                                    16300003
163100                                                                  16310003
163200     EVALUATE TRUE                                                16320003
163300         WHEN SQLCODE = ZERO                                      16330003
163400              CONTINUE                                            16340003
163500         WHEN SQLWARN0 NOT = SPACE                                16350003
163600         WHEN SQLCODE  NOT = +0                                   16360003
163700              MOVE '8200-SELECT-SKU-CNT-CLASS'                    16370003
163800                                   TO PV-PARAGRAPH-NAME           16380003
163900              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  16390003
164000              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               16400003
164100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              16410003
164200              PERFORM 9200-SQL-ABEND                              16420003
164300     END-EVALUATE.                                                16430003
164400                                                                  16440003
164500 8250-SELECT-CARTON-CNT-CLASS.                                    16450003
164600                                                                  16460003
164700     EXEC SQL                                                     16470003
164800         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      16480003
164900         INTO  :PV-CARTON-COUNT                                   16490003
165000         FROM SUT_TRIP_DTL_SUM                                    16500003
165100        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          16510003
165200         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      16520003
165300         AND   DEPT_NBR              = :SUT00095-DEPT-NBR         16530003
165400         AND   MAJ_CL_NBR            = :SUT00095-MAJ-CL-NBR       16540003
165500        WITH UR                                                   16550003
165600     END-EXEC.                                                    16560003
165700                                                                  16570003
165800     EVALUATE TRUE                                                16580003
165900         WHEN SQLCODE = ZERO                                      16590003
166000              CONTINUE                                            16600003
166100         WHEN SQLWARN0 NOT = SPACE                                16610003
166200         WHEN SQLCODE  NOT = +0                                   16620003
166300              MOVE '8250-SELECT-CARTON-CNT-CLASS'                 16630003
166400                                   TO PV-PARAGRAPH-NAME           16640003
166500              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  16650003
166600              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               16660003
166700              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              16670003
166800              PERFORM 9200-SQL-ABEND                              16680003
166900     END-EVALUATE.                                                16690003
167000                                                                  16700003
167100 8300-SELECT-SKU-CNT-DEPT.                                        16710003
167200                                                                  16720003
167300                                                                  16730003
167400     EXEC SQL                                                     16740003
167500         SELECT COUNT(DISTINCT SKU_NBR)                           16750003
167600         INTO  :PV-SKU-COUNT                                      16760003
167700         FROM SUT_TRIP_DTL_SUM                                    16770003
167800        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          16780003
167900         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      16790003
168000         AND   DEPT_NBR              = :SUT00095-DEPT-NBR         16800003
168100        WITH UR                                                   16810003
168200     END-EXEC.                                                    16820003
168300                                                                  16830003
168400                                                                  16840003
168500     EVALUATE TRUE                                                16850003
168600         WHEN SQLCODE = ZERO                                      16860003
168700              CONTINUE                                            16870003
168800         WHEN SQLWARN0 NOT = SPACE                                16880003
168900         WHEN SQLCODE  NOT = +0                                   16890003
169000              MOVE '8300-SELECT-SKU-CNT-DEPT'                     16900003
169100                                   TO PV-PARAGRAPH-NAME           16910003
169200              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  16920003
169300              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               16930003
169400              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              16940003
169500              PERFORM 9200-SQL-ABEND                              16950003
169600     END-EVALUATE.                                                16960003
169700                                                                  16970003
169800 8350-SELECT-CARTON-CNT-DEPT.                                     16980003
169900                                                                  16990003
170000     EXEC SQL                                                     17000003
170100         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      17010003
170200         INTO  :PV-CARTON-COUNT                                   17020003
170300         FROM SUT_TRIP_DTL_SUM                                    17030003
170400        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          17040003
170500         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       17050003
170600         AND   DEPT_NBR              = :PV-SAVE-DEPT-NBR          17060003
170700        WITH UR                                                   17070003
170800     END-EXEC.                                                    17080003
170900                                                                  17090003
171000     EVALUATE TRUE                                                17100003
171100         WHEN SQLCODE = ZERO                                      17110003
171200              CONTINUE                                            17120003
171300         WHEN SQLWARN0 NOT = SPACE                                17130003
171400         WHEN SQLCODE  NOT = +0                                   17140003
171500              MOVE '8350-SELECT-CARTON-CNT-DEPT'                  17150003
171600                                   TO PV-PARAGRAPH-NAME           17160003
171700              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  17170003
171800              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               17180003
171900              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              17190003
172000              PERFORM 9200-SQL-ABEND                              17200003
172100     END-EVALUATE.                                                17210003
172200                                                                  17220003
172300*CLP 07/07/2015 START                                             17230014
172400 8401-SELECT-SKU-CNT-BRND.                                        17240018
172500                                                                  17250014
172600     EXEC SQL                                                     17260014
172700         SELECT COUNT(DISTINCT SKU_NBR)                           17270014
172800         INTO  :PV-SKU-COUNT                                      17280014
172900         FROM SUT_TRIP_DTL_SUM                                    17290014
173000        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          17300014
173100         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       17310014
173200         AND   BRND_ID               = :PV-SAVE-BRND-ID           17320014
173300        WITH UR                                                   17330014
173400     END-EXEC.                                                    17340014
173500                                                                  17350014
173600     EVALUATE TRUE                                                17360014
173700         WHEN SQLCODE = ZERO                                      17370014
173800              CONTINUE                                            17380014
173900         WHEN SQLWARN0 NOT = SPACE                                17390014
174000         WHEN SQLCODE  NOT = +0                                   17400014
174100              MOVE '8401-SELECT-SKU-CNT-BRND'                     17410014
174200                                   TO PV-PARAGRAPH-NAME           17420014
174300              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  17430014
174400              MOVE PV-SAVE-BUS-AREA-ID                            17440014
174500                                   TO  PV-ITEM-NMBR               17450014
174600              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              17460014
174700              MOVE PV-SAVE-BRND-ID                                17470014
174800                                   TO  PV-ITEM-NMBR               17480014
174900              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            17490014
175000              PERFORM 9200-SQL-ABEND                              17500014
175100     END-EVALUATE.                                                17510014
175200*CLP 07/07/2015 END                                               17520014
175300                                                                  17530014
175400*CLP 07/07/2015 START                                             17540014
175500 8451-SELECT-CARTON-CNT-BRND.                                     17550014
175600                                                                  17560014
175700     EXEC SQL                                                     17570014
175800         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      17580014
175900         INTO  :PV-CARTON-COUNT                                   17590014
176000         FROM SUT_TRIP_DTL_SUM                                    17600014
176100        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          17610014
176200         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       17620014
176300         AND   BRND_ID               = :PV-SAVE-BRND-ID           17630014
176400        WITH UR                                                   17640014
176500     END-EXEC.                                                    17650014
176600                                                                  17660014
176700     EVALUATE TRUE                                                17670014
176800         WHEN SQLCODE = ZERO                                      17680014
176900              CONTINUE                                            17690014
177000         WHEN SQLWARN0 NOT = SPACE                                17700014
177100         WHEN SQLCODE  NOT = +0                                   17710014
177200              MOVE '8451-SELECT-CARTON-CNT-BRND'                  17720014
177300                                   TO PV-PARAGRAPH-NAME           17730014
177400              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  17740014
177500              MOVE PV-SAVE-BUS-AREA-ID                            17750014
177600                                   TO PV-ITEM-NMBR                17760014
177700              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              17770014
177800              MOVE PV-SAVE-BRND-ID                                17780014
177900                                   TO PV-ITEM-NMBR                17790014
178000              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE-1            17800014
178100              PERFORM 9200-SQL-ABEND                              17810014
178200     END-EVALUATE.                                                17820014
178300*CLP 07/07/2015 END                                               17830014
178400                                                                  17840014
178500 8500-SELECT-SKU-CNT-BUS-GP.                                      17850003
178600                                                                  17860003
178700     EXEC SQL                                                     17870003
178800         SELECT COUNT(DISTINCT SKU_NBR)                           17880003
178900         INTO  :PV-SKU-COUNT                                      17890003
179000         FROM SUT_TRIP_DTL_SUM                                    17900003
179100        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          17910003
179200         AND   BUS_AREA_ID           = :SUT00095-BUS-AREA-ID      17920003
179300        WITH UR                                                   17930003
179400     END-EXEC.                                                    17940003
179500                                                                  17950003
179600     EVALUATE TRUE                                                17960003
179700         WHEN SQLCODE = ZERO                                      17970003
179800              CONTINUE                                            17980003
179900         WHEN SQLWARN0 NOT = SPACE                                17990003
180000         WHEN SQLCODE  NOT = +0                                   18000003
180100              MOVE '8500-SELECT-SKU-CNT-BUS-GP'                   18010003
180200                                   TO PV-PARAGRAPH-NAME           18020003
180300              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  18030003
180400              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               18040003
180500              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              18050003
180600              PERFORM 9200-SQL-ABEND                              18060003
180700     END-EVALUATE.                                                18070003
180800                                                                  18080003
180900 8550-SELECT-CARTON-CNT-BUS-GP.                                   18090003
181000                                                                  18100003
181100     EXEC SQL                                                     18110003
181200         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      18120003
181300         INTO  :PV-CARTON-COUNT                                   18130003
181400         FROM SUT_TRIP_DTL_SUM                                    18140003
181500        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          18150003
181600         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       18160003
181700        WITH UR                                                   18170003
181800     END-EXEC.                                                    18180003
181900                                                                  18190003
182000     EVALUATE TRUE                                                18200003
182100         WHEN SQLCODE = ZERO                                      18210003
182200              CONTINUE                                            18220003
182300         WHEN SQLWARN0 NOT = SPACE                                18230003
182400         WHEN SQLCODE  NOT = +0                                   18240003
182500              MOVE '8550-SELECT-CARTON-CNT-BUS-GP'                18250003
182600                                   TO PV-PARAGRAPH-NAME           18260003
182700              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  18270003
182800              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               18280003
182900              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              18290003
183000              PERFORM 9200-SQL-ABEND                              18300003
183100     END-EVALUATE.                                                18310003
183200                                                                  18320003
183300 8600-SUMM-TRIP-QTY-DOL.                                          18330003
183400     EXEC SQL                                                     18340003
183500         SELECT                                                   18350003
183600               SUM(UNT_QTY)                                       18360003
183700            ,  SUM(RTL_DOL_AMT)                                   18370003
183800            ,  SUM(COST_DOL_AMT)                                  18380003
183900         INTO                                                     18390003
184000               :PV-UNIT-QTY-SUM                                   18400003
184100            ,  :PV-RETAIL-SUM                                     18410003
184200            ,  :PV-COST-SUM                                       18420003
184300         FROM SUT_TRIP_DTL_SUM                                    18430003
184400        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          18440003
184500        WITH UR                                                   18450003
184600     END-EXEC.                                                    18460003
184700                                                                  18470003
184800                                                                  18480003
184900     EVALUATE TRUE                                                18490003
185000         WHEN SQLCODE = ZERO                                      18500003
185100              CONTINUE                                            18510003
185200         WHEN SQLCODE = -305                                      18520003
185300             MOVE ZERO             TO PV-UNIT-QTY-SUM             18530003
185400                                      PV-RETAIL-SUM               18540003
185500                                      PV-COST-SUM                 18550003
185600              CONTINUE                                            18560003
185700         WHEN SQLWARN0 NOT = SPACE                                18570003
185800         WHEN SQLCODE  NOT = +0                                   18580003
185900* DMH 1/25/05 - BEGIN                                             18590003
186000     MOVE SPACES                     TO PV-CICS-MSG-AREA          18600003
186100     MOVE DK-OTBND-TRIP-ID           TO PV-DISP-TRIP              18610003
186200     MOVE SQLCODE                    TO PV-DISP-SQLCODE           18620003
186300     STRING ' SUKCS574 - '                                        18630003
186400            '8600-SUMM-TRIP-QTY-DOL - '                           18640003
186500                                             DELIMITED BY SIZE    18650003
186600                                        INTO PV-CICS-MSG-AREA     18660003
186700     PERFORM 9997-CSSL                                            18670003
186800     MOVE SPACES                     TO PV-CICS-MSG-AREA          18680003
186900     STRING ' SUKCS574 - '                                        18690003
187000            'TRIP=' PV-DISP-TRIP                                  18700003
187100            '  SQLCODE= ' PV-DISP-SQLCODE                         18710003
187200            '  TMST='  PV-CURRENT-TIMESTAMP                       18720003
187300                                             DELIMITED BY SIZE    18730003
187400                                        INTO PV-CICS-MSG-AREA     18740003
187500     PERFORM 9997-CSSL                                            18750003
187600* DMH 1/25/05 - END                                               18760003
187700              MOVE '8600-SUMM-TRIP-QTY-DOL'                       18770003
187800                                   TO PV-PARAGRAPH-NAME           18780003
187900              MOVE 'SUM SUT_WRK_SUM' TO PV-DB2-OPERATION-ATTEMPTED18790003
188000              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               18800003
188100              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              18810003
188200              PERFORM 9200-SQL-ABEND                              18820003
188300     END-EVALUATE.                                                18830003
188400                                                                  18840003
188500 8700-SELECT-SKU-CNT-TRIP.                                        18850003
188600                                                                  18860003
188700     EXEC SQL                                                     18870003
188800         SELECT COUNT(DISTINCT SKU_NBR)                           18880003
188900         INTO  :PV-SKU-COUNT                                      18890003
189000         FROM SUT_TRIP_DTL_SUM                                    18900003
189100        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          18910003
189200        WITH UR                                                   18920003
189300     END-EXEC.                                                    18930003
189400                                                                  18940003
189500                                                                  18950003
189600     EVALUATE TRUE                                                18960003
189700         WHEN SQLCODE = ZERO                                      18970003
189800              CONTINUE                                            18980003
189900         WHEN SQLCODE = -304                                      18990003
190000              MOVE 9999  TO  PV-SKU-COUNT                         19000003
190100         WHEN SQLWARN0 NOT = SPACE                                19010003
190200         WHEN SQLCODE  NOT = +0                                   19020003
190300              MOVE '8700-SELECT-SKU-CNT-TRIP'                     19030003
190400                                   TO PV-PARAGRAPH-NAME           19040003
190500              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  19050003
190600              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               19060003
190700              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              19070003
190800              PERFORM 9200-SQL-ABEND                              19080003
190900     END-EVALUATE.                                                19090003
191000                                                                  19100003
191100 8750-SELECT-CARTON-CNT-TRIP.                                     19110003
191200                                                                  19120003
191300     EXEC SQL                                                     19130003
191400         SELECT COUNT(DISTINCT SHIPT_UNT_ID)                      19140003
191500         INTO  :PV-CARTON-COUNT                                   19150003
191600         FROM SUT_TRIP_DTL_SUM                                    19160003
191700        WHERE  TRIP_OCRNC_ID         = :DK-TRIP-OCRNC-ID          19170003
191800        WITH UR                                                   19180003
191900     END-EXEC.                                                    19190003
192000                                                                  19200003
192100     EVALUATE TRUE                                                19210003
192200         WHEN SQLCODE = ZERO                                      19220003
192300              CONTINUE                                            19230003
192400         WHEN SQLWARN0 NOT = SPACE                                19240003
192500         WHEN SQLCODE  NOT = +0                                   19250003
192600              MOVE '8750-SELECT-CARTON-CNT-TRIP'                  19260003
192700                                   TO PV-PARAGRAPH-NAME           19270003
192800              MOVE 'READ SUT00095' TO PV-DB2-OPERATION-ATTEMPTED  19280003
192900              MOVE DK-OTBND-TRIP-ID TO PV-ITEM-NMBR               19290003
193000              MOVE PV-ITEM-NMBR    TO PV-FIELD-VALUE              19300003
193100              PERFORM 9200-SQL-ABEND                              19310003
193200     END-EVALUATE.                                                19320003
193300                                                                  19330003
193400 8800-INSERT-SUT00010.                                            19340003
193500                                                                  19350003
193600     EXEC SQL                                                     19360003
193700          INSERT INTO SUT_MAJ_CL_SUM                              19370003
193800                 (TRIP_OCRNC_ID                                   19380003
193900               ,  BUS_AREA_ID                                     19390003
194000               ,  DEPT_NBR                                        19400003
194100               ,  MAJ_CL_NBR                                      19410003
194200               ,  UNT_QTY                                         19420003
194300               ,  SKU_QTY                                         19430003
194400               ,  CART_QTY                                        19440003
194500               ,  RTL_DOL_AMT                                     19450003
194600               ,  COST_DOL_AMT)                                   19460003
194700          VALUES (                                                19470003
194800                 :SUT00010-TRIP-OCRNC-ID                          19480003
194900              ,  :SUT00010-BUS-AREA-ID                            19490003
195000              ,  :SUT00010-DEPT-NBR                               19500003
195100              ,  :SUT00010-MAJ-CL-NBR                             19510003
195200              ,  :SUT00010-UNT-QTY                                19520003
195300              ,  :SUT00010-SKU-QTY                                19530003
195400              ,  :SUT00010-CART-QTY                               19540003
195500              ,  :SUT00010-RTL-DOL-AMT                            19550003
195600              ,  :SUT00010-COST-DOL-AMT)                          19560003
195700     END-EXEC.                                                    19570003
195800                                                                  19580003
195900     EVALUATE TRUE                                                19590003
196000         WHEN SQLCODE = +0                                        19600003
196100              CONTINUE                                            19610003
196200                                                                  19620003
196300         WHEN SQLWARN0 NOT = SPACES                               19630003
196400         WHEN SQLCODE < +0                                        19640003
196500         WHEN SQLCODE > +0                                        19650003
196600             MOVE '8800-INSERT-SUT00010'                          19660003
196700                                  TO PV-PARAGRAPH-NAME            19670003
196800             MOVE 'INSERT SUT_MAJ_CL_SUM'                         19680003
196900                               TO PV-DB2-OPERATION-ATTEMPTED      19690003
197000             MOVE SUT00010-TRIP-OCRNC-ID  TO PV-FIELD-VALUE       19700003
197100             MOVE SUT00010-BUS-AREA-ID TO PV-FIELD-VALUE-1        19710003
197200             MOVE SUT00010-DEPT-NBR    TO PV-FIELD-VALUE-2        19720003
197300             MOVE SQLCODE      TO PV-DISP-SQLCODE                 19730003
197400             PERFORM 9200-SQL-ABEND                               19740003
197500     END-EVALUATE.                                                19750003
197600                                                                  19760003
197700 8820-INSERT-SUT00009.                                            19770003
197800                                                                  19780003
197900     EXEC SQL                                                     19790003
198000          INSERT INTO SUT_DEPT_SUM                                19800003
198100                 (TRIP_OCRNC_ID                                   19810003
198200               ,  BUS_AREA_ID                                     19820003
198300               ,  DEPT_NBR                                        19830003
198400               ,  UNT_QTY                                         19840003
198500               ,  SKU_QTY                                         19850003
198600               ,  CART_QTY                                        19860003
198700               ,  RTL_DOL_AMT                                     19870003
198800               ,  COST_DOL_AMT)                                   19880003
198900          VALUES (                                                19890003
199000                 :SUT00009-TRIP-OCRNC-ID                          19900003
199100              ,  :SUT00009-BUS-AREA-ID                            19910003
199200              ,  :SUT00009-DEPT-NBR                               19920003
199300              ,  :SUT00009-UNT-QTY                                19930003
199400              ,  :SUT00009-SKU-QTY                                19940003
199500              ,  :SUT00009-CART-QTY                               19950003
199600              ,  :SUT00009-RTL-DOL-AMT                            19960003
199700              ,  :SUT00009-COST-DOL-AMT)                          19970003
199800     END-EXEC.                                                    19980003
199900                                                                  19990003
200000     EVALUATE TRUE                                                20000003
200100         WHEN SQLCODE = +0                                        20010003
200200              CONTINUE                                            20020003
200300                                                                  20030003
200400         WHEN SQLWARN0 NOT = SPACES                               20040003
200500         WHEN SQLCODE < +0                                        20050003
200600         WHEN SQLCODE > +0                                        20060003
200700             MOVE '8820-INSERT-SUT00009'                          20070003
200800                                  TO PV-PARAGRAPH-NAME            20080003
200900             MOVE 'INSERT SUT_DEPT_SUM'                           20090003
201000                               TO PV-DB2-OPERATION-ATTEMPTED      20100003
201100             MOVE SQLCODE            TO PV-DISP-SQLCODE           20110003
201200             PERFORM 9200-SQL-ABEND                               20120003
201300     END-EVALUATE.                                                20130003
201400                                                                  20140003
201500 8825-UPDATE-SUT00009.                                            20150003
201600                                                                  20160003
201700     EXEC SQL                                                     20170003
201800          UPDATE SUT_DEPT_SUM                                     20180003
201900             SET  UNT_QTY         = :SUT00009-UNT-QTY             20190003
202000               ,  SKU_QTY         = :SUT00009-SKU-QTY             20200003
202100               ,  CART_QTY        = :SUT00009-CART-QTY            20210003
202200               ,  RTL_DOL_AMT     = :SUT00009-RTL-DOL-AMT         20220003
202300               ,  COST_DOL_AMT    = :SUT00009-COST-DOL-AMT        20230003
202400           WHERE  TRIP_OCRNC_ID = :SUT00009-TRIP-OCRNC-ID         20240003
202500             AND  BUS_AREA_ID   = :SUT00009-BUS-AREA-ID           20250003
202600             AND  DEPT_NBR      = :SUT00009-DEPT-NBR              20260003
202700     END-EXEC.                                                    20270003
202800                                                                  20280003
202900     EVALUATE TRUE                                                20290003
203000         WHEN SQLCODE = +0                                        20300003
203100              CONTINUE                                            20310003
203200                                                                  20320003
203300         WHEN SQLWARN0 NOT = SPACES                               20330003
203400         WHEN SQLCODE < +0                                        20340003
203500         WHEN SQLCODE > +0                                        20350003
203600             MOVE '8825-UPDATE-SUT00009'                          20360003
203700                                  TO PV-PARAGRAPH-NAME            20370003
203800             MOVE 'UPDATE SUT_DEPT_SUM'                           20380003
203900                               TO PV-DB2-OPERATION-ATTEMPTED      20390003
204000             MOVE SQLCODE            TO PV-DISP-SQLCODE           20400003
204100             PERFORM 9200-SQL-ABEND                               20410003
204200     END-EVALUATE.                                                20420003
204300                                                                  20430003
204400 8840-INSERT-SUT00008.                                            20440003
204500                                                                  20450003
204600     EXEC SQL                                                     20460003
204700          INSERT INTO SUT_BUS_AREA_SUM                            20470003
204800                 (TRIP_OCRNC_ID                                   20480003
204900               ,  BUS_AREA_ID                                     20490003
205000               ,  UNT_QTY                                         20500003
205100               ,  SKU_QTY                                         20510003
205200               ,  CART_QTY                                        20520003
205300               ,  RTL_DOL_AMT                                     20530003
205400               ,  COST_DOL_AMT)                                   20540003
205500          VALUES (                                                20550003
205600                 :SUT00008-TRIP-OCRNC-ID                          20560003
205700              ,  :SUT00008-BUS-AREA-ID                            20570003
205800              ,  :SUT00008-UNT-QTY                                20580003
205900              ,  :SUT00008-SKU-QTY                                20590003
206000              ,  :SUT00008-CART-QTY                               20600003
206100              ,  :SUT00008-RTL-DOL-AMT                            20610003
206200              ,  :SUT00008-COST-DOL-AMT)                          20620003
206300     END-EXEC.                                                    20630003
206400                                                                  20640003
206500     EVALUATE TRUE                                                20650003
206600         WHEN SQLCODE = +0                                        20660003
206700              CONTINUE                                            20670003
206800                                                                  20680003
206900         WHEN SQLWARN0 NOT = SPACES                               20690003
207000         WHEN SQLCODE < +0                                        20700003
207100         WHEN SQLCODE > +0                                        20710003
207200             MOVE '8840-INSERT-SUT00008'                          20720003
207300                                  TO PV-PARAGRAPH-NAME            20730003
207400             MOVE 'INSERT SUT_BUS_AREA_SUM'                       20740003
207500                               TO PV-DB2-OPERATION-ATTEMPTED      20750003
207600             MOVE SQLCODE            TO PV-DISP-SQLCODE           20760003
207700             PERFORM 9200-SQL-ABEND                               20770003
207800     END-EVALUATE.                                                20780003
207900                                                                  20790003
208000 8845-UPDATE-SUT00008.                                            20800003
208100                                                                  20810003
208200     EXEC SQL                                                     20820003
208300          UPDATE SUT_BUS_AREA_SUM                                 20830003
208400             SET  UNT_QTY          = :SUT00008-UNT-QTY            20840003
208500               ,  SKU_QTY          = :SUT00008-SKU-QTY            20850003
208600               ,  CART_QTY         = :SUT00008-CART-QTY           20860003
208700               ,  RTL_DOL_AMT      = :SUT00008-RTL-DOL-AMT        20870003
208800               ,  COST_DOL_AMT     = :SUT00008-COST-DOL-AMT       20880003
208900           WHERE  TRIP_OCRNC_ID    = :SUT00008-TRIP-OCRNC-ID      20890003
209000             AND  BUS_AREA_ID      = :SUT00008-BUS-AREA-ID        20900003
209100     END-EXEC.                                                    20910003
209200                                                                  20920003
209300     EVALUATE TRUE                                                20930003
209400         WHEN SQLCODE = +0                                        20940003
209500              CONTINUE                                            20950003
209600                                                                  20960003
209700         WHEN SQLWARN0 NOT = SPACES                               20970003
209800         WHEN SQLCODE < +0                                        20980003
209900         WHEN SQLCODE > +0                                        20990003
210000             MOVE '8845-UPDATE-SUT00008'                          21000003
210100                                  TO PV-PARAGRAPH-NAME            21010003
210200             MOVE 'UPDATE SUT_BUS_AREA_SUM'                       21020003
210300                               TO PV-DB2-OPERATION-ATTEMPTED      21030003
210400             MOVE SQLCODE            TO PV-DISP-SQLCODE           21040003
210500             PERFORM 9200-SQL-ABEND                               21050003
210600     END-EVALUATE.                                                21060003
210700                                                                  21070003
210800 8860-INSERT-SUT00007.                                            21080003
210900                                                                  21090003
211000     EXEC SQL                                                     21100003
211100          INSERT INTO SUT_TRIP_SUM                                21110003
211200                 (TRIP_OCRNC_ID                                   21120003
211300               ,  OTBND_TRIP_ID                                   21130003
211400               ,  CRE_TMST                                        21140003
211500               ,  UNT_QTY                                         21150003
211600               ,  SKU_QTY                                         21160003
211700               ,  CART_QTY                                        21170003
211800               ,  RTL_DOL_AMT                                     21180003
211900               ,  COST_DOL_AMT)                                   21190003
212000          VALUES (                                                21200003
212100                 :SUT00007-TRIP-OCRNC-ID                          21210003
212200              ,  :SUT00007-OTBND-TRIP-ID                          21220003
212300              ,  :PV-CURRENT-TIMESTAMP                            21230003
212400              ,  :SUT00007-UNT-QTY                                21240003
212500              ,  :SUT00007-SKU-QTY                                21250003
212600              ,  :SUT00007-CART-QTY                               21260003
212700              ,  :SUT00007-RTL-DOL-AMT                            21270003
212800              ,  :SUT00007-COST-DOL-AMT)                          21280003
212900     END-EXEC.                                                    21290003
213000                                                                  21300003
213100     EVALUATE TRUE                                                21310003
213200         WHEN SQLCODE = +0                                        21320003
213300              SET PS-INSERT-DONE      TO TRUE                     21330003
213400                                                                  21340003
213500         WHEN SQLCODE = -803                                      21350003
213600              SET PS-NO-INSERT-DONE   TO TRUE                     21360003
213700              PERFORM 5000-CREATE-TRIP-OCCURENCE-ID               21370003
213800              MOVE DK-TRIP-OCRNC-ID TO SUT00007-TRIP-OCRNC-ID     21380003
213900                                                                  21390003
214000         WHEN SQLWARN0 NOT = SPACES                               21400003
214100         WHEN SQLCODE < +0                                        21410003
214200         WHEN SQLCODE > +0                                        21420003
214300             MOVE '8860-INSERT-SUT00007'                          21430003
214400                                  TO PV-PARAGRAPH-NAME            21440003
214500             MOVE 'INSERT SUT_TRIP_SUM'                           21450003
214600                               TO PV-DB2-OPERATION-ATTEMPTED      21460003
214700             MOVE SQLCODE            TO PV-DISP-SQLCODE           21470003
214800             PERFORM 9200-SQL-ABEND                               21480003
214900     END-EVALUATE.                                                21490003
215000                                                                  21500003
215100 8870-UPDATE-SUT00007.                                            21510003
215200                                                                  21520003
215300     EXEC SQL                                                     21530003
215400          UPDATE  SUT_TRIP_SUM                                    21540003
215500             SET  UNT_QTY         = :SUT00007-UNT-QTY             21550003
215600               ,  SKU_QTY         = :SUT00007-SKU-QTY             21560003
215700               ,  CART_QTY        = :SUT00007-CART-QTY            21570003
215800               ,  RTL_DOL_AMT     = :SUT00007-RTL-DOL-AMT         21580003
215900               ,  COST_DOL_AMT    = :SUT00007-COST-DOL-AMT        21590003
216000           WHERE TRIP_OCRNC_ID    = :SUT00007-TRIP-OCRNC-ID       21600003
216100             AND OTBND_TRIP_ID    = :SUT00007-OTBND-TRIP-ID       21610003
216200     END-EXEC.                                                    21620003
216300                                                                  21630003
216400     EVALUATE TRUE                                                21640003
216500         WHEN SQLCODE = +0                                        21650003
216600              CONTINUE                                            21660003
216700                                                                  21670003
216800         WHEN SQLWARN0 NOT = SPACES                               21680003
216900         WHEN SQLCODE < +0                                        21690003
217000         WHEN SQLCODE > +0                                        21700003
217100             MOVE '8870-UPDATE-SUT00007'                          21710003
217200                                  TO PV-PARAGRAPH-NAME            21720003
217300             MOVE 'UPDATE SUT_TRIP_SUM'                           21730003
217400                               TO PV-DB2-OPERATION-ATTEMPTED      21740003
217500             MOVE SQLCODE            TO PV-DISP-SQLCODE           21750003
217600             PERFORM 9200-SQL-ABEND                               21760003
217700     END-EVALUATE.                                                21770003
217800                                                                  21780003
217900 8880-INSERT-SUT00011.                                            21790003
218000                                                                  21800003
218100     EXEC SQL                                                     21810003
218200          INSERT INTO SUT_MAJ_CL_AD_DTE                           21820003
218300                 (TRIP_OCRNC_ID                                   21830003
218400               ,  BUS_AREA_ID                                     21840003
218500               ,  DEPT_NBR                                        21850003
218600               ,  MAJ_CL_NBR                                      21860003
218700               ,  AD_EVNT_DTE)                                    21870003
218800          VALUES (                                                21880003
218900                 :SUT00011-TRIP-OCRNC-ID                          21890003
219000              ,  :SUT00011-BUS-AREA-ID                            21900003
219100              ,  :SUT00011-DEPT-NBR                               21910003
219200              ,  :SUT00011-MAJ-CL-NBR                             21920003
219300              ,  :SUT00011-AD-EVNT-DTE)                           21930003
219400     END-EXEC.                                                    21940003
219500                                                                  21950003
219600     EVALUATE TRUE                                                21960003
219700         WHEN SQLCODE = +0                                        21970003
219800              CONTINUE                                            21980003
219900                                                                  21990003
220000         WHEN SQLWARN0 NOT = SPACES                               22000003
220100         WHEN SQLCODE < +0                                        22010003
220200         WHEN SQLCODE > +0                                        22020003
220300             MOVE '8880-INSERT-SUT00011'                          22030003
220400                                  TO PV-PARAGRAPH-NAME            22040003
220500             MOVE 'INSERT SUT_MAJ_CL_AD_DTE'                      22050003
220600                               TO PV-DB2-OPERATION-ATTEMPTED      22060003
220700             MOVE SQLCODE            TO PV-DISP-SQLCODE           22070003
220800             PERFORM 9200-SQL-ABEND                               22080003
220900     END-EVALUATE.                                                22090003
221000                                                                  22100003
221100*CLP 07/07/2015 START                                             22110014
221200 8891-INSERT-SUT00066.                                            22120017
221300                                                                  22130014
221400     EXEC SQL                                                     22140014
221500          INSERT INTO SUT_BRND_MDSE_SUM                           22150014
221600                 (BUS_AREA_ID                                     22160014
221700               ,  TRIP_OCRNC_ID                                   22170014
221800               ,  BRND_ID                                         22180014
221900               ,  UNT_QTY                                         22190014
222000               ,  SKU_QTY                                         22200014
222100               ,  CART_QTY                                        22210014
222200               ,  RTL_DOL_AMT                                     22220014
222300               ,  COST_DOL_AMT                                    22230014
222400               ,  PRC_MSG_RPLN_NEW_IND                            22240014
222500               ,  HNG_FOLD_CDE)                                   22250014
222600          VALUES (                                                22260014
222700                 :SUT00066-BUS-AREA-ID                            22270017
222800              ,  :SUT00066-TRIP-OCRNC-ID                          22280017
222900              ,  :SUT00066-BRND-ID                                22290017
223000              ,  :SUT00066-UNT-QTY                                22300017
223100              ,  :SUT00066-SKU-QTY                                22310017
223200              ,  :SUT00066-CART-QTY                               22320017
223300              ,  :SUT00066-RTL-DOL-AMT                            22330017
223400              ,  :SUT00066-COST-DOL-AMT                           22340017
223500              ,  :SUT00066-PRC-MSG-RPLN-NEW-IND                   22350017
223600              ,  :SUT00066-HNG-FOLD-CDE)                          22360017
223700     END-EXEC.                                                    22370014
223800                                                                  22380014
223900     EVALUATE TRUE                                                22390014
224000         WHEN SQLCODE = +0                                        22400014
224100              CONTINUE                                            22410014
224200                                                                  22420014
224300         WHEN SQLWARN0 NOT = SPACES                               22430014
224400         WHEN SQLCODE < +0                                        22440014
224500         WHEN SQLCODE > +0                                        22450014
224600             MOVE '8891-INSERT-SUT00066'                          22460017
224700                                  TO PV-PARAGRAPH-NAME            22470014
224800             MOVE 'INSERT SUT_BRND_MDSE_SUM'                      22480014
224900                               TO PV-DB2-OPERATION-ATTEMPTED      22490014
225000             MOVE SQLCODE            TO PV-DISP-SQLCODE           22500014
225100             MOVE SUT00066-TRIP-OCRNC-ID TO PV-FIELD-VALUE        22510025
225200             PERFORM 9200-SQL-ABEND                               22520014
225300     END-EVALUATE.                                                22530014
225400*CLP 07/07/2015 END                                               22540014
225500                                                                  22550014
225600 8900-SELECT-CURRENT-DATE.                                        22560003
225700                                                                  22570003
225800     EXEC SQL                                                     22580003
225900         SELECT DISTINCT CURRENT TIMESTAMP                        22590003
226000           INTO :PV-CURRENT-TIMESTAMP                             22600003
226100         FROM  SYSIBM.SYSDUMMY1                                   22610003
226200     END-EXEC.                                                    22620003
226300                                                                  22630003
226400     EVALUATE TRUE                                                22640003
226500         WHEN SQLCODE = ZEROS                                     22650003
226600              CONTINUE                                            22660003
226700                                                                  22670003
226800         WHEN OTHER                                               22680003
226900              MOVE '8900-SELECT-CURRENT-DATE'                     22690003
227000                                   TO PV-PARAGRAPH-NAME           22700003
227100              MOVE 'SELECT CURRENT TIMESTAMP'                     22710003
227200                                   TO PV-DB2-OPERATION-ATTEMPTED  22720003
227300              MOVE SQLCODE            TO PV-DISP-SQLCODE          22730003
227400              PERFORM 9200-SQL-ABEND                              22740003
227500     END-EVALUATE.                                                22750003
227600                                                                  22760003
227700/                                                                 22770003
227800 9000-FINIS.                                                      22780003
227900                                                                  22790003
228000                                                                  22800003
228100     PERFORM 9998-RETURN.                                         22810003
228200                                                                  22820003
228300                                                                  22830003
228400 9200-SQL-ABEND.                                                  22840003
228500******************************************************************22850003
228600*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    22860003
228700*  ERROR OR WARNING CODE OCCURS.                                  22870003
228800******************************************************************22880003
228900                                                                  22890003
229000     MOVE SPACES                     TO PV-CICS-MSG-AREA.         22900003
229100     STRING ' SUKCS574 - '           DELIMITED BY SIZE            22910003
229200            PV-PARAGRAPH-NAME        DELIMITED BY SIZE            22920003
229300                                        INTO PV-CICS-MSG-AREA.    22930003
229400     PERFORM 9997-CSSL.                                           22940003
229500     MOVE SPACES                     TO PV-CICS-MSG-AREA.         22950003
229600     STRING ' SUKCS574 - '           DELIMITED BY SIZE            22960003
229700          PV-DB2-OPERATION-ATTEMPTED DELIMITED BY SIZE            22970003
229800          ' '                        DELIMITED BY SIZE            22980003
229900          PV-DISP-SQLCODE            DELIMITED BY SIZE            22990025
230000          ' '                        DELIMITED BY SIZE            23000025
230100          PV-FIELD-VALUE             DELIMITED BY SIZE            23010003
230200          ' '                        DELIMITED BY SIZE            23020003
230300          PV-FIELD-VALUE-1           DELIMITED BY SIZE            23030003
230400          ' '                        DELIMITED BY SIZE            23040003
230500          PV-FIELD-VALUE-2           DELIMITED BY SIZE            23050003
230600                                        INTO PV-CICS-MSG-AREA.    23060003
230700     PERFORM 9997-CSSL.                                           23070003
230800                                                                  23080003
230900     MOVE +4013                  TO ABEND-CODE.                   23090003
231000     CALL 'ILBOABN0' USING ABEND-CODE.                            23100003
231100                                                                  23110003
231200******************************************************************23120003
231300* DISPLAY MESSAGE IN CICS MESSAGE LOG                             23130003
231400******************************************************************23140003
231500 9997-CSSL.                                                       23150003
231600                                                                  23160003
231700                                                                  23170003
231800     EXEC CICS                                                    23180003
231900          WRITEQ TD                                               23190003
232000           QUEUE   ('CSSL')                                       23200003
232100            FROM   (PV-CICS-MSG-AREA)                             23210003
232200          LENGTH   (80)                                           23220003
232300            RESP   (PV-CICS-RESP)                                 23230003
232400     END-EXEC.                                                    23240003
232500                                                                  23250003
232600******************************************************************23260003
232700*                                                                 23270003
232800******************************************************************23280003
232900 9998-RETURN.                                                     23290003
233000                                                                  23300003
233100     PERFORM 8900-SELECT-CURRENT-DATE.                            23310003
233200     MOVE 'ENDED'                     TO PV-LOG-PARA              23320003
233300                                                                  23330003
233400     PERFORM 9999-WRITE-TO-CSSL                                   23340003
233500     MOVE PC047-COMMAREA                TO DFHCOMMAREA.           23350003
233600                                                                  23360003
233700     IF PV-STARTCODE = 'TD'                                       23370003
233800         EXEC CICS                                                23380003
233900              RETURN                                              23390003
234000         END-EXEC                                                 23400003
234100     ELSE                                                         23410003
234200         GOBACK                                                   23420003
234300     END-IF.                                                      23430003
234400                                                                  23440003
234500                                                                  23450003
234600******************************************************************23460003
234700*                                                                 23470003
234800******************************************************************23480003
234900 9999-WRITE-TO-CSSL.                                              23490003
235000                                                                  23500003
235100     MOVE EIBTASKN                    TO PV-LOG-TASK              23510003
235200     MOVE PV-CURRENT-TIMESTAMP (12:8) TO PV-TIME-PARM             23520003
235300     MOVE PC047-CALLING-PROGRAM       TO PV-LOG-CALLING-PGM       23530003
235400     MOVE PC047-OTBND-TRIP-ID         TO PV-LOG-TRIP              23540003
235500     MOVE PV-USERID                   TO PV-LOG-TEXT              23550003
235600     MOVE PC047-SQLCODE               TO PV-LOG-SQLCODE           23560003
235700     IF PV-LOG-PARA =  'ENDED' OR                                 23570003
235800        PV-LOG-PARA =  'START'                                    23580003
235900         CONTINUE                                                 23590003
236000     ELSE                                                         23600003
236100         MOVE PC047-PARAGRAPH         TO PV-LOG-PARA              23610003
236200     END-IF                                                       23620003
236300                                                                  23630003
236400     EXEC CICS                                                    23640003
236500          WRITEQ TD                                               23650003
236600           QUEUE   ('CSSL')                                       23660003
236700            FROM   (PV-LOG-MSG)                                   23670003
236800          LENGTH   (100)                                          23680003
236900            RESP   (PV-CICS-RESP)                                 23690003
237000     END-EXEC.                                                    23700003
237100                                                                  23710003
237200***************************************************************** 23720003
237300* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 23730003
237400     COPY PCPD049.                                                23740003
