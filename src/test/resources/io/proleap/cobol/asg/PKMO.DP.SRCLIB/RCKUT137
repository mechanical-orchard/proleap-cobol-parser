000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.             RCKUT137.                                00050001
000600 AUTHOR.                 GERMAN BANDA.                            00060001
000700 INSTALLATION.           KOHLS.                                   00070001
000800 DATE-WRITTEN            APRIL, 2003.                             00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200* THIS MODULE WILL BE USED TO TRACK PO/RCVR/LINE/PACK ACTIVITY    00120001
001300******************************************************************00130001
001400 ENVIRONMENT DIVISION.                                            00140001
001500******************************************************************00150001
001600                                                                  00160001
001700******************************************************************00170001
001800 DATA DIVISION.                                                   00180001
001900******************************************************************00190001
002000                                                                  00200001
002100******************************************************************00210001
002200 WORKING-STORAGE SECTION.                                         00220001
002300******************************************************************00230001
002400*----------------------------------------------------------------*00240001
002500**  SECURITY SUBROUTINE PARAMETERS                                00250001
002600*----------------------------------------------------------------*00260001
002700     COPY DPWS008.                                                00270001
002800                                                                  00280001
002900                                                                  00290001
003000*                                                                 00300001
003100 01  DK-DB2-KEYS.                                                 00310001
003200     05  DK-PO-NBR                       PIC S9(09) COMP SYNC.    00320001
003300     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP SYNC.    00330001
003400     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00340001
003500     05  DK-FCLTY-ID                     PIC S9(04) COMP.         00350001
003600                                                                  00360001
003700 01  PC-PROGRAM-CONSTANTS.                                        00370001
003800     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00380001
003900                                  '9999-09-09-09.09.09.999999'.   00390001
004000     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'RCKUT137'.   00400001
004100     05  PC-LOGGING-PROGRAM-NAME   PIC X(08)  VALUE 'SUKPV702'.   00410001
004200     05  PC-DEFAULT-DATE           PIC X(10)  VALUE '9999-09-09'. 00420001
004300                                                                  00430001
004400                                                                  00440001
004500 01  PS-PROGRAM-SWITCHES.                                         00450001
004600     05  PS-ERROR-SW                    PIC  X(01)  VALUE  'N'.   00460001
004700         88  PS-NO-ERROR                            VALUE  'N'.   00470001
004800         88  PS-ERROR                               VALUE  'Y'.   00480001
004900     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   00490001
005000         88  PS-LOG-MESSAGE                          VALUE 'Y'.   00500001
005100         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   00510001
005200     05  PS-BEFORE-ONLY-LOGGING-SW      PIC  X       VALUE 'N'.   00520001
005300         88  PS-BEFORE-ONLY-LOGGING                  VALUE 'Y'.   00530001
005400         88  PS-NOT-BEFORE-ONLY-LOGGING              VALUE 'N'.   00540001
005500     05  PS-CONTINUATION-SW             PIC  X       VALUE 'N'.   00550001
005600         88  PS-DONE                                 VALUE 'Y'.   00560001
005700         88  PS-NOT-DONE                             VALUE 'N'.   00570001
005800     05  PS-PREV-TRKG-ROW-EXISTS-SW     PIC  X       VALUE 'N'.   00580002
005900         88  PS-PREV-TRKG-ROW-EXISTS-YES             VALUE 'Y'.   00590002
006000         88  PS-PREV-TRKG-ROW-EXISTS-NO              VALUE 'N'.   00600002
006100                                                                  00610001
006200 01  PV-PROGRAM-VARIABLES.                                        00620001
006300     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      00630001
006400                                                    COMP SYNC.    00640001
006500     05  PV-RACF-FUNCTION-NAME          PIC  X(08).               00650001
006600     05  PV-NOTIF-NBR                    PIC S9(9) VALUE ZERO     00660001
006700                                                COMP SYNC.        00670001
006800     05  PV-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.00680001
006900     05  PV-FROM-PARAGRAPH               PIC X(35) VALUE SPACES.  00690001
007000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00700001
007100                                                COMP SYNC.        00710001
007200     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     00720001
007300                                                COMP SYNC.        00730001
007400     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 00740016
007500     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 00750016
007600     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               00760001
007700     05  PV-DISP-PO                      PIC 9(09).               00770001
007800     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(04).               00780001
007900     05  PV-DISP-OPER-UNT-ID             PIC   9(04).             00790001
008000     05  PV-DISP-DEPT                    PIC   X(03).             00800001
008100     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           00810001
008200                                                 VALUE ZEROS.     00820001
008300*----------------------------------------------------------------*00830001
008400*    SQL AND COBOL DECLARATIONS FOR THE PO/RCVR TRACKING TABLE *  00840001
008500*    (RCT_PO_RCVR_TRKG) *                                         00850001
008600*----------------------------------------------------------------*00860001
008700     EXEC SQL                                                     00870001
008800          INCLUDE RCT00017                                        00880001
008900     END-EXEC.                                                    00890001
009000*----------------------------------------------------------------*00900001
009100*    SQL AND COBOL DECLARATIONS FOR THE DC FUNCTION CODE TABLE   *00910001
009200*    (RCT_DC_FUNC)                                               *00920001
009300*----------------------------------------------------------------*00930001
009400     EXEC SQL                                                     00940001
009500          INCLUDE RCT00018                                        00950001
009600     END-EXEC.                                                    00960001
009700******************************************************************00970001
009800*  COMMUNICATIONS AREA FOR DB2                                    00980001
009900******************************************************************00990001
010000     EXEC SQL                                                     01000001
010100         INCLUDE SQLCA                                            01010001
010200     END-EXEC.                                                    01020001
010300                                                                  01030001
010400******************************************************************01040001
010500 LINKAGE SECTION.                                                 01050001
010600     COPY RCWS071.                                                01060001
010700******************************************************************01070001
010800                                                                  01080001
010900******************************************************************01090001
011000 PROCEDURE DIVISION USING RC071-FIELDS.                           01100001
011100     SET RC071-SUCCESSFUL        TO TRUE                          01110001
011200     INITIALIZE DCLRCT00017                                       01120001
011300                DCLRCT00018.                                      01130001
011400                                                                  01140001
011500******************************************************************01150001
011600 0000-PROGRAM-MAINLINE.                                           01160001
011700     INITIALIZE PV-PROGRAM-VARIABLES.                             01170001
011800     SET PS-NO-ERROR TO TRUE.                                     01180001
011900     MOVE 'N'                   TO  PS-ERROR-SW                   01190001
012000                                    PS-LOG-MESSAGE-SW             01200001
012100                                    PS-BEFORE-ONLY-LOGGING-SW     01210001
012200                                    PS-PREV-TRKG-ROW-EXISTS-SW    01220012
012300                                    PS-CONTINUATION-SW.           01230012
012400                                                                  01240001
012500     MOVE RC071-DC-FUNCTION-CODE TO RCT00017-DC-FUNC-CDE          01250014
012600                                    RCT00018-DC-FUNC-CDE.         01260014
012700     MOVE RC071-PO-NBR           TO RCT00017-PO-NBR.              01270013
012800     MOVE RC071-PO-RCVR          TO RCT00017-RCVR-SEQ-NBR.        01280013
012900     MOVE RC071-SIGNON-LOCATION  TO RCT00017-LOC-NBR.             01290013
013000     MOVE RC071-PREPK-ID         TO RCT00017-PREPK-ID.            01300013
013100     IF RC071-PREPK-ID > 0                                        01310019
013200         MOVE 0                  TO RCT00017-PO-LNE-NBR           01320019
013300     ELSE                                                         01330019
013400         MOVE RC071-PO-LINE      TO RCT00017-PO-LNE-NBR           01340019
013500     END-IF.                                                      01350019
013600     MOVE RC071-CALLING-PROGRAM  TO RCT00017-CRE-BY-PGM-NM.       01360013
013700     MOVE RC071-USER-ID          TO RCT00017-CRE-BY-USR-ID.       01370013
013701                                                                  01370124
013702     IF RC071-PKSL-SEQ-NBR  IS NUMERIC                            01370224
013703        MOVE RC071-PKSL-SEQ-NBR     TO RCT00017-PKSL-SEQ-NBR      01370324
013711     ELSE                                                         01371122
013712        MOVE ZEROES                 TO RCT00017-PKSL-SEQ-NBR      01371224
013714     END-IF                                                       01371422
013715                                                                  01371522
013720     IF RC071-DEST-OPER-UNT-ID IS NUMERIC                         01372024
013721        MOVE RC071-DEST-OPER-UNT-ID TO RCT00017-DEST-LOC-NBR      01372124
013731     ELSE                                                         01373122
013732        MOVE ZEROES                 TO RCT00017-DEST-LOC-NBR      01373224
013800     END-IF                                                       01380022
013810                                                                  01381022
013900     PERFORM 1000-SELECT-BY-DC-FUNC.                              01390002
014000     PERFORM 1200-PROCESS-TRKING-CDE.                             01400002
014100                                                                  01410001
014200     PERFORM 9998-RETURN.                                         01420001
014300                                                                  01430001
014400 1000-SELECT-BY-DC-FUNC.                                          01440002
014500                                                                  01450001
014600     EXEC SQL                                                     01460001
014700          SELECT   QTY_TRKG_CDE                                   01470002
014800            INTO  :RCT00018-QTY-TRKG-CDE                          01480002
014900            FROM                                                  01490001
015000                  RCT_DC_FUNC                                     01500002
015100            WHERE DC_FUNC_CDE       = :RCT00018-DC-FUNC-CDE       01510002
015200     END-EXEC.                                                    01520001
015300                                                                  01530001
015400     EVALUATE TRUE                                                01540001
015500         WHEN SQLCODE = ZERO                                      01550001
015600             CONTINUE                                             01560002
015700         WHEN SQLCODE = -904                                      01570001
015800         WHEN SQLCODE = -911                                      01580001
015900             SET RC071-DATABASE-BUSY   TO TRUE                    01590001
016000             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  01600001
016100             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     01610001
016200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       01620001
016300             STRING   ' RCKUT137-1000-'                           01630002
016400                      ' CALLED BY-'                               01640001
016500                      RC071-CALLING-PROGRAM                       01650001
016600                      ' PO='                                      01660001
016700                      PV-DISP-PO                                  01670001
016800                      ' RCVR='                                    01680001
016900                      PV-DISP-RCVR-SEQ-NBR                        01690001
017000                      'SQLCODE'                                   01700001
017100                      PV-DISPLAY-SQLCODE                          01710001
017200                      'FUNC= '                                    01720017
017300                      RCT00018-DC-FUNC-CDE                        01730017
017400                      DELIMITED BY SIZE                           01740001
017500                                      INTO RC071-CRA-RET-MSG      01750001
017600             MOVE '1000-'        TO RC071-CRA-REQ-ID              01760002
017700             PERFORM 9999-WRITE-TO-CSSL                           01770015
017800             PERFORM 9998-RETURN                                  01780015
017900         WHEN SQLWARN0 NOT = SPACES                               01790015
018000         WHEN SQLCODE  NOT = ZERO                                 01800015
018100             SET RC071-INVALID-SQL     TO TRUE                    01810015
018200             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  01820015
018300             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     01830015
018400             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       01840015
018500             STRING   ' RCKUT137-1000-'                           01850015
018600                      ' CALLED BY-'                               01860015
018700                      RC071-CALLING-PROGRAM                       01870015
018800                      ' PO='                                      01880015
018900                      PV-DISP-PO                                  01890015
019000                      ' RCVR='                                    01900015
019100                      PV-DISP-RCVR-SEQ-NBR                        01910015
019200                      'SQLCODE'                                   01920015
019300                      PV-DISPLAY-SQLCODE                          01930015
019400                      'FUNC= '                                    01940018
019500                      RCT00018-DC-FUNC-CDE                        01950018
019600                      DELIMITED BY SIZE                           01960015
019700                                      INTO RC071-CRA-RET-MSG      01970015
019800             MOVE '1000-'        TO RC071-CRA-REQ-ID              01980015
019900             PERFORM 9999-WRITE-TO-CSSL                           01990015
020000             PERFORM 9998-RETURN                                  02000015
020100     END-EVALUATE.                                                02010015
020200                                                                  02020015
020300 1200-PROCESS-TRKING-CDE.                                         02030015
020400                                                                  02040015
020500**  I = INCREMENT   C = CREATE                                    02050015
020600                                                                  02060015
020700     IF RCT00018-QTY-TRKG-CDE = 'I'                               02070015
020800        PERFORM 1500-CHCK-TRKING-ROW-EXSTS                        02080015
020900        IF PS-PREV-TRKG-ROW-EXISTS-YES                            02090015
021000           PERFORM 1750-UPDATE-RCT-PO-RCVR-TRKG                   02100015
021100        ELSE                                                      02110015
021200           PERFORM 2000-INSERT-RCT-PO-RCVR-TRKG                   02120015
021300        END-IF                                                    02130015
021400     ELSE                                                         02140015
021500        PERFORM 2000-INSERT-RCT-PO-RCVR-TRKG                      02150015
021600     END-IF.                                                      02160015
021700                                                                  02170015
021800                                                                  02180015
021900                                                                  02190001
022000 1500-CHCK-TRKING-ROW-EXSTS.                                      02200002
022100                                                                  02210001
022200     EXEC SQL                                                     02220001
022300          SELECT   MIN(CRE_TMST)                                  02230002
022400            INTO  :RCT00017-CRE-TMST                              02240002
022500            FROM  RCT_PO_RCVR_TRKG                                02250002
022600            WHERE PO_NBR          = :RCT00017-PO-NBR              02260002
022700              AND RCVR_SEQ_NBR    = :RCT00017-RCVR-SEQ-NBR        02270002
022800              AND CRE_BY_USR_ID   = :RCT00017-CRE-BY-USR-ID       02280002
022900              AND PO_LNE_NBR      = :RCT00017-PO-LNE-NBR          02290002
023000              AND PREPK_ID        = :RCT00017-PREPK-ID            02300002
023100     END-EXEC.                                                    02310001
023200                                                                  02320001
023300     EVALUATE TRUE                                                02330001
023400         WHEN SQLCODE = ZERO                                      02340001
023500             SET PS-PREV-TRKG-ROW-EXISTS-YES TO TRUE              02350002
023600         WHEN SQLCODE = +100                                      02360010
023700             SET PS-PREV-TRKG-ROW-EXISTS-NO  TO TRUE              02370002
023800         WHEN SQLCODE = -904                                      02380001
023900         WHEN SQLCODE = -911                                      02390001
024000             SET RC071-DATABASE-BUSY   TO TRUE                    02400001
024100             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  02410001
024200             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     02420001
024300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       02430001
024400             STRING   ' RCKUT137-1500-'                           02440012
024500                      ' CALLED BY-'                               02450001
024600                      RC071-CALLING-PROGRAM                       02460001
024700                      ' PO='                                      02470001
024800                      PV-DISP-PO                                  02480001
024900                      ' RCVR='                                    02490001
025000                      PV-DISP-RCVR-SEQ-NBR                        02500001
025100                      'SQLCODE'                                   02510001
025200                      PV-DISPLAY-SQLCODE                          02520001
025300                      DELIMITED BY SIZE                           02530001
025400                                      INTO RC071-CRA-RET-MSG      02540001
025500             MOVE '1500-'        TO RC071-CRA-REQ-ID              02550012
025600             PERFORM 9999-WRITE-TO-CSSL                           02560015
025700             PERFORM 9998-RETURN                                  02570015
025800         WHEN SQLWARN0 NOT = SPACES                               02580001
025900         WHEN SQLCODE  NOT = ZERO                                 02590001
026000             SET RC071-INVALID-SQL     TO TRUE                    02600001
026100             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  02610001
026200             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     02620001
026300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       02630001
026400             STRING   ' RCKUT137-1500-'                           02640012
026500                      ' CALLED BY-'                               02650001
026600                      RC071-CALLING-PROGRAM                       02660001
026700                      ' PO='                                      02670001
026800                      PV-DISP-PO                                  02680001
026900                      ' RCVR='                                    02690001
027000                      PV-DISP-RCVR-SEQ-NBR                        02700001
027100                      'SQLCODE'                                   02710001
027200                      PV-DISPLAY-SQLCODE                          02720001
027300                      DELIMITED BY SIZE                           02730001
027400                                      INTO RC071-CRA-RET-MSG      02740001
027500             MOVE '1500-'        TO RC071-CRA-REQ-ID              02750012
027600             PERFORM 9999-WRITE-TO-CSSL                           02760015
027700             PERFORM 9998-RETURN                                  02770001
027800     END-EVALUATE.                                                02780001
027900                                                                  02790002
028000 1750-UPDATE-RCT-PO-RCVR-TRKG.                                    02800002
028100                                                                  02810002
028200     EXEC SQL                                                     02820002
028300        UPDATE RCT_PO_RCVR_TRKG                                   02830003
028400         SET   QTY_TRKD_NBR    =  (QTY_TRKD_NBR + 1)              02840005
028500             , LAST_UPD_TMST   =  CURRENT TIMESTAMP               02850011
028600         WHERE PO_NBR           = :RCT00017-PO-NBR                02860003
028700           AND RCVR_SEQ_NBR     = :RCT00017-RCVR-SEQ-NBR          02870003
028800           AND CRE_BY_USR_ID    = :RCT00017-CRE-BY-USR-ID         02880003
028900           AND CRE_TMST         = :RCT00017-CRE-TMST              02890003
029000     END-EXEC.                                                    02900002
029100                                                                  02910002
029200     EVALUATE TRUE                                                02920002
029300         WHEN SQLCODE = ZERO                                      02930002
029400         WHEN SQLCODE = +100                                      02940005
029500             CONTINUE                                             02950002
029600         WHEN SQLCODE = -904                                      02960002
029700         WHEN SQLCODE = -911                                      02970002
029800             SET RC071-DATABASE-BUSY   TO TRUE                    02980002
029900             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  02990002
030000             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     03000002
030100             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       03010002
030200             STRING   ' RCKUT137-1750-'                           03020002
030300                      ' CALLED BY-'                               03030002
030400                      RC071-CALLING-PROGRAM                       03040002
030500                      ' PO='                                      03050002
030600                      PV-DISP-PO                                  03060002
030700                      ' RCVR='                                    03070002
030800                      PV-DISP-RCVR-SEQ-NBR                        03080002
030900                      'SQLCODE'                                   03090002
031000                      PV-DISPLAY-SQLCODE                          03100002
031100                      DELIMITED BY SIZE                           03110002
031200                                      INTO RC071-CRA-RET-MSG      03120002
031300             MOVE '1750-'        TO RC071-CRA-REQ-ID              03130002
031400             PERFORM 9999-WRITE-TO-CSSL                           03140015
031500             PERFORM 9998-RETURN                                  03150002
031600         WHEN SQLWARN0 NOT = SPACES                               03160002
031700         WHEN SQLCODE  NOT = ZERO                                 03170002
031800             SET RC071-INVALID-SQL     TO TRUE                    03180002
031900             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  03190002
032000             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     03200002
032100             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       03210002
032200             STRING   ' RCKUT137-1750-'                           03220002
032300                      ' CALLED BY-'                               03230002
032400                      RC071-CALLING-PROGRAM                       03240002
032500                      ' PO='                                      03250002
032600                      PV-DISP-PO                                  03260002
032700                      ' RCVR='                                    03270002
032800                      PV-DISP-RCVR-SEQ-NBR                        03280002
032900                      'SQLCODE'                                   03290002
033000                      PV-DISPLAY-SQLCODE                          03300002
033100                      DELIMITED BY SIZE                           03310002
033200                                      INTO RC071-CRA-RET-MSG      03320002
033300             MOVE '1750-'        TO RC071-CRA-REQ-ID              03330002
033400             PERFORM 9999-WRITE-TO-CSSL                           03340015
033500             PERFORM 9998-RETURN                                  03350002
033600     END-EVALUATE.                                                03360002
033700                                                                  03370002
033800 2000-INSERT-RCT-PO-RCVR-TRKG.                                    03380002
033900                                                                  03390014
034000     MOVE   +1          TO      RCT00017-QTY-TRKD-NBR.            03400014
034100                                                                  03410014
034200     EXEC SQL                                                     03420001
034300          INSERT INTO RCT_PO_RCVR_TRKG                            03430002
034400                 ( PO_NBR                                         03440002
034500                  ,RCVR_SEQ_NBR                                   03450002
034600                  ,CRE_BY_USR_ID                                  03460002
034700                  ,CRE_TMST                                       03470002
034800                  ,DC_FUNC_CDE                                    03480002
034900                  ,LOC_NBR                                        03490002
035000                  ,PO_LNE_NBR                                     03500002
035100                  ,PREPK_ID                                       03510002
035200                  ,CRE_BY_PGM_NM                                  03520002
035300                  ,QTY_TRKD_NBR                                   03530002
035400                  ,LAST_UPD_TMST                                  03540011
035410                  ,PKSL_SEQ_NBR                                   03541021
035420                  ,DEST_LOC_NBR                                   03542021
035500                 )                                                03550002
035600           VALUES                                                 03560002
035700                 (:RCT00017-PO-NBR                                03570002
035800                 ,:RCT00017-RCVR-SEQ-NBR                          03580002
035900                 ,:RCT00017-CRE-BY-USR-ID                         03590002
036000                 , CURRENT TIMESTAMP                              03600002
036100                 ,:RCT00017-DC-FUNC-CDE                           03610002
036200                 ,:RCT00017-LOC-NBR                               03620002
036300                 ,:RCT00017-PO-LNE-NBR                            03630002
036400                 ,:RCT00017-PREPK-ID                              03640002
036500                 ,:RCT00017-CRE-BY-PGM-NM                         03650002
036600                 ,:RCT00017-QTY-TRKD-NBR                          03660011
036700                 , CURRENT TIMESTAMP                              03670021
036710                 ,:RCT00017-PKSL-SEQ-NBR                          03671021
036720                 ,:RCT00017-DEST-LOC-NBR)                         03672021
036800     END-EXEC.                                                    03680001
036900                                                                  03690001
037000     EVALUATE TRUE                                                03700001
037100         WHEN SQLCODE = ZERO                                      03710001
037200         WHEN SQLCODE = +100                                      03720001
037300             CONTINUE                                             03730009
037400         WHEN SQLCODE = -904                                      03740001
037500         WHEN SQLCODE = -911                                      03750001
037600             SET RC071-DATABASE-BUSY   TO TRUE                    03760001
037700             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  03770001
037800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       03780001
037900             STRING   ' RCKUT137-2000-'                           03790012
038000                      ' CALLED BY-'                               03800001
038100                      RC071-CALLING-PROGRAM                       03810001
038200                      ' PO='                                      03820001
038300                      PV-DISP-PO                                  03830001
038400                      ' RCVR='                                    03840001
038500                      PV-DISP-RCVR-SEQ-NBR                        03850001
038600                      'SQLCODE'                                   03860001
038700                      PV-DISPLAY-SQLCODE                          03870001
038800                      DELIMITED BY SIZE                           03880001
038900                                      INTO RC071-CRA-RET-MSG      03890001
039000             MOVE '2000-'        TO RC071-CRA-REQ-ID              03900002
039100             PERFORM 9999-WRITE-TO-CSSL                           03910015
039200             PERFORM 9998-RETURN                                  03920001
039300         WHEN SQLWARN0 NOT = SPACES                               03930001
039400         WHEN SQLCODE  NOT = ZERO                                 03940001
039500             SET RC071-INVALID-SQL     TO TRUE                    03950001
039600             MOVE RC071-PO-NBR    TO  PV-DISP-PO                  03960001
039700             MOVE RC071-PO-RCVR       TO PV-DISP-RCVR-SEQ-NBR     03970001
039800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       03980001
039900             STRING   ' RCKUT137-2000-'                           03990002
040000                      ' CALLED BY-'                               04000001
040100                      RC071-CALLING-PROGRAM                       04010001
040200                      ' PO='                                      04020001
040300                      PV-DISP-PO                                  04030001
040400                      ' RCVR='                                    04040001
040500                      PV-DISP-RCVR-SEQ-NBR                        04050001
040600                      'SQLCODE'                                   04060001
040700                      PV-DISPLAY-SQLCODE                          04070001
040800                      DELIMITED BY SIZE                           04080001
040900                                      INTO RC071-CRA-RET-MSG      04090001
041000             MOVE '2000-'        TO RC071-CRA-REQ-ID              04100002
041100             PERFORM 9999-WRITE-TO-CSSL                           04110015
041200             PERFORM 9998-RETURN                                  04120001
041300     END-EVALUATE.                                                04130001
041400                                                                  04140001
041500                                                                  04150001
041600                                                                  04160001
041700                                                                  04170001
041800*-----------------------------------------------------------------04180001
041900*  RETURN TO CALLING PROGRAM                                      04190001
042000*-----------------------------------------------------------------04200001
042100 9998-RETURN.                                                     04210001
042200                                                                  04220001
042300     MOVE SQLCA                         TO RC071-SQLCA.           04230001
042400     GOBACK.                                                      04240001
042500                                                                  04250001
042600 9999-WRITE-TO-CSSL.                                              04260015
042700                                                                  04270015
042800     MOVE RC071-CRA-RET-MSG       TO PV-CICS-MSG-AREA.            04280015
042900     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      04290015
043000                                                                  04300015
043100     EXEC CICS                                                    04310015
043200          WRITEQ TD                                               04320015
043300           QUEUE   ('CSSL')                                       04330015
043400            FROM   (PV-CICS-MSG-AREA)                             04340015
043500          LENGTH   (PV-COMMAREA-LENGTH)                           04350015
043600            RESP   (PV-CICS-RESPONSE)                             04360016
043700     END-EXEC.                                                    04370015
043800                                                                  04380015
