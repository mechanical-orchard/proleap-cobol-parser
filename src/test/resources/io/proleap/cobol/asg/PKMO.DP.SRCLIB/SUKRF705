000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRF705.                                00050000
000600 AUTHOR.                 CHERI PARMLEY.                           00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN.           JULY 11, 2013.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM IS NEEDED FOR THE FINAL LABEL REQUEST. IT IS OFF   00120000
001300* THE UCC128 MENU. OPTION #5. THE PURPOSE OF THESE CHANGES ARE TO 00130000
001400* ALLOW THE DIRECTION OF CARTONS AFTER THEY HAVE BEEN RFID TAGGED 00140000
001400* IN A NON-AUDIT SITUATION.                                       00141000
001400* #OF LABELS WITHIN BATCH IS PERFORMED IN 7020- IN 2 PLACES AND   00142000
001400* A NEW PARM WAS ADDED FOR IT. RFDPLC ON THE TKRPRPM TABLE        00143000
001500*----------------------------------------------------------------*00144000
001500*----------------------------------------------------------------*00144104
000510* 10/14/2013  CHERI PARMLEY  CHG0065998     TKID: TKMAF76        *00144206
000520*             ADD F1 (TRANSFER TO HELP SCREEN) LOGIC             *00144304
000560*             TAGGED AS CLP 10/14/2013                            00144604
001500*----------------------------------------------------------------*00144704
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00144907
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00145007
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00145107
263968*---------------------------------------------------------------* 00145207
001600                                                                  00145300
001700******************************************************************00146000
001800 ENVIRONMENT DIVISION.                                            00147000
001900******************************************************************00148000
002000                                                                  00149000
002100******************************************************************00150000
002200 DATA DIVISION.                                                   00160000
002300******************************************************************00170000
002400                                                                  00180000
002500******************************************************************00190000
002600 WORKING-STORAGE SECTION.                                         00200000
002700******************************************************************00210000
002800*                                                                 00220000
002900 01  CA-COMMAREA.                                                 00230000
003000*----------------------------------------------------------------*00240000
003100*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT            00250000
003200*----------------------------------------------------------------*00260000
003300     COPY SUWS001.                                                00270000
003600                                                                  00280000
003700*----------------------------------------------------------------*00290000
003800*  DB2 KEYS                                                      *00300000
003900*----------------------------------------------------------------*00310000
004000 01  DK-DB2-KEYS.                                                 00320000
004100     05  DK-CURR-OPER-UNT-ID             PIC  S9(4) COMP.         00330000
004200     05  DK-FCLTY-ID                     PIC  S9(4) VALUE +1      00340000
004300                                                    COMP.         00350000
004400     05  DK-TRIP-ID                      PIC  S9(9) COMP.         00360000
004500                                                                  00370000
      *CLP 10/14/2013 BEGIN                                             00370104
006200* HELP SCREEN COMMAREA                                            00371000
006300     COPY PCWS192.                                                00372000
006400*----------------------------------------------------------------*00373000
006500* HELP SCREEN WORK AREA                                           00374000
006600     COPY PCWS188.                                                00375000
      *CLP 10/14/2013 END                                               00375104
004600*----------------------------------------------------------------*00380000
004700*  PROGRAM CONSTANTS                                             *00390000
004800*----------------------------------------------------------------*00400000
004900 01  PC-PROGRAM-CONSTANTS.                                        00410000
005000     05  PC-TRANID                       PIC  X(04)  VALUE 'S705'.00420000
005100     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00430000
005200                                                     COMP SYNC.   00440000
005300     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00450000
005400                                                     COMP SYNC.   00460000
005600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00470000
005700                                                     COMP SYNC.   00480000
005800     05  PC-MF-FORM-LENGTH               PIC S9(04)  VALUE +207   00490000
005900                                                     COMP SYNC.   00500000
006000     05  PC-FI-FORM-LENGTH               PIC S9(04)  VALUE +244   00510000
006100                                                     COMP SYNC.   00520000
006200     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00530000
006300                                                     COMP SYNC.   00540000
006400     05  PC-WAKE-LENGTH                  PIC S9(04)  VALUE +3     00550000
006500                                                     COMP SYNC.   00560000
006800     05  PC-01                           PIC  X(02)  VALUE '01'.  00570000
006900     05  PC-49                           PIC  X(02)  VALUE '49'.  00580000
007000     05  PC-50                           PIC  X(02)  VALUE '50'.  00590000
007100     05  PC-95                           PIC  X(02)  VALUE '95'.  00600000
007200     05  PC-A                            PIC  X(01)  VALUE 'A'.   00610000
007210     05  PC-B                            PIC  X(01)  VALUE 'B'.   00620000
007300     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00630000
007400     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00640000
007500     05  PC-90                           PIC  X(02)  VALUE '90'.  00650000
007600     05  PC-CORPORATE                    PIC S9(04)  VALUE 90     00660000
007700                                                     COMP.        00670000
007800                                                                  00680000
007900     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF705'.   00690000
008000     05  PC-TRAILER-STOP-PGM        PIC X(08) VALUE 'SUKRF503'.   00700000
008300     05  PC-SU-MENU-PGM             PIC X(08) VALUE 'SUKRF500'.   00710000
008400     05  PC-SU-SHIP-CODE-PGM        PIC X(08) VALUE 'SUKRF706'.   00720000
008500     05  PC-PRTR-VALIDATION-PGM     PIC X(08) VALUE 'DPKCS060'.   00730000
008600     05  PC-REPORT-PGM-1            PIC X(08) VALUE 'PCKCS126'.   00740000
008700     05  PC-REPORT-PGM-2            PIC X(08) VALUE 'SUKRF527'.   00750000
008800                                                                  00760000
008900*----------------------------------------------------------------*00770000
009000*   ERROR MESSAGES                                                00780000
009100*----------------------------------------------------------------*00790000
009200     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19)                     00800000
009300                                    VALUE  'DB2 ACCESS ERROR   '. 00810000
009400     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     00820000
009500                                    VALUE  'UNRECOGNIZED PF KEY'. 00830000
009600     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     00840000
009700                                    VALUE  'ENTER THROUGH MENU '. 00850000
009800     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     00860000
009900                                    VALUE  'TRANS NOT AVAILABLE'. 00870000
010000     05  PC-PLS-ENT-FLD-MSG         PIC X(19)                     00880000
010100                                    VALUE  'PLEASE ENTER FIELD '. 00890000
010200     05  PC-MUST-BE-NUM-MSG         PIC X(19)                     00900000
010300                                    VALUE  'MUST BE NUMERIC    '. 00910000
010400     05  PC-MUST-BE-GT-0-MSG        PIC X(19)                     00920000
010500                                    VALUE  'MUST BE > ZERO     '. 00930000
010600     05  PC-MUST-BE-PBS-MSG         PIC X(19)                     00940000
010700                                    VALUE  'RCVR NOT PK-BY-STR '. 00950000
010800     05  PC-STR-NOT-XCRIBED-MSG     PIC X(19)                     00960000
010900                                    VALUE  'STR NOT TRANSCRIBED'. 00970000
011000     05  PC-CICS-ERR-MSG            PIC X(19)                     00980000
011100                                    VALUE  'CICS ACCESS ERROR  '. 00990000
011200     05  PC-INVALID-TRIP            PIC X(19)                     01000000
011300                                    VALUE  'INVALID TRIP ID    '. 01010000
011400     05  PC-TRIP-NOT-ARRIVED        PIC X(19)                     01020000
011500                                    VALUE  'TRAILER NOT AR     '. 01030000
011600     05  PC-PRT-IND-INVALID         PIC X(19)                     01040000
011700                                    VALUE  'PRNT IND INVALID   '. 01050000
011800     05  PC-PRT-ON-F2               PIC X(19)                     01060000
011900                                    VALUE 'IS PRTR ON? F2-CNFM'.  01070000
012000     05  PC-NOT-AVAILABLE           PIC X(19)                     01080000
012100                                    VALUE 'T - NOT AVAILABLE  '.  01090000
012200     05  PC-INVALID-PRTR-ID         PIC X(19)                     01100000
012300                                    VALUE 'INVALID PRINTER ID '.  01110000
012400     05  PC-INVALID-PRTR-W-BTCH     PIC X(19)                     01120000
012500                                    VALUE 'INVALID PRTR W/BTCH'.  01130000
015200     05  PC-FINDLAY-FORM-DATA.                                    01140000
015300         10  FILLER                      PIC  X(01)  VALUE        01150000
015400         '~'.                                                     01160000
015500         10  FILLER                      PIC  X(09)  VALUE        01170000
015600         '^Rบ$บDRบ^'.                                             01180000
015700         10  FILLER                      PIC  X(41)  VALUE        01190000
015800         '^Rบ0บRบ20บ82บ203บ792บ0บ1บ0บpบ4บ0บ203บ0บบ^'.             01200000
015900         10  FILLER                      PIC  X(40)  VALUE        01210000
016000         '^Rบ1บRบ233บ340บ30บ547บ0บ1บ0บ3บ1บ1บ0บ0บบ^'.              01220000
016100         10  FILLER                      PIC  X(40)  VALUE        01230000
016200         '^Rบ2บRบ276บ467บ90บ547บ0บ1บ0บ3บ4บ3บ0บ0บบ^'.              01240000
016300         10  FILLER                      PIC  X(40)  VALUE        01250000
016400         '^Rบ3บRบ256บ140บ90บ260บ0บ1บ0บ2บ3บ2บ0บ0บบ^'.              01260000
016500* text for printer id (field 4)                                   01270000
016600         10  FILLER                      PIC  X(39)  VALUE        01280000
016700         '^Rบ4บRบ233บ82บ30บ100บ0บ1บ0บ3บ1บ1บ0บ0บบ^'.               01290000
016800* format identifier                                               01300000
016900         10  FILLER                      PIC  X(26)  VALUE        01310000
017000         '^Tบ1บRบ382บ792บ0บ1บ2บ3บ4บ^'.                            01320000
017100         10  FILLER                      PIC  X(06)  VALUE        01330000
017200         '^OบCบ^'.                                                01340000
017300         10  FILLER                      PIC  X(01)  VALUE        01350000
017400         '~'.                                                     01360000
017500*                                                                 01370000
017600***                                                               01380000
017700*                                                                 01390000
017800     05  PC-WAKE-UP-DATA.                                         01400000
017900         10  FILLER                      PIC  X(01)  VALUE        01410000
018000         '~'.                                                     01420000
018100         10  FILLER                      PIC  X(01)  VALUE        01430000
018200         'A'.                                                     01440000
018300         10  FILLER                      PIC  X(01)  VALUE        01450000
018400         '~'.                                                     01460000
018500                                                                  01470000
      ******************************************************************01480000
      **TIME FIELDS                                                     01490000
      ******************************************************************01500000
       01  SD-TIME-STAMP                   PIC  X(26)  VALUE SPACES.    01510000
       01  FILLER REDEFINES SD-TIME-STAMP.                              01520000
           05  SD-CURR-DTE                 PIC  X(10).                  01530000
           05  FILLER                      PIC  X(01).                  01540000
           05  SD-HOUR                     PIC  X(02).                  01550000
           05  FILLER                      PIC  X(01).                  01560000
           05  SD-MINUTE                   PIC  X(02).                  01570000
           05  FILLER                      PIC  X(01).                  01580000
           05  SD-SECOND                   PIC  X(02).                  01590000
           05  FILLER                      PIC  X(01).                  01600000
           05  SD-MICROSEC                 PIC  X(06).                  01610000
018600*----------------------------------------------------------------*01620000
018700* PROGRAM SWITCHES                                               *01630000
018800*----------------------------------------------------------------*01640000
018900 01  PS-PROGRAM-SWITCHES.                                         01650000
019000     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01660000
019100         88  PS-VALID-INPUT                          VALUE 'Y'.   01670000
019200         88  PS-INVALID-INPUT                        VALUE 'N'.   01680000
019700     05  PS-PRINTER-ID-SW                PIC  X(01)  VALUE 'Y'.   01690000
019800         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   01700000
019900         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   01710000
020000*                                                                 01720000
020100 01  DN-DB2-NULL-INDICATORS.                                      01730000
020200     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01740000
020300*                                                                 01750000
020400*----------------------------------------------------------------*01760000
020500* PROGRAM VARIABLES                                              *01770000
020600*----------------------------------------------------------------*01780000
020700 01  PV-PROGRAM-VARIABLES.                                        01790000
020800     05  PV-CICS-MSG-AREA.                                        01800000
020900         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 01810000
021000         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 01820000
021100         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 01830000
021200         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 01840000
021300         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 01850000
021400         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 01860000
021500     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01870000
021600     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 01880000
021700     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01890000
021800                                                     COMP SYNC.   01900000
021900     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01910000
022000     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  01920000
022100                                                     COMP SYNC.   01930000
022200     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  01940000
022300                                                     COMP SYNC.   01950000
022400     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  01960000
022500                                                     COMP SYNC.   01970000
022600     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    01980000
022700                                                     COMP SYNC.   01990000
022800     05  PV-RBA                          PIC S9(08)  VALUE +0     02000000
022900                                                     COMP SYNC.   02010000
022800     05  PV-CONTROL-NO                   PIC S9(08)  VALUE +0.    02020000
           05  PV-CONTROL-WORK.                                         02030000
               10  PV-DC-LOC                   PIC 9(04) VALUE ZERO.    02040000
               10  PV-MONTH                    PIC 9(02) VALUE ZERO.    02050000
               10  PV-DAY                      PIC 9(02) VALUE ZERO.    02060000
023000*                                                                 02070000
023100     05  PV-PROGRAM-DATA.                                         02080000
023200         10  PV-MANIFEST.                                         02090000
023300             15  PV-MANIFEST-N           PIC  9(11).              02100000
023400         10  PV-PRINTER-ID.                                       02110000
023500             15  PV-PRINTER-ID-N         PIC  9(03) VALUE ZEROES. 02120000
023600             15  PV-OPER-UNIT            PIC S9(09) VALUE ZEROES. 02130000
023700******************************************************************02140000
023800*  B=BATCH  T=TETHERED CABLE  N=NO  Y=YES                        *02150000
023900******************************************************************02160000
024000         10  PV-PRINT-IND                PIC  X(01).              02170000
024100             88  PV-VALID-PRINT-IND      VALUE 'B',               02180000
024300                                               'P', 'N', 'Y',     02190000
024400                                               'Q'.               02200000
024500             88  PV-NO-PRINTER           VALUE 'N'.               02210000
024800             88  PV-BATCH-PRINTER        VALUE 'B'.               02220000
024900             88  PV-TETHERED-PRINTER     VALUE 'T'.               02230000
025000             88  PV-TEST-TETHERED        VALUE 'Q'.               02240000
025100             88  PV-YES-PRINTER          VALUE 'Y'.               02250000
025200             88  PV-PRINT-AND-PEEL       VALUE 'P'.               02260000
025300         10 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.  02270000
025400         10 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.      02280000
025500             15 FILLER                   PIC  X(03).              02290000
025600             15 PV-2-DIGIT-DC-ABBR       PIC  X(02).              02300000
025700                                                                  02310000
025800*----------------------------------------------------------------*02320000
025900*  GENERATED DSECT FOR THE SUKM705 MAPSET                         02330000
026000*----------------------------------------------------------------*02340000
026100     COPY SUKM705.                                                02350000
026200                                                                  02360000
026300*----------------------------------------------------------------*02370000
026400*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02380000
026500*----------------------------------------------------------------*02390000
026600     COPY DPWS010I.                                               02400000
026700                                                                  02410000
026800*----------------------------------------------------------------*02420000
026900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02430000
027000*----------------------------------------------------------------*02440000
027100     COPY DPWS013.                                                02450000
027200                                                                  02460000
027300*----------------------------------------------------------------*02470000
027400*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02480000
027500*----------------------------------------------------------------*02490000
027600     COPY DPWS015.                                                02500000
027700                                                                  02510000
027800*----------------------------------------------------------------*02520000
027900*  WORKING STORAGE AREA FOR NON-ARCHITECTURE PROGRAMS             02530000
028000*----------------------------------------------------------------*02540000
028100     COPY DPWS026.                                                02550000
028200                                                                  02560000
028300*----------------------------------------------------------------*02570000
028400*  SENDING/RECEIVING AREA FOR THE                                *02580000
028500*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02590000
028600*----------------------------------------------------------------*02600000
028700     COPY DPWS072.                                                02610000
028800                                                                  02620000
028900*----------------------------------------------------------------*02630000
029000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02640000
029100*----------------------------------------------------------------*02650000
029200     COPY DFHAID.                                                 02660000
029300                                                                  02670000
029400*---------------------------------------------------------------* 02680000
029500*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 02690000
029600*---------------------------------------------------------------* 02700000
029700     EXEC SQL                                                     02710000
029800          INCLUDE TTRIPST                                         02720000
029900     END-EXEC.                                                    02730000
030000                                                                  02740000
030100*---------------------------------------------------------------* 02750000
030200*    DB2 AREA FOR THE TRIP STATUS CODE TABLE                    * 02760000
030300*---------------------------------------------------------------* 02770000
030400     EXEC SQL                                                     02780000
030500          INCLUDE TTRSTYP                                         02790000
030600     END-EXEC.                                                    02800000
030700                                                                  02810000
030800*---------------------------------------------------------------* 02820000
030900*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 02830000
031000*---------------------------------------------------------------* 02840000
031100     EXEC SQL                                                     02850000
031200          INCLUDE TVHTRIP                                         02860000
031300     END-EXEC.                                                    02870000
031400                                                                  02880000
031500*----------------------------------------------------------------*02890000
031600*  DB2 AREA FOR THE logistics domain location master table       *02900000
031700*----------------------------------------------------------------*02910000
031800     EXEC SQL                                                     02920000
031900         INCLUDE XLT00010                                         02930000
032000     END-EXEC.                                                    02940000
032100                                                                  02950000
032900*----------------------------------------------------------------*02960000
033000*  DB2 AREA FOR THE PARAMETER TABLE                              *02970000
033100*----------------------------------------------------------------*02980000
033200     EXEC SQL                                                     02990000
033300         INCLUDE TKRPRPM                                          03000000
033400     END-EXEC.                                                    03010000
033500                                                                  03020000
033600*---------------------------------------------------------------* 03030000
033700*  COMMUNICATIONS AREA FOR DB2                                    03040000
033800*---------------------------------------------------------------* 03050000
033900     EXEC SQL                                                     03060000
034000         INCLUDE SQLCA                                            03070000
034100     END-EXEC.                                                    03080000
034200                                                                  03090000
034300***************************************************************** 03100000
034400 LINKAGE SECTION.                                                 03110000
034500******************************************************************03120000
034700 01  DFHCOMMAREA.                                                 03130000
034800     05  FILLER                       OCCURS 1 TO 4072 TIMES      03140000
034900                                      DEPENDING ON EIBCALEN.      03150000
035000         10  FILLER                   PIC X.                      03160000
035100                                                                  03170000
035200******************************************************************03180000
035300 PROCEDURE DIVISION.                                              03190000
035400******************************************************************03200000
035500 0000-PROGRAM-MAINLINE.                                           03210000
035600                                                                  03220000
035800     INITIALIZE CA-COMMAREA                                       03230000
035900     MOVE DFHCOMMAREA TO CA-COMMAREA.                             03240000
036000                                                                  03250000
036100     EXEC CICS                                                    03260000
036200         ASSIGN USERID (SU001-USER-ID)                            03270000
036300                RESP   (PV-CICS-RESPONSE)                         03280000
036400                FACILITY(PV-OPER-UNIT)                            03290000
036500     END-EXEC.                                                    03300000
036600                                                                  03310000
036700     EVALUATE TRUE                                                03320000
036800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03330000
036900             CONTINUE                                             03340000
037000         WHEN OTHER                                               03350000
037100            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       03360000
037200            MOVE 'UNABLE TO ASSIGN USER-ID'                       03370000
037300              TO DP013-MESSAGE-TEXT (1)                           03380000
037400            SET DP013-LOGIC-ABEND        TO TRUE                  03390000
037500            SET DP013-NO-ROLLBACK        TO TRUE                  03400000
037600            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                03410000
037700     END-EVALUATE.                                                03420000
037800                                                                  03430000
037811     SET PV-BATCH-PRINTER   TO TRUE.                              03440000
037812     MOVE PC-B              TO  PV-PRINT-IND.                     03450000
037820                                                                  03460000
037900     PERFORM DP026-0000-GET-LOGON-INFO.                           03470000
038000     MOVE DP026-LOCATION-NBR TO  SU001-CURR-OPER-UNT-ID           03480000
038000                                 SU001-OPER-UNT-ID.               03490000
038500                                                                  03500000
037810*    SET THE CONTROL NUMBER                                       03510000
           PERFORM 3200-BUILD-CONTROL-NO.                               03520000
037812     MOVE PV-CONTROL-NO     TO  ACNTLO                            03530000
                                      SU001-AUDIT-CNTL-NBR.             03540000
038600                                                                  03550000
038300     PERFORM 7000-GET-DC-LOCATION.                                03560000
038400     PERFORM 7020-LABEL-SCAN-PRINT.                               03570000
                                                                        03580000
038700     EVALUATE TRUE                                                03590000
038800         WHEN EIBCALEN = ZERO                                     03600000
038900             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    03610000
039000             PERFORM 8300-RETURN                                  03620000
      *CLP 10/14/2013 BEGIN                                             03621004
154300****************************************************************  03631000
154400* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        03632000
154500****************************************************************  03633000
154600         WHEN EIBTRNID = 'Z278'                                   03634000
154700             MOVE DFHCOMMAREA          TO PC192-COMMAREA          03635000
154800             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             03636000
154900             SET SU001-PROCESS-SCREEN  TO TRUE                    03637000
155000             INITIALIZE PV-PROGRAM-DATA                           03638000
155600             MOVE -1     TO APRTIDL                               03639503
155700             PERFORM 8000-SEND-MAP                                03639600
155800             PERFORM 8200-RETURN-TRANID                           03639700
      *CLP 10/14/2013 END                                               03639804
155900                                                                  03640000
039200         WHEN SU001-INITIALIZE-SCREEN                             03641000
039300         WHEN EIBAID = DFHCLEAR                                   03650000
039400              SET SU001-PROCESS-SCREEN TO TRUE                    03660000
039500              SET SU001-TRIP-NOT-CONFIRMED TO TRUE                03670000
039600              PERFORM 1000-INITIALIZE                             03680000
039700              PERFORM 8000-SEND-MAP                               03690000
039800              PERFORM 8200-RETURN-TRANID                          03700000
      *CLP 10/14/2013 BEGIN                                             03701004
061300         WHEN EIBAID = DFHPF1                                     03711000
061400              PERFORM 1200-HELP-SCREEN                            03712000
      *CLP 10/14/2013 END                                               03712104
                                                                        03713000
040000         WHEN EIBAID = DFHPF3                                     03720000
040100              MOVE SPACES         TO SU001-TURN-PRINTER-ON-IND    03730000
040300              MOVE PC-SU-MENU-PGM TO PV-TRANSFER-PROGRAM          03740000
040400              PERFORM 4000-XCTL-LRT-MENU                          03750000
040500                                                                  03760000
040600         WHEN EIBAID = DFHPF2 AND                                 03770000
040700              SU001-TURN-PRINTER-ON                               03780000
040800              MOVE SPACES         TO SU001-TURN-PRINTER-ON-IND    03790000
042000              MOVE PC-SU-SHIP-CODE-PGM                            03800000
042100                                   TO PV-TRANSFER-PROGRAM         03810000
042200              PERFORM 4000-XCTL-LRT-MENU                          03820000
042300                                                                  03830000
042400         WHEN SU001-TURN-PRINTER-ON                               03840000
042500              PERFORM 8100-SEND-DATA-ONLY                         03850000
042600              PERFORM 8200-RETURN-TRANID                          03860000
042700                                                                  03870000
042800         WHEN EIBAID = DFHENTER                                   03880000
042900              SET PS-VALID-INPUT TO TRUE                          03890000
043000              PERFORM 2000-PROCESS-SCREEN-FIELDS                  03900000
043100                                                                  03910000
043200              IF  PS-VALID-INPUT                                  03920000
043300                  IF  PV-YES-PRINTER                              03930000
043600                          SET  SU001-TURN-PRINTER-ON TO TRUE      03940000
043700                          MOVE DP015-PRO-NOR-OFF  TO APRTIDA      03950000
043900                          MOVE PC-PRT-ON-F2       TO AMSGLNO      03960000
044000                          PERFORM 8100-SEND-DATA-ONLY             03970000
044100                          PERFORM 8200-RETURN-TRANID              03980000
044200                  END-IF                                          03990000
044300                  MOVE ZEROES           TO SU001-BATCH-NUMBER     04000000
044500                  IF  PV-PRINT-AND-PEEL                           04010000
038400                      PERFORM 7020-LABEL-SCAN-PRINT               04020000
044700                  END-IF                                          04030000
044900                  MOVE PC-SU-SHIP-CODE-PGM                        04040000
045000                                        TO PV-TRANSFER-PROGRAM    04050000
045100                  PERFORM 4000-XCTL-LRT-MENU                      04060000
045200              ELSE                                                04070000
045300                  PERFORM 8100-SEND-DATA-ONLY                     04080000
045400                  PERFORM 8200-RETURN-TRANID                      04090000
045500              END-IF                                              04100000
045600                                                                  04110000
045700         WHEN OTHER                                               04120000
045800              MOVE -1                         TO APRTIDL          04130000
045900              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          04140000
046000              PERFORM 8100-SEND-DATA-ONLY                         04150000
046100              PERFORM 8200-RETURN-TRANID                          04160000
046200     END-EVALUATE.                                                04170000
046300                                                                  04180000
046400     GOBACK.                                                      04190000
046500                                                                  04200000
046700 1000-INITIALIZE.                                                 04210000
046800                                                                  04220000
046900     MOVE -1                          TO APRTIDL                  04230000
047000     IF  SU001-LAST-PROGRAM = PC-SU-MENU-PGM                      04240000
047300             INITIALIZE PV-PROGRAM-DATA                           04250000
047501             SET PV-BATCH-PRINTER   TO TRUE                       04260000
047510             MOVE PC-B              TO  APRTIDO                   04270000
047520                                        PV-PRINT-IND              04280000
047600             MOVE ZEROES            TO  APRTIDO                   04290000
047700             MOVE -1                TO  APRTIDL                   04300000
047800     ELSE                                                         04310000
048400             MOVE PV-PRINTER-ID-N    TO  APRTIDO                  04320000
048500             MOVE PV-PRINTER-ID-N    TO  SU001-PRINTER-ID         04330000
048600             MOVE PV-PRINTER-ID-N    TO  SU001-PRINTER-ID-USE     04340000
048700     END-IF.                                                      04350000
      *CLP 10/14/2013 BEGIN                                             04351004
191600 1200-HELP-SCREEN.                                                04361000
191700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      04362000
191800     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       04363000
191900     COPY PCPD188.                                                04364000
192000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      04365000
192100     PERFORM 4200-XCTL-TO-HELP.                                   04366000
      *CLP 10/14/2013 END                                               04366104
192200                                                                  04367000
049000 2000-PROCESS-SCREEN-FIELDS.                                      04370000
049100     PERFORM 2100-RECEIVE-MAP.                                    04380000
049200     PERFORM 2200-EDIT-INPUT.                                     04390000
049300                                                                  04400000
049500 2100-RECEIVE-MAP.                                                04410000
049600                                                                  04420000
049700     EXEC CICS                                                    04430000
049800         RECEIVE MAP    ('SU705A')                                04440000
049900                 MAPSET ('SUKM705')                               04450000
050000                 RESP   (PV-CICS-RESPONSE)                        04460000
050100     END-EXEC.                                                    04470000
050200                                                                  04480000
050300     EVALUATE TRUE                                                04490000
050400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04500000
050500             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   04510000
050600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                04520000
050700             CONTINUE                                             04530000
050800         WHEN OTHER                                               04540000
050900            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       04550000
051000            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)04560000
051100            SET DP013-LOGIC-ABEND        TO TRUE                  04570000
051200            SET DP013-NO-ROLLBACK        TO TRUE                  04580000
051300            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                04590000
051400     END-EVALUATE.                                                04600000
051500                                                                  04610000
051600*                                                                 04620000
051700 2110-RECEIVE-SCREEN-FIELDS.                                      04630000
051800                                                                  04640000
053500     IF  APRTIDL > ZERO                                           04650000
053600         MOVE APRTIDI TO PV-PRINTER-ID                            04660000
053700     ELSE                                                         04670000
053800         IF APRTIDA = DP015-ERASE-EOF                             04680000
053900             MOVE SPACES TO PV-PRINTER-ID                         04690000
054000         END-IF                                                   04700000
054100     END-IF.                                                      04710000
054200                                                                  04720000
054300*                                                                 04730000
054400 2200-EDIT-INPUT.                                                 04740000
054500                                                                  04750000
054700     PERFORM 2230-EDIT-PRINT-IND.                                 04760000
054800     IF  PV-NO-PRINTER                                            04770000
054900         CONTINUE                                                 04780000
055000     ELSE                                                         04790000
055100         PERFORM 2260-EDIT-PRINTER-ID                             04800000
055200     END-IF.                                                      04810000
055300                                                                  04820000
055400*                                                                 04830000
055500 2230-EDIT-PRINT-IND.                                             04840000
055600     IF  PV-VALID-PRINT-IND                                       04850000
055700         MOVE PV-PRINT-IND           TO SU001-PRINTER-IND         04860000
055800     ELSE                                                         04870000
055900         SET PS-INVALID-INPUT        TO TRUE                      04880000
056000         MOVE DP015-UNP-ALP-BRT-MDT  TO APRTIDA                   04890000
056100         MOVE -1                     TO APRTIDL                   04900000
056200         MOVE PC-PRT-IND-INVALID     TO AMSGLNO                   04910000
056300     END-IF.                                                      04920000
056400*                                                                 04930000
056500***  TEMPORARY FOR TESTING WITH TETHERED PRINTING                 04940000
056600*                                                                 04950000
056700     IF  PV-TEST-TETHERED                                         04960000
056800         SET  PV-TETHERED-PRINTER    TO TRUE                      04970000
056900         MOVE PV-PRINT-IND           TO SU001-PRINTER-IND         04980000
057000     END-IF.                                                      04990000
057100                                                                  05000000
057200                                                                  05010000
064100                                                                  05020000
064200                                                                  05030000
064300******************************************************************05040000
064400*  VALIDATE PRINTER ID - MUST BE NUMERIC                         *05050000
064500*  IF PRINT OPTION = B (BATCH) VALIDATE PRINTER ID               *05060000
064600******************************************************************05070000
064700 2260-EDIT-PRINTER-ID.                                            05080000
064800                                                                  05090000
064900     EVALUATE TRUE                                                05100000
065000         WHEN PV-PRINTER-ID = SPACES                              05110000
065100             SET PS-INVALID-INPUT        TO TRUE                  05120000
065200             MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA               05130000
065300             MOVE -1                     TO APRTIDL               05140000
065400             MOVE PC-INVALID-PRTR-ID     TO AMSGLNO               05150000
065500         WHEN OTHER                                               05160000
065600             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              05170000
065700             MOVE PV-PRINTER-ID  TO  DP010I-UNEDITED-FIELD        05180000
065800             MOVE 03             TO  DP010I-MAXIMUM-DIGITS        05190000
065900             MOVE 0              TO  DP010I-MAXIMUM-DECIMALS      05200000
066000                                                                  05210000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     05221007
263968                  USING DP010I-NUMERIC-EDIT-AREA                  05222007
066200                                                                  05230000
066300             IF  DP010I-ERROR-DETECTED                            05240000
066400                 SET PS-INVALID-INPUT        TO TRUE              05250000
066500                 MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA           05260000
066600                 MOVE -1                     TO APRTIDL           05270000
066700                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           05280000
066800             ELSE                                                 05290000
066900                 IF  DP010I-NUMERIC-FIELD = ZEROES                05300000
067000                     IF  PV-NO-PRINTER                            05310000
067100                         MOVE  ZEROES  TO SU001-PRINTER-ID        05320000
067200                     ELSE                                         05330000
067300                         SET PS-INVALID-INPUT        TO TRUE      05340000
067400                         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA   05350000
067500                         MOVE -1                     TO APRTIDL   05360000
067600                         MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO   05370000
067700                     END-IF                                       05380000
067800                 ELSE                                             05390000
067900                     IF  PV-BATCH-PRINTER  OR                     05400000
068000                         PV-PRINT-AND-PEEL                        05410000
068200                         PERFORM 2270-VALIDATE-PRINTER-ID         05420000
068300                         IF  PS-INVALID-PRINTER-ID                05430000
068400                             SET PS-INVALID-INPUT TO TRUE         05440000
068500                             MOVE DP015-UNP-NUM-BRT-MDT           05450000
068600                                                     TO APRTIDA   05460000
068700                             MOVE -1                 TO APRTIDL   05470000
068800                             MOVE PC-INVALID-PRTR-ID TO AMSGLNO   05480000
068900                         ELSE                                     05490000
069000                             IF  PV-BATCH-PRINTER  AND            05500000
069100                                 DP072-PRTR-INTFC-FTP             05510000
069200                                 SET PS-INVALID-INPUT TO TRUE     05520000
069300                                 MOVE DP015-UNP-NUM-BRT-MDT       05530000
069400                                                     TO APRTIDA   05540000
069500                                 MOVE -1             TO APRTIDL   05550000
069600                                 MOVE PC-INVALID-PRTR-W-BTCH      05560000
069700                                                     TO AMSGLNO   05570000
069800                             ELSE                                 05580000
069900                                 MOVE  PV-PRINTER-ID-N            05590000
070000                                   TO  SU001-PRINTER-ID           05600000
070100                         END-IF                                   05610000
070200                     ELSE                                         05620000
070300                         MOVE  PV-PRINTER-ID-N                    05630000
070400                               TO  SU001-PRINTER-ID               05640000
070500                         MOVE  PV-PRINTER-ID-N                    05650000
070600                               TO  SU001-PRINTER-ID-USE           05660000
070700                     END-IF                                       05670000
070800                 END-IF                                           05680000
070900             END-IF                                               05690000
071000     END-EVALUATE.                                                05700000
071100                                                                  05710000
071200                                                                  05720000
071300******************************************************************05730000
071400* VALIDATE PRINTER ID                                            *05740000
071500******************************************************************05750000
071600 2270-VALIDATE-PRINTER-ID.                                        05760000
071700     IF PV-PRINT-AND-PEEL                                         05770000
071800        MOVE PC-REPORT-PGM-2  TO  DP072-RPT-PGM-NME               05780000
071900     ELSE                                                         05790000
072000        MOVE PC-REPORT-PGM-1  TO  DP072-RPT-PGM-NME               05800000
072100     END-IF                                                       05810000
072200                                                                  05820000
072300     MOVE PV-PRINTER-ID    TO  DP072-PRINTER-ID.                  05830000
072400     MOVE PC-01            TO  DP072-RPT-PGM-TYP-ID.              05840000
072500     MOVE DP026-LOCATION-NBR                                      05850000
072510                           TO  DP072-ORIGIN-OPER-UNT-ID           05860000
072610                               DP072-OPER-UNT-ID.                 05870000
072700     MOVE 1                TO  DP072-ORIGIN-FCLTY-ID              05880000
072800                               DP072-FCLTY-ID.                    05890000
072900     SET DP072-VALIDATE    TO  TRUE.                              05900000
073000                                                                  05910000
073100     EXEC CICS                                                    05920000
073200          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  05930000
073300               COMMAREA (DP072-COMM-AREA)                         05940000
073400               RESP     (PV-CICS-RESPONSE)                        05950000
073500     END-EXEC                                                     05960000
073600                                                                  05970000
073700     EVALUATE TRUE                                                05980000
073800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05990000
073900              PERFORM 2275-VALIDATE-PRINTER-SML                   06000000
074000         WHEN OTHER                                               06010000
074100             SET PS-INVALID-PRINTER-ID  TO  TRUE                  06020000
074200     END-EVALUATE.                                                06030000
074300                                                                  06040000
074400                                                                  06050000
074500******************************************************************06060000
074600*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *06070000
074700*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *06080000
074800*  CAN BE PRINTED ON THIS PRINTER.                               *06090000
074900******************************************************************06100000
075000 2275-VALIDATE-PRINTER-SML.                                       06110000
075100                                                                  06120000
075200     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               06130000
075300         SET  PS-INVALID-PRINTER-ID   TO TRUE                     06140000
075400     END-IF.                                                      06150000
075500                                                                  06160000
075600     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  06170000
075700         CONTINUE                                                 06180000
075800     ELSE                                                         06190000
075900         SET  PS-INVALID-PRINTER-ID   TO TRUE                     06200000
076000     END-IF.                                                      06210000
076100                                                                  06220000
037810*    XXXXMMDD - FIRST 4 DC FOLLOWED BY MM DD                      06230000
       3200-BUILD-CONTROL-NO.                                           06240000
                                                                        06250000
           EXEC SQL                                                     06260000
                SET :SD-TIME-STAMP = CURRENT TIMESTAMP                  06270000
           END-EXEC.                                                    06280000
                                                                        06290000
           MOVE SU001-CURR-OPER-UNT-ID TO PV-DC-LOC.                    06300000
           MOVE SD-CURR-DTE(6:2)       TO PV-MONTH.                     06310000
           MOVE SD-CURR-DTE(9:2)       TO PV-DAY.                       06320000
           MOVE PV-CONTROL-WORK        TO PV-CONTROL-NO.                06330000
                                                                        06340000
088100*                                                                 06350000
088200 4000-XCTL-LRT-MENU.                                              06360000
088300     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     06370000
088400     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          06380000
088600     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           06390000
088700     EXEC CICS                                                    06400000
088800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    06410000
088900               COMMAREA  (CA-COMMAREA)                            06420000
089100               LENGTH    (PV-COMMAREA-LENGTH)                     06430000
089200               RESP      (PV-CICS-RESPONSE)                       06440000
089300     END-EXEC.                                                    06450000
089400                                                                  06460000
089500     EVALUATE TRUE                                                06470000
089600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06480000
089700             CONTINUE                                             06490000
089800         WHEN OTHER                                               06500000
089900             MOVE '4000-XCTL-TO-LRT-MENU'                         06510000
090000                 TO DP013-PARAGRAPH                               06520000
090100             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   06530000
090200                 TO DP013-MESSAGE-TEXT (1)                        06540000
090300             MOVE PV-TRANSFER-PROGRAM                             06550000
090400                 TO DP013-MESSAGE-TEXT (2)                        06560000
090500             SET DP013-CICS-ABEND  TO TRUE                        06570000
090600             SET DP013-NO-ROLLBACK TO TRUE                        06580000
090700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06590000
090800             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06600000
090900             SET SU001-PROCESS-SCREEN TO TRUE                     06610000
091000             PERFORM 8000-SEND-MAP                                06620000
091100             PERFORM 8200-RETURN-TRANID                           06630000
091200     END-EVALUATE.                                                06640000
091300                                                                  06650000
      *CLP 10/14/2013 BEGIN                                             06650105
443300 4200-XCTL-TO-HELP.                                               06651000
443400                                                                  06652000
443500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      06653000
443600     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    06654000
443700     MOVE SU001-COMMON-DATA           TO PC192-HOST-SAVE-AREA.    06655000
443800                                                                  06656000
443900     EXEC CICS                                                    06657000
444000         XCTL                                                     06658000
444100             PROGRAM   (PV-TRANSFER-PROGRAM)                      06659000
444200             COMMAREA  (PC192-COMMAREA)                           06659100
444300             LENGTH    (PV-COMMAREA-LENGTH)                       06659200
444400             RESP      (PV-CICS-RESPONSE)                         06659300
444500     END-EXEC.                                                    06659400
444600                                                                  06659500
444700     EVALUATE TRUE                                                06659600
444800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06659700
444900              CONTINUE                                            06659800
445000         WHEN OTHER                                               06659900
445100             MOVE '4200-XCTL-TO-HELP '                            06660000
445200                 TO DP013-PARAGRAPH                               06660100
445300             MOVE 'SUKRF706 - UNABLE TO XCTL TO PROGRAM: '        06660200
445400                 TO DP013-MESSAGE-TEXT (1)                        06660300
445500             MOVE PV-TRANSFER-PROGRAM                             06660400
445600                 TO DP013-MESSAGE-TEXT (2)                        06660500
445700             SET DP013-CICS-ABEND  TO TRUE                        06660600
445800             SET DP013-ROLLBACK TO TRUE                           06660700
445900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06660800
446000             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06660900
446100             SET SU001-PROCESS-SCREEN TO TRUE                     06661000
446200             PERFORM 8000-SEND-MAP                                06661100
446300             PERFORM 8200-RETURN-TRANID                           06661200
446400     END-EVALUATE.                                                06661300
      *CLP 10/14/2013 END                                               06661405
446500                                                                  06661500
093300 5050-RECEIVE.                                                    06662000
093400     EXEC CICS                                                    06670000
093500      RECEIVE INTO    (PV-RECEIVE-DATA)                           06680000
093600              LENGTH  (PC-RECEIVE-LENGTH)                         06690000
093700              RESP    (PV-CICS-RESPONSE)                          06700000
093800     END-EXEC.                                                    06710000
093900                                                                  06720000
094000     EVALUATE TRUE                                                06730000
094100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06740000
094200         WHEN PV-CICS-RESPONSE = DFHRESP (EOC)                    06750000
094300             CONTINUE                                             06760000
094400         WHEN OTHER                                               06770000
094500             MOVE '5050-RECEIVE         ' TO DP013-PARAGRAPH      06780000
094600             MOVE 'BAD RECEIVE        ' TO DP013-MESSAGE-TEXT (1) 06790000
094700             MOVE PV-RECEIVE-DATA       TO DP013-MESSAGE-TEXT (2) 06800000
094800             SET DP013-CICS-ABEND       TO TRUE                   06810000
094900             SET DP013-NO-ROLLBACK      TO TRUE                   06820000
095000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06830000
095100     END-EVALUATE.                                                06840000
095200                                                                  06850000
095300 5075-WAKE-UP-PRINTER.                                            06860000
095400     EXEC CICS                                                    06870000
095500         SEND FROM    (PC-WAKE-UP-DATA)                           06880000
095600              LENGTH  (PC-WAKE-LENGTH)                            06890000
095700              ERASE                                               06900000
095800              RESP    (PV-CICS-RESPONSE)                          06910000
095900     END-EXEC.                                                    06920000
096000                                                                  06930000
096100     EVALUATE TRUE                                                06940000
096200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06950000
096300             CONTINUE                                             06960000
096400         WHEN OTHER                                               06970000
096500             MOVE '5075-WAKE-UP-PRINTER    ' TO DP013-PARAGRAPH   06980000
096600             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 06990000
096700             SET DP013-CICS-ABEND       TO TRUE                   07000000
096800             SET DP013-NO-ROLLBACK      TO TRUE                   07010000
096900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07020000
097000     END-EVALUATE.                                                07030000
097100                                                                  07040000
097200*6000-LABEL-FORM-FINDLAY.                                         07050000
097300* for testing only                                                07060000
097400*    STRING ' SUKRF705 FORM-'     DELIMITED BY SIZE               07070000
097500*           PC-FINDLAY-FORM-DATA  DELIMITED BY SIZE               07080000
097600*                                 INTO PV-CICS-MSG-AREA.          07090000
097700*    MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     07100000
097800*                                                                 07110000
097900*    MOVE LENGTH OF PV-CICS-MSG-AREA1                             07120000
098000*           TO PV-COMMAREA-LENGTH.                                07130000
098100*                                                                 07140000
098200*    EXEC CICS WRITEQ TD                                          07150000
098300*                     QUEUE('CSSL')                               07160000
098400*                     FROM(PV-CICS-MSG-AREA1)                     07170000
098500*                     LENGTH(PV-COMMAREA-LENGTH)                  07180000
098600*                     RESP (PV-CICS-RESPONSE)                     07190000
098700*    END-EXEC.                                                    07200000
098800*    EXEC CICS WRITEQ TD                                          07210000
098900*                     QUEUE('CSSL')                               07220000
099000*                     FROM(PV-CICS-MSG-AREA2)                     07230000
099100*                     LENGTH(PV-COMMAREA-LENGTH)                  07240000
099200*                     RESP (PV-CICS-RESPONSE)                     07250000
099300*    END-EXEC.                                                    07260000
099400*    EXEC CICS WRITEQ TD                                          07270000
099500*                     QUEUE('CSSL')                               07280000
099600*                     FROM(PV-CICS-MSG-AREA3)                     07290000
099700*                     LENGTH(PV-COMMAREA-LENGTH)                  07300000
099800*                     RESP (PV-CICS-RESPONSE)                     07310000
099900*    END-EXEC.                                                    07320000
100000*    EXEC CICS WRITEQ TD                                          07330000
100100*                     QUEUE('CSSL')                               07340000
100200*                     FROM(PV-CICS-MSG-AREA4)                     07350000
100300*                     LENGTH(PV-COMMAREA-LENGTH)                  07360000
100400*                     RESP (PV-CICS-RESPONSE)                     07370000
100500*    END-EXEC.                                                    07380000
100600*    EXEC CICS WRITEQ TD                                          07390000
100700*                     QUEUE('CSSL')                               07400000
100800*                     FROM(PV-CICS-MSG-AREA5)                     07410000
100900*                     LENGTH(PV-COMMAREA-LENGTH)                  07420000
101000*                     RESP (PV-CICS-RESPONSE)                     07430000
101100*    END-EXEC.                                                    07440000
101200*    EXEC CICS WRITEQ TD                                          07450000
101300*                     QUEUE('CSSL')                               07460000
101400*                     FROM(PV-CICS-MSG-AREA6)                     07470000
101500*                     LENGTH(PV-COMMAREA-LENGTH)                  07480000
101600*                     RESP (PV-CICS-RESPONSE)                     07490000
101700*    END-EXEC.                                                    07500000
101800* for testing only                                                07510000
101900     exec CICS                                                    07520000
102000         SEND FROM    (PC-FINDLAY-FORM-DATA)                      07530000
102100              LENGTH  (PC-FI-FORM-LENGTH)                         07540000
102200              ERASE                                               07550000
102300              RESP    (PV-CICS-RESPONSE)                          07560000
102400     END-EXEC.                                                    07570000
102500                                                                  07580000
102600     EVALUATE TRUE                                                07590000
102700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07600000
102800             CONTINUE                                             07610000
102900         WHEN OTHER                                               07620000
103000             MOVE '6000-LABEL-FORM-FINDLAY ' TO DP013-PARAGRAPH   07630000
103100             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 07640000
103200             SET DP013-CICS-ABEND       TO TRUE                   07650000
103300             SET DP013-NO-ROLLBACK      TO TRUE                   07660000
103400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07670000
103500     END-EVALUATE.                                                07680000
103600                                                                  07690000
103700                                                                  07700000
103800*----------------------------------------------------------------*07710000
103900*                                                                *07720000
104000*----------------------------------------------------------------*07730000
104100 7000-GET-DC-LOCATION.                                            07740000
104200                                                                  07750000
104300     MOVE  SPACES                    TO  SU001-DC-PRTD-AT-CDE.    07760000
104400     MOVE  SU001-CURR-OPER-UNT-ID    TO  DK-CURR-OPER-UNT-ID.     07770000
104500                                                                  07780000
104600     EXEC SQL                                                     07790000
104700          SELECT LOC_5_ABBR_NM                                    07800000
104800          INTO  :PV-DC-5-CHAR-ABBR                                07810000
104900          FROM   XLT_LOC                                          07820000
105000          WHERE  LOC_TYP_CDE = 'DC'                               07830000
105100          AND    LOC_NBR   = :DK-CURR-OPER-UNT-ID                 07840000
105200     END-EXEC.                                                    07850000
105300                                                                  07860000
105400     EVALUATE TRUE                                                07870000
105500         WHEN SQLCODE = ZERO                                      07880000
105600              MOVE  PV-2-DIGIT-DC-ABBR  TO  SU001-DC-PRTD-AT-CDE  07890000
105700                                                                  07900000
105800         WHEN SQLCODE = +100                                      07910000
105900              MOVE  PC-90   TO  SU001-DC-PRTD-AT-CDE              07920000
106000                                                                  07930000
106100         WHEN SQLWARN0 NOT = SPACES                               07940000
106200         WHEN SQLCODE NOT EQUAL ZERO                              07950000
106300             MOVE '7000-GET-DC-LOCATION'                          07960000
106400                             TO DP013-PARAGRAPH                   07970000
106500             MOVE 'SUKRF705 - GET DC LOCATION CODE'               07980000
106600                             TO DP013-MESSAGE-TEXT(1)             07990000
106700             MOVE SU001-CURR-OPER-UNT-ID                          08000000
106800                             TO DP013-MESSAGE-TEXT(2)             08010000
106900             MOVE SQLCA      TO DP013-SQLCA                       08020000
107000             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           08030000
107100             SET DP013-DB2-ABEND                                  08040000
107200                             TO TRUE                              08050000
107300             SET DP013-NO-ROLLBACK                                08060000
107400                             TO TRUE                              08070000
107500             SET DP013-XCTL-DISPLAY-RESTART                       08080000
107600                             TO TRUE                              08090000
107700             PERFORM DP014-0000-PROCESS-ABEND                     08100000
107800     END-EVALUATE.                                                08110000
107900                                                                  08120000
108000                                                                  08130000
112300*----------------------------------------------------------------*08140000
112400* GET THE DEFAULT NUMBER FOR WHEN TO PRINT LABELS                *08150000
112500*----------------------------------------------------------------*08160000
112600 7020-LABEL-SCAN-PRINT.                                           08170000
112700     MOVE ZEROES                   TO  SU001-PRT-LBL-ON-SCN-CNT.  08180000
112800     MOVE  SU001-CURR-OPER-UNT-ID  TO  DK-CURR-OPER-UNT-ID.       08190000
112900                                                                  08200000
113000     INITIALIZE DCLTKRPRPM.                                       08210000
113100                                                                  08220000
113200     EXEC SQL                                                     08230000
113300         SELECT  FUNC_QTY                                         08240000
113400           INTO  :KRPRPM-FUNC-QTY                                 08250000
113500           FROM  TKRPRPM                                          08260000
113600          WHERE  LOC_ID             = :DK-CURR-OPER-UNT-ID        08270000
113700            AND  SYS_PRC_FUNC_CDE   = 'RFDPLC'                    08280000
113800     END-EXEC.                                                    08290000
113900                                                                  08300000
114000     EVALUATE TRUE                                                08310000
114100         WHEN SQLCODE = ZERO                                      08320000
114200              MOVE  KRPRPM-FUNC-QTY                               08330000
114300                TO  SU001-PRT-LBL-ON-SCN-CNT                      08340000
114400         WHEN SQLCODE = +100                                      08350000
114500              MOVE  +1                                            08360000
114600                TO  SU001-PRT-LBL-ON-SCN-CNT                      08370000
114700         WHEN SQLWARN0 NOT = SPACES                               08380000
114800         WHEN SQLCODE NOT EQUAL ZERO                              08390000
114900             MOVE '7020-LABEL-SCAN-PRINT'                         08400000
115000                             TO DP013-PARAGRAPH                   08410000
115100             MOVE 'SUKRF705 - GET DC LABEL SCAN PRINT AMOUNT'     08420000
115200                             TO DP013-MESSAGE-TEXT(1)             08430000
115300             MOVE SU001-CURR-OPER-UNT-ID                          08440000
115400                             TO DP013-MESSAGE-TEXT(2)             08450000
115500             MOVE SQLCA      TO DP013-SQLCA                       08460000
115600             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           08470000
115700             SET DP013-DB2-ABEND                                  08480000
115800                             TO TRUE                              08490000
115900             SET DP013-NO-ROLLBACK                                08500000
116000                             TO TRUE                              08510000
116100             SET DP013-XCTL-DISPLAY-RESTART                       08520000
116200                             TO TRUE                              08530000
116300             PERFORM DP014-0000-PROCESS-ABEND                     08540000
116400     END-EVALUATE.                                                08550000
116500                                                                  08560000
121000                                                                  08570000
121100*----------------------------------------------------------------*08580000
121200*                                                                *08590000
121300*----------------------------------------------------------------*08600000
121400                                                                  08610000
121500 8000-SEND-MAP.                                                   08620000
121600                                                                  08630000
121700     EXEC CICS                                                    08640000
121800         SEND MAP       ('SU705A')                                08650000
121900              MAPSET    ('SUKM705')                               08660000
122000              ERASE                                               08670000
122100              CURSOR                                              08680000
122200              RESP      (PV-CICS-RESPONSE)                        08690000
122300     END-EXEC.                                                    08700000
122400                                                                  08710000
122500     EVALUATE TRUE                                                08720000
122600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08730000
122700             CONTINUE                                             08740000
122800         WHEN OTHER                                               08750000
122900             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         08760000
123000             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  08770000
123100             SET DP013-CICS-ABEND      TO TRUE                    08780000
123200             SET DP013-NO-ROLLBACK     TO TRUE                    08790000
123300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08800000
123400     END-EVALUATE.                                                08810000
123500                                                                  08820000
123600*                                                                 08830000
123700 8100-SEND-DATA-ONLY.                                             08840000
123800                                                                  08850000
123900     EXEC CICS                                                    08860000
124000         SEND MAP       ('SU705A')                                08870000
124100              MAPSET    ('SUKM705')                               08880000
124200              CURSOR                                              08890000
124300              DATAONLY                                            08900000
124400              RESP      (PV-CICS-RESPONSE)                        08910000
124500     END-EXEC.                                                    08920000
124600                                                                  08930000
124700     EVALUATE TRUE                                                08940000
124800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08950000
124900             CONTINUE                                             08960000
125000         WHEN OTHER                                               08970000
125100             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        08980000
125200             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 08990000
125300             SET DP013-CICS-ABEND       TO TRUE                   09000000
125400             SET DP013-NO-ROLLBACK      TO TRUE                   09010000
125500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09020000
125600     END-EVALUATE.                                                09030000
125700                                                                  09040000
125800*                                                                 09050000
125900 8200-RETURN-TRANID.                                              09060000
126100     MOVE LENGTH OF CA-COMMAREA      TO PV-COMMAREA-LENGTH        09070000
126200     EXEC CICS                                                    09080000
126300         RETURN TRANSID  (PC-TRANID)                              09090000
126400                COMMAREA (CA-COMMAREA)                            09100000
126600                LENGTH   (PV-COMMAREA-LENGTH)                     09110000
126700                RESP     (PV-CICS-RESPONSE)                       09120000
126800     END-EXEC.                                                    09130000
126900                                                                  09140000
127000     EVALUATE TRUE                                                09150000
127100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09160000
127200             CONTINUE                                             09170000
127300         WHEN OTHER                                               09180000
127400             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        09190000
127500             MOVE 'UNABLE TO RETURN TO TRANID'                    09200000
127600                 TO DP013-MESSAGE-TEXT (1)                        09210000
127700             SET DP013-CICS-ABEND       TO TRUE                   09220000
127800             SET DP013-NO-ROLLBACK      TO TRUE                   09230000
127900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09240000
128000     END-EVALUATE.                                                09250000
128100                                                                  09260000
128200*                                                                 09270000
128300 8300-RETURN.                                                     09280000
128400                                                                  09290000
128500     EXEC CICS                                                    09300000
128600         SEND FROM (PV-MESSAGE-AREA)                              09310000
128700              LENGTH (19)                                         09320000
128800              ERASE                                               09330000
128900     END-EXEC.                                                    09340000
129000                                                                  09350000
129100     EXEC CICS                                                    09360000
129200         RETURN                                                   09370000
129300     END-EXEC.                                                    09380000
129400                                                                  09390000
129500*                                                                 09400000
129600 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  09410000
129700                                                                  09420000
129800     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              09430000
129900     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             09440000
130000     INITIALIZE DP013-SRC-TASK-NUMBER                             09450000
130100                DP013-STACK.                                      09460000
130200     SET DP013-LINK-RETURN TO TRUE.                               09470000
130300                                                                  09480000
130400     EXEC CICS                                                    09490000
130500         LINK                                                     09500000
130600             PROGRAM   (DP013-NAME)                               09510000
130700             COMMAREA  (DP013-PARAMETERS)                         09520000
130800             LENGTH    (DP013-LENGTH)                             09530000
130900     END-EXEC.                                                    09540000
131000                                                                  09550000
131100*                                                                 09560000
131200*----------------------------------------------------------------*09570000
131300*    GET LOGON INFORMATION FOR NON-ARCHITECTURE PROGRAMS         *09580000
131400*----------------------------------------------------------------*09590000
131500                                                                  09600000
131600     COPY DPPD026.                                                09610000
131700                                                                  09620000
131800*                                                                 09630000
131900*----------------------------------------------------------------*09640000
132000*    ABEND PROCESSOR MODULE                                      *09650000
132100*----------------------------------------------------------------*09660000
132200                                                                  09670000
132300     COPY DPPD014.                                                09680000
132400                                                                  09690000
