000100 PROCESS DATA(24)                                                 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*                                                                 00030000
000400 PROGRAM-ID.             MPKCS019.                                00040000
000500 AUTHOR.                 WILLIAM B. BURT.                         00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN            MARCH, 1990.                             00070000
000800 DATE-COMPILED.                                                   00080000
001000******************************************************************00100000
001001* TO GET TO THIS SCREEN SELECT THE MERCHANIDSE ID OPTION FROM     00090000
001002* THE MAIN MENU, THEN OPTION 1                                    00090000
001003******************************************************************00100000
001100* THIS PROGRAM DISPLAYS A SCREEN WHICH IS USED TO VERIFY TICKET   00110000
001200* INFORMATION ON A BAR CODED TICKET.  SKU INFORMATION, RELATED TO 00120000
001300* A CODE, IS DISPLAYED UPON SCANNING A BAR CODE AND PRESSING EN-  00130000
001400* TER.  DATA DISPLAYED IS FROM THE SKU TABLE AND IS USED TO VERIFY00140000
001500* THAT INFORMATION PRINTED ON THE TICKET MATCHES THE INFORMATION  00150000
001600* RELATED TO THAT SKU ON THE SKU TABLE.                           00160000
001700******************************************************************00170000
001700* CHANGED 02/14/2023   JEAN KURK              CHG0281369         *00170000
001700*               MAKE CALL TO UPC CHECK DIGIT ROUTINE DYNAMIC     *00170000
001700******************************************************************00170000
001800*                                                                 00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000*                                                                 00200000
002100 DATA DIVISION.                                                   00210000
002200*                                                                 00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400*                                                                 00240000
002410*----------------------------------------------------------------*00241000
002420*  DECREASED LENGTH OF CA-SKU AND REMOVED CA-VNDR-IN-HSE-NMBR.   *00242000
002421*  ADDED NEW CA VARIABLES CA-DEPT, CA-MAJ-CLASS AND CA-SUB-CLASS *00242100
002423*                                               **   WR # 21361  *00242300
002430*----------------------------------------------------------------*00243000
002500 01  CA-COMMAREA.                                                 00250000
002600     05  FILLER                          PIC  X(01)  VALUE SPACE. 00260000
002700     05  CA-UPC-CODE-NUMERIC             PIC  9(12)  VALUE ZERO.  00270000
002800     05  FILLER REDEFINES CA-UPC-CODE-NUMERIC.                    00280000
002900         10  CA-SYSTEM-IDENTIFIER        PIC  X(01).              00290000
003000         10  CA-VENDOR-NMBR              PIC  X(05).              00300000
003100         10  CA-ITEM-NMBR                PIC  X(05).              00310000
003200         10  CA-CHECK-DIGIT              PIC  X(01).              00320000
003500     05  CA-SKU                          PIC  X(08)  VALUE SPACE. 00350000
003700     05  CA-CUR-UNIT-RTL-AMT             PIC 9(05)V9(02)          00370000
003800                                                     VALUE ZERO.  00380000
003900     05  CA-VENDOR-STYLE-CODE            PIC  X(15)  VALUE SPACE. 00390000
004000     05  CA-SKU-DESC                     PIC  X(25)  VALUE SPACE. 00400000
004100     05  CA-SIZE-DESC                    PIC  X(05)  VALUE SPACE. 00410000
004200     05  CA-COLOR-DESC                   PIC  X(04)  VALUE SPACE. 00420000
004600     05  CA-RETURN-TRANID                PIC  X(04)  VALUE SPACE. 00460000
004700     05  CA-STATUS-CODE                  PIC  9(02)  VALUE ZERO.  00470000
004800         88  CA-STATUS-10                            VALUE 10.    00480000
004900         88  CA-STATUS-20                            VALUE 20.    00490000
005000         88  CA-STATUS-30                            VALUE 30.    00500000
005100         88  CA-STATUS-40                            VALUE 40.    00510000
005200         88  CA-STATUS-90                            VALUE 90.    00520000
005300     05  CA-STATUS-DESC                  PIC  X(16)  VALUE SPACES.00530000
005400     05  CA-TICKET-COLOR                 PIC  X(13)  VALUE SPACES.00540000
005500     05  CA-GP-QTY                       PIC  9(03)  VALUE ZERO.  00550000
005600     05  CA-GP-RTL                       PIC  9(05)V99            00560000
005700                                                     VALUE ZERO.  00570000
005900     05  CA-DEPT                         PIC  9(04)  VALUE ZERO.  00590000
006000     05  CA-MAJ-CLASS                    PIC  9(04)  VALUE ZERO.  00600000
006100     05  CA-SUB-CLASS                    PIC  9(04)  VALUE ZERO.  00610000
006200*----------------------------------------------------------------*00620000
006210* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *00621000
006220*----------------------------------------------------------------*00622000
006300*                                                                 00630000
006400 01  PC-PROGRAM-CONSTANTS.                                        00640000
006500     05  PC-QUESTION-MARK.                                        00650000
006600         10  FILLER                      PIC  X(01)  VALUE '?'.   00660000
006700         10  FILLER                      PIC  X(05)  VALUE        00670000
006800                                                     LOW-VALUE.   00680000
006900     05  PC-TRANID                       PIC  X(04)  VALUE 'M019'.00690000
007000     05  PC-MENU-TRANID                  PIC  X(04)  VALUE 'M018'.00700000
007100     05  PC-BARK-MENU-TRANID             PIC  X(04)  VALUE 'BARK'.00710000
007200     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +2     00720000
007300                                                     COMP SYNC.   00730000
007400     05  PC-INTRNL-UPC-CODE-IDENTIFIER   PIC  9(01)  VALUE 4.     00740000
007500     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00750000
007600                                                     COMP SYNC.   00760000
007610*----------------------------------------------------------------*00761000
007620*  INCREASED COMMAREA LENGTH FROM 127 TO 134    **   WR # 21361  *00762000
007630*----------------------------------------------------------------*00763000
007900     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +134   00790000
008000                                                     COMP SYNC.   00800000
008010*----------------------------------------------------------------*00801000
008020* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *00802000
008030*----------------------------------------------------------------*00803000
008200     05  PC-RESOURCE                     PIC  X(04)  VALUE 'CSSL'.00820000
008300     05  PC-RESOURCE-LENGTH              PIC S9(04)  VALUE +4     00830000
008400                                                     COMP SYNC.   00840000
008500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00850000
008600         'MPKCS019'.                                              00860000
009500*                                                                 00950000
009600 01  PS-PROGRAM-SWITCHES.                                         00960000
009700     05  PS-INVALID-UPC-IND              PIC  X(01)  VALUE 'N'.   00970000
009800         88  PS-INVALID-UPC                          VALUE 'Y'.   00980000
010800*                                                                 01080000
010810*----------------------------------------------------------------*01081000
010820*  REMOVED PV-FORMATTED-SKU GROUP ITEM AND ADDED                 *01082000
010821*  NEW VARIABLES.                               **   WR # 21361  *01082100
010830*----------------------------------------------------------------*01083000
010900 01  PV-PROGRAM-VARIABLES.                                        01090000
011000     05  PV-MESSAGE-AREA                 PIC  X(80)  VALUE SPACE. 01100000
011100     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZERO   01110000
011200                                                     COMP SYNC.   01120000
011300     05  PV-UPC-CHECK-DIGIT-MESSAGE.                              01130000
011400         10  FILLER                      PIC  X(38)  VALUE        01140000
011500             'UPC CHECK DIGIT INCORRECT.  SHOULD BE '.            01150000
011600         10  PV-COMPUTED-UPC-CHECK-DIGIT                          01160000
011700                                         PIC  9(01)  VALUE ZERO.  01170000
011800         10  FILLER                      PIC  X(40)  VALUE        01180000
011900             ', PLEASE RE-ENTER                       '.          01190000
012000     05  PV-UPC-CODE                     PIC S9(15)  VALUE ZERO   01200000
012100                                                     COMP-3.      01210000
013000     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE +0     01300000
013100                                                     COMP SYNC.   01310000
013200     05  PV-GP-QTY-RTL.                                           01320000
013300         10  PV-GP-QTY                   PIC ZZ9     VALUE ZERO.  01330000
013400         10  PV-GP-SLASH                 PIC X       VALUE '/'.   01340000
013500         10  PV-GP-RTL-AMT               PIC ZZZZZ.99             01350000
013600                                                     VALUE ZERO.  01360000
013800     05  PV-SIZE-NRF-SIZE-CDE            PIC S9(9) COMP           01380000
013810                                                     VALUE ZERO.  01381000
013900     05  PV-SIZE-KOHLS-DESC              PIC S9(9) COMP           01390000
013910                                                     VALUE ZERO.  01391000
014000     05  PV-SIZE-KOHLS-DESC-X            PIC X(5) VALUE SPACES.   01400000
014010     05  PV-DEPT-CLASS.                                           01401000
014100         10  PV-MERCH-DEPT-NMBR          PIC 9(4) VALUE ZERO.     01410000
014110         10  FILLER                      PIC X(1) VALUE SPACES.         00
014200         10  PV-MERCH-MAJ-CLASS-NMBR     PIC 9(4) VALUE ZERO.     01420000
014201         10  FILLER                      PIC X(1) VALUE SPACES.         00
014210         10  PV-MERCH-SUB-CLASS-NMBR     PIC 9(4) VALUE ZERO.     01421000
014300     05  PV-SEQ-NMBR                     PIC X(8) VALUE SPACES.   01430000
014400     05  PV-CUR-UNIT-RTL-AMT             PIC S9(5)V9(2) COMP-3    01440000
014410                                                     VALUE ZERO.  01441000
014500     05  PV-VENDOR-STYLE-CODE            PIC X(15) VALUE SPACES.  01450000
014600     05  PV-STATUS-CODE                  PIC S9(3)V COMP-3        01460000
014610                                                     VALUE ZERO.  01461000
014700     05  PV-SKU-DESC                     PIC X(25) VALUE SPACES.  01470000
014800     05  PV-SIZE-DESC                    PIC X(10) VALUE SPACES.  01480000
014900     05  PV-COLOR-DESC                   PIC X(4) VALUE SPACES.   01490000
015000     05  PV-GP-QTY-TEMP                  PIC S9(3)V COMP-3        01500000
015010                                                     VALUE ZERO.  01501000
015100     05  PV-GP-RTL-AMT-TEMP              PIC S9(5)V9(2) COMP-3    01510000
015110                                                     VALUE ZERO.  01511000
015200     05  PV-LONG-SIZE-DESC               PIC X(20) VALUE SPACES.  01520000
015300     05  PV-LONG-COLOR-DESC              PIC X(20) VALUE SPACES.  01530000
015400     05  PV-SIZE-CDE                     PIC X(5) VALUE SPACES.   01540000
015410     05  DK-CURRENT-DATE                 PIC X(10) VALUE SPACES.          
015500*----------------------------------------------------------------*01550000
015510* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01551000
015520*----------------------------------------------------------------*01552000
015600*                                                                 01560000
015700 01  ST-SYSTEM-TIME-AREA.                                         01570000
015800     05  ST-ABSTIME                      PIC S9(16)  VALUE +0     01580000
015900                                                     COMP SYNC.   01590000
016000     05  ST-TIME-EDIT.                                            01600000
016100         10  ST-TIME-HHMM                PIC  X(05)  VALUE SPACE. 01610000
016200         10  FILLER                      PIC  X(03)  VALUE SPACE. 01620000
016300*----------------------------------------------------------------*01630000
016400*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 21361  *01640000
016500*----------------------------------------------------------------*01650000
016600     COPY XLWS001.                                                01660000
016700*----------------------------------------------------------------*01670000
016800* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01680000
016900*----------------------------------------------------------------*01690000
017000                                                                  01700000
017100*                                                                 01710000
017200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01720000
017300*                                                                 01730000
017400     COPY DPWS013.                                                01740000
017500                                                                  01750000
017600*                                                                 01760000
017700*  THE SYMBOLIC DESCRIPTION MAP                                   01770000
017800*                                                                 01780000
017900     COPY MPKM019.                                                01790000
018000                                                                  01800000
018100*                                                                 01810000
018200*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01820000
018300*                                                                 01830000
018400     COPY DPWS015.                                                01840000
018500                                                                  01850000
018600*                                                                 01860000
018700*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01870000
018800*                                                                 01880000
018900     COPY DFHAID.                                                 01890000
019000                                                                  01900000
022400*                                                                 02240000
022500*  UPC PARAMETER LIST FOR CALLING THE UPC CHECK DIGIT ROUTINE.    02250000
022600*                                                                 02260000
022700     COPY DPWS040I.                                               02270000
022800                                                                  02280000
022810     EXEC SQL                                                     01910013
022820        INCLUDE SQLCA                                             01920013
022830     END-EXEC.                                                    01930013
022840     EXEC SQL                                                     01910013
022850        INCLUDE TCOCNTL                                           01920013
022860     END-EXEC.                                                    01930013
022900******************************************************************02290000
023000 LINKAGE SECTION.                                                 02300000
023100******************************************************************02310000
023200 01  DFHCOMMAREA                   PIC  X(96).                    02320000
023300                                                                  02330000
023400******************************************************************02340000
023500 PROCEDURE DIVISION.                                              02350000
023600******************************************************************02360000
023700 0000-PROGRAM-MAINLINE.                                           02370000
023800     MOVE DFHCOMMAREA TO CA-COMMAREA.                             02380000
023900     MOVE LOW-VALUES  TO MP019AI.                                 02390000
024000                                                                  02400000
024100     EVALUATE TRUE                                                02410000
024200         WHEN EIBCALEN = ZERO                                     02420000
024300             MOVE 'INVALID ENTRY INTO UPC TICKET VERIFICATION SCRE02430000
024400-                  'EN - PLEASE ENTER THROUGH MENU'               02440000
024500                 TO PV-MESSAGE-AREA                               02450000
024600             PERFORM 8300-RETURN                                  02460000
024700         WHEN EIBTRNID = PC-MENU-TRANID                           02470000
024800         WHEN EIBTRNID = PC-BARK-MENU-TRANID                      02480000
024900             PERFORM 2100-UPDATE-SCREEN-HEADER                    02490000
025000             PERFORM 8000-SEND-MAP                                02500000
025100             INITIALIZE CA-COMMAREA                               02510000
025200             PERFORM 8400-SETUP-RETURN-TRANID                     02520000
025300             PERFORM 8200-RETURN-TRANID                           02530000
025400         WHEN EIBAID = DFHENTER                                   02540000
025500             PERFORM 1000-RECEIVE-MAP                             02550000
025600             PERFORM 1100-EDIT-UPC                                02560000
025700             PERFORM 1200-VALIDATE-CHECK-DIGIT                    02570000
026100*----------------------------------------------------------------*02610000
026200*                                               **   WR # 21361  *02620000
026300* INITIALIZED XL001-ITEM-COMMAREA.                               *02630000
026310* REMOVED CALL TO 1300-DETERMINE-ITEM-NMBR AND                   *02631000
026320*                 7100-SELECT-SKUINFO-BY-ITEMNBR PARAGRAPHS      *02632000
026400* ADDED CODE TO CALL XLKUT001.                                   *02640000
026500*----------------------------------------------------------------*02650000
026600                                                                  02660000
027000             PERFORM 1350-CALL-XLKUT-DOMAIN-PGM                   02700000
027200                                                                  02720000
027300*----------------------------------------------------------------*02730000
027400* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02740000
027500*----------------------------------------------------------------*02750000
027600             PERFORM 1400-FILL-MAP-AND-COMMAREA                   02760000
027700             PERFORM 2100-UPDATE-SCREEN-HEADER                    02770000
027800             MOVE -1 TO ASYSIDL                                   02780000
027900             PERFORM 8100-SEND-DATA-ONLY                          02790000
028000             PERFORM 8200-RETURN-TRANID                           02800000
028100         WHEN EIBAID = DFHPF3                                     02810000
028200             PERFORM 2200-XCTL-TO-MENU                            02820000
028300         WHEN EIBAID = DFHCLEAR                                   02830000
028400             PERFORM 2100-UPDATE-SCREEN-HEADER                    02840000
028500             PERFORM 8000-SEND-MAP                                02850000
028600             PERFORM 8200-RETURN-TRANID                           02860000
028700         WHEN OTHER                                               02870000
028800             MOVE 'UNRECOGNIZED PF KEY' TO AERRMSGO               02880000
028900             PERFORM 2100-UPDATE-SCREEN-HEADER                    02890000
029000             MOVE -1 TO ASYSIDL                                   02900000
029100             PERFORM 8100-SEND-DATA-ONLY                          02910000
029200             PERFORM 8200-RETURN-TRANID                           02920000
029300     END-EVALUATE.                                                02930000
029400                                                                  02940000
029500     GOBACK.                                                      02950000
029600*                                                                 02960000
029700 1000-RECEIVE-MAP.                                                02970000
029800     EXEC CICS                                                    02980000
029900         RECEIVE MAP    ('MP019A')                                02990000
030000                 MAPSET ('MPKM019')                               03000000
030100                 RESP   (PV-CICS-RESPONSE)                        03010000
030200     END-EXEC.                                                    03020000
030300                                                                  03030000
030400     EVALUATE TRUE                                                03040000
030500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03050000
030600             CONTINUE                                             03060000
030700         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                03070000
030800             PERFORM 2000-MAPFAIL                                 03080000
030900         WHEN OTHER                                               03090000
031000            MOVE '1000-RECEIVE-MAP'                               03100000
031100                TO DP013-PARAGRAPH                                03110000
031200            SET DP013-LOGIC-ABEND TO TRUE                         03120000
031300            MOVE 'UNABLE TO FIND COMMAREA FOR CALLING TRANSACTION'03130000
031400                TO DP013-MESSAGE-TEXT (1)                         03140000
031500            PERFORM 9999-ABEND                                    03150000
031600     END-EVALUATE.                                                03160000
031700*                                                                 03170000
031800 1100-EDIT-UPC.                                                   03180000
031900     IF  ACKDGTL = ZERO                                           03190000
032000         MOVE 'UPC NOT VALID -- PLEASE ENTER'                     03200000
032100                                        TO AERRMSGO               03210000
032200         MOVE PC-QUESTION-MARK          TO ACKDGTO                03220000
032300         MOVE DP015-UNP-NUM-BRT-OFF     TO ACKDGTA                03230000
032400         MOVE DP015-RED                 TO ACKDGTC                03240000
032500         MOVE DP015-REVERSE             TO ACKDGTH                03250000
032600         MOVE -1                        TO ACKDGTL                03260000
032700         SET PS-INVALID-UPC             TO TRUE                   03270000
032800     ELSE                                                         03280000
032900         IF  ACKDGTI NOT NUMERIC                                  03290000
033000             MOVE 'UPC NOT NUMERIC -- PLEASE RE-ENTER'            03300000
033100                                        TO AERRMSGO               03310000
033200             MOVE DP015-UNP-NUM-BRT-MDT TO ACKDGTA                03320000
033300             MOVE DP015-RED             TO ACKDGTC                03330000
033400             MOVE DP015-REVERSE         TO ACKDGTH                03340000
033500             MOVE -1                    TO ACKDGTL                03350000
033600             SET PS-INVALID-UPC         TO TRUE                   03360000
033700         ELSE                                                     03370000
033800             MOVE DP015-UNP-NUM-NOR-MDT TO ACKDGTA                03380000
033900             MOVE DP015-GREEN           TO ACKDGTC                03390000
034000             MOVE DP015-UNDERLINE       TO ACKDGTH                03400000
034100         END-IF                                                   03410000
034200     END-IF.                                                      03420000
034300                                                                  03430000
034400     IF  AITMNBRL = ZERO                                          03440000
034500         MOVE 'UPC NOT VALID -- PLEASE ENTER'                     03450000
034600                                        TO AERRMSGO               03460000
034700         MOVE PC-QUESTION-MARK          TO AITMNBRO               03470000
034800         MOVE DP015-UNP-NUM-BRT-OFF     TO AITMNBRA               03480000
034900         MOVE DP015-RED                 TO AITMNBRC               03490000
035000         MOVE DP015-REVERSE             TO AITMNBRH               03500000
035100         MOVE -1                        TO AITMNBRL               03510000
035200         SET PS-INVALID-UPC             TO TRUE                   03520000
035300     ELSE                                                         03530000
035400         IF  AITMNBRI NOT NUMERIC                                 03540000
035500             MOVE 'UPC NOT NUMERIC -- PLEASE RE-ENTER'            03550000
035600                                        TO AERRMSGO               03560000
035700             MOVE DP015-UNP-NUM-BRT-MDT TO AITMNBRA               03570000
035800             MOVE DP015-RED             TO AITMNBRC               03580000
035900             MOVE DP015-REVERSE         TO AITMNBRH               03590000
036000             MOVE -1                    TO AITMNBRL               03600000
036100             SET PS-INVALID-UPC         TO TRUE                   03610000
036200         ELSE                                                     03620000
036300             MOVE DP015-UNP-NUM-NOR-MDT TO AITMNBRA               03630000
036400             MOVE DP015-GREEN           TO AITMNBRC               03640000
036500             MOVE DP015-UNDERLINE       TO AITMNBRH               03650000
036600         END-IF                                                   03660000
036700     END-IF.                                                      03670000
036800                                                                  03680000
036900     IF  AVDRNBRL = ZERO                                          03690000
037000         MOVE 'UPC NOT VALID -- PLEASE ENTER'                     03700000
037100                                        TO AERRMSGO               03710000
037200         MOVE PC-QUESTION-MARK          TO AVDRNBRO               03720000
037300         MOVE DP015-UNP-NUM-BRT-OFF     TO AVDRNBRA               03730000
037400         MOVE DP015-RED                 TO AVDRNBRC               03740000
037500         MOVE DP015-REVERSE             TO AVDRNBRH               03750000
037600         MOVE -1                        TO AVDRNBRL               03760000
037700         SET PS-INVALID-UPC             TO TRUE                   03770000
037800     ELSE                                                         03780000
037900         IF  AVDRNBRI NOT NUMERIC                                 03790000
038000             MOVE 'UPC NOT NUMERIC -- PLEASE RE-ENTER'            03800000
038100                                        TO AERRMSGO               03810000
038200             MOVE DP015-UNP-NUM-BRT-MDT TO AVDRNBRA               03820000
038300             MOVE DP015-RED             TO AVDRNBRC               03830000
038400             MOVE DP015-REVERSE         TO AVDRNBRH               03840000
038500             MOVE -1                    TO AVDRNBRL               03850000
038600             SET PS-INVALID-UPC         TO TRUE                   03860000
038700         ELSE                                                     03870000
038800             MOVE DP015-UNP-NUM-NOR-MDT TO AVDRNBRA               03880000
038900             MOVE DP015-GREEN           TO AVDRNBRC               03890000
039000             MOVE DP015-UNDERLINE       TO AVDRNBRH               03900000
039100         END-IF                                                   03910000
039200     END-IF.                                                      03920000
039300                                                                  03930000
039400     IF  ASYSIDL = ZERO                                           03940000
039500         MOVE 'UPC NOT VALID -- PLEASE ENTER'                     03950000
039600                                        TO AERRMSGO               03960000
039700         MOVE PC-QUESTION-MARK          TO ASYSIDO                03970000
039800         MOVE DP015-UNP-NUM-BRT-OFF     TO ASYSIDA                03980000
039900         MOVE DP015-RED                 TO ASYSIDC                03990000
040000         MOVE DP015-REVERSE             TO ASYSIDH                04000000
040100         MOVE -1                        TO ASYSIDL                04010000
040200         SET PS-INVALID-UPC             TO TRUE                   04020000
040300     ELSE                                                         04030000
040400         IF  ASYSIDI NOT NUMERIC                                  04040000
040500             MOVE 'UPC NOT NUMERIC -- PLEASE RE-ENTER'            04050000
040600                                        TO AERRMSGO               04060000
040700             MOVE DP015-UNP-NUM-BRT-MDT TO ASYSIDA                04070000
040800             MOVE DP015-RED             TO ASYSIDC                04080000
040900             MOVE DP015-REVERSE         TO ASYSIDH                04090000
041000             MOVE -1                    TO ASYSIDL                04100000
041100             SET PS-INVALID-UPC         TO TRUE                   04110000
041200         ELSE                                                     04120000
041300             MOVE DP015-UNP-NUM-BRT-MDT TO ASYSIDA                04130000
041400             MOVE DP015-GREEN           TO ASYSIDC                04140000
041500             MOVE DP015-UNDERLINE       TO ASYSIDH                04150000
041600         END-IF                                                   04160000
041700     END-IF.                                                      04170000
041800                                                                  04180000
041900     IF PS-INVALID-UPC                                            04190000
042000         PERFORM 8100-SEND-DATA-ONLY                              04200000
042100         PERFORM 8200-RETURN-TRANID                               04210000
042200     END-IF.                                                      04220000
042300*                                                                 04230000
042400 1200-VALIDATE-CHECK-DIGIT.                                       04240000
042500     INITIALIZE DP040I-UPC-CHECK-DIGIT-PARMS.                     04250000
042600     SET DP040I-COMP-CHECK-DIGIT-OPTION  TO TRUE.                 04260000
042700     MOVE ASYSIDI                        TO CA-SYSTEM-IDENTIFIER. 04270000
042800     MOVE AVDRNBRI                       TO CA-VENDOR-NMBR.       04280000
042900     MOVE AITMNBRI                       TO CA-ITEM-NMBR.         04290000
043000     MOVE ACKDGTI                        TO CA-CHECK-DIGIT.       04300000
043100                                                                  04310000
043200     IF CA-UPC-CODE-NUMERIC = ZERO                                04320000
043300         MOVE 'UPC NOT VALID -- PLEASE ENTER'                     04330000
043400                                         TO AERRMSGO              04340000
043500         MOVE DP015-UNP-NUM-BRT-MDT      TO ACKDGTA               04350000
043600                                            AITMNBRA              04360000
043700                                            AVDRNBRA              04370000
043800                                            ASYSIDA               04380000
043900         MOVE DP015-RED                  TO ACKDGTC               04390000
044000                                            AITMNBRC              04400000
044100                                            AVDRNBRC              04410000
044200                                            ASYSIDC               04420000
044300         MOVE DP015-REVERSE              TO ACKDGTH               04430000
044400                                            AITMNBRH              04440000
044500                                            AVDRNBRH              04450000
044600                                            ASYSIDH               04460000
044700         PERFORM 2100-UPDATE-SCREEN-HEADER                        04470000
044800         PERFORM 8000-SEND-MAP                                    04480000
044900         PERFORM 8200-RETURN-TRANID                               04490000
045000     ELSE                                                         04500000
045100         MOVE CA-UPC-CODE-NUMERIC        TO DP040I-UPC-CODE       04510000
045200                                            PV-UPC-CODE           04520000
045300     END-IF.                                                      04530000
045400                                                                  04540000
045500     CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          04550000
045500                     USING DP040I-UPC-CHECK-DIGIT-PARMS.          04550000
045600                                                                  04560000
045700     IF DP040I-COMPUTED-UPC-CHK-DIGIT = DP040I-UPC-CHECK-DIGIT    04570000
045800         CONTINUE                                                 04580000
045900     ELSE                                                         04590000
046000         MOVE DP040I-COMPUTED-UPC-CHK-DIGIT                       04600000
046100             TO PV-COMPUTED-UPC-CHECK-DIGIT                       04610000
046200         MOVE DP015-UNP-NUM-BRT-MDT      TO ACKDGTA               04620000
046300         MOVE DP015-RED                  TO ACKDGTC               04630000
046400         MOVE DP015-REVERSE              TO ACKDGTH               04640000
046500         MOVE -1                         TO ACKDGTL               04650000
046600         MOVE PV-UPC-CHECK-DIGIT-MESSAGE TO AERRMSGO              04660000
046700         PERFORM 8100-SEND-DATA-ONLY                              04670000
046800         PERFORM 8200-RETURN-TRANID                               04680000
046900     END-IF.                                                      04690000
049600*----------------------------------------------------------------*04960000
049700*                                               **   WR # 21361  *04970000
049800* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *04980000
049900*----------------------------------------------------------------*04990000
050000 1350-CALL-XLKUT-DOMAIN-PGM.                                      05000000
050100                                                                  05010000
050200     INITIALIZE XL001-ITEM-COMMAREA.                              02670000
050400     MOVE PV-UPC-CODE          TO XL001-KEY-UPC-NBR.              05040000
050500                                                                  05050000
050600     SET  XL001-BY-UPC-NBR                                        05060000
050700          XL001-SELECT-UPC                                        05070000
050800          XL001-SELECT-SKU                                        05080000
050900          XL001-SELECT-VND-STYL                                   05090000
051000          XL001-SELECT-SKU-STR    TO TRUE.                        05100000
051100                                                                  05110000
051200     CALL XL001-VSM-PGM USING  DFHEIBLK                           05120000
051201                               XL001-COMMAREA                     05120100
051202                               XL001-ITEM-COMMAREA.               05120200
051210                                                                  05121000
051300     EVALUATE TRUE                                                05130000
051400         WHEN XL001-UPC-CONTENTION                                05140000
051500              CONTINUE                                            05150000
051600         WHEN XL001-UPC-NOT-FOUND                                 05160000
051700         WHEN XL001-UPC-SQLCODE = ZERO                            05170000
051800              PERFORM 1355-DETERMINE-ITEM-NMBR                    05180000
051900         WHEN XL001-UPC-SQLCODE > ZERO                            05190000
052000         WHEN XL001-UPC-SQLCODE < ZERO                            05200000
052100              MOVE '1350-CALL-XLKUT-DOMAIN-PGM'                   05210000
052200                   TO DP013-PARAGRAPH                             05220000
052300              MOVE 'SELECT AN ITEM NMBR FOR THE FOLLOWING UPC:'   05230000
052400                   TO DP013-MESSAGE-TEXT (1)                      05240000
052500              MOVE PV-UPC-CODE                                    05250000
052600                   TO DP013-MESSAGE-TEXT (2)                      05260000
052800              MOVE 'XLV_UPC'       TO DP013-DB2-TABLE-NAME (1)    05280000
052900              SET DP013-DB2-ABEND  TO TRUE                        05290000
053000              PERFORM 9999-ABEND.                                 05300000
053010                                                                  05301000
053020         EXEC SQL                                                         
053030             SELECT CURRENT DATE                                          
053031             INTO  :DK-CURRENT-DATE                                       
053032             FROM   TCOCNTL                                               
053050         END-EXEC.                                                        
053060                                                                          
053100 1355-DETERMINE-ITEM-NMBR.                                        05310000
053110                                                                  05311000
053200         EVALUATE TRUE                                            05320000
053300           WHEN XL001-UPC-SQLCODE = ZERO                          05330000
053400                PERFORM 1360-GETSKU-INFO                          05340000
053500           WHEN XL001-UPC-SQLCODE = PC-ROW-NOT-FOUND              05350000
053600                MOVE 'UPC NOT FOUND'       TO AERRMSGO            05360000
053700                MOVE DP015-UNP-NUM-BRT-MDT TO ACKDGTA             05370000
053800                                              AITMNBRA            05380000
053900                                              AVDRNBRA            05390000
054000                                              ASYSIDA             05400000
054100                MOVE DP015-RED             TO ACKDGTC             05410000
054200                                              AITMNBRC            05420000
054300                                              AVDRNBRC            05430000
054400                                              ASYSIDC             05440000
054500                MOVE DP015-REVERSE         TO ACKDGTH             05450000
054600                                              AITMNBRH            05460000
054700                                              AVDRNBRH            05470000
054800                                              ASYSIDH             05480000
054900                PERFORM 2100-UPDATE-SCREEN-HEADER                 05490000
055000                PERFORM 8000-SEND-MAP                             05500000
055100                PERFORM 8200-RETURN-TRANID                        05510000
055200        END-EVALUATE.                                             05520000
055210                                                                  05521000
055300 1360-GETSKU-INFO.                                                05530000
055310                                                                  05531000
055400        EVALUATE TRUE                                             05540000
055500          WHEN XL001-SKU-CONTENTION                               05550000
055600               CONTINUE                                           05560000
055700          WHEN XL001-SKU-NOT-FOUND                                05570000
055800               MOVE 'UPC NOT ASSOCIATED WITH A SKU -- CONTACT DP' 05580000
055810                                          TO  AERRMSGO            05581000
055820               MOVE DP015-UNP-NUM-BRT-MDT TO  ACKDGTA             05582000
055830                                              AITMNBRA            05583000
055840                                              AVDRNBRA            05584000
055850                                              ASYSIDA             05585000
055860                MOVE DP015-RED             TO ACKDGTC             05586000
055870                                              AITMNBRC            05587000
055880                                              AVDRNBRC            05588000
055890                                              ASYSIDC             05589000
055891                MOVE DP015-REVERSE         TO ACKDGTH             05589100
055892                                              AITMNBRH            05589200
055893                                              AVDRNBRH            05589300
055894                                              ASYSIDH             05589400
055895                PERFORM 2100-UPDATE-SCREEN-HEADER                 05589500
055896                PERFORM 8000-SEND-MAP                             05589600
055897                PERFORM 8200-RETURN-TRANID                        05589700
055898           WHEN XL001-SKU-SQLCODE = ZERO                          05589800
055899                MOVE XL001-SKU-NBR          TO PV-SEQ-NMBR        05589900
055900                MOVE XL001-SKU-DESC         TO PV-SKU-DESC        05590000
055901                MOVE XL001-SIZE-DESC        TO PV-SIZE-DESC       05590100
055902                MOVE XL001-SIZE-DESC        TO PV-LONG-SIZE-DESC  05590200
055903                MOVE XL001-SHRT-CLOR-DESC   TO PV-COLOR-DESC      05590300
055904                MOVE XL001-CSTM-CLOR-DESC   TO PV-LONG-COLOR-DESC 05590400
055905                MOVE XL001-KOHLS-SIZE-CDE   TO PV-SIZE-CDE        05590500
055906                PERFORM 1375-VND-STYL-INFO                        05590600
055907           WHEN XL001-SKU-SQLCODE < ZERO                          05590700
055908           WHEN XL001-SKU-SQLCODE > ZERO                          05590800
055909                MOVE '1360-GETSKU-INFO'                           05590900
055910                     TO DP013-PARAGRAPH                           05591000
055911                MOVE 'SELECT SKU INFORMATION FOR THE FOLLOWING IT 05591100
055912-                    'EM NUMBER: '                                05591200
055913                     TO DP013-MESSAGE-TEXT (1)                    05591300
055914                MOVE XL001-ITM-NBR                                05591400
055915                     TO DP013-MESSAGE-TEXT (2)                    05591500
055917                MOVE 'XLV_SKU'      TO DP013-DB2-TABLE-NAME (1)   05591700
055918                SET DP013-DB2-ABEND TO TRUE                       05591800
055919                PERFORM 9999-ABEND                                05591900
055920        END-EVALUATE.                                             05592000
055921                                                                  05592100
055922 1375-VND-STYL-INFO.                                              05592200
055923                                                                  05592300
055924        EVALUATE TRUE                                             05592400
055925          WHEN XL001-VND-STYL-CONTENTION                          05592500
055926          WHEN XL001-VND-STYL-SQLCODE = +100                      05592600
055927               CONTINUE                                           05592700
055928          WHEN XL001-VND-STYL-SQLCODE = ZERO                      05592800
055929               MOVE XL001-DEPT-NBR         TO PV-MERCH-DEPT-NMBR  05592900
055930                                              CA-DEPT             05593000
055931               MOVE XL001-MAJ-CL-NBR       TO                     05593100
055932                                     PV-MERCH-MAJ-CLASS-NMBR      05593200
055933                                     CA-MAJ-CLASS                 05593300
055934               MOVE XL001-SUB-CL-NBR       TO                     05593400
055935                                     PV-MERCH-SUB-CLASS-NMBR      05593500
055936                                     CA-SUB-CLASS                 05593600
055938               MOVE XL001-VS-NBR           TO PV-VENDOR-STYLE-CODE05593800
055939               PERFORM 1380-SKU-STR-INFO                          05593900
055940          WHEN XL001-VND-STYL-SQLCODE < ZERO                      05594000
055941          WHEN XL001-VND-STYL-SQLCODE > ZERO                      05594100
055942               MOVE '1375-VND-STYL-INFO'                          05594200
055943                   TO DP013-PARAGRAPH                             05594300
055944               MOVE 'SELECT SKU INFORMATION FOR THE FOLLOWING IT  05594400
055945-                    'EM NUMBER: '                                05594500
055946                     TO DP013-MESSAGE-TEXT (1)                    05594600
055947               MOVE XL001-ITM-NBR                                 05594700
055948                    TO DP013-MESSAGE-TEXT (2)                     05594800
055950               MOVE 'XLV_VND_STYL' TO DP013-DB2-TABLE-NAME (1)    05595000
055951               SET DP013-DB2-ABEND TO TRUE                        05595100
055952               PERFORM 9999-ABEND                                 05595200
055953        END-EVALUATE.                                             05595300
055954                                                                  05595400
055955 1380-SKU-STR-INFO.                                               05595500
055956                                                                  05595600
055957        EVALUATE TRUE                                             05595700
055958          WHEN XL001-SKU-STR-CONTENTION                           05595800
055959          WHEN XL001-SKU-STR-SQLCODE = +100                       05595900
055960               CONTINUE                                           05596000
055961          WHEN XL001-SKU-STR-SQLCODE = ZERO                       05596100
055962               MOVE XL001-UNT-RTL-AMT      TO PV-CUR-UNIT-RTL-AMT 05596200
055963               MOVE XL001-STR-SKU-STAT-CDE TO PV-STATUS-CODE      05596300
055964               MOVE XL001-GP-QTY           TO PV-GP-QTY-TEMP      05596400
055965               MOVE XL001-GP-AMT           TO PV-GP-RTL-AMT-TEMP  05596500
055966          WHEN XL001-SKU-STR-SQLCODE < ZERO                       05596600
055967          WHEN XL001-SKU-STR-SQLCODE > ZERO                       05596700
055968               MOVE '1380-SKU-STR-INFO'                           05596800
055969                    TO DP013-PARAGRAPH                            05596900
055970               MOVE 'SELECT SKU INFORMATION FOR THE FOLLOWING IT  05597000
055971-                   'EM NUMBER: '                                 05597100
055972                    TO DP013-MESSAGE-TEXT (1)                     05597200
055973               MOVE XL001-ITM-NBR                                 05597300
055974                    TO DP013-MESSAGE-TEXT (2)                     05597400
055976               MOVE 'XLV_SKU_STR'  TO DP013-DB2-TABLE-NAME (1)    05597600
055977               SET DP013-DB2-ABEND TO TRUE                        05597700
055978               PERFORM 9999-ABEND                                 05597800
055979        END-EVALUATE.                                             05597900
055980*----------------------------------------------------------------*05598000
056000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *05600000
056100*----------------------------------------------------------------*05610000
056200 1400-FILL-MAP-AND-COMMAREA.                                      05620000
056210*----------------------------------------------------------------*05621000
056220*  REMOVED ALL TSK REFERENCES AND REPLACED WITH NEWLY            *05622000
056221*  INTRODUCED VARIABLES                                          *05622111
056237*                                                 **  WR # 21361 *05623800
056250*----------------------------------------------------------------*05625000
056300     MOVE SPACE                  TO  AERRMSGO.                    05630000
056910     MOVE PV-DEPT-CLASS          TO  ACLASSO.                     05691000
057000     MOVE PV-SEQ-NMBR            TO  CA-SKU                       05700000
057010                                     ASKUO.                       05701000
057100     MOVE  SPACE  TO XL001-SKU-STAT-CDE.                          05710000
060000         MOVE PV-CUR-UNIT-RTL-AMT                                 06000000
060100                                 TO  CA-CUR-UNIT-RTL-AMT          06010000
060200                                     ACURRTLO.                    06020000
060400         MOVE PV-VENDOR-STYLE-CODE                                06040000
060500                                 TO  CA-VENDOR-STYLE-CODE         06050000
060600                                     ASTYLEO.                     06060000
060800         MOVE PV-SKU-DESC        TO  CA-SKU-DESC                  06080000
060900                                     ADESCO.                      06090000
061000         IF PV-SIZE-DESC NOT = SPACES                             06100000
061100             MOVE PV-SIZE-DESC             TO CA-SIZE-DESC        06110000
061200                                              ASIZEO              06120000
061300         ELSE                                                     06130000
061600             IF PV-LONG-SIZE-DESC = SPACES                        06160000
061700                MOVE PV-SIZE-DESC       TO CA-SIZE-DESC           06170000
061800                                           ASIZEO                 06180000
061900             ELSE                                                 06190000
062000                MOVE PV-LONG-COLOR-DESC   TO CA-SIZE-DESC         06200000
062100                                             ASIZEO               06210000
062200             END-IF                                               06220000
062300         END-IF.                                                  06230000
062600         IF PV-LONG-COLOR-DESC   =  SPACES                        06260000
062700            MOVE PV-COLOR-DESC          TO  CA-COLOR-DESC         06270000
062800                                            ACOLORO               06280000
062900         ELSE                                                     06290000
063100            MOVE PV-LONG-COLOR-DESC     TO  CA-COLOR-DESC         06310000
063200                                            ACOLORO               06320000
063300         END-IF.                                                  06330000
063800         MOVE PV-STATUS-CODE     TO CA-STATUS-CODE.               06380000
063900         MOVE CA-STATUS-CODE     TO  ASTATUSO.                    06390000
064000         MOVE SPACES             TO  CA-TICKET-COLOR              06400000
064100                                     ATKTCLRO.                    06410000
064200         EVALUATE TRUE                                            06420000
064300             WHEN CA-STATUS-10                                    06430000
064400                  MOVE 'NEW             '                         06440000
064500                                 TO CA-STATUS-DESC                06450000
064600             WHEN CA-STATUS-20                                    06460000
064700                  MOVE 'ACTIVE          '                         06470000
064800                                 TO CA-STATUS-DESC                06480000
064900             WHEN CA-STATUS-30                                    06490000
065000                  MOVE 'YELLOW TICKET'                            06500000
065100                                 TO  CA-TICKET-COLOR              06510000
065200                                     ATKTCLRO                     06520000
065300                  MOVE 'CLEARANCE       '                         06530000
065400                                 TO CA-STATUS-DESC                06540000
065500             WHEN CA-STATUS-40                                    06550000
065600                  MOVE 'SPECIAL PURCHASE'                         06560000
065700                                 TO CA-STATUS-DESC                06570000
065800             WHEN CA-STATUS-90                                    06580000
065900                  MOVE 'DISCONTINUED    '                         06590000
066000                                 TO CA-STATUS-DESC                06600000
066100             WHEN OTHER                                           06610000
066200                  MOVE 'UNKNOWN STATUS  '                         06620000
066300                                 TO CA-STATUS-DESC                06630000
066400         END-EVALUATE.                                            06640000
066500         MOVE CA-STATUS-DESC     TO  ASTDESCO.                    06650000
067700         IF PV-GP-QTY-TEMP > 1                                    06770000
067800             MOVE PV-GP-QTY-TEMP TO  CA-GP-QTY                    06780000
067900                                     PV-GP-QTY                    06790000
068000             MOVE PV-GP-RTL-AMT-TEMP TO CA-GP-RTL                 06800000
068100                                     PV-GP-RTL-AMT                06810000
068200             MOVE PV-GP-QTY-RTL  TO  AGPRTLO                      06820000
068300         ELSE                                                     06830000
068400             MOVE ZERO           TO  CA-GP-QTY                    06840000
068500                                     CA-GP-RTL                    06850000
068600             MOVE SPACES         TO  AGPRTLO                      06860000
068700         END-IF.                                                  06870012
068800*    END-IF.                                                      06880000
068900*                                                                 06890000
069000 2000-MAPFAIL.                                                    06900000
069100     MOVE 'PLEASE ENTER A VALID UPC CODE' TO AERRMSGO.            06910000
069200     MOVE -1                              TO ASYSIDL.             06920000
069300     MOVE PC-QUESTION-MARK                TO ASYSIDO              06930000
069400                                             AVDRNBRO             06940000
069500                                             AITMNBRO             06950000
069600                                             ACKDGTO.             06960000
069700     MOVE DP015-UNP-NUM-BRT-OFF           TO ASYSIDA              06970000
069800                                             AVDRNBRA             06980000
069900                                             AITMNBRA             06990000
070000                                             ACKDGTA.             07000000
070100     MOVE DP015-RED                       TO ASYSIDC              07010000
070200                                             AVDRNBRC             07020000
070300                                             AITMNBRC             07030000
070400                                             ACKDGTC.             07040000
070500     MOVE DP015-REVERSE                   TO ASYSIDH              07050000
070600                                             AVDRNBRH             07060000
070700                                             AITMNBRH             07070000
070800                                             ACKDGTH.             07080000
070900     PERFORM 2100-UPDATE-SCREEN-HEADER.                           07090000
071000     PERFORM 8100-SEND-DATA-ONLY.                                 07100000
071100     PERFORM 8200-RETURN-TRANID.                                  07110000
071200*                                                                 07120000
071300 2100-UPDATE-SCREEN-HEADER.                                       07130000
071400     EXEC CICS                                                    07140000
071500         ASKTIME ABSTIME (ST-ABSTIME)                             07150000
071600     END-EXEC.                                                    07160000
071700                                                                  07170000
071800     EXEC CICS                                                    07180000
071900         FORMATTIME ABSTIME (ST-ABSTIME)                          07190000
072000                    MMDDYY  (ADATEO)                              07200000
072100                    DATESEP                                       07210000
072200                    TIME    (ST-TIME-EDIT)                        07220000
072300                    TIMESEP                                       07230000
072400     END-EXEC.                                                    07240000
072500                                                                  07250000
072600     MOVE ST-TIME-HHMM  TO ATIMEO.                                07260000
072700     MOVE EIBTRMID      TO ATERMO.                                07270000
072800*                                                                 07280000
072900 2200-XCTL-TO-MENU.                                               07290000
073000     IF CA-RETURN-TRANID = PC-MENU-TRANID                         07300000
073100         EXEC CICS                                                07310000
073200             XCTL  PROGRAM  ('MPKCS018')                          07320000
073300                   RESP     (PV-CICS-RESPONSE)                    07330000
073400         END-EXEC                                                 07340000
073500     ELSE                                                         07350000
073600         IF CA-RETURN-TRANID = PC-BARK-MENU-TRANID                07360000
073700             EXEC CICS                                            07370000
073800                 XCTL  PROGRAM  ('CMP210MO')                      07380000
073900                       RESP     (PV-CICS-RESPONSE)                07390000
074000             END-EXEC                                             07400000
074100         END-IF                                                   07410000
074200     END-IF.                                                      07420000
074300                                                                  07430000
074400     EVALUATE TRUE                                                07440000
074500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07450000
074600             CONTINUE                                             07460000
074700         WHEN OTHER                                               07470000
074800             MOVE '2200-XCTL-TO-MENU'                             07480000
074900                TO DP013-PARAGRAPH                                07490000
075000             SET DP013-CICS-ABEND TO TRUE                         07500000
075100             IF CA-RETURN-TRANID = PC-BARK-MENU-TRANID            07510000
075200                 MOVE 'UNABLE TO XCTL TO DISTRIBUTION CENTER MENU'07520000
075300                     TO DP013-MESSAGE-TEXT (1)                    07530000
075400             ELSE                                                 07540000
075500                 MOVE 'UNABLE TO XCTL TO MERCHANDISE IDENTIFICATIO07550000
075600-                     'N MENU'                                    07560000
075700                     TO DP013-MESSAGE-TEXT (1)                    07570000
075800             END-IF                                               07580000
075900             PERFORM 9999-ABEND                                   07590000
076000     END-EVALUATE.                                                07600000
076010*----------------------------------------------------------------*07601000
076100*                                                                *07610000
076200* REMOVED 7000-SELECT-ITEM-NMBR                                  *07620000
081800* REMOVED 7100-SELECT-SKUINFO-BY-ITEMNBR                         *08180000
092400* REMOVED 7200-GET-TSIZE-INFO                                    *09240000
095200* REMOVED 7300-GET-TSIZE-INFO                                    *09520000
095201*                                                 **  WR # 21361 *09831000
095202*----------------------------------------------------------------*09832000
098400 8000-SEND-MAP.                                                   09840000
098500     EXEC CICS                                                    09850000
098600         SEND MAP    ('MP019A')                                   09860000
098700              MAPSET ('MPKM019')                                  09870000
098800              ERASE                                               09880000
098900              FORMFEED                                            09890000
099000     END-EXEC.                                                    09900000
099100*                                                                 09910000
099200 8100-SEND-DATA-ONLY.                                             09920000
099300     EXEC CICS                                                    09930000
099400         SEND MAP       ('MP019A')                                09940000
099500              MAPSET    ('MPKM019')                               09950000
099600              CURSOR                                              09960000
099700              DATAONLY                                            09970000
099800              FORMFEED                                            09980000
099900     END-EXEC.                                                    09990000
100000*                                                                 10000000
100100 8200-RETURN-TRANID.                                              10010000
100200     EXEC CICS                                                    10020000
100300         RETURN TRANSID  (PC-TRANID)                              10030000
100400                COMMAREA (CA-COMMAREA)                            10040000
100500                LENGTH   (PC-COMMAREA-LENGTH)                     10050000
100600     END-EXEC.                                                    10060000
100700*                                                                 10070000
100800 8300-RETURN.                                                     10080000
100900     EXEC CICS                                                    10090000
101000         SEND FROM (PV-MESSAGE-AREA)                              10100000
101100              LENGTH (80)                                         10110000
101200              ERASE                                               10120000
101300     END-EXEC.                                                    10130000
101400                                                                  10140000
101500     EXEC CICS                                                    10150000
101600         RETURN                                                   10160000
101700     END-EXEC.                                                    10170000
101800*                                                                 10180000
101900 8400-SETUP-RETURN-TRANID.                                        10190000
102000     IF EIBTRNID = PC-MENU-TRANID                                 10200000
102100         MOVE PC-MENU-TRANID TO CA-RETURN-TRANID                  10210000
102200     ELSE                                                         10220000
102300         IF EIBTRNID = PC-BARK-MENU-TRANID                        10230000
102400             MOVE PC-BARK-MENU-TRANID TO CA-RETURN-TRANID         10240000
102500         END-IF                                                   10250000
102600     END-IF.                                                      10260000
102700                                                                  10270000
102800*                                                                 10280000
102900 9999-ABEND.                                                      10290000
103000     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              10300000
103100     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             10310000
103200     INITIALIZE DP013-SRC-TASK-NUMBER                             10320000
103300                DP013-STACK.                                      10330000
103400     SET DP013-XCTL-DISPLAY-LOGOFF TO TRUE.                       10340000
103500                                                                  10350000
103600     EXEC CICS                                                    10360000
103700         XCTL                                                     10370000
103800             PROGRAM   (DP013-NAME)                               10380000
103900             COMMAREA  (DP013-PARAMETERS)                         10390000
104000             LENGTH    (DP013-LENGTH)                             10400000
104100     END-EXEC.                                                    10410000
104200*                                                                 10420000
