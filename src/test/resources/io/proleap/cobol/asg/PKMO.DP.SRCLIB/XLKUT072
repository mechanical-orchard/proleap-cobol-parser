000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    XLKUT072.                                         00020001
000300 AUTHOR.        JOE LAROSA.                                       00030000
000400 DATE-WRITTEN.  DECEMBER, 2003.                                   00040001
000500****************************************************************  00050000
000600*        C L A S S   D O M A I N   S Y N C / E X T R A C T        00060001
000700*                                                                 00070000
000800* THIS PROGRAM COMPARES FIVE SETS OF FILES, CREATING A SINGLE     00080001
000900* COMBINED OUTFILE OF THE DIFFERENCES BETWEEN EACH SET OF FILES.  00090000
001000* THE PROGRAM WILL COMPARE FILES EXTRACTED FROM RMS AGAINST LIKE  00100001
001100* FILES EXTRACTED FROM THE DB2 DEPARTMENT CLASS DOMAIN TABLES.    00110001
001200*                                                                 00120000
001300* DIFFERENCES BETWEEN THE RMS & DB2 FILES WILL BE WRITTEN TO AN   00130000
001400* OUTPUT FILE AS EITHER AN ADD, DELETE OR UPDATE RECORD.          00140000
001500****************************************************************  00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800                                                                  00180000
001900 FILE-CONTROL.                                                    00190000
002000     SELECT RMS-BUS-AREA-FILE    ASSIGN TO INP01.                 00200002
002100     SELECT DB2-BUS-AREA-FILE    ASSIGN TO INP02.                 00210002
002200                                                                  00220000
002300     SELECT RMS-BUS-GRP-FILE     ASSIGN TO INP03.                 00230002
002400     SELECT DB2-BUS-GRP-FILE     ASSIGN TO INP04.                 00240002
002500                                                                  00250002
002600     SELECT RMS-DEPT-FILE        ASSIGN TO INP05.                 00260002
002700     SELECT DB2-DEPT-FILE        ASSIGN TO INP06.                 00270002
002800                                                                  00280000
002900     SELECT RMS-MAJ-CL-FILE      ASSIGN TO INP07.                 00290002
003000     SELECT DB2-MAJ-CL-FILE      ASSIGN TO INP08.                 00300002
003100                                                                  00310000
003200     SELECT RMS-SUB-CL-FILE      ASSIGN TO INP09.                 00320002
003300     SELECT DB2-SUB-CL-FILE      ASSIGN TO INP10.                 00330002
003400                                                                  00340000
003500     SELECT OUTPUT-FILE          ASSIGN TO OUT01.                 00350000
003600                                                                  00360000
003700****************************************************************  00370000
003800 DATA DIVISION.                                                   00380000
003900 FILE SECTION.                                                    00390000
004000                                                                  00400000
004100 FD  RMS-BUS-AREA-FILE                                            00410002
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0 RECORDS.                                    00440000
004500 01  RMS-BUS-AREA-REC            PIC X(29).                       00450002
004600                                                                  00460000
004700 FD  DB2-BUS-AREA-FILE                                            00470002
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     RECORDING MODE IS F                                          00490000
005000     BLOCK CONTAINS 0 RECORDS.                                    00500000
005100 01  DB2-BUS-AREA-REC            PIC X(27).                       00510006
005200                                                                  00520000
005300 FD  RMS-BUS-GRP-FILE                                             00530002
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     RECORDING MODE IS F                                          00550000
005600     BLOCK CONTAINS 0 RECORDS.                                    00560000
005700 01  RMS-BUS-GRP-REC             PIC X(34).                       00570002
005800                                                                  00580000
005900 FD  DB2-BUS-GRP-FILE                                             00590002
006000     LABEL RECORDS ARE STANDARD                                   00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS.                                    00620000
006300 01  DB2-BUS-GRP-REC             PIC X(29).                       00630006
006400                                                                  00640000
006500 FD  RMS-DEPT-FILE                                                00650002
006600     LABEL RECORDS ARE STANDARD                                   00660000
006700     RECORDING MODE IS F                                          00670000
006800     BLOCK CONTAINS 0 RECORDS.                                    00680000
006900 01  RMS-DEPT-REC                PIC X(54).                       00690002
007000                                                                  00700000
007100 FD  DB2-DEPT-FILE                                                00710002
007200     LABEL RECORDS ARE STANDARD                                   00720002
007300     RECORDING MODE IS F                                          00730002
007400     BLOCK CONTAINS 0 RECORDS.                                    00740002
007500 01  DB2-DEPT-REC                PIC X(38).                       00750012
007600                                                                  00760002
007700 FD  RMS-MAJ-CL-FILE                                              00770002
007800     LABEL RECORDS ARE STANDARD                                   00780000
007900     RECORDING MODE IS F                                          00790000
008000     BLOCK CONTAINS 0 RECORDS.                                    00800000
008100 01  RMS-MAJ-CL-REC              PIC X(42).                       00810002
008200                                                                  00820000
008300 FD  DB2-MAJ-CL-FILE                                              00830002
008400     LABEL RECORDS ARE STANDARD                                   00840002
008500     RECORDING MODE IS F                                          00850002
008600     BLOCK CONTAINS 0 RECORDS.                                    00860002
008700 01  DB2-MAJ-CL-REC              PIC X(29).                       00870017
008800                                                                  00880002
008900 FD  RMS-SUB-CL-FILE                                              00890002
009000     LABEL RECORDS ARE STANDARD                                   00900000
009100     RECORDING MODE IS F                                          00910000
009200     BLOCK CONTAINS 0 RECORDS.                                    00920000
009300 01  RMS-SUB-CL-REC              PIC X(77).                       00930007
009400                                                                  00940000
009500 FD  DB2-SUB-CL-FILE                                              00950002
009600     LABEL RECORDS ARE STANDARD                                   00960000
009700     RECORDING MODE IS F                                          00970000
009800     BLOCK CONTAINS 0 RECORDS.                                    00980000
009900 01  DB2-SUB-CL-REC              PIC X(61).                       00990006
010000                                                                  01000000
010100 FD  OUTPUT-FILE                                                  01010000
010200     LABEL RECORDS ARE STANDARD                                   01020000
010300     RECORDING MODE IS F                                          01030000
010400     BLOCK CONTAINS 0 RECORDS.                                    01040000
010500 01  OUTPUT-FILE-REC             PIC X(80).                       01050002
010600                                                                  01060000
010700****************************************************************  01070000
010800 WORKING-STORAGE SECTION.                                         01080000
010900                                                                  01090000
011000 01  WS-WORKING-STOAGE-VALUE     PIC X(35)  VALUE                 01100000
011100                          '*** WORKING STORAGE STARTS HERE ***'.  01110000
011200 01  PS-PROGRAM-SWITCHES.                                         01120000
011300     05  PS-EMPTY-FILE-SW        PIC X(01)  VALUE 'N'.            01130000
011400         88  PS-EMPTY-FILE-YES              VALUE 'Y'.            01140000
011500         88  PS-EMPTY-FILE-NO               VALUE 'N'.            01150000
011600     05  PS-EOF-RMS-SW           PIC X(01)  VALUE 'N'.            01160000
011700         88  PS-EOF-RMS-YES                 VALUE 'Y'.            01170000
011800         88  PS-EOF-RMS-NO                  VALUE 'N'.            01180000
011900     05  PS-EOF-DB2-SW           PIC X(01)  VALUE 'N'.            01190000
012000         88  PS-EOF-DB2-YES                 VALUE 'Y'.            01200000
012100         88  PS-EOF-DB2-NO                  VALUE 'N'.            01210000
012200                                                                  01220000
012300 01  PC-PROGRAM-CONSTANTS.                                        01230000
012400     05  PC-PROGRAM-NAME         PIC X(08)  VALUE 'XLKUT072'.     01240002
012500                                                                  01250000
012600 01  CONTROL-CARD-DATA.                                           01260000
012700     05  CC-PROGRAM-NAME         PIC X(01)  VALUE SPACES.         01270000
012800         88  CC-NIGHTLY-MAINT               VALUE '1'.            01280000
012900         88  CC-DATA-INTEGRITY              VALUE '2'.            01290000
013000     05  CC-FILLER               PIC X(79)  VALUE SPACES.         01300000
013100                                                                  01310000
013200 01  PV-PROGRAM-VARIABLES.                                        01320000
013300     05  PV-PARAGRAPH-NAME       PIC X(30)  VALUE SPACES.         01330000
013400     05  PV-BUS-AREA-ID          PIC 9(02).                       01340002
013500     05  PV-BUS-GP-NBR           PIC 9(03).                       01350002
013600     05  PV-BUS-GP-AREA-ID       PIC 9(02).                       01360002
013700     05  PV-DEPT-NBR             PIC 9(04).                       01370002
013800     05  PV-BYR-NBR              PIC 9(04).                       01380002
013900     05  PV-DMA-NBR              PIC 9(04).                       01390002
014000     05  PV-CONT-CLR-EXCLN-IND   PIC X(01).                       01400011
014100     05  PV-MAJ-CL-NBR           PIC 9(04).                       01410002
           05  PV-MAJ-CL-NM            PIC X(20).                       01411018
014200     05  PV-SUB-CL-NBR           PIC 9(04).                       01420002
014200     05  PV-PUT-AWY-CDE          PIC X(02).                       01421014
014300                                                                  01430000
014400 01  PA-PROGRAM-ACCUMULATORS.                                     01440000
014500     05  PA-BUS-AREA-ISRT-COUNT  PIC 9(07).                       01450002
014600     05  PA-BUS-AREA-UPD-COUNT   PIC 9(07).                       01460002
014700     05  PA-BUS-AREA-DEL-COUNT   PIC 9(07).                       01470002
014800     05  PA-BUS-GRP-ISRT-COUNT   PIC 9(07).                       01480002
014900     05  PA-BUS-GRP-UPD-COUNT    PIC 9(07).                       01490002
015000     05  PA-BUS-GRP-DEL-COUNT    PIC 9(07).                       01500002
015100     05  PA-DEPT-ISRT-COUNT      PIC 9(07).                       01510002
015200     05  PA-DEPT-UPD-COUNT       PIC 9(07).                       01520002
015300     05  PA-DEPT-DEL-COUNT       PIC 9(07).                       01530002
015400     05  PA-MAJ-CL-ISRT-COUNT    PIC 9(07).                       01540002
015500     05  PA-MAJ-CL-UPD-COUNT     PIC 9(07).                       01550002
015600     05  PA-MAJ-CL-DEL-COUNT     PIC 9(07).                       01560002
015700     05  PA-SUB-CL-ISRT-COUNT    PIC 9(07).                       01570002
015800     05  PA-SUB-CL-UPD-COUNT     PIC 9(07).                       01580002
015900     05  PA-SUB-CL-DEL-COUNT     PIC 9(07).                       01590002
016000                                                                  01600000
016100******************************************************************01610002
016200* LAYOUTS OF RMS INPUT FILES.                                     01620002
016300******************************************************************01630002
016400     COPY HMRD014.                                                01640002
016500                                                                  01650002
016600******************************************************************01660000
016700* LAYOUTS OF DB2 INPUT FILES.                                     01670002
016800******************************************************************01680000
016900*XLT_BUS_AREA                                                     01690002
017000     EXEC SQL                                                     01700000
017100         INCLUDE XLT00000                                         01710002
017200     END-EXEC.                                                    01720000
017300                                                                  01730000
017400*XLT_BUS_GP                                                       01740002
017500     EXEC SQL                                                     01750000
017600         INCLUDE XLT00001                                         01760002
017700     END-EXEC.                                                    01770000
017800                                                                  01780000
017900*XLT_DEPT                                                         01790002
018000     EXEC SQL                                                     01800000
018100         INCLUDE XLT00002                                         01810002
018200     END-EXEC.                                                    01820000
018300                                                                  01830000
018400*XLT_MAJ_CL                                                       01840002
018500     EXEC SQL                                                     01850000
018600         INCLUDE XLT00022                                         01860002
018700     END-EXEC.                                                    01870000
018800                                                                  01880000
018900*XLT_SUB_CL                                                       01890002
019000     EXEC SQL                                                     01900000
019100         INCLUDE XLT00023                                         01910002
019200     END-EXEC.                                                    01920000
019300                                                                  01930000
019400     EXEC SQL                                                     01940002
019500         INCLUDE SQLCA                                            01950002
019600     END-EXEC.                                                    01960002
019700                                                                  01970002
019800******************************************************************01980000
019900* LAYOUT OF OUTPUT FILE.                                          01990002
020000******************************************************************02000000
020100     COPY XLRD039.                                                02010004
020200                                                                  02020000
020300/*****************************************************************02030000
020400 PROCEDURE DIVISION.                                              02040000
020500                                                                  02050000
020600     PERFORM 1000-INITIALIZATION.                                 02060000
020700                                                                  02070000
020800*CHECK IF ANY EMPTY RMS FILES (ERROR MESSAGE).                    02080000
020900     SET PS-EMPTY-FILE-NO TO TRUE.                                02090000
021000     PERFORM 8000-READ-INP01-FILE.                                02100000
021100     PERFORM 8200-READ-INP03-FILE.                                02110002
021200     PERFORM 8400-READ-INP05-FILE.                                02120002
021300     PERFORM 8600-READ-INP07-FILE.                                02130002
021400     PERFORM 8800-READ-INP09-FILE.                                02140002
021500     IF PS-EMPTY-FILE-YES                                         02150000
021600         PERFORM 1100-CLOSE-INPUT-FILES                           02160000
021700         MOVE 4095 TO RETURN-CODE                                 02170000
021800         PERFORM 9999-TERMINATE                                   02180000
021900         GOBACK.                                                  02190000
022000                                                                  02200000
022100*COMPARE BUSINESS AREA RECORDS.                                   02210002
022200     SET PS-EOF-RMS-NO TO TRUE.                                   02220000
022300     SET PS-EOF-DB2-NO TO TRUE.                                   02230000
022400     PERFORM 8100-READ-INP02-FILE.                                02240002
022500     PERFORM 2000-PROCESS-BUS-AREA                                02250002
022600       UNTIL PS-EOF-RMS-YES                                       02260000
022700          OR PS-EOF-DB2-YES.                                      02270000
022800                                                                  02280000
022900     IF PS-EOF-RMS-YES                                            02290000
023000         PERFORM 2010-PROCESS-INP02                               02300000
023100           UNTIL PS-EOF-DB2-YES                                   02310000
023200     ELSE                                                         02320000
023300         PERFORM 2020-PROCESS-INP01                               02330000
023400           UNTIL PS-EOF-RMS-YES                                   02340000
023500     END-IF.                                                      02350000
023600                                                                  02360000
023700     CLOSE RMS-BUS-AREA-FILE                                      02370002
023800           DB2-BUS-AREA-FILE.                                     02380002
023900                                                                  02390000
024000*COMPARE BUSINESS GROUP RECORDS.                                  02400002
024100     SET PS-EOF-RMS-NO TO TRUE.                                   02410000
024200     SET PS-EOF-DB2-NO TO TRUE.                                   02420000
024300     PERFORM 8300-READ-INP04-FILE.                                02430002
024400     PERFORM 2100-PROCESS-BUS-GRP                                 02440002
024500       UNTIL PS-EOF-RMS-YES                                       02450000
024600          OR PS-EOF-DB2-YES.                                      02460000
024700                                                                  02470000
P42541*    IF PS-EOF-RMS-YES                                            02480021
P42541*        PERFORM 2110-PROCESS-INP04                               02490021
P42541*          UNTIL PS-EOF-DB2-YES                                   02500021
P42541*    ELSE                                                         02510021
P42541*        PERFORM 2120-PROCESS-INP03                               02520021
P42541*          UNTIL PS-EOF-RMS-YES                                   02530021
P42541*    END-IF.                                                      02540021
P42541                                                                  02541021
P42541     IF PS-EOF-DB2-YES                                            02542021
P42541         PERFORM 2120-PROCESS-INP03                               02543021
P42541           UNTIL PS-EOF-RMS-YES                                   02544021
P42541     END-IF.                                                      02545021
025500                                                                  02550000
025600     CLOSE RMS-BUS-GRP-FILE                                       02560002
025700           DB2-BUS-GRP-FILE.                                      02570002
025800                                                                  02580000
025900*COMPARE DEPARTMENT RECORDS.                                      02590002
026000     SET PS-EOF-RMS-NO TO TRUE.                                   02600000
026100     SET PS-EOF-DB2-NO TO TRUE.                                   02610000
026200     PERFORM 8500-READ-INP06-FILE.                                02620002
026300     PERFORM 2200-PROCESS-DEPT                                    02630002
026400       UNTIL PS-EOF-RMS-YES                                       02640000
026500          OR PS-EOF-DB2-YES.                                      02650000
026600                                                                  02660000
P42541*    IF PS-EOF-RMS-YES                                            02670021
P42541*        PERFORM 2210-PROCESS-INP06                               02680021
P42541*          UNTIL PS-EOF-DB2-YES                                   02690021
P42541*    ELSE                                                         02700021
P42541*        PERFORM 2220-PROCESS-INP05                               02710021
P42541*          UNTIL PS-EOF-RMS-YES                                   02720021
P42541*    END-IF.                                                      02730021
P42541                                                                  02731021
P42541     IF PS-EOF-DB2-YES                                            02732021
P42541         PERFORM 2220-PROCESS-INP05                               02733021
P42541           UNTIL PS-EOF-RMS-YES                                   02734021
P42541     END-IF.                                                      02735021
027400                                                                  02740000
027500     CLOSE RMS-DEPT-FILE                                          02750002
027600           DB2-DEPT-FILE.                                         02760002
027700                                                                  02770000
027800*COMPARE MAJOR CLASS RECORDS.                                     02780002
027900     SET PS-EOF-RMS-NO TO TRUE.                                   02790000
028000     SET PS-EOF-DB2-NO TO TRUE.                                   02800000
028100     PERFORM 8700-READ-INP08-FILE.                                02810002
028200     PERFORM 2300-PROCESS-MAJ-CL                                  02820002
028300       UNTIL PS-EOF-RMS-YES                                       02830000
028400          OR PS-EOF-DB2-YES.                                      02840000
028500                                                                  02850000
P42541*    IF PS-EOF-RMS-YES                                            02860021
P42541*        PERFORM 2310-PROCESS-INP08                               02870021
P42541*          UNTIL PS-EOF-DB2-YES                                   02880021
P42541*    ELSE                                                         02890021
P42541*        PERFORM 2320-PROCESS-INP07                               02900021
P42541*          UNTIL PS-EOF-RMS-YES                                   02910021
P42541*    END-IF.                                                      02920021
P42541                                                                  02921021
P42541     IF PS-EOF-DB2-YES                                            02922021
P42541         PERFORM 2320-PROCESS-INP07                               02923021
P42541           UNTIL PS-EOF-RMS-YES                                   02924021
P42541     END-IF.                                                      02925021
029300                                                                  02930000
029400     CLOSE RMS-MAJ-CL-FILE                                        02940002
029500           DB2-MAJ-CL-FILE.                                       02950002
029600                                                                  02960000
029700*COMPARE SUB-CLASS RECORDS.                                       02970002
029800     SET PS-EOF-RMS-NO TO TRUE.                                   02980000
029900     SET PS-EOF-DB2-NO TO TRUE.                                   02990000
030000     PERFORM 8900-READ-INP10-FILE.                                03000002
030100     PERFORM 2400-PROCESS-SUB-CL                                  03010002
030200       UNTIL PS-EOF-RMS-YES                                       03020000
030300          OR PS-EOF-DB2-YES.                                      03030000
030400                                                                  03040000
P42541*    IF PS-EOF-RMS-YES                                            03050021
P42541*        PERFORM 2410-PROCESS-INP10                               03060021
P42541*          UNTIL PS-EOF-DB2-YES                                   03070021
P42541*    ELSE                                                         03080021
P42541*        PERFORM 2420-PROCESS-INP09                               03090021
P42541*          UNTIL PS-EOF-RMS-YES                                   03100021
P42541*    END-IF.                                                      03110021
P42541                                                                  03111021
P42541     IF PS-EOF-DB2-YES                                            03112021
P42541         PERFORM 2420-PROCESS-INP09                               03113021
P42541           UNTIL PS-EOF-RMS-YES                                   03114021
P42541     END-IF.                                                      03115021
031200                                                                  03120000
031300     CLOSE RMS-SUB-CL-FILE                                        03130002
031400           DB2-SUB-CL-FILE.                                       03140002
031500                                                                  03150000
031600*FINISH PROCESSING.                                               03160000
031700     PERFORM 9999-TERMINATE.                                      03170000
031800                                                                  03180000
031900     GOBACK.                                                      03190000
032000                                                                  03200000
032100******************************************************************03210000
032200*             I N I T I A L I Z A T I O N                        *03220000
032300******************************************************************03230000
032400 1000-INITIALIZATION.                                             03240000
032500     MOVE '1000-INITIALIZATION           ' TO PV-PARAGRAPH-NAME.  03250000
032600                                                                  03260000
032700*OPEN FILES.                                                      03270000
032800     OPEN INPUT  RMS-BUS-AREA-FILE                                03280002
032900                 DB2-BUS-AREA-FILE                                03290002
033000                 RMS-BUS-GRP-FILE                                 03300002
033100                 DB2-BUS-GRP-FILE                                 03310002
033200                 RMS-DEPT-FILE                                    03320002
033300                 DB2-DEPT-FILE                                    03330002
033400                 RMS-MAJ-CL-FILE                                  03340002
033500                 DB2-MAJ-CL-FILE                                  03350002
033600                 RMS-SUB-CL-FILE                                  03360002
033700                 DB2-SUB-CL-FILE                                  03370002
033800          OUTPUT OUTPUT-FILE.                                     03380000
033900                                                                  03390000
034000*SET COUNTERS TO ZERO.                                            03400000
034100     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          03410000
034200                                                                  03420000
034300*READ SYSIN CONTROL CARD.                                         03430000
034400     ACCEPT CONTROL-CARD-DATA FROM SYSIN.                         03440000
034500                                                                  03450000
034600******************************************************************03460000
034700 1100-CLOSE-INPUT-FILES.                                          03470000
034800     MOVE '1100-CLOSE-INPUT-FILES        ' TO PV-PARAGRAPH-NAME.  03480000
034900                                                                  03490000
035000     CLOSE RMS-BUS-AREA-FILE                                      03500002
035100           DB2-BUS-AREA-FILE                                      03510002
035200           RMS-BUS-GRP-FILE                                       03520002
035300           DB2-BUS-GRP-FILE                                       03530002
035400           RMS-DEPT-FILE                                          03540002
035500           DB2-DEPT-FILE                                          03550002
035600           RMS-MAJ-CL-FILE                                        03560002
035700           DB2-MAJ-CL-FILE                                        03570002
035800           RMS-SUB-CL-FILE                                        03580002
035900           DB2-SUB-CL-FILE.                                       03590002
036000                                                                  03600000
036100******************************************************************03610000
036200*           P R O C E S S   B U S   A R E A                      *03620002
036300******************************************************************03630004
036400 2000-PROCESS-BUS-AREA.                                           03640002
036500     MOVE '2000-PROCESS-BUS-AREA         ' TO PV-PARAGRAPH-NAME.  03650002
036600                                                                  03660000
036700     MOVE XLT00000-BUS-AREA-ID TO PV-BUS-AREA-ID                  03670004
036800     IF HM014-BUS-AREA-ID = PV-BUS-AREA-ID                        03680004
036900         IF HM014-BUS-AREA-DESC = XLT00000-BUS-AREA-DESC          03690003
037000             PERFORM 8000-READ-INP01-FILE                         03700000
037100             PERFORM 8100-READ-INP02-FILE                         03710003
037200         ELSE                                                     03720000
037300             INITIALIZE XL039-TRANS-REC                           03730004
037400             MOVE '2'  TO XL039-ACTION-TYPE                       03740004
037500             MOVE 'A'  TO XL039-RECORD-TYPE                       03750004
037600             MOVE '06' TO XL039-SORT-SEQUENCE                     03760004
037700                                                                  03770000
037800             MOVE HM014-BUS-AREA-ID   TO XL039-AREA-ID            03780004
037900             MOVE HM014-BUS-AREA-DESC TO XL039-AREA-DESC          03790004
038000                                                                  03800000
038100             PERFORM 9000-WRITE-OUTPUT-REC                        03810000
038200             ADD 1 TO PA-BUS-AREA-UPD-COUNT                       03820004
038300                                                                  03830000
038400             PERFORM 8000-READ-INP01-FILE                         03840000
038500             PERFORM 8100-READ-INP02-FILE                         03850004
038600     ELSE                                                         03860000
038700     IF HM014-BUS-AREA-ID > PV-BUS-AREA-ID                        03870004
038800         PERFORM 2010-PROCESS-INP02                               03880000
038900     ELSE                                                         03890000
039000     IF PV-BUS-AREA-ID > HM014-BUS-AREA-ID                        03900004
039100         PERFORM 2020-PROCESS-INP01                               03910000
039200     END-IF                                                       03920000
039300     END-IF                                                       03930000
039400     END-IF.                                                      03940000
039500                                                                  03950000
039600******************************************************************03960000
039700 2010-PROCESS-INP02.                                              03970000
039800     MOVE '2010-PROCESS-INP02            ' TO PV-PARAGRAPH-NAME.  03980000
039900                                                                  03990000
040000     INITIALIZE XL039-TRANS-REC.                                  04000004
040100                                                                  04010000
040200     MOVE '3'  TO XL039-ACTION-TYPE.                              04020004
040300     MOVE 'A'  TO XL039-RECORD-TYPE.                              04030004
040400     MOVE '15' TO XL039-SORT-SEQUENCE.                            04040004
040500                                                                  04050000
040600     MOVE XLT00000-BUS-AREA-ID TO XL039-AREA-ID.                  04060004
040700                                                                  04070000
040800     PERFORM 9000-WRITE-OUTPUT-REC.                               04080000
040900     ADD 1 TO PA-BUS-AREA-DEL-COUNT.                              04090004
041000                                                                  04100000
041100     PERFORM 8100-READ-INP02-FILE.                                04110004
041200                                                                  04120000
041300******************************************************************04130000
041400 2020-PROCESS-INP01.                                              04140000
041500     MOVE '2020-PROCESS-INP01            ' TO PV-PARAGRAPH-NAME.  04150000
041600                                                                  04160000
041700     INITIALIZE XL039-TRANS-REC.                                  04170004
041800                                                                  04180000
041900     MOVE '1'  TO XL039-ACTION-TYPE.                              04190004
042000     MOVE 'A'  TO XL039-RECORD-TYPE.                              04200004
042100     MOVE '01' TO XL039-SORT-SEQUENCE.                            04210004
042200                                                                  04220000
042300     MOVE HM014-BUS-AREA-ID   TO XL039-AREA-ID.                   04230004
042400     MOVE HM014-BUS-AREA-DESC TO XL039-AREA-DESC.                 04240004
042500                                                                  04250000
042600     PERFORM 9000-WRITE-OUTPUT-REC.                               04260000
042700     ADD 1 TO PA-BUS-AREA-ISRT-COUNT.                             04270004
042800                                                                  04280000
042900     PERFORM 8000-READ-INP01-FILE.                                04290000
043000                                                                  04300000
043100******************************************************************04310000
043200*           P R O C E S S   B U S   G R O U P                    *04320004
043300******************************************************************04330004
043400 2100-PROCESS-BUS-GRP.                                            04340004
043500     MOVE '2100-PROCESS-BUS-GRP          ' TO PV-PARAGRAPH-NAME.  04350004
043600                                                                  04360000
043700     MOVE XLT00001-BUS-GP-NBR  TO PV-BUS-GP-NBR                   04370004
043800     MOVE XLT00001-BUS-AREA-ID TO PV-BUS-AREA-ID                  04380004
043900     IF HM014-BUS-GP-NBR = PV-BUS-GP-NBR                          04390004
044000         IF HM014-BUS-GP-AREA-ID = PV-BUS-AREA-ID                 04400004
044100           AND HM014-BUS-GP-DESC = XLT00001-BUS-GP-DESC           04410004
044200             PERFORM 8200-READ-INP03-FILE                         04420004
044300             PERFORM 8300-READ-INP04-FILE                         04430004
044400         ELSE                                                     04440000
044500             INITIALIZE XL039-TRANS-REC                           04450004
044600             MOVE '2'  TO XL039-ACTION-TYPE                       04460004
044700             MOVE 'G'  TO XL039-RECORD-TYPE                       04470004
044800             MOVE '07' TO XL039-SORT-SEQUENCE                     04480004
044900                                                                  04490000
045000             MOVE HM014-BUS-GP-NBR     TO XL039-GROUP-NBR         04500004
045100             MOVE HM014-BUS-GP-AREA-ID TO XL039-GP-AREA-ID        04510004
045200             MOVE HM014-BUS-GP-DESC    TO XL039-GROUP-DESC        04520004
045300                                                                  04530000
045400             PERFORM 9000-WRITE-OUTPUT-REC                        04540000
045500             ADD 1 TO PA-BUS-GRP-UPD-COUNT                        04550004
045600                                                                  04560000
045700             PERFORM 8200-READ-INP03-FILE                         04570004
045800             PERFORM 8300-READ-INP04-FILE                         04580004
045900     ELSE                                                         04590000
046000     IF HM014-BUS-GP-NBR > PV-BUS-GP-NBR                          04600004
P42541*        PERFORM 2110-PROCESS-INP04                               04610021
P42541         PERFORM 8300-READ-INP04-FILE                             04611021
046200     ELSE                                                         04620000
046300     IF PV-BUS-GP-NBR > HM014-BUS-GP-NBR                          04630004
046400         PERFORM 2120-PROCESS-INP03                               04640000
046500     END-IF                                                       04650000
046600     END-IF                                                       04660000
046700     END-IF.                                                      04670000
046800                                                                  04680000
046900******************************************************************04690000
P42541*2110-PROCESS-INP04.                                              04700021
P42541*    MOVE '2110-PROCESS-INP04            ' TO PV-PARAGRAPH-NAME.  04710021
P42541*                                                                 04720021
P42541*    INITIALIZE XL039-TRANS-REC.                                  04730021
P42541*                                                                 04740021
P42541*    MOVE '3'  TO XL039-ACTION-TYPE.                              04750021
P42541*    MOVE 'G'  TO XL039-RECORD-TYPE.                              04760021
P42541*    MOVE '14' TO XL039-SORT-SEQUENCE.                            04770021
P42541*                                                                 04780021
P42541*    MOVE XLT00001-BUS-GP-NBR TO XL039-GROUP-NBR.                 04790021
P42541*                                                                 04800021
P42541*    PERFORM 9000-WRITE-OUTPUT-REC.                               04810021
P42541*    ADD 1 TO PA-BUS-GRP-DEL-COUNT.                               04820021
P42541*                                                                 04830021
P42541*    PERFORM 8300-READ-INP04-FILE.                                04840021
P42541*                                                                 04850021
048600******************************************************************04860000
048700 2120-PROCESS-INP03.                                              04870000
048800     MOVE '2120-PROCESS-INP03            ' TO PV-PARAGRAPH-NAME.  04880000
048900                                                                  04890000
049000     INITIALIZE XL039-TRANS-REC.                                  04900004
049100                                                                  04910000
049200     MOVE '1'  TO XL039-ACTION-TYPE.                              04920004
049300     MOVE 'G'  TO XL039-RECORD-TYPE.                              04930004
049400     MOVE '02' TO XL039-SORT-SEQUENCE.                            04940004
049500                                                                  04950000
049600     MOVE HM014-BUS-GP-NBR     TO XL039-GROUP-NBR.                04960004
049700     MOVE HM014-BUS-GP-AREA-ID TO XL039-GP-AREA-ID.               04970004
049800     MOVE HM014-BUS-GP-DESC    TO XL039-GROUP-DESC.               04980004
049900                                                                  04990000
050000     PERFORM 9000-WRITE-OUTPUT-REC.                               05000000
050100     ADD 1 TO PA-BUS-GRP-ISRT-COUNT.                              05010004
050200                                                                  05020000
050300     PERFORM 8200-READ-INP03-FILE.                                05030004
050400                                                                  05040000
050500******************************************************************05050000
050600*          P R O C E S S   D E P A R T M E N T                   *05060004
050700******************************************************************05070000
050800 2200-PROCESS-DEPT.                                               05080004
050900     MOVE '2200-PROCESS-DEPT             ' TO PV-PARAGRAPH-NAME.  05090004
051000                                                                  05100000
051100     MOVE XLT00002-DEPT-NBR   TO PV-DEPT-NBR.                     05110004
051200     MOVE XLT00002-BUS-GP-NBR TO PV-BUS-GP-NBR.                   05120004
051300     MOVE XLT00002-BYR-NBR    TO PV-BYR-NBR.                      05130004
051400     MOVE XLT00002-DMA-NBR    TO PV-DMA-NBR.                      05140004
051500     MOVE XLT00002-CONT-CLR-EXCLN-IND                             05150004
051600                              TO PV-CONT-CLR-EXCLN-IND.           05160004
051700     IF HM014-DEPT-DEPT-NBR = PV-DEPT-NBR                         05170004
052000         IF HM014-DEPT-STR-DEPT-NM     = XLT00002-DEPT-NM         05200004
052100           AND HM014-DEPT-MDSE-LNE-CDE = XLT00002-MDSE-LNE-CDE    05210004
052200           AND HM014-DEPT-BUS-GP-NBR   = PV-BUS-GP-NBR            05220004
052300           AND HM014-DEPT-STR-ZNE-CDE  = XLT00002-STR-ZN-CDE      05230004
052400           AND HM014-DEPT-BYR-NBR      = PV-BYR-NBR               05240004
052500           AND HM014-DEPT-DMA-NBR      = PV-DMA-NBR               05250004
052600           AND HM014-DEPT-CONT-CLR-EXCLN-IND =                    05260004
052700                                         PV-CONT-CLR-EXCLN-IND    05270004
052800             PERFORM 8400-READ-INP05-FILE                         05280004
052900             PERFORM 8500-READ-INP06-FILE                         05290004
053000         ELSE                                                     05300000
053100             INITIALIZE XL039-TRANS-REC                           05310004
053200             MOVE '2'  TO XL039-ACTION-TYPE                       05320004
053300             MOVE 'D'  TO XL039-RECORD-TYPE                       05330004
053400             MOVE '08' TO XL039-SORT-SEQUENCE                     05340004
053500                                                                  05350000
053600             MOVE HM014-DEPT-DEPT-NBR     TO XL039-DEPT-NBR       05360004
053700             MOVE HM014-DEPT-STR-DEPT-NM  TO XL039-DEPT-NAME      05370004
053800             MOVE HM014-DEPT-MDSE-LNE-CDE TO XL039-MDSE-LNE-CDE   05380004
053900             MOVE HM014-DEPT-BUS-GP-NBR   TO XL039-BUS-GP-NBR     05390004
054000             MOVE HM014-DEPT-STR-ZNE-CDE  TO XL039-STR-ZN-CDE     05400004
054100             MOVE HM014-DEPT-BYR-NBR      TO XL039-BYR-NBR        05410004
054200             MOVE HM014-DEPT-DMA-NBR      TO XL039-DMA-NBR        05420004
054300             MOVE HM014-DEPT-CONT-CLR-EXCLN-IND                   05430004
054400                                          TO XL039-EXCLN-IND      05440004
054500                                                                  05450000
054600             PERFORM 9000-WRITE-OUTPUT-REC                        05460000
054700             ADD 1 TO PA-DEPT-UPD-COUNT                           05470004
054800                                                                  05480000
054900             PERFORM 8400-READ-INP05-FILE                         05490004
055000             PERFORM 8500-READ-INP06-FILE                         05500004
055100     ELSE                                                         05510000
055200     IF HM014-DEPT-DEPT-NBR > PV-DEPT-NBR                         05520004
055210***      DISPLAY 'D- HM014-DEPT-DEPT-NBR = ' HM014-DEPT-DEPT-NBR  05521010
055220***              ' / PV-DEPT-NBR = ' PV-DEPT-NBR                  05522010
P42541*        PERFORM 2210-PROCESS-INP06                               05530021
P42541         PERFORM 8500-READ-INP06-FILE                             05531021
055400     ELSE                                                         05540000
055500     IF PV-DEPT-NBR > HM014-DEPT-DEPT-NBR                         05550004
055510***      DISPLAY 'A- HM014-DEPT-DEPT-NBR = ' HM014-DEPT-DEPT-NBR  05551010
055520***              ' / PV-DEPT-NBR = ' PV-DEPT-NBR                  05552010
055600         PERFORM 2220-PROCESS-INP05                               05560000
055700     END-IF                                                       05570000
055800     END-IF                                                       05580000
055900     END-IF.                                                      05590000
056000                                                                  05600000
056100******************************************************************05610000
P42541*2210-PROCESS-INP06.                                              05620021
P42541*    MOVE '2210-PROCESS-INP06            ' TO PV-PARAGRAPH-NAME.  05630021
P42541*                                                                 05640021
P42541*    INITIALIZE XL039-TRANS-REC.                                  05650021
P42541*                                                                 05660021
P42541*    MOVE '3'  TO XL039-ACTION-TYPE.                              05670021
P42541*    MOVE 'D'  TO XL039-RECORD-TYPE.                              05680021
P42541*    MOVE '13' TO XL039-SORT-SEQUENCE.                            05690021
P42541*                                                                 05700021
P42541*    MOVE PV-DEPT-NBR TO XL039-DEPT-NBR.                          05710021
P42541*                                                                 05720021
P42541*    PERFORM 9000-WRITE-OUTPUT-REC.                               05730021
P42541*    ADD 1 TO PA-DEPT-DEL-COUNT.                                  05740021
P42541*                                                                 05750021
P42541*    PERFORM 8500-READ-INP06-FILE.                                05760021
P42541*                                                                 05770021
057800******************************************************************05780000
057900 2220-PROCESS-INP05.                                              05790000
058000     MOVE '2220-PROCESS-INP05            ' TO PV-PARAGRAPH-NAME.  05800000
058100                                                                  05810000
058200     INITIALIZE XL039-TRANS-REC.                                  05820004
058300                                                                  05830000
058400     MOVE '1'  TO XL039-ACTION-TYPE.                              05840004
058500     MOVE 'D'  TO XL039-RECORD-TYPE.                              05850004
058600     MOVE '03' TO XL039-SORT-SEQUENCE.                            05860004
058700                                                                  05870000
058800     MOVE HM014-DEPT-DEPT-NBR     TO XL039-DEPT-NBR.              05880004
058900     MOVE HM014-DEPT-STR-DEPT-NM  TO XL039-DEPT-NAME.             05890004
059000     MOVE HM014-DEPT-MDSE-LNE-CDE TO XL039-MDSE-LNE-CDE.          05900004
059100     MOVE HM014-DEPT-BUS-GP-NBR   TO XL039-BUS-GP-NBR.            05910004
059200     MOVE HM014-DEPT-STR-ZNE-CDE  TO XL039-STR-ZN-CDE.            05920004
059300     MOVE HM014-DEPT-BYR-NBR      TO XL039-BYR-NBR.               05930004
059400     MOVE HM014-DEPT-DMA-NBR      TO XL039-DMA-NBR.               05940004
059500     MOVE HM014-DEPT-CONT-CLR-EXCLN-IND                           05950004
059600                                  TO XL039-EXCLN-IND.             05960004
059700                                                                  05970000
059800     PERFORM 9000-WRITE-OUTPUT-REC.                               05980000
059900     ADD 1 TO PA-DEPT-ISRT-COUNT.                                 05990004
060000                                                                  06000000
060100     PERFORM 8400-READ-INP05-FILE.                                06010004
060200                                                                  06020000
060300******************************************************************06030000
060400*          P R O C E S S   M A J O R   C L A S S                 *06040004
060500******************************************************************06050004
060600 2300-PROCESS-MAJ-CL.                                             06060004
060700     MOVE '2300-PROCESS-MAJ-CL           ' TO PV-PARAGRAPH-NAME.  06070004
060800                                                                  06080000
060900     MOVE XLT00022-DEPT-NBR    TO PV-DEPT-NBR.                    06090014
061000     MOVE XLT00022-MAJ-CL-NBR  TO PV-MAJ-CL-NBR.                  06100014
           MOVE XLT00022-MAJ-CL-NM   TO PV-MAJ-CL-NM.                   06100118
           MOVE XLT00022-PUT-AWY-CDE TO PV-PUT-AWY-CDE.                 06101014
061100     IF HM014-MAJ-CL-DEPT-NBR = PV-DEPT-NBR                       06110004
061200       AND HM014-MAJ-CL-NBR = PV-MAJ-CL-NBR                       06120004
061300       IF HM014-MAJ-CL-PUT-AWY-CDE = XLT00022-PUT-AWY-CDE         06130020
               AND HM014-MAJ-CL-NM  = PV-MAJ-CL-NM                      06131020
061400             PERFORM 8600-READ-INP07-FILE                         06140004
061500             PERFORM 8700-READ-INP08-FILE                         06150004
061600       ELSE                                                       06160020
061700             INITIALIZE XL039-TRANS-REC                           06170004
061800             MOVE '2'  TO XL039-ACTION-TYPE                       06180004
061900             MOVE 'M'  TO XL039-RECORD-TYPE                       06190004
062000             MOVE '09' TO XL039-SORT-SEQUENCE                     06200004
062100                                                                  06210000
062200             MOVE HM014-MAJ-CL-DEPT-NBR TO XL039-MAJ-CL-DEPT-NBR  06220005
062300             MOVE HM014-MAJ-CL-NBR      TO XL039-MAJ-CL-NBR       06230004
062400             MOVE HM014-MAJ-CL-NM       TO XL039-MAJ-CL-NM        06240004
                   MOVE HM014-MAJ-CL-PUT-AWY-CDE                        06241014
                                              TO XL039-PUT-AWY-CDE      06242014
062500                                                                  06250000
062600             PERFORM 9000-WRITE-OUTPUT-REC                        06260000
062700             ADD 1 TO PA-MAJ-CL-UPD-COUNT                         06270004
062800                                                                  06280000
062900             PERFORM 8600-READ-INP07-FILE                         06290004
063000             PERFORM 8700-READ-INP08-FILE                         06300004
063100     ELSE                                                         06310000
063200     IF (HM014-MAJ-CL-DEPT-NBR > PV-DEPT-NBR)                     06320004
063300       OR (HM014-MAJ-CL-DEPT-NBR = PV-DEPT-NBR                    06330004
063400        AND HM014-MAJ-CL-NBR     > PV-MAJ-CL-NBR)                 06340004
P42541*        PERFORM 2310-PROCESS-INP08                               06350021
P42541         PERFORM 8700-READ-INP08-FILE                             06351021
063600     ELSE                                                         06360000
063700     IF (PV-DEPT-NBR > HM014-MAJ-CL-DEPT-NBR)                     06370004
063800       OR (PV-DEPT-NBR    = HM014-MAJ-CL-DEPT-NBR                 06380004
063900        AND PV-MAJ-CL-NBR > HM014-MAJ-CL-NBR)                     06390004
064000         PERFORM 2320-PROCESS-INP07                               06400000
064100     END-IF                                                       06410000
064200     END-IF                                                       06420000
064300     END-IF.                                                      06430000
064400                                                                  06440000
064500******************************************************************06450000
P42541*2310-PROCESS-INP08.                                              06460021
P42541*    MOVE '2310-PROCESS-INP08            ' TO PV-PARAGRAPH-NAME.  06470021
P42541*                                                                 06480021
P42541*    INITIALIZE XL039-TRANS-REC.                                  06490021
P42541*                                                                 06500021
P42541*    MOVE '3'  TO XL039-ACTION-TYPE.                              06510021
P42541*    MOVE 'M'  TO XL039-RECORD-TYPE.                              06520021
P42541*    MOVE '12' TO XL039-SORT-SEQUENCE.                            06530021
P42541*                                                                 06540021
P42541*    MOVE PV-DEPT-NBR    TO XL039-MAJ-CL-DEPT-NBR.                06550021
P42541*    MOVE PV-MAJ-CL-NBR  TO XL039-MAJ-CL-NBR.                     06560021
P42541*    MOVE PV-PUT-AWY-CDE TO XL039-PUT-AWY-CDE.                    06561021
P42541*                                                                 06570021
P42541*    PERFORM 9000-WRITE-OUTPUT-REC.                               06580021
P42541*    ADD 1 TO PA-MAJ-CL-DEL-COUNT.                                06590021
P42541*                                                                 06600021
P42541*    PERFORM 8700-READ-INP08-FILE.                                06610021
P42541*                                                                 06620021
066300******************************************************************06630000
066400 2320-PROCESS-INP07.                                              06640000
066500     MOVE '2320-PROCESS-INP07            ' TO PV-PARAGRAPH-NAME.  06650000
066600                                                                  06660000
066700     INITIALIZE XL039-TRANS-REC.                                  06670004
066800                                                                  06680000
066900     MOVE '1'  TO XL039-ACTION-TYPE.                              06690004
067000     MOVE 'M'  TO XL039-RECORD-TYPE.                              06700004
067100     MOVE '04' TO XL039-SORT-SEQUENCE.                            06710004
067200                                                                  06720000
067300     MOVE HM014-MAJ-CL-DEPT-NBR    TO XL039-MAJ-CL-DEPT-NBR.      06730014
067400     MOVE HM014-MAJ-CL-NBR         TO XL039-MAJ-CL-NBR.           06740014
067500     MOVE HM014-MAJ-CL-NM          TO XL039-MAJ-CL-NM.            06750014
           MOVE HM014-MAJ-CL-PUT-AWY-CDE TO XL039-PUT-AWY-CDE.          06751014
067600                                                                  06760000
067700     PERFORM 9000-WRITE-OUTPUT-REC.                               06770000
067800     ADD 1 TO PA-MAJ-CL-ISRT-COUNT.                               06780004
067900                                                                  06790000
068000     PERFORM 8600-READ-INP07-FILE.                                06800004
068100                                                                  06810000
068200******************************************************************06820000
068300*             P R O C E S S   S U B C L A S S                    *06830004
068400******************************************************************06840005
068500 2400-PROCESS-SUB-CL.                                             06850004
068600     MOVE '2400-PROCESS-SUB-CL           ' TO PV-PARAGRAPH-NAME.  06860004
068700                                                                  06870000
068800     MOVE XLT00023-DEPT-NBR   TO PV-DEPT-NBR.                     06880005
068900     MOVE XLT00023-MAJ-CL-NBR TO PV-MAJ-CL-NBR.                   06890005
069000     MOVE XLT00023-SUB-CL-NBR TO PV-SUB-CL-NBR.                   06900005
069100                                                                  06910005
069200     IF HM014-SUB-CL-DEPT-NBR = PV-DEPT-NBR                       06920005
069300       AND HM014-SUB-CL-MAJ-CL-NBR = PV-MAJ-CL-NBR                06930005
069400       AND HM014-SUB-CL-NBR = PV-SUB-CL-NBR                       06940005
069500         IF HM014-SUB-CL-NM = XLT00023-SUB-CL-NM                  06950005
069600           AND HM014-SUB-CL-POS-MDSE-DESC = XLT00023-POS-MDSE-DESC06960005
069700           AND HM014-SUB-CL-TAX-DFLT-IND = XLT00023-TAX-DFLT-IND  06970005
069800           AND HM014-SUB-CL-DISC-ELIG-IND = XLT00023-DISC-ELIG-IND06980005
069900             PERFORM 8800-READ-INP09-FILE                         06990004
070000             PERFORM 8900-READ-INP10-FILE                         07000004
070100         ELSE                                                     07010000
070200             INITIALIZE XL039-TRANS-REC                           07020004
070300             MOVE '2'  TO XL039-ACTION-TYPE                       07030004
070400             MOVE 'S'  TO XL039-RECORD-TYPE                       07040004
070500             MOVE '10' TO XL039-SORT-SEQUENCE                     07050004
070600                                                                  07060000
070700             MOVE HM014-SUB-CL-DEPT-NBR                           07070005
070800                  TO XL039-SUB-CL-DEPT-NBR                        07080005
070900             MOVE HM014-SUB-CL-MAJ-CL-NBR                         07090005
071000                  TO XL039-SUB-CL-MAJ-CL-NBR                      07100005
071100             MOVE HM014-SUB-CL-NBR                                07110005
071200                  TO XL039-SUB-CL-NBR                             07120005
071300             MOVE HM014-SUB-CL-NM                                 07130005
071400                  TO XL039-SUB-CL-NM                              07140005
071500             MOVE HM014-SUB-CL-POS-MDSE-DESC                      07150005
071600                  TO XL039-SUB-CL-MDSE-DESC                       07160005
071700             MOVE HM014-SUB-CL-TAX-DFLT-IND                       07170005
071800                  TO XL039-TAX-DFLT-IND                           07180005
071900             MOVE HM014-SUB-CL-DISC-ELIG-IND                      07190005
072000                  TO XL039-DISC-ELIG-IND                          07200005
072100                                                                  07210000
072200             PERFORM 9000-WRITE-OUTPUT-REC                        07220000
072300             ADD 1 TO PA-SUB-CL-UPD-COUNT                         07230004
072400                                                                  07240000
072500             PERFORM 8800-READ-INP09-FILE                         07250004
072600             PERFORM 8900-READ-INP10-FILE                         07260004
072700     ELSE                                                         07270005
072800     IF (HM014-SUB-CL-DEPT-NBR > PV-DEPT-NBR)                     07280005
072900       OR (HM014-SUB-CL-DEPT-NBR = PV-DEPT-NBR                    07290005
073000        AND HM014-SUB-CL-MAJ-CL-NBR > PV-MAJ-CL-NBR)              07300005
073100       OR (HM014-SUB-CL-DEPT-NBR = PV-DEPT-NBR                    07310005
073200        AND HM014-SUB-CL-MAJ-CL-NBR = PV-MAJ-CL-NBR               07320005
073300        AND HM014-SUB-CL-NBR > PV-SUB-CL-NBR)                     07330005
P42541*        PERFORM 2410-PROCESS-INP10                               07340021
P42541         PERFORM 8900-READ-INP10-FILE                             07341021
073500     ELSE                                                         07350000
073600     IF (PV-DEPT-NBR > HM014-SUB-CL-DEPT-NBR)                     07360005
073700       OR (PV-DEPT-NBR = HM014-SUB-CL-DEPT-NBR                    07370005
073800        AND PV-MAJ-CL-NBR > HM014-SUB-CL-MAJ-CL-NBR)              07380005
073900       OR (PV-DEPT-NBR = HM014-SUB-CL-DEPT-NBR                    07390005
074000        AND PV-MAJ-CL-NBR = HM014-SUB-CL-MAJ-CL-NBR               07400005
074100        AND PV-SUB-CL-NBR > HM014-SUB-CL-NBR)                     07410005
074200         PERFORM 2420-PROCESS-INP09                               07420000
074300     END-IF                                                       07430000
074400     END-IF                                                       07440000
074500     END-IF.                                                      07450000
074600                                                                  07460000
074700******************************************************************07470000
P42541*2410-PROCESS-INP10.                                              07480022
P42541*    MOVE '2410-PROCESS-INP10            ' TO PV-PARAGRAPH-NAME.  07490022
P42541*                                                                 07500022
P42541*    INITIALIZE XL039-TRANS-REC.                                  07510022
P42541*                                                                 07520022
P42541*    MOVE '3'  TO XL039-ACTION-TYPE.                              07530022
P42541*    MOVE 'S'  TO XL039-RECORD-TYPE.                              07540022
P42541*    MOVE '11' TO XL039-SORT-SEQUENCE.                            07550022
P42541*                                                                 07560022
P42541*    MOVE PV-DEPT-NBR   TO XL039-SUB-CL-DEPT-NBR.                 07570022
P42541*    MOVE PV-MAJ-CL-NBR TO XL039-SUB-CL-MAJ-CL-NBR.               07580022
P42541*    MOVE PV-SUB-CL-NBR TO XL039-SUB-CL-NBR.                      07590022
P42541*                                                                 07600022
P42541*    PERFORM 9000-WRITE-OUTPUT-REC.                               07610022
P42541*    ADD 1 TO PA-SUB-CL-DEL-COUNT.                                07620022
P42541*                                                                 07630022
P42541*    PERFORM 8900-READ-INP10-FILE.                                07640022
P42541*                                                                 07650022
076600******************************************************************07660000
076700 2420-PROCESS-INP09.                                              07670000
076800     MOVE '2420-PROCESS-INP09            ' TO PV-PARAGRAPH-NAME.  07680000
076900                                                                  07690000
077000     INITIALIZE XL039-TRANS-REC.                                  07700004
077100                                                                  07710000
077200     MOVE '1'  TO XL039-ACTION-TYPE.                              07720004
077300     MOVE 'S'  TO XL039-RECORD-TYPE.                              07730004
077400     MOVE '05' TO XL039-SORT-SEQUENCE.                            07740004
077500                                                                  07750000
077600     MOVE HM014-SUB-CL-DEPT-NBR      TO XL039-SUB-CL-DEPT-NBR.    07760005
077700     MOVE HM014-SUB-CL-MAJ-CL-NBR    TO XL039-SUB-CL-MAJ-CL-NBR.  07770005
077800     MOVE HM014-SUB-CL-NBR           TO XL039-SUB-CL-NBR.         07780005
077900     MOVE HM014-SUB-CL-NM            TO XL039-SUB-CL-NM.          07790005
078000     MOVE HM014-SUB-CL-POS-MDSE-DESC TO XL039-SUB-CL-MDSE-DESC.   07800005
078100     MOVE HM014-SUB-CL-TAX-DFLT-IND  TO XL039-TAX-DFLT-IND.       07810005
078200     MOVE HM014-SUB-CL-DISC-ELIG-IND TO XL039-DISC-ELIG-IND.      07820005
078300                                                                  07830000
078400     PERFORM 9000-WRITE-OUTPUT-REC.                               07840000
078500     ADD 1 TO PA-SUB-CL-ISRT-COUNT.                               07850004
078600                                                                  07860000
078700     PERFORM 8800-READ-INP09-FILE.                                07870004
078800                                                                  07880000
078900******************************************************************07890000
079000*            I N P U T   F I L E   R E A D S                     *07900000
079100******************************************************************07910000
079200 8000-READ-INP01-FILE.                                            07920000
079300     MOVE '8000-READ-INP01-FILE          ' TO PV-PARAGRAPH-NAME.  07930000
079400                                                                  07940000
079500     READ RMS-BUS-AREA-FILE INTO HMRD014-BUS-AREA-RECORD          07950002
079600       AT END                                                     07960000
079700         SET PS-EMPTY-FILE-YES TO TRUE                            07970000
079800         SET PS-EOF-RMS-YES    TO TRUE.                           07980000
079900                                                                  07990000
080000******************************************************************08000000
080100 8100-READ-INP02-FILE.                                            08010002
080200     MOVE '8100-READ-INP02-FILE          ' TO PV-PARAGRAPH-NAME.  08020002
080300                                                                  08030000
080400     READ DB2-BUS-AREA-FILE INTO DCLXLT00000                      08040002
080500       AT END                                                     08050000
080600         SET PS-EOF-DB2-YES TO TRUE.                              08060000
080700                                                                  08070000
080800******************************************************************08080000
080900 8200-READ-INP03-FILE.                                            08090002
081000     MOVE '8200-READ-INP03-FILE          ' TO PV-PARAGRAPH-NAME.  08100002
081100                                                                  08110000
081200     READ RMS-BUS-GRP-FILE INTO HMRD014-BUS-GP-RECORD             08120002
081300       AT END                                                     08130000
081400         SET PS-EMPTY-FILE-YES TO TRUE                            08140000
081500         SET PS-EOF-RMS-YES    TO TRUE.                           08150000
081600                                                                  08160000
081700******************************************************************08170000
081800 8300-READ-INP04-FILE.                                            08180002
081900     MOVE '8300-READ-INP04-FILE          ' TO PV-PARAGRAPH-NAME.  08190002
082000                                                                  08200000
082100     READ DB2-BUS-GRP-FILE INTO DCLXLT00001                       08210002
082200       AT END                                                     08220000
082300         SET PS-EOF-DB2-YES TO TRUE.                              08230000
082400                                                                  08240000
082500******************************************************************08250000
082600 8400-READ-INP05-FILE.                                            08260002
082700     MOVE '8400-READ-INP05-FILE          ' TO PV-PARAGRAPH-NAME.  08270002
082800                                                                  08280000
082900     READ RMS-DEPT-FILE INTO HMRD014-DEPT-RECORD                  08290002
083000       AT END                                                     08300000
083100         SET PS-EMPTY-FILE-YES TO TRUE                            08310000
083200         SET PS-EOF-RMS-YES    TO TRUE.                           08320000
083300                                                                  08330000
083400******************************************************************08340000
083500 8500-READ-INP06-FILE.                                            08350002
083600     MOVE '8500-READ-INP06-FILE          ' TO PV-PARAGRAPH-NAME.  08360002
083700                                                                  08370000
083800     READ DB2-DEPT-FILE INTO DCLXLT00002                          08380002
083900       AT END                                                     08390000
084000         SET PS-EOF-DB2-YES TO TRUE.                              08400000
084100                                                                  08410000
084200******************************************************************08420000
084300 8600-READ-INP07-FILE.                                            08430002
084400     MOVE '8600-READ-INP07-FILE          ' TO PV-PARAGRAPH-NAME.  08440002
084500                                                                  08450000
084600     READ RMS-MAJ-CL-FILE INTO HMRD014-MAJ-CL-RECORD              08460002
084700       AT END                                                     08470000
084800         SET PS-EMPTY-FILE-YES TO TRUE                            08480000
084900         SET PS-EOF-RMS-YES    TO TRUE.                           08490000
085000                                                                  08500000
085100******************************************************************08510000
085200 8700-READ-INP08-FILE.                                            08520002
085300     MOVE '8700-READ-INP08-FILE          ' TO PV-PARAGRAPH-NAME.  08530002
085400                                                                  08540000
085500     READ DB2-MAJ-CL-FILE INTO DCLXLT00022                        08550002
085600       AT END                                                     08560000
085700         SET PS-EOF-DB2-YES TO TRUE.                              08570000
085800                                                                  08580000
085900******************************************************************08590000
086000 8800-READ-INP09-FILE.                                            08600002
086100     MOVE '8800-READ-INP09-FILE          ' TO PV-PARAGRAPH-NAME.  08610002
086200                                                                  08620000
086300     READ RMS-SUB-CL-FILE INTO HMRD014-SUB-CL-RECORD              08630002
086400       AT END                                                     08640000
086500         SET PS-EMPTY-FILE-YES TO TRUE                            08650000
086600         SET PS-EOF-RMS-YES    TO TRUE.                           08660000
086700                                                                  08670000
086800******************************************************************08680000
086900 8900-READ-INP10-FILE.                                            08690002
087000     MOVE '8900-READ-INP10-FILE          ' TO PV-PARAGRAPH-NAME.  08700002
087100                                                                  08710000
087200     READ DB2-SUB-CL-FILE INTO DCLXLT00023                        08720002
087300       AT END                                                     08730000
087400         SET PS-EOF-DB2-YES TO TRUE.                              08740000
087500                                                                  08750000
087600******************************************************************08760000
087700******************************************************************08770000
087800 9000-WRITE-OUTPUT-REC.                                           08780000
087900                                                                  08790000
088000     WRITE OUTPUT-FILE-REC FROM XL039-TRANS-REC.                  08800004
088100                                                                  08810000
088200     IF CC-DATA-INTEGRITY                                         08820000
088300         MOVE 4094 TO RETURN-CODE                                 08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088600******************************************************************08860000
088700*                 E N D   O F   J O B                            *08870000
088800******************************************************************08880000
088900 9999-TERMINATE.                                                  08890000
089000     MOVE '9999-TERMINATE                ' TO PV-PARAGRAPH-NAME.  08900000
089100                                                                  08910000
089200     CLOSE OUTPUT-FILE.                                           08920000
089300                                                                  08930000
089400     DISPLAY '**************************'.                        08940008
089500     DISPLAY '*******  XLKUT072  *******'.                        08950008
089600     DISPLAY '**************************'.                        08960008
089700     DISPLAY 'BUS AREA INSERTS = ' PA-BUS-AREA-ISRT-COUNT.        08970002
089800     DISPLAY 'BUS AREA DELETES = ' PA-BUS-AREA-DEL-COUNT.         08980002
089900     DISPLAY 'BUS AREA UPDATES = ' PA-BUS-AREA-UPD-COUNT.         08990002
090000     DISPLAY ' '.                                                 09000000
090100     DISPLAY 'BUS GRP INSERTS  = ' PA-BUS-GRP-ISRT-COUNT.         09010002
090200     DISPLAY 'BUS GRP DELETES  = ' PA-BUS-GRP-DEL-COUNT.          09020002
090300     DISPLAY 'BUS GRP UPDATES  = ' PA-BUS-GRP-UPD-COUNT.          09030002
090400     DISPLAY ' '.                                                 09040000
090500     DISPLAY 'DEPT INSERTS     = ' PA-DEPT-ISRT-COUNT.            09050002
090600     DISPLAY 'DEPT DELETES     = ' PA-DEPT-DEL-COUNT.             09060002
090700     DISPLAY 'DEPT UPDATES     = ' PA-DEPT-UPD-COUNT.             09070002
090800     DISPLAY ' '.                                                 09080000
090900     DISPLAY 'MAJ CL INSERTS   = ' PA-MAJ-CL-ISRT-COUNT.          09090002
091000     DISPLAY 'MAJ CL DELETES   = ' PA-MAJ-CL-DEL-COUNT.           09100002
091100     DISPLAY 'MAJ CL UPDATES   = ' PA-MAJ-CL-UPD-COUNT.           09110002
091200     DISPLAY ' '.                                                 09120000
091300     DISPLAY 'SUB CL INSERTS   = ' PA-SUB-CL-ISRT-COUNT.          09130002
091400     DISPLAY 'SUB CL DELETES   = ' PA-SUB-CL-DEL-COUNT.           09140002
091500     DISPLAY 'SUB CL UPDATES   = ' PA-SUB-CL-UPD-COUNT.           09150002
091600     DISPLAY '**************************'.                        09160008
091700                                                                  09170000
091800******************************************************************09180000
091900******************************************************************09190000
