000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TXKRP052.                                00050000
000600 AUTHOR.                 DANIEL OKYERE.                           00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           OCTOBER 2007.                            00080000
000900 DATE-COMPILED.          OCTOBER 2007.                            00090000
001000******************************************************************00100000
001100*  THIS PROGRAM CREATES THE NEW YORK E-COMMERCE COUNTY REPORT.   *00110000
001200******************************************************************00120000
SEPHOR* CHANGE LOG:                                                    *00131001
SEPHOR*  04/28/2022                                                    *00131201
SEPHOR*     CHANGE MADE: ADDED SEPHORA DEPT 712 TO THE LIST OF DEPTS   *00132001
SEPHOR*     IN PV-NON-TAX-RPT-DEPT TO BE EXCLUDED FROM THE REPORT.     *00132101
SEPHOR*  MADE BY: BARB SCHULTZ               WR/IR#: CHG0269533        *00133005
001300******************************************************************00134001
001400 ENVIRONMENT DIVISION.                                            00140000
001500******************************************************************00150000
001600                                                                  00160000
001700 CONFIGURATION SECTION.                                           00170000
001800                                                                  00180000
001900 SOURCE-COMPUTER.    IBM-3090.                                    00190000
002000 OBJECT-COMPUTER.    IBM-3090.                                    00200000
002100                                                                  00210000
002200 INPUT-OUTPUT SECTION.                                            00220000
002300                                                                  00230000
002400 FILE-CONTROL.                                                    00240000
002500                                                                  00250000
002600     SELECT INPUT-FILE                                            00260000
002700         ASSIGN TO INP01.                                         00270000
002800                                                                  00280000
002900     SELECT POS-DATE-CARD-FILE                                    00290000
003000         ASSIGN TO INP02.                                         00300000
003100                                                                  00310000
003200     SELECT OUTPUT-FILE                                           00320000
003300         ASSIGN TO OUT01.                                         00330000
003400                                                                  00340000
003500******************************************************************00350000
003600 DATA DIVISION.                                                   00360000
003700******************************************************************00370000
003800                                                                  00380000
003900 FILE SECTION.                                                    00390000
004000                                                                  00400000
004100 FD  INPUT-FILE                                                   00410000
004700     RECORDING MODE IS F                                          00470000
004701     LABEL RECORDS ARE STANDARD.                                  00470100
004702                                                                  00470200
004703 01  INPUT-RECORD                    PIC X(220).                  00470300
004704                                                                  00470400
004705 FD  POS-DATE-CARD-FILE                                           00470500
004706     RECORDING MODE IS F                                          00470600
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     LABEL RECORDS ARE STANDARD.                                  00490000
005000                                                                  00500000
005100 01  POS-DATE-CARD-RECORD            PIC X(80).                   00510000
005200                                                                  00520000
005300 FD  OUTPUT-FILE                                                  00530000
005310     RECORDING MODE IS F                                          00531000
005400     LABEL RECORDS ARE STANDARD.                                  00540000
005500                                                                  00550000
005600 01  OUTPUT-RECORD                   PIC X(132).                  00560000
005700                                                                  00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900                                                                  00590000
006000******************************************************************00600000
006100* RECORD LAYOUT FOR INPUT DATE CARD                               00610000
006200* LISTS THE FIRST AND LAST DAYS OF THE FISCAL PERIOD.             00620000
006300* LAYOUT:   CCYYMMDD CCYYMMDD                                     00630000
006400******************************************************************00640000
006500 01  CC-DATE-CARD.                                                00650000
006600     05  CC-RPT-TYPE                    PIC X(01).                00660000
006700         88 CC-RPT-810                            VALUE 'T'.      00670000
006800         88 CC-RPT-SCHA                           VALUE 'A'.      00680000
006900         88 CC-RPT-SCHB                           VALUE 'B'.      00690000
007000     05  CC-TO-DATE                     PIC X(08) VALUE SPACES.   00700000
007100     05  FILLER                         PIC X(71) VALUE SPACES.   00710000
007200                                                                  00720000
007300***************************************************************** 00730000
007400* COPYBOOK LAYOUT FOR INPUT FILE                                * 00740000
007500***************************************************************** 00750000
007600     COPY TXRD052.                                                00760000
007700                                                                  00770000
007800******************************************************************00780000
007900*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             00790000
008000******************************************************************00800000
008100     COPY DPWS500.                                                00810000
008200                                                                  00820000
008300 01 PC-PROGRAM-CONSTANTS.                                         00830000
008400    05  PC-CURRENT-PROGRAM-NAME        PIC  X(08) VALUE           00840000
008500                                                     'TXKRP052'.  00850000
008600                                                                  00860000
008700 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      00870000
008800                                                  COMP SYNC.      00880000
008900     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00890000
009000     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00900000
009100                                                                  00910000
009200 01 PS-PROGRAM-SWITCHES.                                          00920000
009300    05 PS-END-OF-INPUT-FILE-SW         PIC X(01) VALUE 'N'.       00930000
009400       88 PS-END-OF-INPUT-FILE                   VALUE 'Y'.       00940000
009500    05 PS-END-OF-DATE-FILE-SW          PIC X(01) VALUE 'N'.       00950000
009600       88  PS-END-OF-DATE-FILE                   VALUE 'Y'.       00960000
009700                                                                  00970000
009800 01 PV-PROGRAM-VARIABLES.                                         00980000
009900    05 PV-PARAGRAPH-NAME               PIC  X(30)    VALUE SPACE. 00990000
010000    05 PV-OPERATION-MSG-1              PIC  X(40)    VALUE SPACE. 01000000
010100    05 PV-DEPT-NBR                     PIC X(03)     VALUE SPACES.01010000
SEPHOR       88 PV-NON-TAX-RPT-DEPT            VALUES '981' '983' '712'.01020001
010300    05 PV-INPUT-COUNT                  PIC  9(07)    VALUE ZERO.  01030000
010400    05 PV-INCLUDE-COUNT                PIC  9(07)    VALUE ZERO.  01040000
010500    05 PV-EXCLUDE-COUNT                PIC  9(07)    VALUE ZERO.  01050000
010600    05 PV-ADD-TAXABLE-AMOUNT           PIC S9(07)V99 VALUE ZERO.  01060000
010700    05 PV-ADD-TAX                      PIC S9(07)V99 VALUE ZERO.  01070000
010800    05 PV-TOTAL-TAXABLE-AMOUNT         PIC S9(10)V99 VALUE ZERO.  01080000
010900    05 PV-TOTAL-TAX                    PIC S9(10)V99 VALUE ZERO.  01090000
011000    05 PV-CITY-TAXABLE-AMOUNT          PIC S9(10)V99 VALUE ZERO.  01100000
011100    05 PV-CITY-TAX                     PIC S9(10)V99 VALUE ZERO.  01110000
011200    05 PV-COUNTY-TAXABLE-AMOUNT        PIC S9(10)V99 VALUE ZERO.  01120000
011300    05 PV-COUNTY-TAX                   PIC S9(10)V99 VALUE ZERO.  01130000
011400    05 PV-COUNTY-NAME                  PIC  X(26)    VALUE SPACES.01140000
011500    05 PV-CITY-NAME                    PIC  X(26)    VALUE SPACES.01150000
011600    05 PV-PRINT-RECORD                 PIC  X(132)   VALUE SPACES.01160000
011700    05 PV-LINE-SPACING                 PIC S9(04)    VALUE ZERO   01170000
011800                                                     COMP SYNC.   01180000
011900    05 PV-RATE1                        PIC 9V9(5)    VALUE ZERO.  01190000
012000    05 PV-RATE2                        PIC 9V9(5)    VALUE ZERO.  01200000
012100    05 PV-RATE3                        PIC 9V9(5)    VALUE ZERO.  01210000
012101    05 HAS-ZERO-RATE                   PIC X         VALUE 'N'.   01210100
012102    05 PV-COMP-START-DTE.                                         01210200
012103       10 PV-COMP-START-CCYY           PIC X(04).                 01210300
012104       10 PV-COMP-START-MM             PIC X(02).                 01210400
012200       10 PV-COMP-START-DD             PIC X(02).                 01220000
012300    05 PV-COMP-END-DTE.                                           01230000
012400       10 PV-COMP-END-CCYY             PIC X(04).                 01240000
012500       10 PV-COMP-END-MM               PIC X(02).                 01250000
012600       10 PV-COMP-END-DD               PIC X(02).                 01260000
012700******************************************************************01270000
012800*  HEADING LINES FOR THE NEW YORK ECOMMERCE REPORT                01280000
012900******************************************************************01290000
013000 01  RH-HEADER2.                                                  01300000
013100     05 FILLER                         PIC X(04) VALUE SPACES.    01310000
013200     05 FILLER                         PIC X(04) VALUE 'CITY'.    01320000
013300     05 FILLER                         PIC X(25) VALUE SPACES.    01330000
013400     05 FILLER                         PIC X(13) VALUE            01340000
013500                                                'TAXABLE SALES'.  01350000
013600     05 FILLER                         PIC X(03) VALUE SPACES.    01360000
013700     05 FILLER                         PIC X(09) VALUE            01370000
013800                                                'SALES TAX'.      01380000
013900     05 FILLER                         PIC X(06) VALUE SPACES.    01390000
014000     05 FILLER                         PIC X(11) VALUE            01400000
014100                                                'COUNTY NAME'.    01410000
014200     05 FILLER                         PIC X(18) VALUE SPACES.    01420000
014300     05 FILLER                         PIC X(12) VALUE            01430000
014400                                                'COUNTY SALES'.   01440000
014500     05 FILLER                         PIC X(05) VALUE SPACES.    01450000
014600     05 FILLER                         PIC X(10) VALUE            01460000
014700                                                'COUNTY TAX'.     01470000
014800                                                                  01480000
014900 01  DTL-DETAIL.                                                  01490000
015000     05 FILLER                         PIC X(01) VALUE SPACES.    01500000
015001     05 DTL-CITY-WARNING               PIC X(01) VALUE SPACES.    01500100
015002     05 FILLER                         PIC X(02) VALUE SPACES.    01500200
015100     05 DTL-CITY-NAME                  PIC X(26) VALUE SPACES.    01510000
015200     05 FILLER                         PIC X(03) VALUE SPACES.    01520000
015300     05 DTL-TAXABLE-AMOUNT             PIC ZZ,ZZZ,ZZ9.99-.        01530000
015400     05 FILLER                         PIC X(01) VALUE SPACES.    01540000
015500     05 DTL-TAX-AMOUNT                 PIC ZZZ,ZZ9.99-.           01550000
015600     05 DTL-RATE-DATA                  PIC X(30) VALUE SPACES.    01560000
015700                                                                  01570000
015800 01  TOT-CNTY-LINE.                                               01580000
015900     05 FILLER                         PIC X(62) VALUE SPACES.    01590000
015901     05 TOT-CNTY-WARNING               PIC X(01) VALUE SPACES.    01590100
015902     05 FILLER                         PIC X(01) VALUE SPACES.    01590200
016000     05 TOT-COUNTY-NAME                PIC X(26) VALUE SPACES.    01600000
016100     05 FILLER                         PIC X(01) VALUE SPACES.    01610000
016200     05 TOT-TAXABLE-AMOUNT             PIC ZZZ,ZZZ,ZZ9.99-.       01620000
016300     05 FILLER                         PIC X(01) VALUE SPACES.    01630000
016400     05 TOT-TAX-AMOUNT                 PIC ZZ,ZZZ,ZZ9.99-.        01640000
016500     05 FILLER                         PIC X(11) VALUE SPACES.    01650000
016600                                                                  01660000
016700 01  RATE-DATA.                                                   01670000
016800     05 FILLER                         PIC X(01) VALUE SPACES.    01680000
016900     05 FILLER                         PIC X(08) VALUE 'Rates ( '.01690000
017000     05 RL-RATE1X.                                                01700000
017100          07 RL-RATE1                  PIC ZZ.ZZZ.                01710000
017200     05 RL-RATE2X.                                                01720000
017300          07 RL-RATE2                  PIC ZZ.ZZZ.                01730000
017400     05 RL-RATE3X.                                                01740000
017500          07 RL-RATE3                  PIC ZZ.ZZZ.                01750000
017600     05 FILLER                         PIC X(02) VALUE ' )'.      01760000
017700                                                                  01770000
017701                                                                  01770100
017702******************************************************************01770200
017703 PROCEDURE DIVISION.                                              01770300
017704******************************************************************01770400
017705 0000-MAINLINE.                                                   01770500
017706                                                                  01770600
017707     PERFORM 1000-INITIALIZE-PROGRAM.                             01770700
017708                                                                  01770800
017709     PERFORM 2000-PROCESS-INPUT-FILE                              01770900
017710       UNTIL PS-END-OF-INPUT-FILE.                                01771000
017711                                                                  01771100
017712     PERFORM 6000-WRITE-GRAND-TOTAL-LINE.                         01771200
017800                                                                  01780000
017900     CLOSE INPUT-FILE.                                            01790000
018100     GOBACK.                                                      01810000
018200                                                                  01820000
018300******************************************************************01830000
018400* 1000-INITIALIZE-PROGRAM                                         01840000
018500*     OPEN FILES, PROCESS CONTROL CARD                            01850000
018600******************************************************************01860000
018700 1000-INITIALIZE-PROGRAM.                                         01870000
018800                                                                  01880000
018900     OPEN INPUT  POS-DATE-CARD-FILE                               01890000
019000                 INPUT-FILE                                       01900000
019100          OUTPUT OUTPUT-FILE.                                     01910000
019200                                                                  01920000
019300     PERFORM 1300-PROCESS-DATE-CARD.                              01930000
019400     PERFORM 5000-READ-INPUT-FILE.                                01940000
019500     IF INPUT-RECORD(1:5) = 'Str#,' AND NOT PS-END-OF-INPUT-FILE  01950000
019600         PERFORM 5000-READ-INPUT-FILE                             01960000
019700     END-IF                                                       01970000
019800     IF NOT PS-END-OF-INPUT-FILE                                  01980000
019900         MOVE TX052-CITY-NAME   TO PV-CITY-NAME                   01990000
020000         MOVE TX052-COUNTY-NAME TO PV-COUNTY-NAME                 02000000
020100         IF TX052-TAX-RATE = ZERO                                 02010000
020200            MOVE 'Y' TO HAS-ZERO-RATE                             02020000
020300         END-IF                                                   02030000
020400         IF TX052-TAX-RATE NOT = PV-RATE1                         02040000
020500             IF PV-RATE1 = ZERO                                   02050000
020600                 MOVE TX052-TAX-RATE    TO PV-RATE1               02060000
020700             ELSE                                                 02070000
020800                 IF TX052-TAX-RATE NOT = PV-RATE2                 02080000
020900                     IF PV-RATE2 = ZERO                           02090000
021000                         MOVE TX052-TAX-RATE    TO PV-RATE2       02100000
021100                     ELSE                                         02110000
021200                         MOVE TX052-TAX-RATE    TO PV-RATE3       02120000
021300                     END-IF                                       02130000
021400                 END-IF                                           02140000
021500             END-IF                                               02150000
021600         END-IF                                                   02160000
021700     END-IF.                                                      02170000
021701                                                                  02170100
021702                                                                  02170200
021703     PERFORM 8000-PRINT-HEADINGS.                                 02170300
021704                                                                  02170400
021705******************************************************************02170500
021706* 1300-PROCESS-DATE-CARD                                          02170600
021707******************************************************************02170700
021708 1300-PROCESS-DATE-CARD.                                          02170800
021709                                                                  02170900
021710     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         02171000
021711                                                                  02171100
021712     READ POS-DATE-CARD-FILE INTO CC-DATE-CARD                    02171200
021713         AT END                                                   02171300
021714             SET PS-END-OF-DATE-FILE TO TRUE                      02171400
021715     END-READ.                                                    02171500
021716                                                                  02171600
021717     IF PS-END-OF-DATE-FILE                                       02171700
021718         MOVE '1300-PROCESS-DATE-CARD'  TO PV-PARAGRAPH-NAME      02171800
021719         MOVE 'DATE CARD MISSING      ' TO PV-OPERATION-MSG-1     02171900
021720         SET AC-CONTROL-CARD-ERROR TO TRUE                        02172000
021730         PERFORM 9999-ABEND                                       02173000
021800     END-IF.                                                      02180000
021900                                                                  02190000
022000     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     02200000
022100     SET DPG52-LK-DTE-ISO            TO TRUE.                     02210000
022200                                                                  02220000
022300     MOVE CC-TO-DATE                 TO DPG52-DB2-ISO-DATE.       02230000
022400                                                                  02240000
022500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    02250000
022600                                             DPG54 DPG55 DPG56.   02260000
022700     IF  DPG54-SEVERE-ERROR                                       02270000
022800         DISPLAY '*********************************'              02280000
022900         DISPLAY '** ABEND FROM CALL SUB         **'              02290000
023000         DISPLAY '** PROGRAM = TXKRP052          **'              02300000
023100         DISPLAY '** DATE = ' CC-TO-DATE '       **'              02310000
023200         DISPLAY '*********************************'              02320000
023300         DISPLAY DPG54-ERROR-MESSAGE                              02330000
023400         SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                    02340000
023500         PERFORM 9999-ABEND                                       02350000
023600     ELSE                                                         02360000
023700         IF  DPG54-DATE-INVALID                                   02370000
023800              DISPLAY '****************************'              02380000
023900              DISPLAY '** ABEND INVALID END DATE **'              02390000
024000              DISPLAY '** PROGRAM = TXKRP052     **'              02400000
024100              DISPLAY '** DATE = ' CC-TO-DATE '  **'              02410000
024200              DISPLAY '****************************'              02420000
024300              DISPLAY DPG54-ERROR-MESSAGE                         02430000
024400              SET AC-CONTROL-CARD-ERROR TO TRUE                   02440000
024500              PERFORM 9999-ABEND                                  02450000
024600         END-IF                                                   02460000
024700     END-IF.                                                      02470000
024800                                                                  02480000
024900     MOVE DPG56-FIRST-FP-GREG-CC-YR TO PV-COMP-START-CCYY.        02490000
025000     MOVE DPG56-FIRST-FP-GREG-CC-MO TO PV-COMP-START-MM.          02500000
025100     MOVE DPG56-FIRST-FP-GREG-CC-DY TO PV-COMP-START-DD.          02510000
025200     MOVE DPG56-LAST-FP-GREG-CC-YR  TO PV-COMP-END-CCYY.          02520000
025300     MOVE DPG56-LAST-FP-GREG-CC-MO  TO PV-COMP-END-MM.            02530000
025400     MOVE DPG56-LAST-FP-GREG-CC-DY  TO PV-COMP-END-DD.            02540000
025600*-------------------------------------------------------------*   02560000
025700* 2000-PROCESS-INPUT-FILE                                     *   02570000
025800*-------------------------------------------------------------*   02580000
025900 2000-PROCESS-INPUT-FILE.                                         02590000
026000                                                                  02600000
026100     MOVE TX052-DEPT-NBR TO PV-DEPT-NBR.                          02610000
026200                                                                  02620000
026300     IF PV-NON-TAX-RPT-DEPT                                       02630000
026400         ADD 1 TO PV-EXCLUDE-COUNT                                02640000
026500     ELSE                                                         02650000
026600         IF TX052-COUNTY-NAME = PV-COUNTY-NAME                    02660000
026700             IF TX052-CITY-NAME = PV-CITY-NAME                    02670000
026800                 CONTINUE                                         02680000
026900             ELSE                                                 02690000
027000                 PERFORM 3000-WRITE-CITY-LINE                     02700000
027100             END-IF                                               02710000
027200         ELSE                                                     02720000
027300             PERFORM 3000-WRITE-CITY-LINE                         02730000
027400             PERFORM 4000-WRITE-COUNTY-LINE                       02740000
027500         END-IF                                                   02750000
027600                                                                  02760000
027700         MOVE TX052-TAX-AMT   TO PV-ADD-TAX                       02770000
027800         MOVE TX052-GROSS-AMT TO PV-ADD-TAXABLE-AMOUNT            02780000
027900                                                                  02790000
028000         IF TX052-CREDIT-YES                                      02800000
028100             MULTIPLY -1 BY PV-ADD-TAXABLE-AMOUNT                 02810000
028200             MULTIPLY -1 BY PV-ADD-TAX                            02820000
028300         END-IF                                                   02830000
028400                                                                  02840000
028500         IF TX052-PROCESS-DTE >= PV-COMP-START-DTE AND            02850000
028600            TX052-PROCESS-DTE <= PV-COMP-END-DTE                  02860000
028700             ADD 1 TO PV-INCLUDE-COUNT                            02870000
028800             ADD PV-ADD-TAXABLE-AMOUNT TO PV-TOTAL-TAXABLE-AMOUNT 02880000
028900                                          PV-CITY-TAXABLE-AMOUNT  02890000
029000                                          PV-COUNTY-TAXABLE-AMOUNT02900000
029100             ADD PV-ADD-TAX            TO PV-TOTAL-TAX            02910000
029200                                          PV-CITY-TAX             02920000
029300                                          PV-COUNTY-TAX           02930000
029400             IF TX052-WARNING NOT = SPACES                        02940000
029500                MOVE TX052-WARNING        TO TOT-CNTY-WARNING     02950000
029600                                             DTL-CITY-WARNING     02960000
029700             END-IF                                               02970000
029800             IF TX052-TAX-RATE = ZERO                             02980000
029900                MOVE 'Y' TO HAS-ZERO-RATE                         02990000
030000             END-IF                                               03000000
030100             IF TX052-TAX-RATE NOT = PV-RATE1                     03010000
030200                 IF PV-RATE1 = ZERO                               03020000
030300                     MOVE TX052-TAX-RATE    TO PV-RATE1           03030000
030400                 ELSE                                             03040000
030500                     IF TX052-TAX-RATE NOT = PV-RATE2             03050000
030600                         IF PV-RATE2 = ZERO                       03060000
030700                             MOVE TX052-TAX-RATE    TO PV-RATE2   03070000
030800                         ELSE                                     03080000
030900                             MOVE TX052-TAX-RATE    TO PV-RATE3   03090000
031000                         END-IF                                   03100000
031100                     END-IF                                       03110000
031200                 END-IF                                           03120000
031201             END-IF                                               03120100
031202         ELSE                                                     03120200
031203             ADD 1 TO PV-EXCLUDE-COUNT                            03120300
031204         END-IF                                                   03120400
031205     END-IF.                                                      03120500
031206                                                                  03120600
031207     PERFORM 5000-READ-INPUT-FILE.                                03120700
031208                                                                  03120800
031209*--------------------------------------------------------------*  03120900
031210* 3000-WRITE-CITY-LINE                                         *  03121000
031211*--------------------------------------------------------------*  03121100
031212 3000-WRITE-CITY-LINE.                                            03121200
031213                                                                  03121300
031214     IF PV-CITY-TAXABLE-AMOUNT NOT = 0                            03121400
031215         MOVE PV-CITY-NAME           TO DTL-CITY-NAME             03121500
031216         MOVE PV-CITY-TAXABLE-AMOUNT TO DTL-TAXABLE-AMOUNT        03121600
031217         MOVE PV-CITY-TAX            TO DTL-TAX-AMOUNT            03121700
031218         IF PV-RATE1 > 0 OR HAS-ZERO-RATE = 'Y'                   03121800
031219             COMPUTE RL-RATE1 = PV-RATE1 * 100                    03121900
031220             COMPUTE RL-RATE2 = PV-RATE2 * 100                    03122000
031230             COMPUTE RL-RATE3 = PV-RATE3 * 100                    03123000
031240             IF HAS-ZERO-RATE = 'Y'                               03124000
031250                IF PV-RATE2 = ZERO                                03125000
031260                   MOVE ' 0.000' TO RL-RATE2X                     03126000
031270                ELSE                                              03127000
031280                   MOVE ' 0.000' TO RL-RATE3X                     03128000
031290                END-IF                                            03129000
031300             END-IF                                               03130000
031400             MOVE RATE-DATA     TO DTL-RATE-DATA                  03140000
031500             MOVE ZEROES TO PV-RATE1 PV-RATE2 PV-RATE3            03150000
031600             MOVE 'N'           TO HAS-ZERO-RATE                  03160000
031700         ELSE                                                     03170000
031800             MOVE SPACES        TO DTL-RATE-DATA                  03180000
031801         END-IF                                                   03180100
031802         MOVE DTL-DETAIL TO PV-PRINT-RECORD                       03180200
031803         PERFORM 8200-WRITE-REPORT-LINE                           03180300
031804         MOVE SPACES            TO DTL-CITY-WARNING               03180400
031805     END-IF.                                                      03180500
031806                                                                  03180600
031807     MOVE TX052-CITY-NAME TO PV-CITY-NAME.                        03180700
031808     MOVE ZEROES          TO PV-CITY-TAXABLE-AMOUNT               03180800
031809                             PV-CITY-TAX.                         03180900
031810                                                                  03181000
031900*--------------------------------------------------------------*  03190000
032000* 4000-WRITE-COUNTY-LINE                                       *  03200000
032100*--------------------------------------------------------------*  03210000
032200 4000-WRITE-COUNTY-LINE.                                          03220000
032300                                                                  03230000
032400     IF PV-COUNTY-TAXABLE-AMOUNT NOT = 0                          03240000
032500         MOVE PV-COUNTY-NAME           TO TOT-COUNTY-NAME         03250000
032600         MOVE PV-COUNTY-TAXABLE-AMOUNT TO TOT-TAXABLE-AMOUNT      03260000
032700         MOVE PV-COUNTY-TAX            TO TOT-TAX-AMOUNT          03270000
032900         MOVE TOT-CNTY-LINE TO PV-PRINT-RECORD                    03290000
033000         PERFORM 8200-WRITE-REPORT-LINE                           03300000
033010         MOVE SPACES                   TO TOT-CNTY-WARNING        03301000
033100     END-IF.                                                      03310000
033200                                                                  03320000
033300     MOVE TX052-CITY-NAME   TO PV-CITY-NAME.                      03330000
033400     MOVE ZEROES            TO PV-CITY-TAXABLE-AMOUNT             03340000
033500                               PV-CITY-TAX.                       03350000
033600     MOVE TX052-COUNTY-NAME TO PV-COUNTY-NAME.                    03360000
033700     MOVE ZEROES            TO PV-COUNTY-TAXABLE-AMOUNT           03370000
033800                               PV-COUNTY-TAX.                     03380000
033900                                                                  03390000
034000***************************************************************** 03400000
034100* READ THE INPUT FILE FOR PROCESSING.                           * 03410000
034200***************************************************************** 03420000
034300 5000-READ-INPUT-FILE.                                            03430000
034400                                                                  03440000
034500     READ INPUT-FILE INTO TX052-TAX-SUMMARY-RECORD                03450000
034600          AT END                                                  03460000
034700             SET PS-END-OF-INPUT-FILE TO TRUE                     03470000
034800          NOT AT END                                              03480000
034900             ADD 1 TO PV-INPUT-COUNT                              03490000
035000     END-READ.                                                    03500000
035100                                                                  03510000
035200*--------------------------------------------------------------*  03520000
035300* 6000-WRITE-GRAND-TOTAL-LINE                                  *  03530000
035400*--------------------------------------------------------------*  03540000
035500 6000-WRITE-GRAND-TOTAL-LINE.                                     03550000
035600                                                                  03560000
035700     PERFORM 3000-WRITE-CITY-LINE.                                03570000
035800     PERFORM 4000-WRITE-COUNTY-LINE.                              03580000
035900                                                                  03590000
036000     IF PV-TOTAL-TAXABLE-AMOUNT NOT = 0                           03600000
036100         MOVE 'GRAND TOTAL'           TO TOT-COUNTY-NAME          03610000
036200         MOVE PV-TOTAL-TAXABLE-AMOUNT TO TOT-TAXABLE-AMOUNT       03620000
036300         MOVE PV-TOTAL-TAX            TO TOT-TAX-AMOUNT           03630000
036400                                                                  03640000
036500         MOVE TOT-CNTY-LINE TO PV-PRINT-RECORD                    03650000
036600         PERFORM 8200-WRITE-REPORT-LINE                           03660000
036700     END-IF.                                                      03670000
036800                                                                  03680000
036900******************************************************************03690000
037000 8000-PRINT-HEADINGS.                                             03700000
037100*     PRINT THE HEADINGS FOR THE REPORT.                          03710000
037200******************************************************************03720000
037300                                                                  03730000
037400     MOVE RH-HEADER2                  TO PV-PRINT-RECORD.         03740000
037500     PERFORM 8200-WRITE-REPORT-LINE.                              03750000
037600                                                                  03760000
037700******************************************************************03770000
037800 8200-WRITE-REPORT-LINE.                                          03780000
037900*     WRITE DETAIL LINES.                                         03790000
038000******************************************************************03800000
038100                                                                  03810000
038200     WRITE OUTPUT-RECORD                                          03820000
038300        FROM PV-PRINT-RECORD                                      03830000
038400           AFTER ADVANCING PV-LINE-SPACING.                       03840000
038500                                                                  03850000
038600     INITIALIZE                          PV-PRINT-RECORD.         03860000
038700                                                                  03870000
038800******************************************************************03880000
038900 9999-ABEND.                                                      03890000
039000*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  03900000
039100******************************************************************03910000
039200                                                                  03920000
039300     DISPLAY '** ABEND           **'.                             03930000
039400     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  03940000
039500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03950000
039600     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       03960000
039700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         03970000
039800                                                                  03980000
039900********************** END OF PROGRAM ****************************03990000
