000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    APKUT111.                                         00040001
000500 AUTHOR.        MIKE BESKE.                                       00050000
000600 DATE-WRITTEN.  MARCH 2000.                                       00060001
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*                       COBOL 2                                 * 00090004
001000*                                                               * 00100000
001100*     COMBINE AGED INVOICE DATA WITH MATCHING UNJOURNALIZED     * 00110047
001200*                                                               * 00120000
001300* THE PURPOSE OF THIS PROGRAM IS TO COMBINE THE INTRANSIT       * 00130001
001400* (UNJOURNALIZED AND NON-INVOICE RECEIPTS) WHEN ACTIVITY OCCURS * 00140001
001500* FOR THE 91-120 AND THE OVER-120 DAYS AGING BUCKETS WITH OPEN  * 00150001
001600* INVOICES.  THE COMBINED FILE WILL BE INPUT FOR THE OPEN       * 00160006
001700* INVOICE AGING REPORT (APKRP262).                              * 00170001
001800*                                                               * 00180000
001900*---------------------------------------------------------------* 00190000
002000*                                                               * 00200000
002100* INPUT:                                                        * 00210000
002200*                                                               * 00220000
002300*  1. OPEN-INVOICE-FILE                 (APRD262)               * 00230047
002400*  2. UNJOURNALIZED-FILE                (APRD042)               * 00240047
002500*  3. NINREC-FILE                       (APRD042)               * 00250047
002600*                                                               * 00260000
002700* OUTPUT:                                                       * 00270000
002800*                                                               * 00280000
002900*  1. COMBINED-FILE                     (APRD262)               * 00290047
003000*                                                               * 00300000
003100*---------------------------------------------------------------* 00310000
003200*  CHANGES:                                                     * 00320000
003300*                                                               * 00330000
003400* 11/17/00 - CHANGED THE RECORD LENGTH ON THE INPUT FILE        * 00340044
003500*            FROM 77 TO 78.  CHANGED THE APRD262I COPYBOOK      * 00350045
003600*            TO APRD262 AND RENAMED ALL FIELDS TO CONFORM       * 00360045
003700*            TO CURRENT STANDARDS.  EXPANDED THE                * 00370045
003800*            DAYS-DELINQUENT FIELD FROM 3 TO 5 POSITIONS.       * 00380045
003900*        BY: NANCY EILBES                      WR#: 20704       * 00390045
004000*                                                               * 00400000
004100* 02/27/01 - CHANGED THE RECORD LENGTH ON THE INPUT FILE        * 00410046
004200*            FROM 78 TO 100.                                    * 00420046
004300*        BY: NANCY EILBES                      WR#: 20704       * 00430046
004400*                                                               * 00440046
004500* 02/07/2003                                                    * 00450048
004600*    CHANGE MADE: ARKPO PHASE3 PROJECT.                         * 00460047
004700*    UPDATED PGM TITLE TO MATCH THE SPEC TITLE.                 * 00470047
004800*    UPDATED PGM COMMENT BLOCK WITH THE FILENAMES.              * 00480047
004900*    CHANGED -PURCHASE-ORDER TO -PO-NBR FOR THE COPYBOOKS AND   * 00490047
005000*    W/S FIELD NAMES.  INCREASED THE W/S -PO-NBR LENGTH FROM 7  * 00500047
005100*    TO 9 BYTES.                                                * 00510047
005200* MADE BY:  MIKE BESKE                          WR#: 23500      * 00520047
005300*                                                               * 00530050
005400* 05/21/2004  CHANGED MADE: STORE CONSTRAINTS PROJECT           * 00540050
005500*             RECOMPILED THIS PROGRAM TO PICK UP THE APRD042    * 00550050
005600*             COPYBOOK MODIFICATIONS.                           * 00560050
005700*             MADE BY: MIKE BESKE             WR/IR #:25805     * 00570050
005800*                                                               * 00580050
005810* 06/12/2008  CHANGED MADE: MATCH BY DC PHASE 2 PROJECT.        * 00581053
005820*             REMOVED ALL REFERENCES TO ENTRY-METHOD, PO-STATUS,* 00582054
005830*             AND HOLD-IND SINCE THESE HAVE BEEN REMOVED FROM   * 00583054
005831*             THE COPYBOOK APRD262.                             * 00583154
005840*             MADE BY: ROLF NOHE              WR/IR #:32804     * 00584051
005850*                                                               * 00585051
005810* 08/15/2021  CHANGED MADE: MOVE SEPHORA INDICATOR TO OUTPUT    * 00586060
005840*             MADE BY: JEAN KURK              CHG0260549        * 00589160
005900*---------------------------------------------------------------* 00590047
006000 EJECT                                                            00600047
006100                                                                  00610047
006200 ENVIRONMENT DIVISION.                                            00620047
006300 CONFIGURATION SECTION.                                           00630047
006400 SOURCE-COMPUTER. IBM-3090.                                       00640047
006500 OBJECT-COMPUTER. IBM-3090.                                       00650047
006600                                                                  00660047
006700                                                                  00670047
006800 INPUT-OUTPUT SECTION.                                            00680047
006900 FILE-CONTROL.                                                    00690047
007000                                                                  00700047
007100     SELECT OPEN-INVOICE-FILE          ASSIGN TO UT-S-INP01.      00710047
007200     SELECT UNJOURNALIZED-FILE         ASSIGN TO UT-S-INP02.      00720047
007300     SELECT NINREC-FILE                ASSIGN TO UT-S-INP03.      00730047
007400     SELECT COMBINED-FILE              ASSIGN TO UT-S-OUT01.      00740047
007500                                                                  00750047
007600 DATA DIVISION.                                                   00760047
007700 FILE SECTION.                                                    00770047
007800                                                                  00780047
007900 FD  OPEN-INVOICE-FILE                                            00790047
008000     RECORDING MODE IS F                                          00800047
008100     BLOCK CONTAINS 0 CHARACTERS                                  00810047
008200     LABEL RECORDS ARE STANDARD                                   00820047
008300     DATA RECORD IS OPEN-INVOICE-RECORD.                          00830047
008400                                                                  00840047
008500 01  OPEN-INVOICE-RECORD        PIC X(100).                       00850047
008600                                                                  00860047
008700 FD  UNJOURNALIZED-FILE                                           00870047
008800     RECORDING MODE IS F                                          00880047
008900     BLOCK CONTAINS 0 CHARACTERS                                  00890047
009000     LABEL RECORDS ARE STANDARD                                   00900047
009100     DATA RECORD IS UNJOURNALIZED-RECORD.                         00910047
009200                                                                  00920047
009300 01  UNJOURNALIZED-RECORD       PIC X(120).                       00930047
009400                                                                  00940047
009500 FD  NINREC-FILE                                                  00950047
009600     RECORDING MODE IS F                                          00960047
009700     BLOCK CONTAINS 0 CHARACTERS                                  00970047
009800     LABEL RECORDS ARE STANDARD                                   00980047
009900     DATA RECORD IS NINREC-RECORD.                                00990047
010000                                                                  01000047
010100 01  NINREC-RECORD              PIC X(120).                       01010047
010200                                                                  01020047
010300 FD  COMBINED-FILE                                                01030047
010400     RECORDING MODE IS F                                          01040047
010500     BLOCK CONTAINS 0 CHARACTERS                                  01050047
010600     LABEL RECORDS ARE STANDARD                                   01060047
010700     DATA RECORD IS COMBINED-RECORD.                              01070047
010800                                                                  01080047
010900 01  COMBINED-RECORD            PIC X(100).                       01090047
011000                                                                  01100047
011100 EJECT                                                            01110047
011200 WORKING-STORAGE SECTION.                                         01120047
011300                                                                  01130047
011400 01  PC-PROGRAM-CONSTANTS.                                        01140047
011500     05  PC-WS-PROGRAM           PIC  X(40)  VALUE                01150047
011600         '**** WORKING STORAGE ** APKUT111 ****'.                 01160047
011700                                                                  01170047
011800 01  PV-PROGRAM-VARIABLES.                                        01180047
011900     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      01190047
012000     05  PV-NULL-IND             PIC S9(4)     VALUE ZERO         01200047
012100                                               COMP SYNC.         01210047
012200                                                                  01220047
012300     05  PV-DATE-CCYY-MM-DD      PIC  X(10)    VALUE SPACES.      01230047
012400     05  PV-OPEN-COUNT           PIC S9(9)     VALUE ZEROS        01240047
012500                                               COMP.              01250047
012600     05  PV-UNJRNL-COUNT         PIC S9(9)     VALUE ZEROS        01260047
012700                                               COMP.              01270047
012800     05  PV-NINREC-COUNT         PIC S9(9)     VALUE ZEROS        01280047
012900                                               COMP.              01290047
013000     05  PV-COMBINED-COUNT       PIC S9(9)     VALUE ZEROS        01300047
013100                                               COMP.              01310047
013200     05  PV-UNJRNL-BYPASSED-COUNT PIC S9(9)    VALUE ZEROS        01320047
013300                                               COMP.              01330047
013400     05  PV-NINREC-BYPASSED-COUNT PIC S9(9)    VALUE ZEROS        01340047
013500                                               COMP.              01350047
013600     05  PV-UNJRNL-UNMATCHED-COUNT PIC S9(9)   VALUE ZEROS        01360047
013700                                               COMP.              01370047
013800     05  PV-NINREC-UNMATCHED-COUNT PIC S9(9)   VALUE ZEROS        01380047
013900                                               COMP.              01390047
014000     05  PW-CURRENT-PARAGRAPH    PIC  X(30)    VALUE SPACES.      01400047
014100     05  ABEND-CODE              PIC S9(04)    VALUE ZEROES       01410047
014200                                               COMP SYNC.         01420047
014300         88 WRITE-ERROR                             VALUE +4001.  01430047
014400         88 READ-ERROR                              VALUE +4002.  01440047
014500         88 CC-ERRROR                               VALUE +4003.  01450047
014600         88 TABLE-ERROR                             VALUE +4004.  01460047
014700         88 OPEN-ERROR                              VALUE +4005.  01470047
014800         88 CLOSE-ERROR                             VALUE +4006.  01480047
014900         88 SEQ-ERROR                               VALUE +4007.  01490047
015000         88 DATA-ERROR                              VALUE +4008.  01500047
015100         88 KEYPUNCH-ERROR                          VALUE +4009.  01510047
015200         88 SORT-ERROR                              VALUE +4012.  01520047
015300         88 DB2-ERROR                               VALUE +4013.  01530047
015400         88 DATE-ERROR                              VALUE +4019.  01540047
015500                                                                  01550047
015600 01  WS-ABEND-FIELDS.                                             01560047
015700     05  WS-ABEND-PROGRAM        PIC X(8)      VALUE 'APKUT255'.  01570047
015800     05  WS-ABEND-PARAGRAPH      PIC X(50)     VALUE SPACES.      01580047
015900     05  WS-ABEND-OPERATION      PIC X(50)     VALUE SPACES.      01590047
016000     05  WS-ABEND-STRUCTURE-1    PIC X(8)      VALUE SPACES.      01600047
016100     05  WS-ABEND-STRUCTURE-2    PIC X(8)      VALUE SPACES.      01610047
016200     05  WS-ABEND-STATUS         PIC XX        VALUE SPACES.      01620047
016300                                                                  01630047
016400 01  SV-NINREC-KEY.                                               01640047
016500     05  SV-VND-NBR              PIC  X(09)    VALUE '000000000'. 01650047
016600     05  SV-PO-NBR               PIC  9(09)    VALUE ZEROES.      01660047
016700                                                                  01670047
016800 01  PV-OPEN-INVOICE-KEY.                                         01680047
016900     05  PV-OI-VENDOR-NUMBER     PIC  9(09)    VALUE ZEROES.      01690047
017000     05  PV-OI-PO-NBR            PIC  9(09)    VALUE ZEROES.      01700047
017100                                                                  01710047
017200 01  PV-UNJOURNALIZED-KEY.                                        01720047
017300     05  PV-UJ-VENDOR-NUMBER     PIC  X(09)    VALUE '000000000'. 01730047
017400     05  PV-UJ-PO-NBR            PIC  9(09)    VALUE ZEROES.      01740047
017500                                                                  01750047
017600 01  PV-NINREC-KEY.                                               01760047
017700     05  PV-NR-VENDOR-NUMBER     PIC  X(09)    VALUE '000000000'. 01770047
017800     05  PV-NR-PO-NBR            PIC  9(09)    VALUE ZEROES.      01780047
017900                                                                  01790047
018000 01  PV-CURRENT-DATE.                                             01800047
018100     05  PV-CUR-CC               PIC  9(02)    VALUE ZEROES.      01810047
018200     05  PV-CUR-YYMMDD.                                           01820047
018300         10  PV-CUR-YY           PIC  9(02)    VALUE ZEROES.      01830047
018400         10  PV-CUR-MM           PIC  9(02)    VALUE ZEROES.      01840047
018500         10  PV-CUR-DD           PIC  9(02)    VALUE ZEROES.      01850047
018600 01  PW-CURRENT-DATE.                                             01860047
018700     05  PW-CURRENT-CC           PIC  9(02)    VALUE ZEROES.      01870047
018800     05  PW-CURRENT-YYMMDD.                                       01880047
018900         10  PW-CURRENT-YY       PIC  9(02)    VALUE ZEROES.      01890047
019000         10 FILLER               PIC  X(01)    VALUE '-'.         01900047
019100         10  PW-CURRENT-MM       PIC  9(02)    VALUE ZEROES.      01910047
019200         10 FILLER               PIC  X(01)    VALUE '-'.         01920047
019300         10  PW-CURRENT-DD       PIC  9(02)    VALUE ZEROES.      01930047
019400                                                                  01940047
019500 01  PS-OI-FIRST-TIME-SW         PIC X(01)   VALUE 'Y'.           01950047
019600     88  PS-OI-FIRST-TIME                    VALUE 'Y'.           01960047
019700     88  PS-OI-NOT-FIRST-TIME                VALUE ' '.           01970047
019800                                                                  01980047
019900 01  PS-FIRST-TIME-SW            PIC X(01)   VALUE ' '.           01990047
020000     88  PS-FIRST-TIME                       VALUE 'Y'.           02000047
020100     88  PS-NOT-FIRST-TIME                   VALUE ' '.           02010047
020200                                                                  02020047
020300 01  PS-PROGRAM-SWITCHES.                                         02030047
020400     05  PS-END-OPEN-SW          PIC  X(01)  VALUE ' '.           02040047
020500         88  PS-END-OPEN                     VALUE 'Y'.           02050047
020600     05  PS-END-UNJOURNALIZED-SW PIC  X(01)  VALUE ' '.           02060047
020700         88  PS-END-UNJOURNALIZED            VALUE 'Y'.           02070047
020800     05  PS-END-NINREC-SW        PIC  X(01)  VALUE ' '.           02080047
020900         88  PS-END-NINREC                   VALUE 'Y'.           02090047
021000                                                                  02100047
021100 01  RUN-TIME.                                                    02110047
021200     05  R-HR                    PIC 99.                          02120047
021300     05  R-MIN                   PIC 99.                          02130047
021400     05  R-SEC                   PIC 99.                          02140047
021500     05  R-TH                    PIC 99.                          02150047
021600*                                                                 02160047
021700 01  DATE-IN.                                                     02170047
021800     05 DATE-IN-YY               PIC XX.                          02180047
021900     05 DATE-IN-MM               PIC XX.                          02190047
022000     05 DATE-IN-DD               PIC XX.                          02200047
022100                                                                  02210047
022200/                                                                 02220047
022300*                                                                 02230047
022400*    WORK AREA PASSED IN CALL TO DPKUT500.                        02240047
022500*                                                                 02250047
022600     COPY DPWS500.                                                02260047
022700/                                                                 02270047
022800*                                                                 02280047
022900*    OPEN-INVOICE-RECORD.                                         02290047
023000*                                                                 02300047
023100     COPY APRD262.                                                02310047
023200/                                                                 02320047
023300*                                                                 02330047
023400*    UNJOURNALIZED-RECORD.                                        02340047
023500*                                                                 02350047
023600     COPY APRD042.                                                02360047
023700/                                                                 02370047
023800*                                                                 02380047
023900*    NINREC-RECORD.                                               02390047
024000*                                                                 02400047
024100     COPY APRD042 REPLACING 'AP042-' BY 'WS042-'.                 02410047
024200/                                                                 02420047
024300*                                                                 02430047
024400*    COMBINED-RECORD.                                             02440047
024500*                                                                 02450047
024600     COPY APRD262  REPLACING 'AP262-' BY 'WS262-'.                02460047
024700/                                                                 02470047
024800 01  FILLER                      PIC  X(35)  VALUE                02480047
024900     '**** END OF W/S ** APKUT111 ****'.                          02490047
025000 EJECT                                                            02500047
025100 PROCEDURE DIVISION.                                              02510047
025200                                                                  02520047
025300     PERFORM A100-MAINLINE.                                       02530047
025400     GOBACK.                                                      02540047
025500                                                                  02550047
025600 EJECT                                                            02560047
025700 A100-MAINLINE.                                                   02570047
025800                                                                  02580047
025900     PERFORM B100-INITIALIZE.                                     02590047
026000                                                                  02600047
026100     PERFORM B200-PROCESS-FILES                                   02610047
026200         UNTIL PS-END-OPEN                                        02620047
026300           AND PS-END-UNJOURNALIZED                               02630047
026400           AND PS-END-NINREC.                                     02640047
026500                                                                  02650047
026600     PERFORM B300-END-OF-PROGRAM.                                 02660047
026700                                                                  02670047
026800 EJECT                                                            02680047
026900*---------------------------------------------------------------- 02690047
027000*    INITIALIZATION PROCESSING.                                   02700047
027100*---------------------------------------------------------------- 02710047
027200 B100-INITIALIZE.                                                 02720047
027300                                                                  02730047
027400     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02740047
027500                                                                  02750047
027600     MOVE FUNCTION CURRENT-DATE TO PV-CURRENT-DATE.               02760047
027700     MOVE PV-CUR-CC TO PW-CURRENT-CC.                             02770047
027800     MOVE PV-CUR-YY TO PW-CURRENT-YY.                             02780047
027900     MOVE PV-CUR-MM TO PW-CURRENT-MM.                             02790047
028000     MOVE PV-CUR-DD TO PW-CURRENT-DD.                             02800047
028100                                                                  02810047
028200     ACCEPT RUN-TIME FROM TIME.                                   02820047
028300     ACCEPT DATE-IN  FROM DATE.                                   02830047
028400                                                                  02840047
028500     DISPLAY ' RUN-DATE = ' DATE-IN '   RUN-TIME = ' RUN-TIME.    02850047
028600                                                                  02860047
028700     OPEN INPUT  OPEN-INVOICE-FILE                                02870047
028800                 UNJOURNALIZED-FILE                               02880047
028900                 NINREC-FILE                                      02890047
029000     OPEN OUTPUT COMBINED-FILE.                                   02900047
029100                                                                  02910047
029200     INITIALIZE WS262-INPUT-RECORD.                               02920047
029300                                                                  02930047
029400     PERFORM R100-READ-OPEN-INVOICE.                              02940047
029500     PERFORM R200-READ-UNJOURNALIZED.                             02950047
029600     PERFORM R300-READ-NINREC.                                    02960047
029700                                                                  02970047
029800 EJECT                                                            02980047
029900*---------------------------------------------------------------- 02990047
030000* CONTROLS THE PROCESSING OF THE 3 INPUT FILES IS BASED ON HOW    03000047
030100* THE VENDOR/PO NUMBERS COMPARE TO EACH OTHER.  THE OPEN INVOICE  03010047
030200* FILE WILL HAVE 1 TO MANY RECS FOR EACH VENDOR/PO COMBINATION.   03020047
030300* THE UNJOURNAL FILE WILL HAVE 0 TO MANY RECS FOR EACH VENDOR/PO. 03030047
030400* THE NINREC FILE COULD HAVE 0 TO MANY RECORDS FOR ANY GIVEN      03040047
030500* VENDOR/PO COMBINATION.  THE PURPOSE IS TO CREATE A SINGLE       03050047
030600* OUTPUT (APRD262I) FILE THAT CONTAINS ALL THE RECORDS FROM THE   03060047
030700* OPEN INVOICE FILE (AP262).   IT WILL ALSO INCLUDE               03070047
030800* ONLY THE MATCHING RECORDS FROM UNJOURNALIZED FILE (AP042) AND   03080047
030900* THE NINREC FILE (WS042).  THOSE RECORDS FROM THE UNJOURNALIZED  03090047
031000* AND NINREC FILES THAT DON'T MATCH ANY RECORDS IN THE OPEN       03100047
031100* INVOICE FILE ARE OMITTED.  THIS IS A TRIPLE BUMP PROCESS.       03110047
031200*---------------------------------------------------------------- 03120047
031300 B200-PROCESS-FILES.                                              03130047
031400                                                                  03140047
031500     IF PV-OPEN-INVOICE-KEY = PV-UNJOURNALIZED-KEY                03150047
031600        IF PV-NINREC-KEY = PV-OPEN-INVOICE-KEY                    03160047
031700           PERFORM C100-PROCESS-MATCHED-NINRECS                   03170047
031800                   UNTIL PV-NINREC-KEY > PV-OPEN-INVOICE-KEY      03180047
031900        ELSE                                                      03190047
032000           IF PV-NINREC-KEY < PV-OPEN-INVOICE-KEY                 03200047
032100              PERFORM C400-PROCESS-UNMATCHED-NINREC               03210047
032200                      UNTIL PV-NINREC-KEY >= PV-OPEN-INVOICE-KEY  03220047
032300                            OR PS-END-NINREC                      03230047
032400              IF PV-NINREC-KEY = PV-OPEN-INVOICE-KEY              03240047
032500                 PERFORM C100-PROCESS-MATCHED-NINRECS             03250047
032600                         UNTIL PV-NINREC-KEY > PV-OPEN-INVOICE-KEY03260047
032700                               OR PS-END-NINREC                   03270047
032800              END-IF                                              03280047
032900           END-IF                                                 03290047
033000        END-IF                                                    03300047
033100        IF PS-END-OPEN AND PS-END-UNJOURNALIZED AND PS-END-NINREC 03310047
033200           NEXT SENTENCE                                          03320047
033300        ELSE                                                      03330047
033400           PERFORM C300-PROCESS-UNJOURNALIZED UNTIL               03340047
033500               (PV-UNJOURNALIZED-KEY > PV-OPEN-INVOICE-KEY)       03350047
033600                OR PS-END-UNJOURNALIZED                           03360047
033700           PERFORM C200-PROCESS-OPEN-INVOICE UNTIL                03370047
033800               (AP262-VENDOR-NUMBER > PV-OI-VENDOR-NUMBER OR      03380047
033900                AP262-PO-NBR > PV-OI-PO-NBR)                      03390047
034000                OR PS-END-OPEN                                    03400047
034100           MOVE AP262-VENDOR-NUMBER   TO PV-OI-VENDOR-NUMBER      03410047
034200           MOVE AP262-PO-NBR TO PV-OI-PO-NBR                      03420047
034300        END-IF                                                    03430047
034400     ELSE                                                         03440047
034500        IF PV-OPEN-INVOICE-KEY > PV-UNJOURNALIZED-KEY             03450047
034600           IF PV-NINREC-KEY = PV-UNJOURNALIZED-KEY                03460047
034700              PERFORM C400-PROCESS-UNMATCHED-NINREC               03470047
034800                      UNTIL PV-NINREC-KEY > PV-UNJOURNALIZED-KEY  03480047
034900                         OR PS-END-NINREC                         03490047
035000              PERFORM C500-PROCESS-UNMATCHED-UNJRNL UNTIL         03500047
035100                  (PV-UNJOURNALIZED-KEY >= PV-OPEN-INVOICE-KEY)   03510047
035200                   OR PS-END-UNJOURNALIZED                        03520047
035300           ELSE                                                   03530047
035400              IF PV-NINREC-KEY < PV-UNJOURNALIZED-KEY             03540047
035500                 PERFORM C400-PROCESS-UNMATCHED-NINREC            03550047
035600                       UNTIL PV-NINREC-KEY >= PV-UNJOURNALIZED-KEY03560047
035700                             OR PS-END-NINREC                     03570047
035800                 IF PV-NINREC-KEY = PV-UNJOURNALIZED-KEY          03580047
035900                    PERFORM C400-PROCESS-UNMATCHED-NINREC         03590047
036000                            UNTIL PV-NINREC-KEY >                 03600047
036100                                  PV-UNJOURNALIZED-KEY            03610047
036200                                  OR PS-END-NINREC                03620047
036300                    PERFORM C500-PROCESS-UNMATCHED-UNJRNL UNTIL   03630047
036400                    (PV-UNJOURNALIZED-KEY >=                      03640047
036500                        PV-OPEN-INVOICE-KEY)                      03650047
036600                     OR PS-END-UNJOURNALIZED                      03660047
036700                 END-IF                                           03670047
036800              ELSE                                                03680047
036900                 IF NOT PS-END-UNJOURNALIZED                      03690047
037000                    PERFORM C500-PROCESS-UNMATCHED-UNJRNL UNTIL   03700047
037100                      PV-UNJOURNALIZED-KEY >= PV-OPEN-INVOICE-KEY 03710047
037200                      OR PS-END-UNJOURNALIZED                     03720047
037300                 END-IF                                           03730047
037400              END-IF                                              03740047
037500           END-IF                                                 03750047
037600        ELSE                                                      03760047
037700            IF PV-OPEN-INVOICE-KEY < PV-UNJOURNALIZED-KEY         03770047
037800               IF PV-NINREC-KEY = PV-OPEN-INVOICE-KEY             03780047
037900                  PERFORM C100-PROCESS-MATCHED-NINRECS            03790047
038000                         UNTIL PV-NINREC-KEY > PV-OPEN-INVOICE-KEY03800047
038100                            OR PS-END-NINREC                      03810047
038200                  PERFORM C200-PROCESS-OPEN-INVOICE UNTIL         03820047
038300                      (AP262-VENDOR-NUMBER >                      03830047
038400                       PV-OI-VENDOR-NUMBER OR                     03840047
038500                       AP262-PO-NBR >                             03850047
038600                       PV-OI-PO-NBR)                              03860047
038700                      OR PS-END-OPEN                              03870047
038800                  MOVE AP262-VENDOR-NUMBER   TO                   03880047
038900                       PV-OI-VENDOR-NUMBER                        03890047
039000                  MOVE AP262-PO-NBR TO                            03900047
039100                       PV-OI-PO-NBR                               03910047
039200               ELSE                                               03920047
039300                  IF PV-NINREC-KEY < PV-OPEN-INVOICE-KEY          03930047
039400                     PERFORM C400-PROCESS-UNMATCHED-NINREC        03940047
039500                             UNTIL PV-NINREC-KEY >=               03950047
039600                                   PV-OPEN-INVOICE-KEY            03960047
039700                                   OR PS-END-NINREC               03970047
039800                     IF PV-NINREC-KEY = PV-OPEN-INVOICE-KEY       03980047
039900                        PERFORM C100-PROCESS-MATCHED-NINRECS      03990047
040000                                UNTIL PV-NINREC-KEY >             04000047
040100                                      PV-OPEN-INVOICE-KEY         04010047
040200                                      OR PS-END-NINREC            04020047
040300                        PERFORM C200-PROCESS-OPEN-INVOICE UNTIL   04030047
040400                            (AP262-VENDOR-NUMBER >                04040047
040500                             PV-OI-VENDOR-NUMBER OR               04050047
040600                             AP262-PO-NBR >                       04060047
040700                             PV-OI-PO-NBR)                        04070047
040800                            OR PS-END-OPEN                        04080047
040900                        MOVE AP262-VENDOR-NUMBER   TO             04090047
041000                             PV-OI-VENDOR-NUMBER                  04100047
041100                        MOVE AP262-PO-NBR TO                      04110047
041200                             PV-OI-PO-NBR                         04120047
041300                     END-IF                                       04130047
041400                  ELSE                                            04140047
041500                     PERFORM C200-PROCESS-OPEN-INVOICE UNTIL      04150047
041600                         (AP262-VENDOR-NUMBER >                   04160047
041700                          PV-OI-VENDOR-NUMBER OR                  04170047
041800                          AP262-PO-NBR >                          04180047
041900                          PV-OI-PO-NBR)                           04190047
042000                         OR PS-END-OPEN                           04200047
042100                     MOVE AP262-VENDOR-NUMBER   TO                04210047
042200                          PV-OI-VENDOR-NUMBER                     04220047
042300                     MOVE AP262-PO-NBR TO                         04230047
042400                          PV-OI-PO-NBR                            04240047
042500                  END-IF                                          04250047
042600               END-IF                                             04260047
042700            END-IF                                                04270047
042800         END-IF                                                   04280047
042900     END-IF.                                                      04290047
043000                                                                  04300047
043100                                                                  04310047
043200 EJECT                                                            04320047
043300*---------------------------------------------------------------- 04330047
043400*  END OF PROGRAM - DISPLAYS COUNTERS AND CLOSES FILES.           04340047
043500*---------------------------------------------------------------- 04350047
043600 B300-END-OF-PROGRAM.                                             04360047
043700                                                                  04370047
043800     DISPLAY 'PROGRAM APKUT111 RECORD COUNTS'.                    04380047
043900     DISPLAY '****************************'.                      04390047
044000     DISPLAY 'NBR OF OPEN INVOICES READ    = ' PV-OPEN-COUNT.     04400047
044100     DISPLAY 'NBR OF UNJRNLZD RECS READ    = ' PV-UNJRNL-COUNT.   04410047
044200     DISPLAY 'NBR OF NON-INVC RECS READ    = ' PV-NINREC-COUNT.   04420047
044300     DISPLAY 'NBR OF BYPASSED UNJRNLZD RECS NOT WRITTEN  = '      04430047
044400                                      PV-UNJRNL-BYPASSED-COUNT.   04440047
044500     DISPLAY 'NBR OF BYPASSED NON-INVC RECS NOT WRITTEN  = '      04450047
044600                                      PV-NINREC-BYPASSED-COUNT.   04460047
044700     DISPLAY 'NBR OF UNMATCHED UNJRNLZD RECS NOT WRITTEN = '      04470047
044800                                      PV-UNJRNL-UNMATCHED-COUNT.  04480047
044900     DISPLAY 'NBR OF UNMATCHED NON-INVC RECS NOT WRITTEN = '      04490047
045000                                      PV-NINREC-UNMATCHED-COUNT.  04500047
045100     DISPLAY 'TOTAL NBR OF RECORDS WRITTEN = ' PV-COMBINED-COUNT. 04510047
045200     DISPLAY '****************************'.                      04520047
045300     DISPLAY '** PROGRAM APKUT111 ENDS NORMALLY **'.              04530047
045400                                                                  04540047
045500     CLOSE OPEN-INVOICE-FILE                                      04550047
045600           UNJOURNALIZED-FILE                                     04560047
045700           NINREC-FILE                                            04570047
045800           COMBINED-FILE.                                         04580047
045900                                                                  04590047
046000 EJECT                                                            04600047
046100*---------------------------------------------------------------- 04610047
046200*  PROCESSES THE NINRECS REC(S) THAT HAVE A MATCHING OPEN INVOICE 04620047
046300*  RECORD.                                                        04630047
046400*---------------------------------------------------------------- 04640047
046500 C100-PROCESS-MATCHED-NINRECS.                                    04650047
046600                                                                  04660047
046700     PERFORM E100-FORMAT-FROM-NINREC-REC.                         04670047
046800                                                                  04680047
046900     IF ( WS262-DAYS-DELINQUENT > 30 ) AND                        04690052
047000        ( WS262-GROSS-INVOICE-AMT > 0 )                           04700047
047100        PERFORM W100-WRITE-COMBINED-RECORD                        04710047
047200     ELSE                                                         04720047
047300        ADD +1 TO PV-NINREC-BYPASSED-COUNT                        04730047
047400     END-IF.                                                      04740047
047500                                                                  04750047
047600     IF NOT PS-END-NINREC                                         04760047
047700        PERFORM R300-READ-NINREC                                  04770047
047800     END-IF.                                                      04780047
047900                                                                  04790047
048000     INITIALIZE WS262-INPUT-RECORD.                               04800047
048100                                                                  04810047
048200 EJECT                                                            04820047
048300*---------------------------------------------------------------- 04830047
048400* PROCESSES THE UNMATCHED UNJOURNALIZED RECORDS                   04840047
048500*---------------------------------------------------------------- 04850047
048600 C200-PROCESS-OPEN-INVOICE.                                       04860047
048700                                                                  04870047
048800     MOVE AP262-INPUT-RECORD TO WS262-INPUT-RECORD.               04880047
048900     PERFORM W100-WRITE-COMBINED-RECORD.                          04890047
049000                                                                  04900047
049100     IF NOT PS-END-OPEN                                           04910047
049200        PERFORM R100-READ-OPEN-INVOICE                            04920047
049300     END-IF.                                                      04930047
049400                                                                  04940047
049500     INITIALIZE WS262-INPUT-RECORD.                               04950047
049600                                                                  04960047
049700 EJECT                                                            04970047
049800*---------------------------------------------------------------- 04980047
049900*  PROCESSES THE UNJOURNALIZED RECORDS THAT HAVE A MATCHING       04990047
050000*  OPEN INVOICE RECORD.                                           05000047
050100*---------------------------------------------------------------- 05010047
050200 C300-PROCESS-UNJOURNALIZED.                                      05020047
050300                                                                  05030047
050400     PERFORM E200-FORMAT-FROM-UNJOURNALIZED.                      05040047
050500                                                                  05050047
050600     IF ( WS262-DAYS-DELINQUENT > 30 ) AND                        05060052
050700        ( WS262-GROSS-INVOICE-AMT > 0 )                           05070047
050800        PERFORM W100-WRITE-COMBINED-RECORD                        05080047
050900     ELSE                                                         05090047
051000        ADD +1 TO PV-UNJRNL-BYPASSED-COUNT                        05100047
051100     END-IF.                                                      05110047
051200                                                                  05120047
051300     IF NOT PS-END-UNJOURNALIZED                                  05130047
051400        PERFORM R200-READ-UNJOURNALIZED                           05140047
051500     END-IF.                                                      05150047
051600                                                                  05160047
051700     INITIALIZE WS262-INPUT-RECORD.                               05170047
051800                                                                  05180047
051900 EJECT                                                            05190047
052000*---------------------------------------------------------------- 05200047
052100*  PROCESSES THE NON-INVOICED RECEIPTS THAT DO NOT HAVE MATCHING  05210047
052200*  OPEN INVOICE RECORDS.                                          05220047
052300*---------------------------------------------------------------- 05230047
052400 C400-PROCESS-UNMATCHED-NINREC.                                   05240047
052500                                                                  05250047
052600     IF NOT PS-END-NINREC                                         05260047
052700        PERFORM R300-READ-NINREC                                  05270047
052800        ADD +1 TO PV-NINREC-UNMATCHED-COUNT                       05280047
052900     END-IF.                                                      05290047
053000                                                                  05300047
053100 EJECT                                                            05310047
053200*---------------------------------------------------------------- 05320047
053300*  PROCESSES THE UNJOURNALIZED RECORDS THAT DO NOT HAVE MATCHING  05330047
053400*  OPEN INVOICE RECORDS.                                          05340047
053500*---------------------------------------------------------------- 05350047
053600 C500-PROCESS-UNMATCHED-UNJRNL.                                   05360047
053700                                                                  05370047
053800     IF NOT PS-END-UNJOURNALIZED                                  05380047
053900        PERFORM R200-READ-UNJOURNALIZED                           05390047
054000        ADD +1 TO PV-UNJRNL-UNMATCHED-COUNT                       05400047
054100     END-IF.                                                      05410047
054200                                                                  05420047
054300 EJECT                                                            05430047
054400*---------------------------------------------------------------- 05440047
054500* CONVERTS THE NINREC RECORD TO THE OPEN INVOICE RECORD LAYOUT.   05450047
054600*---------------------------------------------------------------- 05460047
054700 E100-FORMAT-FROM-NINREC-REC.                                     05470047
054800                                                                  05480047
054900     MOVE WS042-VRFD-DTE            TO PV-DATE-CCYY-MM-DD.        05490047
055000     PERFORM E500-CALC-DAYS-DELINQ.                               05500047
055100                                                                  05510047
055300     MOVE WS042-VND-NBR             TO WS262-VENDOR-NUMBER.       05530047
055400     MOVE WS042-PO-NBR              TO WS262-PO-NBR.              05540047
055500     MOVE '99999Z/UNJOURNALIZED'    TO WS262-INVOICE-NUMBER.      05550047
055600     MOVE WS042-ENT-NM-DESC         TO WS262-VENDOR-NAME.         05560047
055700     MOVE SPACE                     TO WS262-RECVR-STATUS.        05570047
056000     MOVE SPACE                     TO WS262-INVOICE-TYPE.        05600047
056100     MOVE ZEROES                    TO WS262-DUE-DATE.            05610047
056200     MOVE WS042-CALCD-VRFD-COST-AMT TO WS262-GROSS-INVOICE-AMT.   05620047
056300     MOVE SPACE                     TO WS262-INVOICE-STATUS.      05630047
056400     MOVE ZEROES                    TO WS262-PAYT-REQ-SEQ-NBR.    05640047
058600     MOVE WS042-SEPHORA-IND         TO WS262-SEPHORA-IND.         05641056
056500                                                                  05650047
056600 EJECT                                                            05660047
056700*---------------------------------------------------------------- 05670047
056800* CONVERTS THE UNJOURNALIZED RECORD TO THE OPEN INVOICE RECORD    05680047
056900* LAYOUT.                                                         05690047
057000*---------------------------------------------------------------- 05700047
057100 E200-FORMAT-FROM-UNJOURNALIZED.                                  05710047
057200                                                                  05720047
057300     MOVE AP042-VRFD-DTE            TO PV-DATE-CCYY-MM-DD.        05730047
057400     PERFORM E500-CALC-DAYS-DELINQ.                               05740047
057500                                                                  05750047
057700     MOVE AP042-VND-NBR             TO WS262-VENDOR-NUMBER.       05770047
057800     MOVE AP042-PO-NBR              TO WS262-PO-NBR.              05780047
057900     MOVE '99999Z/UNJOURNALIZED'    TO WS262-INVOICE-NUMBER.      05790047
058000     MOVE AP042-ENT-NM-DESC         TO WS262-VENDOR-NAME.         05800047
058100     MOVE SPACE                     TO WS262-RECVR-STATUS.        05810047
058400     MOVE SPACE                     TO WS262-INVOICE-TYPE.        05840047
058500     MOVE ZEROES                    TO WS262-DUE-DATE.            05850047
058600     MOVE AP042-CALCD-VRFD-COST-AMT TO WS262-GROSS-INVOICE-AMT.   05860047
058700     MOVE SPACE                     TO WS262-INVOICE-STATUS.      05870047
058800     MOVE ZEROES                    TO WS262-PAYT-REQ-SEQ-NBR.    05880047
058600     MOVE AP042-SEPHORA-IND         TO WS262-SEPHORA-IND.         05881055
058900                                                                  05890047
059000 EJECT                                                            05900047
059100*---------------------------------------------------------------- 05910047
059200* COMPARES THE VERIFED DATE WITH THE CURRENT DATE TO DETERMINE    05920047
059300* WHETHER TO CALCULATE THE NUMBER OF DELINQUENT DAYS.             05930047
059400*---------------------------------------------------------------- 05940047
059500 E500-CALC-DAYS-DELINQ.                                           05950047
059600     MOVE 'E500-CALC-DAYS-DELINQ       ' TO PW-CURRENT-PARAGRAPH. 05960047
059700                                                                  05970047
059800     IF PV-DATE-CCYY-MM-DD >= PW-CURRENT-DATE                     05980047
059900         MOVE ZERO TO WS262-DAYS-DELINQUENT                       05990047
060000     ELSE                                                         06000047
060100         PERFORM E550-COMPARE-DATES                               06010047
060200         MOVE DPG55-DAYS-DIFFERENCE TO WS262-DAYS-DELINQUENT      06020047
060300     END-IF.                                                      06030047
060400                                                                  06040047
060500 EJECT                                                            06050047
060600*---------------------------------------------------------------- 06060047
060700* CALCULATES THE NUMBER OF DAYS DELINQUENT FOR THE NINREC OR      06070047
060800* UNJOURNALIZED RECORD.                                           06080047
060900*---------------------------------------------------------------- 06090047
061000 E550-COMPARE-DATES.                                              06100047
061100     INITIALIZE DPG51                                             06110047
061200                DPG52                                             06120047
061300                DPG53                                             06130047
061400                DPG54                                             06140047
061500                DPG55                                             06150047
061600                DPG56.                                            06160047
061700                                                                  06170047
061800     MOVE 'F2'                 TO DPG51-CALENDAR-TYPE.            06180047
061900                                                                  06190047
062000     SET DPG51-DO-NOT-INCR-DECR-DATE                              06200047
062100         DPG52-LK-DTE-ISO-FMT                                     06210047
062200         DPG53-LK-CMPR-DTE-ISO-FMT    TO TRUE.                    06220047
062300                                                                  06230047
062400     MOVE PV-DATE-CCYY-MM-DD        TO DPG52-LK-DATE-INPUT.       06240047
062500     MOVE PW-CURRENT-DATE           TO DPG53-LK-CMPR-DATE-INPUT.  06250047
062600                                                                  06260047
062700     CALL DP500-KOHLS-CALENDAR-ROUTINE                            06270047
062800         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               06280047
062900                                                                  06290047
063000     IF (DPG54-WARNING-ERROR OR                                   06300047
063100         DPG54-SEVERE-ERROR)                                      06310047
063200***************************************************************   06320047
063300         DISPLAY 'CALENDAR-TYPE   ' DPG54-CALENDAR-TYPE-IND       06330047
063400         DISPLAY 'DATE-VALID      ' DPG54-DATE-VALID-IND          06340047
063500         DISPLAY 'CMPR-DATE-VALID ' DPG54-CMPR-DATE-VALID-IND     06350047
063600         DISPLAY 'INCR-DECR-IND   ' DPG54-INCR-DECR-IND           06360047
063700         DISPLAY 'ERROR-IND       ' DPG54-ERROR-IND               06370047
063800***************************************************************   06380047
063900         MOVE PW-CURRENT-PARAGRAPH           TO WS-ABEND-PARAGRAPH06390047
064000         MOVE 'UNSUCCESSFUL DATE COMPARISON' TO WS-ABEND-OPERATION06400047
064100         SET DATE-ERROR TO TRUE                                   06410047
064200         PERFORM 9999-ABEND.                                      06420047
064300                                                                  06430047
064400 EJECT                                                            06440047
064500*---------------------------------------------------------------- 06450047
064600*  READS THE OPEN INVOICE FILE  (AP262).                          06460047
064700*---------------------------------------------------------------- 06470047
064800 R100-READ-OPEN-INVOICE.                                          06480047
064900                                                                  06490047
065000     READ OPEN-INVOICE-FILE INTO AP262-INPUT-RECORD               06500047
065100         AT END                                                   06510047
065200             MOVE ALL '9' TO AP262-INPUT-RECORD                   06520047
065300             SET PS-END-OPEN TO TRUE.                             06530047
065400                                                                  06540047
065500     IF PS-OI-FIRST-TIME                                          06550047
065600        SET PS-OI-NOT-FIRST-TIME TO TRUE                          06560047
065700        MOVE AP262-VENDOR-NUMBER   TO PV-OI-VENDOR-NUMBER         06570047
065800        MOVE AP262-PO-NBR TO PV-OI-PO-NBR                         06580047
065900     END-IF.                                                      06590047
066000                                                                  06600047
066100     IF NOT PS-END-OPEN                                           06610047
066200        ADD +1 TO PV-OPEN-COUNT                                   06620047
066300     END-IF.                                                      06630047
066400                                                                  06640047
066500 EJECT                                                            06650047
066600*---------------------------------------------------------------- 06660047
066700*  READS THE UNJOURNALIZED RECEIPTS FILE  (AP042).                06670047
066800*---------------------------------------------------------------- 06680047
066900 R200-READ-UNJOURNALIZED.                                         06690047
067000                                                                  06700047
067100     READ UNJOURNALIZED-FILE INTO AP042-EXTRACT-FILE              06710047
067200         AT END                                                   06720047
067300             MOVE ALL '9' TO AP042-EXTRACT-FILE                   06730047
067400             SET PS-END-UNJOURNALIZED TO TRUE.                    06740047
067500                                                                  06750047
067600     MOVE AP042-VND-NBR TO PV-UJ-VENDOR-NUMBER.                   06760047
067700     MOVE AP042-PO-NBR  TO PV-UJ-PO-NBR.                          06770047
067800                                                                  06780047
067900     IF NOT PS-END-UNJOURNALIZED                                  06790047
068000        ADD +1 TO PV-UNJRNL-COUNT                                 06800047
068100     END-IF.                                                      06810047
068200                                                                  06820047
068300 EJECT                                                            06830047
068400*---------------------------------------------------------------- 06840047
068500*  READS THE NON-INVOICED RECEIPTS FILE  (WS042).                 06850047
068600*---------------------------------------------------------------- 06860047
068700 R300-READ-NINREC.                                                06870047
068800                                                                  06880047
068900     READ NINREC-FILE INTO WS042-EXTRACT-FILE                     06890047
069000         AT END                                                   06900047
069100             MOVE ALL '9' TO WS042-EXTRACT-FILE                   06910047
069200             SET PS-END-NINREC TO TRUE.                           06920047
069300                                                                  06930047
069400     MOVE WS042-VND-NBR TO PV-NR-VENDOR-NUMBER.                   06940047
069500     MOVE WS042-PO-NBR  TO PV-NR-PO-NBR.                          06950047
069600                                                                  06960047
069700     IF NOT PS-END-NINREC                                         06970047
069800        ADD +1 TO PV-NINREC-COUNT                                 06980047
069900     END-IF.                                                      06990047
070000                                                                  07000047
070100 EJECT                                                            07010047
070200*---------------------------------------------------------------- 07020047
070300*  WRITES OUT THE RECORD FROM EITHER THE OPEN INVOICE, NINREC OR  07030047
070400*  UNJOURNALIZED FILES TO THE COMBINED FILE.                      07040047
070500*---------------------------------------------------------------- 07050047
070600 W100-WRITE-COMBINED-RECORD.                                      07060047
070700                                                                  07070047
070800     WRITE COMBINED-RECORD FROM WS262-INPUT-RECORD.               07080047
070900                                                                  07090047
071000     ADD 1                TO PV-COMBINED-COUNT.                   07100047
071100                                                                  07110047
071200 EJECT                                                            07120047
071300***************************************************************** 07130047
071400*    ABEND ROUTINE                                               *07140047
071500***************************************************************** 07150047
071600 9999-ABEND.                                                      07160047
071700                                                                  07170047
071800     MOVE '9999-ABEND' TO PW-CURRENT-PARAGRAPH.                   07180047
071900                                                                  07190047
072000     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 07200047
072100     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               07210047
072200     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               07220047
072300     CALL 'ILBOABN0' USING ABEND-CODE.                            07230047
072400                                                                  07240047
