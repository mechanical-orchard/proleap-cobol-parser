000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.               TCKUT036.                              00020000
000300 AUTHOR.                   BARB SCHULTZ.                          00030000
000400 INSTALLATION.             KOHLS DEPARTMENT STORES.               00040000
000500 DATE-WRITTEN.             APRIL, 2019.                           00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*            ADD FULFILLMENT CODE TO NEW TRANS FILE              *00080000
000900*----------------------------------------------------------------*00090000
001000*  PROGRAM NARRATIVE:                                            *00100000
001100*                                                                *00110000
001200*   THIS PROGRAM WILL READ THE NEW TRANS FILE FROM TCK095 AND    *00120000
001300*   ADD THE FULFILLMENT INDICATOR ON THE END OF THE FILE.        *00130000
002000*----------------------------------------------------------------*00200000
004700                                                                  00538000
004800 ENVIRONMENT DIVISION.                                            00539000
004900                                                                  00540000
005000                                                                  00550000
005100 CONFIGURATION SECTION.                                           00560000
005200                                                                  00570000
005300 SOURCE-COMPUTER.    IBM-3090.                                    00580000
005400 OBJECT-COMPUTER.    IBM-3090.                                    00590000
005500                                                                  00600000
005600                                                                  00610000
005700 INPUT-OUTPUT SECTION.                                            00620000
005800                                                                  00630000
005900 FILE-CONTROL.                                                    00640000
006000                                                                  00650000
006100     SELECT NEW-TRANS-FILE             ASSIGN TO INP01.           00660000
006200     SELECT BANK-SETTLEMENT-FILE       ASSIGN TO OUT01.           00670000
006400     EJECT                                                        00690000
006500                                                                  00700000
006600 DATA DIVISION.                                                   00710000
006700                                                                  00720000
006800 FILE SECTION.                                                    00730000
006900                                                                  00740000
007000 FD  NEW-TRANS-FILE                                               00750000
007100     RECORDING MODE IS F                                          00760000
007200     BLOCK CONTAINS 0 RECORDS                                     00770000
007300     LABEL RECORDS ARE STANDARD.                                  00780000
007400                                                                  00790000
007500 01  NEW-TRANS-RECORD                 PIC X(298).                 00800000
007600                                                                  00810000
007700                                                                  00820000
007800 FD  BANK-SETTLEMENT-FILE                                         00830000
007900     RECORDING MODE IS F                                          00840000
008000     BLOCK CONTAINS 0 RECORDS                                     00850000
008100     LABEL RECORDS ARE STANDARD.                                  00860000
008200 01  BANK-SETTLEMENT-RECORD           PIC X(298).                 00870000
008300                                                                  00880000
008400                                                                  00890000
009100                                                                  00960000
009200 WORKING-STORAGE SECTION.                                         00970000
009300                                                                  00980000
009400 01  FILLER                           PIC X(32)  VALUE            00990000
009500     'TCKUT036 WORKING STORAGE BEGINS:'.                          01000000
009600                                                                  01010000
009700******************************************************************01020000
009800 01  PC-PROGRAM-CONSTANTS.                                        01030000
009900                                                                  01040000
010000     05  PC-PROGRAM-NUMBER            PIC X(08)      VALUE        01050000
010100         'TCKUT036'.                                              01060000
010900     05  PC-START-PGM-MSG             PIC X(06)      VALUE        01140000
011000         'START '.                                                01150000
011100     05  PC-NORMAL-EOJ-MSG            PIC X(13)      VALUE        01160000
011200         '- NORMAL EOJ '.                                         01170000
011900                                                                  01240000
012000 01  PS-PROCESS-SWITCHES.                                         01250000
012100     05  PS-END-OF-COSA-FILE-SW        PIC X(01) VALUE 'N'.       01260000
012200         88  PS-END-OF-COSA-FILE                 VALUE 'Y'.       01270000
012300         88  PS-NOT-END-OF-COSA-FILE             VALUE 'N'.       01280000
012400     05  PS-WRITE-FILE-SW              PIC X(01).                 01290000
012500         88  PS-WRITE-AJB-FILE                   VALUE 'Y'.       01300000
012600         88  PS-WRITE-BANK-SETTLE-FILE           VALUE 'N'.       01310000
013600                                                                  01410000
013700 01  PV-PROGRAM-VARIABLES.                                        01420000
014000     05  PV-READ-CNT                 PIC 9(07)    VALUE ZEROES.   01450000
SHIP       05  PV-NOT-OMNI-CNT             PIC 9(07)    VALUE ZEROES.   01460002
SHIP       05  PV-OMNI-CNT                 PIC 9(07)    VALUE ZEROES.   01461002
014200     05  PV-WRITE-BANK               PIC 9(07)    VALUE ZEROES.   01470000
014400     05  PV-DISPLAY-CNT              PIC Z,ZZZ,ZZ9.               01490000
014600     05  PV-DB2-ERROR-MSG            PIC X(40)      VALUE SPACES. 01510000
015900     05  PV-OMNI-CHNL-FFLMT-TYP-CDE  PIC X(03).                   01640000
016010     05  PV-FULFILLMENT-TYPE         PIC X(01)    VALUE SPACES.   01660000
016020         88  PV-OMNI-BPS-BOS                       VALUE 'O'.     01670000
016030         88  PV-SHIP-TO-HOME                       VALUE 'S'.     01680000
016100                                                                  01681000
016200                                                                  01682000
016500*----------------------------------------------------------------*01685000
016600*  DATE VALIDATION CALLING PARAMETER LIST                        *01686000
016700*----------------------------------------------------------------*01687000
016800     COPY DPWS500.                                                01688000
016900*----------------------------------------------------------------*01689000
017000*    STANDARD FILE LAYOUT FOR THE COSA SETTLEMENT FILE           *01690000
017100*----------------------------------------------------------------*01700000
000100******************************************************************01711000
000200*  THIS COPYBOOK IS THE LAYOUT FOR THE EXTRACT FILE TO BE USED   *01712000
000300*  FOR THE LATE EXTRACT OF CREDIT TRANSACTIONS FOR SETTLEMENT.   *01713000
000500******************************************************************01715000
000600 01  TC005A-EXTRACT-RECORD.                                       01716000
000700     05  TC005A-PARTN-NBR            PIC S9(04)    COMP.          01717000
000800     05  TC005A-STR-NBR              PIC S9(04)    COMP.          01718000
000900     05  TC005A-RGST-ID              PIC S9(04)    COMP.          01719000
001000     05  TC005A-TRN-NBR              PIC S9(04)    COMP.          01719100
001100     05  TC005A-STRT-TM              PIC  X(08).                  01719200
001200     05  TC005A-SLS-CORR-SEQ-NBR     PIC S9(04)    COMP.          01719300
001300     05  TC005A-TRN-TYP-CDE          PIC  X(02).                  01719400
001400     05  TC005A-SLS-DTE              PIC  X(10).                  01719500
001500     05  TC005A-TRN-DTE              PIC  X(10).                  01719600
001600     05  TC005A-TNDR-SEQ-NBR         PIC S9(04)    COMP.          01719700
001700     05  TC005A-TNDR-TYP-CDE         PIC  X(02).                  01719800
001800     05  TC005A-TNDR-ID              PIC  X(33).                  01719900
001900     05  TC005A-TNDR-AMT             PIC S9(07)V99 COMP-3.        01720000
002000     05  TC005A-TNDR-ID-SRC-CDE      PIC  X(02).                  01720100
002100     05  TC005A-AUTH-NBR             PIC  X(06).                  01720200
002200     05  TC005A-AUTH-SRC-CDE         PIC  X(02).                  01720300
002300     05  TC005A-CPS-TRN-ID           PIC S9(15)    COMP-3.        01720400
002400     05  TC005A-MC-CMPLIN-CDE        PIC  X(04).                  01720500
002500     05  TC005A-VIP-SRC-CDE          PIC  X(01).                  01720600
002600     05  TC005A-VIP-RSPN-CDE         PIC  X(02).                  01720700
002700     05  TC005A-BNKNET-NBR           PIC  X(15).                  01720800
002800     05  TC005A-SETTLE-STORE-NBR     PIC  9(04).                  01720900
002900     05  TC005A-ECOMM-REAUTH-IND     PIC  X(01).                  01721000
003000     05  TC005A-ECOMM-ORD-NBR        PIC  X(25).                  01721100
003100     05  TC005A-AUTH-REF-NBR         PIC  X(45).                  01721200
003200     05  TC005A-TRAN-CDE             PIC  X(01).                  01721300
003300         88  TC005A-PREV-DAY-TRAN   VALUE 'P'.                    01721400
003400         88  TC005A-CURR-DAY-TRAN   VALUE SPACE.                  01721500
003500     05  TC005A-MERCHANT-NBR         PIC  X(15).                  01721600
002600     05  TC005A-AVS-RSPN-CDE         PIC  X(01).                  01721700
003800     05  TC005A-VOID-ABRT-CDE        PIC  X(01).                  01721800
001900     05  TC005A-SLS-TX-AMT           PIC S9(07)V99 COMP-3.        01721900
001900     05  TC005A-CRD-LVL-RSLT-CDE     PIC  X(02).                  01722000
001900     05  TC005A-CVV-RSPN-CDE         PIC  X(01).                  01722100
001900     05  TC005A-E-BUS-IND            PIC  X(01).                  01722200
001900     05  TC005A-NETWK-REF-ID         PIC  X(15).                  01722300
001900     05  TC005A-TRSM-TMST            PIC  X(26).                  01722400
001900     05  TC005A-SYS-TRC-AUD-NBR      PIC  9(06).                  01722500
001900     05  TC005A-TRK-DAT-CND-CDE      PIC  X(02).                  01722600
002000     05  TC005A-OMNI-CHNL-FFLMT-TYP-CDE PIC  X(03).               01722700
003900     05  TC005A-VISA-MULT-CLR-SEQ-NBR PIC  9(04).                 01722801
003900     05  TC005A-VISA-TOT-SHP-NBR     PIC  9(04).                  01722901
003900     05  TC005A-MC-MULT-CLR-SEQ-NBR  PIC  9(04).                  01723001
003900     05  TC005A-FULFILLMENT-TYPE     PIC  X(01).                  01723101
003900     05  FILLER                      PIC  X(09).                  01723201
                                                                        01723401
017300*----------------------------------------------------------------*01724001
017400*    STANDARD FILE LAYOUT FOR THE AJB SETTLEMENT FILE            *01730000
017500*----------------------------------------------------------------*01740000
017600     COPY TCRD005.                                                01750000
                                                                        01760000
023900                                                                  02380000
024000****************************************************************  02390000
024100 PROCEDURE DIVISION.                                              02400000
024200****************************************************************  02410000
024300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  02420000
024400* PROGRAM.                                                     *  02430000
024500****************************************************************  02440000
024600                                                                  02450000
024700 0000-PROGRAM-MAINLINE.                                           02460000
024800                                                                  02470000
024900     PERFORM 1000-INITIALIZATION.                                 02480000
025000                                                                  02490000
025100     PERFORM 1600-PROCESS-FILE                                    02500000
025200        UNTIL PS-END-OF-COSA-FILE.                                02510000
025300                                                                  02520000
025400     PERFORM 9999-END-ROUTINE.                                    02530000
025500                                                                  02540000
025600     GOBACK.                                                      02550000
025700                                                                  02560000
025900****************************************************************  02580000
026000* 1000-INITIALIZATION OPENS ALL FILES                          *  02590000
026100*      READS THE FIRST COSA RECORD                             *  02600000
026200****************************************************************  02610000
026300 1000-INITIALIZATION.                                             02620000
026400                                                                  02630000
026500     DISPLAY PC-START-PGM-MSG   PC-PROGRAM-NUMBER.                02640000
026600                                                                  02650000
026700     OPEN INPUT  NEW-TRANS-FILE                                   02660000
026800          OUTPUT BANK-SETTLEMENT-FILE.                            02670000
027000                                                                  02690000
027100     MOVE SPACES                 TO  PS-WRITE-FILE-SW.            02700000
027200                                                                  02710000
027300     PERFORM 1500-READ-INPUT-FILE.                                02720000
027400                                                                  02730000
027500                                                                  02740000
027600****************************************************************  02750000
027700* 1500-READ COSA EXTRACT INPUT FILE                            *  02760000
027800****************************************************************  02770000
027900 1500-READ-INPUT-FILE.                                            02780000
028000                                                                  02790000
028200     INITIALIZE TC005A-EXTRACT-RECORD.                            02810000
028200     INITIALIZE TC005-EXTRACT-RECORD.                             02811000
028300                                                                  02820000
028400     READ NEW-TRANS-FILE                                          02830000
028500         INTO TC005A-EXTRACT-RECORD                               02840000
028600         AT END                                                   02850000
028700             SET PS-END-OF-COSA-FILE TO TRUE                      02860000
028800     END-READ.                                                    02870000
033200                                                                  02881000
029000                                                                  02890000
029100****************************************************************  02900000
029200* 1600-PROCESS-FILE                                            *  02910000
029300****************************************************************  02920000
029400 1600-PROCESS-FILE.                                               02930000
029500                                                                  02940000
033300     ADD  1                      TO PV-READ-CNT.                  02941004
029600     MOVE TC005A-PARTN-NBR       TO TC005-PARTN-NBR.              02950000
029700     MOVE TC005A-STR-NBR         TO TC005-STR-NBR.                02960000
029800     MOVE TC005A-RGST-ID         TO TC005-RGST-ID.                02970000
029900     MOVE TC005A-TRN-NBR         TO TC005-TRN-NBR.                02980000
030000     MOVE TC005A-STRT-TM         TO TC005-STRT-TM.                02990000
030100     MOVE TC005A-SLS-CORR-SEQ-NBR TO TC005-SLS-CORR-SEQ-NBR.      03000000
030200     MOVE TC005A-TRN-TYP-CDE     TO TC005-TRN-TYP-CDE.            03010000
030300     MOVE TC005A-SLS-DTE         TO TC005-SLS-DTE.                03020000
030400     MOVE TC005A-TRN-DTE         TO TC005-TRN-DTE.                03030000
030500     MOVE TC005A-TNDR-SEQ-NBR    TO TC005-TNDR-SEQ-NBR.           03040000
030600     MOVE TC005A-TNDR-TYP-CDE    TO TC005-TNDR-TYP-CDE.           03050000
030700     MOVE TC005A-TNDR-ID         TO TC005-TNDR-ID.                03060000
030800     MOVE TC005A-TNDR-AMT        TO TC005-TNDR-AMT.               03070000
030900     MOVE TC005A-TNDR-ID-SRC-CDE TO TC005-TNDR-ID-SRC-CDE.        03080000
031000     MOVE TC005A-AUTH-NBR        TO TC005-AUTH-NBR.               03090000
031100     MOVE TC005A-AUTH-SRC-CDE    TO TC005-AUTH-SRC-CDE.           03100000
031200     MOVE TC005A-CPS-TRN-ID      TO TC005-CPS-TRN-ID.             03110000
031300     MOVE TC005A-MC-CMPLIN-CDE   TO TC005-MC-CMPLIN-CDE.          03120000
031400     MOVE TC005A-VIP-SRC-CDE     TO TC005-VIP-SRC-CDE.            03130000
031500     MOVE TC005A-VIP-RSPN-CDE    TO TC005-VIP-RSPN-CDE.           03140000
031600     MOVE TC005A-BNKNET-NBR      TO TC005-BNKNET-NBR.             03150000
                                                                        03160000
           MOVE TC005A-SETTLE-STORE-NBR TO TC005-SETTLE-STORE-NBR.      03161000
           MOVE TC005A-ECOMM-REAUTH-IND TO TC005-ECOMM-REAUTH-IND.      03162000
           MOVE TC005A-ECOMM-ORD-NBR    TO TC005-ECOMM-ORD-NBR.         03163000
           MOVE TC005A-AUTH-REF-NBR     TO TC005-AUTH-REF-NBR.          03164000
           MOVE TC005A-TRAN-CDE         TO TC005-TRAN-CDE.              03165000
           MOVE TC005A-MERCHANT-NBR     TO TC005-MERCHANT-NBR.          03169100
           MOVE TC005A-AVS-RSPN-CDE     TO TC005-AVS-RSPN-CDE.          03169200
           MOVE TC005A-VOID-ABRT-CDE    TO TC005-VOID-ABRT-CDE.         03169300
           MOVE TC005A-SLS-TX-AMT       TO TC005-SLS-TX-AMT.            03169400
           MOVE TC005A-CRD-LVL-RSLT-CDE TO TC005-CRD-LVL-RSLT-CDE.      03169500
           MOVE TC005A-CVV-RSPN-CDE     TO TC005-CVV-RSPN-CDE.          03169600
           MOVE TC005A-E-BUS-IND        TO TC005-E-BUS-IND.             03169700
           MOVE TC005A-NETWK-REF-ID     TO TC005-NETWK-REF-ID.          03169800
034500     MOVE TC005A-TRSM-TMST       TO TC005-TRSM-TMST.              03520000
034600     MOVE TC005A-SYS-TRC-AUD-NBR TO TC005-SYS-TRC-AUD-NBR.        03530000
034800     MOVE TC005A-TRK-DAT-CND-CDE TO TC005-TRK-DAT-CND-CDE.        03550000
034900     MOVE TC005A-OMNI-CHNL-FFLMT-TYP-CDE TO                       03560000
035000                              TC005-OMNI-CHNL-FFLMT-TYP-CDE.      03570000
SHIP       MOVE TC005A-VISA-MULT-CLR-SEQ-NBR TO                         03571000
SHIP            TC005-VISA-MULT-CLR-SEQ-NBR.                            03572000
SHIP       MOVE TC005A-VISA-TOT-SHP-NBR TO TC005-VISA-TOT-SHP-NBR.      03573000
SHIP                                                                    03573100
SHIP       MOVE TC005A-MC-MULT-CLR-SEQ-NBR TO                           03573200
SHIP            TC005-MC-MULT-CLR-SEQ-NBR.                              03573300
SHIP                                                                    03573400
SHIP  * SET A SWITCH TO INDICATE OMNI TYPE ORDERS                       03574000
SHIP       IF TC005A-OMNI-CHNL-FFLMT-TYP-CDE = SPACES OR                03575000
SHIP          TC005A-OMNI-CHNL-FFLMT-TYP-CDE = 'SFS' OR                 03576000
SHIP          TC005A-OMNI-CHNL-FFLMT-TYP-CDE = 'SDD'                    03577000
SHIP             SET PV-SHIP-TO-HOME TO TRUE                            03578000
SHIP             ADD  1 TO  PV-NOT-OMNI-CNT                             03578102
SHIP       ELSE                                                         03579000
SHIP             SET PV-OMNI-BPS-BOS TO TRUE                            03579100
SHIP             ADD  1 TO  PV-OMNI-CNT                                 03579202
SHIP       END-IF.                                                      03579300
SHIP       MOVE PV-FULFILLMENT-TYPE    TO TC005-FULFILLMENT-TYPE.       03579400
                                                                        03579500
                                                                        03580000
035400     PERFORM 8400-WRITE-BANK-SETTLE-FILE.                         03610000
035600                                                                  03630000
035700     MOVE SPACES                 TO  PS-WRITE-FILE-SW.            03640000
035800                                                                  03650000
035900     PERFORM 1500-READ-INPUT-FILE.                                03660000
036000                                                                  03670000
042000                                                                  04270000
064100***************************************************************** 06480000
064200*    WRITE BANK SETTLEMENT FILE                                  *06490000
064300***************************************************************** 06500000
064400 8400-WRITE-BANK-SETTLE-FILE.                                     06510000
064500                                                                  06520000
064600     WRITE BANK-SETTLEMENT-RECORD FROM TC005-EXTRACT-RECORD.      06530000
064700                                                                  06540000
064800     ADD 1 TO PV-WRITE-BANK.                                      06550000
064900                                                                  06560000
067200***************************************************************** 06790000
067300* 9999-END-ROUTINE                                              * 06800000
067400* CLOSE FILES                                                   * 06810000
067500***************************************************************** 06820000
067600                                                                  06830000
067700 9999-END-ROUTINE.                                                06840000
067800                                                                  06850000
068000     CLOSE NEW-TRANS-FILE.                                        06870000
068100     CLOSE BANK-SETTLEMENT-FILE.                                  06880000
068300                                                                  06900000
068400     MOVE PV-READ-CNT TO PV-DISPLAY-CNT.                          06910000
068500     DISPLAY 'RECORDS READ:                     ' PV-DISPLAY-CNT. 06920000
068800     MOVE PV-WRITE-BANK TO PV-DISPLAY-CNT.                        06950000
068900     DISPLAY 'TOT RECORDS WRITTEN TO BANK FILE: ' PV-DISPLAY-CNT. 06960003
068400     MOVE PV-OMNI-CNT TO PV-DISPLAY-CNT.                          06970002
068500     DISPLAY 'OMNI RECORDS WRITTEN:             ' PV-DISPLAY-CNT. 06980003
068800     MOVE PV-NOT-OMNI-CNT TO PV-DISPLAY-CNT.                      06981002
068900     DISPLAY 'NOT OMNI RECORDS WRITTEN:         ' PV-DISPLAY-CNT. 06982003
069200     DISPLAY PC-NORMAL-EOJ-MSG   PC-PROGRAM-NUMBER.               06990000
