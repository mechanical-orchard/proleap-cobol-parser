000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.      MRKRP140.                                       00040000
000500 AUTHOR.          JIM LEIKNESS.                                   00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    06/27/05.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* THIS PROGRAM WILL PRINT A SUMMARY OF ORDERS RERUN.              00100000
001100*                                                                 00110000
001200****PLEASE NOTE**PLEASE NOTE**PLEASE NOTE**PLEASE NOTE************00120000
001300*                                                                 00130000
001400*             THIS PROGRAM SOURCES FROM THE SG ORACLE TABLES      00140000
001500*             (STAGING TABLES).                                   00150000
001600*             THE CRITERIA FOR WHICH ORDERS ARE ON THE REPORT     00160000
001700*             ARE (1)THAT THE ORDER RUN DATE IS GREATER THAN OR   00170000
001800*             EQUAL TO THE CURRENT BEGIN OF WEEK DATE (2)THE      00180000
001900*             RUN CODE IS IN (2A, 3A, 4A, OR 5A) WHICH ARE        00190000
002000*             THE RERUN JOBS.                                     00200000
002100*                                                                 00210000
002200****PLEASE NOTE**PLEASE NOTE**PLEASE NOTE**PLEASE NOTE************00220000
002300*                                                                 00230000
002310******************************************************************00230102
002320**  HISTORY LOG:                                                 *00230202
002330******************************************************************00230302
002350* DATE:         07/30/2018                                       *00232002
002360* WR/IR#:       CHG0204126                                       *00233002
002370* PROGRAMMER:   COGNIZANT                                        *00234002
002380* DESCRIPTION:  ORACLE LOGON STANDARDS PROGRAM CHANGE            *00235002
002390******************************************************************00236002
002400******************************************************************00240000
002500 ENVIRONMENT DIVISION.                                            00250000
002600******************************************************************00260000
002700*                                                                 00270000
002800 CONFIGURATION SECTION.                                           00280000
002900 SOURCE-COMPUTER. IBM-3090.                                       00290000
003000 OBJECT-COMPUTER. IBM-3090.                                       00300000
003100*                                                                 00310000
003200 INPUT-OUTPUT SECTION.                                            00320000
003300 FILE-CONTROL.                                                    00330000
003400                                                                  00340000
003500     SELECT DATE-CONTROL-CARD-FILE                                00350000
003600         ASSIGN                       TO INP01.                   00360000
003700                                                                  00370000
003800     SELECT SYS-ID1-CONTROL-CARD-FILE                             00380000
003900         ASSIGN                       TO INP02.                   00390000
004000                                                                  00400000
004100     SELECT DEPT-EXCP-CARD-FILE                                   00410000
004200         ASSIGN                       TO INP03.                   00420000
004300                                                                  00430000
004400     SELECT PRINT-REPORT                                          00440000
004500         ASSIGN                       TO RPT01.                   00450000
004600                                                                  00460000
004610     SELECT ORACLE-LOGON-FILE                                     00461001
004620         ASSIGN                       TO ORALOGON.                00462001
004630                                                                  00463001
004700     EJECT                                                        00470000
004800*                                                                 00480000
004900***************                                                   00490000
005000 DATA DIVISION.                                                   00500000
005100***************                                                   00510000
005200*                                                                 00520000
005300 FILE SECTION.                                                    00530000
005400*                                                                 00540000
005500 FD  DATE-CONTROL-CARD-FILE                                       00550000
005600     RECORDING MODE IS F                                          00560000
005700     BLOCK CONTAINS 0 RECORDS.                                    00570000
005800 01  DATE-CONTROL-CARD-RECORD        PIC  X(80).                  00580000
005900                                                                  00590000
006000 FD  SYS-ID1-CONTROL-CARD-FILE                                    00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS.                                    00620000
006300 01  SYS-ID1-CONTROL-CARD-RECORD     PIC  X(80).                  00630000
006400                                                                  00640000
006500 FD  DEPT-EXCP-CARD-FILE                                          00650000
006600     RECORDING MODE IS F                                          00660000
006700     BLOCK CONTAINS 0 RECORDS.                                    00670000
006800 01  DEPT-EXCP-CARD-RECORD           PIC  X(80).                  00680000
006900                                                                  00690000
007000 FD  PRINT-REPORT                                                 00700000
007100     RECORDING MODE F                                             00710000
007200     BLOCK CONTAINS 0 RECORDS                                     00720000
007300     RECORD CONTAINS 132 CHARACTERS                               00730000
007400     LABEL RECORDS ARE OMITTED                                    00740000
007500     DATA RECORD IS PRINT-LINE.                                   00750000
007600                                                                  00760000
007700 01  PRINT-LINE                      PIC X(132).                  00770000
007800                                                                  00780000
007810 FD  ORACLE-LOGON-FILE                                            00781001
007820     RECORDING MODE IS F                                          00782001
007830     LABEL RECORDS ARE STANDARD                                   00783001
007840     BLOCK CONTAINS 0 RECORDS                                     00784001
007850     RECORD CONTAINS 80 CHARACTERS                                00785001
007860     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00786001
007870                                                                  00787001
007880 01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       00788001
007890                                                                  00789001
007900     EJECT                                                        00790000
008000                                                                  00800000
008100 WORKING-STORAGE SECTION.                                         00810000
008200                                                                  00820000
008300 01 PV-PROGRAM-VARIABLES.                                         00830000
008310     05  PV-ORACLE-USERID-LEN       PIC S9(4) VALUE ZEROS         00831001
008320                                              COMP SYNC.          00832001
008330     05  PV-ORACLE-PASSWORD-LEN     PIC S9(4) VALUE ZEROS         00833001
008340                                              COMP SYNC.          00834001
008400     05 PV-LINE-CNT                                  PIC S9(3)    00840000
008500                                                     VALUE +0     00850000
008600                                                     COMP-3.      00860000
008700     05 PV-PAGE-CNT                                  PIC 9(3)     00870000
008800                                                     VALUE ZEROS  00880000
008900                                                     COMP-3.      00890000
009000     05 PV-CSR-FETCHED-CNT                           PIC 9(8)     00900000
009100                                                     VALUE ZEROS. 00910000
009200     05 PV-DETAIL-LINE-CNT                           PIC 9(8)     00920000
009300                                                     VALUE ZEROS. 00930000
009400     05 PV-PARAGRAPH-NAME             PIC X(30)   VALUE SPACES.   00940000
009500     05 PV-OPERATION                  PIC X(30)   VALUE SPACES.   00950000
009600     05  PV-YYMMDD-DATE.                                          00960000
009700         10  PV-YYMMDD-YY             PIC  X(02)    VALUE SPACE.  00970000
009800         10  PV-YYMMDD-MM             PIC  X(02)    VALUE SPACE.  00980000
009900         10  PV-YYMMDD-DD             PIC  X(02)    VALUE SPACE.  00990000
010000     05  PV-YEAR.                                                 01000000
010100         15  PV-YEAR-CC               PIC  X(02)    VALUE SPACE.  01010000
010200         15  PV-YEAR-YY               PIC  X(02)    VALUE SPACE.  01020000
010300     05  PV-TIME-HHMMSS.                                          01030000
010400         10  PV-TIME-HHMMSS-HH        PIC  X(02)    VALUE SPACES. 01040000
010500         10  PV-TIME-HHMMSS-MM        PIC  X(02)    VALUE SPACES. 01050000
010600         10  PV-TIME-HHMMSS-SS        PIC  X(02)    VALUE SPACES. 01060000
010700     05  PV-BOW-DATE-FMT.                                         01070000
010800         10 PV-BOW-DATE               PIC  X(10)    VALUE SPACES. 01080000
010900         10 FILLER                    PIC  X(09)                  01090000
011000                                           VALUE '.00.00.01'.     01100000
011100     05  PV-ORD-RN-DATE               PIC  X(10)    VALUE SPACES. 01110000
011200     05  PV-ORACLE-BOW-DATE           PIC  X(19)    VALUE SPACES. 01120000
011300     05  PV-GMA-NBR                   PIC  X(02)    VALUE SPACES. 01130000
011400     05  PV-DMA-NBR                   PIC  X(02)    VALUE SPACES. 01140000
011500     05  PV-HOLD-GMA                  PIC  X(02)    VALUE SPACES. 01150000
011600     05  PV-HOLD-DMA                  PIC  X(02)    VALUE SPACES. 01160000
011700     05  PV-GMA-NAME                  PIC  X(18)    VALUE SPACES. 01170000
011800     05  PV-DMA-NAME                  PIC  X(18)    VALUE SPACES. 01180000
011900     05  PV-SKU-CNT                   PIC S9(9)     COMP-3        01190000
012000                                                    VALUE ZERO.   01200000
012100     05  PV-ORD-QTY-CNT               PIC S9(8)     COMP-3        01210000
012200                                                    VALUE ZERO.   01220000
012300     05  PV-SUM-RTL-AMT               PIC S9(9)V99  COMP-3        01230000
012400                                                    VALUE ZERO.   01240000
012500     05  PV-SUM-COST-AMT              PIC S9(9)V99  COMP-3        01250000
012600                                                    VALUE ZERO.   01260000
012700     05  PV-EX-DEPT-CNT                              PIC 9(8)     01270000
012800                                                     VALUE ZEROS. 01280000
012900     05  PV-DEPT-NBR                  PIC X(03)    VALUE SPACES.  01290000
013000*                                                                 01300000
013100 01 PV-TOTAL-VARIABLES.                                           01310000
013200     05 PV-TOT1-ORDER-LINES                          PIC S9(9)V99 01320000
013300                                                       COMP-3.    01330000
013400     05 PV-TOT1-TOTORDQTY                            PIC S9(8)    01340000
013500                                                       COMP-3.    01350000
013600     05 PV-TOT1-TOTCOST                              PIC S9(9)V99 01360000
013700                                                       COMP-3.    01370000
013800     05 PV-TOT1-TOTRETAIL                            PIC S9(9)V99 01380000
013900                                                       COMP-3.    01390000
014000     05 PV-TOT2-ORDER-LINES                          PIC S9(9)V99 01400000
014100                                                       COMP-3.    01410000
014200     05 PV-TOT2-TOTORDQTY                            PIC S9(8)    01420000
014300                                                       COMP-3.    01430000
014400     05 PV-TOT2-TOTCOST                              PIC S9(9)V99 01440000
014500                                                       COMP-3.    01450000
014600     05 PV-TOT2-TOTRETAIL                            PIC S9(9)V99 01460000
014700                                                       COMP-3.    01470000
014800******************************************************************01480000
014900* WORKING-STORAGE FOR CALENDAR ROUTINE                            01490000
015000******************************************************************01500000
015100     COPY DPWS500.                                                01510000
015200******************************************************************01520000
015300* STANDARD HEADER LINE - KOHLS 132 COL                            01530000
015400******************************************************************01540000
015500     COPY DPWS132.                                                01550000
015600******************************************************************01560000
015700* DATE CONTROL CARD                                               01570000
015800******************************************************************01580000
015900 01  CC-DATE-CONTROL-CARD.                                        01590000
016000     05  CC-DATE.                                                 01600000
016100         10  CC-DATE-CC               PIC  X(02)     VALUE SPACE. 01610000
016200         10  CC-DATE-YY               PIC  X(02)     VALUE SPACE. 01620000
016300         10  CC-DATE-DASH1            PIC  X         VALUE SPACE. 01630000
016400         10  CC-DATE-MM               PIC  X(02)     VALUE SPACE. 01640000
016500         10  CC-DATE-DASH2            PIC  X         VALUE SPACE. 01650000
016600         10  CC-DATE-DD               PIC  X(02)     VALUE SPACE. 01660000
016700     05  FILLER                       PIC  X(70)     VALUE SPACE. 01670000
016800                                                                  01680000
016900******************************************************************01690000
017000* SYSTEM ID CONTROL CARD                                          01700000
017100******************************************************************01710000
017200 01  CC-SYS-RECORD.                                               01720000
017300     05  CC-SYS-ID1                   PIC  X(02)     VALUE SPACE. 01730000
017400     05  FILLER                       PIC  X(01)     VALUE SPACE. 01740000
017500     05  CC-SYS-ID2                   PIC  X(02)     VALUE SPACE. 01750000
017600     05  FILLER                       PIC  X(01)     VALUE SPACE. 01760000
017700     05  CC-SYS-ID3                   PIC  X(02)     VALUE SPACE. 01770000
017800     05  FILLER                       PIC  X(01)     VALUE SPACE. 01780000
017900     05  CC-SYS-ID4                   PIC  X(02)     VALUE SPACE. 01790000
018000     05  FILLER                       PIC  X(01)     VALUE SPACE. 01800000
018100                                                                  01810000
018200******************************************************************01820000
018300* EXCLUDED DEPT CONTROL CARD                                      01830000
018400******************************************************************01840000
018500*JL                                                               01850000
018600 01  CC-DEPT-RECORD.                                              01860000
018700     05  CC-DEPT-ID1                  PIC  9(3)      VALUE ZERO.  01870000
018800     05  FILLER                       PIC  X(01)     VALUE SPACE. 01880000
018900     05  CC-DEPT-ID2                  PIC  9(3)      VALUE ZERO.  01890000
019000     05  FILLER                       PIC  X(01)     VALUE SPACE. 01900000
019100     05  CC-DEPT-ID3                  PIC  9(3)      VALUE ZERO.  01910000
019200     05  FILLER                       PIC  X(01)     VALUE SPACE. 01920000
019300     05  CC-DEPT-ID4                  PIC  9(3)      VALUE ZERO.  01930000
019400     05  FILLER                       PIC  X(01)     VALUE SPACE. 01940000
019500     05  CC-DEPT-ID5                  PIC  9(3)      VALUE ZERO.  01950000
019600                                                                  01960000
019700 01  DB-KEY-DEPT.                                                 01970000
019800     05  DB-DEPT-ID1                  PIC X(3) VALUE SPACE.       01980000
019900     05  DB-DEPT-ID2                  PIC X(3) VALUE SPACE.       01990000
020000     05  DB-DEPT-ID3                  PIC X(3) VALUE SPACE.       02000000
020100     05  DB-DEPT-ID4                  PIC X(3) VALUE SPACE.       02010000
020200     05  DB-DEPT-ID5                  PIC X(3) VALUE SPACE.       02020000
020300                                                                  02030000
020400 01  EMPTY-REPORT-LINE.                                           02040000
020500     05  FILLER                       PIC X(48)      VALUE        02050000
020600         '          ** NO RECORDS WERE FOUND **         '.        02060000
020700*                                                                 02070000
020800 01  HL-HEADING-BLANK.                                            02080000
020900     05  FILLER                       PIC X(20)      VALUE        02090000
021000         '                    '.                                  02100000
021100*                                                                 02110000
021200 01  HL-HEADING-LINE1.                                            02120000
021300     05  FILLER                       PIC X(49)      VALUE SPACES.02130000
021400     05  FILLER                       PIC X(37)      VALUE        02140000
021500         '         ORDER RERUN REPORT          '.                 02150000
021600     05  FILLER                       PIC X(56)      VALUE SPACE. 02160000
021700*                                                                 02170000
021800 01  HL-HEADING-LINE2.                                            02180000
021900     05  FILLER                       PIC X(05)      VALUE        02190000
022000         'GMM: '.                                                 02200000
022100     05  PRT-GMM                      PIC X(02).                  02210000
022200     05  FILLER                       PIC X(02)      VALUE SPACES.02220000
022300     05  PRT-GMM-NAME                 PIC X(32).                  02230000
022400     05  FILLER                       PIC X(07)      VALUE        02240000
022500         '  DMM: '.                                               02250000
022600     05  PRT-DMM                      PIC X(02).                  02260000
022700     05  FILLER                       PIC X(02)      VALUE SPACES.02270000
022800     05  PRT-DMM-NAME                 PIC X(32).                  02280000
022900     05  FILLER                       PIC X(48)      VALUE SPACES.02290000
023000*                                                                 02300000
023100 01  HL-HEADING-LINE3.                                            02310000
023200     05  FILLER                       PIC X(02)      VALUE SPACES.02320000
023300     05  FILLER                       PIC X(16)      VALUE        02330000
023400         'REFERENCE NUMBER'.                                      02340000
023500     05  FILLER                       PIC X(08)      VALUE SPACE. 02350000
023600     05  FILLER                       PIC X(11)      VALUE        02360000
023700         'VENDOR NAME'.                                           02370000
023800     05  FILLER                       PIC X(12)      VALUE SPACE. 02380000
023900     05  FILLER                       PIC X(09)      VALUE        02390000
024000         '  SYSID  '.                                             02400000
024100     05  FILLER                       PIC X(06)      VALUE SPACE. 02410000
024200     05  FILLER                       PIC X(07)      VALUE        02420000
024300         'CREATED'.                                               02430000
024400     05  FILLER                       PIC X(06)      VALUE SPACE. 02440000
024500     05  FILLER                       PIC X(08)      VALUE        02450000
024600         '  SKUS  '.                                              02460000
024700     05  FILLER                       PIC X(04)      VALUE SPACE. 02470000
024800     05  FILLER                       PIC X(09)      VALUE        02480000
024900         'ORDER QTY'.                                             02490000
025000     05  FILLER                       PIC X(05)      VALUE SPACE. 02500000
025100     05  FILLER                       PIC X(10)      VALUE        02510000
025200         'TOTAL COST'.                                            02520000
025300     05  FILLER                       PIC X(03)      VALUE SPACE. 02530000
025400     05  FILLER                       PIC X(12)      VALUE        02540000
025500         'TOTAL RETAIL'.                                          02550000
025600     05  FILLER                       PIC X(04)      VALUE SPACE. 02560000
025700*                                                                 02570000
025800 01  DETAIL-LINE.                                                 02580000
025900     05  FILLER                       PIC X(02)      VALUE SPACES.02590000
026000     05  PRT-REF-NBR                  PIC X(15).                  02600000
026100     05  FILLER                       PIC X(05)      VALUE SPACE. 02610000
026200     05  PRT-VENDOR-NAME              PIC X(25).                  02620000
026300     05  FILLER                       PIC X(05)      VALUE SPACE. 02630000
026400     05  PRT-SYSID                    PIC X(02).                  02640000
026500     05  FILLER                       PIC X(10)      VALUE SPACE. 02650000
026600     05  PRT-CREATED                  PIC X(10).                  02660000
026700     05  FILLER                       PIC X(03)      VALUE SPACE. 02670000
026800     05  PRT-LINES                    PIC ZZ,ZZ9.                 02680000
026900     05  FILLER                       PIC X(05)      VALUE SPACE. 02690000
027000     05  PRT-TOTAL-QTY                PIC ZZ,ZZZ,ZZ9.             02700000
027100     05  FILLER                       PIC X(02)      VALUE SPACE. 02710000
027200     05  PRT-TOTAL-COST               PIC ZZ,ZZZ,ZZ9.99.          02720000
027300     05  FILLER                       PIC X(01)      VALUE SPACE. 02730000
027400     05  PRT-TOTAL-RETAIL             PIC ZZZ,ZZZ,ZZ9.99.         02740000
027500     05  FILLER                       PIC X(04)      VALUE SPACE. 02750000
027600*                                                                 02760000
027700 01  DETAIL-END.                                                  02770000
027800     05  FILLER                       PIC X(20)      VALUE        02780000
027900         '** END OF REPORT ** '.                                  02790000
028000*                                                                 02800000
028100 01  HL-TOTAL-LINE1.                                              02810000
028200     05  FILLER                       PIC X(31)      VALUE        02820000
028300         'TOTAL OF DIVISION RERUN        '.                       02830000
028400     05  FILLER                       PIC X(43)      VALUE SPACE. 02840000
028500     05  TOT1-ORDER-LINES             PIC Z,ZZZ,ZZ9.              02850000
028600     05  FILLER                       PIC X(05)      VALUE SPACE. 02860000
028700     05  TOT1-TOTORD-QTY              PIC ZZ,ZZZ,ZZ9.             02870000
028800     05  FILLER                       PIC X(02)      VALUE SPACE. 02880000
028900     05  TOT1-TOTCOST                 PIC ZZ,ZZZ,ZZZ.99.          02890000
029000     05  FILLER                       PIC X(01)      VALUE SPACE. 02900000
029100     05  TOT1-TOTRETAIL               PIC ZZZ,ZZZ,ZZZ.99.         02910000
029200     05  FILLER                       PIC X(04)      VALUE SPACE. 02920000
029300*                                                                 02930000
029400 01  HL-TOTAL-LINE2.                                              02940000
029500     05  FILLER                       PIC X(30)      VALUE        02950000
029600         'TOTAL OF GMM RERUN           '.                         02960000
029700     05  FILLER                       PIC X(44)      VALUE SPACE. 02970000
029800     05  TOT2-ORDER-LINES             PIC Z,ZZZ,ZZ9.              02980000
029900     05  FILLER                       PIC X(05)      VALUE SPACE. 02990000
030000     05  TOT2-TOTORD-QTY              PIC ZZ,ZZZ,ZZ9.             03000000
030100     05  FILLER                       PIC X(02)      VALUE SPACE. 03010000
030200     05  TOT2-TOTCOST                 PIC ZZ,ZZZ,ZZZ.99.          03020000
030300     05  FILLER                       PIC X(01)      VALUE SPACE. 03030000
030400     05  TOT2-TOTRETAIL               PIC ZZZ,ZZZ,ZZZ.99.         03040000
030500     05  FILLER                       PIC X(04)      VALUE SPACE. 03050000
030600*                                                                 03060000
030700 01  PC-PROGRAM-CONSTANTS.                                        03070000
030800     05  PC-PROGRAM-NAME                 PIC X(08)   VALUE        03080000
030900                                                     'MRKRP140'.  03090000
031000     05  PC-OP-CO-NMBR                   PIC X(02)   VALUE '03'.  03100000
031100     05  PC-LEVEL-DPT                    PIC  X(3)   VALUE 'DPT'. 03110000
031200     05  PC-TYPES.                                                03120000
031300         10 PC-BUYER                     PIC X(03)   VALUE 'BYR'. 03130000
031400         10 PC-DMM                       PIC X(03)   VALUE 'DMM'. 03140000
031500         10 PC-GMM                       PIC X(03)   VALUE 'GMM'. 03150000
031600         10 PC-DMA                       PIC X(03)   VALUE 'DMA'. 03160000
031700         10 PC-GMA                       PIC X(03)   VALUE 'GMA'. 03170000
031800     05  PC-SPACE                        PIC  X(1)   VALUE SPACE. 03180000
031900     05  PC-MAX-LINES                 PIC S9(3)      VALUE +52    03190000
032000                                                     COMP-3.      03200000
032100*                                                                 03210000
032200 01  PS-PROGRAM-SWITCHES.                                         03220000
032210     05  PS-END-OF-LOGON-FILE-SW      PIC X(01)      VALUE 'N'.   03221001
032220         88  PS-END-OF-LOGON-FILE                    VALUE 'Y'.   03222001
032230     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(01)      VALUE 'N'.   03223001
032240         88  PS-ORA-SRC-EMPTY                        VALUE 'Y'.   03224001
032300     05  PS-RECORDS-SW                PIC X(01)      VALUE 'N'.   03230000
032400         88  PS-END-OF-RECORDS                       VALUE 'Y'.   03240000
032500         88  PS-FIRST-RECORD                         VALUE 'F'.   03250000
032600     05  PS-GMA-DMA-TOTAL-SW          PIC X(01)      VALUE 'N'.   03260000
032700         88  PS-GMA-DMA-TOTAL                        VALUE 'Y'.   03270000
032800         88  PS-NOT-GMA-DMA-TOTAL                    VALUE 'N'.   03280000
032900     05  PS-EXCLUDED-REC-SW           PIC X(01)      VALUE 'N'.   03290000
033000         88  PS-NOT-EXCLUDED                         VALUE 'Y'.   03300000
033100         88  PS-EXCLUDED                             VALUE 'N'.   03310000
033110                                                                  03311001
033122 01  CC-ORACLE-CONNECTION.                                        03312201
033123     05  CC-ORACLE-USERID             PIC X(40).                  03312301
033124         88 CC-AUTO-LOGON                            VALUE '/'.   03312401
033125     05  CC-ORACLE-PASSWORD           PIC X(40).                  03312501
033130                                                                  03313001
033200******************************************************************03320000
033300*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        03330000
033400******************************************************************03340000
033500     COPY DPWS004.                                                03350000
033600****************************************************************  03360000
033700**ORACLE DECLARE SECTION                                          03370000
033800****************************************************************  03380000
033900     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     03390000
034000                                                                  03400000
034100 01  USERNAME                    PIC  X(10)  VARYING.             03410000
034200 01  PASSWD                      PIC  X(10)  VARYING.             03420000
034300 01  PV-ORACLE-ID                PIC  X(01)  VALUE '/'.           03430000
034400 01  PV-SUM-ORD-NULL             PIC S9(04)   COMP VALUE 0.       03440000
034500 01  PV-SUM-RTL-NULL             PIC S9(04)   COMP VALUE 0.       03450000
034600 01  PV-SUM-COST-NULL            PIC S9(04)   COMP VALUE 0.       03460000
034700                                                                  03470000
034800******************************************************************03480000
034900* COBOL DECLARATION FOR TABLE SGT_STG_PO                          03490000
035000******************************************************************03500000
035100     EXEC SQL                                                     03510000
035200         INCLUDE SGT00001                                         03520000
035300     END-EXEC.                                                    03530000
035400******************************************************************03540000
035500* COBOL DECLARATION FOR TABLE SGT_STG_RPLNT_PO                    03550000
035600******************************************************************03560000
035700     EXEC SQL                                                     03570000
035800         INCLUDE SGT00002                                         03580000
035900     END-EXEC.                                                    03590000
036000******************************************************************03600000
036100* COBOL DECLARATION FOR TABLE SGT_STG_PO_SKU                      03610000
036200******************************************************************03620000
036300     EXEC SQL                                                     03630000
036400         INCLUDE SGT00003                                         03640000
036500     END-EXEC.                                                    03650000
036600******************************************************************03660000
036700* COBOL DECLARATION FOR TABLE SGT_STG_AUD                         03670000
036800******************************************************************03680000
036900     EXEC SQL                                                     03690000
037000         INCLUDE SGT00005                                         03700000
037100     END-EXEC.                                                    03710000
037200******************************************************************03720000
037300* COBOL DECLARATION FOR TABLE TMDSEAR                             03730000
037400******************************************************************03740000
037500     EXEC SQL                                                     03750000
037600         INCLUDE TMDSEAR                                          03760000
037700     END-EXEC.                                                    03770000
037800                                                                  03780000
037900******************************************************************03790000
038000* COBOL DECLARATION FOR TABLE TRSPBAR                             03800000
038100******************************************************************03810000
038200     EXEC SQL                                                     03820000
038300         INCLUDE TRSPBAR                                          03830000
038400     END-EXEC.                                                    03840000
038500******************************************************************03850000
038600* COBOL DECLARATION FOR TABLE XMT_VND                             03860000
038700******************************************************************03870000
038800 01  XMTVND.                                                      03880000
038900     05 XMTVND-ENT-ID                 PIC   S9(9) COMP.           03890000
039000     05 XMTVND-PRIM-VND-NM            PIC   X(30).                03900000
039100     05 XMTVND-VND-NBR                PIC   X(9).                 03910000
039200     05 XMTVND-STAT-CDE               PIC   X(1).                 03920000
039300     05 XMTVND-VND-CRE-TMST           PIC   X(26).                03930000
039400     05 XMTVND-VND-LAST-UPD-TMST      PIC   X(26).                03940000
039500                                                                  03950000
039600     EXEC SQL END DECLARE SECTION END-EXEC.                       03960000
039700     EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       03970000
039800                                                                  03980000
039900******************************************************************03990000
040000*  ERROR PROCESSING VARIABLES                                     04000000
040100******************************************************************04010000
040200                                                                  04020000
040300 01  ABEND-CODE                          PIC S9(04)  VALUE +0     04030000
040400                                                     COMP SYNC.   04040000
040500*                                                                 04050000
040600****************************************************************  04060000
040700 PROCEDURE DIVISION.                                              04070000
040800****************************************************************  04080000
040900* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  04090000
041000* PROGRAM.                                                     *  04100000
041100****************************************************************  04110000
041200 0000-PROGRAM-MAINLINE.                                           04120000
041300                                                                  04130000
041400     PERFORM 1000-PREPROCESSOR.                                   04140000
041500                                                                  04150000
041600     IF PS-END-OF-RECORDS                                         04160000
041700        WRITE PRINT-LINE FROM EMPTY-REPORT-LINE                   04170000
041800              AFTER ADVANCING 2                                   04180000
041900        PERFORM 1400-CLOSE-CURSOR                                 04190000
042000        CLOSE DATE-CONTROL-CARD-FILE                              04200000
042100              SYS-ID1-CONTROL-CARD-FILE                           04210000
042200              DEPT-EXCP-CARD-FILE                                 04220000
042300              PRINT-REPORT                                        04230000
042400     ELSE                                                         04240000
042500        PERFORM 2000-PROCESS-CURSOR                               04250000
042600          UNTIL PS-END-OF-RECORDS                                 04260000
042700        PERFORM 1900-EOF-PROCESSING                               04270000
042800     END-IF.                                                      04280000
042900                                                                  04290000
043000     STOP RUN.                                                    04300000
043100                                                                  04310000
043200****************************************************************  04320000
043300* 1000-PREPROCESSOR OPENS ALL FILES ASSOCIATED WITH THE JOB,   *  04330000
043400* READS THE DATE CONTROL CARD FILE AND LOGS INTO THE ORACLE    *  04340000
043500* DATABASE.                                                    *  04350000
043600****************************************************************  04360000
043700 1000-PREPROCESSOR.                                               04370000
043800                                                                  04380000
043900     DISPLAY '** START OF MRKRP140 **'.                           04390000
044000     OPEN INPUT  DATE-CONTROL-CARD-FILE                           04400000
044100                 SYS-ID1-CONTROL-CARD-FILE                        04410000
044200                 DEPT-EXCP-CARD-FILE.                             04420000
044300     OPEN OUTPUT PRINT-REPORT.                                    04430000
044400                                                                  04440000
044500     INITIALIZE PV-PROGRAM-VARIABLES.                             04450000
044600     INITIALIZE PV-TOTAL-VARIABLES.                               04460000
044700     MOVE 'N' TO PS-RECORDS-SW.                                   04470000
044800     MOVE SPACES TO PV-HOLD-GMA                                   04480000
044900                    PV-HOLD-DMA.                                  04490000
045000                                                                  04500000
045100     ACCEPT PV-YYMMDD-DATE FROM DATE.                             04510000
045200     MOVE PV-YYMMDD-YY          TO PV-YEAR-YY.                    04520000
045300                                                                  04530000
045400     IF PV-YYMMDD-YY > 80                                         04540000
045500        MOVE 19 TO PV-YEAR-CC                                     04550000
045600     ELSE                                                         04560000
045700        MOVE 20 TO PV-YEAR-CC                                     04570000
045800     END-IF.                                                      04580000
045900                                                                  04590000
046000     MOVE PV-YEAR               TO DP132-RUN-YEAR.                04600000
046100     MOVE PV-YYMMDD-MM          TO DP132-RUN-MONTH.               04610000
046200     MOVE PV-YYMMDD-DD          TO DP132-RUN-DAY.                 04620000
046300                                                                  04630000
046400     ACCEPT PV-TIME-HHMMSS FROM TIME.                             04640000
046500     MOVE PV-TIME-HHMMSS-HH     TO DP132-RUN-HOUR.                04650000
046600     MOVE PV-TIME-HHMMSS-MM     TO DP132-RUN-MINUTE.              04660000
046700                                                                  04670000
046800     MOVE 1                           TO DP132-REPORT-NUMBER.     04680000
046900     MOVE 'MRKRP140'                  TO DP132-PROGRAM-NAME.      04690000
047000                                                                  04700000
047100                                                                  04710000
047200     SET PS-NOT-GMA-DMA-TOTAL TO TRUE.                            04720000
047300                                                                  04730000
047400     PERFORM 1050-PROCESS-CONTROL-CARD.                           04740000
047500                                                                  04750000
047610     PERFORM 9000-ORACLE-SETUP.                                   04761001
047700                                                                  04770000
047800     PERFORM 1200-DECLARE-OPEN-CURSOR.                            04780000
047900                                                                  04790000
048000     PERFORM 2500-FETCH-CURSOR                                    04800000
048100         UNTIL (PS-NOT-EXCLUDED                                   04810000
048200             OR PS-END-OF-RECORDS).                               04820000
048300                                                                  04830000
048400     SET PS-EXCLUDED TO TRUE.                                     04840000
048500                                                                  04850000
048600     PERFORM 3000-REPORT-HEADINGS.                                04860000
048700                                                                  04870000
048800     MOVE PV-GMA-NBR      TO PV-HOLD-GMA.                         04880000
048900     MOVE PV-DMA-NBR      TO PV-HOLD-DMA.                         04890000
049000                                                                  04900000
049100     IF PS-END-OF-RECORDS                                         04910000
049200        CONTINUE                                                  04920000
049300     ELSE                                                         04930000
049400        PERFORM 2600-PROCESS-DETAIL                               04940000
049500     END-IF.                                                      04950000
049600                                                                  04960000
049700****************************************************************  04970000
049800* VALIDATE THE CONTROL CARD DATE                                  04980000
049900****************************************************************  04990000
050000 1050-PROCESS-CONTROL-CARD.                                       05000000
050100                                                                  05010000
050200     READ DATE-CONTROL-CARD-FILE INTO CC-DATE-CONTROL-CARD        05020000
050300         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP140'         05030000
050400                DISPLAY '** DATE-CONTROL-CARD-FILE EMPTY'         05040000
050500                MOVE +4003 TO ABEND-CODE                          05050000
050600                CALL 'ILBOABN0' USING ABEND-CODE.                 05060000
050700                                                                  05070000
050800     DISPLAY SPACES.                                              05080000
050900     DISPLAY '** MRKRP140 CONTROL-CARD: ' CC-DATE.                05090000
051000                                                                  05100000
051100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05110000
051200     SET DPG51-FISCAL-JAN-DEC-F2                                  05120000
051300         DPG51-DO-NOT-INCR-DECR-DATE                              05130000
051400         DPG52-LK-DTE-ISO-FMT        TO TRUE.                     05140000
051500     MOVE CC-DATE TO DPG52-LK-DATE-INPUT                          05150000
051600                                                                  05160000
051700     CALL DP500-KOHLS-CALENDAR-ROUTINE                            05170000
051800         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               05180000
051900                                                                  05190000
052000     IF DPG54-DATE-INVALID                                        05200000
052100         DISPLAY '** ABEND ** IN MRKRP140'                        05210000
052200         DISPLAY '** PARAGRAPH: 1050-PROCESS-CONTROL-CARD.'       05220000
052300         DISPLAY '** INVALID PROCESS DATE ON CONTROL CARD.'       05230000
052400         DISPLAY '** CALENDAR ROUTINE ERROR MESSAGE = '           05240000
052500                     DPG54-ERROR-MESSAGE                          05250000
052600         DISPLAY '** DPG51 = ' DPG51                              05260000
052700         DISPLAY '** DPG52 = ' DPG52                              05270000
052800         DISPLAY '** DPG53 = ' DPG53                              05280000
052900         DISPLAY '** DPG54 = ' DPG54                              05290000
053000         DISPLAY '** DPG55 = ' DPG55                              05300000
053100         DISPLAY '** DPG56 = ' DPG56                              05310000
053200         MOVE +4003 TO ABEND-CODE                                 05320000
053300         CALL 'ILBOABN0' USING ABEND-CODE                         05330000
053400     ELSE                                                         05340000
053500         IF DPG54-SEVERE-ERROR                                    05350000
053600             DISPLAY '** ABEND ** IN MRKRP140'                    05360000
053700             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.'   05370000
053800             DISPLAY '** CALLED BY 1050-PROCESS-CONTROL-CARD.'    05380000
053900             DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE    05390000
054000             DISPLAY '** DPG51 = ' DPG51                          05400000
054100             DISPLAY '** DPG52 = ' DPG52                          05410000
054200             DISPLAY '** DPG53 = ' DPG53                          05420000
054300             DISPLAY '** DPG54 = ' DPG54                          05430000
054400             DISPLAY '** DPG55 = ' DPG55                          05440000
054500             DISPLAY '** DPG56 = ' DPG56                          05450000
054600             MOVE +4003 TO ABEND-CODE                             05460000
054700             CALL 'ILBOABN0' USING ABEND-CODE                     05470000
054800         ELSE                                                     05480000
054900             IF DPG54-WARNING-ERROR                               05490000
055000                 DISPLAY                                          05500000
055100                       '** WARNING RETURNED BY CALENDAR ROUTINE.' 05510000
055200                 DISPLAY                                          05520000
055300                       '** CALLED BY 1050-PROCESS-CONTROL-CARD.'  05530000
055400                 DISPLAY                                          05540000
055500                       '** WARNING MESSAGE = ' DPG54-ERROR-MESSAGE05550000
055600             END-IF                                               05560000
055700         END-IF                                                   05570000
055800     END-IF.                                                      05580000
055900                                                                  05590000
056000     MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO  PV-BOW-DATE.              05600000
056100     MOVE PV-BOW-DATE-FMT           TO  PV-ORACLE-BOW-DATE.       05610000
056200                                                                  05620000
056300     DISPLAY SPACES.                                              05630000
056400     DISPLAY '** BEGIN OF WEEK DATE: ' PV-BOW-DATE.               05640000
056500                                                                  05650000
056600     READ SYS-ID1-CONTROL-CARD-FILE INTO CC-SYS-RECORD            05660000
056700         AT END DISPLAY '** ABEND ** IN PROGRAM MRKRP140'         05670000
056800                DISPLAY '** SYS-ID1-CONTROL-CARD-FILE EMPTY'      05680000
056900                MOVE +4003 TO ABEND-CODE                          05690000
057000                CALL 'ILBOABN0' USING ABEND-CODE.                 05700000
057100                                                                  05710000
057200     DISPLAY SPACES.                                              05720000
057300     DISPLAY '** MRKRP140 SYSTEM-ID 1 : ' CC-SYS-ID1.             05730000
057400     DISPLAY SPACES.                                              05740000
057500     DISPLAY '** MRKRP140 SYSTEM-ID 2 : ' CC-SYS-ID2.             05750000
057600     DISPLAY SPACES.                                              05760000
057700     DISPLAY '** MRKRP140 SYSTEM-ID 3 : ' CC-SYS-ID3.             05770000
057800     DISPLAY SPACES.                                              05780000
057900     DISPLAY '** MRKRP140 SYSTEM-ID 4 : ' CC-SYS-ID4.             05790000
058000                                                                  05800000
058100     READ DEPT-EXCP-CARD-FILE INTO CC-DEPT-RECORD                 05810000
058200         AT END DISPLAY '** NO EXCLUDED DEPARTMENTS'.             05820000
058300                                                                  05830000
058400     DISPLAY SPACES.                                              05840000
058500     DISPLAY '** MRKRP140 DEPT-ID1   : ' CC-DEPT-ID1.             05850000
058600     DISPLAY SPACES.                                              05860000
058700     DISPLAY '** MRKRP140 DEPT-ID2   : ' CC-DEPT-ID2.             05870000
058800     DISPLAY SPACES.                                              05880000
058900     DISPLAY '** MRKRP140 DEPT-ID3   : ' CC-DEPT-ID3.             05890000
059000     DISPLAY SPACES.                                              05900000
059100     DISPLAY '** MRKRP140 DEPT-ID4   : ' CC-DEPT-ID4.             05910000
059200     DISPLAY SPACES.                                              05920000
059300     DISPLAY '** MRKRP140 DEPT-ID5   : ' CC-DEPT-ID5.             05930000
059400                                                                  05940000
059500     MOVE CC-DEPT-ID1  TO  DB-DEPT-ID1.                           05950000
059600     MOVE CC-DEPT-ID2  TO  DB-DEPT-ID2.                           05960000
059700     MOVE CC-DEPT-ID3  TO  DB-DEPT-ID3.                           05970000
059800     MOVE CC-DEPT-ID4  TO  DB-DEPT-ID4.                           05980000
059900     MOVE CC-DEPT-ID5  TO  DB-DEPT-ID5.                           05990000
060000                                                                  06000000
060100****************************************************************  06010000
060200* DECLARES THE SUGGESTED ORDER CURSOR.                         *  06020000
060300* THE FOLLOWING CURSOR WILL SELECT ORDERS IN AN 'A' - ACCEPTED *  06030000
060400* OR 'C' - CREATED STAGING STATUS CODE.                        *  06040000
060500* OPEN THE SUGGESTED ORDER CURSOR.                             *  06050000
060600****************************************************************  06060000
060700 1200-DECLARE-OPEN-CURSOR.                                        06070000
060800                                                                  06080000
060900     EXEC SQL                                                     06090000
061000        DECLARE SUGG_ORD_CSR CURSOR FOR                           06100000
061100           SELECT /*+ ORDERED */ A.STG_PO_ID                      06110000
061200                 ,F.GMA_NBR                                       06120000
061300                 ,F.DMA_NBR                                       06130000
061400                 ,A.SRC_SYS_KY_TXT                                06140000
061500                 ,E.PRIM_VND_NM                                   06150000
061600                 ,D.MR_SYS_CDE                                    06160000
061700                 ,TO_CHAR(D.ORD_RN_DTE,'MM-DD-YYYY')              06170000
061800                 ,F.DEPT_NBR                                      06180000
061900             FROM SGT_STG_AUD A                                   06190000
062000                 ,SGT_STG_PO B                                    06200000
062100                 ,SGT_STG_RPLNT_PO D                              06210000
062200                 ,XMT_VND E                                       06220000
062300                 ,TMDSEAR F                                       06230000
062400            WHERE A.STG_PO_ID = B.STG_PO_ID                       06240000
062500              AND B.STG_PO_ID = D.STG_PO_ID                       06250000
062600              AND B.ENT_ID = E.ENT_ID                             06260000
062700              AND A.CRE_DTE >= TO_DATE(:PV-ORACLE-BOW-DATE,       06270000
062800                                        'YYYY-MM-DD.HH24.MI.SS')  06280000
062900              AND F.OPERCO_NBR = '03'                             06290000
063000              AND F.DEPT_NBR = B.DEPT_NBR                         06300000
063100              AND (D.MR_SYS_CDE = :CC-SYS-ID1                     06310000
063200                OR D.MR_SYS_CDE = :CC-SYS-ID2                     06320000
063300                OR D.MR_SYS_CDE = :CC-SYS-ID3                     06330000
063400                OR D.MR_SYS_CDE = :CC-SYS-ID4)                    06340000
063500              AND F.MDSELV_CDE = :PC-LEVEL-DPT                    06350000
063600              AND SYSDATE < F.END_DTE                             06360000
063700         ORDER BY F.GMA_NBR                                       06370000
063800                 ,F.DMA_NBR                                       06380000
063900                 ,A.SRC_SYS_KY_TXT                                06390000
064000                 ,D.MR_SYS_CDE                                    06400000
064100                 ,D.ORD_RN_DTE                                    06410000
064200                 ,E.PRIM_VND_NM                                   06420000
064300     END-EXEC.                                                    06430000
064400                                                                  06440000
064500     EXEC SQL                                                     06450000
064600         OPEN SUGG_ORD_CSR                                        06460000
064700     END-EXEC.                                                    06470000
064800                                                                  06480000
064900     EVALUATE TRUE                                                06490000
065000         WHEN SQLCODE = ZERO                                      06500000
065100             CONTINUE                                             06510000
065200         WHEN SQLCODE = 1403                                      06520000
065300             SET PS-END-OF-RECORDS TO TRUE                        06530000
065400         WHEN OTHER                                               06540000
065500             MOVE '1200-DECLARE-OPEN-CURSOR'                      06550000
065600                                        TO PV-PARAGRAPH-NAME      06560000
065700             MOVE 'DECLARE/OPEN CSR '   TO PV-OPERATION           06570000
065800             PERFORM 9900-SQL-ERROR                               06580000
065900     END-EVALUATE.                                                06590000
066000****************************************************************  06600000
066100* CLOSE THE SUGGESTED ORDER CURSOR.                            *  06610000
066200****************************************************************  06620000
066300 1400-CLOSE-CURSOR.                                               06630000
066400                                                                  06640000
066500     EXEC SQL                                                     06650000
066600         CLOSE SUGG_ORD_CSR                                       06660000
066700     END-EXEC.                                                    06670000
066800                                                                  06680000
066900     EVALUATE TRUE                                                06690000
067000         WHEN SQLCODE = ZERO                                      06700000
067100             CONTINUE                                             06710000
067200         WHEN OTHER                                               06720000
067300             MOVE '1400-CLOSE-CURSOR'                             06730000
067400                                        TO PV-PARAGRAPH-NAME      06740000
067500             MOVE 'CLOSE SUGG_ORD_CSR'  TO PV-OPERATION           06750000
067600             PERFORM 9900-SQL-ERROR                               06760000
067700     END-EVALUATE.                                                06770000
067800******************************************************************06780000
067900* 1900-EOF-PROCESSING - CLOSES ALL FILES ASSOCIATED WITH THE JOB *06790000
068000******************************************************************06800000
068100                                                                  06810000
068200 1900-EOF-PROCESSING.                                             06820000
068300                                                                  06830000
068400     PERFORM 5000-PRINT-DMM-TOTAL.                                06840000
068500     PERFORM 5100-PRINT-GMM-TOTAL.                                06850000
068600                                                                  06860000
068700     WRITE PRINT-LINE FROM DETAIL-END                             06870000
068800         AFTER ADVANCING 2.                                       06880000
068900                                                                  06890000
069000     PERFORM 1400-CLOSE-CURSOR.                                   06900000
069100                                                                  06910000
069200     CLOSE DATE-CONTROL-CARD-FILE                                 06920000
069300           PRINT-REPORT.                                          06930000
069400                                                                  06940000
069500     DISPLAY SPACES.                                              06950000
069600     DISPLAY '** NUMBER OF ROWS FETCHED: ' PV-CSR-FETCHED-CNT.    06960000
069700     DISPLAY SPACES.                                              06970000
069800     DISPLAY '** NUMBER OF DETAIL LINES WRITTEN: '                06980000
069900                                           PV-DETAIL-LINE-CNT.    06990000
070000     DISPLAY '** NUMBER OF ROWS EXCLUDED:' PV-EX-DEPT-CNT.        07000000
070100     DISPLAY SPACES.                                              07010000
070200     DISPLAY '** END OF MRKRP140   **'.                           07020000
070300                                                                  07030000
070400****************************************************************  07040000
070500* THIS PARAGRAPH WILL PROCESS THE CURSOR TO PRINT THE REPORT.  *  07050000
070600****************************************************************  07060000
070700 2000-PROCESS-CURSOR.                                             07070000
070800                                                                  07080000
070900     PERFORM 2500-FETCH-CURSOR                                    07090000
071000         UNTIL (PS-NOT-EXCLUDED                                   07100000
071100             OR PS-END-OF-RECORDS).                               07110000
071200                                                                  07120000
071300     IF PS-END-OF-RECORDS                                         07130000
071400        CONTINUE                                                  07140000
071500     ELSE                                                         07150000
071600        SET PS-EXCLUDED TO TRUE                                   07160000
071700        PERFORM 2600-PROCESS-DETAIL                               07170000
071800     END-IF.                                                      07180000
071900                                                                  07190000
072000****************************************************************  07200000
072100* THIS PARAGRAPH WILL FETCH THE SUGGESTED ORDER CURSOR VALUES. *  07210000
072200****************************************************************  07220000
072300 2500-FETCH-CURSOR.                                               07230000
072400                                                                  07240000
072500     EXEC SQL                                                     07250000
072600         FETCH SUGG_ORD_CSR                                       07260000
072700          INTO :SGT00005.STG-PO-ID                                07270000
072800              ,:PV-GMA-NBR                                        07280000
072900              ,:PV-DMA-NBR                                        07290000
073000              ,:SGT00005.SRC-SYS-KY-TXT                           07300000
073100              ,:XMTVND-PRIM-VND-NM                                07310000
073200              ,:SGT00002.MR-SYS-CDE                               07320000
073300              ,:PV-ORD-RN-DATE                                    07330000
073400              ,:PV-DEPT-NBR                                       07340000
073500     END-EXEC.                                                    07350000
073600                                                                  07360000
073700     EVALUATE TRUE                                                07370000
073800        WHEN SQLCODE = ZERO                                       07380000
073900            ADD +1 TO PV-CSR-FETCHED-CNT                          07390000
074000            EVALUATE TRUE                                         07400000
074100                WHEN ((MR-SYS-CDE IN SGT00002 = '2A')             07410000
074200                    AND ((PV-DEPT-NBR = DB-DEPT-ID1)              07420000
074300                     OR  (PV-DEPT-NBR = DB-DEPT-ID2)              07430000
074400                     OR  (PV-DEPT-NBR = DB-DEPT-ID3)              07440000
074500                     OR  (PV-DEPT-NBR = DB-DEPT-ID4)              07450000
074600                     OR  (PV-DEPT-NBR = DB-DEPT-ID5)))            07460000
074700                         ADD +1 TO PV-EX-DEPT-CNT                 07470000
074800                         SET PS-EXCLUDED TO TRUE                  07480000
074900                WHEN OTHER                                        07490000
075000                    SET PS-NOT-EXCLUDED TO TRUE                   07500000
075100            END-EVALUATE                                          07510000
075200        WHEN SQLCODE = 1403                                       07520000
075300             SET PS-END-OF-RECORDS TO TRUE                        07530000
075400        WHEN OTHER                                                07540000
075500             MOVE '2500-FETCH-CURSOR'                             07550000
075600                                        TO PV-PARAGRAPH-NAME      07560000
075700             MOVE 'FETCH SUGG_ORD_CSR'  TO PV-OPERATION           07570000
075800             PERFORM 9900-SQL-ERROR                               07580000
075900     END-EVALUATE.                                                07590000
076000                                                                  07600000
076100****************************************************************  07610000
076200* THIS PARAGRAPH WILL MOVE THE CURSOR VALUES TO THE DETAIL     *  07620000
076300* LINES, CALL THE PARAGRAPHS TO GET THE QUANTITY AND AMOUNT    *  07630000
076400* DETAIL, MOVE THAT DETAIL AND INCREMENT THE TOTAL BUCKETS.    *  07640000
076500****************************************************************  07650000
076600 2600-PROCESS-DETAIL.                                             07660000
076700                                                                  07670000
076800     IF PV-GMA-NBR = PV-HOLD-GMA                                  07680000
076900        IF PV-DMA-NBR = PV-HOLD-DMA                               07690000
077000           PERFORM 3300-GET-PO-VALUES                             07700000
077100           PERFORM 2700-MOVE-ITEM-DETAIL                          07710000
077200           PERFORM 4000-PRINT-ITEM-DETAIL                         07720000
077300        ELSE                                                      07730000
077400           PERFORM 2800-DMA-BREAK                                 07740000
077500           PERFORM 3300-GET-PO-VALUES                             07750000
077600           PERFORM 2700-MOVE-ITEM-DETAIL                          07760000
077700           PERFORM 4000-PRINT-ITEM-DETAIL                         07770000
077800           MOVE PV-DMA-NBR TO PV-HOLD-DMA                         07780000
077900        END-IF                                                    07790000
078000     ELSE                                                         07800000
078100        PERFORM 2900-GMA-BREAK                                    07810000
078200        PERFORM 3300-GET-PO-VALUES                                07820000
078300        PERFORM 2700-MOVE-ITEM-DETAIL                             07830000
078400        PERFORM 4000-PRINT-ITEM-DETAIL                            07840000
078500        MOVE PV-GMA-NBR TO PV-HOLD-GMA                            07850000
078600        MOVE PV-DMA-NBR TO PV-HOLD-DMA                            07860000
078700     END-IF.                                                      07870000
078800                                                                  07880000
078900****************************************************************  07890000
079000* THIS PARAGRAPH WILL MOVE THE CURSOR VALUES TO THE DETAIL     *  07900000
079100* LINES, CALL THE PARAGRAPHS TO GET THE QUANTITY AND AMOUNT    *  07910000
079200* DETAIL, MOVE THAT DETAIL AND INCREMENT THE TOTAL BUCKETS.    *  07920000
079300****************************************************************  07930000
079400 2700-MOVE-ITEM-DETAIL.                                           07940000
079500                                                                  07950000
079600     MOVE SRC-SYS-KY-TXT IN SGT00005    TO PRT-REF-NBR.           07960000
079700     MOVE XMTVND-PRIM-VND-NM            TO PRT-VENDOR-NAME.       07970000
079800     MOVE MR-SYS-CDE IN SGT00002        TO PRT-SYSID.             07980000
079900     MOVE PV-ORD-RN-DATE                TO PRT-CREATED.           07990000
080000     MOVE PV-SKU-CNT                    TO PRT-LINES.             08000000
080100     MOVE PV-ORD-QTY-CNT                TO PRT-TOTAL-QTY.         08010000
080200     MOVE PV-SUM-COST-AMT               TO PRT-TOTAL-COST.        08020000
080300     MOVE PV-SUM-RTL-AMT                TO PRT-TOTAL-RETAIL.      08030000
080400                                                                  08040000
080500     ADD PV-SKU-CNT                     TO PV-TOT1-ORDER-LINES    08050000
080600                                           PV-TOT2-ORDER-LINES.   08060000
080700     ADD PV-ORD-QTY-CNT                 TO PV-TOT1-TOTORDQTY      08070000
080800                                           PV-TOT2-TOTORDQTY.     08080000
080900     ADD PV-SUM-RTL-AMT                 TO PV-TOT1-TOTRETAIL      08090000
081000                                           PV-TOT2-TOTRETAIL.     08100000
081100     ADD PV-SUM-COST-AMT                TO PV-TOT1-TOTCOST        08110000
081200                                           PV-TOT2-TOTCOST.       08120000
081300                                                                  08130000
081400****************************************************************  08140000
081500* PROCESS A CHANGE IN THE DMM NUMBER.                          *  08150000
081600****************************************************************  08160000
081700 2800-DMA-BREAK.                                                  08170000
081800                                                                  08180000
081900     PERFORM 5000-PRINT-DMM-TOTAL.                                08190000
082000     PERFORM 3000-REPORT-HEADINGS.                                08200000
082100                                                                  08210000
082200****************************************************************  08220000
082300* PROCESS A CHANGE IN THE GMM NUMBER.                          *  08230000
082400****************************************************************  08240000
082500 2900-GMA-BREAK.                                                  08250000
082600                                                                  08260000
082700     PERFORM 5000-PRINT-DMM-TOTAL.                                08270000
082800     PERFORM 5100-PRINT-GMM-TOTAL.                                08280000
082900     PERFORM 3000-REPORT-HEADINGS.                                08290000
083000                                                                  08300000
083100****************************************************************  08310000
083200* 3000-REPORT-HEADINGS -      WRITES THE HEADING LINES FOR THE *  08320000
083300* REPORT WHEN THERE IS A CHANGE IN REFERENCE NUMBERS OR WHEN   *  08330000
083400* THE PAGE IS FULL.                                            *  08340000
083500****************************************************************  08350000
083600 3000-REPORT-HEADINGS.                                            08360000
083700*  GET THE GMM,AND DMM NAMES FROM THE DB2 MERCHANDISE AREA TABLES 08370000
083800     IF PS-GMA-DMA-TOTAL                                          08380000
083900        CONTINUE                                                  08390000
084000     ELSE                                                         08400000
084100        PERFORM 3100-GET-GMA-LAST-NAME                            08410000
084200        PERFORM 3200-GET-DMA-LAST-NAME                            08420000
084300     END-IF.                                                      08430000
084400                                                                  08440000
084500     ADD +1                           TO PV-PAGE-CNT              08450000
084600     MOVE PV-PAGE-CNT                 TO DP132-PAGE-NUMBER        08460000
084700     WRITE PRINT-LINE FROM DP132-STANDRD-HEADER-132-COLS          08470000
084800         AFTER ADVANCING PAGE                                     08480000
084900     WRITE PRINT-LINE FROM HL-HEADING-LINE1                       08490000
085000         AFTER ADVANCING 1                                        08500000
085100     WRITE PRINT-LINE FROM HL-HEADING-LINE2                       08510000
085200         AFTER ADVANCING 2                                        08520000
085300     WRITE PRINT-LINE FROM HL-HEADING-LINE3                       08530000
085400         AFTER ADVANCING 2                                        08540000
085500     WRITE PRINT-LINE FROM HL-HEADING-BLANK                       08550000
085600         AFTER ADVANCING 1                                        08560000
085700     MOVE 4                           TO PV-LINE-CNT.             08570000
085800                                                                  08580000
085900****************************************************************  08590000
086000* GET THE GMA'S LAST NAME.                                     *  08600000
086100****************************************************************  08610000
086200 3100-GET-GMA-LAST-NAME.                                          08620000
086300                                                                  08630000
086400     EXEC SQL                                                     08640000
086500           SELECT B.WORKER_LAST_NAME                              08650000
086600             INTO :PV-GMA-NAME                                    08660000
086700             FROM TMDSEAR A                                       08670000
086800                 ,TRSPBAR B                                       08680000
086900            WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                   08690000
087000              AND A.OPERCO_NBR = :PC-OP-CO-NMBR                   08700000
087100              AND A.GMA_NBR = :PV-GMA-NBR                         08710000
087200              AND A.MDSELV_CDE = :PC-GMA                          08720000
087300              AND B.RSPLVL_CDE = :PC-GMM                          08730000
087400              AND SYSDATE < A.END_DTE                             08740000
087500              AND (SYSDATE BETWEEN B.WORKER_STRT_DTE              08750000
087600                               AND B.WORKER_END_DTE)              08760000
087700     END-EXEC.                                                    08770000
087800                                                                  08780000
087900     EVALUATE TRUE                                                08790000
088000         WHEN SQLCODE = ZERO                                      08800000
088100             MOVE PV-GMA-NBR               TO PRT-GMM             08810000
088200             MOVE PV-GMA-NAME              TO PRT-GMM-NAME        08820000
088300         WHEN SQLCODE = 1403                                      08830000
088400             MOVE SPACES                   TO PRT-GMM             08840000
088500             MOVE SPACES                   TO PRT-GMM-NAME        08850000
088600         WHEN OTHER                                               08860000
088700             MOVE '3100-GET-GMA-LAST-NAME'                        08870000
088800                                        TO PV-PARAGRAPH-NAME      08880000
088900             MOVE 'SELECT GMA NAME '    TO PV-OPERATION           08890000
089000             PERFORM 9900-SQL-ERROR                               08900000
089100     END-EVALUATE.                                                08910000
089200                                                                  08920000
089300****************************************************************  08930000
089400* GET THE DMA'S LAST NAME.                                     *  08940000
089500****************************************************************  08950000
089600 3200-GET-DMA-LAST-NAME.                                          08960000
089700                                                                  08970000
089800     EXEC SQL                                                     08980000
089900           SELECT B.WORKER_LAST_NAME                              08990000
090000             INTO :PV-DMA-NAME                                    09000000
090100             FROM TMDSEAR A                                       09010000
090200                 ,TRSPBAR B                                       09020000
090300            WHERE A.MDSEAR_DKEY = B.MDSEAR_DKEY                   09030000
090400              AND A.OPERCO_NBR = :PC-OP-CO-NMBR                   09040000
090500              AND A.DMA_NBR = :PV-DMA-NBR                         09050000
090600              AND A.MDSELV_CDE = :PC-DMA                          09060000
090700              AND B.RSPLVL_CDE = :PC-DMM                          09070000
090800              AND SYSDATE < A.END_DTE                             09080000
090900              AND (SYSDATE BETWEEN B.WORKER_STRT_DTE              09090000
091000                               AND B.WORKER_END_DTE)              09100000
091100     END-EXEC.                                                    09110000
091200                                                                  09120000
091300     EVALUATE TRUE                                                09130000
091400         WHEN SQLCODE = ZERO                                      09140000
091500             MOVE PV-DMA-NBR               TO PRT-DMM             09150000
091600             MOVE PV-DMA-NAME              TO PRT-DMM-NAME        09160000
091700         WHEN SQLCODE = 1403                                      09170000
091800             MOVE SPACES                   TO PRT-DMM             09180000
091900             MOVE SPACES                   TO PRT-DMM-NAME        09190000
092000         WHEN OTHER                                               09200000
092100             MOVE '3200-GET-DMA-LAST-NAME'                        09210000
092200                                        TO PV-PARAGRAPH-NAME      09220000
092300             MOVE 'SELECT DMA NAME '    TO PV-OPERATION           09230000
092400             PERFORM 9900-SQL-ERROR                               09240000
092500     END-EVALUATE.                                                09250000
092600                                                                  09260000
092700***************************************************************** 09270000
092800* SELECT COUNT OF SKUS ON PURCHASE ORDER, SELECT SUM OF ORDER   * 09280000
092900* QUANITY, SELECT SUM OF UNIT RETAIL AMOUNT AND SELECT SUM OF   * 09290000
093000* UNIT COST AMOUNT.                                             * 09300000
093100***************************************************************** 09310000
093200 3300-GET-PO-VALUES.                                              09320000
093300                                                                  09330000
093400     EXEC SQL                                                     09340000
093500           SELECT COUNT(SKU_NBR)                                  09350000
093600                 ,SUM(ORD_QTY)                                    09360000
093700                 ,SUM(UNT_RTL_AMT * ORD_QTY)                      09370000
093800                 ,SUM(UNT_COST_AMT * ORD_QTY)                     09380000
093900             INTO :PV-SKU-CNT                                     09390000
094000                 ,:PV-ORD-QTY-CNT :PV-SUM-ORD-NULL                09400000
094100                 ,:PV-SUM-RTL-AMT :PV-SUM-RTL-NULL                09410000
094200                 ,:PV-SUM-COST-AMT :PV-SUM-COST-NULL              09420000
094300             FROM SGT_STG_PO_SKU                                  09430000
094400            WHERE STG_PO_ID = :SGT00005.STG-PO-ID                 09440000
094500     END-EXEC.                                                    09450000
094600                                                                  09460000
094700     EVALUATE TRUE                                                09470000
094800         WHEN SQLCODE = ZERO                                      09480000
094900             IF PV-SUM-ORD-NULL = -1                              09490000
095000                MOVE ZERO TO PV-ORD-QTY-CNT                       09500000
095100             END-IF                                               09510000
095200             IF PV-SUM-RTL-NULL = -1                              09520000
095300                MOVE ZERO TO PV-SUM-RTL-AMT                       09530000
095400             END-IF                                               09540000
095500             IF PV-SUM-COST-NULL = -1                             09550000
095600                MOVE ZERO TO PV-SUM-COST-AMT                      09560000
095700             END-IF                                               09570000
095800         WHEN SQLCODE = 1403                                      09580000
095900                MOVE ZERO TO PV-SKU-CNT                           09590000
096000                MOVE ZERO TO PV-ORD-QTY-CNT                       09600000
096100                MOVE ZERO TO PV-SUM-RTL-AMT                       09610000
096200                MOVE ZERO TO PV-SUM-COST-AMT                      09620000
096300         WHEN OTHER                                               09630000
096400             MOVE '3300-GET-PO-VALUES'                            09640000
096500                                        TO PV-PARAGRAPH-NAME      09650000
096600             MOVE 'SELECT PO VALUES'    TO PV-OPERATION           09660000
096700             PERFORM 9900-SQL-ERROR                               09670000
096800     END-EVALUATE.                                                09680000
096900                                                                  09690000
097000***************************************************************** 09700000
097100* WRITE OUT THE DETAIL RECORD                                   * 09710000
097200***************************************************************** 09720000
097300 4000-PRINT-ITEM-DETAIL.                                          09730000
097400                                                                  09740000
097500     IF PV-LINE-CNT > PC-MAX-LINES                                09750000
097600         PERFORM 3000-REPORT-HEADINGS                             09760000
097700     END-IF.                                                      09770000
097800                                                                  09780000
097900     WRITE PRINT-LINE FROM DETAIL-LINE                            09790000
098000        AFTER ADVANCING 1                                         09800000
098100     ADD 1 TO PV-LINE-CNT.                                        09810000
098200     ADD 1 TO PV-DETAIL-LINE-CNT.                                 09820000
098300                                                                  09830000
098400***************************************************************** 09840000
098500* PRINT OUT THE DMM TOTAL LINE.                                 * 09850000
098600***************************************************************** 09860000
098700 5000-PRINT-DMM-TOTAL.                                            09870000
098800                                                                  09880000
098900     SET PS-GMA-DMA-TOTAL TO TRUE.                                09890000
099000                                                                  09900000
099100     MOVE  PV-TOT1-ORDER-LINES   TO TOT1-ORDER-LINES.             09910000
099200     MOVE  PV-TOT1-TOTORDQTY     TO TOT1-TOTORD-QTY.              09920000
099300     MOVE  PV-TOT1-TOTCOST       TO TOT1-TOTCOST.                 09930000
099400     MOVE  PV-TOT1-TOTRETAIL     TO TOT1-TOTRETAIL.               09940000
099500                                                                  09950000
099600     IF PV-LINE-CNT > PC-MAX-LINES                                09960000
099700         PERFORM 3000-REPORT-HEADINGS                             09970000
099800     END-IF.                                                      09980000
099900                                                                  09990000
100000     WRITE PRINT-LINE FROM HL-TOTAL-LINE1                         10000000
100100          AFTER ADVANCING 2                                       10010000
100200     WRITE PRINT-LINE FROM HL-HEADING-BLANK                       10020000
100300          AFTER ADVANCING 1                                       10030000
100400     ADD 3                            TO PV-LINE-CNT.             10040000
100500                                                                  10050000
100600     MOVE  ZEROS                 TO PV-TOT1-ORDER-LINES.          10060000
100700     MOVE  ZEROS                 TO PV-TOT1-TOTORDQTY.            10070000
100800     MOVE  ZEROS                 TO PV-TOT1-TOTCOST.              10080000
100900     MOVE  ZEROS                 TO PV-TOT1-TOTRETAIL.            10090000
101000                                                                  10100000
101100     SET PS-NOT-GMA-DMA-TOTAL TO TRUE.                            10110000
101200                                                                  10120000
101300***************************************************************** 10130000
101400* PRINT OUT THE GMM TOTAL LINE.                                 * 10140000
101500***************************************************************** 10150000
101600 5100-PRINT-GMM-TOTAL.                                            10160000
101700                                                                  10170000
101800     SET PS-GMA-DMA-TOTAL TO TRUE.                                10180000
101900*                                                                 10190000
102000     MOVE  PV-TOT2-ORDER-LINES   TO TOT2-ORDER-LINES.             10200000
102100     MOVE  PV-TOT2-TOTORDQTY     TO TOT2-TOTORD-QTY.              10210000
102200     MOVE  PV-TOT2-TOTCOST       TO TOT2-TOTCOST.                 10220000
102300     MOVE  PV-TOT2-TOTRETAIL     TO TOT2-TOTRETAIL.               10230000
102400                                                                  10240000
102500                                                                  10250000
102600     IF PV-LINE-CNT > PC-MAX-LINES                                10260000
102700         PERFORM 3000-REPORT-HEADINGS                             10270000
102800     END-IF.                                                      10280000
102900                                                                  10290000
103000     WRITE PRINT-LINE FROM HL-TOTAL-LINE2                         10300000
103100          AFTER ADVANCING 2                                       10310000
103200     ADD 2                            TO PV-LINE-CNT.             10320000
103300                                                                  10330000
103400     MOVE  ZEROS                 TO PV-TOT2-ORDER-LINES.          10340000
103500     MOVE  ZEROS                 TO PV-TOT2-TOTORDQTY.            10350000
103600     MOVE  ZEROS                 TO PV-TOT2-TOTCOST.              10360000
103700     MOVE  ZEROS                 TO PV-TOT2-TOTRETAIL.            10370000
103800                                                                  10380000
103900     SET PS-NOT-GMA-DMA-TOTAL TO TRUE.                            10390000
104000                                                                  10400000
104100****************************************************************  10410001
104200* CONNECT TO ORACLE.                                              10420001
104300****************************************************************  10430001
104400 9000-ORACLE-SETUP.                                               10440001
104500                                                                  10450001
104600     OPEN INPUT ORACLE-LOGON-FILE.                                10460001
104700                                                                  10470001
104800     PERFORM 9100-READ-ORACLE-LOGON.                              10480001
104900                                                                  10490001
105000     CLOSE ORACLE-LOGON-FILE.                                     10500001
105100                                                                  10510001
105200     IF ((PS-END-OF-LOGON-FILE)                                   10520001
105300             OR (CC-ORACLE-CONNECTION = SPACES))                  10530001
105400         DISPLAY '** ABEND **'                                    10540001
105500         DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  10550001
105600                   'NOT PROVIDED'                                 10560001
105700         SET PS-ORA-SRC-EMPTY TO TRUE                             10570001
105800         CALL 'ILBOABN0' USING ABEND-CODE                         10580001
105900     END-IF.                                                      10590001
106000                                                                  10600001
106100     IF CC-AUTO-LOGON                                             10610001
106200         DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        10620001
106300         EXEC SQL                                                 10630001
106400              CONNECT :USERNAME                                   10640001
106500         END-EXEC                                                 10650001
106600     ELSE                                                         10660001
106700         INITIALIZE PV-ORACLE-USERID-LEN                          10670001
106800                    PV-ORACLE-PASSWORD-LEN                        10680001
106900         INSPECT CC-ORACLE-USERID                                 10690001
107000             TALLYING PV-ORACLE-USERID-LEN                        10700001
107100          FOR CHARACTERS BEFORE INITIAL SPACE                     10710001
107200      INSPECT CC-ORACLE-PASSWORD                                  10720001
107300          TALLYING PV-ORACLE-PASSWORD-LEN                         10730001
107400          FOR CHARACTERS BEFORE INITIAL SPACE                     10740001
107500      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           10750001
107600                USERNAME-ARR                                      10760001
107700      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   10770001
107800      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       10780001
107900                PASSWD-ARR                                        10790001
108000      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   10800001
108100      DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '       10810001
108200                USERNAME-ARR                                      10820001
108300      EXEC SQL                                                    10830001
108400        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   10840001
108500      END-EXEC                                                    10850001
108600      INITIALIZE CC-ORACLE-PASSWORD                               10860001
108700                 PASSWD                                           10870001
108800      END-IF.                                                     10880001
108900                                                                  10890001
109000     IF (SQLCODE NOT = 0)                                         10900001
109100         MOVE '9000-ORACLE-SETUP' TO PV-PARAGRAPH-NAME            10910001
109200         MOVE 'CONNECT TO ORACLE' TO PV-OPERATION                 10920001
109300         DISPLAY PV-PARAGRAPH-NAME                                10930001
109400         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  10940001
109500         PERFORM 9900-SQL-ERROR                                   10950001
109510     END-IF.                                                      10951001
109520                                                                  10952001
109530     EXEC SQL                                                     10953001
109540      ALTER SESSION                                               10954001
109550          SET NLS_DATE_FORMAT = 'YYYY-MM-DD-HH24.MI.SS'           10955001
109560     END-EXEC.                                                    10956001
109570                                                                  10957001
109580***************************************************************** 10958001
109590*  B120-READ-ORACLE-LOGON.                                      * 10959001
109591* ==> PROCESSES:                                                * 10959101
109592*   - READ ORCALE CONTROL CARD                                  * 10959201
109593* ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 10959301
109594***************************************************************** 10959401
109595 9100-READ-ORACLE-LOGON.                                          10959501
109596                                                                  10959601
109597     READ ORACLE-LOGON-FILE                                       10959701
109598         INTO CC-ORACLE-CONNECTION                                10959801
109599         AT END                                                   10959901
109600             SET PS-END-OF-LOGON-FILE TO TRUE                     10960001
109601     END-READ.                                                    10960101
109602                                                                  10960201
109610******************************************************************10961000
109700*    ABEND ON A SQL ERROR.                                        10970000
109800******************************************************************10980000
109900 9900-SQL-ERROR.                                                  10990000
110000                                                                  11000000
110100     DISPLAY '*** ABEND ***'.                                     11010000
110200     DISPLAY '** MRKRP140 - SQL ERROR'.                           11020000
110300     DISPLAY '** PROGRAM          ** = ' PC-PROGRAM-NAME.         11030000
110400     DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.       11040000
110500     DISPLAY '** OPERATION        ** = ' PV-OPERATION.            11050000
110600                                                                  11060000
110700*    THE FOLLOWING COPYBOOK UTILIZES MODULE DSNTIAR TO FORMAT     11070000
110800*    THE INFO IN SQLCA INTO UNDERSTANDABLE VERBAGE.               11080000
110900     COPY DPPD004.                                                11090000
111000                                                                  11100000
111100     MOVE +4013 TO ABEND-CODE.                                    11110000
111200     CALL 'ILBOABN0' USING ABEND-CODE.                            11120000
111300                                                                  11130000
111400 EJECT                                                            11140000
