000100 IDENTIFICATION DIVISION.                                         00010001
000200 TITLE 'MANIFESTING - CONVEYOR CUTOFF CRITERIA SCREEN'.           00020001
000300                                                                  00030001
000400 PROGRAM-ID.             PCKRF873.                                00040001
000500 AUTHOR.                 DENNIS STEFFEN.                          00050001
000600 INSTALLATION.           KOHLS.                                   00060001
000700 DATE-WRITTEN.           APRIL 2001.                              00070001
000800 DATE-COMPILED.                                                   00080001
000900 ENVIRONMENT DIVISION.                                            00090001
001000 DATA DIVISION.                                                   00100001
001100                                                                  00110001
001200 WORKING-STORAGE SECTION.                                         00120001
001300                                                                  00130001
001400 01  PC-PROGRAM-CONSTANTS.                                        00140001
001500     05  PC-TRANID                    PIC X(04) VALUE 'E873'.     00150001
001600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF873'. 00160001
001700     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00170001
001800            '9999-09-09-09.09.09.999999'.                         00180001
001900     05  PC-MUST-BE-NUM-MSG           PIC X(19) VALUE             00190001
002000                                           'MUST BE NUMERIC    '. 00200001
002100                                                                  00210001
002200                                                                  00220001
002300* ERROR MESSAGES                                                 *00230001
002400     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00240001
002500                                           'UNRECOGNIZED PF KEY'. 00250001
002600     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00260001
002700                                           'ENTER THROUGH MENU '. 00270001
002800     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00280001
002900                                           'TRANS NOT AVAILABLE'. 00290001
003000     05  PC-WRONG-FACILITY            PIC X(19) VALUE             00300001
003100                                           'WRG FCLTY - F2 CONF'. 00310001
003200                                                                  00320001
003300 01  PS-PROGRAM-SWITCHES.                                         00330001
003400     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00340001
003500         88  PS-ERRORS-YES                        VALUE 'Y'.      00350001
003600         88  PS-ERRORS-NO                         VALUE 'N'.      00360001
003700     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'N'.      00370001
003800         88  PS-VALID-INPUT                       VALUE 'Y'.      00380001
003900         88  PS-INVALID-INPUT                     VALUE 'N'.      00390001
004000     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00400001
004100         88  PS-XCTL-E871                       VALUE 'E871'.     00410001
004200     05  PS-TCNTRID-SW                PIC X(01) VALUE 'N'.        00420001
004300         88  PS-TSUOBTS-YES                       VALUE 'Y'.      00430001
004400         88  PS-TSUOBTS-NO                        VALUE 'N'.      00440001
004500                                                                  00450001
004600 01  PV-PROGRAM-VARIABLES.                                        00460001
004700     05  PV-NEXT-IND                  PIC X(01) VALUE SPACES.     00470001
004800     05  PV-LAST-IND                  PIC X(01) VALUE SPACES.     00480001
004900     05  PV-DB2-COUNT                 PIC S9(03) COMP-3.          00490001
005000     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00500001
005100                                                     COMP SYNC.   00510001
005200     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00520001
005300     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00530001
005400                                                     COMP SYNC.   00540001
005500     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    00550001
005600                                                                  00560001
005700     05  PV-SUB                       PIC S9(4) COMP              00570001
005800                                                VALUE ZERO.       00580001
005900     05  PV-COUNT                     PIC S9(4) COMP              00590001
006000                                                VALUE ZERO.       00600001
006100     05  PV-TMST                      PIC  X(26)  VALUE SPACE.    00610001
006200                                                                  00620001
006300 01  PV-LOG-MSG.                                                  00630001
006400     05  FILLER                       PIC X(12) VALUE             00640001
006500         ' E873 ERROR '.                                          00650001
006600     05  FILLER                       PIC X(06) VALUE             00660001
006700         'USER= '.                                                00670001
006800     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     00680001
006900     05  FILLER                       PIC X(10) VALUE             00690001
007000         ' SQLCODE= '.                                            00700001
007100     05  PV-SQLCODE                   PIC -9(03).                 00710001
007200     05  FILLER                       PIC X(06) VALUE             00720001
007300         ' ERR= '.                                                00730001
007400     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       00740001
007500     05  FILLER                       PIC X(07) VALUE             00750001
007600         ' DOOR= '.                                               00760001
007700     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     00770001
007800/                                                                 00780001
007900 01  PV-EDITING-FIELDS.                                           00790001
008000     05  PV-SCREEN-DOOR               PIC X(04).                  00800001
008100     05  PV-SCREEN-DEST               PIC X(04).                  00810001
008200     05  PV-SCREEN-SERIAL-NBR         PIC X(09).                  00820001
008300                                                                  00830001
008400/                                                                 00840001
008500 01  CA-COMMAREA.                                                 00850001
008600     COPY PCWS233.                                                00860001
008700     05  CA-PRIVATE-COMMAREA          PIC X(100).                 00870001
008800     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     00880001
008900         10  CA-CURR-SEAL             PIC X(20).                  00890001
009000/                                                                 00900001
009100*  MAP LAYOUT                                                     00910001
009200     COPY PCKM873.                                                00920001
009300                                                                  00930001
009400* HELP SCREEN COMMAREA                                            00940001
009500     COPY PCWS192.                                                00950001
009600* HELP SCREEN WORK AREA                                           00960001
009700     COPY PCWS188.                                                00970001
009800/                                                                 00980001
009900     COPY DPWS010I.                                               00990001
010000*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01000001
010100     COPY DPWS015.                                                01010001
010200                                                                  01020001
010300*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01030001
010400     COPY DFHAID.                                                 01040001
010500                                                                  01050001
010600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01060001
010700     COPY DPWS013.                                                01070001
010800                                                                  01080001
010900/                                                                 01090001
011000                                                                  01100001
011100     EXEC SQL                                                     01110001
011200         INCLUDE SQLCA                                            01120001
011300     END-EXEC.                                                    01130001
011400                                                                  01140001
011500 LINKAGE SECTION.                                                 01150001
011600 01  DFHCOMMAREA.                                                 01160001
011700     05  FILLER                         OCCURS  1 TO 4072 TIMES   01170001
011800                                      DEPENDING ON EIBCALEN.      01180001
011900         10  FILLER                   PIC X.                      01190001
012000/                                                                 01200001
012100 PROCEDURE DIVISION.                                              01210001
012200 0000-PROGRAM-MAINLINE.                                           01220001
012300                                                                  01230001
012400     INITIALIZE CA-COMMAREA                                       01240001
012500     MOVE DFHCOMMAREA                 TO CA-COMMAREA              01250001
012600                                                                  01260001
012700     EVALUATE TRUE                                                01270001
012800         WHEN EIBCALEN = ZERO                                     01280001
012900             MOVE PC-ENTER-THROUGH-MENU-MSG                       01290001
013000                                      TO PV-MESSAGE-AREA          01300001
013100             PERFORM 8110-RETURN                                  01310001
013200                                                                  01320001
013300         WHEN EIBTRNID = 'Z278'                                   01330001
013400*            RETURNING FROM F1 HELP INFO SCREEN                   01340001
013500             MOVE DFHCOMMAREA         TO PC192-COMMAREA           01350001
013600             MOVE PC192-HOST-SAVE-AREA                            01360001
013700                                      TO CA-COMMAREA              01370001
013800             SET PC233-PROCESS-SCREEN TO TRUE                     01380001
013900             MOVE PC192-HOST-SAVE-MAP TO PC873AO                  01390001
014000             MOVE -1                  TO ANEXTL                   01400001
014100             PERFORM 8000-SEND-MAP                                01410001
014200             PERFORM 8100-RETURN-TRANID                           01420001
014300                                                                  01430001
014400         WHEN PC233-INITIALIZE-SCREEN                             01440001
014500         WHEN EIBAID = DFHCLEAR                                   01450001
014600             SET PC233-PROCESS-SCREEN TO TRUE                     01460001
014700             PERFORM 1000-INITIALIZE                              01470001
014800             PERFORM 8000-SEND-MAP                                01480001
014900             PERFORM 8100-RETURN-TRANID                           01490001
015000*                                                                 01500001
015100         WHEN EIBAID = DFHPF3                                     01510001
015200             MOVE PC233-ROOT-PROGRAM  TO PV-TRANSFER-PROGRAM      01520001
015300             PERFORM 8200-XCTL                                    01530001
015301                                                                  01530102
015310         WHEN EIBAID = DFHPF8                                     01531002
015320             MOVE 'PCKRF880'          TO PV-TRANSFER-PROGRAM      01532002
015330             PERFORM 8200-XCTL                                    01533002
015400*                                                                 01540001
015500         WHEN EIBAID = DFHPF9                                     01550001
015600             MOVE 'PCKRF743'          TO PV-TRANSFER-PROGRAM      01560001
015700             PERFORM 8200-XCTL                                    01570001
015800                                                                  01580001
015900         WHEN EIBAID = DFHENTER                                   01590001
016000             PERFORM 8020-RECEIVE-MAP                             01600001
016100             PERFORM 2100-EDIT-INPUT                              01610001
016200                                                                  01620001
016300             IF PS-VALID-INPUT                                    01630001
016400                                                                  01640001
016500                 SET PS-ERRORS-NO TO TRUE                         01650001
016600                                                                  01660001
016700                 PERFORM 2000-PROCESS                             01670001
016800                 IF PS-ERRORS-NO                                  01680001
016900                     MOVE 'PCKRF874'  TO PV-TRANSFER-PROGRAM      01690001
017000                     PERFORM 8200-XCTL                            01700001
017100                 ELSE                                             01710001
017200                     PERFORM 8010-SEND-DATA-ONLY                  01720001
017300                     PERFORM 8100-RETURN-TRANID                   01730001
017400                 END-IF                                           01740001
017500                                                                  01750001
017600             ELSE                                                 01760001
017700                                                                  01770001
017800                 PERFORM 8010-SEND-DATA-ONLY                      01780001
017900                 PERFORM 8100-RETURN-TRANID                       01790001
018000             END-IF                                               01800001
018100                                                                  01810001
018200         WHEN EIBAID = DFHPF1                                     01820001
018300             PERFORM 8020-RECEIVE-MAP                             01830001
018400             MOVE PC873AO             TO PC192-HOST-SAVE-MAP      01840001
018500             PERFORM 1200-HELP-SCREEN                             01850001
018600                                                                  01860001
018700         WHEN OTHER                                               01870001
018800             PERFORM 8020-RECEIVE-MAP                             01880001
018900             MOVE -1                  TO ANEXTL                   01890001
019000             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      01900001
019100                                      TO AMSGLNO                  01910001
019200             PERFORM 8000-SEND-MAP                                01920001
019300             PERFORM 8100-RETURN-TRANID                           01930001
019400     END-EVALUATE.                                                01940001
019500                                                                  01950001
019600     GOBACK.                                                      01960001
019700                                                                  01970001
019800 1000-INITIALIZE.                                                 01980001
019900                                                                  01990001
020000     EXEC SQL SET :PV-TMST = CURRENT TIMESTAMP END-EXEC           02000001
020100                                                                  02010001
020200     MOVE PC233-DOOR-ID               TO ADOORO                   02020001
020300     MOVE PC233-SERIAL-NBR            TO ASERIALO                 02030001
020400     MOVE PC233-STR-NBR               TO ADESTO                   02040001
020500     MOVE PC233-OWNER-SCAC-ID         TO ASCACO                   02050001
020600     MOVE PC233-TRAILER               TO ATRLRO                   02060001
020700     MOVE -1                          TO ANEXTL                   02070001
020800                                                                  02080001
020900     MOVE 'ENTER TO CONTINUE '        TO AMSGLNO                  02090001
021000                                                                  02100001
021100     INITIALIZE CA-REDEFINED-COMMAREA                             02110001
021200     MOVE PC-TRANID                   TO PC233-TRAN-ID            02120001
021300                                                                  02130001
021400     MOVE PC233-USER-ID               TO PV-USER-ID.              02140001
021500                                                                  02150001
021600 1200-HELP-SCREEN.                                                02160001
021700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      02170001
021800     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       02180001
021900     COPY PCPD188.                                                02190001
022000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      02200001
022100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     02210001
022200     PERFORM 8220-XCTL-TO-HELP.                                   02220001
022300                                                                  02230001
022400/                                                                 02240001
022500 2000-PROCESS.                                                    02250001
022600     IF PV-NEXT-IND = 'S'                                         02260001
022700         SET PC233-FIRST-CTN-ON-NEXT-TRLR                         02270001
022800                                      TO TRUE                     02280001
022900     ELSE                                                         02290001
023000         SET PC233-LAST-CTN-ON-THIS-TRLR                          02300001
023100                                      TO TRUE                     02310001
023200     END-IF.                                                      02320001
023300                                                                  02330001
023400/                                                                 02340001
023500 2100-EDIT-INPUT.                                                 02350001
023600                                                                  02360001
023700     SET PS-ERRORS-NO                                             02370001
023800         PS-VALID-INPUT               TO TRUE                     02380001
023900     MOVE SPACES                      TO AMSGLNO                  02390001
024000                                                                  02400001
024100     IF  ALASTL > ZERO                                            02410001
024200         MOVE ALASTI TO PV-LAST-IND                               02420001
024300     ELSE                                                         02430001
024400         IF ALASTA = DP015-ERASE-EOF                              02440001
024500             MOVE SPACES TO PV-LAST-IND                           02450001
024600         END-IF                                                   02460001
024700     END-IF.                                                      02470001
024800                                                                  02480001
024900     IF  ANEXTL > ZERO                                            02490001
025000         MOVE ANEXTI TO PV-NEXT-IND                               02500001
025100     ELSE                                                         02510001
025200         IF ANEXTA = DP015-ERASE-EOF                              02520001
025300             MOVE SPACES TO PV-NEXT-IND                           02530001
025400         END-IF                                                   02540001
025500     END-IF.                                                      02550001
025600                                                                  02560001
025700     EVALUATE TRUE                                                02570001
025800     WHEN PV-LAST-IND = SPACES AND PV-NEXT-IND = SPACES           02580001
025900     WHEN PV-LAST-IND = 'S'    AND PV-NEXT-IND = 'S'              02590001
026000         MOVE ' PLEASE CHOOSE ONE '                               02600001
026100                                      TO AMSGLNO                  02610001
026200         SET PS-INVALID-INPUT         TO TRUE                     02620001
026300         MOVE -1                      TO ANEXTL                   02630001
026400     WHEN PV-LAST-IND > SPACES                                    02640001
026500         IF PV-LAST-IND NOT = 'S'                                 02650001
026600             MOVE ' USE "S" TO SELECT '                           02660001
026700                                      TO AMSGLNO                  02670001
026800             SET PS-INVALID-INPUT     TO TRUE                     02680001
026900             MOVE -1                  TO ALASTL                   02690001
027000         END-IF                                                   02700001
027100     WHEN OTHER                                                   02710001
027200         IF PV-NEXT-IND NOT = 'S'                                 02720001
027300             MOVE ' USE "S" TO SELECT '                           02730001
027400                                      TO AMSGLNO                  02740001
027500             SET PS-INVALID-INPUT     TO TRUE                     02750001
027600             MOVE -1                  TO ANEXTL                   02760001
027700         END-IF                                                   02770001
027800     END-EVALUATE.                                                02780001
027900/                                                                 02790001
028000 8000-SEND-MAP.                                                   02800001
028100                                                                  02810001
028200     EXEC CICS                                                    02820001
028300         SEND MAP       ('PC873A')                                02830001
028400              MAPSET    ('PCKM873')                               02840001
028500              ERASE                                               02850001
028600              CURSOR                                              02860001
028700              RESP      (PV-CICS-RESPONSE)                        02870001
028800     END-EXEC.                                                    02880001
028900                                                                  02890001
029000     EVALUATE TRUE                                                02900001
029100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02910001
029200             CONTINUE                                             02920001
029300         WHEN OTHER                                               02930001
029400             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          02940001
029500             MOVE 'PCKRF873 - UNABLE TO SEND MAP'                 02950001
029600                                      TO DP013-MESSAGE-TEXT (1)   02960001
029700             SET DP013-CICS-ABEND                                 02970001
029800                 DP013-ROLLBACK       TO TRUE                     02980001
029900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               02990001
030000     END-EVALUATE.                                                03000001
030100                                                                  03010001
030200 8010-SEND-DATA-ONLY.                                             03020001
030300                                                                  03030001
030400     EXEC CICS                                                    03040001
030500         SEND MAP       ('PC873A')                                03050001
030600              MAPSET    ('PCKM873')                               03060001
030700              CURSOR                                              03070001
030800              DATAONLY                                            03080001
030900              RESP      (PV-CICS-RESPONSE)                        03090001
031000     END-EXEC.                                                    03100001
031100                                                                  03110001
031200     EVALUATE TRUE                                                03120001
031300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03130001
031400             CONTINUE                                             03140001
031500         WHEN OTHER                                               03150001
031600             MOVE '8010-SEND-DATA-ONLY'                           03160001
031700                                      TO DP013-PARAGRAPH          03170001
031800             MOVE 'PCKRF873 - UNABLE TO SEND DATA'                03180001
031900                                      TO DP013-MESSAGE-TEXT (1)   03190001
032000             SET DP013-CICS-ABEND                                 03200001
032100                 DP013-ROLLBACK       TO TRUE                     03210001
032200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               03220001
032300     END-EVALUATE.                                                03230001
032400                                                                  03240001
032500 8020-RECEIVE-MAP.                                                03250001
032600                                                                  03260001
032700     EXEC CICS                                                    03270001
032800         RECEIVE MAP    ('PC873A')                                03280001
032900                 MAPSET ('PCKM873')                               03290001
033000                 RESP   (PV-CICS-RESPONSE)                        03300001
033100     END-EXEC.                                                    03310001
033200                                                                  03320001
033300     EVALUATE TRUE                                                03330001
033400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03340001
033500             CONTINUE                                             03350001
033600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                03360001
033700             CONTINUE                                             03370001
033800         WHEN OTHER                                               03380001
033900            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          03390001
034000            MOVE 'PCKRF873 - UNABLE TO RECEIVE MAP'               03400001
034100                                      TO DP013-MESSAGE-TEXT (1)   03410001
034200            SET DP013-LOGIC-ABEND     TO TRUE                     03420001
034300            SET DP013-ROLLBACK        TO TRUE                     03430001
034400            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                03440001
034500     END-EVALUATE.                                                03450001
034600                                                                  03460001
034700 8100-RETURN-TRANID.                                              03470001
034800                                                                  03480001
034900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       03490001
035000     EXEC CICS                                                    03500001
035100         RETURN TRANSID  (PC-TRANID)                              03510001
035200                COMMAREA (CA-COMMAREA)                            03520001
035300                LENGTH   (PV-COMMAREA-LENGTH)                     03530001
035400                RESP     (PV-CICS-RESPONSE)                       03540001
035500     END-EXEC.                                                    03550001
035600                                                                  03560001
035700     EVALUATE TRUE                                                03570001
035800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03580001
035900             CONTINUE                                             03590001
036000         WHEN OTHER                                               03600001
036100             MOVE '8100-RETURN-TRANIND'                           03610001
036200                                      TO DP013-PARAGRAPH          03620001
036300             MOVE 'PCKRF873 - UNABLE TO RETURN TO TRANID'         03630001
036400                 TO DP013-MESSAGE-TEXT (1)                        03640001
036500             SET DP013-CICS-ABEND     TO TRUE                     03650001
036600             SET DP013-ROLLBACK       TO TRUE                     03660001
036700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               03670001
036800     END-EVALUATE.                                                03680001
036900                                                                  03690001
037000 8110-RETURN.                                                     03700001
037100                                                                  03710001
037200     EXEC CICS                                                    03720001
037300         SEND FROM (PV-MESSAGE-AREA)                              03730001
037400              LENGTH (19)                                         03740001
037500              ERASE                                               03750001
037600     END-EXEC.                                                    03760001
037700                                                                  03770001
037800     EXEC CICS                                                    03780001
037900         RETURN                                                   03790001
038000     END-EXEC.                                                    03800001
038100                                                                  03810001
038200 8200-XCTL.                                                       03820001
038300     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    03830001
038400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      03840001
038500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       03850001
038600                                                                  03860001
038700     EXEC CICS                                                    03870001
038800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    03880001
038900               COMMAREA  (CA-COMMAREA)                            03890001
039000               LENGTH    (PV-COMMAREA-LENGTH)                     03900001
039100               RESP      (PV-CICS-RESPONSE)                       03910001
039200     END-EXEC.                                                    03920001
039300                                                                  03930001
039400     EVALUATE TRUE                                                03940001
039500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03950001
039600             CONTINUE                                             03960001
039700         WHEN OTHER                                               03970001
039800             MOVE '8200-XCTL'                                     03980001
039900                                      TO DP013-PARAGRAPH          03990001
040000             MOVE 'PCKRF873 - UNABLE TO XCTL TO PROGRAM: '        04000001
040100                                      TO DP013-MESSAGE-TEXT (1)   04010001
040200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   04020001
040300             SET DP013-CICS-ABEND                                 04030001
040400                 DP013-ROLLBACK       TO TRUE                     04040001
040500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04050001
040600             MOVE PC-TRANS-UNAVAILABLE-MSG                        04060001
040700                                      TO AMSGLNO                  04070001
040800             SET PC233-PROCESS-SCREEN TO TRUE                     04080001
040900             MOVE -1                  TO ANEXTL                   04090001
041000             PERFORM 8000-SEND-MAP                                04100001
041100             PERFORM 8100-RETURN-TRANID                           04110001
041200     END-EVALUATE.                                                04120001
041300                                                                  04130001
041400 8210-XCTL-ERROR-SCREEN.                                          04140001
041500     IF NOT PC233-ABEND                                           04150001
041600         SET PC233-INITIALIZE-SCREEN  TO TRUE                     04160001
041700     END-IF                                                       04170001
041800     IF PC233-PGM-MSG-NBR = ZERO                                  04180001
041900         MOVE 2                       TO PC233-PGM-MSG-NBR        04190001
042000     END-IF                                                       04200001
042100                                                                  04210001
042200     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          04220001
042300     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      04230001
042400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       04240001
042500     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      04250001
042600                                                                  04260001
042700     EXEC CICS                                                    04270001
042800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    04280001
042900               COMMAREA  (CA-COMMAREA)                            04290001
043000               LENGTH    (PV-COMMAREA-LENGTH)                     04300001
043100               RESP      (PV-CICS-RESPONSE)                       04310001
043200     END-EXEC.                                                    04320001
043300                                                                  04330001
043400     EVALUATE TRUE                                                04340001
043500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04350001
043600             CONTINUE                                             04360001
043700         WHEN OTHER                                               04370001
043800             MOVE '8200-XCTL'                                     04380001
043900                                      TO DP013-PARAGRAPH          04390001
044000             MOVE 'PCKRF873 - UNABLE TO XCTL TO PROGRAM: '        04400001
044100                                      TO DP013-MESSAGE-TEXT (1)   04410001
044200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   04420001
044300             SET DP013-CICS-ABEND                                 04430001
044400                 DP013-ROLLBACK       TO TRUE                     04440001
044500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04450001
044600             MOVE PC-TRANS-UNAVAILABLE-MSG                        04460001
044700                                      TO AMSGLNO                  04470001
044800             SET PC233-PROCESS-SCREEN TO TRUE                     04480001
044900             MOVE -1                  TO ANEXTL                   04490001
045000             PERFORM 8000-SEND-MAP                                04500001
045100             PERFORM 8100-RETURN-TRANID                           04510001
045200     END-EVALUATE.                                                04520001
045300                                                                  04530001
045400*                                                                 04540001
045500 8220-XCTL-TO-HELP.                                               04550001
045600                                                                  04560001
045700     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       04570001
045800                                                                  04580001
045900     EXEC CICS                                                    04590001
046000         XCTL                                                     04600001
046100             PROGRAM   (PV-TRANSFER-PROGRAM)                      04610001
046200             COMMAREA  (PC192-COMMAREA)                           04620001
046300             LENGTH    (PV-COMMAREA-LENGTH)                       04630001
046400             RESP      (PV-CICS-RESPONSE)                         04640001
046500     END-EXEC.                                                    04650001
046600                                                                  04660001
046700     EVALUATE TRUE                                                04670001
046800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04680001
046900              CONTINUE                                            04690001
047000         WHEN OTHER                                               04700001
047100             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          04710001
047200             MOVE 'PCKRF873 - UNABLE TO XCTL TO PROGRAM: '        04720001
047300                                      TO DP013-MESSAGE-TEXT (1)   04730001
047400             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   04740001
047500             SET DP013-CICS-ABEND                                 04750001
047600                 DP013-ROLLBACK       TO TRUE                     04760001
047700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               04770001
047800             MOVE PC-TRANS-UNAVAILABLE-MSG                        04780001
047900                                      TO AMSGLNO                  04790001
048000             SET PC233-PROCESS-SCREEN TO TRUE                     04800001
048100             MOVE -1                  TO ANEXTL                   04810001
048200             PERFORM 8000-SEND-MAP                                04820001
048300             PERFORM 8100-RETURN-TRANID                           04830001
048400     END-EVALUATE.                                                04840001
048500/                                                                 04850001
048600 9000-SOFT-ABORT.                                                 04860001
048700                                                                  04870001
048800     EXEC CICS                                                    04880001
048900         SYNCPOINT ROLLBACK                                       04890001
049000     END-EXEC                                                     04900001
049100                                                                  04910001
049200     MOVE 1                           TO PC233-PGM-MSG-NBR        04920001
049300     MOVE SQLCODE                     TO PC233-SQLCODE            04930001
049400     PERFORM 8210-XCTL-ERROR-SCREEN.                              04940001
049500                                                                  04950001
049600                                                                  04960001
049700 9903-WRITE-CICS-LOG.                                             04970001
049800                                                                  04980001
049900     MOVE SQLCODE                     TO PV-SQLCODE               04990001
050000                                                                  05000001
050100     EXEC CICS                                                    05010001
050200         WRITEQ TD                                                05020001
050300             QUEUE  ('CSSL')                                      05030001
050400             FROM   (PV-LOG-MSG)                                  05040001
050500             RESP   (PV-CICS-RESPONSE)                            05050001
050600     END-EXEC.                                                    05060001
050700                                                                  05070001
050800 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  05080001
050900                                                                  05090001
051000     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           05100001
051100     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          05110001
051200     INITIALIZE DP013-SRC-TASK-NUMBER                             05120001
051300                DP013-STACK.                                      05130001
051400     SET DP013-LINK-RETURN            TO TRUE.                    05140001
051500                                                                  05150001
051600     EXEC CICS                                                    05160001
051700         LINK                                                     05170001
051800             PROGRAM   (DP013-NAME)                               05180001
051900             COMMAREA  (DP013-PARAMETERS)                         05190001
052000             LENGTH    (DP013-LENGTH)                             05200001
052100     END-EXEC.                                                    05210001
