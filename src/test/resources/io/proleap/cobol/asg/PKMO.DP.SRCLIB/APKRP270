000100 IDENTIFICATION DIVISION.                                         00010009
000200 PROGRAM-ID.     APKRP270.                                        00020009
000300 AUTHOR.         M.WILKINSON.                                     00030009
000400 DATE-WRITTEN.   09/21/1995.                                      00040009
000500 DATE-COMPILED.                                                   00050009
000600******************************************************************00060041
000700* COBOL 2                                                        *00070041
000800*----------------------------------------------------------------*00080041
000900* POS REQUIRING MANUAL RECONCILIATION REPORT                     *00090041
001000*----------------------------------------------------------------*00100041
001100* PROGRAM OVERVIEW:                                              *00110041
001300*     THIS PROGRAM CREATES THE PO'S REQUIRING MANUAL             *00130041
001400* RECONCILIATION REPORT FROM A REPORT FILE PRODUCED IN           *00140041
001500* APKUP230.  THIS PROGRAM PRODUCES 2 REPORTS IN ONE PASS.        *00150041
001600*----------------------------------------------------------------*00160041
001700* INPUT:                                                         *00170041
001900* 1. MANUAL-RECON-FILE                         (APRD270)         *00190041
002000*                                                                *00200041
002100* OUTPUT:                                                        *00210041
002300* 1. POS REQUIRING MANAUL RECONCILIATION                         *00230041
002310*    REPORT - MASTER                           (DPWS133O)        *00231041
002400* 2. POS REQUIRING MANAU RECONCILIATION                          *00240041
002410*    REPORT - WORKING                          (DPWS133O)        *00241041
002600******************************************************************00260041
002700* MAINTENANCE:                                                   *00270041
002800*                                                                *00280041
002900*   01/29/96 MARY KING                                           *00290041
003000*          - ADDED LOGIC TO HANDLE A NEW REASON CODE, 12,        *00300041
003100*            INDICATING A REMAINDER INVOICE IS PART OF THE       *00310041
003200*            INPUT AND A NEW ONE WOULD BE CREATED AS OUTPUT      *00320041
003300*            OF THE AUTOMATIC RECONCILIATION PROCESS.            *00330041
003400*                                                                *00340041
003500*   02/20/96 MARY KING                                           *00350041
003600*          - ADDED PAGE BREAK FOR EACH VENDOR BEGINNING          *00360041
003700*            WITH A NEW LETTER OF THE ALPHABET.                  *00370041
003800*          - ADDED 88 LEVELS FOR VARIABLE SUB.                   *00380041
003900*                                                                *00390041
004000*   04/11/97 MARILYN WILKINSON                                   *00400041
004100*          - COMMENT OUT WORKING-REPORT TO CHECK FOR FIRST       *00410041
004200*            LETTER OF VENDOR NOT = FOR PAGE BREAK - DO FOR      *00420041
004300*            BOTH WORKING AND MASTER.                            *00430041
004400*                                                                *00440041
004500* 02/05/2003                                                     *00450041
004600*    CHANGE MADE: ARKPO PHASE3 PROJECT.                          *00460041
004700*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.          *00470041
004800*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK.        *00480041
004900*    CHANGED THE VARIOUS PRINT PO NUMBERS TO PIC Z(9).           *00490041
005000*    INCREASED THE LENGTH OF THE W/S PO NBRS TO 9 BYTES.         *00500041
005100*    REALIGNED THE HEADERS BECAUSE OF THE LARGER PRINT           *00510041
005200*    PO NBRS. RENAMED THE W/S AND PRINT PO NBR TO                *00520041
005300*    MATCH THE PO-NBR NAMING STANDARD IN THE COPYBOOK.           *00530041
005400* MADE BY:  MIKE BESKE                          WR#: 23500       *00540041
005401*                                                                *00540141
005410* 10/26/2006                                                     *00541041
005420*    CHANGE MADE: MATCH BY DC -- REMOVED THE PHRASE              *00542041
005430*    'CONTACT PROGRAMMING.' FROM ALL REASON MESSAGES.            *00543041
005491* MADE BY: KRYSTEN LEARY                        WR#: 31317       *00549141
005492*                                                                *00549241
005493* 03/11/2007                                                     *00549341
005494*    CHANGE MADE: MATCH BY DC PROJECT.                           *00549441
005495*    ADDED DC NBR TO DETAIL HEADER AND DETAIL LINE.              *00549541
005496*    MODIFIED PARAGRAPH \475- TO INCLUDE DC NBR.                 *00549641
005498* MADE BY: ROLF NOHE                            WR#: 21578       *00549841
005499*                                                                *00549941
005500* 05/11/2021                                                     *00550041
005501*    CHANGE MADE: RECOMPILE FOR NEW VERSION OF APRD270           *00550141
005502*    FOR SEPHORA LOGIC                                           *00550241
005504* MADE BY: JEAN KURK                       CHG0256545            *00550441
005505*                                                                *00550541
005506*DATE  01/03/2024                                                *00550641
005507*    CHANGE MADE: ADDED RECEIVER INCOMPLETE FLAG TO DETAIL LINES,*00550741
005508*    ADDED LOGIC TO MOVE NEW APRD270 FIELD TO NEW DETAIL FIELD.  *00550841
005509*    INCREASED RECORD LENGTH ON INPUT FILE TO 106.               *00550941
005510*    MADE BY: NANCY EILBES            WR/IR #: CHG0297757        *00551041
005520******************************************************************00552041
005600                                                                  00560013
005700 ENVIRONMENT DIVISION.                                            00570009
005800 CONFIGURATION SECTION.                                           00580009
005900 INPUT-OUTPUT SECTION.                                            00590009
006000 FILE-CONTROL.                                                    00600009
006100                                                                  00610009
006200     SELECT MANUAL-RECON-FILE    ASSIGN TO UT-S-INP01.            00620009
006300     SELECT RPT01-FILE           ASSIGN TO UT-S-RPT01.            00630009
006400     SELECT RPT02-FILE           ASSIGN TO UT-S-RPT02.            00640009
006500                                                                  00650009
006600 DATA DIVISION.                                                   00660009
006700 FILE SECTION.                                                    00670009
006800 FD  MANUAL-RECON-FILE                                            00680009
006900     RECORDING MODE IS F                                          00690009
007000     LABEL RECORDS ARE STANDARD                                   00700009
007100     BLOCK CONTAINS 0 RECORDS                                     00710009
007200     DATA RECORD IS MANUAL-RECON-RECORD.                          00720009
007300 01  MANUAL-RECON-RECORD         PIC  X(106).                     00730039
007400                                                                  00740009
007500 FD  RPT01-FILE                                                   00750009
007600     RECORDING MODE IS F                                          00760009
007700     LABEL RECORDS ARE STANDARD                                   00770009
007800     BLOCK CONTAINS 0 RECORDS                                     00780009
007900     DATA RECORD IS RPT01-RECORD.                                 00790009
008000 01  RPT01-RECORD                PIC  X(132).                     00800009
008100                                                                  00810009
008200 FD  RPT02-FILE                                                   00820009
008300     RECORDING MODE IS F                                          00830009
008400     LABEL RECORDS ARE STANDARD                                   00840009
008500     BLOCK CONTAINS 0 RECORDS                                     00850009
008600     DATA RECORD IS RPT02-RECORD.                                 00860009
008700 01  RPT02-RECORD                PIC  X(132).                     00870009
008800                                                                  00880009
009000 WORKING-STORAGE SECTION.                                         00900009
009010*--------------------------------------------------------------*  00901015
009020* INPUT RECORD LAYOUT                                          *  00902015
009030*--------------------------------------------------------------*  00903015
009040     COPY APRD270.                                                00904015
009050                                                                  00905015
009060*--------------------------------------------------------------*  00906015
009070* STANDARD REPORT LAYOUT FOR 132 CHARACTERS                    *  00907015
009080*--------------------------------------------------------------*  00908015
009090     COPY DPWS133O.                                               00909015
009091                                                                  00909115
009200 01  PROGRAM-WORKAREAS.                                           00920015
009900     05  PV-PROGRAM-NAME         PIC X(08)   VALUE 'APKRP270'.    00990013
010100     05  PV-INVOICE-COUNT        PIC S9(07)  COMP-3 VALUE +0.     01010013
010200     05  PV-NUM-DIFF-REASON-CDS  PIC S9(03)  COMP-3 VALUE +0.     01020013
010400                                                                  01040009
011300 01  COMPARE-FIELDS.                                              01130009
011400     05  PV-SAVE-LETTER               PIC X(01) VALUE ' '.        01140009
011500     05  PV-PREV-COMPARE.                                         01150009
011600         10  PV-PREV-PO-NBR           PIC 9(09) VALUE 0.          01160009
011700         10  PV-PREV-REASON-CODE      PIC X(02) VALUE LOW-VALUES. 01170009
011800                                                                  01180009
011900 01  ACCUM-FIELDS.                                                01190009
012000     05  T-REPORT-COUNT          PIC S9(07)    COMP-3 VALUE +60.  01200009
012100     05  T-REPORT-AMOUNT         PIC S9(11)V99 COMP-3 VALUE +0.   01210009
012200                                                                  01220009
012300 01  PRINT-FIELDS.                                                01230009
012400     05  PR-MAX-LINES            PIC S9(05)   COMP-3  VALUE +60.  01240009
012500     05  PR-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01250009
012600     05  PR-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01260009
012700     05  PR-DETAIL-CC            PIC S9(01)   COMP-3  VALUE +0.   01270009
012800     05  PR-CC                   PIC S9(01)   COMP-3  VALUE +0.   01280009
013000     05  PR-LINE                 PIC X(132)  VALUE SPACES.        01300015
013100                                                                  01310009
013200 01  PROGRAM-SWITCHES-SUBS.                                       01320009
013300     05  PV-INPUT-EOF-SW         PIC  X(01)   VALUE 'N'.          01330013
013400         88  INPUT-EOF                        VALUE 'Y'.          01340013
013500         88  INPUT-NOT-EOF                    VALUE 'N'.          01350013
013600     05  PV-FIRST-INVOICE-SW     PIC  X(01)   VALUE 'Y'.          01360013
013700         88  FIRST-INVOICE                    VALUE 'Y'.          01370013
013800         88  NOT-FIRST-INVOICE                VALUE 'N'.          01380013
013900     05  SUB                     PIC S9(09)   COMP  VALUE +0.     01390013
014000         88  MASTER-REPORT                          VALUE +1.     01400013
014100         88  WORKING-REPORT                         VALUE +2.     01410013
014200                                                                  01420009
014300 01  PV-CURRENT-DATE.                                             01430009
014400     05  PV-CURRENT-YEAR         PIC  9(02)           VALUE 0.    01440009
014500     05  PV-CURRENT-MONTH        PIC  9(02)           VALUE 0.    01450009
014600     05  PV-CURRENT-DAY          PIC  9(02)           VALUE 0.    01460009
014800 01  PV-CURRENT-TIME.                                             01480009
014900     05  PV-CURRENT-HOUR         PIC  9(02)           VALUE 0.    01490009
015000     05  PV-CURRENT-MINUTE       PIC  9(02)           VALUE 0.    01500009
015100     05  FILLER                  PIC  9(02)           VALUE 0.    01510013
015200                                                                  01520009
015300 01 PV-REASON-CDE-TBL.                                            01530009
015400    05  PV-REASON-CODE-TABLE OCCURS 50 TIMES INDEXED BY R-INDX.   01540013
015600        10  PV-REASON-CODE-USED              PIC X(01).           01560009
015700                                                                  01570009
016701*--------------------------------------------------------------*  01670113
016702* REPORT TITLES                                                *  01670213
016703*--------------------------------------------------------------*  01670313
016704 01  PV-REPORT-NAMES.                                             01670413
016705     05 FILLER                           PIC X(52)   VALUE        01670513
016706        '    PO S REQUIRING MANUAL RECONCILIATION - MASTER   '.   01670613
016707     05 FILLER                           PIC X(52)   VALUE        01670713
016708        '    PO S REQUIRING MANUAL RECONCILIATION - WORKING  '.   01670813
016709 01  PV-REPORTS REDEFINES PV-REPORT-NAMES.                        01670913
016710     05  PV-REPORT OCCURS 2 TIMES        PIC X(52).               01671013
016711                                                                  01671113
016712*--------------------------------------------------------------*  01671213
016720* REPORT HEADING LINES                                         *  01672013
016730*--------------------------------------------------------------*  01673013
016800 01  HDR-LINE2.                                                   01680009
016900     05  FILLER                  PIC  X(40)   VALUE SPACES.       01690009
017000     05  HL2-TITLE               PIC  X(52)   VALUE SPACES.       01700009
017100     05  FILLER                  PIC  X(40)   VALUE SPACES.       01710009
017200                                                                  01720009
017300 01  HDR-LINE3.                                                   01730009
017400*    05  FILLER                  PIC  X(02)    VALUE SPACE.       01740035
017500     05  FILLER                  PIC  X(30)    VALUE              01750009
017600         'VENDOR NAME                   '.                        01760009
017700     05  FILLER                  PIC  X(02)    VALUE SPACE.       01770009
017800     05  FILLER                  PIC  X(09)    VALUE              01780009
017900         'VENDOR # '.                                             01790009
018000     05  FILLER                  PIC  X(02)    VALUE SPACE.       01800009
018100     05  FILLER                  PIC  X(09)    VALUE              01810009
018200         'P/O #  '.                                               01820009
018300     05  FILLER                  PIC  X(02)    VALUE SPACE.       01830009
018400     05  FILLER                  PIC  X(10)    VALUE              01840009
018500         'ENTRY DATE'.                                            01850009
018600     05  FILLER                  PIC  X(02)    VALUE SPACE.       01860009
018700     05  FILLER                  PIC  X(20)    VALUE              01870009
018800         'INVOICE #           '.                                  01880010
018900     05  FILLER                  PIC  X(02)    VALUE SPACE.       01890035
019000     05  FILLER                  PIC  X(02)    VALUE              01900009
019100         'EM'.                                                    01910009
019200     05  FILLER                  PIC  X(02)    VALUE SPACE.       01920009
019300     05  FILLER                  PIC  X(07)    VALUE              01930009
019400         'STORE #'.                                               01940009
019500     05  FILLER                  PIC  X(02)    VALUE SPACE.       01950009
019600     05  FILLER                  PIC  X(14)    VALUE              01960009
019700         ' GROSS INVOICE'.                                        01970009
019800     05  FILLER                  PIC  X(01)    VALUE SPACE.       01980035
019920     05  FILLER                  PIC  X(05)    VALUE              01992021
019930         'DC # '.                                                 01993021
019940     05  FILLER                  PIC  X(01)    VALUE SPACE.       01994031
019941     05  FILLER                  PIC  X(03)    VALUE              01994131
019950         'LVL'.                                                   01995031
020000     05  FILLER                  PIC  X(01)    VALUE SPACE.       02000018
020010     05  FILLER                  PIC  X(06)    VALUE              02001040
020020         'RV INC'.                                                02002040
020100                                                                  02010009
020200 01  HDR-LINE4.                                                   02020009
020300*    05  FILLER                  PIC  X(02)    VALUE SPACE.       02030035
020400     05  FILLER                  PIC  X(30)    VALUE              02040009
020500         '------------------------------'.                        02050009
020600     05  FILLER                  PIC  X(02)    VALUE SPACE.       02060009
020700     05  FILLER                  PIC  X(09)    VALUE              02070009
020800         '---------'.                                             02080009
020900     05  FILLER                  PIC  X(02)    VALUE SPACE.       02090009
021000     05  FILLER                  PIC  X(09)    VALUE              02100009
021100         '---------'.                                             02110009
021200     05  FILLER                  PIC  X(02)    VALUE SPACE.       02120009
021300     05  FILLER                  PIC  X(10)    VALUE              02130009
021400         '----------'.                                            02140009
021500     05  FILLER                  PIC  X(02)    VALUE SPACE.       02150009
021600     05  FILLER                  PIC  X(20)    VALUE              02160009
021700         '--------------------'.                                  02170009
021800*    05  FILLER                  PIC  X(02)    VALUE SPACE.       02180035
021900*    05  FILLER                  PIC  X(01)    VALUE              02190035
022000*        '-'.                                                     02200035
022100     05  FILLER                  PIC  X(02)    VALUE SPACE.       02210009
022200     05  FILLER                  PIC  X(02)    VALUE              02220009
022300         '--'.                                                    02230009
022400     05  FILLER                  PIC  X(02)    VALUE SPACE.       02240009
022500     05  FILLER                  PIC  X(07)    VALUE              02250009
022600         '-------'.                                               02260009
022700     05  FILLER                  PIC  X(02)    VALUE SPACE.       02270009
022800     05  FILLER                  PIC  X(14)    VALUE              02280009
022900         '--------------'.                                        02290009
023000     05  FILLER                  PIC  X(01)    VALUE SPACE.       02300035
023120     05  FILLER                  PIC  X(05)    VALUE              02312021
023130         '-----'.                                                 02313021
023200     05  FILLER                  PIC  X(01)    VALUE SPACE.       02320019
023210     05  FILLER                  PIC  X(03)    VALUE              02321031
023220         '---'.                                                   02322031
023230     05  FILLER                  PIC  X(01)    VALUE SPACE.       02323031
023240     05  FILLER                  PIC  X(07)    VALUE              02324035
023250         '-------'.                                               02325035
023300                                                                  02330009
023310*--------------------------------------------------------------*  02331013
023320* REPORT DETAIL LINES                                          *  02332013
023330*--------------------------------------------------------------*  02333013
023400 01  DETAIL-LINE.                                                 02340009
023500*    05  FILLER                  PIC  X(02).                      02350035
023600     05  DL-VENDOR-NAME          PIC  X(30).                      02360009
023700     05  FILLER                  PIC  X(02).                      02370009
023800     05  DL-VENDOR-NUMBER        PIC  X(09).                      02380009
023900     05  FILLER                  PIC  X(02).                      02390009
024000     05  DL-PO-NBR               PIC  Z(09).                      02400009
024100     05  FILLER                  PIC  X(03).                      02410009
024200     05  DL-ENTRY-DATE.                                           02420009
024300         10  DL-ENTRY-MONTH      PIC  9(02).                      02430009
024400         10  DL-ENTRY-LIT1       PIC  X(01).                      02440009
024500         10  DL-ENTRY-DAY        PIC  9(02).                      02450009
024600         10  DL-ENTRY-LIT2       PIC  X(01).                      02460009
024700         10  DL-ENTRY-YEAR       PIC  9(02).                      02470009
024800     05  FILLER                  PIC  X(03).                      02480009
024900     05  DL-INVOICE-NUMBER       PIC  X(20).                      02490009
025000     05  FILLER                  PIC  X(02).                      02500035
025100     05  DL-INVOICE-ENTRY-METHOD PIC  X(02).                      02510009
025200     05  FILLER                  PIC  X(04).                      02520009
025300     05  DL-STORE-NUMBER         PIC  9(04).                      02530009
025400     05  FILLER                  PIC  X(03).                      02540009
025500     05  DL-GROSS-INVOICE-AMT    PIC  ZZZ,ZZZ,ZZ9.99.             02550009
025600     05  FILLER                  PIC  X(02).                      02560035
025720     05  DL-DC-NUMBER            PIC  9(03).                      02572031
025730     05  FILLER                  PIC  X(03).                      02573031
025740     05  DL-MTCH-LVL-CDE         PIC  X(01).                      02574031
025800     05  FILLER                  PIC  X(04).                      02580040
025810     05  DL-RCV-INCMP-IND        PIC  X(01).                      02581037
025900                                                                  02590009
026000 01  DETAIL-LINE2                REDEFINES  DETAIL-LINE.          02600009
026100     05  FILLER                  PIC  X(02).                      02610009
026200     05  DL2-TYPE                PIC  X(30).                      02620009
026300     05  FILLER                  PIC  X(01).                      02630009
026400     05  DL2-COUNT               PIC  ZZZZ,ZZ9.                   02640009
026500     05  FILLER                  PIC  X(01).                      02650009
026600     05  DL2-AMOUNT              PIC  ZZ,ZZZ,ZZZ,ZZ9.99.          02660009
026700     05  FILLER                  PIC  X(73).                      02670009
026701                                                                  02670113
026702*--------------------------------------------------------------*  02670213
026703* END OF REPORT LINE                                           *  02670313
026704*--------------------------------------------------------------*  02670413
026710 01  EOR-END-OF-REPORT.                                           02671013
026720     05  FILLER                  PIC  X(52)  VALUE SPACES.        02672013
026730     05  FILLER                  PIC  X(80)  VALUE                02673013
026740         '*****  END OF REPORT *****'.                            02674013
026800                                                                  02680009
026810*--------------------------------------------------------------*  02681013
026820* REASON DESCRIPTIONS                                          *  02682013
026830*--------------------------------------------------------------*  02683013
026900 01  REASON-LINE.                                                 02690009
027000     05  FILLER                  PIC  X(10)   VALUE SPACES.       02700009
027100     05  REASON-LINE-AREA        PIC  X(100).                     02710009
027200     05  FILLER                  PIC  X(22)   VALUE SPACES.       02720009
027300                                                                  02730009
027400 01  REASON-DESCRIPTIONS.                                         02740009
027500     05  REASON-1.                                                02750009
027600         10  FILLER              PIC  X(50)  VALUE                02760009
027700            'THIS VENDOR AND DEPARTMENT MUST BE MANUALLY RECONC'. 02770009
027800         10  FILLER              PIC  X(50)  VALUE                02780009
027900            'ILED.                                             '. 02790009
028000     05  REASON-2.                                                02800009
028100         10  FILLER              PIC  X(50)  VALUE                02810009
028200            'NUMBER OF RECEIVERS FOR THIS PO/STORE EXCEEDS PROG'. 02820009
028300         10  FILLER              PIC  X(50)  VALUE                02830009
028400            'RAM LIMITS.                                       '. 02840013
028500     05  REASON-3.                                                02850009
028600         10  FILLER              PIC  X(50)  VALUE                02860009
028700            'NUMBER OF RECEIVING DISTRIBUTIONS FOR THIS PO/STOR'. 02870009
028800         10  FILLER              PIC  X(50)  VALUE                02880009
028900            'E EXCEEDS PROGRAM LIMITS.                         '. 02890013
029000     05  REASON-4.                                                02900009
029100         10  FILLER              PIC  X(50)  VALUE                02910009
029200            'NUMBER OF NON-INVOICED RECEIPTS FOR THIS PO/STORE '. 02920009
029300         10  FILLER              PIC  X(50)  VALUE                02930009
029400            'EXCEEDS PROGRAM LIMITS.                           '. 02940013
029500     05  REASON-5.                                                02950009
029600         10  FILLER              PIC  X(50)  VALUE                02960009
029700            'NUMBER OF INVOICES FOR THIS PO/STORE EXCEEDS PROGR'. 02970009
029800         10  FILLER              PIC  X(50)  VALUE                02980009
029900            'AM LIMITS.                                        '. 02990013
030000     05  REASON-6.                                                03000009
030100         10  FILLER              PIC  X(50)  VALUE                03010009
030200            'RECEIVER WITH VERIFIED QUANTITY AND ZERO UNIT COST'. 03020009
030300         10  FILLER              PIC  X(50)  VALUE                03030009
030400            ' FOUND.                                           '. 03040009
030500     05  REASON-7.                                                03050009
030600         10  FILLER              PIC  X(50)  VALUE                03060009
030700            'COMBINATION OF OVERAGE AND SHORTAGE FOUND FOR THIS'. 03070009
030800         10  FILLER              PIC  X(50)  VALUE                03080009
030900            ' PO/STORE.                                        '. 03090009
031000     05  REASON-8.                                                03100009
031100         10  FILLER              PIC  X(50)  VALUE                03110009
031200            'MULTIPLE INVOICE UNIT COSTS FOR A PO LINE FOUND.  '. 03120009
031300         10  FILLER              PIC  X(50)  VALUE                03130009
031400            '                                                  '. 03140009
031500     05  REASON-9.                                                03150009
031600         10  FILLER              PIC  X(50)  VALUE                03160009
031700            'UNIT COST DIFFERENCES EXCEED THE CONTROL LIMIT.   '. 03170009
031800         10  FILLER              PIC  X(50)  VALUE                03180009
031900            '                                                  '. 03190009
032000     05  REASON-10.                                               03200009
032100         10  FILLER              PIC  X(50)  VALUE                03210009
032200            'NUMBER OF PRICE CLAIMS FOR THIS PO/STORE EXCEEDS  '. 03220009
032300         10  FILLER              PIC  X(50)  VALUE                03230009
032400            'PROGRAM LIMITS.                                   '. 03240013
032500     05  REASON-11.                                               03250009
032600         10  FILLER              PIC  X(50)  VALUE                03260009
032700            'NO INVOICE DETAIL.                                '. 03270009
032800         10  FILLER              PIC  X(50)  VALUE                03280009
032900            '                                                  '. 03290009
033000     05  REASON-12.                                               03300009
033100         10  FILLER              PIC  X(50)  VALUE                03310009
033200            'REMAINDER INVOICE IS INPUT AND A NEW REMAINDER WOU'. 03320009
033300         10  FILLER              PIC  X(50)  VALUE                03330009
033400            'LD BE CREATED.                                    '. 03340009
033500                                                                  03350009
034700*---------------------                                            03470013
034800 PROCEDURE DIVISION.                                              03480014
034900*---------------------                                            03490013
035300                                                                  03530009
035400     PERFORM B100-INITIALIZATION.                                 03540013
035600     PERFORM B200-PROCESS-REPORTS.                                03560013
035800     PERFORM B300-END-PROGRAM.                                    03580013
036000     GOBACK.                                                      03600009
036100                                                                  03610009
036300*--------------------------------------------------------------*  03630013
036400* INITIALIZATION PROCESSING                                    *  03640013
036700*--------------------------------------------------------------*  03670013
036800 B100-INITIALIZATION.                                             03680013
036900                                                                  03690009
037200     OPEN INPUT  MANUAL-RECON-FILE                                03720009
037300          OUTPUT RPT01-FILE                                       03730009
037400                 RPT02-FILE.                                      03740009
037500                                                                  03750009
037600     ACCEPT PV-CURRENT-DATE      FROM DATE.                       03760009
037700     MOVE PV-CURRENT-MONTH       TO DP133O-RUN-MONTH.             03770013
037800     MOVE PV-CURRENT-DAY         TO DP133O-RUN-DAY.               03780013
037900     MOVE PV-CURRENT-YEAR        TO DP133O-RUN-YEAR.              03790013
038000                                                                  03800009
038100     ACCEPT PV-CURRENT-TIME      FROM TIME.                       03810009
038200     MOVE PV-CURRENT-HOUR        TO DP133O-RUN-HOUR.              03820013
038300     MOVE PV-CURRENT-MINUTE      TO DP133O-RUN-MINUTE.            03830013
038500     MOVE PV-PROGRAM-NAME        TO DP133O-PROGRAM-NAME.          03850013
038600                                                                  03860009
038700     MOVE SPACES                 TO DETAIL-LINE                   03870013
038800                                    REASON-LINE.                  03880013
039000     MOVE ZERO                   TO PV-INVOICE-COUNT.             03900013
039200     PERFORM R100-READ-MANUAL-RECON-FILE.                         03920013
039300                                                                  03930009
039500*--------------------------------------------------------------*  03950013
039600* PROCESSES THE REPORTS EVEN IF THERE IS NO INPUT              *  03960013
040000*--------------------------------------------------------------*  04000013
040100 B200-PROCESS-REPORTS.                                            04010013
040700                                                                  04070009
040800     PERFORM                                                      04080009
040900         VARYING SUB FROM 1 BY 1                                  04090009
041000             UNTIL SUB > 2                                        04100009
041100                                                                  04110009
041200         PERFORM C100-SETUP-REPORT                                04120013
041400         SET FIRST-INVOICE            TO TRUE                     04140009
041500         INITIALIZE                      PV-REASON-CDE-TBL        04150009
041600         MOVE AP270-VENDOR-NAME (1:1) TO PV-SAVE-LETTER           04160009
041700         MOVE AP270-PO-NBR            TO PV-PREV-PO-NBR           04170009
041800                                                                  04180009
041900         PERFORM C200-PROCESS-INPUT                               04190013
042000           UNTIL INPUT-EOF OR AP270-REPORT > SUB                  04200013
042300         PERFORM W400-WRITE-TOTALS                                04230013
042500     END-PERFORM.                                                 04250009
042600                                                                  04260009
042700*--------------------------------------------------------------*  04270013
042710* END OF PROGRAM PROCESSING                                    *  04271013
042720*--------------------------------------------------------------*  04272013
042730 B300-END-PROGRAM.                                                04273013
042740                                                                  04274013
042750     CLOSE MANUAL-RECON-FILE                                      04275013
042760           RPT01-FILE                                             04276013
042770           RPT02-FILE.                                            04277013
042780                                                                  04278013
042800*--------------------------------------------------------------*  04280013
042810* SETUP OF REPORT HEADINGS, PAGE COUNTS, AND TOTALS.           *  04281013
043300*--------------------------------------------------------------*  04330013
043400 C100-SETUP-REPORT.                                               04340013
043500                                                                  04350009
044000     MOVE SUB                    TO DP133O-REPORT-NUMBER.         04400013
044100     MOVE PV-REPORT(SUB)         TO HL2-TITLE.                    04410013
045200                                                                  04520009
045300*  CLEAR PAGE COUNT, FORCE HEADING FIRST TIME                     04530009
045500     MOVE ZERO                   TO PR-PAGE-COUNT.                04550013
045600     MOVE 99                     TO PR-LINE-COUNT.                04560013
045800     MOVE 0                      TO PV-PREV-PO-NBR.               04580013
045900     MOVE LOW-VALUES             TO PV-PREV-REASON-CODE.          04590013
046100*  CLEAR FINAL TOTAL FIELDS                                       04610009
046200     MOVE +0                     TO T-REPORT-COUNT                04620013
046300                                    T-REPORT-AMOUNT.              04630013
046400                                                                  04640009
046600*--------------------------------------------------------------*  04660013
046700* INPUT FILE PROCESSING:                                       *  04670013
046800* THE HEADER RECORDS ARE PROCESSED AS A GROUP -- ONLY ONE LINE *  04680013
046900* IS PRINTED.  THE TOTALS ARE ACCUMULATED ON A NUMBER OF       *  04690013
046910* INVOICES AND A NUMBER OF DIFFERENT REASON CODES.             *  04691013
046920* THE INVOICE RECORDS ARE PROCESSED AND PRINTED INDIVIDUALLY --*  04692013
046930* A LINE IS PRINTED FOR EACH INVOICE.  IF THE ENTIRE PURCHASE  *  04693013
046940* ORDER ONLY HAS ONE REASON CODE, IT IS PRINTED AT THE END OF  *  04694013
046950* THAT PO'S INVOICE LIST.  IF THE PURCHASE ORDER HAS MULTIPLE  *  04695013
046960* REASON CODES, THEY ARE PRINTED AT THE END OF EACH "GROUP"    *  04696013
046970* OF INVOICES THAT THE SAME REASON CODE.                       *  04697013
047000*--------------------------------------------------------------*  04700013
047100 C200-PROCESS-INPUT.                                              04710013
047200                                                                  04720009
048610     IF AP270-PO-NBR = PV-PREV-PO-NBR                             04861028
048700        IF AP270-HEADER = LOW-VALUES                              04870009
048800           PERFORM C300-PROCESS-HEADER                            04880013
048900        ELSE                                                      04890009
049000           PERFORM C400-PROCESS-INVOICE                           04900013
049100        END-IF                                                    04910009
049200        PERFORM R100-READ-MANUAL-RECON-FILE                       04920013
049300     ELSE                                                         04930009
049400        SET FIRST-INVOICE              TO TRUE                    04940013
049500        PERFORM C500-PROCESS-REASON                               04950013
049600        MOVE AP270-PO-NBR              TO PV-PREV-PO-NBR          04960013
049700        INITIALIZE PV-REASON-CDE-TBL                              04970013
049800     END-IF.                                                      04980009
049900                                                                  04990009
050100*--------------------------------------------------------------*  05010013
050110* PROCESS THE HEADER RECORD BY MOVING THE VENDOR AND PO INFO   *  05011013
050120* TO THE DETAIL LINE SO THAT IT IS NOT REPEATED.  IF A PAGE    *  05012013
050130* OVERFLOW IS DETECTED, THE NEW PO WILL BE PUT ONTO A NEW PAGE *  05013013
050700*--------------------------------------------------------------*  05070013
050800 C300-PROCESS-HEADER.                                             05080013
050900                                                                  05090009
051700     IF AP270-VENDOR-NAME (1:1) = PV-SAVE-LETTER                  05170013
051800        CONTINUE                                                  05180013
051900     ELSE                                                         05190013
052000        MOVE +99                     TO PR-LINE-COUNT             05200013
052100        MOVE AP270-VENDOR-NAME (1:1) TO PV-SAVE-LETTER            05210013
052300     END-IF.                                                      05230009
052400                                                                  05240009
052500     MOVE 1                          TO PR-DETAIL-CC.             05250013
052700     MOVE AP270-VENDOR-NAME          TO DL-VENDOR-NAME.           05270013
052800     MOVE AP270-VENDOR-NUMBER        TO DL-VENDOR-NUMBER.         05280013
052900     MOVE AP270-PO-NBR               TO DL-PO-NBR.                05290013
053000     ADD  AP270-INVOICE-COUNT        TO PV-INVOICE-COUNT.         05300013
053100     EVALUATE AP270-REASON-CODE                                   05310009
053200         WHEN '01'                                                05320009
053300              SET R-INDX TO 1                                     05330009
053400         WHEN '02'                                                05340009
053500              SET R-INDX TO 2                                     05350009
053600         WHEN '03'                                                05360009
053700              SET R-INDX TO 3                                     05370009
053800         WHEN '04'                                                05380009
053900              SET R-INDX TO 4                                     05390009
054000         WHEN '05'                                                05400009
054100              SET R-INDX TO 5                                     05410009
054200         WHEN '06'                                                05420009
054300              SET R-INDX TO 6                                     05430009
054400         WHEN '07'                                                05440009
054500              SET R-INDX TO 7                                     05450009
054600         WHEN '08'                                                05460009
054700              SET R-INDX TO 8                                     05470009
054800         WHEN '09'                                                05480009
054900              SET R-INDX TO 9                                     05490009
055000         WHEN '10'                                                05500009
055100              SET R-INDX TO 10                                    05510009
055200         WHEN '11'                                                05520009
055300              SET R-INDX TO 11                                    05530009
055400         WHEN '12'                                                05540009
055500              SET R-INDX TO 12                                    05550009
055600         WHEN OTHER                                               05560009
055700              SET R-INDX TO 50                                    05570009
055800     END-EVALUATE.                                                05580009
055900                                                                  05590009
056000     MOVE 'X' TO PV-REASON-CODE-USED (R-INDX).                    05600009
056100                                                                  05610009
058200*--------------------------------------------------------------*  05820013
058300* FORMATS AND WRITES THE REPORT DETAIL LINES                   *  05830013
058600*--------------------------------------------------------------*  05860013
058700 C400-PROCESS-INVOICE.                                            05870013
058800                                                                  05880009
059100     IF FIRST-INVOICE                                             05910009
059200        PERFORM C425-DETERMINE-LINES                              05920013
059300        PERFORM C475-FORMAT-LINE                                  05930013
059400        MOVE AP270-REASON-CODE    TO PV-PREV-REASON-CODE          05940009
059500        SET NOT-FIRST-INVOICE     TO TRUE                         05950009
059600     ELSE                                                         05960009
059700        IF AP270-REASON-CODE NOT = PV-PREV-REASON-CODE            05970013
059800           PERFORM C500-PROCESS-REASON                            05980013
059900           MOVE AP270-REASON-CODE TO PV-PREV-REASON-CODE          05990009
060000        END-IF                                                    06000009
060100        PERFORM C475-FORMAT-LINE                                  06010013
060200     END-IF.                                                      06020009
060300                                                                  06030009
060400*--------------------------------------------------------------*  06040013
060401* COUNT THE NUMBER OF DIFFERENT REASON CODES THAT EXIST FOR    *  06040113
060402* THE PURCHASE ORDER.   THE TABLE IS BUILT FROM THE HEADER     *  06040213
060403* RECORDS.                                                     *  06040313
060404*--------------------------------------------------------------*  06040413
060405 C425-DETERMINE-LINES.                                            06040513
060406                                                                  06040613
060407     MOVE 0 TO PV-NUM-DIFF-REASON-CDS.                            06040713
060408                                                                  06040813
060409     PERFORM VARYING R-INDX FROM 1 BY 1                           06040913
060410        UNTIL R-INDX > 50                                         06041013
060411        IF PV-REASON-CODE-USED (R-INDX) = 'X'                     06041113
060412           ADD 1                 TO PV-NUM-DIFF-REASON-CDS        06041213
060413        END-IF                                                    06041313
060414     END-PERFORM.                                                 06041413
060415                                                                  06041513
060416     IF ((PR-DETAIL-CC + PR-LINE-COUNT + PV-INVOICE-COUNT + 1     06041613
060417          + PV-NUM-DIFF-REASON-CDS) > PR-MAX-LINES)               06041713
060418       MOVE 99                   TO PR-LINE-COUNT                 06041813
060419     END-IF.                                                      06041913
060420                                                                  06042013
060421*--------------------------------------------------------------*  06042113
060422* FORMATS PRINT LINE                                           *  06042213
060430*--------------------------------------------------------------*  06043013
060500 C475-FORMAT-LINE.                                                06050013
060600                                                                  06060009
060900     MOVE AP270-ENTRY-MONTH          TO DL-ENTRY-MONTH.           06090013
061000     MOVE '-'                        TO DL-ENTRY-LIT1.            06100013
061100     MOVE AP270-ENTRY-DAY            TO DL-ENTRY-DAY.             06110013
061200     MOVE '-'                        TO DL-ENTRY-LIT2.            06120013
061300     MOVE AP270-ENTRY-YEAR           TO DL-ENTRY-YEAR.            06130013
061400     MOVE AP270-INVOICE-NUMBER       TO DL-INVOICE-NUMBER.        06140013
061500                                                                  06150009
061600     MOVE AP270-INVOICE-ENTRY-METHOD TO DL-INVOICE-ENTRY-METHOD.  06160013
061800     MOVE AP270-STORE-NUMBER         TO DL-STORE-NUMBER.          06180013
061810     MOVE AP270-DC-NBR               TO DL-DC-NUMBER.             06181018
061820     MOVE AP270-MTCH-LVL-CDE         TO DL-MTCH-LVL-CDE.          06182031
061830     MOVE AP270-RCV-INCOMP-IND       TO DL-RCV-INCMP-IND.         06183036
061900     MOVE AP270-GROSS-INVOICE-AMT    TO DL-GROSS-INVOICE-AMT.     06190013
062600                                                                  06260009
062900     PERFORM W300-WRITE-REPORT-DETAIL.                            06290013
063100     MOVE SPACE                      TO DETAIL-LINE.              06310013
063200     MOVE 1                          TO PR-DETAIL-CC.             06320013
063400     MOVE ZERO                       TO PV-INVOICE-COUNT.         06340013
063800     ADD 1                           TO T-REPORT-COUNT.           06380013
063900     ADD AP270-GROSS-INVOICE-AMT     TO T-REPORT-AMOUNT.          06390013
064100                                                                  06410009
064300*--------------------------------------------------------------*  06430013
064400* FORMATS AND WRITES A REASON CODE                             *  06440013
064700*--------------------------------------------------------------*  06470013
064800 C500-PROCESS-REASON.                                             06480013
064900                                                                  06490009
065000     EVALUATE PV-PREV-REASON-CODE                                 06500009
065100         WHEN '01'                                                06510009
065200              MOVE REASON-1  TO REASON-LINE-AREA                  06520009
065300         WHEN '02'                                                06530009
065400              MOVE REASON-2  TO REASON-LINE-AREA                  06540009
065500         WHEN '03'                                                06550009
065600              MOVE REASON-3  TO REASON-LINE-AREA                  06560009
065700         WHEN '04'                                                06570009
065800              MOVE REASON-4  TO REASON-LINE-AREA                  06580009
065900         WHEN '05'                                                06590009
066000              MOVE REASON-5  TO REASON-LINE-AREA                  06600009
066100         WHEN '06'                                                06610009
066200              MOVE REASON-6  TO REASON-LINE-AREA                  06620009
066300         WHEN '07'                                                06630009
066400              MOVE REASON-7  TO REASON-LINE-AREA                  06640009
066500         WHEN '08'                                                06650009
066600              MOVE REASON-8  TO REASON-LINE-AREA                  06660009
066700         WHEN '09'                                                06670009
066800              MOVE REASON-9  TO REASON-LINE-AREA                  06680009
066900         WHEN '10'                                                06690009
067000              MOVE REASON-10 TO REASON-LINE-AREA                  06700009
067100         WHEN '11'                                                06710009
067200              MOVE REASON-11 TO REASON-LINE-AREA                  06720009
067300         WHEN '12'                                                06730009
067400              MOVE REASON-12 TO REASON-LINE-AREA                  06740009
067500         WHEN OTHER                                               06750009
067600              MOVE SPACES    TO REASON-LINE-AREA                  06760009
067700     END-EVALUATE.                                                06770009
067800                                                                  06780009
067900     MOVE 1                     TO PR-DETAIL-CC.                  06790009
068000     MOVE PR-DETAIL-CC          TO PR-CC.                         06800009
068100     MOVE REASON-LINE           TO PR-LINE.                       06810009
068200     PERFORM W200-WRITE-REPORT-LINE.                              06820013
068300                                                                  06830009
068400     MOVE SPACES                TO PR-LINE.                       06840009
068500     PERFORM W200-WRITE-REPORT-LINE.                              06850013
068600                                                                  06860009
070200*--------------------------------------------------------------*  07020013
070300* READ INPUT FILE                                              *  07030013
070700*--------------------------------------------------------------*  07070013
070800 R100-READ-MANUAL-RECON-FILE.                                     07080013
071200                                                                  07120009
071300     READ MANUAL-RECON-FILE      INTO AP270-RECORD                07130009
071400         AT END                                                   07140009
071500             SET INPUT-EOF TO TRUE.                               07150013
071600                                                                  07160009
071700*--------------------------------------------------------------*  07170013
071710* WRITE REPORT HEADINGS                                        *  07171013
071720*--------------------------------------------------------------*  07172013
071730 W100-WRITE-REPORT-HEADINGS.                                      07173013
071740                                                                  07174013
071750*  BUMP PAGE COUNT                                                07175013
071760     ADD 1                       TO PR-PAGE-COUNT.                07176013
071770     MOVE PR-PAGE-COUNT          TO DP133O-PAGE-NUMBER.           07177013
071780     MOVE 0                      TO PR-LINE-COUNT.                07178013
071790                                                                  07179013
071791     MOVE 0                                 TO PR-CC.             07179113
071792     MOVE DP133O-STANDRD-HEADER-133-COLS    TO PR-LINE.           07179213
071793     PERFORM W200-WRITE-REPORT-LINE.                              07179313
071794     MOVE 1                                 TO PR-CC.             07179413
071795     MOVE HDR-LINE2                         TO PR-LINE.           07179513
071796     PERFORM W200-WRITE-REPORT-LINE.                              07179613
071797     MOVE 2                                 TO PR-CC.             07179713
071798     MOVE HDR-LINE3                         TO PR-LINE.           07179813
071803     PERFORM W200-WRITE-REPORT-LINE.                              07180320
071804     MOVE 1                                 TO PR-CC.             07180420
071805     MOVE HDR-LINE4                         TO PR-LINE.           07180520
071810     PERFORM W200-WRITE-REPORT-LINE.                              07181020
071811                                                                  07181120
071812*--------------------------------------------------------------*  07181220
071813* WRITES BOTH REPORTS.  THE 'SUB' SUBSCRIPT IS USED TO         *  07181313
071820* DETERMINE THE REPORT AND THE 'PR-CC' IS USED TO DETERMINE    *  07182013
071830* THE HORIZONTAL SPACING.                                      *  07183013
072500*--------------------------------------------------------------*  07250013
072600 W200-WRITE-REPORT-LINE.                                          07260013
072700                                                                  07270009
073200     IF PR-CC = 0                                                 07320009
073300        MOVE 1                  TO PR-CC                          07330013
073400        EVALUATE TRUE                                             07340013
073500          WHEN MASTER-REPORT                                      07350013
073600            WRITE RPT01-RECORD FROM PR-LINE AFTER ADVANCING PAGE  07360013
073800          WHEN WORKING-REPORT                                     07380013
073900            WRITE RPT02-RECORD FROM PR-LINE AFTER ADVANCING PAGE  07390013
074100        END-EVALUATE                                              07410013
074200     ELSE                                                         07420009
074300        EVALUATE TRUE                                             07430013
074400          WHEN MASTER-REPORT                                      07440013
074500            WRITE RPT01-RECORD FROM PR-LINE AFTER ADVANCING PR-CC 07450013
074700          WHEN WORKING-REPORT                                     07470013
074800            WRITE RPT02-RECORD FROM PR-LINE AFTER ADVANCING PR-CC 07480013
075000         END-EVALUATE                                             07500009
075100     END-IF.                                                      07510009
075200                                                                  07520009
075300*  BUMP LINE COUNT                                                07530009
075500     ADD PR-CC                   TO PR-LINE-COUNT.                07550013
075600                                                                  07560009
075800*--------------------------------------------------------------*  07580013
075810* WRITE THE REPORT DETAIL FOR EACH OF THE REPORTS.             *  07581013
076300*--------------------------------------------------------------*  07630013
076400 W300-WRITE-REPORT-DETAIL.                                        07640013
076500                                                                  07650009
076800*  CHECK FOR PAGE OVERFLOW.                                       07680009
077000*  WE WANT TO DISPLAY VENDOR & PO ONCE PER PAGE, AT A PO BREAK OR 07700009
077100*  AT A PAGE BREAK                                                07710009
077300     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             07730009
077400         PERFORM W100-WRITE-REPORT-HEADINGS                       07740013
077500         MOVE AP270-VENDOR-NAME    TO DL-VENDOR-NAME              07750013
077600         MOVE AP270-VENDOR-NUMBER  TO DL-VENDOR-NUMBER            07760013
077800         MOVE AP270-PO-NBR         TO DL-PO-NBR                   07780013
078000         MOVE 1                    TO PR-DETAIL-CC                07800013
078100     END-IF.                                                      07810009
078200                                                                  07820009
078300*  MOVE TO PRINT AREA & WRITE REPORT LINE                         07830009
078500     MOVE PR-DETAIL-CC             TO PR-CC.                      07850013
078600     MOVE DETAIL-LINE              TO PR-LINE.                    07860013
078700     PERFORM W200-WRITE-REPORT-LINE.                              07870013
078800                                                                  07880009
083400*--------------------------------------------------------------*  08340013
083500* WRITE GRAND TOTALS FOR EACH OF THE REPORTS                   *  08350013
083800*--------------------------------------------------------------*  08380013
083900 W400-WRITE-TOTALS.                                               08390013
084000                                                                  08400009
084300*  WRITE THE HEADING IF NOT DONE YET                              08430013
084500     IF T-REPORT-COUNT = 0                                        08450009
084600         PERFORM W100-WRITE-REPORT-HEADINGS                       08460013
084700     END-IF.                                                      08470009
084800                                                                  08480009
084900*  PRINT REASON LINE                                              08490009
085100     PERFORM C500-PROCESS-REASON.                                 08510013
085200                                                                  08520009
085500     MOVE SPACE                  TO DETAIL-LINE.                  08550013
085900     MOVE 'TOTAL INVOICES'       TO DL2-TYPE.                     08590013
086000     MOVE T-REPORT-COUNT         TO DL2-COUNT.                    08600013
086100     MOVE T-REPORT-AMOUNT        TO DL2-AMOUNT.                   08610013
086200                                                                  08620009
086300     MOVE 1                      TO PR-CC.                        08630013
086400     MOVE DETAIL-LINE            TO PR-LINE.                      08640013
086500     PERFORM W200-WRITE-REPORT-LINE.                              08650013
086700     MOVE SPACE                  TO DETAIL-LINE.                  08670013
087100     MOVE 2                      TO PR-CC.                        08710013
087200     MOVE EOR-END-OF-REPORT      TO PR-LINE.                      08720013
087300     PERFORM W200-WRITE-REPORT-LINE.                              08730013
