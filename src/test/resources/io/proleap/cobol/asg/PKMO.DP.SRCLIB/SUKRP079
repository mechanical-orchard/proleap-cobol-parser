000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             SUKRP079.                                00040000
000500 AUTHOR.                 DENISE HAHN.                             00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            OCTOBER 2021.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS IS A COPY OF SUKRP041 - BUT FOR ONLY SEPHORA DEPTS      * 00100000
001010*                                                               * 00101000
001020*  THIS PROGRAM WILL CREATE THE WEEKLY, MONTHLY, SEASONAL       * 00102000
001100*  AND YEARLY CARTONS SCAN BASED RECEIVED BY DC REPORT          * 00110000
001200***************************************************************** 00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400***************************************************************** 00140000
001500 CONFIGURATION SECTION.                                           00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800                                                                  00180000
001900 INPUT-OUTPUT SECTION.                                            00190000
002000 FILE-CONTROL.                                                    00200000
002100*                                                                 00210000
002200     SELECT NEW-CONTROL-FILE                                      00220000
002300         ASSIGN TO SYSIN.                                         00230000
002400*                                                                 00240000
002500     SELECT INPUT-FILE                                            00250000
002600         ASSIGN TO INP01.                                         00260000
002700*                                                                 00270000
002800     SELECT REPORT-FILE                                           00280000
002900         ASSIGN TO RPT01.                                         00290000
003000*                                                                 00300000
003100***************************************************************** 00310000
003200 DATA DIVISION.                                                   00320000
003300***************************************************************** 00330000
003400 FILE SECTION.                                                    00340000
003500*                                                                 00350000
003600 FD  NEW-CONTROL-FILE                                             00360000
003700     RECORDING MODE IS F                                          00370000
003800     BLOCK CONTAINS 0 RECORDS.                                    00380000
003900 01  NEW-CONTROL-RECORD               PIC X(080).                 00390000
004000                                                                  00400000
004100*                                                                 00410000
004200 FD  INPUT-FILE                                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0  RECORDS.                                   00440000
004500 01  INPUT-RECORD                    PIC  X(200).                 00450000
004600*                                                                 00460000
004700 FD  REPORT-FILE                                                  00470000
004800     RECORDING MODE IS F                                          00480000
004900     BLOCK CONTAINS 0  RECORDS.                                   00490000
005000 01  REPORT-RECORD                   PIC  X(132).                 00500000
005100*                                                                 00510000
005200***************************************************************** 00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400*                                                                 00540000
005500 01  PROGRAM-SWITCHES.                                            00550000
005600     05  PS-EOF-INPUT-SW              PIC X(01) VALUE 'N'.        00560000
005700         88  PS-EOF-INPUT                       VALUE 'Y'.        00570000
005800*                                                                 00580000
005900 01  PV-PROGRAM-CONSTANTS.                                        00590000
006000     05  PC-SUKRP079                 PIC X(08) VALUE  'SUKRP079'. 00600000
006100     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00610000
006200*                                                                 00620000
006300 01  DK-KEY-FIELDS.                                               00630000
006400     05  DK-STR-NBR                  PIC  S9(4) COMP  VALUE 0.    00640000
006500*                                                                 00650000
006600 01  PV-PROGRAM-VARIABLES.                                        00660000
006700     05  PV-DATE                     PIC X(10).                   00670000
006800                                                                  00680000
006900     05  PV-DISP-OPER                PIC 9(04).                   00690000
007000     05  PV-DISP-COUNT               PIC 9(09)V99.                00700000
007100     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       00710000
007200     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00720000
007300     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00730000
007400                                                   COMP-3.        00740000
007500     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00750000
007600                                                   COMP-3.        00760000
007700     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00770000
007800                                                   COMP-3.        00780000
007900 01  PV-DC-COUNTS.                                                00790000
008000     05  PV-OUTBOUND-SMO             PIC S9(9) COMP.              00800000
008100     05  PV-OUTBOUND-ASN             PIC S9(9) COMP.              00810000
008200     05  PV-OUTBOUND-CPS             PIC S9(9) COMP.              00820000
008300     05  PV-DISTHD-P2L               PIC S9(9) COMP.              00830000
008400     05  PV-SULBXF-COUNT             PIC S9(9) COMP.              00840000
008500     05  PV-SULBXF-P2L               PIC S9(9) COMP.              00850000
008600     05  PV-TOT-CTNS-RECEIVED        PIC S9(9) COMP.              00860000
008700     05  PV-TOT-CTNS-CHECKIN         PIC S9(9) COMP.              00870000
008800     05  PV-TOT-CTNS-PHYSICAL        PIC S9(9) COMP.              00880000
008900     05  PV-TOT-SML                  PIC S9(9) COMP.              00890000
009000     05  PV-TOT-P2L                  PIC S9(9) COMP.              00900000
009100 01  PV-CORP-COUNTS.                                              00910000
009200     05  PV-OUTBOUND-SMO-CORP        PIC S9(9) COMP.              00920000
009300     05  PV-OUTBOUND-ASN-CORP        PIC S9(9) COMP.              00930000
009400     05  PV-OUTBOUND-CPS-CORP        PIC S9(9) COMP.              00940000
009500     05  PV-DISTHD-P2L-CORP          PIC S9(9) COMP.              00950000
009600     05  PV-SULBXF-P2L-CORP          PIC S9(9) COMP.              00960000
009700     05  PV-TOT-CTNS-RECEIVED-CORP   PIC S9(9) COMP.              00970000
009800     05  PV-TOT-CTNS-CHECKIN-CORP    PIC S9(9) COMP.              00980000
009900     05  PV-TOT-CTNS-PHYSICAL-CORP   PIC S9(9) COMP.              00990000
010000     05  PV-TOT-SML-CORP             PIC S9(9) COMP.              01000000
010100     05  PV-TOT-P2L-CORP             PIC S9(9) COMP.              01010000
010200 01  PV-PCT-FIELDS.                                               01020000
010300     05  PV-WORKING-PCT              PIC S9(9)V9999 COMP-3.       01030000
010400     05  PV-UCC128-PCT               PIC S9(9)V9 COMP-3.          01040000
010500     05  PV-PHYSICAL-PCT             PIC S9(9)V9 COMP-3.          01050000
010600     05  PV-SML-PCT                  PIC S9(9)V9 COMP-3.          01060000
010700     05  PV-SML-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01070000
010800     05  PV-SML-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01080000
010900     05  PV-SML-SMOOTHING-PCT        PIC S9(9)V9 COMP-3.          01090000
011000     05  PV-P2L-SML-PCT              PIC S9(9)V9 COMP-3.          01100000
011100     05  PV-P2L-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01110000
011200     05  PV-P2L-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01120000
011300 01  PV-DATE-FIELDS.                                              01130000
011400     05  PV-TODAYS-DATE.                                          01140000
011500         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01150000
011600         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01160000
011700         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01170000
011800     05  PV-TODAYS-TIME.                                          01180000
011900         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01190000
012000         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01200000
012100         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01210000
012200         10  FILLER                  PIC 9(02) VALUE ZERO.        01220000
012300     05  PV-COMPARE-DATE.                                         01230000
012400         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        01240000
012500         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        01250000
012600         10  FILLER                  PIC X(01) VALUE '-'.         01260000
012700         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        01270000
012800         10  FILLER                  PIC X(01) VALUE '-'.         01280000
012900         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        01290000
013000*                                                                 01300000
013100 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01310000
013200                                                 COMP SYNC.       01320000
013300*                                                                 01330000
013400******************************************************************01340000
013500*  DB2 FORMATTED MESSAGE AREA                                     01350000
013600******************************************************************01360000
013700     COPY DPWS004.                                                01370000
013800*                                                                 01380000
013900*    DATE CONTROL CARD                                            01390000
014000     COPY SURD032.                                                01400000
014100                                                                  01410000
014200     COPY SURD059.                                                01420000
014300*                                                                 01430000
014400******************************************************************01440000
014500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01450000
014600******************************************************************01460000
014700     COPY DPWS132O.                                               01470000
014800*                                                                 01480000
014900 01  HEADING-LINES.                                               01490000
015000     05  HEADING-LINE-1.                                          01500000
015100         10  FILLER                  PIC  X(42)    VALUE SPACES.  01510001
015200         10  HEAD1-PERIOD            PIC  X(07).                  01520000
015300         10  FILLER                  PIC  X(44)    VALUE          01530001
015410             ' - SEPHORA CARTONS SCAN BASED RECEIVED BY DC'.      01541001
015500         10  FILLER                  PIC  X(39)    VALUE SPACES.  01550001
015600*                                                                 01560000
015700     05  HEADING-LINE-2.                                          01570000
015800         10  FILLER                  PIC  X(51)    VALUE SPACES.  01580000
015900         10  FILLER                  PIC  X(05)    VALUE          01590000
016000             'FROM '.                                             01600000
016100         10  HEADING-2-FROM-DTE      PIC  X(10)    VALUE SPACES.  01610000
016200         10  FILLER                  PIC  X(04)    VALUE          01620000
016300             ' TO '.                                              01630000
016400         10  HEADING-2-TO-DTE        PIC  X(10)    VALUE SPACES.  01640000
016500         10  FILLER                  PIC  X(52)    VALUE SPACES.  01650000
016600*                                                                 01660000
016700     05  HEADING-LINE-3.                                          01670000
016800         10  FILLER                  PIC  X(32)    VALUE SPACES.  01680000
016900         10  FILLER                  PIC  X(05)    VALUE          01690000
017000             'TOTAL'.                                             01700000
017100         10  FILLER                  PIC  X(06)    VALUE SPACES.  01710000
017200         10  FILLER                  PIC  X(05)    VALUE          01720000
017300             'TOTAL'.                                             01730000
017400         10  FILLER                  PIC  X(06)    VALUE SPACES.  01740000
017500         10  FILLER                  PIC  X(05)    VALUE          01750000
017600             'TOTAL'.                                             01760000
017700         10  FILLER                  PIC  X(73)    VALUE SPACES.  01770000
017800*                                                                 01780000
017900     05  HEADING-LINE-4.                                          01790000
018000         10  FILLER                  PIC  X(31)    VALUE SPACES.  01800000
018100         10  FILLER                  PIC  X(07)    VALUE          01810000
018200             'CARTONS'.                                           01820000
018300         10  FILLER                  PIC  X(04)    VALUE SPACES.  01830000
018400         10  FILLER                  PIC  X(07)    VALUE          01840000
018500             'CARTONS'.                                           01850000
018600         10  FILLER                  PIC  X(04)    VALUE SPACES.  01860000
018700         10  FILLER                  PIC  X(07)    VALUE          01870000
018800             'CARTONS'.                                           01880000
018900* DMH    10  FILLER                  PIC  X(06)    VALUE SPACES.  01890000
019000         10  FILLER                  PIC  X(05)    VALUE SPACES.  01900000
019100         10  FILLER                  PIC  X(21)    VALUE          01910000
019200             '-------------- S M L '.                             01920000
019300         10  FILLER                  PIC  X(16)    VALUE          01930000
019400             '----------------'.                                  01940000
019500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01950000
019600         10  FILLER                  PIC  X(27)    VALUE          01960000
019700             '--------- P 2 L -----------'.                       01970000
019800         10  FILLER                  PIC  X        VALUE SPACE.   01980000
019900*                                                                 01990000
020000     05  HEADING-LINE-5.                                          02000000
020100         10  FILLER                  PIC  X(03)    VALUE          02010000
020200             ' DC'.                                               02020000
020300         10  FILLER                  PIC  X(28)    VALUE SPACES.  02030000
020400         10  FILLER                  PIC  X(08)    VALUE          02040000
020500             'RECEIVED'.                                          02050000
020600         10  FILLER                  PIC  X(03)    VALUE SPACES.  02060000
020700         10  FILLER                  PIC  X(07)    VALUE          02070000
020800             'CHECKIN'.                                           02080000
020900         10  FILLER                  PIC  X(04)    VALUE SPACES.  02090000
021000         10  FILLER                  PIC  X(08)    VALUE          02100000
021100             'PHYSICAL'.                                          02110000
021200* DMH    10  FILLER                  PIC  X(07)    VALUE SPACES.  02120000
021300         10  FILLER                  PIC  X(06)    VALUE SPACES.  02130000
021400         10  FILLER                  PIC  X(05)    VALUE          02140000
021500             'TOTAL'.                                             02150000
021600         10  FILLER                  PIC  X(03)    VALUE SPACES.  02160000
021700         10  FILLER                  PIC  X(07)    VALUE          02170000
021800             'CHECKIN'.                                           02180000
021900         10  FILLER                  PIC  X(02)    VALUE SPACES.  02190000
022000         10  FILLER                  PIC  X(08)    VALUE          02200000
022100             'PHYSICAL'.                                          02210000
022200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02220000
022300         10  FILLER                  PIC  X(09)    VALUE          02230000
022400             'SMOOTHING'.                                         02240000
022500         10  FILLER                  PIC  X(04)    VALUE SPACES.  02250000
022600         10  FILLER                  PIC  X(05)    VALUE          02260000
022700             'TOTAL'.                                             02270000
022800         10  FILLER                  PIC  X(03)    VALUE SPACES.  02280000
022900         10  FILLER                  PIC  X(07)    VALUE          02290000
023000             'CHECKIN'.                                           02300000
023100         10  FILLER                  PIC  X(02)    VALUE SPACES.  02310000
023200         10  FILLER                  PIC  X(08)    VALUE          02320000
023300             'PHYSICAL'.                                          02330000
023400         10  FILLER                  PIC  X        VALUE SPACE.   02340000
023500*                                                                 02350000
023600 01  DETAIL-LINES.                                                02360000
023700     05  DETAIL-LINE1.                                            02370000
023800         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.  02380000
023900         10  FILLER                 PIC  X(01)     VALUE SPACES.  02390000
024000         10  DL1-OPER-DESC          PIC  X(22)     VALUE SPACES.  02400000
024100         10  DL1-TOT-CARTN-RECVD    PIC  ZZZ,ZZZ,ZZ9.             02410000
024200         10  DL1-TOT-CARTN-CHCKIN   PIC  ZZZ,ZZZ,ZZ9.             02420000
024300         10  DL1-TOT-CARTN-PHYSCL   PIC  ZZZ,ZZZ,ZZ9.             02430000
024400* DMH    10  FILLER                 PIC  X(02)     VALUE SPACES.  02440000
024500         10  FILLER                 PIC  X(01)     VALUE SPACES.  02450000
024600         10  DL1-SML-TOTAL          PIC  ZZZ,ZZZ,ZZ9.             02460000
024700         10  DL1-SML-CKECKIN        PIC  ZZ,ZZZ,ZZ9.              02470000
024800         10  DL1-SML-PHYSICAL       PIC  ZZ,ZZZ,ZZ9.              02480000
024900         10  DL1-SML-SMOOTHING      PIC  ZZZZZ,ZZ9.               02490000
025000         10  DL1-P2L-TOTAL          PIC  ZZ,ZZZ,ZZ9.              02500000
025100         10  DL1-P2L-CHECKIN        PIC  ZZ,ZZZ,ZZ9.              02510000
025200         10  DL1-P2L-PHYSICAL       PIC  ZZ,ZZZ,ZZ9.              02520000
025300         10  FILLER                  PIC  X        VALUE SPACE.   02530000
025400*                                                                 02540000
025500     05  DETAIL-LINE2.                                            02550000
025600         10  FILLER                 PIC  X(44)     VALUE SPACES.  02560000
025700         10  DL2-TOT-CRT-CHKIN-PCT  PIC  ZZZ.9.                   02570000
025800         10  FILLER                 PIC  X(06)     VALUE SPACES.  02580000
025900         10  DL2-TOT-CRT-PHYSCL-PCT PIC  ZZZ.9.                   02590000
026000* DMH    10  FILLER                 PIC  X(08)     VALUE SPACES.  02600000
026100         10  FILLER                 PIC  X(07)     VALUE SPACES.  02610000
026200         10  DL2-SML-TOTAL-PCT      PIC  ZZZ.9.                   02620000
026300         10  FILLER                 PIC  X(05)     VALUE SPACES.  02630000
026400         10  DL2-SML-CKECKIN-PCT    PIC  ZZZ.9.                   02640000
026500         10  FILLER                 PIC  X(05)     VALUE SPACES.  02650000
026600         10  DL2-SML-PHYSICAL-PCT   PIC  ZZZ.9.                   02660000
026700         10  FILLER                 PIC  X(04)     VALUE SPACES.  02670000
026800         10  DL2-SML-SMOOTHING-PCT  PIC  ZZZ.9.                   02680000
026900         10  FILLER                 PIC  X(05)     VALUE SPACES.  02690000
027000         10  DL2-P2L-TOTAL-PCT      PIC  ZZZ.9.                   02700000
027100         10  FILLER                 PIC  X(05)     VALUE SPACES.  02710000
027200         10  DL2-P2L-CHECKIN-PCT    PIC  ZZZ.9.                   02720000
027300         10  FILLER                 PIC  X(05)     VALUE SPACES.  02730000
027400         10  DL2-P2L-PHYSICAL-PCT   PIC  ZZZ.9.                   02740000
027500         10  FILLER                  PIC  X        VALUE SPACE.   02750000
027600*                                                                 02760000
027700 01  MISCELLANEOUS-LINES.                                         02770000
027800     05  END-OF-REPORT-LINE.                                      02780000
027900         10  FILLER                  PIC  X(54)    VALUE SPACES.  02790000
028000         10  FILLER                  PIC  X(44)    VALUE          02800000
028100             '  ** END OF REPORT **                       '.      02810000
028200         10  FILLER                  PIC  X(44)    VALUE SPACES.  02820000
028300*                                                                 02830000
028400*                                                                 02840000
028500*DB2 AREA FOR XLT_LOC                                             02850000
028600     EXEC SQL                                                     02860000
028700          INCLUDE XLT00010                                        02870000
028800     END-EXEC.                                                    02880000
028900*                                                                 02890000
029000*                                                                 02900000
029100***************************************************************** 02910000
029200*  DB2 COMMUNICATION AREA                                         02920000
029300***************************************************************** 02930000
029400     EXEC SQL                                                     02940000
029500         INCLUDE SQLCA                                            02950000
029600     END-EXEC.                                                    02960000
029700                                                                  02970000
029800***************************************************************** 02980000
029900*  DB2 COMMUNICATION AREA2                                        02990000
030000***************************************************************** 03000000
030100     COPY SQLCA2.                                                 03010000
030200                                                                  03020000
030300                                                                  03030000
030400***************************************************************** 03040000
030500 PROCEDURE DIVISION.                                              03050000
030600*                                                                 03060000
030700 0000-MAINLINE-PROCESSING.                                        03070000
030800******************************************************************03080000
030900**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03090000
031000******************************************************************03100000
031100     DISPLAY '****** STARTING SUKRP079 ******'.                   03110000
031200*                                                                 03120000
031300*OPEN FILES.                                                      03130000
031400     OPEN INPUT  NEW-CONTROL-FILE                                 03140000
031500                 INPUT-FILE                                       03150000
031600          OUTPUT REPORT-FILE.                                     03160000
031700*                                                                 03170000
031800     PERFORM 1000-INITIALIZATION.                                 03180000
031900*                                                                 03190000
032000     PERFORM 1500-PAGE-BREAK.                                     03200000
032100     PERFORM 2000-PROCESS-DCS                                     03210000
032200         UNTIL PS-EOF-INPUT.                                      03220000
032300     PERFORM 2300-CORP-TOTALS.                                    03230000
032400                                                                  03240000
032500*                                                                 03250000
032600     CLOSE NEW-CONTROL-FILE                                       03260000
032700           REPORT-FILE                                            03270000
032800           INPUT-FILE.                                            03280000
032900     GOBACK.                                                      03290000
033000*                                                                 03300000
033100******************************************************************03310000
033200 1000-INITIALIZATION.                                             03320000
033300******************************************************************03330000
033400**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03340000
033500******************************************************************03350000
033600                                                                  03360000
033700     ACCEPT PV-TODAYS-DATE                                        03370000
033800       FROM DATE.                                                 03380000
033900*                                                                 03390000
034000     ACCEPT PV-TODAYS-TIME                                        03400000
034100       FROM TIME.                                                 03410000
034200*                                                                 03420000
034300     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  03430000
034400                                PV-COMPARE-DATE-MM.               03440000
034500     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    03450000
034600                                PV-COMPARE-DATE-DD.               03460000
034700     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   03470000
034800                                PV-COMPARE-DATE-YY.               03480000
034900     IF PV-COMPARE-DATE-YY  >  80                                 03490000
035000         MOVE  19            TO PV-COMPARE-DATE-CC                03500000
035100     ELSE                                                         03510000
035200         MOVE  20            TO PV-COMPARE-DATE-CC                03520000
035300     END-IF.                                                      03530000
035400*                                                                 03540000
035500     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  03550000
035600     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                03560000
035700*                                                                 03570000
035800     MOVE PC-SUKRP079        TO DP132O-PROGRAM-NAME.              03580000
035900     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             03590000
036000*                                                                 03600000
036100     MOVE +0                 TO PV-PAGE-COUNT.                    03610000
036200                                                                  03620000
036300     PERFORM 8000-READ-CONTROL-REC.                               03630000
036400     MOVE SU032-FROM-DATE      TO HEADING-2-FROM-DTE.             03640000
036500     MOVE SU032-TO-DATE        TO HEADING-2-TO-DTE.               03650000
036600     EVALUATE SU032-RPT-TYPE                                      03660000
036700         WHEN 'W'                                                 03670000
036800             MOVE '  WEEK '               TO HEAD1-PERIOD         03680000
036900         WHEN 'M'                                                 03690000
037000             MOVE ' MONTH '               TO HEAD1-PERIOD         03700000
037100         WHEN 'S'                                                 03710000
037200             MOVE 'SEASON '               TO HEAD1-PERIOD         03720000
037300         WHEN 'C'                                                 03730000
037400         WHEN 'F'                                                 03740000
037500             MOVE '  YEAR '               TO HEAD1-PERIOD         03750000
037600         WHEN 'T'                                                 03760000
037700             MOVE '   YTD '               TO HEAD1-PERIOD         03770000
037800         WHEN OTHER                                               03780000
037900             MOVE '1000-INITIALIZE'       TO PV-PARAGRAPH         03790000
038000             MOVE 'INVALID REPORT TYPE  ' TO PV-DB2-FUNCTION      03800000
038100             PERFORM 9100-SQL-ABEND                               03810000
038200     END-EVALUATE.                                                03820000
038300     INITIALIZE PV-DC-COUNTS                                      03830000
038400                PV-CORP-COUNTS.                                   03840000
038500*                                                                 03850000
038600******************************************************************03860000
038700**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03870000
038800**  PAGES (AS NEEDED).                                            03880000
038900******************************************************************03890000
039000 1500-PAGE-BREAK.                                                 03900000
039100*                                                                 03910000
039200     ADD +1                   TO PV-PAGE-COUNT.                   03920000
039300     MOVE PV-PAGE-COUNT       TO DP132O-PAGE-NUMBER.              03930000
039400*                                                                 03940000
039500     WRITE REPORT-RECORD                                          03950000
039600       FROM DP132O-STANDRD-HEADER-132-COLS                        03960000
039700         AFTER ADVANCING PAGE.                                    03970000
039800*                                                                 03980000
039900     WRITE REPORT-RECORD                                          03990000
040000       FROM HEADING-LINE-1                                        04000000
040100         AFTER ADVANCING 2 LINES.                                 04010000
040200*                                                                 04020000
040300     WRITE REPORT-RECORD                                          04030000
040400       FROM HEADING-LINE-2                                        04040000
040500         AFTER ADVANCING 1 LINE.                                  04050000
040600*                                                                 04060000
040700     WRITE REPORT-RECORD                                          04070000
040800       FROM HEADING-LINE-3                                        04080000
040900         AFTER ADVANCING 2 LINE.                                  04090000
041000*                                                                 04100000
041100     WRITE REPORT-RECORD                                          04110000
041200       FROM HEADING-LINE-4                                        04120000
041300         AFTER ADVANCING 1 LINE.                                  04130000
041400*                                                                 04140000
041500     WRITE REPORT-RECORD                                          04150000
041600       FROM HEADING-LINE-5                                        04160000
041700         AFTER ADVANCING 1 LINE.                                  04170000
041800*                                                                 04180000
041900     MOVE +6                 TO PV-LINE-COUNT.                    04190000
042000*                                                                 04200000
042100*                                                                 04210000
042200******************************************************************04220000
042300 2000-PROCESS-DCS.                                                04230000
042400     PERFORM 4000-READ-INPUT-RECORD                               04240000
042500       WITH TEST AFTER                                            04250000
042600       UNTIL                                                      04260000
042700        (SU059-DATE       = SU032-FROM-DATE OR                    04270000
042800         SU059-DATE       > SU032-FROM-DATE) AND                  04280000
042900        (SU059-DATE       < SU032-TO-DATE OR                      04290000
043000         SU059-DATE       = SU032-TO-DATE) OR                     04300000
043100        PS-EOF-INPUT.                                             04310000
043200                                                                  04320000
043300     IF (SU059-OPER-UNT-ID NOT = DK-STR-NBR) OR                   04330000
043400         PS-EOF-INPUT                                             04340000
043500         IF DK-STR-NBR > 0                                        04350000
043600             PERFORM 2200-CALCULATE-PERCENTAGES                   04360000
043700             PERFORM 3000-PRINT-DETAIL-LINE                       04370000
043800         END-IF                                                   04380000
043900         IF NOT PS-EOF-INPUT                                      04390000
044000             MOVE SU059-OPER-UNT-ID        TO DK-STR-NBR          04400000
044100             PERFORM 7000-SELECT-DC-NAME                          04410000
044200             INITIALIZE PV-DC-COUNTS                              04420000
044300         END-IF                                                   04430000
044400     END-IF.                                                      04440000
044500     IF NOT PS-EOF-INPUT                                          04450000
044600         PERFORM 2100-SUMM-DC                                     04460000
044700     END-IF.                                                      04470000
044800                                                                  04480000
044900*                                                                 04490000
045000 2100-SUMM-DC.                                                    04500000
045100     MOVE SU059-DATE               TO PV-DATE.                    04510000
045200     COMPUTE PV-TOT-CTNS-RECEIVED =                               04520000
045300             PV-TOT-CTNS-RECEIVED +                               04530000
045400             SU059-TOT-CTNS-RECEIVED.                             04540000
045500     COMPUTE PV-TOT-CTNS-CHECKIN =                                04550000
045600             PV-TOT-CTNS-CHECKIN +                                04560000
045700             SU059-TOT-CTNS-CHECKIN.                              04570000
045800     COMPUTE PV-TOT-CTNS-PHYSICAL =                               04580000
045900             PV-TOT-CTNS-PHYSICAL +                               04590000
046000             SU059-TOT-CTNS-PHYSICAL.                             04600000
046100     COMPUTE PV-TOT-SML =                                         04610000
046200             PV-TOT-SML +                                         04620000
046300             SU059-TOT-SML.                                       04630000
046400     COMPUTE PV-OUTBOUND-ASN =                                    04640000
046500             PV-OUTBOUND-ASN +                                    04650000
046600             SU059-OUTBOUND-ASN.                                  04660000
046700     COMPUTE PV-OUTBOUND-CPS =                                    04670000
046800             PV-OUTBOUND-CPS +                                    04680000
046900             SU059-OUTBOUND-CPS.                                  04690000
047000     COMPUTE PV-OUTBOUND-SMO =                                    04700000
047100             PV-OUTBOUND-SMO +                                    04710000
047200             SU059-OUTBOUND-SMO.                                  04720000
047300     COMPUTE PV-TOT-P2L =                                         04730000
047400             PV-TOT-P2L +                                         04740000
047500             SU059-TOT-P2L.                                       04750000
047600     COMPUTE PV-SULBXF-P2L =                                      04760000
047700             PV-SULBXF-P2L +                                      04770000
047800             SU059-SULBXF-P2L.                                    04780000
047900     COMPUTE PV-DISTHD-P2L =                                      04790000
048000             PV-DISTHD-P2L +                                      04800000
048100             SU059-DISTHD-P2L.                                    04810000
048200                                                                  04820000
048300 2200-CALCULATE-PERCENTAGES.                                      04830000
048400                                                                  04840000
048500     IF PV-TOT-CTNS-CHECKIN > 0 AND                               04850000
048600        PV-TOT-CTNS-RECEIVED > 0                                  04860000
048700         COMPUTE PV-WORKING-PCT =                                 04870000
048800                (PV-TOT-CTNS-CHECKIN /                            04880000
048900                 PV-TOT-CTNS-RECEIVED)                            04890000
049000         COMPUTE PV-UCC128-PCT ROUNDED =                          04900000
049100                 PV-WORKING-PCT * 100                             04910000
049200     ELSE                                                         04920000
049300         MOVE 0        TO PV-UCC128-PCT                           04930000
049400     END-IF.                                                      04940000
049500                                                                  04950000
049600     IF PV-TOT-CTNS-PHYSICAL > 0 AND                              04960000
049700        PV-TOT-CTNS-RECEIVED > 0                                  04970000
049800         COMPUTE PV-WORKING-PCT =                                 04980000
049900                (PV-TOT-CTNS-PHYSICAL /                           04990000
050000                 PV-TOT-CTNS-RECEIVED)                            05000000
050100         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        05010000
050200                 PV-WORKING-PCT * 100                             05020000
050300     ELSE                                                         05030000
050400         MOVE 0        TO PV-PHYSICAL-PCT                         05040000
050500     END-IF.                                                      05050000
050600                                                                  05060000
050700     IF PV-TOT-SML > 0 AND                                        05070000
050800        PV-TOT-CTNS-RECEIVED > 0                                  05080000
050900         COMPUTE PV-WORKING-PCT =                                 05090000
051000                (PV-TOT-SML /                                     05100000
051100                 PV-TOT-CTNS-RECEIVED)                            05110000
051200         COMPUTE PV-SML-PCT ROUNDED =                             05120000
051300                 PV-WORKING-PCT * 100                             05130000
051400     ELSE                                                         05140000
051500         MOVE 0        TO PV-SML-PCT                              05150000
051600     END-IF.                                                      05160000
051700                                                                  05170000
051800     IF PV-OUTBOUND-ASN > 0 AND                                   05180000
051900        PV-TOT-SML > 0                                            05190000
052000         COMPUTE PV-WORKING-PCT =                                 05200000
052100                (PV-OUTBOUND-ASN /                                05210000
052200                 PV-TOT-SML)                                      05220000
052300         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     05230000
052400                 PV-WORKING-PCT * 100                             05240000
052500     ELSE                                                         05250000
052600         MOVE 0        TO PV-SML-CHECKIN-PCT                      05260000
052700     END-IF.                                                      05270000
052800                                                                  05280000
052900     IF PV-OUTBOUND-CPS > 0 AND                                   05290000
053000        PV-TOT-SML > 0                                            05300000
053100         COMPUTE PV-WORKING-PCT =                                 05310000
053200                (PV-OUTBOUND-CPS /                                05320000
053300                 PV-TOT-SML)                                      05330000
053400         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    05340000
053500                 PV-WORKING-PCT * 100                             05350000
053600     ELSE                                                         05360000
053700         MOVE 0        TO PV-SML-PHYSICAL-PCT                     05370000
053800     END-IF.                                                      05380000
053900                                                                  05390000
054000     IF PV-OUTBOUND-SMO > 0 AND                                   05400000
054100        PV-TOT-SML > 0                                            05410000
054200         COMPUTE PV-WORKING-PCT =                                 05420000
054300                (PV-OUTBOUND-SMO /                                05430000
054400                 PV-TOT-SML)                                      05440000
054500         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   05450000
054600                 PV-WORKING-PCT * 100                             05460000
054700     ELSE                                                         05470000
054800         MOVE 0        TO PV-SML-SMOOTHING-PCT                    05480000
054900     END-IF.                                                      05490000
055000                                                                  05500000
055100     IF PV-TOT-P2L > 0 AND                                        05510000
055200        PV-TOT-CTNS-RECEIVED > 0                                  05520000
055300         COMPUTE PV-WORKING-PCT =                                 05530000
055400                (PV-TOT-P2L /                                     05540000
055500                 PV-TOT-CTNS-RECEIVED)                            05550000
055600         COMPUTE PV-P2L-SML-PCT ROUNDED =                         05560000
055700                 PV-WORKING-PCT * 100                             05570000
055800     ELSE                                                         05580000
055900         MOVE 0        TO PV-P2L-SML-PCT                          05590000
056000     END-IF.                                                      05600000
056100                                                                  05610000
056200     IF PV-SULBXF-P2L > 0 AND                                     05620000
056300        PV-TOT-P2L > 0                                            05630000
056400         COMPUTE PV-WORKING-PCT =                                 05640000
056500                (PV-SULBXF-P2L /                                  05650000
056600                 PV-TOT-P2L)                                      05660000
056700         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     05670000
056800                 PV-WORKING-PCT * 100                             05680000
056900     ELSE                                                         05690000
057000         MOVE 0        TO PV-P2L-CHECKIN-PCT                      05700000
057100     END-IF.                                                      05710000
057200                                                                  05720000
057300     IF PV-DISTHD-P2L > 0 AND                                     05730000
057400        PV-TOT-P2L > 0                                            05740000
057500         COMPUTE PV-WORKING-PCT =                                 05750000
057600                (PV-DISTHD-P2L /                                  05760000
057700                 PV-TOT-P2L)                                      05770000
057800         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    05780000
057900                 PV-WORKING-PCT * 100                             05790000
058000     ELSE                                                         05800000
058100         MOVE 0        TO PV-P2L-PHYSICAL-PCT                     05810000
058200     END-IF.                                                      05820000
058300                                                                  05830000
058400     COMPUTE PV-TOT-CTNS-RECEIVED-CORP =                          05840000
058500             PV-TOT-CTNS-RECEIVED-CORP +                          05850000
058600             PV-TOT-CTNS-RECEIVED.                                05860000
058700     COMPUTE PV-TOT-CTNS-CHECKIN-CORP =                           05870000
058800             PV-TOT-CTNS-CHECKIN-CORP +                           05880000
058900             PV-TOT-CTNS-CHECKIN.                                 05890000
059000     COMPUTE PV-TOT-CTNS-PHYSICAL-CORP =                          05900000
059100             PV-TOT-CTNS-PHYSICAL-CORP +                          05910000
059200             PV-TOT-CTNS-PHYSICAL.                                05920000
059300     COMPUTE PV-TOT-SML-CORP =                                    05930000
059400             PV-TOT-SML-CORP +                                    05940000
059500             PV-TOT-SML                                           05950000
059600     COMPUTE PV-TOT-P2L-CORP =                                    05960000
059700             PV-TOT-P2L-CORP +                                    05970000
059800             PV-TOT-P2L                                           05980000
059900     COMPUTE PV-OUTBOUND-SMO-CORP =                               05990000
060000             PV-OUTBOUND-SMO-CORP +                               06000000
060100             PV-OUTBOUND-SMO.                                     06010000
060200     COMPUTE PV-OUTBOUND-ASN-CORP =                               06020000
060300             PV-OUTBOUND-ASN-CORP +                               06030000
060400             PV-OUTBOUND-ASN.                                     06040000
060500     COMPUTE PV-OUTBOUND-CPS-CORP =                               06050000
060600             PV-OUTBOUND-CPS-CORP +                               06060000
060700             PV-OUTBOUND-CPS.                                     06070000
060800     COMPUTE PV-DISTHD-P2L-CORP =                                 06080000
060900             PV-DISTHD-P2L-CORP +                                 06090000
061000             PV-DISTHD-P2L.                                       06100000
061100     COMPUTE PV-SULBXF-P2L-CORP =                                 06110000
061200             PV-SULBXF-P2L-CORP +                                 06120000
061300             PV-SULBXF-P2L.                                       06130000
061400                                                                  06140000
061500 2300-CORP-TOTALS.                                                06150000
061600                                                                  06160000
061700     IF PV-TOT-CTNS-CHECKIN-CORP > 0 AND                          06170000
061800        PV-TOT-CTNS-RECEIVED-CORP > 0                             06180000
061900         COMPUTE PV-WORKING-PCT =                                 06190000
062000                (PV-TOT-CTNS-CHECKIN-CORP /                       06200000
062100                 PV-TOT-CTNS-RECEIVED-CORP)                       06210000
062200         COMPUTE PV-UCC128-PCT ROUNDED =                          06220000
062300                 PV-WORKING-PCT * 100                             06230000
062400     ELSE                                                         06240000
062500         MOVE 0        TO PV-UCC128-PCT                           06250000
062600     END-IF.                                                      06260000
062700                                                                  06270000
062800     IF PV-TOT-CTNS-PHYSICAL-CORP > 0 AND                         06280000
062900        PV-TOT-CTNS-RECEIVED-CORP > 0                             06290000
063000         COMPUTE PV-WORKING-PCT =                                 06300000
063100                (PV-TOT-CTNS-PHYSICAL-CORP /                      06310000
063200                 PV-TOT-CTNS-RECEIVED-CORP)                       06320000
063300         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        06330000
063400                 PV-WORKING-PCT * 100                             06340000
063500     ELSE                                                         06350000
063600         MOVE 0      TO PV-PHYSICAL-PCT                           06360000
063700     END-IF.                                                      06370000
063800                                                                  06380000
063900     IF PV-TOT-SML-CORP > 0 AND                                   06390000
064000        PV-TOT-CTNS-RECEIVED-CORP > 0                             06400000
064100         COMPUTE PV-WORKING-PCT =                                 06410000
064200                (PV-TOT-SML-CORP /                                06420000
064300                 PV-TOT-CTNS-RECEIVED-CORP)                       06430000
064400         COMPUTE PV-SML-PCT ROUNDED =                             06440000
064500                 PV-WORKING-PCT * 100                             06450000
064600     ELSE                                                         06460000
064700         MOVE 0    TO PV-SML-PCT                                  06470000
064800     END-IF.                                                      06480000
064900                                                                  06490000
065000     IF PV-OUTBOUND-ASN-CORP > 0 AND                              06500000
065100        PV-TOT-SML-CORP > 0                                       06510000
065200         COMPUTE PV-WORKING-PCT =                                 06520000
065300                (PV-OUTBOUND-ASN-CORP /                           06530000
065400                 PV-TOT-SML-CORP)                                 06540000
065500         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     06550000
065600                 PV-WORKING-PCT * 100                             06560000
065700     ELSE                                                         06570000
065800         MOVE 0    TO PV-SML-CHECKIN-PCT                          06580000
065900     END-IF.                                                      06590000
066000                                                                  06600000
066100     IF PV-OUTBOUND-CPS-CORP > 0 AND                              06610000
066200        PV-TOT-SML-CORP > 0                                       06620000
066300         COMPUTE PV-WORKING-PCT =                                 06630000
066400                (PV-OUTBOUND-CPS-CORP /                           06640000
066500                 PV-TOT-SML-CORP)                                 06650000
066600         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    06660000
066700                 PV-WORKING-PCT * 100                             06670000
066800     ELSE                                                         06680000
066900         MOVE 0    TO PV-SML-PHYSICAL-PCT                         06690000
067000     END-IF.                                                      06700000
067100                                                                  06710000
067200     IF PV-OUTBOUND-SMO-CORP > 0 AND                              06720000
067300        PV-TOT-SML-CORP > 0                                       06730000
067400         COMPUTE PV-WORKING-PCT =                                 06740000
067500                (PV-OUTBOUND-SMO-CORP /                           06750000
067600                 PV-TOT-SML-CORP)                                 06760000
067700         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   06770000
067800                 PV-WORKING-PCT * 100                             06780000
067900     ELSE                                                         06790000
068000         MOVE 0    TO PV-SML-SMOOTHING-PCT                        06800000
068100     END-IF.                                                      06810000
068200                                                                  06820000
068300     IF PV-TOT-P2L-CORP > 0 AND                                   06830000
068400        PV-TOT-CTNS-RECEIVED-CORP > 0                             06840000
068500         COMPUTE PV-WORKING-PCT =                                 06850000
068600                (PV-TOT-P2L-CORP /                                06860000
068700                 PV-TOT-CTNS-RECEIVED-CORP)                       06870000
068800         COMPUTE PV-P2L-SML-PCT ROUNDED =                         06880000
068900                 PV-WORKING-PCT * 100                             06890000
069000     ELSE                                                         06900000
069100         MOVE 0    TO PV-P2L-SML-PCT                              06910000
069200     END-IF.                                                      06920000
069300                                                                  06930000
069400     IF PV-SULBXF-P2L-CORP > 0 AND                                06940000
069500        PV-TOT-P2L-CORP > 0                                       06950000
069600         COMPUTE PV-WORKING-PCT =                                 06960000
069700                (PV-SULBXF-P2L-CORP /                             06970000
069800                 PV-TOT-P2L-CORP)                                 06980000
069900         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     06990000
070000                 PV-WORKING-PCT * 100                             07000000
070100     ELSE                                                         07010000
070200         MOVE 0    TO PV-P2L-CHECKIN-PCT                          07020000
070300     END-IF.                                                      07030000
070400                                                                  07040000
070500     IF PV-DISTHD-P2L-CORP > 0 AND                                07050000
070600        PV-TOT-P2L-CORP > 0                                       07060000
070700         COMPUTE PV-WORKING-PCT =                                 07070000
070800                (PV-DISTHD-P2L-CORP /                             07080000
070900                 PV-TOT-P2L-CORP)                                 07090000
071000         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    07100000
071100                 PV-WORKING-PCT * 100                             07110000
071200     ELSE                                                         07120000
071300         MOVE 0    TO PV-P2L-PHYSICAL-PCT                         07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
071600     ADD +1                  TO PV-LINE-COUNT                     07160000
071700     PERFORM 3100-PRINT-CORP-DETAIL-LINE.                         07170000
071800                                                                  07180000
071900*                                                                 07190000
072000******************************************************************07200000
072100 3000-PRINT-DETAIL-LINE.                                          07210000
072200*                                                                 07220000
072300     MOVE DK-STR-NBR               TO DL1-OPER-UNT.               07230000
072400     MOVE XLT00010-LOC-NM          TO DL1-OPER-DESC.              07240000
072500     MOVE PV-TOT-CTNS-RECEIVED     TO DL1-TOT-CARTN-RECVD.        07250000
072600     MOVE PV-TOT-CTNS-CHECKIN      TO DL1-TOT-CARTN-CHCKIN.       07260000
072700     MOVE PV-TOT-CTNS-PHYSICAL     TO DL1-TOT-CARTN-PHYSCL.       07270000
072800     MOVE PV-TOT-SML               TO DL1-SML-TOTAL.              07280000
072900     MOVE PV-OUTBOUND-ASN          TO DL1-SML-CKECKIN.            07290000
073000     MOVE PV-OUTBOUND-CPS          TO DL1-SML-PHYSICAL.           07300000
073100     MOVE PV-OUTBOUND-SMO          TO DL1-SML-SMOOTHING.          07310000
073200     MOVE PV-TOT-P2L               TO DL1-P2L-TOTAL.              07320000
073300     MOVE PV-SULBXF-P2L            TO DL1-P2L-CHECKIN.            07330000
073400     MOVE PV-DISTHD-P2L            TO DL1-P2L-PHYSICAL.           07340000
073500*                                                                 07350000
073600     MOVE PV-UCC128-PCT            TO DL2-TOT-CRT-CHKIN-PCT.      07360000
073700     MOVE PV-PHYSICAL-PCT          TO DL2-TOT-CRT-PHYSCL-PCT.     07370000
073800     MOVE PV-SML-PCT               TO DL2-SML-TOTAL-PCT.          07380000
073900     MOVE PV-SML-CHECKIN-PCT       TO DL2-SML-CKECKIN-PCT.        07390000
074000     MOVE PV-SML-PHYSICAL-PCT      TO DL2-SML-PHYSICAL-PCT.       07400000
074100     MOVE PV-SML-SMOOTHING-PCT     TO DL2-SML-SMOOTHING-PCT.      07410000
074200     MOVE PV-P2L-SML-PCT           TO DL2-P2L-TOTAL-PCT.          07420000
074300     MOVE PV-P2L-CHECKIN-PCT       TO DL2-P2L-CHECKIN-PCT.        07430000
074400     MOVE PV-P2L-PHYSICAL-PCT      TO DL2-P2L-PHYSICAL-PCT.       07440000
074500                                                                  07450000
074600*                                                                 07460000
074700     ADD +3 TO PV-LINE-COUNT.                                     07470000
074800     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07480000
074900         PERFORM 1500-PAGE-BREAK                                  07490000
075000     END-IF.                                                      07500000
075100*                                                                 07510000
075200     WRITE REPORT-RECORD                                          07520000
075300       FROM DETAIL-LINE1                                          07530000
075400         AFTER ADVANCING 2 LINE.                                  07540000
075500*                                                                 07550000
075600     WRITE REPORT-RECORD                                          07560000
075700       FROM DETAIL-LINE2                                          07570000
075800         AFTER ADVANCING 1 LINE.                                  07580000
075900*                                                                 07590000
076000*                                                                 07600000
076100******************************************************************07610000
076200 3100-PRINT-CORP-DETAIL-LINE.                                     07620000
076300*                                                                 07630000
076400     MOVE 0                         TO DL1-OPER-UNT.              07640000
076500     MOVE 'CORPORATE TOTALS'        TO DL1-OPER-DESC.             07650000
076600     MOVE PV-TOT-CTNS-RECEIVED-CORP TO DL1-TOT-CARTN-RECVD.       07660000
076700     MOVE PV-TOT-CTNS-CHECKIN-CORP  TO DL1-TOT-CARTN-CHCKIN.      07670000
076800     MOVE PV-TOT-CTNS-PHYSICAL-CORP TO DL1-TOT-CARTN-PHYSCL.      07680000
076900     MOVE PV-TOT-SML-CORP           TO DL1-SML-TOTAL.             07690000
077000     MOVE PV-OUTBOUND-ASN-CORP      TO DL1-SML-CKECKIN.           07700000
077100     MOVE PV-OUTBOUND-CPS-CORP      TO DL1-SML-PHYSICAL.          07710000
077200     MOVE PV-OUTBOUND-SMO-CORP      TO DL1-SML-SMOOTHING.         07720000
077300     MOVE PV-TOT-P2L-CORP           TO DL1-P2L-TOTAL.             07730000
077400     MOVE PV-SULBXF-P2L-CORP        TO DL1-P2L-CHECKIN.           07740000
077500     MOVE PV-DISTHD-P2L-CORP        TO DL1-P2L-PHYSICAL.          07750000
077600*                                                                 07760000
077700     MOVE PV-UCC128-PCT             TO DL2-TOT-CRT-CHKIN-PCT.     07770000
077800     MOVE PV-PHYSICAL-PCT           TO DL2-TOT-CRT-PHYSCL-PCT.    07780000
077900     MOVE PV-SML-PCT                TO DL2-SML-TOTAL-PCT.         07790000
078000     MOVE PV-SML-CHECKIN-PCT        TO DL2-SML-CKECKIN-PCT.       07800000
078100     MOVE PV-SML-PHYSICAL-PCT       TO DL2-SML-PHYSICAL-PCT.      07810000
078200     MOVE PV-SML-SMOOTHING-PCT      TO DL2-SML-SMOOTHING-PCT.     07820000
078300     MOVE PV-P2L-SML-PCT            TO DL2-P2L-TOTAL-PCT.         07830000
078400     MOVE PV-P2L-CHECKIN-PCT        TO DL2-P2L-CHECKIN-PCT.       07840000
078500     MOVE PV-P2L-PHYSICAL-PCT       TO DL2-P2L-PHYSICAL-PCT.      07850000
078600                                                                  07860000
078700*                                                                 07870000
078800     ADD +5 TO PV-LINE-COUNT.                                     07880000
078900     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07890000
079000         PERFORM 1500-PAGE-BREAK                                  07900000
079100     END-IF.                                                      07910000
079200*                                                                 07920000
079300     WRITE REPORT-RECORD                                          07930000
079400       FROM DETAIL-LINE1                                          07940000
079500         AFTER ADVANCING 2 LINES.                                 07950000
079600*                                                                 07960000
079700     WRITE REPORT-RECORD                                          07970000
079800       FROM DETAIL-LINE2                                          07980000
079900         AFTER ADVANCING 1 LINE.                                  07990000
080000*                                                                 08000000
080100     WRITE REPORT-RECORD                                          08010000
080200       FROM END-OF-REPORT-LINE                                    08020000
080300         AFTER ADVANCING 2 LINES.                                 08030000
080400                                                                  08040000
080500 4000-READ-INPUT-RECORD.                                          08050000
080600     READ INPUT-FILE                                              08060000
080700       INTO SU059-RECORD                                          08070000
080800         AT END                                                   08080000
080900             SET PS-EOF-INPUT         TO TRUE                     08090000
081000         NOT AT END                                               08100000
081100             CONTINUE                                             08110000
081200     END-READ.                                                    08120000
081300*                                                                 08130000
081400 7000-SELECT-DC-NAME.                                             08140000
081500                                                                  08150000
081600     EXEC SQL                                                     08160000
081700        SELECT  LOC_NM                                            08170000
081800          INTO  :XLT00010-LOC-NM                                  08180000
081900          FROM  XLT_LOC                                           08190000
082000         WHERE  LOC_NBR     = :DK-STR-NBR                         08200000
082100     END-EXEC.                                                    08210000
082200                                                                  08220000
082300     EVALUATE TRUE                                                08230000
082400         WHEN SQLCODE = +0                                        08240000
082500             CONTINUE                                             08250000
082600         WHEN SQLCODE < ZERO                                      08260000
082700         WHEN SQLCODE > ZERO                                      08270000
082800         WHEN SQLWARN0 NOT = SPACE                                08280000
082900             MOVE '7000-SELECT-DC-NAME'                           08290000
083000                                      TO PV-PARAGRAPH             08300000
083100             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08310000
083200             PERFORM 9100-SQL-ABEND                               08320000
083300     END-EVALUATE.                                                08330000
083400                                                                  08340000
083500                                                                  08350000
083600 8000-READ-CONTROL-REC.                                           08360000
083700                                                                  08370000
083800     READ NEW-CONTROL-FILE INTO                                   08380000
083900           SU032-DATE-CONTROL-REC                                 08390000
084000     AT END                                                       08400000
084100         CONTINUE                                                 08410000
084200     NOT AT END                                                   08420000
084300         DISPLAY 'DATE CONTROL CARD:'                             08430000
084400         DISPLAY SU032-DATE-CONTROL-REC                           08440000
084500         DISPLAY SPACES                                           08450000
084600     END-READ.                                                    08460000
084700                                                                  08470000
084800 9100-SQL-ABEND.                                                  08480000
084900     MOVE SQLCODE                     TO SQLCODE2.                08490000
085000     MOVE SQLERRD(3)                  TO SQLERRD3.                08500000
085100                                                                  08510000
085200     DISPLAY '** ABEND **         ** = SQLERROR'.                 08520000
085300     DISPLAY '** PROGRAM   ** = ' PC-SUKRP079.                    08530000
085400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08540000
085500     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08550000
085600                                                                  08560000
085700     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                08570000
085800     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                08580000
085900     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 08590000
086000     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                08600000
086100                                                                  08610000
086200                                                                  08620000
086300     MOVE +4013                       TO ABEND-CODE.              08630000
086400     CALL 'ILBOABN0' USING ABEND-CODE.                            08640000
