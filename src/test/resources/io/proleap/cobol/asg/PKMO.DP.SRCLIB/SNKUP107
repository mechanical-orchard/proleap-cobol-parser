000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SNKUP107.                                00050000
000600 AUTHOR.                 GERMAN BANDA.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            11-01-23.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL READ AN ODD CARTON UPDATE FILE-WRITE       * 00120000
001300*  AND UPDATE THE ASN TABLES BASED ON THE QUANTITIES FROM THE   * 00130000
001400*  IMPORT TABLES (TRT_IMPRT_CART)                               * 00140000
001410* TASNCAR - ASN CARTON TASNDTL - ASN DETAIL                     * 00141000
001411* TASNDTL - ASN DETAIL                                          * 00141100
001412* TASDTPL - ASN PO LINE ITEM TABLE                              * 00141200
001413***************************************************************** 00141300
001414* CHANGE HISTORY:                                               * 00141400
001415*    CHANGES                                                    * 00141500
001416*     MADE BY:                                                  * 00141600
001417*     DATE:                                                     * 00141700
001418*                                                               * 00141800
001419***************************************************************** 00141900
001420 ENVIRONMENT DIVISION.                                            00142000
001430***************************************************************** 00143000
001440                                                                  00144000
001450 CONFIGURATION SECTION.                                           00145000
001460                                                                  00146000
001470 SOURCE-COMPUTER.        IBM-3090.                                00147000
001480 OBJECT-COMPUTER.        IBM-3090.                                00148000
001490                                                                  00149000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT ASN-CARTON-UPD-INPUT                                  00190000
002000         ASSIGN TO INP01.                                         00200000
002100                                                                  00210000
002200                                                                  00220000
002300******************************************************************00230000
002400 DATA DIVISION.                                                   00240000
002500******************************************************************00250000
002600                                                                  00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900 FD  ASN-CARTON-UPD-INPUT                                         00290000
003000     RECORDING MODE IS F                                          00300000
003100     LABEL RECORDS ARE STANDARD                                   00310000
003200     RECORD CONTAINS 175 CHARACTERS                               00320000
003300     BLOCK CONTAINS 0  RECORDS.                                   00330000
003400                                                                  00340000
003500 01  ASN-CARTON-UPD-INPUT-REC        PIC  X(175).                 00350000
003600                                                                  00360000
003700                                                                  00370000
003800 WORKING-STORAGE SECTION.                                         00380000
003900                                                                  00390000
004000                                                                  00400000
004100 01  FILLER.                                                      00410000
004200     05  FILLER                      PIC  X(36)    VALUE          00420000
004300         ' ***** WORKING STORAGE PGM=SNKUP107 '.                  00430000
004400     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   00440000
004500     05  FILLER                      PIC  X(10)    VALUE          00450000
004600         ' LOCATION='.                                            00460000
004700     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00470000
004800     05  FILLER                      PIC  X(06)    VALUE          00480000
004900         ' *****'.                                                00490000
005000 EJECT                                                            00500000
005100 01  PROGRAM-SWITCHES.                                            00510000
005200     05 PS-EOF-SW                     PIC X(01) VALUE 'N'.        00520000
005300        88 PS-EOF                     VALUE 'Y'.                  00530000
005400        88 PS-NOT-EOF                 VALUE 'N'.                  00540000
005500 01  DK-DB2-KEYS.                                                 00550000
005600     05  DK-PO-NBR                    PIC S9(09)  COMP.           00560000
005700     05  DK-PO-NBR-CHAR               PIC X(08).                  00570000
005800     05  DK-SHIPT-UNT-ID              PIC S9(18)  COMP-3.         00580000
005900                                                                  00590000
006000 01  PC-CONSTANTS.                                                00600000
006100     05  PC-MAX-RETRIES              PIC S9(04)    VALUE  +3      00610000
006200                                                   COMP.          00620000
006300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00630000
006400                                                   'SNKUP107'.    00640000
006500     05  PC-0                        PIC S9(09)    COMP  VALUE 0. 00650000
006600     05  PC-PO                       PIC  X(02)    VALUE 'PO'.    00660000
006700                                                                  00670000
006800 01  PV-PROGRAM-VARIABLES.                                        00680000
006900     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       00690000
007000                                                   COMP SYNC.     00700000
007100     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(60)    VALUE SPACE.   00710000
007200     05  PV-DB2-OPERATION-ATTEMPT-2  PIC  X(60)    VALUE SPACE.   00720000
007300     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00730000
007400                                                   COMP SYNC.     00740000
007500     05  PV-SQL-CODE                 PIC  9(04)    VALUE ZERO.    00750000
007600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00760000
007700     05  PV-REC-IN-QTY               PIC 9(07)     VALUE ZEROES.  00770000
007800     05  PV-REC-CRTN-UPD-QTY         PIC 9(07)     VALUE ZEROES.  00780000
007900     05  PV-REC-DTPL-UPD-QTY         PIC 9(07)     VALUE ZEROES.  00790000
008000     05  PV-REC-NDTL-UPD-QTY         PIC 9(07)     VALUE ZEROES.  00800000
008100     05  PV-READ-COUNTER             PIC 9(07)     VALUE ZEROES.  00810000
008200*                                                                 00820000
008300     05  PV-PO-NUMBR                     PIC  X(09)  VALUE SPACES.00830000
008400     05  PV-PO-NUMBR-R REDEFINES PV-PO-NUMBR.                     00840000
008500         10  FILLER                      PIC  X(01).              00850000
008600         10  PV-PO-NUMBER                PIC  X(08).              00860000
008700*                                                                 00870000
008800     05  PV-LINE-NBR                     PIC  X(04)  VALUE SPACES.00880000
008900     05  PV-LINE-NBR-R REDEFINES PV-LINE-NBR.                     00890000
009000         10  FILLER                      PIC  9(01).              00900000
009100         10  PV-PO-LINE-NBR              PIC  9(03).              00910000
009110     05  PV-PREV-ASNHDR-ID               PIC  9(9).               00911002
009120     05  PV-PREV-PO-NBR                  PIC  9(9).               00912002
009130     05  PV-LOCATION                     PIC  9(4).               00913005
009200                                                                  00920000
009300*----------------------------------------------------------------*00930000
009400* ADDED PROGRAM VARIABLES.                            WR # 230ZZ *00940000
009500*----------------------------------------------------------------*00950000
009600     05  PV-TEMP-SKU-NBR             PIC 9(8)      VALUE ZEROES.  00960000
009700     05  PV-TEMP-DEPT-NBR            PIC X(3)      VALUE SPACES.  00970000
009800     05  PV-TEMP-SUB-CL-NBR          PIC X(2)      VALUE SPACES.  00980000
009900*----------------------------------------------------------------*00990000
009901* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *00990100
009902*----------------------------------------------------------------*00990200
009903                                                                  00990300
009904 01  ABEND-CODE                       PIC S9(04)     VALUE +0     00990400
009905                                                     COMP SYNC.   00990500
009906     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 00990600
009907     88  ABEND-4002-READ-ERROR                       VALUE +4002. 00990700
009908     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 00990800
009909     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 00990900
009910     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 00991000
009920     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 00992000
009930     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 00993000
009940     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 00994000
009950     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 00995000
009960     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00996000
009970                                                                  00997000
009980******************************************************************00998000
009990*    UPDATE CARTON FILE LAYOUT                                    00999000
010000******************************************************************01000000
010100     COPY SNRD008.                                                01010000
010200******************************************************************01020000
010300 EJECT                                                            01030000
010400*                                                                 01040000
010500*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                01050000
010600*                                                                 01060000
010700     EXEC SQL                                                     01070000
010800          INCLUDE TASNCAR                                         01080000
010900     END-EXEC.                                                    01090000
011000                                                                  01100000
011100*                                                                 01110000
011200*    DB2 DCLGEN FOR TASDTPL TABLE                                 01120000
011300*                                                                 01130000
011400     EXEC SQL                                                     01140000
011500          INCLUDE TASDTPL                                         01150000
011600     END-EXEC.                                                    01160000
011700                                                                  01170000
011800*                                                                 01180000
011900*    DB2 DCLGEN FOR TASNDTL TABLE                                 01190000
012000*                                                                 01200000
012100     EXEC SQL                                                     01210000
012200          INCLUDE TASNDTL                                         01220000
012300     END-EXEC.                                                    01230000
012400                                                                  01240000
012500*                                                                 01250000
012600*  COMMUNICATIONS AREA FOR DB2                                    01260000
012700*                                                                 01270000
012800     EXEC SQL                                                     01280000
012900         INCLUDE SQLCA                                            01290000
013000     END-EXEC.                                                    01300000
013100                                                                  01310000
013200******************************************************************01320000
013300*                                                                 01330000
013400* DB2 COMMUNICATION AREA 2                                        01340000
013500*                                                                 01350000
013600     COPY SQLCA2.                                                 01360000
013700                                                                  01370000
013800*                                                                 01380000
013900 EJECT                                                            01390000
014000***************************************************************** 01400000
014100* PROCEDURE DIVISION.                                           * 01410000
014200***************************************************************** 01420000
014300 PROCEDURE DIVISION.                                              01430000
014400                                                                  01440000
014500 0000-MAINLINE-PROCESSING.                                        01450000
014600     DISPLAY '**** START OF SNKUP107 ****'.                       01460000
014700     PERFORM 1000-INITIALIZE.                                     01470000
014800                                                                  01480000
014900                                                                  01490000
015000     PERFORM 2000-PROCESS-INPUT-RECORD                            01500000
015100         UNTIL PS-EOF.                                            01510000
015200                                                                  01520000
015300                                                                  01530000
015400     DISPLAY ' ** RECORDS READ          ==> ' PV-REC-IN-QTY.      01540000
015500     DISPLAY ' ** CRTN RECORDS UPDATED  ==> ' PV-REC-CRTN-UPD-QTY.01550000
015600     DISPLAY ' ** SDTPL RECORDS UPDATED ==> ' PV-REC-DTPL-UPD-QTY.01560000
015700     DISPLAY ' ** SNDTL RECORDS UPDATED ==> ' PV-REC-NDTL-UPD-QTY.01570000
015800                                                                  01580000
015900     CLOSE  ASN-CARTON-UPD-INPUT.                                 01590000
016000                                                                  01600000
016100     DISPLAY '****  END OF SNKUP107  ****'.                       01610000
016200                                                                  01620000
016300 0000-EXIT.  STOP RUN.                                            01630000
016400                                                                  01640000
016500 1000-INITIALIZE.                                                 01650000
016600       OPEN INPUT  ASN-CARTON-UPD-INPUT.                          01660000
016700       MOVE ZEROES TO PV-REC-IN-QTY                               01670000
016800                      PV-REC-CRTN-UPD-QTY                         01680000
016900                      PV-REC-NDTL-UPD-QTY                         01690002
016910                      PV-PREV-ASNHDR-ID                           01691003
016920                      PV-PREV-PO-NBR                              01692003
016930                      PV-LOCATION.                                01693005
017000                                                                  01700000
017100       PERFORM 8000-READ-ASN-CARTON-FILE.                         01710000
017200                                                                  01720000
017300 2000-PROCESS-INPUT-RECORD.                                       01730000
017400      ADD 1 TO PV-REC-IN-QTY.                                     01740000
017500                                                                  01750000
017600      MOVE SN008-ASNHDR-ID     TO  ASNCAR-ASNHDR-ID               01760000
017700                                   ASDTPL-ASNHDR-ID               01770000
017800                                   ASNDTL-ASNHDR-ID               01780000
017900      MOVE SN008-CARTON-NBR    TO  ASNCAR-ASNCAR-NBR              01790000
018000      MOVE SN008-IMPRT-UNT-QTY TO  ASNCAR-PKG-QTY                 01800000
018100                                   ASNCAR-PKG-SIZE-QTY            01810000
018200      MOVE SN008-LINE-TOT-QTY  TO  ASDTPL-ASSOC-QTY               01820004
018300                                   ASNDTL-SHIPT-QTY               01830000
018400      MOVE SN008-LOCATION      TO  ASNCAR-LOC-NBR                 01840000
018500      MOVE SN008-LNE-NBR       TO  PV-LINE-NBR                    01850000
018600      MOVE PV-PO-LINE-NBR      TO  ASDTPL-PO-LN-NBR               01860000
018700      MOVE SN008-PO-NBR        TO  PV-PO-NUMBR                    01870000
018800      MOVE PV-PO-NUMBER        TO  ASDTPL-PO-NBR                  01880000
018900                                   ASNDTL-PO-NBR                  01890000
019000      MOVE SN008-UPC-NBR       TO  ASNDTL-UPC-NBR                 01900000
019100      PERFORM 3000-UPDATE-TASNCAR                                 01910000
019110      IF ((SN008-ASNHDR-ID =  PV-PREV-ASNHDR-ID) AND              01911002
019120          (SN008-PO-NBR    = PV-PREV-PO-NBR ) AND                 01912007
019140          (SN008-LOCATION  = PV-LOCATION ))                       01914007
019150         CONTINUE                                                 01915002
019160      ELSE                                                        01916002
019200         PERFORM 3200-UPDATE-TASDTPL                              01920001
019300         PERFORM 3400-UPDATE-TASNDTL                              01930001
019301         MOVE SN008-ASNHDR-ID TO PV-PREV-ASNHDR-ID                01930102
019302         MOVE SN008-PO-NBR    TO PV-PREV-PO-NBR                   01930202
019303         MOVE SN008-LOCATION  TO PV-LOCATION                      01930305
019310      END-IF                                                      01931001
019320                                                                  01932001
019400      PERFORM 8000-READ-ASN-CARTON-FILE.                          01940000
019500**************************************************************    01950000
019600*   UPDATE ASN CARTON TABLE                                       01960000
019700**************************************************************    01970000
019800 3000-UPDATE-TASNCAR.                                             01980000
019900     MOVE '3000-UPDATE-TASNCAR'  TO PV-ABEND-PARAGRAPH.           01990000
020000                                                                  02000000
020100     EXEC SQL                                                     02010000
020200       UPDATE TASNCAR                                             02020000
020300          SET PKG_QTY      = :ASNCAR-PKG-QTY                      02030000
020400           ,  PKG_SIZE_QTY = :ASNCAR-PKG-SIZE-QTY                 02040000
020500        WHERE ASNHDR_ID    = :ASNCAR-ASNHDR-ID                    02050000
020600          AND ASNCAR_NBR   = :ASNCAR-ASNCAR-NBR                   02060000
020700     END-EXEC                                                     02070000
020800                                                                  02080000
020900     EVALUATE TRUE                                                02090000
021000         WHEN SQLCODE = ZERO                                      02100000
021100             ADD 1 TO PV-REC-CRTN-UPD-QTY                         02110000
021200                                                                  02120000
021300         WHEN SQLCODE = +100                                      02130000
021400             DISPLAY '**************************************'     02140000
021500             DISPLAY 'CARTON NOT FOUND '                          02150000
021600             DISPLAY 'ASNCAR-ASNHDR-ID ' ASNCAR-ASNHDR-ID         02160000
021700             DISPLAY 'ASNCAR-ASNCAR-NBR' ASNCAR-ASNCAR-NBR        02170000
021800             DISPLAY 'ASNCAR-LOC-NBR   ' ASNCAR-LOC-NBR           02180000
021900             DISPLAY 'ASNCAR-PKG-QTY   ' ASNCAR-PKG-QTY           02190000
022000             DISPLAY '**********************************'         02200000
022100         WHEN SQLCODE = -803                                      02210000
022200             DISPLAY '**************************************'     02220000
022300             DISPLAY 'DUPLICATE CARTN'                            02230000
022400             DISPLAY 'ASNCAR-ASNHDR-ID ' ASNCAR-ASNHDR-ID         02240000
022500             DISPLAY 'ASNCAR-ASNCAR-NBR' ASNCAR-ASNCAR-NBR        02250000
022600             DISPLAY 'ASNCAR-LOC-NBR   ' ASNCAR-LOC-NBR           02260000
022700             DISPLAY 'ASNCAR-PKG-QTY   ' ASNCAR-PKG-QTY           02270000
022800             DISPLAY '**********************************'         02280000
022900                                                                  02290000
023000         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  02300000
023100             DISPLAY '**************************************'     02310000
023200             DISPLAY 'WARNING ISSUED ON UPDATE OF TASNCAR   '     02320000
023300             DISPLAY 'SN008-PO-NBR:  '                            02330000
023400                      SN008-PO-NBR                                02340000
023500             DISPLAY 'SN008-CARTON-NBR:  '                        02350000
023600                      SN008-CARTON-NBR                            02360000
023700             DISPLAY '**********************************'         02370000
023800             PERFORM 9800-SQL-WARNING                             02380000
023900                                                                  02390000
024000         WHEN SQLCODE < ZERO                                      02400000
024100             DISPLAY '**************************************'     02410000
024200             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNCAR     '     02420000
024300             DISPLAY 'SN008-PO-NBR:  '                            02430000
024400                      SN008-PO-NBR                                02440000
024500             DISPLAY 'SN008-CARTON-NBR:  '                        02450000
024600                      SN008-CARTON-NBR                            02460000
024700             DISPLAY '**************************************'     02470000
024800             PERFORM 9900-SQL-ERROR                               02480000
024900                                                                  02490000
025000     END-EVALUATE.                                                02500000
025100                                                                  02510000
025200*                                                                 02520000
025300**************************************************************    02530000
025400*   UPDATE ASN PO LINE ABLE                                       02540000
025500**************************************************************    02550000
025600 3200-UPDATE-TASDTPL.                                             02560000
025700     MOVE '3200-UPDATE-TASDTPL'  TO PV-ABEND-PARAGRAPH.           02570000
025800                                                                  02580000
025900     EXEC SQL                                                     02590000
026000         UPDATE TASDTPL                                           02600000
026100            SET ASSOC_QTY   =  :ASDTPL-ASSOC-QTY                  02610000
026200          WHERE ASNHDR_ID    = :ASDTPL-ASNHDR-ID                  02620000
026300            AND PO_LN_NBR    = :ASDTPL-PO-LN-NBR                  02630000
026400            AND PO_NBR       = :ASDTPL-PO-NBR                     02640000
026500     END-EXEC                                                     02650000
026600                                                                  02660000
026700     EVALUATE TRUE                                                02670000
026800         WHEN SQLCODE = ZERO                                      02680000
026900             ADD 1 TO PV-REC-DTPL-UPD-QTY                         02690000
027000         WHEN SQLCODE = +100                                      02700000
027100             DISPLAY '**************************************'     02710000
027200             DISPLAY 'TASDTPL NOT FOUND '                         02720000
027300             DISPLAY 'ASDTPL-ASNHDR-ID' ASDTPL-ASNHDR-ID          02730000
027400             DISPLAY 'ASDTPL-PO-NBR   ' ASDTPL-PO-NBR             02740000
027500             DISPLAY 'ASDTPL-PO-LN-NBR' ASDTPL-PO-LN-NBR          02750000
027600             DISPLAY 'ASDTPL-ASSOC-QTY' ASDTPL-ASSOC-QTY          02760000
027700                                                                  02770000
027800         WHEN SQLCODE = -803                                      02780000
027900             DISPLAY '**************************************'     02790000
028000             DISPLAY 'DUPLICATE TASDTPL'                          02800000
028100             DISPLAY 'ASDTPL-ASNHDR-ID' ASDTPL-ASNHDR-ID          02810000
028200             DISPLAY 'ASDTPL-PO-NBR   ' ASDTPL-PO-NBR             02820000
028300             DISPLAY 'ASDTPL-PO-LN-NBR' ASDTPL-PO-LN-NBR          02830000
028400             DISPLAY 'ASDTPL-ASSOC-QTY' ASDTPL-ASSOC-QTY          02840000
028500                                                                  02850000
028600         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  02860000
028700             DISPLAY '**************************************'     02870000
028800             DISPLAY 'WARNING ISSUED ON UPDATE OF TASDTPL   '     02880000
028900             DISPLAY 'ASDTPL-ASNHDR-ID' ASDTPL-ASNHDR-ID          02890000
029000             DISPLAY 'ASDTPL-PO-NBR   ' ASDTPL-PO-NBR             02900000
029100             DISPLAY 'ASDTPL-PO-LN-NBR' ASDTPL-PO-LN-NBR          02910000
029200             DISPLAY 'ASDTPL-ASSOC-QTY' ASDTPL-ASSOC-QTY          02920000
029300             DISPLAY '**********************************'         02930000
029400             PERFORM 9800-SQL-WARNING                             02940000
029500                                                                  02950000
029600         WHEN SQLCODE < ZERO                                      02960000
029700             DISPLAY '**************************************'     02970000
029800             DISPLAY 'ERROR ISSUED ON UPDATE OF TASDTPL     '     02980000
029900             DISPLAY 'ASDTPL-ASNHDR-ID' ASDTPL-ASNHDR-ID          02990000
030000             DISPLAY 'ASDTPL-PO-NBR   ' ASDTPL-PO-NBR             03000000
030100             DISPLAY 'ASDTPL-PO-LN-NBR' ASDTPL-PO-LN-NBR          03010000
030200             DISPLAY 'ASDTPL-ASSOC-QTY' ASDTPL-ASSOC-QTY          03020000
030300             DISPLAY '**************************************'     03030000
030400             PERFORM 9900-SQL-ERROR                               03040000
030500                                                                  03050000
030600     END-EVALUATE.                                                03060000
030700                                                                  03070000
030800*                                                                 03080000
030900**************************************************************    03090000
031000*   UPDATE ASN DETAIL TABLE                                       03100000
031100**************************************************************    03110000
031200*                                                                 03120000
031300 3400-UPDATE-TASNDTL.                                             03130000
031400     MOVE '3400-UPDATE-TASNDTL'  TO PV-ABEND-PARAGRAPH.           03140000
031500                                                                  03150000
031600                                                                  03160000
031700     EXEC SQL                                                     03170000
031800         UPDATE TASNDTL                                           03180000
031900            SET SHIPT_QTY   =  :ASNDTL-SHIPT-QTY                  03190000
032000          WHERE ASNHDR_ID    = :ASNDTL-ASNHDR-ID                  03200000
032100            AND UPC_NBR      = :ASNDTL-UPC-NBR                    03210000
032200            AND PO_NBR       = :ASNDTL-PO-NBR                     03220000
032300     END-EXEC                                                     03230000
032400                                                                  03240000
032500     EVALUATE TRUE                                                03250000
032600         WHEN SQLCODE = ZERO                                      03260000
032700             ADD 1 TO PV-REC-NDTL-UPD-QTY                         03270000
032800         WHEN SQLCODE = +100                                      03280000
032900             DISPLAY 'ASNDTL NOT FOUND' ASNDTL-ASNHDR-ID          03290000
033000         WHEN SQLCODE = -803                                      03300000
033100             DISPLAY '**************************************'     03310000
033200             DISPLAY 'DUPLICATE LINE '                            03320000
033300             DISPLAY 'SN008-PO-NBR:  '                            03330000
033400                      SN008-PO-NBR                                03340000
033500             DISPLAY 'ASNDTL-ASNHDR-ID:  '                        03350000
033600                      ASNDTL-ASNHDR-ID                            03360000
033700             DISPLAY 'PO LINE NUMBER:  ' ASNDTL-PO-NBR            03370000
033800             DISPLAY '**********************************'         03380000
033900                                                                  03390000
034000         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  03400000
034100             DISPLAY '**************************************'     03410000
034200             DISPLAY 'WARNING ISSUED ON UPDATE OF TASDTPL   '     03420000
034300             DISPLAY 'ASNDTL-SHIPT-QTY' ASNDTL-SHIPT-QTY          03430000
034400             DISPLAY 'ASNDTL-ASNHDR-ID' ASNDTL-ASNHDR-ID          03440000
034500             DISPLAY 'ASNDTL-UPC-NBR ' ASNDTL-UPC-NBR             03450000
034600             DISPLAY 'ASNDTL-PO-NBR   '  ASNDTL-PO-NBR            03460000
034700             DISPLAY '**********************************'         03470000
034800             PERFORM 9800-SQL-WARNING                             03480000
034900                                                                  03490000
035000         WHEN SQLCODE < ZERO                                      03500000
035100             DISPLAY '**************************************'     03510000
035200             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNDTL     '     03520000
035300             DISPLAY 'ASNDTL-SHIPT-QTY' ASNDTL-SHIPT-QTY          03530000
035400             DISPLAY 'ASNDTL-ASNHDR-ID' ASNDTL-ASNHDR-ID          03540000
035500             DISPLAY 'ASNDTL-UPC-NBR ' ASNDTL-UPC-NBR             03550000
035600             DISPLAY 'ASNDTL-PO-NBR   '  ASNDTL-PO-NBR            03560000
035700             DISPLAY '**************************************'     03570000
035800             PERFORM 9900-SQL-ERROR                               03580000
035900                                                                  03590000
036000     END-EVALUATE.                                                03600000
036100                                                                  03610000
036200*                                                                 03620000
036300 8000-READ-ASN-CARTON-FILE.                                       03630000
036400      INITIALIZE SN008-ASN-UPD-RECORD                             03640000
036500                                                                  03650000
036600      READ ASN-CARTON-UPD-INPUT                                   03660000
036700         INTO SN008-ASN-UPD-RECORD                                03670000
036800           AT END                                                 03680000
036900              SET PS-EOF   TO TRUE                                03690000
037000           NOT AT END                                             03700000
037100              ADD +1 TO PV-READ-COUNTER                           03710000
037200      END-READ.                                                   03720000
037300******************************************************************03730000
037400 9100-SQL-ABEND.                                                  03740000
037500******************************************************************03750000
037600*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    03760000
037700*  ERROR OR WARNING CODE OCCURS.                                  03770000
037800******************************************************************03780000
037900     DISPLAY '9100-SQL-ABEND'.                                    03790000
038000     DISPLAY '** ABEND     **'.                                   03800000
038100     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        03810000
038200     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             03820000
038300     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     03830000
038400     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPT-2.     03840000
038500     DISPLAY '** PO-NBR    ** = ' SN008-PO-NBR                    03850000
038600     MOVE SQLCODE TO PV-SQL-CODE.                                 03860000
038700     DISPLAY '** SQL CODE  ** = ' PV-SQL-CODE.                    03870000
038800     MOVE +4013 TO PV-ABEND-CODE.                                 03880000
038900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03890000
039000                                                                  03900000
039100 9800-SQL-WARNING.                                                03910000
039200                                                                  03920000
039300      MOVE SQLCODE               TO SQLCODE2.                     03930000
039400      MOVE SQLERRD(3)            TO SQLERRD3.                     03940000
039500      DISPLAY '** ABEND **       ** = SQLWARNING'.                03950000
039600      DISPLAY '** PROGRAM        ** = SNKUP107'.                  03960000
039700      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       03970000
039800      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 03980000
039900      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 03990000
040000      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 04000000
040100      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 04010000
040200      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 04020000
040300      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 04030000
040400      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 04040000
040500      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 04050000
040600      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 04060000
040700      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 04070000
040800                                                                  04080000
040900      SET ABEND-4013-DB2-ERROR   TO TRUE                          04090000
041000      CALL 'ILBOABN0' USING ABEND-CODE.                           04100000
041100 9900-SQL-ERROR.                                                  04110000
041200                                                                  04120000
041300      MOVE SQLCODE               TO SQLCODE2.                     04130000
041400      MOVE SQLERRD(3)            TO SQLERRD3.                     04140000
041500      DISPLAY '** ABEND **       ** = SQLERROR'.                  04150000
041600      DISPLAY '** PROGRAM        ** = SNKUP107'.                  04160000
041700      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       04170000
041800      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 04180000
041900      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 04190000
042000      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  04200000
042100      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 04210000
042200                                                                  04220000
042300      SET ABEND-4013-DB2-ERROR   TO TRUE                          04230000
042400      CALL 'ILBOABN0' USING ABEND-CODE.                           04240000
