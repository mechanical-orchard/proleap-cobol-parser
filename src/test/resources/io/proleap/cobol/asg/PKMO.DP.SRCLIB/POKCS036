000100*-----------------------*                                         00010052
000200 IDENTIFICATION DIVISION.                                         00020052
000300*-----------------------*                                         00030052
000400 PROGRAM-ID.    POKCS036.                                         00040052
000500 AUTHOR.        DOUG NOLTNER - STRATAGEM.                         00050052
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060052
000700 DATE-WRITTEN.  09/93.                                            00070052
000800 DATE-COMPILED.                                                   00080052
000900                                                                  00090052
001000*---------------------------------------------------------------* 00100052
001100*    W036 - PURCHASE ITEM ALLOCATION INQUIRY                    * 00110052
001200*                                                               * 00120052
001300*    THIS PROGRAM DISPLAYS STORE ALLOCATIONS FOR                * 00130052
001400*    A PURCHASE ORDER LINE ITEM.                                * 00140052
001500*                                                               * 00150052
001600*---------------------------------------------------------------* 00160052
001700*                                                               * 00170052
001800*    CHANGED TO REPLACE TALLPLN.PLAN_TMST WITH A DUMMY TIMESTAMP* 00180052
001900*    IN THE AR-CSR CURSOR.  ONLY RECITEM-VERFYD-TMST OBTAINED   * 00190052
002000*    FROM TRECITM ROWS IN THE CURSOR UNION IS BEING USED.       * 00200052
002100*                                                               * 00210052
002200*    PAUL KEBER - STRATAGEM    04/18/95    WR# 3338             * 00220052
002300*---------------------------------------------------------------* 00230052
002400***************************************************************** 00240052
002500* DATE     WHO      DESCRIPTION                                 * 00250052
002600* 011701   TKMA537  WR #21643, E-COMMERCE EDITS                 * 00260052
002700*                   ADDED CODE TO HIGHLIGHT WEB ITEMS IN RED    * 00270052
003000***************************************************************** 00280052
W24803* 04/25/03 - RAMAKRISHNA PRASAD V,IGSI -   WR NO.24803           *00290052
W24803*    - IN MAP POKM036 REPLACED DEPARTMENT, CLASS AND             *00300052
W24803*      SEQUENCE NUMBER BY DEPARTMENT, MAJOR CLASS, SUB CLASS     *00310052
W24803*      AND SKU NUMBER.                                           *00320052
W24803*    - IN THE COPYBOOK POWS070, DEPARTMENT, CLASS AND SEQUENCE   *00330052
W24803*      NUMBER WERE REPLACED WITH DEPARTMENT, MAJOR CLASS, SUB    *00340052
W24803*      CLASS AND SKU NUMBER.                                     *00350052
W24803*    - CHANGED THE PARA NAME 4450-CHECK-TWEBUPC TO               *00360052
W24803*      4450-CHECK-TWEBITM                                        *00370052
W24803*    - REPLACED ALL REFERENCES TO TSK                            *00380052
W24803*      WITH XLT_SKU, XLT_VND_STYL TABLES                         *00390052
W24803*    - REPLACED DEPARTMENT, CLASS AND 3 DIGIT SEQUENCE NUMBER    *00400052
W24803*      WITH DEPARTMENT, SUB CLASS, MAJOR CLASS AND SKU NUMBER    *00410052
W24803*    - ADDED A NEW FILLER FIELD WITH SIZE 1134 BYTES AFTER THE   *00420052
W24803*      STRUCTURE ASC-SPECIFIC-COMMAREA                           *00430052
W24803*    - TUPCPLS AND TWEBITM IN 4450-CHECK-WEBITM PARAGRAPH IS NOT *00440052
W24803*      REPLACED BY LOGISTICS DOMAIN TABLES BECAUSE OF PERFORMANCE*00450052
W24803*      ISSUES.                                                   *00460052
W24803******************************************************************00470052
C98147* 11/20/14 - LINDA FRIESS              -   CHG0098147             00480065
C98147*    - EXPANDED PO NUMBER TO 8 DIGITS IN MAP                      00490067
C98147*    - INCLUDES NEW POWS070 COPYBOOK WITH EXPANDED PO NUMBER      00500067
C98147******************************************************************00510065
263126*    CHANGED 10/27/2021    BY JIM HUNTER      WR: CHG0263126      00511068
263126*    CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE  00512068
263126*    MAKING THE CALL DYNAMIC VS STATIC.                           00513068
263126******************************************************************00514068
CICS  *  CHANGED 11/11/2022    BY BARB SCHULTZ    WR: CHG0278485        00515070
CICS  *                                                                 00516069
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     00517069
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      00517169
CICS  ******************************************************************00518069
002500*--------------------*                                            00520052
002600 ENVIRONMENT DIVISION.                                            00530052
002700*--------------------*                                            00540052
002800                                                                  00550052
002900*-------------*                                                   00560052
003000 DATA DIVISION.                                                   00570052
003100*-------------*                                                   00580052
003200                                                                  00590052
003300 WORKING-STORAGE SECTION.                                         00600052
003400                                                                  00610052
003300 01  DK-DB2-KEYS.                                                 00620052
003600     05  DK-PO-LNE-NBR                PIC S9(09) VALUE +0         00630052
003700                                                 COMP.            00640052
003500 01  PC-PROGRAM-CONSTANTS.                                        00650052
003600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00660052
003700                                                    'PO036A  '.   00670052
003800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00680052
003900                                                    'POKM036 '.   00690052
004000     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00700052
004100                                                    'POKCS036'.   00710052
004200     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00720052
004300     05  PC-NON-SELECT-FORMAT           PIC  X(01)  VALUE '1'.    00730052
004400     05  PC-INTER-APPL-PKSL             PIC  X(01)  VALUE '2'.    00740052
004500     05  PC-INTER-APPL-SKU-RCVR         PIC  X(01)  VALUE '3'.    00750052
004600     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00760052
004700                                                    COMP SYNC.    00770052
004800     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00780052
004900                                                    COMP SYNC.    00790052
005000     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00800052
005100                                                    +1000000      00810052
005200                                                    COMP-3.       00820052
005300     05  PC-ITM-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00830052
005400                                                    COMP SYNC.    00840052
005500     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00850052
005600                                                    COMP-3.       00860052
005700     05  PC-TSYMSG-NUMBERS.                                       00870052
005800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00880052
005900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00890052
006000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00900052
006100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00910052
006200         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  00920052
006300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00930052
006400         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00940052
006500         10  PC-TSYMSG-00610            PIC  9(05)  VALUE 00610.  00950052
006510         10  PC-TSYMSG-00994            PIC  9(05)  VALUE 00994.  00960052
006600*                                                                 00970052
006700 01  PS-PROGRAM-SWITCHES.                                         00980052
006800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00990052
006900         88  PS-NO-ERROR                            VALUE 'Y'.    01000052
007000         88  PS-ERROR                               VALUE 'N'.    01010052
007100     05  PS-EOF-DATE-CSR-SW             PIC  X(01)  VALUE 'N'.    01020052
007200         88  PS-EOF-DATE-CSR                        VALUE 'Y'.    01030052
007300         88  PS-NOT-EOF-DATE-CSR                    VALUE 'N'.    01040052
007400     05  PS-EOF-DC-CSR-SW               PIC  X(01)  VALUE 'N'.    01050052
007500         88  PS-EOF-DC-CSR                          VALUE 'Y'.    01060052
007600         88  PS-NOT-EOF-DC-CSR                      VALUE 'N'.    01070052
007700     05  PS-EOF-AR-CSR-SW               PIC  X(01)  VALUE 'N'.    01080052
007800         88  PS-EOF-AR-CSR                          VALUE 'Y'.    01090052
007900         88  PS-NOT-EOF-AR-CSR                      VALUE 'N'.    01100052
008000     05  PS-EOF-DCRCPT-CSR-SW           PIC  X(01)  VALUE 'N'.    01110052
008100         88  PS-EOF-DCRCPT-CSR                      VALUE 'Y'.    01120052
008200         88  PS-NOT-EOF-DCRCPT-CSR                  VALUE 'N'.    01130052
008202     05  PS-END-OF-DC-SW                PIC  X(01)  VALUE 'N'.    01140052
008203         88  PS-END-OF-DC                           VALUE 'Y'.    01150052
008204         88  PS-NOT-END-OF-DC                       VALUE 'N'.    01160052
008205     05  PS-TABLE-OVERFLOW-SW           PIC  X(01)  VALUE 'N'.    01170052
008206         88  PS-TABLE-OVERFLOW                      VALUE 'Y'.    01180052
008207         88  PS-NOT-TABLE-OVERFLOW                  VALUE 'N'.    01190052
008208     05  PS-DC-MATCH-SW                 PIC  X(01)  VALUE 'N'.    01200052
008209         88  PS-DC-MATCH                            VALUE 'Y'.    01210052
008210         88  PS-NO-DC-MATCH                         VALUE 'N'.    01220052
008300                                                                  01230052
008400 01  PV-PROGRAM-VARIABLES.                                        01240052
008500     05  PV-SUB                         PIC S9(04)  VALUE +0      01250052
008600                                                    COMP SYNC.    01260052
008700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01270052
008800                                                    COMP SYNC.    01280052
008900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01290052
009000                                                    COMP-3.       01300052
009100     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01310052
009200                                                    COMP-3.       01320052
009300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01330052
009400                                                    COMP-3.       01340052
009500     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01350052
009600                                                    COMP-3.       01360052
009700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01370052
009800                                                    COMP-3.       01380052
009900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01390052
010000                                                    COMP-3.       01400052
010100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01410052
010200                                                    COMP-3.       01420052
010300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01430052
010400                                                    COMP SYNC.    01440052
010500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01450052
010600                                                    COMP SYNC.    01460052
010700     05  PV-ITEM                        PIC S9(04)  VALUE +0      01470052
010800                                                    COMP SYNC.    01480052
010900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01490052
011000                                                    COMP SYNC.    01500052
011100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01510052
011200                                                    COMP SYNC.    01520052
011300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01530052
011400                                                    COMP SYNC.    01540052
011500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01550052
011600                                                    COMP SYNC.    01560052
011700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01570052
011800                                                    COMP SYNC.    01580052
011900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01590052
012000                                                    COMP SYNC.    01600052
012100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01610052
012200                                                    COMP SYNC.    01620052
012300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01630052
012400                                                    COMP SYNC.    01640052
012500     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01650052
012600                                                    COMP SYNC.    01660052
012700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01670052
012800                                                    COMP SYNC.    01680052
012900     05  PV-QUOTIENT                    PIC S9(04)  VALUE +0      01690052
013000                                                    COMP SYNC.    01700052
013100     05  PV-SAVE-STR-NBR                PIC S9(04)  VALUE +0      01710052
013200                                                    COMP SYNC.    01720052
           05  PV-SAVE-DEST-NBR               PIC S9(04)  VALUE +0      01730052
                                                          COMP SYNC.    01740052
013300     05  PV-STORE-NBR                   PIC  9(04).               01750052
013400     05  FILLER REDEFINES PV-STORE-NBR.                           01760052
013600         10  PV-STORE-NBR-X             PIC  X(04).               01770055
013100     05  PV-STORE-NBR-DB2               PIC S9(04)  VALUE +0      01780055
013200                                                    COMP SYNC.    01790055
013700     05  PV-DATE-TABLE.                                           01800052
013800         10  PV-RCPT-DATE OCCURS 6 TIMES PIC X(26).               01810052
013900     05  PV-TMST-BREAK.                                           01820052
014000         10  PV-TMST-YEAR               PIC  X(04).               01830052
014100         10  FILLER                     PIC  X(01).               01840052
014200         10  PV-TMST-MM                 PIC  X(02).               01850052
014300         10  FILLER                     PIC  X(01).               01860052
014400         10  PV-TMST-DD                 PIC  X(02).               01870052
014500         10  FILLER                     PIC  X(16).               01880052
014600     05  PV-AR-IND                      PIC  X(01).               01890052
014700                                                                  01900052
014800     05  PV-DC-TRBL-CODE.                                         01910052
014900         10  FILLER                     PIC X(03)   VALUE 'TB-'.  01920052
015000         10  PV-DC-INIT                 PIC X(02).                01930052
015002     05  PV-DC-COUNT                    PIC S9(9)   VALUE +0      01940052
015003                                                    COMP-3.       01950052
015004     05  PV-DC-REC-DATE                 PIC X(10).                01960052
015005     05  PV-ALLOC-DATE                  PIC X(10).                01970052
W24803     05  PV-NULL-INDICATORS.                                      01980052
W24803         10 PV-SKU-NBR-IND              PIC S9(04) VALUE +0       01990052
W24803                                                   COMP.          02000052
W24803         10 PV-MAJ-CL-NBR-IND           PIC S9(04) VALUE +0       02010052
W24803                                                   COMP.          02020052
W24803         10 PV-SUB-CL-NBR-IND           PIC S9(04) VALUE +0       02030052
W24803                                                   COMP.          02040052
W24803         10 PV-SKU-DESC                 PIC S9(04) VALUE +0       02050052
W24803                                                   COMP.          02060052
W24803         10 PV-VS-NBR                   PIC S9(04) VALUE +0       02070052
W24803                                                   COMP.          02080052
W24803         10 PV-CSTM-CLOR-DESC           PIC S9(04) VALUE +0       02090052
W24803                                                   COMP.          02100052
W24803         10 PV-SIZE-DESC                PIC S9(04) VALUE +0       02110052
W24803                                                   COMP.          02120052
W24803     05  PV-TEMP-SKU.                                             02130052
W24803         10 PV-TEMP-DEPT                PIC 9(03)  VALUE 0.       02140052
W24803         10 PV-TEMP-CLASS               PIC 9(02)  VALUE 0.       02150052
W24803         10 PV-TEMP-SEQ                 PIC 9(03)  VALUE 0.       02160052
W24803     05  PV-SKU REDEFINES PV-TEMP-SKU   PIC 9(08).                02170052
W24803     05  PV-MAJ-CL.                                               02180052
W24803         10 PV-MAJ-CL-1                 PIC 9      VALUE 0.       02190052
W24803         10 FILLER                      PIC 9      VALUE 0.       02200052
W24803     05  PV-MAJ-CLASS REDEFINES PV-MAJ-CL                         02210052
W24803                                        PIC 9(02).                02220052
015100                                                                  02230052
015200******************************************************************02240052
015300**  THIS IS THE LAYOUT FOR THE TEMP STORAGE QUEUE CONTAINING    **02250052
015400**  SELECTED PO LINE ITEMS TO BE PROCESSED BY THIS PROGRAM.     **02260052
015500******************************************************************02270052
015600     COPY POWS012.                                                02280052
015700                                                                  02290052
015800                                                                  02300052
015900******************************************************************02310052
016000**  THIS IS THE LAYOUT FOR THE TEMP STORAGE QUEUE CONTAINING    **02320052
016100**  SELECTED PO LINE ITEMS FROM THE PO SKU RECEIVER SCREEN.     **02330052
016200******************************************************************02340052
016300     COPY POWS070.                                                02350052
016400                                                                  02360052
016500******************************************************************02370052
016600**  THIS IS THE LAYOUT FOR THE TEMP STORAGE QUEUE CONTAINING    **02380052
016700**  SELECTED PKSL PO LINE ITEMS TO BE PROCESSED BY THIS PROGRAM.**02390052
016800******************************************************************02400052
016900     COPY RCWS013.                                                02410052
017000                                                                  02420052
017100******************************************************************02430052
017200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02440052
017300**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02450052
017400**  APPLICATION-SPECIFIC COMMAREA.                              **02460052
017500******************************************************************02470052
017600 01  LQW-LIST-QUEUE-WORK-AREA.                                    02480052
017700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02490052
017800     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           02500052
017900                                        INDEXED BY LQW-IDX.       02510052
018000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02520052
018100         10  LQW-STORE-NBR              PIC S9(04)  COMP.         02530052
018200         10  LQW-DC-IND                 PIC  X(02).               02540052
018300         10  LQW-STORE-NAME             PIC  X(05).               02550052
018400         10  LQW-PLAN-QTY               PIC  9(06).               02560052
018500         10  LQW-RCVD-QTY               PIC  9(06).               02570052
018600         10  LQW-RCVD-QTY1              PIC  9(06).               02580052
018700         10  LQW-RCVD-QTY2              PIC  9(06).               02590052
018800         10  LQW-RCVD-QTY3              PIC  9(06).               02600052
018900         10  LQW-RCVD-QTY4              PIC  9(06).               02610052
019000         10  LQW-RCVD-QTY5              PIC  9(06).               02620052
019100         10  LQW-RCVD-QTY6              PIC  9(06).               02630052
019200         10  LQW-RCVD-QTYO              PIC  9(06).               02640052
019300                                                                  02650052
019400*---------------------------------------------------------------* 02660052
019500*    MAP LAYOUT                                                 * 02670052
019600*---------------------------------------------------------------* 02680052
019700                                                                  02690052
019800     COPY POKM036.                                                02700052
019900                                                                  02710052
020000 01  MR-OCCURS-LAYOUT                   REDEFINES  PO036AO.       02720052
C98147     05  FILLER                         PIC X(455).               02730067
020200     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          02740052
020300         10  MR-STORE-NBRL              PIC S9(04) COMP.          02750052
020400         10  MR-STORE-NBRA              PIC  X(01).               02760052
020500         10  MR-STORE-NBRC              PIC  X(01).               02770052
020600         10  MR-STORE-NBRP              PIC  X(01).               02780052
020700         10  MR-STORE-NBRH              PIC  X(01).               02790052
020800         10  MR-STORE-NBRV              PIC  X(01).               02800052
020900         10  MR-STORE-NBRI              PIC  ZZZZ.                02810054
021000                                                                  02820052
021100         10  MR-STORE-NAMEL             PIC S9(04) COMP.          02830052
021200         10  MR-STORE-NAMEA             PIC  X(01).               02840052
021300         10  MR-STORE-NAMEC             PIC  X(01).               02850052
021400         10  MR-STORE-NAMEP             PIC  X(01).               02860052
021500         10  MR-STORE-NAMEH             PIC  X(01).               02870052
021600         10  MR-STORE-NAMEV             PIC  X(01).               02880052
021700         10  MR-STORE-NAMEI             PIC  X(05).               02890052
021800                                                                  02900052
021900         10  MR-DC-INDL                 PIC S9(04) COMP.          02910052
022000         10  MR-DC-INDA                 PIC  X(01).               02920052
022100         10  MR-DC-INDC                 PIC  X(01).               02930052
022200         10  MR-DC-INDP                 PIC  X(01).               02940052
022300         10  MR-DC-INDH                 PIC  X(01).               02950052
022400         10  MR-DC-INDV                 PIC  X(01).               02960052
022500         10  MR-DC-INDI                 PIC  X(02).               02970052
022600                                                                  02980052
022700         10  MR-PLAN-QTYL               PIC S9(04) COMP.          02990052
022800         10  MR-PLAN-QTYA               PIC  X(01).               03000052
022900         10  MR-PLAN-QTYC               PIC  X(01).               03010052
023000         10  MR-PLAN-QTYP               PIC  X(01).               03020052
023100         10  MR-PLAN-QTYH               PIC  X(01).               03030052
023200         10  MR-PLAN-QTYV               PIC  X(01).               03040052
023300         10  MR-PLAN-QTYI               PIC  ZZZZZZ.              03050052
023400                                                                  03060052
023500         10  MR-RCVD-QTYL               PIC S9(04) COMP.          03070052
023600         10  MR-RCVD-QTYA               PIC  X(01).               03080052
023700         10  MR-RCVD-QTYC               PIC  X(01).               03090052
023800         10  MR-RCVD-QTYP               PIC  X(01).               03100052
023900         10  MR-RCVD-QTYH               PIC  X(01).               03110052
024000         10  MR-RCVD-QTYV               PIC  X(01).               03120052
024100         10  MR-RCVD-QTYI               PIC  ZZZZZZ.              03130052
024200                                                                  03140052
024300         10  MR-QTY-REC1L               PIC S9(04) COMP.          03150052
024400         10  MR-QTY-REC1A               PIC  X(01).               03160052
024500         10  MR-QTY-REC1C               PIC  X(01).               03170052
024600         10  MR-QTY-REC1P               PIC  X(01).               03180052
024700         10  MR-QTY-REC1H               PIC  X(01).               03190052
024800         10  MR-QTY-REC1V               PIC  X(01).               03200052
024900         10  MR-QTY-REC1I               PIC  ZZZZZZ.              03210052
025000                                                                  03220052
025100         10  MR-QTY-REC2L               PIC S9(04) COMP.          03230052
025200         10  MR-QTY-REC2A               PIC  X(01).               03240052
025300         10  MR-QTY-REC2C               PIC  X(01).               03250052
025400         10  MR-QTY-REC2P               PIC  X(01).               03260052
025500         10  MR-QTY-REC2H               PIC  X(01).               03270052
025600         10  MR-QTY-REC2V               PIC  X(01).               03280052
025700         10  MR-QTY-REC2I               PIC  ZZZZZZ.              03290052
025800                                                                  03300052
025900         10  MR-QTY-REC3L               PIC S9(04) COMP.          03310052
026000         10  MR-QTY-REC3A               PIC  X(01).               03320052
026100         10  MR-QTY-REC3C               PIC  X(01).               03330052
026200         10  MR-QTY-REC3P               PIC  X(01).               03340052
026300         10  MR-QTY-REC3H               PIC  X(01).               03350052
026400         10  MR-QTY-REC3V               PIC  X(01).               03360052
026500         10  MR-QTY-REC3I               PIC  ZZZZZZ.              03370052
026600                                                                  03380052
026700         10  MR-QTY-REC4L               PIC S9(04) COMP.          03390052
026800         10  MR-QTY-REC4A               PIC  X(01).               03400052
026900         10  MR-QTY-REC4C               PIC  X(01).               03410052
027000         10  MR-QTY-REC4P               PIC  X(01).               03420052
027100         10  MR-QTY-REC4H               PIC  X(01).               03430052
027200         10  MR-QTY-REC4V               PIC  X(01).               03440052
027300         10  MR-QTY-REC4I               PIC  ZZZZZZ.              03450052
027400                                                                  03460052
027500         10  MR-QTY-REC5L               PIC S9(04) COMP.          03470052
027600         10  MR-QTY-REC5A               PIC  X(01).               03480052
027700         10  MR-QTY-REC5C               PIC  X(01).               03490052
027800         10  MR-QTY-REC5P               PIC  X(01).               03500052
027900         10  MR-QTY-REC5H               PIC  X(01).               03510052
028000         10  MR-QTY-REC5V               PIC  X(01).               03520052
028100         10  MR-QTY-REC5I               PIC  ZZZZZZ.              03530052
028200                                                                  03540052
028300         10  MR-QTY-REC6L               PIC S9(04) COMP.          03550052
028400         10  MR-QTY-REC6A               PIC  X(01).               03560052
028500         10  MR-QTY-REC6C               PIC  X(01).               03570052
028600         10  MR-QTY-REC6P               PIC  X(01).               03580052
028700         10  MR-QTY-REC6H               PIC  X(01).               03590052
028800         10  MR-QTY-REC6V               PIC  X(01).               03600052
028900         10  MR-QTY-REC6I               PIC  ZZZZZZ.              03610052
029000                                                                  03620052
029100         10  MR-QTY-RECOL               PIC S9(04) COMP.          03630052
029200         10  MR-QTY-RECOA               PIC  X(01).               03640052
029300         10  MR-QTY-RECOC               PIC  X(01).               03650052
029400         10  MR-QTY-RECOP               PIC  X(01).               03660052
029500         10  MR-QTY-RECOH               PIC  X(01).               03670052
029600         10  MR-QTY-RECOV               PIC  X(01).               03680052
029700         10  MR-QTY-RECOI               PIC  ZZZZZZ.              03690052
029800                                                                  03700052
029900*---------------------------------------------------------------* 03710052
030000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03720052
030100*---------------------------------------------------------------* 03730052
030200                                                                  03740052
030300     COPY DPWS015.                                                03750052
030400                                                                  03760052
030500*---------------------------------------------------------------* 03770052
030600*    FUNCTION KEYS COPYBOOK.                                    * 03780052
030700*---------------------------------------------------------------* 03790052
030800                                                                  03800052
030900     COPY DPWS016.                                                03810052
031000                                                                  03820052
031100*---------------------------------------------------------------* 03830052
031200*    NUMERIC EDIT LAYOUT.                                       * 03840052
031300*---------------------------------------------------------------* 03850052
031400                                                                  03860052
031500     COPY DPWS010I.                                               03870052
031600                                                                  03880052
031700*---------------------------------------------------------------* 03890052
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 03900069
031900*---------------------------------------------------------------* 03910052
032000                                                                  03920052
032100     COPY DPWS030.                                                03930052
CICS       COPY DPWS930.                                                03931069
032200                                                                  03940052
032300*---------------------------------------------------------------* 03950052
032400*    STANDARD COMMAREA.                                         * 03960052
032500*---------------------------------------------------------------* 03970052
032600                                                                  03980052
032700     COPY DPWS020.                                                03990052
032800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04000052
032900                                                                  04010052
033000*---------------------------------------------------------------* 04020052
033100* INTER-APPLICATION COMMAREA.                                   * 04030052
033200*   POWS011 - INPUT FROM PO CREATE PROGRAM                      * 04040052
033300*---------------------------------------------------------------* 04050052
033400                                                                  04060052
033500         10  INTER-APPL-COMM-AREA       PIC X(200).               04070052
033600     COPY POWS013.                                                04080052
033700     COPY RCWS015.                                                04090052
033800     COPY POWS069.                                                04100052
033900                                                                  04110052
034000*---------------------------------------------------------------* 04120052
034100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04130052
034200*---------------------------------------------------------------* 04140052
034300         10  ASC-SPECIFIC-COMMAREA.                               04150052
034400             15  ASC-SEL-QUEUE-NAME     PIC  X(08).               04160052
034500             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        04170052
034600             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04180052
034700                                        PIC S9(09) COMP-3.        04190052
034800             15  ASC-SEL-SUB            PIC S9(04) COMP.          04200052
034900             15  ASC-SEL-ITEM           PIC S9(04) COMP.          04210052
035000             15  ASC-LIST-KEYS.                                   04220052
035100                 20  ASC-KEY-PO-NBR     PIC S9(09) COMP.          04230052
035200                 20  ASC-KEY-PO-LINE-NBR                          04240052
035300                                        PIC S9(09) COMP.          04250052
035400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04260052
035500                 20  ASC-BLOCK-MODIFIED-SW                        04270052
035600                                        PIC  X(01).               04280052
035700                     88  ASC-BLOCK-NOT-MODIFIED                   04290052
035800                                        VALUE 'N'.                04300052
035900                     88  ASC-BLOCK-MODIFIED                       04310052
036000                                        VALUE 'Y'.                04320052
036100                                                                  04330052
036200                 20  ASC-ITEM-ARRAY.                              04340052
036300                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        04350052
036400                         30  ASC-LIST-ITEM-NUMBER                 04360052
036500                                        PIC S9(09) COMP-3.        04370052
036600                         30  ASC-STORE-NBR           PIC S9(04)   04380052
036700                                                          COMP.   04390052
036800                         30  ASC-STORE-NAME          PIC  X(05).  04400052
036900                         30  ASC-DC-IND              PIC  X(02).  04410052
037000                         30  ASC-PLAN-QTY            PIC  9(06).  04420052
037100                         30  ASC-RCVD-QTY            PIC  9(06).  04430052
037200                         30  ASC-RCVD-QTY1           PIC  9(06).  04440052
037300                         30  ASC-RCVD-QTY2           PIC  9(06).  04450052
037400                         30  ASC-RCVD-QTY3           PIC  9(06).  04460052
037500                         30  ASC-RCVD-QTY4           PIC  9(06).  04470052
037600                         30  ASC-RCVD-QTY5           PIC  9(06).  04480052
037700                         30  ASC-RCVD-QTY6           PIC  9(06).  04490052
037800                         30  ASC-RCVD-QTYO           PIC  9(06).  04500052
037900                                                                  04510052
038000             15  ASC-BLK-SUB                         PIC S9(04)   04520052
038100                                                          COMP    04530052
038200                                                          SYNC.   04540052
038300             15  ASC-ITEM-SUB                        PIC S9(04)   04550052
038400                                                          COMP    04560052
038500                                                          SYNC.   04570052
038600             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   04580052
038700                                                          COMP-3. 04590052
038800             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   04600052
038900                                                          COMP-3. 04610052
039000             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   04620052
039100                                                          COMP-3. 04630052
039200             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   04640052
039300                                                          COMP-3. 04650052
039400             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   04660052
039500                                                          COMP    04670052
039600                                                          SYNC.   04680052
039700             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  04690052
039800                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04700052
039900                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04710052
040000             15  ASC-PROCESS-SEL-SW                  PIC  X(01).  04720052
040100                 88  ASC-PROCESS-SEL                 VALUE 'Y'.   04730052
040200                 88  ASC-NOT-PROCESS-SEL             VALUE 'N'.   04740052
040300             15  ASC-LIST-QUEUE-NAME.                             04750052
040400                 20  ASC-LIST-TERM-ID                PIC  X(04).  04760052
040500                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   04770052
040600                                                          COMP-3. 04780052
040700                 20  ASC-LIST-SEQ                    PIC  9(01).  04790052
040800             15  ASC-START-ITEM-REQUEST.                          04800052
040900                 20  ASC-START-ITEM-REQUEST-N        PIC  9(07).  04810052
041000             15  ASC-PO-LNE-NBR                      PIC S9(09)   04820052
041100                                                          COMP.   04830052
041200             15  ASC-DPT-NBR                         PIC  X(03).  04840052
041300             15  ASC-ENT-NAME-DESC                   PIC  X(30).  04850052
W24803             15  ASC-MAJ-CL-NBR                      PIC  9(02).  04860052
W24803             15  ASC-SUB-CL-NBR                      PIC  9(02).  04870052
W24803             15  ASC-SKU-NBR                         PIC  9(08).  04880052
041600             15  ASC-SKU-DESC                        PIC  X(25).  04890052
041700             15  ASC-UNIT-QTY                        PIC S9(09)   04900052
041800                                                          COMP.   04910052
041900             15  ASC-TOT-SHIP-QTY                    PIC S9(09)   04920052
042000                                                          COMP.   04930052
042100             15  ASC-VEND-STYL-NAME                  PIC  X(20).  04940052
042200             15  ASC-COLOR-DESC                      PIC  X(25).  04950052
042300             15  ASC-SIZE-DESC                       PIC  X(25).  04960052
042400             15  ASC-DIR-STR-IND                     PIC  X(01).  04970052
042500             15  ASC-INTER-APPL-CODE-IND             PIC  X(01).  04980052
042600                 88  ASC-INTER-APPL-PKSL             VALUE '2'.   04990052
042700                 88  ASC-INTER-APPL-SKU-RCVR         VALUE '3'.   05000052
042800             15  ASC-DATE-TABLE.                                  05010052
042900                 20  ASC-DATES OCCURS 7 TIMES.                    05020052
043000                     25  ASC-YEAR                    PIC  X(04).  05030052
043100                     25  ASC-DATE.                                05040052
043200                         30  ASC-DATE-MM             PIC  X(02).  05050052
043300                         30  ASC-DATE-SL             PIC  X(01).  05060052
043400                         30  ASC-DATE-DD             PIC  X(02).  05070052
043500             15  ASC-PKSL-APP-PO-LNE-NBR             PIC S9(04)   05080052
043600                                                          COMP.   05090052
043601* IF WE HAVE MORE THAN 30 DIST CENTERS, BUMP THE NUMBER OF OCCURS 05100064
043602* UP.                                                             05110052
043605             15  ASC-DC-TABLE OCCURS 30 TIMES.                    05120063
043606                 20  ASC-DC-NBR                      PIC S9(4)    05130052
043607                                                     COMP SYNC.   05140052
043608                 20  ASC-DC-NAME                     PIC X(5).    05150052
043609                 20  FILLER REDEFINES ASC-DC-NAME.                05160052
043610                     25  FILLER                      PIC X(3).    05170052
043620                     25  ASC-DC-NAME-ABBR            PIC X(2).    05180052
W24803         10  FILLER                                  PIC X(974).  05190064
043700                                                                  05200052
043800*---------------------------------------------------------------* 05210052
043900*    ABEND PROCESSING COPYBOOK.                                 * 05220052
044000*---------------------------------------------------------------* 05230052
044100                                                                  05240052
044200     COPY DPWS013.                                                05250052
044300                                                                  05260052
044400*---------------------------------------------------------------* 05270052
044500*    DB2 AREA FOR PURCHASE ORDER                                * 05280052
044600*---------------------------------------------------------------* 05290052
044700     EXEC SQL                                                     05300052
044800          INCLUDE TPURCHS                                         05310052
044900     END-EXEC.                                                    05320052
045000                                                                  05330052
045010*---------------------------------------------------------------* 05340052
045020*    DB2 AREA FOR PURCHASE ORDER SHIPMENT INFO                  * 05350052
045030*---------------------------------------------------------------* 05360052
045040     EXEC SQL                                                     05370052
045050          INCLUDE TPLNSHP                                         05380052
045060     END-EXEC.                                                    05390052
045070                                                                  05400052
045100*---------------------------------------------------------------* 05410052
045200*    DB2 AREA FOR PURCHASE ITEM                                 * 05420052
045300*---------------------------------------------------------------* 05430052
045400     EXEC SQL                                                     05440052
045500          INCLUDE TPURITM                                         05450052
045600     END-EXEC.                                                    05460052
045700                                                                  05470052
046500*---------------------------------------------------------------* 05480052
046600*    DB2 AREA FOR MERCHANDISE STORE DISTRIBUTION                * 05490052
046700*---------------------------------------------------------------* 05500052
046800     EXEC SQL                                                     05510052
046900          INCLUDE TMESTDS                                         05520052
047000     END-EXEC.                                                    05530052
047100                                                                  05540052
047200*---------------------------------------------------------------* 05550052
047300*    DB2 AREA FOR TALLPLN TABLE                                 * 05560052
047400*---------------------------------------------------------------* 05570052
047500     EXEC SQL                                                     05580052
047600          INCLUDE TALLPLN                                         05590052
047700     END-EXEC.                                                    05600052
047800                                                                  05610052
047900*---------------------------------------------------------------* 05620052
048000*    DB2 AREA FOR TRECDIS TABLE                                 * 05630052
048100*---------------------------------------------------------------* 05640052
048200     EXEC SQL                                                     05650052
048300          INCLUDE TRECDIS                                         05660052
048400     END-EXEC.                                                    05670052
048500                                                                  05680052
048600*---------------------------------------------------------------* 05690052
048700*    DB2 AREA FOR TRECITM TABLE                                 * 05700052
048800*---------------------------------------------------------------* 05710052
048900     EXEC SQL                                                     05720052
049000          INCLUDE TRECITM                                         05730052
049100     END-EXEC.                                                    05740052
049200                                                                  05750052
049300*---------------------------------------------------------------* 05760052
049400*    DB2 AREA FOR LOCATION                                      * 05770054
049500*---------------------------------------------------------------* 05780052
049600     EXEC SQL                                                     05790052
049700          INCLUDE XMT00001                                        05800054
049800     END-EXEC.                                                    05810052
049900                                                                  05820054
049300*---------------------------------------------------------------* 05830054
049400*    DB2 AREA FOR DC LOCATION ASSIGNMENT                        * 05840054
049500*---------------------------------------------------------------* 05850054
049600     EXEC SQL                                                     05860054
049700          INCLUDE XMT00002                                        05870054
049800     END-EXEC.                                                    05880054
049900                                                                  05890052
050000*---------------------------------------------------------------* 05900052
050100*    DB2 AREA FOR ENTERPRISE NAME                               * 05910052
050200*---------------------------------------------------------------* 05920052
050300     EXEC SQL                                                     05930052
050400          INCLUDE TENTNME                                         05940052
050500     END-EXEC.                                                    05950052
050600                                                                  05960052
W24803***************************************************************** 05970052
W24803*    DB2 AREA FOR XLT_SKU TABLE                                   05980052
W24803***************************************************************** 05990052
W24803                                                                  06000052
W24803     EXEC SQL                                                     06010052
W24803         INCLUDE XLT00003                                         06020052
W24803     END-EXEC.                                                    06030052
W24803***************************************************************** 06040052
W24803*    DB2 AREA FOR XLT_VND_STYL TABLE                              06050052
W24803***************************************************************** 06060052
W24803                                                                  06070052
W24803     EXEC SQL                                                     06080052
W24803         INCLUDE XLT00004                                         06090052
W24803     END-EXEC.                                                    06100052
W24803***************************************************************** 06110052
W24803*    DB2 AREA FOR TUPCPLS                                       * 06120052
W24803***************************************************************** 06130052
W24803                                                                  06140052
W24803     EXEC SQL                                                     06150052
W24803         INCLUDE TUPCPLS                                          06160052
W24803     END-EXEC.                                                    06170052
W24803***************************************************************** 06180052
W24803*    DB2 AREA FOR TWEBITM TABLE                                 * 06190052
W24803***************************************************************** 06200052
W24803                                                                  06210052
W24803     EXEC SQL                                                     06220052
W24803         INCLUDE TWEBITM                                          06230052
W24803     END-EXEC.                                                    06240052
W24803*                                                                 06250052
050700*---------------------------------------------------------------* 06260052
050800*    DB2 AREA FOR COMMUNICATIONS                                * 06270052
050900*---------------------------------------------------------------* 06280052
051000     EXEC SQL                                                     06290052
051100          INCLUDE SQLCA                                           06300052
051200     END-EXEC.                                                    06310052
051300                                                                  06320052
051400*---------------------------------------------------------------* 06330052
051500*    DATE CURSOR                                                * 06340052
051600*---------------------------------------------------------------* 06350052
051700     EXEC SQL                                                     06360052
051800          DECLARE DATE-CSR  CURSOR FOR                            06370052
051900          SELECT DISTINCT(VERFYD_TMST)                            06380052
052000          FROM TRECITM                                            06390052
052100          WHERE VER_STATUS_CDE = 'A'                              06400052
052200            AND ORD_NBR = :ASC-KEY-PO-NBR                         06410052
052300            AND ORD_LNE_NBR = :ASC-PO-LNE-NBR                     06420052
052400            AND STATUS_CDE = 'VE'                                 06430052
052500          ORDER BY 1                                              06440052
052600     END-EXEC.                                                    06450052
052700                                                                  06460052
052800                                                                  06470052
052900*---------------------------------------------------------------* 06480052
053000*    DC ALLOCATION CURSOR                                       * 06490052
053100*---------------------------------------------------------------* 06500052
053200     EXEC SQL                                                     06510052
053300          DECLARE DC-CSR  CURSOR FOR                              06520052
053400          SELECT DEST_NBR,                                        06530052
053500                 CURR_SPLIT_QTY                                   06540052
053600          FROM   TALLPLN                                          06550052
053700          WHERE PO_NBR = :ASC-KEY-PO-NBR                          06560052
053800            AND PO_LNE_NBR = :ASC-KEY-PO-LINE-NBR                 06570052
053900*           AND STATUS_CDE = 'AC'                                 06580052
054000          ORDER BY DEST_NBR                                       06590052
054100     END-EXEC.                                                    06600052
054200                                                                  06610052
054300*---------------------------------------------------------------* 06620052
054400*    STORE ALLOCATIONS AND RECEIPTS CURSOR                      * 06630052
054500*---------------------------------------------------------------* 06640052
054600     EXEC SQL                                                     06650052
054700          DECLARE AR-CSR  CURSOR FOR                              06660052
054800          SELECT A.DEST_NBR,                                      06670052
054900                 B.STR_NBR,                                       06680052
055000                 'A',                                             06690052
055100                 TIMESTAMP ('00010101000001'),                    06700052
055200                 B.STR_DISTRO_QTY                                 06710052
055300          FROM TALLPLN A,                                         06720052
055400               TMESTDS B                                          06730052
055500          WHERE A.PO_NBR         = :ASC-KEY-PO-NBR                06740052
055600            AND A.PO_LNE_NBR     = :ASC-KEY-PO-LINE-NBR           06750052
055700            AND A.STATUS_CDE     = 'AC'                           06760052
055800            AND B.PO_NBR         = A.PO_NBR                       06770052
055900            AND B.PO_LNE_NBR     = A.PO_LNE_NBR                   06780052
056000            AND B.PLAN_NBR       = A.PLAN_NBR                     06790052
056100          UNION                                                   06800052
056200          SELECT F.OPER_UNT_ID,                                   06810052
056300                 G.STR_NBR,                                       06820052
056400                 'R',                                             06830052
056500                 F.VERFYD_TMST,                                   06840052
056600                 G.AP_VERIFY_ITM_QTY                              06850052
056700          FROM TRECITM F,                                         06860052
056800               TRECDIS G                                          06870052
056900          WHERE F.ORD_NBR        = :ASC-KEY-PO-NBR                06880052
057000            AND F.ORD_LNE_NBR    = :ASC-PO-LNE-NBR                06890052
057100            AND F.VER_STATUS_CDE = 'A'                            06900052
057200            AND F.STATUS_CDE     = 'VE'                           06910052
057300            AND G.ORD_NBR        = F.ORD_NBR                      06920052
057400            AND G.ORD_LNE_NBR    = F.ORD_LNE_NBR                  06930052
057500            AND G.REC_SEQ_NBR    = F.REC_SEQ_NBR                  06940052
057600            AND G.VER_STATUS_CDE = 'A'                            06950052
057700            AND G.OPER_UNT_ID    = F.OPER_UNT_ID                  06960052
057800            AND G.FCLTY_ID       = F.FCLTY_ID                     06970052
057900          ORDER BY 1,2,3,4,5                                      06980052
058000     END-EXEC.                                                    06990052
058100                                                                  07000052
058200*---------------------------------------------------------------* 07010052
058300*    DC RECEIPTS CURSOR                                         * 07020052
058400*---------------------------------------------------------------* 07030052
058500     EXEC SQL                                                     07040052
058600          DECLARE DCRCPT-CSR  CURSOR FOR                          07050052
058700          SELECT A.VERFYD_TMST,                                   07060052
058800                 B.AP_VERIFY_ITM_QTY                              07070052
058900          FROM TRECITM A,                                         07080052
059000               TRECDIS B                                          07090052
059100          WHERE A.ORD_NBR        = :ASC-KEY-PO-NBR                07100052
059200            AND A.ORD_LNE_NBR    = :ASC-PO-LNE-NBR                07110052
059300            AND A.VER_STATUS_CDE = 'A'                            07120052
059400            AND A.OPER_UNT_ID    = :ALLPLN-DEST-NBR               07130052
059500            AND A.STATUS_CDE     = 'VE'                           07140052
059600            AND B.ORD_NBR        = A.ORD_NBR                      07150052
059700            AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR                  07160052
059800            AND B.REC_SEQ_NBR    = A.REC_SEQ_NBR                  07170052
059900            AND B.VER_STATUS_CDE = 'A'                            07180052
060000            AND B.OPER_UNT_ID    = A.OPER_UNT_ID                  07190052
060100            AND B.FCLTY_ID       = A.FCLTY_ID                     07200052
060200          ORDER BY 1                                              07210052
060300     END-EXEC.                                                    07220052
060400                                                                  07230052
060402*---------------------------------------------------------------* 07240052
060403*    DC CURSOR                                                  * 07250052
060404*---------------------------------------------------------------* 07260052
060405                                                                  07270052
060406     EXEC SQL                                                     07280052
060407          DECLARE DC-NAME-CSR CURSOR FOR                          07290052
060407          SELECT XL.LOC_NBR,                                      07300054
060408                 XL.LOC_5_ABBR_NM                                 07310054
060409            FROM XMT_LOC XL                                       07320054
060410           WHERE LOC_TYP_CDE = 'DC'                               07330054
060411             AND CLO_DTE > CURRENT DATE                           07340054
060412             AND XL.LOC_NBR =                                     07350054
060413                (SELECT DC_NBR                                    07360054
060414                   FROM XMT_DC_LOC_ASGMT DLA1                     07370054
060415                  WHERE DLA1.LOC_NBR = XL.LOC_NBR                 07380054
060416                    AND DLA1.PO_STRT_DTE =                        07390054
060417                       (SELECT MAX(PO_STRT_DTE)                   07400054
                                FROM XMT_DC_LOC_ASGMT DLA2              07410054
                               WHERE DLA2.PO_STRT_DTE <= CURRENT DATE   07420054
                                 AND DLA1.LOC_NBR = DLA2.LOC_NBR))      07430054
060418     END-EXEC.                                                    07440052
060500                                                                  07450052
060600 LINKAGE SECTION.                                                 07460052
060700                                                                  07470052
060800 01  DFHCOMMAREA.                                                 07480052
060900     05  FILLER                         OCCURS  1 TO 4072 TIMES   07490052
061000                                        DEPENDING ON EIBCALEN.    07500052
061100         10  FILLER                     PIC X.                    07510052
061200                                                                  07520052
061300                                                                  07530052
061400*------------------*                                              07540052
061500 PROCEDURE DIVISION.                                              07550052
061600*------------------*                                              07560052
061700                                                                  07570052
061800 0000-MAIN-MODULE.                                                07580052
061900                                                                  07590052
062000     INITIALIZE DP030-CICS-API-FIELDS.                            07600052
062100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07610052
062200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07620052
062300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07630052
062400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07640052
062500     MOVE LENGTH OF PO036AI        TO DP030-MAP-LENGTH (1).       07650052
062600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07660052
062700     PERFORM 0001-CALL-CICS-ARCH-API.                             07670052
062800                                                                  07680052
062900     PERFORM 1000-CONTROL-PROCESSING                              07690052
063000                                                                  07700052
063100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07710052
063200     PERFORM 0001-CALL-CICS-ARCH-API.                             07720052
063300                                                                  07730052
063400                                                                  07740052
063500******************************************************************07750052
063600**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07760052
063700**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07770052
063800******************************************************************07780052
063900 0001-CALL-CICS-ARCH-API.                                         07790052
064000                                                                  07800052
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07810069
064200                                    DFHCOMMAREA                   07820069
064300                                    DP030-CICS-API-FIELDS         07830069
064400                                    DP020-STANDARD-COMMAREA       07840069
064500                                    PO036AI.                      07850069
064600                                                                  07860052
064700     IF  DP030-RC-CALL-SUCCESSFUL                                 07870052
064800         CONTINUE                                                 07880052
064900     ELSE                                                         07890052
065000         SET DP013-NO-ROLLBACK                                    07900052
065100             DP013-XCTL-DISPLAY-RESTART                           07910052
065200             DP013-CICS-ABEND      TO TRUE                        07920052
065300         MOVE '0001-CALL-CICS-ARCH-API'                           07930052
065400                                   TO DP013-PARAGRAPH             07940052
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07950069
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07960069
065700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07970052
065800         PERFORM DP013-0000-PROCESS-ABEND.                        07980052
065900                                                                  07990052
066000                                                                  08000052
066100*----------------------------------------------------------------*08010052
066200* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08020052
066300* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08030052
066400*----------------------------------------------------------------*08040052
066500 1000-CONTROL-PROCESSING.                                         08050052
066600                                                                  08060052
066700     EVALUATE TRUE                                                08070052
066800         WHEN DP020-NEXT-ACT-INITIAL                              08080052
066900             INITIALIZE ASC-SPECIFIC-COMMAREA                     08090052
067000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08100052
067100             MOVE DP020-SRC-TASK-NUMBER                           08110052
067200                                   TO ASC-LIST-TASK-NUMBER        08120052
067300             MOVE PC-LIST-QUEUE-SEQ                               08130052
067400                                   TO ASC-LIST-SEQ                08140052
067500             PERFORM 1100-FIND-OBJECT-KEYS                        08150052
067600             IF PS-ERROR                                          08160052
067700                 CONTINUE                                         08170052
067800             ELSE                                                 08180052
067900                 PERFORM 4000-BUILD-INITIAL-PANEL                 08190052
068000             END-IF                                               08200052
068100                                                                  08210052
068200         WHEN DP020-NEXT-ACT-READ-MAP                             08220052
068300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08230052
068400                                   TO PV-TOP-ITEM                 08240052
068500             PERFORM 2000-PROCESS-PANEL                           08250052
068600                                                                  08260052
068700         WHEN DP020-NEXT-ACT-RETURN                               08270052
068800             PERFORM 2050-DELETE-LIST-QUEUE                       08280052
068900             PERFORM 4000-BUILD-INITIAL-PANEL                     08290052
069000                                                                  08300052
069100         WHEN OTHER                                               08310052
069200             SET DP013-LOGIC-ABEND TO TRUE                        08320052
069300             SET DP013-NO-ROLLBACK TO TRUE                        08330052
069400             MOVE '1000-CONTROL-PROCESSING'                       08340052
069500                                   TO DP013-PARAGRAPH             08350052
069600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08360052
069700                                   TO DP013-MESSAGE-TEXT(1)       08370052
069800             PERFORM DP013-0000-PROCESS-ABEND                     08380052
069900     END-EVALUATE.                                                08390052
070000                                                                  08400052
070100                                                                  08410052
070200*----------------------------------------------------------------*08420052
070300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08430052
070400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08440052
070500*----------------------------------------------------------------*08450052
070600 1100-FIND-OBJECT-KEYS.                                           08460052
070700                                                                  08470052
070800     MOVE DP020-INT-APPL-FORMAT-IND                               08480052
070900                                   TO ASC-INTER-APPL-CODE-IND.    08490052
071000                                                                  08500052
071100     EVALUATE DP020-INT-APPL-FORMAT-IND                           08510052
071200         WHEN PC-NON-SELECT-FORMAT                                08520052
071300             SET ASC-NOT-PROCESS-SEL                              08530052
071400                                   TO TRUE                        08540052
071500             MOVE PO013-PO-NBR     TO ASC-KEY-PO-NBR              08550052
071600             MOVE PO013-PO-LNE-NBR TO ASC-KEY-PO-LINE-NBR         08560052
071700             MOVE PO013-PO-LNE-VAR-NBR                            08570052
071800                                   TO ASC-PO-LNE-NBR              08580052
071900                                                                  08590052
072000         WHEN PC-INTER-APPL-PKSL                                  08600052
072100             SET ASC-PROCESS-SEL   TO TRUE                        08610052
072200             IF  RC015-NUMBER-OF-SELECTED-ITEMS = ZERO            08620052
072300                 MOVE PC-TSYMSG-00057                             08630052
072400                                   TO DP020-MSG-NUMBER            08640052
072500                 SET DP020-MSG-FATAL                              08650052
072600                                   TO TRUE                        08660052
072700                 SET DP020-NEXT-ACT-APPL-ERROR                    08670052
072800                                   TO TRUE                        08680052
072900                 SET PS-ERROR      TO TRUE                        08690052
073000             ELSE                                                 08700052
073100                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              08710052
073200                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08720052
073300                 MOVE RC015-NUMBER-OF-TS-ITEMS                    08730052
073400                                   TO ASC-NUMBER-OF-TS-ITEMS      08740052
073500                 MOVE SPACE        TO ASC-START-ITEM-REQUEST      08750052
073600                 MOVE RC015-SEL-QUEUE-NAME                        08760052
073700                                   TO ASC-SEL-QUEUE-NAME          08770052
073800                 PERFORM 1120-PREPARE-PKSL-LIST-ENTRY             08780052
073900             END-IF                                               08790052
074000                                                                  08800052
074100         WHEN PC-INTER-APPL-SKU-RCVR                              08810052
074200             SET ASC-PROCESS-SEL   TO TRUE                        08820052
074300             IF  PO069-NUMBER-OF-SELECTED-ITEMS = ZERO            08830052
074400                 MOVE PC-TSYMSG-00057                             08840052
074500                                   TO DP020-MSG-NUMBER            08850052
074600                 SET DP020-MSG-FATAL                              08860052
074700                                   TO TRUE                        08870052
074800                 SET DP020-NEXT-ACT-APPL-ERROR                    08880052
074900                                   TO TRUE                        08890052
075000                 SET PS-ERROR      TO TRUE                        08900052
075100             ELSE                                                 08910052
075200                 MOVE PO069-NUMBER-OF-SELECTED-ITEMS              08920052
075300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08930052
075400                 MOVE PO069-NUMBER-OF-TS-ITEMS                    08940052
075500                                   TO ASC-NUMBER-OF-TS-ITEMS      08950052
075600                 MOVE SPACE        TO ASC-START-ITEM-REQUEST      08960052
075700                 MOVE PO069-SEL-QUEUE-NAME                        08970052
075800                                   TO ASC-SEL-QUEUE-NAME          08980052
075900                 PERFORM 1130-PREPARE-SKU-RCVR-ENTRY              08990052
076000             END-IF                                               09000052
076100                                                                  09010052
076200         WHEN OTHER                                               09020052
076300             SET ASC-PROCESS-SEL   TO TRUE                        09030052
076400             IF  PO013-NUMBER-OF-SELECTED-ITEMS = ZERO            09040052
076500                 MOVE PC-TSYMSG-00057                             09050052
076600                                   TO DP020-MSG-NUMBER            09060052
076700                 SET DP020-MSG-FATAL                              09070052
076800                                   TO TRUE                        09080052
076900                 SET DP020-NEXT-ACT-APPL-ERROR                    09090052
077000                                   TO TRUE                        09100052
077100                 SET PS-ERROR      TO TRUE                        09110052
077200             ELSE                                                 09120052
077300                 MOVE PO013-NUMBER-OF-SELECTED-ITEMS              09130052
077400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS09140052
077500                 MOVE PO013-NUMBER-OF-TS-ITEMS                    09150052
077600                                   TO ASC-NUMBER-OF-TS-ITEMS      09160052
077700                 MOVE SPACE        TO ASC-START-ITEM-REQUEST      09170052
077800                 MOVE PO013-SEL-QUEUE-NAME                        09180052
077900                                   TO ASC-SEL-QUEUE-NAME          09190052
078000                 PERFORM 1110-PREPARE-LIST-ENTRY                  09200052
078100             END-IF                                               09210052
078200     END-EVALUATE.                                                09220052
078300                                                                  09230052
078302     PERFORM 1200-LOAD-DC-TABLE.                                  09240052
078400                                                                  09250052
078500*----------------------------------------------------------------*09260052
078600* ENTRY IS FROM A LIST. GET THE FIRST SKU SELECTED.              *09270052
078700*----------------------------------------------------------------*09280052
078800 1110-PREPARE-LIST-ENTRY.                                         09290052
078900                                                                  09300052
079000     MOVE PO012-MAX-ITEMS          TO ASC-SEL-SUB.                09310052
079100     MOVE +0                       TO ASC-SEL-ITEM.               09320052
079200     PERFORM 2130-GET-NEXT-PO-LINE.                               09330052
079300                                                                  09340052
079400                                                                  09350052
079500*----------------------------------------------------------------*09360052
079600* ENTRY IS FROM A LIST. GET THE FIRST PO LINE SELECTED FROM PKSL *09370052
079700*----------------------------------------------------------------*09380052
079800 1120-PREPARE-PKSL-LIST-ENTRY.                                    09390052
079900                                                                  09400052
080000     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                09410052
080100     MOVE +0                       TO ASC-SEL-ITEM.               09420052
080200     PERFORM 2160-GET-NEXT-PKSL-PO-LINE.                          09430052
080300                                                                  09440052
080400*----------------------------------------------------------------*09450052
080500* ENTRY IS FROM THE SKU RECEIVER LIST SCREEN.                    *09460052
080600*----------------------------------------------------------------*09470052
080700 1130-PREPARE-SKU-RCVR-ENTRY.                                     09480052
080800                                                                  09490052
080900     MOVE PO070-MAX-ITEMS          TO ASC-SEL-SUB.                09500052
081000     MOVE +0                       TO ASC-SEL-ITEM.               09510052
081100     PERFORM 2180-GET-NEXT-SKU-RECEIVER.                          09520052
081200                                                                  09530052
081202*----------------------------------------------------------------*09540052
081203* LOADS A DC TABLE WITH ALL OF THE VALID DC NAMES.               *09550052
081204*----------------------------------------------------------------*09560052
081205 1200-LOAD-DC-TABLE.                                              09570052
081206                                                                  09580052
081207     SET PS-NOT-END-OF-DC TO TRUE.                                09590052
081208     SET PS-NOT-TABLE-OVERFLOW TO TRUE.                           09600052
081209                                                                  09610052
081210     PERFORM 1210-GET-DONT-SHIP-BEF-DTE.                          09620052
081211                                                                  09630052
081212     IF PLNSHP-DONT-SHIP-BEF-DTE > PV-ALLOC-DATE                  09640052
081213         MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DC-REC-DATE          09650052
081214     ELSE                                                         09660052
081215         MOVE PV-ALLOC-DATE TO PV-DC-REC-DATE                     09670052
081216     END-IF.                                                      09680052
081217                                                                  09690052
081218     PERFORM 4010-OPEN-DC-NAME-CSR.                               09700052
081219     PERFORM 4015-PROCESS-DC-NAME-CSR.                            09710052
081220     PERFORM 4020-CLOSE-DC-NAME-CSR.                              09720052
081221                                                                  09730052
081222     IF PS-TABLE-OVERFLOW                                         09740052
081223         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    09750052
081224         SET DP020-MSG-FATAL TO TRUE                              09760052
081225         MOVE PC-TSYMSG-00994 TO DP020-MSG-NUMBER                 09770052
081226     END-IF.                                                      09780052
081227                                                                  09790052
081228*----------------------------------------------------------------*09800052
081229* RETRIEVE DO NOT SHIP BEFORE DATE TO USE IN VALIDATING A DC     *09810052
081230*----------------------------------------------------------------*09820052
081231 1210-GET-DONT-SHIP-BEF-DTE.                                      09830052
081232                                                                  09840052
081233     PERFORM                                                      09850052
081234         WITH TEST AFTER                                          09860052
081235         VARYING PV-RETRY-COUNTER                                 09870052
081236         FROM 1 BY 1                                              09880052
081237         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09890052
081238             OR (SQLCODE = ZERO))                                 09900052
081239                                                                  09910052
081240             EXEC SQL                                             09920052
081241                 SELECT DONT_SHIP_BEF_DTE,                        09930052
081242                        CURRENT DATE                              09940052
081243                 INTO :PLNSHP-DONT-SHIP-BEF-DTE,                  09950052
081244                      :PV-ALLOC-DATE                              09960052
081245                 FROM TPLNSHP                                     09970052
081246                 WHERE PO_NBR = :ASC-KEY-PO-NBR                   09980052
081247                   AND VER_STATUS_CDE = 'A'                       09990052
081248             END-EXEC                                             10000052
081249                                                                  10010052
081250         EVALUATE TRUE                                            10020052
081251             WHEN SQLCODE = ZERO                                  10030052
081252             WHEN SQLCODE = -904                                  10040052
081253             WHEN SQLCODE = -913                                  10050052
081254                 CONTINUE                                         10060052
081255             WHEN SQLWARN0 NOT = SPACES                           10070052
081256             WHEN SQLCODE < ZERO                                  10080052
081257             WHEN SQLCODE > ZERO                                  10090052
081258                 MOVE '1210-GET-DONT-SHIP-BEF-DTE'                10100052
081259                                   TO DP013-PARAGRAPH             10110052
081260                 MOVE 'SQL ERROR SELECTING PO'                    10120052
081261                                   TO DP013-MESSAGE-TEXT (1)      10130052
081262                 MOVE SQLCA        TO DP013-SQLCA                 10140052
081263                 MOVE 'TPLNSHP '   TO DP013-DB2-TABLE-NAME (1)    10150052
081264                 SET DP013-DB2-ABEND                              10160052
081265                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10170052
081266                 PERFORM DP013-0000-PROCESS-ABEND                 10180052
081267         END-EVALUATE                                             10190052
081268     END-PERFORM.                                                 10200052
081269*                                                                 10210052
081270     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10220052
081271         MOVE '1210-GET-DONT-SHIP-BEF-DTE'                        10230052
081272                                   TO DP013-PARAGRAPH             10240052
081273         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT PO'  10250052
081274                                   TO DP013-MESSAGE-TEXT (1)      10260052
081275         MOVE SQLCA                TO DP013-SQLCA                 10270052
081276         MOVE 'TPLNSHP '           TO DP013-DB2-TABLE-NAME (1)    10280052
081277         SET DP013-DB2-ABEND                                      10290052
081278             DP013-XCTL-DISPLAY-RESTART                           10300052
081279                                   TO TRUE                        10310052
081280         PERFORM DP013-0000-PROCESS-ABEND                         10320052
081281     END-IF.                                                      10330052
081291                                                                  10340052
081300*----------------------------------------------------------------*10350052
081400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10360052
081500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10370052
081600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10380052
081700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10390052
081800* FUNCTION KEYS CAN GET THIS FAR.                                *10400052
081900*----------------------------------------------------------------*10410052
082000 2000-PROCESS-PANEL.                                              10420052
082100                                                                  10430052
082200     EVALUATE TRUE                                                10440052
082300         WHEN DP020-SRC-AID = DP016-CLEAR                         10450052
082400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10460052
082500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10470052
082600                                                                  10480052
082700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10490052
082800             PERFORM 2050-DELETE-LIST-QUEUE                       10500052
082900             PERFORM 4000-BUILD-INITIAL-PANEL                     10510052
083000                                                                  10520052
083100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10530052
083200             IF ASC-PROCESS-SEL                                   10540052
083300                 PERFORM 2050-DELETE-LIST-QUEUE                   10550052
083400                 EVALUATE TRUE                                    10560052
083500                    WHEN ASC-INTER-APPL-PKSL                      10570052
083600                     PERFORM 2160-GET-NEXT-PKSL-PO-LINE           10580052
083700                                                                  10590052
083800                    WHEN ASC-INTER-APPL-SKU-RCVR                  10600052
083900                     PERFORM 2180-GET-NEXT-SKU-RECEIVER           10610052
084000                                                                  10620052
084100                    WHEN OTHER                                    10630052
084200                     PERFORM 2130-GET-NEXT-PO-LINE                10640052
084300                 END-EVALUATE                                     10650052
084400*                IF ASC-INTER-APPL-PKSL                           10660052
084500*                    PERFORM 2160-GET-NEXT-PKSL-PO-LINE           10670052
084600*                ELSE                                             10680052
084700*                    PERFORM 2130-GET-NEXT-PO-LINE                10690052
084800*                END-IF                                           10700052
084900*                                                                 10710052
085000*                IF ASC-INTER-APPL-SKU-RCVR                       10720052
085100*                    PERFORM 2160-GET-NEXT-PKSL-PO-LINE           10730052
085200*                    PERFORM 2180-GET-NEXT-SKU-RECEIVER           10740052
085300*                ELSE                                             10750052
085400*                    PERFORM 2130-GET-NEXT-PO-LINE                10760052
085500*                END-IF                                           10770052
085600                 PERFORM 4000-BUILD-INITIAL-PANEL                 10780052
085700             ELSE                                                 10790052
085800*                --- BOTTOM OF LIST ---                           10800052
085900                 MOVE PC-TSYMSG-00070                             10810052
086000                                   TO DP020-MSG-NUMBER            10820052
086100                 SET DP020-MSG-INFORMATIONAL                      10830052
086200                                   TO TRUE                        10840052
086300             END-IF                                               10850052
086400                                                                  10860052
086500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10870052
086600             IF ASC-PROCESS-SEL                                   10880052
086700                 PERFORM 2050-DELETE-LIST-QUEUE                   10890052
086800                 EVALUATE TRUE                                    10900052
086900                    WHEN ASC-INTER-APPL-PKSL                      10910052
087000                     PERFORM 2170-GET-PREV-PKSL-PO-LINE           10920052
087100                                                                  10930052
087200                    WHEN ASC-INTER-APPL-SKU-RCVR                  10940052
087300                     PERFORM 2190-GET-PREV-SKU-RECEIVER           10950052
087400                                                                  10960052
087500                    WHEN OTHER                                    10970052
087600                     PERFORM 2140-GET-PREV-PO-LINE                10980052
087700                 END-EVALUATE                                     10990052
087800                                                                  11000052
087900*                IF ASC-INTER-APPL-PKSL                           11010052
088000*                    PERFORM 2170-GET-PREV-PKSL-PO-LINE           11020052
088100*                ELSE                                             11030052
088200*                    PERFORM 2140-GET-PREV-PO-LINE                11040052
088300*                END-IF                                           11050052
088400                 PERFORM 4000-BUILD-INITIAL-PANEL                 11060052
088500             ELSE                                                 11070052
088600*                --- TOP OF LIST ---                              11080052
088700                 MOVE PC-TSYMSG-00069                             11090052
088800                                   TO DP020-MSG-NUMBER            11100052
088900                 SET DP020-MSG-INFORMATIONAL                      11110052
089000                                   TO TRUE                        11120052
089100             END-IF                                               11130052
089200                                                                  11140052
089300         WHEN OTHER                                               11150052
089400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11160052
089500             PERFORM 2100-CHECK-FUNCTION-KEY                      11170052
089600     END-EVALUATE.                                                11180052
089700                                                                  11190052
089800                                                                  11200052
089900*----------------------------------------------------------------*11210052
090000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11220052
090100*----------------------------------------------------------------*11230052
090200 2050-DELETE-LIST-QUEUE.                                          11240052
090300                                                                  11250052
090400     EXEC CICS                                                    11260052
090500         DELETEQ TS                                               11270052
090600             QUEUE (ASC-LIST-QUEUE-NAME)                          11280052
090700             RESP  (PV-CICS-RESP)                                 11290052
090800     END-EXEC.                                                    11300052
090900                                                                  11310052
091000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11320052
091100        (PV-CICS-RESP = DFHRESP(QIDERR))                          11330052
091200         CONTINUE                                                 11340052
091300     ELSE                                                         11350052
091400         SET DP013-CICS-ABEND      TO TRUE                        11360052
091500         SET DP013-NO-ROLLBACK     TO TRUE                        11370052
091600                                                                  11380052
091700         MOVE '2050-DELETE-LIST-QUEUE'                            11390052
091800                                   TO DP013-PARAGRAPH             11400052
091900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11410052
092000                                   TO DP013-MESSAGE-TEXT (1)      11420052
092100         PERFORM DP013-0000-PROCESS-ABEND                         11430052
092200     END-IF.                                                      11440052
092300                                                                  11450052
092400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11460052
092500                                                                  11470052
092600                                                                  11480052
092700*----------------------------------------------------------------*11490052
092800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11500052
092900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11510052
093000* CICS ARCHITECTURE API.                                         *11520052
093100*----------------------------------------------------------------*11530052
093200 2100-CHECK-FUNCTION-KEY.                                         11540052
093300                                                                  11550052
093400     EVALUATE TRUE                                                11560052
093500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11570052
093600             MOVE +1               TO PV-TOP-ITEM                 11580052
093700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11590052
093800             PERFORM 3200-RESET-ATTRIBUTES                        11600052
093900                                                                  11610052
094000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11620052
094100             PERFORM 2110-BROWSE-BACKWARD                         11630052
094200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11640052
094300             PERFORM 3200-RESET-ATTRIBUTES                        11650052
094400                                                                  11660052
094500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11670052
094600             PERFORM 2120-BROWSE-FORWARD                          11680052
094700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11690052
094800             PERFORM 3200-RESET-ATTRIBUTES                        11700052
094900                                                                  11710052
095000         WHEN DP020-SRC-AID = DP016-ENTER                         11720052
095100             PERFORM 2150-CHECK-FOR-JUMP-BROWSE                   11730052
095200             IF PS-ERROR                                          11740052
095300                 CONTINUE                                         11750052
095400             ELSE                                                 11760052
095500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11770052
095600                 PERFORM 3200-RESET-ATTRIBUTES                    11780052
095700             END-IF                                               11790052
095800                                                                  11800052
095900         WHEN OTHER                                               11810052
096000             SET DP013-NO-ROLLBACK                                11820052
096100                 DP013-XCTL-DISPLAY-RESTART                       11830052
096200                 DP013-CICS-ABEND  TO TRUE                        11840052
096300             MOVE '2100-CHECK-FUNCTION-KEY'                       11850052
096400                                   TO DP013-PARAGRAPH             11860052
096500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11870052
096600                                   TO DP013-MESSAGE-TEXT (1)      11880052
096700             PERFORM DP013-0000-PROCESS-ABEND                     11890052
096800     END-EVALUATE.                                                11900052
096900                                                                  11910052
097000                                                                  11920052
097100*----------------------------------------------------------------*11930052
097200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11940052
097300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11950052
097400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11960052
097500*    MESSAGE.                                                    *11970052
097600*----------------------------------------------------------------*11980052
097700 2110-BROWSE-BACKWARD.                                            11990052
097800                                                                  12000052
097900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12010052
098000         GIVING PV-TOP-ITEM.                                      12020052
098100                                                                  12030052
098200     IF  ((PV-TOP-ITEM < +1)                                      12040052
098300       OR (PV-TOP-ITEM = +1))                                     12050052
098400         MOVE +1                   TO PV-TOP-ITEM                 12060052
098500*        -- TOP OF LIST --                                        12070052
098600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12080052
098700         SET DP020-MSG-INFORMATIONAL                              12090052
098800                                   TO TRUE                        12100052
098900     END-IF.                                                      12110052
099000                                                                  12120052
099100                                                                  12130052
099200*----------------------------------------------------------------*12140052
099300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12150052
099400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12160052
099500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12170052
099600*----------------------------------------------------------------*12180052
099700 2120-BROWSE-FORWARD.                                             12190052
099800                                                                  12200052
099900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12210052
100000         GIVING PV-TOP-ITEM.                                      12220052
100100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12230052
100200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12240052
100300                                   TO PV-TOP-ITEM                 12250052
100400*        -- BOTTOM OF LIST --                                     12260052
100500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12270052
100600         SET DP020-MSG-INFORMATIONAL                              12280052
100700                                   TO TRUE                        12290052
100800     ELSE                                                         12300052
100900         COMPUTE PV-BOTTOM-ITEM =                                 12310052
101000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12320052
101100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12330052
101200*            -- BOTTOM OF LIST --                                 12340052
101300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12350052
101400             SET DP020-MSG-INFORMATIONAL                          12360052
101500                                   TO TRUE                        12370052
101600         END-IF                                                   12380052
101700     END-IF.                                                      12390052
101800                                                                  12400052
101900                                                                  12410052
102000******************************************************************12420052
102100** GET THE PO AND PO LINE NBR THE NEXT SELECTED                 **12430052
102200** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **12440052
102300******************************************************************12450052
102400 2130-GET-NEXT-PO-LINE.                                           12460052
102500                                                                  12470052
102600     ADD +1                        TO ASC-SEL-SUB.                12480052
102700     IF  ASC-SEL-SUB > PO012-MAX-ITEMS                            12490052
102800         ADD +1                    TO ASC-SEL-ITEM                12500052
102900         MOVE +1                   TO ASC-SEL-SUB                 12510052
103000     END-IF.                                                      12520052
103100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                12530052
103200         PERFORM 9100-READ-SEL-QUEUE                              12540052
103300         IF  PO012-PO-LNE-NBR (ASC-SEL-SUB) > ZERO                12550052
103400             MOVE PO013-PO-NBR                                    12560052
103500                                   TO ASC-KEY-PO-NBR              12570052
103600             MOVE PO012-PO-LNE-NBR (ASC-SEL-SUB)                  12580052
103700                                   TO ASC-KEY-PO-LINE-NBR         12590052
103800             IF PO012-APP-PO-LNE-NBR (ASC-SEL-SUB)> 0             12600052
103900                 MOVE PO012-APP-PO-LNE-NBR (ASC-SEL-SUB)          12610052
104000                                   TO ASC-PO-LNE-NBR              12620052
104100             ELSE                                                 12630052
104200                 MOVE PO012-PO-LNE-VAR-NBR (ASC-SEL-SUB)          12640052
104300                                   TO ASC-PO-LNE-NBR              12650052
104400             END-IF                                               12660052
104500             SET PO012-INQ (ASC-SEL-SUB)                          12670052
104600                                   TO TRUE                        12680052
104700             PERFORM 9200-REWRITE-LIST-QUEUE                      12690052
104800         ELSE                                                     12700052
104900             SUBTRACT +1 FROM ASC-SEL-SUB                         12710052
105000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12720052
105100             SET DP020-MSG-INFORMATIONAL                          12730052
105200                                   TO TRUE                        12740052
105300         END-IF                                                   12750052
105400     ELSE                                                         12760052
105500         SUBTRACT +1 FROM ASC-SEL-ITEM                            12770052
105600         MOVE PO012-MAX-ITEMS      TO ASC-SEL-SUB                 12780052
105700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12790052
105800         SET DP020-MSG-INFORMATIONAL                              12800052
105900                                   TO TRUE                        12810052
106000     END-IF.                                                      12820052
106100                                                                  12830052
106200                                                                  12840052
106300******************************************************************12850052
106400** GET THE PO NBR AND PO LINE NBR OF PREVIOUS SELECTED          **12860052
106500** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **12870052
106600******************************************************************12880052
106700 2140-GET-PREV-PO-LINE.                                           12890052
106800                                                                  12900052
106900     SUBTRACT +1 FROM ASC-SEL-SUB.                                12910052
107000     IF  ASC-SEL-SUB < +1                                         12920052
107100         SUBTRACT +1 FROM ASC-SEL-ITEM                            12930052
107200         MOVE PO012-MAX-ITEMS      TO ASC-SEL-SUB                 12940052
107300     END-IF.                                                      12950052
107400                                                                  12960052
107500     IF  ASC-SEL-ITEM > ZERO                                      12970052
107600         PERFORM 9100-READ-SEL-QUEUE                              12980052
107700         MOVE PO013-PO-NBR                                        12990052
107800                                   TO ASC-KEY-PO-NBR              13000052
107900         MOVE PO012-PO-LNE-NBR (ASC-SEL-SUB)                      13010052
108000                                   TO ASC-KEY-PO-LINE-NBR         13020052
108100         IF PO012-APP-PO-LNE-NBR (ASC-SEL-SUB) > 0                13030052
108200             MOVE PO012-APP-PO-LNE-NBR (ASC-SEL-SUB)              13040052
108300                                   TO ASC-PO-LNE-NBR              13050052
108400         ELSE                                                     13060052
108500             MOVE PO012-PO-LNE-VAR-NBR (ASC-SEL-SUB)              13070052
108600                                   TO ASC-PO-LNE-NBR              13080052
108700         END-IF                                                   13090052
108800     ELSE                                                         13100052
108900         MOVE +1                   TO ASC-SEL-ITEM                13110052
109000                                      ASC-SEL-SUB                 13120052
109100*        --- TOP OF LIST ---                                      13130052
109200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13140052
109300         SET DP020-MSG-INFORMATIONAL                              13150052
109400                                   TO TRUE                        13160052
109500     END-IF.                                                      13170052
109600                                                                  13180052
109700                                                                  13190052
109800*----------------------------------------------------------------*13200052
109900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13210052
110000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13220052
110100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13230052
110200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13240052
110300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13250052
110400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13260052
110500*----------------------------------------------------------------*13270052
110600 2150-CHECK-FOR-JUMP-BROWSE.                                      13280052
110700                                                                  13290052
110800     SET PS-NO-ERROR               TO TRUE.                       13300052
110900     IF (ASC-START-ITEM-REQUEST = SPACE)                          13310052
111000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13320052
111100                                   TO PV-TOP-ITEM                 13330052
111200     ELSE                                                         13340052
111300         MOVE ASC-START-ITEM-REQUEST                              13350052
111400                                   TO DP010I-UNEDITED-FIELD       13360052
111500         MOVE PC-ITM-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13370052
111600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13380052
111700         SET DP010I-NEGATIVE-NOT-ALLOWED                          13390052
111800                                   TO TRUE                        13400052
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13411068
263126              USING DP010I-NUMERIC-EDIT-AREA                      13412068
112000                                                                  13420052
112100         IF  NOT DP010I-ERROR-DETECTED                            13430052
112200             MOVE DP010I-NUMERIC-FIELD                            13440052
112300                                   TO  ASC-START-ITEM-REQUEST-N   13450052
112400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13460052
112500                 IF  ASC-START-ITEM-REQUEST-N >                   13470052
112600                                          ASC-NUMBER-OF-ITEMS-READ13480052
112700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13490052
112800                     COMPUTE PV-TOP-ITEM =                        13500052
112900                             ASC-NUMBER-OF-ITEMS-READ             13510052
113000                             - PC-ITEMS-PER-PANEL + 1             13520052
113100                     IF  PV-TOP-ITEM < +1                         13530052
113200                         MOVE +1   TO PV-TOP-ITEM                 13540052
113300                         MOVE PC-TSYMSG-00070                     13550052
113400                                   TO DP020-MSG-NUMBER            13560052
113500                         SET DP020-MSG-INFORMATIONAL              13570052
113600                                   TO TRUE                        13580052
113700                     END-IF                                       13590052
113800                 ELSE                                             13600052
113900                     MOVE ASC-START-ITEM-REQUEST-N                13610052
114000                                   TO PV-TOP-ITEM                 13620052
114100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13630052
114200                     COMPUTE PV-BOTTOM-ITEM =                     13640052
114300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13650052
114400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13660052
114500*                        -- BOTTOM OF LIST --                     13670052
114600                         MOVE PC-TSYMSG-00070                     13680052
114700                                   TO DP020-MSG-NUMBER            13690052
114800                         SET DP020-MSG-INFORMATIONAL              13700052
114900                                   TO TRUE                        13710052
115000                     END-IF                                       13720052
115100                 END-IF                                           13730052
115200             ELSE                                                 13740052
115300*                --- VALUE OUT OF RANGE ----                      13750052
115400                 MOVE PC-TSYMSG-00101                             13760052
115500                                   TO DP020-MSG-NUMBER            13770052
115600                 MOVE -1           TO ASTRTITL                    13780052
115700                 SET DP030-SET-CURSOR-APPL-1                      13790052
115800                                   TO TRUE                        13800052
115900                 MOVE DP015-REVERSE                               13810052
116000                                   TO ASTRTITH                    13820052
116100                 MOVE DP015-RED    TO ASTRTITC                    13830052
116200                 MOVE DP015-UNP-NUM-BRT-MDT                       13840052
116300                                   TO ASTRTITA                    13850052
116400                 SET DP020-MSG-FATAL                              13860052
116500                                   TO TRUE                        13870052
116600                 SET PS-ERROR      TO TRUE                        13880052
116700             END-IF                                               13890052
116800                                                                  13900052
116900         ELSE                                                     13910052
117000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13920052
117100             MOVE -1               TO ASTRTITL                    13930052
117200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13940052
117300             MOVE DP015-REVERSE    TO ASTRTITH                    13950052
117400             MOVE DP015-RED        TO ASTRTITC                    13960052
117500             MOVE DP015-UNP-NUM-BRT-MDT                           13970052
117600                                   TO ASTRTITA                    13980052
117700             SET DP020-MSG-FATAL   TO TRUE                        13990052
117800             SET PS-ERROR          TO TRUE                        14000052
117900         END-IF                                                   14010052
118000     END-IF.                                                      14020052
118100                                                                  14030052
118200                                                                  14040052
118300******************************************************************14050052
118400** GET THE PO AND PO LINE NBR FROM THE NEXT SELECTED            **14060052
118500** OBJECT FROM THE PKSL SELECTED-ITEMS TEMP. STORAGE QUEUE.     **14070052
118600******************************************************************14080052
118700 2160-GET-NEXT-PKSL-PO-LINE.                                      14090052
118800                                                                  14100052
118900     ADD +1                        TO ASC-SEL-SUB.                14110052
119000                                                                  14120052
119100     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            14130052
119200         ADD +1                    TO ASC-SEL-ITEM                14140052
119300         MOVE +1                   TO ASC-SEL-SUB                 14150052
119400     END-IF.                                                      14160052
119500                                                                  14170052
119600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14180052
119700         PERFORM 9300-READ-PKSL-SEL-QUEUE                         14190052
119800         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      14200052
119900             MOVE RC015-PO-NBR                                    14210052
120000                                   TO ASC-KEY-PO-NBR              14220052
120100             MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)              14230052
120200                                   TO ASC-KEY-PO-LINE-NBR         14240052
120300*?????                                ASC-PO-LNE-NBR              14250052
120400             SET RC013-INQ (ASC-SEL-SUB)                          14260052
120500                                   TO TRUE                        14270052
120600             PERFORM 9400-REWRITE-PKSL-LIST-QUEUE                 14280052
120700         ELSE                                                     14290052
120800             SUBTRACT +1 FROM ASC-SEL-SUB                         14300052
120900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14310052
121000             SET DP020-MSG-INFORMATIONAL                          14320052
121100                                   TO TRUE                        14330052
121200         END-IF                                                   14340052
121300     ELSE                                                         14350052
121400         SUBTRACT +1 FROM ASC-SEL-ITEM                            14360052
121500         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14370052
121600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14380052
121700         SET DP020-MSG-INFORMATIONAL                              14390052
121800                                   TO TRUE                        14400052
121900     END-IF.                                                      14410052
122000                                                                  14420052
122100                                                                  14430052
122200******************************************************************14440052
122300** GET THE PO AND PO LINE NBR FROM THE NEXT SELECTED            **14450052
122400** OBJECT FROM THE SKU ORDERED SCREEN TEMP STORAGE QUEUE.       **14460052
122500******************************************************************14470052
122600 2180-GET-NEXT-SKU-RECEIVER.                                      14480052
122700                                                                  14490052
122800     ADD +1                        TO ASC-SEL-SUB.                14500052
122900                                                                  14510052
123000     IF  ASC-SEL-SUB > PO070-MAX-ITEMS                            14520052
123100         ADD +1                    TO ASC-SEL-ITEM                14530052
123200         MOVE +1                   TO ASC-SEL-SUB                 14540052
123300     END-IF.                                                      14550052
123400                                                                  14560052
123500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14570052
123600         PERFORM 9500-READ-SKU-RCVR-SEL-QUEUE                     14580052
123700         IF  PO070-ITEM (ASC-SEL-SUB) > ZERO                      14590052
123800             MOVE PO070-PO-NBR (ASC-SEL-SUB)                      14600052
123900                                   TO ASC-KEY-PO-NBR              14610052
124000             MOVE PO070-LINE (ASC-SEL-SUB)                        14620052
124100                                   TO ASC-KEY-PO-LINE-NBR         14630052
124200                                      ASC-PO-LNE-NBR              14640052
124300             PERFORM 9600-REWRITE-RCVR-LIST-QUEUE                 14650052
124400         ELSE                                                     14660052
124500             SUBTRACT +1 FROM ASC-SEL-SUB                         14670052
124600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14680052
124700             SET DP020-MSG-INFORMATIONAL                          14690052
124800                                   TO TRUE                        14700052
124900         END-IF                                                   14710052
125000     ELSE                                                         14720052
125100         SUBTRACT +1 FROM ASC-SEL-ITEM                            14730052
125200         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14740052
125300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14750052
125400         SET DP020-MSG-INFORMATIONAL                              14760052
125500                                   TO TRUE                        14770052
125600     END-IF.                                                      14780052
125700                                                                  14790052
125800******************************************************************14800052
125900** GET THE PO NBR AND PO LINE NBR OF PREVIOUS SELECTED          **14810052
126000** OBJECT FROM THE PKSL SELECTED-ITEMS TEMP. STORAGE QUEUE.     **14820052
126100******************************************************************14830052
126200 2170-GET-PREV-PKSL-PO-LINE.                                      14840052
126300                                                                  14850052
126400     SUBTRACT +1 FROM ASC-SEL-SUB.                                14860052
126500                                                                  14870052
126600     IF  ASC-SEL-SUB < +1                                         14880052
126700         SUBTRACT +1 FROM ASC-SEL-ITEM                            14890052
126800         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 14900052
126900     END-IF.                                                      14910052
127000                                                                  14920052
127100     IF  ASC-SEL-ITEM > ZERO                                      14930052
127200         PERFORM 9300-READ-PKSL-SEL-QUEUE                         14940052
127300         MOVE RC015-PO-NBR         TO ASC-KEY-PO-NBR              14950052
127400         MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)                  14960052
127500                                   TO ASC-KEY-PO-LINE-NBR         14970052
127600*?????                                ASC-PO-LNE-NBR              14980052
127700     ELSE                                                         14990052
127800         MOVE +1                   TO ASC-SEL-ITEM                15000052
127900                                      ASC-SEL-SUB                 15010052
128000*        --- TOP OF LIST ---                                      15020052
128100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15030052
128200         SET DP020-MSG-INFORMATIONAL                              15040052
128300                                   TO TRUE                        15050052
128400     END-IF.                                                      15060052
128500                                                                  15070052
128600                                                                  15080052
128700******************************************************************15090052
128800** GET THE PO NBR AND PO LINE NBR OF PREVIOUS SELECTED          **15100052
128900** OBJECT FROM THE SKU RECEIVER TEMP STORAGE QUEUE.             **15110052
129000******************************************************************15120052
129100 2190-GET-PREV-SKU-RECEIVER.                                      15130052
129200                                                                  15140052
129300     SUBTRACT +1 FROM ASC-SEL-SUB.                                15150052
129400                                                                  15160052
129500     IF  ASC-SEL-SUB < +1                                         15170052
129600         SUBTRACT +1 FROM ASC-SEL-ITEM                            15180052
129700         MOVE PO070-MAX-ITEMS      TO ASC-SEL-SUB                 15190052
129800     END-IF.                                                      15200052
129900                                                                  15210052
130000     IF  ASC-SEL-ITEM > ZERO                                      15220052
130100         PERFORM 9500-READ-SKU-RCVR-SEL-QUEUE                     15230052
130200         MOVE PO070-PO-NBR (ASC-SEL-SUB)                          15240052
130300                                   TO ASC-KEY-PO-NBR              15250052
130400         MOVE PO070-LINE (ASC-SEL-SUB)                            15260052
130500                                   TO ASC-KEY-PO-LINE-NBR         15270052
130600                                      ASC-PO-LNE-NBR              15280052
130700     ELSE                                                         15290052
130800         MOVE +1                   TO ASC-SEL-ITEM                15300052
130900                                      ASC-SEL-SUB                 15310052
131000*        --- TOP OF LIST ---                                      15320052
131100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15330052
131200         SET DP020-MSG-INFORMATIONAL                              15340052
131300                                   TO TRUE                        15350052
131400     END-IF.                                                      15360052
131500                                                                  15370052
131600                                                                  15380052
131700******************************************************************15390052
131800** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **15400052
131900** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **15410052
132000******************************************************************15420052
132100 2200-MOVE-SCREEN-TO-COMMAREA.                                    15430052
132200                                                                  15440052
132300     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15450052
132400     MOVE +1                       TO PV-SUB.                     15460052
132500                                                                  15470052
132600     IF ASTRTITL > ZERO                                           15480052
132700         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      15490052
132800     ELSE                                                         15500052
132900         IF ASTRTITF = DP015-ERASE-EOF                            15510052
133000             INITIALIZE ASC-START-ITEM-REQUEST                    15520052
133100         END-IF                                                   15530052
133200     END-IF.                                                      15540052
133300                                                                  15550052
133400                                                                  15560052
133500******************************************************************15570052
133600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **15580052
133700******************************************************************15590052
133800 3200-RESET-ATTRIBUTES.                                           15600052
133900                                                                  15610052
134000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15620052
134100     MOVE DP015-GREEN              TO ASTRTITC.                   15630052
134200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15640052
134300                                                                  15650052
134400                                                                  15660052
134500*----------------------------------------------------------------*15670052
134600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *15680052
134700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *15690052
134800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *15700052
134900*    DISPLAY THE PANEL TO USER.                                  *15710052
135000*----------------------------------------------------------------*15720052
135100 4000-BUILD-INITIAL-PANEL.                                        15730052
135200                                                                  15740052
135300     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             15750052
135400                                ASC-BLOCK-ENTRIES (2).            15760052
135500     MOVE +1                       TO ASC-BLK-SUB.                15770052
135600     SET PS-NOT-EOF-DATE-CSR                                      15780052
135700         PS-NOT-EOF-DC-CSR                                        15790052
135800         PS-NOT-EOF-AR-CSR         TO TRUE.                       15800052
135900                                                                  15810052
136000     MOVE +0                       TO ASC-ITEM-SUB                15820052
136100                                      ASC-NUMBER-OF-ITEMS-READ    15830052
136200                                      ASC-HIGHEST-BLOCK-WRITTEN   15840052
136300                                      ASC-ITEM-AT-TOP-OF-PANEL    15850052
136400                                      ASC-TOT-SHIP-QTY            15860052
136500                                      PV-SAVE-STR-NBR.            15870052
136600                                                                  15880052
136700     PERFORM 4050-GET-OTHER-SCREEN-FIELDS.                        15890052
136800     IF SQLCODE = +100                                            15900052
136900         SET DP020-NEXT-ACT-APPL-ERROR                            15910052
137000                                   TO TRUE                        15920052
137100         SET DP020-MSG-FATAL       TO TRUE                        15930052
137200         MOVE PC-TSYMSG-00083      TO DP020-MSG-NUMBER            15940052
137300     ELSE                                                         15950052
137400         IF  ASC-INTER-APPL-PKSL                                  15960052
137500             MOVE ASC-PKSL-APP-PO-LNE-NBR                         15970052
137600                                   TO ASC-PO-LNE-NBR              15980052
137700         END-IF                                                   15990052
137800         PERFORM 4100-GET-DATES                                   16000052
137900         IF ASC-DIR-STR-IND = 'Y'                                 16010052
138000             CONTINUE                                             16020052
138100         ELSE                                                     16030052
138200             PERFORM 4200-GET-DC                                  16040052
138300         END-IF                                                   16050052
138400         PERFORM 4300-GET-ALLOCS-RCPTS                            16060052
138500         MOVE +1                   TO PV-TOP-ITEM                 16070052
138600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     16080052
138700     END-IF.                                                      16090052
138800                                                                  16100052
138802*----------------------------------------------------------------*16110052
138803* OPEN  THE DC NAME CURSOR                                       *16120052
138804*----------------------------------------------------------------*16130052
138805 4010-OPEN-DC-NAME-CSR.                                           16140052
138806                                                                  16150052
138807     PERFORM                                                      16160052
138808         WITH TEST AFTER                                          16170052
138809         VARYING PV-RETRY-COUNTER                                 16180052
138810         FROM 1 BY 1                                              16190052
138811         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16200052
138812                   OR (SQLCODE = ZERO))                           16210052
138813                                                                  16220052
138814                 EXEC SQL                                         16230052
138815                      OPEN DC-NAME-CSR                            16240052
138816                 END-EXEC                                         16250052
138817                                                                  16260052
138818         EVALUATE TRUE                                            16270052
138819             WHEN SQLCODE = ZERO                                  16280052
138820             WHEN SQLCODE = -904                                  16290052
138821             WHEN SQLCODE = -913                                  16300052
138822                 CONTINUE                                         16310052
138823             WHEN SQLWARN0 NOT = SPACES                           16320052
138824             WHEN SQLCODE < ZERO                                  16330052
138825             WHEN SQLCODE > ZERO                                  16340052
138826                 MOVE '4010-OPEN-DC-NAME-CURSOR'                  16350052
138827                                   TO DP013-PARAGRAPH             16360052
138828                 MOVE 'OPEN DC NAME CURSOR - '                    16370052
138829                                   TO DP013-MESSAGE-TEXT (1)      16380052
138830                 MOVE SQLCA        TO DP013-SQLCA                 16390052
138831                 MOVE 'XMT_LOC '   TO DP013-DB2-TABLE-NAME (1)    16400054
138831                 MOVE 'XMT_DC_LOC_ASGMT '                         16410054
138831                                   TO DP013-DB2-TABLE-NAME (2)    16420054
138832                 SET DP013-DB2-ABEND                              16430052
138833                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16440052
138834                 PERFORM DP013-0000-PROCESS-ABEND                 16450052
138835         END-EVALUATE                                             16460052
138836     END-PERFORM.                                                 16470052
138837                                                                  16480052
138838     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16490052
138839         MOVE '4010-OPEN-DC-NAME CSR'   TO DP013-PARAGRAPH        16500052
138840         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   16510052
138841                                   TO DP013-MESSAGE-TEXT (1)      16520052
138842         MOVE SQLCA                TO DP013-SQLCA                 16530052
138843         MOVE 'XMT_LOC '           TO DP013-DB2-TABLE-NAME (1)    16540054
138843         MOVE 'XMT_DC_LOC_ASGMT'   TO DP013-DB2-TABLE-NAME (2)    16550054
138844         SET DP013-DB2-ABEND                                      16560054
138845             DP013-XCTL-DISPLAY-RESTART                           16570054
138846                                   TO TRUE                        16580054
138847         PERFORM DP013-0000-PROCESS-ABEND                         16590054
138848     END-IF.                                                      16600054
138849                                                                  16610054
138850                                                                  16620054
138851*----------------------------------------------------------------*16630054
138852* PROCESS THE DC NAME CURSOR                                     *16640054
138853*----------------------------------------------------------------*16650054
138854                                                                  16660054
138855 4015-PROCESS-DC-NAME-CSR.                                        16670054
138856                                                                  16680054
138857     PERFORM VARYING PV-DC-COUNT                                  16690054
138858        FROM 1 BY 1                                               16700054
138859       UNTIL PS-END-OF-DC OR PS-TABLE-OVERFLOW                    16710054
138860                                                                  16720054
138861           PERFORM 4016-FETCH-DC-NAME-CSR                         16730054
138862           IF PS-END-OF-DC                                        16740054
138863               CONTINUE                                           16750054
138864           ELSE                                                   16760054
138865* IF WE HAVE MORE THAN 30 DIST CENTERS, BUMP THE NUMBER UP FROM   16770064
138866* 10 TO THE NUMBER OF OCCURS IN THE ASC-DC-TABLE.                 16780054
138867               IF PV-DC-COUNT > 30                                16790064
138868                   SET PS-TABLE-OVERFLOW TO TRUE                  16800054
138869               ELSE                                               16810054
138870                   MOVE XMT00001-LOC-NBR                          16820054
138871                     TO ASC-DC-NBR (PV-DC-COUNT)                  16830054
138872                   MOVE XMT00001-LOC-5-ABBR-NM                    16840054
138873                     TO ASC-DC-NAME (PV-DC-COUNT)                 16850054
138874               END-IF                                             16860054
138875           END-IF                                                 16870054
138876     END-PERFORM.                                                 16880054
138877                                                                  16890054
138878*----------------------------------------------------------------*16900054
138879*    FETCH THE DC NAME CURSOR                                    *16910054
138880*----------------------------------------------------------------*16920054
138881                                                                  16930054
138882 4016-FETCH-DC-NAME-CSR.                                          16940054
138883                                                                  16950054
138884     EXEC SQL                                                     16960054
138885          FETCH DC-NAME-CSR                                       16970054
138886          INTO  :XMT00001-LOC-NBR,                                16980054
138887                :XMT00001-LOC-5-ABBR-NM                           16990054
138888     END-EXEC.                                                    17000054
138889                                                                  17010054
138890     EVALUATE TRUE                                                17020054
138891         WHEN SQLCODE = ZERO                                      17030054
138892              CONTINUE                                            17040054
138893         WHEN SQLCODE = +100                                      17050054
138894              SET PS-END-OF-DC TO TRUE                            17060054
138895         WHEN SQLWARN0 NOT = SPACE                                17070054
138896         WHEN SQLCODE NOT = ZERO                                  17080054
138897              MOVE '4016-FETCH-DC-NAME-CSR'                       17090054
138898                                   TO DP013-PARAGRAPH             17100054
138899              MOVE 'FETCH DC NAME CURSOR'                         17110054
138900                                   TO DP013-MESSAGE-TEXT (1)      17120054
138901              MOVE SQLCA           TO DP013-SQLCA                 17130054
138902              SET DP013-DB2-ABEND                                 17140054
138903                                   TO TRUE                        17150054
138904              PERFORM DP013-0000-PROCESS-ABEND                    17160054
138905     END-EVALUATE.                                                17170054
138906                                                                  17180054
138907*----------------------------------------------------------------*17190054
138908* CLOSE THE DC NAME CURSOR                                       *17200054
138909*----------------------------------------------------------------*17210054
138910 4020-CLOSE-DC-NAME-CSR.                                          17220054
138911                                                                  17230054
138912     EXEC SQL                                                     17240054
138913         CLOSE DC-NAME-CSR                                        17250054
138914     END-EXEC.                                                    17260054
138915                                                                  17270054
138916     EVALUATE TRUE                                                17280054
138917         WHEN SQLCODE = ZERO                                      17290054
138918             CONTINUE                                             17300054
138919         WHEN SQLWARN0 NOT = SPACES                               17310054
138920         WHEN SQLCODE < ZERO                                      17320054
138921         WHEN SQLCODE > ZERO                                      17330054
138922             MOVE '4020-CLOSE-DC-NAME-CSR'                        17340054
138923                                   TO DP013-PARAGRAPH             17350054
138924             MOVE 'CLOSE DC NAME CURSOR '                         17360054
138925                                   TO DP013-MESSAGE-TEXT (1)      17370054
138926             MOVE SQLCA            TO DP013-SQLCA                 17380054
138927             MOVE 'XMT_LOC '          TO DP013-DB2-TABLE-NAME (1) 17390054
138927             MOVE 'XMT_DC_LOC_ASGMT ' TO DP013-DB2-TABLE-NAME (2) 17400054
138928             SET DP013-DB2-ABEND                                  17410054
138929                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17420054
138930             PERFORM DP013-0000-PROCESS-ABEND                     17430054
138931     END-EVALUATE.                                                17440054
138940                                                                  17450054
139000*----------------------------------------------------------------*17460052
139100* GET OTHER SCREEN FIELDS FROM TPURCHS                           *17470052
139200*----------------------------------------------------------------*17480052
139300 4050-GET-OTHER-SCREEN-FIELDS.                                    17490052
139400                                                                  17500052
139500     PERFORM                                                      17510052
139600         WITH TEST AFTER                                          17520052
139700         VARYING PV-RETRY-COUNTER                                 17530052
139800         FROM 1 BY 1                                              17540052
139900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17550052
140000             OR (SQLCODE = ZERO)                                  17560052
140100             OR (SQLCODE = +100))                                 17570052
140200             EXEC SQL                                             17580052
140300                 SELECT A.DEPT_NBR,                               17590052
140400                        A.DIR_STR_IND,                            17600052
140500                        B.ENT_NAME_DESC                           17610052
140600                 INTO :ASC-DPT-NBR,                               17620052
140700                      :ASC-DIR-STR-IND,                           17630052
140800                      :ASC-ENT-NAME-DESC                          17640052
140900                 FROM TPURCHS A,                                  17650052
141000                      TENTNME B                                   17660052
141100                 WHERE A.PO_NBR = :ASC-KEY-PO-NBR                 17670052
141200                   AND A.VER_STATUS_CDE = 'A'                     17680052
141300                   AND B.ENT_ID = A.ENT_ID                        17690052
141400                   AND B.TYPE_CDE = '01'                          17700052
141500             END-EXEC                                             17710052
141600         EVALUATE TRUE                                            17720052
141700             WHEN SQLCODE = ZERO                                  17730052
141800             WHEN SQLCODE = +100                                  17740052
141900             WHEN SQLCODE = -904                                  17750052
142000             WHEN SQLCODE = -913                                  17760052
142100                 CONTINUE                                         17770052
142200             WHEN SQLWARN0 NOT = SPACES                           17780052
142300             WHEN SQLCODE < ZERO                                  17790052
142400             WHEN SQLCODE > ZERO                                  17800052
142500                 MOVE '4050-GET-OTHER-SCREEN-FIELDS'              17810052
142600                                   TO DP013-PARAGRAPH             17820052
142700                 MOVE 'SQL ERROR SELECTING PO'                    17830052
142800                                   TO DP013-MESSAGE-TEXT (1)      17840052
142900                 MOVE SQLCA        TO DP013-SQLCA                 17850052
143000                 MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)    17860052
143100                 SET DP013-DB2-ABEND                              17870052
143200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17880052
143300                 PERFORM DP013-0000-PROCESS-ABEND                 17890052
143400         END-EVALUATE                                             17900052
143500     END-PERFORM.                                                 17910052
143600                                                                  17920052
143700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17930052
143800         MOVE '4050-GET-OTHER-SCREEN-FIELDS'                      17940052
143900                                   TO DP013-PARAGRAPH             17950052
144000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT PO'  17960052
144100                                   TO DP013-MESSAGE-TEXT (1)      17970052
144200         MOVE SQLCA                TO DP013-SQLCA                 17980052
144300         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    17990052
144400         SET DP013-DB2-ABEND                                      18000052
144500             DP013-XCTL-DISPLAY-RESTART                           18010052
144600                                   TO TRUE                        18020052
144700         PERFORM DP013-0000-PROCESS-ABEND                         18030052
144800     END-IF.                                                      18040052
144900                                                                  18050052
145000     IF SQLCODE = ZERO                                            18060052
W24803        INITIALIZE DCLTPURITM                                     18070052
W24803                   DCLXLT00003                                    18080052
W24803                   DCLXLT00004                                    18090052
W24803                   PV-NULL-INDICATORS                             18100052
W24803        MOVE ASC-KEY-PO-NBR      TO PURITM-PO-NBR                 18110052
W24803        MOVE ASC-KEY-PO-LINE-NBR TO PURITM-PO-LNE-NBR             18120052
145100         PERFORM                                                  18130052
145200             WITH TEST AFTER                                      18140052
145300             VARYING PV-RETRY-COUNTER                             18150052
145400             FROM 1 BY 1                                          18160052
145500             UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)           18170052
145600                 OR (SQLCODE = ZERO)                              18180052
145700                 OR (SQLCODE = +100))                             18190052
145800                 EXEC SQL                                         18200052
W24803                     SELECT S.SKU_NBR,                            18210052
W24803                            V.MAJ_CL_NBR,                         18220052
W24803                            V.SUB_CL_NBR,                         18230052
W24803                            S.SKU_DESC,                           18240052
W24803                            V.VS_NBR,                             18250052
W24803                            S.CSTM_CLOR_DESC,                     18260052
W24803                            S.SIZE_DESC,                          18270052
W24803                            CL_NBR,                               18280052
W24803                            SKU_SEQ_NBR,                          18290052
W24803                            A.SKU_DESC,                           18300052
W24803                            VEND_STYL_NAME,                       18310052
W24803                            COLOR_DESC,                           18320052
W24803                            A.SIZE_DESC,                          18330052
146500                            A.UNT_QTY,                            18340052
146600                            A.APP_PO_LNE_NBR                      18350052
W24803                     INTO :XLT00003-SKU-NBR:PV-SKU-NBR-IND,       18360052
W24803                          :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND, 18370052
W24803                          :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND, 18380052
W24803                          :XLT00003-SKU-DESC:PV-SKU-DESC,         18390052
W24803                          :XLT00004-VS-NBR:PV-VS-NBR,             18400052
W24803                       :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC,18410052
W24803                          :XLT00003-SIZE-DESC:PV-SIZE-DESC,       18420052
W24803                          :PURITM-CL-NBR,                         18430052
W24803                          :PURITM-SKU-SEQ-NBR,                    18440052
W24803                          :PURITM-SKU-DESC,                       18450052
W24803                          :PURITM-VEND-STYL-NAME,                 18460052
W24803                          :PURITM-COLOR-DESC,                     18470052
W24803                          :PURITM-SIZE-DESC,                      18480052
W24803                          :PURITM-UNT-QTY,                        18490052
W24803                          :PURITM-APP-PO-LNE-NBR                  18500052
147500                     FROM TPURITM A                               18510052
W24803                     LEFT OUTER JOIN                              18520052
W24803                          XLT_SKU S                               18530052
W24803                     ON   A.ITM_NBR = S.ITM_NBR                   18540052
W24803                     LEFT OUTER JOIN                              18550052
W24803                          XLT_VND_STYL V                          18560052
W24803                     ON   S.STYL_ID = V.STYL_ID                   18570052
W24803                     WHERE A.PO_NBR         = :PURITM-PO-NBR      18580052
147700                       AND A.VER_STATUS_CDE = 'A'                 18590052
W24803                       AND A.PO_LNE_NBR     = :PURITM-PO-LNE-NBR  18600052
147900                 END-EXEC                                         18610052
148000             EVALUATE TRUE                                        18620052
148100                 WHEN SQLCODE = ZERO                              18630052
148200                 WHEN SQLCODE = +100                              18640052
W24803                    IF PV-SKU-NBR-IND = +0                        18650052
W24803                      MOVE XLT00003-SKU-NBR                       18660052
W24803                                   TO ASC-SKU-NBR                 18670052
W24803                      MOVE XLT00004-MAJ-CL-NBR                    18680052
W24803                                   TO ASC-MAJ-CL-NBR              18690052
W24803                      MOVE XLT00004-SUB-CL-NBR                    18700052
W24803                                   TO ASC-SUB-CL-NBR              18710052
W24803                      MOVE XLT00003-SKU-DESC                      18720052
W24803                                   TO ASC-SKU-DESC                18730052
W24803                      MOVE XLT00004-VS-NBR                        18740052
W24803                                   TO ASC-VEND-STYL-NAME          18750052
W24803                      MOVE XLT00003-CSTM-CLOR-DESC                18760052
W24803                                   TO ASC-COLOR-DESC              18770052
W24803                      MOVE XLT00003-SIZE-DESC                     18780052
W24803                                   TO ASC-SIZE-DESC               18790052
W24803                    ELSE                                          18800052
W24803                      MOVE PURITM-CL-NBR                          18810052
W24803                                   TO ASC-SUB-CL-NBR              18820052
W24803                                      PV-TEMP-CLASS               18830052
W24803                      MOVE PURITM-CL-NBR (1:1)                    18840052
W24803                                   TO PV-MAJ-CL-1                 18850052
W24803                      MOVE PV-MAJ-CLASS                           18860052
W24803                                   TO ASC-MAJ-CL-NBR              18870052
W24803                      MOVE ASC-DPT-NBR                            18880052
W24803                                   TO PV-TEMP-DEPT                18890052
W24803                      MOVE PURITM-SKU-SEQ-NBR                     18900052
W24803                                   TO PV-TEMP-SEQ                 18910052
W24803                      MOVE PV-SKU  TO ASC-SKU-NBR                 18920052
W24803                      MOVE PURITM-SKU-DESC                        18930052
W24803                                   TO ASC-SKU-DESC                18940052
W24803                      MOVE PURITM-VEND-STYL-NAME                  18950052
W24803                                   TO ASC-VEND-STYL-NAME          18960052
W24803                      MOVE PURITM-COLOR-DESC                      18970052
W24803                                   TO ASC-COLOR-DESC              18980052
W24803                      MOVE PURITM-SIZE-DESC                       18990052
W24803                                   TO ASC-SIZE-DESC               19000052
W24803                    END-IF                                        19010052
W24803                    MOVE PURITM-UNT-QTY                           19020052
W24803                                   TO ASC-UNIT-QTY                19030052
W24803                    MOVE PURITM-APP-PO-LNE-NBR                    19040052
W24803                                   TO ASC-PKSL-APP-PO-LNE-NBR     19050052
148300                 WHEN SQLCODE = -904                              19060052
148400                 WHEN SQLCODE = -913                              19070052
148500                     CONTINUE                                     19080052
148600                 WHEN SQLWARN0 NOT = SPACES                       19090052
148700                 WHEN SQLCODE < ZERO                              19100052
148800                 WHEN SQLCODE > ZERO                              19110052
148900                     MOVE '4050-GET-OTHER-SCREEN-FIELDS'          19120052
149000                                   TO DP013-PARAGRAPH             19130052
149100                     MOVE 'SQL ERROR SELECTING PO LINE'           19140052
149200                                   TO DP013-MESSAGE-TEXT (1)      19150052
149300                     MOVE SQLCA    TO DP013-SQLCA                 19160052
149400                     MOVE 'TPURITM '                              19170052
149500                                   TO DP013-DB2-TABLE-NAME (1)    19180052
W24803                     MOVE 'XLT_SKU '                              19190052
W24803                                   TO DP013-DB2-TABLE-NAME (2)    19200052
W24803                     MOVE 'XLT_VND_STYL '                         19210052
W24803                                   TO DP013-DB2-TABLE-NAME (3)    19220052
149600                     SET DP013-DB2-ABEND                          19230052
149700                         DP013-XCTL-DISPLAY-RESTART               19240052
149800                                   TO TRUE                        19250052
149900                     PERFORM DP013-0000-PROCESS-ABEND             19260052
150000             END-EVALUATE                                         19270052
150100         END-PERFORM                                              19280052
150200                                                                  19290052
150300         IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                    19300052
150400             MOVE '4050-GET-OTHER-SCREEN-FIELDS'                  19310052
150500                                   TO DP013-PARAGRAPH             19320052
150600             MOVE 'MAX RETRIES EXCEED ATTEMPTING TO SELECT SKU'   19330052
150700                                   TO DP013-MESSAGE-TEXT (1)      19340052
150800             MOVE SQLCA            TO DP013-SQLCA                 19350052
150900             MOVE 'TPURITM '       TO DP013-DB2-TABLE-NAME (1)    19360052
W24803             MOVE 'XLT_SKU '       TO  DP013-DB2-TABLE-NAME (2)   19370052
W24803             MOVE 'XLT_VND_STYL'  TO  DP013-DB2-TABLE-NAME (3)    19380052
151000             SET DP013-DB2-ABEND                                  19390052
151100                 DP013-XCTL-DISPLAY-RESTART                       19400052
151200                                   TO TRUE                        19410052
151300             PERFORM DP013-0000-PROCESS-ABEND                     19420052
151400         END-IF                                                   19430052
151500     END-IF.                                                      19440052
151600                                                                  19450052
151700                                                                  19460052
151800*----------------------------------------------------------------*19470052
151900* CONTROLS PROCESSING OF OBTAINING RECEIVE DATES                 *19480052
152000*----------------------------------------------------------------*19490052
152100 4100-GET-DATES.                                                  19500052
152200                                                                  19510052
152300     PERFORM 4110-OPEN-DATE-CSR.                                  19520052
152400     INITIALIZE PV-DATE-TABLE                                     19530052
152500                ASC-DATE-TABLE.                                   19540052
152600     MOVE +1                       TO PV-SUB.                     19550052
152700     PERFORM 4120-PROCESS-DATE-CSR                                19560052
152800         UNTIL PS-EOF-DATE-CSR.                                   19570052
152900     PERFORM 4130-CLOSE-DATE-CSR.                                 19580052
153000                                                                  19590052
153100                                                                  19600052
153200*----------------------------------------------------------------*19610052
153300* OPENS DATE CURSOR                                              *19620052
153400*----------------------------------------------------------------*19630052
153500 4110-OPEN-DATE-CSR.                                              19640052
153600                                                                  19650052
153700     PERFORM                                                      19660052
153800         WITH TEST AFTER                                          19670052
153900         VARYING PV-RETRY-COUNTER                                 19680052
154000         FROM 1 BY 1                                              19690052
154100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19700052
154200                   OR (SQLCODE = ZERO))                           19710052
154300         EXEC SQL                                                 19720052
154400              OPEN DATE-CSR                                       19730052
154500         END-EXEC                                                 19740052
154600                                                                  19750052
154700         EVALUATE TRUE                                            19760052
154800             WHEN SQLCODE = ZERO                                  19770052
154900             WHEN SQLCODE = -904                                  19780052
155000             WHEN SQLCODE = -913                                  19790052
155100                 CONTINUE                                         19800052
155200             WHEN SQLWARN0 NOT = SPACES                           19810052
155300             WHEN SQLCODE < ZERO                                  19820052
155400             WHEN SQLCODE > ZERO                                  19830052
155500                 MOVE '4110-OPEN-DATE-CSR'                        19840052
155600                                   TO DP013-PARAGRAPH             19850052
155700                 MOVE 'OPEN DATE CURSOR - '                       19860052
155800                                   TO DP013-MESSAGE-TEXT (1)      19870052
155900                 MOVE SQLCA        TO DP013-SQLCA                 19880052
156000                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    19890052
156100                 SET DP013-DB2-ABEND                              19900052
156200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19910052
156300                 PERFORM DP013-0000-PROCESS-ABEND                 19920052
156400         END-EVALUATE                                             19930052
156500     END-PERFORM.                                                 19940052
156600                                                                  19950052
156700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19960052
156800         MOVE '4110-OPEN-DATE-CSR' TO DP013-PARAGRAPH             19970052
156900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19980052
157000                                   TO DP013-MESSAGE-TEXT (1)      19990052
157100         MOVE SQLCA                TO DP013-SQLCA                 20000052
157200         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    20010052
157300         SET DP013-DB2-ABEND                                      20020052
157400             DP013-XCTL-DISPLAY-RESTART                           20030052
157500                                   TO TRUE                        20040052
157600         PERFORM DP013-0000-PROCESS-ABEND                         20050052
157700     END-IF.                                                      20060052
157800                                                                  20070052
157900                                                                  20080052
158000*----------------------------------------------------------------*20090052
158100* READS DATE CSR AND STORES FIRST 6 DATES                        *20100052
158200*----------------------------------------------------------------*20110052
158300 4120-PROCESS-DATE-CSR.                                           20120052
158400                                                                  20130052
158500     PERFORM                                                      20140052
158600         WITH TEST AFTER                                          20150052
158700         VARYING PV-RETRY-COUNTER                                 20160052
158800         FROM 1 BY 1                                              20170052
158900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20180052
159000                   OR (SQLCODE = ZERO)                            20190052
159100                   OR (SQLCODE = +100))                           20200052
159200         EXEC SQL                                                 20210052
159300              FETCH DATE-CSR                                      20220052
159400              INTO :RECITM-VERFYD-TMST                            20230052
159500         END-EXEC                                                 20240052
159600                                                                  20250052
159700         EVALUATE TRUE                                            20260052
159800             WHEN SQLCODE = ZERO                                  20270052
159900             WHEN SQLCODE = +100                                  20280052
160000             WHEN SQLCODE = -904                                  20290052
160100             WHEN SQLCODE = -913                                  20300052
160200                 CONTINUE                                         20310052
160300             WHEN SQLWARN0 NOT = SPACES                           20320052
160400             WHEN SQLCODE < ZERO                                  20330052
160500             WHEN SQLCODE > ZERO                                  20340052
160600                 MOVE '4120-PROCESS-DATE-CSR'                     20350052
160700                                   TO DP013-PARAGRAPH             20360052
160800                 MOVE 'READ DATE CURSOR - '                       20370052
160900                                   TO DP013-MESSAGE-TEXT (1)      20380052
161000                 MOVE SQLCA        TO DP013-SQLCA                 20390052
161100                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    20400052
161200                 SET DP013-DB2-ABEND                              20410052
161300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20420052
161400                 PERFORM DP013-0000-PROCESS-ABEND                 20430052
161500         END-EVALUATE                                             20440052
161600     END-PERFORM.                                                 20450052
161700                                                                  20460052
161800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20470052
161900         MOVE '4120-PROCESS-DATE-CSR' TO DP013-PARAGRAPH          20480052
162000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ CSR'   20490052
162100                                   TO DP013-MESSAGE-TEXT (1)      20500052
162200         MOVE SQLCA                TO DP013-SQLCA                 20510052
162300         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    20520052
162400         SET DP013-DB2-ABEND                                      20530052
162500             DP013-XCTL-DISPLAY-RESTART                           20540052
162600                                   TO TRUE                        20550052
162700         PERFORM DP013-0000-PROCESS-ABEND                         20560052
162800     END-IF.                                                      20570052
162900                                                                  20580052
163000     IF SQLCODE = +100                                            20590052
163100         SET PS-EOF-DATE-CSR       TO TRUE                        20600052
163200     ELSE                                                         20610052
163300         IF PV-SUB < +7                                           20620052
163400             MOVE RECITM-VERFYD-TMST                              20630052
163500                                   TO PV-RCPT-DATE (PV-SUB)       20640052
163600                                      PV-TMST-BREAK               20650052
163700             MOVE PV-TMST-YEAR     TO ASC-YEAR (PV-SUB)           20660052
163800             MOVE PV-TMST-MM       TO ASC-DATE-MM (PV-SUB)        20670052
163900             MOVE PV-TMST-DD       TO ASC-DATE-DD (PV-SUB)        20680052
164000             MOVE '/'              TO ASC-DATE-SL (PV-SUB)        20690052
164100             ADD +1                TO PV-SUB                      20700052
164200         END-IF                                                   20710052
164300         IF PV-SUB = +7                                           20720052
164400             MOVE 'OTHER'          TO ASC-DATE (PV-SUB)           20730052
164500             ADD +1                TO PV-SUB                      20740052
164600         END-IF                                                   20750052
164700     END-IF.                                                      20760052
164800                                                                  20770052
164900                                                                  20780052
165000*----------------------------------------------------------------*20790052
165100* CLOSE THE DATE CURSOR                                          *20800052
165200*----------------------------------------------------------------*20810052
165300 4130-CLOSE-DATE-CSR.                                             20820052
165400                                                                  20830052
165500     EXEC SQL                                                     20840052
165600         CLOSE DATE-CSR                                           20850052
165700     END-EXEC.                                                    20860052
165800                                                                  20870052
165900     EVALUATE TRUE                                                20880052
166000         WHEN SQLCODE = ZERO                                      20890052
166100             CONTINUE                                             20900052
166200         WHEN SQLWARN0 NOT = SPACES                               20910052
166300         WHEN SQLCODE < ZERO                                      20920052
166400         WHEN SQLCODE > ZERO                                      20930052
166500             MOVE '4130-CLOSE-DATE-CSR'                           20940052
166600                                   TO DP013-PARAGRAPH             20950052
166700             MOVE 'CLOSE DATE CURSOR '                            20960052
166800                                   TO DP013-MESSAGE-TEXT (1)      20970052
166900             MOVE SQLCA            TO DP013-SQLCA                 20980052
167000             MOVE 'TRECITM '       TO DP013-DB2-TABLE-NAME (1)    20990052
167100             SET DP013-DB2-ABEND                                  21000052
167200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21010052
167300             PERFORM DP013-0000-PROCESS-ABEND                     21020052
167400     END-EVALUATE.                                                21030052
167500                                                                  21040052
167600                                                                  21050052
167700*----------------------------------------------------------------*21060052
167800* CONTROLS PROCESSING OF OBTAINING DC ALLOCATIONS AND RECEIPTS   *21070052
167900*----------------------------------------------------------------*21080052
168000 4200-GET-DC.                                                     21090052
168100                                                                  21100052
168200     PERFORM 4210-OPEN-DC-CSR.                                    21110052
168300     PERFORM 4220-PROCESS-DC-CSR                                  21120052
168400         UNTIL PS-EOF-DC-CSR.                                     21130052
168500     PERFORM 4230-CLOSE-DC-CSR.                                   21140052
168600                                                                  21150052
168700                                                                  21160052
168800*----------------------------------------------------------------*21170052
168900* OPENS DC CURSOR                                                *21180052
169000*----------------------------------------------------------------*21190052
169100 4210-OPEN-DC-CSR.                                                21200052
169200                                                                  21210052
169300     PERFORM                                                      21220052
169400         WITH TEST AFTER                                          21230052
169500         VARYING PV-RETRY-COUNTER                                 21240052
169600         FROM 1 BY 1                                              21250052
169700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21260052
169800                   OR (SQLCODE = ZERO))                           21270052
169900         EXEC SQL                                                 21280052
170000              OPEN DC-CSR                                         21290052
170100         END-EXEC                                                 21300052
170200                                                                  21310052
170300         EVALUATE TRUE                                            21320052
170400             WHEN SQLCODE = ZERO                                  21330052
170500             WHEN SQLCODE = -904                                  21340052
170600             WHEN SQLCODE = -913                                  21350052
170700                 CONTINUE                                         21360052
170800             WHEN SQLWARN0 NOT = SPACES                           21370052
170900             WHEN SQLCODE < ZERO                                  21380052
171000             WHEN SQLCODE > ZERO                                  21390052
171100                 MOVE '4210-OPEN-DC-CSR'                          21400052
171200                                   TO DP013-PARAGRAPH             21410052
171300                 MOVE 'OPEN DC CURSOR - '                         21420052
171400                                   TO DP013-MESSAGE-TEXT (1)      21430052
171500                 MOVE SQLCA        TO DP013-SQLCA                 21440052
171600                 MOVE 'TALLPLN '   TO DP013-DB2-TABLE-NAME (1)    21450052
171700                 SET DP013-DB2-ABEND                              21460052
171800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           21470052
171900                 PERFORM DP013-0000-PROCESS-ABEND                 21480052
172000         END-EVALUATE                                             21490052
172100     END-PERFORM.                                                 21500052
172200                                                                  21510052
172300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21520052
172400         MOVE '4210-OPEN-DC-CSR' TO DP013-PARAGRAPH               21530052
172500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   21540052
172600                                   TO DP013-MESSAGE-TEXT (1)      21550052
172700         MOVE SQLCA                TO DP013-SQLCA                 21560052
172800         MOVE 'TALLPLN '           TO DP013-DB2-TABLE-NAME (1)    21570052
172900         SET DP013-DB2-ABEND                                      21580052
173000             DP013-XCTL-DISPLAY-RESTART                           21590052
173100                                   TO TRUE                        21600052
173200         PERFORM DP013-0000-PROCESS-ABEND                         21610052
173300     END-IF.                                                      21620052
173400                                                                  21630052
173500                                                                  21640052
173600*----------------------------------------------------------------*21650052
173700* READS DC CSR AND CREATES RECORDS FOR A DC                      *21660052
173800*----------------------------------------------------------------*21670052
173900 4220-PROCESS-DC-CSR.                                             21680052
174000                                                                  21690052
174100     PERFORM                                                      21700052
174200         WITH TEST AFTER                                          21710052
174300         VARYING PV-RETRY-COUNTER                                 21720052
174400         FROM 1 BY 1                                              21730052
174500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21740052
174600                   OR (SQLCODE = ZERO)                            21750052
174700                   OR (SQLCODE = +100))                           21760052
174800         EXEC SQL                                                 21770052
174900              FETCH DC-CSR                                        21780052
175000              INTO :ALLPLN-DEST-NBR                               21790052
175100                  ,:ALLPLN-CURR-SPLIT-QTY                         21800052
175200         END-EXEC                                                 21810052
175300                                                                  21820052
175400         EVALUATE TRUE                                            21830052
175500             WHEN SQLCODE = ZERO                                  21840052
175600             WHEN SQLCODE = +100                                  21850052
175700             WHEN SQLCODE = -904                                  21860052
175800             WHEN SQLCODE = -913                                  21870052
175900                 CONTINUE                                         21880052
176000             WHEN SQLWARN0 NOT = SPACES                           21890052
176100             WHEN SQLCODE < ZERO                                  21900052
176200             WHEN SQLCODE > ZERO                                  21910052
176300                 MOVE '4220-PROCESS-DC-CSR'                       21920052
176400                                   TO DP013-PARAGRAPH             21930052
176500                 MOVE 'READ DC CURSOR - '                         21940052
176600                                   TO DP013-MESSAGE-TEXT (1)      21950052
176700                 MOVE SQLCA        TO DP013-SQLCA                 21960052
176800                 MOVE 'TALLPLN '   TO DP013-DB2-TABLE-NAME (1)    21970052
176900                 SET DP013-DB2-ABEND                              21980052
177000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           21990052
177100                 PERFORM DP013-0000-PROCESS-ABEND                 22000052
177200         END-EVALUATE                                             22010052
177300     END-PERFORM.                                                 22020052
177400                                                                  22030052
177500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22040052
177600         MOVE '4220-PROCESS-DC-CSR' TO DP013-PARAGRAPH            22050052
177700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ CSR'   22060052
177800                                   TO DP013-MESSAGE-TEXT (1)      22070052
177900         MOVE SQLCA                TO DP013-SQLCA                 22080052
178000         MOVE 'TALLPLN '           TO DP013-DB2-TABLE-NAME (1)    22090052
178100         SET DP013-DB2-ABEND                                      22100052
178200             DP013-XCTL-DISPLAY-RESTART                           22110052
178300                                   TO TRUE                        22120052
178400         PERFORM DP013-0000-PROCESS-ABEND                         22130052
178500     END-IF.                                                      22140052
178600                                                                  22150052
178700     IF SQLCODE = +100                                            22160052
178800         SET PS-EOF-DC-CSR         TO TRUE                        22170052
178900     ELSE                                                         22180052
179000         IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                    22190052
179100             ADD +1                TO ASC-ITEM-SUB                22200052
179200         ELSE                                                     22210052
179300             ADD +1                TO ASC-BLK-SUB                 22220052
179400             MOVE +1               TO ASC-ITEM-SUB                22230052
179500                                                                  22240052
179600             IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY             22250052
179700                 MOVE +1           TO ASC-BLK-SUB                 22260052
179800                 SET ASC-BLOCK-MODIFIED (1)                       22270052
179900                                   TO TRUE                        22280052
180000                 PERFORM 5100-WRITE-TEMP-STORAGE                  22290052
180100                 MOVE ASC-BLOCK-ENTRIES                           22300052
180200                               (PC-MAX-BLOCKS-IN-ARRAY)           22310052
180300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 22320052
180400                 ADD +1            TO ASC-BLK-SUB                 22330052
180500                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       22340052
180600                 SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)          22350052
180700                                   TO TRUE                        22360052
180800             END-IF                                               22370052
180900         END-IF                                                   22380052
181000         ADD +1                    TO ASC-NUMBER-OF-ITEMS-READ    22390052
181100         MOVE ASC-NUMBER-OF-ITEMS-READ                            22400052
181200                                   TO ASC-LIST-ITEM-NUMBER        22410052
181300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22420052
181400                                                                  22430052
181500         MOVE ALLPLN-DEST-NBR      TO PV-STORE-NBR                22440052
181600                                      ASC-STORE-NBR               22450052
181700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22460052
181800         PERFORM 4999-GET-STR-NAME                                22470052
181900         MOVE XMT00001-LOC-5-ABBR-NM                              22480054
182000                                   TO ASC-STORE-NAME              22490052
182100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22500052
182200         MOVE '**'                 TO ASC-DC-IND                  22510052
182300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22520052
182400         MOVE ALLPLN-CURR-SPLIT-QTY                               22530052
182500                                   TO ASC-PLAN-QTY                22540052
182600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22550052
182700         MOVE ZERO                 TO ASC-RCVD-QTY                22560052
182800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22570052
182900                                      ASC-RCVD-QTY1               22580052
183000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22590052
183100                                      ASC-RCVD-QTY2               22600052
183200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22610052
183300                                      ASC-RCVD-QTY3               22620052
183400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22630052
183500                                      ASC-RCVD-QTY4               22640052
183600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22650052
183700                                      ASC-RCVD-QTY5               22660052
183800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22670052
183900                                      ASC-RCVD-QTY6               22680052
184000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22690052
184100                                      ASC-RCVD-QTYO               22700052
184200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22710052
184300         PERFORM 4240-GET-DC-RECEIPTS                             22720052
184400     END-IF.                                                      22730052
184500                                                                  22740052
184600                                                                  22750052
184700*----------------------------------------------------------------*22760052
184800* CLOSE THE DC CURSOR                                            *22770052
184900*----------------------------------------------------------------*22780052
185000 4230-CLOSE-DC-CSR.                                               22790052
185100                                                                  22800052
185200     EXEC SQL                                                     22810052
185300         CLOSE DC-CSR                                             22820052
185400     END-EXEC.                                                    22830052
185500                                                                  22840052
185600     EVALUATE TRUE                                                22850052
185700         WHEN SQLCODE = ZERO                                      22860052
185800             CONTINUE                                             22870052
185900         WHEN SQLWARN0 NOT = SPACES                               22880052
186000         WHEN SQLCODE < ZERO                                      22890052
186100         WHEN SQLCODE > ZERO                                      22900052
186200             MOVE '4230-CLOSE-DC-CSR'                             22910052
186300                                   TO DP013-PARAGRAPH             22920052
186400             MOVE 'CLOSE DC CURSOR '                              22930052
186500                                   TO DP013-MESSAGE-TEXT (1)      22940052
186600             MOVE SQLCA            TO DP013-SQLCA                 22950052
186700             MOVE 'TALLPLN '       TO DP013-DB2-TABLE-NAME (1)    22960052
186800             SET DP013-DB2-ABEND                                  22970052
186900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22980052
187000             PERFORM DP013-0000-PROCESS-ABEND                     22990052
187100     END-EVALUATE.                                                23000052
187200                                                                  23010052
187300                                                                  23020052
187400*----------------------------------------------------------------*23030052
187500* CONTROLS PROCESSING OF OBTAINING DC RECEIPTS                   *23040052
187600*----------------------------------------------------------------*23050052
187700 4240-GET-DC-RECEIPTS.                                            23060052
187800                                                                  23070052
187900     PERFORM 4241-OPEN-DCRCPT-CSR.                                23080052
188000     SET PS-NOT-EOF-DCRCPT-CSR     TO TRUE.                       23090052
188100     PERFORM 4242-PROCESS-DCRCPT-CSR                              23100052
188200         UNTIL PS-EOF-DCRCPT-CSR.                                 23110052
188300     PERFORM 4243-CLOSE-DCRCPT-CSR.                               23120052
188400                                                                  23130052
188500                                                                  23140052
188600*----------------------------------------------------------------*23150052
188700* OPENS DC RECEIPTS CURSOR                                       *23160052
188800*----------------------------------------------------------------*23170052
188900 4241-OPEN-DCRCPT-CSR.                                            23180052
189000                                                                  23190052
189100     PERFORM                                                      23200052
189200         WITH TEST AFTER                                          23210052
189300         VARYING PV-RETRY-COUNTER                                 23220052
189400         FROM 1 BY 1                                              23230052
189500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23240052
189600                   OR (SQLCODE = ZERO))                           23250052
189700         EXEC SQL                                                 23260052
189800              OPEN DCRCPT-CSR                                     23270052
189900         END-EXEC                                                 23280052
190000                                                                  23290052
190100         EVALUATE TRUE                                            23300052
190200             WHEN SQLCODE = ZERO                                  23310052
190300             WHEN SQLCODE = -904                                  23320052
190400             WHEN SQLCODE = -913                                  23330052
190500                 CONTINUE                                         23340052
190600             WHEN SQLWARN0 NOT = SPACES                           23350052
190700             WHEN SQLCODE < ZERO                                  23360052
190800             WHEN SQLCODE > ZERO                                  23370052
190900                 MOVE '4241-OPEN-DCRCPT-CSR'                      23380052
191000                                   TO DP013-PARAGRAPH             23390052
191100                 MOVE 'OPEN DCRCPT CURSOR - '                     23400052
191200                                   TO DP013-MESSAGE-TEXT (1)      23410052
191300                 MOVE SQLCA        TO DP013-SQLCA                 23420052
191400                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)    23430052
191500                 SET DP013-DB2-ABEND                              23440052
191600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23450052
191700                 PERFORM DP013-0000-PROCESS-ABEND                 23460052
191800         END-EVALUATE                                             23470052
191900     END-PERFORM.                                                 23480052
192000                                                                  23490052
192100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23500052
192200         MOVE '4241-OPEN-DCRCPT-CSR' TO DP013-PARAGRAPH           23510052
192300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   23520052
192400                                   TO DP013-MESSAGE-TEXT (1)      23530052
192500         MOVE SQLCA                TO DP013-SQLCA                 23540052
192600         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    23550052
192700         SET DP013-DB2-ABEND                                      23560052
192800             DP013-XCTL-DISPLAY-RESTART                           23570052
192900                                   TO TRUE                        23580052
193000         PERFORM DP013-0000-PROCESS-ABEND                         23590052
193100     END-IF.                                                      23600052
193200                                                                  23610052
193300                                                                  23620052
193400*----------------------------------------------------------------*23630052
193500* READS RECEIPTS CURSOR FOR EACH DC AND CREATES A RECORD         *23640052
193600*----------------------------------------------------------------*23650052
193700 4242-PROCESS-DCRCPT-CSR.                                         23660052
193800                                                                  23670052
193900     PERFORM                                                      23680052
194000         WITH TEST AFTER                                          23690052
194100         VARYING PV-RETRY-COUNTER                                 23700052
194200         FROM 1 BY 1                                              23710052
194300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23720052
194400                   OR (SQLCODE = ZERO)                            23730052
194500                   OR (SQLCODE = +100))                           23740052
194600         EXEC SQL                                                 23750052
194700              FETCH DCRCPT-CSR                                    23760052
194800              INTO :RECITM-VERFYD-TMST                            23770052
194900                  ,:RECDIS-VERIFY-ITM-QTY                         23780052
195000         END-EXEC                                                 23790052
195100                                                                  23800052
195200         EVALUATE TRUE                                            23810052
195300             WHEN SQLCODE = ZERO                                  23820052
195400             WHEN SQLCODE = +100                                  23830052
195500             WHEN SQLCODE = -904                                  23840052
195600             WHEN SQLCODE = -913                                  23850052
195700                 CONTINUE                                         23860052
195800             WHEN SQLWARN0 NOT = SPACES                           23870052
195900             WHEN SQLCODE < ZERO                                  23880052
196000             WHEN SQLCODE > ZERO                                  23890052
196100                 MOVE '4242-PROCESS-DCRCPT-CSR'                   23900052
196200                                   TO DP013-PARAGRAPH             23910052
196300                 MOVE 'READ DCRCPT CURSOR - '                     23920052
196400                                   TO DP013-MESSAGE-TEXT (1)      23930052
196500                 MOVE SQLCA        TO DP013-SQLCA                 23940052
196600                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)    23950052
196700                 SET DP013-DB2-ABEND                              23960052
196800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23970052
196900                 PERFORM DP013-0000-PROCESS-ABEND                 23980052
197000         END-EVALUATE                                             23990052
197100     END-PERFORM.                                                 24000052
197200                                                                  24010052
197300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24020052
197400         MOVE '4242-PROCESS-DCRCPT-CSR' TO DP013-PARAGRAPH        24030052
197500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ CSR'   24040052
197600                                   TO DP013-MESSAGE-TEXT (1)      24050052
197700         MOVE SQLCA                TO DP013-SQLCA                 24060052
197800         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    24070052
197900         SET DP013-DB2-ABEND                                      24080052
198000             DP013-XCTL-DISPLAY-RESTART                           24090052
198100                                   TO TRUE                        24100052
198200         PERFORM DP013-0000-PROCESS-ABEND                         24110052
198300     END-IF.                                                      24120052
198400                                                                  24130052
198500     IF SQLCODE = +100                                            24140052
198600         SET PS-EOF-DCRCPT-CSR     TO TRUE                        24150052
198700     ELSE                                                         24160052
198800         ADD  RECDIS-VERIFY-ITM-QTY                               24170052
198900                                   TO ASC-RCVD-QTY                24180052
199000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24190052
199100         PERFORM 4321-DETERMINE-RCPT-BUCKET                       24200052
199200     END-IF.                                                      24210052
199300                                                                  24220052
199400                                                                  24230052
199500*----------------------------------------------------------------*24240052
199600* CLOSE THE DC RECEIPTS CURSOR                                   *24250052
199700*----------------------------------------------------------------*24260052
199800 4243-CLOSE-DCRCPT-CSR.                                           24270052
199900                                                                  24280052
200000     EXEC SQL                                                     24290052
200100         CLOSE DCRCPT-CSR                                         24300052
200200     END-EXEC.                                                    24310052
200300                                                                  24320052
200400     EVALUATE TRUE                                                24330052
200500         WHEN SQLCODE = ZERO                                      24340052
200600             CONTINUE                                             24350052
200700         WHEN SQLWARN0 NOT = SPACES                               24360052
200800         WHEN SQLCODE < ZERO                                      24370052
200900         WHEN SQLCODE > ZERO                                      24380052
201000             MOVE '4243-CLOSE-DCRCPT-CSR'                         24390052
201100                                   TO DP013-PARAGRAPH             24400052
201200             MOVE 'CLOSE DCRCPT CURSOR '                          24410052
201300                                   TO DP013-MESSAGE-TEXT (1)      24420052
201400             MOVE SQLCA            TO DP013-SQLCA                 24430052
201500             MOVE 'TRECDIS '       TO DP013-DB2-TABLE-NAME (1)    24440052
201600             SET DP013-DB2-ABEND                                  24450052
201700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24460052
201800             PERFORM DP013-0000-PROCESS-ABEND                     24470052
201900     END-EVALUATE.                                                24480052
202000                                                                  24490052
202100                                                                  24500052
202200*----------------------------------------------------------------*24510052
202300* CONTROLS PROCESSING OF OBTAINING STORE ALLOCATIONS AND RECEIPTS*24520052
202400*----------------------------------------------------------------*24530052
202500 4300-GET-ALLOCS-RCPTS.                                           24540052
202600                                                                  24550052
202700     PERFORM 4310-OPEN-AR-CSR.                                    24560052
202800     PERFORM 4320-PROCESS-AR-CSR                                  24570052
202900         UNTIL PS-EOF-AR-CSR.                                     24580052
203000     PERFORM 4330-CLOSE-AR-CSR.                                   24590052
203100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          24600052
203200         MOVE +1                   TO ASC-BLK-SUB                 24610052
203300         PERFORM 5100-WRITE-TEMP-STORAGE                          24620052
203400         ADD +1                    TO ASC-BLK-SUB                 24630052
203500         PERFORM 5100-WRITE-TEMP-STORAGE                          24640052
203600                                                                  24650052
203700         MOVE 1                    TO ASC-BLK-SUB                 24660052
203800                                      PV-BLOCK-NUMBER             24670052
203900         PERFORM 4410-READ-TEMP-STORAGE                           24680052
204000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             24690052
204100             MOVE 2                TO ASC-BLK-SUB                 24700052
204200                                      PV-BLOCK-NUMBER             24710052
204300             PERFORM 4410-READ-TEMP-STORAGE                       24720052
204400         END-IF                                                   24730052
204500     END-IF.                                                      24740052
204600                                                                  24750052
204700                                                                  24760052
204800*----------------------------------------------------------------*24770052
204900* OPENS ALLOCATIONS AND RECEIPTS CURSOR                          *24780052
205000*----------------------------------------------------------------*24790052
205100 4310-OPEN-AR-CSR.                                                24800052
205200                                                                  24810052
205300     PERFORM                                                      24820052
205400         WITH TEST AFTER                                          24830052
205500         VARYING PV-RETRY-COUNTER                                 24840052
205600         FROM 1 BY 1                                              24850052
205700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24860052
205800                   OR (SQLCODE = ZERO))                           24870052
205900         EXEC SQL                                                 24880052
206000              OPEN AR-CSR                                         24890052
206100         END-EXEC                                                 24900052
206200                                                                  24910052
206300         EVALUATE TRUE                                            24920052
206400             WHEN SQLCODE = ZERO                                  24930052
206500             WHEN SQLCODE = -904                                  24940052
206600             WHEN SQLCODE = -913                                  24950052
206700                 CONTINUE                                         24960052
206800             WHEN SQLWARN0 NOT = SPACES                           24970052
206900             WHEN SQLCODE < ZERO                                  24980052
207000             WHEN SQLCODE > ZERO                                  24990052
207100                 MOVE '4310-OPEN-AR-CSR'                          25000052
207200                                   TO DP013-PARAGRAPH             25010052
207300                 MOVE 'OPEN AR CURSOR - '                         25020052
207400                                   TO DP013-MESSAGE-TEXT (1)      25030052
207500                 MOVE SQLCA        TO DP013-SQLCA                 25040052
207600                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)    25050052
207700                 SET DP013-DB2-ABEND                              25060052
207800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25070052
207900                 PERFORM DP013-0000-PROCESS-ABEND                 25080052
208000         END-EVALUATE                                             25090052
208100     END-PERFORM.                                                 25100052
208200                                                                  25110052
208300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25120052
208400         MOVE '4310-OPEN-AR-CSR' TO DP013-PARAGRAPH               25130052
208500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   25140052
208600                                   TO DP013-MESSAGE-TEXT (1)      25150052
208700         MOVE SQLCA                TO DP013-SQLCA                 25160052
208800         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    25170052
208900         SET DP013-DB2-ABEND                                      25180052
209000             DP013-XCTL-DISPLAY-RESTART                           25190052
209100                                   TO TRUE                        25200052
209200         PERFORM DP013-0000-PROCESS-ABEND                         25210052
209300     END-IF.                                                      25220052
209400                                                                  25230052
209500*----------------------------------------------------------------*25240052
209600* READS ALLOCATIONS AND RECEIPTS CURSOR FOR EACH UNIQUE STORE    *25250052
209700* CREATES A RECORD.                                              *25260052
209800*----------------------------------------------------------------*25270052
209900                                                                  25280052
210000 4320-PROCESS-AR-CSR.                                             25290052
210100                                                                  25300052
210200     PERFORM                                                      25310052
210300         WITH TEST AFTER                                          25320052
210400         VARYING PV-RETRY-COUNTER                                 25330052
210500         FROM 1 BY 1                                              25340052
210600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25350052
210700                   OR (SQLCODE = ZERO)                            25360052
210800                   OR (SQLCODE = +100))                           25370052
210900         EXEC SQL                                                 25380052
211000              FETCH AR-CSR                                        25390052
211100              INTO :ALLPLN-DEST-NBR                               25400052
211200                  ,:MESTDS-STR-NBR                                25410052
211300                  ,:PV-AR-IND                                     25420052
211400                  ,:RECITM-VERFYD-TMST                            25430052
211500                  ,:RECDIS-VERIFY-ITM-QTY                         25440052
211600         END-EXEC                                                 25450052
211700                                                                  25460052
211800         EVALUATE TRUE                                            25470052
211900             WHEN SQLCODE = ZERO                                  25480052
212000             WHEN SQLCODE = +100                                  25490052
212100             WHEN SQLCODE = -904                                  25500052
212200             WHEN SQLCODE = -913                                  25510052
212300                 CONTINUE                                         25520052
212400             WHEN SQLWARN0 NOT = SPACES                           25530052
212500             WHEN SQLCODE < ZERO                                  25540052
212600             WHEN SQLCODE > ZERO                                  25550052
212700                 MOVE '4320-PROCESS-AR-CSR'                       25560052
212800                                   TO DP013-PARAGRAPH             25570052
212900                 MOVE 'READ AR CURSOR - '                         25580052
213000                                   TO DP013-MESSAGE-TEXT (1)      25590052
213100                 MOVE SQLCA        TO DP013-SQLCA                 25600052
213200                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)    25610052
213300                 SET DP013-DB2-ABEND                              25620052
213400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25630052
213500                 PERFORM DP013-0000-PROCESS-ABEND                 25640052
213600         END-EVALUATE                                             25650052
213700     END-PERFORM.                                                 25660052
213800                                                                  25670052
213900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25680052
214000         MOVE '4320-PROCESS-AR-CSR' TO DP013-PARAGRAPH            25690052
214100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ CSR'   25700052
214200                                   TO DP013-MESSAGE-TEXT (1)      25710052
214300         MOVE SQLCA                TO DP013-SQLCA                 25720052
214400         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    25730052
214500         SET DP013-DB2-ABEND                                      25740052
214600             DP013-XCTL-DISPLAY-RESTART                           25750052
214700                                   TO TRUE                        25760052
214800         PERFORM DP013-0000-PROCESS-ABEND                         25770052
214900     END-IF.                                                      25780052
215000                                                                  25790052
215100     IF SQLCODE = +100                                            25800052
215200         SET PS-EOF-AR-CSR         TO TRUE                        25810052
215300     ELSE                                                         25820052
215400         IF  MESTDS-STR-NBR = PV-SAVE-STR-NBR                     25830052
215400         AND ALLPLN-DEST-NBR = PV-SAVE-DEST-NBR                   25840052
215500             ADD RECDIS-VERIFY-ITM-QTY                            25850052
215600                                   TO ASC-RCVD-QTY                25860052
215700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25870052
215800                                      ASC-TOT-SHIP-QTY            25880052
215900             PERFORM 4321-DETERMINE-RCPT-BUCKET                   25890052
216000         ELSE                                                     25900052
216100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                25910052
216200                 ADD +1            TO ASC-ITEM-SUB                25920052
216300             ELSE                                                 25930052
216400                 ADD +1            TO ASC-BLK-SUB                 25940052
216500                 MOVE +1           TO ASC-ITEM-SUB                25950052
216600                                                                  25960052
216700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         25970052
216800                     MOVE +1       TO ASC-BLK-SUB                 25980052
216900                     SET ASC-BLOCK-MODIFIED (1)                   25990052
217000                                   TO TRUE                        26000052
217100                     PERFORM 5100-WRITE-TEMP-STORAGE              26010052
217200                     MOVE ASC-BLOCK-ENTRIES                       26020052
217300                               (PC-MAX-BLOCKS-IN-ARRAY)           26030052
217400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26040052
217500                     ADD +1        TO ASC-BLK-SUB                 26050052
217600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26060052
217700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26070052
217800                                   TO TRUE                        26080052
217900                 END-IF                                           26090052
218000             END-IF                                               26100052
218100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26110052
218200             MOVE ASC-NUMBER-OF-ITEMS-READ                        26120052
218300                                   TO ASC-LIST-ITEM-NUMBER        26130052
218400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26140052
218500                                                                  26150052
218600             MOVE MESTDS-STR-NBR   TO PV-STORE-NBR                26160052
218700                                      ASC-STORE-NBR               26170052
218800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26180052
218900                                      PV-SAVE-STR-NBR             26190052
218600             MOVE ALLPLN-DEST-NBR  TO PV-SAVE-DEST-NBR            26200052
219000                                                                  26210052
219100*            IF MESTDS-STR-NBR = +85 OR +810                      26220052
219200*                MOVE 'CSTK '      TO ASC-STORE-NAME              26230052
219300*                                     (ASC-BLK-SUB ASC-ITEM-SUB)  26240052
219400*            ELSE                                                 26250052
219500*                PERFORM 4999-GET-STR-NAME                        26260052
219600*                MOVE XMT00001-LOC-5-ABBR-NM                      26270054
219700*                                  TO ASC-STORE-NAME              26280052
219800*                                     (ASC-BLK-SUB ASC-ITEM-SUB)  26290052
219900*            END-IF                                               26300052
220000*                                                                 26310052
220100             PERFORM 4999-GET-STR-NAME                            26320052
220200                                                                  26330052
220300             IF XMT00001-LOC-5-ABBR-NM = 'DC'                     26340054
220400                 STRING XMT00001-LOC-5-ABBR-NM(4:2)               26350054
220500                    DELIMITED BY SIZE INTO PV-DC-INIT             26360052
220600                                                                  26370052
220700                 MOVE PV-DC-TRBL-CODE TO ASC-STORE-NAME           26380052
220800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26390052
220900             ELSE                                                 26400052
221000*                PERFORM 4999-GET-STR-NAME                        26410052
221100                 MOVE XMT00001-LOC-5-ABBR-NM                      26420054
221200                                   TO ASC-STORE-NAME              26430052
221300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26440052
221400             END-IF                                               26450052
221500                                                                  26460052
221502             SET PS-NO-DC-MATCH TO TRUE                           26470052
221503             PERFORM VARYING PV-DC-COUNT                          26480052
221504                FROM 1 BY 1                                       26490052
221505               UNTIL PS-DC-MATCH                                  26500052
221506                                                                  26510052
221507                 IF ASC-DC-NBR (PV-DC-COUNT) = ALLPLN-DEST-NBR    26520052
221508                     MOVE ASC-DC-NAME-ABBR (PV-DC-COUNT)          26530052
221510                       TO ASC-DC-IND (ASC-BLK-SUB ASC-ITEM-SUB)   26540052
221511                     SET PS-DC-MATCH TO TRUE                      26550052
221512                 ELSE                                             26560052
221513* IF WE HAVE MORE THAN 30 DIST CENTERS, BUMP THE NUMBER UP FROM   26570064
221514* 10 TO THE NUMBER OF OCCURS IN THE ASC-DC-TABLE.                 26580052
221515                     IF PV-DC-COUNT > 30                          26590064
221516                         SET PS-DC-MATCH TO TRUE                  26600052
221517                     END-IF                                       26610052
221518                 END-IF                                           26620052
221519             END-PERFORM                                          26630052
222710                                                                  26640052
222800             MOVE ZERO             TO ASC-PLAN-QTY                26650052
222900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26660052
223000                                      ASC-RCVD-QTY                26670052
223100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26680052
223200                                      ASC-RCVD-QTY1               26690052
223300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26700052
223400                                      ASC-RCVD-QTY2               26710052
223500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26720052
223600                                      ASC-RCVD-QTY3               26730052
223700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26740052
223800                                      ASC-RCVD-QTY4               26750052
223900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26760052
224000                                      ASC-RCVD-QTY5               26770052
224100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26780052
224200                                      ASC-RCVD-QTY6               26790052
224300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26800052
224400                                      ASC-RCVD-QTYO               26810052
224500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26820052
224600             IF PV-AR-IND = 'A'                                   26830052
224700                 ADD  RECDIS-VERIFY-ITM-QTY                       26840052
224800****            (THIS IS REALLY MESTDS-STR-DISTRO-QTY)            26850052
224900                                   TO ASC-PLAN-QTY                26860052
225000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26870052
225100             ELSE                                                 26880052
225200                 ADD  RECDIS-VERIFY-ITM-QTY                       26890052
225300                                   TO ASC-RCVD-QTY                26900052
225400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26910052
225500                                      ASC-TOT-SHIP-QTY            26920052
225600                 PERFORM 4321-DETERMINE-RCPT-BUCKET               26930052
225700             END-IF                                               26940052
225800         END-IF                                                   26950052
225900     END-IF.                                                      26960052
226000                                                                  26970052
226100                                                                  26980052
226200*----------------------------------------------------------------*26990052
226300* DETERMINE BASED ON DATES WHICH BUCKET TO PUT RECEIPT AMT       *27000052
226400*----------------------------------------------------------------*27010052
226500 4321-DETERMINE-RCPT-BUCKET.                                      27020052
226600                                                                  27030052
226700     IF RECITM-VERFYD-TMST = PV-RCPT-DATE(1)                      27040052
226800         ADD RECDIS-VERIFY-ITM-QTY                                27050052
226900                                   TO ASC-RCVD-QTY1               27060052
227000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27070052
227100     ELSE                                                         27080052
227200     IF RECITM-VERFYD-TMST = PV-RCPT-DATE(2)                      27090052
227300         ADD RECDIS-VERIFY-ITM-QTY                                27100052
227400                                   TO ASC-RCVD-QTY2               27110052
227500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27120052
227600     ELSE                                                         27130052
227700     IF RECITM-VERFYD-TMST = PV-RCPT-DATE(3)                      27140052
227800         ADD RECDIS-VERIFY-ITM-QTY                                27150052
227900                                   TO ASC-RCVD-QTY3               27160052
228000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27170052
228100     ELSE                                                         27180052
228200     IF RECITM-VERFYD-TMST = PV-RCPT-DATE(4)                      27190052
228300         ADD RECDIS-VERIFY-ITM-QTY                                27200052
228400                                   TO ASC-RCVD-QTY4               27210052
228500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27220052
228600     ELSE                                                         27230052
228700     IF RECITM-VERFYD-TMST = PV-RCPT-DATE(5)                      27240052
228800         ADD RECDIS-VERIFY-ITM-QTY                                27250052
228900                                   TO ASC-RCVD-QTY5               27260052
229000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27270052
229100     ELSE                                                         27280052
229200     IF RECITM-VERFYD-TMST = PV-RCPT-DATE(6)                      27290052
229300         ADD RECDIS-VERIFY-ITM-QTY                                27300052
229400                                   TO ASC-RCVD-QTY6               27310052
229500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27320052
229600     ELSE                                                         27330052
229700         ADD RECDIS-VERIFY-ITM-QTY                                27340052
229800                                   TO ASC-RCVD-QTYO               27350052
229900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27360052
230000     END-IF                                                       27370052
230100     END-IF                                                       27380052
230200     END-IF                                                       27390052
230300     END-IF                                                       27400052
230400     END-IF                                                       27410052
230500     END-IF.                                                      27420052
230600                                                                  27430052
230700                                                                  27440052
230800*----------------------------------------------------------------*27450052
230900* CLOSE THE ALLOCATIONS AND RECEIPTS CURSOR                      *27460052
231000*----------------------------------------------------------------*27470052
231100 4330-CLOSE-AR-CSR.                                               27480052
231200                                                                  27490052
231300     EXEC SQL                                                     27500052
231400         CLOSE AR-CSR                                             27510052
231500     END-EXEC.                                                    27520052
231600                                                                  27530052
231700     EVALUATE TRUE                                                27540052
231800         WHEN SQLCODE = ZERO                                      27550052
231900             CONTINUE                                             27560052
232000         WHEN SQLWARN0 NOT = SPACES                               27570052
232100         WHEN SQLCODE < ZERO                                      27580052
232200         WHEN SQLCODE > ZERO                                      27590052
232300             MOVE '4330-CLOSE-AR-CSR'                             27600052
232400                                   TO DP013-PARAGRAPH             27610052
232500             MOVE 'CLOSE AR CURSOR '                              27620052
232600                                   TO DP013-MESSAGE-TEXT (1)      27630052
232700             MOVE SQLCA            TO DP013-SQLCA                 27640052
232800             MOVE 'TRECDIS '       TO DP013-DB2-TABLE-NAME (1)    27650052
232900             SET DP013-DB2-ABEND                                  27660052
233000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27670052
233100             PERFORM DP013-0000-PROCESS-ABEND                     27680052
233200     END-EVALUATE.                                                27690052
233300                                                                  27700052
233400                                                                  27710052
233500*----------------------------------------------------------------*27720052
233600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *27730052
233700*----------------------------------------------------------------*27740052
233800                                                                  27750052
233900 4400-MOVE-COMMAREA-TO-SCREEN.                                    27760052
234000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             27770052
234100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          27780052
234200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          27790052
234300             MOVE +1               TO ASC-BLK-SUB                 27800052
234400             PERFORM 5100-WRITE-TEMP-STORAGE                      27810052
234500             ADD +1                TO ASC-BLK-SUB                 27820052
234600             PERFORM 5100-WRITE-TEMP-STORAGE                      27830052
234700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             27840052
234800                 GIVING PV-BLOCK-NUMBER                           27850052
234900                 REMAINDER PV-REMAINDER                           27860052
235000             IF  PV-REMAINDER > ZERO                              27870052
235100                 ADD +1            TO PV-BLOCK-NUMBER             27880052
235200             END-IF                                               27890052
235300             MOVE +1               TO ASC-BLK-SUB                 27900052
235400             PERFORM 4410-READ-TEMP-STORAGE                       27910052
235500             ADD +1                TO ASC-BLK-SUB                 27920052
235600                                      PV-BLOCK-NUMBER             27930052
235700             PERFORM 4410-READ-TEMP-STORAGE                       27940052
235800     END-IF.                                                      27950052
235900     MOVE +1                       TO ASC-BLK-SUB.                27960052
236000     COMPUTE ASC-ITEM-SUB =                                       27970052
236100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              27980052
236200         + PC-ITEMS-PER-PANEL).                                   27990052
236300                                                                  28000052
236400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        28010052
236500         ADD +1                    TO ASC-BLK-SUB                 28020052
236600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            28030052
236700     END-IF.                                                      28040052
236800                                                                  28050052
236900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           28060052
237000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                28070052
237100     PERFORM 4420-FORMAT-LIST-LINES                               28080052
237200         VARYING PV-SUB                                           28090052
237300         FROM PC-ITEMS-PER-PANEL BY -1                            28100052
237400         UNTIL PV-SUB < +1.                                       28110052
                                                                        28120052
W24803     PERFORM 4450-CHECK-WEBITM                                    28130052
                                                                        28140052
           IF PV-DB2-COUNT > 0                                          28150052
W24803        MOVE DP015-RED  TO AMJCLC                                 28160052
W24803                           ASUCLC                                 28170052
W24803                           ASKUC                                  28180052
           ELSE                                                         28190052
W24803        MOVE DP015-BLUE TO AMJCLC                                 28200052
W24803                           ASUCLC                                 28210052
W24803                           ASKUC                                  28220052
           END-IF                                                       28230052
237500                                                                  28240052
237600     COMPUTE ASC-ITEMS-DISPLAYED =                                28250052
237700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          28260052
237800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    28270052
237900                                      ASTRTITO.                   28280052
238000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    28290052
238100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    28300052
238200     MOVE ASC-DPT-NBR              TO ADEPTO                      28310052
238400     MOVE ASC-ENT-NAME-DESC        TO AVENDNMO.                   28320052
238500     MOVE ASC-KEY-PO-NBR           TO APONUMO.                    28330052
238600     MOVE ASC-PO-LNE-NBR           TO ALINEO.                     28340052
W24803     MOVE ASC-MAJ-CL-NBR           TO AMJCLO.                     28350052
W24803     MOVE ASC-SUB-CL-NBR           TO ASUCLO.                     28360052
238800     MOVE ASC-SKU-NBR              TO ASKUO.                      28370052
238900     MOVE ASC-SKU-DESC             TO ADESCO.                     28380052
239000     MOVE ASC-COLOR-DESC           TO ACOLO.                      28390052
239100     MOVE ASC-SIZE-DESC            TO ASIZEO.                     28400052
239200     MOVE ASC-VEND-STYL-NAME       TO ASTYLEO.                    28410052
239300     MOVE ASC-UNIT-QTY             TO AQUANO.                     28420052
239400     MOVE ASC-TOT-SHIP-QTY         TO ASHPQTYO.                   28430052
239500     MOVE ASC-YEAR (1)             TO AYEAR1O.                    28440052
239600     MOVE ASC-YEAR (2)             TO AYEAR2O.                    28450052
239700     MOVE ASC-YEAR (3)             TO AYEAR3O.                    28460052
239800     MOVE ASC-YEAR (4)             TO AYEAR4O.                    28470052
239900     MOVE ASC-YEAR (5)             TO AYEAR5O.                    28480052
240000     MOVE ASC-YEAR (6)             TO AYEAR6O.                    28490052
240100     MOVE ASC-DATE (1)             TO ADAT1O.                     28500052
240200     MOVE ASC-DATE (2)             TO ADAT2O.                     28510052
240300     MOVE ASC-DATE (3)             TO ADAT3O.                     28520052
240400     MOVE ASC-DATE (4)             TO ADAT4O.                     28530052
240500     MOVE ASC-DATE (5)             TO ADAT5O.                     28540052
240600     MOVE ASC-DATE (6)             TO ADAT6O.                     28550052
240700     MOVE ASC-DATE (7)             TO ADAT7O.                     28560052
240800                                                                  28570052
240900     IF  DP020-MSG-NUMBER-X = SPACE                               28580052
241000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  28590052
241100*            --- MORE ITEMS TO DISPLAY ----                       28600052
241200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            28610052
241300             SET DP020-MSG-INFORMATIONAL                          28620052
241400                                   TO TRUE                        28630052
241500         END-IF                                                   28640052
241600     END-IF.                                                      28650052
241700                                                                  28660052
241800                                                                  28670052
241900*----------------------------------------------------------------*28680052
242000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *28690052
242100*----------------------------------------------------------------*28700052
242200 4410-READ-TEMP-STORAGE.                                          28710052
242300                                                                  28720052
242400     EXEC CICS                                                    28730052
242500         READQ TS                                                 28740052
242600             QUEUE (ASC-LIST-QUEUE-NAME)                          28750052
242700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28760052
242800             ITEM  (PV-BLOCK-NUMBER)                              28770052
242900             RESP  (PV-CICS-RESP)                                 28780052
243000     END-EXEC.                                                    28790052
243100                                                                  28800052
243200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       28810052
243300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     28820052
243400         CONTINUE                                                 28830052
243500     ELSE                                                         28840052
243600         SET DP013-CICS-ABEND      TO TRUE                        28850052
243700         SET DP013-NO-ROLLBACK     TO TRUE                        28860052
243800         MOVE '4410-READ-TEMP-STORAGE'                            28870052
243900                                   TO DP013-PARAGRAPH             28880052
244000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      28890052
244100                                   TO DP013-MESSAGE-TEXT(1)       28900052
244200         PERFORM DP013-0000-PROCESS-ABEND                         28910052
244300     END-IF.                                                      28920052
244400                                                                  28930052
244500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28940052
244600                                                                  28950052
244700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         28960052
244800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               28970052
244900     END-IF.                                                      28980052
245000                                                                  28990052
245100                                                                  29000052
245200*----------------------------------------------------------------*29010052
245300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *29020052
245400*----------------------------------------------------------------*29030052
245500 4420-FORMAT-LIST-LINES.                                          29040052
245600                                                                  29050052
245700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      29060052
245800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                29070052
245900         MOVE ZERO                 TO MR-PLAN-QTYI (PV-SUB)       29080052
246000                                      MR-RCVD-QTYI (PV-SUB)       29090052
246100                                      MR-QTY-REC1I (PV-SUB)       29100052
246200                                      MR-QTY-REC2I (PV-SUB)       29110052
246300                                      MR-QTY-REC3I (PV-SUB)       29120052
246400                                      MR-QTY-REC4I (PV-SUB)       29130052
246500                                      MR-QTY-REC5I (PV-SUB)       29140052
246600                                      MR-QTY-REC6I (PV-SUB)       29150052
246700                                      MR-QTY-RECOI (PV-SUB)       29160052
246800                                      MR-STORE-NBRI (PV-SUB)      29170052
246900                                                                  29180052
247000         MOVE SPACE                TO MR-STORE-NAMEI (PV-SUB)     29190052
247100                                      MR-DC-INDI   (PV-SUB)       29200052
247200     ELSE                                                         29210052
247300         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           29220052
247400             MOVE ASC-PLAN-QTY   (ASC-BLK-SUB ASC-ITEM-SUB)       29230052
247500                                   TO MR-PLAN-QTYI (PV-SUB)       29240052
247600             MOVE ASC-RCVD-QTY   (ASC-BLK-SUB ASC-ITEM-SUB)       29250052
247700                                   TO MR-RCVD-QTYI (PV-SUB)       29260052
247800             MOVE ASC-STORE-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)       29270052
247900                                   TO MR-STORE-NBRI (PV-SUB)      29280052
248000             MOVE ASC-STORE-NAME (ASC-BLK-SUB ASC-ITEM-SUB)       29290052
248100                                   TO MR-STORE-NAMEI (PV-SUB)     29300052
248200             MOVE ASC-DC-IND     (ASC-BLK-SUB ASC-ITEM-SUB)       29310052
248300                                   TO MR-DC-INDI    (PV-SUB)      29320052
248400             MOVE ASC-RCVD-QTY1  (ASC-BLK-SUB ASC-ITEM-SUB)       29330052
248500                                   TO MR-QTY-REC1I (PV-SUB)       29340052
248600             MOVE ASC-RCVD-QTY2  (ASC-BLK-SUB ASC-ITEM-SUB)       29350052
248700                                   TO MR-QTY-REC2I (PV-SUB)       29360052
248800             MOVE ASC-RCVD-QTY3  (ASC-BLK-SUB ASC-ITEM-SUB)       29370052
248900                                   TO MR-QTY-REC3I (PV-SUB)       29380052
249000             MOVE ASC-RCVD-QTY4  (ASC-BLK-SUB ASC-ITEM-SUB)       29390052
249100                                   TO MR-QTY-REC4I (PV-SUB)       29400052
249200             MOVE ASC-RCVD-QTY5  (ASC-BLK-SUB ASC-ITEM-SUB)       29410052
249300                                   TO MR-QTY-REC5I (PV-SUB)       29420052
249400             MOVE ASC-RCVD-QTY6  (ASC-BLK-SUB ASC-ITEM-SUB)       29430052
249500                                   TO MR-QTY-REC6I (PV-SUB)       29440052
249600             MOVE ASC-RCVD-QTYO  (ASC-BLK-SUB ASC-ITEM-SUB)       29450052
249700                                   TO MR-QTY-RECOI (PV-SUB)       29460052
249800             IF  MR-DC-INDI (PV-SUB) = '**'                       29470052
249900                 MOVE DP015-YELLOW                                29480052
250000                                   TO MR-STORE-NBRC (PV-SUB)      29490052
250100                                      MR-STORE-NAMEC(PV-SUB)      29500052
250200                                      MR-DC-INDC    (PV-SUB)      29510052
250300                                      MR-PLAN-QTYC  (PV-SUB)      29520052
250400                                      MR-RCVD-QTYC  (PV-SUB)      29530052
250500                                      MR-QTY-REC1C  (PV-SUB)      29540052
250600                                      MR-QTY-REC2C  (PV-SUB)      29550052
250700                                      MR-QTY-REC3C  (PV-SUB)      29560052
250800                                      MR-QTY-REC4C  (PV-SUB)      29570052
250900                                      MR-QTY-REC5C  (PV-SUB)      29580052
251000                                      MR-QTY-REC6C  (PV-SUB)      29590052
251100                                      MR-QTY-RECOC  (PV-SUB)      29600052
251200             ELSE                                                 29610052
251300                 MOVE DP015-BLUE   TO MR-STORE-NBRC (PV-SUB)      29620052
251400                                      MR-STORE-NAMEC(PV-SUB)      29630052
251500                                      MR-DC-INDC    (PV-SUB)      29640052
251600                                      MR-PLAN-QTYC  (PV-SUB)      29650052
251700                                      MR-RCVD-QTYC  (PV-SUB)      29660052
251800                                      MR-QTY-REC1C  (PV-SUB)      29670052
251900                                      MR-QTY-REC2C  (PV-SUB)      29680052
252000                                      MR-QTY-REC3C  (PV-SUB)      29690052
252100                                      MR-QTY-REC4C  (PV-SUB)      29700052
252200                                      MR-QTY-REC5C  (PV-SUB)      29710052
252300                                      MR-QTY-REC6C  (PV-SUB)      29720052
252400                                      MR-QTY-RECOC  (PV-SUB)      29730052
252500             END-IF                                               29740052
252600         END-IF                                                   29750052
252700     END-IF.                                                      29760052
252800     SUBTRACT +1 FROM ASC-ITEM-SUB                                29770052
252900     IF  ASC-ITEM-SUB < + 1                                       29780052
253000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                29790052
253100         MOVE +1                   TO ASC-BLK-SUB                 29800052
253200     END-IF.                                                      29810052
253300                                                                  29820052
378800*----------------------------------------------------------------*29830052
378900* DETERMINE IF LINE ITEM IS ON TWEBUPC TABLE                     *29840052
W24803* NOTE : TWEBITM AND TUPCPLS TABLES ARE NOT REPLACED BY LOGISTICS*29850052
W24803* DOMAIN TABLES BECAUSE OF PERFORMACE ISSUES.                    *29860052
379100*----------------------------------------------------------------*29870052
W24803 4450-CHECK-WEBITM.                                               29880052
W24803     MOVE ASC-KEY-PO-NBR      TO PURCHS-PO-NBR                    29890052
W24803     MOVE ASC-KEY-PO-LINE-NBR TO PURITM-PO-LNE-NBR                29900052
373400     PERFORM                                                      29910052
373500         WITH TEST AFTER                                          29920052
373600         VARYING PV-RETRY-COUNTER                                 29930052
373700         FROM 1 BY 1                                              29940052
373800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29950052
373900             OR (SQLCODE = +0) OR (SQLCODE = +100))               29960052
               EXEC SQL                                                 29970052
                    SELECT COUNT(*)                                     29980052
                     INTO :PV-DB2-COUNT                                 29990052
                     FROM TWEBITM A                                     30000052
                         ,TUPCPLS C                                     30010052
                         ,TPURITM E                                     30020052
                         ,TPURCHS F                                     30030052
W24803             WHERE F.PO_NBR = :PURCHS-PO-NBR                      30040052
                     AND F.PO_NBR = E.PO_NBR                            30050052
                     AND F.VER_STATUS_CDE = 'A'                         30060052
                     AND E.VER_STATUS_CDE = 'A'                         30070052
W24803               AND E.PO_LNE_NBR = :PURITM-PO-LNE-NBR              30080052
                     AND E.ITM_NBR = C.ITM_NBR                          30090052
                     AND C.OPERCO_NBR = '03'                            30100052
                     AND C.STR_NBR = 0                                  30110052
                     AND ((C.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      30120052
                           C.EFF_END_TMST IS NULL) OR                   30130052
                          (C.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      30140052
                           C.EFF_END_TMST > CURRENT TIMESTAMP))         30150052
                     AND   C.UPC_ID = A.INTR_UPC_ID                     30160052
                     AND  (A.EFF_BEG_TMST <= CURRENT TIMESTAMP          30170052
                             AND A.EFF_END_TMST IS NULL)                30180052
               END-EXEC                                                 30190052
                                                                        30200052
               EVALUATE TRUE                                            30210052
                   WHEN SQLCODE = +0                                    30220052
                   WHEN SQLCODE = +100                                  30230052
                   WHEN SQLCODE = -904                                  30240052
                   WHEN SQLCODE = -913                                  30250052
                        CONTINUE                                        30260052
                   WHEN SQLWARN0 NOT = SPACES                           30270052
                   WHEN SQLCODE < +0                                    30280052
                   WHEN SQLCODE > +0                                    30290052
W24803                  MOVE '4450-CHECK-WEBITM'                        30300052
376100                                  TO DP013-PARAGRAPH              30310052
376200                  MOVE 'UNSUCCESSFUL SELECT COUNT(*)'             30320052
376300                                  TO DP013-MESSAGE-TEXT (1)       30330052
376400                  MOVE SQLCA      TO DP013-SQLCA                  30340052
W24803                  MOVE 'TWEBITM '                                 30350052
W24803                                  TO DP013-DB2-TABLE-NAME (1)     30360052
W24803                  MOVE 'TUPCPLS '                                 30370052
W24803                                  TO DP013-DB2-TABLE-NAME (2)     30380052
W24803                  MOVE 'TPURITM '                                 30390052
W24803                                  TO DP013-DB2-TABLE-NAME (3)     30400052
W24803                  MOVE 'TPURCHS '                                 30410052
W24803                                  TO DP013-DB2-TABLE-NAME (4)     30420052
376600                  SET DP013-DB2-ABEND                             30430052
376700                  DP013-XCTL-DISPLAY-RESTART                      30440052
376800                                  TO TRUE                         30450052
376900                  PERFORM DP013-0000-PROCESS-ABEND                30460052
377000         END-EVALUATE                                             30470052
377100     END-PERFORM.                                                 30480052
377200                                                                  30490052
377300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30500052
W24803         MOVE '4450-CHECK- XLVWEBSKU'                             30510052
W24803                                  TO DP013-PARAGRAPH              30520052
377500         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TWEBUPC'        30530052
377600                                  TO DP013-MESSAGE-TEXT (1)       30540052
377700         MOVE SQLCA               TO DP013-SQLCA                  30550052
W24803         MOVE 'XLV_WEB_SKU '                                      30560052
W24803                                  TO DP013-DB2-TABLE-NAME (1)     30570052
W24803         MOVE 'XLT_SKU '                                          30580052
W24803                                  TO DP013-DB2-TABLE-NAME (2)     30590052
W24803         MOVE 'XLV_SKU_STR '                                      30600052
W24803                                  TO DP013-DB2-TABLE-NAME (3)     30610052
377900         SET DP013-DB2-ABEND                                      30620052
378000             DP013-XCTL-DISPLAY-RESTART                           30630052
378100                                  TO TRUE                         30640052
378200         PERFORM DP013-0000-PROCESS-ABEND                         30650052
378300     END-IF.                                                      30660052
206400                                                                  30670052
253400*----------------------------------------------------------------*30680052
253500*    DETERMINES 5 CHARACTER NAME FOR STORE OR DC.                *30690052
253600*----------------------------------------------------------------*30700052
253700 4999-GET-STR-NAME.                                               30710052
           MOVE PV-STORE-NBR TO PV-STORE-NBR-DB2.                       30720055
253800                                                                  30730052
253900     PERFORM                                                      30740052
254000         WITH TEST AFTER                                          30750052
254100         VARYING PV-RETRY-COUNTER                                 30760052
254200         FROM 1 BY 1                                              30770052
254300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30780052
254400                   OR (SQLCODE = ZERO)                            30790052
254500                   OR (SQLCODE = +100))                           30800052
254600         EXEC SQL                                                 30810052
254700              SELECT LOC_5_ABBR_NM,                               30820054
254800                     LOC_TYP_CDE                                  30830054
254900              INTO :XMT00001-LOC-5-ABBR-NM,                       30840054
255000                   :XMT00001-LOC-TYP-CDE                          30850054
255100              FROM XMT_LOC                                        30860054
255200              WHERE LOC_NBR = :PV-STORE-NBR-DB2                   30870054
255300         END-EXEC                                                 30880052
255400                                                                  30890052
255500         EVALUATE TRUE                                            30900052
255600             WHEN SQLCODE = ZERO                                  30910052
255700             WHEN SQLCODE = +100                                  30920052
255800             WHEN SQLCODE = -904                                  30930052
255900             WHEN SQLCODE = -913                                  30940052
256000                 CONTINUE                                         30950052
256100             WHEN SQLWARN0 NOT = SPACES                           30960052
256200             WHEN SQLCODE < ZERO                                  30970052
256300             WHEN SQLCODE > ZERO                                  30980052
256400                 MOVE '4999-GET-STR-NAME'                         30990052
256500                                   TO DP013-PARAGRAPH             31000052
256600                 MOVE 'SELECT STORE NAME'                         31010052
256700                                   TO DP013-MESSAGE-TEXT (1)      31020052
256800                 MOVE SQLCA        TO DP013-SQLCA                 31030052
256900                 MOVE 'XMT_LOC '   TO DP013-DB2-TABLE-NAME (1)    31040054
257000                 SET DP013-DB2-ABEND                              31050052
257100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           31060052
257200                 PERFORM DP013-0000-PROCESS-ABEND                 31070052
257300         END-EVALUATE                                             31080052
257400     END-PERFORM.                                                 31090052
257500                                                                  31100052
257600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31110052
257700         MOVE '4999-GET-STR-NAME' TO DP013-PARAGRAPH              31120052
257800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT STR' 31130052
257900                                   TO DP013-MESSAGE-TEXT (1)      31140052
258000         MOVE SQLCA                TO DP013-SQLCA                 31150052
258100         MOVE 'XMT_LOC '           TO DP013-DB2-TABLE-NAME (1)    31160054
258200         SET DP013-DB2-ABEND                                      31170052
258300             DP013-XCTL-DISPLAY-RESTART                           31180052
258400                                   TO TRUE                        31190052
258500         PERFORM DP013-0000-PROCESS-ABEND                         31200052
258600     END-IF.                                                      31210052
258700                                                                  31220052
258800     IF SQLCODE = +100                                            31230052
258900         MOVE SPACES               TO XMT00001-LOC-5-ABBR-NM      31240054
259000                                      XMT00001-LOC-TYP-CDE        31250054
259100     END-IF.                                                      31260052
259200                                                                  31270052
259300*----------------------------------------------------------------*31280052
259400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *31290052
259500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *31300052
259600*----------------------------------------------------------------*31310052
259700 5100-WRITE-TEMP-STORAGE.                                         31320052
259800                                                                  31330052
259900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     31340052
260000                                   TO PV-LIST-ITEM-NUMBER.        31350052
260100     COMPUTE PV-BLOCK-NUMBER =                                    31360052
260200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    31370052
260300                                                                  31380052
260400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             31390052
260500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             31400052
260600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      31410052
260700             PERFORM 5105-REWRITE-ASC-LISTQ                       31420052
260800         END-IF                                                   31430052
260900     ELSE                                                         31440052
261000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       31450052
261100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            31460052
261200         PERFORM 5110-WRITE-ASC-LISTQ                             31470052
261300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   31480052
261400     END-IF.                                                      31490052
261500                                                                  31500052
261600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      31510052
261700                                   TO TRUE.                       31520052
261800                                                                  31530052
261900                                                                  31540052
262000******************************************************************31550052
262100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **31560052
262200** SPECIFIC COMMAREA.                                           **31570052
262300******************************************************************31580052
262400 5105-REWRITE-ASC-LISTQ.                                          31590052
262500                                                                  31600052
262600     EXEC CICS                                                    31610052
262700         WRITEQ TS                                                31620052
262800             QUEUE (ASC-LIST-QUEUE-NAME)                          31630052
262900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31640052
263000             ITEM  (PV-BLOCK-NUMBER)                              31650052
263100             REWRITE                                              31660052
263200             RESP  (PV-CICS-RESP)                                 31670052
263300     END-EXEC.                                                    31680052
263400                                                                  31690052
263500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           31700052
263600         CONTINUE                                                 31710052
263700     ELSE                                                         31720052
263800         SET DP013-CICS-ABEND      TO TRUE                        31730052
263900         SET DP013-NO-ROLLBACK     TO TRUE                        31740052
264000         MOVE '5105-REWRITE-ASC-LISTQ'                            31750052
264100                                   TO DP013-PARAGRAPH             31760052
264200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     31770052
264300                                   TO DP013-MESSAGE-TEXT(1)       31780052
264400         PERFORM DP013-0000-PROCESS-ABEND                         31790052
264500     END-IF.                                                      31800052
264600                                                                  31810052
264700                                                                  31820052
264800******************************************************************31830052
264900** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **31840052
265000** SPECIFIC COMMAREA.                                           **31850052
265100******************************************************************31860052
265200 5110-WRITE-ASC-LISTQ.                                            31870052
265300                                                                  31880052
265400     EXEC CICS                                                    31890052
265500         WRITEQ TS                                                31900052
265600             QUEUE (ASC-LIST-QUEUE-NAME)                          31910052
265700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31920052
265800             ITEM  (PV-BLOCK-NUMBER)                              31930052
265900             RESP  (PV-CICS-RESP)                                 31940052
266000     END-EXEC.                                                    31950052
266100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      31960052
266200         SET DP013-CICS-ABEND      TO TRUE                        31970052
266300         SET DP013-NO-ROLLBACK     TO TRUE                        31980052
266400         MOVE '5110-WRITE-ASC-LISTQ'                              31990052
266500                                   TO DP013-PARAGRAPH             32000052
266600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           32010052
266700                                   TO DP013-MESSAGE-TEXT(1)       32020052
266800         PERFORM DP013-0000-PROCESS-ABEND                         32030052
266900     END-IF.                                                      32040052
267000                                                                  32050052
267100                                                                  32060052
267200*----------------------------------------------------------------*32070052
267300* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *32080052
267400*----------------------------------------------------------------*32090052
267500 9100-READ-SEL-QUEUE.                                             32100052
267600                                                                  32110052
267700     EXEC CICS                                                    32120052
267800         READQ TS                                                 32130052
267900             QUEUE (ASC-SEL-QUEUE-NAME)                           32140052
268000             INTO  (PO012-PO-SELECT-RECORD)                       32150052
268100             ITEM  (ASC-SEL-ITEM)                                 32160052
268200             RESP  (PV-CICS-RESP)                                 32170052
268300     END-EXEC.                                                    32180052
268400                                                                  32190052
268500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       32200052
268600         CONTINUE                                                 32210052
268700     ELSE                                                         32220052
268800         SET DP013-LOGIC-ABEND                                    32230052
268900             DP013-NO-ROLLBACK     TO TRUE                        32240052
269000         MOVE '9100-READ-SEL-QUEUE'                               32250052
269100                                   TO DP013-PARAGRAPH             32260052
269200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   32270052
269300                                   TO DP013-MESSAGE-TEXT (1)      32280052
269400         PERFORM DP013-0000-PROCESS-ABEND                         32290052
269500     END-IF.                                                      32300052
269600                                                                  32310052
269700                                                                  32320052
269800*----------------------------------------------------------------*32330052
269900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *32340052
270000*----------------------------------------------------------------*32350052
270100 9200-REWRITE-LIST-QUEUE.                                         32360052
270200                                                                  32370052
270300     EXEC CICS                                                    32380052
270400          WRITEQ TS                                               32390052
270500              QUEUE  (ASC-SEL-QUEUE-NAME)                         32400052
270600              FROM   (PO012-PO-SELECT-RECORD)                     32410052
270700              ITEM   (ASC-SEL-ITEM)                               32420052
270800              RESP   (PV-CICS-RESP)                               32430052
270900              REWRITE                                             32440052
271000     END-EXEC.                                                    32450052
271100                                                                  32460052
271200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   32470052
271300         SET DP013-CICS-ABEND                                     32480052
271400             DP013-NO-ROLLBACK     TO TRUE                        32490052
271500         MOVE '9200-REWRITE-LIST-QUEUE'                           32500052
271600                                   TO DP013-PARAGRAPH             32510052
271700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   32520052
271800                                   TO DP013-MESSAGE-TEXT (1)      32530052
271900         PERFORM DP013-0000-PROCESS-ABEND                         32540052
272000     END-IF.                                                      32550052
272100                                                                  32560052
272200                                                                  32570052
272300*----------------------------------------------------------------*32580052
272400* READ AN ITEM FROM THE SELECTED PKSL ITEMS TEMP STORAGE QUEUE.  *32590052
272500*----------------------------------------------------------------*32600052
272600 9300-READ-PKSL-SEL-QUEUE.                                        32610052
272700                                                                  32620052
272800     EXEC CICS                                                    32630052
272900         READQ TS                                                 32640052
273000             QUEUE (ASC-SEL-QUEUE-NAME)                           32650052
273100             INTO  (RC013-DC-SELECT-RECORD)                       32660052
273200             ITEM  (ASC-SEL-ITEM)                                 32670052
273300             RESP  (PV-CICS-RESP)                                 32680052
273400     END-EXEC.                                                    32690052
273500                                                                  32700052
273600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       32710052
273700         CONTINUE                                                 32720052
273800     ELSE                                                         32730052
273900         SET DP013-LOGIC-ABEND                                    32740052
274000             DP013-NO-ROLLBACK     TO TRUE                        32750052
274100         MOVE '9300-READ-PKSL-SEL-QUEUE'                          32760052
274200                                   TO DP013-PARAGRAPH             32770052
274300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   32780052
274400                                   TO DP013-MESSAGE-TEXT (1)      32790052
274500         PERFORM DP013-0000-PROCESS-ABEND                         32800052
274600     END-IF.                                                      32810052
274700                                                                  32820052
274800                                                                  32830052
274900*----------------------------------------------------------------*32840052
275000* UPDATE AN ITEM IN THE SELECTED PKSL ITEMS TEMP STORAGE QUEUE.  *32850052
275100*----------------------------------------------------------------*32860052
275200 9400-REWRITE-PKSL-LIST-QUEUE.                                    32870052
275300                                                                  32880052
275400     EXEC CICS                                                    32890052
275500          WRITEQ TS                                               32900052
275600              QUEUE  (ASC-SEL-QUEUE-NAME)                         32910052
275700              FROM   (RC013-DC-SELECT-RECORD)                     32920052
275800              ITEM   (ASC-SEL-ITEM)                               32930052
275900              RESP   (PV-CICS-RESP)                               32940052
276000              REWRITE                                             32950052
276100     END-EXEC.                                                    32960052
276200                                                                  32970052
276300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   32980052
276400         SET DP013-CICS-ABEND                                     32990052
276500             DP013-NO-ROLLBACK     TO TRUE                        33000052
276600         MOVE '9400-REWRITE-PKSL-LIST-QUEUE'                      33010052
276700                                   TO DP013-PARAGRAPH             33020052
276800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33030052
276900                                   TO DP013-MESSAGE-TEXT (1)      33040052
277000         PERFORM DP013-0000-PROCESS-ABEND                         33050052
277100     END-IF.                                                      33060052
277200                                                                  33070052
277300                                                                  33080052
277400*----------------------------------------------------------------*33090052
277500* READ AN ITEM FROM THE SELECTED SKU RCVR TEMP STORAGE QUEUE.    *33100052
277600*----------------------------------------------------------------*33110052
277700 9500-READ-SKU-RCVR-SEL-QUEUE.                                    33120052
277800                                                                  33130052
277900     EXEC CICS                                                    33140052
278000         READQ TS                                                 33150052
278100             QUEUE (ASC-SEL-QUEUE-NAME)                           33160052
278200             INTO  (PO070-SKU-RECEIVER-REC)                       33170052
278300             ITEM  (ASC-SEL-ITEM)                                 33180052
278400             RESP  (PV-CICS-RESP)                                 33190052
278500     END-EXEC.                                                    33200052
278600                                                                  33210052
278700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       33220052
278800         CONTINUE                                                 33230052
278900     ELSE                                                         33240052
279000         SET DP013-LOGIC-ABEND                                    33250052
279100             DP013-NO-ROLLBACK     TO TRUE                        33260052
279200         MOVE '9500-READ-SKU-RCVR-SEL-QUEUE'                      33270052
279300                                   TO DP013-PARAGRAPH             33280052
279400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   33290052
279500                                   TO DP013-MESSAGE-TEXT (1)      33300052
279600         PERFORM DP013-0000-PROCESS-ABEND                         33310052
279700     END-IF.                                                      33320052
279800                                                                  33330052
279900                                                                  33340052
280000*----------------------------------------------------------------*33350052
280100* UPDATE AN ITEM IN THE SELECTED PKSL ITEMS TEMP STORAGE QUEUE.  *33360052
280200*----------------------------------------------------------------*33370052
280300 9600-REWRITE-RCVR-LIST-QUEUE.                                    33380052
280400                                                                  33390052
280500     EXEC CICS                                                    33400052
280600          WRITEQ TS                                               33410052
280700              QUEUE  (ASC-SEL-QUEUE-NAME)                         33420052
280800              FROM   (PO070-SKU-RECEIVER-REC)                     33430052
280900              ITEM   (ASC-SEL-ITEM)                               33440052
281000              RESP   (PV-CICS-RESP)                               33450052
281100              REWRITE                                             33460052
281200     END-EXEC.                                                    33470052
281300                                                                  33480052
281400     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   33490052
281500         SET DP013-CICS-ABEND                                     33500052
281600             DP013-NO-ROLLBACK     TO TRUE                        33510052
281700         MOVE '9600-REWRITE-RCVR-LIST-QUEUE'                      33520052
281800                                   TO DP013-PARAGRAPH             33530052
281900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33540052
282000                                   TO DP013-MESSAGE-TEXT (1)      33550052
282100         PERFORM DP013-0000-PROCESS-ABEND                         33560052
282200     END-IF.                                                      33570052
282300                                                                  33580052
282400                                                                  33590052
282500*----------------------------------------------------------------*33600052
282600*    ABEND PROCESSOR MODULE                                      *33610052
282700*----------------------------------------------------------------*33620052
282800                                                                  33630052
282900     COPY DPPD013.                                                33640052
