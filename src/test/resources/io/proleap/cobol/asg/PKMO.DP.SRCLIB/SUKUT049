000100 IDENTIFICATION DIVISION.                                         00010004
000200                                                                  00020004
000300 TITLE 'CARTONS MANIFESTED TO TRAILER EXTRACT'.                   00030004
000400 PROGRAM-ID.             SUKUT049.                                00040001
000500 AUTHOR.                 LYNN MCADAMS.                            00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN            AUGUST, 2001.                            00070004
000800 DATE-COMPILED.                                                   00080001
000900                                                                  00090001
001000*----------------------------------------------------------------*00100001
001100********* CARTONS THAT ARE EXPECTED TO BE ON THE TRAILER *********00110004
001200*                                                                *00120004
001300* THIS PROGRAM WILL CREATE AN EXTRACT FILE USED FOR REPORTING    *00130004
001400* OF MANIFESTED CARTON DATA FOR A TRAILER BEING AUDITED.         *00140004
001500*                                                                *00150004
001600* THIS CONSISTS OF CARTONS THAT HAVE BEEN DIVERTED, MANUALLY     *00160004
001700* SCANNED ON, OR SCANNED OFF DUE TO AN AUDIT BEING PERFORMED.    *00170004
001800*                                                                *00180004
001900* THE DATA WILL BE EXTRACTED FROM THE CARTON DATABASES USING     *00190004
002000* THE TRAILER AUDIT CONTROL NUMBER THAT WAS ENTERED ON THE RF    *00200004
002100* TRAILER AUDIT SCREEN (PCKRF892).                               *00210004
002200*                                                                *00220004
002300* THE CONTROL CARD IS READ AS INPUT TO THIS PROGRAM USING THE    *00230004
002400* AUDIT CONTROL NUMBER AND THE USER ID OF THE PERSON WHO CREATED *00240004
002500* THE AUDIT.                                                     *00250004
002600*                                                                *00260004
002700* THE MANIFEST OUTPUT EXTRACT FILE (SURD018) WILL CONTAIN ALL    *00270004
002800* CARTONS MANIFESTED TO THE TRAILER SERIAL NUMBER SPECIFIED.     *00280004
002900* IT WILL ALSO GIVE THE MANIFESTED CARTON COUNT AND THE          *00290004
003000* MANIFESTED CARTON ERROR COUNT.                                 *00300004
003100*                                                                *00310004
003200* THE MANIFEST NOT AUDITED EXTRACT FILE (SURD019) WILL CONTAIN   *00320004
003300* ALL CARTONS ON THE TRAILER THAT ARE MANIFESTED BUT NOT AUDITED.*00330004
003400*----------------------------------------------------------------*00340001
003500                                                                  00350002
003600 ENVIRONMENT DIVISION.                                            00360002
003700                                                                  00370002
003800                                                                  00380002
003900 CONFIGURATION SECTION.                                           00390002
004000                                                                  00400002
004100 SOURCE-COMPUTER.        IBM-3090.                                00410002
004200 OBJECT-COMPUTER.        IBM-3090.                                00420002
004300                                                                  00430002
004400 INPUT-OUTPUT SECTION.                                            00440002
004500                                                                  00450002
004600 FILE-CONTROL.                                                    00460002
004700*INPUT                                                            00470004
004800     SELECT CARDIN-INPUT-FILE                                     00480004
004900         ASSIGN TO CARDIN.                                        00490002
005000                                                                  00500004
005100*SURD018                                                          00510004
005200     SELECT MFST-EXTRACT-FILE                                     00520004
005300         ASSIGN TO OUT01.                                         00530004
005400                                                                  00540004
005500*SURD019                                                          00550004
005600     SELECT MFST-NOT-AUD-EXTRACT-FILE                             00560004
005700         ASSIGN TO OUT02.                                         00570004
005800*                                                                 00580002
005900*                                                                 00590004
006000 DATA DIVISION.                                                   00600002
006100                                                                  00610004
006200 FILE SECTION.                                                    00620002
006300                                                                  00630004
006400 FD  CARDIN-INPUT-FILE                                            00640004
006500     LABEL RECORDS ARE STANDARD                                   00650002
006600     RECORDING MODE IS F                                          00660002
006700     BLOCK CONTAINS 0 RECORDS                                     00670002
006800     RECORD CONTAINS 80 CHARACTERS.                               00680002
006900 01  CC-RECORD                       PIC X(80).                   00690002
007000                                                                  00700002
007100 FD  MFST-EXTRACT-FILE                                            00710004
007200     LABEL RECORDS ARE STANDARD                                   00720004
007300     RECORDING MODE IS F                                          00730004
007400     BLOCK CONTAINS 0 RECORDS                                     00740004
007500     RECORD CONTAINS 200 CHARACTERS.                              00750004
007600 01  SU-MFST-EXTRACT-RECORD          PIC X(200).                  00760004
007700                                                                  00770004
007800 FD  MFST-NOT-AUD-EXTRACT-FILE                                    00780004
007900     LABEL RECORDS ARE STANDARD                                   00790004
008000     RECORDING MODE IS F                                          00800004
008100     BLOCK CONTAINS 0 RECORDS                                     00810004
008200     RECORD CONTAINS 300 CHARACTERS.                              00820004
008300 01  SU-MFST-NOT-AUD-EXTRACT-RECORD  PIC X(300).                  00830004
008400*                                                                 00840002
008500*                                                                 00850004
008600 WORKING-STORAGE SECTION.                                         00860002
008700                                                                  00870004
008800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00880002
008900                                                   COMP SYNC.     00890002
009000 01  PROGRAM-SWITCHES.                                            00900002
009100     05  PS-EOF-CARDIN-SW               PIC X(01)   VALUE 'N'.    00910004
009200         88  PS-EOF-CARDIN-FILE                     VALUE 'Y'.    00920004
009300         88  PS-NOT-EOF-CARDIN-FILE                 VALUE 'N'.    00930004
009400     05  PS-EOF-STRT-STP-TMST-SW        PIC X(01)   VALUE 'N'.    00940004
009500         88  PS-EOF-STRT-STP-TMST                   VALUE 'Y'.    00950004
009600         88  PS-NOT-EOF-STRT-STP-TMST               VALUE 'N'.    00960004
009700     05  PS-MANIFEST-DC-SW              PIC X(01)   VALUE 'N'.    00970004
009800         88  PS-MANIFEST-DC-FOUND                   VALUE 'Y'.    00980004
009900         88  PS-MANIFEST-DC-NOT-FND                 VALUE 'N'.    00990004
010000     05  PS-CURSOR-SW                   PIC X(01).                01000004
010100         88  PS-AUD-SHP-ACTV-CSR                    VALUE 'A'.    01010004
010200         88  PS-AUD-SHTL-ACTV-CSR                   VALUE 'B'.    01020004
010300         88  PS-SCAN-OFF-CSR                        VALUE 'C'.    01030004
010400     05  PS-EOF-AUD-ERROR-CSR-SW        PIC X(01)   VALUE 'N'.    01040004
010500         88  PS-EOF-AUD-ERROR-CSR                   VALUE 'Y'.    01050004
010600         88  PS-NOT-EOF-AUD-ERROR-CSR               VALUE 'N'.    01060004
010700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    01070004
010800         88  PS-CRTN-HAS-ERRORS                     VALUE 'Y'.    01080004
010900         88  PS-CRTN-NO-ERRORS                      VALUE 'N'.    01090004
011000                                                                  01100004
011100 01  PC-CONSTANTS.                                                01110002
011200     05  PC-1                        PIC S9(03)    VALUE +1       01120002
011300                                                   COMP-3.        01130002
011400     05  PC-18                       PIC S9(04)    VALUE 18       01140002
011500                                                   COMP SYNC.     01150002
011600     05  PC-A                        PIC  X(01)    VALUE 'A'.     01160002
011700     05  PC-N                        PIC  X(01)    VALUE 'N'.     01170004
011800     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01180004
011900     05  PC-S                        PIC  X(09)                   01190004
012000                                     VALUE 'SAME     '.           01200004
012100     05  PC-D                        PIC  X(09)                   01210004
012200                                     VALUE 'DIFFERENT'.           01220004
012300     05  PC-C                        PIC  X(09)                   01230004
012400                                     VALUE ' CONVEYOR'.           01240004
012500     05  PC-100                      PIC  X(06)                   01250004
012600                                     VALUE '100%  '.              01260004
012700     05  PC-SPOT                     PIC  X(06)                   01270004
012800                                     VALUE 'SPOT  '.              01280004
012900     05  PC-REWORK                   PIC  X(06)                   01290004
013000                                     VALUE 'REWORK'.              01300004
013100     05  PC-CR                       PIC  X(16)                   01310004
013200                                     VALUE 'AUDIT CREATE    '.    01320004
013300     05  PC-IP                       PIC  X(16)                   01330004
013400                                     VALUE 'AUDIT IN PROCESS'.    01340004
013500     05  PC-CM                       PIC  X(16)                   01350004
013600                                     VALUE 'AUDIT COMPLETE  '.    01360004
013700     05  PC-PP                       PIC  X(16)                   01370004
013800                                     VALUE 'AUDIT POSTPONE  '.    01380004
013900     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01390002
014000         'SUKUT049'.                                              01400004
014100     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.01410004
014200     05  PC-DEFAULT-TMST         PIC X(26)                        01420004
014300             VALUE '9999-09-09-09.09.09.999999'.                  01430004
014400                                                                  01440004
014500 01  PV-MISC-FIELDS.                                              01450002
014600     05  PV-RETRY-COUNT          PIC S9(4)     COMP SYNC VALUE +0.01460004
014700     05  PV-SPACE                    PIC  X(01)    VALUE ' '.     01470004
014800     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01480004
014900                                                   COMP SYNC.     01490004
015000     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  01500004
015100     05  PV-CARTON-ID-DISPLAY        PIC  X(30)    VALUE SPACES.  01510004
015200     05  PV-OPER-UNT-ID              PIC  X(30)    VALUE SPACES.  01520004
015300     05  PV-START-TMST               PIC  X(30)    VALUE SPACES.  01530004
015400     05  PV-END-TMST                 PIC  X(30)    VALUE SPACES.  01540004
015500     05  PV-AUD-START-TMST           PIC  X(30)    VALUE SPACES.  01550004
015600     05  PV-AUD-END-TMST             PIC  X(30)    VALUE SPACES.  01560004
015700     05  PV-DEFAULT-TMST             PIC  X(30)    VALUE SPACES.  01570004
015800     05  PV-ACTIVE                   PIC  X(30)    VALUE SPACES.  01580004
015900     05  PV-INACTIVE                 PIC  X(30)    VALUE SPACES.  01590004
016000     05  PV-DOOR-ID                  PIC  X(04)    VALUE SPACES.  01600004
016100     05  PV-TRLR-DEST                PIC  X(04)    VALUE SPACES.  01610004
016200     05  PV-OTBND-TRIP-ID            PIC  X(30)    VALUE SPACES.  01620004
016300     05  PV-SCANNED-ON               PIC  X(30)    VALUE SPACES.  01630004
016400     05  PV-SCANNED-OFF              PIC  X(30)    VALUE SPACES.  01640004
016500     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01650004
016600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01660004
016700     05  PV-DISPLAY-SQLCODE          PIC -9(05)    VALUE ZEROES.  01670004
016710     05  PV-DISPLAY-OTBND-TRIP       PIC  9(09)    VALUE ZEROES.  01671004
016720     05  PV-DISPLAY-OPER             PIC  9(04)    VALUE ZEROES.  01672004
016730     05  PV-DISPLAY-DEST             PIC  9(04)    VALUE ZEROES.  01673004
016740     05  PV-DISPLAY-TRLR-SRL         PIC  9(09)    VALUE ZEROES.  01674004
016750     05  PV-DISPLAY-AUD-CNTL         PIC  9(09)    VALUE ZEROES.  01675004
016751     05  PV-DISPLAY-COUNT            PIC  ZZZ,ZZZ,ZZ9.            01675112
016760     05  PV-SQL-RETURN-CD            PIC  999-.                   01676004
016770     05  PV-DB2-TABLE-NAME           PIC  X(08)    VALUE SPACES.  01677004
016780     05  PV-DB2-OPERATION-MESSAGE-1  PIC  X(79)    VALUE SPACES.  01678004
016790     05  PV-DB2-OPERATION-MESSAGE-2  PIC  X(79)    VALUE SPACES.  01679004
016800     05  PV-DB2-OPERATION-MESSAGE-3  PIC  X(79)    VALUE SPACES.  01680004
016900     05  PV-DB2-OPERATION-MESSAGE-4  PIC  X(79)    VALUE SPACES.  01690004
017000                                                                  01700004
017100     05  PV-MFST-NOT-AUDITED         PIC  X(01)    VALUE SPACES.  01710004
017200     05  PV-MFST-NOT-AUD-MFST-DC     PIC  X(01)    VALUE SPACES.  01720004
017210                                                                  01721007
017220     05  PV-DEST-TRLR-SRL-NBR        PIC S9(09)    COMP.          01722007
017300                                                                  01730004
017400*BREAKDOWN OF SHIPT-UNT-ID (18 CHAR)                              01740004
017500     05  PV-CTN-X                        PIC  X(18).              01750004
017600     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              01760004
017700     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          01770004
017800         10  PV-CTN-9-1                  PIC  9(01).              01780004
017900         10  PV-CTN-9-2                  PIC  9(01).              01790004
018000         10  PV-CTN-9-3                  PIC  9(01).              01800004
018100         10  PV-CTN-9-4                  PIC  9(01).              01810004
018200         10  PV-CTN-9-5                  PIC  9(01).              01820004
018300         10  PV-CTN-9-6                  PIC  9(01).              01830004
018400         10  PV-CTN-9-7                  PIC  9(01).              01840004
018500         10  PV-CTN-9-8THRU10            PIC  9(03).              01850004
018600         10  PV-CTN-9-11                 PIC  9(01).              01860004
018700         10  PV-CTN-9-12                 PIC  9(01).              01870004
018800         10  PV-CTN-9-13                 PIC  9(01).              01880004
018900         10  PV-CTN-9-14                 PIC  9(01).              01890004
019000         10  PV-CTN-9-15                 PIC  9(01).              01900004
019100         10  PV-CTN-9-16                 PIC  9(01).              01910004
019200         10  PV-CTN-9-17                 PIC  9(01).              01920004
019300         10  PV-CTN-9-18                 PIC  9(01).              01930004
019400                                                                  01940004
019500     05  PV-ORIG-OPER-UNT-ID.                                     01950004
019600         10  PV-CTN-DIGIT-8          PIC   X(01).                 01960004
019700         10  PV-CTN-DIGIT-9          PIC   X(01).                 01970004
019800         10  PV-CTN-DIGIT-10         PIC   X(01).                 01980004
019900     05  PV-OPER-N REDEFINES PV-ORIG-OPER-UNT-ID.                 01990004
020000         10  PV-CTN-DIGIT-8-N        PIC   9(01).                 02000004
020100         10  PV-CTN-DIGIT-9-N        PIC   9(01).                 02010004
020200         10  PV-CTN-DIGIT-10-N       PIC   9(01).                 02020004
020210                                                                  02021012
020220     05  PV-WRITE-MANIFEST-COUNT     PIC  S9(9)     VALUE ZERO    02022012
020230                                                    COMP-3.       02023012
020240     05  PV-WRITE-EXCEPTION-COUNT    PIC  S9(9)     VALUE ZERO    02024012
020250                                                    COMP-3.       02025012
020300*                                                                 02030004
020400 EJECT                                                            02040004
020500                                                                  02050004
020600 01  DK-DB-KEYS.                                                  02060004
020700     05  DK-AUD-CNTL-NBR             PIC S9(09) COMP.             02070004
020800     05  DK-OPER-UNT-ID              PIC S9(04) COMP.             02080004
020900     05  DK-ORIG-OTBND-TRIP-ID       PIC S9(09) COMP.             02090004
021000     05  DK-DEST-OTBND-TRIP-ID       PIC S9(09) COMP.             02100004
021100     05  DK-ORIG-OPER-UNT-ID         PIC S9(04) COMP.             02110004
021200     05  DK-DEST-OPER-UNT-ID         PIC S9(04) COMP.             02120004
021300     05  DK-TRLR-SRL-NBR             PIC S9(09) COMP.             02130004
021400     05  DK-DOOR-ID                  PIC  X(04).                  02140004
021500     05  DK-DOOR-TYP-CDE             PIC  X(02).                  02150004
021600     05  DK-SHIPT-UNT-ID             PIC S9(18)V COMP-3.          02160004
021700*                                                                 02170004
021800 01  DN-DB2-NULL-INDICATORS.                                      02180004
021900     05  DN-ORIG-TRIP-ID             PIC S9(04) COMP VALUE +0.    02190004
022000     05  DN-DEST-TRIP-ID             PIC S9(04) COMP VALUE +0.    02200004
022100*                                                                 02210004
022200 01  CC-CONTROL-CARD.                                             02220004
022300     05  CC-AUD-CNTL-NBR             PIC  9(09).                  02230004
022400     05  FILLER                      PIC  X(01).                  02240004
022500     05  CC-USER-ID                  PIC  X(08).                  02250004
022600     05  FILLER                      PIC  X(62).                  02260004
022700                                                                  02270004
022800*  RECORD LAYOUT FOR THE MANIFEST EXTRACT OUTPUT FILE             02280004
022900 01  MFST-EXTRACT.                                                02290004
023000     COPY SURD018.                                                02300004
023100*                                                                 02310004
023200*  RECORD LAYOUT FOR THE AUDIT EXTRACT OUTPUT FILE                02320004
023300 01  AUDIT-EXTRACT.                                               02330004
023400     COPY SURD019.                                                02340004
023401                                                                  02340104
023402*  LOGISTICS DOMAIN LOCATION MODULE                               02340200
023403*                                                                 02340300
023404     COPY XLWS071.                                                02340400
023405                                                                  02340501
023406*  DB2 FORMATTED MESSAGE AREA                                     02340604
023407     COPY DPWS004.                                                02340704
023408                                                                  02340804
023409*  NUMERIC EDIT ROUTINE COMMAREA                                  02340904
023410     COPY DPWS010I.                                               02341004
023420                                                                  02342004
023430*  PCWS049 - WORK FIELDS USED TO DETERMINE TRAILER CONTENTS       02343004
023440     COPY PCWS049.                                                02344004
023450                                                                  02345004
023460**DB2 TABLES                                                      02346004
023470                                                                  02347004
023480* AUDIT TRAILER EXCEPTIONS TABLE                                  02348004
023490* SUT_AUD_TRLR_EXC                                                02349004
023500     EXEC SQL                                                     02350004
023600          INCLUDE SUT00002                                        02360004
023700     END-EXEC.                                                    02370004
023800                                                                  02380004
023900* AUDIT TRAILER TRIP TABLE                                        02390004
024000* SUT_AUD_TRLR_TRIP                                               02400004
024100     EXEC SQL                                                     02410004
024200          INCLUDE SUT00004                                        02420004
024300     END-EXEC.                                                    02430004
024400                                                                  02440004
024500* AUDIT HEADER TABLE                                              02450004
024600     EXEC SQL                                                     02460004
024700          INCLUDE TSUNAUD                                         02470004
024800     END-EXEC.                                                    02480004
024900                                                                  02490004
025000* SU-OUTBOUND CARTON                                              02500004
025100     EXEC SQL                                                     02510004
025200          INCLUDE SUT00024                                        02520004
025300     END-EXEC.                                                    02530004
025400                                                                  02540004
025500* SU-SHIPMENT UNIT/UPC ASSOCIATION                                02550004
025600     EXEC SQL                                                     02560004
025700          INCLUDE SUT00028                                        02570004
025800     END-EXEC.                                                    02580004
025900                                                                  02590004
026000* TRAILER DEFINITION TABLE                                        02600004
026100     EXEC SQL                                                     02610004
026200          INCLUDE TCNTRID                                         02620004
026300     END-EXEC.                                                    02630004
026400                                                                  02640004
026500* SHIPPING UNIT LOCATION TABLE                                    02650004
026600     EXEC SQL                                                     02660004
026700          INCLUDE SUT00027                                        02670004
026800     END-EXEC.                                                    02680004
026900                                                                  02690004
027000* CARTON DIVERT/OUTBOUND TRIP ASSOCIATION TABLE                   02700004
027100     EXEC SQL                                                     02710004
027200          INCLUDE TSUCDOT                                         02720004
027300     END-EXEC.                                                    02730004
027400                                                                  02740004
027500* OUTBOUND TRAILER TRIP TABLE                                     02750004
027600     EXEC SQL                                                     02760004
027700          INCLUDE TSUOBTR                                         02770004
027800     END-EXEC.                                                    02780004
027900                                                                  02790004
028000* OUTBOUND TRAILER TRIP STATUS TABLE                              02800004
028100     EXEC SQL                                                     02810004
028200          INCLUDE TSUOBTS                                         02820004
028300     END-EXEC.                                                    02830004
028400                                                                  02840004
028500* CARTON DIVERTS FROM CONVEYOR SYSTEM TABLE                       02850004
028600     EXEC SQL                                                     02860004
028700          INCLUDE TSUCRDV                                         02870004
028800     END-EXEC.                                                    02880004
028900                                                                  02890004
029000* DISTRIBUTION CENTER DOOR TO STORE ASSOCIATION TABLE             02900004
029100     EXEC SQL                                                     02910004
029200          INCLUDE TCNDRST                                         02920004
029300     END-EXEC.                                                    02930004
029400                                                                  02940004
029500* AUDIT TRAILER CARTON DETAIL TABLE                               02950004
029600* SUT_AUD_TRLR_CART                                               02960004
029700     EXEC SQL                                                     02970004
029800          INCLUDE SUT00000                                        02980004
029900     END-EXEC.                                                    02990004
030000                                                                  03000004
030100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARM TABLE TO      03010004
030200*  CHECK IF DC IS MANIFESTING                                     03020004
030300     EXEC SQL                                                     03030004
030400         INCLUDE TKRPRPM                                          03040004
030500     END-EXEC.                                                    03050004
030600                                                                  03060004
030700                                                                  03070004
030800* PCWS050 - CURSOR USED TO DETERMINE TRAILER CONTENTS             03080004
030900     COPY PCWS050.                                                03090004
031000                                                                  03100004
031100*  DB2 COMMUNICATION AREA                                         03110004
031200     EXEC SQL                                                     03120004
031300         INCLUDE SQLCA                                            03130004
031400     END-EXEC.                                                    03140004
031500                                                                  03150004
031600*  DB2 COMMUNICATION AREA2                                        03160004
031700     COPY SQLCA2.                                                 03170004
031800                                                                  03180004
031900 EJECT                                                            03190004
032000                                                                  03200004
032100                                                                  03210004
032200 PROCEDURE DIVISION.                                              03220004
032300                                                                  03230004
032400*THIS IS THE MAIN DRIVER FOR THE PROGRAM.                         03240004
032500 0000-MAINLINE-PROCESSING.                                        03250004
032600                                                                  03260004
032601     DISPLAY '******************************'.                    03260113
032602     DISPLAY '*                            *'.                    03260213
032603     DISPLAY '* SUKUT049 - BEGIN           *'.                    03260313
032604     DISPLAY '*                            *'.                    03260413
032605     DISPLAY '******************************'.                    03260513
032610                                                                  03261013
032700     PERFORM 1000-INITIALIZATION.                                 03270004
032800                                                                  03280004
032900     IF PS-NOT-EOF-CARDIN-FILE                                    03290004
033000         PERFORM 2000-PROCESS-CARTONS                             03300004
033100     END-IF.                                                      03310004
033200                                                                  03320004
033300     PERFORM 9000-EOJ-ROUTINE.                                    03330004
033400                                                                  03340004
033410     MOVE PV-WRITE-MANIFEST-COUNT  TO PV-DISPLAY-COUNT.           03341012
033411     DISPLAY 'SURD018 MANIFEST RECORDS WRITTEN.:  '               03341112
033412             PV-DISPLAY-COUNT.                                    03341212
033420     MOVE PV-WRITE-EXCEPTION-COUNT TO PV-DISPLAY-COUNT.           03342012
033430     DISPLAY 'SURD019 EXCEPTION RECORDS WRITTEN:  '               03343012
033440             PV-DISPLAY-COUNT.                                    03344012
033450                                                                  03345012
033500     GOBACK.                                                      03350004
033600*                                                                 03360004
033700*                                                                 03370004
033800*PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.                  03380004
033900 1000-INITIALIZATION.                                             03390004
034000                                                                  03400004
034200     OPEN INPUT  CARDIN-INPUT-FILE                                03420004
034300          OUTPUT MFST-EXTRACT-FILE                                03430004
034400          OUTPUT MFST-NOT-AUD-EXTRACT-FILE.                       03440004
034500                                                                  03450006
034510     INITIALIZE SU018-EXTRACT-RECORD.                             03451006
034617     INITIALIZE SU019-EXTRACT-RECORD.                             03461706
034645                                                                  03464506
034650     PERFORM 7000-READ-CARDIN-FILE.                               03465004
034700                                                                  03470004
034800     IF PS-EOF-CARDIN-FILE                                        03480004
034900         DISPLAY '** SUKUT049 ABEND **'                           03490004
035000         DISPLAY '** CARDIN (TRLR AUDIT NBR) FILE IS EMPTY **'    03500004
035100         MOVE +4019                  TO PV-ABEND-CODE             03510004
035200         CALL 'ILBOABN0' USING PV-ABEND-CODE                      03520004
035300     END-IF.                                                      03530004
035400*                                                                 03540004
035500*                                                                 03550004
035600 2000-PROCESS-CARTONS.                                            03560004
035800     MOVE CC-AUD-CNTL-NBR  TO  DK-AUD-CNTL-NBR.                   03580004
035900     PERFORM 2300-GET-AUDIT-INFO.                                 03590004
036000     PERFORM 2100-GET-OTBND-TRIP.                                 03600006
036100     PERFORM 2200-GET-ORIG-TRAILER-NBR.                           03610004
036200                                                                  03620004
036300     IF DK-DEST-OTBND-TRIP-ID > ZERO                              03630004
036400         PERFORM 3200-GET-DEST-TRAILER-NBR                        03640004
036500     ELSE                                                         03650004
036600         CONTINUE                                                 03660004
036700     END-IF.                                                      03670004
036800                                                                  03680004
036900*    PERFORM 2300-GET-AUDIT-INFO.                                 03690004
037000*                                                                 03700004
037100*                                                                 03710004
037200*GET OUTBOUND TRIP ID BASED ON AUDIT CONTROL NUMBER               03720004
037300 2100-GET-OTBND-TRIP.                                             03730004
037500         EXEC SQL                                                 03750004
037600             SELECT B.ORIG_OTBND_TRIP_ID                          03760004
037700                 ,  B.DEST_OTBND_TRIP_ID                          03770004
037800             INTO  :SUT00004-ORIG-OTBND-TRIP-ID :DN-ORIG-TRIP-ID  03780004
037900                 , :SUT00004-DEST-OTBND-TRIP-ID :DN-DEST-TRIP-ID  03790004
038000             FROM   TSUNAUD A                                     03800004
038100                  , SUT_AUD_TRLR_TRIP B                           03810004
038200             WHERE  A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR             03820004
038300               AND  B.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR           03830004
038310             WITH UR                                              03831008
038400         END-EXEC                                                 03840004
038500                                                                  03850004
038600         EVALUATE TRUE                                            03860004
038700             WHEN SQLCODE = 0                                     03870004
038800             WHEN SQLCODE = +100                                  03880004
038900             WHEN SQLCODE = -904                                  03890004
039000             WHEN SQLCODE = -911                                  03900004
039100                 IF DN-ORIG-TRIP-ID = -1                          03910004
039200                    MOVE ZEROS   TO SUT00004-ORIG-OTBND-TRIP-ID   03920004
039300                 END-IF                                           03930004
039400                 IF DN-DEST-TRIP-ID = -1                          03940004
039500                    MOVE ZEROS   TO SUT00004-DEST-OTBND-TRIP-ID   03950004
039600                 END-IF                                           03960004
039700                                                                  03970004
039800                 MOVE SUT00004-ORIG-OTBND-TRIP-ID TO              03980004
039900                                        DK-ORIG-OTBND-TRIP-ID     03990004
040000                 MOVE SUT00004-DEST-OTBND-TRIP-ID TO              04000004
040100                                        DK-DEST-OTBND-TRIP-ID     04010004
040200             WHEN OTHER                                           04020004
040300                 MOVE '2100-GET-OTBND-TRIP'                       04030004
040400                                        TO PV-PARAGRAPH-NAME      04040004
040500                 MOVE 'SELECT FROM SUT_AUD_TRLR_TRIP'             04050004
040600                                  TO PV-DB2-OPERATION-ATTEMPTED   04060004
040700                 PERFORM 9100-SQL-ABEND                           04070004
040800         END-EVALUATE.                                            04080004
040900*                                                                 04090004
041000*                                                                 04100004
041100*GET TRAILER SERIAL NUMBER BASED ON OUTBND TRIP ID                04110004
041200 2200-GET-ORIG-TRAILER-NBR.                                       04120004
041400         EXEC SQL                                                 04140004
041500             SELECT TRLR_SRL_NBR                                  04150004
041600                  , DOOR_TYP_CDE                                  04160004
041700                  , ORGN_OPER_UNT_ID                              04170004
041800                  , DEST_OPER_UNT_ID                              04180004
041900             INTO  :SUOBTR-TRLR-SRL-NBR                           04190004
042000                  ,:SUOBTR-DOOR-TYP-CDE                           04200004
042100                  ,:SUOBTR-ORGN-OPER-UNT-ID                       04210004
042200                  ,:SUOBTR-DEST-OPER-UNT-ID                       04220004
042300             FROM   TSUOBTR                                       04230004
042400             WHERE  OTBND_TRIP_ID    = :DK-ORIG-OTBND-TRIP-ID     04240004
042410             WITH UR                                              04241008
042500         END-EXEC                                                 04250004
042600                                                                  04260004
042700         EVALUATE TRUE                                            04270004
042800             WHEN SQLCODE = 0                                     04280004
042900             WHEN SQLCODE = +100                                  04290004
043000             WHEN SQLCODE = -904                                  04300004
043100             WHEN SQLCODE = -911                                  04310004
043200                 MOVE SUOBTR-TRLR-SRL-NBR     TO DK-TRLR-SRL-NBR  04320004
043300                 MOVE SUOBTR-DOOR-TYP-CDE     TO DK-DOOR-TYP-CDE  04330004
043400                 MOVE SUOBTR-ORGN-OPER-UNT-ID                     04340004
043500                                          TO DK-ORIG-OPER-UNT-ID  04350004
043600                                             PC049-DK-OPER-UNT-ID 04360004
043700                                             DK-OPER-UNT-ID       04370004
043800                 PERFORM 2310-GET-FCLTY-DESC                      04380004
043900                 MOVE SUOBTR-DEST-OPER-UNT-ID                     04390004
044000                                          TO DK-DEST-OPER-UNT-ID  04400004
044100                                             PC049-DK-TRLR-DEST   04410004
044200                                             PC049-PV-STORE-01    04420004
044300             WHEN OTHER                                           04430004
044400                 MOVE '2200-GET-ORIG-TRAILER-NBR'                 04440004
044500                                        TO PV-PARAGRAPH-NAME      04450004
044600                 MOVE 'SELECT FROM TSUOBTR'                       04460004
044700                                  TO PV-DB2-OPERATION-ATTEMPTED   04470004
044800                 PERFORM 9100-SQL-ABEND                           04480004
044900         END-EVALUATE.                                            04490004
045000*                                                                 04500004
045100*                                                                 04510004
045200                                                                  04520004
045300 2300-GET-AUDIT-INFO.                                             04530004
045500         EXEC SQL                                                 04550004
045600             SELECT AUD_TYP_CDE                                   04560004
045700                 ,  AUD_STAT_CDE                                  04570004
045800                 ,  DEST_TYP_CDE                                  04580004
045900                 ,  AUD_USR_ID                                    04590004
046000                 ,  AUD_STRT_TMST                                 04600004
046100                 ,  AUD_STP_TMST                                  04610004
046200                 ,  OPER_UNT_ID                                   04620004
046300                 ,  FCLTY_ID                                      04630004
046400             INTO  :SUNAUD-AUD-TYP-CDE                            04640004
046500                 , :SUNAUD-AUD-STAT-CDE                           04650004
046600                 , :SUNAUD-DEST-TYP-CDE                           04660004
046700                 , :SUNAUD-AUD-USR-ID                             04670004
046800                 , :SUNAUD-AUD-STRT-TMST                          04680004
046900                 , :SUNAUD-AUD-STP-TMST                           04690004
047000                 , :SUNAUD-OPER-UNT-ID                            04700004
047100                 , :SUNAUD-FCLTY-ID                               04710004
047200             FROM   TSUNAUD                                       04720004
047300             WHERE  AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR           04730004
047310             WITH UR                                              04731008
047400         END-EXEC                                                 04740004
047500                                                                  04750004
047600         EVALUATE TRUE                                            04760004
047700             WHEN SQLCODE = 0                                     04770004
047800             WHEN SQLCODE = +100                                  04780004
047900             WHEN SQLCODE = -904                                  04790004
048000             WHEN SQLCODE = -911                                  04800004
048100               EVALUATE TRUE                                      04810004
048200*DEST-TYP-CDE 'S' = AUDITED TO SAME TRAILER                       04820004
048300*DEST-TYP-CDE 'D' = AUDITED TO DIFFERENT TRAILER                  04830004
048400*DEST-TYP-CDE 'C' = AUDITED TO CONVEYOR                           04840004
048500*DEST-TYP-CDE 'N' = DEFAULT - AUD NOT STARTED, NO CARTONS SCANNED 04850004
048600*GET CARTONS CURRENTLY ATTACHED TO TRAILER (DIVERTED & SCANNED ON)04860004
048700*LMM                                                              04870004
048800                 WHEN SUNAUD-DEST-TYP-CDE = 'S'                   04880004
048900                    PERFORM 2700-SELECT-TSUNAUD                   04890004
049000                    MOVE SUT00004-ORIG-OTBND-TRIP-ID              04900004
049100                      TO DK-ORIG-OTBND-TRIP-ID                    04910004
049200                    PERFORM 2200-GET-ORIG-TRAILER-NBR             04920004
049300                    PERFORM 3000-GET-ATTACHED-CARTONS             04930004
049400                                                                  04940004
049500                 WHEN SUNAUD-DEST-TYP-CDE = 'D' OR 'C'            04950004
049600                    PERFORM 2700-SELECT-TSUNAUD                   04960004
049700                    MOVE SUT00004-ORIG-OTBND-TRIP-ID              04970004
049800                      TO DK-ORIG-OTBND-TRIP-ID                    04980004
049900                    PERFORM 2200-GET-ORIG-TRAILER-NBR             04990004
049910                    IF  SUNAUD-DEST-TYP-CDE = 'D'                 04991008
049920                        PERFORM 3200-GET-DEST-TRAILER-NBR         04992008
049930                    END-IF                                        04993008
050000                    PERFORM 3000-GET-ATTACHED-CARTONS             05000004
050100*PCPD049 MODULE                                                   05010004
050200                    PERFORM P7250-OPEN-SCAN-OFF-CSR               05020004
050300                    SET PS-SCAN-OFF-CSR  TO TRUE                  05030004
050400                    EVALUATE TRUE                                 05040004
050500                        WHEN SQLCODE = 0                          05050004
050600                        WHEN SQLCODE = -904                       05060004
050700                        WHEN SQLCODE = -911                       05070004
050800                            CONTINUE                              05080004
050900                        WHEN SQLCODE = +100                       05090004
051000                            CONTINUE                              05100004
051100                        WHEN OTHER                                05110004
051200                            MOVE 'P7250-OPEN-SCAN-OFF-CSR'        05120004
051300                                          TO PV-PARAGRAPH-NAME    05130004
051400                            MOVE PC049-DK-AUD-STRT-TMST           05140004
051500                                          TO PV-AUD-START-TMST    05150004
051600                            MOVE PC049-DK-AUD-STP-TMST            05160004
051700                                          TO PV-AUD-END-TMST      05170004
051800                            MOVE PC049-DK-OTBND-TRIP-ID           05180004
051900                                          TO PV-OTBND-TRIP-ID     05190004
052000                            MOVE 'OPEN SCAN OFF CURSOR'           05200004
052100                                    TO PV-DB2-OPERATION-ATTEMPTED 05210004
052200                            PERFORM 9100-SQL-ABEND                05220004
052300                    END-EVALUATE                                  05230004
052400                                                                  05240004
052500*THIS CURSOR WILL BRING BACK ALL OF THE CARTONS THAT WERE         05250004
052600*SCANNED OFF OF A TRAILER BECAUSE AN AUDIT HAS OCCURRED.          05260004
052700*PCPD049 MODULE                                                   05270004
052800                    PERFORM P7255-FETCH-SCAN-OFF-CSR              05280004
052900                    EVALUATE TRUE                                 05290004
053000                        WHEN SQLCODE = 0                          05300004
053100                        WHEN SQLCODE = -904                       05310004
053200                        WHEN SQLCODE = -911                       05320004
053300                            CONTINUE                              05330004
053400                        WHEN SQLCODE = +100                       05340004
053500                            CONTINUE                              05350004
053600                        WHEN OTHER                                05360004
053700                            MOVE 'P7255-FETCH-SCAN-OFF-CSR'       05370004
053800                                          TO PV-PARAGRAPH-NAME    05380004
053900                            MOVE PC049-DK-AUD-STRT-TMST           05390004
054000                                          TO PV-AUD-START-TMST    05400004
054100                            MOVE PC049-DK-AUD-STP-TMST            05410004
054200                                          TO PV-AUD-END-TMST      05420004
054300                            MOVE PC049-DK-OTBND-TRIP-ID           05430004
054400                                          TO PV-OTBND-TRIP-ID     05440004
054500                            MOVE 'FETCH SCAN OFF CURSOR'          05450004
054600                                    TO PV-DB2-OPERATION-ATTEMPTED 05460004
054700                            PERFORM 9100-SQL-ABEND                05470004
054800                    END-EVALUATE                                  05480004
054900                                                                  05490004
055000                    IF PC049-EOF-SCAN-OFF                         05500004
055100                        CONTINUE                                  05510004
055200                    ELSE                                          05520004
055300                       PERFORM 2400-GET-SCAC-TRLR-ID              05530004
055400                       PERFORM 2500-GET-TRAILER-INFO              05540004
055500                       PERFORM 4150-WRITE-SCANNED-OFF-CARTONS     05550004
055600                         UNTIL PC049-EOF-SCAN-OFF                 05560004
055700                    END-IF                                        05570004
055800*PCPD049 MODULE                                                   05580004
055900                    PERFORM P7260-CLOSE-SCAN-OFF-CSR              05590004
056000                    EVALUATE TRUE                                 05600004
056100                        WHEN SQLCODE = 0                          05610004
056200                        WHEN SQLCODE = -904                       05620004
056300                        WHEN SQLCODE = -911                       05630004
056400                            CONTINUE                              05640004
056500                        WHEN SQLCODE = +100                       05650004
056600                            CONTINUE                              05660004
056700                        WHEN OTHER                                05670004
056800                            MOVE 'P7260-CLOSE-SCAN-OFF-CSR'       05680004
056900                                          TO PV-PARAGRAPH-NAME    05690004
057000                            MOVE PC049-DK-AUD-STRT-TMST           05700004
057100                                          TO PV-AUD-START-TMST    05710004
057200                            MOVE PC049-DK-AUD-STP-TMST            05720004
057300                                          TO PV-AUD-END-TMST      05730004
057400                            MOVE PC049-DK-OTBND-TRIP-ID           05740004
057500                                          TO PV-OTBND-TRIP-ID     05750004
057600                            MOVE 'CLOSE SCAN OFF CURSOR'          05760004
057700                                    TO PV-DB2-OPERATION-ATTEMPTED 05770004
057800                            PERFORM 9100-SQL-ABEND                05780004
057900                    END-EVALUATE                                  05790004
058000                                                                  05800004
058100                 WHEN SUNAUD-DEST-TYP-CDE = 'N'                   05810004
058200                    CONTINUE                                      05820004
058300               END-EVALUATE                                       05830004
058400                                                                  05840004
058500             WHEN OTHER                                           05850004
058600                 MOVE '2300-GET-AUDIT-INFO'                       05860004
058700                                        TO PV-PARAGRAPH-NAME      05870004
058800                 MOVE 'SELECT FROM TSUNAUD'                       05880004
058900                                  TO PV-DB2-OPERATION-ATTEMPTED   05890004
059000                 PERFORM 9100-SQL-ABEND                           05900004
059100         END-EVALUATE.                                            05910004
059200*                                                                 05920004
059300*                                                                 05930004
059400*THIS PARAGRAPH WILL SELECT THE FACLITY DESC                      05940004
059500 2310-GET-FCLTY-DESC.                                             05950004
059502     INITIALIZE XL071-COMMAREA-REC.                               05950201
059503     MOVE SUNAUD-OPER-UNT-ID    TO XL071-LOCATION-NUMBER          05950301
059504                                                                  05950401
059505     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05950501
059506                                                                  05950601
059507     EVALUATE TRUE                                                05950701
059508     WHEN XL071-NO-ERRORS                                         05950801
059509         CONTINUE                                                 05950904
059510     WHEN XL071-LOC-NOT-FOUND                                     05951001
059511     WHEN XL071-DC-ASGMT-NOT-FND                                  05951101
059512         MOVE 'UNKNOWN'             TO XL071-LOC-NM               05951203
059513     WHEN XL071-BAD-DB2-RETURN                                    05951301
059514         DISPLAY 'CALL LOCATION MOD '                             05951401
059515         DISPLAY 'XLT00010'                                       05951501
059516         MOVE '2310-GET-FCLTY-DESC' TO PV-PARAGRAPH-NAME          05951604
059517         MOVE 'CALL XLKUT071'       TO PV-DB2-OPERATION-ATTEMPTED 05951704
059518         MOVE XL071-SQLCA             TO SQLCA                    05951801
059519         PERFORM 9100-SQL-ABEND                                   05951904
059520     END-EVALUATE.                                                05952001
059530/                                                                 05953004
059540*                                                                 05954004
059550*GET SCAC AND TRAILER BASED ON TRAILER SERIAL NBR                 05955004
059560 2400-GET-SCAC-TRLR-ID.                                           05956004
059570         EXEC SQL                                                 05957004
059580             SELECT SCAC_CDE                                      05958004
059590                  , TRLR_ID                                       05959004
059600             INTO  :CNTRID-SCAC-CDE                               05960004
059700                  ,:CNTRID-TRLR-ID                                05970004
059800             FROM   TCNTRID                                       05980004
059900             WHERE  TRLR_SRL_NBR     = :DK-TRLR-SRL-NBR           05990004
059910             WITH UR                                              05991008
060000         END-EXEC                                                 06000004
060100                                                                  06010004
060200         EVALUATE TRUE                                            06020004
060300             WHEN SQLCODE = 0                                     06030004
060400             WHEN SQLCODE = +100                                  06040004
060500             WHEN SQLCODE = -904                                  06050004
060600             WHEN SQLCODE = -911                                  06060004
060700                 CONTINUE                                         06070004
060800             WHEN OTHER                                           06080004
060900                 MOVE '2400-GET-SCAC-TRLR-ID'                     06090004
061000                                        TO PV-PARAGRAPH-NAME      06100004
061100                 MOVE 'SELECT FROM TCNTRID'                       06110004
061200                                  TO PV-DB2-OPERATION-ATTEMPTED   06120004
061300                 PERFORM 9100-SQL-ABEND                           06130004
061400         END-EVALUATE.                                            06140004
061500*                                                                 06150004
061600*                                                                 06160004
061700 2500-GET-TRAILER-INFO.                                           06170004
061800     EXEC SQL                                                     06180004
061900       SELECT  A.TRIP_STAT_CDE                                    06190004
062000              ,A.DOOR_ID                                          06200004
062100         INTO  :SUOBTS-TRIP-STAT-CDE                              06210004
062200              ,:SUOBTS-DOOR-ID                                    06220004
062300         FROM  TSUOBTS A                                          06230004
062400              ,TSUOBTR B                                          06240004
062500        WHERE A.OTBND_TRIP_ID  =  B.OTBND_TRIP_ID                 06250004
062600          AND A.OTBND_STAT_TMST  IN                               06260004
062700              (SELECT  MAX(F.OTBND_STAT_TMST)                     06270004
062800                 FROM  TSUOBTS F                                  06280004
062900                      ,TSUOBTR G                                  06290004
063000                WHERE  F.OTBND_TRIP_ID  = G.OTBND_TRIP_ID         06300004
063100                  AND  G.TRLR_SRL_NBR   = :DK-TRLR-SRL-NBR)       06310004
063110        WITH UR                                                   06311008
063200     END-EXEC                                                     06320004
063300                                                                  06330004
063400     EVALUATE TRUE                                                06340004
063500         WHEN SQLCODE = 0                                         06350004
063600         WHEN SQLCODE = +100                                      06360004
063700         WHEN SQLCODE = -904                                      06370004
063800         WHEN SQLCODE = -911                                      06380004
063900             MOVE SUOBTS-DOOR-ID          TO DK-DOOR-ID           06390004
064000                                             PC049-DK-DOOR-ID     06400004
064100         WHEN OTHER                                               06410004
064200             MOVE '2500-GET-TRAILER-INFO'                         06420004
064300                                    TO PV-PARAGRAPH-NAME          06430004
064400             MOVE 'SELECT FROM TSUOBTS'                           06440004
064500                                TO PV-DB2-OPERATION-ATTEMPTED     06450004
064600             PERFORM 9100-SQL-ABEND                               06460004
064700     END-EVALUATE.                                                06470004
064800*                                                                 06480004
064900*                                                                 06490004
065000*GET DIVERT INFO                                                  06500004
065100 2600-GET-DIVERT-INFO.                                            06510004
065200     EXEC SQL                                                     06520004
065300       SELECT  A.DIVERT_NBR                                       06530004
065400              ,A.DIVERT_LOC_ID                                    06540004
065500              ,A.BRCDE_NBR                                        06550004
065600         INTO  :SUCRDV-DIVERT-NBR                                 06560004
065700              ,:SUCRDV-DIVERT-LOC-ID                              06570004
065800              ,:SUCRDV-BRCDE-NBR                                  06580004
065900         FROM  TSUCRDV A                                          06590004
066000        WHERE  A.SHIPT_UNT_ID        =  :DK-SHIPT-UNT-ID          06600004
066100          AND  A.DIVERT_TMST IN                                   06610004
066200             (SELECT MAX(B.DIVERT_TMST)                           06620004
066300                FROM TSUCRDV B                                    06630004
066400               WHERE B.SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID)         06640004
066410        WITH UR                                                   06641008
066500     END-EXEC                                                     06650004
066600                                                                  06660004
066700     EVALUATE TRUE                                                06670004
066800         WHEN SQLCODE = 0                                         06680004
066900         WHEN SQLCODE = -904                                      06690004
067000         WHEN SQLCODE = -911                                      06700004
067100             CONTINUE                                             06710004
067200         WHEN SQLCODE = +100                                      06720004
067300             MOVE SPACES TO SUCRDV-BRCDE-NBR                      06730004
067400         WHEN OTHER                                               06740004
067500             MOVE '2600-GET-DIVERT-INFO'                          06750004
067600                                    TO PV-PARAGRAPH-NAME          06760004
067700             MOVE DK-SHIPT-UNT-ID                                 06770004
067800                                    TO PV-CARTON-ID-DISPLAY       06780004
067900             MOVE 'SELECT FROM TSUCRDV'                           06790004
068000                                TO PV-DB2-OPERATION-ATTEMPTED     06800004
068100             PERFORM 9100-SQL-ABEND                               06810004
068200     END-EVALUATE.                                                06820004
068300*                                                                 06830004
068400*                                                                 06840004
068500*GET AUDIT START AND STOP TIMESTAMP                               06850004
068600 2700-SELECT-TSUNAUD.                                             06860004
068700     EXEC SQL                                                     06870004
068800       SELECT A.AUD_STRT_TMST                                     06880004
068900            , A.AUD_STP_TMST                                      06890004
069000            , B.ORIG_OTBND_TRIP_ID                                06900004
069010            , B.DEST_OTBND_TRIP_ID                                06901008
069100         INTO  :SUNAUD-AUD-STRT-TMST                              06910004
069200              ,:SUNAUD-AUD-STP-TMST                               06920004
069300              ,:SUT00004-ORIG-OTBND-TRIP-ID                       06930004
069310              ,:SUT00004-DEST-OTBND-TRIP-ID :DN-DEST-TRIP-ID      06931008
069400         FROM TSUNAUD A                                           06940004
069500             ,SUT_AUD_TRLR_TRIP B                                 06950004
069600        WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                   06960004
069700          AND A.AUD_CNTL_NBR =  B.AUD_CNTL_NBR                    06970004
069710        WITH UR                                                   06971008
069800     END-EXEC                                                     06980004
070000                                                                  07000004
070100     EVALUATE TRUE                                                07010004
070200         WHEN SQLCODE = 0                                         07020004
070300         WHEN SQLCODE = -904                                      07030004
070400         WHEN SQLCODE = -911                                      07040004
070500             MOVE SUNAUD-AUD-STRT-TMST TO PC049-DK-AUD-STRT-TMST  07050004
070600             MOVE SUNAUD-AUD-STP-TMST  TO PC049-DK-AUD-STP-TMST   07060004
070610             IF DN-DEST-TRIP-ID = -1                              07061008
070620                MOVE ZEROS   TO SUT00004-DEST-OTBND-TRIP-ID       07062008
070630             END-IF                                               07063008
070640                                                                  07064008
070670             MOVE SUT00004-DEST-OTBND-TRIP-ID TO                  07067008
070680                  DK-DEST-OTBND-TRIP-ID                           07068008
070700         WHEN SQLCODE = +100                                      07070004
070800             CONTINUE                                             07080004
070900         WHEN OTHER                                               07090004
071000             MOVE '2700-SELECT-TSUNAUD'                           07100004
071100                                    TO PV-PARAGRAPH-NAME          07110004
071200             MOVE 'SELECT FROM TSUNAUD'                           07120004
071300                                TO PV-DB2-OPERATION-ATTEMPTED     07130004
071400             PERFORM 9100-SQL-ABEND                               07140004
071500     END-EVALUATE.                                                07150004
071600*                                                                 07160004
071700*                                                                 07170004
071800*GET CARTONS CURRENTLY ATTACHED TO TRAILER (DIVERTED & SCANNED ON)07180004
071900 3000-GET-ATTACHED-CARTONS.                                       07190004
072000     PERFORM 2400-GET-SCAC-TRLR-ID.                               07200004
072100     PERFORM 2500-GET-TRAILER-INFO.                               07210004
072200                                                                  07220004
072300*GET THE START AND END DIVERT CARTONS FOR A GIVEN TRIP ID         07230004
072400     MOVE DK-ORIG-OTBND-TRIP-ID TO PC049-DK-OTBND-TRIP-ID.        07240004
072500*PCPD049 MODULE                                                   07250004
072600     PERFORM P4000-AUD-STRT-END-DVRT.                             07260004
072700     EVALUATE TRUE                                                07270004
072800         WHEN SQLCODE = 0                                         07280004
072900         WHEN SQLCODE = -904                                      07290004
073000         WHEN SQLCODE = -911                                      07300004
073100             CONTINUE                                             07310004
073200         WHEN SQLCODE = +100                                      07320004
073300         WHEN SQLCODE = -305                                      07330004
073400             MOVE PC-DEFAULT-TMST TO                              07340004
073500                      PC049-DK-START-TMST                         07350004
073600                      PC049-DK-END-TMST                           07360004
073700         WHEN OTHER                                               07370004
073800             MOVE 'P4000-AUD-STRT-END-DVRT'                       07380004
073900                                    TO PV-PARAGRAPH-NAME          07390004
074000             MOVE PC049-DK-START-TMST                             07400004
074100                                    TO PV-START-TMST              07410004
074200             MOVE PC049-DK-END-TMST                               07420004
074300                                    TO PV-END-TMST                07430004
074400             MOVE PC049-DK-OPER-UNT-ID                            07440004
074500                                    TO PV-OPER-UNT-ID             07450004
074600             MOVE 'A'               TO PV-ACTIVE                  07460004
074700             MOVE PC049-DK-OTBND-TRIP-ID                          07470004
074800                                    TO PV-OTBND-TRIP-ID           07480004
074900             MOVE 'SHON'            TO PV-SCANNED-ON              07490004
075000             MOVE 'SHOF'            TO PV-SCANNED-OFF             07500004
075100             MOVE 'I'               TO PV-INACTIVE                07510004
075200             MOVE 'SELECT STRT END DVRT'                          07520004
075300                              TO PV-DB2-OPERATION-ATTEMPTED       07530004
075400             PERFORM 9100-SQL-ABEND                               07540004
075500     END-EVALUATE                                                 07550004
075600     MOVE PC049-DK-END-TMST  TO PC049-PC-DEFAULT-TMST.            07560004
075700                                                                  07570004
075800*PCPD049 MODULE                                                   07580004
075900                                                                  07590004
076000                                                                  07600004
076100     PERFORM P3000-DOOR-STR-CSR.                                  07610004
076200     EVALUATE TRUE                                                07620004
076300         WHEN SQLCODE = 0                                         07630004
076400         WHEN SQLCODE = -904                                      07640004
076500         WHEN SQLCODE = -911                                      07650004
076600             CONTINUE                                             07660004
076700         WHEN SQLCODE = +100                                      07670004
076800             CONTINUE                                             07680004
076900         WHEN OTHER                                               07690004
077000             MOVE 'P3000-DOOR-STR-CSR'                            07700004
077100                                    TO PV-PARAGRAPH-NAME          07710004
077200             MOVE PC049-DK-OPER-UNT-ID                            07720004
077300                                    TO PV-OPER-UNT-ID             07730004
077400             MOVE PC049-DK-DOOR-ID                                07740004
077500                                    TO PV-DOOR-ID                 07750004
077600             MOVE PC049-DK-TRLR-DEST                              07760004
077700                                    TO PV-TRLR-DEST               07770004
077800             MOVE PC049-PC-DEFAULT-TMST                           07780004
077900                                    TO PV-DEFAULT-TMST            07790004
078000             MOVE 'SELECT DOOR-STR CSR'                           07800004
078100                              TO PV-DB2-OPERATION-ATTEMPTED       07810004
078200             PERFORM 9100-SQL-ABEND                               07820004
078300     END-EVALUATE                                                 07830004
078400                                                                  07840004
078500     EVALUATE TRUE                                                07850004
078600        WHEN SUOBTR-DOOR-TYP-CDE = 'SH'                           07860004
078700           SET PS-AUD-SHP-ACTV-CSR TO TRUE                        07870004
078800*PCPD049 MODULE                                                   07880004
078900           PERFORM P7320-OPEN-AUD-SHP-ACTV-CSR                    07890004
079000           EVALUATE TRUE                                          07900004
079100               WHEN SQLCODE = 0                                   07910004
079200               WHEN SQLCODE = -904                                07920004
079300               WHEN SQLCODE = -911                                07930004
079400                   CONTINUE                                       07940004
079500               WHEN SQLCODE = +100                                07950004
079600                   CONTINUE                                       07960004
079700               WHEN OTHER                                         07970004
079800                   MOVE 'P7320-OPEN-AUD-SHP-ACTV-CSR'             07980004
079900                                          TO PV-PARAGRAPH-NAME    07990004
080000                   MOVE PC049-DK-START-TMST                       08000004
080100                                          TO PV-START-TMST        08010004
080200                   MOVE PC049-DK-END-TMST                         08020004
080300                                          TO PV-END-TMST          08030004
080400                   MOVE PC049-DK-OPER-UNT-ID                      08040004
080500                                          TO PV-OPER-UNT-ID       08050004
080600                   MOVE 'A'               TO PV-ACTIVE            08060004
080700                   MOVE PC049-DK-OTBND-TRIP-ID                    08070004
080800                                          TO PV-OTBND-TRIP-ID     08080004
080900                   MOVE 'SHON'            TO PV-SCANNED-ON        08090004
081000                   MOVE 'SHOF'            TO PV-SCANNED-OFF       08100004
081100                   MOVE 'I'               TO PV-INACTIVE          08110004
081200                   MOVE 'OPEN SHP ACTV CURSOR'                    08120004
081300                                    TO PV-DB2-OPERATION-ATTEMPTED 08130004
081400                   PERFORM 9100-SQL-ABEND                         08140004
081500           END-EVALUATE                                           08150004
081600                                                                  08160004
081700*PCPD049 MODULE                                                   08170004
081800           PERFORM P7325-FETCH-AUD-SHP-ACTV-CSR                   08180004
081900           EVALUATE TRUE                                          08190004
082000               WHEN SQLCODE = 0                                   08200004
082100               WHEN SQLCODE = -904                                08210004
082200               WHEN SQLCODE = -911                                08220004
082300                  IF PC049-PV-REC-TYPE = 'A'                      08230004
082400                     MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID  08240004
082500                                                 PV-CTN-X         08250004
082600                     PERFORM 2600-GET-DIVERT-INFO                 08260004
082700                  ELSE                                            08270004
082800                     CONTINUE                                     08280004
082900                  END-IF                                          08290004
083000               WHEN SQLCODE = +100                                08300004
083100                   CONTINUE                                       08310004
083200               WHEN OTHER                                         08320004
083300                   MOVE 'P7325-FETCH-AUD-SHP-ACTV-CSR'            08330004
083400                                          TO PV-PARAGRAPH-NAME    08340004
083500                   MOVE PC049-DK-START-TMST                       08350004
083600                                          TO PV-START-TMST        08360004
083700                   MOVE PC049-DK-END-TMST                         08370004
083800                                          TO PV-END-TMST          08380004
083900                   MOVE PC049-DK-OPER-UNT-ID                      08390004
084000                                          TO PV-OPER-UNT-ID       08400004
084100                   MOVE 'A'               TO PV-ACTIVE            08410004
084200                   MOVE PC049-DK-OTBND-TRIP-ID                    08420004
084300                                          TO PV-OTBND-TRIP-ID     08430004
084400                   MOVE 'SHON'            TO PV-SCANNED-ON        08440004
084500                   MOVE 'SHOF'            TO PV-SCANNED-OFF       08450004
084600                   MOVE 'I'               TO PV-INACTIVE          08460004
084700                   MOVE 'FETCH SHP ACTV CURSOR'                   08470004
084800                                    TO PV-DB2-OPERATION-ATTEMPTED 08480004
084900                   PERFORM 9100-SQL-ABEND                         08490004
085000           END-EVALUATE                                           08500004
085100                                                                  08510004
085200           IF PC049-NOT-EOF-AUD-SHP-ACTV-CSR                      08520004
085300              MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID         08530004
085400              PERFORM 2600-GET-DIVERT-INFO                        08540004
085500           ELSE                                                   08550004
085600              CONTINUE                                            08560004
085700           END-IF                                                 08570004
085800                                                                  08580004
085900           IF PC049-EOF-AUD-SHP-ACTV-CSR                          08590004
086000              CONTINUE                                            08600004
086100           ELSE                                                   08610004
086200              PERFORM 5000-SELECT-AUDITED-CRTNS                   08620004
086300              PERFORM 3100-WRITE-ATTACHED-CARTONS                 08630004
086400                UNTIL PC049-EOF-AUD-SHP-ACTV-CSR                  08640004
086500           END-IF                                                 08650004
086600                                                                  08660004
086700*PCPD049 MODULE                                                   08670004
086800           PERFORM P7330-CLOSE-AUD-SHP-ACTV-CSR                   08680004
086900           EVALUATE TRUE                                          08690004
087000               WHEN SQLCODE = 0                                   08700004
087100               WHEN SQLCODE = -904                                08710004
087200               WHEN SQLCODE = -911                                08720004
087300                   CONTINUE                                       08730004
087400               WHEN SQLCODE = +100                                08740004
087500                   CONTINUE                                       08750004
087600               WHEN OTHER                                         08760004
087700                   MOVE 'P7330-CLOSE-AUD-SHP-ACTV-CSR'            08770004
087800                                          TO PV-PARAGRAPH-NAME    08780004
087900                   MOVE PC049-DK-START-TMST                       08790004
088000                                          TO PV-START-TMST        08800004
088100                   MOVE PC049-DK-END-TMST                         08810004
088200                                          TO PV-END-TMST          08820004
088300                   MOVE PC049-DK-OPER-UNT-ID                      08830004
088400                                          TO PV-OPER-UNT-ID       08840004
088500                   MOVE 'A'               TO PV-ACTIVE            08850004
088600                   MOVE PC049-DK-OTBND-TRIP-ID                    08860004
088700                                          TO PV-OTBND-TRIP-ID     08870004
088800                   MOVE 'SHON'            TO PV-SCANNED-ON        08880004
088900                   MOVE 'SHOF'            TO PV-SCANNED-OFF       08890004
089000                   MOVE 'I'               TO PV-INACTIVE          08900004
089100                   MOVE 'CLOSE SHP ACTV CURSOR'                   08910004
089200                                    TO PV-DB2-OPERATION-ATTEMPTED 08920004
089300                   PERFORM 9100-SQL-ABEND                         08930004
089400           END-EVALUATE                                           08940004
089500                                                                  08950004
089600        WHEN SUOBTR-DOOR-TYP-CDE = 'DS' OR 'ST'                   08960004
089700           SET PS-AUD-SHTL-ACTV-CSR TO TRUE                       08970004
089800*PCPD049 MODULE                                                   08980004
089900           PERFORM P7280-OPEN-AUD-SHTL-ACTV-CSR                   08990004
090000           EVALUATE TRUE                                          09000004
090100               WHEN SQLCODE = 0                                   09010004
090200               WHEN SQLCODE = -904                                09020004
090300               WHEN SQLCODE = -911                                09030004
090400                   CONTINUE                                       09040004
090500               WHEN SQLCODE = +100                                09050004
090600                   CONTINUE                                       09060004
090700               WHEN OTHER                                         09070004
090800                   MOVE 'P7280-OPEN-AUD-SHTL-ACTV-CSR'            09080004
090900                                 TO PV-PARAGRAPH-NAME             09090004
091000                   MOVE PC049-DK-START-TMST                       09100004
091100                                 TO PV-START-TMST                 09110004
091200                   MOVE PC049-DK-END-TMST                         09120004
091300                                 TO PV-END-TMST                   09130004
091400                   MOVE PC049-DK-OPER-UNT-ID                      09140004
091500                                 TO PV-OPER-UNT-ID                09150004
091600                   MOVE 'A'      TO PV-ACTIVE                     09160004
091700                   MOVE PC049-DK-OTBND-TRIP-ID                    09170004
091800                                 TO PV-OTBND-TRIP-ID              09180004
091900                   MOVE 'SHON'   TO PV-SCANNED-ON                 09190004
092000                   MOVE 'OPEN SHTL ACTV CRTN CSR'                 09200004
092100                           TO PV-DB2-OPERATION-ATTEMPTED          09210004
092200                   PERFORM 9100-SQL-ABEND                         09220004
092300           END-EVALUATE                                           09230004
092400                                                                  09240004
092500*PCPD049 MODULE                                                   09250004
092600           PERFORM P7285-FETCH-AUD-SHTL-ACTV-CSR                  09260004
092700           EVALUATE TRUE                                          09270004
092800               WHEN SQLCODE = 0                                   09280004
092900               WHEN SQLCODE = -904                                09290004
093000               WHEN SQLCODE = -911                                09300004
093100                   CONTINUE                                       09310004
093200               WHEN SQLCODE = +100                                09320004
093300                   CONTINUE                                       09330004
093400               WHEN OTHER                                         09340004
093500                   MOVE 'P7285-FETCH-AUD-SHTL-ACTV-CSR'           09350004
093600                                 TO PV-PARAGRAPH-NAME             09360004
093700                   MOVE PC049-DK-START-TMST                       09370004
093800                                 TO PV-START-TMST                 09380004
093900                   MOVE PC049-DK-END-TMST                         09390004
094000                                 TO PV-END-TMST                   09400004
094100                   MOVE PC049-DK-OPER-UNT-ID                      09410004
094200                                 TO PV-OPER-UNT-ID                09420004
094300                   MOVE 'A'      TO PV-ACTIVE                     09430004
094400                   MOVE PC049-DK-OTBND-TRIP-ID                    09440004
094500                                 TO PV-OTBND-TRIP-ID              09450004
094600                   MOVE 'SHON'   TO PV-SCANNED-ON                 09460004
094700                   MOVE 'FETCH SHTL ACTV CRTN CSR'                09470004
094800                           TO PV-DB2-OPERATION-ATTEMPTED          09480004
094900                   PERFORM 9100-SQL-ABEND                         09490004
095000           END-EVALUATE                                           09500004
095100                                                                  09510004
095200           IF PC049-EOF-AUD-STL-ACTV-CSR                          09520004
095300               CONTINUE                                           09530004
095400           ELSE                                                   09540004
095500              MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID         09550004
095600              MOVE DK-SHIPT-UNT-ID TO PV-CTN-N                    09560004
095700              PERFORM 5000-SELECT-AUDITED-CRTNS                   09570004
095800              PERFORM 3100-WRITE-ATTACHED-CARTONS                 09580004
095900                UNTIL PC049-EOF-AUD-STL-ACTV-CSR                  09590004
096000           END-IF                                                 09600004
096100                                                                  09610004
096200*PCPD049 MODULE                                                   09620004
096300           PERFORM P7290-CLOSE-AUD-SHTL-ACTV-CSR                  09630004
096400           EVALUATE TRUE                                          09640004
096500               WHEN SQLCODE = 0                                   09650004
096600               WHEN SQLCODE = -904                                09660004
096700               WHEN SQLCODE = -911                                09670004
096800                   CONTINUE                                       09680004
096900               WHEN SQLCODE = +100                                09690004
097000                   CONTINUE                                       09700004
097100               WHEN OTHER                                         09710004
097200                   MOVE 'P7290-CLOSE-AUD-SHTL-ACTV-CSR'           09720004
097300                                 TO PV-PARAGRAPH-NAME             09730004
097400                   MOVE PC049-DK-START-TMST                       09740004
097500                                 TO PV-START-TMST                 09750004
097600                   MOVE PC049-DK-END-TMST                         09760004
097700                                 TO PV-END-TMST                   09770004
097800                   MOVE PC049-DK-OPER-UNT-ID                      09780004
097900                                 TO PV-OPER-UNT-ID                09790004
098000                   MOVE 'A'      TO PV-ACTIVE                     09800004
098100                   MOVE PC049-DK-OTBND-TRIP-ID                    09810004
098200                                 TO PV-OTBND-TRIP-ID              09820004
098300                   MOVE 'SHON'   TO PV-SCANNED-ON                 09830004
098400                   MOVE 'CLOSE SHTL ACTV CRTN CSR'                09840004
098500                           TO PV-DB2-OPERATION-ATTEMPTED          09850004
098600                   PERFORM 9100-SQL-ABEND                         09860004
098700           END-EVALUATE                                           09870004
098800     END-EVALUATE.                                                09880004
098900*                                                                 09890004
099000*                                                                 09900004
099100*WRITES DIVERTED AND MANUALLY SCANNED ON CARTONS                  09910004
099200 3100-WRITE-ATTACHED-CARTONS.                                     09920004
099300     MOVE PC049-PV-REC-TYPE           TO SU018-RECORD-TYPE        09930004
099400     MOVE CC-AUD-CNTL-NBR             TO SU018-AUD-CNTL-NBR       09940004
099500     MOVE SUNAUD-DEST-TYP-CDE         TO SU018-DEST-TYP-CDE       09950004
099600     MOVE SUOBTR-TRLR-SRL-NBR         TO SU018-TRAILER-SERIAL-NBR 09960004
099700     MOVE CNTRID-SCAC-CDE             TO SU018-SCAC               09970004
099800     MOVE CNTRID-TRLR-ID              TO SU018-TRAILER-ID         09980004
099900     MOVE PV-SPACE                    TO SU018-SCN-LOC-ID         09990004
100000     MOVE SUT00004-ORIG-OTBND-TRIP-ID TO SU018-ORIG-OTBND-TRIP-ID 10000004
100100     MOVE SUT00004-DEST-OTBND-TRIP-ID TO SU018-DEST-OTBND-TRIP-ID 10010004
100200     MOVE SUOBTR-ORGN-OPER-UNT-ID     TO SU018-ORGN-OPER-UNT-ID   10020004
100300     MOVE SUOBTR-DEST-OPER-UNT-ID     TO SU018-DEST-OPER-UNT-ID   10030004
100400     MOVE SUOBTS-TRIP-STAT-CDE        TO SU018-TRIP-STAT-CDE      10040004
100500     MOVE SUOBTS-DOOR-ID              TO SU018-ORIG-DOOR-ID       10050004
100600     MOVE SUOBTS-DOOR-ID              TO SU018-DEST-DOOR-ID       10060004
100700     MOVE SUOBTR-DOOR-TYP-CDE         TO SU018-ORIG-DOOR-TYP-CDE  10070004
100800     MOVE SUOBTR-DOOR-TYP-CDE         TO SU018-DEST-DOOR-TYP-CDE  10080004
100900     MOVE SUCRDV-DIVERT-NBR           TO SU018-ORIG-DIVERT-NBR    10090004
101000     MOVE SUCRDV-DIVERT-NBR           TO SU018-DEST-DIVERT-NBR    10100004
101100     MOVE SUCRDV-DIVERT-LOC-ID        TO SU018-ORIG-DIVERT-LOC-ID 10110004
101200     MOVE SUCRDV-DIVERT-LOC-ID        TO SU018-DEST-DIVERT-LOC-ID 10120004
101300                                                                  10130004
101400     EVALUATE TRUE                                                10140004
101500        WHEN PS-AUD-SHP-ACTV-CSR OR PS-AUD-SHTL-ACTV-CSR          10150004
101600           MOVE SUCRDV-SHIPT-UNT-ID   TO SU018-SHIPT-UNT-ID       10160004
101700        WHEN PS-SCAN-OFF-CSR                                      10170004
101800           MOVE SUT00027-SHIPT-UNT-ID TO SU018-SHIPT-UNT-ID       10180004
101900     END-EVALUATE                                                 10190004
102000                                                                  10200004
102100     MOVE SUCRDV-BRCDE-NBR            TO SU018-BRCDE-NBR          10210004
102200                                                                  10220004
102300     MOVE 1                           TO SU018-MFST-CRTN-CNT      10230004
102400     PERFORM 8000-WRITE-MFST-EXTRACT-RECORD.                      10240004
102500     INITIALIZE SU018-EXTRACT-RECORD.                             10250010
102600                                                                  10260004
102700     EVALUATE TRUE                                                10270004
102800        WHEN SUOBTR-DOOR-TYP-CDE = 'SH'                           10280004
102900*PCPD049 MODULE                                                   10290004
103000           PERFORM P7325-FETCH-AUD-SHP-ACTV-CSR                   10300004
103100           EVALUATE TRUE                                          10310004
103200               WHEN SQLCODE = 0                                   10320004
103300               WHEN SQLCODE = -904                                10330004
103400               WHEN SQLCODE = -911                                10340004
103500                  IF PC049-PV-REC-TYPE = 'A'                      10350004
103600                     MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID  10360004
103700                     PERFORM 2600-GET-DIVERT-INFO                 10370004
103800                  ELSE                                            10380004
103900                     CONTINUE                                     10390004
104000                  END-IF                                          10400004
104100               WHEN SQLCODE = +100                                10410004
104200                   CONTINUE                                       10420004
104300               WHEN OTHER                                         10430004
104400                   MOVE 'P7325-FETCH-AUD-SHP-ACTV-CSR'            10440004
104500                                          TO PV-PARAGRAPH-NAME    10450004
104600                   MOVE PC049-DK-START-TMST                       10460004
104700                                          TO PV-START-TMST        10470004
104800                   MOVE PC049-DK-END-TMST                         10480004
104900                                          TO PV-END-TMST          10490004
105000                   MOVE PC049-DK-OPER-UNT-ID                      10500004
105100                                          TO PV-OPER-UNT-ID       10510004
105200                   MOVE 'A'               TO PV-ACTIVE            10520004
105300                   MOVE PC049-DK-OTBND-TRIP-ID                    10530004
105400                                          TO PV-OTBND-TRIP-ID     10540004
105500                   MOVE 'SHON'            TO PV-SCANNED-ON        10550004
105600                   MOVE 'SHOF'            TO PV-SCANNED-OFF       10560004
105700                   MOVE 'I'               TO PV-INACTIVE          10570004
105800                   MOVE 'FETCH SHP ACTV CURSOR'                   10580004
105900                                    TO PV-DB2-OPERATION-ATTEMPTED 10590004
106000                   PERFORM 9100-SQL-ABEND                         10600004
106100           END-EVALUATE                                           10610004
106200           IF PC049-NOT-EOF-AUD-SHP-ACTV-CSR                      10620004
106300              MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID         10630004
106400              PERFORM 2600-GET-DIVERT-INFO                        10640004
106500              MOVE DK-SHIPT-UNT-ID TO PV-CTN-N                    10650004
106600              PERFORM 5000-SELECT-AUDITED-CRTNS                   10660004
106700           ELSE                                                   10670004
106800              CONTINUE                                            10680004
106900           END-IF                                                 10690004
107000                                                                  10700004
107100        WHEN SUOBTR-DOOR-TYP-CDE = 'DS' OR 'ST'                   10710004
107200*PCPD049 MODULE                                                   10720004
107300           PERFORM P7285-FETCH-AUD-SHTL-ACTV-CSR                  10730004
107400           EVALUATE TRUE                                          10740004
107500               WHEN SQLCODE = 0                                   10750004
107600               WHEN SQLCODE = -904                                10760004
107700               WHEN SQLCODE = -911                                10770004
107800                   CONTINUE                                       10780004
107900               WHEN SQLCODE = +100                                10790004
108000                   CONTINUE                                       10800004
108100               WHEN OTHER                                         10810004
108200                   MOVE 'P7285-FETCH-AUD-SHTL-ACTV-CSR'           10820004
108300                                 TO PV-PARAGRAPH-NAME             10830004
108400                   MOVE PC049-DK-START-TMST                       10840004
108500                                 TO PV-START-TMST                 10850004
108600                   MOVE PC049-DK-END-TMST                         10860004
108700                                 TO PV-END-TMST                   10870004
108800                   MOVE PC049-DK-OPER-UNT-ID                      10880004
108900                                 TO PV-OPER-UNT-ID                10890004
109000                   MOVE 'A'      TO PV-ACTIVE                     10900004
109100                   MOVE PC049-DK-OTBND-TRIP-ID                    10910004
109200                                 TO PV-OTBND-TRIP-ID              10920004
109300                   MOVE 'SHON'   TO PV-SCANNED-ON                 10930004
109400                   MOVE 'FETCH SHTL ACTV CRTN CSR'                10940004
109500                           TO PV-DB2-OPERATION-ATTEMPTED          10950004
109600                   PERFORM 9100-SQL-ABEND                         10960004
109700           END-EVALUATE                                           10970004
109800           IF PC049-NOT-EOF-AUD-STL-ACTV-CSR                      10980004
109900              MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID         10990004
110000              PERFORM 2600-GET-DIVERT-INFO                        11000004
110100              MOVE DK-SHIPT-UNT-ID TO PV-CTN-N                    11010004
110200              PERFORM 5000-SELECT-AUDITED-CRTNS                   11020004
110300           ELSE                                                   11030004
110400              CONTINUE                                            11040004
110500           END-IF                                                 11050004
110600     END-EVALUATE.                                                11060004
110700                                                                  11070004
110800*                                                                 11080004
110900*WRITES ALL CARTONS THAT ARE MANIFESTED BUT NOT AUDITED           11090004
111000 3150-WRITE-NOT-AUD-EXTRACT.                                      11100004
111100     MOVE SUNAUD-OPER-UNT-ID          TO SU019-OPER-UNT-ID        11110004
111200                                         SU019-FCLTY-ID           11120004
111400     MOVE XL071-LOC-NM                TO SU019-FCLTY-NME          11140004
111500     MOVE DK-SHIPT-UNT-ID             TO SU019-SHIPT-UNT-ID       11150004
111600     MOVE CC-AUD-CNTL-NBR             TO SU019-AUD-CNTL-NBR       11160004
111700     MOVE SUNAUD-AUD-STRT-TMST        TO SU019-AUD-STRT-TMST      11170004
111800     MOVE SUNAUD-AUD-STP-TMST         TO SU019-AUD-STP-TMST       11180004
111900     MOVE SUNAUD-AUD-USR-ID           TO SU019-AUD-INITIATED-BY   11190004
112000                                                                  11200004
112100     IF SUNAUD-AUD-TYP-CDE = '01'                                 11210004
112200        MOVE PC-100                   TO SU019-AUD-TYP-CDE        11220004
112300     END-IF                                                       11230004
112400                                                                  11240004
112500     IF SUNAUD-AUD-TYP-CDE = '02'                                 11250004
112600        MOVE PC-SPOT                  TO SU019-AUD-TYP-CDE        11260004
112700     END-IF                                                       11270004
112800                                                                  11280004
112900     IF SUNAUD-AUD-TYP-CDE = '03'                                 11290004
113000        MOVE PC-REWORK                TO SU019-AUD-TYP-CDE        11300004
113100     END-IF                                                       11310004
113200                                                                  11320004
113300     IF SUNAUD-AUD-STAT-CDE = 'CR'                                11330004
113400        MOVE PC-CR                    TO SU019-AUD-STAT-CDE       11340004
113500     END-IF                                                       11350004
113600                                                                  11360004
113700     IF SUNAUD-AUD-STAT-CDE = 'IP'                                11370004
113800        MOVE PC-IP                    TO SU019-AUD-STAT-CDE       11380004
113900     END-IF                                                       11390004
114000                                                                  11400004
114100     IF SUNAUD-AUD-STAT-CDE = 'CM'                                11410004
114200        MOVE PC-CM                    TO SU019-AUD-STAT-CDE       11420004
114300     END-IF                                                       11430004
114400                                                                  11440004
114500     IF SUNAUD-AUD-STAT-CDE = 'PP'                                11450004
114600        MOVE PC-PP                    TO SU019-AUD-STAT-CDE       11460004
114700     END-IF                                                       11470004
114800                                                                  11480004
114900                                                                  11490004
115000     IF SUNAUD-DEST-TYP-CDE = 'S'                                 11500004
115100        MOVE SUOBTR-TRLR-SRL-NBR      TO SU019-ORIG-TRLR-SER-NBR  11510004
115200        MOVE ZEROES                   TO SU019-DEST-TRLR-SER-NBR  11520004
115300        MOVE PC-S                     TO SU019-DEST-TYP-CDE       11530004
115400        MOVE SUT00004-ORIG-OTBND-TRIP-ID                          11540004
115500                                      TO SU019-ORIG-TRIP-ID       11550004
115600        MOVE ZEROES                   TO SU019-DEST-TRIP-ID       11560004
115700     END-IF                                                       11570004
115800                                                                  11580004
115900     IF SUNAUD-DEST-TYP-CDE = 'D'                                 11590004
116000        PERFORM 2200-GET-ORIG-TRAILER-NBR                         11600004
116100        MOVE SUOBTR-TRLR-SRL-NBR      TO SU019-ORIG-TRLR-SER-NBR  11610004
116200        PERFORM 3200-GET-DEST-TRAILER-NBR                         11620004
116300        MOVE PV-DEST-TRLR-SRL-NBR     TO SU019-DEST-TRLR-SER-NBR  11630007
116400        MOVE PC-D                     TO SU019-DEST-TYP-CDE       11640004
116500        MOVE SUT00004-ORIG-OTBND-TRIP-ID                          11650004
116600                                      TO SU019-ORIG-TRIP-ID       11660004
116700        MOVE SUT00004-DEST-OTBND-TRIP-ID                          11670004
116800                                      TO SU019-DEST-TRIP-ID       11680004
116900     END-IF                                                       11690004
117000                                                                  11700004
117100     IF SUNAUD-DEST-TYP-CDE = 'C'                                 11710004
117200        MOVE SUOBTR-TRLR-SRL-NBR      TO SU019-ORIG-TRLR-SER-NBR  11720004
117300        MOVE ZEROES                   TO SU019-DEST-TRLR-SER-NBR  11730004
117400        MOVE PC-C                     TO SU019-DEST-TYP-CDE       11740004
117500        MOVE SUT00004-ORIG-OTBND-TRIP-ID                          11750004
117600                                      TO SU019-ORIG-TRIP-ID       11760004
117700        MOVE ZEROES                   TO SU019-DEST-TRIP-ID       11770004
117800     END-IF                                                       11780004
117900                                                                  11790004
118000     MOVE SUOBTR-DEST-OPER-UNT-ID     TO SU019-DEST-OPER-UNT-ID   11800004
118100     MOVE SUNAUD-AUD-USR-ID           TO SU019-AUD-INITIATED-BY   11810004
118200                                                                  11820004
118300     IF SUT00002-ERR-CDE = 'E'                                    11830004
118400        MOVE PC-Y TO SU019-MISLOADED-CRTN                         11840004
118500     ELSE                                                         11850004
118600        MOVE SPACES TO SU019-MISLOADED-CRTN                       11860004
118700     END-IF                                                       11870004
118800                                                                  11880004
118900     IF SUT00002-ERR-CDE = 'A'                                    11890004
119000        MOVE PC-Y TO SU019-CRTN-NOT-MFST-TO-TRLR                  11900004
119100     ELSE                                                         11910004
119200        MOVE SPACES TO SU019-CRTN-NOT-MFST-TO-TRLR                11920004
119300     END-IF                                                       11930004
119400                                                                  11940004
119500     IF SUT00002-ERR-CDE = 'C'                                    11950004
119600        MOVE PC-Y TO SU019-CRTN-CONTENT-UNKNOWN                   11960004
119700     ELSE                                                         11970004
119800        MOVE SPACES TO SU019-CRTN-CONTENT-UNKNOWN                 11980004
119900     END-IF                                                       11990004
120000                                                                  12000004
120100     IF SUT00002-ERR-CDE = 'F'                                    12010004
120200        MOVE PC-Y TO SU019-DUPLICATE-SCAN                         12020004
120300     ELSE                                                         12030004
120400        MOVE SPACES TO SU019-DUPLICATE-SCAN                       12040004
120500     END-IF                                                       12050004
120600                                                                  12060004
120700     IF SUT00002-ERR-CDE = 'D'                                    12070004
120800        MOVE PC-Y TO SU019-CRTN-INACTIVE                          12080004
120900     ELSE                                                         12090004
121000        MOVE SPACES TO SU019-CRTN-INACTIVE                        12100004
121100     END-IF                                                       12110004
121200                                                                  12120004
121300     IF SUT00002-ERR-CDE = 'B'                                    12130004
121400        MOVE PC-Y TO SU019-CRTN-NOT-FOUND                         12140004
121500     ELSE                                                         12150004
121600        MOVE SPACES TO SU019-CRTN-NOT-FOUND                       12160004
121700     END-IF                                                       12170004
121800                                                                  12180004
121900     IF PV-MFST-NOT-AUDITED = 'Y'                                 12190004
122000        MOVE PC-Y TO SU019-MFST-NOT-AUDITED                       12200004
122100     ELSE                                                         12210004
122200        MOVE SPACES TO SU019-MFST-NOT-AUDITED                     12220004
122300     END-IF                                                       12230004
122400                                                                  12240004
122500     IF SUT00002-ERR-CDE = 'G'                                    12250004
122600        MOVE PC-Y TO SU019-CRE-NON-MFST-DC                        12260004
122700     ELSE                                                         12270004
122800        MOVE SPACES TO SU019-CRE-NON-MFST-DC                      12280004
122900     END-IF                                                       12290004
123000                                                                  12300004
123100     IF PV-MFST-NOT-AUD-MFST-DC = 'Y'                             12310004
123200        MOVE PC-Y TO SU019-MFST-NOT-AUD-NON-MFST-DC               12320004
123300     ELSE                                                         12330004
123400        MOVE SPACES TO SU019-MFST-NOT-AUD-NON-MFST-DC             12340004
123500     END-IF                                                       12350004
123600                                                                  12360004
123700     PERFORM 8500-WRITE-AUD-EXTRACT-RECORD.                       12370004
123800     INITIALIZE SU019-EXTRACT-RECORD.                             12380006
123810                                                                  12381009
123900*                                                                 12390004
124000*                                                                 12400004
124100 3200-GET-DEST-TRAILER-NBR.                                       12410004
124200     EXEC SQL                                                     12420004
124300        SELECT TRLR_SRL_NBR                                       12430004
124400         INTO  :PV-DEST-TRLR-SRL-NBR                              12440007
124500          FROM TSUOBTR                                            12450004
124600         WHERE OTBND_TRIP_ID = :DK-DEST-OTBND-TRIP-ID             12460004
124610        WITH UR                                                   12461008
124700     END-EXEC                                                     12470004
124800                                                                  12480004
124900     EVALUATE TRUE                                                12490004
125000         WHEN SQLCODE = 0                                         12500004
125100         WHEN SQLCODE = -904                                      12510004
125200         WHEN SQLCODE = -911                                      12520004
125300             CONTINUE                                             12530004
125400         WHEN SQLCODE = +100                                      12540004
125500             CONTINUE                                             12550004
125600         WHEN OTHER                                               12560004
125700             MOVE '3200-GET-DEST-TRAILER-NBR'                     12570004
125800                                    TO PV-PARAGRAPH-NAME          12580004
125900             MOVE 'SELECT FROM TSUOBTR'                           12590004
126000                                TO PV-DB2-OPERATION-ATTEMPTED     12600004
126100             PERFORM 9100-SQL-ABEND                               12610004
126200     END-EVALUATE.                                                12620004
126300*                                                                 12630004
126400*                                                                 12640004
126500 4150-WRITE-SCANNED-OFF-CARTONS.                                  12650004
126600     MOVE PV-SPACE                    TO SU018-RECORD-TYPE        12660004
126700     MOVE CC-AUD-CNTL-NBR             TO SU018-AUD-CNTL-NBR       12670004
126800     MOVE SUNAUD-DEST-TYP-CDE         TO SU018-DEST-TYP-CDE       12680004
126900     MOVE SUOBTR-TRLR-SRL-NBR         TO SU018-TRAILER-SERIAL-NBR 12690004
127000     MOVE CNTRID-SCAC-CDE             TO SU018-SCAC               12700004
127100     MOVE CNTRID-TRLR-ID              TO SU018-TRAILER-ID         12710004
127200     MOVE SUT00027-SCN-CDE            TO SU018-SCN-LOC-ID         12720004
127300     MOVE SUT00004-ORIG-OTBND-TRIP-ID TO SU018-ORIG-OTBND-TRIP-ID 12730004
127400     MOVE SUT00004-DEST-OTBND-TRIP-ID TO SU018-DEST-OTBND-TRIP-ID 12740004
127500     MOVE SUOBTR-ORGN-OPER-UNT-ID     TO SU018-ORGN-OPER-UNT-ID   12750004
127600     MOVE SUOBTR-DEST-OPER-UNT-ID     TO SU018-DEST-OPER-UNT-ID   12760004
127700     MOVE SUOBTS-TRIP-STAT-CDE        TO SU018-TRIP-STAT-CDE      12770004
127800     MOVE SUOBTS-DOOR-ID              TO SU018-ORIG-DOOR-ID       12780004
127900     MOVE SUOBTS-DOOR-ID              TO SU018-DEST-DOOR-ID       12790004
128000     MOVE SUOBTR-DOOR-TYP-CDE         TO SU018-ORIG-DOOR-TYP-CDE  12800004
128100     MOVE SUOBTR-DOOR-TYP-CDE         TO SU018-DEST-DOOR-TYP-CDE  12810004
128200     MOVE SUCRDV-DIVERT-NBR           TO SU018-ORIG-DIVERT-NBR    12820004
128300     MOVE SUCRDV-DIVERT-NBR           TO SU018-DEST-DIVERT-NBR    12830004
128400     MOVE SUCRDV-DIVERT-LOC-ID        TO SU018-ORIG-DIVERT-LOC-ID 12840004
128500     MOVE SUCRDV-DIVERT-LOC-ID        TO SU018-DEST-DIVERT-LOC-ID 12850004
128600                                                                  12860004
128700     EVALUATE TRUE                                                12870004
128800        WHEN PS-AUD-SHP-ACTV-CSR OR PS-AUD-SHTL-ACTV-CSR          12880004
128900           MOVE SUCRDV-SHIPT-UNT-ID   TO SU018-SHIPT-UNT-ID       12890004
129000        WHEN PS-SCAN-OFF-CSR                                      12900004
129100           MOVE SUT00027-SHIPT-UNT-ID TO SU018-SHIPT-UNT-ID       12910004
129200     END-EVALUATE                                                 12920004
129300                                                                  12930004
129400     MOVE PV-SPACE                    TO SU018-BRCDE-NBR          12940004
129500                                                                  12950004
129600                                                                  12960004
129700     PERFORM 8000-WRITE-MFST-EXTRACT-RECORD.                      12970004
129800     INITIALIZE SU018-EXTRACT-RECORD.                             12980004
129900                                                                  12990004
130000     SET PS-SCAN-OFF-CSR   TO TRUE                                13000004
130100*PCPD049 MODULE                                                   13010004
130200     PERFORM P7255-FETCH-SCAN-OFF-CSR.                            13020004
130300     EVALUATE TRUE                                                13030004
130400         WHEN SQLCODE = 0                                         13040004
130500         WHEN SQLCODE = -904                                      13050004
130600         WHEN SQLCODE = -911                                      13060004
130700             CONTINUE                                             13070004
130800         WHEN SQLCODE = +100                                      13080004
130900             CONTINUE                                             13090004
131000         WHEN OTHER                                               13100004
131100             MOVE 'P7255-FETCH-SCAN-OFF-CSR'                      13110004
131200                           TO PV-PARAGRAPH-NAME                   13120004
131300             MOVE PC049-DK-AUD-STRT-TMST                          13130004
131400                           TO PV-AUD-START-TMST                   13140004
131500             MOVE PC049-DK-AUD-STP-TMST                           13150004
131600                           TO PV-AUD-END-TMST                     13160004
131700             MOVE PC049-DK-OTBND-TRIP-ID                          13170004
131800                           TO PV-OTBND-TRIP-ID                    13180004
131900             MOVE 'FETCH SCAN OFF CURSOR'                         13190004
132000                     TO PV-DB2-OPERATION-ATTEMPTED                13200004
132100             PERFORM 9100-SQL-ABEND                               13210004
132200     END-EVALUATE.                                                13220004
132300*                                                                 13230004
132400*                                                                 13240004
132500 5000-SELECT-AUDITED-CRTNS.                                       13250004
132600         EXEC SQL                                                 13260004
132700             SELECT A.AUD_CNTL_NBR                                13270004
132800                  , A.SHIPT_UNT_ID                                13280004
132900                  , A.SCN_TMST                                    13290004
133000                  , A.AUD_USR_ID                                  13300004
133100             INTO  :SUT00000-AUD-CNTL-NBR                         13310004
133200                  ,:SUT00000-SHIPT-UNT-ID                         13320004
133300                  ,:SUT00000-SCN-TMST                             13330004
133400                  ,:SUT00000-AUD-USR-ID                           13340004
133500             FROM   SUT_AUD_TRLR_CART A                           13350004
133600             WHERE  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID         13360004
133700               AND  A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR         13370004
133800               AND  A.SCN_TMST IN                                 13380004
133900                    (SELECT MAX(B.SCN_TMST)                       13390004
134000                       FROM SUT_AUD_TRLR_CART B                   13400004
134100                      WHERE B.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID     13410004
134200                        AND B.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR)    13420004
134210             WITH UR                                              13421008
134300         END-EXEC                                                 13430004
134400                                                                  13440004
134500         EVALUATE TRUE                                            13450004
134600*MANIFESTED CARTONS - AUDITED OR NOT AUDITED                      13460004
134700             WHEN SQLCODE = 0                                     13470004
134800             WHEN SQLCODE = -904                                  13480004
134900             WHEN SQLCODE = -911                                  13490004
135000                 CONTINUE                                         13500004
135100             WHEN SQLCODE = +100                                  13510004
135200*IF +100 HERE, ERROR MESSAGE WILL BE 'MANIFESTED - TO TRLR        13520004
135300*BUT NOT AUDITED'.                                                13530004
135400*DO ANOTHER CHECK TO SEE IF CREATED FROM A MANIFESTING DC.        13540004
135500                 PERFORM 5100-CHECK-IF-MFST-DC                    13550004
135600             WHEN OTHER                                           13560004
135700                 MOVE '5000-SELECT-AUDITED-CRTNS'                 13570004
135800                                        TO PV-PARAGRAPH-NAME      13580004
135900                 MOVE DK-SHIPT-UNT-ID                             13590004
136000                                        TO PV-CARTON-ID-DISPLAY   13600004
136100                 MOVE 'SELECT FROM SUT_AUD_TRLR_CART'             13610004
136200                                  TO PV-DB2-OPERATION-ATTEMPTED   13620004
136300                 PERFORM 9100-SQL-ABEND                           13630004
136400         END-EVALUATE.                                            13640004
136500*                                                                 13650004
136600*                                                                 13660004
136700*CHECK TO SEE IF CARTON WAS CREATED AT MANIFESTING DC             13670004
136800 5100-CHECK-IF-MFST-DC.                                           13680004
136900     MOVE PV-CTN-9-8THRU10 TO DK-ORIG-OPER-UNT-ID.                13690004
137000                                                                  13700004
137100     EXEC SQL                                                     13710004
137200          SELECT FUNC_END_TMST                                    13720004
137300               , FUNC_TXT                                         13730004
137400          INTO  :KRPRPM-FUNC-END-TMST                             13740004
137500               ,:KRPRPM-FUNC-TXT                                  13750004
137600          FROM   TKRPRPM                                          13760004
137700          WHERE  SYS_PRC_FUNC_CDE  = 'DCMFST'                     13770004
137800            AND  LOC_ID            = :DK-ORIG-OPER-UNT-ID         13780004
137900            AND  INTFC_SYS_CDE     = 'KHL'                        13790004
138000            AND  FUNC_PRC_STAT_CDE = 'AC'                         13800004
138100            AND  FUNC_TXT          = 'Y'                          13810004
138110          WITH UR                                                 13811008
138200     END-EXEC.                                                    13820004
138300                                                                  13830004
138400     EVALUATE TRUE                                                13840004
138500         WHEN SQLCODE = ZERO                                      13850004
138600             SET PS-MANIFEST-DC-FOUND  TO TRUE                    13860004
138700                IF SUNAUD-AUD-TYP-CDE = '01'                      13870004
138800                   MOVE 1    TO SU018-MFST-CRTN-ERR-CNT           13880004
138900                   MOVE PC-Y TO SU019-MFST-NOT-AUDITED            13890004
139000                   MOVE 1    TO SU018-MFST-NOT-AUD-CNT            13900004
139100                   MOVE PC-N TO PV-MFST-NOT-AUD-MFST-DC           13910004
139200                   MOVE PC-Y TO PV-MFST-NOT-AUDITED               13920004
139300                END-IF                                            13930004
139400             IF PC049-NOT-EOF-AUD-SHP-ACTV-CSR                    13940004
139500* DMH 10/11/02  PC049-PV-REC-TYPE = 'A' OR                        13950004
139600* DMH 10/11/02  PC049-PV-REC-TYPE = 'C'                           13960004
139700                PERFORM 3150-WRITE-NOT-AUD-EXTRACT                13970004
139800             ELSE                                                 13980004
139900                CONTINUE                                          13990004
140000             END-IF                                               14000004
140100                                                                  14010004
140200         WHEN SQLCODE = +100                                      14020004
140300*IF NOT FOUND HERE, DC IS NOT A MANIFESTING DC.  THE ERROR WILL BE14030004
140400*'MANFESTED - NOT AUDITED - CARTON(S) CREATED FROM NON-MFST DC'.  14040004
140500             SET PS-MANIFEST-DC-NOT-FND TO TRUE                   14050004
140600             IF SUNAUD-AUD-TYP-CDE = '01'                         14060004
140700                MOVE 1    TO SU018-MFST-CRTN-ERR-CNT              14070004
140800                MOVE PC-Y TO SU019-MFST-NOT-AUD-NON-MFST-DC       14080004
140900                MOVE 1    TO SU018-MFST-NOT-AUD-CNT               14090004
141000                MOVE PC-N TO PV-MFST-NOT-AUDITED                  14100004
141100                MOVE PC-Y TO PV-MFST-NOT-AUD-MFST-DC              14110004
141200             END-IF                                               14120004
141300             IF PC049-NOT-EOF-AUD-SHP-ACTV-CSR                    14130004
141400* DMH 10/11/02  PC049-PV-REC-TYPE = 'A' OR                        14140004
141500* DMH 10/11/02  PC049-PV-REC-TYPE = 'C'                           14150004
141600                PERFORM 3150-WRITE-NOT-AUD-EXTRACT                14160004
141700             ELSE                                                 14170004
141800                CONTINUE                                          14180004
141900             END-IF                                               14190004
142000                                                                  14200004
142100         WHEN SQLWARN0 NOT = SPACES                               14210004
142200         WHEN SQLCODE < ZERO                                      14220004
142300         WHEN SQLCODE > ZERO                                      14230004
142400             MOVE '5100-CHECK-IF-MFST-DC'                         14240004
142500                 TO PV-PARAGRAPH-NAME                             14250004
142600             MOVE 'SELECT OF TKRPRPM TABLE'                       14260004
142700                 TO PV-DB2-OPERATION-ATTEMPTED                    14270004
142800             PERFORM 9100-SQL-ABEND                               14280004
142900     END-EVALUATE.                                                14290004
143000*                                                                 14300004
143100*                                                                 14310004
143200 7000-READ-CARDIN-FILE.                                           14320004
143300     READ CARDIN-INPUT-FILE INTO CC-CONTROL-CARD                  14330004
143400        AT END                                                    14340004
143500           SET PS-EOF-CARDIN-FILE TO TRUE.                        14350004
143600                                                                  14360004
143700     IF PS-EOF-CARDIN-FILE                                        14370004
143800         CONTINUE                                                 14380004
143900     ELSE                                                         14390004
144000         DISPLAY 'TRLR AUDIT NBR IS : ' CC-AUD-CNTL-NBR           14400004
144100         PERFORM 7100-VALIDATE-CONTROL-CARD                       14410004
144200     END-IF.                                                      14420004
144300*                                                                 14430004
144400*                                                                 14440004
144500*NUMERIC EDIT OF AUDIT CONTROL NUMBER                             14450004
144600 7100-VALIDATE-CONTROL-CARD.                                      14460004
144700                                                                  14470004
144800     MOVE CC-AUD-CNTL-NBR            TO DP010I-UNEDITED-FIELD.    14480004
144900     MOVE +9                         TO DP010I-MAXIMUM-DIGITS.    14490004
145000     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  14500004
145100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     14510004
145200     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14520004
145300         USING DP010I-NUMERIC-EDIT-AREA.                          14530004
145400                                                                  14540004
145500     IF DP010I-NO-ERROR-DETECTED                                  14550004
145600         MOVE DP010I-NUMERIC-FIELD  TO DK-AUD-CNTL-NBR            14560004
145700     ELSE                                                         14570004
145800         DISPLAY '** SUKUT049 ABEND **'                           14580004
145900         DISPLAY '** AUDIT NUMBER IS NOT NUMERIC **'              14590004
146000         MOVE +4019                  TO PV-ABEND-CODE             14600004
146100         CALL 'ILBOABN0' USING PV-ABEND-CODE                      14610004
146200     END-IF.                                                      14620004
146300*                                                                 14630004
146400*                                                                 14640004
146500 8000-WRITE-MFST-EXTRACT-RECORD.                                  14650004
146600     WRITE SU-MFST-EXTRACT-RECORD                                 14660004
146700       FROM SU018-EXTRACT-RECORD.                                 14670004
146710                                                                  14671012
146720     ADD +1 TO PV-WRITE-MANIFEST-COUNT.                           14672012
146800*                                                                 14680004
146900*                                                                 14690004
147000 8500-WRITE-AUD-EXTRACT-RECORD.                                   14700004
147100     WRITE SU-MFST-NOT-AUD-EXTRACT-RECORD                         14710004
147200       FROM SU019-EXTRACT-RECORD.                                 14720004
147210                                                                  14721012
147220     ADD +1 TO PV-WRITE-EXCEPTION-COUNT.                          14722012
147300*                                                                 14730004
147400*                                                                 14740004
147500 9000-EOJ-ROUTINE.                                                14750004
147600     CLOSE CARDIN-INPUT-FILE                                      14760004
147700           MFST-EXTRACT-FILE                                      14770004
147800           MFST-NOT-AUD-EXTRACT-FILE.                             14780004
147900*                                                                 14790004
148000*                                                                 14800004
148100 9100-SQL-ABEND.                                                  14810004
148200******************************************************************14820004
148300*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    14830004
148400*  ERROR OR WARNING CODE OCCURS.                                  14840004
148500******************************************************************14850004
148600     DISPLAY '9100-SQL-ABEND'.                                    14860004
148700     DISPLAY '** ABEND     **'.                                   14870004
148800     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        14880004
148900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              14890004
149000     DISPLAY '** CARTON ID ** = ' PV-CARTON-ID-DISPLAY.           14900004
149100     DISPLAY '** START TMST ** = ' PV-START-TMST.                 14910004
149200     DISPLAY '** END TMST   ** = ' PV-END-TMST.                   14920004
149300     DISPLAY '** OPER ID    ** = ' PV-OPER-UNT-ID.                14930004
149400     DISPLAY '** ACTIVE     ** = ' PV-ACTIVE.                     14940004
149500     DISPLAY '** TRIP ID    ** = ' PV-OTBND-TRIP-ID.              14950004
149600     DISPLAY '** SCANNED ON ** = ' PV-SCANNED-ON.                 14960004
149700     DISPLAY '** SCANNED OFF ** = ' PV-SCANNED-OFF.               14970004
149800     DISPLAY '** INACTIVE    ** = ' PV-INACTIVE.                  14980004
149900     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     14990004
150000                                                                  15000004
150100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    15010004
150200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         15020004
150300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     15030004
150400* FORMAT.                                                         15040004
150500                                                                  15050004
150600     COPY DPPD004.                                                15060004
150700                                                                  15070004
150800     MOVE +4013                  TO ABEND-CODE.                   15080004
150900     CALL 'ILBOABN0' USING ABEND-CODE.                            15090004
151000                                                                  15100004
151100***************************************************************** 15110004
151200* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 15120004
151300     COPY PCPD049.                                                15130004
151400******************************************************************15140004
