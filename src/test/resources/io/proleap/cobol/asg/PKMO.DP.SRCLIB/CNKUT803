000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000600******************************************************************00060004
000700 PROGRAM-ID.    CNKUT803.                                         00070099
000800 AUTHOR.        TKMA497.                                          00080007
000900 INSTALLATION.  KOHLS.                                            00090004
001000 DATE-WRITTEN   AUGUST, 2011.                                     00100099
001100 DATE-COMPILED.                                                   00110004
001200******************************************************************00120004
001300*  NEW DC - PRINTER EXTRACT                                       00130099
001301*           TPRTRCL - PRINTER CLUSTER                             00130199
001302*           TPRTRID - PRINTER ID                                  00130299
001303*           TPRTRTK - PRINTER STOCK                               00130399
001305*  THIS PROGRAM EXTRACTS DATA FROM THE PRINTER CLUSTER, PRINTER,  00130599
001310*  AND PRINTER TRACK NUMBER TABLES.                               00131099
001400*  IF THE NEW OPER_UNT_ID VALUE IN THE CONTROL CARD IS            00140099
001500*  DIFFERENT FROM THE VALUE USED IN THE MAIN CURSOR, REPLACES     00150008
001600*  THE VALUE USED IN THE MAIN CURSORS WITH THE NEW VALUE IN THE   00160099
001700*  CONTROL CARD BEFORE WRITING THE OUTPUT FILES.                  00170099
006600******************************************************************00660004
007000 ENVIRONMENT DIVISION.                                            00700004
007100******************************************************************00710004
007200 CONFIGURATION SECTION.                                           00720004
007300*                                                                 00730004
007400 SOURCE-COMPUTER.        IBM-3090.                                00740004
007500 OBJECT-COMPUTER.        IBM-3090.                                00750004
007600*                                                                 00760004
007700 INPUT-OUTPUT SECTION.                                            00770004
007800*                                                                 00780004
007900 FILE-CONTROL.                                                    00790004
008000*                                                                 00800008
008400     SELECT CLUSTER-FILE-OUT                                      00840099
008500         ASSIGN TO OUT01.                                         00850004
008700*                                                                 00870004
008710     SELECT PRINTER-FILE-OUT                                      00871099
008720         ASSIGN TO OUT02.                                         00872099
008730*                                                                 00873099
008740     SELECT TRACK-NBR-FILE-OUT                                    00874099
008750         ASSIGN TO OUT03.                                         00875099
008800******************************************************************00880004
008900 DATA DIVISION.                                                   00890004
009000******************************************************************00900004
009100 FILE SECTION.                                                    00910004
009200*                                                                 00920004
010000*                                                                 01000004
010100 FD  CLUSTER-FILE-OUT                                             01010099
010200     RECORDING MODE IS F                                          01020004
010300     BLOCK CONTAINS 0 RECORDS                                     01030004
010400     LABEL RECORDS ARE STANDARD.                                  01040004
010500*                                                                 01050004
010600 01 CLUSTER-RECORD-OUT                PIC  X(29).                 01060099
010700*                                                                 01070099
010710 FD  PRINTER-FILE-OUT                                             01071099
010720     RECORDING MODE IS F                                          01072099
010730     BLOCK CONTAINS 0 RECORDS                                     01073099
010740     LABEL RECORDS ARE STANDARD.                                  01074099
010750*                                                                 01075099
010760 01 PRINTER-RECORD-OUT                PIC  X(55).                 01076099
010770*                                                                 01077099
010780 FD  TRACK-NBR-FILE-OUT                                           01078099
010790     RECORDING MODE IS F                                          01079099
010791     BLOCK CONTAINS 0 RECORDS                                     01079199
010792     LABEL RECORDS ARE STANDARD.                                  01079299
010793*                                                                 01079399
010794 01 TRACK-NBR-RECORD-OUT              PIC  X(23).                 01079499
010800*                                                                 01080004
010900 WORKING-STORAGE SECTION.                                         01090004
010901 01  WS-TPRTRID.                                                  01090199
010902     05  WS-PRTRID-DATA.                                          01090299
010903         10  WS-PRTRID-PRTR-ID            PIC   X(8).             01090399
010904         10  WS-PRTRID-PRTR-OPER-UNT-ID   PIC  S9(4) COMP.        01090499
010905         10  WS-PRTRID-PRTR-FCLTY-ID      PIC  S9(4) COMP.        01090599
010906         10  WS-PRTRID-PRTR-CLUSTR-NBR    PIC  S9(4) COMP.        01090699
010907         10  WS-PRTR-CLUSTR-NBR-NULL      PIC  S9(4) COMP.        01090799
010908         10  WS-PRTRID-PRTR-TYP-CDE       PIC   X(8).             01090899
010909         10  WS-PRTRID-PRTR-LOC-DESC      PIC   X(30).            01090999
010910         10  WS-PRTRID-PRTR-PHY-STAT-CDE  PIC   X(1).             01091099
011000*                                                                 01100004
011100 01  PC-PROGRAM-CONSTANTS.                                        01110004
011200     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           01120099
011300         'CNKUT803'.                                              01130099
011400                                                                  01140004
011500 01  DK-DB2-KEYS.                                                 01150019
011600     05  DK-OPER-UNT-ID             PIC S9(04)  VALUE ZERO        01160099
011700                                                   COMP.          01170019
012600*                                                                 01260004
012700 01  CC-CONTROL-CARD.                                             01270004
012800     05  CC-OPER-UNT-ID-CURR1       PIC  9(04).                   01280099
012810     05  CC-OPER-UNT-ID-CURR1-X REDEFINES CC-OPER-UNT-ID-CURR1    01281099
012820                                    PIC  X(04).                   01282088
012900     05  FILLER                     PIC  X.                       01290011
013000     05  CC-OPER-UNT-ID-NEW1        PIC  9(04).                   01300099
013010     05  CC-OPER-UNT-ID-NEW1-X REDEFINES CC-OPER-UNT-ID-NEW1      01301099
013020                                    PIC  X(04).                   01302088
013100     05  FILLER                     PIC  X.                       01310011
013200     05  CC-OPER-UNT-ID-CURR2       PIC  9(04).                   01320099
013210     05  CC-OPER-UNT-ID-CURR2-X REDEFINES CC-OPER-UNT-ID-CURR2    01321099
013220                                    PIC  X(04).                   01322088
013300     05  FILLER                     PIC  X.                       01330011
013400     05  CC-OPER-UNT-ID-NEW2        PIC  9(04).                   01340099
013410     05  CC-OPER-UNT-ID-NEW2-X REDEFINES CC-OPER-UNT-ID-NEW2      01341099
013420                                    PIC  X(04).                   01342088
013500     05  FILLER                     PIC  X.                       01350011
013600     05  CC-OPER-UNT-ID-CURR3       PIC  9(04).                   01360099
013610     05  CC-OPER-UNT-ID-CURR3-X REDEFINES CC-OPER-UNT-ID-CURR3    01361099
013620                                    PIC  X(04).                   01362088
013700     05  FILLER                     PIC  X.                       01370011
013800     05  CC-OPER-UNT-ID-NEW3        PIC  9(04).                   01380099
013810     05  CC-OPER-UNT-ID-NEW3-X REDEFINES CC-OPER-UNT-ID-NEW3      01381099
013820                                    PIC  X(04).                   01382088
013900     05  FILLER                     PIC  X.                       01390011
014000     05  CC-OPER-UNT-ID-CURR4       PIC  9(04).                   01400099
014010     05  CC-OPER-UNT-ID-CURR4-X REDEFINES CC-OPER-UNT-ID-CURR4    01401099
014020                                    PIC  X(04).                   01402088
014100     05  FILLER                     PIC  X.                       01410011
014200     05  CC-OPER-UNT-ID-NEW4        PIC  9(04).                   01420099
014210     05  CC-OPER-UNT-ID-NEW4-X REDEFINES CC-OPER-UNT-ID-NEW4      01421099
014220                                    PIC  X(04).                   01422088
014300     05  FILLER                     PIC  X(41).                   01430011
014500*                                                                 01450004
014600*                                                                 01460004
014700 01  PS-PROGRAM-SWITCHES.                                         01470004
015000     05  PS-CONTROL-CARD-VALID-SW    PIC  X(01)    VALUE SPACE.   01500004
015100         88  PS-CONTROL-CARD-INVALID               VALUE 'N'.     01510004
015200         88  PS-CONTROL-CARD-VALID                 VALUE 'Y'.     01520004
015201     05  PS-END-OF-CLUSTER-CSR-SW    PIC  X(01)    VALUE 'N'.     01520199
015210         88 PS-END-OF-CLUSTER-CSR-NO               VALUE 'N'.     01521099
015220         88 PS-END-OF-CLUSTER-CSR-YES              VALUE 'Y'.     01522099
015230     05  PS-END-OF-PRINTER-CSR-SW    PIC  X(01)    VALUE 'N'.     01523099
015240         88 PS-END-OF-PRINTER-CSR-NO               VALUE 'N'.     01524099
015250         88 PS-END-OF-PRINTER-CSR-YES              VALUE 'Y'.     01525099
015260     05  PS-END-OF-TRACK-NBR-CSR-SW  PIC  X(01)    VALUE 'N'.     01526099
015270         88 PS-END-OF-TRACK-NBR-CSR-NO             VALUE 'N'.     01527099
015280         88 PS-END-OF-TRACK-NBR-CSR-YES            VALUE 'Y'.     01528099
015400*                                                                 01540004
015500 01  PV-PROGRAM-VARIABLES.                                        01550004
015510     05  PV-OPERATING-UNIT           PIC  X.                      01551099
015520         88  PV-OPER-UNT-1           VALUE '1'.                   01552099
015530         88  PV-OPER-UNT-2           VALUE '2'.                   01553099
015540         88  PV-OPER-UNT-3           VALUE '3'.                   01554099
015550         88  PV-OPER-UNT-4           VALUE '4'.                   01555099
015600     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01560004
015700                                                   COMP.          01570004
015800     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01580004
015810     05  PV-OPER-UNT-ID              PIC S9(04)    VALUE ZERO     01581099
015820                                                   COMP.          01582029
015830     05  PV-DISP-OPER-UNT-ID         PIC  9(04)    VALUE ZERO.    01583099
015840     05  PV-DISP-PRTR-CLUSTR-NBR     PIC  9(04)    VALUE ZERO.    01584099
015850     05  PV-DISP-PRTR-TRK-NBR        PIC  9(04)    VALUE ZERO.    01585099
015900     05  PV-TPRTRCL-I-CNT            PIC S9(05)    VALUE ZERO     01590099
016000                                                   COMP-3.        01600004
016100     05  PV-TPRTRCL-O1-CNT           PIC S9(05)    VALUE ZERO     01610099
016200                                                   COMP-3.        01620004
016210     05  PV-TPRTRCL-O2-CNT           PIC S9(05)    VALUE ZERO     01621099
016220                                                   COMP-3.        01622097
016230     05  PV-TPRTRCL-O3-CNT           PIC S9(05)    VALUE ZERO     01623099
016240                                                   COMP-3.        01624097
016250     05  PV-TPRTRCL-O4-CNT           PIC S9(05)    VALUE ZERO     01625099
016260                                                   COMP-3.        01626097
016300     05  PV-TPRTRCL-O-CNT            PIC S9(05)    VALUE ZERO     01630099
016301                                                   COMP-3.        01630199
016310     05  PV-TPRTRID-I-CNT            PIC S9(05)    VALUE ZERO     01631099
016320                                                   COMP-3.        01632099
016330     05  PV-TPRTRID-O1-CNT           PIC S9(05)    VALUE ZERO     01633099
016340                                                   COMP-3.        01634099
016350     05  PV-TPRTRID-O2-CNT           PIC S9(05)    VALUE ZERO     01635099
016360                                                   COMP-3.        01636099
016370     05  PV-TPRTRID-O3-CNT           PIC S9(05)    VALUE ZERO     01637099
016380                                                   COMP-3.        01638099
016390     05  PV-TPRTRID-O4-CNT           PIC S9(05)    VALUE ZERO     01639099
016391                                                   COMP-3.        01639199
016392     05  PV-TPRTRID-O-CNT            PIC S9(05)    VALUE ZERO     01639299
016400                                                   COMP-3.        01640004
016401     05  PV-TPRTRTK-I-CNT            PIC S9(05)    VALUE ZERO     01640199
016402                                                   COMP-3.        01640299
016403     05  PV-TPRTRTK-O1-CNT           PIC S9(05)    VALUE ZERO     01640399
016404                                                   COMP-3.        01640499
016405     05  PV-TPRTRTK-O2-CNT           PIC S9(05)    VALUE ZERO     01640599
016406                                                   COMP-3.        01640699
016407     05  PV-TPRTRTK-O3-CNT           PIC S9(05)    VALUE ZERO     01640799
016408                                                   COMP-3.        01640899
016409     05  PV-TPRTRTK-O4-CNT           PIC S9(05)    VALUE ZERO     01640999
016410                                                   COMP-3.        01641099
016411     05  PV-TPRTRTK-O-CNT            PIC S9(05)    VALUE ZERO     01641199
016412                                                   COMP-3.        01641299
016420     05  PV-DISPLAY-CNT              PIC ZZZZ9.                   01642033
016500     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01650004
017200*                                                                 01720004
017300*                                                                 01730004
017400 01  PE-PROGRAM-ERROR-MESSAGES.                                   01740004
017500     05  PE-MSG-01                   PIC  X(30)    VALUE          01750004
017600         'OPEN OF CLUSTER_CSR           '.                        01760099
017700     05  PE-MSG-02                   PIC  X(30)    VALUE          01770004
017800         'FETCH OF CLUSTER_CSR          '.                        01780099
020100     05  PE-MSG-03                   PIC  X(30)    VALUE          02010022
020200         'CLOSE OF CLUSTER_CSR          '.                        02020099
020210     05  PE-MSG-04                   PIC  X(30)    VALUE          02021099
020220         'OPEN OF PRINTER_CSR           '.                        02022099
020230     05  PE-MSG-05                   PIC  X(30)    VALUE          02023099
020240         'FETCH OF PRINTER_CSR          '.                        02024099
020250     05  PE-MSG-06                   PIC  X(30)    VALUE          02025099
020260         'CLOSE OF PRINTER_CSR          '.                        02026099
020270     05  PE-MSG-07                   PIC  X(30)    VALUE          02027099
020280         'OPEN OF TRACL_CSR             '.                        02028099
020290     05  PE-MSG-08                   PIC  X(30)    VALUE          02029099
020291         'FETCH OF TRACK_NBR_CSR        '.                        02029199
020292     05  PE-MSG-09                   PIC  X(30)    VALUE          02029299
020293         'CLOSE OF TRACK_NBR_CSR        '.                        02029399
020300*                                                                 02030004
021300******************************************************************02130004
021400*  COPY BOOK FOR DB2 FORMATTED MESSAGE AREA                       02140004
021500******************************************************************02150004
021600     COPY DPWS004.                                                02160004
021700*                                                                 02170004
021800*                                                                 02180004
021900******************************************************************02190004
022000*  COMMUNICATIONS AREA FOR DB2                                    02200004
022100******************************************************************02210004
022200     EXEC SQL                                                     02220004
022300          INCLUDE SQLCA                                           02230004
022400     END-EXEC.                                                    02240004
022500*                                                                 02250004
022510*----------------------------------------------------------------*02251035
022520*    DB2 PRINTER CLUSTER TABLE                                    02252099
022530*----------------------------------------------------------------*02253035
022540     EXEC SQL                                                     02254035
022550          INCLUDE TPRTRCL                                         02255099
022560     END-EXEC.                                                    02256035
022570*                                                                 02257099
022580*----------------------------------------------------------------*02258099
022590*    DB2 PRINTER TABLE                                            02259099
022600*----------------------------------------------------------------*02260099
022700     EXEC SQL                                                     02270099
022800          INCLUDE TPRTRID                                         02280099
022900     END-EXEC.                                                    02290099
024900*                                                                 02490099
025000*----------------------------------------------------------------*02500099
025010*    DB2 PRINTER TRACK NUMBER TABLE                               02501099
025020*----------------------------------------------------------------*02502099
025030     EXEC SQL                                                     02503099
025040          INCLUDE TPRTRTK                                         02504099
025050     END-EXEC.                                                    02505099
025060*                                                                 02506099
025100******************************************************************02510099
025200**  CURSOR USED TO RETRIEVE PRINTER CLUSTER DATA                  02520099
025400******************************************************************02540004
025500     EXEC SQL                                                     02550004
025600          DECLARE CLUSTER_CSR CURSOR FOR                          02560099
025720           SELECT PRTR_CLUSTR_NBR                                 02572099
025730                 ,CLUSTR_OPER_UNT_ID                              02573099
025740                 ,CLUSTR_FCLTY_ID                                 02574099
025750                 ,IP_ADDR                                         02575099
025760                 ,CLUSTR_OS_RLSE_CDE                              02576099
025770                 ,DAT_XFER_MODE_ID                                02577099
025780                 ,XMIT_INTFC_CDE                                  02578099
026600             FROM TPRTRCL                                         02660099
026800            WHERE CLUSTR_OPER_UNT_ID = :DK-OPER-UNT-ID            02680099
026900         WITH UR                                                  02690016
027000     END-EXEC                                                     02700036
029500*                                                                 02950004
029600******************************************************************02960099
029700**  CURSOR USED TO RETRIEVE PRINTER DATA                          02970099
029800******************************************************************02980099
029900     EXEC SQL                                                     02990099
030000          DECLARE PRINTER_CSR CURSOR FOR                          03000099
030200           SELECT PRTR_ID                                         03020099
030300                 ,PRTR_OPER_UNT_ID                                03030099
030400                 ,PRTR_FCLTY_ID                                   03040099
030500                 ,PRTR_CLUSTR_NBR                                 03050099
030600                 ,PRTR_TYP_CDE                                    03060099
030700                 ,PRTR_LOC_DESC                                   03070099
030710                 ,PRTR_PHY_STAT_CDE                               03071099
030800             FROM TPRTRID                                         03080099
030900            WHERE PRTR_OPER_UNT_ID = :DK-OPER-UNT-ID              03090099
030910            ORDER BY PRTR_CLUSTR_NBR DESC                         03091099
030920                   , PRTR_ID ASC                                  03092099
031000         WITH UR                                                  03100099
031100     END-EXEC                                                     03110099
031200******************************************************************03120099
031300**  CURSOR USED TO RETRIEVE PRINTER TRACK NUMBER DATA             03130099
031400******************************************************************03140099
031500     EXEC SQL                                                     03150099
031600          DECLARE TRACK_NBR_CSR CURSOR FOR                        03160099
031800           SELECT PRTR_ID                                         03180099
031900                 ,PRTR_OPER_UNT_ID                                03190099
032000                 ,PRTR_FCLTY_ID                                   03200099
032100                 ,PRTR_TRK_NBR                                    03210099
032200                 ,STK_TYP_CDE                                     03220099
032300                 ,PRTR_TRK_STAT_CDE                               03230099
032400             FROM TPRTRTK                                         03240099
032500            WHERE PRTR_OPER_UNT_ID = :DK-OPER-UNT-ID              03250099
032600         WITH UR                                                  03260099
032700     END-EXEC                                                     03270099
032800*                                                                 03280099
046000*                                                                 04600004
046100******************************************************************04610004
046200 PROCEDURE DIVISION.                                              04620004
046300******************************************************************04630004
046400                                                                  04640004
046500******************************************************************04650004
046600*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   04660004
046700******************************************************************04670004
046800 0000-PROGRAM-MAINLINE.                                           04680004
046900     PERFORM 1000-INITIALIZE.                                     04690004
046910*                                                                 04691099
046920* NOTE:  IF LOC-ID-CURR  =  LOC-ID-NEW THIS IS VALID              04692099
046930*        THAT IS WHAT WILL BE USED TO LOAD THE FILE TO PROD       04693099
046940*                                                                 04694099
047000*                                                                 04700004
047010     IF  CC-OPER-UNT-ID-CURR1-X NUMERIC   AND                     04701099
047011         CC-OPER-UNT-ID-NEW1-X  NUMERIC   AND                     04701199
047012         CC-OPER-UNT-ID-CURR1-X > '0000'  AND                     04701299
047013         CC-OPER-UNT-ID-NEW1-X  > '0000'                          04701399
047024         MOVE CC-OPER-UNT-ID-CURR1 TO DK-OPER-UNT-ID              04702499
047025         MOVE CC-OPER-UNT-ID-NEW1 TO PV-OPER-UNT-ID               04702599
047026         MOVE '1'             TO PV-OPERATING-UNIT                04702699
047027         PERFORM 6000-OPEN-CLUSTER-CSR                            04702799
047028                                                                  04702899
047029         PERFORM 6010-FETCH-CLUSTER-CSR                           04702999
047030         IF  PS-END-OF-CLUSTER-CSR-NO                             04703099
047031             DISPLAY '*** TABLE TPRTRCL ***'                      04703199
047032             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR1 '        04703299
047033                                    CC-OPER-UNT-ID-CURR1          04703399
047034             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW1  '        04703499
047035                                   CC-OPER-UNT-ID-NEW1            04703599
047036             PERFORM 2000-PROCESS-TPRTRCL                         04703699
047037                 UNTIL PS-END-OF-CLUSTER-CSR-YES                  04703799
047038          ELSE                                                    04703899
047039              DISPLAY '** CC CURRENT OPER-UNT-ID 1 NOT FOUND'     04703999
047040                      '** ON TPRTRCL ==> ' CC-OPER-UNT-ID-CURR1-X 04704099
047041          END-IF                                                  04704199
047042                                                                  04704299
047043          PERFORM 6020-CLOSE-CLUSTER-CSR                          04704399
047044                                                                  04704499
047054          PERFORM 7000-OPEN-PRINTER-CSR                           04705499
047055          PERFORM 7010-FETCH-PRINTER-CSR                          04705599
047056          IF  PS-END-OF-PRINTER-CSR-NO                            04705699
047057              DISPLAY '*** TABLE TPRTRID ***'                     04705799
047058              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR1 '       04705899
047059                                     CC-OPER-UNT-ID-CURR1         04705999
047060              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW1  '       04706099
047061                                     CC-OPER-UNT-ID-NEW1          04706199
047062              PERFORM 2100-PROCESS-TPRTRID                        04706299
047063                UNTIL PS-END-OF-PRINTER-CSR-YES                   04706399
047065          ELSE                                                    04706599
047066              DISPLAY '** CC CURRENT OPER-UNT-ID 1 NOT FOUND'     04706699
047067                      '** ON TPRTRID ==> ' CC-OPER-UNT-ID-CURR1-X 04706799
047068          END-IF                                                  04706899
047069          PERFORM 7020-CLOSE-PRINTER-CSR                          04706999
047070                                                                  04707099
047071          PERFORM 8000-OPEN-TRACK-NBR-CSR                         04707199
047072          PERFORM 8010-FETCH-TRACK-NBR-CSR                        04707299
047073          IF  PS-END-OF-TRACK-NBR-CSR-NO                          04707399
047074              DISPLAY '*** TABLE TPRTRTK ***'                     04707499
047075              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR1 '       04707599
047076                                     CC-OPER-UNT-ID-CURR1         04707699
047077              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW1  '       04707799
047078                                     CC-OPER-UNT-ID-NEW1          04707899
047079              PERFORM 2200-PROCESS-TPRTRTK                        04707999
047080                UNTIL PS-END-OF-TRACK-NBR-CSR-YES                 04708099
047081          ELSE                                                    04708199
047082              DISPLAY '** CC CURRENT OPER-UNT-ID 1 NOT FOUND'     04708299
047083                      '** ON TPRTRTK ==> ' CC-OPER-UNT-ID-CURR1-X 04708399
047084          END-IF                                                  04708499
047085          PERFORM 8020-CLOSE-TRACK-NBR-CSR                        04708599
047086                                                                  04708699
047087     ELSE                                                         04708725
047088* * *  JUST SKIP IF CURRENT AND NEW OPER-UNT-ID ARE ZERO          04708899
047089         IF  CC-OPER-UNT-ID-CURR1-X = '0000'  AND                 04708999
047090             CC-OPER-UNT-ID-NEW1-X  = '0000'                      04709099
047091             CONTINUE                                             04709189
047092         ELSE                                                     04709225
047093             DISPLAY '** CC OPER-UNT-ID 1 DATA INVALID'           04709399
047094             DISPLAY '** ' CC-OPER-UNT-ID-CURR1-X ' '             04709499
047095                           CC-OPER-UNT-ID-NEW1-X                  04709599
047096         END-IF                                                   04709686
047097     END-IF.                                                      04709725
047098*                                                                 04709892
047099     IF  CC-OPER-UNT-ID-CURR2-X NUMERIC   AND                     04709999
047100         CC-OPER-UNT-ID-NEW2-X  NUMERIC   AND                     04710099
047101         CC-OPER-UNT-ID-CURR2-X > '0000'  AND                     04710199
047110         CC-OPER-UNT-ID-NEW2-X  > '0000'                          04711099
047210         MOVE CC-OPER-UNT-ID-CURR2 TO DK-OPER-UNT-ID              04721099
047220         MOVE CC-OPER-UNT-ID-NEW2 TO PV-OPER-UNT-ID               04722099
047221         MOVE '2'             TO PV-OPERATING-UNIT                04722199
047222         SET PS-END-OF-CLUSTER-CSR-NO TO TRUE                     04722299
047230         PERFORM 6000-OPEN-CLUSTER-CSR                            04723099
047231                                                                  04723199
047240         PERFORM 6010-FETCH-CLUSTER-CSR                           04724099
047241         IF  PS-END-OF-CLUSTER-CSR-NO                             04724199
047242             DISPLAY '*** TABLE TPRTRCL ***'                      04724299
047243             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR2 '        04724399
047244                                    CC-OPER-UNT-ID-CURR2          04724499
047245             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW2  '        04724599
047246                                    CC-OPER-UNT-ID-NEW2           04724699
047250             PERFORM 2000-PROCESS-TPRTRCL                         04725099
047260               UNTIL PS-END-OF-CLUSTER-CSR-YES                    04726099
047261          ELSE                                                    04726199
047262              DISPLAY '** CC CURRENT OPER-UNT-ID 2 NOT FOUND'     04726299
047263                      '** ON TPRTRCL ==> ' CC-OPER-UNT-ID-CURR2-X 04726399
047265          END-IF                                                  04726599
047270          PERFORM 6020-CLOSE-CLUSTER-CSR                          04727099
047271          SET PS-END-OF-PRINTER-CSR-NO TO TRUE                    04727199
047272                                                                  04727299
047273          PERFORM 7000-OPEN-PRINTER-CSR                           04727399
047274          PERFORM 7010-FETCH-PRINTER-CSR                          04727499
047275          IF  PS-END-OF-PRINTER-CSR-NO                            04727599
047276              DISPLAY '*** TABLE TPRTRID ***'                     04727699
047277              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR2 '       04727799
047278                                     CC-OPER-UNT-ID-CURR2         04727899
047279              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW2  '       04727999
047280                                     CC-OPER-UNT-ID-NEW2          04728099
047281              PERFORM 2100-PROCESS-TPRTRID                        04728199
047282                UNTIL PS-END-OF-PRINTER-CSR-YES                   04728299
047283          ELSE                                                    04728399
047284              DISPLAY '** CC CURRENT OPER-UNT-ID 2 NOT FOUND'     04728499
047285                      '** ON TPRTRID ==> ' CC-OPER-UNT-ID-CURR2-X 04728599
047286          END-IF                                                  04728699
047287          PERFORM 7020-CLOSE-PRINTER-CSR                          04728799
047288          SET PS-END-OF-TRACK-NBR-CSR-NO TO TRUE                  04728899
047289                                                                  04728999
047290          PERFORM 8000-OPEN-TRACK-NBR-CSR                         04729099
047291          PERFORM 8010-FETCH-TRACK-NBR-CSR                        04729199
047292          IF  PS-END-OF-TRACK-NBR-CSR-NO                          04729299
047293              DISPLAY '*** TABLE TPRTRTK ***'                     04729399
047294              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR2 '       04729499
047295                                     CC-OPER-UNT-ID-CURR2         04729599
047296              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW2  '       04729699
047297                                     CC-OPER-UNT-ID-NEW2          04729799
047298              PERFORM 2200-PROCESS-TPRTRTK                        04729899
047299                UNTIL PS-END-OF-TRACK-NBR-CSR-YES                 04729999
047300          ELSE                                                    04730099
047301              DISPLAY '** CC CURRENT OPER-UNT-ID 2 NOT FOUND'     04730199
047302                      '** ON TPRTRTK ==> ' CC-OPER-UNT-ID-CURR2-X 04730299
047303          END-IF                                                  04730399
047304          PERFORM 8020-CLOSE-TRACK-NBR-CSR                        04730499
047305                                                                  04730599
047306     ELSE                                                         04730692
047307* * *  JUST SKIP IF CURRENT AND NEW OPER-UNT-ID ARE ZERO          04730799
047308         IF  CC-OPER-UNT-ID-CURR2-X = '0000'  AND                 04730899
047309             CC-OPER-UNT-ID-NEW2-X  = '0000'                      04730999
047310             CONTINUE                                             04731092
047311         ELSE                                                     04731192
047312             DISPLAY '** CC OPER-UNT-ID 2 DATA INVALID'           04731299
047313             DISPLAY '** ' CC-OPER-UNT-ID-CURR2-X ' '             04731399
047314                           CC-OPER-UNT-ID-NEW2-X                  04731499
047315         END-IF                                                   04731592
047316     END-IF.                                                      04731692
047320*                                                                 04732004
047400     IF  CC-OPER-UNT-ID-CURR3-X NUMERIC   AND                     04740099
047410         CC-OPER-UNT-ID-NEW3-X  NUMERIC   AND                     04741099
047420         CC-OPER-UNT-ID-CURR3-X > '0000'  AND                     04742099
047430         CC-OPER-UNT-ID-NEW3-X  > '0000'                          04743099
047472         MOVE CC-OPER-UNT-ID-CURR3 TO DK-OPER-UNT-ID              04747299
047473         MOVE CC-OPER-UNT-ID-NEW3 TO PV-OPER-UNT-ID               04747399
047474         MOVE '3'             TO PV-OPERATING-UNIT                04747499
047475         SET PS-END-OF-CLUSTER-CSR-NO TO TRUE                     04747599
047476         PERFORM 6000-OPEN-CLUSTER-CSR                            04747699
047477                                                                  04747799
047478         PERFORM 6010-FETCH-CLUSTER-CSR                           04747899
047479         IF  PS-END-OF-CLUSTER-CSR-NO                             04747999
047480             DISPLAY '*** TABLE TPRTRCL ***'                      04748099
047481             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR3 '        04748199
047482                                    CC-OPER-UNT-ID-CURR3          04748299
047483             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW3  '        04748399
047484                                    CC-OPER-UNT-ID-NEW3           04748499
047485             PERFORM 2000-PROCESS-TPRTRCL                         04748599
047486               UNTIL PS-END-OF-CLUSTER-CSR-YES                    04748699
047487         ELSE                                                     04748799
047488             DISPLAY '** CC CURRENT OPER-UNT-ID 3 NOT FOUND'      04748899
047489                     '** ON TPRTRCL ==> ' CC-OPER-UNT-ID-CURR3-X  04748999
047490         END-IF                                                   04749099
047491         PERFORM 6020-CLOSE-CLUSTER-CSR                           04749199
047492         SET PS-END-OF-PRINTER-CSR-NO TO TRUE                     04749299
047493                                                                  04749399
047494         PERFORM 7000-OPEN-PRINTER-CSR                            04749499
047495         PERFORM 7010-FETCH-PRINTER-CSR                           04749599
047496         IF  PS-END-OF-PRINTER-CSR-NO                             04749699
047497             DISPLAY '*** TABLE TPRTRID ***'                      04749799
047498             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR3 '        04749899
047499                                    CC-OPER-UNT-ID-CURR3          04749999
047500             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW3  '        04750099
047501                                    CC-OPER-UNT-ID-NEW3           04750199
047502             PERFORM 2100-PROCESS-TPRTRID                         04750299
047503               UNTIL PS-END-OF-PRINTER-CSR-YES                    04750399
047504         ELSE                                                     04750499
047505             DISPLAY '** CC CURRENT OPER-UNT-ID 3 NOT FOUND'      04750599
047506                     '** ON TPRTRID ==> ' CC-OPER-UNT-ID-CURR3-X  04750699
047507         END-IF                                                   04750799
047508         PERFORM 7020-CLOSE-PRINTER-CSR                           04750899
047509         SET PS-END-OF-TRACK-NBR-CSR-NO TO TRUE                   04750999
047510                                                                  04751099
047511         PERFORM 8000-OPEN-TRACK-NBR-CSR                          04751199
047512         PERFORM 8010-FETCH-TRACK-NBR-CSR                         04751299
047513         IF  PS-END-OF-TRACK-NBR-CSR-NO                           04751399
047514             DISPLAY '*** TABLE TPRTRTK ***'                      04751499
047515             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR3 '        04751599
047516                                    CC-OPER-UNT-ID-CURR3          04751699
047517             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW3  '        04751799
047518                                    CC-OPER-UNT-ID-NEW3           04751899
047519             PERFORM 2200-PROCESS-TPRTRTK                         04751999
047520               UNTIL PS-END-OF-TRACK-NBR-CSR-YES                  04752099
047521         ELSE                                                     04752199
047522             DISPLAY '** CC CURRENT OPER-UNT-ID 3 NOT FOUND'      04752299
047523                     '** ON TPRTRTK ==> ' CC-OPER-UNT-ID-CURR3-X  04752399
047524         END-IF                                                   04752499
047525                                                                  04752599
047526         PERFORM 8020-CLOSE-TRACK-NBR-CSR                         04752699
047527                                                                  04752799
047528     ELSE                                                         04752893
047529* * *  JUST SKIP IF CURRENT AND NEW OPER-UNT-ID ARE ZERO          04752999
047530         IF  CC-OPER-UNT-ID-CURR3-X = '0000'  AND                 04753099
047531             CC-OPER-UNT-ID-NEW3-X  = '0000'                      04753199
047532             CONTINUE                                             04753293
047533         ELSE                                                     04753393
047534             DISPLAY '** CC OPER-UNT-ID 3 DATA INVALID'           04753499
047535             DISPLAY '** ' CC-OPER-UNT-ID-CURR3-X ' '             04753599
047536                           CC-OPER-UNT-ID-NEW3-X                  04753699
047537         END-IF                                                   04753793
047538     END-IF.                                                      04753893
047539*                                                                 04753994
047540     IF  CC-OPER-UNT-ID-CURR4-X NUMERIC   AND                     04754099
047541         CC-OPER-UNT-ID-NEW4-X  NUMERIC   AND                     04754199
047542         CC-OPER-UNT-ID-CURR4-X > '0000'  AND                     04754299
047543         CC-OPER-UNT-ID-NEW4-X  > '0000'                          04754399
047545         MOVE CC-OPER-UNT-ID-CURR4 TO DK-OPER-UNT-ID              04754599
047546         MOVE CC-OPER-UNT-ID-NEW4  TO PV-OPER-UNT-ID              04754699
047547         MOVE '4'                  TO PV-OPERATING-UNIT           04754799
047548         SET PS-END-OF-CLUSTER-CSR-NO TO TRUE                     04754899
047549                                                                  04754999
047550         PERFORM 6000-OPEN-CLUSTER-CSR                            04755099
047551         PERFORM 6010-FETCH-CLUSTER-CSR                           04755199
047552         IF  PS-END-OF-CLUSTER-CSR-NO                             04755299
047553             DISPLAY '*** TABLE TPRTRCL ***'                      04755399
047554             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR4 '        04755499
047555                                    CC-OPER-UNT-ID-CURR4          04755599
047556             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW4  '        04755699
047557                                    CC-OPER-UNT-ID-NEW4           04755799
047558             PERFORM 2000-PROCESS-TPRTRCL                         04755899
047559               UNTIL PS-END-OF-CLUSTER-CSR-YES                    04755999
047560         ELSE                                                     04756099
047561             DISPLAY '** CC CURRENT OPER-UNT-ID 4 NOT FOUND'      04756199
047562                     '** ON TPRTRCL ==> ' CC-OPER-UNT-ID-CURR4-X  04756299
047563         END-IF                                                   04756399
047564         PERFORM 6020-CLOSE-CLUSTER-CSR                           04756499
047565         SET PS-END-OF-PRINTER-CSR-NO TO TRUE                     04756599
047566                                                                  04756699
047567         PERFORM 7000-OPEN-PRINTER-CSR                            04756799
047568         PERFORM 7010-FETCH-PRINTER-CSR                           04756899
047569         IF  PS-END-OF-PRINTER-CSR-NO                             04756999
047570             DISPLAY '*** TABLE TPRTRID ***'                      04757099
047571             DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR4 '        04757199
047572                                    CC-OPER-UNT-ID-CURR4          04757299
047573             DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW4  '        04757399
047574                                    CC-OPER-UNT-ID-NEW4           04757499
047575             PERFORM 2100-PROCESS-TPRTRID                         04757599
047576               UNTIL PS-END-OF-PRINTER-CSR-YES                    04757699
047577         ELSE                                                     04757799
047578             DISPLAY '** CC CURRENT OPER-UNT-ID 4 NOT FOUND'      04757899
047579                     '** ON TPRTRID ==> ' CC-OPER-UNT-ID-CURR4-X  04757999
047580         END-IF                                                   04758099
047581         PERFORM 7020-CLOSE-PRINTER-CSR                           04758199
047582         SET PS-END-OF-TRACK-NBR-CSR-NO TO TRUE                   04758299
047583                                                                  04758399
047584         PERFORM 8000-OPEN-TRACK-NBR-CSR                          04758499
047585         PERFORM 8010-FETCH-TRACK-NBR-CSR                         04758599
047586         IF  PS-END-OF-TRACK-NBR-CSR-NO                           04758699
047587              DISPLAY '*** TABLE TPRTRTK ***'                     04758799
047588              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR4 '       04758899
047589                                     CC-OPER-UNT-ID-CURR4         04758999
047590              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW4  '       04759099
047591                                     CC-OPER-UNT-ID-NEW4          04759199
047592              PERFORM 2200-PROCESS-TPRTRTK                        04759299
047593                UNTIL PS-END-OF-TRACK-NBR-CSR-YES                 04759399
047594         ELSE                                                     04759499
047595             DISPLAY '** CC CURRENT OPER-UNT-ID 4 NOT FOUND'      04759599
047596                     '** ON TPRTRTK ==> ' CC-OPER-UNT-ID-CURR4-X  04759699
047597         END-IF                                                   04759799
047598         PERFORM 8020-CLOSE-TRACK-NBR-CSR                         04759899
047599                                                                  04759999
047600     ELSE                                                         04760094
047601* * *  JUST SKIP IF CURRENT AND NEW OPER-UNT-ID ARE ZERO          04760199
047602         IF  CC-OPER-UNT-ID-CURR4-X = '0000'  AND                 04760299
047603             CC-OPER-UNT-ID-NEW4-X  = '0000'                      04760399
047604             CONTINUE                                             04760494
047605         ELSE                                                     04760594
047606             DISPLAY '** CC OPER-UNT-ID 4 DATA INVALID'           04760699
047607             DISPLAY '** ' CC-OPER-UNT-ID-CURR4-X ' '             04760799
047608                           CC-OPER-UNT-ID-NEW4-X                  04760899
047609         END-IF                                                   04760994
047610     END-IF.                                                      04761094
047611*                                                                 04761143
047612     PERFORM 9000-DISPLAY-COUNTS                                  04761243
047613*                                                                 04761304
047614     CLOSE CLUSTER-FILE-OUT                                       04761499
047615           PRINTER-FILE-OUT                                       04761599
047616           TRACK-NBR-FILE-OUT.                                    04761699
047617                                                                  04761799
047620     STOP RUN.                                                    04762004
047700*                                                                 04770004
048400******************************************************************04840004
048500 1000-INITIALIZE.                                                 04850004
048600     DISPLAY '**'.                                                04860099
048601     DISPLAY '** PROGRAM:  CNKUT908'.                             04860199
048602     DISPLAY '**'.                                                04860299
048610     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04861013
048611     DISPLAY '** CONTROL CARD: '                                  04861199
048612             CC-CONTROL-CARD.                                     04861299
048613     DISPLAY '**'.                                                04861399
048620*                                                                 04862013
048700     OPEN OUTPUT CLUSTER-FILE-OUT                                 04870099
048710                 PRINTER-FILE-OUT                                 04871099
048720                 TRACK-NBR-FILE-OUT.                              04872099
048800*                                                                 04880004
049600******************************************************************04960004
049700 2000-PROCESS-TPRTRCL.                                            04970099
058600*                                                                 05860004
059400     MOVE PV-OPER-UNT-ID     TO PRTRCL-CLUSTR-OPER-UNT-ID         05940099
059800*                                                                 05980089
061800     WRITE CLUSTER-RECORD-OUT                                     06180099
061901        FROM DCLTPRTRCL.                                          06190199
061910     ADD +1 TO PV-TPRTRCL-O-CNT.                                  06191099
061920     EVALUATE TRUE                                                06192098
061930         WHEN PV-OPER-UNT-1                                       06193099
061940              ADD +1 TO PV-TPRTRCL-O1-CNT                         06194099
061950         WHEN PV-OPER-UNT-2                                       06195099
061951              ADD +1 TO PV-TPRTRCL-O2-CNT                         06195199
061952         WHEN PV-OPER-UNT-3                                       06195299
061953              ADD +1 TO PV-TPRTRCL-O3-CNT                         06195399
061954         WHEN PV-OPER-UNT-4                                       06195499
061955              ADD +1 TO PV-TPRTRCL-O4-CNT                         06195599
061960     END-EVALUATE                                                 06196098
062000*                                                                 06200004
062100     PERFORM 6010-FETCH-CLUSTER-CSR.                              06210099
062200*                                                                 06220004
062300******************************************************************06230099
062400 2100-PROCESS-TPRTRID.                                            06240099
062500*                                                                 06250099
062600     MOVE PV-OPER-UNT-ID     TO WS-PRTRID-PRTR-OPER-UNT-ID        06260099
062700*                                                                 06270099
062800     WRITE PRINTER-RECORD-OUT                                     06280099
062810        FROM WS-TPRTRID.                                          06281099
063100     ADD +1 TO PV-TPRTRID-O-CNT.                                  06310099
063200     EVALUATE TRUE                                                06320099
063300         WHEN PV-OPER-UNT-1                                       06330099
063400              ADD +1 TO PV-TPRTRID-O1-CNT                         06340099
063500         WHEN PV-OPER-UNT-2                                       06350099
063600              ADD +1 TO PV-TPRTRID-O2-CNT                         06360099
063700         WHEN PV-OPER-UNT-3                                       06370099
063800              ADD +1 TO PV-TPRTRID-O3-CNT                         06380099
063900         WHEN PV-OPER-UNT-4                                       06390099
064000              ADD +1 TO PV-TPRTRID-O4-CNT                         06400099
064100     END-EVALUATE                                                 06410099
064200*                                                                 06420099
064300     PERFORM 7010-FETCH-PRINTER-CSR.                              06430099
064400*                                                                 06440099
064500******************************************************************06450099
064600 2200-PROCESS-TPRTRTK.                                            06460099
064700*                                                                 06470099
064800     MOVE PV-OPER-UNT-ID     TO PRTRTK-PRTR-OPER-UNT-ID           06480099
064900*                                                                 06490099
065000     WRITE TRACK-NBR-RECORD-OUT                                   06500099
065100        FROM DCLTPRTRTK.                                          06510099
065200     ADD +1 TO PV-TPRTRTK-O-CNT.                                  06520099
065300     EVALUATE TRUE                                                06530099
065400         WHEN PV-OPER-UNT-1                                       06540099
065500              ADD +1 TO PV-TPRTRTK-O1-CNT                         06550099
065600         WHEN PV-OPER-UNT-2                                       06560099
065700              ADD +1 TO PV-TPRTRTK-O2-CNT                         06570099
065800         WHEN PV-OPER-UNT-3                                       06580099
065900              ADD +1 TO PV-TPRTRTK-O3-CNT                         06590099
066000         WHEN PV-OPER-UNT-4                                       06600099
066100              ADD +1 TO PV-TPRTRTK-O4-CNT                         06610099
066200     END-EVALUATE                                                 06620099
066300*                                                                 06630099
066400     PERFORM 8010-FETCH-TRACK-NBR-CSR.                            06640099
066500*                                                                 06650099
112000******************************************************************11200004
112100*  OPEN THE CLUSTER_CSR                                           11210099
112200******************************************************************11220004
112300 6000-OPEN-CLUSTER-CSR.                                           11230099
112400     EXEC SQL                                                     11240004
112500          OPEN CLUSTER_CSR                                        11250099
112600     END-EXEC.                                                    11260004
112700*                                                                 11270004
112800     EVALUATE TRUE                                                11280004
112900         WHEN SQLCODE = ZERO                                      11290004
113000              CONTINUE                                            11300004
113100         WHEN OTHER                                               11310004
113200              MOVE '6000-OPEN-CLUSTER-CSR'                        11320099
113300                                 TO PV-ABEND-PARAGRAPH            11330022
113400              MOVE PE-MSG-01     TO PV-DB2-OPERATION-ATTEMPTED    11340004
113500              PERFORM 9200-SQL-ABEND                              11350004
113600     END-EVALUATE.                                                11360004
113700*                                                                 11370004
113900******************************************************************11390004
114000*  FETCH THE NEXT CLUSTER                                         11400099
114100******************************************************************11410004
114200 6010-FETCH-CLUSTER-CSR.                                          11420099
114220                                                                  11422058
114300     EXEC SQL                                                     11430004
114400          FETCH CLUSTER_CSR                                       11440099
114513           INTO :PRTRCL-PRTR-CLUSTR-NBR                           11451399
114514               ,:PRTRCL-CLUSTR-OPER-UNT-ID                        11451499
114515               ,:PRTRCL-CLUSTR-FCLTY-ID                           11451599
114516               ,:PRTRCL-IP-ADDR                                   11451699
114517               ,:PRTRCL-CLUSTR-OS-RLSE-CDE                        11451799
114518               ,:PRTRCL-DAT-XFER-MODE-ID                          11451899
114519               ,:PRTRCL-XMIT-INTFC-CDE                            11451999
115400     END-EXEC.                                                    11540004
115500*                                                                 11550004
115600     EVALUATE TRUE                                                11560004
115700         WHEN SQLCODE = ZERO                                      11570004
115710              ADD +1 TO PV-TPRTRCL-I-CNT                          11571099
115800         WHEN SQLCODE = +100                                      11580004
115910              SET PS-END-OF-CLUSTER-CSR-YES                       11591099
115920                                TO TRUE                           11592027
116000         WHEN OTHER                                               11600004
116020              PERFORM 9000-DISPLAY-COUNTS                         11602033
116030              EVALUATE TRUE                                       11603099
116040                  WHEN PV-OPER-UNT-1                              11604099
116050                       DISPLAY '*** OPER-UNT-ID '                 11605099
116051                                CC-OPER-UNT-ID-CURR1-X            11605199
116060                  WHEN PV-OPER-UNT-2                              11606099
116061                       DISPLAY '*** OPER-UNT-ID '                 11606199
116062                                CC-OPER-UNT-ID-CURR2-X            11606299
116080                  WHEN PV-OPER-UNT-3                              11608099
116090                       DISPLAY '*** OPER-UNT-ID '                 11609099
116091                                CC-OPER-UNT-ID-CURR3-X            11609199
116092                  WHEN PV-OPER-UNT-4                              11609299
116093                       DISPLAY '*** OPER-UNT-ID '                 11609399
116094                                CC-OPER-UNT-ID-CURR3-X            11609499
116095              END-EVALUATE                                        11609599
116096              MOVE PRTRCL-PRTR-CLUSTR-NBR                         11609699
116097                                TO PV-DISP-PRTR-CLUSTR-NBR        11609799
116098              DISPLAY '*** LAST GOOD CLUSTER FETCH: '             11609899
116100                                   PV-DISP-PRTR-CLUSTR-NBR        11610099
116110              MOVE '6010-FETCH-CLUSTER-CSR'                       11611099
116200                                 TO PV-ABEND-PARAGRAPH            11620004
116300              MOVE PE-MSG-02     TO PV-DB2-OPERATION-ATTEMPTED    11630004
116400              PERFORM 9200-SQL-ABEND                              11640004
116500     END-EVALUATE.                                                11650004
116600*                                                                 11660004
141700******************************************************************14170004
141800*  CLOSE THE CLUSTER_CSR                                          14180099
141900******************************************************************14190004
142000 6020-CLOSE-CLUSTER-CSR.                                          14200099
142100     EXEC SQL                                                     14210004
142200          CLOSE CLUSTER_CSR                                       14220099
142300     END-EXEC.                                                    14230004
142400*                                                                 14240004
142500     EVALUATE TRUE                                                14250004
142600         WHEN SQLCODE = ZERO                                      14260004
142700              CONTINUE                                            14270004
142800         WHEN OTHER                                               14280004
142900              MOVE '6020-CLOSE-CLUSTER-CSR'                       14290099
143000                                 TO PV-ABEND-PARAGRAPH            14300004
143100              MOVE PE-MSG-03     TO PV-DB2-OPERATION-ATTEMPTED    14310024
143200              PERFORM 9200-SQL-ABEND                              14320004
143300     END-EVALUATE.                                                14330004
143400*                                                                 14340004
143500******************************************************************14350099
143600*  OPEN THE PRINTER_CSR                                           14360099
143700******************************************************************14370099
143800 7000-OPEN-PRINTER-CSR.                                           14380099
143900     EXEC SQL                                                     14390099
144000          OPEN PRINTER_CSR                                        14400099
144100     END-EXEC.                                                    14410099
144200*                                                                 14420099
144300     EVALUATE TRUE                                                14430099
144400         WHEN SQLCODE = ZERO                                      14440099
144500              CONTINUE                                            14450099
144600         WHEN OTHER                                               14460099
144610              MOVE '7000-OPEN-PRINTER-CSR'                        14461099
144620                                 TO PV-ABEND-PARAGRAPH            14462099
144630              MOVE PE-MSG-04     TO PV-DB2-OPERATION-ATTEMPTED    14463099
144640              PERFORM 9200-SQL-ABEND                              14464099
144650     END-EVALUATE.                                                14465099
144651******************************************************************14465199
144652*  FETCH THE NEXT TPRTRID                                         14465299
144653******************************************************************14465399
144654 7010-FETCH-PRINTER-CSR.                                          14465499
144655                                                                  14465599
144656     EXEC SQL                                                     14465699
144657          FETCH PRINTER_CSR                                       14465799
144659           INTO :WS-PRTRID-PRTR-ID                                14465999
144660               ,:WS-PRTRID-PRTR-OPER-UNT-ID                       14466099
144661               ,:WS-PRTRID-PRTR-FCLTY-ID                          14466199
144662               ,:WS-PRTRID-PRTR-CLUSTR-NBR                        14466299
144663                    :WS-PRTR-CLUSTR-NBR-NULL                      14466399
144664               ,:WS-PRTRID-PRTR-TYP-CDE                           14466499
144665               ,:WS-PRTRID-PRTR-LOC-DESC                          14466599
144666               ,:WS-PRTRID-PRTR-PHY-STAT-CDE                      14466699
144674     END-EXEC.                                                    14467499
144675*                                                                 14467599
144676     EVALUATE TRUE                                                14467699
144677         WHEN SQLCODE = ZERO                                      14467799
144678              ADD +1 TO PV-TPRTRID-I-CNT                          14467899
144679         WHEN SQLCODE = +100                                      14467999
144680              SET PS-END-OF-PRINTER-CSR-YES                       14468099
144681                                TO TRUE                           14468199
144682         WHEN OTHER                                               14468299
144683              PERFORM 9000-DISPLAY-COUNTS                         14468399
144684              EVALUATE TRUE                                       14468499
144685                  WHEN PV-OPER-UNT-1                              14468599
144686                       DISPLAY '*** OPER-UNT-ID '                 14468699
144687                                CC-OPER-UNT-ID-CURR1-X            14468799
144688                  WHEN PV-OPER-UNT-2                              14468899
144689                       DISPLAY '*** OPER-UNT-ID '                 14468999
144690                                CC-OPER-UNT-ID-CURR2-X            14469099
144691                  WHEN PV-OPER-UNT-3                              14469199
144692                       DISPLAY '*** OPER-UNT-ID '                 14469299
144693                                CC-OPER-UNT-ID-CURR3-X            14469399
144694                  WHEN PV-OPER-UNT-4                              14469499
144695                       DISPLAY '*** OPER-UNT-ID '                 14469599
144696                                CC-OPER-UNT-ID-CURR3-X            14469699
144697              END-EVALUATE                                        14469799
144700              DISPLAY '*** LAST GOOD PRINTER FETCH: '             14470099
144701                                   WS-PRTRID-PRTR-ID              14470199
144702              MOVE '7010-FETCH-PRINTER-CSR'                       14470299
144703                                 TO PV-ABEND-PARAGRAPH            14470399
144704              MOVE PE-MSG-05     TO PV-DB2-OPERATION-ATTEMPTED    14470499
144705              PERFORM 9200-SQL-ABEND                              14470599
144706     END-EVALUATE.                                                14470699
144707*                                                                 14470799
144708******************************************************************14470899
144709*  CLOSE THE CLUSTER_CSR                                          14470999
144710******************************************************************14471099
144711 7020-CLOSE-PRINTER-CSR.                                          14471199
144712     EXEC SQL                                                     14471299
144713          CLOSE PRINTER_CSR                                       14471399
144714     END-EXEC.                                                    14471499
144715*                                                                 14471599
144716     EVALUATE TRUE                                                14471699
144717         WHEN SQLCODE = ZERO                                      14471799
144718              CONTINUE                                            14471899
144719         WHEN OTHER                                               14471999
144720              MOVE '7020-CLOSE-PRINTER-CSR'                       14472099
144721                                 TO PV-ABEND-PARAGRAPH            14472199
144722              MOVE PE-MSG-06     TO PV-DB2-OPERATION-ATTEMPTED    14472299
144723              PERFORM 9200-SQL-ABEND                              14472399
144724     END-EVALUATE.                                                14472499
144725******************************************************************14472599
144726*  OPEN THE TRACK_NBR_CSR                                         14472699
144727******************************************************************14472799
144728 8000-OPEN-TRACK-NBR-CSR.                                         14472899
144729     EXEC SQL                                                     14472999
144730          OPEN TRACK_NBR_CSR                                      14473099
144731     END-EXEC.                                                    14473199
144732*                                                                 14473299
144733     EVALUATE TRUE                                                14473399
144734         WHEN SQLCODE = ZERO                                      14473499
144735              CONTINUE                                            14473599
144736         WHEN OTHER                                               14473699
144737              MOVE '8000-OPEN-TRACK-NBR-CSR'                      14473799
144738                                 TO PV-ABEND-PARAGRAPH            14473899
144739              MOVE PE-MSG-07     TO PV-DB2-OPERATION-ATTEMPTED    14473999
144740              PERFORM 9200-SQL-ABEND                              14474099
144741     END-EVALUATE.                                                14474199
144742*                                                                 14474299
144743******************************************************************14474399
144744*  FETCH THE NEXT TPTRRTK                                         14474499
144745******************************************************************14474599
144746 8010-FETCH-TRACK-NBR-CSR.                                        14474699
144747                                                                  14474799
144748     EXEC SQL                                                     14474899
144749          FETCH TRACK_NBR_CSR                                     14474999
144751           INTO :PRTRTK-PRTR-ID                                   14475199
144752               ,:PRTRTK-PRTR-OPER-UNT-ID                          14475299
144753               ,:PRTRTK-PRTR-FCLTY-ID                             14475399
144754               ,:PRTRTK-PRTR-TRK-NBR                              14475499
144755               ,:PRTRTK-STK-TYP-CDE                               14475599
144756               ,:PRTRTK-PRTR-TRK-STAT-CDE                         14475699
144757     END-EXEC.                                                    14475799
144758*                                                                 14475899
144759     EVALUATE TRUE                                                14475999
144760         WHEN SQLCODE = ZERO                                      14476099
144761              ADD +1 TO PV-TPRTRTK-I-CNT                          14476199
144762         WHEN SQLCODE = +100                                      14476299
144763              SET PS-END-OF-TRACK-NBR-CSR-YES                     14476399
144764                                TO TRUE                           14476499
144765         WHEN OTHER                                               14476599
144766              PERFORM 9000-DISPLAY-COUNTS                         14476699
144767              EVALUATE TRUE                                       14476799
144768                  WHEN PV-OPER-UNT-1                              14476899
144769                       DISPLAY '*** OPER-UNT-ID '                 14476999
144770                                CC-OPER-UNT-ID-CURR1-X            14477099
144771                  WHEN PV-OPER-UNT-2                              14477199
144772                       DISPLAY '*** OPER-UNT-ID '                 14477299
144773                                CC-OPER-UNT-ID-CURR2-X            14477399
144774                  WHEN PV-OPER-UNT-3                              14477499
144775                       DISPLAY '*** OPER-UNT-ID '                 14477599
144776                                CC-OPER-UNT-ID-CURR3-X            14477699
144777                  WHEN PV-OPER-UNT-4                              14477799
144778                       DISPLAY '*** OPER-UNT-ID '                 14477899
144779                                CC-OPER-UNT-ID-CURR3-X            14477999
144780              END-EVALUATE                                        14478099
144781              MOVE PRTRTK-PRTR-TRK-NBR                            14478199
144782                                TO PV-DISP-PRTR-TRK-NBR           14478299
144783              DISPLAY '*** LAST GOOD TRACK NBR FETCH: '           14478399
144784                                   PRTRTK-PRTR-ID ' '             14478499
144785                                   PV-DISP-PRTR-TRK-NBR           14478599
144786              MOVE '8010-FETCH-TRACK-NBR-CSR'                     14478699
144787                                 TO PV-ABEND-PARAGRAPH            14478799
144788              MOVE PE-MSG-08     TO PV-DB2-OPERATION-ATTEMPTED    14478899
144789              PERFORM 9200-SQL-ABEND                              14478999
144790     END-EVALUATE.                                                14479099
144791*                                                                 14479199
144792******************************************************************14479299
144793*  CLOSE THE TRACK_NBR_CSR                                        14479399
144794******************************************************************14479499
144795 8020-CLOSE-TRACK-NBR-CSR.                                        14479599
144796     EXEC SQL                                                     14479699
144797          CLOSE TRACK_NBR_CSR                                     14479799
144798     END-EXEC.                                                    14479899
144799*                                                                 14479999
144800     EVALUATE TRUE                                                14480099
144801         WHEN SQLCODE = ZERO                                      14480199
144802              CONTINUE                                            14480299
144803         WHEN OTHER                                               14480399
144804              MOVE '8020-CLOSE-TRACK-NBR-CSR'                     14480499
144805                                 TO PV-ABEND-PARAGRAPH            14480599
144806              MOVE PE-MSG-09     TO PV-DB2-OPERATION-ATTEMPTED    14480699
144807              PERFORM 9200-SQL-ABEND                              14480799
144808     END-EVALUATE.                                                14480899
144809*                                                                 14480999
144810******************************************************************14481004
144900 9000-DISPLAY-COUNTS.                                             14490033
145100                                                                  14510004
145200     DISPLAY '********************************************'       14520033
145201     DISPLAY '**                                        **'       14520199
145202     DISPLAY '** TKRPRCL - PRINT CLUSTER                **'       14520299
145203     DISPLAY '**                                        **'       14520399
145210     MOVE PV-TPRTRCL-I-CNT   TO PV-DISPLAY-CNT                    14521099
145300     DISPLAY 'TPRTRCL FETCHED ..............: ' PV-DISPLAY-CNT.   14530099
145500     MOVE PV-TPRTRCL-O1-CNT  TO PV-DISPLAY-CNT                    14550099
145501     DISPLAY 'OPER-UNT-ID 1 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550199
145502     MOVE PV-TPRTRCL-O2-CNT  TO PV-DISPLAY-CNT                    14550299
145503     DISPLAY 'OPER-UNT-ID 2 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550399
145504     MOVE PV-TPRTRCL-O3-CNT  TO PV-DISPLAY-CNT                    14550499
145505     DISPLAY 'OPER-UNT-ID 3 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550599
145506     MOVE PV-TPRTRCL-O4-CNT  TO PV-DISPLAY-CNT                    14550699
145507     DISPLAY 'OPER-UNT-ID 4 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550799
145508     MOVE PV-TPRTRCL-O-CNT   TO PV-DISPLAY-CNT                    14550899
145509     DISPLAY 'TOTAL TPRTRCL OUTPUT WRITTEN..: ' PV-DISPLAY-CNT.   14550999
145510     DISPLAY '**                                        **'       14551099
145520     DISPLAY '********************************************'.      14552037
145521     DISPLAY '**                                        **'       14552199
145522     DISPLAY '** TKRPRID - PRINTER ID                   **'       14552299
145523     DISPLAY '**                                        **'       14552399
145530     MOVE PV-TPRTRID-I-CNT   TO PV-DISPLAY-CNT                    14553099
145540     DISPLAY 'TPRTRID FETCHED ..............: ' PV-DISPLAY-CNT.   14554099
145560     MOVE PV-TPRTRID-O1-CNT  TO PV-DISPLAY-CNT                    14556099
145570     DISPLAY 'OPER-UNT-ID 1 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14557099
145580     MOVE PV-TPRTRID-O2-CNT  TO PV-DISPLAY-CNT                    14558099
145590     DISPLAY 'OPER-UNT-ID 2 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14559099
145600     MOVE PV-TPRTRID-O3-CNT  TO PV-DISPLAY-CNT                    14560099
145700     DISPLAY 'OPER-UNT-ID 3 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14570099
145800     MOVE PV-TPRTRID-O4-CNT  TO PV-DISPLAY-CNT                    14580099
145900     DISPLAY 'OPER-UNT-ID 4 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14590099
145910     MOVE PV-TPRTRID-O-CNT   TO PV-DISPLAY-CNT                    14591099
146000     DISPLAY 'TOTAL TPRTRID OUTPUT WRITTEN..: ' PV-DISPLAY-CNT.   14600099
146001     DISPLAY '**                                        **'       14600199
146010     DISPLAY '********************************************'.      14601099
146011     DISPLAY '**                                        **'       14601199
146012     DISPLAY '** TKRPRTK - PRINTER TRACK                **'       14601299
146013     DISPLAY '**                                        **'       14601399
146020     MOVE PV-TPRTRTK-I-CNT   TO PV-DISPLAY-CNT                    14602099
146030     DISPLAY 'TPRTRTK FETCHED ..............: ' PV-DISPLAY-CNT.   14603099
146040     MOVE PV-TPRTRTK-O1-CNT  TO PV-DISPLAY-CNT                    14604099
146050     DISPLAY 'OPER-UNT-ID 1 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14605099
146060     MOVE PV-TPRTRTK-O2-CNT  TO PV-DISPLAY-CNT                    14606099
146070     DISPLAY 'OPER-UNT-ID 2 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14607099
146080     MOVE PV-TPRTRTK-O3-CNT  TO PV-DISPLAY-CNT                    14608099
146090     DISPLAY 'OPER-UNT-ID 3 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14609099
146091     MOVE PV-TPRTRTK-O4-CNT  TO PV-DISPLAY-CNT                    14609199
146092     DISPLAY 'OPER-UNT-ID 4 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14609299
146093     MOVE PV-TPRTRTK-O-CNT   TO PV-DISPLAY-CNT                    14609399
146094     DISPLAY 'TOTAL TPRTRTK OUTPUT WRITTEN..: ' PV-DISPLAY-CNT.   14609499
146095     DISPLAY '**                                        **'       14609599
146100     DISPLAY '********************************************'.      14610099
146700*                                                                 14670004
146800******************************************************************14680004
146900*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    14690004
147000*  ERROR OR WARNING CODE OCCURS.                                  14700004
147100******************************************************************14710004
147200 9200-SQL-ABEND.                                                  14720004
147300     DISPLAY '9200-SQL-ABEND'.                                    14730004
147400     DISPLAY '** ABEND     **'.                                   14740004
147500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        14750004
147600     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             14760004
147700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     14770004
147800*                                                                 14780004
147900*                                                                 14790004
148000******************************************************************14800004
148100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    14810004
148200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         14820004
148300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     14830004
148400* FORMAT.                                                         14840004
148500******************************************************************14850004
148600     COPY DPPD004.                                                14860004
148700                                                                  14870004
148800     IF  SQLCODE NOT = -911                                       14880004
148900         EXEC SQL                                                 14890004
149000              COMMIT                                              14900004
149100         END-EXEC                                                 14910004
149200     END-IF.                                                      14920004
149300                                                                  14930004
149400     MOVE +4013                  TO PV-ABEND-CODE.                14940004
149500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         14950004
