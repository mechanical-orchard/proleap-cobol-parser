      ******************************************************************00010077
       IDENTIFICATION DIVISION.                                         00020077
      ******************************************************************00030077
      *                                                                 00040077
       PROGRAM-ID.   DAKRP114.                                          00050077
       AUTHOR.       RICH KELLEN.                                       00060077
       INSTALLATION. KOHLS DEPARTMENT STORES.                           00070077
       DATE-WRITTEN. JULY  2006.                                        00080077
       DATE-COMPILED.                                                   00090077
      *                                                                 00100077
      ***************************************************************** 00110077
      * WR30812 - THIS PROGRAM WILL CREATE THE MONTHLY OFF INVOICE    * 00120077
      *           STMT. DATA FROM ORACLE TABLES ARE GATHERED IN THE   * 00130077
      *           2 PREVIOUS PGMS, DAKUT314 AND DAKUT315 AND DB2 DATA * 00140077
      *           IS ACCESSED IN THIS PROGRAM TO CREATE THE REPORT.   * 00150077
      *           THE DB2 TABLE ACCESSED IN THIS PROGRAM IS TADJRNL.  * 00160077
      *           TADJRNL IS USED TO GET THE DOLLARS ADDED FOR        * 00170077
      *           A VENDOR/DEPT FOR A FISCAL PERIOD.THE TMDSEAR TABLE * 00180077
      *           IS USED TO GET THE DEPT DESCRIPTION.                * 00190077
      ***************************************************************** 00200077
      ******************** HISTORY OF CHANGES **************************00210077
      * CHG ID/                                                        *00220077
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *00230077
      * -------  ----------  ----------------------------------------  *00240077
      * WR30812  07/11/2006  INITIAL IMPLEMENTATION                    *00241077
      * WR30812  08/17/2006  CHANGE TO ALSO PICK UP AP_TRN_CODE='2J'   *00242077
      *                      ROWS WHEN GETTING ADDED DOLLARS VALUE.    *00243077
      * WR30812  08/22/2006  CHANGE TO USE DA110-RMNG-AVL-COST-AMT-TOT *00244077
      *                      INSTEAD OF DA110-TTL-AVL-COST-AMT-TOT     *00245077
      *                      FIELD FOR REPORT.                         *00245177
      * WR30812  09/27/2006  CHANGE TO COMPUTE OPENING BALANCE =       *00245287
      *                      DA110-TTL-AVL-COST-AMT-TOT - DOLLARS ADDED*00245385
      *                      (FROM LAST PERIOD).                       *00245485
      *                      CHANGE TO COMPUTE ENDING BALANCE =        *00245585
      *                      DA110-TTL-AVL-COST-AMT-TOT -              *00245685
      *                      DA110-OFF-INVC-TOT.                       *00245785
      *                      CHANGE TO USE  DA110-TTL-AVL-COST-AMT-TOT *00245885
      *                      AS TOTAL AVAILABLE.                       *00245985
      * WR30812  10/17/2006  CHANGE TO USE DA110-RMNG-AVL-COST-AMT-TOT *00246092
      *                      AS ENDING BALANCE AND COMPUTE TOTAL AVAIL *00246192
      *                      AS DA110-RMNG-AVL-COST-AMT-TOT +          *00246292
      *                      DA110-OFF-INVC-TOT. COMPUTE OPENING BAL   *00246392
      *                      AS TOTAL AVAIL - DOLLARS ADDED.           *00246492
      ******************************************************************00246592
      ******************************************************************00246692
       ENVIRONMENT DIVISION.                                            00246792
      ******************************************************************00246892
      *                                                                 00246992
       CONFIGURATION SECTION.                                           00247092
       SOURCE-COMPUTER.   IBM-3090.                                     00247192
       OBJECT-COMPUTER.   IBM-3090.                                     00248077
      *                                                                 00249077
       INPUT-OUTPUT SECTION.                                            00250077
       FILE-CONTROL.                                                    00260077
           SELECT DRIVER-FILE                                           00270077
               ASSIGN                       TO INP01.                   00280077
      *                                                                 00290077
            SELECT DA-OFF-INVC-FILE                                     00300077
              ASSIGN                        TO RPT01.                   00310077
                                                                        00320077
      ******************************************************************00330077
       DATA DIVISION.                                                   00340077
      ******************************************************************00350077
      *                                                                 00360077
       FILE SECTION.                                                    00370077
       FD  DRIVER-FILE                                                  00380077
           RECORDING MODE F                                             00390077
           BLOCK CONTAINS 0 RECORDS                                     00400077
           RECORD CONTAINS 275 CHARACTERS                               00410081
           LABEL RECORDS ARE STANDARD                                   00420077
           DATA RECORD IS DRIVER-RECORD.                                00430077
       01  DRIVER-RECORD                      PIC X(275).               00440081
      *                                                                 00450077
       FD DA-OFF-INVC-FILE                                              00460077
           RECORDING MODE IS F                                          00470077
           BLOCK CONTAINS 0 RECORDS                                     00480077
           DATA RECORD IS DA-OFF-INVC-LINE.                             00490077
                                                                        00500077
       01 DA-OFF-INVC-LINE                       PIC X(132).            00510077
      *                                                                 00520077
       WORKING-STORAGE SECTION.                                         00530077
      *                                                                 00540077
           COPY SQLCA2.                                                 00550077
      *                                                                 00560077
                                                                        00570077
       01 ABEND-CODE                      PIC S9(04)    VALUE ZERO      00580077
                                                        COMP SYNC.      00590077
           88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 00600077
           88  ABEND-4002-READ-ERROR                       VALUE +4002. 00610077
           88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 00620077
           88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 00630077
           88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 00640077
           88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 00650077
           88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 00660077
           88  ABEND-4008-DATS-ERROR                       VALUE +4008. 00670077
           88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 00680077
           88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00690077
      *                                                                 00700077
       01 SD-SYSTEM-DATE.                                               00710077
          05  SD-SYSTEM-YEAR              PIC  9(02)  VALUE ZEROS.      00720077
          05  SD-SYSTEM-MONTH             PIC  9(02)  VALUE ZEROS.      00730077
          05  SD-SYSTEM-DAY               PIC  9(02)  VALUE ZEROS.      00740077
                                                                        00750077
       01 ST-SYSTEM-TIME.                                               00760077
          05  ST-SYSTEM-HOUR              PIC  9(02)  VALUE ZEROS.      00770077
          05  ST-SYSTEM-MINUTE            PIC  9(02)  VALUE ZEROS.      00780077
      *                                                                 00790077
       01 SA-SAVE-AREAS.                                                00800077
          05  SA-CURRENT-DATE             PIC  X(10)  VALUE SPACES.     00810077
          05  SA-CURR-DATE REDEFINES SA-CURRENT-DATE.                   00820077
              10 SA-CURR-CENTURY          PIC  X(02).                   00830077
              10 SA-CURR-YEAR             PIC  X(02).                   00840077
              10 FILLER                   PIC  X(01).                   00850077
              10 SA-CURR-MONTH            PIC  X(02).                   00860077
              10 FILLER                   PIC  X(01).                   00870077
              10 SA-CURR-DAY              PIC  X(02).                   00880077
          05  SA-CURRENT-TIME             PIC  X(08)  VALUE SPACES.     00890077
          05  SA-CURR-TIME REDEFINES SA-CURRENT-TIME.                   00900077
              10 SA-CURR-HOUR             PIC  X(02).                   00910077
              10 FILLER                   PIC  X(01).                   00920077
              10 SA-CURR-MINUTE           PIC  X(02).                   00930077
              10 FILLER                   PIC  X(01).                   00940077
              10 SA-CURR-SECOND           PIC  X(02).                   00950077
          05  SA-PREV-DEPT-NMBR           PIC X(03)    VALUE SPACES.    00960077
      *                                                                 00970077
       01 PC-PROGRAM-CONSTANTS.                                         00980077
          05  PC-DPKUT500                 PIC X(10)      VALUE          00990077
              'DPKUT500  '.                                             01000077
          05  PC-ADV-PAGE-SYMBOL          PIC X      VALUE '1'.         01010077
          05  PC-OPERCO-NBR               PIC X(02)  VALUE '03'.        01020077
          05  PC-DEPT-CODE                PIC X(03)  VALUE 'DPT'.       01030077
          05  PC-TYPE-CDE                 PIC X(02)  VALUE '01'.        01040077
          05  PC-PROGRAM-NAME             PIC X(08)  VALUE              01050077
              'DAKRP114'.                                               01060077
          05  PC-MAX-PAGE-LINES           PIC S9(03) VALUE +60          01070077
                                                     COMP-3.            01080077
          05  PC-MAX-RETRY-CNT            PIC S9(04) VALUE 3            01090077
                                                     COMP SYNC.         01100077
          05  PC-MORE-THAN-MAX-RETRY      PIC S9(04) VALUE 4            01110077
                                                     COMP SYNC.         01120077
      *                                                                 01130077
       01 PV-PROGRAM-VARIABLES.                                         01140077
          05  PV-SQLCODE                  PIC +9(04).                   01150077
          05  PV-OPENING-BALANCE          PIC S9(11)V99 VALUE ZERO.     01160077
          05  PV-DOLLARS-ADDED            PIC S9(11)V99 VALUE ZERO.     01170077
          05  PV-TOT-AVL                  PIC S9(11)V99 VALUE ZERO.     01180077
      * THESE VARIABLES ARE TO HOLD TOTALS AT THE DA TYPE LEVEL         01190077
          05  PV-TOT-AVAIL                PIC S9(11)V99 VALUE ZERO.     01200077
          05  PV-TOT-NON-OFF-INVC-DEBITS  PIC S9(11)V99 VALUE ZERO.     01210077
          05  PV-TOT-OFF-INVC-DEBITS      PIC S9(11)V99 VALUE ZERO.     01220077
          05  PV-TOT-PROF-CST             PIC S9(11)V99  VALUE +0.      01230077
          05  PV-TOT-PROF-CST-RTL         PIC S9(11)V99  VALUE +0.      01240077
          05  PV-TOT-COOP                 PIC S9(11)V99  VALUE +0.      01250077
          05  PV-TOT-MRKDN                PIC S9(11)V99  VALUE +0.      01260077
          05  PV-TOT-MRKDN-CST            PIC S9(11)V99  VALUE +0.      01270077
      * THESE VARIABLES ARE TO HOLD TOTALS AT THE DEPT LEVEL            01280077
          05  PV-DPT-OFF-INVC             PIC S9(11)V99 VALUE ZERO.     01290077
          05  PV-DPT-NON-OFF-INVC         PIC S9(11)V99 VALUE ZERO.     01300077
          05  PV-DPT-TOT-PROF-CST         PIC S9(11)V99  VALUE +0.      01310077
          05  PV-DPT-TOT-PROF-CST-RTL     PIC S9(11)V99  VALUE +0.      01320077
          05  PV-DPT-TOT-COOP             PIC S9(11)V99  VALUE +0.      01330077
          05  PV-DPT-TOT-MRKDN            PIC S9(11)V99  VALUE +0.      01340077
          05  PV-DPT-TOT-MRKDN-CST        PIC S9(11)V99  VALUE +0.      01350077
      * THESE VARIABLES ARE TO HOLD TOTALS AT THE BMM/BUYER/VEND LEVEL  01360077
          05  PV-X-TOT-AVAIL               PIC S9(11)V99 VALUE ZERO.    01370077
          05  PV-X-OPENING-BALANCE         PIC S9(11)V99 VALUE ZERO.    01380077
          05  PV-X-ENDING-BALANCE          PIC S9(11)V99 VALUE ZERO.    01390077
          05  PV-X-DOLLARS-ADDED           PIC S9(11)V99 VALUE ZERO.    01400077
          05  PV-X-TOT-NON-OFF-INVC-DEBITS PIC S9(11)V99 VALUE ZERO.    01410077
          05  PV-X-TOT-OFF-INVC-DEBITS     PIC S9(11)V99 VALUE ZERO.    01420077
          05  PV-X-TOT-PROF-CST            PIC S9(11)V99  VALUE +0.     01430077
          05  PV-X-TOT-PROF-CST-RTL        PIC S9(11)V99  VALUE +0.     01440077
          05  PV-X-TOT-COOP                PIC S9(11)V99  VALUE +0.     01450077
          05  PV-X-TOT-MRKDN               PIC S9(11)V99  VALUE +0.     01460077
          05  PV-X-TOT-MRKDN-CST           PIC S9(11)V99  VALUE +0.     01470077
      * THIS IS USED FOR DEPT AND BMM/BUYER/VEND TOTALS                 01480077
          05  PV-ENDING-BALANCE            PIC S9(11)V99 VALUE ZERO.    01490077
      *                                                                 01500077
          05  PV-OFFSET-DAYS               PIC  9(03) VALUE ZERO.       01510077
          05  PV-NBR-OF-DA-OFF-INVC        PIC  9(04) VALUE ZERO.       01520077
          05  PV-PREV-DA-OFF-INVC-LINE PIC X(201) VALUE SPACES.         01530077
          05  PV-PREV-DMM-NBR              PIC X(2)   VALUE SPACE.      01540077
          05  PV-PREV-BUYER-NBR            PIC 9(3)   VALUE ZERO.       01550077
          05  PV-PREV-VENDOR-NAME          PIC X(30)  VALUE SPACE.      01560077
          05  PV-PREV-CDE-DESC             PIC X(30)  VALUE SPACE.      01570077
          05  PV-PREV-DEPT-NBR             PIC 9(3)   VALUE ZERO.       01580077
          05  PV-PREV-SORT-SEQ             PIC X(2)   VALUE SPACE.      01590077
              88 PV-NO-DEBIT-ALLOWANCES    VALUE '00'.                  01600077
              88 PV-AD-COOP                VALUE '10'.                  01610077
              88 PV-MKDN-PROF-ASST-CST     VALUE '20'.                  01620077
              88 PV-MKDN-PROF-ASST-CST-RTL VALUE '30'.                  01630077
              88 PV-MKDN-ALLWNCE           VALUE '40'.                  01640077
              88 PV-MKDN-ALLWNCE-CST-ONLY  VALUE '50'.                  01650077
          05  PV-RETRY-CNT                 PIC S9(04)    VALUE +0       01660077
                                                        COMP SYNC.      01670077
          05  PV-CURRENT-DATE-CCYY-MM-DD   PIC X(10).                   01680077
          05  PV-CURRENT-DATE-CCYY-MM-DD-RED REDEFINES                  01690077
            PV-CURRENT-DATE-CCYY-MM-DD.                                 01700077
            10  PV-CURRENT-DATE-CC         PIC XX.                      01710077
            10  PV-CURRENT-DATE-YY         PIC XX.                      01720077
            10  PV-CURRENT-DATE-D1         PIC X.                       01730077
            10  PV-CURRENT-DATE-MM         PIC XX.                      01740077
            10  PV-CURRENT-DATE-D2         PIC X.                       01750077
            10  PV-CURRENT-DATE-DD         PIC XX.                      01760077
          05  PV-CURRENT-DATE              PIC X(08)     VALUE SPACE.   01770077
          05  PV-CURRENT-DATE-RED REDEFINES PV-CURRENT-DATE.            01780077
            10  PV-CURRENT-DATE-RED-CC     PIC 99.                      01790077
            10  PV-CURRENT-DATE-RED-YYMMDD PIC 9(6).                    01800077
          05  PV-CURRENT-DATE-YYMMDD-SQL   PIC S9(07)V   COMP-3.        01810077
          05  PV-CALL-DEPT                 PIC X(03)  VALUE SPACES.     01820077
          05  PV-CALL-MANAGER              PIC X(02)  VALUE SPACES.     01830077
          05  PV-DMM-NMBR                  PIC 9(03)  VALUE ZEROS.      01840077
          05  PV-BUYER-NMBR                PIC 9(03)  VALUE ZEROS.      01850077
          05  PV-BUYER-NAME                PIC X(20)  VALUE SPACES.     01860077
          05  PV-ABEND-CODE                PIC S9(04)     VALUE +0      01870077
                                                          COMP SYNC.    01880077
          05  PV-PARA-NAME                 PIC X(35).                   01890077
          05  PV-LN-CNT-FOR-TOT            PIC S9(03)     VALUE +99     01900077
                                                          COMP-3.       01910077
          05  PV-PAGE-CNT                  PIC S9(05)     VALUE ZERO.   01920077
          05  PV-PAGE-DISSECT.                                          01930077
              10  FILLER                   PIC 9(4).                    01940077
              10  PV-PAGE-LAST-DIGIT       PIC 9.                       01950077
                  88  PV-ODD               VALUE 1 3 5 7 9.             01960077
                                                                        01970077
          05  PV-DB2-OUT-DATE              PIC X(10)      VALUE SPACES. 01980077
          05  PV-CURRENT-WEEKDAY           PIC X(09)      VALUE SPACES. 01990077
          05  PV-DECREMENT-1ST             PIC 9(02)      VALUE ZERO.   02000077
          05  PV-NULL-INDICATORS.                                       02010077
              10  PV-NET-COST-AMT-QTY-NULL PIC S9(04)     VALUE +0      02020077
                                                          COMP.         02030077
      *                                                                 02040077
       01 PS-PROGRAM-SWITCHES.                                          02050077
          05  PS-END-OF-DRIVER-FILE-SW     PIC X(1) VALUE 'N'.          02060077
              88  PS-END-OF-DRIVER-FILE             VALUE 'Y'.          02070077
              88  PS-NOT-END-OF-DRIVER-FILE         VALUE 'N'.          02080077
          05  PS-PRINT-DET-TOTS-SW     PIC X(1)     VALUE 'N'.          02090077
              88  PS-PRINT-DET-TOTS                 VALUE 'Y'.          02100077
              88  PS-DONT-PRINT-DET-TOTS            VALUE 'N'.          02110077
                                                                        02120077
      *                                                                 02130077
      ******************************************************************02140077
      * ZERO SALES SKU LAYOUT.                                          02150077
      ******************************************************************02160077
           COPY DARD110.                                                02170077
                                                                        02180077
      ******************************************************************02190077
      * DB2 ERROR MESSAGES FORMAT AREA.                                 02200077
      ******************************************************************02210077
           COPY DPWS004.                                                02220077
                                                                        02230077
      ******************************************************************02240077
      * CALENDAR ROUTINE WORK AREA.                                     02250077
      ******************************************************************02260077
           COPY DPWS500.                                                02270077
      *                                                                 02280077
      ******************************************************************02290077
      * KOHLS STANDARD 132 BYTE REPORT HEADER.                          02300077
      ******************************************************************02310077
      *                                                                 02320077
           COPY DPWS132O.                                               02330077
                                                                        02340077
      *                                                                 02350077
       01 H2-HEADING-LINE.                                              02360077
          05  FILLER               PIC X(01)      VALUE SPACE.          02370077
          05  FILLER               PIC X(44)      VALUE SPACES.         02380077
          05  FILLER               PIC X(43)      VALUE                 02390077
              'MONTHLY PROFIT ASSISTANCE / CO-OP STATEMENT'.            02400077
          05  FILLER               PIC X(35)      VALUE SPACE.          02410077
      *                                                                 02420077
       01 H2A-HEADING-LINE.                                             02430077
          05  FILLER               PIC X(01)      VALUE SPACE.          02440077
          05  FILLER               PIC X(58)      VALUE SPACES.         02450077
          05  H2A-FISCAL-MONTH     PIC X(14)      VALUE SPACE.          02460077
          05  FILLER               PIC X(35)      VALUE SPACE.          02470077
      *                                                                 02480077
       01 H3-HEADING-LINE.                                              02490077
          05  FILLER               PIC X(01)      VALUE SPACE.          02500077
          05  FILLER               PIC X(04)      VALUE 'DMM:'.         02510077
          05  FILLER               PIC X(05)      VALUE SPACE.          02520077
          05  H3-DMM-NBR           PIC 9(03)      VALUE ZEROES.         02530077
          05  H3-DMM-X REDEFINES H3-DMM-NBR                             02540077
                                   PIC X(03).                           02550077
          05  FILLER               PIC X(03)      VALUE ' - '.          02560077
          05  H3-DMM-NAME          PIC X(20)      VALUE SPACES.         02570077
          05  FILLER               PIC X(167)     VALUE SPACES.         02580077
      *                                                                 02590077
       01 H4-HEADING-LINE.                                              02600077
          05  FILLER               PIC X(01)      VALUE SPACE.          02610077
          05  FILLER               PIC X(09)      VALUE 'BUYER:   '.    02620077
          05  H4-BUYER-NBR         PIC 9(03)      VALUE ZEROES.         02630077
          05  H4-BUYER-X REDEFINES H4-BUYER-NBR                         02640077
                                   PIC X(03).                           02650077
          05  FILLER               PIC X(03)      VALUE ' - '.          02660077
          05  H4-BUYER-NAME        PIC X(20)      VALUE SPACES.         02670077
          05  FILLER               PIC X(167)     VALUE SPACES.         02680077
      *                                                                 02690077
       01 H5-HEADING-LINE.                                              02700077
          05  FILLER               PIC X(01)      VALUE SPACE.          02710077
          05  FILLER               PIC X(09)      VALUE 'VENDOR:  '.    02720077
          05  H5-VENDOR-NBR        PIC X(09)      VALUE ZEROES.         02730077
          05  H5-VENDOR-X REDEFINES H5-VENDOR-NBR                       02740077
                                   PIC X(09).                           02750077
          05  FILLER               PIC X(03)      VALUE ' - '.          02760077
          05  H5-VENDOR-NAME       PIC X(30)      VALUE SPACES.         02770077
          05  FILLER               PIC X(100)     VALUE SPACES.         02780077
      *                                                                 02790077
       01 H5A-HEADING-LINE.                                             02800077
          05  FILLER               PIC X(01)      VALUE SPACE.          02810077
          05  FILLER               PIC X(05)      VALUE 'DEPT:'.        02820077
          05  FILLER               PIC X(04)      VALUE SPACE.          02830077
          05  H5A-DEPT-NBR         PIC 9(03)      VALUE ZEROES.         02840077
          05  H5A-DEPT-NBR-X REDEFINES H5A-DEPT-NBR PIC XXX.            02850077
          05  H5A-DEPT-SLASH       PIC X(03)      VALUE ' - '.          02860077
          05  H5A-DEPT-DESC        PIC X(25)      VALUE SPACE.          02870077
      *                                                                 02880077
       01 H6-HEADING-LINE.                                              02890077
          05  FILLER               PIC X(85)      VALUE SPACE.          02900077
          05  FILLER               PIC X(33)                            02910077
              VALUE 'OFF-INVOICE      NON OFF-INVOICE'.                 02920077
          05  FILLER               PIC X(62)      VALUE SPACE.          02930077
      *                                                                 02940077
       01 H7-HEADING-LINE.                                              02950077
          05  FILLER               PIC X(77)      VALUE SPACE.          02960077
          05  FILLER               PIC X(42)                            02970077
              VALUE '-------------------   ------------------'.         02980077
          05  FILLER               PIC X(62)      VALUE SPACE.          02990077
      *                                                                 03000077
       01 H8-HEADING-LINE.                                              03010077
          05  FILLER               PIC X(04)      VALUE SPACE.          03020077
          05  FILLER               PIC X(16)                            03030077
              VALUE 'OPENING BALANCE:'.                                 03040077
          05  FILLER               PIC X(58)      VALUE SPACE.          03050077
          05  H8-OPENING-BALANCE   PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             03060077
      *                                                                 03070077
       01 H9-HEADING-LINE.                                              03080077
          05  FILLER               PIC X(04)      VALUE SPACE.          03090077
          05  FILLER               PIC X(14)                            03100077
              VALUE 'DOLLARS ADDED:'.                                   03110077
          05  FILLER               PIC X(60)      VALUE SPACE.          03120077
          05  H9-DOLLARS-ADDED     PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             03130077
      *                                                                 03140077
       01 H10-HEADING-LINE.                                             03150077
          05  FILLER               PIC X(04)      VALUE SPACE.          03160077
          05  FILLER               PIC X(16)                            03170077
              VALUE 'TOTAL AVAILABLE:'.                                 03180077
          05  FILLER               PIC X(58)      VALUE SPACE.          03190077
          05  H10-TOTAL-AVAIL       PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.            03200077
      *                                                                 03210077
       01 H11-HEADING-LINE.                                             03220077
          05  FILLER               PIC X(04)      VALUE SPACE.          03230077
          05  FILLER               PIC X(11)      VALUE SPACE.          03240077
          05  FILLER               PIC X(02)      VALUE SPACE.          03250077
          05  FILLER               PIC X(03)      VALUE SPACE.          03260077
          05  FILLER               PIC X(23)      VALUE SPACE.          03270077
          05  FILLER               PIC X(12)      VALUE                 03280077
              'DEBIT NUMBER'.                                           03290077
          05  FILLER               PIC X(07)      VALUE SPACE.          03300077
          05  FILLER               PIC X(10)      VALUE                 03310077
              'COMPLETION'.                                             03320077
      *                                                                 03330077
       01 H12-HEADING-LINE.                                             03340077
          05  FILLER               PIC X(06)      VALUE SPACE.          03350077
          05  H12-DA-CDE-DESC      PIC X(40)      VALUE SPACE.          03360077
          05  FILLER               PIC X(54)      VALUE SPACES.         03370077
      *                                                                 03380077
      *  DETAIL LINE FOR PROFIT AND COOP DEBIT TYPES                    03390077
       01 DL1-LINE.                                                     03400077
          05  FILLER               PIC X(44)      VALUE SPACE.          03410077
          05  DL1-DA-ALW-NBR       PIC X(10)      VALUE SPACE.          03420077
          05  FILLER               PIC X(08)      VALUE SPACE.          03430077
          05  DL1-DA-ALW-CPT-DT    PIC X(15)      VALUE SPACE.          03440077
          05  FILLER               PIC X(01)      VALUE SPACE.          03450077
          05  DL1-CST-AMT          PIC $ZZ,ZZZ,ZZZ,ZZZ.99 VALUE ZERO.   03460077
      *                                                                 03470077
      *  DETAIL LINE FOR MRKDN AND MRKDN CST DEBIT TYPES                03480077
       01 DL2-LINE.                                                     03490077
          05  FILLER               PIC X(44)      VALUE SPACE.          03500077
          05  DL2-DA-ALW-NBR       PIC X(10)      VALUE SPACE.          03510077
          05  FILLER               PIC X(08)      VALUE SPACE.          03520077
          05  DL2-DA-ALW-CPT-DT    PIC X(10)      VALUE SPACE.          03530077
          05  FILLER               PIC X(27)      VALUE SPACE.          03540077
          05  DL2-CST-AMT          PIC $ZZ,ZZZ,ZZZ,ZZZ.99 VALUE ZERO.   03550077
      *                                                                 03560077
      *  SUB TOTAL FOR PROFIT AND COOP DEBIT TYPES                      03570077
       01 ST1-HEADING-LINE.                                             03580077
          05  FILLER               PIC X(06)      VALUE SPACE.          03590077
          05  FILLER               PIC X(06)      VALUE 'TOTAL '.       03600077
          05  ST01-DEBIT-TYPE      PIC X(32)      VALUE SPACE.          03610077
          05  FILLER               PIC X(34)      VALUE SPACE.          03620077
          05  ST01-SUB-TOTAL       PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             03630077
          05  FILLER               PIC X(01)      VALUE ' '.            03640077
      *                                                                 03650077
      *  SUB TOTAL FOR MRKDN AND MRKDN CST DEBIT TYPES                  03660077
       01 ST2-HEADING-LINE.                                             03670077
          05  FILLER               PIC X(06)      VALUE SPACE.          03680077
          05  FILLER               PIC X(06)      VALUE 'TOTAL '.       03690077
          05  ST02-DEBIT-TYPE      PIC X(32)      VALUE SPACE.          03700077
          05  FILLER               PIC X(55)      VALUE SPACE.          03710077
          05  ST02-SUB-TOTAL       PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             03720077
          05  FILLER               PIC X(01)      VALUE ' '.            03730077
      *  TOTAL FOR DEPARTMENT                                           03740077
       01 ST03-HEADING-LINE.                                            03750077
          05  FILLER               PIC X(04)      VALUE SPACE.          03760077
          05  FILLER               PIC X(12)      VALUE                 03770077
              'DEPARTMENT: '.                                           03780077
          05  ST03-DEPT-NBR        PIC 999        VALUE ZERO.           03790077
          05  FILLER               PIC X(06)      VALUE                 03800077
              ' TOTAL'.                                                 03810077
          05  FILLER               PIC X(53)      VALUE SPACE.          03820077
          05  ST03-DPT-OFF-INVC    PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             03830077
          05  FILLER               PIC X(02)      VALUE SPACE.          03840077
          05  ST03-DPT-NON-OFF-INVC PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.            03850077
          05  FILLER               PIC X(01)      VALUE ' '.            03860077
      *                                                                 03870077
      *                                                                 03880077
      *  TOTAL FOR PROFIT DEBIT TYPE                                    03890077
       01 T10-HEADING-LINE.                                             03900077
          05  FILLER               PIC X(04)      VALUE SPACE.          03910077
          05  FILLER               PIC X(34)      VALUE                 03920077
              'TOTAL MKDN ALW PROFIT ASST - COST:'.                     03930077
          05  FILLER               PIC X(44)      VALUE SPACE.          03940077
          05  T10-PROF-CST         PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             03950077
          05  FILLER               PIC X(01)      VALUE ' '.            03960077
      *                                                                 03970077
      *                                                                 03980077
      *  TOTAL FOR PROFIT CST/RTL DEBIT TYPE                            03990077
       01 T20-HEADING-LINE.                                             04000077
          05  FILLER               PIC X(04)      VALUE SPACE.          04010077
          05  FILLER               PIC X(38)      VALUE                 04020077
              'TOTAL MKDN ALW PROFIT ASST - COST/RTL:'.                 04030077
          05  FILLER               PIC X(36)      VALUE SPACE.          04040077
          05  T20-PROF-CST-RTL     PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             04050077
          05  FILLER               PIC X(01)      VALUE ' '.            04060077
      *                                                                 04070077
      *  TOTAL FOR COOP DEBIT TYPE                                      04080077
       01 T30-HEADING-LINE.                                             04090077
          05  FILLER               PIC X(04)      VALUE SPACE.          04100077
          05  FILLER               PIC X(34)      VALUE                 04110077
              'TOTAL AD COOP FROM VENDOR FUNDING:'.                     04120077
          05  FILLER               PIC X(40)      VALUE SPACE.          04130077
          05  T30-COOP             PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             04140077
          05  FILLER               PIC X(01)      VALUE ' '.            04150077
      *                                                                 04160077
      *  TOTAL FOR MRKDN DEBIT TYPE                                     04170077
       01 T40-HEADING-LINE.                                             04180077
          05  FILLER               PIC X(04)      VALUE SPACE.          04190077
          05  FILLER               PIC X(26)      VALUE                 04200077
              'TOTAL MARKDOWN ALLOWANCE:'.                              04210077
          05  FILLER               PIC X(69)      VALUE SPACE.          04220077
          05  T40-MRKDN            PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             04230077
          05  FILLER               PIC X(01)      VALUE ' '.            04240077
      *  TOTAL FOR MRKDN CST DEBIT TYPE                                 04250077
       01 T50-HEADING-LINE.                                             04260077
          05  FILLER               PIC X(04)      VALUE SPACE.          04270077
          05  FILLER               PIC X(26)      VALUE                 04280077
              'TOTAL MKDN ALW COST ONLY:'.                              04290077
          05  FILLER               PIC X(67)      VALUE SPACE.          04300077
          05  T50-MRKDN-CST        PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             04310077
          05  FILLER               PIC X(01)      VALUE ' '.            04320077
      *                                                                 04330077
      *  TOTAL DEBITS FOR OFF INVOICES                                  04340077
       01 T06-HEADING-LINE.                                             04350077
          05  FILLER               PIC X(04)      VALUE SPACE.          04360077
          05  FILLER               PIC X(18)      VALUE                 04370077
              'TOTAL OFF-INVOICE:'.                                     04380077
          05  FILLER               PIC X(56)      VALUE SPACE.          04390077
          05  T06-OFF-INVC-DEBITS  PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             04400077
          05  FILLER               PIC X(01)      VALUE ' '.            04410077
      *                                                                 04420077
      *  TOTAL DEBITS FOR NON-OFF INVOICES                              04430077
       01 T06A-HEADING-LINE.                                            04440077
          05  FILLER               PIC X(04)      VALUE SPACE.          04450077
          05  FILLER               PIC X(23)      VALUE                 04460077
              'TOTAL NON OFF-INVOICE:'.                                 04470077
          05  FILLER               PIC X(72)      VALUE SPACE.          04480077
          05  T06A-NON-OFF-INVC-DEBITS PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.         04490077
          05  FILLER               PIC X(01)      VALUE ' '.            04500077
      *                                                                 04510077
      *  ENDING BALANCE FOR DMM/BUYER/VENDOR                            04520077
       01 T07-HEADING-LINE.                                             04530077
          05  FILLER               PIC X(04)      VALUE SPACE.          04540077
          05  FILLER               PIC X(12)      VALUE                 04550077
              'END BALANCE:'.                                           04560077
          05  FILLER               PIC X(62)      VALUE SPACE.          04570077
          05  T07-ENDING-BALANCE   PIC $ZZ,ZZZ,ZZZ,ZZZ.99-.             04580077
          05  FILLER               PIC X(01)      VALUE ' '.            04590077
      *                                                                 04600077
       01 EP-EMPTY-PAGE.                                                04610077
          05  FILLER                  PIC X(49)     VALUE SPACES.       04620077
          05  FILLER                  PIC X(83)     VALUE               04630077
              'THIS PAGE INTENTIONALLY LEFT BLANK'.                     04640077
                                                                        04650077
       01 ND-NO-DATA-PAGE.                                              04660077
          05  FILLER                  PIC X(49)     VALUE SPACES.       04670077
          05  FILLER                  PIC X(83)     VALUE               04680077
              'THERE IS NO DATA FOR THIS MONTH'.                        04690077
                                                                        04700077
      ******************************************************************04710077
      * SQLCA AREA                                                      04720077
      ******************************************************************04730077
      *                                                                 04740077
           EXEC SQL                                                     04750077
               INCLUDE SQLCA                                            04760077
           END-EXEC.                                                    04770077
      *                                                                 04780077
      ******************************************************************04790077
      * COBOL DECLARATION FOR DB2 JOURNAL TABLE                         04800077
      ******************************************************************04810077
           EXEC SQL                                                     04820077
               INCLUDE TADJRNL                                          04830077
           END-EXEC.                                                    04840077
      ******************************************************************04850077
      * TABLE DECLARATIONS FOR MB MERCHANDISE       (TMDSEAR)           04860077
      ******************************************************************04870077
      *                                                                 04880077
           EXEC SQL                                                     04890077
               INCLUDE TMDSEAR                                          04900077
           END-EXEC.                                                    04910077
      ******************************************************************04920077
      * CURSOR DECLARES                                                 04930077
      ******************************************************************04940077
                                                                        04950077
      ******************************************************************04960077
       PROCEDURE DIVISION.                                              04970077
      ******************************************************************04980077
      *                                                                 04990077
          EJECT                                                         05000077
       0000-MAINLINE-PROCESSING.                                        05010077
      ******************************************************************05020077
      * MAIN PROCESSING ROUTINE                                       * 05030077
      ******************************************************************05040077
                                                                        05050077
            PERFORM 1000-INIT.                                          05060077
      * SET FIELDS UP FOR THE FIRST TIME THE MAIN PROGRAM LOOP IS       05070077
      * PERFORMED.                                                      05080077
            IF PS-NOT-END-OF-DRIVER-FILE                                05090077
      *       MOVE DA110-TTL-AVL-COST-AMT-TOT TO H10-TOTAL-AVAIL        05100088
      *       MOVE DA110-TTL-AVL-COST-AMT-TOT TO PV-TOT-AVAIL           05110088
              COMPUTE PV-TOT-AVAIL = DA110-RMNG-AVL-COST-AMT-TOT +      05120088
                DA110-OFF-INVC-TOT                                      05130091
              MOVE PV-TOT-AVAIL TO H10-TOTAL-AVAIL                      05140088
              MOVE DA110-DMM-NBR   TO PV-PREV-DMM-NBR                   05150077
              MOVE DA110-BUYER-NBR TO PV-PREV-BUYER-NBR                 05160077
              MOVE DA110-DEPT-NBR TO PV-PREV-DEPT-NBR                   05170077
              MOVE DA110-VENDOR-NM TO PV-PREV-VENDOR-NAME               05180077
              MOVE DA110-CDE-DESC TO PV-PREV-CDE-DESC                   05190077
              MOVE DA110-SORT-SEQ TO PV-PREV-SORT-SEQ                   05200077
              MOVE DA110-FSCL-YR-NBR           TO                       05210077
                    ADJRNL-PSTG-FYR-NBR                                 05220077
              MOVE DA110-FSCL-MN-NBR           TO                       05230077
                   ADJRNL-PSTG-FMN-NBR                                  05240077
              PERFORM 6000-PRINT-HEADINGS                               05250077
              PERFORM 2000-DA-AVL-FUND-RPT                              05260077
                UNTIL PS-END-OF-DRIVER-FILE                             05270077
            ELSE                                                        05280077
              PERFORM 6005-PRINT-EMPTY-REPORT.                          05290077
      *                                                                 05300077
                                                                        05310077
            PERFORM 9000-END-OF-JOB.                                    05320077
                                                                        05330077
            GOBACK.                                                     05340077
                                                                        05350077
      ******************************************************************05360077
      * OPEN FILES AND CURSOR, GET CURRENT DATE AND TIME FROM DB2.     *05370077
      ******************************************************************05380077
      *                                                                 05390077
       1000-INIT.                                                       05400077
            MOVE '*1000-INIT.              *' TO PV-PARA-NAME.          05410077
            OPEN INPUT  DRIVER-FILE                                     05420077
                 OUTPUT DA-OFF-INVC-FILE.                               05430077
                                                                        05440077
                                                                        05450077
      ***   POPULATE HEADING DATE/TIME                                  05460077
            PERFORM 9900-GET-DATE-TIME.                                 05470077
            MOVE SD-SYSTEM-DATE          TO PV-CURRENT-DATE-YYMMDD-SQL. 05480077
            MOVE SD-SYSTEM-YEAR          TO DP132O-RUN-YEAR.            05490077
            MOVE SD-SYSTEM-MONTH         TO DP132O-RUN-MONTH.           05500077
            MOVE SD-SYSTEM-DAY           TO DP132O-RUN-DAY.             05510077
            MOVE ST-SYSTEM-HOUR          TO DP132O-RUN-HOUR.            05520077
            MOVE ST-SYSTEM-MINUTE        TO DP132O-RUN-MINUTE.          05530077
            MOVE 'DAKRP114'              TO DP132O-PROGRAM-NAME.        05540077
            MOVE  1                      TO DP132O-REPORT-NUMBER.       05550077
                                                                        05560077
            PERFORM 8400-CALENDAR-DAY-OF-WEEK.                          05570077
                                                                        05580077
            READ DRIVER-FILE INTO DA110-AVL-VND-FUND-DET-REC            05590077
              AT END                                                    05600077
                SET PS-END-OF-DRIVER-FILE TO TRUE.                      05610077
      * LOGIC TO DETERMINE AND FORMAT HEADING FISCAL MONTH              05620077
            IF DA110-FSCL-MN-NBR = '12'                                 05630077
              MOVE SPACE TO H2A-FISCAL-MONTH                            05640077
              STRING                                                    05650077
                     ' JANUARY 20' DELIMITED BY SIZE                    05660077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  05670077
                    , '  ' DELIMITED BY SIZE                            05680077
                     INTO H2A-FISCAL-MONTH                              05690077
            ELSE                                                        05700077
            IF DA110-FSCL-MN-NBR = '01'                                 05710077
              MOVE SPACE TO H2A-FISCAL-MONTH                            05720077
              STRING                                                    05730077
                     ' FEBRUARY 20' DELIMITED BY SIZE                   05740077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  05750077
                    , ' ' DELIMITED BY SIZE                             05760077
                     INTO H2A-FISCAL-MONTH                              05770077
            ELSE                                                        05780077
            IF DA110-FSCL-MN-NBR = '02'                                 05790077
              MOVE SPACE TO H2A-FISCAL-MONTH                            05800077
              STRING                                                    05810077
                     '    MARCH 20' DELIMITED BY SIZE                   05820077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  05830077
                    , '  ' DELIMITED BY SIZE                            05840077
                     INTO H2A-FISCAL-MONTH                              05850077
            ELSE                                                        05860077
            IF DA110-FSCL-MN-NBR = '03'                                 05870077
              MOVE SPACE TO H2A-FISCAL-MONTH                            05880077
              STRING                                                    05890077
                     '    APRIL 20' DELIMITED BY SIZE                   05900077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  05910077
                    , '  ' DELIMITED BY SIZE                            05920077
                     INTO H2A-FISCAL-MONTH                              05930077
            ELSE                                                        05940077
            IF DA110-FSCL-MN-NBR = '04'                                 05950077
              MOVE SPACE TO H2A-FISCAL-MONTH                            05960077
              STRING                                                    05970077
                     '    MAY 20' DELIMITED BY SIZE                     05980077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  05990077
                    , '    ' DELIMITED BY SIZE                          06000077
                     INTO H2A-FISCAL-MONTH                              06010077
            ELSE                                                        06020077
            IF DA110-FSCL-MN-NBR = '05'                                 06030077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06040077
              STRING                                                    06050077
                     '   JUNE 20' DELIMITED BY SIZE                     06060077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06070077
                    , '    ' DELIMITED BY SIZE                          06080077
                     INTO H2A-FISCAL-MONTH                              06090077
            ELSE                                                        06100077
            IF DA110-FSCL-MN-NBR = '06'                                 06110077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06120077
              STRING                                                    06130077
                     '   JULY 20' DELIMITED BY SIZE                     06140077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06150077
                    , '    ' DELIMITED BY SIZE                          06160077
                     INTO H2A-FISCAL-MONTH                              06170077
            ELSE                                                        06180077
            IF DA110-FSCL-MN-NBR = '07'                                 06190077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06200077
              STRING                                                    06210077
                     '  AUGUST 20' DELIMITED BY SIZE                    06220077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06230077
                    , '   ' DELIMITED BY SIZE                           06240077
                     INTO H2A-FISCAL-MONTH                              06250077
            ELSE                                                        06260077
            IF DA110-FSCL-MN-NBR = '08'                                 06270077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06280077
              STRING                                                    06290077
                     'SEPTEMBER 20' DELIMITED BY SIZE                   06300077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06310077
                     INTO H2A-FISCAL-MONTH                              06320077
            ELSE                                                        06330077
            IF DA110-FSCL-MN-NBR = '09'                                 06340077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06350077
              STRING                                                    06360077
                     ' OCTOBER 20' DELIMITED BY SIZE                    06370077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06380077
                    , '  ' DELIMITED BY SIZE                            06390077
                     INTO H2A-FISCAL-MONTH                              06400077
            ELSE                                                        06410077
            IF DA110-FSCL-MN-NBR = '10'                                 06420077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06430077
              STRING                                                    06440077
                     ' NOVEMBER 20' DELIMITED BY SIZE                   06450077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06460077
                    , ' ' DELIMITED BY SIZE                             06470077
                     INTO H2A-FISCAL-MONTH                              06480077
            ELSE                                                        06490077
            IF DA110-FSCL-MN-NBR = '11'                                 06500077
              MOVE SPACE TO H2A-FISCAL-MONTH                            06510077
              STRING                                                    06520077
                     ' DECEMBER 20' DELIMITED BY SIZE                   06530077
                    , SD-SYSTEM-YEAR DELIMITED BY SIZE                  06540077
                    , ' ' DELIMITED BY SIZE                             06550077
                     INTO H2A-FISCAL-MONTH.                             06560077
      *                                                                 06570077
      ******************************************************************06580077
      * PROCESS DEBIT ALLOWANCE AVAIL FUNDING RECORDS                  *06590077
      ******************************************************************06600077
       2000-DA-AVL-FUND-RPT.                                            06610077
           PERFORM 2010-PROCESS-DMM-BUYER-VENDOR                        06620077
             UNTIL DA110-DMM-NBR      NOT = PV-PREV-DMM-NBR             06630077
                   OR DA110-BUYER-NBR NOT = PV-PREV-BUYER-NBR           06640077
                   OR DA110-VENDOR-NM NOT = PV-PREV-VENDOR-NAME         06650077
                   OR PS-END-OF-DRIVER-FILE.                            06660077
           PERFORM 3100-PRINT-TOTALS.                                   06670077
           IF PS-END-OF-DRIVER-FILE                                     06680077
      * IF THE THERE ARE NO MORE INPUT RECORDS AND THE LAST PAGE PRINTED06690077
      * WAS ODD THEN, AN 'INTENTIONAL' BLANK PAGE NEEDS TO BE PRINTED.  06700077
             MOVE PV-PAGE-CNT TO PV-PAGE-DISSECT                        06710077
             IF PV-ODD                                                  06720077
               PERFORM 6010-PRINT-PREV-HEADINGS                         06730077
               MOVE 'ALL'           TO H5A-DEPT-NBR-X                   06740077
               MOVE SPACE           TO H5A-DEPT-DESC                    06750077
                                       H5A-DEPT-SLASH                   06760077
               MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE                06770077
               WRITE DA-OFF-INVC-LINE                                   06780077
               MOVE SPACE         TO DA-OFF-INVC-LINE                   06790077
               WRITE DA-OFF-INVC-LINE                                   06800077
               MOVE EP-EMPTY-PAGE TO DA-OFF-INVC-LINE                   06810077
               WRITE DA-OFF-INVC-LINE                                   06820077
             END-IF                                                     06830077
           ELSE                                                         06840077
      * ZERO TOTAL FIELDS TO PROCESS THE NEXT DMM/BUYER/VENDOR COMBO    06850077
             PERFORM 5999-SKIP-PAGE-LOGIC                               06860077
             MOVE 0 TO PV-ENDING-BALANCE                                06870077
                       PV-TOT-NON-OFF-INVC-DEBITS                       06880077
                       PV-TOT-OFF-INVC-DEBITS                           06890077
                       PV-TOT-MRKDN-CST                                 06900077
                       PV-TOT-MRKDN                                     06910077
                       PV-TOT-COOP                                      06920077
                       PV-TOT-PROF-CST-RTL                              06930077
                       PV-TOT-PROF-CST                                  06940077
                       PV-X-TOT-AVAIL                                   06950077
                       PV-X-ENDING-BALANCE                              06960077
                       PV-X-DOLLARS-ADDED                               06970077
                       PV-X-OPENING-BALANCE                             06980077
                       PV-X-TOT-NON-OFF-INVC-DEBITS                     06990077
                       PV-X-TOT-OFF-INVC-DEBITS                         07000077
                       PV-X-TOT-MRKDN-CST                               07010077
                       PV-X-TOT-MRKDN                                   07020077
                       PV-X-TOT-COOP                                    07030077
                       PV-X-TOT-PROF-CST-RTL                            07040077
                       PV-X-TOT-PROF-CST                                07050077
                       PV-DPT-TOT-MRKDN-CST                             07060077
                       PV-DPT-TOT-MRKDN                                 07070077
                       PV-DPT-TOT-COOP                                  07080077
                       PV-DPT-TOT-PROF-CST-RTL                          07090077
                       PV-DPT-TOT-PROF-CST                              07100077
             MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                07110077
             MOVE DA110-FSCL-YR-NBR           TO                        07120077
                   ADJRNL-PSTG-FYR-NBR                                  07130077
             MOVE DA110-FSCL-MN-NBR           TO                        07140077
                  ADJRNL-PSTG-FMN-NBR                                   07150077
             MOVE DA110-DMM-NBR   TO PV-PREV-DMM-NBR                    07160077
             MOVE DA110-BUYER-NBR TO PV-PREV-BUYER-NBR                  07170077
             MOVE DA110-VENDOR-NM TO PV-PREV-VENDOR-NAME                07180077
             MOVE DA110-DEPT-NBR  TO PV-PREV-DEPT-NBR                   07190077
           END-IF.                                                      07200077
      ******************************************************************07210077
      * PROCESS DMM/BUYER/VENDOR HEADINGS/TOTALS                        07220077
      ******************************************************************07230077
       2010-PROCESS-DMM-BUYER-VENDOR.                                   07240088
           MOVE DA110-RMNG-AVL-COST-AMT-TOT TO PV-ENDING-BALANCE.       07261091
           COMPUTE PV-X-ENDING-BALANCE = PV-X-ENDING-BALANCE +          07270077
             PV-ENDING-BALANCE.                                         07280089
           PERFORM 2020-PROCESS-DEPT                                    07290077
             UNTIL DA110-DMM-NBR      NOT = PV-PREV-DMM-NBR             07300077
                   OR DA110-BUYER-NBR NOT = PV-PREV-BUYER-NBR           07310077
                   OR DA110-VENDOR-NM NOT = PV-PREV-VENDOR-NAME         07320077
                   OR DA110-DEPT-NBR  NOT = PV-PREV-DEPT-NBR            07330077
                   OR PS-END-OF-DRIVER-FILE.                            07340077
           PERFORM 3150-PRINT-DEPT-TOTALS.                              07350077
           MOVE DA110-DEPT-NBR  TO PV-PREV-DEPT-NBR.                    07360077
           MOVE 0 TO PV-ENDING-BALANCE                                  07370077
                     PV-TOT-NON-OFF-INVC-DEBITS                         07380077
                     PV-TOT-OFF-INVC-DEBITS                             07390077
                     PV-TOT-MRKDN-CST                                   07400077
                     PV-TOT-MRKDN                                       07410077
                     PV-TOT-COOP                                        07420077
                     PV-TOT-PROF-CST-RTL                                07430077
                     PV-TOT-PROF-CST                                    07440077
                     PV-DPT-TOT-MRKDN-CST                               07450077
                     PV-DPT-TOT-MRKDN                                   07460077
                     PV-DPT-TOT-COOP                                    07470077
                     PV-DPT-TOT-PROF-CST-RTL                            07480077
                     PV-DPT-TOT-PROF-CST.                               07490077
      * THIS WILL PRINT EITHER THE HEADERS FOR A NEW DEPT OR THE        07500077
      * HEADERS USING THE PREVIOUS HEADER DATA AS NEEDED WHEN THE       07510077
      * DMM/BUYER/VENDOR TOTALS ARE PRINTED.                            07520077
           IF DA110-DMM-NBR      NOT = PV-PREV-DMM-NBR                  07530077
              OR DA110-BUYER-NBR NOT = PV-PREV-BUYER-NBR                07540077
              OR DA110-VENDOR-NM NOT = PV-PREV-VENDOR-NAME              07550077
              OR PS-END-OF-DRIVER-FILE                                  07560077
             PERFORM 6010-PRINT-PREV-HEADINGS                           07570077
             MOVE 'ALL'           TO H5A-DEPT-NBR-X                     07580077
             MOVE SPACE           TO H5A-DEPT-DESC                      07590077
                                     H5A-DEPT-SLASH                     07600077
             MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE                  07610077
             WRITE DA-OFF-INVC-LINE                                     07620077
           ELSE                                                         07630077
             PERFORM 6000-PRINT-HEADINGS                                07640077
           END-IF.                                                      07650077
      ******************************************************************07660077
      * PROCESS DEPT                                                    07670077
      ******************************************************************07680077
        2020-PROCESS-DEPT.                                              07690077
           MOVE DA110-DEPT-NBR  TO H5A-DEPT-NBR                         07700077
                                   PV-CALL-DEPT.                        07710077
           PERFORM 7300-SELECT-DEPT-NAME.                               07720077
           MOVE ' - '           TO H5A-DEPT-SLASH.                      07730077
           MOVE MDSEAR-DESC     TO H5A-DEPT-DESC.                       07740077
           MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE.                   07750077
           WRITE DA-OFF-INVC-LINE.                                      07760077
           MOVE SPACE            TO DA-OFF-INVC-LINE.                   07770077
           WRITE DA-OFF-INVC-LINE.                                      07780077
           MOVE SPACE            TO DA-OFF-INVC-LINE.                   07790077
           WRITE DA-OFF-INVC-LINE.                                      07800077
           MOVE SPACE            TO DA-OFF-INVC-LINE.                   07810077
           WRITE DA-OFF-INVC-LINE.                                      07820077
           MOVE H6-HEADING-LINE TO DA-OFF-INVC-LINE.                    07830077
           WRITE DA-OFF-INVC-LINE.                                      07840077
           MOVE H7-HEADING-LINE TO DA-OFF-INVC-LINE.                    07850077
           WRITE DA-OFF-INVC-LINE.                                      07860077
           MOVE H8-HEADING-LINE TO DA-OFF-INVC-LINE.                    07870077
           WRITE DA-OFF-INVC-LINE.                                      07880077
           MOVE H9-HEADING-LINE TO DA-OFF-INVC-LINE.                    07890077
           WRITE DA-OFF-INVC-LINE.                                      07900077
           MOVE H10-HEADING-LINE TO DA-OFF-INVC-LINE.                   07910077
           WRITE DA-OFF-INVC-LINE.                                      07920077
           MOVE DA110-DEPT-NBR  TO H5A-DEPT-NBR.                        07930077
           MOVE SPACE            TO DA-OFF-INVC-LINE.                   07940077
           WRITE DA-OFF-INVC-LINE.                                      07950077
           IF DA110-CDE-DESC NOT = 'NO DEBIT ALLOWANCES'                07960077
             MOVE H11-HEADING-LINE TO DA-OFF-INVC-LINE                  07970077
             WRITE DA-OFF-INVC-LINE.                                    07980077
           MOVE SPACE TO H12-DA-CDE-DESC.                               07990077
           MOVE DA110-CDE-DESC TO H12-DA-CDE-DESC.                      08000077
           MOVE H12-HEADING-LINE TO DA-OFF-INVC-LINE.                   08010077
           WRITE DA-OFF-INVC-LINE.                                      08020077
           COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 13.          08030077
           PERFORM 2030-PROCESS-DETAILS                                 08040077
             UNTIL DA110-DEPT-NBR  NOT = PV-PREV-DEPT-NBR               08050077
                OR DA110-DMM-NBR   NOT = PV-PREV-DMM-NBR                08060077
                OR DA110-BUYER-NBR NOT = PV-PREV-BUYER-NBR              08070077
                OR DA110-VENDOR-NM NOT = PV-PREV-VENDOR-NAME            08080077
                OR PS-END-OF-DRIVER-FILE.                               08090077
           MOVE PV-DPT-OFF-INVC     TO ST03-DPT-OFF-INVC.               08100077
           MOVE PV-DPT-NON-OFF-INVC TO ST03-DPT-NON-OFF-INVC.           08110077
           MOVE PV-PREV-DEPT-NBR    TO ST03-DEPT-NBR.                   08120077
           ADD 1 TO PV-NBR-OF-DA-OFF-INVC.                              08130077
           IF PS-NOT-END-OF-DRIVER-FILE                                 08140077
             MOVE 0                   TO PV-DPT-OFF-INVC                08150077
                                         PV-DPT-NON-OFF-INVC            08160077
                                         PV-DPT-TOT-MRKDN-CST           08170077
                                         PV-DPT-TOT-MRKDN               08180077
                                         PV-DPT-TOT-COOP                08190077
                                         PV-DPT-TOT-PROF-CST-RTL        08200077
                                         PV-DPT-TOT-PROF-CST            08210077
           END-IF.                                                      08220077
                                                                        08230077
      ******************************************************************08240077
      * PROCESS DA DETAILS, SUBTOTALS DATA AND TOTALS                   08250077
      ******************************************************************08260077
       2030-PROCESS-DETAILS.                                            08270077
           IF DA110-MKDN-ALLWNCE                                        08280077
             OR DA110-MKDN-ALLWNCE-CST-ONLY                             08290077
             COMPUTE PV-TOT-NON-OFF-INVC-DEBITS =                       08300077
                     PV-TOT-NON-OFF-INVC-DEBITS + DA110-NET-CST-AMT     08310077
             COMPUTE PV-DPT-NON-OFF-INVC        =                       08320077
                     PV-DPT-NON-OFF-INVC        + DA110-NET-CST-AMT     08330077
           ELSE                                                         08340077
             COMPUTE PV-TOT-OFF-INVC-DEBITS =                           08350077
                     PV-TOT-OFF-INVC-DEBITS + DA110-NET-CST-AMT         08360077
             COMPUTE PV-DPT-OFF-INVC        =                           08370077
                     PV-DPT-OFF-INVC        + DA110-NET-CST-AMT.        08380077
           IF  PV-LN-CNT-FOR-TOT > PC-MAX-PAGE-LINES                    08390077
               PERFORM 6000-PRINT-HEADINGS                              08400077
           END-IF.                                                      08410077
           IF DA110-MKDN-PROF-ASST-CST                                  08420077
              ADD DA110-NET-CST-AMT TO PV-TOT-PROF-CST                  08430077
                                       PV-DPT-TOT-PROF-CST              08440077
           ELSE                                                         08450077
           IF DA110-MKDN-PROF-ASST-CST-RTL                              08460077
              ADD DA110-NET-CST-AMT TO PV-TOT-PROF-CST-RTL              08470077
                                       PV-DPT-TOT-PROF-CST-RTL          08480077
           ELSE                                                         08490077
           IF DA110-AD-COOP                                             08500077
              ADD DA110-NET-CST-AMT TO PV-TOT-COOP                      08510077
                                       PV-DPT-TOT-COOP                  08520077
           ELSE                                                         08530077
           IF DA110-MKDN-ALLWNCE                                        08540077
              ADD DA110-NET-CST-AMT TO PV-TOT-MRKDN                     08550077
                                       PV-DPT-TOT-MRKDN                 08560077
           ELSE                                                         08570077
           IF DA110-MKDN-ALLWNCE-CST-ONLY                               08580077
              ADD DA110-NET-CST-AMT TO PV-TOT-MRKDN-CST                 08590077
                                       PV-DPT-TOT-MRKDN-CST.            08600077
      *                                                                 08610077
      * FORMAT DETAIL RECORD BY DA TYPE                                 08620077
           IF DA110-NO-DEBIT-ALLOWANCE                                  08630077
             CONTINUE                                                   08640077
           ELSE                                                         08650077
           IF DA110-MKDN-ALLWNCE           OR                           08660077
              DA110-MKDN-ALLWNCE-CST-ONLY                               08670077
             PERFORM 3000-CHECK-FOR-TOP                                 08680077
             MOVE DA110-DR-ALW-NBR          TO DL2-DA-ALW-NBR           08690077
             MOVE DA110-CPLT-DTE            TO DL2-DA-ALW-CPT-DT        08700077
             MOVE DA110-NET-CST-AMT         TO DL2-CST-AMT              08710077
             MOVE DL2-LINE                  TO DA-OFF-INVC-LINE         08720077
             WRITE DA-OFF-INVC-LINE                                     08730077
           ELSE                                                         08740077
             PERFORM 3000-CHECK-FOR-TOP                                 08750077
             MOVE DA110-DR-ALW-NBR          TO DL1-DA-ALW-NBR           08760077
             MOVE DA110-CPLT-DTE            TO DL1-DA-ALW-CPT-DT        08770077
             MOVE DA110-NET-CST-AMT         TO DL1-CST-AMT              08780077
             MOVE DL1-LINE                  TO DA-OFF-INVC-LINE         08790077
             WRITE DA-OFF-INVC-LINE.                                    08800077
      *                                                                 08810077
            READ DRIVER-FILE INTO DA110-AVL-VND-FUND-DET-REC            08820077
              AT END                                                    08830077
                SET PS-END-OF-DRIVER-FILE TO TRUE.                      08840077
      * CHECK TO SEE IF DEBIT TYPE SUB TOTAL NEEDS TO BE WRITTEN        08850077
            PERFORM 3200-CHECK-FOR-DEBIT-TYP-CHG.                       08860077
                                                                        08870077
      ******************************************************************08880077
      * CHECK TO SEE IF PAGE IS FULL AND PAGE BREAK IS NEEDED          *08890077
      ******************************************************************08900077
       3000-CHECK-FOR-TOP.                                              08910077
           COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 1            08920077
           IF  PV-LN-CNT-FOR-TOT > PC-MAX-PAGE-LINES                    08930077
               PERFORM 6000-PRINT-HEADINGS                              08940077
           END-IF.                                                      08950077
      *                                                                 08960077
      ******************************************************************08970077
      * PRINT THE TOTALS FOR DMM/BUYER/VENDOR                          *08980077
      ******************************************************************08990077
       3100-PRINT-TOTALS.                                               09000077
           MOVE PV-X-TOT-AVAIL     TO H10-TOTAL-AVAIL.                  09010077
           MOVE PV-X-DOLLARS-ADDED TO H9-DOLLARS-ADDED.                 09020077
           MOVE PV-X-OPENING-BALANCE TO H8-OPENING-BALANCE.             09030077
           MOVE H6-HEADING-LINE TO DA-OFF-INVC-LINE.                    09040077
           WRITE DA-OFF-INVC-LINE.                                      09050077
           MOVE H7-HEADING-LINE TO DA-OFF-INVC-LINE.                    09060077
           WRITE DA-OFF-INVC-LINE.                                      09070077
           MOVE H8-HEADING-LINE TO DA-OFF-INVC-LINE.                    09080077
           WRITE DA-OFF-INVC-LINE.                                      09090077
           MOVE H9-HEADING-LINE TO DA-OFF-INVC-LINE.                    09100077
           WRITE DA-OFF-INVC-LINE.                                      09110077
           MOVE H10-HEADING-LINE TO DA-OFF-INVC-LINE.                   09120077
           WRITE DA-OFF-INVC-LINE.                                      09130077
           MOVE PV-X-TOT-PROF-CST     TO T10-PROF-CST.                  09140077
           MOVE PV-X-TOT-PROF-CST-RTL TO T20-PROF-CST-RTL.              09150077
           MOVE PV-X-TOT-COOP         TO T30-COOP.                      09160077
           MOVE PV-X-TOT-MRKDN        TO T40-MRKDN.                     09170077
           MOVE PV-X-TOT-MRKDN-CST    TO T50-MRKDN-CST.                 09180077
           MOVE PV-X-TOT-OFF-INVC-DEBITS TO T06-OFF-INVC-DEBITS.        09190077
           MOVE PV-X-TOT-NON-OFF-INVC-DEBITS TO                         09200077
                T06A-NON-OFF-INVC-DEBITS.                               09210077
           MOVE PV-X-ENDING-BALANCE   TO T07-ENDING-BALANCE.            09220077
           IF  PV-LN-CNT-FOR-TOT < PC-MAX-PAGE-LINES - 11               09230077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09240077
             WRITE DA-OFF-INVC-LINE                                     09250077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09260077
             WRITE DA-OFF-INVC-LINE                                     09270077
             IF PV-X-TOT-COOP > 0                                       09280077
               MOVE T30-HEADING-LINE TO DA-OFF-INVC-LINE                09290077
               WRITE DA-OFF-INVC-LINE                                   09300077
             END-IF                                                     09310077
             IF PV-X-TOT-PROF-CST > 0                                   09320077
               MOVE T10-HEADING-LINE TO DA-OFF-INVC-LINE                09330077
               WRITE DA-OFF-INVC-LINE                                   09340077
             END-IF                                                     09350077
             IF PV-X-TOT-PROF-CST-RTL > 0                               09360077
               MOVE T20-HEADING-LINE TO DA-OFF-INVC-LINE                09370077
               WRITE DA-OFF-INVC-LINE                                   09380077
             END-IF                                                     09390077
             IF PV-X-TOT-MRKDN > 0                                      09400077
               MOVE T40-HEADING-LINE TO DA-OFF-INVC-LINE                09410077
               WRITE DA-OFF-INVC-LINE                                   09420077
             END-IF                                                     09430077
             IF PV-X-TOT-MRKDN-CST > 0                                  09440077
               MOVE T50-HEADING-LINE TO DA-OFF-INVC-LINE                09450077
               WRITE DA-OFF-INVC-LINE                                   09460077
             END-IF                                                     09470077
             MOVE T06-HEADING-LINE TO DA-OFF-INVC-LINE                  09480077
             WRITE DA-OFF-INVC-LINE                                     09490077
             MOVE T06A-HEADING-LINE TO DA-OFF-INVC-LINE                 09500077
             WRITE DA-OFF-INVC-LINE                                     09510077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09520077
             WRITE DA-OFF-INVC-LINE                                     09530077
             MOVE T07-HEADING-LINE TO DA-OFF-INVC-LINE                  09540077
             WRITE DA-OFF-INVC-LINE                                     09550077
           ELSE                                                         09560077
             PERFORM 6010-PRINT-PREV-HEADINGS                           09570077
             MOVE 'ALL'           TO H5A-DEPT-NBR-X                     09580077
             MOVE SPACE           TO H5A-DEPT-DESC                      09590077
                                     H5A-DEPT-SLASH                     09600077
             MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE                  09610077
             WRITE DA-OFF-INVC-LINE                                     09620077
             MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE                  09630077
             WRITE DA-OFF-INVC-LINE                                     09640077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09650077
             WRITE DA-OFF-INVC-LINE                                     09660077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09670077
             WRITE DA-OFF-INVC-LINE                                     09680077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09690077
             WRITE DA-OFF-INVC-LINE                                     09700077
             MOVE H6-HEADING-LINE TO DA-OFF-INVC-LINE                   09710077
             WRITE DA-OFF-INVC-LINE                                     09720077
             MOVE H7-HEADING-LINE TO DA-OFF-INVC-LINE                   09730077
             WRITE DA-OFF-INVC-LINE                                     09740077
             MOVE H8-HEADING-LINE TO DA-OFF-INVC-LINE                   09750077
             WRITE DA-OFF-INVC-LINE                                     09760077
             MOVE H9-HEADING-LINE TO DA-OFF-INVC-LINE                   09770077
             WRITE DA-OFF-INVC-LINE                                     09780077
             MOVE H10-HEADING-LINE TO DA-OFF-INVC-LINE                  09790077
             WRITE DA-OFF-INVC-LINE                                     09800077
             MOVE DA110-DEPT-NBR  TO H5A-DEPT-NBR                       09810077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  09820077
             WRITE DA-OFF-INVC-LINE                                     09830077
             COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 13         09840077
             IF PV-TOT-COOP > 0                                         09850077
               MOVE T30-HEADING-LINE TO DA-OFF-INVC-LINE                09860077
               WRITE DA-OFF-INVC-LINE                                   09870077
             END-IF                                                     09880077
             IF PV-TOT-PROF-CST > 0                                     09890077
               MOVE T10-HEADING-LINE TO DA-OFF-INVC-LINE                09900077
               WRITE DA-OFF-INVC-LINE                                   09910077
             END-IF                                                     09920077
             IF PV-TOT-PROF-CST-RTL > 0                                 09930077
               MOVE T20-HEADING-LINE TO DA-OFF-INVC-LINE                09940077
               WRITE DA-OFF-INVC-LINE                                   09950077
             END-IF                                                     09960077
             IF PV-TOT-MRKDN-CST > 0                                    09970077
               MOVE T40-HEADING-LINE TO DA-OFF-INVC-LINE                09980077
               WRITE DA-OFF-INVC-LINE                                   09990077
             END-IF                                                     10000077
             IF PV-TOT-MRKDN > 0                                        10010077
               MOVE T50-HEADING-LINE TO DA-OFF-INVC-LINE                10020077
               WRITE DA-OFF-INVC-LINE                                   10030077
             END-IF                                                     10040077
             MOVE T06-HEADING-LINE TO DA-OFF-INVC-LINE                  10050077
             WRITE DA-OFF-INVC-LINE                                     10060077
             MOVE T06A-HEADING-LINE TO DA-OFF-INVC-LINE                 10070077
             WRITE DA-OFF-INVC-LINE                                     10080077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10090077
             WRITE DA-OFF-INVC-LINE                                     10100077
             MOVE T07-HEADING-LINE TO DA-OFF-INVC-LINE                  10110077
             WRITE DA-OFF-INVC-LINE.                                    10120077
                                                                        10130077
      ******************************************************************10140077
      * PRINT THE DEPT TOTALS                                          *10150077
      ******************************************************************10160077
       3150-PRINT-DEPT-TOTALS.                                          10170077
           MOVE PV-TOT-PROF-CST     TO T10-PROF-CST.                    10180077
           COMPUTE PV-X-TOT-PROF-CST = PV-X-TOT-PROF-CST +              10190077
               PV-TOT-PROF-CST.                                         10200077
           MOVE PV-TOT-PROF-CST-RTL TO T20-PROF-CST-RTL.                10210077
           COMPUTE PV-X-TOT-PROF-CST-RTL = PV-X-TOT-PROF-CST-RTL +      10220077
               PV-TOT-PROF-CST-RTL.                                     10230077
           MOVE PV-TOT-COOP         TO T30-COOP.                        10240077
           COMPUTE PV-X-TOT-COOP = PV-X-TOT-COOP + PV-TOT-COOP.         10250077
           MOVE PV-TOT-MRKDN        TO T40-MRKDN.                       10260077
           COMPUTE PV-X-TOT-MRKDN = PV-X-TOT-MRKDN + PV-TOT-MRKDN.      10270077
           MOVE PV-TOT-MRKDN-CST    TO T50-MRKDN-CST.                   10280077
           COMPUTE PV-X-TOT-MRKDN-CST = PV-X-TOT-MRKDN-CST +            10290077
               PV-TOT-MRKDN-CST.                                        10300077
           MOVE PV-TOT-OFF-INVC-DEBITS TO T06-OFF-INVC-DEBITS.          10310077
           COMPUTE PV-X-TOT-AVAIL = PV-X-TOT-AVAIL + PV-TOT-AVAIL.      10320077
           COMPUTE PV-X-OPENING-BALANCE = PV-X-OPENING-BALANCE +        10330077
                   PV-OPENING-BALANCE.                                  10340077
           COMPUTE PV-X-DOLLARS-ADDED = PV-X-DOLLARS-ADDED +            10350077
                   PV-DOLLARS-ADDED.                                    10360077
           COMPUTE PV-X-TOT-OFF-INVC-DEBITS = PV-X-TOT-OFF-INVC-DEBITS +10370077
               PV-TOT-OFF-INVC-DEBITS.                                  10380077
           MOVE PV-TOT-NON-OFF-INVC-DEBITS TO T06A-NON-OFF-INVC-DEBITS. 10390077
           COMPUTE PV-X-TOT-NON-OFF-INVC-DEBITS =                       10400077
             PV-X-TOT-NON-OFF-INVC-DEBITS + PV-TOT-NON-OFF-INVC-DEBITS. 10410077
           MOVE PV-ENDING-BALANCE   TO T07-ENDING-BALANCE.              10420077
      * IF THERE MORE THAN 11 LINES LEFT ON A PAGE, THERE IS ROOM TO    10430077
      * PRINT THE DEPT TOTALS. OTHERWISE BREAK TO NEW PAGE AND PRINT.   10440077
           IF  PV-LN-CNT-FOR-TOT < PC-MAX-PAGE-LINES - 11               10450077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10460077
             WRITE DA-OFF-INVC-LINE                                     10470077
             IF PV-TOT-COOP > 0                                         10480077
               MOVE T30-HEADING-LINE TO DA-OFF-INVC-LINE                10490077
               WRITE DA-OFF-INVC-LINE                                   10500077
             END-IF                                                     10510077
             IF PV-TOT-PROF-CST > 0                                     10520077
               MOVE T10-HEADING-LINE TO DA-OFF-INVC-LINE                10530077
               WRITE DA-OFF-INVC-LINE                                   10540077
             END-IF                                                     10550077
             IF PV-TOT-PROF-CST-RTL > 0                                 10560077
               MOVE T20-HEADING-LINE TO DA-OFF-INVC-LINE                10570077
               WRITE DA-OFF-INVC-LINE                                   10580077
             END-IF                                                     10590077
             IF PV-TOT-MRKDN > 0                                        10600077
               MOVE T40-HEADING-LINE TO DA-OFF-INVC-LINE                10610077
               WRITE DA-OFF-INVC-LINE                                   10620077
             END-IF                                                     10630077
             IF PV-TOT-MRKDN-CST > 0                                    10640077
               MOVE T50-HEADING-LINE TO DA-OFF-INVC-LINE                10650077
               WRITE DA-OFF-INVC-LINE                                   10660077
             END-IF                                                     10670077
             MOVE T06-HEADING-LINE TO DA-OFF-INVC-LINE                  10680077
             WRITE DA-OFF-INVC-LINE                                     10690077
             MOVE T06A-HEADING-LINE TO DA-OFF-INVC-LINE                 10700077
             WRITE DA-OFF-INVC-LINE                                     10710077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10720077
             WRITE DA-OFF-INVC-LINE                                     10730077
             MOVE T07-HEADING-LINE TO DA-OFF-INVC-LINE                  10740077
             WRITE DA-OFF-INVC-LINE                                     10750077
           ELSE                                                         10760077
             PERFORM 6010-PRINT-PREV-HEADINGS                           10770077
             MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE                  10780077
             WRITE DA-OFF-INVC-LINE                                     10790077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10800077
             WRITE DA-OFF-INVC-LINE                                     10810077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10820077
             WRITE DA-OFF-INVC-LINE                                     10830077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10840077
             WRITE DA-OFF-INVC-LINE                                     10850077
             MOVE H6-HEADING-LINE TO DA-OFF-INVC-LINE                   10860077
             WRITE DA-OFF-INVC-LINE                                     10870077
             MOVE H7-HEADING-LINE TO DA-OFF-INVC-LINE                   10880077
             WRITE DA-OFF-INVC-LINE                                     10890077
             MOVE H8-HEADING-LINE TO DA-OFF-INVC-LINE                   10900077
             WRITE DA-OFF-INVC-LINE                                     10910077
             MOVE H9-HEADING-LINE TO DA-OFF-INVC-LINE                   10920077
             WRITE DA-OFF-INVC-LINE                                     10930077
             MOVE H10-HEADING-LINE TO DA-OFF-INVC-LINE                  10940077
             WRITE DA-OFF-INVC-LINE                                     10950077
             MOVE DA110-DEPT-NBR  TO H5A-DEPT-NBR                       10960077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10970077
             WRITE DA-OFF-INVC-LINE                                     10980077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  10990077
             WRITE DA-OFF-INVC-LINE                                     11000077
             COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 14         11010077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  11020077
             WRITE DA-OFF-INVC-LINE                                     11030077
             IF PV-TOT-COOP > 0                                         11040077
               MOVE T30-HEADING-LINE TO DA-OFF-INVC-LINE                11050077
               WRITE DA-OFF-INVC-LINE                                   11060077
             END-IF                                                     11070077
             IF PV-TOT-PROF-CST > 0                                     11080077
               MOVE T10-HEADING-LINE TO DA-OFF-INVC-LINE                11090077
               WRITE DA-OFF-INVC-LINE                                   11100077
             END-IF                                                     11110077
             IF PV-TOT-PROF-CST-RTL > 0                                 11120077
               MOVE T20-HEADING-LINE TO DA-OFF-INVC-LINE                11130077
               WRITE DA-OFF-INVC-LINE                                   11140077
             END-IF                                                     11150077
             IF PV-TOT-MRKDN-CST > 0                                    11160077
               MOVE T40-HEADING-LINE TO DA-OFF-INVC-LINE                11170077
               WRITE DA-OFF-INVC-LINE                                   11180077
             END-IF                                                     11190077
             IF PV-TOT-MRKDN > 0                                        11200077
               MOVE T50-HEADING-LINE TO DA-OFF-INVC-LINE                11210077
               WRITE DA-OFF-INVC-LINE                                   11220077
             END-IF                                                     11230077
             MOVE T06-HEADING-LINE TO DA-OFF-INVC-LINE                  11240077
             WRITE DA-OFF-INVC-LINE                                     11250077
             MOVE T06A-HEADING-LINE TO DA-OFF-INVC-LINE                 11260077
             WRITE DA-OFF-INVC-LINE                                     11270077
             MOVE SPACE            TO DA-OFF-INVC-LINE                  11280077
             WRITE DA-OFF-INVC-LINE                                     11290077
             MOVE T07-HEADING-LINE TO DA-OFF-INVC-LINE                  11300077
             WRITE DA-OFF-INVC-LINE.                                    11310077
                                                                        11320077
      ******************************************************************11330077
      * CHECK FOR MID PAGE BREAK IS NEEDED BECAUSE DA TYPE CHANGED     *11340077
      ******************************************************************11350077
       3200-CHECK-FOR-DEBIT-TYP-CHG.                                    11360077
      * THE DA TYPE SUB-TOTAL NEEDS TO PRINTED WHEN THE TYPE CD OR      11370077
      * DEPARTMENT CHANGES OR WHEN A PAGE BREAK OCCURS BECAUSE A        11380077
      * CHANGE OF DMM/BUYER/VENDOR IS ENCOUNTERED OR END OF FILE.       11390077
            IF DA110-CDE-DESC    NOT = PV-PREV-CDE-DESC                 11400077
              OR DA110-DEPT-NBR  NOT = PV-PREV-DEPT-NBR                 11410077
              OR DA110-DMM-NBR   NOT = PV-PREV-DMM-NBR                  11420077
              OR DA110-BUYER-NBR NOT = PV-PREV-BUYER-NBR                11430077
              OR DA110-VENDOR-NM NOT = PV-PREV-VENDOR-NAME              11440077
              OR PS-PRINT-DET-TOTS                                      11450077
              OR PS-END-OF-DRIVER-FILE                                  11460077
      * CHECK FOR DA TYPE TO GET CORRECT LINE FORMAT.                   11470077
              IF PV-NO-DEBIT-ALLOWANCES                                 11480077
                CONTINUE                                                11490077
              ELSE                                                      11500077
              IF PV-MKDN-ALLWNCE-CST-ONLY                               11510077
                MOVE SPACE TO ST02-DEBIT-TYPE                           11520077
                MOVE PV-DPT-TOT-MRKDN-CST TO ST02-SUB-TOTAL             11530077
                MOVE PV-PREV-CDE-DESC TO ST02-DEBIT-TYPE                11540077
                MOVE ST2-HEADING-LINE TO DA-OFF-INVC-LINE               11550077
                WRITE DA-OFF-INVC-LINE                                  11560077
                MOVE SPACE TO DA-OFF-INVC-LINE                          11570077
                WRITE DA-OFF-INVC-LINE                                  11580077
                COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 2       11590077
              ELSE                                                      11600077
              IF PV-MKDN-ALLWNCE                                        11610077
                MOVE SPACE TO ST02-DEBIT-TYPE                           11620077
                MOVE PV-TOT-MRKDN TO ST02-SUB-TOTAL                     11630077
                MOVE PV-PREV-CDE-DESC TO ST02-DEBIT-TYPE                11640077
                MOVE PV-DPT-TOT-MRKDN TO ST02-SUB-TOTAL                 11650077
                MOVE ST2-HEADING-LINE TO DA-OFF-INVC-LINE               11660077
                WRITE DA-OFF-INVC-LINE                                  11670077
                MOVE SPACE TO DA-OFF-INVC-LINE                          11680077
                WRITE DA-OFF-INVC-LINE                                  11690077
                COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 2       11700077
              ELSE                                                      11710077
              IF PV-AD-COOP                                             11720077
                MOVE SPACE TO ST01-DEBIT-TYPE                           11730077
                MOVE PV-PREV-CDE-DESC TO ST01-DEBIT-TYPE                11740077
                MOVE PV-DPT-TOT-COOP  TO ST01-SUB-TOTAL                 11750077
                MOVE ST1-HEADING-LINE TO DA-OFF-INVC-LINE               11760077
                WRITE DA-OFF-INVC-LINE                                  11770077
                MOVE SPACE TO DA-OFF-INVC-LINE                          11780077
                WRITE DA-OFF-INVC-LINE                                  11790077
                COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 2       11800077
              ELSE                                                      11810077
              IF PV-MKDN-PROF-ASST-CST-RTL                              11820077
                MOVE SPACE TO ST01-DEBIT-TYPE                           11830077
                MOVE PV-PREV-CDE-DESC TO ST01-DEBIT-TYPE                11840077
                MOVE PV-DPT-TOT-PROF-CST-RTL TO ST01-SUB-TOTAL          11850077
                MOVE ST1-HEADING-LINE TO DA-OFF-INVC-LINE               11860077
                WRITE DA-OFF-INVC-LINE                                  11870077
                MOVE SPACE TO DA-OFF-INVC-LINE                          11880077
                WRITE DA-OFF-INVC-LINE                                  11890077
                COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 2       11900077
              ELSE                                                      11910077
              IF PV-MKDN-PROF-ASST-CST                                  11920077
                MOVE SPACE TO ST01-DEBIT-TYPE                           11930077
                MOVE PV-PREV-CDE-DESC TO ST01-DEBIT-TYPE                11940077
                MOVE PV-DPT-TOT-PROF-CST TO ST01-SUB-TOTAL              11950077
                MOVE ST1-HEADING-LINE TO DA-OFF-INVC-LINE               11960077
                WRITE DA-OFF-INVC-LINE                                  11970077
                MOVE SPACE TO DA-OFF-INVC-LINE                          11980077
                WRITE DA-OFF-INVC-LINE                                  11990077
                COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 2       12000077
              END-IF                                                    12010077
              END-IF                                                    12020077
              END-IF                                                    12030077
              END-IF                                                    12040077
              END-IF                                                    12050077
                MOVE SPACE TO H12-DA-CDE-DESC                           12060077
      * HEADING 12 WILL BE PRINTED AS PART OF THE DMM/BUYER/VENDOR BREAK12070077
      * ROUTINE AND WILL ONLY TO BE PRINTED HERE IF A NEW PAGE IS       12080077
      * NEEDED BECAUSE THE LAST ONE IS FULL.                            12090077
              IF NOT PS-PRINT-DET-TOTS                                  12100077
                AND NOT PS-END-OF-DRIVER-FILE                           12110077
                AND DA110-DEPT-NBR   = PV-PREV-DEPT-NBR                 12120077
                AND DA110-DMM-NBR    = PV-PREV-DMM-NBR                  12130077
                AND DA110-BUYER-NBR  = PV-PREV-BUYER-NBR                12140077
                AND DA110-VENDOR-NM  = PV-PREV-VENDOR-NAME              12150077
      * IF THE CURRENT PAGE IS TOO FULL, THEN THERE WON'T BE ENOUGH ROOM12160077
      * TO PRINT THE DA DETAIL HEADINGS AND DETAIL LINE, SO, A NEW PAGE 12170077
      * BREAK IS PERFORMED.                                             12180077
                IF  PV-LN-CNT-FOR-TOT NOT < PC-MAX-PAGE-LINES - 3       12190077
                  PERFORM 6010-PRINT-PREV-HEADINGS                      12200077
                  MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE             12210077
                  WRITE DA-OFF-INVC-LINE                                12220077
                  MOVE SPACE            TO DA-OFF-INVC-LINE             12230077
                  WRITE DA-OFF-INVC-LINE                                12240077
                  MOVE SPACE            TO DA-OFF-INVC-LINE             12250077
                  WRITE DA-OFF-INVC-LINE                                12260077
                  MOVE SPACE            TO DA-OFF-INVC-LINE             12270077
                  WRITE DA-OFF-INVC-LINE                                12280077
                  MOVE H6-HEADING-LINE TO DA-OFF-INVC-LINE              12290077
                  WRITE DA-OFF-INVC-LINE                                12300077
                  MOVE H7-HEADING-LINE TO DA-OFF-INVC-LINE              12310077
                  WRITE DA-OFF-INVC-LINE                                12320077
                  MOVE H8-HEADING-LINE TO DA-OFF-INVC-LINE              12330077
                  WRITE DA-OFF-INVC-LINE                                12340077
                  MOVE H9-HEADING-LINE TO DA-OFF-INVC-LINE              12350077
                  WRITE DA-OFF-INVC-LINE                                12360077
                  MOVE H10-HEADING-LINE TO DA-OFF-INVC-LINE             12370077
                  WRITE DA-OFF-INVC-LINE                                12380077
                  MOVE DA110-DEPT-NBR  TO H5A-DEPT-NBR                  12390077
                  MOVE SPACE            TO DA-OFF-INVC-LINE             12400077
                  WRITE DA-OFF-INVC-LINE                                12410077
                  IF DA110-CDE-DESC NOT = 'NO DEBIT ALLOWANCES'         12420077
                    MOVE H11-HEADING-LINE TO DA-OFF-INVC-LINE           12430077
                    WRITE DA-OFF-INVC-LINE                              12440077
                  END-IF                                                12450077
                  COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 13    12460077
                END-IF                                                  12470077
                COMPUTE PV-LN-CNT-FOR-TOT = PV-LN-CNT-FOR-TOT + 2       12480077
                MOVE DA110-CDE-DESC TO H12-DA-CDE-DESC                  12490077
                MOVE H12-HEADING-LINE TO DA-OFF-INVC-LINE               12500077
                WRITE DA-OFF-INVC-LINE                                  12510077
                MOVE DA110-CDE-DESC TO PV-PREV-CDE-DESC                 12520077
                MOVE DA110-SORT-SEQ TO PV-PREV-SORT-SEQ                 12530077
              END-IF                                                    12540077
                MOVE DA110-CDE-DESC TO PV-PREV-CDE-DESC                 12550077
                MOVE DA110-SORT-SEQ TO PV-PREV-SORT-SEQ                 12560077
              END-IF                                                    12570077
                MOVE DA110-CDE-DESC TO PV-PREV-CDE-DESC                 12580077
                MOVE DA110-SORT-SEQ TO PV-PREV-SORT-SEQ.                12590077
                                                                        12600077
      ******************************************************************12610077
      * ON A DMM/BUYER/VENDOR PAGE BREAK IF THE PAGE NUMBER IS ODD, SKIP12620077
      * A PAGE SINCE THIS REPORT IS PRINTED DUPLEX.                     12630077
      ******************************************************************12640077
       5999-SKIP-PAGE-LOGIC.                                            12650077
           MOVE PV-PAGE-CNT TO PV-PAGE-DISSECT.                         12660077
           IF PV-ODD                                                    12670077
             PERFORM 6010-PRINT-PREV-HEADINGS                           12680077
             MOVE 'ALL'           TO H5A-DEPT-NBR-X                     12690077
             MOVE SPACE           TO H5A-DEPT-DESC                      12700077
                                     H5A-DEPT-SLASH                     12710077
             MOVE H5A-HEADING-LINE TO DA-OFF-INVC-LINE                  12720077
             WRITE DA-OFF-INVC-LINE                                     12730077
             MOVE SPACE         TO DA-OFF-INVC-LINE                     12740077
             WRITE DA-OFF-INVC-LINE                                     12750077
             MOVE EP-EMPTY-PAGE TO DA-OFF-INVC-LINE                     12760077
             WRITE DA-OFF-INVC-LINE                                     12770077
             PERFORM 6000-PRINT-HEADINGS                                12780077
           ELSE                                                         12790077
             PERFORM 6000-PRINT-HEADINGS                                12800077
           END-IF.                                                      12810077
      ******************************************************************12820077
      * FORMAT AND PRINT HEADINGS USING INFO FROM LATEST INPUT REC    * 12830077
      ******************************************************************12840077
       6000-PRINT-HEADINGS.                                             12850077
           MOVE DA110-ENTITY-ID TO ADJRNL-ENT-ID.                       12860077
           MOVE 0 TO ADJRNL-NET-COST-AMT.                               12870077
           IF DA110-VENDOR-NBR > SPACE                                  12880077
             MOVE DA110-VENDOR-NBR TO ADJRNL-VND-NBR                    12890077
             MOVE DA110-DEPT-NBR   TO ADJRNL-DEPT-NBR                   12900077
             PERFORM 7100-GET-TADJRNL-INFO-VND                          12910077
           ELSE                                                         12920077
             MOVE DA110-DEPT-NBR   TO ADJRNL-DEPT-NBR                   12930077
             PERFORM 7200-GET-TADJRNL-INFO-ENT-ID                       12940077
           END-IF.                                                      12950077
           COMPUTE PV-DOLLARS-ADDED = ADJRNL-NET-COST-AMT * -1.         12960077
           MOVE  PV-DOLLARS-ADDED       TO H9-DOLLARS-ADDED.            12970077
           MOVE DA110-TTL-AVL-COST-AMT-TOT TO H10-TOTAL-AVAIL.          12980077
           COMPUTE PV-TOT-AVAIL = DA110-RMNG-AVL-COST-AMT-TOT +         12991088
             DA110-OFF-INVC-TOT.                                        12992091
           COMPUTE PV-OPENING-BALANCE = PV-TOT-AVAIL                    12995088
             - PV-DOLLARS-ADDED.                                        12996090
           MOVE PV-OPENING-BALANCE      TO H8-OPENING-BALANCE.          13030077
           MOVE DA110-DMM-NM                TO H3-DMM-NAME.             13040077
           MOVE DA110-DMM-NBR               TO H3-DMM-NBR.              13050077
           MOVE DA110-BUYER-NM              TO H4-BUYER-NAME.           13060077
           MOVE DA110-BUYER-NBR             TO H4-BUYER-NBR.            13070077
           MOVE DA110-VENDOR-NBR            TO H5-VENDOR-NBR.           13080077
           MOVE DA110-VENDOR-NM             TO H5-VENDOR-NAME.          13090077
           ADD +1 TO PV-PAGE-CNT.                                       13100077
           MOVE PV-PAGE-CNT TO DP132O-PAGE-NUMBER.                      13110077
           MOVE DP132O-STANDRD-HEADER-132-COLS TO DA-OFF-INVC-LINE.     13120077
           MOVE PC-ADV-PAGE-SYMBOL TO DA-OFF-INVC-LINE(1:1).            13130077
           WRITE DA-OFF-INVC-LINE.                                      13140077
           MOVE SPACES TO DP132O-LASER-NEW-PAGE-INDICATR.               13150077
           MOVE H2-HEADING-LINE TO DA-OFF-INVC-LINE.                    13160077
           WRITE DA-OFF-INVC-LINE.                                      13170077
           MOVE H2A-HEADING-LINE TO DA-OFF-INVC-LINE.                   13180077
           WRITE DA-OFF-INVC-LINE.                                      13190077
           MOVE SPACE           TO DA-OFF-INVC-LINE.                    13200077
           WRITE DA-OFF-INVC-LINE.                                      13210077
           MOVE H3-HEADING-LINE TO DA-OFF-INVC-LINE.                    13220077
           WRITE DA-OFF-INVC-LINE.                                      13230077
           MOVE H4-HEADING-LINE TO DA-OFF-INVC-LINE.                    13240077
           WRITE DA-OFF-INVC-LINE.                                      13250077
           MOVE H5-HEADING-LINE TO DA-OFF-INVC-LINE.                    13260077
           WRITE DA-OFF-INVC-LINE.                                      13270077
           MOVE DA110-CDE-DESC TO PV-PREV-CDE-DESC.                     13280077
           MOVE +7  TO PV-LN-CNT-FOR-TOT.                               13290077
                                                                        13300077
      *                                                                 13310077
       6005-PRINT-EMPTY-REPORT.                                         13320077
           ADD +1 TO PV-PAGE-CNT.                                       13330077
           MOVE PV-PAGE-CNT TO DP132O-PAGE-NUMBER.                      13340077
           MOVE DP132O-STANDRD-HEADER-132-COLS TO DA-OFF-INVC-LINE.     13350077
           MOVE PC-ADV-PAGE-SYMBOL TO DA-OFF-INVC-LINE(1:1).            13360077
           WRITE DA-OFF-INVC-LINE.                                      13370077
           MOVE H2-HEADING-LINE TO DA-OFF-INVC-LINE.                    13380077
           WRITE DA-OFF-INVC-LINE.                                      13390077
           MOVE H2A-HEADING-LINE TO DA-OFF-INVC-LINE.                   13400077
           WRITE DA-OFF-INVC-LINE.                                      13410077
           MOVE SPACE           TO DA-OFF-INVC-LINE.                    13420077
           WRITE DA-OFF-INVC-LINE.                                      13430077
           MOVE SPACE           TO DA-OFF-INVC-LINE.                    13440077
           WRITE DA-OFF-INVC-LINE.                                      13450077
           MOVE ND-NO-DATA-PAGE TO DA-OFF-INVC-LINE.                    13460077
           WRITE DA-OFF-INVC-LINE.                                      13470077
                                                                        13480077
      *                                                                 13490077
      ******************************************************************13500077
      * FORMAT AND PRINT HEADINGS USING DATA FROM LAST PAGE'S HEADINGS *13510077
      ******************************************************************13520077
       6010-PRINT-PREV-HEADINGS.                                        13530077
           ADD +1 TO PV-PAGE-CNT.                                       13540077
           MOVE PV-PAGE-CNT TO DP132O-PAGE-NUMBER.                      13550077
           MOVE DP132O-STANDRD-HEADER-132-COLS TO DA-OFF-INVC-LINE.     13560077
           MOVE PC-ADV-PAGE-SYMBOL TO DA-OFF-INVC-LINE(1:1).            13570077
           WRITE DA-OFF-INVC-LINE.                                      13580077
           MOVE SPACES TO DP132O-LASER-NEW-PAGE-INDICATR.               13590077
           MOVE H2-HEADING-LINE TO DA-OFF-INVC-LINE.                    13600077
           WRITE DA-OFF-INVC-LINE.                                      13610077
           MOVE H2A-HEADING-LINE TO DA-OFF-INVC-LINE.                   13620077
           WRITE DA-OFF-INVC-LINE.                                      13630077
           MOVE SPACE           TO DA-OFF-INVC-LINE.                    13640077
           WRITE DA-OFF-INVC-LINE.                                      13650077
           MOVE H3-HEADING-LINE TO DA-OFF-INVC-LINE.                    13660077
           WRITE DA-OFF-INVC-LINE.                                      13670077
           MOVE H4-HEADING-LINE TO DA-OFF-INVC-LINE.                    13680077
           WRITE DA-OFF-INVC-LINE.                                      13690077
           MOVE H5-HEADING-LINE TO DA-OFF-INVC-LINE.                    13700077
           WRITE DA-OFF-INVC-LINE.                                      13710077
           MOVE DA110-CDE-DESC TO PV-PREV-CDE-DESC.                     13720077
           MOVE +7  TO PV-LN-CNT-FOR-TOT.                               13730077
                                                                        13740077
      *                                                                 13750077
      ******************************************************************13760077
      *  GET DOLLARS ADDED INFORMATION USING VENDOR (DUNNS) NBR        *13770077
      ******************************************************************13780077
       7100-GET-TADJRNL-INFO-VND.                                       13790077
                                                                        13800077
           MOVE '*7100-GET-TADJRNL-INFO-VND     *' TO PV-PARA-NAME.     13810077
                                                                        13820077
           MOVE 0 TO ADJRNL-NET-COST-AMT.                               13830077
           EXEC SQL                                                     13840077
               SELECT SUM(NET_COST_AMT)                                 13850077
               INTO   :ADJRNL-NET-COST-AMT                              13860077
                 FROM TADJRNL                                           13870077
                WHERE PSTG_FYR_NBR  = :ADJRNL-PSTG-FYR-NBR              13880077
                  AND PSTG_FMN_NBR  = :ADJRNL-PSTG-FMN-NBR              13890077
                  AND DEPT_NBR      = :ADJRNL-DEPT-NBR                  13900077
                  AND VND_NBR       = :ADJRNL-VND-NBR                   13910077
                  AND AP_TRN_CDE   IN ('2D','2H','2J')                  13920077
                  AND DOC_EXTR_IND  = 'Y'                               13930077
                GROUP BY VND_NBR                                        13940077
           END-EXEC.                                                    13950077
                                                                        13960077
           EVALUATE TRUE                                                13970077
               WHEN SQLCODE = 0                                         13980077
                  CONTINUE                                              13990077
               WHEN SQLCODE = +100                                      14000077
                  MOVE 0 TO ADJRNL-NET-COST-AMT                         14010077
               WHEN OTHER                                               14080077
                 DISPLAY 'TADJRNL ' ADJRNL-PSTG-FYR-NBR ' - '           14090077
                                    ADJRNL-PSTG-FMN-NBR ' - '           14100077
                                    ADJRNL-VND-NBR      ' - '           14110077
                                    ADJRNL-DEPT-NBR                     14120077
                 PERFORM 9999-SQL-ERROR                                 14130077
           END-EVALUATE.                                                14140077
                                                                        14150077
      ******************************************************************14160077
      *  GET DOLLARS ADDED INFORMATION USING ENT_ID                    *14170077
      ******************************************************************14180077
       7200-GET-TADJRNL-INFO-ENT-ID.                                    14190077
                                                                        14200077
           MOVE '*7200-GET-TADJRNL-INFO-ENT-ID  *' TO PV-PARA-NAME.     14210077
                                                                        14220077
           MOVE 0 TO ADJRNL-NET-COST-AMT.                               14230077
           EXEC SQL                                                     14240077
               SELECT SUM(NET_COST_AMT)                                 14250077
               INTO   :ADJRNL-NET-COST-AMT                              14260077
                 FROM TADJRNL                                           14270077
                WHERE PSTG_FYR_NBR  = :ADJRNL-PSTG-FYR-NBR              14280077
                  AND PSTG_FMN_NBR  = :ADJRNL-PSTG-FMN-NBR              14290077
                  AND DEPT_NBR      = :ADJRNL-DEPT-NBR                  14300077
                  AND ENT_ID        = :ADJRNL-ENT-ID                    14310077
                  AND AP_TRN_CDE   IN ('2D','2H','2J')                  14320077
                  AND DOC_EXTR_IND  = 'Y'                               14330077
                GROUP BY VND_NBR                                        14340077
                        ,PSTG_FYR_NBR                                   14350077
                        ,PSTG_FMN_NBR                                   14360077
                        ,AP_TRN_CDE                                     14370077
                        ,DOC_EXTR_IND                                   14380077
           END-EXEC.                                                    14390077
                                                                        14400077
           EVALUATE TRUE                                                14410077
               WHEN SQLCODE = 0                                         14420077
                  CONTINUE                                              14430077
               WHEN SQLCODE = +100                                      14440077
                  MOVE 0 TO ADJRNL-NET-COST-AMT                         14500077
               WHEN OTHER                                               14510077
                 DISPLAY 'TADJRNL ' ADJRNL-PSTG-FYR-NBR '-'             14520077
                                    ADJRNL-PSTG-FMN-NBR '-'             14530077
                                    ADJRNL-VND-NBR                      14540077
                 PERFORM 9999-SQL-ERROR                                 14550077
           END-EVALUATE.                                                14560077
                                                                        14570077
      *                                                                 14580077
      ******************************************************************14590077
      * RETRIEVE DEPARTMENT DESCRIPTION FROM MBS TABLES               * 14600077
      ******************************************************************14610077
       7300-SELECT-DEPT-NAME.                                           14620077
           MOVE '*7300-SELECT-DEPT-NAME         *' TO PV-PARA-NAME.     14630077
           PERFORM                                                      14640077
              VARYING PV-RETRY-CNT                                      14650077
              FROM 1 BY 1                                               14660077
              UNTIL   PV-RETRY-CNT > PC-MAX-RETRY-CNT                   14670077
                                                                        14680077
               EXEC SQL                                                 14690077
                  SELECT MDSEAR_DESC                                    14700077
                   INTO  :MDSEAR-DESC                                   14710077
                   FROM  TMDSEAR                                        14720077
                   WHERE OPERCO_NBR = :PC-OPERCO-NBR                    14730077
                     AND DEPT_NBR   = :PV-CALL-DEPT                     14740077
                     AND MDSELV_CDE = :PC-DEPT-CODE                     14750077
                     AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE      14760077
               END-EXEC                                                 14770077
              EVALUATE TRUE                                             14780077
                 WHEN SQLCODE = +0                                      14790077
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT         14800077
                 WHEN SQLCODE = +100                                    14810077
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT         14820077
                    MOVE 'NOT ON TMDSEAR' TO MDSEAR-DESC                14830077
                 WHEN SQLCODE = -911                                    14840077
                 WHEN SQLCODE = -913                                    14850077
                    CONTINUE                                            14860077
                 WHEN OTHER                                             14870077
                    PERFORM 9999-SQL-ERROR                              14880077
              END-EVALUATE                                              14890077
           END-PERFORM.                                                 14900077
                                                                        14910077
           IF (SQLWARN0 NOT = SPACES                                    14920077
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                    14930077
             OR SQLCODE < 0)                                            14940077
               PERFORM 9999-SQL-ERROR                                   14950077
           END-IF.                                                      14960077
      *                                                                 14970077
      ******************************************************************14980077
      * RETRIEVE DAY OF WEEK                                          * 14990077
      ******************************************************************15000077
       8400-CALENDAR-DAY-OF-WEEK.                                       15010077
                                                                        15020077
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15030077
           MOVE 'F4'                 TO DPG51-CALENDAR-TYPE.            15040077
           SET DPG51-DO-NOT-INCR-DECR-DATE                              15050077
                                      TO TRUE                           15060077
                                                                        15070077
           SET  DPG52-LK-DTE-ISO-FMT TO TRUE.                           15080077
           MOVE SA-CURRENT-DATE      TO DPG52-LK-DATE-INPUT.            15090077
                                                                        15100077
           CALL DP500-KOHLS-CALENDAR-ROUTINE                            15110077
               USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               15120077
                                                                        15130077
           EVALUATE TRUE                                                15140077
               WHEN DPG54-SEVERE-ERROR                                  15150077
                   DISPLAY '** ABEND **'                                15160077
                   DISPLAY '** PGM = DAKRP114'                          15170077
                   DISPLAY '** 8400-CALENDAR-DAY-OF-WEEK'               15180077
                   DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  15190077
                   DISPLAY '** ERROR MESSAGE = '                        15200077
                           DPG54-ERROR-MESSAGE                          15210077
                   DISPLAY '** DPG51 = ' DPG51                          15220077
                   DISPLAY '** DPG52 = ' DPG52                          15230077
                   DISPLAY '** DPG53 = ' DPG53                          15240077
                   DISPLAY '** DPG54 = ' DPG54                          15250077
                   MOVE +4003 TO ABEND-CODE                             15260077
                   CALL 'ILBOABN0' USING ABEND-CODE                     15270077
               WHEN OTHER                                               15280077
                   CONTINUE                                             15290077
           END-EVALUATE.                                                15300077
                                                                        15310077
           MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DB2-OUT-DATE               15320077
           MOVE DPG55-ALPHA-WEEK-DAY   TO PV-CURRENT-WEEKDAY.           15330077
           DISPLAY 'WEEK DAY: ', PV-CURRENT-WEEKDAY.                    15340077
                                                                        15350077
           EVALUATE PV-CURRENT-WEEKDAY                                  15360077
               WHEN 'SUNDAY   '                                         15370077
                    MOVE 7 TO PV-DECREMENT-1ST                          15380077
               WHEN 'MONDAY   '                                         15390077
                    MOVE 8 TO PV-DECREMENT-1ST                          15400077
               WHEN 'TUESDAY  '                                         15410077
                    MOVE 9 TO PV-DECREMENT-1ST                          15420077
               WHEN 'WEDNESDAY'                                         15430077
                    MOVE 10 TO PV-DECREMENT-1ST                         15440077
               WHEN 'THURSDAY '                                         15450077
                    MOVE 11 TO PV-DECREMENT-1ST                         15460077
               WHEN 'FRIDAY   '                                         15470077
                    MOVE 12 TO PV-DECREMENT-1ST                         15480077
               WHEN 'SATURDAY '                                         15490077
                    MOVE 13 TO PV-DECREMENT-1ST                         15500077
           END-EVALUATE.                                                15510077
      *                                                                 15520077
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15530077
           MOVE PV-DECREMENT-1ST      TO DPG51-INCR-DECR-DAYS-9.        15540077
           SET  DPG51-DECREMENT-DATE  TO TRUE.                          15550077
           MOVE 'F4'                  TO DPG51-CALENDAR-TYPE.           15560077
           SET  DPG52-LK-DTE-ISO-FMT  TO TRUE.                          15570077
           MOVE PV-DB2-OUT-DATE        TO DPG52-LK-DATE-INPUT.          15580077
                                                                        15590077
           CALL DP500-KOHLS-CALENDAR-ROUTINE                            15600077
               USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               15610077
                                                                        15620077
           EVALUATE TRUE                                                15630077
               WHEN DPG54-SEVERE-ERROR                                  15640077
                   DISPLAY '** ABEND **'                                15650077
                   DISPLAY '** PGM = DAKRP114'                          15660077
                   DISPLAY '** 8400-CALENDAR-DAY-OF-WEEK'               15670077
                   DISPLAY '** INVALID RETURN FROM 1ST DECREMENT. '     15680077
                   DISPLAY '** ERROR MESSAGE = '                        15690077
                           DPG54-ERROR-MESSAGE                          15700077
                   DISPLAY '** DPG51 = ' DPG51                          15710077
                   DISPLAY '** DPG52 = ' DPG52                          15720077
                   DISPLAY '** DPG53 = ' DPG53                          15730077
                   DISPLAY '** DPG54 = ' DPG54                          15740077
                   MOVE +4003 TO ABEND-CODE                             15750077
                   CALL 'ILBOABN0' USING ABEND-CODE                     15760077
               WHEN OTHER                                               15770077
                   CONTINUE                                             15780077
           END-EVALUATE.                                                15790077
                                                                        15800077
           MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DB2-OUT-DATE.              15810077
      *                                                                 15820077
      ******************************************************************15830077
      *  CLOSE CURSORS, CLOSE FILES, DISPLAY COUNTERS                 * 15840077
      ******************************************************************15850077
       9000-END-OF-JOB.                                                 15860077
           DISPLAY ' '.                                                 15870077
           DISPLAY 'DA OFF INVC RECORDS ' PV-NBR-OF-DA-OFF-INVC.        15880077
           DISPLAY '**------ END ' PC-PROGRAM-NAME ' ------**'.         15890077
           CLOSE DRIVER-FILE                                            15900077
                 DA-OFF-INVC-FILE.                                      15910077
                                                                        15920077
      *                                                                 15930077
                                                                        15940077
      ******************************************************************15950077
      * 9900-GET-DATE-TIME - GET THE CURRENT DATE AND TIME FROM DB2   * 15960077
      ******************************************************************15970077
       9900-GET-DATE-TIME.                                              15980077
           MOVE '*9900-GET-DATE-TIME.             *' TO PV-PARA-NAME.   15990077
                                                                        16000077
           EXEC SQL                                                     16010077
               SET :SA-CURRENT-DATE = CURRENT DATE                      16020077
           END-EXEC.                                                    16030077
                                                                        16040077
           EXEC SQL                                                     16050077
               SET :SA-CURRENT-TIME = CURRENT TIME                      16060077
           END-EXEC.                                                    16070077
                                                                        16080077
           EVALUATE TRUE                                                16090077
               WHEN SQLCODE = ZERO                                      16100077
                   MOVE SA-CURR-YEAR       TO SD-SYSTEM-YEAR            16110077
                   MOVE SA-CURR-MONTH      TO SD-SYSTEM-MONTH           16120077
                   MOVE SA-CURR-DAY        TO SD-SYSTEM-DAY             16130077
                   MOVE SA-CURR-HOUR       TO ST-SYSTEM-HOUR            16140077
                   MOVE SA-CURR-MINUTE     TO ST-SYSTEM-MINUTE          16150077
               WHEN OTHER                                               16160077
                   PERFORM 9999-SQL-ERROR                               16170077
           END-EVALUATE.                                                16180077
                                                                        16190077
                                                                        16200077
       9999-SQL-ERROR.                                                  16210077
      ******************************************************************16220077
      * ABEND ROUTINE FOR BAD SQL CALLS                               * 16230077
      ******************************************************************16240077
           DISPLAY '** ABEND **          = SQL ERROR'.                  16250077
           DISPLAY '** PROGRAM **        = DAKRP114'                    16260077
           DISPLAY '** PARAGRAPH **      = ' PV-PARA-NAME               16270077
      *                                                                 16280077
      ******************************************************************16290077
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    16300077
      * MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         16310077
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     16320077
      * FORMAT.                                                         16330077
      ******************************************************************16340077
            COPY DPPD004.                                               16350077
      *                                                                 16360077
           MOVE +4013                      TO ABEND-CODE.               16370077
           CALL 'ILBOABN0' USING ABEND-CODE.                            16380077
                                                                        16390077
