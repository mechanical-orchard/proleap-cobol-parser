000100***************************************************************** 00010005
000200 IDENTIFICATION DIVISION.                                         00020005
000300***************************************************************** 00030005
000400                                                                  00040005
000500 PROGRAM-ID.             RCKUT190.                                00050002
000600 AUTHOR.                 RON KRIER.                               00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN            DECEMBER 2021.                           00080002
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL BE USED TO TAKE IN A FILE THAT WAS PARSED  * 00120002
001300*  FROM AN XML FILE FILE FROM A THIRD PARTY VENDOR WHICH        * 00130002
001400*  CONTAINED SHIPMENT INFORMATION FOR MERCHANDISE THAT WAS      * 00140002
001500*  PROCESSED BY THE THIRD PARTY VENDOR AND PACKED TO SML        * 00150002
001600*  CARTONS FOR STORES.  WHEN THE THIRD PARTY PUT THE SML        * 00160002
001700*  CARTONS ONTO A TRAILER AND SHIPPED THAT TRAILER, THEY        * 00170002
001800*  GENERATED A FILE FOR THE TRAILER OF WHAT WAS ON THAT TRAILER * 00180002
001900*  DOWN TO THE CARTON CONTENTS LEVEL WHICH WE WILL THEN USE TO  * 00190002
002000*  POPULATE THE OUTBOUND CARTON DATABASE AND GENERATE VERIFIED  * 00200002
002100*  RECEIVERS.                                                   * 00210002
002200*                                                               * 00220000
002300*  WHEN THIS PROGRAM WAS WRITTEN, IT WAS WRITTEN TO PROCESS     * 00230002
002400*  SHIPMENT DATA FROM GEODIS AS THEY WERE DOING A PICK, PACK    * 00240002
002500*  AND SHIP PROCESS FOR SEPHORA MERCHANDISE.                    * 00250002
002600*                                                               * 00260002
002700*  THE INPUT FILE FOR THIS PROGRAM IS COMING FROM RCKUT189      * 00270002
002800*  WHICH PARSED XML DATA FROM THE THIRD PARTY.                  * 00280002
002900*                                                               * 00290002
003000*  THIS PROGRAM WILL VALIDATE THE DATA FROM THE PARSED FILE.    * 00300002
003100*  THE PROGRAM WILL DO NUMERIC CHECKS ON THE APPROPRIATE DATA   * 00310002
003200*  AND THEN PERFORM VARIOUS VALIDATION CHECKS TO ENSURE THE     * 00320002
003300*  DATA TO BE PROCESSED IS VALID FOR KOHLS (LIKE FOR EXAMPLE,   * 00330002
003400*  VALID PO NUMBER, VALID SKU NUMBER, VALID SKU ON THE PO,      * 00340002
003500*  ETC.  VALID DATA WILL BE WRITTEN TO COPYBOOK RCRD119 AND     * 00350002
003600*  PASSED FOR FURTHER PROCESSING.  INVALID DATA WILL BE         * 00360002
003700*  WRITTEN TO COPYBOOK RCRD120 AND PASSED FOR ERROR REPORTING.  * 00370002
003710*                                                               * 00371042
003720*  FYI - FOR RECORDS WRITTEN TO THE INVAID DATA FILE, YOU CAN   * 00372042
003730*        FIND DATA DISPLAYED IN THE SYSOUT FROM THIS PROGAM     * 00373042
003731*        ABOUT WHAT CAUSED IT TO BE WRITTEN TO THE INVALID      * 00373142
003740*        DATA FILE AND ALSO LOOK AT REPORT RCKRP095.            * 00374042
003750*                                                               * 00375042
003800***************************************************************** 00380000
003900                                                                  00390000
004000 ENVIRONMENT DIVISION.                                            00400000
004100                                                                  00410000
004200 CONFIGURATION SECTION.                                           00420000
004300                                                                  00430000
004400 SOURCE-COMPUTER.        IBM-3090.                                00440000
004500 OBJECT-COMPUTER.        IBM-3090.                                00450000
004600                                                                  00460000
004700 INPUT-OUTPUT SECTION.                                            00470000
004800                                                                  00480000
004900 FILE-CONTROL.                                                    00490000
005000                                                                  00500000
005100     SELECT PARSED-SHIPMENT-FILE                                  00510002
005200         ASSIGN TO INP01.                                         00520000
005300                                                                  00530000
005400     SELECT VALID-DATA-OUTPUT-FILE                                00540002
005500         ASSIGN TO OUT01.                                         00550000
005600                                                                  00560000
005700     SELECT INVALID-DATA-OUTPUT-FILE                              00570005
005800         ASSIGN TO OUT02.                                         00580000
005900                                                                  00590000
005910     SELECT ERROR-COUNTS-OUTPUT-FILE                              00591047
005920         ASSIGN TO OUT03.                                         00592047
005930                                                                  00593047
006000******************************************************************00600000
006100 DATA DIVISION.                                                   00610000
006200******************************************************************00620000
006300                                                                  00630000
006400 FILE SECTION.                                                    00640000
006500                                                                  00650000
006600 FD  PARSED-SHIPMENT-FILE                                         00660002
006700     RECORDING MODE IS F                                          00670000
006800     LABEL RECORDS ARE STANDARD                                   00680000
006900     BLOCK CONTAINS 0 RECORDS.                                    00690000
007000 01  PARSED-SHIPMENT-RECORD           PIC  X(330).                00700002
007100                                                                  00710000
007200 FD  VALID-DATA-OUTPUT-FILE                                       00720002
007300     RECORDING MODE IS F                                          00730000
007400     BLOCK CONTAINS 0  RECORDS.                                   00740000
007500 01  VALID-DATA-OUTPUT-RECORD         PIC  X(300).                00750004
007600                                                                  00760000
007700 FD  INVALID-DATA-OUTPUT-FILE                                     00770004
007800     RECORDING MODE IS F                                          00780000
007900     BLOCK CONTAINS 0  RECORDS.                                   00790000
008000 01  INVALID-DATA-OUTPUT-RECORD       PIC  X(330).                00800004
008100                                                                  00810000
008110 FD  ERROR-COUNTS-OUTPUT-FILE                                     00811045
008120     RECORDING MODE IS F                                          00812045
008130     BLOCK CONTAINS 0  RECORDS.                                   00813045
008140 01  ERROR-COUNTS-OUTPUT-RECORD       PIC  X(100).                00814046
008150                                                                  00815045
008200 WORKING-STORAGE SECTION.                                         00820000
008300                                                                  00830000
008400 01  FILLER                      PIC  X(46)    VALUE              00840000
008500     '** WORKING STORAGE FOR RCKUT190 STARTS HERE **'.            00850002
008600                                                                  00860000
008700 01  DATABASE-KEY-FIELDS.                                         00870000
008800     05  DK-PO-NUMBER                PIC  S9(9)  COMP.            00880000
008900     05  DK-DC-NUMBER                PIC  S9(4)  COMP.            00890000
009000     05  DK-UPC-NUMBER               PIC  S9(15) COMP-3.          00900000
009100     05  DK-SKU-NUMBER               PIC  S9(8)  COMP-3.          00910000
009200     05  DK-SML-NUMBER               PIC  S9(18) COMP-3.          00920002
009300     05  DK-STORE-NUMBER             PIC  S9(4)  COMP.            00930002
009400                                                                  00940000
009500 01  PROGRAM-SWITCHES.                                            00950000
009600     05  END-OF-FILE-SW              PIC  X(01)    VALUE 'Y'.     00960000
009700         88  END-OF-FILE                           VALUE 'N'.     00970000
009800     05  PS-WRITE-ERROR-FILE-SW      PIC X(01)     VALUE 'N'.     00980002
009900         88  PS-WRITE-ERROR-FILE-NO                VALUE 'N'.     00990002
010000         88  PS-WRITE-ERROR-FILE-YES               VALUE 'Y'.     01000002
010100     05  PS-ERROR-SW                 PIC X(01)     VALUE 'N'.     01010000
010200         88  PS-ERROR-NO                           VALUE 'N'.     01020000
010300         88  PS-ERROR-YES                          VALUE 'Y'.     01030000
010400     05  PS-NUMERIC-ERROR-SW         PIC X(01)     VALUE 'N'.     01040000
010500         88  PS-NUMERIC-ERROR-NO                   VALUE 'N'.     01050000
010600         88  PS-NUMERIC-ERROR-YES                  VALUE 'Y'.     01060000
010700     05  PS-KOHLS-PO-FOUND-SW        PIC X(01)     VALUE 'N'.     01070009
010800         88  PS-KOHLS-PO-NOT-FOUND                 VALUE 'N'.     01080009
010900         88  PS-KOHLS-PO-FOUND                     VALUE 'Y'.     01090010
011000     05  PS-PREV-KOHLS-PO-FOUND-SW   PIC X(01)     VALUE 'N'.     01100009
011100         88  PS-PREV-KOHLS-PO-NOT-FOUND            VALUE 'N'.     01110009
011200         88  PS-PREV-SINGLE-PO-FOUND               VALUE 'Y'.     01120000
011300         88  PS-PREV-MULT-PO-FOUND                 VALUE 'M'.     01130000
011400     05  PS-UPC-FOUND-SW             PIC X(01)     VALUE 'N'.     01140000
011500         88  PS-UPC-NOT-FOUND                      VALUE 'N'.     01150000
011600         88  PS-UPC-FOUND                          VALUE 'Y'.     01160000
011700     05  PS-SKU-FOUND-SW             PIC X(01)     VALUE 'N'.     01170011
011800         88  PS-SKU-NOT-FOUND                      VALUE 'N'.     01180011
011900         88  PS-SKU-FOUND                          VALUE 'Y'.     01190011
012000     05  PS-PO-LINE-FOUND-SW         PIC X(01)     VALUE 'N'.     01200000
012100         88  PS-PO-LINE-NOT-FOUND                  VALUE 'N'.     01210000
012200         88  PS-PO-LINE-FOUND                      VALUE 'Y'.     01220000
012300     05  PS-SML-FOUND-SW             PIC X(01)     VALUE 'N'.     01230002
012400         88  PS-SML-NOT-FOUND                      VALUE 'N'.     01240002
012500         88  PS-SML-FOUND                          VALUE 'Y'.     01250002
012600     05  PS-STORE-FOUND-SW           PIC X(01)     VALUE 'N'.     01260002
012700         88  PS-STORE-NOT-FOUND                    VALUE 'N'.     01270002
012800         88  PS-STORE-FOUND                        VALUE 'Y'.     01280002
012900     05  PS-DC-FOUND-SW              PIC X(01)     VALUE 'N'.     01290002
013000         88  PS-DC-NOT-FOUND                       VALUE 'N'.     01300002
013100         88  PS-DC-FOUND                           VALUE 'Y'.     01310002
013200     05  PS-SML-F10-NUMERIC-SW       PIC X(01)     VALUE 'N'.     01320002
013300         88  PS-SML-F10-NOT-NUMERIC                VALUE 'N'.     01330002
013400         88  PS-SML-F10-NUMERIC                    VALUE 'Y'.     01340002
013500     05  PS-SML-M10-NUMERIC-SW       PIC X(01)     VALUE 'N'.     01350008
013600         88  PS-SML-M10-NOT-NUMERIC                VALUE 'N'.     01360008
013700         88  PS-SML-M10-NUMERIC                    VALUE 'Y'.     01370008
013800     05  PS-SML-L10-NUMERIC-SW       PIC X(01)     VALUE 'N'.     01380008
013900         88  PS-SML-L10-NOT-NUMERIC                VALUE 'N'.     01390008
014000         88  PS-SML-L10-NUMERIC                    VALUE 'Y'.     01400008
014100     05  PS-COMMENT-TYPE-SW          PIC X(01)     VALUE 'N'.     01410000
014200         88  PS-COMMENT-TYPE-ERROR                 VALUE 'E'.     01420000
014300         88  PS-COMMENT-TYPE-WARNING               VALUE 'W'.     01430000
014400         88  PS-COMMENT-TYPE-INFO                  VALUE 'I'.     01440000
014500     05  PS-REPORT-WRITE-SW          PIC X(01)     VALUE 'N'.     01450000
014600         88  PS-REPORT-WRITE-YES                   VALUE 'Y'.     01460000
014700         88  PS-REPORT-WRITE-NO                    VALUE 'N'.     01470000
014800     05  PS-DC-MATCH-SW              PIC X(01)     VALUE 'N'.     01480000
014900         88  PS-DC-MATCH                           VALUE 'Y'.     01490000
015000         88  PS-DC-MATCH-NO                        VALUE 'N'.     01500000
015100     05  PS-SML-FORMAT-SW            PIC X(01)     VALUE 'N'.     01510011
015200         88  PS-SML-FORMAT-GOOD                    VALUE 'Y'.     01520011
015300         88  PS-SML-FORMAT-ISSUE                   VALUE 'N'.     01530011
015400     05  PS-SML-CARTON-TYPE-VALID-SW PIC X(01)     VALUE 'N'.     01540022
015500         88  PS-SML-NOT-CARTON-TYPE                VALUE 'N'.     01550022
015600         88  PS-SML-IS-CARTON-TYPE                 VALUE 'Y'.     01560022
015700     05  PS-SML-POS-3-TO-4-VALID-SW  PIC X(01)     VALUE 'N'.     01570023
015800         88  PS-SML-POS-3-TO-4-INVALID             VALUE 'N'.     01580023
015900         88  PS-SML-POS-3-TO-4-VALID               VALUE 'Y'.     01590023
016000     05  PS-SML-STORE-ORD-STORE-SW   PIC X(01)     VALUE 'N'.     01600022
016100         88  PS-SML-STORE-ORD-STORE-MATCH          VALUE 'Y'.     01610022
016200         88  PS-SML-STORE-ORD-STORE-NOMATCH        VALUE 'N'.     01620022
016300     05  PS-SML-DC-NBR-VALID-SW      PIC X(01)     VALUE 'N'.     01630022
016400         88  PS-SML-DC-NBR-NOT-DC                  VALUE 'N'.     01640022
016500         88  PS-SML-DC-NBR-VALID                   VALUE 'Y'.     01650022
016600         88  PS-SML-DC-NBR-NOT-FOUND               VALUE 'F'.     01660022
016700                                                                  01670000
016800 01  PC-CONSTANTS.                                                01680002
016900     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01690002
017000                                                   COMP SYNC.     01700002
017100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01710000
017200                                                   'RCKUT190'.    01720003
017300                                                                  01730000
017400     05  PC-COMMA                    PIC X(01)     VALUE ','.     01740000
017500     05  PC-PERIOD                   PIC X(01)     VALUE '.'.     01750000
017600     05  PC-D                        PIC X(01)     VALUE 'D'.     01760000
017700     05  PC-T                        PIC X(01)     VALUE 'T'.     01770000
017800     05  PC-PROGRESSIVE-READ-LIMIT   PIC S9(9)     VALUE 400      01780004
017900                                                    COMP-3.       01790000
018000                                                                  01800000
018100 01  PV-ACCUMULATOR-FIELDS.                                       01810000
018200     05  PV-RETRY-COUNT              PIC S9(04)  VALUE +0         01820000
018300                                                   COMP SYNC.     01830000
018400     05  PV-COMMA-COUNT              PIC S9(04)  VALUE +0         01840000
018500                                                   COMP SYNC.     01850000
018600                                                                  01860000
018700     05  PV-PO-SPEC-INSTRUCTION.                                  01870000
018800         10  PV-PO-SPEC-INST-FIXED   PIC X(12)     VALUE          01880000
018900             'SEPHORA PO #'.                                      01890000
019000         10  PV-PO-SPEC-INST-PO-NBR  PIC 9(10)     VALUE ZERO.    01900000
019100     05  PV-PO-SPEC-INSTR-DESC       PIC X(150)    VALUE SPACES.  01910000
019200                                                                  01920000
019300 01  PV-ABEND-FIELDS.                                             01930000
019400     05  PV-ABEND-CODE               PIC S9(04)  VALUE ZERO       01940000
019500                                                   COMP SYNC.     01950000
019600     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)  VALUE SPACES.    01960000
019700     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'RCKUT190'.01970005
019800     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01980000
019900     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01990000
020000     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02000000
020100     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02010000
020200     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02020000
020300     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02030000
020400     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      02040000
020500                                                                  02050000
020600 01  PV-UNSTRING-FIELDS.                                          02060000
020700     05  PV-FILE-NAME                PIC   X(20)    VALUE SPACES. 02070000
020800     05  PV-RECORD-TYPE              PIC   X(01)    VALUE SPACES. 02080000
020900     05  PV-ORD-NBR                  PIC   X(10)    VALUE SPACES. 02090000
021000     05  PV-MDSE-SOURCE              PIC   X(03)    VALUE SPACES. 02100000
021100     05  PV-DC-NBR                   PIC   X(04)    VALUE SPACES. 02110000
021200     05  PV-UPC-NBR                  PIC   X(15)    VALUE SPACES. 02120000
021300     05  PV-SHIP-QTY                 PIC   X(05)    VALUE SPACES. 02130000
021400     05  PV-RECORD-FILLER            PIC   X(05)    VALUE SPACES. 02140000
021500     05  PV-RECORD-QTY               PIC   X(07)    VALUE SPACES. 02150000
021600                                                                  02160000
021700 01  PV-MISC-FIELDS.                                              02170000
021800     05  PV-READ-COUNT               PIC  S9(9)     VALUE ZERO    02180000
021900                                                    COMP-3.       02190000
022000     05  PV-VALID-WRITE-COUNT        PIC  S9(9)     VALUE ZERO    02200005
022100                                                    COMP-3.       02210000
022200     05  PV-INVALID-WRITE-COUNT      PIC  S9(9)     VALUE ZERO    02220005
022300                                                    COMP-3.       02230000
022400     05  PV-PROGRESSIVE-READ-COUNT   PIC  S9(9)     VALUE ZERO    02240003
022500                                                    COMP-3.       02250003
022600     05  PV-TOTAL-RECORD-QTY         PIC  S9(9)     VALUE ZERO    02260000
022700                                                    COMP-3.       02270000
022710     05  PV-TOTAL-VALID-SHIP-QTY     PIC  S9(9)     VALUE ZERO    02271043
022720                                                    COMP-3.       02272043
022800     05  PV-PO-SELECT-QTY            PIC  S9(9)     VALUE ZERO    02280000
022900                                                    COMP-3.       02290000
023000     05  PV-PO-MULT-SELECT-QTY       PIC  S9(9)     VALUE ZERO    02300000
023100                                                    COMP-3.       02310000
023200     05  PV-SEPHORA-PO-SELECT-QTY    PIC  S9(9)     VALUE ZERO    02320011
023300                                                    COMP-3.       02330011
023400     05  PV-ERR-SML-EXISTS-CNT       PIC S9(9)  VALUE ZERO COMP-3.02340013
023500     05  PV-ERR-STR-NOT-FOUND-CNT    PIC S9(9)  VALUE ZERO COMP-3.02350013
023600     05  PV-ERR-3RD-DC-NOT-FOUND-CNT PIC S9(9)  VALUE ZERO COMP-3.02360013
023700     05  PV-ERR-TO-DC-NOT-FOUND-CNT  PIC S9(9)  VALUE ZERO COMP-3.02370013
023800     05  PV-ERR-SML-DC-NOT-FOUND-CNT PIC S9(9)  VALUE ZERO COMP-3.02380013
023900     05  PV-ERR-SRV-DC-NOT-FOUND-CNT PIC S9(9)  VALUE ZERO COMP-3.02390013
024000     05  PV-ERR-NON-NUMERIC-CNT      PIC S9(9)  VALUE ZERO COMP-3.02400000
024010     05  PV-ERR-DATA-MISSING-CNT     PIC S9(9)  VALUE ZERO COMP-3.02401034
024100     05  PV-ERR-PO-NOT-FOUND-CNT     PIC S9(9)  VALUE ZERO COMP-3.02410000
024200     05  PV-ERR-SKU-NOT-FOUND-CNT    PIC S9(9)  VALUE ZERO COMP-3.02420011
024300     05  PV-ERR-SKU-NOT-ON-PO-CNT    PIC S9(9)  VALUE ZERO COMP-3.02430000
024400     05  PV-PREV-RECORD-TYPE         PIC   X(1)     VALUE SPACE.  02440000
024500     05  PV-PREV-SENT-ORD-NBR        PIC 9(10)     VALUE ZERO.    02450000
024600     05  PV-PREV-KOHLS-PO-NBR        PIC 9(08)     VALUE ZERO.    02460009
024700     05  PV-HOLD-SEPHORA-PO-NBR      PIC X(15)     VALUE SPACES.  02470011
024800     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACES.  02480000
024900     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     02490000
025000                                                   COMP SYNC.     02500000
025100     05  PV-CURRENT-TMST-DB2         PIC X(26)     VALUE SPACE.   02510000
025200     05  PV-CURRENT-TMST.                                         02520000
025300         10  PV-CURR-DATE.                                        02530000
025400             15  PV-CURR-DATE-CC     PIC  9(02)    VALUE ZERO.    02540000
025500             15  PV-CURR-DATE-YY     PIC  9(02)    VALUE ZERO.    02550000
025600             15  PV-CURR-DASH1       PIC  X        VALUE SPACE.   02560000
025700             15  PV-CURR-DATE-MM     PIC  9(02)    VALUE ZERO.    02570000
025800             15  PV-CURR-DASH2       PIC  X        VALUE SPACE.   02580000
025900             15  PV-CURR-DATE-DD     PIC  9(02)    VALUE ZERO.    02590000
026000             15  PV-CURR-DASH3       PIC  X        VALUE SPACE.   02600000
026100         10  PV-CURR-TIME.                                        02610000
026200             15  PV-CURR-TIME-HH     PIC  9(02)    VALUE ZERO.    02620000
026300             15  PV-CURR-TIME-P1     PIC  X        VALUE SPACE.   02630000
026400             15  PV-CURR-TIME-MM     PIC  9(02)    VALUE ZERO.    02640000
026500             15  PV-CURR-TIME-P2     PIC  X        VALUE SPACE.   02650000
026600             15  PV-CURR-TIME-SS     PIC  9(02)    VALUE ZERO.    02660000
026700             15  FILL                PIC  X(07)    VALUE SPACE.   02670000
026800                                                                  02680000
026900     05  PV-NULL-IND                 PIC  S9(4)    VALUE ZERO     02690000
027000                                                   COMP SYNC.     02700000
027100     05  PV-DB2-COUNT                PIC  S9(9)    VALUE ZERO     02710000
027200                                                   COMP-3.        02720000
027300     05  PV-DISP-NBR-C               PIC  ZZ,ZZZ,ZZ9.             02730000
027400     05  PV-DISP-NBR-C2              PIC  ZZ,ZZZ,ZZ9.             02740000
027500     05  PV-DISP-NBR                 PIC  ZZZZZZZ9.               02750000
027600     05  PV-DISP-NBR-15              PIC  999999999999999.        02760000
027700     05  PV-DISP-NBR-10              PIC  9999999999.             02770000
027800     05  PV-DISP-NBR-8               PIC  99999999.               02780000
027900     05  PV-DISP-NBR-18              PIC  999999999999999999.     02790000
028000     05  PV-DISP-NBR-4               PIC  9999.                   02800000
028100     05  PV-DISP-LINE                PIC  9(9)-.                  02810000
028200                                                                  02820000
028300     05  PV-DISP-OPER-IN-REC         PIC  9999.                   02830000
028400     05  PV-DISP-OPER-ON-PO          PIC  9999.                   02840000
028500                                                                  02850000
028600     05  PV-CURR-CCYY.                                            02860000
028700         10  PV-CURR-CC              PIC  X(02)    VALUE SPACE.   02870000
028800         10  PV-CURR-YY              PIC  X(02)    VALUE SPACE.   02880000
028900                                                                  02890008
029000     05  PV-SPLIT-SML-NBR.                                        02900008
029100         10  PV-SPLIT-SML-NBR-F10    PIC  X(10)    VALUE SPACE.   02910008
029200         10  PV-SPLIT-SML-NBR-M10    PIC  X(10)    VALUE SPACE.   02920008
029300         10  PV-SPLIT-SML-NBR-L10    PIC  X(10)    VALUE SPACE.   02930008
029400                                                                  02940000
029500     05  PV-SPLIT-SML-NBR-2.                                      02950008
029600         10  PV-SPLIT-SML-2-F20      PIC  X(20)    VALUE SPACE.   02960008
029700         10  PV-SPLIT-SML-2-L10      PIC  X(10)    VALUE SPACE.   02970008
029800                                                                  02980008
029900     05  PV-SML-NBR-FINAL.                                        02990008
030000         10  PV-SML-NBR-FINAL-F2     PIC  9(02)    VALUE ZERO.    03000008
030100         10  PV-SML-NBR-FINAL-L18    PIC  9(18)    VALUE ZERO.    03010008
030200                                                                  03020000
030300     05  PV-DELIVERY-SCAC            PIC  X(04)    VALUE SPACE.   03030000
030400     05  PV-LOC-NBR                  PIC  S9(4) COMP.             03040000
030500     05  PV-SSCC-PO-LINE             PIC  S9(9) COMP.             03050000
030600                                                                  03060007
030700     05  PV-SHIP-DATE                PIC  9(08)    VALUE ZERO.    03070007
030800     05  PV-SHIP-DATE-ALPHA.                                      03080007
030900         10  PV-SHIP-DATE-YYYY       PIC  9(04).                  03090007
031000         10  PV-SHIP-DATE-MM         PIC  9(02).                  03100007
031100         10  PV-SHIP-DATE-DD         PIC  9(02).                  03110007
031200                                                                  03120008
031300     05  PV-CUST-ORDER-NBR.                                       03130008
031400         10  PV-CUST-ORDER-KOHLS-PO  PIC  X(08).                  03140008
031500         10  PV-CUST-ORDER-DASH      PIC  X(01).                  03150008
031600         10  PV-CUST-ORDER-STR-NBR   PIC  X(11).                  03160008
031700                                                                  03170011
031800     05  PV-SML-NBR.                                              03180011
031900         10  PV-SML-CARTON-TYPE      PIC  9(02).                  03190011
032000             88  PV-SML-TYPE-IS-CARTON            VALUE 00.       03200011
032100         10  PV-SML-POSITION-3-TO-4  PIC  9(02).                  03210022
032200             88  PV-SML-POS-3-TO-4-VALID          VALUE 42.       03220022
032300         10  PV-SML-POSITION-5       PIC  9(01).                  03230011
032400         10  PV-SML-STORE-NBR        PIC  9(04).                  03240011
032500         10  PV-SML-DC-NBR           PIC  9(03).                  03250011
032600         10  PV-SML-SEQ-NBR          PIC  9(08).                  03260011
032700                                                                  03270000
032800******************************************************************03280000
032900*  COPYBOOKS.                                                     03290000
033000******************************************************************03300000
033100                                                                  03310000
033200*----------------------------------------------------------------*03320000
033300*    NUMERIC EDIT ROUTINE LAYOUT                                  03330000
033400*----------------------------------------------------------------*03340000
033500     COPY DPWS010I.                                               03350000
033600                                                                  03360000
033700*----------------------------------------------------------------*03370000
033800*    PARCED SHIPMENT INPUT FILE LAYOUT                            03380003
033900*----------------------------------------------------------------*03390000
034000     COPY RCRD118.                                                03400003
034100                                                                  03410000
034200*----------------------------------------------------------------*03420000
034300*    VALID SHIPMENT DATA OUPTPUT FILE LAYOUT                      03430003
034400*----------------------------------------------------------------*03440000
034500     COPY RCRD119.                                                03450003
034600                                                                  03460000
034700*----------------------------------------------------------------*03470003
034800*    INVALID SHIPMENT DATA OUTPUT FILE LAYOUT                     03480046
034900*----------------------------------------------------------------*03490003
035000     COPY RCRD120.                                                03500003
035100                                                                  03510003
035110*----------------------------------------------------------------*03511046
035120*    ERROR COUNT DATA OUTPUT FILE LAYOUT                          03512046
035130*----------------------------------------------------------------*03513046
035140     COPY RCRD122.                                                03514046
035150                                                                  03515046
035200***************************************************************** 03520000
035300*  *** DB2 MESSAGE AREAS ****                                   * 03530000
035400***************************************************************** 03540000
035500     COPY DPWS004.                                                03550000
035600                                                                  03560000
035700*---------------------------------------------------------------* 03570000
035800*    DB2 AREA FOR TPURCHS - PURCHASE ORDER HEADER TABLE         * 03580000
035900*---------------------------------------------------------------* 03590000
036000     EXEC SQL                                                     03600000
036100          INCLUDE TPURCHS                                         03610000
036200     END-EXEC.                                                    03620000
036300                                                                  03630000
036400*---------------------------------------------------------------* 03640000
036500*    DB2 AREA FOR TPOINST - PURCHASE ORDER INSTRUCTIONS TABLE   * 03650000
036600*---------------------------------------------------------------* 03660000
036700     EXEC SQL                                                     03670000
036800          INCLUDE TPOINST                                         03680000
036900     END-EXEC.                                                    03690000
037000                                                                  03700000
037100*---------------------------------------------------------------* 03710000
037200*    DB2 AREA FOR TINSTCD - INSTRUCTIONS CODE TABLE             * 03720000
037300*---------------------------------------------------------------* 03730000
037400     EXEC SQL                                                     03740000
037500          INCLUDE TINSTCD                                         03750000
037600     END-EXEC.                                                    03760000
037700                                                                  03770000
037800*---------------------------------------------------------------* 03780000
037900*    DB2 AREA FOR TPURITM - PURCHASE ORDER ITEM TABLE           * 03790000
038000*---------------------------------------------------------------* 03800000
038100     EXEC SQL                                                     03810000
038200          INCLUDE TPURITM                                         03820000
038300     END-EXEC.                                                    03830000
038400                                                                  03840000
038500*---------------------------------------------------------------* 03850000
038600*    DB2 AREA FOR XLT_LOC - LOCATION TABLE                      * 03860003
038700*---------------------------------------------------------------* 03870000
038800     EXEC SQL                                                     03880000
038900          INCLUDE XLT00010                                        03890000
039000     END-EXEC.                                                    03900000
039100                                                                  03910000
039200*---------------------------------------------------------------* 03920003
039300*    DB2 AREA FOR XLT_DC_LOC_ASGMT - STORE TO DC TABLE          * 03930003
039400*---------------------------------------------------------------* 03940003
039500     EXEC SQL                                                     03950003
039600          INCLUDE XLT00014                                        03960003
039700     END-EXEC.                                                    03970003
039800                                                                  03980003
039900*---------------------------------------------------------------* 03990000
040000*    DB2 AREA FOR XLT_UPC - LOGISTICS DOMAIN UPC TABLE          * 04000000
040100*---------------------------------------------------------------* 04010000
040200     EXEC SQL                                                     04020000
040300          INCLUDE XLT00006                                        04030000
040400     END-EXEC.                                                    04040000
040500                                                                  04050000
040600*---------------------------------------------------------------* 04060000
040700*    DB2 AREA FOR XLT_SKU - LOGISTICS DOMAIN SKU TABLE          * 04070000
040800*---------------------------------------------------------------* 04080000
040900     EXEC SQL                                                     04090000
041000          INCLUDE XLT00003                                        04100000
041100     END-EXEC.                                                    04110000
041200                                                                  04120000
041300*---------------------------------------------------------------* 04130000
041400*    DB2 AREA FOR XLT_VND_STYL - LOGISTICS DOMAIN STYLE TABLE   * 04140000
041500*---------------------------------------------------------------* 04150000
041600     EXEC SQL                                                     04160000
041700          INCLUDE XLT00004                                        04170000
041800     END-EXEC.                                                    04180000
041900                                                                  04190000
042000*---------------------------------------------------------------* 04200000
042100*    DB2 AREA FOR SUT_OTBND_CART - OUTBOUND CARTON HEADER TABLE * 04210003
042200*---------------------------------------------------------------* 04220000
042300     EXEC SQL                                                     04230000
042400          INCLUDE SUT00024                                        04240003
042500     END-EXEC.                                                    04250000
042600                                                                  04260000
042700*---------------------------------------------------------------* 04270000
042800*    DB2 AREA FOR COMMUNICATIONS                                * 04280000
042900*---------------------------------------------------------------* 04290000
043000     EXEC SQL                                                     04300000
043100          INCLUDE SQLCA                                           04310000
043200     END-EXEC.                                                    04320000
043300                                                                  04330000
043400***************************************************************** 04340000
043500                                                                  04350000
043600 LINKAGE SECTION.                                                 04360000
043700                                                                  04370000
043800***************************************************************** 04380000
043900 PROCEDURE DIVISION.                                              04390000
044000***************************************************************** 04400000
044100                                                                  04410000
044200 0000-MAINLINE-PROCESSING.                                        04420000
044300                                                                  04430000
044400     DISPLAY 'START OF PROGRAM RCKUT190'.                         04440004
044500                                                                  04450000
044600     MOVE PC-PROGRESSIVE-READ-LIMIT TO PV-DISP-NBR.               04460000
044700     DISPLAY 'PROGRESSIVE READ DISPLAY TRIGGER IS:  '             04470000
044800             PV-DISP-NBR.                                         04480000
044900     DISPLAY ' '.                                                 04490000
045000                                                                  04500000
045100     PERFORM 1000-INITIALIZATION.                                 04510000
045200                                                                  04520000
045300     PERFORM 2000-PROCESS-PARSED-RECS                             04530005
045400       UNTIL END-OF-FILE.                                         04540000
045500                                                                  04550000
045600     IF  PV-READ-COUNT = 0                                        04560000
045700         DISPLAY '*** EMPTY INPUT FILE ***'                       04570000
045800         DISPLAY ' '                                              04580000
045900     END-IF.                                                      04590000
046000                                                                  04600000
046100     PERFORM 8500-SHOW-COUNTERS.                                  04610000
046200     PERFORM 8600-WRITE-ERROR-COUNTS.                             04620045
046210                                                                  04621045
046300     CLOSE PARSED-SHIPMENT-FILE                                   04630005
046400           VALID-DATA-OUTPUT-FILE                                 04640005
046500           INVALID-DATA-OUTPUT-FILE                               04650045
046510           ERROR-COUNTS-OUTPUT-FILE.                              04651045
046600                                                                  04660000
046700     STOP RUN.                                                    04670000
046800                                                                  04680000
046900                                                                  04690000
047000******************************************************************04700000
047100*  OPEN FILES, READ THE FIRST INPUT RECORD AND PRINT THE REPORT  *04710000
047200*  HEADINGS.                                                     *04720000
047300******************************************************************04730000
047400 1000-INITIALIZATION.                                             04740000
047500                                                                  04750000
047600     OPEN INPUT  PARSED-SHIPMENT-FILE.                            04760005
047700     OPEN OUTPUT VALID-DATA-OUTPUT-FILE                           04770005
047800                 INVALID-DATA-OUTPUT-FILE                         04780045
047900                 ERROR-COUNTS-OUTPUT-FILE.                        04790045
048000** GET CURRENT TIMESTAMP                                          04800000
048100                                                                  04810000
048200     EXEC SQL                                                     04820000
048300         SET :PV-CURRENT-TMST-DB2 = CURRENT TIMESTAMP             04830000
048400     END-EXEC.                                                    04840000
048500                                                                  04850000
048600     EVALUATE TRUE                                                04860000
048700         WHEN SQLCODE = ZERO                                      04870000
048800             MOVE PV-CURRENT-TMST-DB2    TO PV-CURRENT-TMST       04880000
048900                                                                  04890000
049000         WHEN OTHER                                               04900000
049100             MOVE '1000-INITIALIZATION'  TO PV-ABEND-PARAGRAPH    04910000
049200             MOVE 'SET CURRENT TIMESTAMP'                         04920000
049300                                         TO PV-ABEND-OPERATION    04930000
049400             PERFORM 9900-DB2-ABEND                               04940000
049500         END-EVALUATE.                                            04950000
049600                                                                  04960000
049700     PERFORM 7000-READ-INPUT.                                     04970000
049800                                                                  04980000
049900                                                                  04990000
050000******************************************************************05000000
050100*  THIS IS THE CONTROL PARAGRAPH FOR THE PROCESSING OF THE DATA  *05010000
050200*  FROM THE INPUT FILE.  IT WILL DO SOME INTIAL DATA CHECKS AND  *05020000
050300*  THEN PERFORM OTHER PARAGRAPHS TO FURTHER EDIT THE DATA BEFORE *05030000
050400*  THE DATA IS EITHER WRITTEN TO THE VALID DATA FILE OR THE      *05040042
050500*  INVALID DATA FILE.                                            *05050042
050600******************************************************************05060000
050700 2000-PROCESS-PARSED-RECS.                                        05070005
050800                                                                  05080000
050900     PERFORM 3000-PROCESS-DETAIL-RECORD.                          05090005
051000                                                                  05100000
051100     PERFORM 7000-READ-INPUT.                                     05110000
051200                                                                  05120000
051300******************************************************************05130000
051400*  THIS WILL CONTROL THE PROCESSING OF THE INDIVDIDUAL DETAIL    *05140000
051500*  RECORDS FROM THE INPUT FILE.  THIS WILL CALL PARAGRAPHS TO    *05150000
051600*  VALIDATE THE DATA WITHIN THE RECROD.  WHEN DONE, IF THERE ARE *05160005
051700*  NO ERRORS IN THE DATA, THE RECORD WILL BE WRITTEN TO THE      *05170005
051800*  VALID FILE.  IF THERE ARE ERRORS IN THE DATA, THEN RECORD     *05180005
051900*  WILL BE WRITTEN TO THE INVALID FILE.                          *05190005
052000******************************************************************05200000
052100 3000-PROCESS-DETAIL-RECORD.                                      05210000
052200                                                                  05220000
052300     SET PS-ERROR-NO TO TRUE.                                     05230024
052400                                                                  05240024
052500     SET RC120-3PDCNBR-VALID TO TRUE.                             05250005
052600     SET RC120-KSDCNBR-VALID TO TRUE.                             05260005
052700     SET RC120-SHPDTE-VALID  TO TRUE.                             05270005
052800     SET RC120-CUSTORD-VALID TO TRUE.                             05280005
052900     SET RC120-KPONBR-VALID  TO TRUE.                             05290005
053000     SET RC120-DSTSTR-VALID  TO TRUE.                             05300012
053100     SET RC120-SMLNBR-VALID  TO TRUE.                             05310005
053200     SET RC120-CORDLN-VALID  TO TRUE.                             05320005
053300     SET RC120-SKUNBR-VALID  TO TRUE.                             05330005
053400     SET RC120-SHPQTY-VALID  TO TRUE.                             05340005
053500     SET RC120-ORDQTY-VALID  TO TRUE.                             05350005
053600                                                                  05360006
053700     MOVE RC118-3RD-PRTY-DC-NBR      TO RC120-3RD-PRTY-DC-NBR.    05370007
053800     MOVE RC118-KOHLS-SHIP-TO-DC-NBR TO                           05380007
053900          RC120-KOHLS-SHIP-TO-DC-NBR.                             05390007
054000     MOVE RC118-SHIP-SCAC            TO RC120-SHIP-SCAC           05400007
054100                                        RC119-SHIP-SCAC.          05410007
054200     MOVE RC118-SHIP-TRAILER-NBR     TO RC120-SHIP-TRAILER-NBR    05420007
054300                                        RC119-SHIP-VEH-NBR.       05430007
054400     MOVE RC118-SHIP-BOL             TO RC120-SHIP-BOL            05440007
054500                                        RC119-SHIP-BOL-NBR.       05450007
054600     MOVE RC118-SHIP-PRO             TO RC120-SHIP-PRO            05460007
054700                                        RC119-SHIP-PRO-NBR.       05470007
054800     MOVE RC118-SHIP-DATE            TO RC120-SHIP-DATE.          05480007
054900     MOVE RC118-CUST-ORDER-NBR       TO RC120-CUST-ORDER-NBR.     05490007
055000     MOVE RC118-KOHLS-PO-NBR         TO RC120-KOHLS-PO-NBR.       05500018
055100     MOVE RC118-3RD-PRTY-ORDER-NBR   TO RC120-3RD-PRTY-ORDER-NBR  05510007
055200                                        RC119-3RD-PRTY-ORDER-NBR. 05520007
055300     MOVE RC118-DEST-STORE-NBR       TO RC120-DEST-STORE-NBR.     05530012
055400     MOVE RC118-SML-NBR              TO RC120-SML-NBR.            05540007
055500     MOVE RC118-3RD-PRTY-CARTON-ID   TO RC120-3RD-PRTY-CARTON-ID  05550007
055600                                        RC119-3RD-PRTY-CARTON-ID. 05560007
055700     MOVE RC118-CUST-ORDER-LINE-NBR  TO RC120-CUST-ORDER-LINE-NBR 05570007
055800                                        RC119-CUST-ORDER-LINE-NBR.05580016
055900     MOVE RC118-SKU-NBR              TO RC120-SKU-NBR.            05590007
056000     MOVE RC118-SHIP-QTY             TO RC120-SHIP-QTY.           05600007
056100     MOVE RC118-ORDER-QTY            TO RC120-ORDER-QTY.          05610007
056200     MOVE 0                          TO RC119-REC-SEQ-NBR         05620013
056300                                        RC119-KOHLS-PO-LINE-NBR.  05630013
056400                                                                  05640007
056500     PERFORM 3200-CHECK-NUMERIC-FIELDS.                           05650008
056600                                                                  05660013
056700     IF  PS-NUMERIC-ERROR-YES                                     05670013
056800         ADD +1 TO PV-ERR-NON-NUMERIC-CNT                         05680013
056900     END-IF.                                                      05690013
057000                                                                  05700008
057100     IF  RC120-KPONBR-VALID                                       05710008
057200         PERFORM 3300-VALIDATE-PO-NUMBER                          05720008
057300     END-IF.                                                      05730008
057400                                                                  05740000
057500     IF  RC120-SKUNBR-VALID                                       05750008
057600         PERFORM 3400-VALIDATE-SKU-NUMBER                         05760008
057700     END-IF.                                                      05770008
057800                                                                  05780000
057900     IF  RC120-SMLNBR-VALID                                       05790008
058000         PERFORM 3500-VALIDATE-SML-NUMBER                         05800008
058100     END-IF.                                                      05810008
058200                                                                  05820000
058300     IF  RC120-3PDCNBR-VALID                                      05830008
058400         PERFORM 3600-VALIDATE-3RD-PARTY-DC                       05840008
058500     END-IF.                                                      05850008
058600                                                                  05860000
058700     IF  RC120-DSTSTR-VALID                                       05870012
058800         PERFORM 3650-VALIDATE-DEST-STR-NBR                       05880012
058900     END-IF.                                                      05890012
059000                                                                  05900012
059100     IF  RC120-CUSTORD-VALID                                      05910012
059200         PERFORM 3700-CUST-ORD-COMPONENTS                         05920008
059300     END-IF.                                                      05930008
059400                                                                  05940000
059500     IF  RC120-KSDCNBR-VALID                                      05950013
059600         PERFORM 3800-VALIDATE-SHIP-TO-DC                         05960013
059700     END-IF.                                                      05970008
059800                                                                  05980000
059900     IF  PS-ERROR-NO                                              05990000
059910         ADD +1 TO PV-VALID-WRITE-COUNT                           05991041
059920         MOVE PV-VALID-WRITE-COUNT TO                             05992041
059930              RC119-VALID-FILE-RECORD-NBR                         05993041
060000         WRITE VALID-DATA-OUTPUT-RECORD                           06000005
060100          FROM RC119-VALID-SHIPMENT-REC                           06010005
060200         ADD RC119-SHIP-UNT-QTY TO                                06020043
060300             PV-TOTAL-VALID-SHIP-QTY                              06030043
060600     ELSE                                                         06060005
060610         ADD +1 TO PV-INVALID-WRITE-COUNT                         06061037
060620         MOVE PV-INVALID-WRITE-COUNT TO                           06062037
060630              RC120-INVALID-FILE-RECORD-NBR                       06063038
060700         SET RC120-ERROR-RECORD TO TRUE                           06070013
060800         WRITE INVALID-DATA-OUTPUT-RECORD                         06080005
060900          FROM RC120-INVALID-SHIPMENT-REC                         06090005
061100         DISPLAY ' SKIPPING TO NEXT RECORD'                       06110025
061200         DISPLAY ' '                                              06120025
061700     END-IF.                                                      06170000
061800                                                                  06180000
061900                                                                  06190000
062000******************************************************************06200000
062100*  THIS PARAGRAPH WILL TAKE THE INDIVIDUAL FIELDS THAT SHOULD    *06210000
062200*  CONTAIN ONLY NUMERIC DATA AND PERFORM A CHECK TO CONFIRM THAT *06220000
062300*  THEY CONTAIN ONLY NUMERIC VALUES.  ANYTHING OTHER THAN A      *06230000
062400*  NUMBER VALUE IN THE CHECKED FIELDS WILL INDICATE AN ERROR AND *06240000
062500*  DATA WILL BE WRITTEN TO THE INVALID DATA FILE AND REJECTED    *06250005
062600*  FROM FURTHER PROCESSING OF THE DATA.                          *06260005
062700******************************************************************06270000
062800 3200-CHECK-NUMERIC-FIELDS.                                       06280000
062900                                                                  06290000
063000     SET PS-NUMERIC-ERROR-NO TO TRUE.                             06300000
063100                                                                  06310000
063200* NUMERIC CHECK THE KOHLS PO NUMBER                               06320007
063300     MOVE RC118-KOHLS-PO-NBR TO DP010I-UNEDITED-FIELD.            06330007
063400     MOVE 8                  TO DP010I-MAXIMUM-DIGITS.            06340007
063500     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          06350000
063600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     06360000
063700     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06370005
063800          USING DP010I-NUMERIC-EDIT-AREA.                         06380005
063900     IF  DP010I-ERROR-DETECTED                                    06390000
064000     OR  DP010I-DIGIT-COUNT = 0                                   06400032
064100         SET PS-NUMERIC-ERROR-YES TO TRUE                         06410000
064200         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      06420025
064300         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            06430025
064400         DISPLAY 'KOHLS PO NBR NUMERIC CHECK: ' RC118-KOHLS-PO-NBR06440007
064500         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        06450000
064600         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 06460033
064700         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          06470033
064800         IF  DP010I-ERROR-DETECTED                                06480035
064900             SET RC120-KPONBR-NOT-NUMERIC TO TRUE                 06490033
065000         ELSE                                                     06500033
065100             SET RC120-KPONBR-MISSING TO TRUE                     06510033
065110             DISPLAY 'KOHL PO NUMBER MISSING'                     06511034
065120             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    06512034
065200         END-IF                                                   06520033
065300     ELSE                                                         06530000
065400         MOVE DP010I-NUMERIC-FIELD TO RC119-KOHLS-PO-NBR          06540007
065500     END-IF.                                                      06550000
065600                                                                  06560019
065700* NUMERIC CHECK THE THIRD PARTY DC NUMBER                         06570007
065800     MOVE RC118-3RD-PRTY-DC-NBR TO DP010I-UNEDITED-FIELD.         06580007
065900     MOVE 4                     TO DP010I-MAXIMUM-DIGITS.         06590007
066000     MOVE 0                     TO DP010I-MAXIMUM-DECIMALS.       06600007
066100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     06610007
066200     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06620007
066300          USING DP010I-NUMERIC-EDIT-AREA.                         06630007
066400     IF  DP010I-ERROR-DETECTED                                    06640007
066500     OR  DP010I-DIGIT-COUNT = 0                                   06650032
066600         SET PS-NUMERIC-ERROR-YES TO TRUE                         06660007
066700         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      06670025
066800         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            06680025
066900         DISPLAY '3RD PARTY DC NUMERIC CHECK: '                   06690007
067000                 RC118-3RD-PRTY-DC-NBR                            06700007
067100         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        06710007
067200         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 06720033
067300         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          06730033
067400         IF  DP010I-ERROR-DETECTED                                06740035
067500             SET RC120-3PDCNBR-NOT-NUMERIC TO TRUE                06750033
067600         ELSE                                                     06760033
067700             SET RC120-3PDCNBR-MISSING TO TRUE                    06770033
067710             DISPLAY '3RD PARTY DC NUMBER MISSING'                06771034
067720             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    06772034
067800         END-IF                                                   06780033
067900     ELSE                                                         06790007
068000         MOVE DP010I-NUMERIC-FIELD TO RC119-3RD-PRTY-DC-NBR       06800007
068100     END-IF.                                                      06810007
068200                                                                  06820007
068300* NUMERIC CHECK THE SHIP TO KOHLS DC NUMBER                       06830007
068400     MOVE RC118-KOHLS-SHIP-TO-DC-NBR TO DP010I-UNEDITED-FIELD.    06840007
068500     MOVE 4                          TO DP010I-MAXIMUM-DIGITS.    06850007
068600     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  06860007
068700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     06870007
069100     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06910007
069200          USING DP010I-NUMERIC-EDIT-AREA.                         06920007
069300                                                                  06930042
069600     IF  DP010I-ERROR-DETECTED                                    06960007
069700     OR  DP010I-DIGIT-COUNT = 0                                   06970032
069800         SET PS-NUMERIC-ERROR-YES TO TRUE                         06980007
069900         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      06990025
070000         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            07000025
070100         DISPLAY 'KOHL SHIP DC NUMERIC CHECK: '                   07010007
070200                 RC118-KOHLS-SHIP-TO-DC-NBR                       07020007
070300         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07030007
070400         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 07040033
070500         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          07050033
070600         IF  DP010I-ERROR-DETECTED                                07060035
070700             SET RC120-KSDCNBR-NOT-NUMERIC TO TRUE                07070033
070800         ELSE                                                     07080033
070900             SET RC120-KSDCNBR-MISSING TO TRUE                    07090033
071000             DISPLAY 'KOHL SHIP DC NUMBER MISSING'                07100034
071010             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    07101034
071100         END-IF                                                   07110033
071200     ELSE                                                         07120033
071300         MOVE DP010I-NUMERIC-FIELD TO RC119-SHIP-TO-DC-NBR        07130007
071400     END-IF.                                                      07140007
071500                                                                  07150007
071600* NUMERIC CHECK THE DESTINATION STORE NUMBER                      07160012
071700     MOVE RC118-DEST-STORE-NBR       TO DP010I-UNEDITED-FIELD.    07170012
071800     MOVE 4                          TO DP010I-MAXIMUM-DIGITS.    07180012
071900     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  07190012
072000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07200012
072100     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07210012
072200          USING DP010I-NUMERIC-EDIT-AREA.                         07220012
072300     IF  DP010I-ERROR-DETECTED                                    07230012
072400     OR  DP010I-DIGIT-COUNT = 0                                   07240032
072500         SET PS-NUMERIC-ERROR-YES TO TRUE                         07250012
072600         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      07260025
072700         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            07270025
072800         DISPLAY 'DEST STORE NUMERIC CHECK: '                     07280012
072900                 RC118-DEST-STORE-NBR                             07290012
073000         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07300012
073100         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 07310033
073200         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          07320033
073300         IF  DP010I-ERROR-DETECTED                                07330035
073400             SET RC120-DSTSTR-NOT-NUMERIC TO TRUE                 07340033
073500         ELSE                                                     07350033
073600             SET RC120-DSTSTR-MISSING TO TRUE                     07360033
073610             DISPLAY 'DEST STORE NUMBER MISSING'                  07361034
073620             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    07362034
073700         END-IF                                                   07370033
073800     ELSE                                                         07380012
073900         MOVE DP010I-NUMERIC-FIELD TO RC119-DEST-STORE-NBR        07390012
074000     END-IF.                                                      07400012
074100                                                                  07410012
074200* NUMERIC CHECK THE SHIP DATE                                     07420012
074300     MOVE RC118-SHIP-DATE            TO DP010I-UNEDITED-FIELD.    07430007
074400     MOVE 8                          TO DP010I-MAXIMUM-DIGITS.    07440007
074500     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  07450007
074600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07460007
074700     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07470007
074800          USING DP010I-NUMERIC-EDIT-AREA.                         07480007
074900     IF  DP010I-ERROR-DETECTED                                    07490007
075000     OR  DP010I-DIGIT-COUNT = 0                                   07500032
075100         SET PS-NUMERIC-ERROR-YES TO TRUE                         07510007
075200         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      07520025
075300         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            07530025
075400         DISPLAY 'SHIP DATE NUMERIC CHECK:    '                   07540007
075500                 RC118-SHIP-DATE                                  07550007
075600         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07560007
075700         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 07570033
075800         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          07580033
075900         IF  DP010I-ERROR-DETECTED                                07590035
076000             SET RC120-SHPDTE-NOT-NUMERIC  TO TRUE                07600033
076100         ELSE                                                     07610033
076200             SET RC120-SHPDTE-MISSING TO TRUE                     07620033
076210             DISPLAY 'SHIP DATE MISSING'                          07621034
076220             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    07622034
076300         END-IF                                                   07630033
076400     ELSE                                                         07640007
076500         IF  DP010I-DIGIT-COUNT = 8                               07650007
076600             MOVE DP010I-NUMERIC-FIELD TO PV-SHIP-DATE            07660007
076700             MOVE PV-SHIP-DATE TO PV-SHIP-DATE-ALPHA              07670007
076800             MOVE PV-SHIP-DATE-YYYY TO RC119-SHIP-DATE-YYYY       07680007
076900             MOVE PV-SHIP-DATE-MM   TO RC119-SHIP-DATE-MM         07690007
077000             MOVE PV-SHIP-DATE-DD   TO RC119-SHIP-DATE-DD         07700007
077100             MOVE '-'               TO RC119-SHIP-DATE-DASH1      07710007
077200                                       RC119-SHIP-DATE-DASH2      07720007
077300         ELSE                                                     07730007
077400             SET PS-NUMERIC-ERROR-YES TO TRUE                     07740007
077500             SET RC120-SHPDTE-FORMAT-ISSUE TO TRUE                07750007
077600             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  07760025
077700             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        07770025
077800             DISPLAY 'SHIP DATE FORMAT ISSUE :    '               07780008
077900                     RC118-SHIP-DATE                              07790008
078000             DISPLAY 'LESS THAN 8 DIGITS IN DATE FIELD'           07800008
078100         END-IF                                                   07810008
078200     END-IF.                                                      07820007
078300                                                                  07830008
078400* NUMERIC CHECK THE COMPONENTS OF THE CUSTOMER ORDER NUMBER       07840008
078500     MOVE RC118-CUST-ORDER-NBR  TO PV-CUST-ORDER-NBR.             07850008
078600                                                                  07860008
078700     IF  PV-CUST-ORDER-DASH = '-'                                 07870008
078800         MOVE PV-CUST-ORDER-KOHLS-PO TO DP010I-UNEDITED-FIELD     07880008
078900         MOVE 8                      TO DP010I-MAXIMUM-DIGITS     07890008
079000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   07900008
079100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07910008
079200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07920008
079300              USING DP010I-NUMERIC-EDIT-AREA                      07930008
079400         IF  DP010I-ERROR-DETECTED                                07940008
079500         OR  DP010I-DIGIT-COUNT = 0                               07950032
079600             SET PS-NUMERIC-ERROR-YES TO TRUE                     07960008
079700             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  07970025
079800             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        07980025
079900             DISPLAY 'CUST ORD PO NUMERIC CHECK:  '               07990008
080000                     PV-CUST-ORDER-KOHLS-PO                       08000008
080100             DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND    08010008
080200             MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4             08020033
080300             DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4      08030033
080400             IF  DP010I-ERROR-DETECTED                            08040035
080500                 SET RC120-CUSTORD-FORMAT-ISSUE TO TRUE           08050033
080600             ELSE                                                 08060033
080700                 SET RC120-CUSTORD-MISSING TO TRUE                08070033
080710                 DISPLAY 'CUSTOMER ORDER NBR MISSING'             08071034
080720                 ADD +1 TO PV-ERR-DATA-MISSING-CNT                08072034
080800             END-IF                                               08080033
080900         ELSE                                                     08090008
081000             IF  DP010I-DIGIT-COUNT = 8                           08100008
081100                 MOVE DP010I-NUMERIC-FIELD TO                     08110008
081200                      RC119-CUST-ORD-KOHLS-PO                     08120008
081300                 MOVE '-' TO RC119-CUST-ORD-DASH                  08130008
081400             ELSE                                                 08140008
081500                 SET PS-NUMERIC-ERROR-YES TO TRUE                 08150008
081600                 SET RC120-CUSTORD-FORMAT-ISSUE TO TRUE           08160008
081700                 MOVE PV-READ-COUNT TO PV-DISP-NBR-C              08170025
081800                 DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C    08180025
081900                 DISPLAY 'CUST ORD FORMAT ISSUE :     '           08190008
082000                         RC118-CUST-ORDER-NBR                     08200008
082100                 DISPLAY 'LESS THAN 8 DIGITS IN PO FIELD'         08210008
082200             END-IF                                               08220008
082300         END-IF                                                   08230008
082400     ELSE                                                         08240008
082500         SET PS-NUMERIC-ERROR-YES TO TRUE                         08250008
082600         SET RC120-CUSTORD-FORMAT-ISSUE TO TRUE                   08260008
082700         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      08270025
082800         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            08280025
082900         DISPLAY 'CUST ORD FORMAT ISSUE :     '                   08290008
083000                 RC118-CUST-ORDER-NBR                             08300008
083100         DISPLAY 'POSITION 9 IS NOT A DASH TO SEPARATE FIELDS'    08310008
083200     END-IF.                                                      08320008
083300                                                                  08330008
083400     IF  PV-CUST-ORDER-DASH = '-'                                 08340008
083500         MOVE PV-CUST-ORDER-STR-NBR  TO DP010I-UNEDITED-FIELD     08350008
083600         MOVE 4                      TO DP010I-MAXIMUM-DIGITS     08360008
083700         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   08370008
083800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08380008
083900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08390008
084000              USING DP010I-NUMERIC-EDIT-AREA                      08400008
084100         IF  DP010I-ERROR-DETECTED                                08410008
084200         OR  DP010I-DIGIT-COUNT = 0                               08420032
084300             SET PS-NUMERIC-ERROR-YES TO TRUE                     08430008
084400             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  08440025
084500             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        08450025
084600             DISPLAY 'CUST ORD STR NUMERIC CHECK: '               08460008
084700                     PV-CUST-ORDER-STR-NBR                        08470016
084800             DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND    08480008
084900             MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4             08490033
085000             DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4      08500033
085100             IF  DP010I-ERROR-DETECTED                            08510035
085200                 SET RC120-CUSTORD-FORMAT-ISSUE TO TRUE           08520033
085300             ELSE                                                 08530033
085400                 SET RC120-CUSTORD-MISSING TO TRUE                08540033
085410                 DISPLAY 'CUSTOMER ORDER NBR MISSING'             08541034
085420                 ADD +1 TO PV-ERR-DATA-MISSING-CNT                08542034
085500             END-IF                                               08550033
085600         ELSE                                                     08560008
085700             MOVE DP010I-NUMERIC-FIELD TO                         08570008
085800                  RC119-CUST-ORD-STR-NBR                          08580008
085900         END-IF                                                   08590008
086000     END-IF.                                                      08600008
086100                                                                  08610008
086200     IF  RC118-SML-NBR = SPACES                                   08620032
086300     OR  RC118-SML-NBR = LOW-VALUES                               08630032
086400         SET PS-NUMERIC-ERROR-YES TO TRUE                         08640032
086500         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      08650032
086600         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            08660032
086700         DISPLAY 'SML NUMBER IS MISSING               '           08670036
086800         DISPLAY 'FULL SML NUMBER FROM INPUT FILE IS: '           08680032
086900                 RC118-SML-NBR                                    08690032
087000         SET RC120-SMLNBR-MISSING TO TRUE                         08700036
087010         ADD +1 TO PV-ERR-DATA-MISSING-CNT                        08701036
087100     ELSE                                                         08710032
087200         PERFORM 3220-NUMERIC-CHECK-SML                           08720032
087300     END-IF.                                                      08730032
087400                                                                  08740032
087500* NUMERIC CHECK THE CUSTOMER ORDER LINE NUMBER                    08750008
087600* SINCE WE ARE USING THIS FIELD ONLY FOR REPORTING, IF            08760008
087700* IT IS NOT NUMERIC, WE WILL SET TO ZERO AND NOT ERROR OUT        08770008
087800* THE RECORD                                                      08780008
087900     MOVE RC118-CUST-ORDER-LINE-NBR TO DP010I-UNEDITED-FIELD.     08790008
088000     MOVE 4                         TO DP010I-MAXIMUM-DIGITS.     08800008
088100     MOVE 0                         TO DP010I-MAXIMUM-DECIMALS.   08810008
088200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     08820008
088300     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08830008
088400          USING DP010I-NUMERIC-EDIT-AREA.                         08840008
088500     IF  DP010I-ERROR-DETECTED                                    08850008
088600         MOVE 0000 TO RC119-CUST-ORDER-LINE-NBR                   08860008
088700     ELSE                                                         08870008
088800         MOVE DP010I-NUMERIC-FIELD TO                             08880008
088900              RC119-CUST-ORDER-LINE-NBR                           08890008
089000     END-IF.                                                      08900008
089100                                                                  08910008
089200* NUMERIC CHECK THE SKU NUMBER                                    08920008
089300     MOVE RC118-SKU-NBR              TO DP010I-UNEDITED-FIELD.    08930008
089400     MOVE 8                          TO DP010I-MAXIMUM-DIGITS.    08940008
089500     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  08950008
089600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     08960008
089700     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08970008
089800          USING DP010I-NUMERIC-EDIT-AREA.                         08980008
089900     IF  DP010I-ERROR-DETECTED                                    08990008
090000     OR  DP010I-DIGIT-COUNT = 0                                   09000032
090100         SET PS-NUMERIC-ERROR-YES TO TRUE                         09010008
090200         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      09020025
090300         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            09030025
090400         DISPLAY 'SKU NUMBER NUMERIC CHECK:   '                   09040008
090500                 RC118-SKU-NBR                                    09050008
090600         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        09060008
090700         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 09070033
090800         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          09080033
090900         IF  DP010I-ERROR-DETECTED                                09090035
091000             SET RC120-SKUNBR-NOT-NUMERIC TO TRUE                 09100033
091100         ELSE                                                     09110033
091200             SET RC120-SKUNBR-MISSING TO TRUE                     09120033
091210             DISPLAY 'SKU NUMBER MISSING'                         09121034
091220             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    09122034
091300         END-IF                                                   09130033
091400     ELSE                                                         09140008
091500         MOVE DP010I-NUMERIC-FIELD TO RC119-SKU-NBR               09150008
091600     END-IF.                                                      09160008
091700                                                                  09170008
091800* NUMERIC CHECK THE SHIP QUANTITY                                 09180008
091900     MOVE RC118-SHIP-QTY             TO DP010I-UNEDITED-FIELD.    09190008
092000     MOVE 5                          TO DP010I-MAXIMUM-DIGITS.    09200008
092100     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  09210008
092200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     09220008
092300     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09230008
092400          USING DP010I-NUMERIC-EDIT-AREA.                         09240008
092500     IF  DP010I-ERROR-DETECTED                                    09250008
092600     OR  DP010I-DIGIT-COUNT = 0                                   09260032
092700         SET PS-NUMERIC-ERROR-YES TO TRUE                         09270008
092800         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      09280025
092900         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            09290025
093000         DISPLAY 'SHIP QTY NUMERIC CHECK:     '                   09300008
093100                 RC118-SHIP-QTY                                   09310008
093200         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        09320008
093300         MOVE DP010I-DIGIT-COUNT TO PV-DISP-NBR-4                 09330033
093400         DISPLAY '** DP010I-DIGIT-COUNT: ' PV-DISP-NBR-4          09340033
093500         IF  DP010I-ERROR-DETECTED                                09350035
093600             SET RC120-SHPQTY-NOT-NUMERIC TO TRUE                 09360033
093700         ELSE                                                     09370033
093800             SET RC120-SHPQTY-MISSING TO TRUE                     09380033
093810             DISPLAY 'SHIP QUANTITY MISSING'                      09381034
093820             ADD +1 TO PV-ERR-DATA-MISSING-CNT                    09382034
093900         END-IF                                                   09390033
094000     ELSE                                                         09400008
094100         MOVE DP010I-NUMERIC-FIELD TO RC119-SHIP-UNT-QTY          09410008
094200     END-IF.                                                      09420008
094300                                                                  09430008
094400* NUMERIC CHECK THE ORDER QUANTITY                                09440039
094410* SINCE WE ARE USING THIS FIELD ONLY FOR REPORTING, IF            09441039
094420* IT IS NOT NUMERIC, WE WILL SET TO ZERO AND NOT ERROR OUT        09442039
094500     MOVE RC118-ORDER-QTY            TO DP010I-UNEDITED-FIELD.    09450008
094600     MOVE 5                          TO DP010I-MAXIMUM-DIGITS.    09460008
094700     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  09470008
094800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     09480008
094900     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09490008
094901          USING DP010I-NUMERIC-EDIT-AREA.                         09490139
094910     IF  DP010I-ERROR-DETECTED                                    09491039
094920         MOVE 0 TO RC119-ORDER-UNT-QTY                            09492039
094930     ELSE                                                         09493039
094940         MOVE DP010I-NUMERIC-FIELD TO                             09494039
094950              RC119-ORDER-UNT-QTY                                 09495039
094960     END-IF.                                                      09496039
096900                                                                  09690000
097000     IF  PS-NUMERIC-ERROR-YES                                     09700000
097100         SET RC120-ERROR-RECORD TO TRUE                           09710008
097200         SET PS-ERROR-YES TO TRUE                                 09720013
097300     END-IF.                                                      09730000
097400                                                                  09740000
097500                                                                  09750000
097600******************************************************************09760032
097700* THIS PARAGRAPH WILL BREAK THE SML NUMBER FIELD INTO THREE      *09770032
097800* FIELDS OF 10 CHARACTERS AND PERFORM THE NUMERIC CHECK AND IF   *09780032
097900* THE SML CONTAINS THE RIGHT FIELD COMPONENTS.                   *09790032
098000******************************************************************09800032
098100 3220-NUMERIC-CHECK-SML.                                          09810032
098200                                                                  09820032
098300* NUMERIC CHECK THE FIRST 10 DIGITS OF THE SSCC NUMBER            09830032
098400     MOVE RC118-SML-NBR      TO PV-SPLIT-SML-NBR.                 09840032
098500     SET PS-SML-F10-NOT-NUMERIC TO TRUE.                          09850032
098600                                                                  09860032
098700     MOVE PV-SPLIT-SML-NBR-F10 TO DP010I-UNEDITED-FIELD.          09870032
098800     MOVE 10                 TO DP010I-MAXIMUM-DIGITS.            09880032
098900     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          09890032
099000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     09900032
099400     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09940032
099500          USING DP010I-NUMERIC-EDIT-AREA.                         09950032
099600                                                                  09960042
099900     IF  DP010I-ERROR-DETECTED                                    09990032
100000         SET PS-NUMERIC-ERROR-YES TO TRUE                         10000032
100100         SET PS-SML-F10-NOT-NUMERIC TO TRUE                       10010032
100200         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      10020032
100300         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            10030032
100400         DISPLAY 'SML FIRST 10 DIGIT NUMERIC CHECK:  '            10040032
100500                 PV-SPLIT-SML-NBR-F10                             10050032
100600         DISPLAY 'FULL SML NUMBER FROM INPUT FILE IS: '           10060032
100700                 RC118-SML-NBR                                    10070032
100800         SET RC120-SMLNBR-FORMAT-ISSUE TO TRUE                    10080032
100900     ELSE                                                         10090032
101000         IF  DP010I-DIGIT-COUNT = 10                              10100032
101100             SET PS-SML-F10-NUMERIC TO TRUE                       10110032
101200         ELSE                                                     10120032
101300             SET PS-SML-F10-NOT-NUMERIC TO TRUE                   10130032
101400         END-IF                                                   10140032
101500     END-IF.                                                      10150032
101600                                                                  10160032
101700* NUMERIC CHECK THE MIDDLE 10 DIGITS OF THE SSCC NUMBER           10170032
101800     SET PS-SML-M10-NOT-NUMERIC TO TRUE.                          10180032
101900                                                                  10190032
102000     MOVE PV-SPLIT-SML-NBR-M10 TO DP010I-UNEDITED-FIELD.          10200032
102100     MOVE 10                 TO DP010I-MAXIMUM-DIGITS.            10210032
102200     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          10220032
102300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     10230032
102400     CALL DP010I-NUMERIC-EDIT-ROUTINE                             10240032
102500          USING DP010I-NUMERIC-EDIT-AREA.                         10250032
102600     IF  DP010I-ERROR-DETECTED                                    10260032
102700         SET PS-NUMERIC-ERROR-YES TO TRUE                         10270032
102800         SET PS-SML-M10-NOT-NUMERIC TO TRUE                       10280032
102900         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      10290032
103000         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            10300032
103100         DISPLAY 'SML SECOND 10 DIGIT NUMERIC CHECK:  '           10310032
103200                 PV-SPLIT-SML-NBR-M10                             10320032
103300         DISPLAY 'FULL SML NUMBER FROM INPUT FILE IS: '           10330032
103400                 RC118-SML-NBR                                    10340032
103500         SET RC120-SMLNBR-FORMAT-ISSUE TO TRUE                    10350032
103600     ELSE                                                         10360032
103700         IF  DP010I-DIGIT-COUNT = 10                              10370032
103800             SET PS-SML-M10-NUMERIC TO TRUE                       10380032
103900         ELSE                                                     10390032
104000             SET PS-SML-M10-NOT-NUMERIC TO TRUE                   10400032
104100         END-IF                                                   10410032
104200     END-IF.                                                      10420032
104300                                                                  10430032
104400* NUMERIC CHECK THE LAST 10 DIGITS OF THE SSCC NUMBER             10440032
104500     SET PS-SML-L10-NOT-NUMERIC TO TRUE.                          10450032
104600                                                                  10460032
104700     IF  PV-SPLIT-SML-NBR-L10 = SPACES                            10470032
104800         IF  PS-SML-F10-NUMERIC                                   10480032
104900         AND PS-SML-M10-NUMERIC                                   10490032
105000             MOVE PV-SPLIT-SML-NBR TO PV-SPLIT-SML-NBR-2          10500032
105100             MOVE PV-SPLIT-SML-2-F20 TO RC119-SML-NBR             10510032
105200         ELSE                                                     10520032
105300             NEXT SENTENCE                                        10530032
105400         END-IF                                                   10540032
105500     ELSE                                                         10550032
105600         SET PS-NUMERIC-ERROR-YES TO TRUE                         10560032
105700         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      10570032
105800         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            10580032
105900         DISPLAY 'SML THIRD 10 DIGIT NUMERIC CHECK:   '           10590032
106000                 PV-SPLIT-SML-NBR-L10                             10600032
106100         DISPLAY 'THERE IS DATA BEYOND THE FIRST 20 DIGITS'       10610032
106200                 ' OF THE SML NUMBER FIELD'                       10620032
106300         DISPLAY 'FULL SML NUMBER FROM INPUT FILE IS: '           10630032
106400                 RC118-SML-NBR                                    10640032
106500         SET RC120-SMLNBR-FORMAT-ISSUE TO TRUE                    10650032
106600     END-IF.                                                      10660032
106700                                                                  10670032
106800                                                                  10680032
106900******************************************************************10690032
107000* THIS PARAGRAPH WILL TAKE THE PO NUMBER FROM THE INPUT FILE     *10700011
107100* AND VALIDATE THAT THE PO IS A VALID PO - MEANING THAT THE PO   *10710011
107200* IS FOUND ON THE TPURCHS TABLE.                                 *10720011
107300* IF THE PO IS VALID, THEN THIS PARAGRAPH WILL EXECUTE A         *10730011
107400* PARAGRAPH TO SEE IF THERE IS A SEPHORA PO NUMBER THAT IS       *10740011
107500* ASSOCIATED TO THE KOHLS PO NUMBER.                             *10750011
107600******************************************************************10760000
107700 3300-VALIDATE-PO-NUMBER.                                         10770000
107800                                                                  10780000
107900     IF  RC119-KOHLS-PO-NBR = PV-PREV-KOHLS-PO-NBR                10790011
108000         MOVE PS-PREV-KOHLS-PO-FOUND-SW TO                        10800011
108100              PS-KOHLS-PO-FOUND-SW                                10810011
108200         IF  PS-KOHLS-PO-FOUND                                    10820011
108300             MOVE PV-HOLD-SEPHORA-PO-NBR TO                       10830011
108400                  RC119-SEPHORA-PO-NBR                            10840011
108500         ELSE                                                     10850011
108600             SET RC120-KPONBR-INVALID-PO TO TRUE                  10860011
108700             SET PS-ERROR-YES TO TRUE                             10870011
108710             ADD +1 TO PV-ERR-PO-NOT-FOUND-CNT                    10871044
108720             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  10872044
108730             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        10873044
108740             DISPLAY 'PO NOT FOUND ON TPURCHS: '                  10874044
108750                     RC119-KOHLS-PO-NBR                           10875044
108800         END-IF                                                   10880011
108900     ELSE                                                         10890011
109000         MOVE RC119-KOHLS-PO-NBR TO DK-PO-NUMBER                  10900011
109100         SET PS-KOHLS-PO-NOT-FOUND TO TRUE                        10910011
109200         PERFORM 3310-TPURCHS-PO-NUMBER                           10920011
109300         MOVE RC119-KOHLS-PO-NBR TO PV-PREV-KOHLS-PO-NBR          10930011
109400         MOVE PS-KOHLS-PO-FOUND-SW TO                             10940011
109500              PS-PREV-KOHLS-PO-FOUND-SW                           10950011
109600         IF  PS-KOHLS-PO-FOUND                                    10960011
109700             PERFORM 3320-GET-SEPHORA-PO-NBR                      10970011
109800             MOVE PV-HOLD-SEPHORA-PO-NBR TO                       10980011
109900                  RC119-SEPHORA-PO-NBR                            10990011
110000         ELSE                                                     11000011
110100             SET RC120-KPONBR-INVALID-PO TO TRUE                  11010011
110200             SET PS-ERROR-YES TO TRUE                             11020011
110300             ADD +1 TO PV-ERR-PO-NOT-FOUND-CNT                    11030013
110400             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  11040013
110500             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        11050025
110600             DISPLAY 'PO NOT FOUND ON TPURCHS: '                  11060025
110700                     RC119-KOHLS-PO-NBR                           11070025
110900         END-IF                                                   11090011
111000     END-IF.                                                      11100011
111100                                                                  11110000
111200                                                                  11120000
111300******************************************************************11130000
111400* THIS PARAGRAPH WILL CHECK TO SEE IF THE KOHLS PO NUMBER ON THE *11140010
111500* INPUT RECORD IS A VALID PO NUMBER - DOES IT EXIST ON THE       *11150011
111600* TPURCHS TABLE.                                                 *11160011
111700******************************************************************11170000
111800 3310-TPURCHS-PO-NUMBER.                                          11180010
111900                                                                  11190000
112000     EXEC SQL                                                     11200000
112100          SELECT A.PO_NBR                                         11210010
112200            INTO :PURCHS-PO-NBR                                   11220000
112300            FROM TPURCHS A                                        11230010
112400          WHERE A.PO_NBR            = :DK-PO-NUMBER               11240010
112500            AND A.VER_STATUS_CDE    = 'A'                         11250010
112600          WITH UR                                                 11260000
112700     END-EXEC                                                     11270000
112800                                                                  11280000
112900     EVALUATE TRUE                                                11290000
113000         WHEN SQLCODE  = +0                                       11300000
113100             SET PS-KOHLS-PO-FOUND TO TRUE                        11310010
113200         WHEN SQLCODE  = +100                                     11320000
113300             SET PS-KOHLS-PO-NOT-FOUND TO TRUE                    11330009
113400         WHEN OTHER                                               11340000
113500             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  11350025
113600             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        11360025
113700             DISPLAY '3310-TPURCHS-PO-NUMBER DB2 ERROR'           11370010
113800             DISPLAY 'PO NBR:  ' RC119-KOHLS-PO-NBR               11380010
113900             MOVE '3310-TPURCHS-PO-NUMBER' TO PV-ABEND-PARAGRAPH  11390010
114000             MOVE 'GET PO FROM TPURCHS'                           11400010
114100                                            TO PV-ABEND-OPERATION 11410000
114200             PERFORM 9900-DB2-ABEND                               11420000
114300     END-EVALUATE.                                                11430000
114400                                                                  11440000
114500                                                                  11450000
114600******************************************************************11460000
114700* THIS PARAGRAPH WILL BE USED TO GET THE SEPHORA PO NUMBER FROM  *11470011
114800* THE PO SPECIAL INSTRUCTION TABLE.  THERE IS A POSSIBLITY THAT  *11480011
114900* THERE MAY NOT BE A SEPHORA PO NUMBER WITHIN THE SPECIAL        *11490011
115000* INSTRUCTIONS FOR THE PO - THIS IS NOT CONSIDERED AN ISSUE AS   *11500011
115100* THIS IS AN OPTIONAL FIELD.                                     *11510011
115200******************************************************************11520000
115300 3320-GET-SEPHORA-PO-NBR.                                         11530011
115400                                                                  11540000
115500     EXEC SQL                                                     11550000
115600          SELECT C.PO_NBR                                         11560000
115700               , SUBSTR(B.INSTR_DESC,13,15)                       11570011
115800            INTO :PURCHS-PO-NBR                                   11580000
115900               , :INSTCD-INSTR-DESC                               11590000
116000            FROM TPOINST A                                        11600000
116100               , TINSTCD B                                        11610000
116200               , TPURCHS C                                        11620000
116300          WHERE C.PO_NBR            = :DK-PO-NUMBER               11630011
116400            AND C.VER_STATUS_CDE    = 'A'                         11640011
116500            AND A.PO_NBR            = C.PO_NBR                    11650011
116600            AND A.RECIP_CDE         = 'VN'                        11660011
116700            AND B.INSTR_NBR         = A.INSTR_NBR                 11670011
116800            AND UPPER(B.INSTR_DESC) LIKE 'SEPHORA PO #%'          11680011
116900          WITH UR                                                 11690000
117000     END-EXEC                                                     11700000
117100                                                                  11710000
117200     EVALUATE TRUE                                                11720000
117300         WHEN SQLCODE  = +0                                       11730000
117400         WHEN SQLCODE  = -811                                     11740000
117500             MOVE INSTCD-INSTR-DESC TO PV-HOLD-SEPHORA-PO-NBR     11750011
117600         WHEN SQLCODE  = +100                                     11760000
117700             MOVE SPACES TO PV-HOLD-SEPHORA-PO-NBR                11770011
117800         WHEN OTHER                                               11780000
117900             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  11790025
118000             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        11800025
118100             DISPLAY '3320-GET-SEPHORA-PO-NBR DB2 ERROR'          11810011
118200             DISPLAY 'PO NBR:  ' RC119-KOHLS-PO-NBR               11820011
118300             MOVE '3320-GET-SEPHORA-PO-NBR' TO PV-ABEND-PARAGRAPH 11830011
118400             MOVE 'GET SEPHORA PO FROM TPOINST'                   11840011
118500                                            TO PV-ABEND-OPERATION 11850000
118600             PERFORM 9900-DB2-ABEND                               11860000
118700     END-EVALUATE.                                                11870000
118800                                                                  11880000
118900                                                                  11890000
119000******************************************************************11900000
119100* THIS PARAGRAPH WILL BE USED TO VALIDATE THE SKU NUMBER PASSED  *11910011
119200* IN THE INPUT FILE AND TIE THAT SKU NUMBER TO A UPC NUMBER AND  *11920011
119300* THEN TRY TO MATCH THE SKU TO THE KOHLS PO NUMBER TO GET THE    *11930000
119400* LINE NUMBER FOR THE PO.                                        *11940000
119500******************************************************************11950000
119600 3400-VALIDATE-SKU-NUMBER.                                        11960005
119700                                                                  11970000
119800     MOVE RC119-SKU-NBR TO DK-SKU-NUMBER.                         11980011
119900     SET PS-SKU-NOT-FOUND TO TRUE.                                11990011
120000                                                                  12000000
120100     PERFORM 3410-FIND-SKU-NBR.                                   12010011
120200                                                                  12020000
120300     IF  PS-SKU-NOT-FOUND                                         12030011
120400         SET PS-ERROR-YES TO TRUE                                 12040000
120500         SET RC120-SKUNBR-NOT-ON-MSTR TO TRUE                     12050011
120600         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      12060011
120700         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            12070025
120800         DISPLAY ' COULD NOT FIND SKU NBR ON XLT_SKU: '           12080029
120900                 RC119-SKU-NBR                                    12090025
121100         ADD +1 TO PV-ERR-SKU-NOT-FOUND-CNT                       12110013
121200     ELSE                                                         12120000
121300         IF  RC120-KPONBR-VALID                                   12130011
121400             SET PS-PO-LINE-NOT-FOUND TO TRUE                     12140011
121500             MOVE RC119-KOHLS-PO-NBR TO DK-PO-NUMBER              12150016
121600             PERFORM 3420-FIND-PO-LINE-NBR                        12160011
121700             IF  PS-PO-LINE-NOT-FOUND                             12170011
121800                 SET PS-ERROR-YES TO TRUE                         12180011
121810                 SET RC120-SKUNBR-NOT-ON-PO TO TRUE               12181040
121900                 MOVE PV-READ-COUNT TO PV-DISP-NBR-C              12190011
122000                 DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C    12200025
122100                 DISPLAY ' COULD NOT FIND PO LINE NBR'            12210029
122200                 DISPLAY 'KOHLS PO NBR IS: ' RC119-KOHLS-PO-NBR   12220011
122300                         '     SKU NBR IS: ' RC119-SKU-NBR        12230011
122500                 ADD +1 TO PV-ERR-SKU-NOT-ON-PO-CNT               12250013
122600             END-IF                                               12260011
122700         END-IF                                                   12270011
122800     END-IF.                                                      12280000
122900                                                                  12290000
123000                                                                  12300000
123100******************************************************************12310000
123200* THIS PARAGRAPH WILL BE USED TO CHECK IF THE SKU NUMBER IS ON   *12320011
123300* THE SKU MASTER TABLE.                                          *12330011
123400******************************************************************12340000
123500 3410-FIND-SKU-NBR.                                               12350011
123600                                                                  12360000
123700     EXEC SQL                                                     12370000
123800          SELECT A.UPC_NBR                                        12380000
123900               , B.SKU_NBR                                        12390000
124000            INTO :XLT00006-UPC-NBR                                12400000
124100               , :XLT00003-SKU-NBR                                12410000
124200            FROM XLT_UPC A                                        12420000
124300               , XLT_SKU B                                        12430000
124400          WHERE B.SKU_NBR     = :DK-SKU-NUMBER                    12440011
124500            AND A.INTR_UPC_ID = B.INTR_UPC_ID                     12450011
124600            AND A.UPC_TYP_CDE = 'I'                               12460011
124700          WITH UR                                                 12470000
124800     END-EXEC                                                     12480000
124900                                                                  12490000
125000     EVALUATE TRUE                                                12500000
125100         WHEN SQLCODE  = +0                                       12510000
125200         WHEN SQLCODE  = -811                                     12520011
125300             SET PS-SKU-FOUND TO TRUE                             12530011
125400             MOVE XLT00006-UPC-NBR TO RC119-UPC-NBR               12540011
125500         WHEN SQLCODE  = +100                                     12550000
125600             SET PS-SKU-NOT-FOUND TO TRUE                         12560011
125700         WHEN OTHER                                               12570000
125800             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  12580025
125900             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        12590025
126000             DISPLAY '3410-FIND-SKU-NBR DB2 ERROR'                12600011
126100             DISPLAY 'SKU NUMBER IS:  ' RC119-SKU-NBR             12610011
126200             MOVE '3410-FIND-SKU-NBR' TO PV-ABEND-PARAGRAPH       12620011
126300             MOVE 'VALIDATE SKU NUMBER TO GET UPC'                12630011
126400                                            TO PV-ABEND-OPERATION 12640000
126500             PERFORM 9900-DB2-ABEND                               12650000
126600     END-EVALUATE.                                                12660000
126700                                                                  12670000
126800                                                                  12680000
126900******************************************************************12690000
127000* THIS PARAGRAPH WILL BE USED TO TAKE THE KOHLS PO NUMBER        *12700000
127100* RETRIEVED EARLIER AND THE SKU NUMBER RETRIEVED EARLIER         *12710000
127200* AND FIND THE PO LINE NUMBER THAT THE SKU IS ON.                *12720000
127300******************************************************************12730000
127400 3420-FIND-PO-LINE-NBR.                                           12740000
127500                                                                  12750000
127600     EXEC SQL                                                     12760000
127700          SELECT PO_NBR                                           12770000
127800               , PO_LNE_NBR                                       12780000
127900               , RMS_PO_SKU_NBR                                   12790000
128000            INTO :PURITM-PO-NBR                                   12800000
128100               , :PURITM-PO-LNE-NBR                               12810000
128200               , :PURITM-RMS-PO-SKU-NBR                           12820000
128300            FROM TPURITM                                          12830000
128400          WHERE PO_NBR         = :DK-PO-NUMBER                    12840000
128500            AND RMS_PO_SKU_NBR = :DK-SKU-NUMBER                   12850000
128600            AND VER_STATUS_CDE = 'A'                              12860000
128700          WITH UR                                                 12870000
128800     END-EXEC                                                     12880000
128900                                                                  12890000
129000     EVALUATE TRUE                                                12900000
129100         WHEN SQLCODE  = +0                                       12910000
129200         WHEN SQLCODE  = -811                                     12920011
129300             SET PS-PO-LINE-FOUND TO TRUE                         12930000
129400             MOVE PURITM-PO-LNE-NBR TO RC119-KOHLS-PO-LINE-NBR    12940013
129500         WHEN SQLCODE  = +100                                     12950000
129600             SET PS-PO-LINE-NOT-FOUND TO TRUE                     12960000
129700         WHEN OTHER                                               12970000
129800             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  12980025
129900             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        12990025
130000             DISPLAY '3420-FIND-PO-LINE-NBR DB2 ERROR'            13000000
130100             DISPLAY 'KOHLS PO NBR IS: ' RC119-KOHLS-PO-NBR       13010011
130200                     '     SKU NBR IS: ' RC119-SKU-NBR            13020011
130300             MOVE '3420-FIND-PO-LINE-NBR' TO PV-ABEND-PARAGRAPH   13030000
130400             MOVE 'GET PO LINE NBR'                               13040000
130500                                            TO PV-ABEND-OPERATION 13050000
130600             PERFORM 9900-DB2-ABEND                               13060000
130700     END-EVALUATE.                                                13070000
130800                                                                  13080000
130900                                                                  13090000
131000******************************************************************13100000
131100*  THIS PARAGRAPH WILL MANAGE THE CHECKING OF THE SSCC NUMBER    *13110000
131200*  FROM THE INPUT FILE.  BASICALLY, WE WILL BE DOING A CHECK TO  *13120000
131300*  SEE IF THAT NUMBER IS ALREADY IN USE ON THE OUTBOUND CARTON   *13130011
131400*  TABLES.                                                       *13140000
131500*  NOTE:                                                         *13150000
131600*       IF SML EXISTS ON THE OUTBOUND CARTON TABLE, THIS IS AN   *13160011
131700*       ERROR.                                                   *13170011
131800*  OTHER VALIDATION CHECKS WILL ALSO THEN BE DONE AGAINST THE    *13180011
131900*  SML NUMBER TO ENSURE THAT COMPONENTS LIKE THE STORE NUMBER    *13190011
132000*  AND DC NUMBER WITHIN THE SML NUMBER ARE VALID.                *13200011
132100******************************************************************13210000
132200 3500-VALIDATE-SML-NUMBER.                                        13220005
132300                                                                  13230000
132400     MOVE RC119-SML-NBR TO DK-SML-NUMBER.                         13240016
132500     SET PS-SML-NOT-FOUND TO TRUE.                                13250002
132600                                                                  13260000
132700     PERFORM 3510-FIND-SML-NBR.                                   13270011
132800                                                                  13280000
132900     IF  PS-SML-FOUND                                             13290002
133000         SET RC120-SMLNBR-ALREADY-EXISTS TO TRUE                  13300011
133100         SET PS-ERROR-YES            TO TRUE                      13310011
133200         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      13320011
133300         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            13330025
133400         DISPLAY ' SML NUMBER ALREADY EXISTS ON SUT_OTBND_CART'   13340029
133500                 ' TABLE'                                         13350029
133600         DISPLAY 'SML NUMBER FROM INPUT IS: '                     13360029
133700                 RC119-SML-NBR                                    13370029
133900         ADD +1 TO PV-ERR-SML-EXISTS-CNT                          13390013
134000     ELSE                                                         13400011
134100         SET PS-SML-FORMAT-ISSUE TO TRUE                          13410011
134200         PERFORM 3520-VALIDATE-SML-NBR-FIELDS                     13420011
134300         IF  PS-SML-FORMAT-ISSUE                                  13430012
134400             SET PS-ERROR-YES        TO TRUE                      13440012
134500             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  13450012
134600             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        13460025
134700             DISPLAY 'SML NUMBER FORMAT ISSUE: '                  13470025
134800                     RC119-SML-NBR                                13480021
134900             IF  PS-SML-NOT-CARTON-TYPE                           13490022
135000                 DISPLAY 'SML DOES NOT START WITH 00'             13500022
135100             END-IF                                               13510022
135200             IF  PS-SML-POS-3-TO-4-INVALID                        13520022
135300                 DISPLAY 'SML IS NOT A 42 IN POSITIONS 3 AND 4'   13530022
135400             END-IF                                               13540022
135500             IF  PS-SML-STORE-ORD-STORE-NOMATCH                   13550022
135600                 DISPLAY 'SML STORE NUMBER DOES NOT MATCH THE'    13560022
135700                         ' THE STORE NUMBER FOR DISTRIBUTION'     13570022
135800                 DISPLAY 'SML STORE NUMBER IS: '                  13580022
135900                         PV-SML-STORE-NBR                         13590022
136000                 DISPLAY 'RC119-DEST-STORE-NBR IS:'               13600022
136100                          RC119-DEST-STORE-NBR                    13610022
136200             END-IF                                               13620022
136300             IF  PS-SML-DC-NBR-NOT-DC                             13630022
136400                 DISPLAY 'SML DC NUMBER IN POSITIONS 10 THRU 12'  13640022
136500                         ' IS NOT A DC TYPE LOCATION'             13650022
136600             END-IF                                               13660022
136700             IF  PS-SML-DC-NBR-NOT-FOUND                          13670022
136800                 DISPLAY 'SML DC NUMBER IN POSITIONS 10 THRU 12'  13680022
136900                         ' IS NOT ON XLT_LOC TABLE'               13690025
137000             END-IF                                               13700022
137200             IF  RC120-SMLNBR-INVALID-DC                          13720012
137300             OR  RC120-SMLNBR-MISMATCH-STR                        13730012
137400                 NEXT SENTENCE                                    13740012
137500             ELSE                                                 13750012
137600                 SET RC120-SMLNBR-FORMAT-ISSUE TO TRUE            13760012
137700             END-IF                                               13770012
137800         END-IF                                                   13780012
137900     END-IF.                                                      13790000
138000                                                                  13800000
138100                                                                  13810000
138200******************************************************************13820000
138300*  THIS PARAGRAPH WILL CHECK TO SEE IF THE SML NUMBER IS FOUND   *13830011
138400*  ON THE OUTBOUND CARTON HEADER TABLE.                          *13840011
138500******************************************************************13850000
138600 3510-FIND-SML-NBR.                                               13860011
138700                                                                  13870000
138800     EXEC SQL                                                     13880000
138900          SELECT A.SHIPT_UNT_ID                                   13890011
139000            INTO :SUT00024-SHIPT-UNT-ID                           13900014
139100            FROM SUT_OTBND_CART A                                 13910014
139200          WHERE A.SHIPT_UNT_ID = :DK-SML-NUMBER                   13920011
139300          WITH UR                                                 13930000
139400     END-EXEC                                                     13940000
139500                                                                  13950000
139600     EVALUATE TRUE                                                13960000
139700         WHEN SQLCODE  = +0                                       13970000
139800             SET PS-SML-FOUND TO TRUE                             13980002
139900         WHEN SQLCODE  = +100                                     13990000
140000             SET PS-SML-NOT-FOUND TO TRUE                         14000002
140100         WHEN OTHER                                               14010000
140200             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  14020011
140300             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        14030025
140400             DISPLAY '3510-FIND-SML-NBR DB2 ERROR'                14040025
140500             DISPLAY 'SML NUMBER IS:  ' RC119-SML-NBR             14050011
140600             MOVE '3510-FIND-SML-NBR' TO PV-ABEND-PARAGRAPH       14060011
140700             MOVE 'CHECK TO SEE IF SML EXISTS'                    14070011
140800                                            TO PV-ABEND-OPERATION 14080000
140900             PERFORM 9900-DB2-ABEND                               14090000
141000     END-EVALUATE.                                                14100000
141100                                                                  14110011
141200                                                                  14120011
141300******************************************************************14130011
141400*  THIS PARAGRAPH WILL TO SEE IF THE DIFFERENT NUMBER            *14140011
141500*  COMPONENETS WITHIN THE SML NUMBER ARE VALID FOR USE.  THIS    *14150011
141600*  INCLUDES THAT THE SML NUMBER STARTS WITH 00, THEN A 4, THEN   *14160011
141700*  CONTAINS A VALID DC NUMBER AND FINALLY THE STORE NUMBER       *14170011
141800*  MATCHES TO THE STORE NUMBER WITHIN THE INPUT RECORD.          *14180011
141900******************************************************************14190011
142000 3520-VALIDATE-SML-NBR-FIELDS.                                    14200011
142100                                                                  14210011
142200     MOVE RC119-SML-NBR TO PV-SML-NBR.                            14220011
142300     SET PS-SML-IS-CARTON-TYPE TO TRUE.                           14230022
142400     SET PS-SML-POS-3-TO-4-VALID TO TRUE.                         14240022
142500     SET PS-SML-STORE-ORD-STORE-MATCH TO TRUE.                    14250022
142600     SET PS-SML-DC-NBR-VALID TO TRUE.                             14260022
142700                                                                  14270011
142800     IF  PV-SML-TYPE-IS-CARTON                                    14280011
142900         SET PS-SML-FORMAT-GOOD TO TRUE                           14290011
143000     ELSE                                                         14300022
143100         SET PS-SML-NOT-CARTON-TYPE TO TRUE                       14310022
143200     END-IF.                                                      14320011
143300                                                                  14330011
143400     IF  PS-SML-FORMAT-GOOD                                       14340011
143500         IF  PV-SML-POS-3-TO-4-VALID                              14350022
143600             SET PS-SML-FORMAT-GOOD TO TRUE                       14360011
143700         ELSE                                                     14370011
143800             SET PS-SML-FORMAT-ISSUE TO TRUE                      14380011
143900             SET PS-SML-POS-3-TO-4-INVALID TO TRUE                14390022
144000         END-IF                                                   14400011
144100     END-IF.                                                      14410011
144200                                                                  14420011
144300     IF  PS-SML-FORMAT-GOOD                                       14430011
144400         IF  PV-SML-STORE-NBR = RC119-DEST-STORE-NBR              14440012
144500             SET PS-SML-FORMAT-GOOD TO TRUE                       14450011
144600         ELSE                                                     14460011
144700             SET PS-SML-FORMAT-ISSUE TO TRUE                      14470011
144800             SET RC120-SMLNBR-MISMATCH-STR TO TRUE                14480012
144900             SET PS-SML-STORE-ORD-STORE-NOMATCH TO TRUE           14490022
145000         END-IF                                                   14500011
145100     END-IF.                                                      14510011
145200                                                                  14520011
145300     IF  PS-SML-FORMAT-GOOD                                       14530011
145400         SET PS-DC-NOT-FOUND TO TRUE                              14540012
145500         MOVE PV-SML-DC-NBR TO DK-DC-NUMBER                       14550012
145600         PERFORM 3610-FIND-DC-NBR                                 14560012
145700         IF  PS-DC-FOUND                                          14570012
145800             IF  XLT00010-LOC-TYP-CDE = 'DC'                      14580012
145900                 NEXT SENTENCE                                    14590012
146000             ELSE                                                 14600012
146100                 SET PS-SML-FORMAT-ISSUE TO TRUE                  14610012
146200                 SET RC120-SMLNBR-INVALID-DC TO TRUE              14620012
146300                 SET PS-SML-DC-NBR-NOT-DC TO TRUE                 14630022
146400             END-IF                                               14640012
146500         ELSE                                                     14650012
146600             SET PS-SML-FORMAT-ISSUE TO TRUE                      14660012
146700             SET RC120-SMLNBR-INVALID-DC TO TRUE                  14670012
146800             SET PS-SML-DC-NBR-NOT-FOUND TO TRUE                  14680022
146900             ADD +1 TO PV-ERR-SML-DC-NOT-FOUND-CNT                14690013
147000         END-IF                                                   14700012
147100     END-IF.                                                      14710012
147200                                                                  14720000
147300                                                                  14730000
147400******************************************************************14740000
147500*  THIS PARAGRAPH WILL CHECK TO SEE IF THE THIRD PARTY DC NUMBER *14750013
147600*  ON THE INPUT RECORD IS A VALID DC NUMBER.                     *14760013
147700******************************************************************14770000
147800 3600-VALIDATE-3RD-PARTY-DC.                                      14780012
147900                                                                  14790000
148000     MOVE RC119-3RD-PRTY-DC-NBR TO DK-DC-NUMBER.                  14800012
148100     SET PS-DC-NOT-FOUND TO TRUE.                                 14810000
148200                                                                  14820000
148300     PERFORM 3610-FIND-DC-NBR.                                    14830000
148400                                                                  14840000
148500     IF  PS-DC-FOUND                                              14850000
148600         IF  XLT00010-LOC-TYP-CDE = 'DC'                          14860000
148700             NEXT SENTENCE                                        14870012
148800         ELSE                                                     14880000
148900             SET PS-ERROR-YES TO TRUE                             14890000
149000             SET RC120-3PDCNBR-NOT-A-DC TO TRUE                   14900012
149100             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  14910012
149200             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        14920025
149300             DISPLAY 'THIRD PARTY DC NUMBER IS NOT A DC'          14930012
149400                     ' LOCATION: '                                14940012
149500                     RC119-3RD-PRTY-DC-NBR                        14950012
149700         END-IF                                                   14970000
149800     ELSE                                                         14980000
149900         SET PS-ERROR-YES TO TRUE                                 14990000
150000         SET RC120-3PDCNBR-INVALID-NBR TO TRUE                    15000012
150100         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      15010012
150200         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            15020025
150300         DISPLAY 'THIRD PARTY DC NUMBER IS NOT ON XLT_LOC: '      15030012
150400                 RC119-3RD-PRTY-DC-NBR                            15040012
150600         ADD +1 TO PV-ERR-3RD-DC-NOT-FOUND-CNT                    15060013
150700     END-IF.                                                      15070000
150800                                                                  15080000
150900                                                                  15090000
151000******************************************************************15100000
151100*  THIS PARAGRAPH WILL DO A SELECT TO THE XLT_LOC TABLE TO SEE   *15110000
151200*  IF THE DC NUMBER IS VALID.                                    *15120000
151300******************************************************************15130000
151400 3610-FIND-DC-NBR.                                                15140000
151500                                                                  15150000
151600     EXEC SQL                                                     15160000
151700          SELECT LOC_NBR                                          15170000
151800               , LOC_TYP_CDE                                      15180000
151900               , LOC_5_ABBR_NM                                    15190000
152000               , OPN_DTE                                          15200000
152100               , CLO_DTE                                          15210000
152200            INTO :XLT00010-LOC-NBR                                15220000
152300               , :XLT00010-LOC-TYP-CDE                            15230000
152400               , :XLT00010-LOC-5-ABBR-NM                          15240000
152500               , :XLT00010-OPN-DTE                                15250000
152600               , :XLT00010-CLO-DTE                                15260000
152700            FROM XLT_LOC                                          15270000
152800          WHERE LOC_NBR = :DK-DC-NUMBER                           15280000
152900          WITH UR                                                 15290000
153000     END-EXEC                                                     15300000
153100                                                                  15310000
153200     EVALUATE TRUE                                                15320000
153300         WHEN SQLCODE  = +0                                       15330000
153400             SET PS-DC-FOUND TO TRUE                              15340000
153500         WHEN SQLCODE  = +100                                     15350000
153600             SET PS-DC-NOT-FOUND TO TRUE                          15360000
153700         WHEN OTHER                                               15370000
153800             MOVE DK-DC-NUMBER TO PV-DISP-NBR-4                   15380012
153900             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  15390012
154000             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        15400025
154100             DISPLAY '3610-FIND-DC-NBR DB2 ERROR'                 15410025
154200             DISPLAY 'DC NUMBER IS:  ' PV-DISP-NBR-4              15420012
154300             MOVE '3610-FIND-DC-NBR' TO PV-ABEND-PARAGRAPH        15430012
154400             MOVE 'CHECK TO SEE IF DC EXISTS'                     15440012
154500                                            TO PV-ABEND-OPERATION 15450012
154600             PERFORM 9900-DB2-ABEND                               15460012
154700     END-EVALUATE.                                                15470000
154800                                                                  15480000
154900                                                                  15490000
155000******************************************************************15500013
155100*  THIS PARAGRAPH WILL CHECK TO SEE IF THE STORE NUMBER ON THE   *15510013
155200*  INPUT RECORD IS A VALID STORE NUMBER AND IF THE STORE/SKU     *15520013
155300*  IS FOUND ON THE PO.                                           *15530013
155400******************************************************************15540013
155500 3650-VALIDATE-DEST-STR-NBR.                                      15550013
155600                                                                  15560013
155700     MOVE RC119-DEST-STORE-NBR TO DK-STORE-NUMBER.                15570013
155800     SET PS-STORE-NOT-FOUND TO TRUE.                              15580013
155900                                                                  15590013
156000     PERFORM 3660-FIND-STORE-NBR.                                 15600013
156100                                                                  15610013
156200     IF  PS-STORE-FOUND                                           15620013
156300         IF  XLT00010-LOC-TYP-CDE = 'DS'                          15630013
156400             NEXT SENTENCE                                        15640013
156500         ELSE                                                     15650013
156600             SET PS-ERROR-YES TO TRUE                             15660013
156700             SET RC120-DSTSTR-NOT-A-DS-STR TO TRUE                15670013
156800             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  15680013
156900             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        15690025
157000             DISPLAY 'DEST STORE NUMBER IS NOT A DS TYPE'         15700013
157100                     ' LOCATION: '                                15710013
157200                     RC119-DEST-STORE-NBR                         15720013
157400         END-IF                                                   15740013
157500     ELSE                                                         15750013
157600         SET PS-ERROR-YES TO TRUE                                 15760013
157700         SET RC120-DSTSTR-INVALID-STR TO TRUE                     15770013
157800         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      15780013
157900         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            15790025
158000         DISPLAY 'DEST STORE NUMBER IS NOT ON XLT_LOC: '          15800013
158100                 RC119-DEST-STORE-NBR                             15810013
158300         ADD +1 TO PV-ERR-STR-NOT-FOUND-CNT                       15830013
158400     END-IF.                                                      15840013
158500                                                                  15850013
158600     IF  RC120-DSTSTR-VALID                                       15860013
158700         SET PS-STORE-NOT-FOUND TO TRUE                           15870013
158800         PERFORM 3670-GET-SERVICING-DC                            15880013
158900     END-IF.                                                      15890013
159000                                                                  15900013
159100                                                                  15910013
159200******************************************************************15920013
159300*  THIS PARAGRAPH WILL DO A SELECT TO THE XLT_LOC TABLE TO SEE   *15930013
159400*  IF THE DC NUMBER IS VALID.                                    *15940013
159500******************************************************************15950013
159600 3660-FIND-STORE-NBR.                                             15960013
159700                                                                  15970013
159800     EXEC SQL                                                     15980013
159900          SELECT LOC_NBR                                          15990013
160000               , LOC_TYP_CDE                                      16000013
160100               , LOC_5_ABBR_NM                                    16010013
160200               , OPN_DTE                                          16020013
160300               , CLO_DTE                                          16030013
160400            INTO :XLT00010-LOC-NBR                                16040013
160500               , :XLT00010-LOC-TYP-CDE                            16050013
160600               , :XLT00010-LOC-5-ABBR-NM                          16060013
160700               , :XLT00010-OPN-DTE                                16070013
160800               , :XLT00010-CLO-DTE                                16080013
160900            FROM XLT_LOC                                          16090013
161000          WHERE LOC_NBR = :DK-STORE-NUMBER                        16100013
161100          WITH UR                                                 16110013
161200     END-EXEC                                                     16120013
161300                                                                  16130013
161400     EVALUATE TRUE                                                16140013
161500         WHEN SQLCODE  = +0                                       16150013
161600             SET PS-STORE-FOUND TO TRUE                           16160013
161700         WHEN SQLCODE  = +100                                     16170013
161800             SET PS-STORE-NOT-FOUND TO TRUE                       16180013
161900         WHEN OTHER                                               16190013
162000             MOVE DK-STORE-NUMBER TO PV-DISP-NBR-4                16200013
162100             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  16210013
162200             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        16220025
162300             DISPLAY '3660-FIND-STORE-NBR DB2 ERROR'              16230025
162400             DISPLAY 'STORE NUMBER IS:  ' PV-DISP-NBR-4           16240013
162500             MOVE '3660-FIND-STORE-NBR' TO PV-ABEND-PARAGRAPH     16250013
162600             MOVE 'CHECK TO SEE IF STORE EXISTS'                  16260013
162700                                            TO PV-ABEND-OPERATION 16270013
162800             PERFORM 9900-DB2-ABEND                               16280013
162900     END-EVALUATE.                                                16290013
163000                                                                  16300013
163100                                                                  16310013
163200******************************************************************16320013
163300*  THIS PARAGRAPH WILL DO A SELECT TO THE XLT_LOC TABLE TO SEE   *16330013
163400*  IF THE DC NUMBER IS VALID.                                    *16340013
163500******************************************************************16350013
163600 3670-GET-SERVICING-DC.                                           16360013
163700                                                                  16370013
163800     EXEC SQL                                                     16380013
163900         SELECT DC_NBR                                            16390013
164000         INTO :XLT00014-DC-NBR                                    16400013
164100         FROM XLT_DC_LOC_ASGMT A                                  16410013
164200         WHERE A.LOC_NBR       =  :DK-STORE-NUMBER                16420013
164300           AND A.EFF_BEG_DTE    IN                                16430013
164400              (SELECT MAX(B.EFF_BEG_DTE)                          16440013
164500                 FROM XLT_DC_LOC_ASGMT B                          16450013
164600                WHERE A.LOC_NBR  =  B.LOC_NBR                     16460013
164700                  AND B.EFF_BEG_DTE  <= CURRENT DATE)             16470013
164800     END-EXEC.                                                    16480013
164900                                                                  16490013
165000     EVALUATE TRUE                                                16500013
165100         WHEN SQLCODE  = +0                                       16510013
165200             MOVE XLT00014-DC-NBR TO RC119-STORE-SUPPORT-DC-NBR   16520013
165300             SET PS-STORE-FOUND TO TRUE                           16530013
165400         WHEN SQLCODE  = +100                                     16540013
165500             IF XLT00010-OPN-DTE > PV-CURR-DATE                   16550052
165501                 PERFORM 3680-GET-NEXT-SRVC-DC                    16550152
165502             ELSE                                                 16550252
165503                 SET PS-STORE-NOT-FOUND TO TRUE                   16550352
165600                 MOVE RC119-SHIP-TO-DC-NBR TO                     16560052
165700                      RC119-STORE-SUPPORT-DC-NBR                  16570052
165800                 ADD +1 TO PV-ERR-SRV-DC-NOT-FOUND-CNT            16580052
165801             END-IF                                               16580152
165810*            SET PS-STORE-NOT-FOUND TO TRUE                       16581052
165820*            MOVE RC119-SHIP-TO-DC-NBR TO                         16582052
165830*                 RC119-STORE-SUPPORT-DC-NBR                      16583052
165840*            ADD +1 TO PV-ERR-SRV-DC-NOT-FOUND-CNT                16584052
165900         WHEN OTHER                                               16590013
166000             MOVE DK-STORE-NUMBER TO PV-DISP-NBR-4                16600013
166100             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  16610013
166200             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        16620025
166300             DISPLAY '3660-FIND-STORE-NBR DB2 ERROR'              16630025
166400             DISPLAY 'STORE NUMBER IS:  ' PV-DISP-NBR-4           16640013
166500             MOVE '3660-FIND-STORE-NBR' TO PV-ABEND-PARAGRAPH     16650013
166600             MOVE 'CHECK TO SEE IF STORE EXISTS'                  16660013
166700                                            TO PV-ABEND-OPERATION 16670013
166800             PERFORM 9900-DB2-ABEND                               16680013
166900     END-EVALUATE.                                                16690013
167000                                                                  16700013
167100                                                                  16710013
167110******************************************************************16711051
167120*  THIS PARAGRAPH WILL GET THE DC NBR FROM THE MAX ROW FOR       *16712052
167130*  THE STORE, REGARDLESS OF THE BEGIN DATE                       *16713052
167140******************************************************************16714051
167150 3680-GET-NEXT-SRVC-DC.                                           16715052
167160                                                                  16716051
167170     EXEC SQL                                                     16717051
167180         SELECT DC_NBR                                            16718052
167190         INTO :XLT00014-DC-NBR                                    16719051
167191         FROM XLT_DC_LOC_ASGMT A                                  16719151
167192         WHERE A.LOC_NBR       =  :DK-STORE-NUMBER                16719251
167193           AND A.EFF_BEG_DTE   =                                  16719352
167194              (SELECT MAX(B.EFF_BEG_DTE)                          16719451
167195                 FROM XLT_DC_LOC_ASGMT B                          16719551
167196                WHERE A.LOC_NBR  =  B.LOC_NBR)                    16719652
167198     END-EXEC.                                                    16719851
167199                                                                  16719951
167200     EVALUATE TRUE                                                16720051
167201         WHEN SQLCODE  = +0                                       16720151
167202             MOVE XLT00014-DC-NBR TO RC119-STORE-SUPPORT-DC-NBR   16720251
167203             SET PS-STORE-FOUND TO TRUE                           16720351
167204         WHEN SQLCODE  = +100                                     16720451
167206             SET PS-STORE-NOT-FOUND TO TRUE                       16720651
167207             MOVE RC119-SHIP-TO-DC-NBR TO                         16720751
167208                  RC119-STORE-SUPPORT-DC-NBR                      16720851
167209             ADD +1 TO PV-ERR-SRV-DC-NOT-FOUND-CNT                16720951
167210         WHEN OTHER                                               16721051
167211             MOVE DK-STORE-NUMBER TO PV-DISP-NBR-4                16721151
167212             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  16721251
167213             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        16721351
167214             DISPLAY '3680-GET-NEXT-SRVC-DC'                      16721452
167215             DISPLAY 'STORE NUMBER IS:  ' PV-DISP-NBR-4           16721551
167216             MOVE '3680-GET-NEXT-SRVC-DC' TO PV-ABEND-PARAGRAPH   16721652
167217             MOVE 'GET SERVICING DC'      TO PV-ABEND-OPERATION   16721752
167219             PERFORM 9900-DB2-ABEND                               16721951
167220     END-EVALUATE.                                                16722051
167221                                                                  16722151
167222                                                                  16722251
167230******************************************************************16723000
167300*  THIS PARAGRAPH WILL TAKE THE CUSTOMER ORDER NUMBER FROM THE   *16730012
167400*  INPUT RECORD VALIDATE THE FORMAT IS RIGHT AND THE COMPONENTS  *16740012
167500*  OF THE ORDER NUMBER ARE CORRECT.                              *16750012
167600*  CUSTOMER ORDER FORMAT IS SUPPOSED TO BE:                      *16760012
167700*      KKKKKKKK-SSSS                                             *16770012
167800*  KKKKKKKK - KOHLS PO NUMBER                                    *16780012
167900*  SSSS     - STORE NUMBER THE UNITS ARE TO BE DISTRIBUTED TO    *16790012
168000******************************************************************16800000
168100 3700-CUST-ORD-COMPONENTS.                                        16810012
168200                                                                  16820000
168300     IF  RC120-KPONBR-VALID                                       16830013
168400         IF  RC119-CUST-ORD-KOHLS-PO = RC119-KOHLS-PO-NBR         16840013
168500             NEXT SENTENCE                                        16850013
168600         ELSE                                                     16860013
168700             SET PS-ERROR-YES TO TRUE                             16870013
168800             SET RC120-CUSTORD-INVALID-PO TO TRUE                 16880013
168900         END-IF                                                   16890013
169000     END-IF.                                                      16900013
169100                                                                  16910013
169200     IF  RC120-DSTSTR-VALID                                       16920013
169300         IF  RC119-CUST-ORD-STR-NBR = RC119-DEST-STORE-NBR        16930013
169400             NEXT SENTENCE                                        16940013
169500         ELSE                                                     16950013
169600             SET PS-ERROR-YES TO TRUE                             16960013
169700             IF  RC120-CUSTORD-INVALID-PO                         16970013
169800                 SET RC120-CUSTORD-INVALID-POSTR TO TRUE          16980013
169900             ELSE                                                 16990013
170000                 SET RC120-CUSTORD-INVALID-STORE TO TRUE          17000013
170100             END-IF                                               17010013
170200         END-IF                                                   17020013
170300     END-IF.                                                      17030013
170400                                                                  17040013
170500     IF  RC120-CUSTORD-VALID                                      17050013
170600         IF  RC119-CUST-ORD-DASH = '-'                            17060013
170700             NEXT SENTENCE                                        17070013
170800         ELSE                                                     17080013
170900             SET PS-ERROR-YES TO TRUE                             17090013
171000             SET RC120-CUSTORD-FORMAT-ISSUE TO TRUE               17100013
171100         END-IF                                                   17110013
171200     END-IF.                                                      17120013
171300                                                                  17130013
171400     IF  RC120-CUSTORD-VALID                                      17140013
171500         NEXT SENTENCE                                            17150013
171600     ELSE                                                         17160013
171700         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      17170013
171800         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            17180025
171900         DISPLAY 'CUSTOMER ORDER NUMBER NOT VALID: '              17190013
172000                 ' LOCATION: '                                    17200013
172100                 RC119-CUST-ORDER-NBR                             17210013
172300     END-IF.                                                      17230013
172400                                                                  17240000
172500                                                                  17250000
172600******************************************************************17260013
172700*  THIS PARAGRAPH WILL CHECK TO SEE IF THE KOHLS SHIP TO DC      *17270013
172800*  NUMBER ON THE INPUT RECORD IS A VALID DC NUMBER.              *17280013
172900******************************************************************17290013
173000 3800-VALIDATE-SHIP-TO-DC.                                        17300013
173100                                                                  17310000
173200     MOVE RC119-SHIP-TO-DC-NBR TO DK-DC-NUMBER.                   17320013
173300     SET PS-DC-NOT-FOUND TO TRUE.                                 17330013
173400                                                                  17340013
173500     PERFORM 3610-FIND-DC-NBR.                                    17350013
173600                                                                  17360013
173700     IF  PS-DC-FOUND                                              17370013
173800         IF  XLT00010-LOC-TYP-CDE = 'DC'                          17380013
173900             NEXT SENTENCE                                        17390013
174000         ELSE                                                     17400013
174100             SET PS-ERROR-YES TO TRUE                             17410013
174200             SET RC120-KSDCNBR-NOT-A-DC TO TRUE                   17420013
174300             MOVE PV-READ-COUNT TO PV-DISP-NBR-C                  17430013
174400             DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C        17440025
174500             DISPLAY 'KOHLS SHIP TO DC NUMBER IS NOT A DC'        17450013
174600                     ' LOCATION: '                                17460013
174700                     RC119-SHIP-TO-DC-NBR                         17470013
174900         END-IF                                                   17490013
175000     ELSE                                                         17500013
175100         SET PS-ERROR-YES TO TRUE                                 17510013
175200         SET RC120-KSDCNBR-INVALID-NBR TO TRUE                    17520013
175300         MOVE PV-READ-COUNT TO PV-DISP-NBR-C                      17530013
175400         DISPLAY 'INPUT RECORD NUMBER: ' PV-DISP-NBR-C            17540025
175500         DISPLAY 'KOHLS SHIP TO DC NUMBER IS NOT ON XLT_LOC: '    17550013
175600                 RC119-SHIP-TO-DC-NBR                             17560013
175800         ADD +1 TO PV-ERR-TO-DC-NOT-FOUND-CNT                     17580013
175900     END-IF.                                                      17590013
176000                                                                  17600013
176100                                                                  17610013
176200******************************************************************17620000
176300*  READ A SHIPPED MERCHANDISE COMMA DELIMITED INPUT RECORD       *17630000
176400******************************************************************17640000
176500 7000-READ-INPUT.                                                 17650000
176600                                                                  17660000
176700     READ PARSED-SHIPMENT-FILE                                    17670005
176800       INTO RC118-PARSED-SHIPMENT-REC                             17680005
176900         AT END                                                   17690000
177000           SET END-OF-FILE TO TRUE                                17700000
177100         NOT AT END                                               17710000
177200           ADD 1                      TO PV-READ-COUNT            17720000
177300                                         PV-PROGRESSIVE-READ-COUNT17730000
177400           IF  PV-PROGRESSIVE-READ-COUNT =                        17740000
177500               PC-PROGRESSIVE-READ-LIMIT                          17750000
177600               MOVE PV-READ-COUNT TO PV-DISP-NBR                  17760000
177700               DISPLAY 'PROGRESSIVE READ COUNT IS: '              17770000
177800                       PV-DISP-NBR                                17780000
177900               MOVE ZEROS TO PV-PROGRESSIVE-READ-COUNT            17790000
178000           END-IF                                                 17800000
178100     END-READ.                                                    17810000
178200                                                                  17820000
178300                                                                  17830000
178400******************************************************************17840000
178500*  SHOW RECORD COUNTS AND AMOUNTS IN SYSOUT                       17850000
178600******************************************************************17860000
178700 8500-SHOW-COUNTERS.                                              17870000
178710     INITIALIZE RC122-ERROR-COUNTS-REC.                           17871045
178720                                                                  17872045
178800     DISPLAY ' '.                                                 17880013
178900     DISPLAY ' *********  RCKUT190 STATISTICS *********'          17890005
179000     DISPLAY ' '.                                                 17900013
179100     MOVE PV-READ-COUNT           TO PV-DISP-NBR-C                17910048
179110                                     RC122-TOT-RECORDS-READ.      17911048
179200     DISPLAY 'RECORDS READ             = ' PV-DISP-NBR-C.         17920000
179210*                                                                 17921048
179300     MOVE PV-VALID-WRITE-COUNT    TO PV-DISP-NBR-C                17930048
179310                                     RC122-VALID-RECORDS-READ.    17931048
179400     DISPLAY 'VALID FILE WRITE COUNT   = ' PV-DISP-NBR-C.         17940005
179410*                                                                 17941048
179500     MOVE PV-INVALID-WRITE-COUNT  TO PV-DISP-NBR-C                17950048
179510                                     RC122-INVLD-RECORDS-READ.    17951048
179600     DISPLAY 'INVALID FILE WRITE COUNT = ' PV-DISP-NBR-C.         17960005
179610*                                                                 17961048
179700     DISPLAY ' '.                                                 17970000
179701     MOVE PV-TOTAL-VALID-SHIP-QTY TO PV-DISP-NBR-C.               17970143
179702     DISPLAY 'TOTAL VALID SHIP UNITS   = ' PV-DISP-NBR-C.         17970243
179710     DISPLAY ' '.                                                 17971043
179800     DISPLAY ' **ERROR COUNTS**'                                  17980000
179900     MOVE PV-ERR-NON-NUMERIC-CNT   TO PV-DISP-NBR-C               17990045
179910                                      RC122-NON-NUMERIC-CNT.      17991045
180000     DISPLAY 'ERRORS OF NON NUMERIC DATA        = ' PV-DISP-NBR-C.18000030
180001*                                                                 18000145
180010     MOVE PV-ERR-DATA-MISSING-CNT  TO PV-DISP-NBR-C               18001045
180011                                      RC122-DATA-MISSING-CNT.     18001145
180020     DISPLAY 'ERRORS OF MISSING DATA            = ' PV-DISP-NBR-C.18002034
180030*                                                                 18003045
180100     MOVE PV-ERR-PO-NOT-FOUND-CNT  TO PV-DISP-NBR-C               18010045
180110                                      RC122-PO-NOT-FND-CNT.       18011045
180200     DISPLAY 'ERRORS OF PO NOT FOUND            = ' PV-DISP-NBR-C.18020030
180210*                                                                 18021045
180300     MOVE PV-ERR-SKU-NOT-ON-PO-CNT TO PV-DISP-NBR-C               18030053
180310                                      RC122-SKU-NOT-ON-PO-CNT.    18031053
180400     DISPLAY 'ERRORS OF SKU NOT FOUND ON PO     = ' PV-DISP-NBR-C.18040030
180410*                                                                 18041045
180500     MOVE PV-ERR-SKU-NOT-FOUND-CNT TO PV-DISP-NBR-C               18050045
180510                                      RC122-SKU-NOT-FND-CNT.      18051045
180600     DISPLAY 'ERRORS OF SKU NOT FOUND           = ' PV-DISP-NBR-C.18060030
180610*                                                                 18061045
180700     MOVE PV-ERR-SML-EXISTS-CNT    TO PV-DISP-NBR-C               18070045
180710                                      RC122-SML-EXISTS-CNT.       18071045
180800     DISPLAY 'ERRORS OF SML ALREADY EXISTS      = ' PV-DISP-NBR-C.18080034
180810*                                                                 18081045
180900     MOVE PV-ERR-STR-NOT-FOUND-CNT      TO PV-DISP-NBR-C          18090045
180910                                           RC122-STR-NOT-FND-CNT. 18091045
181000     DISPLAY 'ERRORS OF STORE NBR NOT FOUND     = ' PV-DISP-NBR-C.18100030
181010*                                                                 18101045
181100     MOVE PV-ERR-3RD-DC-NOT-FOUND-CNT TO PV-DISP-NBR-C            18110045
181110                                         RC122-3RD-DC-NOT-FND-CNT.18111045
181200     DISPLAY 'ERRORS OF 3RD PARTY DC NOT FOUND  = ' PV-DISP-NBR-C.18120030
181210*                                                                 18121045
181300     MOVE PV-ERR-TO-DC-NOT-FOUND-CNT      TO PV-DISP-NBR-C        18130045
181310                                          RC122-TO-DC-NOT-FND-CNT.18131049
181400     DISPLAY 'ERRORS OF SHIP TO DC NOT FOUND    = ' PV-DISP-NBR-C.18140030
181410*                                                                 18141045
181500     MOVE PV-ERR-SML-DC-NOT-FOUND-CNT  TO PV-DISP-NBR-C           18150045
181510                                         RC122-SML-DC-NOT-FND-CNT.18151049
181600     DISPLAY 'ERRORS OF SML DC NOT FOUND        = ' PV-DISP-NBR-C.18160030
181610*                                                                 18161045
181700     MOVE PV-ERR-SRV-DC-NOT-FOUND-CNT TO PV-DISP-NBR-C            18170045
181710                                         RC122-SRV-DC-NOT-FND-CNT.18171045
181800     DISPLAY 'ERRORS OF SERVICE DC NOT FOUND    = ' PV-DISP-NBR-C.18180030
181810*                                                                 18181045
181900     DISPLAY ' '.                                                 18190000
181901*                                                                 18190150
181902     MOVE   PV-CURRENT-TMST-DB2        TO RC122-BEG-TIMESTAMP.    18190250
181903******************************************************************18190346
181904*  WRITE ERROR COUNTS TO FILE                                    *18190446
181905******************************************************************18190546
181910 8600-WRITE-ERROR-COUNTS.                                         18191046
181920     WRITE ERROR-COUNTS-OUTPUT-RECORD                             18192046
181930       FROM RC122-ERROR-COUNTS-REC.                               18193046
181940                                                                  18194046
182000******************************************************************18200000
182100*  DB2 ABEND ROUTINE                                             *18210000
182200******************************************************************18220000
182300 9900-DB2-ABEND.                                                  18230000
182400*    DISPLAY '9900-DB2-ABEND'.                                    18240000
182500                                                                  18250000
182600     MOVE SQLCODE TO PV-SQLCODE.                                  18260000
182700     DISPLAY '*** DB2 ERROR '.                                    18270000
182800     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       18280000
182900     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 18290000
183000     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               18300000
183100     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               18310000
183200     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       18320000
183300     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             18330000
183400                                                                  18340000
183500     IF PV-ABEND-STRUCTURE-2 > SPACES                             18350000
183600         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          18360000
183700     END-IF.                                                      18370000
183800                                                                  18380000
183900     COPY DPPD004.                                                18390000
184000                                                                  18400000
184100     MOVE +4013                  TO PV-ABEND-CODE.                18410000
184200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18420000
184300*                                                                 18430000
184400* ************************ END OF RCKUT190 ********************** 18440005
