000100***************************************************************** 00010036
000200 IDENTIFICATION DIVISION.                                         00020036
000300***************************************************************** 00030036
000400                                                                  00040036
000500 PROGRAM-ID.             SSKRP047.                                00050036
000600 AUTHOR.                 ANGELA COLE.                             00060036
000700 INSTALLATION.           KOHLS.                                   00070036
000800 DATE-WRITTEN            10-3-89.                                 00080036
000900 DATE-COMPILED.                                                   00090036
001000                                                                  00100036
001100***************************************************************** 00110036
001200*  REWRITE TO COBOL FROM DYL280 ON 7/18/00.                       00120036
001300*                                                                 00130036
001400*  THIS PROGRAM SEQUENTIALLY PROCESSES THE TEPLID DB2 TABLE       00140036
001500*  AND CREATES THE DAILY LINE ITEM DISCOUNT EXCEPTION BY          00150036
001600*  DISCOUNT AMOUNT AND PERCENT REPORT.   A CONTROL CARD           00160036
001700*  PROVIDES THE MAXIMUM DISC AMOUNT AND DISCOUNT PERCENTAGE       00170036
001800*  THAT IS TO BE ELIMINATED FROM THE REPORT.                      00180036
001900*  ONLY LINE ITEM DISCOUNTS THAT ARE                              00190036
002000*  MANUALLY TAKEN AT THE REGISTER ARE INCLUDED ON THE REPORT.     00200036
002100*  LINE ITEM DISCOUNT DETAIL IS SUMMARIZED AT THE PHYSICAL        00210036
002200*  MERCHANDISE ITEM LEVEL BEFORE BEING CONSIDERED FOR             00220036
002300*  INCLUSION ON THE REPORT (I.E. IF TWO MANUAL LINE ITEM          00230036
002400*  DISCOUNTS WERE TAKEN TO MARK DOWN THE SAME PHYSICAL            00240036
002500*  MERCHANDISE ITEM, THE DETAIL INFORMATION IS SUMMARIZED).       00250036
002600*  IF THE ABSOLUTE VALUE OF THE CUSTOMER CHARGED AMOUNT IS        00260036
002700*  GREATER THAN THE CONTROL CARD SUPPLIED LIMIT, THE              00270036
002800*  SUMMARIZED INFORMATION IS INCLUDED ON THE REPORT.              00280036
002900*                                                                 00290036
003000*  THE TEPLID TABLE IS ORDERED BY STORE, TERMINAL, TRANSACTION,   00300036
003100*  AND LINE ITEM NUMBER.                                          00310036
003200*                                                                 00320036
003210***************************************************************** 00330036
003220*  CHANGES:                                                       00340036
003230*  JODY TAINTER-DEBOW - 12/22/00                                  00350036
003240*       - PM00384628                                              00360036
003250*         PROGRAM WAS SHOWING MORE THAN 100% FOR TOTAL %          00370036
003260*         DISCOUNT. A CHANGE WAS PUT IN TO CALCULATE THE TOTAL    00380036
003270*         PERCENT DISCOUNT OR PV-DISCOUNT-PCT DIFFERENTLY.        00390036
003280*         CHANGE WAS MADE TO PARAGRAPH 4000-PROCESS-SKU-LEVEL-DATA00400036
003290*         TO NOT ADD EPLID-LID-PCT TO PV-DISCOUNT-PCT-99999 AND   00410036
003291*         TO PARAGRAPH 6000-PRINT-DETAIL TO COMPUTE               00420036
003292*         PV-DISCOUNT-PCT-99999 = PV-MARKDOWN-AMT /               00430036
003293*         PV-SAVE-CHARGE-AMT. ALSO A FIX WAS MADE TO              00440036
003294*         $ DISCOUNT COLUMN CURRENTLY THIS WAS THE SUM OF LID_AMT 00450036
003295*         WHEN LID_TYP_CDE HAD A VALUE OF P OR C.  A CHANGE WAS   00460036
003296*         MADE TO SUM WHEN LID_TYP_CD HAD A VALUE OF D OR C.      00470036
003297*                                                                 00480036
003298***************************************************************** 00490036
003300***************************************************************** 00500036
003400*  CHANGES:                                                       00510036
003500*  MATT STIFF - 09/07/2000                                        00520036
003600*       - THE PROGRAM WAS REFERENCING LINE ITEM SEQUENCE NUMBER   00530036
003700*         BUT IT WAS NOT IN THE SELECT STATEMENT OF THE CURSOR.   00540036
003800*         ADDED IT TO THE SELECT STATEMENT OF THE CURSOR.         00550036
003900*                                                                 00560036
004000***************************************************************** 00570036
004100*  CHANGES:                                                       00580036
004200*  ANGELA COLE - JULY 19, 2000                                    00590036
004300*       - REWRITE PROGRAM FROM DYL280 TO COBOL USING THE          00600036
004400*         COSA DATABASE INSTEAD OF THE DAILY LINE ITEM DISCOUNT   00610036
004500*         SEQUENTIAL FILE.                                        00620036
004600*                                                                 00630036
004700***************************************************************** 00640036
004200*  CHRIS CLARK - JULY 03, 2002                                    00650036
004300*       - CHANGED REPORT TO SORT BY STORE, ASSOCIATE ID, DATE,    00660036
004400*         AND THEN REGISTER. ADDED LID REASON CODE TO REPORT.     00670036
004600*                                                                 00680036
004700***************************************************************** 00690036
004200*  ALEXIS KEIKER - JULY 24, 2002                                  00700036
004300*       - CHANGED REPORT TO NOT HAVE DEPT NBR, SUB CLASS NBR,     00710036
004400*         AND SEQ NBR IN THE SKU FIELD.  THE SKU FIELD WILL NOW   00720036
      *         BE NON INTELLIGENT INSTEAD OF INTELLIGENT.              00730036
004600*                                                                 00740036
004700***************************************************************** 00750042
004200*  ALEXIS KEIKER - AUGUST 13, 2002                                00760042
004300*       - ADDED A SALE ITEM FIELD TO THIS REPORT.  THIS WILL      00770042
004400*         EXPLAIN IF THE ITEM WAS ALREADY ON SALE BEFORE          00780042
      *         RECEIVING THE LINE ITEM DISCOUNT.                       00790042
NEMCHG***************************************************************** 00800074
NEMCHG*  CHANGED 12/17/02 BY NANCY MARTIN                               00810074
NEMCHG*   WR# 24311 EXPANDED DISPLAY FOR OPERATOR ID FROM 6 TO 7        00820074
NEMCHG*       DIGITS TO SUPPORT NEW LONGER UNIQUE ASSOCIATE IDS.        00830074
004600*                                                                 00840042
004700***************************************************************** 00850042
004700*  CHANGED 02/05/03 BY CHRIS CLARK                                00860080
004700*   WR# 21428 CHANGED PROGRAM FOR PROMO.  ITEM NUMBER IS NO       00870080
004700*       LONGER USED ON THE TEPITM TABLE.  INSTEAD OF CHECKING FOR 00880080
004700*       ITEM NUMBER = 0, CHECK FOR DEPT 981 OR 983 OR DUMMY SKUS. 00890080
004700***************************************************************** 00900080
SEPHOR* DATE: 04/11/2022                                                00901086
SEPHOR* CHANGE:      CHG0268920                                         00902087
SEPHOR* PROGRAMMER:  JIM HUNTER                                         00903086
SEPHOR* DESCRIPTION: INCLUDE NEW SEPHORA GIFT CARD DEPARTMENT 712 IN    00904086
SEPHOR*              SETTING THE REPORT SALE IND TO A SPACE INSTEAD OF  00905086
SEPHOR*              'Y'.                                               00905186
SEPHOR******************************************************************00906086
004800 ENVIRONMENT DIVISION.                                            00910036
004900***************************************************************** 00920036
005000                                                                  00930036
005100 CONFIGURATION SECTION.                                           00940036
005200                                                                  00950036
005300 SOURCE-COMPUTER.        IBM-3090.                                00960036
005400                                                                  00970036
005500 OBJECT-COMPUTER.        IBM-3090.                                00980036
005600                                                                  00990036
005700 INPUT-OUTPUT SECTION.                                            01000036
005800                                                                  01010036
005900 FILE-CONTROL.                                                    01020036
006000                                                                  01030036
006100     SELECT POS-DATE-CARD-FILE                                    01040036
006200         ASSIGN TO INP01.                                         01050036
006300                                                                  01060036
006400     SELECT CONTROL-CARD-FILE                                     01070036
006500         ASSIGN TO INP02.                                         01080036
006600                                                                  01090036
006700     SELECT LINE-ITEM-DISC-REPORT                                 01100036
006800         ASSIGN TO RPT01.                                         01110036
006900                                                                  01120036
007000******************************************************************01130036
007100 DATA DIVISION.                                                   01140036
007200******************************************************************01150036
007300                                                                  01160036
007400 FILE SECTION.                                                    01170036
007500                                                                  01180036
007600 FD  POS-DATE-CARD-FILE                                           01190036
007700     RECORDING MODE IS F                                          01200036
007800     BLOCK CONTAINS 0 RECORDS                                     01210036
007900     LABEL RECORDS ARE STANDARD.                                  01220036
008000                                                                  01230036
008100 01  POS-DATE-CARD-RECORD            PIC X(80).                   01240036
008200                                                                  01250036
008300 FD  CONTROL-CARD-FILE                                            01260036
008400     RECORDING MODE IS F                                          01270036
008500     BLOCK CONTAINS 0 RECORDS                                     01280036
008600     LABEL RECORDS ARE STANDARD.                                  01290036
008700                                                                  01300036
008800 01  CONTROL-CARD-RECORD             PIC X(80).                   01310036
008900                                                                  01320036
009000 FD  LINE-ITEM-DISC-REPORT                                        01330036
009100     RECORDING MODE IS F                                          01340036
009200     BLOCK CONTAINS 0  RECORDS.                                   01350036
009300                                                                  01360036
009400 01  LINE-ITEM-DISC-RECORD           PIC  X(150).                 01370037
009500                                                                  01380036
009600******************************************************************01390036
009700 WORKING-STORAGE SECTION.                                         01400036
009800******************************************************************01410036
009900*----------------------------------------------------------------*01420036
010000* RECORD LAYOUT FOR INPUT DATE CARD                               01430036
010100*----------------------------------------------------------------*01440036
010200 01  CC-DATE-CARD.                                                01450036
010300     05  CC-WEEK-END-DTE                PIC X(08).                01460036
010400     05  FILLER                         PIC X(01) VALUE SPACES.   01470036
010500     05  CC-WEEK-BEG-DTE                PIC X(08).                01480036
010600     05  FILLER                         PIC X(61) VALUE SPACES.   01490036
010700                                                                  01500036
010800*----------------------------------------------------------------*01510036
010900* RECORD LAYOUT FOR INPUT CONTROL CARD                            01520036
011000*----------------------------------------------------------------*01530036
011100                                                                  01540036
011200 01  CC-CONTROL-CARD.                                             01550036
011300     05  CC-CONTROL-CARD-DISPLAY.                                 01560036
011400         10  CC-MAXIMUM-DISCOUNT-AMOUNT PIC 9(3)V99 VALUE ZERO.   01570036
011500         10  FILLER                   PIC X(1)    VALUE SPACES.   01580036
011600         10  CC-MAXIMUM-DISCOUNT-PERCENT                          01590036
011700                                      PIC 9(3)    VALUE ZERO.     01600036
011800     05  FILLER                       PIC X(71)   VALUE SPACES.   01610036
011900                                                                  01620036
012000 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01630036
012100                                                  COMP SYNC.      01640036
012200     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01650036
012300     88  AC-DB2-ERROR                             VALUE +4013.    01660036
012400                                                                  01670036
012500 01  PS-PROGRAM-SWITCHES.                                         01680036
012600     05  PS-END-OF-TEPLID-SW           PIC X(01)  VALUE 'N'.      01690036
012700         88  PS-END-OF-TEPLID                     VALUE 'Y'.      01700036
012800     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      01710036
012900         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01720036
013000     05  PS-END-OF-DATE-FILE-SW        PIC X(01)  VALUE 'N'.      01730036
013100         88  PS-END-OF-DATE-FILE                  VALUE 'Y'.      01740036
013200     05  PS-ONLY-753-SW                PIC X(01)  VALUE 'D'.      01750036
013300         88  PS-ONLY-753                          VALUE 'Y'.      01760036
013400         88  PS-OTHER                             VALUE 'O'.      01770036
013500         88  PS-DONT-KNOW                         VALUE 'D'.      01780036
013600     05  PS-FIRST-TIME-SW              PIC X(01)  VALUE 'Y'.      01790036
013700         88  PS-FIRST-TIME                        VALUE 'Y'.      01800036
013800         88  PS-NOT-FIRST-TIME                    VALUE 'N'.      01810036
013900                                                                  01820036
014000 01  PC-CONSTANTS.                                                01830036
014100     05  PC-LINE-LIMIT               PIC S9(04)  VALUE +60.       01840036
014200     05  PC-ONE                      PIC S9(01)  VALUE +1.        01850036
014300     05  PC-ROW-NOT-FOUND            PIC S9(04)  VALUE +100       01860036
014400                                                 COMP SYNC.       01870036
014500     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            01880036
014600                                                 'SSKRP047'.      01890036
014700     05  PC-REPORT-NBR-1             PIC  9(01)  VALUE 1.         01900036
014800     05  PC-GOLDSTAR-MARKDOWN        PIC  X(03)  VALUE '753'.     01910036
014900     05  PC-EMPLOYEE-MARKDOWN        PIC  X(03)  VALUE '790'.     01920036
015000     05  PC-ASSOC-SALE               PIC  X(02)  VALUE '02'.      01930036
015100     05  PC-ASSOC-RETURN             PIC  X(02)  VALUE '12'.      01940036
015200     05  PC-ASSOC-MIXMODE            PIC  X(02)  VALUE '22'.      01950036
015300     05  PC-DOLLAR-OFF               PIC  X(01)  VALUE 'D'.       01960036
015400     05  PC-CORRECTION               PIC  X(01)  VALUE 'C'.       01970036
015410     05  PC-PERCENT-OFF              PIC  X(01)  VALUE 'P'.       01980036
015500                                                                  01990036
015600 01  PV-MISC-COUNT-FIELDS            COMP-3.                      02000036
015700     05  PV-PAGE-CNT                 PIC S9(05)    VALUE ZEROS.   02010036
015800     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZEROS.   02020036
015900                                                                  02030036
016000 01  PV-SAVE-AREA.                                                02040036
016100     05  PV-PRINTED-STR              PIC S9(04)    VALUE ZERO     02050036
016200                                                   COMP.          02060036
016500     05  PV-PRINTED-RGST             PIC S9(04)    VALUE ZERO     02070036
016600                                                   COMP.          02080036
016700     05  PV-PRINTED-TRN              PIC S9(04)    VALUE ZERO     02090036
016800                                                   COMP.          02100036
016100     05  PV-SAVE-STORE               PIC S9(04)    VALUE ZERO     02110036
016200                                                   COMP.          02120036
016300     05  PV-SAVE-STORE-PRT           PIC S9(04)    VALUE ZERO     02130036
016400                                                   COMP.          02140036
016500     05  PV-SAVE-REGISTER            PIC S9(04)    VALUE ZERO     02150036
016600                                                   COMP.          02160036
016700     05  PV-SAVE-TRANSACTION         PIC S9(04)    VALUE ZERO     02170036
016800                                                   COMP.          02180036
016900     05  PV-SAVE-LINE-ITEM           PIC S9(04)    VALUE ZERO     02190036
017000                                                   COMP.          02200036
017100     05  PV-SAVE-SALES-DATE          PIC  X(10)    VALUE SPACES.  02210036
017200     05  PV-SAVE-START-TIME          PIC  X(08)    VALUE SPACES.  02220036
017300     05  PV-SAVE-ASSOC-ID            PIC S9(09)    VALUE ZEROS    02230036
017400                                                   COMP.          02240036
017500     05  PV-SAVE-RSN-CDE             PIC  X(03)    VALUE SPACES.  02250036
017500     05  PV-SAVE-TRAN-TYP-CDE        PIC  X(02)    VALUE SPACES.  02260036
           05  PV-SAVE-SAL-TYP-CDE         PIC  X(1)     VALUE SPACES.  02270055
           05  PV-SAVE-ITM-STAT-CDE        PIC  X(02)    VALUE SPACES.  02280082
           05  PV-SAVE-DEPT-NBR            PIC  X(03)    VALUE SPACES.  02290084
           05  PV-SAVE-PRIC-SRC-CDE        PIC  X(01)    VALUE SPACE.   02300059
           05  PV-SAVE-SKU                 PIC  9(08)    VALUE ZEROES.  02310036
           05  PV-SAVE-SKU-REDF REDEFINES PV-SAVE-SKU.                  02320076
               10  PV-SAVE-SKU-FIRST-FIVE  PIC  9(05).                  02330076
               10  PV-SAVE-SKU-LAST-THREE  PIC  9(03).                  02340076
017900     05  PV-SAVE-SOLD-QTY            PIC S9(04)    VALUE ZEROS    02350036
018000                                                   COMP.          02360036
018100     05  PV-SAVE-CHARGE-AMT          PIC S9(7)V99  VALUE ZERO     02370036
018200                                                   COMP-3.        02380036
           05  PV-SAVE-REG-RTL-AMT         PIC S9(5)V99  VALUE ZERO     02390055
                                                         COMP-3.        02400055
           05  PV-SAVE-SAL-RET-CDE         PIC X(1).                    02410065
               88  PV-SALE-CDE             VALUE 'S'.                   02420064
               88  PV-ADJ-SALE-CDE         VALUE 'A'.                   02430064
               88  PV-RETURN-CDE           VALUES 'R', 'B'.             02440066
018300                                                                  02450036
018400 01  PV-MISC-FIELDS.                                              02460036
018500     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACE.   02470036
018600     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     02480036
018700                                                   COMP SYNC.     02490036
018800     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   02500036
018900     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   02510036
019000     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   02520036
019100     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   02530036
019200     05  PV-MAX-DISCOUNT-AMT         PIC S9(7)V99  VALUE ZERO     02540036
019300                                                   COMP-3.        02550036
019400     05  PV-MIN-DISCOUNT-AMT         PIC S9(7)V99  VALUE ZERO     02560036
019500                                                   COMP-3.        02570036
019600     05  PV-MAX-DISCOUNT-PRCNT       PIC S9(4)V9(5) COMP-3        02580036
019700                                                   VALUE ZERO.    02590036
019800     05  PV-MAX-DISCOUNT-PRCNT-DSP   PIC 9(3)      VALUE ZERO.    02600036
020500     05  PV-DISCOUNT-PCT             PIC 9(3)      VALUE ZERO.    02610036
020600     05  PV-DISCOUNT-PCT-99          PIC 9(3)V99   VALUE ZERO.    02620036
020700     05  PV-DISCOUNT-PCT-99999       PIC 9(3)V9(5) VALUE ZERO.    02630036
020800     05  PV-DISCOUNT-AMT             PIC S9(7)V99  VALUE ZERO.    02640036
020900     05  PV-MARKDOWN-AMT             PIC S9(7)V99  VALUE ZERO.    02650036
021000     05  PV-NET-CHARGED-AMOUNT       PIC S9(7)V99  VALUE ZERO.    02660036
021100     05  PV-LID-COUNT                PIC S9(7)     VALUE ZERO     02670036
021200                                                   COMP-3.        02680036
021300 01  PV-DATE-AND-TIME-FIELDS.                                     02690036
021400     05  PV-WEEK-BEG-DATE            PIC X(10).                   02700036
021500     05  PV-WEEK-END-DATE            PIC X(10).                   02710036
021600     05  PV-BEG-DATE.                                             02720036
021700         10  PV-BEG-CCYY             PIC X(04).                   02730036
021800         10  PV-BEG-MM               PIC X(02).                   02740036
021900         10  PV-BEG-DD               PIC X(02).                   02750036
022000     05  PV-DB2-BEG-DATE.                                         02760036
022100         10  PV-DB2-BEG-CCYY         PIC X(04).                   02770036
022200         10  FILLER                  PIC X(01)    VALUE '-'.      02780036
022300         10  PV-DB2-BEG-MM           PIC X(02).                   02790036
022400         10  FILLER                  PIC X(01)    VALUE '-'.      02800036
022500         10  PV-DB2-BEG-DD           PIC X(02).                   02810036
022600     05  PV-END-DATE.                                             02820036
022700         10  PV-END-CCYY             PIC X(04).                   02830036
022800         10  PV-END-MM               PIC X(02).                   02840036
022900         10  PV-END-DD               PIC X(02).                   02850036
023000     05  PV-DB2-END-DATE.                                         02860036
023100         10  PV-DB2-END-CCYY         PIC X(04).                   02870036
023200         10  FILLER                  PIC X(01)    VALUE '-'.      02880036
023300         10  PV-DB2-END-MM           PIC X(02).                   02890036
023400         10  FILLER                  PIC X(01)    VALUE '-'.      02900036
023500         10  PV-DB2-END-DD           PIC X(02).                   02910036
023600     05  PV-POS-CCYY-MM-DD           PIC X(10)     VALUE SPACE.   02920036
023700     05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      02930036
023800         10  PV-POS-CCYY.                                         02940036
023900             15  PV-POS-CC           PIC X(02).                   02950036
024000             15  PV-POS-YY           PIC X(02).                   02960036
024100         10  FILLER                  PIC X(01).                   02970036
024200         10  PV-POS-MM               PIC X(02).                   02980036
024300         10  FILLER                  PIC X(01).                   02990036
024400         10  PV-POS-DD               PIC X(02).                   03000036
024500     05  PV-CURR-DATE-CCYYMMDD.                                   03010036
024600         10  PV-CURR-DATE-CCYY       PIC  9(04).                  03020036
024700         10  PV-CURR-DATE-MM         PIC  9(02).                  03030036
024800         10  PV-CURR-DATE-DD         PIC  9(02).                  03040036
024900     05  PV-CURR-TIME.                                            03050036
025000         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    03060036
025100         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    03070036
025200         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    03080036
025300     05  PV-HEADER-DATE.                                          03090036
025400         10  PV-HEADER-MM            PIC XX.                      03100036
025500         10  PV-HEADER-SLASH-1       PIC X.                       03110036
025600         10  PV-HEADER-DD            PIC XX.                      03120036
025700         10  PV-HEADER-SLASH-2       PIC X.                       03130036
025800         10  PV-HEADER-CCYY          PIC X(04).                   03140036
025900     05  PV-SALES-DATE.                                           03150036
026000         10  PV-SALES-MM             PIC XX.                      03160036
026100         10  PV-SALES-SLASH-1        PIC X.                       03170036
026200         10  PV-SALES-DD             PIC XX.                      03180036
026300         10  PV-SALES-SLASH-2        PIC X.                       03190036
026400         10  PV-SALES-YY             PIC XX.                      03200036
026500                                                                  03210036
026600                                                                  03220036
026700******************************************************************03230036
026800*  TOP OF PAGE HEADING LINE FOR PRINTING A 150 CHARACTER REPORT.  03240037
026900******************************************************************03250036
027000     COPY DPWS150.                                                03260037
027100                                                                  03270036
027200******************************************************************03280036
027300*  HEADING LINES FOR THE EXCEPTION REPORT.                        03290036
027400******************************************************************03300036
027500                                                                  03310036
027600 01  HL2-HEADING-LINE-2.                                          03320036
027700     05  FILLER                  PIC X(45)   VALUE SPACE.         03330037
027800     05  FILLER                  PIC X(52)   VALUE                03340036
027900         'LINE ITEM DISCOUNT EXCEPTION REPORT FOR WEEK ENDING '.  03350036
028000     05  HL2-DATE                PIC X(10)   VALUE SPACES.        03360036
028100     05  FILLER                  PIC X(43)   VALUE SPACES.        03370037
028200                                                                  03380036
028300 01  HL3-HEADING-LINE-3.                                          03390036
028400     05  FILLER                  PIC X(34)   VALUE SPACE.         03400037
028500     05  FILLER                  PIC X(35)   VALUE                03410036
028600         'FOR DISCOUNTS AMOUNTS GREATER THAN '.                   03420036
028700     05  HL3-MAXIMUM-DISCOUNT-AMOUNT PIC ZZZ.99 VALUE ZERO.       03430036
028800     05  FILLER                  PIC X(37)   VALUE                03440036
028900         '  OR DISCOUNTS PERCENTS GREATER THAN '.                 03450036
029000     05  HL3-MAXIMUM-DISCOUNT-PCT    PIC ZZZ    VALUE ZERO.       03460036
029100     05  FILLER                  PIC X(35)   VALUE SPACES.        03470037
029200                                                                  03480036
029300 01  HL4-HEADING-LINE-4.                                          03490036
029400     05  FILLER                  PIC X(22)   VALUE SPACES.        03500038
029500     05  FILLER                  PIC X(5)    VALUE 'TRANS'.       03510036
029600     05  FILLER                  PIC X(14)   VALUE SPACES.        03520036
029700     05  FILLER                  PIC X(3)    VALUE 'SKU'.         03530036
029800     05  FILLER                  PIC X(5)    VALUE SPACES.        03540036
029900     05  FILLER                  PIC X(5)    VALUE 'ASSOC'.       03550036
030000     05  FILLER                  PIC X(12)   VALUE SPACES.        03560036
           05  FILLER                  PIC X(4)    VALUE 'SALE'.        03570039
           05  FILLER                  PIC X(2)    VALUE SPACES.        03580039
030100     05  FILLER                  PIC X(8)    VALUE 'CUSTOMER'.    03590036
030200     05  FILLER                  PIC X(2)    VALUE SPACE.         03600036
030300     05  FILLER                  PIC X(7)    VALUE 'TOTAL %'.     03610036
030400     05  FILLER                  PIC X(6)    VALUE SPACES.        03620036
030500     05  FILLER                  PIC X       VALUE '$'.           03630036
030600     05  FILLER                  PIC X(07)   VALUE SPACES.        03640036
030600     05  FILLER                  PIC X(03)   VALUE 'RSN'.         03650036
030600     05  FILLER                  PIC X(04)   VALUE SPACES.        03660036
030700     05  FILLER                  PIC X(3)    VALUE 'LID'.         03670036
030800     05  FILLER                  PIC X(5)    VALUE SPACES.        03680036
030900     05  FILLER                  PIC X(8)    VALUE 'MARKDOWN'.    03690036
031000     05  FILLER                  PIC X(6)    VALUE SPACES.        03700036
031100     05  FILLER                  PIC X(3)    VALUE 'NET'.         03710036
031200     05  FILLER                  PIC X(14)   VALUE SPACES.        03720037
031300                                                                  03730036
031400 01  HL5-HEADING-LINE-5.                                          03740036
031500     05  FILLER                  PIC X(5)    VALUE 'STORE'.       03750036
031600     05  FILLER                  PIC X(2)    VALUE SPACE.         03760036
031700     05  FILLER                  PIC X(4)    VALUE 'TERM'.        03770036
031800     05  FILLER                  PIC X(2)    VALUE SPACES.        03780036
031900     05  FILLER                  PIC X(5)    VALUE 'TRANS'.       03790036
032000     05  FILLER                  PIC X(4)    VALUE SPACES.        03800036
032100     05  FILLER                  PIC X(4)    VALUE 'DATE'.        03810036
032200     05  FILLER                  PIC X(5)    VALUE SPACES.        03820036
032300     05  FILLER                  PIC X(4)    VALUE 'OPER'.        03830036
032400     05  FILLER                  PIC X(5)    VALUE SPACES.        03840036
032500     05  FILLER                  PIC X(6)    VALUE 'NUMBER'.      03850036
032600     05  FILLER                  PIC X(4)    VALUE SPACES.        03860036
032700     05  FILLER                  PIC X(4)    VALUE 'TRAN'.        03870036
032800     05  FILLER                  PIC X(2)    VALUE SPACES.        03880036
032900     05  FILLER                  PIC X(5)    VALUE 'UNITS'.       03890036
033000     05  FILLER                  PIC X(5)    VALUE SPACES.        03900036
           05  FILLER                  PIC X(4)    VALUE 'ITEM'.        03910039
           05  FILLER                  PIC X(2)    VALUE SPACES.        03920039
033100     05  FILLER                  PIC X(7)    VALUE 'CHARGED'.     03930036
033200     05  FILLER                  PIC X(3)    VALUE SPACE.         03940036
033300     05  FILLER                  PIC X(8)    VALUE 'DISCOUNT'.    03950036
033400     05  FILLER                  PIC X(2)    VALUE SPACES.        03960036
033500     05  FILLER                  PIC X(8)    VALUE 'DISCOUNT'.    03970036
033600     05  FILLER                  PIC X(3)    VALUE SPACES.        03980036
033600     05  FILLER                  PIC X(3)    VALUE 'CDE'.         03990036
033600     05  FILLER                  PIC X(3)    VALUE SPACES.        04000036
033700     05  FILLER                  PIC X(5)    VALUE 'COUNT'.       04010036
033800     05  FILLER                  PIC X(5)    VALUE SPACES.        04020036
033900     05  FILLER                  PIC X(6)    VALUE 'AMOUNT'.      04030036
034000     05  FILLER                  PIC X(6)    VALUE SPACES.        04040036
034100     05  FILLER                  PIC X(5)    VALUE 'PRICE'.       04050036
034200     05  FILLER                  PIC X(13)   VALUE SPACES.        04060037
034300                                                                  04070036
034400******************************************************************04080036
034500*  DETAIL LINE FOR THE LINE ITEM DISCOUNT REPORT.                 04090036
034600******************************************************************04100036
034700                                                                  04110036
034800 01  D1-DETAIL-LINE-1.                                            04120036
034900     05  DTL1-STORE              PIC 9(4).                        04130036
035000     05  FILLER                  PIC X(3)    VALUE SPACES.        04140036
035100     05  DTL1-TERM               PIC 9(4).                        04150036
035200     05  FILLER                  PIC X(3)    VALUE SPACES.        04160036
035300     05  DTL1-TRANS              PIC 9(4).                        04170036
035400     05  FILLER                  PIC X(2)    VALUE SPACES.        04180036
035500     05  DTL1-DATE               PIC X(8).                        04190036
035600     05  FILLER                  PIC X(2)    VALUE SPACES.        04200036
035700***  05  DTL1-OPER-ID            PIC 9(6).                        04210074
035800***  05  FILLER                  PIC X(3)    VALUE SPACES.        04220074
NEMCHG     05  DTL1-OPER-ID            PIC 9(7).                        04230074
NEMCHG     05  FILLER                  PIC X(2)    VALUE SPACES.        04240074
035900     05  DTL1-SKU                PIC X(08).                       04250036
036000     05  FILLER                  PIC X(4)    VALUE SPACES.        04260036
036100     05  DTL1-ASSOC-TRAN-IND     PIC X(1) .                       04270074
036200     05  FILLER                  PIC X(3)    VALUE SPACES.        04280074
036300     05  DTL1-UNITS              PIC ZZ,ZZZ-.                     04290036
036400     05  FILLER                  PIC X(6)    VALUE SPACES.        04300040
           05  DTL1-SALE-IND           PIC X(1).                        04310041
           05  FILLER                  PIC X(2)    VALUE SPACES.        04320040
036500     05  DTL1-CUST-CHARGED       PIC ZZ,ZZZ.99-.                  04330036
036600     05  FILLER                  PIC X(3)    VALUE SPACES.        04340036
036700     05  DTL1-DISCOUNT-PCT       PIC ZZZ.                         04350036
036800     05  FILLER                  PIC X(4)    VALUE SPACES.        04360036
036900     05  DTL1-DISCOUNT-AMT       PIC ZZ,ZZZ.ZZ-.                  04370036
037000     05  FILLER                  PIC X(2)    VALUE SPACES.        04380036
037000     05  DTL1-RSN-CDE            PIC X(3).                        04390036
037000     05  FILLER                  PIC X(4)    VALUE SPACES.        04400036
037100     05  DTL1-LID-COUNT          PIC ZZZ.                         04410036
037200     05  FILLER                  PIC X(4)    VALUE SPACES.        04420036
037300     05  DTL1-MARKDOWN-AMT       PIC ZZ,ZZZ.99-.                  04430036
037400     05  FILLER                  PIC X(2)    VALUE SPACES.        04440036
037500     05  DTL1-NET-AMT            PIC ZZ,ZZZ.99-.                  04450036
           05  FILLER                  PIC X(5)    VALUE SPACES.        04460037
037600                                                                  04470036
037700******************************************************************04480036
037800*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            04490036
037900******************************************************************04500036
038000     COPY DPWS004.                                                04510036
038100                                                                  04520036
038200******************************************************************04530036
038300*  DB2 COMMUNICATION AREA.                                        04540036
038400******************************************************************04550036
038500     EXEC SQL                                                     04560036
038600          INCLUDE SQLCA                                           04570036
038700     END-EXEC.                                                    04580036
038800******************************************************************04590036
038900*  DB2 TABLE DB2PDBA.TEPITM  - ITEM TABLE                         04600036
039000******************************************************************04610036
039100     EXEC SQL                                                     04620036
039200          INCLUDE TEPITM                                          04630036
039300     END-EXEC.                                                    04640036
039400******************************************************************04650036
039500*  DB2 TABLE DB2PDBA.TEPLID  - LINE ITEM DISCOUNT TABLE           04660036
039600******************************************************************04670036
039700     EXEC SQL                                                     04680036
039800          INCLUDE TEPLID                                          04690036
039900     END-EXEC.                                                    04700036
040000                                                                  04710036
040100******************************************************************04720036
040200*  DB2 TABLE DB2PDBA.TEPTRN  - TRANSACTION TABLE                  04730036
040300******************************************************************04740036
040400     EXEC SQL                                                     04750036
040500          INCLUDE TEPTRN                                          04760036
040600     END-EXEC.                                                    04770036
040700                                                                  04780036
040800******************************************************************04790036
040900*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            04800036
041000******************************************************************04810036
041100     EXEC SQL                                                     04820036
041200          INCLUDE TEPPART                                         04830036
041300     END-EXEC.                                                    04840036
041400                                                                  04850036
041500******************************************************************04860036
041600*  CURSOR FOR FETCHING TEPLID                                     04870036
041700******************************************************************04880036
041800     EXEC SQL                                                     04890036
041900         DECLARE TEPLID-CURSOR CURSOR FOR                         04900036
042000                                                                  04910036
042100         SELECT TRN.STR_NBR                                       04920036
042200              , TRN.RGST_ID                                       04930036
042300              , TRN.TRN_NBR                                       04940036
042400              , TRN.SLS_DTE                                       04950036
042500              , TRN.STRT_TM                                       04960036
042600              , TRN.ASSOC_ID                                      04970036
043000              , TRN.TRN_TYP_CDE                                   04980036
                    , ITM.DEPT_NBR                                      04990075
043100              , ITM.SLD_QTY                                       05000036
                    , ITM.SAL_TYP_CDE                                   05010055
                    , ITM.SAL_RET_CDE                                   05020055
                    , ITM.ITM_STAT_CDE                                  05030081
043200              , ITM.CUST_CHRGD_AMT                                05040081
                    , ITM.REG_RTL_AMT                                   05050055
                    , ITM.PRIC_SRC_CDE                                  05060059
043300              , ITM.NET_CHRGD_AMT                                 05070036
043400              , LID.LID_TYP_CDE                                   05080036
043500              , LID.LID_PCT                                       05090036
043600              , LID.LID_AMT                                       05100036
043700              , LID.LID_RSN_CDE                                   05110036
043800              , ITM.LNE_ITM_SEQ_NBR                               05120036
043900              , ITM.SKU_NBR                                       05130036
044000         FROM TEPPART PRT                                         05140036
044100            , TEPTRN  TRN                                         05150036
044200            , TEPITM  ITM                                         05160036
044300            , TEPLID  LID                                         05170036
044400                                                                  05180036
044500         WHERE (PRT.SLS_DTE     BETWEEN :PV-WEEK-BEG-DATE         05190036
044600                                    AND :PV-WEEK-END-DATE)        05200036
044700           AND TRN.PARTN_NBR          = PRT.PARTN_NBR             05210036
044800           AND ITM.PARTN_NBR          = TRN.PARTN_NBR             05220036
044900           AND LID.PARTN_NBR          = TRN.PARTN_NBR             05230036
045000           AND ITM.STR_NBR            = TRN.STR_NBR               05240036
045100           AND LID.STR_NBR            = TRN.STR_NBR               05250036
045200           AND ITM.RGST_ID            = TRN.RGST_ID               05260036
045300           AND LID.RGST_ID            = TRN.RGST_ID               05270036
045400           AND ITM.TRN_NBR            = TRN.TRN_NBR               05280036
045500           AND LID.TRN_NBR            = TRN.TRN_NBR               05290036
045600           AND ITM.STRT_TM            = TRN.STRT_TM               05300036
045700           AND LID.STRT_TM            = TRN.STRT_TM               05310036
045800           AND ITM.SLS_CORR_SEQ_NBR   = TRN.SLS_CORR_SEQ_NBR      05320036
045900           AND LID.SLS_CORR_SEQ_NBR   = TRN.SLS_CORR_SEQ_NBR      05330036
046000           AND LID.LNE_ITM_SEQ_NBR    = ITM.LNE_ITM_SEQ_NBR       05340036
046100           AND TRN.VOID_ABRT_CDE      = 'N'                       05350036
046200           AND TRN.TRN_STAT_CDE      IN ('V','Z','R','L')         05360036
046300           AND TRN.TRN_TYP_CDE       IN                           05370036
046400                                   ('01','02','11','12','22','23')05380036
046500           AND ITM.LIV_RSLU_CDE       = '+'                       05390036
046600           AND LID.LID_TYP_CDE       IN ('P','D','C')             05400036
049000                                                                  05410036
049100         ORDER BY TRN.STR_NBR                                     05420036
049200                , TRN.ASSOC_ID                                    05430036
049200                , TRN.SLS_DTE                                     05440036
049200                , TRN.RGST_ID                                     05450036
049300                , TRN.TRN_NBR                                     05460036
049400                , ITM.LNE_ITM_SEQ_NBR                             05470036
049500                                                                  05480036
049600         WITH UR                                                  05490036
049700     END-EXEC.                                                    05500036
049800                                                                  05510036
049900*---------------------------------------------------------------* 05520036
050000*---------------------------------------------------------------* 05530036
050100 PROCEDURE DIVISION.                                              05540036
050200*---------------------------------------------------------------* 05550036
050300                                                                  05560036
050400 0000-MAINLINE-PARAGRAPH.                                         05570036
050500                                                                  05580036
050600     PERFORM 1000-INITIALIZE.                                     05590036
050700                                                                  05600036
050800     PERFORM 2000-PROCESS-STORE-REGISTER                          05610036
050900       UNTIL PS-END-OF-TEPLID.                                    05620036
051000                                                                  05630036
051100     PERFORM 8200-CLOSE-TEPLID-CURSOR.                            05640036
051200                                                                  05650036
051300     CLOSE LINE-ITEM-DISC-REPORT.                                 05660036
051400                                                                  05670036
051500     GOBACK.                                                      05680036
051600                                                                  05690036
051700*---------------------------------------------------------------* 05700036
051800* 1000-INITIALIZE-PROGRAM                                         05710036
051900*     OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS    05720036
052000*---------------------------------------------------------------* 05730036
052100 1000-INITIALIZE.                                                 05740036
052200                                                                  05750036
052300     OPEN INPUT  POS-DATE-CARD-FILE                               05760036
052400                 CONTROL-CARD-FILE                                05770036
052500          OUTPUT LINE-ITEM-DISC-REPORT.                           05780036
052600                                                                  05790036
052700     PERFORM 1100-PROCESS-CONTROL-CARD.                           05800036
052800                                                                  05810036
052900     PERFORM 1300-PROCESS-DATE-CARD.                              05820036
053000                                                                  05830036
053100     PERFORM 1500-FORMAT-HEADINGS.                                05840036
053200*        INITIALIZE LINE COUNTER TO GENERATE INITIAL PAGE BREAK.  05850036
053300     MOVE +65  TO  PV-LINE-CNT.                                   05860036
053400                                                                  05870036
053500     PERFORM 8000-OPEN-TEPLID-CURSOR.                             05880036
053600     PERFORM 8100-FETCH-TEPLID-CURSOR.                            05890036
053700     IF PS-END-OF-TEPLID                                          05900036
053800         MOVE '1000-INITIALIZE'  TO  PV-PARAGRAPH-NAME            05910036
053900         MOVE 'NO DATA FOUND FOR TEPLID CURSOR.'                  05920036
054000                                 TO  PV-OPERATION-MSG-1           05930036
054100         SET AC-DB2-ERROR        TO  TRUE                         05940036
054200         PERFORM 9999-ABEND                                       05950036
054300     END-IF.                                                      05960036
054400                                                                  05970036
054500     MOVE EPTRN-STR-NBR          TO  PV-SAVE-STORE.               05980036
054600     MOVE EPTRN-RGST-ID          TO  PV-SAVE-REGISTER.            05990036
054700     MOVE EPTRN-TRN-NBR          TO  PV-SAVE-TRANSACTION.         06000036
           MOVE EPITM-SKU-NBR          TO  PV-SAVE-SKU.                 06010036
055100     MOVE EPITM-LNE-ITM-SEQ-NBR  TO  PV-SAVE-LINE-ITEM.           06020036
055200                                                                  06030036
055300     MOVE EPTRN-SLS-DTE          TO  PV-SAVE-SALES-DATE.          06040036
055400     MOVE EPTRN-STRT-TM          TO  PV-SAVE-START-TIME.          06050036
055500     MOVE EPTRN-ASSOC-ID         TO  PV-SAVE-ASSOC-ID.            06060036
055600     MOVE EPTRN-TRN-TYP-CDE      TO  PV-SAVE-TRAN-TYP-CDE.        06070036
           MOVE EPITM-DEPT-NBR         TO  PV-SAVE-DEPT-NBR.            06080076
055700     MOVE EPITM-SLD-QTY          TO  PV-SAVE-SOLD-QTY.            06090036
055800     MOVE EPITM-ITM-STAT-CDE     TO  PV-SAVE-ITM-STAT-CDE.        06100081
055800     MOVE EPITM-CUST-CHRGD-AMT   TO  PV-SAVE-CHARGE-AMT.          06110081
055900     MOVE EPITM-NET-CHRGD-AMT    TO  PV-NET-CHARGED-AMOUNT.       06120036
           MOVE EPITM-REG-RTL-AMT      TO  PV-SAVE-REG-RTL-AMT.         06130055
           MOVE EPITM-SAL-TYP-CDE      TO  PV-SAVE-SAL-TYP-CDE.         06140055
           MOVE EPITM-SAL-RET-CDE      TO  PV-SAVE-SAL-RET-CDE.         06150055
           MOVE EPITM-PRIC-SRC-CDE     TO  PV-SAVE-PRIC-SRC-CDE.        06160059
056000                                                                  06170036
056100******************************************************************06180036
056200* 1100-PROCESS-CONTROL-CARD                                       06190036
056300*     READ CONTROL CARD TO GET POS DATE IN MMDDYY FORMAT.  CALL   06200036
056400*     DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD PROCESS DATE.  06210036
056500******************************************************************06220036
056600                                                                  06230036
056700 1100-PROCESS-CONTROL-CARD.                                       06240036
056800                                                                  06250036
056900     PERFORM 1200-READ-CONTROL-CARD.                              06260036
057000                                                                  06270036
057100     IF PS-END-OF-CARD-FILE                                       06280036
057200         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   06290036
057300         MOVE 'CONTROL CARD MISSING      ' TO PV-OPERATION-MSG-1  06300036
057400         SET AC-CONTROL-CARD-ERROR TO TRUE                        06310036
057500         PERFORM 9999-ABEND                                       06320036
057600     END-IF.                                                      06330036
057700                                                                  06340036
057800     DISPLAY PC-CURRENT-PROGRAM-NAME                              06350036
057900             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY  ')'.  06360036
058000                                                                  06370036
058100     MOVE CC-MAXIMUM-DISCOUNT-AMOUNT TO                           06380036
058200                                    PV-MAX-DISCOUNT-AMT.          06390036
058300     MOVE CC-MAXIMUM-DISCOUNT-PERCENT TO                          06400036
058400                                    PV-MAX-DISCOUNT-PRCNT-DSP.    06410036
058500     COMPUTE PV-MAX-DISCOUNT-PRCNT =                              06420036
058600                 ( PV-MAX-DISCOUNT-PRCNT-DSP / 100 ).             06430036
058700                                                                  06440036
058800     IF PV-MAX-DISCOUNT-AMT NOT NUMERIC                           06450036
058900         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   06460036
059000         MOVE 'NON-NUMERIC CONTROL CARD AMOUNT'                   06470036
059100                                           TO PV-OPERATION-MSG-1  06480036
059200         SET AC-CONTROL-CARD-ERROR TO TRUE                        06490036
059300         PERFORM 9999-ABEND                                       06500036
059400     END-IF                                                       06510036
059500                                                                  06520036
059600     COMPUTE PV-MIN-DISCOUNT-AMT =                                06530036
059700                          PV-MAX-DISCOUNT-AMT * -1.               06540036
059800                                                                  06550036
059900     MOVE PV-MAX-DISCOUNT-AMT  TO  HL3-MAXIMUM-DISCOUNT-AMOUNT.   06560036
060000     MOVE PV-MAX-DISCOUNT-PRCNT-DSP  TO  HL3-MAXIMUM-DISCOUNT-PCT.06570036
060100                                                                  06580036
060200******************************************************************06590036
060300* 1200-READ-CONTROL-CARD                                          06600036
060400*     READ CONTROL CARD.                                          06610036
060500******************************************************************06620036
060600                                                                  06630036
060700 1200-READ-CONTROL-CARD.                                          06640036
060800                                                                  06650036
060900     READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                  06660036
061000        AT END                                                    06670036
061100           SET PS-END-OF-CARD-FILE TO TRUE.                       06680036
061200                                                                  06690036
061300     CLOSE CONTROL-CARD-FILE.                                     06700036
061400                                                                  06710036
061500******************************************************************06720036
061600* 1300-PROCESS-DATE-CARD                                          06730036
061700******************************************************************06740036
061800                                                                  06750036
061900 1300-PROCESS-DATE-CARD.                                          06760036
062000                                                                  06770036
062100     READ POS-DATE-CARD-FILE INTO CC-DATE-CARD                    06780036
062200         AT END                                                   06790036
062300             SET PS-END-OF-DATE-FILE TO TRUE.                     06800036
062400                                                                  06810036
062500     IF PS-END-OF-DATE-FILE                                       06820036
062600         MOVE '1300-PROCESS-DATE-CARD'  TO PV-PARAGRAPH-NAME      06830036
062700         MOVE 'DATE CARD MISSING      ' TO PV-OPERATION-MSG-1     06840036
062800         SET AC-CONTROL-CARD-ERROR TO TRUE                        06850036
062900         PERFORM 9999-ABEND                                       06860036
063000     END-IF.                                                      06870036
063100                                                                  06880036
063200     DISPLAY 'WEEK BEG DATE ' CC-WEEK-BEG-DTE.                    06890036
063300     DISPLAY 'WEEK END DATE ' CC-WEEK-END-DTE.                    06900036
063400                                                                  06910036
063500     MOVE CC-WEEK-BEG-DTE TO PV-BEG-DATE.                         06920036
063600     MOVE CC-WEEK-END-DTE TO PV-END-DATE.                         06930036
063700     MOVE PV-BEG-MM                   TO PV-DB2-BEG-MM.           06940036
063800     MOVE PV-BEG-DD                   TO PV-DB2-BEG-DD.           06950036
063900     MOVE PV-BEG-CCYY                 TO PV-DB2-BEG-CCYY.         06960036
064000     MOVE PV-END-MM                   TO PV-DB2-END-MM.           06970036
064100     MOVE PV-END-DD                   TO PV-DB2-END-DD.           06980036
064200     MOVE PV-END-CCYY                 TO PV-DB2-END-CCYY.         06990036
064300     MOVE PV-DB2-BEG-DATE             TO PV-WEEK-BEG-DATE.        07000036
064400     MOVE PV-DB2-END-DATE             TO PV-WEEK-END-DATE.        07010036
064500                                                                  07020036
064600                                                                  07030036
064700******************************************************************07040036
064800* 1500-FORMAT-HEADINGS                                            07050036
064900*     GET CURRENT DATE AND TIME FROM SYSTEM.                      07060036
065000*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          07070036
065100*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              07080036
065200******************************************************************07090036
065300 1500-FORMAT-HEADINGS.                                            07100036
065400                                                                  07110036
065500     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   07120036
065600     ACCEPT PV-CURR-TIME FROM TIME.                               07130036
065700                                                                  07140036
065800     MOVE PV-CURR-DATE-MM             TO DP150-RUN-MONTH.         07150037
065900     MOVE PV-CURR-DATE-DD             TO DP150-RUN-DAY.           07160037
066000     MOVE PV-CURR-DATE-CCYY           TO DP150-RUN-YEAR.          07170037
066100                                                                  07180036
066200     MOVE PV-CURR-TIME-HH             TO DP150-RUN-HOUR.          07190037
066300     MOVE PV-CURR-TIME-MM             TO DP150-RUN-MINUTE.        07200037
066400     MOVE PC-CURRENT-PROGRAM-NAME     TO DP150-PROGRAM-NAME.      07210037
066500     MOVE PC-REPORT-NBR-1             TO DP150-REPORT-NUMBER.     07220037
066600                                                                  07230036
066700     MOVE PV-DB2-END-DATE             TO PV-POS-CCYY-MM-DD.       07240036
066800     MOVE PV-POS-MM                   TO PV-HEADER-MM.            07250036
066900     MOVE '/'                         TO PV-HEADER-SLASH-1.       07260036
067000     MOVE PV-POS-DD                   TO PV-HEADER-DD.            07270036
067100     MOVE '/'                         TO PV-HEADER-SLASH-2.       07280036
067200     MOVE PV-POS-CCYY                 TO PV-HEADER-CCYY.          07290036
067300     MOVE PV-HEADER-DATE              TO HL2-DATE.                07300036
067400                                                                  07310036
067500                                                                  07320036
067600*---------------------------------------------------------------* 07330036
067700* 2000-PROCESS-STORE-REGISTER.                                    07340036
067800*     PROCESS A TRANSACTION.  RETAIN THE FIRST VALID LID RECORD   07350036
067900*     AND ACCUMULATE ALL DETAIL RELATED TO THAT MERCHANDISE       07360036
068000*     ITEM.  RELATED DISCOUNTS ARE ASSUMED IF, WITHIN A GIVEN     07370036
068100*     TRANSACTION, THE LINE NUMBERS ARE THE SAME (INDICATING A    07380036
068200*     FURTHER REDUCTION IN PRICE FOR THE SAME ITEM).  LID REASON  07390036
068300*     CODE '753' (GOLDSTAR) ARE ADDED TO THE NET CHARGED AMOUNT   07400036
068400*     FOR SINCE THEY ARE AUTOMATICALLY TAKEN BY THE REGISTER AFTER07410036
068500*     A CLEARANCE PRICE IS ENTERED.  LID RSN CDE'S '753' AND '790'07420036
068600*     (EMPLOYEE DISCOUNT) ARE NOT INCLUDED IN THE REPORT.         07430036
068700*---------------------------------------------------------------* 07440036
068800 2000-PROCESS-STORE-REGISTER.                                     07450036
068900                                                                  07460036
069000     PERFORM 3000-PROCESS-TRANS-DATA                              07470036
069100         UNTIL (EPTRN-STR-NBR NOT EQUAL PV-SAVE-STORE             07480036
069200             OR EPTRN-RGST-ID NOT EQUAL PV-SAVE-REGISTER          07490036
069300             OR EPTRN-TRN-NBR NOT EQUAL PV-SAVE-TRANSACTION       07500036
069400             OR PS-END-OF-TEPLID).                                07510036
069500                                                                  07520036
069600     IF ( EPTRN-STR-NBR NOT EQUAL PV-SAVE-STORE )                 07530036
069700         PERFORM 9000-HEADER-ROUTINE                              07540036
069800     END-IF                                                       07550036
069900                                                                  07560036
070000     MOVE EPTRN-STR-NBR  TO  PV-SAVE-STORE.                       07570036
070100     MOVE EPTRN-RGST-ID  TO  PV-SAVE-REGISTER.                    07580036
070200     MOVE EPTRN-TRN-NBR  TO  PV-SAVE-TRANSACTION.                 07590036
070300                                                                  07600036
070400*---------------------------------------------------------------* 07610036
070500*                                                                 07620036
070600*---------------------------------------------------------------* 07630036
070700 3000-PROCESS-TRANS-DATA.                                         07640036
070800                                                                  07650036
070900     PERFORM 4000-PROCESS-SKU-LEVEL-DATA                          07660036
071000         UNTIL (EPTRN-STR-NBR NOT EQUAL PV-SAVE-STORE             07670036
071100             OR EPTRN-RGST-ID NOT EQUAL PV-SAVE-REGISTER          07680036
071200             OR EPTRN-TRN-NBR NOT EQUAL PV-SAVE-TRANSACTION       07690036
                   OR EPITM-SKU-NBR     NOT EQUAL PV-SAVE-SKU           07700036
071600             OR EPITM-LNE-ITM-SEQ-NBR NOT EQUAL PV-SAVE-LINE-ITEM 07710036
071700             OR PS-END-OF-TEPLID).                                07720036
071800                                                                  07730036
071810                                                                  07740036
071811     IF PV-SAVE-CHARGE-AMT = 0 THEN                               07750036
071812        MOVE 0 TO PV-DISCOUNT-PCT-99999                           07760036
071813     ELSE                                                         07770036
071820        COMPUTE PV-DISCOUNT-PCT-99999                             07780036
071830             = PV-MARKDOWN-AMT / PV-SAVE-CHARGE-AMT               07790036
071831     END-IF.                                                      07800036
071840                                                                  07810036
071850     COMPUTE PV-DISCOUNT-PCT-99 ROUNDED                           07820036
071860                                     = PV-DISCOUNT-PCT-99999.     07830036
071870     COMPUTE PV-DISCOUNT-PCT ROUNDED                              07840036
071880                                     = PV-DISCOUNT-PCT-99         07850036
071890                                     * 100.                       07860036
071891                                                                  07870036
071895     IF (PV-MARKDOWN-AMT <= PV-MIN-DISCOUNT-AMT) OR               07880036
071896        (PV-MARKDOWN-AMT >= PV-MAX-DISCOUNT-AMT) OR               07890036
071897        (PV-DISCOUNT-PCT-99999 >= PV-MAX-DISCOUNT-PRCNT)          07900036
071900        PERFORM 6000-PRINT-DETAIL                                 07910036
071910     END-IF.                                                      07920036
072000                                                                  07930036
072100     INITIALIZE  PV-LID-COUNT                                     07940036
072200                 PV-MARKDOWN-AMT                                  07950036
072300                 PV-DISCOUNT-AMT                                  07960036
072310                 PV-DISCOUNT-PCT                                  07970036
072320                 PV-DISCOUNT-PCT-99                               07980036
072400                 PV-DISCOUNT-PCT-99999                            07990036
072500                 PV-NET-CHARGED-AMOUNT.                           08000036
072600                                                                  08010036
           MOVE EPITM-SKU-NBR          TO  PV-SAVE-SKU.                 08020036
073000     MOVE EPITM-LNE-ITM-SEQ-NBR  TO  PV-SAVE-LINE-ITEM.           08030036
073100     MOVE EPITM-NET-CHRGD-AMT    TO  PV-NET-CHARGED-AMOUNT.       08040036
073200                                                                  08050036
073300     MOVE EPTRN-SLS-DTE          TO  PV-SAVE-SALES-DATE.          08060036
073400     MOVE EPTRN-STRT-TM          TO  PV-SAVE-START-TIME.          08070036
073500     MOVE EPTRN-ASSOC-ID         TO  PV-SAVE-ASSOC-ID.            08080036
073600     MOVE EPTRN-TRN-TYP-CDE      TO  PV-SAVE-TRAN-TYP-CDE.        08090036
           MOVE EPITM-DEPT-NBR         TO  PV-SAVE-DEPT-NBR.            08100076
073700     MOVE EPITM-SLD-QTY          TO  PV-SAVE-SOLD-QTY.            08110036
073800     MOVE EPITM-ITM-STAT-CDE     TO  PV-SAVE-ITM-STAT-CDE.        08120081
073800     MOVE EPITM-CUST-CHRGD-AMT   TO  PV-SAVE-CHARGE-AMT.          08130081
           MOVE EPITM-REG-RTL-AMT      TO  PV-SAVE-REG-RTL-AMT.         08140055
           MOVE EPITM-SAL-TYP-CDE      TO  PV-SAVE-SAL-TYP-CDE.         08150055
           MOVE EPITM-SAL-RET-CDE      TO  PV-SAVE-SAL-RET-CDE.         08160055
           MOVE EPITM-PRIC-SRC-CDE     TO  PV-SAVE-PRIC-SRC-CDE.        08170059
073900                                                                  08180036
074000*---------------------------------------------------------------* 08190036
074100*  PROCESS ITEM LEVEL DISCOUNTS FOR A TRANSACTION.              * 08200036
074200*---------------------------------------------------------------* 08210036
074300 4000-PROCESS-SKU-LEVEL-DATA.                                     08220036
074400                                                                  08230036
074500     EVALUATE TRUE                                                08240036
074600         WHEN EPLID-LID-RSN-CDE = PC-GOLDSTAR-MARKDOWN            08250036
074700         WHEN EPLID-LID-RSN-CDE = PC-EMPLOYEE-MARKDOWN            08260036
074800             SUBTRACT EPLID-LID-AMT FROM PV-NET-CHARGED-AMOUNT    08270036
074900         WHEN OTHER                                               08280036
075000             ADD PC-ONE  TO  PV-LID-COUNT                         08290036
075000             MOVE  EPLID-LID-RSN-CDE TO PV-SAVE-RSN-CDE           08300036
075100             IF ( EPLID-LID-TYP-CDE = PC-DOLLAR-OFF               08310036
075200               OR EPLID-LID-TYP-CDE = PC-CORRECTION  )            08320036
075300                 ADD EPLID-LID-AMT  TO  PV-DISCOUNT-AMT           08330036
075400             END-IF                                               08340036
075600             ADD EPLID-LID-AMT  TO  PV-MARKDOWN-AMT               08350036
081300             MOVE EPLID-LID-RSN-CDE        TO DTL1-RSN-CDE        08360036
075700     END-EVALUATE.                                                08370036
075800                                                                  08380036
075900     PERFORM 8100-FETCH-TEPLID-CURSOR.                            08390036
076000                                                                  08400036
076100******************************************************************08410036
076200* 6000-PRINT-DETAIL                                               08420036
076300*     PRINT THE QUALIFYING ROW                                    08430036
076400******************************************************************08440036
076500 6000-PRINT-DETAIL.                                               08450036
076600                                                                  08460036
076700     IF PV-LINE-CNT GREATER THAN PC-LINE-LIMIT                    08470036
076800         PERFORM 9000-HEADER-ROUTINE                              08480036
076700     ELSE                                                         08490036
076700         IF PV-SAVE-STORE           = PV-PRINTED-STR AND          08500036
076700            (PV-SAVE-REGISTER    NOT EQUAL PV-PRINTED-RGST OR     08510036
076700             PV-SAVE-TRANSACTION NOT EQUAL PV-PRINTED-TRN)        08520036
076700*            PS-END-OF-TEPLID-SW    = 'Y')                        08530036
076700             IF PV-LINE-CNT             = 8                       08540036
076700                CONTINUE                                          08550036
076700             ELSE                                                 08560036
076700                MOVE SPACE             TO PV-PRINT-RECORD         08570036
076700                PERFORM 9900-WRITE-REPORT-LINE                    08580036
076700             END-IF                                               08590036
076700         END-IF                                                   08600036
076900     END-IF.                                                      08610036
077000                                                                  08620036
077100     MOVE PV-SAVE-STORE            TO DTL1-STORE                  08630036
077100                                      PV-PRINTED-STR.             08640036
077200     MOVE PV-SAVE-REGISTER         TO DTL1-TERM                   08650036
077200                                      PV-PRINTED-RGST.            08660036
077300     MOVE PV-SAVE-TRANSACTION      TO DTL1-TRANS                  08670036
077300                                      PV-PRINTED-TRN.             08680036
077400                                                                  08690036
077500     MOVE PV-SAVE-SALES-DATE       TO PV-POS-CCYY-MM-DD.          08700036
077600     MOVE PV-POS-MM                TO PV-SALES-MM.                08710036
077700     MOVE '/'                      TO PV-SALES-SLASH-1.           08720036
077800     MOVE PV-POS-DD                TO PV-SALES-DD.                08730036
077900     MOVE '/'                      TO PV-SALES-SLASH-2.           08740036
078000     MOVE PV-POS-YY                TO PV-SALES-YY.                08750036
078100     MOVE PV-SALES-DATE            TO DTL1-DATE.                  08760036
078200                                                                  08770036
078300     MOVE PV-SAVE-ASSOC-ID         TO DTL1-OPER-ID.               08780036
078400     MOVE PV-SAVE-SKU              TO DTL1-SKU.                   08790036
078800                                                                  08800036
078900     IF ( PV-SAVE-TRAN-TYP-CDE = PC-ASSOC-SALE                    08810046
079000       OR PV-SAVE-TRAN-TYP-CDE = PC-ASSOC-RETURN                  08820046
079100       OR PV-SAVE-TRAN-TYP-CDE = PC-ASSOC-MIXMODE )               08830046
079200        MOVE 'Y'  TO  DTL1-ASSOC-TRAN-IND                         08840045
079300     ELSE                                                         08850036
079400        MOVE ' '  TO  DTL1-ASSOC-TRAN-IND                         08860045
079500     END-IF.                                                      08870036
079600                                                                  08880036
      * CHECKS TO SEE IF ITEM WAS ON SALE OR NOT                        08890049
           EVALUATE TRUE                                                08900065
             WHEN PV-SALE-CDE                                           08910064
                IF (PV-SAVE-SAL-TYP-CDE = 'P')                          08920072
                   MOVE 'Y' TO DTL1-SALE-IND                            08930061
                ELSE                                                    08940061
                   IF (PV-SAVE-SAL-TYP-CDE = 'C')                       08950061
                      MOVE 'C' TO DTL1-SALE-IND                         08960070
                   ELSE                                                 08970061
                      IF (PV-SAVE-SAL-TYP-CDE = 'G')                    08980061
                         MOVE 'G' TO DTL1-SALE-IND                      08990070
                      ELSE                                              09000061
                         MOVE SPACE TO DTL1-SALE-IND                    09010061
                      END-IF                                            09020061
                   END-IF                                               09030061
                END-IF                                                  09040061
             WHEN PV-ADJ-SALE-CDE                                       09050064
                IF (PV-SAVE-SAL-TYP-CDE = 'N' AND                       09060061
                   ((PV-SAVE-DEPT-NBR = '981' OR                        09070084
                    PV-SAVE-DEPT-NBR = '983' OR                         09080084
SEPHOR              PV-SAVE-DEPT-NBR = '712' OR                         09081086
                    PV-SAVE-SKU-LAST-THREE = '000') OR                  09090081
                    PV-SAVE-ITM-STAT-CDE = '00' )) OR                   09100082
                   (PV-SAVE-SAL-TYP-CDE = 'N' AND                       09110061
                    PV-SAVE-CHARGE-AMT >= PV-SAVE-REG-RTL-AMT) OR       09120061
                   (PV-SAVE-SAL-TYP-CDE = 'S')                          09130061
                   MOVE SPACE TO DTL1-SALE-IND                          09140061
                ELSE                                                    09150061
                    MOVE 'Y' TO DTL1-SALE-IND                           09160055
                END-IF                                                  09170061
             WHEN PV-RETURN-CDE                                         09180064
                  MOVE SPACE  TO DTL1-SALE-IND                          09190073
             WHEN OTHER                                                 09200061
                MOVE SPACE TO DTL1-SALE-IND                             09210061
           END-EVALUATE.                                                09220062
                                                                        09230041
079700     MOVE PV-SAVE-SOLD-QTY         TO DTL1-UNITS.                 09240036
079800     MOVE PV-SAVE-CHARGE-AMT       TO DTL1-CUST-CHARGED.          09250036
079900                                                                  09260036
080500     MOVE PV-DISCOUNT-PCT          TO DTL1-DISCOUNT-PCT.          09270036
080600                                                                  09280036
080700     IF PV-DISCOUNT-AMT  EQUAL  ZERO                              09290036
080800         MOVE ZEROS                TO DTL1-DISCOUNT-AMT           09300036
080900     ELSE                                                         09310036
081000         MOVE PV-DISCOUNT-AMT      TO DTL1-DISCOUNT-AMT           09320036
081100     END-IF.                                                      09330036
081200                                                                  09340036
081300     MOVE PV-LID-COUNT             TO DTL1-LID-COUNT.             09350036
081400     MOVE PV-MARKDOWN-AMT          TO DTL1-MARKDOWN-AMT.          09360036
081500     MOVE PV-NET-CHARGED-AMOUNT    TO DTL1-NET-AMT.               09370036
081600                                                                  09380036
081700     MOVE D1-DETAIL-LINE-1         TO PV-PRINT-RECORD.            09390036
081800                                                                  09400036
081900     MOVE PC-ONE                   TO PV-LINE-SPACING.            09410036
           IF DTL1-RSN-CDE NOT = PV-SAVE-RSN-CDE                        09420036
              DISPLAY DTL1-DATE                                         09430036
              DISPLAY DTL1-STORE                                        09440036
              DISPLAY DTL1-TERM                                         09450036
              DISPLAY DTL1-TRANS                                        09460036
           END-IF.                                                      09470036
082000     PERFORM 9900-WRITE-REPORT-LINE.                              09480036
082100                                                                  09490036
082200******************************************************************09500036
082300* 8000-OPEN-TEPLID-CURSOR.                                        09510036
082400*     OPEN TEPLID CURSOR                                          09520036
082500******************************************************************09530036
082600 8000-OPEN-TEPLID-CURSOR.                                         09540036
082700                                                                  09550036
082800     EXEC SQL                                                     09560036
082900          OPEN TEPLID-CURSOR                                      09570036
083000     END-EXEC.                                                    09580036
083100                                                                  09590036
083200     EVALUATE TRUE                                                09600036
083300         WHEN SQLCODE = ZERO                                      09610036
083400              CONTINUE                                            09620036
083500         WHEN SQLWARN0 NOT EQUAL SPACE                            09630036
083600         WHEN SQLCODE NOT EQUAL ZERO                              09640036
083700             MOVE '8000-OPEN-TEPLID-CURSOR'                       09650036
083800                                            TO PV-PARAGRAPH-NAME  09660036
083900             MOVE 'ERROR ON OPEN OF TEPLID-CURSOR'                09670036
084000                                            TO PV-DB2-OPERATION   09680036
084100             PERFORM 9100-SQL-ABEND                               09690036
084200     END-EVALUATE.                                                09700036
084300                                                                  09710036
084400                                                                  09720036
084500******************************************************************09730036
084600* 8100-FETCH-TEPLID-CURSOR                                        09740036
084700******************************************************************09750036
084800 8100-FETCH-TEPLID-CURSOR.                                        09760036
084900                                                                  09770036
085000     EXEC SQL                                                     09780036
085100          FETCH TEPLID-CURSOR                                     09790036
085200           INTO :EPTRN-STR-NBR                                    09800036
085300               ,:EPTRN-RGST-ID                                    09810036
085400               ,:EPTRN-TRN-NBR                                    09820036
085500               ,:EPTRN-SLS-DTE                                    09830036
085600               ,:EPTRN-STRT-TM                                    09840036
085700               ,:EPTRN-ASSOC-ID                                   09850036
086100               ,:EPTRN-TRN-TYP-CDE                                09860036
                     ,:EPITM-DEPT-NBR                                   09870077
086200               ,:EPITM-SLD-QTY                                    09880036
                     ,:EPITM-SAL-TYP-CDE                                09890055
                     ,:EPITM-SAL-RET-CDE                                09900055
                     ,:EPITM-ITM-STAT-CDE                               09910081
086300               ,:EPITM-CUST-CHRGD-AMT                             09920036
                     ,:EPITM-REG-RTL-AMT                                09930055
                     ,:EPITM-PRIC-SRC-CDE                               09940059
086400               ,:EPITM-NET-CHRGD-AMT                              09950036
086500               ,:EPLID-LID-TYP-CDE                                09960036
086600               ,:EPLID-LID-PCT                                    09970036
086700               ,:EPLID-LID-AMT                                    09980036
086800               ,:EPLID-LID-RSN-CDE                                09990036
086900               ,:EPITM-LNE-ITM-SEQ-NBR                            10000036
                     ,:EPITM-SKU-NBR                                    10010036
087000     END-EXEC.                                                    10020036
087100                                                                  10030036
087200     EVALUATE TRUE                                                10040036
087300         WHEN SQLCODE = ZERO                                      10050036
087400             CONTINUE                                             10060036
087500         WHEN SQLCODE = PC-ROW-NOT-FOUND                          10070036
087600             SET PS-END-OF-TEPLID TO TRUE                         10080036
087700         WHEN SQLWARN0 NOT EQUAL SPACE                            10090036
087800         WHEN SQLCODE NOT EQUAL ZERO                              10100036
087900             MOVE '8100-FETCH-TEPLID-CURSOR'                      10110036
088000                                            TO PV-PARAGRAPH-NAME  10120036
088100             MOVE 'ERROR ON FETCH OF TEPLID-CURSOR'               10130036
088200                                            TO PV-DB2-OPERATION   10140036
088300             PERFORM 9100-SQL-ABEND                               10150036
088400     END-EVALUATE.                                                10160036
088500                                                                  10170036
088600                                                                  10180036
088700******************************************************************10190036
088800* 8200-CLOSE-TEPLID-CURSOR                                        10200036
088900******************************************************************10210036
089000 8200-CLOSE-TEPLID-CURSOR.                                        10220036
089100                                                                  10230036
089200     EXEC SQL                                                     10240036
089300          CLOSE TEPLID-CURSOR                                     10250036
089400     END-EXEC.                                                    10260036
089500                                                                  10270036
089600     EVALUATE TRUE                                                10280036
089700         WHEN SQLCODE = ZERO                                      10290036
089800              CONTINUE                                            10300036
089900         WHEN SQLWARN0 NOT EQUAL SPACE                            10310036
090000         WHEN SQLCODE NOT EQUAL ZERO                              10320036
090100             MOVE '8200-CLOSE-TEPLID-CURSOR'                      10330036
090200                                            TO PV-PARAGRAPH-NAME  10340036
090300             MOVE 'ERROR ON CLOSE OF TEPLID-CURSOR'               10350036
090400                                            TO PV-DB2-OPERATION   10360036
090500             PERFORM 9100-SQL-ABEND                               10370036
090600     END-EVALUATE.                                                10380036
090700                                                                  10390036
090800******************************************************************10400036
090900* 9000-HEADER-ROUTINE                                             10410036
091000*     PRINT THE HEADINGS FOR THE REPORT.                          10420036
091100******************************************************************10430036
091200                                                                  10440036
091300 9000-HEADER-ROUTINE.                                             10450036
091400                                                                  10460036
091500     ADD +1                      TO PV-PAGE-CNT.                  10470036
091600     MOVE PV-PAGE-CNT TO DP150-PAGE-NUMBER.                       10480037
091700     MOVE DP150-STANDRD-HEADER-150-COLS                           10490037
091800                                 TO PV-PRINT-RECORD.              10500036
091900     PERFORM 9800-WRITE-RPT-TOP-OF-PAGE.                          10510036
092000                                                                  10520036
092100     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              10530036
092200     MOVE +2                     TO PV-LINE-SPACING.              10540036
092300     PERFORM 9900-WRITE-REPORT-LINE.                              10550036
092400                                                                  10560036
092500     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              10570036
092600     MOVE +1                     TO PV-LINE-SPACING.              10580036
092700     PERFORM 9900-WRITE-REPORT-LINE.                              10590036
092800                                                                  10600036
092900     MOVE HL4-HEADING-LINE-4     TO PV-PRINT-RECORD.              10610036
093000     MOVE +2                     TO PV-LINE-SPACING.              10620036
093100     PERFORM 9900-WRITE-REPORT-LINE.                              10630036
093200                                                                  10640036
093300     MOVE HL5-HEADING-LINE-5     TO PV-PRINT-RECORD.              10650036
093400     MOVE +1                     TO PV-LINE-SPACING.              10660036
093500     PERFORM 9900-WRITE-REPORT-LINE.                              10670036
093600                                                                  10680036
093700     MOVE SPACES                 TO PV-PRINT-RECORD.              10690036
093800     MOVE +1                     TO PV-LINE-SPACING.              10700036
093900     PERFORM 9900-WRITE-REPORT-LINE.                              10710036
094000                                                                  10720036
094100     MOVE +8                     TO PV-LINE-CNT.                  10730036
094200                                                                  10740036
094300******************************************************************10750036
094400* 9800-WRITE-RPT-TOP-OF-PAGE                                      10760036
094500*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   10770036
094600******************************************************************10780036
094700 9800-WRITE-RPT-TOP-OF-PAGE.                                      10790036
094800                                                                  10800036
094900     WRITE LINE-ITEM-DISC-RECORD                                  10810036
095000       FROM PV-PRINT-RECORD                                       10820036
095100         AFTER ADVANCING PAGE.                                    10830036
095200     MOVE +1 TO PV-LINE-CNT.                                      10840036
095300                                                                  10850036
095400******************************************************************10860036
095500* 9900-WRITE-REPORT-LINE                                          10870036
095600*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             10880036
095700******************************************************************10890036
095800 9900-WRITE-REPORT-LINE.                                          10900036
095900                                                                  10910036
096000     WRITE LINE-ITEM-DISC-RECORD                                  10920036
096100       FROM PV-PRINT-RECORD                                       10930036
096200         AFTER ADVANCING PV-LINE-SPACING.                         10940036
096300                                                                  10950036
096400     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          10960036
096500                                                                  10970036
096600******************************************************************10980036
096700* 9100-SQL-ABEND                                                  10990036
096800*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.11000036
096900******************************************************************11010036
097000 9100-SQL-ABEND.                                                  11020036
097100     DISPLAY '** ABEND     **'.                                   11030036
097200     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11040036
097300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              11050036
097400     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               11060036
097500                                                                  11070036
097600******************************************************************11080036
097700* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     11090036
097800* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      11100036
097900******************************************************************11110036
098000     COPY DPPD004.                                                11120036
098100                                                                  11130036
098200     SET AC-DB2-ERROR TO TRUE.                                    11140036
098300     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         11150036
098400                                                                  11160036
098500******************************************************************11170036
098600* 9999-ABEND                                                      11180036
098700*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  11190036
098800******************************************************************11200036
098900 9999-ABEND.                                                      11210036
099000     DISPLAY '** ABEND           **'.                             11220036
099100     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  11230036
099200     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        11240036
099300     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       11250036
099400     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       11260036
099500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         11270036
