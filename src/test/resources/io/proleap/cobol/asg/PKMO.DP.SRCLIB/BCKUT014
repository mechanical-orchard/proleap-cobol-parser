000100******************************************************************00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300******************************************************************00030003
000400                                                                  00040003
000500 PROGRAM-ID.             BCKUT014.                                00050003
000600 AUTHOR.                 RICK TULLOCH.                            00060003
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070003
000800 DATE-WRITTEN.           05-20-20.                                00080003
000900 DATE-COMPILED.                                                   00090003
001000                                                                  00100003
001100******************************************************************00110003
001200*       THIS PROGRAM DOES A MATCH/MERGE OF EMPLOYEE AND          *00120014
001300*  EMPLOYEE SUPERVISOR CSV FILES TO PREPARE A MERGED EMPLOYEE    *00130012
001310*  FILE WITH ALL CONTENT.  MERGE SUPERVISOR HIERARCHY DETAILS    *00131013
001311*  FOR ALL MATCHING RECORDS.                                     *00131113
001320*                                                                *00132012
001400*       EACH CSV FILE MUST HAVE THE INTENDED HEADER RECORD, AND  *00140003
001500*  BY BE SORTED BY ASCENDING EMPLOYEE'S EMPLOYEE ID.             *00150012
001600******************************************************************00160003
001700                                                                  00170003
001800******************************************************************00180003
001900 ENVIRONMENT DIVISION.                                            00190003
002000******************************************************************00200003
002100                                                                  00210003
002200 CONFIGURATION SECTION.                                           00220003
002300                                                                  00230003
002400 SOURCE-COMPUTER.        IBM-3090.                                00240003
002500 OBJECT-COMPUTER.        IBM-3090.                                00250003
002600                                                                  00260003
002700 INPUT-OUTPUT SECTION.                                            00270003
002800                                                                  00280003
002900 FILE-CONTROL.                                                    00290003
003000                                                                  00300003
003100     SELECT EMPLOYEE-CSV-FILE                                     00310003
003200         ASSIGN TO INP01.                                         00320003
003300                                                                  00330003
003400     SELECT SUPERVISOR-CSV-FILE                                   00340003
003500         ASSIGN TO INP02.                                         00350003
003600                                                                  00360003
003700     SELECT MERGED-EMPLOYEE-CSV-FILE                              00370003
003800         ASSIGN TO OUT01.                                         00380003
003900                                                                  00390003
004000******************************************************************00400003
004100 DATA DIVISION.                                                   00410003
004200******************************************************************00420003
004300                                                                  00430003
004400 FILE SECTION.                                                    00440003
004500                                                                  00450003
004600 FD  EMPLOYEE-CSV-FILE                                            00460003
004700     RECORDING MODE IS F                                          00470003
004800     LABEL RECORDS ARE STANDARD                                   00480003
004900     BLOCK CONTAINS 0 RECORDS                                     00490003
005000     RECORD CONTAINS 600 CHARACTERS                               00500020
005100     DATA RECORDS IS EC-EMPLOYEE-CSV-RECORD.                      00510003
005200                                                                  00520003
005300 01  EC-EMPLOYEE-CSV-RECORD      PIC X(600).                      00530020
005400                                                                  00540003
005500 FD  SUPERVISOR-CSV-FILE                                          00550003
005600     RECORDING MODE IS F                                          00560003
005700     LABEL RECORDS ARE STANDARD                                   00570003
005800     BLOCK CONTAINS 0 RECORDS                                     00580003
005900     RECORD CONTAINS 109 CHARACTERS                               00590003
006000     DATA RECORDS IS SC-SUPERVISOR-CSV-RECORD.                    00600003
006100                                                                  00610003
006200 01  SC-SUPERVISOR-CSV-RECORD    PIC X(109).                      00620003
006300                                                                  00630003
006400 FD  MERGED-EMPLOYEE-CSV-FILE                                     00640003
006500     RECORDING MODE IS F                                          00650003
006600     LABEL RECORDS ARE STANDARD                                   00660003
006700     BLOCK CONTAINS 0 RECORDS                                     00670003
006800     RECORD CONTAINS 680 CHARACTERS                               00680020
006900     DATA RECORDS IS ME-MERGED-EMPLOYEE-CSV-RECORD.               00690003
007000                                                                  00700003
007100 01  ME-MERGED-EMPLOYEE-CSV-RECORD                                00710003
007200                                 PIC X(680).                      00720020
007300                                                                  00730003
007400 WORKING-STORAGE SECTION.                                         00740003
007500                                                                  00750003
007600 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          00760003
007700                                              COMP SYNC.          00770003
007800     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        00780003
007900                                                                  00790003
008000 01  PS-PROGRAM-SWITCHES.                                         00800003
008100     05  PS-END-OF-EMPLOYEE-FILE-SW                               00810003
008200                                 PIC X(1)     VALUE 'N'.          00820003
008300         88  PS-END-OF-EMPLOYEE-FILE          VALUE 'Y'.          00830003
008400     05  PS-END-OF-SUPERVISOR-FILE-SW                             00840003
008500                                 PIC X(1)     VALUE 'N'.          00850003
008600         88  PS-END-OF-SUPERVISOR-FILE        VALUE 'Y'.          00860003
008700                                                                  00870003
008800 01  PV-PROGRAM-VARIABLES.                                        00880003
008900     05  PV-CURR-EF-EMPLOYEE-ID  PIC X(7)     VALUE SPACES.       00890003
009000         88  PV-CURR-EF-EOF-EMPLOYEE-ID       VALUE HIGH-VALUES.  00900003
009100         88  PV-CURR-EF-HEADER-LABEL          VALUE 'EMP NBR'.    00910003
009200     05  PV-CURR-SF-EMPLOYEE-ID  PIC X(7)     VALUE SPACES.       00920003
009300         88  PV-CURR-SF-EOF-EMPLOYEE-ID       VALUE HIGH-VALUES.  00930003
009400         88  PV-CURR-SF-HEADER-LABEL          VALUE 'EMP NBR'.    00940003
011700                                                                  01170003
011800 01  ER-EMPLOYEE-RECORD.                                          01180003
012000     05  ER-EMPLOYEE-ID          PIC X(7)     VALUE SPACES.       01200004
012100     05  FILLER                  PIC X(593)   VALUE SPACES.       01210020
012200                                                                  01220003
012300 01  SR-SUPERVISOR-RECORD.                                        01230004
012400     05  FILLER                  PIC X(1)     VALUE SPACES.       01240003
012500     05  SR-EMPLOYEE-ID          PIC X(7)     VALUE SPACES.       01250003
012600     05  FILLER                  PIC X(3)     VALUE SPACES.       01260005
012710     05  SR-SUPERVISOR-EMPLOYEE-ID-1                              01271005
012720                                 PIC X(7)     VALUE SPACES.       01272005
012730     05  FILLER                  PIC X(3)     VALUE SPACES.       01273005
012740     05  SR-SUPERVISOR-EMPLOYEE-ID-2                              01274005
012750                                 PIC X(7)     VALUE SPACES.       01275005
012760     05  FILLER                  PIC X(3)     VALUE SPACES.       01276005
012770     05  SR-SUPERVISOR-EMPLOYEE-ID-3                              01277005
012780                                 PIC X(7)     VALUE SPACES.       01278005
012790     05  FILLER                  PIC X(3)     VALUE SPACES.       01279005
012800     05  SR-SUPERVISOR-EMPLOYEE-ID-4                              01280005
012810                                 PIC X(7)     VALUE SPACES.       01281005
012811     05  FILLER                  PIC X(3)     VALUE SPACES.       01281105
012812     05  SR-SUPERVISOR-EMPLOYEE-ID-5                              01281205
012813                                 PIC X(7)     VALUE SPACES.       01281305
012814     05  FILLER                  PIC X(3)     VALUE SPACES.       01281405
012815     05  SR-SUPERVISOR-EMPLOYEE-ID-6                              01281505
012816                                 PIC X(7)     VALUE SPACES.       01281605
012817     05  FILLER                  PIC X(3)     VALUE SPACES.       01281705
012818     05  SR-SUPERVISOR-EMPLOYEE-ID-7                              01281805
012819                                 PIC X(7)     VALUE SPACES.       01281905
012820     05  FILLER                  PIC X(3)     VALUE SPACES.       01282005
012821     05  SR-SUPERVISOR-EMPLOYEE-ID-8                              01282105
012822                                 PIC X(7)     VALUE SPACES.       01282205
012823     05  FILLER                  PIC X(3)     VALUE SPACES.       01282305
012824     05  SR-SUPERVISOR-EMPLOYEE-ID-9                              01282405
012825                                 PIC X(7)     VALUE SPACES.       01282505
012826     05  FILLER                  PIC X(3)     VALUE SPACES.       01282605
012827     05  SR-SUPERVISOR-EMPLOYEE-ID-10                             01282705
012828                                 PIC X(7)     VALUE SPACES.       01282805
012829     05  FILLER                  PIC X(1)     VALUE SPACES.       01282905
012840                                                                  01284005
012900 01  MR-MERGED-RECORD.                                            01290003
013000     05  MR-EMPLOYEE-RECORD      PIC X(600)   VALUE SPACES.       01300020
013010     05  MR-SUPERVISOR-DETAILS.                                   01301005
013020         10  FILLER              PIC X(1)     VALUE ','.          01302007
013030         10  MR-SUPERVISOR-EMPLOYEE-ID-1                          01303005
013040                                 PIC X(7)     VALUE SPACES.       01304005
013050         10  FILLER              PIC X(1)     VALUE ','.          01305007
013060         10  MR-SUPERVISOR-EMPLOYEE-ID-2                          01306005
013070                                 PIC X(7)     VALUE SPACES.       01307005
013080         10  FILLER              PIC X(1)     VALUE ','.          01308007
013090         10  MR-SUPERVISOR-EMPLOYEE-ID-3                          01309005
013091                                 PIC X(7)     VALUE SPACES.       01309105
013092         10  FILLER              PIC X(1)     VALUE ','.          01309207
013093         10  MR-SUPERVISOR-EMPLOYEE-ID-4                          01309305
013094                                 PIC X(7)     VALUE SPACES.       01309405
013095         10  FILLER              PIC X(1)     VALUE ','.          01309507
013096         10  MR-SUPERVISOR-EMPLOYEE-ID-5                          01309605
013097                                 PIC X(7)     VALUE SPACES.       01309705
013098         10  FILLER              PIC X(1)     VALUE ','.          01309807
013099         10  MR-SUPERVISOR-EMPLOYEE-ID-6                          01309905
013100                                 PIC X(7)     VALUE SPACES.       01310005
013101         10  FILLER              PIC X(1)     VALUE ','.          01310107
013102         10  MR-SUPERVISOR-EMPLOYEE-ID-7                          01310205
013103                                 PIC X(7)     VALUE SPACES.       01310305
013104         10  FILLER              PIC X(1)     VALUE ','.          01310407
013105         10  MR-SUPERVISOR-EMPLOYEE-ID-8                          01310505
013106                                 PIC X(7)     VALUE SPACES.       01310605
013107         10  FILLER              PIC X(1)     VALUE ','.          01310707
013108         10  MR-SUPERVISOR-EMPLOYEE-ID-9                          01310805
013109                                 PIC X(7)     VALUE SPACES.       01310905
013110         10  FILLER              PIC X(1)     VALUE ','.          01311007
013111         10  MR-SUPERVISOR-EMPLOYEE-ID-10                         01311105
013112                                 PIC X(7)     VALUE SPACES.       01311205
013200                                                                  01320003
013300 01  PC-PROGRAM-CONSTANTS.                                        01330003
013400     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'BCKUT014'.   01340003
013500                                                                  01350003
013600 01  PT-PROGRAM-TOTALS.                                           01360003
013700     05  PT-EMPLOYEE-RCDS-READ   PIC S9(7)    VALUE ZEROS         01370003
013800                                              COMP-3.             01380003
013900     05  PT-SUPERVISOR-RCDS-READ PIC S9(7)    VALUE ZEROS         01390003
014000                                              COMP-3.             01400003
014100     05  PT-EMPLOYEE-WO-SUPERVISOR                                01410003
014200                                 PIC S9(7)    VALUE ZEROS         01420003
014300                                              COMP-3.             01430003
014400     05  PT-SUPERVISOR-RCDS-NOT-FND                               01440004
014500                                 PIC S9(7)    VALUE ZEROS         01450003
014600                                              COMP-3.             01460003
014700     05  PT-MERGED-RCDS-WRITTEN  PIC S9(7)    VALUE ZEROS         01470003
014800                                              COMP-3.             01480003
014900                                                                  01490003
015000 01  TD-TOTAL-DISPLAY-MESSAGE.                                    01500003
015100     05  TD-TOTAL-ID             PIC X(51)    VALUE SPACES.       01510003
015200         88  TD-EMPLOYEE-RCDS-READ-ID         VALUE               01520003
015300             'EMPLOYEE CSV RECORDS READ  . . . . . . . . . . . .'.01530003
015400         88  TD-SUPERVISOR-RCDS-READ-ID       VALUE               01540003
015500             'SUPERVISOR CSV RECORDS READ  . . . . . . . . . . .'.01550003
015600         88  TD-EMPLOYEE-WO-SUPERVISOR-ID     VALUE               01560003
015700             'EMPLOYEE CSV RECORDS W/O SUPERVISOR HIERARCHY  . .'.01570003
015800         88  TD-SUPERVISOR-RCDS-NOT-FND-ID    VALUE               01580004
015900             'SUPERVISOR CSV RECORDS W/O MATCHING EMPLOYEE . . .'.01590003
016000         88  TD-MERGED-RCDS-WRITTEN-ID        VALUE               01600003
016100             'MERGED EMPLOYEE CSV RECORDS WRITTEN  . . . . . . .'.01610003
016200     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    01620003
016300                                              VALUE ZEROS.        01630003
016400                                                                  01640003
016500******************************************************************01650003
016600 PROCEDURE DIVISION.                                              01660003
016700******************************************************************01670003
016800                                                                  01680003
016900 0000-MAINLINE.                                                   01690003
017000                                                                  01700003
017100     PERFORM 1000-INITIALIZE.                                     01710003
017200                                                                  01720003
017300     PERFORM 2000-PROCESS-CSV-FILES                               01730003
017400         UNTIL ((PS-END-OF-EMPLOYEE-FILE)                         01740003
017500                 AND (PS-END-OF-SUPERVISOR-FILE)).                01750003
017600                                                                  01760003
017700     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         01770003
017701                                                                  01770111
017710     PERFORM 9000-EOJ-ROUTINE.                                    01771011
017800                                                                  01780003
017900     GOBACK.                                                      01790003
018000                                                                  01800003
018100******************************************************************01810003
018200*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES,           *01820003
018300*  INITIALIZE BOTH CSV FILE LAYOUTS, PERFORM A PRIMING READ ON   *01830003
018400*  BOTH CSV FILES.  VERIFY BOTH FILES BEGIN WITH THE EXPECTED    *01840003
018500*  HEADER RECORD, AND ABEND IF NOT.  WRITE THE MERGED HEADER     *01850003
018600*  RECORD, AND READ THE FIRST DATA RECORD FROM EACH CSV FILE.    *01860003
018700******************************************************************01870003
018800                                                                  01880003
018900 1000-INITIALIZE.                                                 01890003
019000     OPEN INPUT EMPLOYEE-CSV-FILE                                 01900003
019100                SUPERVISOR-CSV-FILE                               01910003
019200          OUTPUT MERGED-EMPLOYEE-CSV-FILE.                        01920003
019300                                                                  01930003
019400     INITIALIZE ER-EMPLOYEE-RECORD                                01940003
019500                SR-SUPERVISOR-RECORD.                             01950006
019700                                                                  01970003
019800     PERFORM 7000-READ-EMPLOYEE-FILE.                             01980003
019900     PERFORM 7100-READ-SUPERVISOR-FILE.                           01990003
020000                                                                  02000003
020100     IF (NOT PV-CURR-EF-HEADER-LABEL)                             02010003
020200         DISPLAY '** ABEND **'                                    02020003
020300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - HEADER RECORD NOT ' 02030003
020400                       'DETECTED AS THE FIRST RECORD ON THE '     02040003
020500                       'EMPLOYEE CSV FILE'                        02050003
020600         SET AC-FILE-SEQUENCE-ERROR TO TRUE                       02060003
020700         CALL 'ILBOABN0' USING ABEND-CODE                         02070003
020800     END-IF.                                                      02080003
020900                                                                  02090003
021000     IF (NOT PV-CURR-SF-HEADER-LABEL)                             02100003
021100         DISPLAY '** ABEND **'                                    02110003
021200         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - HEADER RECORD NOT ' 02120003
021300                       'DETECTED AS THE FIRST RECORD ON THE '     02130003
021400                       'SUPERVISOR CSV FILE'                      02140003
021500         SET AC-FILE-SEQUENCE-ERROR TO TRUE                       02150003
021600         CALL 'ILBOABN0' USING ABEND-CODE                         02160003
021700     END-IF.                                                      02170003
021800                                                                  02180003
021900     MOVE ER-EMPLOYEE-RECORD TO MR-EMPLOYEE-RECORD.               02190003
022000     MOVE SR-SUPERVISOR-EMPLOYEE-ID-1 TO                          02200006
022010               MR-SUPERVISOR-EMPLOYEE-ID-1.                       02201006
022020     MOVE SR-SUPERVISOR-EMPLOYEE-ID-2 TO                          02202006
022030               MR-SUPERVISOR-EMPLOYEE-ID-2.                       02203006
022040     MOVE SR-SUPERVISOR-EMPLOYEE-ID-3 TO                          02204006
022050               MR-SUPERVISOR-EMPLOYEE-ID-3.                       02205006
022060     MOVE SR-SUPERVISOR-EMPLOYEE-ID-4 TO                          02206006
022070               MR-SUPERVISOR-EMPLOYEE-ID-4.                       02207006
022080     MOVE SR-SUPERVISOR-EMPLOYEE-ID-5 TO                          02208006
022090               MR-SUPERVISOR-EMPLOYEE-ID-5.                       02209006
022091     MOVE SR-SUPERVISOR-EMPLOYEE-ID-6 TO                          02209106
022092               MR-SUPERVISOR-EMPLOYEE-ID-6.                       02209206
022093     MOVE SR-SUPERVISOR-EMPLOYEE-ID-7 TO                          02209306
022094               MR-SUPERVISOR-EMPLOYEE-ID-7.                       02209406
022095     MOVE SR-SUPERVISOR-EMPLOYEE-ID-8 TO                          02209506
022096               MR-SUPERVISOR-EMPLOYEE-ID-8.                       02209606
022097     MOVE SR-SUPERVISOR-EMPLOYEE-ID-9 TO                          02209706
022098               MR-SUPERVISOR-EMPLOYEE-ID-9.                       02209806
022099     MOVE SR-SUPERVISOR-EMPLOYEE-ID-10 TO                         02209906
022100               MR-SUPERVISOR-EMPLOYEE-ID-10.                      02210006
022110     PERFORM 8000-WRITE-MERGED-RECORD.                            02211006
022200     PERFORM 7000-READ-EMPLOYEE-FILE.                             02220003
022300     PERFORM 7100-READ-SUPERVISOR-FILE.                           02230003
022400*1000-EXIT.                                                       02240003
022500                                                                  02250003
022600******************************************************************02260003
022700*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *02270003
022800******************************************************************02280003
022900                                                                  02290003
023000 1500-DISPLAY-PROGRAM-TOTALS.                                     02300003
023100     SET TD-EMPLOYEE-RCDS-READ-ID TO TRUE.                        02310003
023200     MOVE PT-EMPLOYEE-RCDS-READ TO TD-TOTAL-AMOUNT.               02320003
023300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       02330003
023400               TD-TOTAL-DISPLAY-MESSAGE.                          02340003
023500                                                                  02350003
023600     SET TD-SUPERVISOR-RCDS-READ-ID TO TRUE.                      02360003
023700     MOVE PT-SUPERVISOR-RCDS-READ TO TD-TOTAL-AMOUNT.             02370003
023800     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       02380003
023900               TD-TOTAL-DISPLAY-MESSAGE.                          02390003
024000                                                                  02400003
024100     SET TD-EMPLOYEE-WO-SUPERVISOR-ID TO TRUE.                    02410003
024200     MOVE PT-EMPLOYEE-WO-SUPERVISOR TO TD-TOTAL-AMOUNT.           02420003
024300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       02430003
024310               TD-TOTAL-DISPLAY-MESSAGE.                          02431008
024400                                                                  02440003
024500     SET TD-SUPERVISOR-RCDS-NOT-FND-ID TO TRUE.                   02450004
024600     MOVE PT-SUPERVISOR-RCDS-NOT-FND TO TD-TOTAL-AMOUNT.          02460004
024700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       02470003
024710               TD-TOTAL-DISPLAY-MESSAGE.                          02471008
024800                                                                  02480003
024900     SET TD-MERGED-RCDS-WRITTEN-ID TO TRUE.                       02490003
025000     MOVE PT-MERGED-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.              02500003
025100     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       02510003
025200               TD-TOTAL-DISPLAY-MESSAGE.                          02520003
025300*1500-EXIT.                                                       02530003
025400                                                                  02540003
025500******************************************************************02550003
025600*  PROCESS A COMPARISON BETWEEN THE EMPLOYEE AND EMPLOYEE        *02560013
025610*  SUPERVISOR CSV FILES.  MERGE SUPERVISOR HIERARCHY DETAILS     *02561013
025620*  ON MATCHING RECORDS TO WRITE OUT A COMBINED EMPLOYEE DETAIL   *02562013
025630*  RECORD.  WHEN AN EMPLOYEE WAS FOUND WITHOUT MATCHING EMPLOYEE *02563013
025640*  SUPERVISOR DETAIL, DISPLAY A MESSAGE, AND WRITE OUT A         *02564013
025650*  COMBINED EMPLOYEE DETAIL RECORD WITH NULL SUPERVISOR          *02565013
025660*  HIERARCHY DETAILS.  IF SUPERVISOR HIERARCHY DETAIL IS FOUND   *02566013
025670*  WITHOUT A MATCHING EMPLOYEE, JUST READ THE NEXT EMPLOYEE      *02567013
025680*  SUPERVISOR CSV RECORD TO SKIP OVER IT.                        *02568013
025700******************************************************************02570003
025800                                                                  02580003
025900 2000-PROCESS-CSV-FILES.                                          02590003
026000     EVALUATE TRUE                                                02600003
026100         WHEN (PV-CURR-EF-EMPLOYEE-ID = PV-CURR-SF-EMPLOYEE-ID)   02610003
026200             MOVE ER-EMPLOYEE-RECORD TO MR-EMPLOYEE-RECORD        02620003
026210             MOVE SR-SUPERVISOR-EMPLOYEE-ID-1 TO                  02621006
026220                       MR-SUPERVISOR-EMPLOYEE-ID-1                02622006
026230             MOVE SR-SUPERVISOR-EMPLOYEE-ID-2 TO                  02623006
026240                       MR-SUPERVISOR-EMPLOYEE-ID-2                02624006
026250             MOVE SR-SUPERVISOR-EMPLOYEE-ID-3 TO                  02625006
026260                       MR-SUPERVISOR-EMPLOYEE-ID-3                02626006
026270             MOVE SR-SUPERVISOR-EMPLOYEE-ID-4 TO                  02627006
026280                       MR-SUPERVISOR-EMPLOYEE-ID-4                02628006
026290             MOVE SR-SUPERVISOR-EMPLOYEE-ID-5 TO                  02629006
026291                       MR-SUPERVISOR-EMPLOYEE-ID-5                02629106
026292             MOVE SR-SUPERVISOR-EMPLOYEE-ID-6 TO                  02629206
026293                       MR-SUPERVISOR-EMPLOYEE-ID-6                02629306
026294             MOVE SR-SUPERVISOR-EMPLOYEE-ID-7 TO                  02629406
026295                       MR-SUPERVISOR-EMPLOYEE-ID-7                02629506
026296             MOVE SR-SUPERVISOR-EMPLOYEE-ID-8 TO                  02629606
026297                       MR-SUPERVISOR-EMPLOYEE-ID-8                02629706
026298             MOVE SR-SUPERVISOR-EMPLOYEE-ID-9 TO                  02629806
026299                       MR-SUPERVISOR-EMPLOYEE-ID-9                02629906
026300             MOVE SR-SUPERVISOR-EMPLOYEE-ID-10 TO                 02630006
026301                       MR-SUPERVISOR-EMPLOYEE-ID-10               02630106
026400             PERFORM 8000-WRITE-MERGED-RECORD                     02640003
026500             PERFORM 7000-READ-EMPLOYEE-FILE                      02650003
026600             PERFORM 7100-READ-SUPERVISOR-FILE                    02660003
026700         WHEN (PV-CURR-EF-EMPLOYEE-ID < PV-CURR-SF-EMPLOYEE-ID)   02670003
026800*                                                                 02680003
026900* AN EMPLOYEE WAS FOUND WITHOUT MATCHING SUPERVISOR DETAIL        02690003
027000*                                                                 02700003
027010             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - NO SUPERVISOR ' 02701009
027020                       'DETAIL FOUND FOR EMPLOYEE '               02702009
027030                       PV-CURR-EF-EMPLOYEE-ID                     02703010
027100             ADD +1 TO PT-EMPLOYEE-WO-SUPERVISOR                  02710003
027200             MOVE ER-EMPLOYEE-RECORD TO MR-EMPLOYEE-RECORD        02720003
027210             INITIALIZE MR-SUPERVISOR-EMPLOYEE-ID-1               02721006
027220                        MR-SUPERVISOR-EMPLOYEE-ID-2               02722006
027230                        MR-SUPERVISOR-EMPLOYEE-ID-3               02723006
027240                        MR-SUPERVISOR-EMPLOYEE-ID-4               02724006
027250                        MR-SUPERVISOR-EMPLOYEE-ID-5               02725006
027260                        MR-SUPERVISOR-EMPLOYEE-ID-6               02726006
027270                        MR-SUPERVISOR-EMPLOYEE-ID-7               02727006
027280                        MR-SUPERVISOR-EMPLOYEE-ID-8               02728006
027290                        MR-SUPERVISOR-EMPLOYEE-ID-9               02729006
027300                        MR-SUPERVISOR-EMPLOYEE-ID-10              02730006
027400             PERFORM 8000-WRITE-MERGED-RECORD                     02740003
027500             PERFORM 7000-READ-EMPLOYEE-FILE                      02750003
027600         WHEN OTHER                                               02760003
027700*                                                                 02770003
027800* SUPERVISOR HIERARCHY DETAIL FOUND WITHOUT A MATCHING EMPLOYEE   02780003
027900*                                                                 02790003
028000             ADD +1 TO PT-SUPERVISOR-RCDS-NOT-FND                 02800004
028100             PERFORM 7100-READ-SUPERVISOR-FILE                    02810003
028200     END-EVALUATE.                                                02820003
028300*2000-EXIT.                                                       02830003
028400                                                                  02840003
028500******************************************************************02850003
028600*  READ AN EMPLOYEE CSV RECORD, AND ACCUMULATE I/O TOTALS.       *02860003
028700******************************************************************02870003
028800                                                                  02880003
028900 7000-READ-EMPLOYEE-FILE.                                         02890003
029000     READ EMPLOYEE-CSV-FILE                                       02900003
029100         INTO ER-EMPLOYEE-RECORD                                  02910003
029200         AT END                                                   02920003
029300             SET PS-END-OF-EMPLOYEE-FILE TO TRUE                  02930003
029400             SET PV-CURR-EF-EOF-EMPLOYEE-ID TO TRUE               02940003
029500     END-READ.                                                    02950003
029600                                                                  02960003
029700     IF (NOT PS-END-OF-EMPLOYEE-FILE)                             02970003
029800         ADD +1 TO PT-EMPLOYEE-RCDS-READ                          02980004
029900         MOVE ER-EMPLOYEE-ID TO PV-CURR-EF-EMPLOYEE-ID            02990003
030000     END-IF.                                                      03000003
030100*7000-EXIT.                                                       03010003
030200                                                                  03020003
030300******************************************************************03030003
030400*  READ A SUVERVISOR CSV RECORD, AND ACCUMULATE I/O TOTALS.      *03040003
030500******************************************************************03050003
030600                                                                  03060003
030700 7100-READ-SUPERVISOR-FILE.                                       03070003
030800     READ SUPERVISOR-CSV-FILE                                     03080003
030900         INTO SR-SUPERVISOR-RECORD                                03090003
031000         AT END                                                   03100003
031100             SET PS-END-OF-SUPERVISOR-FILE TO TRUE                03110003
031200             SET PV-CURR-SF-EOF-EMPLOYEE-ID TO TRUE               03120003
031300     END-READ.                                                    03130003
031400                                                                  03140003
031500     IF (NOT PS-END-OF-SUPERVISOR-FILE)                           03150003
031600         ADD +1 TO PT-SUPERVISOR-RCDS-READ                        03160003
031700         MOVE SR-EMPLOYEE-ID TO PV-CURR-SF-EMPLOYEE-ID            03170003
031800     END-IF.                                                      03180003
031900*7100-EXIT.                                                       03190003
032000                                                                  03200003
032100******************************************************************03210003
032200*  WRITE A MERGED EMPLOYEE CSV RECORD, AND ACCUMULATE I/O TOTALS.*03220003
032300******************************************************************03230003
032400                                                                  03240003
032500 8000-WRITE-MERGED-RECORD.                                        03250003
032600     WRITE ME-MERGED-EMPLOYEE-CSV-RECORD                          03260003
032700         FROM MR-MERGED-RECORD                                    03270003
032800                                                                  03280003
032900     ADD +1 TO PT-MERGED-RCDS-WRITTEN.                            03290003
033000*8000-EXIT.                                                       03300003
033100                                                                  03310003
033200******************************************************************03320003
033300*  CLOSE ALL FILES.                                              *03330003
033400******************************************************************03340003
033500                                                                  03350003
033600 9000-EOJ-ROUTINE.                                                03360003
033700     CLOSE EMPLOYEE-CSV-FILE                                      03370003
033800           SUPERVISOR-CSV-FILE                                    03380003
033900           MERGED-EMPLOYEE-CSV-FILE.                              03390003
034000*9000-EXIT.                                                       03400003
