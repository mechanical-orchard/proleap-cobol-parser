000100***************************************************************** 00010028
000200 IDENTIFICATION DIVISION.                                         00020028
000300***************************************************************** 00030028
000400                                                                  00040028
000500 TITLE 'RFID ELIGIBILITY DETERMINATION MODULE'.                   00050028
000600 PROGRAM-ID.    SUKUT149.                                         00060028
000700 AUTHOR.        BRENDA ROCKWELL.                                  00070028
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080028
000900 DATE-WRITTEN.  AUGUST 2012.                                      00090028
001000******************************************************************00100028
001100******************************************************************00110028
001200*4/12/2013 ALICE EBERT,TKMA283                                   *00120028
001300*PROJECT RFID 3.0-LOGISTICS     WR5148B                          *00130028
001400*CHANGE ROUTINE FROM CHECK FOR RFID DEPT/SUBCLASS AND POSSIBLY   *00140028
001500*STYLE TO 1)CALLING PROGRAM IDENTIFIES IF CARTON IS PACK-TO-LIGHT*00150028
001600*ALONG WITH ALL OTHER INFORMATION NEEDED FOR THE ACCESS METHOD.  *00160028
001700*2)IF NOT P2L, CHECK FOR DEPT W/IN STORE. 3) WHETHER #2 FALSE OR *00170028
001800*CARTON IS P2L, CHECK BY DEPARTMENT WITH POSSIBLE INCLUSIONS/    *00180028
001900*EXCLUSIONS BY SUBCLASS. 4)IF #3 TRUE CHECK #6. 5) IF #3 FALSE,  *00190028
002000*CARTON ISN'T RFID. PASS INFO BACK TO CALLING PROGRAM. 6) CHECK  *00200028
002100*IF DC HAS AUTO CONVONVEYOR EQUIPMENT. IF TRUE CHECK FOR STORES  *00210028
002200*WITHIN DEPT FOR DIVERT. IF FOUND DIVERT CARTON TO P2L FIRST. IF *00220028
002300*NOT FOUND LET CARTON GO IT'S REULAR ROUTE TO FLAT 1ST BEFORE P2L.00230028
002400*7)ADD NEW CDE TO LOOK UP VENDOR AND DEPT TO CHECK IF THE VENDOR* 00240028
002500*IS COMPLIANT TO RFID TAG THE MERCHANDISE IN THIS DEPT. COMPLIANT*00250028
002600*MEANS THE VENDOR HAS BEEN TAGGING LONG ENOUGH FOR KOHL'S TO NO  *00260028
002700*LONGER HAVE TO CHECK THE RFID CARTONS FROM THAT VENDOR FOR THAT *00270028
002800*DEPT. 8)IF VENDOR/DEPT IS NOT COMPLIANT CHECK TO SEE IF VENDOR/ *00280028
002900*DEPT CHECK TO SEE IF VENDOR HAS AN AGREEMENT W/KOHL'S TO TAG    *00290028
003000*MERCHANDISE IN THEIR FACILITIES BEFORE SENDING TO DC'S. IT MEANS*00300028
003100*THEY HAVEN'T BEEN TAGING LONG ENOUGH TO BE COMPLIANT.            00310028
003200*9)IF VENDOR IS NOT COMPLIANT THERE WILL BE A CHECK THAT WILL    *00320028
003300*ALLOW KOHL'S TO TURN THE VNDR OR VNDR/DPT OFF FOR TAGGING IN DC.*00330028
003400*10)IF THE VENDOR/DEPARTMENT IS TURNED OFF FOR TAGGING IN THE DCS*00340028
003500*PASS INFO BACK TO CALLING PROGRAM. 11) IF THE VENDOR/DEPARTMENT *00350028
003600*IS NOT TURNED OFF FROM TAGGING IN THE DC PASS INFO BACK TO CALL-*00360028
003700*ING PGM.THEN CARTON WILL BE DIRECTED TO FLAT OR WHEREEVER THE DC*00370028
003800*DOES IT'S TAGGING AND CHECKING VENDOR'S WORK.                   *00380028
003900*             CHANGES TAGGED AS *AME-5148B-RFID                  *00390028
004000*                                                                 00400028
004100*----------------------------------------------------------------*00410028
004200*--LAST VALUE --- MOVE 62 TO SU093-ERROR-NBR                     *00420028
004300*--THIS VALUE SHOULD BE UPDATED FOR EACH NEW SQL ERROR SO THERE  *00430028
004400*--ARE NO DUPLICATES FOR DEBUGGING.                              *00440028
004500*----------------------------------------------------------------*00450028
004600*7/9/2013  CHERI PARMLEY, TKMAF76                                *00460028
004700*PROJECT RFID 3.0-LOGISTICS     WR5148B                          *00470028
004800*INCLUDED THE DC NUMBER IN THE P2LDVT CHECKS SO THAT EACH DC CAN *00480028
004900*BE CHECKED SEPARATELY FOR P2L.                                  *00490028
005000*----------------------------------------------------------------*00500028
005100* 08/09/13 RLK BEG                                                00510028
005200*----------------------------------------------------------------*00520028
005300*8/9/2013  RICH KELLEN, TKMAA71                                  *00530028
005400*PROJECT RFID 3.0-LOGISTICS     WR5148B                          *00540028
005500*CHANGED LOGIC TO CALL PARA 2550-CK-NO-XCPTN-DPT-WTHIN-STR FOR   *00550028
005600*NON-P2L REQUESTS. THIS LOGIC WAS COMMENTED OUT BUT RESULTED     *00560028
005700*IN SU093-RFID-KOHL-DPT-IN-STR-SW NOT GETTING SET CORRECTLY      *00570028
005800*FOR NON-P2L CARTONS AS THE PROGRAM DID NOT CHECK THE DEPT FOR A *00580028
005900*STORE, JUST THE DEPT.                                           *00590028
006000*----------------------------------------------------------------*00600028
006100* 08/09/13 RLK END                                                00610028
006200*----------------------------------------------------------------*00620028
006300*9/12/2013 CHERI PARMLEY, TKMAF76                                *00630028
006400*PROJECT RFID 3.0-LOGISTICS     WR5148B                          *00640028
006500*ADDED SU093-PO-LEVEL-CHECK FOR THE RECEIVERS BY TRAILER ONLINE  *00650028
006600*FUNCTION TO DETERMINE IF THE PO IS RFID. NEW CURSOR ADDED.      *00660028
006700*----------------------------------------------------------------*00670028
006800*12/18/2013 CHERI PARMLEY, TKMAF76                               *00680028
006900*PROJECT RFID 3.0-LOGISTICS     WR5148D                          *00690028
007000*ADDED PARA 8010- TO CHECK IF AN IR FACILITY IS TAGGING OR NOT   *00700028
007100*----------------------------------------------------------------*00710028
007200*04/09/2014 CHERI PARMLEY, TKMAF76                               *00720028
007300*PROJECT RFID 3.0-LOGISTICS     WR5148D                          *00730028
007400*SET THE IR NEEDS TAGGING SW IN 8300-CHECK-IR-TAGGING            *00740028
007500*SWITCHES WERE NOT BEING SET CORRECTLY FOR PROCESSING IR         *00750028
007600*CARTONS. TAGGED 'CLP 04/09/14'                                  *00760028
007700*----------------------------------------------------------------*00770028
007800*04/08/2015 CHERI PARMLEY, TKMAF76                               *00780028
007900*FOR NON-AUTO CONVEYOR DC'S, DO NOT PRINT MESSAGE LABEL IF THE   *00790028
008000*CARTON IS RFID AND THE FINAL DESTINATION IS PACK-TO-LIGHT. IF   *00800028
008100*THE PARAMETER IS SET TO 'Y', PRINT THE P2L LABEL. 'CLP O4/08/15'*00810028
008200*NEW PARM IS ADDED TO EXECUTE THIS CODE 'P2LFST' IF ITS NOT      *00820028
008300*SET TO 'Y' OR DOES NOT EXIST CODE WILL NOT TRIGGER CARTON LABEL *00830028
008400*TO BE TURNED OFF. PARA 6150- START CHANGES                      *00840028
008500*----------------------------------------------------------------*00850028
008600*FOR AUTO CONVEYOR DC'S, ADDED LOGIC TO INCLUDE DC AND DEPENDING *00860028
008700*IF IT WAS COMING FROM RECEIVING 502/771 DONT INCLUDE STORE IN   *00870028
008800*SELECT, IF P2L INCLUDE STORE IN SELECT PARA'S 8870-8881.        *00880028
008900*----------------------------------------------------------------*00890028
009000*07/12/2017 JIM ARENDT   CHG0176459                              *00900060
009100*ADDED CODE TO PROGRAM FOR THE 'RFID TAG YOUR STORE/ SHORT-TERM  *00910061
009200*SOLUTION' PROJECT.                                              *00920061
009300*----------------------------------------------------------------*00930061
009400 DATE-COMPILED.                                                   00940028
009500 ENVIRONMENT DIVISION.                                            00950028
009600 CONFIGURATION SECTION.                                           00960028
009700 SOURCE-COMPUTER. IBM-3090.                                       00970028
009800 OBJECT-COMPUTER. IBM-3090.                                       00980028
009900                                                                  00990028
010000 DATA DIVISION.                                                   01000028
010100 WORKING-STORAGE SECTION.                                         01010028
010200 01  PV-PROGRAM-VARIABLES.                                        01020028
010300     05  PV-DC-IND                    PIC X     VALUE SPACES.     01030028
010400     05  PV-STORE-IND                 PIC X     VALUE SPACES.     01040028
010500     05  PV-DEPT-SUBCL-IND            PIC X     VALUE SPACES.     01050028
010600     05  PV-EXCEPTIONS-IND            PIC X     VALUE SPACES.     01060028
010700     05  PV-SKIP-STYLE-IND            PIC X     VALUE SPACES.     01070028
010800     05  PV-DEPT-WITHIN-STORE-IND     PIC X     VALUE SPACES.     01080028
010900     05  PV-P2L-DIVERT-DEPT-IND       PIC X     VALUE SPACES.     01090028
011000     05  PV-P2L-DIVERT-DEPT-STR-IND   PIC X     VALUE SPACES.     01100028
011100*CLP 09/12/13 BEGIN                                               01110028
011200     05  PV-DEPT-NO                   PIC X(03).                  01120028
011300     05  PV-DEPT-NO-R REDEFINES PV-DEPT-NO PIC 9(03).             01130028
011400*CLP 09/12/13 END                                                 01140028
011500     05  PV-COUNT-STORES              PIC S9(4) COMP.             01150028
011600     05  PV-LINE-NUMBER               PIC S9(9) COMP.             01160028
011700                                                                  01170028
011800     05  PV-DISPLAY-NUMBER-10         PIC 9(10).                  01180028
011900     05  PV-DISPLAY-NUMBER-5          PIC 9(05).                  01190028
012000     05  PV-DISPLAY-NUMBER-18         PIC 9(18).                  01200028
012100     05  PV-DISPLAY-SQLCODE           PIC 9999999999-.            01210028
012110                                                                  01211070
012120     05  PV-NUMERIC-PO-NBR            PIC 9999999999.             01212070
012200                                                                  01220028
012300     05  PV-DEPT-NBR-N                PIC 9(04).                  01230028
012400     05  PV-DEPT-NBR-A REDEFINES PV-DEPT-NBR-N.                   01240028
012500         10  FILLER                   PIC X.                      01250028
012600         10  PV-DEPT-NBR-3CH          PIC X(03).                  01260028
012700     05  PV-SUB-CL-NBR-N              PIC 9(04).                  01270028
012800     05  PV-SUB-CL-NBR-A REDEFINES PV-SUB-CL-NBR-N.               01280028
012900         10  FILLER                   PIC X(01).                  01290028
013000         10  PV-SUB-CL-NBR-3CH.                                   01300028
013100             15  FILLER               PIC X(01).                  01310028
013200             15  PV-SUB-CL-NBR-2CH    PIC X(02).                  01320028
013300                                                                  01330028
013400 01  DK-KEYS.                                                     01340028
013500     05  DK-DEPT-NBR                  PIC S9(4)V COMP-3.          01350028
013600     05  DK-SUBCLASS-NBR              PIC S9(4)V COMP-3.          01360028
013700     05  DK-LOC-NBR                   PIC S9(4) COMP.             01370028
013800     05  DK-DC-NBR                    PIC S9(4) COMP.             01380028
013900     05  DK-STYLE                     PIC X(20).                  01390028
014000     05  DK-IR-FACILITY-NBR           PIC S9(4) COMP.             01400028
014010     05  DK-PO-NBR                    PIC S9(9) COMP.             01401063
014100                                                                  01410028
014200 01  PS-SWITCHES.                                                 01420028
014300     05  PS-ITEM-UPC-CSR-SW              PIC  X(01)  VALUE 'N'.   01430028
014400         88  PS-EO-ITEM-UPC-CSR                      VALUE 'Y'.   01440028
014500         88  PS-NOT-EO-ITEM-UPC-CSR                  VALUE 'N'.   01450028
014600     05  PS-OTBND-UPC-CSR-SW             PIC  X(01)  VALUE 'N'.   01460028
014700         88  PS-EO-OTBND-UPC-CSR                     VALUE 'Y'.   01470028
014800         88  PS-NOT-EO-OTBND-UPC-CSR                 VALUE 'N'.   01480028
014900     05  PS-PREPK-UPC-CSR-SW             PIC  X(01)  VALUE 'N'.   01490028
015000         88  PS-EO-PREPK-UPC-CSR                     VALUE 'Y'.   01500028
015100         88  PS-NOT-EO-PREPK-UPC-CSR                 VALUE 'N'.   01510028
015200     05  PS-STORE-UPC-CSR-SW             PIC  X(01)  VALUE 'N'.   01520028
015300         88  PS-EO-STORE-UPC-CSR                     VALUE 'Y'.   01530028
015400         88  PS-NOT-EO-STORE-UPC-CSR                 VALUE 'N'.   01540028
015500     05  PS-P2L-STORE-CSR-SW             PIC  X(01)  VALUE 'N'.   01550028
015600         88  PS-EO-P2L-STORE-CSR                     VALUE 'Y'.   01560028
015700         88  PS-NOT-EO-P2L-STORE-CSR                 VALUE 'N'.   01570028
015800*CLP 09/12/13 BEGIN                                               01580028
015900     05  PS-PO-STORE-CSR-SW              PIC  X(01)  VALUE 'N'.   01590028
016000         88  PS-PO-LEVEL-CSR                         VALUE 'Y'.   01600028
016100         88  PS-NOT-PO-LEVEL-CSR                     VALUE 'N'.   01610028
016200*CLP 09/12/13 END                                                 01620028
016300     05  PS-DC-RFID-SW                   PIC  X(01)  VALUE 'N'.   01630028
016400         88  PS-DC-RFID-YES                          VALUE 'Y'.   01640028
016500         88  PS-DC-RFID-NO                           VALUE 'N'.   01650028
016600     05  PS-STORE-RFID-SW                PIC  X(01)  VALUE 'N'.   01660028
016700         88  PS-STORE-RFID-YES                       VALUE 'Y'.   01670028
016800         88  PS-STORE-RFID-NO                        VALUE 'N'.   01680028
016900     05  PS-DEPT-SUBCL-RFID-SW           PIC  X(01)  VALUE 'N'.   01690028
017000         88  PS-DEPT-SUBCL-RFID-YES                  VALUE 'Y'.   01700028
017100         88  PS-DEPT-SUBCL-RFID-NO                   VALUE 'N'.   01710028
017200     05  PS-PREPACK-FIRST-FETCH-SW       PIC  X(01)  VALUE 'N'.   01720028
017300         88  PS-PREPACK-FIRST-FETCH-YES              VALUE 'Y'.   01730028
017400         88  PS-PREPACK-FIRST-FETCH-NO               VALUE 'N'.   01740028
017500     05  PS-DEPT-WITHIN-STORE-RFID-SW    PIC  X(01)  VALUE 'N'.   01750028
017600         88  PS-DEPT-WITHIN-STORE-RFID-YES           VALUE 'Y'.   01760028
017700         88  PS-DEPT-WITHIN-STORE-RFID-NO            VALUE 'N'.   01770028
017800     05  PS-CHECK-FOR-RFID-DONE-SW       PIC  X(01)  VALUE 'N'.   01780028
017900         88  PS-CHECK-FOR-RFID-DONE-YES              VALUE 'Y'.   01790028
018000         88  PS-CHECK-FOR-RFID-DONE-NO               VALUE 'N'.   01800028
018100*CLP 11/15/13                                                     01810028
018200     05  PS-IR-TAGGING-FOR-DEPT-SW       PIC  X(01)  VALUE 'N'.   01820028
018300         88  PS-IR-TAGGING-FOR-DEPT-YES              VALUE 'Y'.   01830028
018400         88  PS-IR-TAGGING-FOR-DEPT-NO               VALUE 'N'.   01840028
018500*CLP 04/08/15                                                     01850028
018600     05  PS-CREATE-CART-LBL-FOR-P2L-SW   PIC  X(01)  VALUE 'N'.   01860028
018700         88  PS-CREATE-CART-LBL-FOR-P2L-YES          VALUE 'Y'.   01870028
018800         88  PS-CREATE-CART-LBL-FOR-P2L-NO           VALUE 'N'.   01880028
018900** GB 10/1 EAS TAG BEGIN                                          01890028
019000     05  PS-EAS-DC-TAGGING-SW            PIC  X(01)  VALUE 'N'.   01900028
019100         88  PS-EAS-DC-TAGGING-YES                   VALUE 'Y'.   01910028
019200         88  PS-EAS-DC-TAGGING-NO                    VALUE 'N'.   01920028
019300     05  PS-EAS-TAGGING-FOR-DEPT-SW      PIC  X(01)  VALUE 'N'.   01930028
019400         88  PS-EAS-TAGGING-FOR-DEPT-YES             VALUE 'Y'.   01940028
019500         88  PS-EAS-TAGGING-FOR-DEPT-NO              VALUE 'N'.   01950028
019501     05  PS-EAS-EXECUTE-BYPASS-SW        PIC  X(01)  VALUE 'N'.   01950173
019502         88  PS-EAS-EXECUTE-BYPASS-YES               VALUE 'Y'.   01950273
019503         88  PS-EAS-EXECUTE-BYPASS-NO                VALUE 'N'.   01950373
019504     05  PS-EAS-SEASET-BYPASS-SW         PIC  X(01)  VALUE 'N'.   01950473
019505         88  PS-EAS-SEASET-BYPASS-YES                VALUE 'Y'.   01950573
019506         88  PS-EAS-SEASET-BYPASS-NO                 VALUE 'N'.   01950673
019507     05  PS-EAS-PO-BYPASS-SW             PIC  X(01)  VALUE 'N'.   01950773
019508         88  PS-EAS-PO-BYPASS-YES                    VALUE 'Y'.   01950873
019509         88  PS-EAS-PO-BYPASS-NO                     VALUE 'N'.   01950973
019510     05  PS-RFID-DC-DEPT-TAGGING-SW      PIC  X(01)  VALUE 'N'.   01951053
019520         88  PS-RFID-DC-DEPT-TAGGING-YES             VALUE 'Y'.   01952053
019530         88  PS-RFID-DC-DEPT-TAGGING-NO              VALUE 'N'.   01953053
019600     05  PS-DEPT-ENT-ID-FOUND-SW         PIC  X(01)  VALUE 'Y'.   01960028
019700         88  PS-DEPT-ENT-ID-FOUND-YES                VALUE 'Y'.   01970028
019800         88  PS-DEPT-ENT-ID-FOUND-NO                 VALUE 'N'.   01980028
019900     05  PS-EFC-STORE-LOCATION-SW        PIC  X(01)  VALUE 'N'.   01990028
020000         88  PS-EFC-STORE-LOCATION-YES               VALUE 'Y'.   02000028
020100         88  PS-EFC-STORE-LOCATION-NO                VALUE 'N'.   02010028
020200     05  PS-RF-EAS-CONTINUE-CHK-SW       PIC  X(01)  VALUE 'N'.   02020030
020300         88  PS-RF-EAS-CONTINUE-CHK-YES              VALUE 'Y'.   02030028
020400         88  PS-RF-EAS-CONTINUE-CHK-NO               VALUE 'N'.   02040028
020500** GB 10/1 EAS TAG END                                            02050028
020600                                                                  02060028
020700*----------------------------------------------------------------*02070028
020800*  COPYBOOK USED TO FOR ITEM ACCESS MODULE                        02080028
020900*  (XLKUT001)                                                     02090028
021000*----------------------------------------------------------------*02100028
021100     COPY XLWS001.                                                02110028
021200*----------------------------------------------------------------*02120028
021300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  02130028
021400*  TABLE                                                          02140028
021500*----------------------------------------------------------------*02150028
021600     EXEC SQL                                                     02160028
021700         INCLUDE TSHUUPC                                          02170028
021800     END-EXEC.                                                    02180028
021900*----------------------------------------------------------------*02190028
022000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR RECITM TABLE           02200028
022100*----------------------------------------------------------------*02210028
022200     EXEC SQL                                                     02220028
022300         INCLUDE TRECITM                                          02230028
022400     END-EXEC.                                                    02240028
022500*----------------------------------------------------------------*02250028
022600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR RECDIS TABLE           02260028
022700*----------------------------------------------------------------*02270028
022800     EXEC SQL                                                     02280028
022900         INCLUDE TRECDIS                                          02290028
023000     END-EXEC.                                                    02300028
023100*----------------------------------------------------------------*02310028
023200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PARAMETER TABLE        02320028
023300*----------------------------------------------------------------*02330028
023400     EXEC SQL                                                     02340028
023500         INCLUDE TKRPRPM                                          02350028
023600     END-EXEC.                                                    02360028
023700*----------------------------------------------------------------*02370028
023800*  DCLGEN FOR INTEGRATION TABLE WST_ATTR_ELEM                     02380028
023900*----------------------------------------------------------------*02390028
024000     EXEC SQL                                                     02400028
024100         INCLUDE WST00010                                         02410028
024200     END-EXEC.                                                    02420028
024300*----------------------------------------------------------------*02430028
024400*----------------------------------------------------------------*02440028
024500*  DCLGEN FOR INTEGRATION TABLE WST_INTGRTN_TYP                   02450028
024600*----------------------------------------------------------------*02460028
024700     EXEC SQL                                                     02470028
024800         INCLUDE WST00008                                         02480028
024900     END-EXEC.                                                    02490028
025000*----------------------------------------------------------------*02500028
025100*  DCLGEN FOR INTEGRATION TABLE WST_ATTR_DEFN                     02510028
025200*----------------------------------------------------------------*02520028
025300     EXEC SQL                                                     02530028
025400         INCLUDE WST00009                                         02540028
025500     END-EXEC.                                                    02550028
025600*----------------------------------------------------------------*02560028
025700*  DCLGEN FOR SUT_OTBND_UPC TABLE                                 02570028
025800*----------------------------------------------------------------*02580028
025900     EXEC SQL                                                     02590028
026000         INCLUDE SUT00028                                         02600028
026100     END-EXEC.                                                    02610028
026200*----------------------------------------------------------------*02620028
026300*  DCLGEN FOR XLV_UPC                                             02630028
026400*----------------------------------------------------------------*02640028
026500     EXEC SQL                                                     02650028
026600         INCLUDE XLV00003                                         02660028
026700     END-EXEC.                                                    02670028
026800*----------------------------------------------------------------*02680028
026900*  DCLGEN FOR XLT_SKU                                             02690028
027000*----------------------------------------------------------------*02700028
027100     EXEC SQL                                                     02710028
027200         INCLUDE XLT00003                                         02720028
027300     END-EXEC.                                                    02730028
027400*----------------------------------------------------------------*02740028
027500*  DCLGEN FOR XLV_VND_STYL                                        02750028
027600*----------------------------------------------------------------*02760028
027700     EXEC SQL                                                     02770028
027800         INCLUDE XLV00001                                         02780028
027900     END-EXEC.                                                    02790028
028000*AME-5148B-RFID  ADDED NEXT DCLGEN                                02800028
028100*----------------------------------------------------------------*02810028
028200*  DCLGEN FOR RIT_RFID_VRFN                                       02820028
028300*----------------------------------------------------------------*02830028
028400     EXEC SQL                                                     02840028
028500         INCLUDE RIT00000                                         02850028
028600     END-EXEC.                                                    02860028
028700*AME-5148B-RFID  ADDED NEXT DCLGEN                                02870028
028800*----------------------------------------------------------------*02880028
028900*  DCLGEN FOR TVNDAGR - VENDOR AGREEMENT TABLE                    02890028
029000*----------------------------------------------------------------*02900028
029100     EXEC SQL                                                     02910028
029200         INCLUDE TVNDAGR                                          02920028
029300     END-EXEC.                                                    02930028
029400*CLP 09/12/13 BEGIN                                               02940028
029500*----------------------------------------------------------------*02950028
029600*  DCLGEN FOR TPURCHS                                             02960028
029700*----------------------------------------------------------------*02970028
029800     EXEC SQL                                                     02980028
029900         INCLUDE TPURCHS                                          02990028
030000     END-EXEC.                                                    03000028
030100*----------------------------------------------------------------*03010028
030200*  DCLGEN FOR TPURITM                                             03020028
030300*----------------------------------------------------------------*03030028
030400     EXEC SQL                                                     03040028
030500         INCLUDE TPURITM                                          03050028
030600     END-EXEC.                                                    03060028
030700*CLP 09/12/13 END                                                 03070028
030800*----------------------------------------------------------------*03080028
030900*----------------------------------------------------------------*03090028
031000*  DCLGEN FOR XLT_LOC LOCATION TABLE                              03100028
031100*----------------------------------------------------------------*03110028
031200     EXEC SQL                                                     03120028
031300         INCLUDE XLT00010                                         03130028
031400     END-EXEC.                                                    03140028
031500*----------------------------------------------------------------*03150028
031600     EXEC SQL                                                     03160028
031700          INCLUDE SQLCA                                           03170028
031800     END-EXEC.                                                    03180028
031900*---------------------------------------------------------------* 03190028
032000*  CURSOR TO RETURN ALL THE UPC'S IN A CARTON FROM INBOUND      * 03200028
032100*---------------------------------------------------------------* 03210028
032200     EXEC SQL                                                     03220028
032300          DECLARE ITEM_UPC_CSR CURSOR FOR                         03230028
032400           SELECT DISTINCT UPC_NBR                                03240065
032410                , TRN_NBR                                         03241065
032500           FROM TSHUUPC                                           03250028
032600           WHERE SHIPT_UNT_ID = :SHUUPC-SHIPT-UNT-ID              03260028
032700          WITH UR                                                 03270028
032800     END-EXEC                                                     03280028
032900                                                                  03290028
033000*---------------------------------------------------------------* 03300028
033100*  CURSOR TO RETURN ALL THE UPC'S IN A CARTON FROM OUTBOUND     * 03310028
033200*---------------------------------------------------------------* 03320028
033300     EXEC SQL                                                     03330028
033400          DECLARE ITEM_UPC_CSR_OTBND CURSOR FOR                   03340028
033500           SELECT DISTINCT UPC_NBR                                03350065
033510                , TRN_NBR                                         03351065
033600           FROM SUT_OTBND_UPC                                     03360028
033700           WHERE SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID            03370028
033800           ORDER BY 1 ASC                                         03380028
033900          WITH UR                                                 03390028
034000     END-EXEC                                                     03400028
034100                                                                  03410028
034200*---------------------------------------------------------------* 03420028
034300*  CURSOR TO RETURN THE INTERNAL UPC ID FROM A PREPK            * 03430028
034400*---------------------------------------------------------------* 03440028
034500     EXEC SQL                                                     03450028
034600          DECLARE PREPK_INT_UPC_CSR CURSOR FOR                    03460028
034700            SELECT DISTINCT(ITM_NBR)                              03470028
034800                 , A.ORD_LNE_NBR                                  03480028
034900                 , A.PREPK_DRV_LNE_CDE                            03490028
035000             FROM  TRECITM A                                      03500028
035100             WHERE A.ORD_NBR             = :RECITM-ORD-NBR        03510028
035200               AND A.PREPK_ID            = :RECITM-PREPK-ID       03520028
035300               AND A.REC_SEQ_NBR         = :RECITM-REC-SEQ-NBR    03530028
035400               AND A.VER_STATUS_CDE      = 'A'                    03540028
035500             ORDER BY A.PREPK_DRV_LNE_CDE DESC                    03550028
035600          WITH UR                                                 03560028
035700     END-EXEC                                                     03570028
035800                                                                  03580028
035900*---------------------------------------------------------------* 03590028
036000*  CURSOR TO RETURN THE ITEM NUMBER FOR A STORE                 * 03600028
036100*---------------------------------------------------------------* 03610028
036200     EXEC SQL                                                     03620028
036300          DECLARE STORE_UPC_CSR CURSOR FOR                        03630028
036400            SELECT DISTINCT(ITM_NBR)                              03640028
036500             FROM  TRECITM A                                      03650028
036600                ,  TRECDIS B                                      03660028
036700             WHERE A.ORD_NBR        =  B.ORD_NBR                  03670028
036800               AND A.REC_SEQ_NBR    =  B.REC_SEQ_NBR              03680028
036900               AND A.ORD_NBR        = :RECITM-ORD-NBR             03690028
037000               AND A.REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR         03700028
037100               AND B.STR_NBR        = :RECDIS-STR-NBR             03710028
037200          WITH UR                                                 03720028
037300     END-EXEC                                                     03730028
037400                                                                  03740028
037500*---------------------------------------------------------------* 03750028
037600*  CURSOR TO RETURN THE STORE NUMBER(S) FOR P2L CARTON          * 03760028
037700*---------------------------------------------------------------* 03770028
037800     EXEC SQL                                                     03780028
037900          DECLARE P2L_STORE_CSR CURSOR FOR                        03790028
038000         SELECT DISTINCT(B.STR_NBR)                               03800028
038100           FROM TRECDIS B                                         03810028
038200          WHERE B.ORD_NBR        = :RECITM-ORD-NBR                03820028
038300            AND B.REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR            03830028
038400            AND B.ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            03840028
038600          WITH UR                                                 03860028
038700     END-EXEC                                                     03870028
038800                                                                  03880028
038900*---------------------------------------------------------------* 03890028
039000*CLP 09/12/13 BEGIN                                               03900028
039100*---------------------------------------------------------------* 03910028
039200*  CURSOR TO RETURN THE DEPT, ENT-ID AND SUBCLASS               * 03920028
039300*---------------------------------------------------------------* 03930028
039400     EXEC SQL                                                     03940028
039500          DECLARE PO_LEVEL_CSR CURSOR FOR                         03950028
039600          SELECT DISTINCT                                         03960028
039700                A.DEPT_NBR                                        03970028
039800              , A.ENT_ID                                          03980028
039900              , D.SUB_CL_NBR                                      03990028
040000          FROM  TPURCHS A                                         04000028
040100              , TPURITM B                                         04010028
040200          LEFT OUTER JOIN                                         04020028
040300                XLT_SKU C                                         04030028
040400          ON    B.ITM_NBR = C.ITM_NBR                             04040028
040500          LEFT OUTER JOIN                                         04050028
040600                XLV_VND_STYL D                                    04060028
040700          ON    C.STYL_ID = D.STYL_ID                             04070028
040800           WHERE  A.PO_NBR         = :PURCHS-PO-NBR               04080028
040900             AND  A.VER_STATUS_CDE = 'A'                          04090028
041000             AND  A.PO_NBR         = B.PO_NBR                     04100028
041100             AND  B.VER_STATUS_CDE = A.VER_STATUS_CDE             04110028
041200          WITH UR                                                 04120028
041300     END-EXEC                                                     04130028
041400*---------------------------------------------------------------* 04140028
041500*CLP 09/12/13 END                                                 04150028
041600                                                                  04160028
041700 LINKAGE SECTION.                                                 04170028
041800     COPY SUWS093.                                                04180028
041900                                                                  04190028
042000 PROCEDURE DIVISION USING SU093-ITEM-COMMAREA.                    04200028
042100                                                                  04210028
042200*    DISPLAY 'START OF SUKUT149'.                                 04220028
042300                                                                  04230028
042400*    DISPLAY 'SUWS093 COMING INTO PROGRAM'.                       04240028
042500*    PERFORM 0100-DISPLAY-SUWS093.                                04250028
042600                                                                  04260028
042700     SET SU093-SUCCESSFUL        TO TRUE.                         04270028
042800     MOVE 'N'                    TO PS-ITEM-UPC-CSR-SW            04280074
042900                                    PS-OTBND-UPC-CSR-SW           04290074
043000                                    PS-PREPK-UPC-CSR-SW           04300074
043100                                    PS-DC-RFID-SW                 04310074
043200                                    PS-STORE-RFID-SW              04320074
043300                                    PS-DEPT-SUBCL-RFID-SW         04330074
043400                                    PS-DEPT-WITHIN-STORE-RFID-SW  04340074
043500                                    PS-STORE-UPC-CSR-SW           04350074
043600                                    PS-EAS-DC-TAGGING-SW          04360074
043700                                    PS-EAS-TAGGING-FOR-DEPT-SW    04370074
043710                                    PS-RF-EAS-CONTINUE-CHK-SW     04371074
043720                                    PS-EFC-STORE-LOCATION-SW      04372074
043730                                    PS-CHECK-FOR-RFID-DONE-SW     04373074
043740                                    PS-CREATE-CART-LBL-FOR-P2L-SW.04374074
043750     MOVE 'Y'                    TO PS-DEPT-ENT-ID-FOUND-SW.      04375074
043800                                                                  04380028
043900     SET SU093-RFID-NO TO TRUE.                                   04390028
044000*CLP 11/15/13                                                     04400028
044100     SET SU093-IR-NEEDS-DC-TAGGING-NO TO TRUE.                    04410028
044200                                                                  04420028
044300     IF SU093-RFID-LOOKUP                                         04430028
044400         PERFORM 0500-PROCESS-LOOKUP                              04440028
044500     ELSE                                                         04450028
044600**SET ALL OUTPUT SWITCHES TO NO. EVEN IF A PARAGRAPH ISN'T        04460028
044700**PERFORMED THE SWITCH WILL HAVE A VALUE ON RETUREN TO CALLING PGM04470028
044800         SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE                04480028
044900         SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE                04490028
045000         SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE                04500028
045100         SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE                04510028
045200         SET SU093-DC-DEPT-TAGS-NO         TO TRUE                04520028
045300         SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE                04530028
045400         SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE                04540028
045500         SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE                04550028
045600         PERFORM 0900-CHECK-EAS-TAGGING-DC                        04560028
045700         PERFORM 1000-PROCESS-REQUEST                             04570028
045800     END-IF.                                                      04580028
045900                                                                  04590028
046000     MOVE SQLCA TO SU093-SQLCA.                                   04600028
046100                                                                  04610028
046200*    DISPLAY 'PS-DC-RFID-SW: ' PS-DC-RFID-SW.                     04620051
046300*    DISPLAY 'PS-EAS-DC-TAGGING-SW: ' PS-EAS-DC-TAGGING-SW.       04630051
046400*    DISPLAY 'PS-EAS-TAGGING-FOR-DEPT-SW: '                       04640051
046500*            PS-EAS-TAGGING-FOR-DEPT-SW.                          04650051
046600*    DISPLAY 'SUWS093 COMING OUT OF PROGRAM'.                     04660051
046700*    PERFORM 0100-DISPLAY-SUWS093.                                04670051
046800                                                                  04680028
046900     GOBACK.                                                      04690028
047000                                                                  04700028
047100 0100-DISPLAY-SUWS093.                                            04710028
047200                                                                  04720028
047300     DISPLAY 'SU093-ACCESS-METHOD: ' SU093-ACCESS-METHOD.         04730028
047400     DISPLAY 'SU093-DC: ' SU093-DC.                               04740028
047500     DISPLAY 'SU093-STORE: ' SU093-STORE.                         04750028
047600     DISPLAY 'SU093-DEPT-SUBCLASS: ' SU093-DEPT-SUBCLASS.         04760028
047700     DISPLAY 'SU093-DEPT-IN-STORE: ' SU093-DEPT-IN-STORE.         04770028
047800     DISPLAY 'SU093-VNDR-DPT-COMPLINT: ' SU093-VNDR-DPT-COMPLINT. 04780028
047900     DISPLAY 'SU093-VNDR-DPT-TAGGING: ' SU093-VNDR-DPT-TAGGING.   04790028
048000     DISPLAY 'SU093-SKU: ' SU093-SKU.                             04800028
048100     DISPLAY 'SU093-RFID-STR-CHK-NEEDED-IND: '                    04810028
048200             SU093-RFID-STR-CHK-NEEDED-IND.                       04820028
048300     DISPLAY 'SU093-RETURN-CODE: ' SU093-RETURN-CODE.             04830028
048400     DISPLAY 'SU093-PREPK-ORDER-IND: ' SU093-PREPK-ORDER-IND.     04840028
048500     DISPLAY 'SU093-INB-OUTB-IND: ' SU093-INB-OUTB-IND.           04850028
048600     DISPLAY 'SU093-ERROR-NBR: ' SU093-ERROR-NBR.                 04860028
048700     IF SU093-SQLCODE IS NUMERIC                                  04870028
048800        MOVE SU093-SQLCODE TO PV-DISPLAY-SQLCODE                  04880028
048900        DISPLAY 'SU093-SQLCODE: ' PV-DISPLAY-SQLCODE              04890028
049000     ELSE                                                         04900028
049100        MOVE ZERO          TO PV-DISPLAY-SQLCODE                  04910028
049200        DISPLAY 'SU093-SQLCODE: ' PV-DISPLAY-SQLCODE              04920028
049300     END-IF.                                                      04930028
049400     MOVE SU093-KEY-PO TO PV-DISPLAY-NUMBER-10.                   04940028
049500     DISPLAY 'SU093-KEY-PO: ' PV-DISPLAY-NUMBER-10.               04950028
049600     MOVE SU093-KEY-REC-SEQ-NBR TO PV-DISPLAY-NUMBER-10.          04960028
049700     DISPLAY 'SU093-KEY-REC-SEQ-NBR: ' PV-DISPLAY-NUMBER-10.      04970028
049800     MOVE SU093-KEY-LNE-NBR TO PV-DISPLAY-NUMBER-10.              04980028
049900     DISPLAY 'SU093-KEY-LNE-NBR: ' PV-DISPLAY-NUMBER-10.          04990028
050000     MOVE SU093-KEY-PREPK-ID TO PV-DISPLAY-NUMBER-5.              05000028
050100     DISPLAY 'SU093-KEY-PREPK-ID: ' PV-DISPLAY-NUMBER-5.          05010028
050200     MOVE SU093-KEY-OPER-UNT-ID TO PV-DISPLAY-NUMBER-5.           05020028
050300     DISPLAY 'SU093-KEY-OPER-UNT-ID: ' PV-DISPLAY-NUMBER-5.       05030028
050400     MOVE SU093-KEY-DEST-LOC TO PV-DISPLAY-NUMBER-5.              05040028
050500     DISPLAY 'SU093-KEY-DEST-LOC: ' PV-DISPLAY-NUMBER-5.          05050028
050600     MOVE SU093-KEY-CARTON-ID TO PV-DISPLAY-NUMBER-18.            05060028
050700     DISPLAY 'SU093-KEY-CARTON-ID: ' PV-DISPLAY-NUMBER-18.        05070028
050800     MOVE SU093-KEY-SKU-NBR TO PV-DISPLAY-NUMBER-10.              05080028
050900     DISPLAY 'SU093-KEY-SKU-NBR: ' PV-DISPLAY-NUMBER-10.          05090028
051000     MOVE SU093-KEY-IR-NBR TO PV-DISPLAY-NUMBER-5.                05100028
051100     DISPLAY 'SU093-KEY-IR-NBR: ' PV-DISPLAY-NUMBER-5.            05110028
051200     DISPLAY 'OUTPUT FIELDS FROM COPYBOOK'.                       05120028
051300     DISPLAY 'SU093-RFID-IND: ' SU093-RFID-IND.                   05130028
051400     DISPLAY 'SU093-RFID-KOHL-DPT-IN-STR-SW: '                    05140028
051500             SU093-RFID-KOHL-DPT-IN-STR-SW.                       05150028
051600     DISPLAY 'SU093-RFID-KOHL-DEPT-SUBCL-SW: '                    05160028
051700             SU093-RFID-KOHL-DEPT-SUBCL-SW.                       05170028
051800     DISPLAY 'SU093-VNDR-DPT-RFID-COMPLI-SW: '                    05180028
051900             SU093-VNDR-DPT-RFID-COMPLI-SW.                       05190028
052000     DISPLAY 'SU093-VNDR-DPT-RFID-TAGS-SW: '                      05200028
052100             SU093-VNDR-DPT-RFID-TAGS-SW.                         05210028
052200     DISPLAY 'SU093-DC-DEPT-TAGS-SW: '                            05220028
052300             SU093-DC-DEPT-TAGS-SW.                               05230028
052400     DISPLAY 'SU093-DC-USE-RFID-CART-LBL-SW: '                    05240028
052500             SU093-DC-USE-RFID-CART-LBL-SW.                       05250028
052600     DISPLAY 'SU093-RFID-DC-AUTO-CONVEYR-SW: '                    05260028
052700             SU093-RFID-DC-AUTO-CONVEYR-SW.                       05270028
052800     DISPLAY 'SU093-DPT-STR-P2L-FIRST-SW: '                       05280028
052900             SU093-DPT-STR-P2L-FIRST-SW.                          05290028
053000     DISPLAY 'SU093-P2L-CHK-IN-SW: '                              05300028
053100             SU093-P2L-CHK-IN-SW.                                 05310028
053200     DISPLAY 'SU093-IR-CHK-IN-SW: ' SU093-IR-CHK-IN-SW.           05320028
053300     DISPLAY 'SU093-IR-NEEDS-DC-TAGGING-SW: '                     05330028
053400             SU093-IR-NEEDS-DC-TAGGING-SW.                        05340028
053500     DISPLAY 'SU093-LABEL-PRINT-IND: '                            05350051
053600              SU093-LABEL-PRINT-IND.                              05360051
053700 0500-PROCESS-LOOKUP.                                             05370028
053800                                                                  05380028
053900     IF SU093-CHECK-BY-DC                                         05390028
054000         PERFORM 1500-CHECK-IF-RFID-DC.                           05400028
054100                                                                  05410028
054200     IF PS-DC-RFID-YES                                            05420028
054300         SET SU093-RFID-DC    TO TRUE                             05430028
054400     END-IF.                                                      05440028
054500                                                                  05450028
054600***************************************************************   05460028
054700***  PILOT TO FLAG CARTONS FOR EAS TAGGING.  INITIAL CHECK TO     05470028
054800***  SEE IF DC IS TURNED ON FOR EAS TAGGING.                      05480028
054900***************************************************************   05490028
055000 0900-CHECK-EAS-TAGGING-DC.                                       05500028
055100                                                                  05510028
055200     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     05520028
055300                                                                  05530028
055400                                                                  05540028
055500     EXEC SQL                                                     05550028
055600         SELECT FUNC_TXT                                          05560028
055700           INTO :KRPRPM-FUNC-TXT                                  05570028
055800         FROM TKRPRPM                                             05580028
055900         WHERE LOC_ID            =  :DK-DC-NBR                    05590028
056000           AND INTFC_SYS_CDE     =  'KHL'                         05600028
056100           AND SYS_PRC_FUNC_CDE  =  'RFIDDC'                      05610028
056200           AND FUNC_PRC_STAT_CDE =  'AC'                          05620028
056300           AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP             05630028
056400           AND FUNC_END_TMST    >=  CURRENT TIMESTAMP             05640028
056500         WITH UR                                                  05650028
056600     END-EXEC.                                                    05660028
056700                                                                  05670028
056800     EVALUATE TRUE                                                05680028
056900         WHEN SQLCODE = ZERO                                      05690028
057000              MOVE KRPRPM-FUNC-TXT TO PS-EAS-DC-TAGGING-SW        05700028
057100         WHEN SQLCODE = +100                                      05710028
057200              SET PS-EAS-DC-TAGGING-NO     TO TRUE                05720028
057300         WHEN OTHER                                               05730028
057400              MOVE 60             TO SU093-ERROR-NBR              05740028
057500              MOVE SQLCODE        TO SU093-SQLCODE                05750028
057600              SET SU093-SQL-ERROR TO TRUE                         05760028
057700     END-EVALUATE.                                                05770028
057800                                                                  05780028
057900                                                                  05790028
058000 1000-PROCESS-REQUEST.                                            05800028
058100                                                                  05810028
058200     PERFORM 1500-CHECK-IF-RFID-DC.                               05820028
058300                                                                  05830028
058400**   DO NOT CONTINUE PROCESSING IF DC IS NOT RFID                 05840028
058500     IF PS-DC-RFID-YES OR PS-EAS-DC-TAGGING-YES                   05850028
058600         EVALUATE TRUE                                            05860028
058700             WHEN SU093-CHECK-IN                                  05870028
058800                 PERFORM 2000-PROCESS-INBOUND-CTN                 05880028
058900             WHEN SU093-CSEPK-SPLIT                               05890028
059000                 IF SU093-PREPK-ORDER-YES                         05900028
059100                    PERFORM 3000-PROCESS-CASEPK-PREPK             05910028
059200                 ELSE                                             05920028
059300                    PERFORM 3500-PROCESS-CASEPK                   05930028
059400                 END-IF                                           05940028
059500             WHEN SU093-SMOOTHING                                 05950028
059600                 PERFORM 4000-PROCESS-SMOOTHING                   05960028
059700             WHEN SU093-CARTON-STATUS                             05970028
059800                 IF SU093-INBOUND-CTN                             05980028
059900                    PERFORM 2000-PROCESS-INBOUND-CTN              05990028
060000                 ELSE                                             06000028
060100                     IF SU093-OUTBOUND-CTN                        06010028
060200                        PERFORM 5000-PROCESS-OUTBOUND-CTN         06020028
060300                     ELSE                                         06030028
060400                         SET SU093-INVALID-ACCESS TO TRUE         06040028
060500                     END-IF                                       06050028
060600                 END-IF                                           06060028
060700             WHEN SU093-PACK-TO-LIGHT                             06070028
060800*GB 5/25/17 BEG                                                   06080051
060900                 SET PS-EAS-DC-TAGGING-NO  TO TRUE                06090051
061000*GB 5/25/17 END                                                   06100051
061100                 PERFORM 6000-PROCESS-PACK-TO-LIGHT               06110028
061200*CLP 09/12/13 BEGIN                                               06120028
061300             WHEN SU093-PO-LEVEL-CHECK                            06130028
061400                 PERFORM 6100-PROCESS-PO-LEVEL-CHECK              06140028
061500*CLP 09/12/13 END                                                 06150028
061600             WHEN OTHER                                           06160028
061700                 SET SU093-INVALID-ACCESS TO TRUE                 06170028
061800         END-EVALUATE                                             06180028
061900     END-IF.                                                      06190028
062000                                                                  06200028
062100                                                                  06210035
062200*IF CARTON IS RFID AND IT'S PACK TO LIGHT, CHECK IF DC HAS AUTO   06220049
062300*CONVEYOR, 8850-CHK-DC-AUTO-CONVEYRS. IF YES, WILL PERFORM        06230049
062400*8860-CHK-DEPT-STR-P2L-FIRST TO SEE IF CARTON NEEDS TO GO TO      06240049
062500*P2L FIRST INSTEAD OF THE FLAT AREA FIRST                         06250049
062600     IF SU093-RFID-STR-CHK-NEEDED-NO                              06260051
062700         PERFORM 8850-CHK-DC-AUTO-CONVEYRS                        06270049
062800     END-IF.                                                      06280049
062900                                                                  06290049
063000     PERFORM 8800-CHK-VNDR-DPT-COMPLI-TAGNG.                      06300049
063100     IF  PS-DEPT-WITHIN-STORE-RFID-YES                            06310051
063200     AND PS-EAS-TAGGING-FOR-DEPT-YES                              06320051
063300     AND (SU093-VNDR-DPT-RFID-TAGS-YES OR                         06330038
063400         SU093-VNDR-DPT-RFID-COMPLI-YES)                          06340038
063500         SET SU093-PRINT-EAS        TO TRUE                       06350051
063600         SET SU093-RFID-YES         TO TRUE                       06360051
063700     ELSE                                                         06370035
063800         IF  PS-DEPT-WITHIN-STORE-RFID-YES                        06380051
063900             AND PS-EAS-TAGGING-FOR-DEPT-YES                      06390051
064000             AND (SU093-VNDR-DPT-RFID-TAGS-NO OR                  06400038
064100                  SU093-VNDR-DPT-RFID-COMPLI-NO)                  06410038
064200             SET SU093-PRINT-RFID-EAS   TO TRUE                   06420051
064300             SET SU093-RFID-YES         TO TRUE                   06430051
064400         ELSE                                                     06440035
064500             IF  PS-DEPT-WITHIN-STORE-RFID-YES                    06450051
064600                 SET SU093-PRINT-RFID    TO TRUE                  06460051
064700                 SET SU093-RFID-YES         TO TRUE               06470051
064800             ELSE                                                 06480051
064900                 IF PS-EAS-TAGGING-FOR-DEPT-YES                   06490051
065000                    SET SU093-PRINT-EAS  TO TRUE                  06500051
065100                    SET SU093-RFID-YES   TO TRUE                  06510051
065200                 ELSE                                             06520035
065300                        SET PS-RF-EAS-CONTINUE-CHK-YES TO TRUE    06530043
065400                 END-IF                                           06540035
065500             END-IF                                               06550051
065600         END-IF                                                   06560051
065700     END-IF.                                                      06570051
065800                                                                  06580035
065900**   IF SU093-RFID-YES AND SU093-RFID-STR-CHK-NEEDED-NO           06590051
066000*****IF SU093-RFID-STR-CHK-NEEDED-NO                              06600051
066100*IF CARTON IS RFID AND IT'S PACK TO LIGHT, CHECK IF DC HAS AUTO   06610028
066200*CONVEYOR, 8850-CHK-DC-AUTO-CONVEYRS. IF YES, WILL PERFORM        06620028
066300*8860-CHK-DEPT-STR-P2L-FIRST TO SEE IF CARTON NEEDS TO GO TO      06630028
066400*P2L FIRST INSTEAD OF THE FLAT AREA FIRST                         06640028
066500*****    PERFORM 8850-CHK-DC-AUTO-CONVEYRS                        06650051
066600*****END-IF.                                                      06660045
066700                                                                  06670028
066800*    DISPLAY '1000-PROCESS-REQUEST - PRIOR TO 8800-'.             06680051
066900*    DISPLAY 'SU093-RFID-IND=' SU093-RFID-IND.                    06690051
067000*    DISPLAY 'PS-EAS-DC-TAGGING-SW=' PS-EAS-DC-TAGGING-SW.        06700051
067100*    DISPLAY 'SU093-IR-NEEDS-DC-TAGGING-SW='                      06710051
067200*            SU093-IR-NEEDS-DC-TAGGING-SW.                        06720051
067300*    DISPLAY 'SU093-LABEL-PRINT-IND: '                            06730051
067400*             SU093-LABEL-PRINT-IND.                              06740051
067500*    DISPLAY 'SU093-IR-CHK-IN-SW=' SU093-IR-CHK-IN-SW.            06750051
067600*    DISPLAY 'PS-EAS-TAGGING-FOR-DEPT-SW='                        06760051
067700*            PS-EAS-TAGGING-FOR-DEPT-SW.                          06770051
067800     IF SU093-RFID-YES OR PS-RF-EAS-CONTINUE-CHK-YES              06780028
067900**   AND PS-EAS-TAGGING-FOR-DEPT-NO                               06790051
068000         IF SU093-IR-NEEDS-DC-TAGGING-YES                         06800028
068100             SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE            06810028
068200         ELSE                                                     06820028
068300*            ONLY NEED TO DO ONCE                                 06830028
068400             IF SU093-IR-CHK-IN-YES                               06840028
068500                CONTINUE                                          06850028
068600             ELSE                                                 06860028
068700                PERFORM 8800-CHK-VNDR-DPT-COMPLI-TAGNG            06870028
068800             END-IF                                               06880028
068900         END-IF                                                   06890028
069000                                                                  06900028
069100*IF VENDOR/DEPT HAS BEEN JUDGED BY KOHL'S TO BE COMPLIANT, THAT IS06910028
069200*THEY AGREED TO TAG AND HAVE BEEN FOLLOWING THROUGH, THE CARTON   06920028
069300*WILL CONTINUE THROUGH THE DC AS IF IT WEREN'T RFID.              06930028
069400           IF SU093-VNDR-DPT-RFID-COMPLI-YES OR                   06940028
069500*CLP 11/15/13                                                     06950028
069600               (SU093-IR-CHK-IN-YES AND                           06960028
069700               SU093-IR-NEEDS-DC-TAGGING-NO)                      06970028
069800               CONTINUE                                           06980028
069900           ELSE                                                   06990028
070000*WHETHER DEPT W/IN VENDOR TAGS OR NOT CHECK IF THE DC/DEPT TAGS   07000028
070100               PERFORM 8825-CHK-DC-DEPT-TAGS                      07010028
070200*WHETHER OR NOT DEPT W/IN VENDOR TAGS OR NOT,OR WHETHER OR NOT    07020028
070300*KOHLS TAGS OR NOT CHECK IF THE DC USES RFID CARTON LABELS,       07030028
070400*SOMETIMES CALLED '5' LABELS                                      07040028
070500               IF SU093-DC-DEPT-TAGS-YES                          07050028
070600                   PERFORM 8840-CHK-DC-USE-RFID-CART-LBL          07060028
070700               END-IF                                             07070028
070800           END-IF                                                 07080028
070900     END-IF.                                                      07090028
071000**GB 9/20/15 EAS BEG                                              07100028
071100     IF PS-EAS-TAGGING-FOR-DEPT-YES                               07110028
071200        PERFORM 8840-CHK-DC-USE-RFID-CART-LBL                     07120028
071300     END-IF.                                                      07130028
071400**GB 9/20/15 EAS END                                              07140028
071500                                                                  07150028
071600*CLP 04/08/15 START                                               07160028
071700     IF SU093-RFID-YES AND                                        07170028
071800        SU093-P2L-CHK-IN-YES                                      07180028
071900         PERFORM 6150-CHECK-NON-AUTO-P2L                          07190028
072000     END-IF.                                                      07200028
072100*CLP 04/08/15 END                                                 07210028
072200                                                                  07220028
072300*08/09/13 RLK BEG                                                 07230028
072400* IF A CHECK IS BEING DONE ON A P2L CARTON, NO SO STORE CHECK IS  07240028
072500* NEEDED AND SU093-RFID-KOHL-DPT-IN-STR-YES IS SET ON.            07250028
072600* ONLY SUKCS771 AND SUKRF502 WILL SET SU093-P2L-CHK-IN-YES ON.    07260028
072700     IF SU093-RFID-YES                                            07270028
072800       AND SU093-P2L-CHK-IN-YES                                   07280028
072900       AND SU093-CHECK-IN                                         07290028
073000       SET SU093-RFID-KOHL-DPT-IN-STR-YES TO TRUE.                07300028
073100*08/09/13 RLK END                                                 07310028
073101                                                                  07310156
073110*09/09/17 GB  BEG                                                 07311056
073120*09/09/17 PGM CALLED BY RECEIVER CREATE AT PO LEVEL TO            07312056
073130*DETERMINE IF TROUBLE NEEDS TO BE CREATED,FOR COMPLIANT OR        07313056
073140*TAGGING VENDORS TRBL CREATE IS BYPASSED, HOWEVER IF ALSO         07314056
073150*EAS THEN TROUBLE SHOULD BE CREATED                               07315056
073200     IF SU093-PO-LEVEL-CHECK                                      07320056
073201        IF PS-EAS-TAGGING-FOR-DEPT-YES                            07320156
073210           SET SU093-VNDR-DPT-RFID-COMPLI-NO                      07321056
073211               SU093-VNDR-DPT-RFID-TAGS-NO TO TRUE                07321156
073212        ELSE                                                      07321257
073213           IF PS-RFID-DC-DEPT-TAGGING-NO                          07321357
073214              SET SU093-RFID-NO  TO TRUE                          07321457
073220           END-IF                                                 07322057
073221        END-IF                                                    07322157
073230     END-IF.                                                      07323056
073240*09/09/17 GB  END                                                 07324056
073250                                                                  07325056
073300** RPK 1/6/17 - COMMENTED OUT THE FOLLOWING 11 LINES,             07330028
073400**              THAT INCLUDES THE CLP 04/08/15 LINES              07340028
073500*CLP 04/08/15 START                                               07350028
073600*    IF SU093-RFID-YES                                            07360028
073700*        IF PS-CREATE-CART-LBL-FOR-P2L-YES                        07370028
073800*            SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE            07380028
073900*        ELSE                                                     07390028
074000*          IF PS-EAS-TAGGING-FOR-DEPT-YES                         07400028
074100*             SET SU093-DC-USE-RFID-CART-LBL-YES TO TRUE          07410028
074200*          END-IF                                                 07420028
074300*        END-IF                                                   07430028
074400*    END-IF.                                                      07440028
074500*CLP 04/08/15 END                                                 07450028
074600********************************************************          07460028
074700***  CHECK THE RFID VERIFCATION TABLE TO SEE IF THE DC IS RFID    07470028
074800********************************************************          07480028
074900 1500-CHECK-IF-RFID-DC.                                           07490028
075000                                                                  07500028
075100     MOVE SU093-KEY-OPER-UNT-ID TO DK-LOC-NBR.                    07510028
075200                                                                  07520028
075300*AME-5148B-RFID START-REPLACE TBL TKRPRPM W/RIT_RFID_VRFN         07530028
075400                                                                  07540028
075500     EXEC SQL                                                     07550028
075600         SELECT A.DC_LOC_NBR                                      07560028
075700           INTO :RIT00000-DC-LOC-NBR                              07570028
075800           FROM RIT_RFID_VRFN  A                                  07580028
075900          WHERE A.DC_LOC_NBR    = :DK-LOC-NBR                     07590028
076000            AND A.STR_NBR       = 0                               07600028
076100            AND A.DEPT_NBR      = 0                               07610028
076200            AND A.SUB_CL_NBR    = 0                               07620028
076300            AND A.RFID_LVL_CDE  = 'RFIDDC'                        07630028
076400            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              07640028
076500            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              07650028
076600         WITH UR                                                  07660028
076700     END-EXEC.                                                    07670028
076800*AME-5148B-RFID END                                               07680028
076900                                                                  07690028
077000     EVALUATE TRUE                                                07700028
077100         WHEN SQLCODE = ZERO                                      07710028
077200                  SET PS-DC-RFID-YES TO TRUE                      07720028
077300         WHEN SQLCODE = +100                                      07730028
077400              SET PS-DC-RFID-NO  TO TRUE                          07740028
077500         WHEN OTHER                                               07750028
077600              SET PS-DC-RFID-NO  TO TRUE                          07760028
077700              MOVE 1              TO SU093-ERROR-NBR              07770028
077800              MOVE SQLCODE        TO SU093-SQLCODE                07780028
077900              SET SU093-SQL-ERROR TO TRUE                         07790028
078000     END-EVALUATE.                                                07800028
078100                                                                  07810028
078200*----------------------------------------------------------------*07820028
078300*PROCESS FOR SU093-CHECK-IN OR (SU093-CARTON-STATUS AND          *07830028
078400*SU093-INBOUND-CTN)                                              *07840028
078500*----------------------------------------------------------------*07850028
078600 2000-PROCESS-INBOUND-CTN.                                        07860028
078700                                                                  07870028
078800**   DO NOT CONTINUE PROCESSING IF STORE IS NOT RFID              07880028
078900         MOVE SU093-KEY-CARTON-ID TO SHUUPC-SHIPT-UNT-ID          07890028
079000         SET PS-NOT-EO-ITEM-UPC-CSR TO TRUE                       07900028
079100         PERFORM 2100-OPEN-ITEM-UPC-CSR                           07910028
079200         PERFORM 2200-FETCH-ITEM-UPC-CSR                          07920028
079300           UNTIL PS-EO-ITEM-UPC-CSR     OR                        07930028
079400                 PS-CHECK-FOR-RFID-DONE-YES                       07940028
079500         PERFORM 2300-CLOSE-ITEM-UPC-CSR.                         07950028
079600                                                                  07960028
079700         IF SU093-RFID-STR-CHK-NEEDED-NO                          07970028
079800             IF PS-DEPT-SUBCL-RFID-YES                            07980028
079900                SET SU093-RFID-YES TO TRUE                        07990028
080000             END-IF                                               08000028
080100         ELSE                                                     08010028
080200             IF PS-DEPT-SUBCL-RFID-YES AND                        08020028
080300                PS-DEPT-WITHIN-STORE-RFID-YES                     08030028
080400                SET SU093-RFID-YES TO TRUE                        08040028
080500             END-IF                                               08050028
080600         END-IF.                                                  08060028
080700                                                                  08070028
080800******************************************************************08080028
080900 2100-OPEN-ITEM-UPC-CSR.                                          08090028
081000                                                                  08100028
081100         EXEC SQL                                                 08110028
081200              OPEN ITEM_UPC_CSR                                   08120028
081300         END-EXEC                                                 08130028
081400                                                                  08140028
081500         EVALUATE TRUE                                            08150028
081600             WHEN SQLCODE = ZERO                                  08160028
081700                 CONTINUE                                         08170028
081800         WHEN SQLCODE = -904                                      08180028
081900         WHEN SQLCODE = -913                                      08190028
082000         WHEN SQLCODE = -911                                      08200028
082100             MOVE 3                   TO SU093-ERROR-NBR          08210028
082200             MOVE SQLCODE             TO SU093-SQLCODE            08220028
082300             SET SU093-SQL-ERROR      TO TRUE                     08230028
082400         WHEN SQLWARN0 NOT = SPACES                               08240028
082500         WHEN SQLCODE NOT EQUAL ZERO                              08250028
082600             MOVE 4                   TO SU093-ERROR-NBR          08260028
082700             MOVE SQLCODE             TO SU093-SQLCODE            08270028
082800             SET SU093-SQL-ERROR      TO TRUE                     08280028
082900         END-EVALUATE.                                            08290028
083000                                                                  08300028
083100*----------------------------------------------------------------*08310028
083200*                                                                *08320028
083300*----------------------------------------------------------------*08330028
083400 2200-FETCH-ITEM-UPC-CSR.                                         08340028
083500                                                                  08350028
083600     EXEC SQL                                                     08360028
083700        FETCH   ITEM_UPC_CSR                                      08370028
083800        INTO   :SHUUPC-UPC-NBR                                    08380028
083810           ,   :SHUUPC-TRN-NBR                                    08381065
083900     END-EXEC.                                                    08390028
084000                                                                  08400028
084100     EVALUATE TRUE                                                08410028
084200       WHEN SQLCODE = ZEROS                                       08420028
084300            PERFORM 8000-SEL-DPT-SCL-VS-NBR                       08430028
084400            PERFORM 8100-CHECK-DEPT                               08440028
084500       WHEN SQLCODE = +100                                        08450028
084600            SET  PS-EO-ITEM-UPC-CSR  TO TRUE                      08460028
084700       WHEN SQLCODE = -904                                        08470028
084800       WHEN SQLCODE = -913                                        08480028
084900       WHEN SQLCODE = -911                                        08490028
085000           MOVE 5                   TO SU093-ERROR-NBR            08500028
085100           MOVE SQLCODE             TO SU093-SQLCODE              08510028
085200           SET SU093-SQL-ERROR      TO TRUE                       08520028
085300       WHEN SQLWARN0 NOT = SPACES                                 08530028
085400       WHEN SQLCODE NOT EQUAL ZERO                                08540028
085500           MOVE 6                   TO SU093-ERROR-NBR            08550028
085600           MOVE SQLCODE             TO SU093-SQLCODE              08560028
085700           SET SU093-SQL-ERROR      TO TRUE                       08570028
085800     END-EVALUATE.                                                08580028
085900                                                                  08590028
086000 2300-CLOSE-ITEM-UPC-CSR.                                         08600028
086100                                                                  08610028
086200         EXEC SQL                                                 08620028
086300             CLOSE ITEM_UPC_CSR                                   08630028
086400         END-EXEC                                                 08640028
086500                                                                  08650028
086600         EVALUATE TRUE                                            08660028
086700             WHEN SQLCODE = ZERO                                  08670028
086800                 CONTINUE                                         08680028
086900             WHEN SQLWARN0 NOT = SPACES                           08690028
087000             WHEN SQLCODE < ZERO                                  08700028
087100             WHEN SQLCODE > ZERO                                  08710028
087200                MOVE 7                   TO SU093-ERROR-NBR       08720028
087300                MOVE SQLCODE             TO SU093-SQLCODE         08730028
087400                SET SU093-SQL-ERROR      TO TRUE                  08740028
087500         END-EVALUATE.                                            08750028
087600                                                                  08760028
087700*************************************************************     08770028
087800***  CHECK DEPT FOR RFID VERIFICATION-DON'T DO WHEN THE CARTON    08780028
087900***  IS A PACK TO LIGHT CARTON                                    08790028
088000*************************************************************     08800028
088100 2500-CHECK-BY-DPT-WITHIN-STORE.                                  08810028
088200                                                                  08820028
088300     IF RECDIS-STR-NBR > 0                                        08830028
088400        MOVE RECDIS-STR-NBR TO DK-LOC-NBR                         08840028
088500     ELSE                                                         08850028
088600         MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR                    08860028
088700     END-IF.                                                      08870028
088800                                                                  08880028
088900     SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE.                   08890028
089000                                                                  08900028
089100     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   08910028
089200                                                                  08920028
089300     EXEC SQL                                                     08930028
089400         SELECT DISTINCT(A.INCLN_CDE)                             08940028
089500           INTO :PV-DEPT-WITHIN-STORE-IND                         08950028
089600           FROM RIT_RFID_VRFN  A                                  08960028
089700          WHERE A.STR_NBR        = :DK-LOC-NBR                    08970028
089800            AND A.DC_LOC_NBR     =0                               08980028
089900            AND A.SUB_CL_NBR     =0                               08990028
090000            AND A.RFID_LVL_CDE   = 'STRDPT'                       09000028
090100            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              09010028
090200            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              09020028
090300         WITH UR                                                  09030028
090400     END-EXEC.                                                    09040028
090500                                                                  09050028
090600     EVALUATE TRUE                                                09060028
090700         WHEN SQLCODE = ZERO                                      09070028
090800           EVALUATE TRUE                                          09080028
090900              WHEN PV-DEPT-WITHIN-STORE-IND = 'N'                 09090028
091000                  SET PS-DEPT-WITHIN-STORE-RFID-YES  TO TRUE      09100028
091100* 08/09/13 RLK BEG                                                09110028
091200                  IF SU093-P2L-CHK-IN-YES                         09120028
091300                    SET SU093-RFID-KOHL-DPT-IN-STR-YES TO TRUE    09130028
091400                  ELSE                                            09140028
091500                    PERFORM 2550-CK-NO-XCPTN-DPT-WTHIN-STR        09150028
091600                  END-IF                                          09160028
091700* 08/09/13 RLK END                                                09170028
091800              WHEN PV-DEPT-WITHIN-STORE-IND = 'E'                 09180028
091900                  PERFORM 2600-CHK-EXCLDED-DPT-WTHIN-STR          09190028
092000              WHEN PV-DEPT-WITHIN-STORE-IND = 'I'                 09200028
092100                  PERFORM 2700-CHK-INCLDED-DPT-WTHIN-STR          09210028
092200              WHEN OTHER                                          09220028
092300                  MOVE 44             TO SU093-ERROR-NBR          09230028
092400                  MOVE SQLCODE        TO SU093-SQLCODE            09240028
092500                  SET SU093-SQL-ERROR TO TRUE                     09250028
092600           END-EVALUATE                                           09260028
092700         WHEN SQLCODE = +100                                      09270028
092800              SET PS-DEPT-WITHIN-STORE-RFID-NO   TO TRUE          09280028
092900              SET SU093-RFID-KOHL-DPT-IN-STR-NO  TO TRUE          09290028
093000         WHEN OTHER                                               09300028
093100              MOVE 25             TO SU093-ERROR-NBR              09310028
093200              MOVE SQLCODE        TO SU093-SQLCODE                09320028
093300              SET SU093-SQL-ERROR TO TRUE                         09330028
093400     END-EVALUATE.                                                09340028
093500                                                                  09350028
093600*************************************************************     09360028
093700***  CHECK DEPT WITHIN STORE FOR RFID VERIFICATION WHEN THER ARE  09370028
093800***  NO INCLUSIONS OR EXCLUSIONS ON RIT_RFID_VRFN                 09380028
093900*************************************************************     09390028
094000 2550-CK-NO-XCPTN-DPT-WTHIN-STR.                                  09400028
094100                                                                  09410028
094200     MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR.                       09420028
094300                                                                  09430028
094400     SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE.                   09440028
094500                                                                  09450028
094600     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   09460028
094700                                                                  09470028
094800     EXEC SQL                                                     09480028
094900         SELECT A.INCLN_CDE                                       09490028
095000           INTO :PV-DEPT-WITHIN-STORE-IND                         09500028
095100           FROM RIT_RFID_VRFN  A                                  09510028
095200          WHERE A.STR_NBR        = :DK-LOC-NBR                    09520028
095300            AND A.DEPT_NBR       = :XLV00001-DEPT-NBR             09530028
095400            AND A.SUB_CL_NBR     = 0                              09540028
095500            AND A.DC_LOC_NBR     = 0                              09550028
095600            AND A.RFID_LVL_CDE   = 'STRDPT'                       09560028
095700            AND A.INCLN_CDE      = 'N'                            09570028
095800            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              09580028
095900            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              09590028
096000         WITH UR                                                  09600028
096100     END-EXEC.                                                    09610028
096200                                                                  09620028
096300     EVALUATE TRUE                                                09630028
096400         WHEN SQLCODE = ZERO                                      09640028
096500              SET PS-DEPT-WITHIN-STORE-RFID-YES  TO TRUE          09650028
096600              SET SU093-RFID-KOHL-DPT-IN-STR-YES TO TRUE          09660028
096700         WHEN SQLCODE = +100                                      09670028
096800              SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE           09680028
096900              SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE           09690028
097000         WHEN OTHER                                               09700028
097100              MOVE 52             TO SU093-ERROR-NBR              09710028
097200              MOVE SQLCODE        TO SU093-SQLCODE                09720028
097300              SET SU093-SQL-ERROR TO TRUE                         09730028
097400     END-EVALUATE.                                                09740028
097500                                                                  09750028
097600*************************************************************     09760028
097700***  CHECK DEPT WITHIN STORE FOR RFID VERIFICATION WHEN INCLN_CDE 09770028
097800***  = 'E' FOR EXCLUDED.                                          09780028
097900*************************************************************     09790028
098000 2600-CHK-EXCLDED-DPT-WTHIN-STR.                                  09800028
098100                                                                  09810028
098200     MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR.                       09820028
098300                                                                  09830028
098400     SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE.                   09840028
098500                                                                  09850028
098600     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   09860028
098700                                                                  09870028
098800     EXEC SQL                                                     09880028
098900         SELECT A.INCLN_CDE                                       09890028
099000           INTO :PV-DEPT-WITHIN-STORE-IND                         09900028
099100           FROM RIT_RFID_VRFN  A                                  09910028
099200          WHERE A.STR_NBR        = :DK-LOC-NBR                    09920028
099300            AND A.DEPT_NBR       = :XLV00001-DEPT-NBR             09930028
099400            AND A.SUB_CL_NBR     =0                               09940028
099500            AND A.DC_LOC_NBR     =0                               09950028
099600            AND A.RFID_LVL_CDE   = 'STRDPT'                       09960028
099700            AND A.INCLN_CDE      = 'E'                            09970028
099800            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              09980028
099900            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              09990028
100000         WITH UR                                                  10000028
100100     END-EXEC.                                                    10010028
100200                                                                  10020028
100300     EVALUATE TRUE                                                10030028
100400         WHEN SQLCODE = ZERO                                      10040028
100500              SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE           10050028
100600              SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE           10060028
100700         WHEN SQLCODE = +100                                      10070028
100800              SET PS-DEPT-WITHIN-STORE-RFID-YES  TO TRUE          10080028
100900              SET SU093-RFID-KOHL-DPT-IN-STR-YES TO TRUE          10090028
101000         WHEN OTHER                                               10100028
101100              MOVE 25             TO SU093-ERROR-NBR              10110028
101200              MOVE SQLCODE        TO SU093-SQLCODE                10120028
101300              SET SU093-SQL-ERROR TO TRUE                         10130028
101400     END-EVALUATE.                                                10140028
101500                                                                  10150028
101600*************************************************************     10160028
101700***  CHECK DEPT WITHIN STORE FOR RFID VERIFICATION WHEN INCLN_CDE 10170028
101800***  = 'I' FOR INCLUDED.                                          10180028
101900*************************************************************     10190028
102000 2700-CHK-INCLDED-DPT-WTHIN-STR.                                  10200028
102100                                                                  10210028
102200     MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR.                       10220028
102300                                                                  10230028
102400     SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE.                   10240028
102500                                                                  10250028
102600     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   10260028
102700                                                                  10270028
102800     EXEC SQL                                                     10280028
102900         SELECT A.INCLN_CDE                                       10290028
103000           INTO :PV-DEPT-WITHIN-STORE-IND                         10300028
103100           FROM RIT_RFID_VRFN  A                                  10310028
103200          WHERE A.STR_NBR        = :DK-LOC-NBR                    10320028
103300            AND A.DEPT_NBR       = :XLV00001-DEPT-NBR             10330028
103400            AND A.SUB_CL_NBR     =0                               10340028
103500            AND A.DC_LOC_NBR     =0                               10350028
103600            AND A.RFID_LVL_CDE   = 'STRDPT'                       10360028
103700            AND A.INCLN_CDE      = 'I'                            10370028
103800            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              10380028
103900            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              10390028
104000         WITH UR                                                  10400028
104100     END-EXEC.                                                    10410028
104200                                                                  10420028
104300     EVALUATE TRUE                                                10430028
104400         WHEN SQLCODE = ZERO                                      10440028
104500              SET PS-DEPT-WITHIN-STORE-RFID-YES  TO TRUE          10450028
104600              SET SU093-RFID-KOHL-DPT-IN-STR-YES TO TRUE          10460028
104700         WHEN SQLCODE = +100                                      10470028
104800              SET PS-DEPT-WITHIN-STORE-RFID-NO   TO TRUE          10480028
104900              SET SU093-RFID-KOHL-DPT-IN-STR-NO  TO TRUE          10490028
105000         WHEN OTHER                                               10500028
105100              MOVE 45             TO SU093-ERROR-NBR              10510028
105200              MOVE SQLCODE        TO SU093-SQLCODE                10520028
105300              SET SU093-SQL-ERROR TO TRUE                         10530028
105400     END-EVALUATE.                                                10540028
105500                                                                  10550028
105600******************************************************************10560028
105700 3000-PROCESS-CASEPK-PREPK.                                       10570028
105800******************************************************************10580028
105900     MOVE SU093-KEY-PO                 TO RECITM-ORD-NBR.         10590028
106000     MOVE SU093-KEY-PREPK-ID           TO RECITM-PREPK-ID.        10600028
106100     MOVE SU093-KEY-REC-SEQ-NBR        TO RECITM-REC-SEQ-NBR.     10610028
106200     SET PS-NOT-EO-PREPK-UPC-CSR       TO TRUE.                   10620028
106300     SET PS-PREPACK-FIRST-FETCH-YES    TO TRUE.                   10630028
106400     SET PS-DEPT-SUBCL-RFID-NO         TO TRUE.                   10640028
106500     SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE.                   10650028
106600                                                                  10660028
106700     PERFORM 3100-OPEN-PREPK-CSR.                                 10670028
106800     PERFORM 3200-FETCH-PREPK-CSR                                 10680028
106900       UNTIL PS-EO-PREPK-UPC-CSR OR                               10690028
107000             PS-CHECK-FOR-RFID-DONE-YES.                          10700028
107100     PERFORM 3300-CLOSE-PREPK-CSR.                                10710028
107200                                                                  10720028
107300                                                                  10730028
107400     IF PS-DEPT-SUBCL-RFID-YES                                    10740028
107500*ABOVE LINE MEANS WE ALREADY KNOW THAT THE DEPT/SUBCL IS RFID     10750028
107600*FOLLOWING LINE MEANS IT'S NOT P2L SO CHECK FOR STORE IS DONE     10760028
107700        IF SU093-RFID-STR-CHK-NEEDED-YES                          10770028
107800           CONTINUE                                               10780028
107900        ELSE                                                      10790028
108000           MOVE PV-LINE-NUMBER TO RECITM-ORD-LNE-NBR              10800028
108100*STORE IN THE CARTON IS RFID.                                     10810028
108200           PERFORM 3550-CHECK-IF-RFID-STORE                       10820028
108300        END-IF                                                    10830028
108400     END-IF.                                                      10840028
108500                                                                  10850028
108600         IF SU093-RFID-STR-CHK-NEEDED-NO                          10860028
108700             AND PS-DEPT-SUBCL-RFID-YES                           10870028
108800                SET SU093-RFID-YES TO TRUE                        10880028
108900         ELSE                                                     10890028
109000             IF PS-DEPT-SUBCL-RFID-YES AND                        10900028
109100                PS-DEPT-WITHIN-STORE-RFID-YES                     10910028
109200                SET SU093-RFID-YES TO TRUE                        10920028
109300         END-IF.                                                  10930028
109400                                                                  10940028
109500******************************************************************10950028
109600 3100-OPEN-PREPK-CSR.                                             10960028
109700                                                                  10970028
109800         EXEC SQL                                                 10980028
109900              OPEN PREPK_INT_UPC_CSR                              10990028
110000         END-EXEC                                                 11000028
110100                                                                  11010028
110200         EVALUATE TRUE                                            11020028
110300             WHEN SQLCODE = ZERO                                  11030028
110400                 CONTINUE                                         11040028
110500         WHEN SQLCODE = -904                                      11050028
110600         WHEN SQLCODE = -913                                      11060028
110700         WHEN SQLCODE = -911                                      11070028
110800             MOVE 8                   TO SU093-ERROR-NBR          11080028
110900             MOVE SQLCODE             TO SU093-SQLCODE            11090028
111000             SET SU093-SQL-ERROR      TO TRUE                     11100028
111100         WHEN SQLWARN0 NOT = SPACES                               11110028
111200         WHEN SQLCODE NOT EQUAL ZERO                              11120028
111300             MOVE 9                   TO SU093-ERROR-NBR          11130028
111400             MOVE SQLCODE             TO SU093-SQLCODE            11140028
111500             SET SU093-SQL-ERROR      TO TRUE                     11150028
111600         END-EVALUATE.                                            11160028
111700                                                                  11170028
111800 EJECT                                                            11180028
111900*----------------------------------------------------------------*11190028
112000*                                                                *11200028
112100*----------------------------------------------------------------*11210028
112200 3200-FETCH-PREPK-CSR.                                            11220028
112300                                                                  11230028
112400     EXEC SQL                                                     11240028
112500        FETCH   PREPK_INT_UPC_CSR                                 11250028
112600        INTO   :RECITM-ITM-NBR                                    11260028
112700             , :RECITM-ORD-LNE-NBR                                11270028
112800             , :RECITM-PREPK-DRV-LNE-CDE                          11280028
112900     END-EXEC.                                                    11290028
113000                                                                  11300028
113100     EVALUATE TRUE                                                11310028
113200       WHEN SQLCODE = ZEROS                                       11320028
113300            PERFORM 8000-SEL-DPT-SCL-VS-NBR                       11330028
113400            PERFORM 8100-CHECK-DEPT                               11340028
113500            IF PS-PREPACK-FIRST-FETCH-YES                         11350028
113600                MOVE RECITM-ORD-LNE-NBR TO PV-LINE-NUMBER         11360028
113700                SET PS-PREPACK-FIRST-FETCH-NO TO TRUE             11370028
113800            END-IF                                                11380028
113900       WHEN SQLCODE = +100                                        11390028
114000            SET  PS-EO-PREPK-UPC-CSR TO TRUE                      11400028
114100       WHEN SQLCODE = -904                                        11410028
114200       WHEN SQLCODE = -913                                        11420028
114300       WHEN SQLCODE = -911                                        11430028
114400           MOVE 10                  TO SU093-ERROR-NBR            11440028
114500           MOVE SQLCODE             TO SU093-SQLCODE              11450028
114600           SET SU093-SQL-ERROR      TO TRUE                       11460028
114700       WHEN SQLWARN0 NOT = SPACES                                 11470028
114800       WHEN SQLCODE NOT EQUAL ZERO                                11480028
114900           MOVE 11                  TO SU093-ERROR-NBR            11490028
115000           MOVE SQLCODE             TO SU093-SQLCODE              11500028
115100           SET SU093-SQL-ERROR      TO TRUE                       11510028
115200     END-EVALUATE.                                                11520028
115300                                                                  11530028
115400*----------------------------------------------------------------*11540028
115500*                                                                *11550028
115600*----------------------------------------------------------------*11560028
115700 3300-CLOSE-PREPK-CSR.                                            11570028
115800                                                                  11580028
115900         EXEC SQL                                                 11590028
116000             CLOSE PREPK_INT_UPC_CSR                              11600028
116100         END-EXEC                                                 11610028
116200                                                                  11620028
116300         EVALUATE TRUE                                            11630028
116400             WHEN SQLCODE = ZERO                                  11640028
116500                 CONTINUE                                         11650028
116600             WHEN SQLWARN0 NOT = SPACES                           11660028
116700             WHEN SQLCODE < ZERO                                  11670028
116800             WHEN SQLCODE > ZERO                                  11680028
116900                MOVE 12                  TO SU093-ERROR-NBR       11690028
117000                MOVE SQLCODE             TO SU093-SQLCODE         11700028
117100                SET SU093-SQL-ERROR      TO TRUE                  11710028
117200         END-EVALUATE.                                            11720028
117300                                                                  11730028
117400*----------------------------------------------------------------*11740028
117500*                                                                *11750028
117600*----------------------------------------------------------------*11760028
117700 3500-PROCESS-CASEPK.                                             11770028
117800                                                                  11780028
117900     PERFORM 8000-SEL-DPT-SCL-VS-NBR.                             11790028
118000     PERFORM 8100-CHECK-DEPT                                      11800028
118100                                                                  11810028
118200**   DO NOT CHECK EACH STORE IF THE ITEMS ARE NOT RFID            11820028
118300     IF PS-DEPT-SUBCL-RFID-YES                                    11830028
118400        IF SU093-RFID-STR-CHK-NEEDED-YES                          11840028
118500           PERFORM 3575-CHK-STORE-DPT-RFID                        11850028
118600        END-IF                                                    11860028
118700     ELSE                                                         11870028
118800         MOVE SU093-KEY-PO            TO RECITM-ORD-NBR           11880028
118900         MOVE SU093-KEY-LNE-NBR       TO RECITM-ORD-LNE-NBR       11890028
119000         MOVE SU093-KEY-REC-SEQ-NBR   TO RECITM-REC-SEQ-NBR       11900028
119100*NEXT LINE MEANS IT'S P2L SO THIS CHECK THAT AT LEAST ONE         11910028
119200*STORE IN THE CARTON IS RFID IS NEEDED                            11920028
119300         PERFORM 3550-CHECK-IF-RFID-STORE                         11930028
119400     END-IF.                                                      11940028
119500                                                                  11950028
119600         IF SU093-RFID-STR-CHK-NEEDED-NO                          11960028
119700             AND PS-DEPT-SUBCL-RFID-YES                           11970028
119800                SET SU093-RFID-YES TO TRUE                        11980028
119900         ELSE                                                     11990028
120000             IF PS-DEPT-SUBCL-RFID-YES AND                        12000028
120100                PS-DEPT-WITHIN-STORE-RFID-YES                     12010028
120200                SET SU093-RFID-YES TO TRUE                        12020028
120300         END-IF.                                                  12030028
120400                                                                  12040028
120500*        IF PS-DEPT-SUBCL-RFID-YES                                12050028
120600*           SET SU093-RFID-YES TO TRUE                            12060028
120700*        END-IF                                                   12070028
120800                                                                  12080028
120900*----------------------------------------------------------------*12090028
121000* CHECK EACH STORE IN P2L CARTON TO SEE IF AT LEAST ONE IS RFID  *12100028
121100*----------------------------------------------------------------*12110028
121200 3550-CHECK-IF-RFID-STORE.                                        12120028
121300                                                                  12130028
121400         SET PS-NOT-EO-P2L-STORE-CSR TO TRUE                      12140028
121500         PERFORM 3560-OPEN-P2L-STR-DPT-CSR                        12150028
121600         PERFORM 3565-FETCH-P2L-STR-DPT-CSR                       12160028
121700           UNTIL PS-EO-P2L-STORE-CSR    OR                        12170028
121800                 PS-CHECK-FOR-RFID-DONE-YES                       12180028
121900         PERFORM 3570-CLOSE-P2L-STR-DPT-CSR.                      12190028
122000                                                                  12200028
122100*----------------------------------------------------------------*12210028
122200* OPEN PACK TO LIGHT STORE DEPT CURSOR TO IDENTIY STORES THAT ARE 12220028
122300* RFID                                                            12230028
122400*----------------------------------------------------------------*12240028
122500 3560-OPEN-P2L-STR-DPT-CSR.                                       12250028
122600                                                                  12260028
122700         EXEC SQL                                                 12270028
122800              OPEN P2L_STORE_CSR                                  12280028
122900         END-EXEC                                                 12290028
123000                                                                  12300028
123100         EVALUATE TRUE                                            12310028
123200             WHEN SQLCODE = ZERO                                  12320028
123300                 CONTINUE                                         12330028
123400         WHEN SQLCODE = -904                                      12340028
123500         WHEN SQLCODE = -913                                      12350028
123600         WHEN SQLCODE = -911                                      12360028
123700             MOVE 49                  TO SU093-ERROR-NBR          12370028
123800             MOVE SQLCODE             TO SU093-SQLCODE            12380028
123900             SET SU093-SQL-ERROR      TO TRUE                     12390028
124000         WHEN SQLWARN0 NOT = SPACES                               12400028
124100         WHEN SQLCODE NOT EQUAL ZERO                              12410028
124200             MOVE 50                  TO SU093-ERROR-NBR          12420028
124300             MOVE SQLCODE             TO SU093-SQLCODE            12430028
124400             SET SU093-SQL-ERROR      TO TRUE                     12440028
124500         END-EVALUATE.                                            12450028
124600                                                                  12460028
124700*----------------------------------------------------------------*12470028
124800* FETCH PACK TO LIGHT STORE DEPT CURSOR TO IDENTIY STORES THAT ARE12480028
124900* RFID                                                            12490028
125000*----------------------------------------------------------------*12500028
125100 3565-FETCH-P2L-STR-DPT-CSR.                                      12510028
125200                                                                  12520028
125300     EXEC SQL                                                     12530028
125400        FETCH   P2L_STORE_CSR                                     12540028
125500        INTO   :RECDIS-STR-NBR                                    12550028
125600     END-EXEC.                                                    12560028
125700                                                                  12570028
125800     EVALUATE TRUE                                                12580028
125900       WHEN SQLCODE = ZEROS                                       12590028
126000            PERFORM 3575-CHK-STORE-DPT-RFID                       12600028
126100       WHEN SQLCODE = +100                                        12610028
126200            SET  PS-EO-P2L-STORE-CSR TO TRUE                      12620028
126300       WHEN SQLCODE = -904                                        12630028
126400       WHEN SQLCODE = -913                                        12640028
126500       WHEN SQLCODE = -911                                        12650028
126600           MOVE 5                   TO SU093-ERROR-NBR            12660028
126700           MOVE SQLCODE             TO SU093-SQLCODE              12670028
126800           SET SU093-SQL-ERROR      TO TRUE                       12680028
126900       WHEN SQLWARN0 NOT = SPACES                                 12690028
127000       WHEN SQLCODE NOT EQUAL ZERO                                12700028
127100           MOVE 6                   TO SU093-ERROR-NBR            12710028
127200           MOVE SQLCODE             TO SU093-SQLCODE              12720028
127300           SET SU093-SQL-ERROR      TO TRUE                       12730028
127400     END-EVALUATE.                                                12740028
127500                                                                  12750028
127600*----------------------------------------------------------------*12760028
127700* CLOSE PACK TO LIGHT STORE DEPT CURSOR TO IDENTIY STORES THAT ARE12770028
127800* RFID                                                            12780028
127900*----------------------------------------------------------------*12790028
128000 3570-CLOSE-P2L-STR-DPT-CSR.                                      12800028
128100                                                                  12810028
128200         EXEC SQL                                                 12820028
128300             CLOSE P2L_STORE_CSR                                  12830028
128400         END-EXEC                                                 12840028
128500                                                                  12850028
128600         EVALUATE TRUE                                            12860028
128700             WHEN SQLCODE = ZERO                                  12870028
128800                 CONTINUE                                         12880028
128900             WHEN SQLWARN0 NOT = SPACES                           12890028
129000             WHEN SQLCODE < ZERO                                  12900028
129100             WHEN SQLCODE > ZERO                                  12910028
129200                MOVE 18                  TO SU093-ERROR-NBR       12920028
129300                MOVE SQLCODE             TO SU093-SQLCODE         12930028
129400                SET SU093-SQL-ERROR      TO TRUE                  12940028
129500         END-EVALUATE.                                            12950028
129600                                                                  12960028
129700*----------------------------------------------------------------*12970028
129800* CHECK IF AT LEAST ONE PACK TO LIGHT STORE/DEPT IS RFID          12980028
129900*----------------------------------------------------------------*12990028
130000 3575-CHK-STORE-DPT-RFID.                                         13000028
130100                                                                  13010028
130200     PERFORM 8000-SEL-DPT-SCL-VS-NBR.                             13020028
130300     PERFORM 8100-CHECK-DEPT.                                     13030028
130400                                                                  13040028
130500     PERFORM 2500-CHECK-BY-DPT-WITHIN-STORE.                      13050028
130600                                                                  13060028
130700     IF PS-DEPT-WITHIN-STORE-RFID-YES  OR                         13070028
130800        SU093-RFID-KOHL-DPT-IN-STR-YES                            13080028
130900        MOVE 'Y' TO PS-CHECK-FOR-RFID-DONE-SW                     13090028
131000     END-IF.                                                      13100028
131100                                                                  13110028
131200******************************************************************13120028
131300 4000-PROCESS-SMOOTHING.                                          13130028
131400******************************************************************13140028
131500                                                                  13150028
131600**   DO NOT CONTINUE PROCESSING IF STORE IS NOT RFID              13160028
131700*    IF PS-STORE-RFID-YES                                         13170028
131800         MOVE SU093-KEY-PO            TO RECITM-ORD-NBR           13180028
131900         MOVE SU093-KEY-REC-SEQ-NBR   TO RECITM-REC-SEQ-NBR       13190028
132000         MOVE SU093-KEY-DEST-LOC      TO RECDIS-STR-NBR           13200028
132100         SET PS-NOT-EO-STORE-UPC-CSR  TO TRUE                     13210028
132200         PERFORM 4100-OPEN-STORE-CSR                              13220028
132300         PERFORM 4200-FETCH-STORE-CSR                             13230028
132400           UNTIL PS-EO-STORE-UPC-CSR OR                           13240028
132500                 PS-CHECK-FOR-RFID-DONE-YES                       13250028
132600         PERFORM 4300-CLOSE-STORE-CSR.                            13260028
132700                                                                  13270028
132800         IF SU093-RFID-STR-CHK-NEEDED-NO                          13280028
132900             IF PS-DEPT-SUBCL-RFID-YES                            13290028
133000                SET SU093-RFID-YES TO TRUE                        13300028
133100             END-IF                                               13310028
133200         ELSE                                                     13320028
133300             IF PS-DEPT-SUBCL-RFID-YES AND                        13330028
133400                PS-DEPT-WITHIN-STORE-RFID-YES                     13340028
133500                SET SU093-RFID-YES TO TRUE                        13350028
133600             END-IF                                               13360028
133700         END-IF.                                                  13370028
133800                                                                  13380028
133900                                                                  13390028
134000******************************************************************13400028
134100 4100-OPEN-STORE-CSR.                                             13410028
134200                                                                  13420028
134300         EXEC SQL                                                 13430028
134400              OPEN STORE_UPC_CSR                                  13440028
134500         END-EXEC.                                                13450028
134600                                                                  13460028
134700         EVALUATE TRUE                                            13470028
134800             WHEN SQLCODE = ZERO                                  13480028
134900                 CONTINUE                                         13490028
135000         WHEN SQLCODE = -904                                      13500028
135100         WHEN SQLCODE = -913                                      13510028
135200         WHEN SQLCODE = -911                                      13520028
135300             MOVE 14                  TO SU093-ERROR-NBR          13530028
135400             MOVE SQLCODE             TO SU093-SQLCODE            13540028
135500             SET SU093-SQL-ERROR      TO TRUE                     13550028
135600         WHEN SQLWARN0 NOT = SPACES                               13560028
135700         WHEN SQLCODE NOT EQUAL ZERO                              13570028
135800             MOVE 15                  TO SU093-ERROR-NBR          13580028
135900             MOVE SQLCODE             TO SU093-SQLCODE            13590028
136000             SET SU093-SQL-ERROR      TO TRUE                     13600028
136100         END-EVALUATE.                                            13610028
136200                                                                  13620028
136300*----------------------------------------------------------------*13630028
136400*                                                                *13640028
136500*----------------------------------------------------------------*13650028
136600 4200-FETCH-STORE-CSR.                                            13660028
136700                                                                  13670028
136800     EXEC SQL                                                     13680028
136900        FETCH   STORE_UPC_CSR                                     13690028
137000        INTO   :RECITM-ITM-NBR                                    13700028
137100     END-EXEC.                                                    13710028
137200                                                                  13720028
137300     EVALUATE TRUE                                                13730028
137400       WHEN SQLCODE = ZEROS                                       13740028
137500            PERFORM 8000-SEL-DPT-SCL-VS-NBR                       13750028
137600            PERFORM 8100-CHECK-DEPT                               13760028
137700       WHEN SQLCODE = +100                                        13770028
137800                SET  PS-EO-STORE-UPC-CSR TO TRUE                  13780028
137900       WHEN SQLCODE = -904                                        13790028
138000       WHEN SQLCODE = -913                                        13800028
138100       WHEN SQLCODE = -911                                        13810028
138200           MOVE 16                  TO SU093-ERROR-NBR            13820028
138300           MOVE SQLCODE             TO SU093-SQLCODE              13830028
138400           SET SU093-SQL-ERROR      TO TRUE                       13840028
138500       WHEN SQLWARN0 NOT = SPACES                                 13850028
138600       WHEN SQLCODE NOT EQUAL ZERO                                13860028
138700           MOVE 17                  TO SU093-ERROR-NBR            13870028
138800           MOVE SQLCODE             TO SU093-SQLCODE              13880028
138900           SET SU093-SQL-ERROR      TO TRUE                       13890028
139000     END-EVALUATE.                                                13900028
139100                                                                  13910028
139200 4300-CLOSE-STORE-CSR.                                            13920028
139300                                                                  13930028
139400         EXEC SQL                                                 13940028
139500             CLOSE STORE_UPC_CSR                                  13950028
139600         END-EXEC                                                 13960028
139700                                                                  13970028
139800         EVALUATE TRUE                                            13980028
139900             WHEN SQLCODE = ZERO                                  13990028
140000                 CONTINUE                                         14000028
140100             WHEN SQLWARN0 NOT = SPACES                           14010028
140200             WHEN SQLCODE < ZERO                                  14020028
140300             WHEN SQLCODE > ZERO                                  14030028
140400                MOVE 18                  TO SU093-ERROR-NBR       14040028
140500                MOVE SQLCODE             TO SU093-SQLCODE         14050028
140600                SET SU093-SQL-ERROR      TO TRUE                  14060028
140700         END-EVALUATE.                                            14070028
140800                                                                  14080028
140900 5000-PROCESS-OUTBOUND-CTN.                                       14090028
141000                                                                  14100028
141100**   DO NOT CONTINUE PROCESSING IF STORE IS NOT RFID              14110028
141200*    IF PS-STORE-RFID-YES                                         14120028
141300         MOVE SU093-KEY-CARTON-ID    TO SUT00028-SHIPT-UNT-ID     14130028
141400         SET PS-NOT-EO-OTBND-UPC-CSR TO TRUE                      14140028
141500         PERFORM 5100-OPEN-OTBND-UPC-CSR                          14150028
141600         PERFORM 5200-FETCH-OTBND-UPC-CSR                         14160028
141700           UNTIL PS-EO-OTBND-UPC-CSR                              14170028
141800         PERFORM 5300-CLOSE-OTBND-UPC-CSR                         14180028
141900                                                                  14190028
142000         IF SU093-RFID-STR-CHK-NEEDED-NO                          14200028
142100             IF PS-DEPT-SUBCL-RFID-YES                            14210028
142200                SET SU093-RFID-YES TO TRUE                        14220028
142300             END-IF                                               14230028
142400         ELSE                                                     14240028
142500             IF PS-DEPT-SUBCL-RFID-YES AND                        14250028
142600                PS-DEPT-WITHIN-STORE-RFID-YES                     14260028
142700                SET SU093-RFID-YES TO TRUE                        14270028
142800             END-IF                                               14280028
142900         END-IF.                                                  14290028
143000                                                                  14300028
143100*CLP 04/14/14 - START                                             14310028
143200         IF SU093-IR-NEEDS-DC-TAGGING-YES                         14320028
143300            SET SU093-RFID-YES TO TRUE                            14330028
143400         END-IF.                                                  14340028
143500*CLP 04/14/14 - END                                               14350028
143600                                                                  14360028
143700******************************************************************14370028
143800 5100-OPEN-OTBND-UPC-CSR.                                         14380028
143900                                                                  14390028
144000         EXEC SQL                                                 14400028
144100              OPEN ITEM_UPC_CSR_OTBND                             14410028
144200         END-EXEC                                                 14420028
144300                                                                  14430028
144400         EVALUATE TRUE                                            14440028
144500             WHEN SQLCODE = ZERO                                  14450028
144600                 CONTINUE                                         14460028
144700         WHEN SQLCODE = -904                                      14470028
144800         WHEN SQLCODE = -913                                      14480028
144900         WHEN SQLCODE = -911                                      14490028
145000             MOVE 19                  TO SU093-ERROR-NBR          14500028
145100             MOVE SQLCODE             TO SU093-SQLCODE            14510028
145200             SET SU093-SQL-ERROR      TO TRUE                     14520028
145300         WHEN SQLWARN0 NOT = SPACES                               14530028
145400         WHEN SQLCODE NOT EQUAL ZERO                              14540028
145500             MOVE 20                  TO SU093-ERROR-NBR          14550028
145600             MOVE SQLCODE             TO SU093-SQLCODE            14560028
145700             SET SU093-SQL-ERROR      TO TRUE                     14570028
145800         END-EVALUATE.                                            14580028
145900                                                                  14590028
146000*----------------------------------------------------------------*14600028
146100*                                                                *14610028
146200*----------------------------------------------------------------*14620028
146300 5200-FETCH-OTBND-UPC-CSR.                                        14630028
146400                                                                  14640028
146500     EXEC SQL                                                     14650028
146600        FETCH   ITEM_UPC_CSR_OTBND                                14660028
146700        INTO   :SUT00028-UPC-NBR                                  14670028
146710           ,   :SUT00028-TRN-NBR                                  14671065
146800     END-EXEC.                                                    14680028
146900                                                                  14690028
147000     EVALUATE TRUE                                                14700028
147100       WHEN SQLCODE = ZEROS                                       14710028
147200            PERFORM 8000-SEL-DPT-SCL-VS-NBR                       14720028
147300            PERFORM 8100-CHECK-DEPT                               14730028
147400*CLP 11/15/13                                                     14740028
147500            PERFORM 8300-CHECK-IR-TAGGING                         14750028
147600*CLP 11/15/13                                                     14760028
147700       WHEN SQLCODE = +100                                        14770028
147800            SET  PS-EO-OTBND-UPC-CSR TO TRUE                      14780028
147900       WHEN SQLCODE = -904                                        14790028
148000       WHEN SQLCODE = -913                                        14800028
148100       WHEN SQLCODE = -911                                        14810028
148200           MOVE 21                  TO SU093-ERROR-NBR            14820028
148300           MOVE SQLCODE             TO SU093-SQLCODE              14830028
148400           SET SU093-SQL-ERROR      TO TRUE                       14840028
148500       WHEN SQLWARN0 NOT = SPACES                                 14850028
148600       WHEN SQLCODE NOT EQUAL ZERO                                14860028
148700           MOVE 22                  TO SU093-ERROR-NBR            14870028
148800           MOVE SQLCODE             TO SU093-SQLCODE              14880028
148900           SET SU093-SQL-ERROR      TO TRUE                       14890028
149000     END-EVALUATE.                                                14900028
149100                                                                  14910028
149200 5300-CLOSE-OTBND-UPC-CSR.                                        14920028
149300                                                                  14930028
149400         EXEC SQL                                                 14940028
149500             CLOSE ITEM_UPC_CSR_OTBND                             14950028
149600         END-EXEC                                                 14960028
149700                                                                  14970028
149800         EVALUATE TRUE                                            14980028
149900             WHEN SQLCODE = ZERO                                  14990028
150000                 CONTINUE                                         15000028
150100             WHEN SQLWARN0 NOT = SPACES                           15010028
150200             WHEN SQLCODE < ZERO                                  15020028
150300             WHEN SQLCODE > ZERO                                  15030028
150400                MOVE 23                  TO SU093-ERROR-NBR       15040028
150500                MOVE SQLCODE             TO SU093-SQLCODE         15050028
150600                SET SU093-SQL-ERROR      TO TRUE                  15060028
150700         END-EVALUATE.                                            15070028
150800                                                                  15080028
150900******************************************************************15090028
151000 6000-PROCESS-PACK-TO-LIGHT.                                      15100028
151100******************************************************************15110028
151200**   DO NOT CONTINUE PROCESSING IF STORE IS NOT RFID              15120028
151300*    IF PS-STORE-RFID-YES                                         15130028
151400         MOVE SU093-KEY-PO            TO RECITM-ORD-NBR           15140028
151500         MOVE SU093-KEY-REC-SEQ-NBR   TO RECITM-REC-SEQ-NBR       15150028
151600         MOVE SU093-KEY-LNE-NBR       TO RECITM-ORD-LNE-NBR       15160028
151700                                                                  15170028
151800         EXEC SQL                                                 15180028
151900            SELECT ITM_NBR                                        15190028
152000             INTO  :RECITM-ITM-NBR                                15200028
152100             FROM  TRECITM                                        15210028
152200             WHERE ORD_NBR        = :RECITM-ORD-NBR               15220028
152300               AND REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR           15230028
152400               AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR           15240028
152500             WITH UR                                              15250028
152600         END-EXEC                                                 15260028
152700                                                                  15270028
152800         EVALUATE TRUE                                            15280028
152900           WHEN SQLCODE = ZEROS                                   15290028
153000                PERFORM 8000-SEL-DPT-SCL-VS-NBR                   15300028
153100                PERFORM 8100-CHECK-DEPT                           15310028
153200           WHEN SQLCODE = +100                                    15320028
153300                CONTINUE                                          15330028
153400           WHEN OTHER                                             15340028
153500                MOVE 24             TO SU093-ERROR-NBR            15350028
153600                MOVE SQLCODE             TO SU093-SQLCODE         15360028
153700                SET SU093-SQL-ERROR      TO TRUE                  15370028
153800         END-EVALUATE.                                            15380028
153900                                                                  15390028
154000         IF SU093-RFID-STR-CHK-NEEDED-NO                          15400028
154100             IF PS-DEPT-SUBCL-RFID-YES                            15410028
154200                SET SU093-RFID-YES TO TRUE                        15420028
154300             END-IF                                               15430028
154400         ELSE                                                     15440028
154500             IF PS-DEPT-SUBCL-RFID-YES                            15450028
154600                PERFORM 2500-CHECK-BY-DPT-WITHIN-STORE            15460028
154700                IF PS-DEPT-WITHIN-STORE-RFID-YES                  15470028
154800                   SET SU093-RFID-YES TO TRUE                     15480028
154900                END-IF                                            15490028
155000             END-IF                                               15500028
155100         END-IF.                                                  15510028
155200                                                                  15520028
155300                                                                  15530028
155400*CLP 09/12/13 BEGIN                                               15540028
155500*----------------------------------------------------------------*15550028
155600*                                                                *15560028
155700*----------------------------------------------------------------*15570028
155800 6100-PROCESS-PO-LEVEL-CHECK.                                     15580028
155900     SET PS-NOT-PO-LEVEL-CSR TO TRUE.                             15590028
156000     MOVE SU093-KEY-PO       TO PURCHS-PO-NBR.                    15600028
156100     PERFORM 6110-OPEN-PO-LEVEL-CSR.                              15610028
156200     PERFORM 6120-FETCH-PO-LEVEL-CSR                              15620028
156300        UNTIL PS-PO-LEVEL-CSR    OR                               15630028
156400              PS-CHECK-FOR-RFID-DONE-YES.                         15640028
156500     PERFORM 6130-CLOSE-PO-LEVEL-CSR.                             15650028
156600*----------------------------------------------------------------*15660028
156700* OPEN PO LEVEL CURSOR                                            15670028
156800*----------------------------------------------------------------*15680028
156900 6110-OPEN-PO-LEVEL-CSR.                                          15690028
157000                                                                  15700028
157100         EXEC SQL                                                 15710028
157200              OPEN PO_LEVEL_CSR                                   15720028
157300         END-EXEC                                                 15730028
157400                                                                  15740028
157500         EVALUATE TRUE                                            15750028
157600             WHEN SQLCODE = ZERO                                  15760028
157700                 CONTINUE                                         15770028
157800         WHEN SQLCODE = -904                                      15780028
157900         WHEN SQLCODE = -913                                      15790028
158000         WHEN SQLCODE = -911                                      15800028
158100             MOVE 53                  TO SU093-ERROR-NBR          15810028
158200             MOVE SQLCODE             TO SU093-SQLCODE            15820028
158300             SET SU093-SQL-ERROR      TO TRUE                     15830028
158400         WHEN SQLWARN0 NOT = SPACES                               15840028
158500         WHEN SQLCODE NOT EQUAL ZERO                              15850028
158600             MOVE 54                  TO SU093-ERROR-NBR          15860028
158700             MOVE SQLCODE             TO SU093-SQLCODE            15870028
158800             SET SU093-SQL-ERROR      TO TRUE                     15880028
158900         END-EVALUATE.                                            15890028
159000                                                                  15900028
159100*----------------------------------------------------------------*15910028
159200* FETCH                                                           15920028
159300*----------------------------------------------------------------*15930028
159400 6120-FETCH-PO-LEVEL-CSR.                                         15940028
159500                                                                  15950028
159600     EXEC SQL                                                     15960028
159700        FETCH   PO_LEVEL_CSR                                      15970028
159800        INTO   :PV-DEPT-NO                                        15980028
159900              ,:XLV00001-ENT-ID                                   15990028
160000              ,:XLV00001-SUB-CL-NBR                               16000028
160100     END-EXEC.                                                    16010028
160200                                                                  16020028
160300     EVALUATE TRUE                                                16030028
160400       WHEN SQLCODE = ZEROS                                       16040028
160500            PERFORM 6140-MOVE-VALUES                              16050028
160600       WHEN SQLCODE = +100                                        16060028
160700            SET  PS-PO-LEVEL-CSR TO TRUE                          16070028
160800       WHEN SQLCODE = -904                                        16080028
160900       WHEN SQLCODE = -913                                        16090028
161000       WHEN SQLCODE = -911                                        16100028
161100           MOVE 54                  TO SU093-ERROR-NBR            16110028
161200           MOVE SQLCODE             TO SU093-SQLCODE              16120028
161300           SET SU093-SQL-ERROR      TO TRUE                       16130028
161400       WHEN SQLWARN0 NOT = SPACES                                 16140028
161500       WHEN SQLCODE NOT EQUAL ZERO                                16150028
161600           MOVE 55                  TO SU093-ERROR-NBR            16160028
161700           MOVE SQLCODE             TO SU093-SQLCODE              16170028
161800           SET SU093-SQL-ERROR      TO TRUE                       16180028
161900     END-EVALUATE.                                                16190028
162000                                                                  16200028
162100                                                                  16210028
162200*----------------------------------------------------------------*16220028
162300* CLOSE PO LEVEL CHECK CURSOR                                     16230028
162400*----------------------------------------------------------------*16240028
162500 6130-CLOSE-PO-LEVEL-CSR.                                         16250028
162600                                                                  16260028
162700         EXEC SQL                                                 16270028
162800             CLOSE PO_LEVEL_CSR                                   16280028
162900         END-EXEC                                                 16290028
163000                                                                  16300028
163100         EVALUATE TRUE                                            16310028
163200             WHEN SQLCODE = ZERO                                  16320028
163300                 CONTINUE                                         16330028
163400             WHEN SQLWARN0 NOT = SPACES                           16340028
163500             WHEN SQLCODE < ZERO                                  16350028
163600             WHEN SQLCODE > ZERO                                  16360028
163700                MOVE 56                  TO SU093-ERROR-NBR       16370028
163800                MOVE SQLCODE             TO SU093-SQLCODE         16380028
163900                SET SU093-SQL-ERROR      TO TRUE                  16390028
164000         END-EVALUATE.                                            16400028
164100                                                                  16410028
164200 6140-MOVE-VALUES.                                                16420028
164300     MOVE PV-DEPT-NO-R        TO XLV00001-DEPT-NBR.               16430028
164400** THE 8100-CHECK-DEPT WILL CHECK TO SEE IF THE DEPARTMENT        16440028
164500** FOR THE PO IS ELIGIBLE FOR RFID TAGGING CHECKS.                16450028
164600     PERFORM 8100-CHECK-DEPT.                                     16460028
164601     PERFORM 6200-CHECK-RFID-DEPT-TAG.                            16460154
164602     IF PS-EAS-DC-TAGGING-YES                                     16460254
164610        PERFORM 8900-CHK-EAS-TAGGING                              16461054
164620     END-IF.                                                      16462054
164700**GB 09/20/15 BEG EAS                                             16470028
164800     IF PS-DEPT-SUBCL-RFID-NO                                     16480028
165100        IF PS-EAS-TAGGING-FOR-DEPT-YES                            16510054
165200           SET PS-CHECK-FOR-RFID-DONE-YES                         16520054
165300               SU093-RFID-YES                                     16530054
165400               SU093-DC-DEPT-TAGS-YES                             16540054
165500               SU093-RFID-KOHL-DPT-IN-STR-YES                     16550054
165600               SU093-RFID-KOHL-DEPT-SUBCL-YES TO TRUE             16560054
165700        ELSE                                                      16570054
165800           SET SU093-RFID-NO TO TRUE                              16580054
165900        END-IF                                                    16590054
166300**GB 09/20/15 END EAS                                             16630028
166400     ELSE                                                         16640028
166500        IF PS-DC-RFID-YES AND PS-RFID-DC-DEPT-TAGGING-YES         16650053
166600           SET SU093-RFID-YES TO TRUE                             16660053
166700        ELSE                                                      16670028
166710          IF PS-EAS-TAGGING-FOR-DEPT-YES                          16671054
166720             SET PS-CHECK-FOR-RFID-DONE-YES                       16672054
166730                 SU093-RFID-YES                                   16673054
166740                 SU093-DC-DEPT-TAGS-YES                           16674054
166750                 SU093-RFID-KOHL-DPT-IN-STR-YES                   16675054
166760                 SU093-RFID-KOHL-DEPT-SUBCL-YES TO TRUE           16676056
166770          ELSE                                                    16677054
166780             SET SU093-RFID-NO TO TRUE                            16678054
166790          END-IF                                                  16679054
166900        END-IF                                                    16690054
167000     END-IF.                                                      16700028
167100                                                                  16710028
167200*CLP 04/09/15 START                                               16720028
167300***************************************************************   16730028
167400***  FOR NON AUTO DC'S DO NOT PRINT MESSAGE LABEL IF THE CARTON   16740028
167500***  IS RFID AND THE FINAL DESTINATION IS PACK TO LIGHT.          16750028
167600***************************************************************   16760028
167700 6150-CHECK-NON-AUTO-P2L.                                         16770028
167800** RPK 1/6/17 - COMMENTED OUT THE FOLLOWING 1 LINE                16780028
167900*    SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   16790028
168000                                                                  16800028
168100     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     16810028
168200                                                                  16820028
168300                                                                  16830028
168400     EXEC SQL                                                     16840028
168500         SELECT FUNC_TXT                                          16850028
168600           INTO :KRPRPM-FUNC-TXT                                  16860028
168700         FROM TKRPRPM                                             16870028
168800         WHERE LOC_ID            =  :DK-DC-NBR                    16880028
168900           AND INTFC_SYS_CDE     =  'RIK'                         16890028
169000           AND SYS_PRC_FUNC_CDE  =  'P2LFST'                      16900028
169100           AND FUNC_PRC_STAT_CDE =  'AC'                          16910028
169200           AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP             16920028
169300           AND FUNC_END_TMST    >=  CURRENT TIMESTAMP             16930028
169400         WITH UR                                                  16940028
169500     END-EXEC.                                                    16950028
169600                                                                  16960028
169700     EVALUATE TRUE                                                16970028
169800** RPK 1/6/17 - COMMENTED OUT THE FOLLOWING 8 LINES               16980028
169900*        WHEN SQLCODE = ZERO                                      16990028
170000*             IF  KRPRPM-FUNC-TXT = 'Y'                           17000028
170100*                 SET PS-CREATE-CART-LBL-FOR-P2L-YES TO TRUE      17010028
170200*             ELSE                                                17020028
170300*                 SET PS-CREATE-CART-LBL-FOR-P2L-NO  TO TRUE      17030028
170400*             END-IF                                              17040028
170500*        WHEN SQLCODE = +100                                      17050028
170600*             SET PS-CREATE-CART-LBL-FOR-P2L-NO  TO TRUE          17060028
170700** RPK 1/6/17 - REPLACED THE ABOVE COMMENTED LINES WITH THE       17070028
170800**              FOLLOWING 6 LINES                                 17080028
170900         WHEN SQLCODE = ZERO                                      17090028
171000              IF  KRPRPM-FUNC-TXT = 'Y'                           17100028
171100                  SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE       17110028
171200              END-IF                                              17120028
171300         WHEN SQLCODE = +100                                      17130028
171400              CONTINUE                                            17140028
171500         WHEN OTHER                                               17150028
171600              MOVE 60             TO SU093-ERROR-NBR              17160028
171700              MOVE SQLCODE        TO SU093-SQLCODE                17170028
171800              SET SU093-SQL-ERROR TO TRUE                         17180028
171900     END-EVALUATE.                                                17190028
171910***************************************************************   17191053
171920***  DC LEVEL CHECK TO DETERMINE IF SU093-RFID-YES FLAG SHOULD    17192058
171930***  BE OVERRIDEN BEFORE BEING PASSED BACK TO THE RECEIVER        17193058
171931***  CREATE PROGRAM(RCKCS234). IF RFID-YES,THEN 424 RFID TROUBLE  17193158
171932***  WILL BE CREATED. THE RFID CHECK AT SU093-PO-LEVEL-CHECK      17193258
171933***  IS AT THE DEPT/SCL LEVEL, NOT AT THE DC LEVEL                17193358
171940***************************************************************   17194053
171950 6200-CHECK-RFID-DEPT-TAG.                                        17195053
171960                                                                  17196053
171970     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     17197053
171980                                                                  17198053
171990                                                                  17199053
171991     EXEC SQL                                                     17199153
171992         SELECT FUNC_TXT                                          17199253
171993           INTO :KRPRPM-FUNC-TXT                                  17199353
171994         FROM TKRPRPM                                             17199453
171995         WHERE LOC_ID            =  :DK-DC-NBR                    17199553
171996           AND INTFC_SYS_CDE     =  'KHL'                         17199653
171997           AND SYS_PRC_FUNC_CDE  =  'RFDDPT'                      17199753
171998           AND FUNC_PRC_STAT_CDE =  'AC'                          17199853
171999           AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP             17199953
172000           AND FUNC_END_TMST    >=  CURRENT TIMESTAMP             17200053
172001         WITH UR                                                  17200153
172002     END-EXEC.                                                    17200253
172003                                                                  17200353
172004     EVALUATE TRUE                                                17200453
172005         WHEN SQLCODE = ZERO                                      17200553
172006              MOVE KRPRPM-FUNC-TXT TO PS-RFID-DC-DEPT-TAGGING-SW  17200653
172007         WHEN SQLCODE = +100                                      17200753
172008              SET PS-RFID-DC-DEPT-TAGGING-NO TO TRUE              17200853
172009         WHEN OTHER                                               17200953
172010              MOVE 64             TO SU093-ERROR-NBR              17201053
172011              MOVE SQLCODE        TO SU093-SQLCODE                17201153
172012              SET SU093-SQL-ERROR TO TRUE                         17201253
172013     END-EVALUATE.                                                17201353
172014                                                                  17201453
172015                                                                  17201553
172020*----------------------------------------------------------------*17202028
172100*  SELECT DEPT, SUBCLASS, USING INPUT AVAILABLE                  *17210028
172200*----------------------------------------------------------------*17220028
172300 8000-SEL-DPT-SCL-VS-NBR.                                         17230028
172400                                                                  17240028
172500     EVALUATE TRUE                                                17250028
172600        WHEN SU093-CHECK-IN                                       17260028
172700        WHEN SU093-CARTON-STATUS AND SU093-INBOUND-CTN            17270028
172800           MOVE SHUUPC-UPC-NBR          TO XLV00003-UPC-NBR       17280028
172900           PERFORM 8400-SELECT-STYL-BY-UPC                        17290028
173000        WHEN SU093-CARTON-STATUS AND SU093-OUTBOUND-CTN           17300028
173100           MOVE SUT00028-UPC-NBR        TO XLV00003-UPC-NBR       17310028
173200           PERFORM 8400-SELECT-STYL-BY-UPC                        17320028
173300        WHEN SU093-CSEPK-SPLIT AND SU093-PREPK-ORDER-NO           17330028
173400           MOVE SU093-KEY-SKU-NBR       TO XLT00003-SKU-NBR       17340028
173500           PERFORM 8500-SELECT-STYL-BY-SKU                        17350028
173600        WHEN SU093-CSEPK-SPLIT AND SU093-PREPK-ORDER-YES          17360028
173700        WHEN SU093-SMOOTHING                                      17370028
173800        WHEN SU093-PACK-TO-LIGHT                                  17380028
173900           MOVE RECITM-ITM-NBR          TO XLT00003-ITM-NBR       17390028
174000           PERFORM 8600-SELECT-STYL-BY-ITM                        17400028
174100     END-EVALUATE.                                                17410028
174200     PERFORM 8700-SLCT-DPT-SUBCL-VS-BY-STYL.                      17420028
174300     IF SU093-RFID-STR-CHK-NEEDED-YES OR                          17430028
174400        SU093-CHECK-BY-DEPT-IN-STR-YES                            17440028
174500        OR SU093-P2L-CHK-IN-YES                                   17450028
174600        PERFORM 2500-CHECK-BY-DPT-WITHIN-STORE                    17460028
174700     ELSE                                                         17470028
174800        SET PS-DEPT-WITHIN-STORE-RFID-NO  TO TRUE                 17480028
174900        SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE                 17490028
175000     END-IF.                                                      17500028
175100                                                                  17510028
175200**GB 09/20/15 EAS BEG                                             17520028
175300     IF  PS-EAS-DC-TAGGING-YES                                    17530028
175400     AND PS-DEPT-ENT-ID-FOUND-YES                                 17540028
175500     AND PS-EAS-TAGGING-FOR-DEPT-NO                               17550051
175600        PERFORM 8950-CHECK-FOR-EFC-STORE                          17560028
175700        IF PS-EFC-STORE-LOCATION-NO                               17570051
175800           PERFORM 8900-CHK-EAS-TAGGING                           17580028
175900        END-IF                                                    17590051
176000     END-IF.                                                      17600028
176100**GB 09/20/15 EAS BEG                                             17610028
176200*----------------------------------------------------------------*17620028
176300*  CHECK TO SEE IF THE DEPT WITHOUT ANY SUBCLASS EXCEPTIONS IS    17630028
176400*  ON THE TABLE.                                                  17640028
176500*----------------------------------------------------------------*17650028
176600 8100-CHECK-DEPT.                                                 17660028
176700                                                                  17670028
176800     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   17680028
176900                                                                  17690028
177000     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    17700028
177100     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR                      17710028
177200                                                                  17720028
177300     EXEC SQL                                                     17730028
177400         SELECT A.INCLN_CDE                                       17740028
177500           INTO :RIT00000-INCLN-CDE                               17750028
177600           FROM RIT_RFID_VRFN A                                   17760028
177700          WHERE A.RFID_LVL_CDE = 'DPTSCL'                         17770028
177800            AND A.DEPT_NBR     = :DK-DEPT-NBR                     17780028
177900            AND A.STR_NBR     =0                                  17790028
178000            AND A.DC_LOC_NBR  =0                                  17800028
178100            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              17810028
178200            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              17820028
178300         WITH UR                                                  17830028
178400     END-EXEC.                                                    17840028
178500                                                                  17850028
178600***  IF ROW IS NOT ON TABLE THE DEPT IS NOT RFID.                 17860028
178700***  IF ROW IS ON TABLE THE DEPT IS RFID UNLESS THERE ARE         17870028
178800***  SUBCLASS EXCLUSIONS.                                         17880028
178900                                                                  17890028
179000     EVALUATE TRUE                                                17900028
179100         WHEN SQLCODE = ZERO                                      17910028
179200         WHEN SQLCODE = -811                                      17920028
179300            EVALUATE TRUE                                         17930028
179400              WHEN RIT00000-INCLN-CDE  = 'N'                      17940028
179500                SET PS-DEPT-SUBCL-RFID-YES TO TRUE                17950028
179600                SET SU093-RFID-KOHL-DEPT-SUBCL-YES TO TRUE        17960028
179700                SET PS-CHECK-FOR-RFID-DONE-YES TO TRUE            17970028
179800              WHEN RIT00000-INCLN-CDE  = 'E'                      17980028
179900                 PERFORM 8120-CHECK-DPT-SUBCL-EXCEPTON            17990028
180000              WHEN RIT00000-INCLN-CDE  = 'I'                      18000028
180100                 PERFORM 8130-CHECK-DPT-SUBCL-INCLUTON            18010028
180200              WHEN OTHER                                          18020028
180300                 MOVE 43             TO SU093-ERROR-NBR           18030028
180400                 MOVE SQLCODE        TO SU093-SQLCODE             18040028
180500                 SET SU093-SQL-ERROR TO TRUE                      18050028
180600            END-EVALUATE                                          18060028
180700         WHEN SQLCODE = +100                                      18070028
180800              SET PS-DEPT-SUBCL-RFID-NO  TO TRUE                  18080028
180900              SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE           18090028
181000              IF SU093-CARTON-STATUS AND SU093-OUTBOUND-CTN       18100028
181100                  CONTINUE                                        18110028
181200              ELSE                                                18120028
181300                 SET PS-CHECK-FOR-RFID-DONE-YES TO TRUE           18130028
181400              END-IF                                              18140028
181500         WHEN OTHER                                               18150028
181600              MOVE 26             TO SU093-ERROR-NBR              18160028
181700              MOVE SQLCODE        TO SU093-SQLCODE                18170028
181800              SET SU093-SQL-ERROR TO TRUE                         18180028
181900     END-EVALUATE.                                                18190028
182000                                                                  18200028
182150*----------------------------------------------------------------*18215052
182200* CHECK IF THE DEPT FOR THE IR FACILITY IS SET TO TAGGING         18220028
182300* CLP 12/18/13 -                                                  18230028
182400*----------------------------------------------------------------*18240028
182500 8010-CHECK-IR-DEPT.                                              18250028
182600                                                                  18260028
182700     SET  PS-IR-TAGGING-FOR-DEPT-NO TO TRUE.                      18270028
182800                                                                  18280028
182900     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    18290028
183000     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR                      18300028
183100                                                                  18310028
183200     EXEC SQL                                                     18320028
183300         SELECT A.INCLN_CDE                                       18330028
183400           INTO :RIT00000-INCLN-CDE                               18340028
183500           FROM RIT_RFID_VRFN A                                   18350028
183600          WHERE A.RFID_LVL_CDE = 'IRDPT'                          18360028
183700            AND A.DEPT_NBR     = :DK-DEPT-NBR                     18370028
183800            AND A.STR_NBR     =0                                  18380028
183900            AND A.DC_LOC_NBR  = :SU093-KEY-IR-NBR                 18390028
184000            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              18400028
184100            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              18410028
184200         WITH UR                                                  18420028
184300     END-EXEC.                                                    18430028
184400                                                                  18440028
184500     EVALUATE TRUE                                                18450028
184600         WHEN SQLCODE = ZERO                                      18460028
184700              SET PS-IR-TAGGING-FOR-DEPT-YES TO TRUE              18470028
184800         WHEN SQLCODE = +100                                      18480028
184900              SET PS-IR-TAGGING-FOR-DEPT-NO  TO TRUE              18490028
185000         WHEN OTHER                                               18500028
185100              MOVE 57             TO SU093-ERROR-NBR              18510028
185200              MOVE SQLCODE        TO SU093-SQLCODE                18520028
185300              SET SU093-SQL-ERROR TO TRUE                         18530028
185400     END-EVALUATE.                                                18540028
185500                                                                  18550028
185600*----------------------------------------------------------------*18560028
185700*  CHECK TO SEE IF THE SUBCLASS IS EXCLUDED ON THE TABLE.         18570028
185800*----------------------------------------------------------------*18580028
185900 8120-CHECK-DPT-SUBCL-EXCEPTON.                                   18590028
186000                                                                  18600028
186100     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   18610028
186200                                                                  18620028
186300     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    18630028
186400     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR                      18640028
186500                                                                  18650028
186600     MOVE  XLV00001-SUB-CL-NBR TO PV-SUB-CL-NBR-N.                18660028
186700     MOVE  PV-SUB-CL-NBR-N     TO  DK-SUBCLASS-NBR.               18670028
186800                                                                  18680028
186900     EXEC SQL                                                     18690028
187000         SELECT A.INCLN_CDE                                       18700028
187100           INTO :RIT00000-INCLN-CDE                               18710028
187200           FROM RIT_RFID_VRFN A                                   18720028
187300          WHERE A.RFID_LVL_CDE = 'DPTSCL'                         18730028
187400            AND A.STR_NBR      =0                                 18740028
187500            AND A.DC_LOC_NBR   =0                                 18750028
187600            AND A.DEPT_NBR     = :DK-DEPT-NBR                     18760028
187700            AND A.SUB_CL_NBR   = :DK-SUBCLASS-NBR                 18770028
187800            AND A.INCLN_CDE    = 'E'                              18780028
187900            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              18790028
188000            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              18800028
188100         WITH UR                                                  18810028
188200     END-EXEC.                                                    18820028
188300                                                                  18830028
188400***  IF ROW IS NOT ON TABLE THE SUBCLASS IS INCLUDED W/IN DEPT    18840028
188500***  IF ROW IS ON TABLE THE SUBCLASS IS EXCLUDED W/IN DEPT        18850028
188600                                                                  18860028
188700     EVALUATE TRUE                                                18870028
188800         WHEN SQLCODE = ZERO                                      18880028
188900         WHEN SQLCODE = -811                                      18890028
189000              SET PS-DEPT-SUBCL-RFID-NO TO TRUE                   18900028
189100              SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE           18910028
189200         WHEN SQLCODE = +100                                      18920028
189300              SET PS-DEPT-SUBCL-RFID-YES  TO TRUE                 18930028
189400              SET SU093-RFID-KOHL-DEPT-SUBCL-YES TO TRUE          18940028
189500              IF SU093-CARTON-STATUS AND SU093-OUTBOUND-CTN       18950028
189600                 CONTINUE                                         18960028
189700              ELSE                                                18970028
189800                 SET PS-CHECK-FOR-RFID-DONE-YES TO TRUE           18980028
189900              END-IF                                              18990028
190000         WHEN OTHER                                               19000028
190100              MOVE 58             TO SU093-ERROR-NBR              19010028
190200              MOVE SQLCODE        TO SU093-SQLCODE                19020028
190300              SET SU093-SQL-ERROR TO TRUE                         19030028
190400     END-EVALUATE.                                                19040028
190500                                                                  19050028
190600*----------------------------------------------------------------*19060028
190700*  CHECK TO SEE IF THE IF SUBCLASS IS INCLUDED ON THE TABLE.      19070028
190800*----------------------------------------------------------------*19080028
190900 8130-CHECK-DPT-SUBCL-INCLUTON.                                   19090028
191000                                                                  19100028
191100     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   19110028
191200                                                                  19120028
191300     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    19130028
191400     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR                      19140028
191500                                                                  19150028
191600     MOVE  XLV00001-SUB-CL-NBR TO PV-SUB-CL-NBR-N.                19160028
191700     MOVE  PV-SUB-CL-NBR-N     TO  DK-SUBCLASS-NBR.               19170028
191800                                                                  19180028
191900     EXEC SQL                                                     19190028
192000         SELECT A.INCLN_CDE                                       19200028
192100           INTO :RIT00000-INCLN-CDE                               19210028
192200           FROM RIT_RFID_VRFN A                                   19220028
192300          WHERE A.RFID_LVL_CDE = 'DPTSCL'                         19230028
192400            AND A.STR_NBR      =0                                 19240028
192500            AND A.DC_LOC_NBR   =0                                 19250028
192600            AND A.DEPT_NBR     = :DK-DEPT-NBR                     19260028
192700            AND A.SUB_CL_NBR   = :DK-SUBCLASS-NBR                 19270028
192800            AND A.INCLN_CDE    = 'I'                              19280028
192900            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              19290028
193000            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              19300028
193100         WITH UR                                                  19310028
193200     END-EXEC.                                                    19320028
193300                                                                  19330028
193400***  IF ROW IS NOT ON TABLE THE SUBCLASS IS EXCLUDED W/IN DEPT    19340028
193500***  IF ROW IS ON TABLE THE SUBCLASS IS INCLUDED W/IN DEPT        19350028
193600                                                                  19360028
193700     EVALUATE TRUE                                                19370028
193800         WHEN SQLCODE = ZERO                                      19380028
193900         WHEN SQLCODE = -811                                      19390028
194000              SET PS-DEPT-SUBCL-RFID-YES TO TRUE                  19400028
194100              SET SU093-RFID-KOHL-DEPT-SUBCL-YES TO TRUE          19410028
194200              SET PS-CHECK-FOR-RFID-DONE-YES TO TRUE              19420028
194300         WHEN SQLCODE = +100                                      19430028
194400              SET PS-DEPT-SUBCL-RFID-NO   TO TRUE                 19440028
194500              SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE           19450028
194600              SET PS-CHECK-FOR-RFID-DONE-YES TO TRUE              19460028
194700         WHEN OTHER                                               19470028
194800              MOVE 59             TO SU093-ERROR-NBR              19480028
194900              MOVE SQLCODE        TO SU093-SQLCODE                19490028
195000              SET SU093-SQL-ERROR TO TRUE                         19500028
195100     END-EVALUATE.                                                19510028
195200                                                                  19520028
195300*CLP 11/15/13                                                     19530028
195400*************************************************************     19540028
195500*    CHECK IF THE FACILITY IS TAGGING OR NOT                      19550028
195600*************************************************************     19560028
195700 8300-CHECK-IR-TAGGING.                                           19570028
195800                                                                  19580028
195900*    DISPLAY '8300-CHECK-IR-TAGGING - PRIOR TO 8800-'.            19590051
196000*    DISPLAY 'SU093-IR-CHK-IN-SW=' SU093-IR-CHK-IN-SW.            19600051
196100*    DISPLAY 'SU093-RFID-KOHL-DPT-IN-STR-SW='                     19610051
196200*            SU093-RFID-KOHL-DPT-IN-STR-SW.                       19620051
196300*    DISPLAY 'SU093-IR-NEEDS-DC-TAGGING-SW='                      19630051
196400*            SU093-IR-NEEDS-DC-TAGGING-SW.                        19640051
196500*    DISPLAY 'SU093-LABEL-PRINT-IND: '                            19650051
196600*             SU093-LABEL-PRINT-IND.                              19660051
196700*CLP 04/09/14 -START                                              19670028
196800     IF SU093-IR-CHK-IN-YES AND SU093-RFID-KOHL-DPT-IN-STR-YES    19680028
196900         IF SU093-IR-NEEDS-DC-TAGGING-NO                          19690028
197000             PERFORM 8010-CHECK-IR-DEPT                           19700028
197100             PERFORM 8800-CHK-VNDR-DPT-COMPLI-TAGNG               19710028
197200             IF PS-IR-TAGGING-FOR-DEPT-NO AND                     19720028
197300               (SU093-VNDR-DPT-RFID-COMPLI-YES OR                 19730028
197400                SU093-VNDR-DPT-RFID-TAGS-YES)                     19740028
197500*               NO TAGGING NEEDED VENDOR TAGGED IT                19750028
197600                SET SU093-IR-NEEDS-DC-TAGGING-NO TO TRUE          19760028
197700             ELSE                                                 19770028
197800                IF PS-IR-TAGGING-FOR-DEPT-NO AND                  19780028
197900                  (SU093-VNDR-DPT-RFID-COMPLI-NO  OR              19790028
198000                   SU093-VNDR-DPT-RFID-TAGS-NO)                   19800028
198100*                  TAGGING NEEDED                                 19810028
198200                   SET SU093-IR-NEEDS-DC-TAGGING-YES TO TRUE      19820028
198300                ELSE                                              19830028
198400                   SET SU093-IR-NEEDS-DC-TAGGING-NO  TO TRUE      19840028
198500                END-IF                                            19850028
198600            END-IF.                                               19860028
198700*CLP 04/09/14 -END                                                19870028
198800                                                                  19880028
198900********************************************************          19890028
199000***  SELECT STYL ID BY UPC NUMBER                                 19900028
199100********************************************************          19910028
199200 8400-SELECT-STYL-BY-UPC.                                         19920028
199300                                                                  19930028
199400     EXEC SQL                                                     19940028
199500        SELECT B.STYL_ID                                          19950028
199600        INTO :XLT00003-STYL-ID                                    19960028
199700        FROM                                                      19970028
199800           XLV_UPC A                                              19980028
199900         , XLT_SKU B                                              19990028
200000       WHERE UPC_NBR       = :XLV00003-UPC-NBR                    20000028
200100        AND  A.INTR_UPC_ID  = B.INTR_UPC_ID                       20010028
200200       WITH UR                                                    20020028
200300     END-EXEC.                                                    20030028
200400                                                                  20040028
200500     EVALUATE TRUE                                                20050028
200600         WHEN SQLCODE = ZERO                                      20060028
200700             CONTINUE                                             20070028
200800         WHEN SQLCODE = +100                                      20080028
200900             MOVE 28                  TO SU093-ERROR-NBR          20090028
201000             MOVE SQLCODE             TO SU093-SQLCODE            20100028
201100             SET SU093-SQL-ERROR      TO TRUE                     20110028
201200     END-EVALUATE.                                                20120028
201300                                                                  20130028
201400********************************************************          20140028
201500***  SELECT STYL ID BY SKU                                        20150028
201600********************************************************          20160028
201700 8500-SELECT-STYL-BY-SKU.                                         20170028
201800                                                                  20180028
201900                                                                  20190028
202000     EXEC SQL                                                     20200028
202100        SELECT B.STYL_ID                                          20210028
202200        INTO :XLT00003-STYL-ID                                    20220028
202300        FROM                                                      20230028
202400           XLT_SKU B                                              20240028
202500       WHERE SKU_NBR       = :XLT00003-SKU-NBR                    20250028
202600       WITH UR                                                    20260028
202700     END-EXEC.                                                    20270028
202800                                                                  20280028
202900     EVALUATE TRUE                                                20290028
203000         WHEN SQLCODE = ZERO                                      20300028
203100             CONTINUE                                             20310028
203200         WHEN SQLCODE = +100                                      20320028
203300             MOVE 29                  TO SU093-ERROR-NBR          20330028
203400             MOVE SQLCODE             TO SU093-SQLCODE            20340028
203500             SET SU093-SQL-ERROR      TO TRUE                     20350028
203600     END-EVALUATE.                                                20360028
203700                                                                  20370028
203800********************************************************          20380028
203900***  SELECT STYL ID BY ITEM NUMBER                                20390028
204000********************************************************          20400028
204100 8600-SELECT-STYL-BY-ITM.                                         20410028
204200                                                                  20420028
204300                                                                  20430028
204400     EXEC SQL                                                     20440028
204500        SELECT B.STYL_ID                                          20450028
204600        INTO :XLT00003-STYL-ID                                    20460028
204700        FROM                                                      20470028
204800           XLT_SKU B                                              20480028
204900       WHERE ITM_NBR       = :XLT00003-ITM-NBR                    20490028
205000       WITH UR                                                    20500028
205100     END-EXEC.                                                    20510028
205200                                                                  20520028
205300     EVALUATE TRUE                                                20530028
205400         WHEN SQLCODE = ZERO                                      20540028
205500             CONTINUE                                             20550028
205600         WHEN SQLCODE = +100                                      20560028
205700             MOVE 30                  TO SU093-ERROR-NBR          20570028
205800             MOVE SQLCODE             TO SU093-SQLCODE            20580028
205900             SET SU093-SQL-ERROR      TO TRUE                     20590028
206000     END-EVALUATE.                                                20600028
206100                                                                  20610028
206200********************************************************          20620028
206300***  SELECT DEPT, SUB-CLASS, VENDER STYLE, ENT ID BY STYL-ID      20630028
206400********************************************************          20640028
206500 8700-SLCT-DPT-SUBCL-VS-BY-STYL.                                  20650028
206600     EXEC SQL                                                     20660028
206700        SELECT A.DEPT_NBR                                         20670028
206800             , A.SUB_CL_NBR                                       20680028
206900             , A.VS_NBR                                           20690028
207000             , A.ENT_ID                                           20700028
207100        INTO :XLV00001-DEPT-NBR                                   20710028
207200           , :XLV00001-SUB-CL-NBR                                 20720028
207300           , :XLV00001-VS-NBR                                     20730028
207400           , :XLV00001-ENT-ID                                     20740028
207500        FROM                                                      20750028
207600           XLV_VND_STYL A                                         20760028
207700       WHERE STYL_ID       = :XLT00003-STYL-ID                    20770028
207800       WITH UR                                                    20780028
207900     END-EXEC.                                                    20790028
208000                                                                  20800028
208100     EVALUATE TRUE                                                20810028
208200         WHEN SQLCODE = ZERO                                      20820028
208300             CONTINUE                                             20830028
208400         WHEN SQLCODE = +100                                      20840028
208500              DISPLAY '8700-SLCT-DPT-SUBCL-VS-BY-STYL NOT FOUND'  20850028
208600              SET PS-DC-RFID-NO  TO TRUE                          20860028
208700              SET PS-DEPT-ENT-ID-FOUND-NO TO TRUE                 20870028
208800              MOVE 39             TO SU093-ERROR-NBR              20880028
208900              MOVE SQLCODE        TO SU093-SQLCODE                20890028
209000              SET SU093-SQL-ERROR TO TRUE                         20900028
209100     END-EVALUATE.                                                20910028
209200                                                                  20920028
209300********************************************************          20930028
209400***  IS VENDOR/DEPT RFID CERTIFIED OR TAGGING                     20940028
209500********************************************************          20950028
209600 8800-CHK-VNDR-DPT-COMPLI-TAGNG.                                  20960028
209700                                                                  20970028
209800*    DISPLAY 'SUKUT149 - 8800-CHK-VNDR-DPT - BEGIN'               20980028
209900     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE                    20990028
210000     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE                    21000028
210100                                                                  21010028
210200     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    21020028
210300     MOVE  PV-DEPT-NBR-3CH   TO  VNDAGR-DEPT-NBR                  21030028
210400                                                                  21040028
210410*CHG0195735 - REMOVE ALIAS NAME A                                 21041060
210500                                                                  21050028
210600     EXEC SQL                                                     21060028
210700          SELECT TYP_CDE                                          21070059
210800            INTO :VNDAGR-TYP-CDE                                  21080028
210900            FROM TVNDAGR                                          21090059
211000           WHERE ENT_ID          = :XLV00001-ENT-ID               21100059
211100             AND DEPT_NBR        = :VNDAGR-DEPT-NBR               21110059
211200             AND AGRMT_TYP_ID    = '4'                            21120059
211300             AND TYP_CDE        IN (11, 12)                       21130059
211400             AND EFFECTIVE_DATE <= CURRENT_DATE                   21140059
211500             AND EXPIRATION_DATE > CURRENT_DATE                   21150059
211600       WITH UR                                                    21160028
211700     END-EXEC.                                                    21170028
211800                                                                  21180028
211810*CHG0195735 - REMOVE ALIAS NAME A                                 21181060
211900     EVALUATE TRUE                                                21190028
212000         WHEN SQLCODE = ZERO                                      21200028
212100             IF VNDAGR-TYP-CDE = 12                               21210028
212200                 SET SU093-VNDR-DPT-RFID-COMPLI-YES   TO TRUE     21220028
212300             ELSE                                                 21230028
212400                 IF VNDAGR-TYP-CDE = 11                           21240028
212500                   SET SU093-VNDR-DPT-RFID-TAGS-YES  TO TRUE      21250029
212600                   IF PS-RF-EAS-CONTINUE-CHK-YES                  21260051
212700                      SET SU093-RFID-YES                          21270051
212800                          SU093-RFID-KOHL-DPT-IN-STR-YES          21280051
212900                          SU093-PRINT-RFID           TO TRUE      21290051
213000                   END-IF                                         21300051
213100                 END-IF                                           21310029
213200             END-IF                                               21320028
213300         WHEN SQLCODE = +100                                      21330028
213400             SET SU093-VNDR-DPT-RFID-TAGS-NO          TO TRUE     21340028
213500             SET SU093-VNDR-DPT-RFID-COMPLI-NO        TO TRUE     21350028
213600         WHEN OTHER                                               21360028
213700             DISPLAY '8800-CHK-VNDR-DPT-COMPLI-TAGNG NOT FOUND'   21370028
213800             MOVE 33                  TO SU093-ERROR-NBR          21380028
213900             MOVE SQLCODE             TO SU093-SQLCODE            21390028
214000             SET SU093-SQL-ERROR      TO TRUE                     21400028
214100     END-EVALUATE.                                                21410028
214200                                                                  21420028
214300*    DISPLAY 'SUKUT149 - 8800-CHK-VNDR-DPT - END'                 21430051
214400*    DISPLAY 'SU093-VNDR-DPT-RFID-COMPLI-SW='                     21440051
214500*            SU093-VNDR-DPT-RFID-COMPLI-SW.                       21450051
214600*    DISPLAY 'SU093-VNDR-DPT-RFID-TAGS-SW='                       21460051
214700*            SU093-VNDR-DPT-RFID-TAGS-SW.                         21470051
214800                                                                  21480028
214900********************************************************          21490028
215000***  CHECK IF DEPT WITHIN DC TAGS.                                21500028
215100********************************************************          21510028
215200 8825-CHK-DC-DEPT-TAGS.                                           21520028
215300                                                                  21530028
215400     SET SU093-DC-DEPT-TAGS-NO   TO TRUE.                         21540028
215500                                                                  21550028
215600     MOVE SU093-KEY-OPER-UNT-ID TO DK-LOC-NBR.                    21560028
215700                                                                  21570028
215800     EXEC SQL                                                     21580028
215900         SELECT DISTINCT(A.INCLN_CDE)                             21590028
216000           INTO :RIT00000-INCLN-CDE                               21600028
216100           FROM RIT_RFID_VRFN  A                                  21610028
216200          WHERE A.DC_LOC_NBR    = :DK-LOC-NBR                     21620028
216300            AND A.STR_NBR       =0                                21630028
216400            AND A.SUB_CL_NBR    =0                                21640028
216500            AND A.RFID_LVL_CDE   = 'DCDPTG'                       21650028
216600            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              21660028
216700            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              21670028
216800         WITH UR                                                  21680028
216900     END-EXEC.                                                    21690028
217000                                                                  21700028
217100***  CHECK TO SEE IF DC/DEPT TAGS.                                21710028
217200***  IF DC ROW IS ON TABLE WITH NO EXCEPTIONS THEN ALL DEPTS IN   21720028
217300***  DC APPLY RFID TAGS IN THE DC.                                21730028
217400***  IF DC ROWS HAVE EXCLUSIONS ON TABLE THEN CHECK IF CURRENT    21740028
217500***  DEPT IS BEING TAGGED IN THE DC OR NOT                        21750028
217600***  IF DC ROWS HAVE INCLUSIONS ON TABLE THEN CHECK IF CURRENT    21760028
217700***  DEPT IS BEING TAGGED IN THE DC OR NOT                        21770028
217800***  IF ROW IS NOT ON TABLE FOR DEPARTMENT IN DC THE DC WON'T TAG.21780028
217900***                                                               21790028
218000                                                                  21800028
218100     EVALUATE TRUE                                                21810028
218200         WHEN SQLCODE = ZERO                                      21820028
218300              EVALUATE TRUE                                       21830028
218400                  WHEN RIT00000-INCLN-CDE = 'N'                   21840028
218500                       SET SU093-DC-DEPT-TAGS-YES TO TRUE         21850028
218600                  WHEN RIT00000-INCLN-CDE = 'E'                   21860028
218700                       PERFORM 8830-CHK-KOHLS-TAG-EXCLSN          21870028
218800                  WHEN RIT00000-INCLN-CDE = 'I'                   21880028
218900                       PERFORM 8835-CHK-KOHLS-TAG-INCLSN          21890028
219000              END-EVALUATE                                        21900028
219100         WHEN SQLCODE = +100                                      21910028
219200              SET SU093-DC-DEPT-TAGS-NO TO TRUE                   21920028
219300         WHEN OTHER                                               21930028
219400              MOVE 42             TO SU093-ERROR-NBR              21940028
219500              MOVE SQLCODE        TO SU093-SQLCODE                21950028
219600              SET SU093-SQL-ERROR TO TRUE                         21960028
219700     END-EVALUATE.                                                21970028
219800                                                                  21980028
219900*                                                                 21990028
220000********************************************************          22000028
220100***  IF DC TAGS CHECK TO SEE IF THERE ARE ANY EXCLUSIONS BY       22010028
220200***  DEPT WITHIN DC                                               22020028
220300********************************************************          22030028
220400 8830-CHK-KOHLS-TAG-EXCLSN.                                       22040028
220500                                                                  22050028
220600                                                                  22060028
220700     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    22070028
220800     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR                      22080028
220900                                                                  22090028
221000     MOVE SU093-KEY-OPER-UNT-ID TO DK-LOC-NBR.                    22100028
221100                                                                  22110028
221200     EXEC SQL                                                     22120028
221300         SELECT A.INCLN_CDE                                       22130028
221400           INTO :RIT00000-INCLN-CDE                               22140028
221500           FROM RIT_RFID_VRFN  A                                  22150028
221600          WHERE A.DC_LOC_NBR    = :DK-LOC-NBR                     22160028
221700            AND A.DEPT_NBR      = :DK-DEPT-NBR                    22170028
221800            AND A.STR_NBR       =0                                22180028
221900            AND A.SUB_CL_NBR    =0                                22190028
222000            AND A.INCLN_CDE     = 'E'                             22200028
222100            AND A.RFID_LVL_CDE   = 'DCDPTG'                       22210028
222200            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              22220028
222300            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              22230028
222400         WITH UR                                                  22240028
222500     END-EXEC.                                                    22250028
222600                                                                  22260028
222700***  ALREADY KNOW THAT THE THE DC TAGS AND HAS EXCLUSIONS.        22270028
222800***  IF ROW IS ON TABLE FOR DEPARTMENT IN DC THE DC WON'TAG.      22280028
222900***  IF ROW IS NOT ON TABLE FOR DEPARTMENT IN DC THE DC WILL TAG. 22290028
223000***                                                               22300028
223100                                                                  22310028
223200     EVALUATE TRUE                                                22320028
223300         WHEN SQLCODE = ZERO                                      22330028
223400              SET SU093-DC-DEPT-TAGS-NO  TO TRUE                  22340028
223500         WHEN SQLCODE = +100                                      22350028
223600              SET SU093-DC-DEPT-TAGS-YES TO TRUE                  22360028
223700         WHEN OTHER                                               22370028
223800              MOVE 42             TO SU093-ERROR-NBR              22380028
223900              MOVE SQLCODE        TO SU093-SQLCODE                22390028
224000              SET SU093-SQL-ERROR TO TRUE                         22400028
224100     END-EVALUATE.                                                22410028
224200                                                                  22420028
224300********************************************************          22430028
224400***  IF DC TAGS CHECK TO SEE IF THERE ARE ANY INCLUSIONS BY       22440028
224500***  DEPT WITHIN DC                                               22450028
224600********************************************************          22460028
224700 8835-CHK-KOHLS-TAG-INCLSN.                                       22470028
224800                                                                  22480028
224900                                                                  22490028
225000     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N                    22500028
225100     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR                      22510028
225200                                                                  22520028
225300     MOVE SU093-KEY-OPER-UNT-ID TO DK-LOC-NBR.                    22530028
225400                                                                  22540028
225500     EXEC SQL                                                     22550028
225600         SELECT A.INCLN_CDE                                       22560028
225700           INTO :RIT00000-INCLN-CDE                               22570028
225800           FROM RIT_RFID_VRFN  A                                  22580028
225900          WHERE A.DC_LOC_NBR    = :DK-LOC-NBR                     22590028
226000            AND A.DEPT_NBR      = :DK-DEPT-NBR                    22600028
226100            AND A.STR_NBR       =0                                22610028
226200            AND A.SUB_CL_NBR    =0                                22620028
226300            AND A.INCLN_CDE     = 'I'                             22630028
226400            AND A.RFID_LVL_CDE   = 'DCDPTG'                       22640028
226500            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              22650028
226600            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              22660028
226700         WITH UR                                                  22670028
226800     END-EXEC.                                                    22680028
226900                                                                  22690028
227000***  ALREADY KNOW THAT THE THE DC TAGS AND HAS INCLUSIONS.        22700028
227100***  IF ROW IS ON TABLE FOR DEPARTMENT IN DC THE DC WILL TAG.     22710028
227200***  IF ROW IS NOT ON TABLE FOR DEPARTMENT IN DC THE DC WON'T TAG.22720028
227300***                                                               22730028
227400                                                                  22740028
227500     EVALUATE TRUE                                                22750028
227600         WHEN SQLCODE = ZERO                                      22760028
227700              SET SU093-DC-DEPT-TAGS-YES TO TRUE                  22770028
227800         WHEN SQLCODE = +100                                      22780028
227900              SET SU093-DC-DEPT-TAGS-NO  TO TRUE                  22790028
228000         WHEN OTHER                                               22800028
228100              MOVE 51             TO SU093-ERROR-NBR              22810028
228200              MOVE SQLCODE        TO SU093-SQLCODE                22820028
228300              SET SU093-SQL-ERROR TO TRUE                         22830028
228400     END-EVALUATE.                                                22840028
228500                                                                  22850028
228600*                                                                 22860028
228700********************************************************          22870028
228800***  CHECK TO SEE IF KOHL'S DC USES RFID CARTON LABELS WHICH      22880028
228900***  SOMETIMES IS REFERRED TO AS A '5' LABEL.                     22890028
229000********************************************************          22900028
229100 8840-CHK-DC-USE-RFID-CART-LBL.                                   22910028
229200                                                                  22920028
229300     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   22930028
229400                                                                  22940028
229500     MOVE SU093-KEY-OPER-UNT-ID TO DK-LOC-NBR.                    22950028
229600                                                                  22960028
229700     EXEC SQL                                                     22970028
229800         SELECT A.DC_LOC_NBR                                      22980028
229900           INTO :RIT00000-DC-LOC-NBR                              22990028
230000           FROM RIT_RFID_VRFN  A                                  23000028
230100          WHERE A.DC_LOC_NBR    = :DK-LOC-NBR                     23010028
230200            AND A.STR_NBR       =0                                23020028
230300            AND A.DEPT_NBR      =0                                23030028
230400            AND A.SUB_CL_NBR    =0                                23040028
230500            AND A.RFID_LVL_CDE  = 'DCLBL '                        23050028
230600            AND A.INCLN_CDE     = 'N'                             23060028
230700            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              23070028
230800            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              23080028
230900         WITH UR                                                  23090028
231000     END-EXEC.                                                    23100028
231100                                                                  23110028
231200***  IF ROW IS NOT ON TABLE THE DC DOESN'T USE RFID CARTON LABELS.23120028
231300***  IF ROW IS ON TABLE THE DC DOES USE RFID CARTON LABELS.      *23130028
231400                                                                  23140028
231500     EVALUATE TRUE                                                23150028
231600         WHEN SQLCODE = ZERO                                      23160028
231700              SET SU093-DC-USE-RFID-CART-LBL-YES TO TRUE          23170028
231800         WHEN SQLCODE = +100                                      23180028
231900              SET SU093-DC-USE-RFID-CART-LBL-NO  TO TRUE          23190028
232000         WHEN OTHER                                               23200028
232100              MOVE 40             TO SU093-ERROR-NBR              23210028
232200              MOVE SQLCODE        TO SU093-SQLCODE                23220028
232300              SET SU093-SQL-ERROR TO TRUE                         23230028
232400     END-EVALUATE.                                                23240028
232500                                                                  23250028
232600********************************************************          23260028
232700***  CHECK IF DC HAS AUTO CONVEYORS                               23270028
232800********************************************************          23280028
232900 8850-CHK-DC-AUTO-CONVEYRS.                                       23290028
233000                                                                  23300049
233100     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   23310028
233200                                                                  23320028
233300     MOVE SU093-KEY-OPER-UNT-ID TO DK-LOC-NBR.                    23330028
233400                                                                  23340028
233500     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   23350028
233600                                                                  23360028
233700     EXEC SQL                                                     23370028
233800         SELECT FUNC_TXT                                          23380028
233900           INTO :KRPRPM-FUNC-TXT                                  23390028
234000         FROM TKRPRPM                                             23400028
234100         WHERE LOC_ID            =  :DK-LOC-NBR                   23410028
234200           AND INTFC_SYS_CDE     =  'KHL'                         23420028
234300           AND SYS_PRC_FUNC_CDE  =  'AUTOCY'                      23430028
234400           AND FUNC_PRC_STAT_CDE =  'AC'                          23440028
234500           AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP             23450028
234600           AND FUNC_END_TMST    >=  CURRENT TIMESTAMP             23460028
234700         WITH UR                                                  23470028
234800     END-EXEC.                                                    23480028
234900                                                                  23490028
235000***  IF ROW IS NOT ON TABLE THE DC DOESN'T USE RFID CARTON LABELS.23500028
235100***  IF ROW IS ON TABLE THE DC DOES USE RFID CATON LABELS.       *23510028
235200                                                                  23520028
235300     EVALUATE TRUE                                                23530028
235400         WHEN SQLCODE = ZERO                                      23540028
235500              IF  KRPRPM-FUNC-TXT = 'EXC'                         23550028
235600                  SET SU093-RFID-DC-AUTO-CONVEYR-YES TO TRUE      23560028
235700              ELSE                                                23570028
235800                  IF KRPRPM-FUNC-TXT = 'NNE'                      23580028
235900                     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE    23590028
236000                  END-IF                                          23600028
236100              END-IF                                              23610028
236200         WHEN SQLCODE = +100                                      23620028
236300              SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE           23630028
236400         WHEN OTHER                                               23640028
236500              MOVE 41             TO SU093-ERROR-NBR              23650028
236600              MOVE SQLCODE        TO SU093-SQLCODE                23660028
236700              SET SU093-SQL-ERROR TO TRUE                         23670028
236800     END-EVALUATE.                                                23680028
236900                                                                  23690028
237000     IF  SU093-RFID-DC-AUTO-CONVEYR-YES                           23700028
237100         PERFORM 8860-CHK-DEPT-STR-P2L-FIRST                      23710028
237200     ELSE                                                         23720028
237300         SET SU093-DPT-STR-P2L-FIRST-NO TO TRUE                   23730028
237400     END-IF.                                                      23740028
237500                                                                  23750028
237600********************************************************          23760028
237700***  FOR DC'S WITH AUTO CONVERYORS CHECK TO SEE IF THE DEPT HAS   23770028
237800***  P2L DIVERT STORES.  USED TO CHECK IF THE DEPT HAS BEEN SET   23780028
237900***  TO SEND THE CARTON TO P2L FIRST BEFORE GOING TO              23790028
238000**   FLAT. WILL DETERMINE IF ALL STORES WITHIN THE DEPT SHOULD GO 23800028
238100**   TO P2L FIRST OR DECIFER IF ANY INCLUSIONS OR EXCLUSIONS OF   23810028
238200**   STORES FROM THE DEPT ARE PRESENT.                            23820028
238300********************************************************          23830028
238400**FROM RECEIVING 502/771 HAS NO STORE                             23840028
238500**FROM PACK TO LIGHT IT HAS STORE                                 23850028
238600**8871-HAS NO STORE 8870-HAS STORE                                23860028
238700**8881-HAS NO STORE 8880-HAS STORE                                23870028
238800********************************************************          23880028
238900********************************************************          23890028
239000 8860-CHK-DEPT-STR-P2L-FIRST.                                     23900028
239100                                                                  23910051
239200     SET SU093-DPT-STR-P2L-FIRST-NO TO TRUE.                      23920028
239300                                                                  23930028
239400     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N.                   23940028
239500     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR.                     23950028
239600     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     23960028
239700                                                                  23970028
239800                                                                  23980028
239900     EXEC SQL                                                     23990028
240000         SELECT DISTINCT(A.INCLN_CDE)                             24000028
240100           INTO :PV-P2L-DIVERT-DEPT-IND                           24010028
240200           FROM RIT_RFID_VRFN  A                                  24020028
240300          WHERE A.DEPT_NBR       = :DK-DEPT-NBR                   24030028
240400            AND A.SUB_CL_NBR     =0                               24040028
240500            AND A.DC_LOC_NBR     = :DK-DC-NBR                     24050028
240600            AND A.RFID_LVL_CDE   = 'P2LDVT'                       24060028
240700            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              24070028
240800            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              24080028
240900         WITH UR                                                  24090028
241000     END-EXEC.                                                    24100028
241100                                                                  24110028
241200     EVALUATE TRUE                                                24120028
241300       WHEN SQLCODE = ZERO                                        24130028
241400         EVALUATE TRUE                                            24140028
241500           WHEN PV-P2L-DIVERT-DEPT-IND = 'N'                      24150028
241600                 SET SU093-DPT-STR-P2L-FIRST-YES TO TRUE          24160028
241700           WHEN PV-P2L-DIVERT-DEPT-IND    = 'E'                   24170028
241800                 IF SU093-KEY-DEST-LOC = 0                        24180028
241900                    PERFORM 8871-CHK-DPT-STR-P2L-FRST-EXCL        24190028
242000                 ELSE                                             24200028
242100                    PERFORM 8870-CHK-DPT-STR-P2L-FRST-EXCL        24210028
242200                 END-IF                                           24220028
242300           WHEN PV-P2L-DIVERT-DEPT-IND    = 'I'                   24230028
242400                 IF SU093-KEY-DEST-LOC = 0                        24240028
242500                     PERFORM 8881-CHK-DPT-STR-P2L-FRST-INCL       24250028
242600                 ELSE                                             24260028
242700                     PERFORM 8880-CHK-DPT-STR-P2L-FRST-INCL       24270028
242800                 END-IF                                           24280028
242900           END-EVALUATE                                           24290028
243000         WHEN SQLCODE = +100                                      24300028
243100              SET SU093-DPT-STR-P2L-FIRST-NO  TO TRUE             24310028
243200         WHEN OTHER                                               24320028
243300              MOVE 36             TO SU093-ERROR-NBR              24330028
243400              MOVE SQLCODE        TO SU093-SQLCODE                24340028
243500              SET SU093-SQL-ERROR TO TRUE                         24350028
243600     END-EVALUATE.                                                24360028
243700                                                                  24370028
243800                                                                  24380028
243900                                                                  24390028
244000********************************************************          24400028
244100***  IF DEPT FROM PARGRAPH 8860 HAS EXCLUSIONS WILL CHECK IF THE  24410028
244200***  CURRENT STORE IS EXCLUDED OR NOT. IF EXLUDED THE CARTON WON'T24420028
244300***  GO TO P2L BEFORE FLAT TO BE TAGGED. IF NOT EXCLUDED THE      24430028
244400**   CARTON WILL GO TO P2L BEFORE FLAT TO BE TAGGED.              24440028
244500********************************************************          24450028
244600 8870-CHK-DPT-STR-P2L-FRST-EXCL.                                  24460028
244700                                                                  24470028
244800     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N.                   24480028
244900     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR.                     24490028
245000                                                                  24500028
245100     MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR.                       24510028
245200     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     24520028
245300                                                                  24530028
245400     EXEC SQL                                                     24540028
245500         SELECT DISTINCT(A.INCLN_CDE)                             24550028
245600           INTO :PV-P2L-DIVERT-DEPT-STR-IND                       24560028
245700           FROM RIT_RFID_VRFN  A                                  24570028
245800          WHERE A.STR_NBR        = :DK-LOC-NBR                    24580028
245900            AND A.DEPT_NBR       = :DK-DEPT-NBR                   24590028
246000            AND A.SUB_CL_NBR     =0                               24600028
246100            AND A.DC_LOC_NBR     = :DK-DC-NBR                     24610028
246200            AND A.INCLN_CDE      ='E'                             24620028
246300            AND A.RFID_LVL_CDE   = 'P2LDVT'                       24630028
246400            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              24640028
246500            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              24650028
246600         WITH UR                                                  24660028
246700     END-EXEC.                                                    24670028
246800                                                                  24680028
246900     EVALUATE TRUE                                                24690028
247000         WHEN SQLCODE = ZERO                                      24700028
247100              SET SU093-DPT-STR-P2L-FIRST-NO TO TRUE              24710028
247200         WHEN SQLCODE = +100                                      24720028
247300              SET SU093-DPT-STR-P2L-FIRST-YES TO TRUE             24730028
247400         WHEN OTHER                                               24740028
247500              MOVE 37             TO SU093-ERROR-NBR              24750028
247600              MOVE SQLCODE        TO SU093-SQLCODE                24760028
247700              SET SU093-SQL-ERROR TO TRUE                         24770028
247800     END-EVALUATE.                                                24780028
247900                                                                  24790028
248000********************************************************          24800028
248100***  IF DEPT FROM PARGRAPH 8860 HAS EXCLUSIONS WILL CHECK IF THE  24810028
248200***  CURRENT STORE IS EXCLUDED OR NOT. IF EXLUDED THE CARTON WON'T24820028
248300***  GO TO P2L BEFORE FLAT TO BE TAGGED. IF NOT EXCLUDED THE      24830028
248400**   CARTON WILL GO TO P2L BEFORE FLAT TO BE TAGGED.              24840028
248500********************************************************          24850028
248600 8871-CHK-DPT-STR-P2L-FRST-EXCL.                                  24860028
248700                                                                  24870028
248800     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N.                   24880028
248900     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR.                     24890028
249000                                                                  24900028
249100     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     24910028
249200                                                                  24920028
249300     EXEC SQL                                                     24930028
249400         SELECT DISTINCT(A.INCLN_CDE)                             24940028
249500           INTO :PV-P2L-DIVERT-DEPT-STR-IND                       24950028
249600           FROM RIT_RFID_VRFN  A                                  24960028
249700          WHERE A.DEPT_NBR       = :DK-DEPT-NBR                   24970028
249800            AND A.SUB_CL_NBR     =0                               24980028
249900            AND A.DC_LOC_NBR     = :DK-DC-NBR                     24990028
250000            AND A.INCLN_CDE      ='E'                             25000028
250100            AND A.RFID_LVL_CDE   = 'P2LDVT'                       25010028
250200            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              25020028
250300            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              25030028
250400         WITH UR                                                  25040028
250500     END-EXEC.                                                    25050028
250600                                                                  25060028
250700     EVALUATE TRUE                                                25070028
250800         WHEN SQLCODE = ZERO                                      25080028
250900              SET SU093-DPT-STR-P2L-FIRST-NO TO TRUE              25090028
251000         WHEN SQLCODE = +100                                      25100028
251100              SET SU093-DPT-STR-P2L-FIRST-YES TO TRUE             25110028
251200         WHEN OTHER                                               25120028
251300              MOVE 61             TO SU093-ERROR-NBR              25130028
251400              MOVE SQLCODE        TO SU093-SQLCODE                25140028
251500              SET SU093-SQL-ERROR TO TRUE                         25150028
251600     END-EVALUATE.                                                25160028
251700                                                                  25170028
251800********************************************************          25180028
251900*** IF DEPT FROM PARGRAPH 8860 HAS INCLUSIONS WILL CHECK IF THE   25190028
252000*** CURRENT STORE IS INCLUDED OR NOT. IF INCLUDED THE CARTON WILL 25200028
252100*** GO TO P2L BEFORE FLAT TO BE TAGGED. IF NOT INCLUDED THE       25210028
252200**  CARTON WILL NOT GO TO P2L BEFORE FLAT TO BE TAGGED.           25220028
252300********************************************************          25230028
252400 8880-CHK-DPT-STR-P2L-FRST-INCL.                                  25240028
252500                                                                  25250028
252600     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N.                   25260028
252700     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR.                     25270028
252800                                                                  25280028
252900     MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR.                       25290028
253000     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     25300028
253100                                                                  25310028
253200     EXEC SQL                                                     25320028
253300         SELECT DISTINCT(A.INCLN_CDE)                             25330028
253400           INTO :PV-P2L-DIVERT-DEPT-STR-IND                       25340028
253500           FROM RIT_RFID_VRFN  A                                  25350028
253600          WHERE A.STR_NBR        = :DK-LOC-NBR                    25360028
253700            AND A.DEPT_NBR       = :DK-DEPT-NBR                   25370028
253800            AND A.SUB_CL_NBR     =0                               25380028
253900            AND A.DC_LOC_NBR     = :DK-DC-NBR                     25390028
254000            AND A.INCLN_CDE      = 'I'                            25400028
254100            AND A.RFID_LVL_CDE   = 'P2LDVT'                       25410028
254200            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              25420028
254300            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              25430028
254400         WITH UR                                                  25440028
254500     END-EXEC.                                                    25450028
254600                                                                  25460028
254700     EVALUATE TRUE                                                25470028
254800         WHEN SQLCODE = ZERO                                      25480028
254900              SET SU093-DPT-STR-P2L-FIRST-YES TO TRUE             25490028
255000         WHEN SQLCODE = +100                                      25500028
255100              SET SU093-DPT-STR-P2L-FIRST-NO  TO TRUE             25510028
255200         WHEN OTHER                                               25520028
255300              MOVE 38             TO SU093-ERROR-NBR              25530028
255400              MOVE SQLCODE        TO SU093-SQLCODE                25540028
255500              SET SU093-SQL-ERROR TO TRUE                         25550028
255600     END-EVALUATE.                                                25560028
255700                                                                  25570028
255800 8881-CHK-DPT-STR-P2L-FRST-INCL.                                  25580028
255900                                                                  25590028
256000     MOVE  XLV00001-DEPT-NBR TO  PV-DEPT-NBR-N.                   25600028
256100     MOVE  PV-DEPT-NBR-N     TO  DK-DEPT-NBR.                     25610028
256200                                                                  25620028
256300     MOVE SU093-KEY-DEST-LOC TO DK-LOC-NBR.                       25630028
256400     MOVE SU093-KEY-OPER-UNT-ID TO DK-DC-NBR.                     25640028
256500                                                                  25650028
256600                                                                  25660028
256700     EXEC SQL                                                     25670028
256800         SELECT DISTINCT(A.INCLN_CDE)                             25680028
256900           INTO :PV-P2L-DIVERT-DEPT-STR-IND                       25690028
257000           FROM RIT_RFID_VRFN  A                                  25700028
257100          WHERE A.DEPT_NBR       = :DK-DEPT-NBR                   25710028
257200            AND A.SUB_CL_NBR     =0                               25720028
257300            AND A.DC_LOC_NBR     = :DK-DC-NBR                     25730028
257400            AND A.INCLN_CDE      = 'I'                            25740028
257500            AND A.RFID_LVL_CDE   = 'P2LDVT'                       25750028
257600            AND A.EFF_STRT_TMST <= CURRENT_TIMESTAMP              25760028
257700            AND A.EFF_END_TMST   > CURRENT_TIMESTAMP              25770028
257800         WITH UR                                                  25780028
257900     END-EXEC.                                                    25790028
258000                                                                  25800028
258100     EVALUATE TRUE                                                25810028
258200         WHEN SQLCODE = ZERO                                      25820028
258300              SET SU093-DPT-STR-P2L-FIRST-YES TO TRUE             25830028
258400         WHEN SQLCODE = +100                                      25840028
258500              SET SU093-DPT-STR-P2L-FIRST-NO  TO TRUE             25850028
258600         WHEN OTHER                                               25860028
258700              MOVE 62             TO SU093-ERROR-NBR              25870028
258800              MOVE SQLCODE        TO SU093-SQLCODE                25880028
258900              SET SU093-SQL-ERROR TO TRUE                         25890028
259000     END-EVALUATE.                                                25900028
259100                                                                  25910028
259210                                                                  25921075
259220********************************************************          25922075
259230*** IN AUGUST OF 2019, THIS PARAGRAPH WAS CHANGED TO              25923075
259240*** ADD LOGIC TO DO SOME CHECKING WHERE IF THE EASTAG             25924075
259250*** CHECK FOUND THE MERCHANDISE NEEDED TO BE EAS TAGGED,          25925075
259260*** THE LOGIC IN THE 'WHEN SQLCODE = ZERO' SECTION OF             25926075
259270*** THE EVALUATE STATEMENT WILL DO FURTHER CHECKS TO              25927075
259280*** SEE IF THE CORRESPONDING SEASONAL SET OR PO HAS               25928075
259281*** BEEN DEFINED IN WST PARMS EASSSBYPAS OR EASPOBYPAS            25928175
259282*** TO INDICATE NOT TO EAS TAG THE MERCHANDISE.                   25928275
259290********************************************************          25929075
259300 8900-CHK-EAS-TAGGING.                                            25930028
259400                                                                  25940028
259500     EXEC SQL                                                     25950028
259600     SELECT   H.ATTR_ELEM_TXT                                     25960028
259700      INTO  :PS-EAS-TAGGING-FOR-DEPT-SW                           25970028
259800      FROM                                                        25980028
259900            WST_INTGRTN_TYP  A                                    25990028
260000         ,  WST_ATTR_DEFN    B                                    26000028
260100         ,  WST_ATTR_ELEM    C              -- OPER               26010064
260200         ,  WST_ATTR_ELEM    D              -- DEPT               26020028
260300         ,  WST_ATTR_ELEM    E              -- ENT ID             26030028
260400         ,  WST_ATTR_ELEM    F              -- FROM TMST          26040028
260500         ,  WST_ATTR_ELEM    G              -- TO TMST            26050028
260600         ,  WST_ATTR_ELEM    H              -- Y/N SWITCH         26060028
260700      WHERE                                                       26070028
260800            A.INTGRTN_TYP_CDE   = 'EASTAG'                        26080028
260900        AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE               26090028
261000        AND B.ATTR_DEFN_SEQ_NBR = 1                               26100028
261100        AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE               26110028
261200        AND C.ATTR_DEFN_SEQ_NBR = 1                               26120028
261300        AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE               26130028
261400        AND D.ATTR_DEFN_SEQ_NBR = 2                               26140028
261500            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           26150028
261600            AND E.ATTR_DEFN_SEQ_NBR = 3                           26160028
261700            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           26170028
261800            AND F.ATTR_DEFN_SEQ_NBR = 4                           26180028
261900            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           26190028
262000            AND G.ATTR_DEFN_SEQ_NBR = 5                           26200028
262100            AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE           26210028
262200            AND H.ATTR_DEFN_SEQ_NBR = 6                           26220028
262300            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         26230028
262400            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         26240028
262500            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         26250028
262600            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         26260028
262700            AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR         26270028
262800            AND C.ATTR_ELEM_NBR     = :DK-DC-NBR                  26280028
262900            AND D.ATTR_ELEM_NBR     = :XLV00001-DEPT-NBR          26290064
263000            AND E.ATTR_ELEM_NBR     = :XLV00001-ENT-ID            26300064
263100            AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP          26310028
263200            AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP          26320028
263300            AND H.ATTR_ELEM_TXT     =  'Y'                        26330028
263400         WITH UR                                                  26340028
263500     END-EXEC.                                                    26350028
263600                                                                  26360028
263700     EVALUATE TRUE                                                26370028
263800         WHEN SQLCODE = ZERO                                      26380028
263810              PERFORM 8905-CHECK-BYPASS-PARM                      26381073
263820              IF  PS-EAS-EXECUTE-BYPASS-NO                        26382073
263830                  CONTINUE                                        26383073
263840              ELSE                                                26384073
263900                  PERFORM 8910-FURTHER-EAS-CHECKS                 26390073
263910              END-IF                                              26391073
264000         WHEN SQLCODE = +100                                      26400028
264100              SET PS-EAS-TAGGING-FOR-DEPT-NO  TO TRUE             26410028
264200         WHEN OTHER                                               26420028
264300              MOVE 63             TO SU093-ERROR-NBR              26430028
264400              MOVE SQLCODE        TO SU093-SQLCODE                26440028
264500              SET SU093-SQL-ERROR TO TRUE                         26450028
264600     END-EVALUATE.                                                26460028
264610                                                                  26461062
264612********************************************************          26461275
264613*** READ THE TKRPRPM PARM FOR PARM NAME EASBYP.  IF THE           26461375
264614*** FUNC_TXT IS A 'Y', THEN THE NEW LOGIC TO CHECK FOR            26461475
264615*** THE BYPASS OF EAS TAGGING WOULD BE EXECUTED.  IF THE          26461575
264616*** FUNC_TXT IS A 'N' OR +100, THEN THE NEW LOGIC TO              26461675
264617*** CHECK FOR THE BYPASS OF THE EAS TAGGING WOULD NOT             26461775
264618*** BE EXECUTED.                                                  26461875
264619********************************************************          26461975
264620 8905-CHECK-BYPASS-PARM.                                          26462075
264621                                                                  26462175
264622     EXEC SQL                                                     26462275
264623         SELECT FUNC_TXT                                          26462375
264624           INTO :PS-EAS-EXECUTE-BYPASS-SW                         26462475
264625         FROM TKRPRPM                                             26462575
264626         WHERE LOC_ID            =  90                            26462675
264627           AND INTFC_SYS_CDE     =  'KHL'                         26462775
264628           AND SYS_PRC_FUNC_CDE  =  'EASBYP'                      26462875
264629           AND FUNC_PRC_STAT_CDE =  'AC'                          26462975
264630           AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP             26463075
264631           AND FUNC_END_TMST    >=  CURRENT TIMESTAMP             26463175
264632         WITH UR                                                  26463275
264633     END-EXEC.                                                    26463375
264634                                                                  26463475
264635     EVALUATE TRUE                                                26463575
264636         WHEN SQLCODE = ZERO                                      26463675
264637              CONTINUE                                            26463775
264638         WHEN SQLCODE = +100                                      26463875
264639              SET PS-EAS-EXECUTE-BYPASS-NO TO TRUE                26463975
264640         WHEN OTHER                                               26464075
264641              MOVE 68             TO SU093-ERROR-NBR              26464175
264642              MOVE SQLCODE        TO SU093-SQLCODE                26464275
264643              SET SU093-SQL-ERROR TO TRUE                         26464375
264644     END-EVALUATE.                                                26464475
264645                                                                  26464575
264646                                                                  26464675
264647********************************************************          26464775
264648*** THIS PARAGRAPH WILL BE EXECUTED ONLY IF THE INITIAL           26464875
264649*** CHECK OF THE EASTAG WST PARM CAME BACK INDICATING             26464975
264650*** THAT THE MERCHANDISE NEEDS TO BE EAS TAGGED.  THIS            26465075
264651*** PARAGRAPH WILL DO FURTHER CHECKS TO SEE IF THE                26465175
264652*** MERCHANDISE SHOULD BE BYPASSED FROM EAS TAGGING IF            26465275
264653*** THE ASSOCIATED PO OR ASSOCIATED SEASONAL SET IS SET           26465375
264654*** UP ON THE EASSSBYPAS OR EASPOBYPAS PARMS TO TELL              26465475
264655*** THE SYSTEM TO NOT PERFORM THE EAS TAGGING.                    26465575
264656*** SHOULD BE NOTED THAT IF THE BYPASS IF FOUND ON THE            26465675
264657*** EASSSBYPAS CHECK, THE PROGRAM WOULD NOT DO THE CHECK          26465775
264658*** OF THE EASPOBYPAS PARM SINCE IT HAS ALREADY DETERMINED        26465875
264659*** TO BYPASS THE EAS TAGGING.                                    26465975
264660********************************************************          26466075
264661 8910-FURTHER-EAS-CHECKS.                                         26466175
264662                                                                  26466275
264663     MOVE SU093-KEY-PO TO PV-NUMERIC-PO-NBR.                      26466375
264664     IF  PV-NUMERIC-PO-NBR > 0                                    26466475
264665     AND PV-NUMERIC-PO-NBR IS NUMERIC                             26466575
264667         MOVE SU093-KEY-PO TO DK-PO-NBR                           26466775
264670         PERFORM 8920-EAS-BYPASS-BY-SET                           26467063
264671     ELSE                                                         26467165
264672         MOVE SHUUPC-TRN-NBR TO PV-NUMERIC-PO-NBR                 26467272
264673         IF  PV-NUMERIC-PO-NBR > 0                                26467371
264674         AND PV-NUMERIC-PO-NBR IS NUMERIC                         26467471
264677             MOVE SHUUPC-TRN-NBR TO DK-PO-NBR                     26467765
264678             PERFORM 8920-EAS-BYPASS-BY-SET                       26467865
264679         ELSE                                                     26467965
264680             MOVE SUT00028-TRN-NBR TO PV-NUMERIC-PO-NBR           26468071
264682             IF  PV-NUMERIC-PO-NBR > 0                            26468271
264683             AND PV-NUMERIC-PO-NBR IS NUMERIC                     26468371
264685                 MOVE SUT00028-TRN-NBR TO DK-PO-NBR               26468565
264686                 PERFORM 8920-EAS-BYPASS-BY-SET                   26468665
264687             END-IF                                               26468765
264688         END-IF                                                   26468865
264689     END-IF.                                                      26468963
264690                                                                  26469063
264691********************************************************          26469175
264692*** THIS PARAGRAPH WILL CHECK THE EASSSBYPAS PARM BASED           26469275
264693*** ON THE SEASONAL SET ASSOCIATED TO THE PO FOR THE              26469375
264694*** MERCHANDISE TO SEE IF WHILE THE EASTAG CHECK FOUND            26469475
264695*** THE MERCHANDISE NEEDS TO BE EAS TAGGED, THIS PARM             26469575
264696*** CHECK WILL OVERRIDE THAT AND FLAG THE MERCHANDISE             26469675
264697*** TO NOT BE EAS TAGGED IF THE SEASONAL SET IS ACTIVE            26469775
264698*** ON THE EASSSBYPAS PARM.                                       26469875
264700********************************************************          26470075
264701 8920-EAS-BYPASS-BY-SET.                                          26470163
264702                                                                  26470263
264703     EXEC SQL                                                     26470363
264704     SELECT   E.ATTR_ELEM_TXT                                     26470463
264705      INTO  :PS-EAS-SEASET-BYPASS-SW                              26470563
264706      FROM                                                        26470663
264707            WST_INTGRTN_TYP  A                                    26470763
264708         ,  WST_ATTR_DEFN    B                                    26470863
264709         ,  WST_ATTR_ELEM    C              -- SET YEAR           26470963
264710         ,  WST_ATTR_ELEM    D              -- SET NAME           26471063
264711         ,  WST_ATTR_ELEM    E              -- Y/N SWITCH         26471163
264712         ,  WST_ATTR_ELEM    F              -- FROM TMST          26471263
264713         ,  WST_ATTR_ELEM    G              -- TO TMST            26471363
264714         ,  TPURCHS          H                                    26471463
264715      WHERE                                                       26471563
264716            A.INTGRTN_TYP_CDE   = 'EASSSBYPAS'                    26471663
264717        AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE               26471763
264718        AND B.ATTR_DEFN_SEQ_NBR = 1                               26471863
264719        AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE               26471963
264720        AND C.ATTR_DEFN_SEQ_NBR = 1                               26472063
264721        AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE               26472163
264722        AND D.ATTR_DEFN_SEQ_NBR = 2                               26472263
264723        AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE               26472363
264724        AND E.ATTR_DEFN_SEQ_NBR = 3                               26472463
264725        AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE               26472563
264726        AND F.ATTR_DEFN_SEQ_NBR = 4                               26472663
264727        AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE               26472763
264728        AND G.ATTR_DEFN_SEQ_NBR = 5                               26472863
264729        AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR             26472963
264730        AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR             26473063
264731        AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR             26473163
264732        AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR             26473263
264733        AND C.ATTR_ELEM_TXT     = H.SEASET_YR                     26473363
264734        AND D.ATTR_ELEM_TXT     = H.SEASET_SHRT_NM                26473467
264735        AND E.ATTR_ELEM_TXT     = 'Y'                             26473563
264736        AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP               26473663
264737        AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP               26473763
264738        AND H.PO_NBR            = :DK-PO-NBR                      26473863
264739        AND H.VER_STATUS_CDE    = 'A'                             26473963
264740         WITH UR                                                  26474063
264741     END-EXEC.                                                    26474163
264742                                                                  26474263
264743     EVALUATE TRUE                                                26474363
264744         WHEN SQLCODE = ZERO                                      26474463
264745              SET PS-EAS-TAGGING-FOR-DEPT-NO  TO TRUE             26474563
264746         WHEN SQLCODE = +100                                      26474663
264747              PERFORM 8930-EAS-BYPASS-BY-PO                       26474763
264748         WHEN OTHER                                               26474863
264749              MOVE 66             TO SU093-ERROR-NBR              26474963
264750              MOVE SQLCODE        TO SU093-SQLCODE                26475063
264751              SET SU093-SQL-ERROR TO TRUE                         26475163
264752     END-EVALUATE.                                                26475263
264753                                                                  26475363
264754********************************************************          26475475
264755*** THIS PARAGRAPH WILL CHECK THE EASPOBYPAS PARM BASED           26475575
264756*** ON THE PO FOR THE MERCHANDISE TO SEE IF WHILE THE             26475675
264757*** EASTAG CHECK FOUND THE MERCHANDISE NEEDS TO BE EAS            26475775
264758*** TAGGED, THIS PARM CHECK WILL OVERRIDE THAT THE FLAG           26475875
264759*** THE MERCHANDISE TO NOT BE EAS TAGGED IF THE PO IS             26475975
264761*** ACTIVE ON THE EASPOBYPAS PARM.                                26476175
264762********************************************************          26476275
264763 8930-EAS-BYPASS-BY-PO.                                           26476363
264764                                                                  26476463
264765     EXEC SQL                                                     26476563
264766     SELECT   E.ATTR_ELEM_TXT                                     26476663
264767      INTO  :PS-EAS-PO-BYPASS-SW                                  26476763
264768      FROM                                                        26476863
264769            WST_INTGRTN_TYP  A                                    26476963
264770         ,  WST_ATTR_DEFN    B                                    26477063
264771         ,  WST_ATTR_ELEM    D              -- PO NUMBER          26477163
264772         ,  WST_ATTR_ELEM    E              -- Y/N SWITCH         26477263
264773         ,  WST_ATTR_ELEM    F              -- FROM TMST          26477363
264774         ,  WST_ATTR_ELEM    G              -- TO TMST            26477463
264775      WHERE                                                       26477563
264776            A.INTGRTN_TYP_CDE   = 'EASPOBYPAS'                    26477663
264777        AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE               26477763
264778        AND B.ATTR_DEFN_SEQ_NBR = 1                               26477863
264779        AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE               26477963
264780        AND D.ATTR_DEFN_SEQ_NBR = 1                               26478063
264781        AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE               26478163
264782        AND E.ATTR_DEFN_SEQ_NBR = 2                               26478263
264783        AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE               26478363
264784        AND F.ATTR_DEFN_SEQ_NBR = 3                               26478463
264785        AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE               26478563
264786        AND G.ATTR_DEFN_SEQ_NBR = 4                               26478663
264787        AND D.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR             26478763
264788        AND D.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR             26478863
264789        AND D.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR             26478963
264790        AND D.ATTR_ELEM_NBR     = :DK-PO-NBR                      26479063
264791        AND E.ATTR_ELEM_TXT     = 'Y'                             26479163
264792        AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP               26479263
264793        AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP               26479363
264794         WITH UR                                                  26479463
264795     END-EXEC.                                                    26479563
264796                                                                  26479663
264797     EVALUATE TRUE                                                26479763
264798         WHEN SQLCODE = ZERO                                      26479863
264799              SET PS-EAS-TAGGING-FOR-DEPT-NO  TO TRUE             26479963
264800         WHEN SQLCODE = +100                                      26480063
264801              CONTINUE                                            26480163
264802         WHEN OTHER                                               26480263
264803              MOVE 67             TO SU093-ERROR-NBR              26480363
264804              MOVE SQLCODE        TO SU093-SQLCODE                26480463
264805              SET SU093-SQL-ERROR TO TRUE                         26480563
264806     END-EVALUATE.                                                26480663
264807                                                                  26480763
264808 8950-CHECK-FOR-EFC-STORE.                                        26480828
264810                                                                  26481028
264900     SET PS-EFC-STORE-LOCATION-NO  TO TRUE                        26490028
265000                                                                  26500028
265100     IF RECDIS-STR-NBR > 0                                        26510028
265200        MOVE RECDIS-STR-NBR TO XLT00010-LOC-NBR                   26520028
265300     ELSE                                                         26530028
265400         MOVE SU093-KEY-DEST-LOC TO XLT00010-LOC-NBR              26540028
265500     END-IF.                                                      26550028
265600                                                                  26560028
265700     EXEC SQL                                                     26570028
265800         SELECT A.E_BUS_IND                                       26580028
265900           INTO :PS-EFC-STORE-LOCATION-SW                         26590028
266000           FROM XLT_LOC     A                                     26600028
266100          WHERE A.LOC_NBR        = :XLT00010-LOC-NBR              26610028
266200            AND A.LOC_TYP_CDE    = 'DS'                           26620028
266300         WITH UR                                                  26630028
266400     END-EXEC.                                                    26640028
266500                                                                  26650028
266600     EVALUATE TRUE                                                26660028
266700         WHEN SQLCODE = ZERO                                      26670028
266800              CONTINUE                                            26680028
266900         WHEN SQLCODE = +100                                      26690028
267000              SET PS-EFC-STORE-LOCATION-NO    TO TRUE             26700028
267100         WHEN OTHER                                               26710028
267200              MOVE 65             TO SU093-ERROR-NBR              26720063
267300              MOVE SQLCODE        TO SU093-SQLCODE                26730028
267400              SET SU093-SQL-ERROR TO TRUE                         26740028
267500     END-EVALUATE.                                                26750028
267600                                                                  26760028
