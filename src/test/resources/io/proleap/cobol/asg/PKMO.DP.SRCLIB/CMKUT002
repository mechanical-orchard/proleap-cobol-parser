000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             CMKUT002.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           02-21-02.                                00080011
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  FORMAT A CENTRAL E-MAIL MESSAGE DETAILING ANY NON-STANDARD    *00120013
001210*  (BASED ON PERSONNEL OR TIMESTAMP) PRODUCTION RELEASES THAT    *00121011
001220*  OCCURRED DURING THE LAST REPORTING CYCLE (DAY OR WEEKEND).    *00122011
001230*  THE NON-STANDARD PRODUCTION RELEASE NOTICE FILE MUST BE PRE-  *00123011
001240*  SORTED BY REQUESTOR USERID, RELEASED BY USERID, AND RELEASED  *00124011
001250*  TIMESTAMP.  NOTICES WILL BE GROUPED BY REQUESTOR USERID AND   *00125011
001260*  RELEASED BY USERID, SINCE THAT IS LIKELY A SINGLE             *00126011
001270*  INSTALLATION REQUEST, WHICH SHOULD THEN HAVE A SINGLE         *00127011
001280*  TURNOVER PACKAGE.  THE E-MAIL IS INTENDED FOR TARGETED        *00128012
001290*  RESEARCH TO ENSURE THAT NON-STANDARD PRODUCTION RELEASES      *00129012
001291*  STILL HAVE PROPER DOCUMENTATION AND SIGNATURE APPROVAL, AND   *00129112
001292*  ALSO ALLOWS FOR FOLLOW-UP ON PROCEDURES, IF THE PRODUCTION    *00129212
001293*  RELEASE SHOULD NOT HAVE BEEN HANDLED IN A NON-STANDARD        *00129312
001294*  FASHION.                                                      *00129412
001295*                                                                *00129521
001296*  A SEPARATE E-MAIL MESSAGE FILE WILL BE BUILT FOR TARGETED     *00129621
001297*  RESEARCH ON TURNOVERS RELEASED BY THE PERSON WHO STAGED THEM. *00129721
001300******************************************************************00130000
001400                                                                  00140000
001500******************************************************************00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700******************************************************************00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
002000                                                                  00200000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT NONSTD-PROD-REL-FILE                                  00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT EMAIL-NOTICE-FILE                                     00310000
003200         ASSIGN TO OUT01.                                         00320000
003210                                                                  00321015
003220     SELECT SELF-TURNOVER-NOTICE-FILE                             00322015
003230         ASSIGN TO OUT02.                                         00323015
003300                                                                  00330000
003400******************************************************************00340000
003500 DATA DIVISION.                                                   00350000
003600******************************************************************00360000
003700                                                                  00370000
003800 FILE SECTION.                                                    00380000
003900                                                                  00390000
004000 FD  NONSTD-PROD-REL-FILE                                         00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     BLOCK CONTAINS 0 RECORDS                                     00430000
004400     RECORD CONTAINS 80 CHARACTERS                                00440000
004500     DATA RECORDS IS NP-NONSTD-PROD-REL-RECORD.                   00450000
004600                                                                  00460000
004700 01  NP-NONSTD-PROD-REL-RECORD   PIC X(80).                       00470000
004800                                                                  00480000
004900 FD  EMAIL-NOTICE-FILE                                            00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     BLOCK CONTAINS 0 RECORDS                                     00520000
005300     RECORD CONTAINS 80 CHARACTERS                                00530000
005400     DATA RECORDS IS EN-EMAIL-NOTICE-RECORD.                      00540000
005500                                                                  00550000
005600 01  EN-EMAIL-NOTICE-RECORD      PIC X(80).                       00560000
005610                                                                  00561015
005620 FD  SELF-TURNOVER-NOTICE-FILE                                    00562015
005630     RECORDING MODE IS F                                          00563015
005640     LABEL RECORDS ARE STANDARD                                   00564015
005650     BLOCK CONTAINS 0 RECORDS                                     00565015
005660     RECORD CONTAINS 80 CHARACTERS                                00566015
005670     DATA RECORDS IS ST-SELF-TURNOVER-NOTICE-RECORD.              00567015
005680                                                                  00568015
005690 01  ST-SELF-TURNOVER-NOTICE-RECORD                               00569015
005691                                 PIC X(80).                       00569115
005700                                                                  00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900                                                                  00590000
006000*                                                                 00600000
006100*  NON-STANDARD PRODUCTION RELEASE NOTICE FILE RECORD LAYOUT      00610000
006200*                                                                 00620000
006300                                                                  00630000
006400     COPY CMRD002.                                                00640000
006500                                                                  00650000
006600 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          00660000
006700                                              COMP SYNC.          00670000
006800                                                                  00680000
006900 01  PS-PROGRAM-SWITCHES.                                         00690000
007000     05  PS-END-OF-NONSTD-FILE-SW                                 00700000
007100                                 PIC X(1)     VALUE 'N'.          00710000
007200         88  PS-END-OF-NONSTD-FILE            VALUE 'Y'.          00720000
007201     05  PS-FIRST-SELF-TURNOVER-SW                                00720115
007202                                 PIC X(1)     VALUE 'Y'.          00720217
007210         88  PS-FIRST-SELF-TURNOVER           VALUE 'Y'.          00721015
007220         88  PS-NOT-FIRST-SELF-TURNOVER       VALUE 'N'.          00722015
007230     05  PS-FIRST-REQ-REL-SELF-TURN-SW                            00723017
007240                                 PIC X(1)     VALUE 'N'.          00724017
007250         88  PS-FIRST-REQ-REL-SELF-TURN       VALUE 'Y'.          00725017
007260         88  PS-NOT-FIRST-REQ-REL-SELF-TURN   VALUE 'N'.          00726017
007300                                                                  00730000
007400 01  PC-PROGRAM-CONSTANTS.                                        00740000
007500     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'CMKUT002'.   00750000
007600                                                                  00760000
007700 01  PV-PROGRAM-VARIABLES.                                        00770000
007800     05  PV-CURRENT-REQUESTER-USERID                              00780000
007900                                 PIC X(8)     VALUE SPACES.       00790000
008000     05  PV-CURRENT-RELEASED-BY-USERID                            00800000
008100                                 PIC X(8)     VALUE SPACES.       00810000
008200     05  PV-OBJECT-RELEASE-DATE-TIME.                             00820001
008300         10  PV-OR-RELEASE-DATE-YEAR                              00830001
008400                                 PIC X(4)     VALUE SPACES.       00840007
008500         10  FILLER              PIC X(1)     VALUE '/'.          00850001
008600         10  PV-OR-RELEASE-DATE-MONTH                             00860001
008700                                 PIC X(2)     VALUE SPACES.       00870001
008800         10  FILLER              PIC X(1)     VALUE '/'.          00880001
008900         10  PV-OR-RELEASE-DATE-DAY                               00890001
009000                                 PIC X(2)     VALUE SPACES.       00900001
009100         10  FILLER              PIC X(1)     VALUE SPACES.       00910001
009200         10  PV-OR-RELEASE-TIME-HOUR                              00920001
009300                                 PIC X(2)     VALUE SPACES.       00930001
009400         10  FILLER              PIC X(1)     VALUE ':'.          00940001
009500         10  PV-OR-RELEASE-TIME-MINUTE                            00950001
009600                                 PIC X(2)     VALUE SPACES.       00960001
009700         10  FILLER              PIC X(1)     VALUE ':'.          00970001
009800         10  PV-OR-RELEASE-TIME-SECOND                            00980001
009900                                 PIC X(2)     VALUE SPACES.       00990001
009910     05  PV-OBJECT-TYPE-DESCRIPTION                               00991002
009911                                 PIC X(20)    VALUE SPACES.       00991102
009920         88  PV-OT-JOB                        VALUE 'JOB'.        00992002
009930         88  PV-OT-PROC                       VALUE 'PROC'.       00993002
009940         88  PV-OT-CONTROL-MEMBER             VALUE               00994002
009941             'CONTROL MEMBER'.                                    00994102
009950         88  PV-OT-COPYBOOK                   VALUE 'COPYBOOK'.   00995002
009960         88  PV-OT-BMS-MAP                    VALUE 'BMS MAP'.    00996002
009970         88  PV-OT-COBOL-PROGRAM              VALUE               00997002
009971             'COBOL PROGRAM'.                                     00997102
009980         88  PV-OT-DYL280-PROGRAM             VALUE               00998002
009981             'DYL280 PROGRAM'.                                    00998102
009990         88  PV-OT-ASSEMBLER-PROGRAM          VALUE               00999002
009991             'ASSEMBLER PROGRAM'.                                 00999102
009992         88  PV-OT-GDG                        VALUE 'GDG'.        00999202
009993         88  PV-OT-ARCHIVAL                   VALUE 'ARCHIVAL'.   00999302
009994         88  PV-OT-MNEMONIC                   VALUE 'MNEMONIC'.   00999402
009995         88  PV-OT-SQR-PROGRAM                VALUE 'SQR PROGRAM'.00999502
009996         88  PV-OT-SQR-INCLUDE                VALUE 'SQR INCLUDE'.00999602
009997         88  PV-OT-UNKNOWN                    VALUE               00999702
009998             '** UNKNOWN **'.                                     00999802
009999     05  PV-PROD-RELEASE-TYPE-QUAL                                00999902
010000                                 PIC X(19)    VALUE SPACES.       01000004
010001         88  PV-PR-NORMAL-RELEASE             VALUE SPACES.       01000102
010002         88  PV-PR-BYPASS-RELEASE             VALUE               01000202
010003             'BYPASS QA/LRN'.                                     01000304
010004         88  PV-PR-DEFERRED-RELEASE           VALUE               01000402
010005             'COMPLETE DEFERRED'.                                 01000504
010006         88  PV-PR-ARCH-JOB                   VALUE 'JOB'.        01000604
010008         88  PV-PR-ARCH-PROC                  VALUE 'PROC'.       01000804
010010         88  PV-PR-ARCH-CONTROL-MEMBER        VALUE               01001002
010011             'CONTROL MEMBER'.                                    01001104
010012         88  PV-PR-ARCH-COPYBOOK              VALUE 'COPYBOOK'.   01001204
010013         88  PV-PR-ARCH-BMS-MAP               VALUE 'BMS MAP'.    01001304
010014         88  PV-PR-ARCH-PROGRAM               VALUE 'PROGRAM'.    01001404
010015         88  PV-PR-UNKNOWN                    VALUE               01001503
010016             '**UNKNOWN**'.                                       01001604
010017     05  PV-PROD-RELEASE-TYPE    PIC X(42)    VALUE SPACES.       01001703
010021                                                                  01002115
010030*                                                                 01003011
010031*  FOR PRINTING E-MAIL MESSAGES, THE PRACTICAL LIMIT TO AVOID     01003111
010032*  WRAPPING IS 78, NOT 80.  ANYTHING OUTSIDE OF INSTRUCTIONAL     01003211
010033*  MESSAGES SHOULD NOT EXCEED 78 CHARACTERS.                      01003311
010034*                                                                 01003411
010040                                                                  01004011
010100 01  EN-EMAIL-NOTICE-LINES.                                       01010000
010200     05  EN-TITLE                PIC X(80)    VALUE               01020000
010300         'NON-STANDARD PRODUCTION RELEASES FROM THE LAST DAY/WEEKE01030011
010400-        'ND'.                                                    01040011
010410     05  EN-INSTRUCTION-LINE-1   PIC X(80)    VALUE               01041004
010420         'THESE RELEASES MAY NOT HAVE PROPER PAPERWORK, APPROVAL, 01042011
010430-        'OR SIGNATURES.'.                                        01043011
010440     05  EN-INSTRUCTION-LINE-2   PIC X(80)    VALUE               01044004
010450         'PLEASE REVIEW FOR COMPLETENESS, AND ENSURE THAT PROPER P01045011
010460-        'ROCEDURES WERE FOLLOWED.'.                              01046011
010500     05  EN-CREATED-LINE.                                         01050001
010600         10  FILLER              PIC X(16)    VALUE               01060001
010700             'E-MAIL CREATED: '.                                  01070001
010800         10  EN-CL-YEAR          PIC X(4)     VALUE SPACES.       01080006
010900         10  FILLER              PIC X(1)     VALUE '/'.          01090001
011000         10  EN-CL-MONTH         PIC X(2)     VALUE SPACES.       01100001
011100         10  FILLER              PIC X(1)     VALUE '/'.          01110001
011200         10  EN-CL-DAY           PIC X(2)     VALUE SPACES.       01120001
011300         10  FILLER              PIC X(1)     VALUE SPACES.       01130001
011400         10  EN-CL-HOUR          PIC X(2)     VALUE SPACES.       01140001
011500         10  FILLER              PIC X(1)     VALUE ':'.          01150001
011600         10  EN-CL-MINUTE        PIC X(2)     VALUE SPACES.       01160001
011700         10  FILLER              PIC X(1)     VALUE ':'.          01170001
011800         10  EN-CL-SECOND        PIC X(2)     VALUE SPACES.       01180001
011900     05  EN-REQUESTER-RELEASED-BY-LINE.                           01190000
012000         10  FILLER              PIC X(14)    VALUE               01200000
012100             'REQUESTED BY: '.                                    01210000
012200         10  EN-RR-REQUESTER-USERID                               01220001
012300                                 PIC X(8)     VALUE SPACES.       01230001
012400         10  FILLER              PIC X(17)    VALUE               01240000
012500             '   RELEASED BY: '.                                  01250000
012600         10  EN-RR-RELEASED-BY-USERID                             01260001
012700                                 PIC X(8)     VALUE SPACES.       01270000
012800         10  FILLER              PIC X(33)    VALUE SPACES.       01280000
012900     05  EN-OBJECT-DETAIL-LINE.                                   01290000
013000         10  FILLER              PIC X(4)     VALUE SPACES.       01300001
013100         10  EN-OD-OBJECT-RELEASE-DATE-TIME                       01310001
013200                                 PIC X(19)    VALUE SPACES.       01320008
013300         10  FILLER              PIC X(3)     VALUE SPACES.       01330001
013400         10  EN-OD-OBJECT-NAME   PIC X(8)     VALUE SPACES.       01340001
013500         10  FILLER              PIC X(2)     VALUE SPACES.       01350001
013510         10  EN-OD-PROD-RELEASE-TYPE                              01351003
013520                                 PIC X(42)    VALUE SPACES.       01352003
013530         10  FILLER              PIC X(4)     VALUE SPACES.       01353003
013531                                                                  01353103
013540     05  EN-NONSTD-NOTICE-LINE.                                   01354003
013550         10  FILLER              PIC X(6)     VALUE SPACES.       01355004
013551         10  FILLER              PIC X(3)     VALUE '**'.         01355103
013552         10  EN-NN-NONSTD-NOTICE-MESSAGE                          01355203
013553                                 PIC X(71)    VALUE SPACES.       01355303
013556             88  EN-NN-REL-BY-REQUESTER       VALUE               01355614
013557                 'THIS WAS RELEASED BY THE SAME PERSON WHO STAGED 01355714
013558-                'THE TURNOVER REQUEST'.                          01355814
013559             88  EN-NN-REL-BY-OTHER-PROD-MVR  VALUE               01355914
013560                 'THIS WAS RELEASED BY SOMEONE OUTSIDE OF THE PROD01356014
013561-                'UCTION CONTROL GROUP'.                          01356114
013562             88  EN-NN-REL-BY-PROD-CNTL-AUTH  VALUE               01356214
013563                 'THIS WAS RELEASED BY SOMEONE NOT PRIMARILY IN PR01356314
013564-                'ODUCTION CONTROL'.                              01356414
013570             88  EN-NN-REL-DURING-OFF-HOURS   VALUE               01357003
013580                 'THIS WAS RELEASED OUTSIDE OF NORMAL WORKING HOUR01358004
013590-                'S'.                                             01359004
013600                                                                  01360000
013610 01  ST-SELF-TURNOVER-LINES.                                      01361017
013611     05  ST-TITLE-2              PIC X(80)    VALUE               01361117
013612         'RELEASED BY REQUESTER NOTICES'.                         01361220
013620     05  ST-REQUESTER-RELEASED-LINE                               01362017
013630                                 PIC X(80)    VALUE SPACES.       01363017
013640                                                                  01364017
013700******************************************************************01370000
013800 PROCEDURE DIVISION.                                              01380000
013900******************************************************************01390000
014000                                                                  01400000
014100 0000-MAINLINE.                                                   01410000
014200                                                                  01420000
014300     PERFORM 1000-INITIALIZE.                                     01430000
014400                                                                  01440000
014500     PERFORM 2000-PROCESS-REQ-REL-BY                              01450000
014600         UNTIL PS-END-OF-NONSTD-FILE.                             01460000
014700                                                                  01470000
014800     PERFORM 9000-EOJ-ROUTINE.                                    01480000
014900                                                                  01490000
015000     GOBACK.                                                      01500000
015100                                                                  01510000
015200******************************************************************01520000
015300*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES.  READ THE *01530000
015400*  THE FIRST NON-STANDARD PRODUCTION RELEASE NOTICE RECORD.      *01540000
015500*  WRITE OUT ALL E-MAIL NOTICE HEADER INFORMATION.               *01550000
015600******************************************************************01560000
015700                                                                  01570000
015800 1000-INITIALIZE.                                                 01580000
015900     OPEN INPUT  NONSTD-PROD-REL-FILE                             01590000
016000          OUTPUT EMAIL-NOTICE-FILE                                01600015
016010                 SELF-TURNOVER-NOTICE-FILE.                       01601015
016100                                                                  01610000
016200     MOVE FUNCTION CURRENT-DATE (1:4) TO EN-CL-YEAR.              01620001
016300     MOVE FUNCTION CURRENT-DATE (5:2) TO EN-CL-MONTH.             01630001
016400     MOVE FUNCTION CURRENT-DATE (7:2) TO EN-CL-DAY.               01640001
016500     MOVE FUNCTION CURRENT-DATE (9:2) TO EN-CL-HOUR.              01650001
016600     MOVE FUNCTION CURRENT-DATE (11:2) TO EN-CL-MINUTE.           01660001
016700     MOVE FUNCTION CURRENT-DATE (13:2) TO EN-CL-SECOND.           01670001
016800                                                                  01680000
016900     PERFORM 7000-READ-NONSTD-PROD-REL-FILE.                      01690000
017000                                                                  01700000
017100     IF (NOT PS-END-OF-NONSTD-FILE)                               01710000
017200         MOVE EN-TITLE TO EN-EMAIL-NOTICE-RECORD                  01720000
017300         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01730000
017400         INITIALIZE EN-EMAIL-NOTICE-RECORD                        01740000
017500         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01750000
017510         MOVE EN-INSTRUCTION-LINE-1 TO EN-EMAIL-NOTICE-RECORD     01751004
017520         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01752004
017530         MOVE EN-INSTRUCTION-LINE-2 TO EN-EMAIL-NOTICE-RECORD     01753004
017540         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01754004
017550         INITIALIZE EN-EMAIL-NOTICE-RECORD                        01755004
017560         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01756004
017570         MOVE EN-CREATED-LINE TO EN-EMAIL-NOTICE-RECORD           01757008
017580         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01758008
017590         INITIALIZE EN-EMAIL-NOTICE-RECORD                        01759008
017591         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   01759108
017600     END-IF.                                                      01760000
017700*1000-EXIT.                                                       01770000
017800                                                                  01780000
017900******************************************************************01790000
018000*  PROCESS A REQUESTOR/RELEASED BY COMBINATION.  THIS IS         *01800011
018010*  PERCEIVED AS A LIKELY TURNOVER UNIT.  WRITE OUT THE GROUPING  *01801011
018020*  HEADER.  PROCESS ALL RELATED NON-STANDARD PRODUCTION RELEASE  *01802011
018030*  NOTICES.                                                      *01803011
018100******************************************************************01810000
018200                                                                  01820000
018300 2000-PROCESS-REQ-REL-BY.                                         01830000
018400     MOVE CM002-REQUESTER-USERID TO PV-CURRENT-REQUESTER-USERID   01840000
018500                                    EN-RR-REQUESTER-USERID.       01850001
018600     MOVE CM002-RELEASED-BY-USERID TO                             01860000
018700               PV-CURRENT-RELEASED-BY-USERID                      01870000
018800               EN-RR-RELEASED-BY-USERID.                          01880001
018900                                                                  01890000
019000     INITIALIZE EN-EMAIL-NOTICE-RECORD.                           01900000
019100     PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD.                      01910000
019200     MOVE EN-REQUESTER-RELEASED-BY-LINE TO                        01920015
019201               EN-EMAIL-NOTICE-RECORD                             01920115
019210               ST-REQUESTER-RELEASED-LINE                         01921017
019300     PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD.                      01930000
019400     INITIALIZE EN-EMAIL-NOTICE-RECORD.                           01940001
019500     PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD.                      01950001
019600                                                                  01960000
019601     SET PS-FIRST-REQ-REL-SELF-TURN TO TRUE.                      01960117
019610                                                                  01961015
019700     PERFORM 3000-PROCESS-RELEASE-OBJECT                          01970000
019800         UNTIL ((PS-END-OF-NONSTD-FILE)                           01980000
019900                 OR (CM002-REQUESTER-USERID NOT =                 01990000
020000                                  PV-CURRENT-REQUESTER-USERID)    02000000
020100                 OR (CM002-RELEASED-BY-USERID NOT =               02010000
020200                                  PV-CURRENT-RELEASED-BY-USERID)).02020000
020300*2000-EXIT.                                                       02030000
020400                                                                  02040000
020500******************************************************************02050000
020600*  PROCESS AN INDIVIDUAL NON-STANDARD PRODUCTION RELEASE NOTICE, *02060011
020610*  WHICH WILL RELATE TO A SINGLE OBJECT.  PREPARE A DETAIL LINE, *02061011
020620*  SPECIFYING THE OBJECT TYPE AND ANY ADDITIONAL INFORMATION     *02062011
020630*  ABOUT EXCEPTIONS TO A NORMAL RELEASE.  WRITE OUT INDENTED     *02063011
020640*  NON-STANDARD PRODUCTION RELEASE NOTICE MESSAGES FOR EACH      *02064011
020650*  EXCEPTION THAT RELATES TO THIS NOTICE.                        *02065011
020700******************************************************************02070000
020800                                                                  02080000
020900 3000-PROCESS-RELEASE-OBJECT.                                     02090000
021000     MOVE CM002-RELEASE-DATE-YEAR TO PV-OR-RELEASE-DATE-YEAR.     02100001
021100     MOVE CM002-RELEASE-DATE-MONTH TO PV-OR-RELEASE-DATE-MONTH.   02110001
021200     MOVE CM002-RELEASE-DATE-DAY TO PV-OR-RELEASE-DATE-DAY.       02120001
021300     MOVE CM002-RELEASE-TIME-HOUR TO PV-OR-RELEASE-TIME-HOUR.     02130001
021400     MOVE CM002-RELEASE-TIME-MINUTE TO PV-OR-RELEASE-TIME-MINUTE. 02140001
021500     MOVE CM002-RELEASE-TIME-SECOND TO PV-OR-RELEASE-TIME-SECOND. 02150001
021600     MOVE PV-OBJECT-RELEASE-DATE-TIME TO                          02160001
021700               EN-OD-OBJECT-RELEASE-DATE-TIME.                    02170001
021800     MOVE CM002-OBJECT-NAME TO EN-OD-OBJECT-NAME.                 02180001
021900                                                                  02190000
022000     EVALUATE TRUE                                                02200000
022100         WHEN CM002-OT-JOB                                        02210000
022110             SET PV-OT-JOB TO TRUE                                02211002
022200         WHEN CM002-OT-PROC                                       02220000
022210             SET PV-OT-PROC TO TRUE                               02221002
022300         WHEN CM002-OT-CONTROL-MEMBER                             02230000
022310             SET PV-OT-CONTROL-MEMBER TO TRUE                     02231002
022400         WHEN CM002-OT-COPYBOOK                                   02240000
022410             SET PV-OT-COPYBOOK TO TRUE                           02241002
022500         WHEN CM002-OT-BMS-MAP                                    02250000
022510             SET PV-OT-BMS-MAP TO TRUE                            02251002
022600         WHEN CM002-OT-COBOL-PROGRAM                              02260000
022610             SET PV-OT-COBOL-PROGRAM TO TRUE                      02261002
022700         WHEN CM002-OT-DYL280-PROGRAM                             02270000
022710             SET PV-OT-DYL280-PROGRAM TO TRUE                     02271002
022800         WHEN CM002-OT-ASSEMBLER-PROGRAM                          02280000
022810             SET PV-OT-ASSEMBLER-PROGRAM TO TRUE                  02281002
022900         WHEN CM002-OT-GDG                                        02290000
022910             SET PV-OT-GDG TO TRUE                                02291002
023000         WHEN CM002-OT-ARCHIVAL                                   02300000
023010             SET PV-OT-ARCHIVAL TO TRUE                           02301002
023100         WHEN CM002-OT-MNEMONIC                                   02310000
023110             SET PV-OT-MNEMONIC TO TRUE                           02311002
023200         WHEN CM002-OT-SQR-PROGRAM                                02320000
023210             SET PV-OT-SQR-PROGRAM TO TRUE                        02321002
023300         WHEN CM002-OT-SQR-INCLUDE                                02330000
023310             SET PV-OT-SQR-INCLUDE TO TRUE                        02331002
023320         WHEN OTHER                                               02332002
023330             SET PV-OT-UNKNOWN TO TRUE                            02333002
023400     END-EVALUATE.                                                02340000
023580                                                                  02358003
023600     EVALUATE TRUE                                                02360000
023700         WHEN CM002-OT-ARCHIVAL                                   02370000
023800             EVALUATE TRUE                                        02380000
023900                 WHEN CM002-PR-ARCH-JOB                           02390000
023910                     SET PV-PR-ARCH-JOB TO TRUE                   02391003
024000                 WHEN CM002-PR-ARCH-PROC                          02400000
024010                     SET PV-PR-ARCH-PROC TO TRUE                  02401003
024100                 WHEN CM002-PR-ARCH-CONTROL-MEMBER                02410000
024110                     SET PV-PR-ARCH-CONTROL-MEMBER TO TRUE        02411003
024200                 WHEN CM002-PR-ARCH-COPYBOOK                      02420000
024210                     SET PV-PR-ARCH-COPYBOOK TO TRUE              02421003
024300                 WHEN CM002-PR-ARCH-BMS-MAP                       02430000
024310                     SET PV-PR-ARCH-BMS-MAP TO TRUE               02431003
024400                 WHEN CM002-PR-ARCH-PROGRAM                       02440000
024410                     SET PV-PR-ARCH-PROGRAM TO TRUE               02441003
024500             END-EVALUATE                                         02450000
024600         WHEN OTHER                                               02460000
024700             EVALUATE TRUE                                        02470000
024800                 WHEN CM002-PR-BYPASS-RELEASE                     02480000
024810                     SET PV-PR-BYPASS-RELEASE TO TRUE             02481003
024900                 WHEN CM002-PR-DEFERRED-RELEASE                   02490000
024901                     SET PV-PR-DEFERRED-RELEASE TO TRUE           02490103
024910                 WHEN OTHER                                       02491003
024920                     SET PV-PR-NORMAL-RELEASE TO TRUE             02492003
025000             END-EVALUATE                                         02500000
025100     END-EVALUATE.                                                02510000
025110                                                                  02511003
025120     IF PV-PR-NORMAL-RELEASE                                      02512003
025131         MOVE PV-OBJECT-TYPE-DESCRIPTION TO PV-PROD-RELEASE-TYPE  02513103
025140     ELSE                                                         02514003
025141         INITIALIZE PV-PROD-RELEASE-TYPE                          02514103
025142         STRING PV-OBJECT-TYPE-DESCRIPTION       DELIMITED BY '  '02514203
025143                ' ('                             DELIMITED BY SIZE02514304
025144                PV-PROD-RELEASE-TYPE-QUAL        DELIMITED BY '  '02514403
025145                ')'                              DELIMITED BY SIZE02514505
025146             INTO PV-PROD-RELEASE-TYPE                            02514603
025150     END-IF.                                                      02515003
025151     MOVE PV-PROD-RELEASE-TYPE TO EN-OD-PROD-RELEASE-TYPE.        02515107
025160                                                                  02516003
025170     MOVE EN-OBJECT-DETAIL-LINE TO EN-EMAIL-NOTICE-RECORD.        02517003
025180     PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD.                      02518003
025190                                                                  02519014
025191     IF (CM002-RELEASED-BY-USERID = CM002-REQUESTER-USERID)       02519114
025192         SET EN-NN-REL-BY-REQUESTER TO TRUE                       02519214
025193         MOVE EN-NONSTD-NOTICE-LINE TO EN-EMAIL-NOTICE-RECORD     02519314
025194         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   02519414
025195*                                                                 02519521
025196*  THE ENTIRE TARGETED EMAIL FOR REVIEW OF CASES WHERE OBJECTS    02519621
025197*  WERE TURNED OVER BY THE PERSON WHO STAGED THEM WILL ONLY BE    02519721
025198*  BUILT WHEN THOSE EXCEPTIONS ARE DETECTED.  TITLE AND HEADER    02519821
025199*  LINES WILL ONLY BE BUILT WHEN THERE ARE EXCEPTIONS, SO THE     02519921
025200*  FILE WILL REMAIN EMPTY WHEN PROCESSING FOR ANY CYCLE WHERE     02520021
025201*  NO EXCEPTIONS OCCURRED.                                        02520121
025202*                                                                 02520221
025203         IF (PS-FIRST-SELF-TURNOVER)                              02520321
025204             SET PS-NOT-FIRST-SELF-TURNOVER TO TRUE               02520421
025205             MOVE EN-TITLE TO ST-SELF-TURNOVER-NOTICE-RECORD      02520521
025206             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02520621
025207             INITIALIZE ST-SELF-TURNOVER-NOTICE-RECORD            02520721
025208             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02520821
025209             MOVE ST-TITLE-2 TO ST-SELF-TURNOVER-NOTICE-RECORD    02520921
025210             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02521021
025211             INITIALIZE ST-SELF-TURNOVER-NOTICE-RECORD            02521121
025212             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02521221
025213         END-IF                                                   02521321
025214         IF (PS-FIRST-REQ-REL-SELF-TURN)                          02521421
025215             SET PS-NOT-FIRST-REQ-REL-SELF-TURN TO TRUE           02521521
025216             INITIALIZE ST-SELF-TURNOVER-NOTICE-RECORD            02521621
025217             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02521721
025218             MOVE ST-REQUESTER-RELEASED-LINE TO                   02521821
025219                       ST-SELF-TURNOVER-NOTICE-RECORD             02521921
025220             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02522021
025221             INITIALIZE ST-SELF-TURNOVER-NOTICE-RECORD            02522121
025222             PERFORM 8100-WRITE-SELF-TURNOVER-RCD                 02522221
025223         END-IF                                                   02522321
025224         MOVE EN-OBJECT-DETAIL-LINE TO                            02522421
025225                   ST-SELF-TURNOVER-NOTICE-RECORD                 02522521
025226         PERFORM 8100-WRITE-SELF-TURNOVER-RCD                     02522621
025227         MOVE EN-NONSTD-NOTICE-LINE TO                            02522721
025228                   ST-SELF-TURNOVER-NOTICE-RECORD                 02522821
025229         PERFORM 8100-WRITE-SELF-TURNOVER-RCD                     02522921
025230     END-IF.                                                      02523021
025240                                                                  02524021
025300     EVALUATE TRUE                                                02530000
025400         WHEN CM002-PC-REL-BY-OTHER-PROD-MVR                      02540000
025401             SET EN-NN-REL-BY-OTHER-PROD-MVR TO TRUE              02540104
025410             MOVE EN-NONSTD-NOTICE-LINE TO EN-EMAIL-NOTICE-RECORD 02541004
025420             PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD               02542004
025500         WHEN CM002-PC-REL-BY-PROD-CNTL-AUTH                      02550000
025501             SET EN-NN-REL-BY-PROD-CNTL-AUTH TO TRUE              02550104
025510             MOVE EN-NONSTD-NOTICE-LINE TO EN-EMAIL-NOTICE-RECORD 02551004
025520             PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD               02552004
025600     END-EVALUATE.                                                02560000
025700                                                                  02570000
025800     IF CM002-OH-REL-DURING-OFF-HOURS                             02580000
025801         SET EN-NN-REL-DURING-OFF-HOURS TO TRUE                   02580104
025810         MOVE EN-NONSTD-NOTICE-LINE TO EN-EMAIL-NOTICE-RECORD     02581004
025820         PERFORM 8000-WRITE-EMAIL-NOTICE-RECORD                   02582004
025900     END-IF.                                                      02590000
026000                                                                  02600000
026100     PERFORM 7000-READ-NONSTD-PROD-REL-FILE.                      02610000
026200*3000-EXIT.                                                       02620000
026300                                                                  02630000
026400******************************************************************02640000
026500*  READ A NON-STANDARD PRODUCTION RELEASE NOTICE FILE RECORD.    *02650011
026600******************************************************************02660000
026700                                                                  02670000
026800 7000-READ-NONSTD-PROD-REL-FILE.                                  02680000
026900     READ NONSTD-PROD-REL-FILE                                    02690000
027000         INTO CM002-NONSTD-PROD-REL-RECORD                        02700000
027100         AT END                                                   02710000
027200             SET PS-END-OF-NONSTD-FILE TO TRUE                    02720000
027300     END-READ.                                                    02730000
027400*7000-EXIT.                                                       02740000
027500                                                                  02750000
027600******************************************************************02760000
027700*  WRITE AN E-MAIL NOTICE RECORD.                                *02770000
027800******************************************************************02780000
027900                                                                  02790000
028000 8000-WRITE-EMAIL-NOTICE-RECORD.                                  02800000
028100     WRITE EN-EMAIL-NOTICE-RECORD.                                02810000
028200*8000-EXIT.                                                       02820000
028210                                                                  02821015
028220******************************************************************02822015
028230*  WRITE A SELF TURNOVER NOTICE RECORD.                          *02823015
028240******************************************************************02824015
028250                                                                  02825015
028260 8100-WRITE-SELF-TURNOVER-RCD.                                    02826015
028270     WRITE ST-SELF-TURNOVER-NOTICE-RECORD.                        02827015
028280*8100-EXIT.                                                       02828015
028300                                                                  02830000
028400******************************************************************02840000
028500*  CLOSE ALL FILES.                                              *02850000
028600******************************************************************02860000
028700                                                                  02870000
028800 9000-EOJ-ROUTINE.                                                02880000
028900     CLOSE NONSTD-PROD-REL-FILE                                   02890000
029000           EMAIL-NOTICE-FILE                                      02900015
029010           SELF-TURNOVER-NOTICE-FILE.                             02901015
029100*9000-EXIT.                                                       02910000
