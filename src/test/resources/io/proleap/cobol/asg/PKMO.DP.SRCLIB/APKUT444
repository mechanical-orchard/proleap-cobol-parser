000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT444.                                        00020000
000300 AUTHOR.         JEAN KURK.                                       00030000
000400 DATE-WRITTEN.   04/14/2022.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060000
000800*  ACCUMULATE MATCH STATS AND CALC PERCENTAGES BY VENDOR         *00070000
000801*----------------------------------------------------------------*00080000
000900*                                                                *00082000
000910*     THIS IS A COPY OF APKUT021 THAT PRODUCES TOTALS BY VENDOR. *00083000
000910*     THIS PROGRAM READS A WEEK WORTH OF TPOSTRR BACKUP FILES    *00083100
000920*     AND COUNTS OCCURRENCES OF BULK VS BY-STORE WITHIN EACH     *00084000
000930*     PAY-RELEASE SOURCE AND CALCULATES PERCENT TO TOTAL OF      *00085000
000931*     EACH CATEGORY.  ALSO COUNTS IMPORTS SO THEY CAN BE         *00086000
000932*     BACKED OUT OF THE BATCH/BULK TOTAL IF NECESSARY.           *00087000
000933*                                                                *00088000
000934*     NOTE THAT THE IMPORT TALLY IS NOT PERFECT.  IT ASSUMES     *00089000
000935*     THAT IMPORT POS ARE THE ONLY ONES THAT CAN HAVE TOLERANCE  *00090000
000936*     OVER $200, BUT IT COULD MISS IMPORT POS IF THE TOLERANCE   *00091000
000937*     WERE UNDER $200.                                           *00092000
000940*                                                                *00093000
001000* INPUT:                                                         *00094000
001100*  1. VENDOR/PO/STORE RELEASE FILE        COPYBOOK APRD444       *00095000
001200*                                                                *00096000
001300* OUTPUT:                                                        *00097000
001400*  1. VENDOR/STATISTICS TEXT FILE                                *00098000
001500*                                                                *00100000
001600*----------------------------------------------------------------*00110000
001601* CHANGE LOG:                                                   * 00120000
001602*                                                               * 00130000
001603* DATE  04/25/2022                                              * 00160200
001604*     CHANGE MADE: NEW PROGRAM TO CREATE STATS BY VENDOR        * 00160300
001606*     MADE BY: JEAN KURK               WR/IR #: CHG0269057      * 00160500
001607*----------------------------------------------------------------*00160600
001700                                                                  00160700
001800 ENVIRONMENT DIVISION.                                            00160800
001900 CONFIGURATION SECTION.                                           00160900
002000 SOURCE-COMPUTER.    IBM-3090.                                    00161000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00162000
002200                                                                  00163000
002300 INPUT-OUTPUT SECTION.                                            00164000
002400 FILE-CONTROL.                                                    00165000
002500     SELECT VENDOR-FILE   ASSIGN TO UT-S-INP01.                   00166000
002600     SELECT STATS-FILE    ASSIGN TO UT-S-OUT01.                   00167000
002700                                                                  00169000
002800 DATA DIVISION.                                                   00170000
002900 FILE SECTION.                                                    00180000
003000                                                                  00190000
003100 FD  VENDOR-FILE                                                  00200000
003200     RECORDING MODE IS F                                          00210000
003300     LABEL RECORDS ARE STANDARD                                   00220000
003400     BLOCK CONTAINS 0 RECORDS.                                    00230000
003500 01  VENDOR-REC.                                                  00240000
003600     05  FILLER                       PIC  X(100).                00250000
003700                                                                  00260000
003800 FD  STATS-FILE                                                   00270000
003900     RECORDING MODE IS F                                          00280000
004000     LABEL RECORDS ARE STANDARD                                   00290000
004100     BLOCK CONTAINS 0 RECORDS.                                    00300000
004200 01  STATS-REC.                                                   00310000
004300     05  FILLER                       PIC  X(254).                00320010
004400                                                                  00330000
004600 WORKING-STORAGE SECTION.                                         00420000
004700                                                                  00430000
004800 01  EOF-SW                           PIC X     VALUE 'N'.        00440000
004900     88  IN-EOF                                 VALUE 'Y'.        00450000
005000 01  PROGRAM-VARIABLES.                                           00460000
005100     05  PV-BATCH-COUNT               PIC S9(7) VALUE ZERO.       00470000
005110     05  PV-BATCH-BULK-COUNT          PIC S9(7) VALUE ZERO.       00480000
005120     05  PV-BATCH-DC-COUNT            PIC S9(7) VALUE ZERO.       00490000
005121     05  PV-BATCH-STORE-COUNT         PIC S9(7) VALUE ZERO.       00500000
005130     05  PV-MANUAL-COUNT              PIC S9(7) VALUE ZERO.       00510000
005131     05  PV-MANUAL-BULK-COUNT         PIC S9(7) VALUE ZERO.       00511000
005132     05  PV-MANUAL-DC-COUNT           PIC S9(7) VALUE ZERO.       00512000
005133     05  PV-MANUAL-STORE-COUNT        PIC S9(7) VALUE ZERO.       00513000
005134     05  PV-AUTO-COUNT                PIC S9(7) VALUE ZERO.       00513100
005135     05  PV-AUTO-BULK-COUNT           PIC S9(7) VALUE ZERO.       00513200
005136     05  PV-AUTO-DC-COUNT             PIC S9(7) VALUE ZERO.       00513300
005137     05  PV-AUTO-STORE-COUNT          PIC S9(7) VALUE ZERO.       00513400
005138     05  PV-TOTAL-COUNT               PIC S9(8) VALUE ZERO.       00513500
005139     05  PV-TOTAL-BULK-COUNT          PIC S9(7) VALUE ZERO.       00513600
005140     05  PV-TOTAL-DC-COUNT            PIC S9(7) VALUE ZERO.       00513700
005141     05  PV-TOTAL-STORE-COUNT         PIC S9(7) VALUE ZERO.       00513800
005142     05  PV-BATCH-PERCENT             PIC S9(3)V99999 VALUE ZERO. 00513900
005143     05  PV-MANUAL-PERCENT            PIC S9(3)V99999 VALUE ZERO. 00514000
005144     05  PV-AUTO-PERCENT              PIC S9(3)V99999 VALUE ZERO. 00514100
005145     05  PV-BULK-PERCENT              PIC S9(3)V99999 VALUE ZERO. 00514200
005146     05  PV-DC-PERCENT                PIC S9(3)V99999 VALUE ZERO. 00514300
005147     05  PV-STORE-PERCENT             PIC S9(3)V99999 VALUE ZERO. 00514400
005148     05  PV-IMPORT-COUNT              PIC S9(7) VALUE ZERO.       00514500
005100     05  PV-TOT-BATCH-COUNT           PIC  9(7) VALUE ZERO.       00514608
005110     05  PV-TOT-BATCH-BULK-COUNT      PIC  9(7) VALUE ZERO.       00514708
005120     05  PV-TOT-BATCH-DC-COUNT        PIC  9(7) VALUE ZERO.       00514808
005121     05  PV-TOT-BATCH-STORE-COUNT     PIC  9(7) VALUE ZERO.       00514908
005130     05  PV-TOT-MANUAL-COUNT          PIC  9(7) VALUE ZERO.       00515008
005131     05  PV-TOT-MANUAL-BULK-COUNT     PIC  9(7) VALUE ZERO.       00515108
005132     05  PV-TOT-MANUAL-DC-COUNT       PIC  9(7) VALUE ZERO.       00515208
005133     05  PV-TOT-MANUAL-STORE-COUNT    PIC  9(7) VALUE ZERO.       00515308
005134     05  PV-TOT-AUTO-COUNT            PIC  9(7) VALUE ZERO.       00515408
005135     05  PV-TOT-AUTO-BULK-COUNT       PIC  9(7) VALUE ZERO.       00515508
005136     05  PV-TOT-AUTO-DC-COUNT         PIC  9(7) VALUE ZERO.       00515608
005137     05  PV-TOT-AUTO-STORE-COUNT      PIC  9(7) VALUE ZERO.       00515708
005138     05  PV-TOT-TOTAL-COUNT           PIC  9(8) VALUE ZERO.       00515808
005139     05  PV-TOT-TOTAL-BULK-COUNT      PIC  9(7) VALUE ZERO.       00515908
005140     05  PV-TOT-TOTAL-DC-COUNT        PIC  9(7) VALUE ZERO.       00516008
005141     05  PV-TOT-TOTAL-STORE-COUNT     PIC  9(7) VALUE ZERO.       00516108
005142     05  PV-TOT-BATCH-PERCENT         PIC  9(3)V99999 VALUE ZERO. 00516208
005143     05  PV-TOT-MANUAL-PERCENT        PIC  9(3)V99999 VALUE ZERO. 00516308
005144     05  PV-TOT-AUTO-PERCENT          PIC  9(3)V99999 VALUE ZERO. 00516408
005145     05  PV-TOT-BULK-PERCENT          PIC  9(3)V99999 VALUE ZERO. 00516508
005146     05  PV-TOT-DC-PERCENT            PIC  9(3)V99999 VALUE ZERO. 00516608
005147     05  PV-TOT-STORE-PERCENT         PIC  9(3)V99999 VALUE ZERO. 00516708
005148     05  PV-TOT-IMPORT-COUNT          PIC  9(7) VALUE ZERO.       00516808
005148     05  PV-HOLD-VENDOR-NBR           PIC  9(9) VALUE ZERO.       00516910
005148     05  PV-HOLD-VENDOR-NAME          PIC  X(50) VALUE SPACES.    00517010
005148     05  PV-HOLD-USER-ID              PIC  X(8)  VALUE SPACES.    00517110
005462     05  PV-DISP-PCT                  PIC 999.999.                00517210
005149                                                                  00517310
005150 01  STATS-RECORD.                                                00517410
005151     05  STATS-VENDOR-NBR             PIC 9(9).                   00517510
005152     05  FILLER                       PIC X     VALUE SPACES.     00517610
005151     05  STATS-VENDOR-NAME            PIC X(50).                  00517710
005152     05  FILLER                       PIC X     VALUE SPACES.     00517810
005151     05  STATS-BATCH-COUNT            PIC 9999999.                00518110
005152     05  FILLER                       PIC X     VALUE SPACES.     00518210
005153     05  STATS-BATCH-BULK-COUNT       PIC 9999999.                00518310
005154     05  FILLER                       PIC X     VALUE SPACES.     00518410
005160     05  STATS-BATCH-DC-COUNT         PIC 9999999.                00518510
005161     05  FILLER                       PIC X     VALUE SPACES.     00518610
005162     05  STATS-BATCH-STORE-COUNT      PIC 9999999.                00518710
005170     05  FILLER                       PIC X     VALUE SPACES.     00518810
005180     05  STATS-IMPORT-COUNT           PIC 9999999.                00518910
005190     05  FILLER                       PIC X     VALUE SPACES.     00519010
005200     05  STATS-AUTO-COUNT             PIC 9999999.                00519110
005300     05  FILLER                       PIC X     VALUE SPACES.     00519210
005400     05  STATS-AUTO-BULK-COUNT        PIC 9999999.                00519310
005410     05  FILLER                       PIC X     VALUE SPACES.     00519410
005411     05  STATS-AUTO-DC-COUNT          PIC 9999999.                00519510
005412     05  FILLER                       PIC X     VALUE SPACES.     00520000
005413     05  STATS-AUTO-STORE-COUNT       PIC 9999999.                00530000
005414     05  FILLER                       PIC X     VALUE SPACES.     00540000
005415     05  STATS-MANUAL-COUNT           PIC 9999999.                00541000
005416     05  FILLER                       PIC X     VALUE SPACES.     00541100
005417     05  STATS-MANUAL-BULK-COUNT      PIC 9999999.                00541200
005418     05  FILLER                       PIC X     VALUE SPACES.     00541300
005419     05  STATS-MANUAL-DC-COUNT        PIC 9999999.                00541400
005420     05  FILLER                       PIC X     VALUE SPACES.     00541500
005421     05  STATS-MANUAL-STORE-COUNT     PIC 9999999.                00541600
005422     05  FILLER                       PIC X     VALUE SPACES.     00541700
005423     05  STATS-TOTAL-COUNT            PIC 99999999.               00541800
005424     05  FILLER                       PIC X     VALUE SPACES.     00541900
005425     05  STATS-TOTAL-BULK-COUNT       PIC 9999999.                00542000
005426     05  FILLER                       PIC X     VALUE SPACES.     00542100
005427     05  STATS-TOTAL-DC-COUNT         PIC 9999999.                00542200
005428     05  FILLER                       PIC X     VALUE SPACES.     00542300
005429     05  STATS-TOTAL-STORE-COUNT      PIC 9999999.                00542400
005430     05  FILLER                       PIC X     VALUE SPACES.     00542500
005431     05  STATS-BATCH-PERCENT          PIC 999.999.                00542600
005432     05  FILLER                       PIC X     VALUE SPACES.     00542700
005433     05  STATS-AUTO-PERCENT           PIC 999.999.                00542800
005434     05  FILLER                       PIC X     VALUE SPACES.     00542900
005435     05  STATS-MANUAL-PERCENT         PIC 999.999.                00543000
005436     05  FILLER                       PIC X     VALUE SPACES.     00543100
005440     05  STATS-BULK-PERCENT           PIC 999.999.                00543200
005450     05  FILLER                       PIC X     VALUE SPACES.     00543300
005460     05  STATS-DC-PERCENT             PIC 999.999.                00543400
005461     05  FILLER                       PIC X     VALUE SPACES.     00543500
005462     05  STATS-STORE-PERCENT          PIC 999.999.                00543600
005470                                                                  00543700
009500*--------------------------------------------------------------*  00550600
009600*  RECORD LAYOUT FOR VENDOR FILE                                  00550700
009700*--------------------------------------------------------------*  00550800
009800     COPY APRD444.                                                00550900
005490                                                                  00551000
016300                                                                  00554200
005490                                                                  00554400
005600 PROCEDURE DIVISION.                                              00554500
005700 A100-MAIN.                                                       00554600
005800                                                                  00554700
005900     PERFORM B100-INITIALIZE.                                     00554800
006000                                                                  00554900
006100     PERFORM B200-ACCUMULATE-STATS                                00555000
006200         UNTIL IN-EOF.                                            00556000
006300                                                                  00557000
006400     PERFORM C100-CREATE-STATS-RECORD.                            00558000
006410                                                                  00559000
006420     PERFORM B300-END-PROCESS.                                    00560000
006500                                                                  00570000
006600     GOBACK.                                                      00580000
006700                                                                  00590000
006800*----------------------------------------------------------------*00600000
006900*    INITIALIZATION PROCESSING                                   *00610000
007100*----------------------------------------------------------------*00620000
007200 B100-INITIALIZE.                                                 00630000
007300                                                                  00640000
007400     OPEN INPUT  VENDOR-FILE                                      00650000
007500          OUTPUT STATS-FILE.                                      00670000
007600                                                                  00680000
007700     PERFORM R100-READ-INPUT.                                     00690000
007700     MOVE AP444-VENDOR-NBR         TO PV-HOLD-VENDOR-NBR.         00691010
007700     MOVE AP444-VENDOR-NAME        TO PV-HOLD-VENDOR-NAME.        00692010
007700     MOVE AP444-PAYT-RLSE-USR-ID   TO PV-HOLD-USER-ID.            00693010
007800                                                                  00700000
007800                                                                  00701000
007810*----------------------------------------------------------------*00710000
007820*  ACCUMULATE MATCH STATISTICS BASED ON VALUES IN VARIOUS POSTRR *00720000
007821*  FIELDS.                                                       *00730000
007830*----------------------------------------------------------------*00740000
007900 B200-ACCUMULATE-STATS.                                           00750000
008000                                                                  00760000
008000* NOTE THAT ONLY RECORDS WITH POSTRR-STATUS-CDE = 'P' AND         00770016
008000*      POSTRR-PAYT-RLSE-USR-ID NOT = 'BYPASS' ARE INCLUDED        00771016
008000*      ON THE FILE THAT IS INPUT TO THIS PROGRAM                  00780016
008100                                                                  00790001
008200     IF AP444-VENDOR-NBR NOT = PV-HOLD-VENDOR-NBR                 00800011
006400         PERFORM C100-CREATE-STATS-RECORD                         00800301
007700         MOVE AP444-VENDOR-NBR         TO PV-HOLD-VENDOR-NBR      00800410
007700         MOVE AP444-VENDOR-NAME        TO PV-HOLD-VENDOR-NAME     00800510
007700         MOVE AP444-PAYT-RLSE-USR-ID   TO PV-HOLD-USER-ID         00800610
008200     END-IF.                                                      00801001
008100                                                                  00803001
008200     IF AP444-CRE-PRC-CDE = 'B'                                   00804002
008300         ADD 1 TO PV-BATCH-COUNT                                  00805001
008301         ADD 1 TO PV-TOTAL-COUNT                                  00806001
008302         IF AP444-MTCH-LVL-CDE = 'P'                              00807002
008303             ADD 1 TO PV-BATCH-BULK-COUNT                         00808001
008304             ADD 1 TO PV-TOTAL-BULK-COUNT                         00809001
008305             IF AP444-TOLR-ADJ-AMT > 200                          00810002
008306                 ADD 1 TO PV-IMPORT-COUNT                         00820000
008307             END-IF                                               00830001
008308         ELSE                                                     00830101
008309             IF AP444-MTCH-LVL-CDE = 'S'                          00830202
008310                 ADD 1 TO PV-BATCH-STORE-COUNT                    00830300
008311                 ADD 1 TO PV-TOTAL-STORE-COUNT                    00830400
008312             ELSE                                                 00830501
008313                 ADD 1 TO PV-BATCH-DC-COUNT                       00830600
008314                 ADD 1 TO PV-TOTAL-DC-COUNT                       00830700
008315             END-IF                                               00830801
008316         END-IF                                                   00830901
008317     ELSE                                                         00831001
008318         IF AP444-CRE-PRC-CDE = 'O'                               00831102
008319             ADD 1 TO PV-MANUAL-COUNT                             00831201
008320             ADD 1 TO PV-TOTAL-COUNT                              00831301
008321             IF AP444-MTCH-LVL-CDE = 'P'                          00831402
008322                 ADD 1 TO PV-MANUAL-BULK-COUNT                    00831500
008323                 ADD 1 TO PV-TOTAL-BULK-COUNT                     00831600
008324             ELSE                                                 00831701
008325                 IF AP444-MTCH-LVL-CDE = 'S'                      00831802
008326                     ADD 1 TO PV-MANUAL-STORE-COUNT               00831900
008327                     ADD 1 TO PV-TOTAL-STORE-COUNT                00832000
008328                 ELSE                                             00832101
008329                     ADD 1 TO PV-MANUAL-DC-COUNT                  00832200
008330                     ADD 1 TO PV-TOTAL-DC-COUNT                   00832300
008331                 END-IF                                           00832401
008332             END-IF                                               00832501
008333         ELSE                                                     00832601
008334             IF AP444-CRE-PRC-CDE = 'A'                           00832702
008335             AND AP444-PAYT-RLSE-USR-ID = 'APKUP230'              00832802
008336                 ADD 1 TO PV-AUTO-COUNT                           00832900
008337                 ADD 1 TO PV-TOTAL-COUNT                          00833000
008338                 IF AP444-MTCH-LVL-CDE = 'P'                      00833102
008339                     ADD 1 TO PV-AUTO-BULK-COUNT                  00833201
008340                     ADD 1 TO PV-TOTAL-BULK-COUNT                 00833301
008341                 ELSE                                             00833400
008342                     IF AP444-MTCH-LVL-CDE = 'S'                  00833502
008343                         ADD 1 TO PV-AUTO-STORE-COUNT             00833601
008344                         ADD 1 TO PV-TOTAL-STORE-COUNT            00833701
008345                     ELSE                                         00833800
008346                         ADD 1 TO PV-AUTO-DC-COUNT                00833901
008347                         ADD 1 TO PV-TOTAL-DC-COUNT               00834001
008348                     END-IF                                       00834100
008349                 END-IF                                           00834200
008350             END-IF                                               00834301
008351         END-IF                                                   00834401
008353     END-IF.                                                      00834600
008354                                                                  00834700
008355     PERFORM R100-READ-INPUT.                                     00834800
008360                                                                  00834900
008360                                                                  00835003
008370 B300-END-PROCESS.                                                00835103
008380                                                                  00836000
008785     IF PV-TOT-TOTAL-COUNT > 0                                    00838114
008785         COMPUTE PV-TOT-BATCH-PERCENT =                           00838214
008786             PV-TOT-BATCH-COUNT / PV-TOT-TOTAL-COUNT * 100        00838314
008787                                                                  00838414
008788         COMPUTE PV-TOT-MANUAL-PERCENT =                          00838514
008789             PV-TOT-MANUAL-COUNT / PV-TOT-TOTAL-COUNT * 100       00838614
008790                                                                  00838714
008791         COMPUTE PV-TOT-AUTO-PERCENT =                            00838814
008792             PV-TOT-AUTO-COUNT / PV-TOT-TOTAL-COUNT * 100         00838914
008793                                                                  00839014
008794         COMPUTE PV-TOT-BULK-PERCENT =                            00839114
008795             PV-TOT-TOTAL-BULK-COUNT / PV-TOT-TOTAL-COUNT * 100   00839214
008796                                                                  00839314
008797         COMPUTE PV-TOT-DC-PERCENT =                              00839414
008798             PV-TOT-TOTAL-DC-COUNT / PV-TOT-TOTAL-COUNT * 100     00839514
008799                                                                  00839614
008800         COMPUTE PV-TOT-STORE-PERCENT =                           00839714
008801             PV-TOT-TOTAL-STORE-COUNT / PV-TOT-TOTAL-COUNT * 100  00839814
008785     END-IF.                                                      00839914
008799                                                                  00840014
008390     DISPLAY 'PROGRAM APKUT444 ENDS SUCCESSFULLY'.                00840114
008750                                                                  00840214
008751     DISPLAY 'BATCH-COUNT    = ' PV-TOT-BATCH-COUNT.              00840314
008752     DISPLAY 'MANUAL-COUNT   = ' PV-TOT-MANUAL-COUNT.             00841001
008753     DISPLAY 'AUTO-COUNT     = ' PV-TOT-AUTO-COUNT.               00850001
008754     DISPLAY 'TOTAL-COUNT    = ' PV-TOT-TOTAL-COUNT.              00860001
005462     MOVE PV-TOT-BATCH-PERCENT   TO PV-DISP-PCT.                  00861009
008755     DISPLAY 'BATCH-PERCENT  = ' PV-DISP-PCT.                     00870009
005462     MOVE PV-TOT-MANUAL-PERCENT  TO PV-DISP-PCT.                  00870109
008756     DISPLAY 'MANUAL-PERCENT = ' PV-DISP-PCT.                     00871009
005462     MOVE PV-TOT-AUTO-PERCENT    TO PV-DISP-PCT.                  00871109
008757     DISPLAY 'AUTO-PERCENT   = ' PV-DISP-PCT.                     00872009
008758     DISPLAY '-------------------------------------'.             00873000
008759     DISPLAY 'BATCH-BULK-COUNT  = ' PV-TOT-BATCH-BULK-COUNT.      00874001
008760     DISPLAY 'MANUAL-BULK-COUNT = ' PV-TOT-MANUAL-BULK-COUNT.     00875001
008761     DISPLAY 'AUTO-BULK-COUNT   = ' PV-TOT-AUTO-BULK-COUNT.       00876001
008762     DISPLAY 'TOTAL-BULK-COUNT  = ' PV-TOT-TOTAL-BULK-COUNT.      00876101
008763     DISPLAY '-------------------------------------'.             00876200
008764     DISPLAY 'BATCH-DC-COUNT  = ' PV-TOT-BATCH-DC-COUNT.          00876301
008765     DISPLAY 'MANUAL-DC-COUNT = ' PV-TOT-MANUAL-DC-COUNT.         00876401
008766     DISPLAY 'AUTO-DC-COUNT   = ' PV-TOT-AUTO-DC-COUNT.           00876501
008767     DISPLAY 'TOTAL-DC-COUNT  = ' PV-TOT-TOTAL-DC-COUNT.          00876601
008768     DISPLAY '-------------------------------------'.             00876700
008769     DISPLAY 'BATCH-STORE-COUNT  = ' PV-TOT-BATCH-STORE-COUNT.    00876801
008770     DISPLAY 'MANUAL-STORE-COUNT = ' PV-TOT-MANUAL-STORE-COUNT.   00876901
008771     DISPLAY 'AUTO-STORE-COUNT   = ' PV-TOT-AUTO-STORE-COUNT.     00877001
008772     DISPLAY 'TOTAL-STORE-COUNT  = ' PV-TOT-TOTAL-STORE-COUNT.    00877101
008773     DISPLAY '-------------------------------------'.             00877200
005462     MOVE PV-TOT-BULK-PERCENT    TO PV-DISP-PCT.                  00877309
008774     DISPLAY 'BULK-PERCENT    = ' PV-DISP-PCT.                    00877409
005462     MOVE PV-TOT-DC-PERCENT      TO PV-DISP-PCT.                  00877509
008775     DISPLAY 'DC-PERCENT      = ' PV-DISP-PCT.                    00877609
005462     MOVE PV-TOT-STORE-PERCENT   TO PV-DISP-PCT.                  00877709
008776     DISPLAY 'STORE-PERCENT   = ' PV-DISP-PCT.                    00877809
008777     DISPLAY '-------------------------------------'.             00877900
008778     DISPLAY 'IMPORT-COUNT    = ' PV-TOT-IMPORT-COUNT.            00878001
008779                                                                  00878100
008780     CLOSE VENDOR-FILE                                            00878202
008781           STATS-FILE.                                            00878300
008782                                                                  00878400
008782                                                                  00878504
008783 C100-CREATE-STATS-RECORD.                                        00878604
008784                                                                  00878704
008785     IF PV-TOTAL-COUNT > 0                                        00878807
008785         COMPUTE PV-BATCH-PERCENT =                               00878907
008786             PV-BATCH-COUNT / PV-TOTAL-COUNT * 100                00879007
008787                                                                  00879107
008788         COMPUTE PV-MANUAL-PERCENT =                              00879207
008789             PV-MANUAL-COUNT / PV-TOTAL-COUNT * 100               00879307
008790                                                                  00879407
008791         COMPUTE PV-AUTO-PERCENT =                                00880007
008792             PV-AUTO-COUNT / PV-TOTAL-COUNT * 100                 00880107
008793                                                                  00880204
008794         COMPUTE PV-BULK-PERCENT =                                00880307
008795             PV-TOTAL-BULK-COUNT / PV-TOTAL-COUNT * 100           00880407
008796                                                                  00880504
008797         COMPUTE PV-DC-PERCENT =                                  00880607
008798             PV-TOTAL-DC-COUNT / PV-TOTAL-COUNT * 100             00880707
008799                                                                  00880804
008800         COMPUTE PV-STORE-PERCENT =                               00880907
008801             PV-TOTAL-STORE-COUNT / PV-TOTAL-COUNT * 100          00881007
008785     END-IF.                                                      00881107
008803                                                                  00881300
005151     MOVE PV-HOLD-VENDOR-NBR    TO STATS-VENDOR-NBR.              00881411
005151     MOVE PV-HOLD-VENDOR-NAME   TO STATS-VENDOR-NAME.             00881610
008804     MOVE PV-BATCH-COUNT        TO STATS-BATCH-COUNT.             00882312
008805     MOVE PV-BATCH-BULK-COUNT   TO STATS-BATCH-BULK-COUNT.        00882412
008806     MOVE PV-BATCH-DC-COUNT     TO STATS-BATCH-DC-COUNT.          00882512
008807     MOVE PV-BATCH-STORE-COUNT  TO STATS-BATCH-STORE-COUNT.       00882612
008808     MOVE PV-MANUAL-COUNT       TO STATS-MANUAL-COUNT.            00882712
008809     MOVE PV-MANUAL-BULK-COUNT  TO STATS-MANUAL-BULK-COUNT.       00882812
008810     MOVE PV-MANUAL-DC-COUNT    TO STATS-MANUAL-DC-COUNT.         00882912
008811     MOVE PV-MANUAL-STORE-COUNT TO STATS-MANUAL-STORE-COUNT.      00883012
008812     MOVE PV-AUTO-COUNT         TO STATS-AUTO-COUNT.              00883112
008813     MOVE PV-AUTO-BULK-COUNT    TO STATS-AUTO-BULK-COUNT.         00883212
008814     MOVE PV-AUTO-DC-COUNT      TO STATS-AUTO-DC-COUNT.           00883312
008815     MOVE PV-AUTO-STORE-COUNT   TO STATS-AUTO-STORE-COUNT.        00883412
008816     MOVE PV-TOTAL-COUNT        TO STATS-TOTAL-COUNT.             00883512
008817     MOVE PV-TOTAL-BULK-COUNT   TO STATS-TOTAL-BULK-COUNT.        00883612
008818     MOVE PV-TOTAL-DC-COUNT     TO STATS-TOTAL-DC-COUNT.          00883712
008819     MOVE PV-TOTAL-STORE-COUNT  TO STATS-TOTAL-STORE-COUNT.       00883812
008820     MOVE PV-BATCH-PERCENT      TO STATS-BATCH-PERCENT.           00883912
008821     MOVE PV-MANUAL-PERCENT     TO STATS-MANUAL-PERCENT.          00884012
008822     MOVE PV-AUTO-PERCENT       TO STATS-AUTO-PERCENT.            00884112
008823     MOVE PV-BULK-PERCENT       TO STATS-BULK-PERCENT.            00884212
008824     MOVE PV-DC-PERCENT         TO STATS-DC-PERCENT.              00884312
008825     MOVE PV-STORE-PERCENT      TO STATS-STORE-PERCENT.           00884412
008826     MOVE PV-IMPORT-COUNT       TO STATS-IMPORT-COUNT.            00884512
008827                                                                  00884612
008828     PERFORM W100-WRITE-STATS-RECORD.                             00884712
008829                                                                  00884812
008804     ADD PV-BATCH-COUNT         TO PV-TOT-BATCH-COUNT.            00884912
008805     ADD PV-BATCH-BULK-COUNT    TO PV-TOT-BATCH-BULK-COUNT.       00885012
008806     ADD PV-BATCH-DC-COUNT      TO PV-TOT-BATCH-DC-COUNT.         00885112
008807     ADD PV-BATCH-STORE-COUNT   TO PV-TOT-BATCH-STORE-COUNT.      00885212
008808     ADD PV-MANUAL-COUNT        TO PV-TOT-MANUAL-COUNT.           00885312
008809     ADD PV-MANUAL-BULK-COUNT   TO PV-TOT-MANUAL-BULK-COUNT.      00885412
008810     ADD PV-MANUAL-DC-COUNT     TO PV-TOT-MANUAL-DC-COUNT.        00885512
008811     ADD PV-MANUAL-STORE-COUNT  TO PV-TOT-MANUAL-STORE-COUNT.     00885612
008812     ADD PV-AUTO-COUNT          TO PV-TOT-AUTO-COUNT.             00885712
008813     ADD PV-AUTO-BULK-COUNT     TO PV-TOT-AUTO-BULK-COUNT.        00885812
008814     ADD PV-AUTO-DC-COUNT       TO PV-TOT-AUTO-DC-COUNT.          00885912
008815     ADD PV-AUTO-STORE-COUNT    TO PV-TOT-AUTO-STORE-COUNT.       00886012
008816     ADD PV-TOTAL-COUNT         TO PV-TOT-TOTAL-COUNT.            00886112
008817     ADD PV-TOTAL-BULK-COUNT    TO PV-TOT-TOTAL-BULK-COUNT.       00886212
008818     ADD PV-TOTAL-DC-COUNT      TO PV-TOT-TOTAL-DC-COUNT.         00886312
008819     ADD PV-TOTAL-STORE-COUNT   TO PV-TOT-TOTAL-STORE-COUNT.      00886412
008820*    ADD PV-BATCH-PERCENT       TO PV-TOT-BATCH-PERCENT.          00886512
008821*    ADD PV-MANUAL-PERCENT      TO PV-TOT-MANUAL-PERCENT.         00886612
008822*    ADD PV-AUTO-PERCENT        TO PV-TOT-AUTO-PERCENT.           00886712
008823*    ADD PV-BULK-PERCENT        TO PV-TOT-BULK-PERCENT.           00886812
008824*    ADD PV-DC-PERCENT          TO PV-TOT-DC-PERCENT.             00886912
008825*    ADD PV-STORE-PERCENT       TO PV-TOT-STORE-PERCENT.          00887012
008826     ADD PV-IMPORT-COUNT        TO PV-TOT-IMPORT-COUNT.           00887112
008826                                                                  00887212
008829     MOVE ZERO TO                                                 00887312
008804                    PV-BATCH-COUNT                                00887412
008805                    PV-BATCH-BULK-COUNT                           00887512
008806                    PV-BATCH-DC-COUNT                             00887612
008807                    PV-BATCH-STORE-COUNT                          00887712
008808                    PV-MANUAL-COUNT                               00887812
008809                    PV-MANUAL-BULK-COUNT                          00887912
008810                    PV-MANUAL-DC-COUNT                            00888012
008811                    PV-MANUAL-STORE-COUNT                         00888112
008812                    PV-AUTO-COUNT                                 00888212
008813                    PV-AUTO-BULK-COUNT                            00888312
008814                    PV-AUTO-DC-COUNT                              00888412
008815                    PV-AUTO-STORE-COUNT                           00888512
008816                    PV-TOTAL-COUNT                                00888612
008817                    PV-TOTAL-BULK-COUNT                           00888712
008818                    PV-TOTAL-DC-COUNT                             00888812
008819                    PV-TOTAL-STORE-COUNT                          00888912
008820                    PV-BATCH-PERCENT                              00889012
008821                    PV-MANUAL-PERCENT                             00889112
008822                    PV-AUTO-PERCENT                               00889212
008823                    PV-BULK-PERCENT                               00889312
008824                    PV-DC-PERCENT                                 00889412
008825                    PV-STORE-PERCENT                              00889512
008826                    PV-IMPORT-COUNT.                              00889612
008826                                                                  00889712
008826                                                                  00889812
008830 R100-READ-INPUT.                                                 00889912
008831                                                                  00890012
008832     READ VENDOR-FILE INTO AP444-VENDOR-RECORD                    00890112
008840         AT END SET IN-EOF TO TRUE.                               00890212
      *    DISPLAY 'VENDOR ' AP444-VENDOR-RECORD.                       00890312
008900                                                                  00890412
008920                                                                  00891001
008910 W100-WRITE-STATS-RECORD.                                         00898700
008920                                                                  00898800
008930     WRITE STATS-REC FROM STATS-RECORD.                           00898900
009000                                                                  00899000
009100                                                                  00900000
