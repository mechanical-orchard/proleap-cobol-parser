000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    RCKRP006.                                         00050001
000600 AUTHOR.        DAN HINTZ.                                        00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   SEPTEMBER, 1994.                                  00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200*  THIS PROGRAM CREATES THE "DUPLICATE RECEIVERS REPORT"          00120001
001300******************************************************************00130001
001400                                                                  00140001
001500******************************************************************00150001
001600 ENVIRONMENT DIVISION.                                            00160001
001700******************************************************************00170001
001800                                                                  00180001
001900 CONFIGURATION SECTION.                                           00190001
002000                                                                  00200001
002100 SOURCE-COMPUTER.        IBM-3090.                                00210001
002200 OBJECT-COMPUTER.        IBM-3090.                                00220001
002300                                                                  00230001
002400 INPUT-OUTPUT SECTION.                                            00240001
002500                                                                  00250001
002600 FILE-CONTROL.                                                    00260001
002700                                                                  00270001
002800     SELECT DUPLICATE-RCVRS-EXTRACT                               00280001
002900         ASSIGN TO INP01.                                         00290001
003000                                                                  00300001
003100     SELECT DUPLICATE-RCVRS-REPORT                                00310001
003200         ASSIGN TO RPT01.                                         00320001
003300                                                                  00330001
003400******************************************************************00340001
003500 DATA DIVISION.                                                   00350001
003600******************************************************************00360001
003700                                                                  00370001
003800 FILE SECTION.                                                    00380001
003900                                                                  00390001
004000 FD  DUPLICATE-RCVRS-EXTRACT                                      00400001
004100     RECORDING MODE IS F                                          00410001
004200     LABEL RECORDS ARE STANDARD                                   00420001
004300     BLOCK CONTAINS 0 RECORDS.                                    00430001
004400                                                                  00440001
004500 01  DUPLICATE-RCVRS-EXTRACT-RECORD   PIC  X(71).                 00450001
004600                                                                  00460001
004700                                                                  00470001
004800 FD  DUPLICATE-RCVRS-REPORT                                       00480001
004900     RECORDING MODE IS F                                          00490001
005000     LABEL RECORDS ARE STANDARD                                   00500001
005100     BLOCK CONTAINS 0 RECORDS.                                    00510001
005200                                                                  00520001
005300 01  DUPLICATE-RCVRS-REPORT-RECORD    PIC  X(132).                00530001
005400*                                                                 00540001
005500*                                                                 00550001
005600******************************************************************00560001
005700 WORKING-STORAGE SECTION.                                         00570001
005800******************************************************************00580001
005900*                                                                 00590001
006000******************************************************************00600001
006100***  WORK FIELDS FOR THE DUPLICATE UNJOURNALIZED RECEIVER         00610001
006200***  EXTRACT FILE.                                                00620001
006300******************************************************************00630001
006400     COPY RCRD005.                                                00640001
006500*                                                                 00650001
006600*                                                                 00660001
006700******************************************************************00670001
006800***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00680001
006900******************************************************************00690001
007000     COPY DPWS132O.                                               00700001
007100*                                                                 00710001
007200*                                                                 00720001
007300 01  HL1-HEADING-LINE-1.                                          00730001
007400     05  FILLER                      PIC  X(53)      VALUE SPACE. 00740001
007500     05  FILLER                      PIC  X(26)      VALUE        00750001
007600         'DUPLICATE RECEIVERS REPORT'.                            00760001
007700     05  FILLER                      PIC  X(53)      VALUE SPACE. 00770001
007800*                                                                 00780001
007900 01  DH1-DETAIL-HEADING-LINE-1.                                   00790001
008000     05  FILLER                      PIC  X(33)      VALUE        00800001
008100         '                          RECEIVE'.                     00810001
008200     05  FILLER                      PIC  X(33)      VALUE        00820001
008300         'R     RECEIPT                    '.                     00830001
008400     05  FILLER                      PIC  X(33)      VALUE        00840001
008500         '                      UNIT       '.                     00850001
008600     05  FILLER                      PIC  X(33)      VALUE        00860001
008700         '    UNIT         UNIT            '.                     00870001
008800*                                                                 00880001
008900 01  DH2-DETAIL-HEADING-LINE-2.                                   00890001
009000     05  FILLER                      PIC  X(33)      VALUE        00900001
009100         '           PO/RECEIVER    LOCATIO'.                     00910001
009200     05  FILLER                      PIC  X(33)      VALUE        00920001
009300         'N     DATE          VENDOR NAME  '.                     00930001
009400     05  FILLER                      PIC  X(33)      VALUE        00940001
009500         '                    RETAIL       '.                     00950001
009600     05  FILLER                      PIC  X(33)      VALUE        00960001
009700         '    COST     QUANTITY            '.                     00970001
009800*                                                                 00980001
009900*                                                                 00990001
010000 01  DL-DETAIL-LINE.                                              01000001
010100     05  FILLER                      PIC  X(09)      VALUE SPACE. 01010001
010200     05  DL-PO-RCVR-NBR.                                          01020001
010300         10  DL-PO-NBR               PIC  ZZZZZZZ9   VALUE ZEROS. 01030001
010400         10  DL-PO-RCVR-DASH         PIC  X(01)      VALUE '-'.   01040001
010500         10  DL-RCVR-SEQ-NBR         PIC  X(04)      VALUE SPACES.01050001
010600     05  FILLER                      PIC  X(04)      VALUE SPACES.01060001
010700     05  DL-RECEIVER-LOCATION        PIC  X(09)      VALUE SPACES.01070001
010800     05  FILLER                      PIC  X(04)      VALUE SPACES.01080001
010900     05  DL-RECEIPT-DATE             PIC  X(10)      VALUE SPACES.01090001
011000     05  FILLER                      PIC  X(04)      VALUE SPACES.01100001
011100     05  DL-VENDOR-NAME              PIC  X(25)      VALUE SPACES.01110001
011200     05  DL-UNIT-RETAIL              PIC  ZZZ,ZZZ,ZZ9.99          01120001
011300                                                     VALUE ZEROS. 01130001
011400     05  FILLER                      PIC  X(01)      VALUE SPACES.01140001
011500     05  DL-UNIT-COST                PIC  ZZZ,ZZZ,ZZ9.99          01150001
011600                                                     VALUE ZEROS. 01160001
011700     05  FILLER                      PIC  X(02)      VALUE SPACES.01170001
011800     05  DL-UNIT-QUANTITY            PIC  ZZZ,ZZZ,ZZ9             01180001
011900                                                     VALUE ZEROS. 01190001
012000     05  FILLER                      PIC  X(12)      VALUE SPACES.01200001
012100*                                                                 01210001
012200*                                                                 01220001
012300 01  ER-END-OF-REPORT-LINE.                                       01230001
012400     05  FILLER                      PIC  X(54)      VALUE SPACE. 01240001
012500     05  FILLER                      PIC  X(25)      VALUE        01250001
012600         '***** END OF REPORT *****'.                             01260001
012700     05  FILLER                      PIC  X(53)      VALUE SPACE. 01270001
012800*                                                                 01280001
012900*                                                                 01290001
013000 01  PS-PROGRAM-SWITCHES.                                         01300001
013100     05  PS-EOF-DUP-RCVRS-EXTRACT-SW PIC  X(01)    VALUE SPACE.   01310001
013200         88  PS-EOF-DUP-RCVRS-EXTRACT              VALUE 'Y'.     01320001
013300     05  PS-PRINT-BLANK-LINE-SW      PIC  X(01)    VALUE SPACE.   01330001
013400         88  PS-PRINT-BLANK-LINE                   VALUE 'Y'.     01340001
013500         88  PS-DONT-PRINT-BLANK-LINE              VALUE 'N'.     01350001
013600     05  PS-FIRST-PO-ON-PAGE-SW      PIC  X(01)    VALUE SPACE.   01360001
013700         88  PS-FIRST-PO-ON-PAGE                   VALUE 'Y'.     01370001
013800         88  PS-NOT-FIRST-PO-ON-PAGE               VALUE 'N'.     01380001
013900*                                                                 01390001
014000*                                                                 01400001
014100 01 PC-PROGRAM-CONSTANTS.                                         01410001
014200     05  PC-PAGE-SIZE-066            PIC S9(04)    VALUE +066     01420001
014300                                                   COMP SYNC.     01430001
014400     05  PC-HEADING-SIZE             PIC S9(04)    VALUE +010     01440001
014500                                                   COMP SYNC.     01450001
014600     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01460001
014700                                                   COMP SYNC.     01470001
014800     05  PC-MAX-TABLE-ENTRIES        PIC S9(04)    VALUE +20      01480001
014900                                                   COMP SYNC.     01490001
015000     05  PC-CURRENT-OPERATING-COMPANY                             01500001
015100                                     PIC  X(02)    VALUE '03'.    01510001
015200     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01520001
015300         'RCKRP006'.                                              01530001
015400     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01540001
015500     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     01550001
015600     05  PC-COLON                    PIC  X(01)    VALUE ':'.     01560001
015700     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     01570001
015800*                                                                 01580001
015900*                                                                 01590001
016000 01  PV-PROGRAM-VARIABLES.                                        01600001
016100     05  PV-LINES-USED               PIC S9(04)    VALUE ZERO     01610001
016200                                                   COMP SYNC.     01620001
016300     05  PV-CURR-PO-NBR              PIC  9(08)    VALUE ZERO.    01630001
016400     05  PV-PREV-PO-NBR              PIC  9(08)    VALUE ZERO.    01640001
016500     05  PV-BLANK-LINE               PIC  X(132)   VALUE SPACES.  01650001
016600*                                                                 01660001
016700     05  PV-PAGE-COUNT               PIC  9(05)    VALUE ZERO.    01670001
016800     05  PV-PAGE-COUNT-RDF  REDEFINES  PV-PAGE-COUNT.             01680001
016900         10  FILLER                  PIC  X(04).                  01690001
017000         10  PV-PAGE-NUMBER          PIC  9(01).                  01700001
017100             88  PV-PAGE-NUMBER-EVEN               VALUES 0, 2, 4 01710001
017200                                                          6, 8.   01720001
017300             88  PV-PAGE-NUMBER-ODD                VALUES 1, 3, 5 01730001
017400                                                          7, 9.   01740001
017500*                                                                 01750001
017600     05  PV-RECEIVER-LOCATION.                                    01760001
017700         10  PV-OPER-UNT-ID          PIC  9(04)    VALUE ZERO.    01770001
017800         10  FILLER                  PIC  X(01)    VALUE SPACES.  01780001
017900         10  PV-FCLTY-ID             PIC  9(04)    VALUE ZERO.    01790001
018000*                                                                 01800001
018100     05  PV-RCPT-DATE-IN             PIC  X(10)    VALUE SPACES.  01810002
018200     05  PV-RCPT-DATE-IN-R           REDEFINES                    01820001
018300         PV-RCPT-DATE-IN.                                         01830001
018400         10  PV-RCPT-DATE-IN-CCYY    PIC  9(04).                  01840002
018410         10  FILLER                  PIC  X(01).                  01841002
018500         10  PV-RCPT-DATE-IN-MM      PIC  9(02).                  01850002
018510         10  FILLER                  PIC  X(01).                  01851002
018600         10  PV-RCPT-DATE-IN-DD      PIC  9(02).                  01860002
018700*                                                                 01870001
018800     05  PV-RCPT-DATE-OUT            PIC  X(10)    VALUE SPACES.  01880001
018900     05  PV-RCPT-DATE-OUT-R          REDEFINES                    01890001
019000         PV-RCPT-DATE-OUT.                                        01900001
019100         10  PV-RCPT-DATE-OUT-MM     PIC  9(02).                  01910001
019200         10  PV-RCPT-DATE-OUT-SLASH1 PIC  X(01).                  01920001
019300         10  PV-RCPT-DATE-OUT-DD     PIC  9(02).                  01930001
019400         10  PV-RCPT-DATE-OUT-SLASH2 PIC  X(01).                  01940001
019500         10  PV-RCPT-DATE-OUT-CCYY   PIC  9(04).                  01950002
019700*                                                                 01970001
019800*                                                                 01980001
019900 01  SD-SYSTEM-DATE.                                              01990001
020000     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  02000001
020100     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  02010001
020200     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  02020001
020300*                                                                 02030001
020400*                                                                 02040001
020500 01  ST-SYSTEM-TIME.                                              02050001
020600     05  ST-SYSTEM-HOUR              PIC  9(02)      VALUE ZERO.  02060001
020700     05  ST-SYSTEM-MINUTE            PIC  9(02)      VALUE ZERO.  02070001
020800     05  FILLER                      PIC  9(04)      VALUE ZERO.  02080001
020900*                                                                 02090001
021000*                                                                 02100001
021100******************************************************************02110001
021200 PROCEDURE DIVISION.                                              02120001
021300******************************************************************02130001
021400                                                                  02140001
021500 0000-PROGRAM-MAINLINE.                                           02150001
021600******************************************************************02160001
021700* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     02170001
021800*      PROGRAM.                                                   02180001
021900******************************************************************02190001
022000     PERFORM 1000-INITIALIZE.                                     02200001
022100                                                                  02210001
022200     PERFORM 7000-READ-DUP-EXTRACT-FILE.                          02220001
022300                                                                  02230001
022400     PERFORM 2000-BUILD-DUP-RCVRS-RPT-DATA                        02240001
022500       UNTIL PS-EOF-DUP-RCVRS-EXTRACT                             02250001
022600                                                                  02260001
022700     PERFORM 9000-EOJ-ROUTINE.                                    02270001
022800     STOP RUN.                                                    02280001
022900*0000-EXIT.                                                       02290001
023000*                                                                 02300001
023100*                                                                 02310001
023200 1000-INITIALIZE.                                                 02320001
023300******************************************************************02330001
023400*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    02340001
023500*    -- OPEN FILES                                                02350001
023600*    -- SET UP AND PRINT REPORT HEADINGS                          02360001
023700******************************************************************02370001
023800     OPEN INPUT  DUPLICATE-RCVRS-EXTRACT                          02380001
023900          OUTPUT DUPLICATE-RCVRS-REPORT.                          02390001
024000*                                                                 02400001
024100     ACCEPT SD-SYSTEM-DATE FROM DATE.                             02410001
024200     ACCEPT ST-SYSTEM-TIME FROM TIME.                             02420001
024300     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              02430001
024400     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             02440001
024500     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               02450001
024600     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              02460001
024700     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            02470001
024800     MOVE PC-CURRENT-PROGRAM-NAME                                 02480001
024900                                 TO DP132O-PROGRAM-NAME.          02490001
025000     MOVE 1                      TO DP132O-REPORT-NUMBER.         02500001
025100     PERFORM 8000-WRITE-PAGE-HEADINGS.                            02510001
025200*                                                                 02520001
025300*1000-EXIT.                                                       02530001
025400*                                                                 02540001
025500*                                                                 02550001
025600 2000-BUILD-DUP-RCVRS-RPT-DATA.                                   02560001
025700******************************************************************02570001
025800*  BUILD THE LINES FOR THE REPORT.                                02580001
025900******************************************************************02590001
026000     MOVE SPACES                     TO DL-DETAIL-LINE.           02600001
026100     MOVE RC005-PO-NBR               TO PV-CURR-PO-NBR.           02610001
026200                                                                  02620001
026300     IF PV-LINES-USED > PC-PAGE-SIZE-066                          02630001
026400        PERFORM 8000-WRITE-PAGE-HEADINGS                          02640001
026500     END-IF.                                                      02650001
026600                                                                  02660001
026700     IF (PV-CURR-PO-NBR NOT = PV-PREV-PO-NBR) OR                  02670001
026800        (PS-FIRST-PO-ON-PAGE)                                     02680001
026900         MOVE RC005-VENDOR-NAME      TO DL-VENDOR-NAME            02690001
027000         MOVE RC005-EXT-RETAIL-AMT   TO DL-UNIT-RETAIL            02700001
027100         MOVE RC005-EXT-COST-AMT     TO DL-UNIT-COST              02710001
027200         MOVE RC005-VERIFIED-QTY     TO DL-UNIT-QUANTITY          02720001
027300                                                                  02730001
027400         IF (PV-CURR-PO-NBR NOT = PV-PREV-PO-NBR) AND             02740001
027500            (PS-NOT-FIRST-PO-ON-PAGE)                             02750001
027600             SET PS-PRINT-BLANK-LINE TO TRUE                      02760001
027700         END-IF                                                   02770001
027800                                                                  02780001
027900         MOVE PV-CURR-PO-NBR         TO PV-PREV-PO-NBR            02790001
028000         SET PS-NOT-FIRST-PO-ON-PAGE TO TRUE                      02800001
028100     END-IF.                                                      02810001
028200                                                                  02820001
028300     MOVE RC005-PO-NBR               TO DL-PO-NBR.                02830001
028400     MOVE PC-DASH                    TO DL-PO-RCVR-DASH.          02840001
028500     MOVE RC005-REC-SEQ-NBR          TO DL-RCVR-SEQ-NBR.          02850001
028600     MOVE RC005-OPER-UNT-ID          TO PV-OPER-UNT-ID.           02860001
028700     MOVE RC005-FCLTY-ID             TO PV-FCLTY-ID.              02870001
028800     MOVE PV-RECEIVER-LOCATION       TO DL-RECEIVER-LOCATION.     02880001
028910*                                                                 02891002
028920     MOVE RC005-RECEIPT-DATE         TO PV-RCPT-DATE-IN.          02892002
028940     MOVE PV-RCPT-DATE-IN-CCYY       TO PV-RCPT-DATE-OUT-CCYY.    02894002
028960     MOVE PV-RCPT-DATE-IN-MM         TO PV-RCPT-DATE-OUT-MM.      02896002
028980     MOVE PV-RCPT-DATE-IN-DD         TO PV-RCPT-DATE-OUT-DD.      02898002
028990     MOVE '/'                        TO PV-RCPT-DATE-OUT-SLASH1.  02899002
028991     MOVE '/'                        TO PV-RCPT-DATE-OUT-SLASH2.  02899102
028999     MOVE PV-RCPT-DATE-OUT           TO DL-RECEIPT-DATE.          02899902
029000*                                                                 02900001
029100     PERFORM 8100-WRITE-DUP-RCVRS-DETAIL.                         02910001
029200*                                                                 02920001
029300     PERFORM 7000-READ-DUP-EXTRACT-FILE.                          02930001
029400*                                                                 02940001
029500*2000-EXIT.                                                       02950001
029600*                                                                 02960001
029700*                                                                 02970001
029800 7000-READ-DUP-EXTRACT-FILE.                                      02980001
029900******************************************************************02990001
030000*  READ THE DUPLICATE RECEIVERS EXTRACT FILE                     *03000001
030100******************************************************************03010001
030200     READ DUPLICATE-RCVRS-EXTRACT                                 03020001
030300       INTO RC005-DUP-RECEIPTS-EXTRACT                            03030001
030400         AT END                                                   03040001
030500           SET PS-EOF-DUP-RCVRS-EXTRACT TO TRUE.                  03050001
030600*                                                                 03060001
030700*                                                                 03070001
030800 8000-WRITE-PAGE-HEADINGS.                                        03080001
030900***************************************************************** 03090001
031000*  PRINT THE HEADINGS ON EACH PAGE.                             * 03100001
031100***************************************************************** 03110001
031200     ADD 1                         TO PV-PAGE-COUNT.              03120001
031300     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         03130001
031400*                                                                 03140001
031500     MOVE PC-HEADING-SIZE          TO PV-LINES-USED.              03150001
031600     SET PS-DONT-PRINT-BLANK-LINE                                 03160001
031700         PS-FIRST-PO-ON-PAGE       TO TRUE.                       03170001
031800*                                                                 03180001
031900     WRITE DUPLICATE-RCVRS-REPORT-RECORD                          03190001
032000       FROM DP132O-STANDRD-HEADER-132-COLS                        03200001
032100         AFTER ADVANCING PAGE.                                    03210001
032200*                                                                 03220001
032300     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   03230001
032400     WRITE DUPLICATE-RCVRS-REPORT-RECORD                          03240001
032500       FROM HL1-HEADING-LINE-1                                    03250001
032600         AFTER ADVANCING 1 LINE.                                  03260001
032700*                                                                 03270001
032800     WRITE DUPLICATE-RCVRS-REPORT-RECORD                          03280001
032900       FROM DH1-DETAIL-HEADING-LINE-1                             03290001
033000         AFTER ADVANCING 2 LINES.                                 03300001
033100*                                                                 03310001
033200     WRITE DUPLICATE-RCVRS-REPORT-RECORD                          03320001
033300       FROM DH2-DETAIL-HEADING-LINE-2                             03330001
033400         AFTER ADVANCING 1 LINE.                                  03340001
033500*                                                                 03350001
033600*                                                                 03360001
033700*8000-EXIT.                                                       03370001
033800*                                                                 03380001
033900*                                                                 03390001
034000 8100-WRITE-DUP-RCVRS-DETAIL.                                     03400001
034100******************************************************************03410001
034200*  WRITE THE STYLE SUMMARY DETAIL RECORD.                         03420001
034300******************************************************************03430001
034400     IF PS-PRINT-BLANK-LINE                                       03440001
034500        WRITE DUPLICATE-RCVRS-REPORT-RECORD                       03450001
034600            FROM PV-BLANK-LINE                                    03460001
034700                AFTER ADVANCING 1 LINE                            03470001
034800        ADD 1 TO PV-LINES-USED                                    03480001
034900        SET PS-DONT-PRINT-BLANK-LINE TO TRUE                      03490001
035000     END-IF.                                                      03500001
035100                                                                  03510001
035200     WRITE DUPLICATE-RCVRS-REPORT-RECORD                          03520001
035300         FROM DL-DETAIL-LINE                                      03530001
035400             AFTER ADVANCING 1 LINE.                              03540001
035500                                                                  03550001
035600     ADD 1 TO PV-LINES-USED.                                      03560001
035700                                                                  03570001
035800*8100-EXIT.                                                       03580001
035900*                                                                 03590001
036000*                                                                 03600001
036100 9000-EOJ-ROUTINE.                                                03610001
036200******************************************************************03620001
036300*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  03630001
036400*  THE CURSOR.                                                    03640001
036500******************************************************************03650001
036600     ADD 2 TO PV-LINES-USED.                                      03660001
036700                                                                  03670001
036800     IF PV-LINES-USED > PC-PAGE-SIZE-066                          03680001
036900        PERFORM 8000-WRITE-PAGE-HEADINGS                          03690001
037000     END-IF.                                                      03700001
037100                                                                  03710001
037200     WRITE DUPLICATE-RCVRS-REPORT-RECORD                          03720001
037300         FROM ER-END-OF-REPORT-LINE                               03730001
037400             AFTER ADVANCING 2 LINES.                             03740001
037500                                                                  03750001
037600     CLOSE DUPLICATE-RCVRS-EXTRACT                                03760001
037700           DUPLICATE-RCVRS-REPORT.                                03770001
037800*                                                                 03780001
037900*                                                                 03790001
038000*9000-EXIT.                                                       03800001
