000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKRP249.                                         00020000
000300 AUTHOR.        JIM ARENDT.                                       00030000
000400 DATE-WRITTEN.  DECEMBER 2016.                                    00040000
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060000
000700*     REPORT OF RECYCLE 210 INVOICES                             *00070000
000800*----------------------------------------------------------------*00080000
000900*    COBOL 390                                                   *00090000
001000*----------------------------------------------------------------*00100000
001100*  PURPOSE:  TO CREATE A REPORT OF EDI 210 INVOICES BEING        *00110000
001200*  RECYCLED BECAUSE THE BROKER REFERENCE NUMBER AND /OR THE      *00120000
001300*  CUSTOMS ENTRY NUMBER COULD NOT BE VERIFIED FOR THE PO.        *00130000
001400*                                                                *00140000
001500*  INPUT:  RECYCLE REPORT RECORDS (APRD179)                      *00150000
001600*  OUTPUT: INVOICES IN RECYCLE STATUS REPORT                     *00160000
001700*----------------------------------------------------------------*00170000
001800* CHANGES:                                                       *00180000
001900*   MM/DD/CCYY                                                   *00190002
002000*      INITIAL VERSION                                           *00200002
002100*        MADE BY: JIM ARENDT              WR/IR #: CHG0158799    *00210000
002200*                                                                *00220000
001900*   01/25/2019                                                   *00221002
002000*      ADDED A LINE TO WRITE OUT TO THE CSV FILE IF NO DATA      *00222002
002000*      IS IN THE INPUT FILE.                                     *00223002
002100*        MADE BY: BARB SCHULTZ            WR/IR #: CHG0216620    *00224003
002200*                                                                *00225002
002300*----------------------------------------------------------------*00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500 CONFIGURATION SECTION.                                           00250000
002600 SOURCE-COMPUTER.        IBM-370.                                 00260000
002700 OBJECT-COMPUTER.        IBM-370.                                 00270000
002800                                                                  00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000 FILE-CONTROL.                                                    00300000
003100     SELECT RECYCLE-RPT-FILE     ASSIGN TO INP01.                 00310000
003200     SELECT DELIMITED-FILE       ASSIGN TO OUT01.                 00320000
003300     SELECT RECYCLE-REPORT       ASSIGN TO RPT01.                 00330000
003400                                                                  00340000
003500 DATA DIVISION.                                                   00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  RECYCLE-RPT-FILE                                             00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     RECORD CONTAINS 200 CHARACTERS                               00420000
004300     DATA RECORD IS RECYCLE-RPT-REC.                              00430000
004400                                                                  00440000
004500 01  RECYCLE-RPT-REC                    PIC X(200).               00450000
004600                                                                  00460000
004700 FD  DELIMITED-FILE                                               00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     RECORDING MODE IS F                                          00490000
005000     BLOCK CONTAINS 0 RECORDS.                                    00500000
005100 01  DELIMITED-RECORD                   PIC X(150).               00510000
005200                                                                  00520000
005300 FD  RECYCLE-REPORT                                               00530000
005400     RECORDING MODE IS F                                          00540000
005500     LABEL RECORDS ARE STANDARD                                   00550000
005600     BLOCK CONTAINS 0 RECORDS                                     00560000
005700     RECORD CONTAINS 132 CHARACTERS                               00570000
005800     DATA RECORD IS RECYCLE-REPORT-REC.                           00580000
005900                                                                  00590000
006000 01  RECYCLE-REPORT-REC                 PIC X(132).               00600000
006100                                                                  00610000
006200                                                                  00620000
006300 WORKING-STORAGE SECTION.                                         00630000
006400                                                                  00640000
006500 01  PROGRAM-SWITCHES.                                            00650000
006600     05  PS-RECYCLE-RPT-EOF-SW          PIC X       VALUE 'N'.    00660000
006700         88 PS-RECYCLE-RPT-NOT-EOF                  VALUE 'N'.    00670000
006800         88 PS-RECYCLE-RPT-EOF                      VALUE 'Y'.    00680000
006900     05  PS-END-OF-TABLE-CHRG-SW        PIC X       VALUE 'N'.    00690000
007000         88 PS-NOT-END-OF-TABLE-CHRG                VALUE 'N'.    00700000
007100         88 PS-END-OF-TABLE-CHRG                    VALUE 'Y'.    00710000
007200     05  PS-RECYCLES-TO-RPT-SW          PIC X       VALUE 'Y'.    00720000
007300         88 NO-RECYCLES-TO-REPORT                   VALUE 'N'.    00730000
007400         88 RECYCLES-TO-REPORT                      VALUE 'Y'.    00740000
007500     05  PS-FIRST-FIVE-SW               PIC X       VALUE 'Y'.    00750000
007600         88 PS-FIRST-FIVE-NO                        VALUE 'N'.    00760000
007700         88 PS-FIRST-FIVE                           VALUE 'Y'.    00770000
007800                                                                  00780000
007900 01  PROGRAM-VARIABLES.                                           00790000
008000     05  PV-RECYCLE-RPT-OUT             PIC  9(12)  VALUE 0.      00800000
008100     05  PV-COUNT-INPUT                 PIC  9(12)  VALUE 0.      00810000
008200     05  MAX-LINES                      PIC S9(03)  COMP-3        00820000
008300                                                    VALUE +65.    00830000
008400     05  PAGE-COUNT                     PIC S9(9) COMP-3 VALUE +0.00840000
008500     05  LINE-COUNT                     PIC S9(3) COMP-3 VALUE +0.00850000
008600     05  DELIM-COUNT                    PIC S9(3) COMP-3 VALUE +0.00860000
008700     05  PV-PO-LEN                      PIC S9(4) COMP   VALUE +0.00870000
008800     05  PV-DAY-LEN                     PIC S9(4) COMP   VALUE +0.00880000
008900     05  PV-INV-LEN                     PIC S9(4) COMP   VALUE +0.00890000
009000     05  PV-ENT-LEN                     PIC S9(4) COMP   VALUE +0.00900000
009100     05  PV-AMT-LEN                     PIC S9(4) COMP   VALUE +0.00910000
009200     05  PV-MBOL-LEN                    PIC S9(4) COMP   VALUE +0.00920000
009300     05  PV-SYSTEM-DATE                 PIC X(08)  VALUE ZERO.    00930000
009400     05  FILLER REDEFINES PV-SYSTEM-DATE.                         00940000
009500         10  PV-SYSTEM-CCYY.                                      00950000
009600             15  PV-SYSTEM-CENTURY      PIC X(02).                00960000
009700             15  PV-SYSTEM-YEAR         PIC X(02).                00970000
009800         10  PV-SYSTEM-MONTH            PIC X(02).                00980000
009900         10  PV-SYSTEM-DAY              PIC X(02).                00990000
010000     05  PV-SYSTEM-TIME.                                          01000000
010100         10  PV-SYSTEM-HOUR             PIC 9(02) VALUE ZERO.     01010000
010200         10  PV-SYSTEM-MINUTE           PIC 9(02) VALUE ZERO.     01020000
010300         10  PV-SYSTEM-SECOND           PIC 9(02) VALUE ZERO.     01030000
010400         10  FILLER                     PIC 9(02) VALUE ZERO.     01040000
010500     05  PV-PROGRAM-NAME                PIC X(8) VALUE 'APKRP249'.01050000
010600     05  PV-HLD-VNDR-NBR                PIC 9(09) VALUE ZEROES.   01060000
010700     05  PV-HLD-INVC-NBR                PIC X(22) VALUE SPACES.   01070000
010800     05  SAVE-CHRG-CODE                 PIC X(03) VALUE SPACES.   01080000
010900     05  SAVE-CHRG-AMT                  PIC -------.99            01090000
011000                                                  VALUE ZEROES.   01100000
017200     05  PV-CSV-LINE.                                             01101000
017200         10  PV-VENDOR-ID            PIC X(09) VALUE SPACES.      01102000
017400         10  PV-INVOIC-NBR           PIC X(22) VALUE SPACES.      01103000
017600         10  PV-INVOICE-DTE          PIC X(08) VALUE SPACES.      01104000
017800         10  PV-MBOL-NBR             PIC X(14) VALUE SPACES.      01105000
018000         10  PV-PO-NBR               PIC 9(09) VALUE ZEROES.      01106000
018200         10  PV-ENTRY-NBR            PIC X(15) VALUE SPACES.      01107000
018400         10  PV-CUST-REFERENCE       PIC X(17) VALUE SPACES.      01108000
018600         10  PV-RECYCLE-DAYS         PIC   99  VALUE ZEROES.      01109000
018800         10  PV-INVOICE-AMT          PIC 9(8)9.99  VALUE ZEROES.  01109100
011100 01  WS-WORK-AREA.                                                01109200
011200     05  WS-VNDR-INVC-KEY.                                        01109300
011300         10  WS-VENDOR-NBR           PIC X(09)     VALUE SPACES.  01109400
011400         10  WS-INVOICE-NBR          PIC X(22)     VALUE SPACES.  01109500
011500                                                                  01109600
011600*----------------------------------------------------------------*01109700
011700*           KOHLS STANDARD 132 CHARACTER REPORT HEADER           *01109800
011800*----------------------------------------------------------------*01109900
011900     COPY DPWS132O.                                               01110000
012000                                                                  01120000
012100 01  BLANK-LINE                PIC X(132) VALUE SPACES.           01130000
012200                                                                  01140000
012300 01  SAVE-DETAIL-LINE          PIC X(132) VALUE SPACES.           01150000
012400                                                                  01160000
012500 01  HDR-TITLE-1.                                                 01170000
012600     05  FILLER                  PIC  X(47)     VALUE SPACE.      01180000
012700     05  FILLER                  PIC  X(40)     VALUE             01190000
012800         'EXPEDITOR 210 INVOICES IN RECYCLE STATUS'.              01200000
012900     05  FILLER                  PIC  X(44)     VALUE SPACE.      01210000
013000                                                                  01220000
013100 01  HEADER-1.                                                    01230000
013200     05  FILLER                PIC X(06) VALUE 'VENDOR'.          01240000
013300     05  FILLER                PIC X(06) VALUE SPACES.            01250000
013400     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01260000
013500     05  FILLER                PIC X(17) VALUE SPACES.            01270000
013600     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01280000
013700     05  FILLER                PIC X(03) VALUE SPACES.            01290000
013800     05  FILLER                PIC X(04) VALUE 'MBOL'.            01300000
013900     05  FILLER                PIC X(17) VALUE SPACES.            01310000
014000     05  FILLER                PIC X(02) VALUE 'PO'.              01320000
014100     05  FILLER                PIC X(09) VALUE SPACES.            01330000
014200     05  FILLER                PIC X(05) VALUE 'ENTRY'.           01340000
014300     05  FILLER                PIC X(13) VALUE SPACES.            01350000
014400     05  FILLER                PIC X(08) VALUE 'CUSTOMER'.        01360000
014500     05  FILLER                PIC X(06) VALUE SPACES.            01370000
014600     05  FILLER                PIC X(07) VALUE 'RECYCLE'.         01380000
014700     05  FILLER                PIC X(06) VALUE SPACES.            01390000
014800     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01400000
014900     05  FILLER                PIC X(02) VALUE SPACES.            01410000
015000                                                                  01420000
015100 01  HEADER-2.                                                    01430000
015200     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01440000
015300     05  FILLER                PIC X(06) VALUE SPACES.            01450000
015400     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01460000
015500     05  FILLER                PIC X(18) VALUE SPACES.            01470000
015600     05  FILLER                PIC X(04) VALUE 'DATE'.            01480000
015700     05  FILLER                PIC X(06) VALUE SPACES.            01490000
015800     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01500000
015900     05  FILLER                PIC X(15) VALUE SPACES.            01510000
016000     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01520000
016100     05  FILLER                PIC X(05) VALUE SPACES.            01530000
016200     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01540000
016300     05  FILLER                PIC X(12) VALUE SPACES.            01550000
016400     05  FILLER                PIC X(09) VALUE 'REFERENCE'.       01560000
016500     05  FILLER                PIC X(08) VALUE SPACES.            01570000
016600     05  FILLER                PIC X(04) VALUE 'DAYS'.            01580000
016700     05  FILLER                PIC X(07) VALUE SPACES.            01590000
016800     05  FILLER                PIC X(06) VALUE 'AMOUNT'.          01600000
016900     05  FILLER                PIC X(02) VALUE SPACES.            01610000
017000                                                                  01620000
017100 01  DETAIL-1.                                                    01630000
017200     05  DTL-VENDOR-ID         PIC X(09) VALUE SPACES.            01640000
017300     05  FILLER                PIC X(03) VALUE SPACES.            01650000
017400     05  DTL-INVOIC-NBR        PIC X(22) VALUE SPACES.            01660000
017500     05  FILLER                PIC X(02) VALUE SPACES.            01670000
017600     05  DTL-INVOICE-DTE       PIC X(08) VALUE SPACES.            01680000
017700     05  FILLER                PIC X(02) VALUE SPACES.            01690000
017800     05  DTL-MBOL-NBR          PIC X(20) VALUE SPACES.            01700000
017900     05  FILLER                PIC X(01) VALUE SPACES.            01710000
018000     05  DTL-PO-NBR            PIC Z(09) VALUE ZEROES.            01720000
018100     05  FILLER                PIC X(02) VALUE SPACES.            01730000
018200     05  DTL-ENTRY-NBR         PIC X(17) VALUE SPACES.            01740000
018300     05  FILLER                PIC X(01) VALUE SPACES.            01750000
018400     05  DTL-CUST-REFERENCE    PIC X(17) VALUE SPACES.            01760000
018500     05  FILLER                PIC X(02) VALUE SPACES.            01770000
018600     05  DTL-RECYCLE-DAYS      PIC   99  VALUE ZEROES.            01780000
018700     05  FILLER                PIC X(02) VALUE SPACES.            01790000
018800     05  DTL-INVOICE-AMT       PIC Z(8)9.99  VALUE ZEROES.        01800000
018900     05  FILLER                PIC X(01) VALUE SPACES.            01810000
019000                                                                  01820000
019100 01  END-OF-REPORT.                                               01830000
019200     05  FILLER                PIC X(52) VALUE SPACES.            01840000
019300     05  FILLER                PIC X(29) VALUE                    01850000
019400        '- - - - END OF REPORT - - - -'.                          01860000
019500     05  FILLER                PIC X(51) VALUE SPACES.            01870000
019600                                                                  01880000
019700 01  NO-DATA-TO-REPORT.                                           01890000
019800     05  FILLER                PIC X(54) VALUE SPACES.            01900000
019900     05  FILLER                PIC X(23) VALUE                    01910000
020000        '-  NO DATA TO REPORT  -'.                                01920000
020100     05  FILLER                PIC X(55) VALUE SPACES.            01930000
020200                                                                  01931001
020200 01  NO-DATA-TO-RPT            PIC X(53) VALUE                    01940001
020200        '        NO DATA FOR 210 INVOICES IN RECYCLE STATUS   '.  01940101
020200                                                                  01940301
020200                                                                  01940401
020300 01  DELIM-HEAD-LINE.                                             01950000
020400     05  FILLER               PIC X(11) VALUE 'VENDOR NBR|'.      01960000
020500     05  FILLER               PIC X(12) VALUE 'INVOICE NBR|'.     01970000
020600     05  FILLER               PIC X(11) VALUE 'INVOICE DT|'.      01980000
020700     05  FILLER               PIC X(09) VALUE 'MBOL NBR|'.        01990000
020800     05  FILLER               PIC X(07) VALUE 'PO NBR|'.          02000000
020900     05  FILLER               PIC X(10) VALUE 'ENTRY NBR|'.       02010000
021000     05  FILLER               PIC X(09) VALUE 'CUST REF|'.        02020000
021100     05  FILLER               PIC X(13) VALUE 'RECYCLE DAYS|'.    02030000
021200     05  FILLER               PIC X(11) VALUE 'INVOICE AMT'.      02040000
021300 EJECT                                                            02050000
021400                                                                  02060000
022100*--------------------------------------------------------------*  02070000
022200*  RECORD LAYOUT FOR THE EDI IMPORT LANDED COST INVOICE FILE   *  02080000
022300*--------------------------------------------------------------*  02090000
022400     COPY APRD179.                                                02100000
022500                                                                  02110000
022600                                                                  02120000
022700 LINKAGE SECTION.                                                 02130000
022800 PROCEDURE DIVISION.                                              02140000
022900                                                                  02150000
023000 A100-MAINLINE-ROUTINE.                                           02160000
023100                                                                  02170000
023200     PERFORM B100-INITIALIZATION.                                 02180000
023300                                                                  02190000
023400     PERFORM B200-CREATE-RECYCLE-RPT                              02200000
023500       UNTIL PS-RECYCLE-RPT-EOF.                                  02210000
023600                                                                  02220000
023700     PERFORM B300-END-OF-JOB.                                     02230000
023800     GOBACK.                                                      02240000
023900                                                                  02250000
024000*--------------------------------------------------------------*  02260000
024100* B100-INITIALIZATION                                          *  02270000
024200*  OPEN FILES, PREPARE REPORT HEADERS AND PERFORM INITIAL READ *  02280000
024300*--------------------------------------------------------------*  02290000
024400 B100-INITIALIZATION.                                             02300000
024500                                                                  02310000
024600     DISPLAY ' '.                                                 02320000
024700     DISPLAY '**--------------- APKRP249 --------------------**'. 02330000
024800     OPEN INPUT  RECYCLE-RPT-FILE                                 02340000
024900          OUTPUT DELIMITED-FILE                                   02350000
025000                 RECYCLE-REPORT.                                  02360000
025100                                                                  02370000
025200     MOVE FUNCTION CURRENT-DATE  TO PV-SYSTEM-DATE.               02380000
025300     MOVE PV-SYSTEM-MONTH        TO DP132O-RUN-MONTH.             02390000
025400     MOVE PV-SYSTEM-DAY          TO DP132O-RUN-DAY.               02400000
025500     MOVE PV-SYSTEM-YEAR         TO DP132O-RUN-YEAR.              02410000
025600     ACCEPT PV-SYSTEM-TIME FROM TIME.                             02420000
025700     MOVE PV-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              02430000
025800     MOVE PV-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            02440000
025900     MOVE PV-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          02450000
026000     MOVE '1'                    TO DP132O-REPORT-NUMBER.         02460000
026100     PERFORM W100-WRITE-HEADINGS.                                 02470000
026200                                                                  02480000
026300*  THIS READS THE FIRST RECORD OF THE INPUT FILE AND CHECKS TO SEE02490000
026400*  IF THERE ARE RECORDS TO PROCESS.                               02500000
026500     PERFORM R100-READ-INPUT.                                     02510000
026600                                                                  02520000
026700     IF PS-RECYCLE-RPT-EOF                                        02530000
026800        SET NO-RECYCLES-TO-REPORT TO TRUE                         02540000
026900     END-IF.                                                      02550000
027000                                                                  02560000
027100     MOVE AP179-VENDOR-NBR  TO WS-VENDOR-NBR.                     02570000
027200     MOVE AP179-INVOICE-NBR TO WS-INVOICE-NBR.                    02580000
027300                                                                  02590000
027400*--------------------------------------------------------------*  02600000
027500* B200-CREATE-RECYCLE-RPT                                      *  02610000
027600*  THIS ROUTINE HOLDS THE MAIN LOGIC FOR RECYCLE REVIEW        *  02620000
027700*  REPORTING.                                                  *  02630000
027800*--------------------------------------------------------------*  02640000
027900 B200-CREATE-RECYCLE-RPT.                                         02650000
028000                                                                  02660000
028100     IF AP179-VNDR-INVC-KEY NOT = WS-VNDR-INVC-KEY                02670000
028200        SET PS-FIRST-FIVE       TO TRUE                           02680000
028300        MOVE DETAIL-1           TO SAVE-DETAIL-LINE               02690000
028400        PERFORM W200-WRITE-DETAIL                                 02700000
028500        PERFORM W400-WRITE-DELIMITED-RECORD                       02710000
028600        MOVE SPACES             TO DETAIL-1                       02720000
028700        PERFORM W300-WRITE-BLANK-LINE                             02730000
028800        MOVE AP179-VENDOR-NBR   TO WS-VENDOR-NBR                  02740000
028900        MOVE AP179-INVOICE-NBR  TO WS-INVOICE-NBR                 02750000
029000     END-IF.                                                      02760000
029100                                                                  02770000
029200**    RECORD TYPE CODE '01'                                       02780000
029300     IF AP179-210-INTRCHG-HDR                                     02790000
029400        MOVE AP179-VENDOR-NBR    TO DTL-VENDOR-ID                 02800000
029400                                    PV-VENDOR-ID                  02810000
029500        MOVE AP179-INVOICE-NBR   TO DTL-INVOIC-NBR                02820000
029500                                    PV-INVOIC-NBR                 02830000
029600        MOVE AP179-RECYCLE-COUNT TO DTL-RECYCLE-DAYS              02840000
029600                                    PV-RECYCLE-DAYS               02850000
029700     END-IF.                                                      02860000
029800                                                                  02870000
029900**    RECORD TYPE CODE '02'                                       02880000
030000     IF AP179-210-INVOICE-HDR                                     02890000
030100        MOVE AP179-INVC-DTE     TO DTL-INVOICE-DTE                02900000
030100                                   PV-INVOICE-DTE                 02910000
030200        MOVE AP179-NET-INVC-AMT TO DTL-INVOICE-AMT                02920000
030200                                   PV-INVOICE-AMT                 02930000
030300     END-IF.                                                      02940000
030400                                                                  02950000
030500**    RECORD TYPE CODE '03'                                       02960000
030600     IF AP179-210-REF-ID                                          02970000
030700        EVALUATE TRUE                                             02980000
030800           WHEN AP179-ENTRY-NBR                                   02990000
030900                MOVE AP179-REFERENCE-ID-NBR TO DTL-ENTRY-NBR      03000000
030900                                               PV-ENTRY-NBR       03010000
031000           WHEN AP179-BOL-NBR                                     03020000
031100                MOVE AP179-REFERENCE-ID-NBR TO DTL-MBOL-NBR       03030000
031100                                               PV-MBOL-NBR        03040000
031200           WHEN AP179-CUSTOMER-REF                                03050000
031300                MOVE AP179-REFERENCE-ID-NBR TO DTL-CUST-REFERENCE 03060000
031300                                               PV-CUST-REFERENCE  03070000
031400        END-EVALUATE                                              03080000
031500     END-IF.                                                      03090000
031600                                                                  03100000
031700**    RECORD TYPE CODE '05'                                       03110000
031800     IF AP179-210-PO-DATA                                         03120000
031900        IF PS-FIRST-FIVE                                          03130000
032000           SET PS-FIRST-FIVE-NO     TO TRUE                       03140000
032100           MOVE AP179-PO-NBR        TO DTL-PO-NBR                 03150000
032100                                       PV-PO-NBR                  03160000
032200        ELSE                                                      03170000
032300           MOVE DETAIL-1 TO SAVE-DETAIL-LINE                      03180000
032400           PERFORM W200-WRITE-DETAIL                              03190000
032500           PERFORM W400-WRITE-DELIMITED-RECORD                    03200000
032600           MOVE SPACES              TO DETAIL-1                   03210000
032700           MOVE AP179-PO-NBR        TO DTL-PO-NBR                 03220000
032700                                       PV-PO-NBR                  03230000
032800        END-IF                                                    03240000
032900     END-IF.                                                      03250000
033000                                                                  03260000
033100     PERFORM R100-READ-INPUT.                                     03270000
033200                                                                  03280000
033300*--------------------------------------------------------------*  03290000
033400* B300-END-OF-JOB                                              *  03300000
033500*  PRINT LAST DETAIL LINE, DISPLAY COUNTS, CLOSE FILES.        *  03310000
033600*--------------------------------------------------------------*  03320000
033700 B300-END-OF-JOB.                                                 03330000
033800                                                                  03340000
033900     IF  NO-RECYCLES-TO-REPORT                                    03350000
034000         DISPLAY ' NO REPORT RECORDS TO PROCESS '                 03360000
034100         WRITE RECYCLE-REPORT-REC FROM NO-DATA-TO-REPORT          03370000
034200             AFTER ADVANCING 1 LINE                               03380000
034100         WRITE DELIMITED-RECORD FROM NO-DATA-TO-RPT               03380101
034300     ELSE                                                         03390000
034400         MOVE DETAIL-1 TO SAVE-DETAIL-LINE                        03400000
034500         PERFORM W200-WRITE-DETAIL                                03410000
034600         PERFORM W400-WRITE-DELIMITED-RECORD                      03420000
034700         MOVE SPACES TO DETAIL-1                                  03430000
034800         PERFORM W300-WRITE-BLANK-LINE                            03440000
034900     END-IF.                                                      03450000
035000                                                                  03460000
035100     WRITE RECYCLE-REPORT-REC FROM END-OF-REPORT                  03470000
035200        AFTER ADVANCING 2 LINES.                                  03480000
035300                                                                  03490000
035400     DISPLAY '**************************************'.            03500000
035500     DISPLAY 'EDI IMPORT INVOICE COUNT  ' PV-COUNT-INPUT.         03510000
035600     DISPLAY 'RECYCLE RECORDS WRITTEN   ' PV-RECYCLE-RPT-OUT.     03520000
035700     DISPLAY '**************************************'.            03530000
035800     DISPLAY ' '.                                                 03540000
035900                                                                  03550000
036000     CLOSE RECYCLE-RPT-FILE                                       03560000
036100           DELIMITED-FILE                                         03570000
036200           RECYCLE-REPORT.                                        03580000
036300                                                                  03590000
036400*--------------------------------------------------------------*  03600000
036500* R100-READ-INPUT                                              *  03610000
036600*  READS A RECORD IN A FILE.                                   *  03620000
036700*--------------------------------------------------------------*  03630000
036800 R100-READ-INPUT.                                                 03640000
036900                                                                  03650000
037000      INITIALIZE AP179-EDI-IMPORT-INVOICE.                        03660000
037100      READ RECYCLE-RPT-FILE INTO AP179-EDI-IMPORT-INVOICE         03670000
037200          AT END                                                  03680000
037300              SET PS-RECYCLE-RPT-EOF TO TRUE                      03690000
037400      END-READ.                                                   03700000
037500                                                                  03710000
037600      IF PS-RECYCLE-RPT-NOT-EOF                                   03720000
037700         ADD 1 TO PV-COUNT-INPUT                                  03730000
037800      END-IF.                                                     03740000
037900                                                                  03750000
038000*--------------------------------------------------------------*  03760000
038100* W100-WRITE-HEADINGS                                          *  03770000
038200*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                   *  03780000
038300*--------------------------------------------------------------*  03790000
038400 W100-WRITE-HEADINGS.                                             03800000
038500                                                                  03810000
038600     ADD 1 TO PAGE-COUNT.                                         03820000
038700     MOVE PAGE-COUNT TO DP132O-PAGE-NUMBER.                       03830000
038800     WRITE RECYCLE-REPORT-REC                                     03840000
038900       FROM DP132O-STANDRD-HEADER-132-COLS AFTER ADVANCING PAGE.  03850000
039000     WRITE RECYCLE-REPORT-REC FROM HDR-TITLE-1                    03860000
039100         AFTER ADVANCING 1 LINE.                                  03870000
039200     WRITE RECYCLE-REPORT-REC FROM BLANK-LINE                     03880000
039300         AFTER ADVANCING 1 LINE.                                  03890000
039400     WRITE RECYCLE-REPORT-REC FROM HEADER-1                       03900000
039500         AFTER ADVANCING 2 LINES.                                 03910000
039600     WRITE RECYCLE-REPORT-REC FROM HEADER-2                       03920000
039700         AFTER ADVANCING 1 LINE.                                  03930000
039800     WRITE RECYCLE-REPORT-REC FROM BLANK-LINE                     03940000
039900         AFTER ADVANCING 1 LINE.                                  03950000
040000     MOVE +7            TO LINE-COUNT.                            03960000
040100                                                                  03970000
040200*--------------------------------------------------------------*  03980000
040300* W200-WRITE-DETAIL                                            *  03990000
040400*  THIS ROUTINE WRITES THE DETAIL LINES.                       *  04000000
040500*--------------------------------------------------------------*  04010000
040600 W200-WRITE-DETAIL.                                               04020000
040700                                                                  04030000
040800     IF LINE-COUNT >= MAX-LINES                                   04040000
040900        PERFORM W100-WRITE-HEADINGS                               04050000
041000        MOVE SAVE-DETAIL-LINE TO DETAIL-1                         04060000
041100     END-IF.                                                      04070000
041200                                                                  04080000
041300     WRITE RECYCLE-REPORT-REC FROM DETAIL-1                       04090000
041400         AFTER ADVANCING 1 LINE.                                  04100000
041500                                                                  04110000
041600     ADD 1 TO LINE-COUNT                                          04120000
041700              PV-RECYCLE-RPT-OUT.                                 04130000
041800                                                                  04140000
041900*--------------------------------------------------------------*  04150000
042000* W300-WRITE-BLANK-LINE                                        *  04160000
042100*--------------------------------------------------------------*  04170000
042200 W300-WRITE-BLANK-LINE.                                           04180000
042300                                                                  04190000
042400     IF LINE-COUNT >= MAX-LINES                                   04200000
042500        CONTINUE                                                  04210000
042600     ELSE                                                         04220000
042700        WRITE RECYCLE-REPORT-REC FROM BLANK-LINE                  04230000
042800        ADD 1 TO LINE-COUNT                                       04240000
042900     END-IF.                                                      04250000
043000                                                                  04260000
043100*--------------------------------------------------------------*  04270000
043200*  WRITES THE INTERFACED TRANSACTION EXCEPTION DETAILS TO FILE *  04280000
043300*--------------------------------------------------------------*  04290000
043400 W400-WRITE-DELIMITED-RECORD.                                     04300000
043500                                                                  04310000
043600     INITIALIZE DELIMITED-RECORD.                                 04320000
043700                                                                  04330000
043800     IF DELIM-COUNT = 0                                           04340000
043900        WRITE DELIMITED-RECORD FROM DELIM-HEAD-LINE               04350000
044000        INITIALIZE DELIMITED-RECORD                               04360000
044100        ADD 1 TO DELIM-COUNT                                      04370000
044200     END-IF.                                                      04380000
044300                                                                  04390000
045000     STRING PV-VENDOR-ID                   DELIMITED BY SPACE     04400000
045100            '|'                            DELIMITED BY SPACE     04410000
045200            PV-INVOIC-NBR                  DELIMITED BY SPACE     04420000
045300            '|'                            DELIMITED BY SPACE     04430000
045400            PV-INVOICE-DTE                 DELIMITED BY SPACE     04440000
045500            '|'                            DELIMITED BY SPACE     04450000
045600            PV-MBOL-NBR                    DELIMITED BY SPACE     04460000
045700            '|'                            DELIMITED BY SPACE     04470000
045800            PV-PO-NBR                      DELIMITED BY SPACE     04480000
045900            '|'                            DELIMITED BY SPACE     04490000
046000            PV-ENTRY-NBR                   DELIMITED BY SPACE     04500000
046100            '|'                            DELIMITED BY SPACE     04510000
046200            PV-CUST-REFERENCE              DELIMITED BY SPACE     04520000
046300            '|'                            DELIMITED BY SPACE     04530000
046400            PV-RECYCLE-DAYS                DELIMITED BY SIZE      04540000
046500            '|'                            DELIMITED BY SPACE     04550000
046600            PV-INVOICE-AMT                 DELIMITED BY SIZE      04560000
046700      INTO DELIMITED-RECORD                                       04570000
046800     END-STRING.                                                  04580000
046900                                                                  04590000
047000     WRITE DELIMITED-RECORD.                                      04600000
047100                                                                  04610000
