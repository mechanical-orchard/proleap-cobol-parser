000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*                                                                 00040000
000500 PROGRAM-ID.    SUKUT185.                                         00050022
000600 AUTHOR.        JIM ARENDT.                                       00060019
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  03/17.                                            00080019
001000*                                                                 00090000
001100*----------------------------------------------------------------*00100000
001200*         STORE TRANSFER PROCESSING                              *00110084
001300*----------------------------------------------------------------*00120000
001900                                                                  00130000
002000******************************************************************00140000
002100 ENVIRONMENT DIVISION.                                            00150000
002200******************************************************************00160000
002300                                                                  00170000
002400 CONFIGURATION SECTION.                                           00180000
002500                                                                  00190000
002600 OBJECT-COMPUTER.  IBM-3090.                                      00200000
002700 SOURCE-COMPUTER.  IBM-3090.                                      00210000
002800                                                                  00220000
002900 INPUT-OUTPUT SECTION.                                            00230000
003000                                                                  00240000
003100 FILE-CONTROL.                                                    00250000
003000                                                                  00260020
003200     SELECT STR-MISLOAD-FILE                                      00270025
003300         ASSIGN TO INP01.                                         00280000
003000                                                                  00290020
003400     SELECT MERCHANDISE-LEDGER-FILE                               00300000
003500         ASSIGN TO OUT01.                                         00310000
003000                                                                  00320020
003600     SELECT SKU-RECEIPTS-FILE                                     00330000
003700         ASSIGN TO OUT02.                                         00340000
003000                                                                  00350020
003800     SELECT SKU-ADJUST-FILE                                       00360000
003900         ASSIGN TO OUT03.                                         00370000
003000                                                                  00380050
003800     SELECT SKU-MISLOAD-FILE                                      00390053
003900         ASSIGN TO OUT04.                                         00400050
003000                                                                  00410020
004500******************************************************************00420000
004600 DATA DIVISION.                                                   00430000
004700******************************************************************00440000
004900 FILE SECTION.                                                    00450000
005000                                                                  00460000
005100 FD  STR-MISLOAD-FILE                                             00470025
005200     RECORDING MODE IS F                                          00480000
005300     LABEL RECORDS ARE STANDARD                                   00490000
005400     RECORD CONTAINS 100 CHARACTERS                               00500026
005500     BLOCK CONTAINS 0 RECORDS.                                    00510000
005600                                                                  00520000
005700 01  STR-MISLOAD-RECORD          PIC X(100).                      00530061
005800                                                                  00540000
005900                                                                  00550000
006000 FD  MERCHANDISE-LEDGER-FILE                                      00560000
006100     RECORDING MODE IS F                                          00570000
006200     LABEL RECORDS ARE STANDARD                                   00580000
006300     RECORD CONTAINS 80 CHARACTERS                                00590000
006400     BLOCK CONTAINS 0 RECORDS.                                    00600000
006500                                                                  00610000
006600 01  MERCHANDISE-LEDGER-RECORD   PIC X(80).                       00620061
006700                                                                  00630000
006800                                                                  00640000
006900 FD  SKU-RECEIPTS-FILE                                            00650000
007000     RECORDING MODE IS F                                          00660000
007100     LABEL RECORDS ARE STANDARD                                   00670000
007200     RECORD CONTAINS 200 CHARACTERS                               00680000
007300     BLOCK CONTAINS 0 RECORDS.                                    00690000
007400                                                                  00700000
007500 01  SKU-RECEIPTS-RECORD         PIC X(200).                      00710061
007600                                                                  00720000
007700                                                                  00730000
007800 FD  SKU-ADJUST-FILE                                              00740000
007900     RECORDING MODE IS F                                          00750000
008000     LABEL RECORDS ARE STANDARD                                   00760000
008100     RECORD CONTAINS 200 CHARACTERS                               00770000
008200     BLOCK CONTAINS 0 RECORDS.                                    00780000
008300                                                                  00790000
008400 01  SKU-ADJUST-RECORD           PIC X(200).                      00800061
008500                                                                  00810000
007800 FD  SKU-MISLOAD-FILE                                             00820053
007900     RECORDING MODE IS F                                          00830050
008000     LABEL RECORDS ARE STANDARD                                   00840050
008100     RECORD CONTAINS 131 CHARACTERS                               00850050
008200     BLOCK CONTAINS 0 RECORDS.                                    00860050
008300                                                                  00870050
008400 01  SKU-MISLOAD-RECORD          PIC X(131).                      00880061
008300                                                                  00890050
084100******************************************************************00900019
010500 WORKING-STORAGE SECTION.                                         00910000
024400 01  PC-PROGRAM-CONSTANTS.                                        00920019
024600     05  PC-PROGRAM-NAME         PIC  X(08)    VALUE 'SUKUT185'.  00930030
024500     05  PC-MERCH-TRAN-CODE      PIC  X(01)    VALUE '3'.         00940025
024900     05  PC-SKU-FIELD-NUM        PIC  X(03)    VALUE '123'.       00950019
025000     05  PC-SKU-ACTION-MINUS     PIC  X(01)    VALUE '-'.         00960025
026900                                                                  00970019
015200 01  PV-PROGRAM-VARIABLES.                                        00980019
015300     05  PV-ML-QTY               PIC  9(05).                      00990019
015700     05  PV-STR-MISLDS-READ      PIC S9(07)    COMP SYNC VALUE +0.01000024
015800     05  PV-MERCH-RECS-WR        PIC S9(07)    COMP SYNC VALUE +0.01010019
015800     05  PV-MERCH-HIGH-QTY-RECS  PIC S9(07)    COMP SYNC VALUE +0.01020088
015900     05  PV-RECEIPT-RECS-WR      PIC S9(07)    COMP SYNC VALUE +0.01030019
016000     05  PV-ADJUST-RECS-WR       PIC S9(07)    COMP SYNC VALUE +0.01040019
016000     05  PV-MISLOAD-RECS-WR      PIC S9(07)    COMP SYNC VALUE +0.01050050
016100     05  PV-DISPLAY-COUNT        PIC  Z,ZZZ,ZZ9.                  01060023
016200     05  PV-SQLCODE              PIC  9(09)     VALUE ZERO.       01070031
016200     05  PV-FISCAL-MN-NBR        PIC  X(02)     VALUE SPACES.     01080032
071000     05  PV-SKU-NMBR             PIC  9(08).                      01090039
071100     05  PV-SKU REDEFINES PV-SKU-NMBR.                            01100039
071200         10 FILLER               PIC  X(08).                      01110039
007500     05  PV-BATCH-NMBR.                                           01120021
007600         10  FILLER              PIC  X(01)     VALUE '0'.        01130078
007500         10  PV-BATCH-NMBR-LAST3.                                 01140078
007600             15  FILLER          PIC  X(01)     VALUE '5'.        01150078
007700             15  PV-BATCH-DAY    PIC  X(02)     VALUE SPACES.     01160078
020000     05  PV-SKU-NUM.                                              01170045
020100         10  PV-SKUNUM-DEPT      PIC  9(03).                      01180061
020200         10  PV-SKUNUM-CLASS     PIC  9(02).                      01190061
020300         10  PV-SKUNUM-SUBCLASS  PIC  9(02).                      01200061
020400     05  PV-NEW-SKU.                                              01210045
020500         10  PV-NEW-SKU-DEPT     PIC  X(03).                      01220061
020600         10  PV-NEW-SKU-CLASS    PIC  X(02).                      01230061
020700         10  PV-NEW-SKU-SUBCLASS PIC  X(02).                      01240061
012000     05  PV-MAJ-CL-NBR-9         PIC  9(04).                      01250056
012000     05  PV-MAJ-CL-NBR-X   REDEFINES  PV-MAJ-CL-NBR-9             01260061
012000                                 PIC  X(04).                      01270056
012000     05  PV-SUB-CL-NBR-9         PIC  9(04).                      01280055
012000     05  PV-SUB-CL-NBR-X   REDEFINES  PV-SUB-CL-NBR-9             01290061
012000                                 PIC  X(04).                      01300055
005500     05  PV-ORIG-TRIP-ID         PIC  9(09).                      01310054
005500     05  PV-ORIG-TRIP-ID-X REDEFINES  PV-ORIG-TRIP-ID             01320061
005500                                 PIC  X(09).                      01330052
005500     05  PV-SCAN-TRIP-ID         PIC  9(09).                      01340054
005500     05  PV-SCAN-TRIP-ID-X REDEFINES  PV-SCAN-TRIP-ID             01350061
005500                                 PIC  X(09).                      01360052
005500     05  PV-RCVR-SEQ-NBR-9       PIC  9(04).                      01370057
005500     05  PV-RCVR-SEQ-NBR-X REDEFINES  PV-RCVR-SEQ-NBR-9           01380061
005500                                 PIC  X(04).                      01390057
005500     05  PV-TRN-LNE-NBR-9        PIC  9(04).                      01400057
005500     05  PV-TRN-LNE-NBR-X   REDEFINES  PV-TRN-LNE-NBR-9           01410057
005500                                 PIC  X(04).                      01420057
005500     05  PV-TO-STR-NBR-X.                                         01430066
005500         10  FILLER              PIC  X(02).                      01440068
005500         10  PV-TO-TRANSFER      PIC  X(03).                      01450068
005500     05  PV-TO-STR-NBR-9  REDEFINES PV-TO-STR-NBR-X               01460066
005500                                 PIC  9(05).                      01470066
005500     05  PV-FROM-STR-NBR-X.                                       01480066
005500         10  FILLER              PIC  X(03).                      01490068
005500         10  PV-FROM-TRANSFER    PIC  X(02).                      01500068
005500     05  PV-FROM-STR-NBR-9  REDEFINES PV-FROM-STR-NBR-X           01510066
005500                                 PIC  9(05).                      01520066
005500     05  PV-TRANSFER-NBR.                                         01530061
005500         10  PV-TRANSFER-FROM    PIC  X(02).                      01540068
005500         10  PV-TRANSFER-TO      PIC  X(03).                      01550068
017000                                                                  01560019
018100 01  PV-ABEND-FIELDS.                                             01570019
018500     05  PV-ABEND-PARAGRAPH          PIC  X(50) VALUE SPACES.     01580045
018600     05  PV-ABEND-OPERATION          PIC  X(50) VALUE SPACES.     01590045
018700     05  PV-ABEND-STRUCTURE-1        PIC  X(08) VALUE SPACES.     01600045
018800     05  PV-ABEND-STRUCTURE-2        PIC  X(08) VALUE SPACES.     01610045
018900     05  PV-ABEND-STRUCTURE-3        PIC  X(08) VALUE SPACES.     01620045
019000     05  PV-DB2-OPERATION-MESSAGE-1  PIC  X(79) VALUE SPACES.     01630045
019100     05  PV-DB2-OPERATION-MESSAGE-2  PIC  X(79) VALUE SPACES.     01640045
019200     05  PV-DB2-OPERATION-MESSAGE-3  PIC  X(79) VALUE SPACES.     01650045
019500                                                                  01660019
027000 01  PV-BATCH-DATE-ISO-FMT       PIC  X(10).                      01670045
027100 01  FILLER      REDEFINES       PV-BATCH-DATE-ISO-FMT.           01680045
027300     05  PV-BATCH-DATE-CCYY      PIC  9(04).                      01690070
027700     05  FILLER                  PIC  X(01).                      01700045
027800     05  PV-BATCH-DATE-MM        PIC  9(02).                      01710070
028000     05  FILLER                  PIC  X(01).                      01720045
028100     05  PV-BATCH-DATE-DD        PIC  9(02).                      01730070
024100                                                                  01740019
012800 01  PS-PROGRAM-SWITCHES.                                         01750000
013300     05  PS-END-OF-STR-MISLDS-SW      PIC X(01) VALUE 'N'.        01760061
013500         88  PS-END-OF-STR-MISLDS               VALUE 'Y'.        01770061
013600     05  PS-ERRORS-FOUND-SW           PIC X(01) VALUE 'N'.        01780061
013700         88  PS-ERRORS-FOUND                    VALUE 'Y'.        01790061
013800         88  PS-ERRORS-NOT-FOUND                VALUE 'N'.        01800061
014800                                                                  01810061
014900 01  DK-DB2-KEY-FIELDS.                                           01820000
015000     05  DK-SKU                  PIC  9(08).                      01830061
015100                                                                  01840000
075300*-----------------------------------------------------------------01850000
075400*  ABEND ROUTINE WORKING STORAGE                                  01860000
075500*-----------------------------------------------------------------01870000
075600     COPY DPWS004.                                                01880000
075700                                                                  01890000
075800 01  ABEND-CODE                  PIC S9(04)    COMP SYNC VALUE +0.01900000
075900                                                                  01910000
076000*-----------------------------------------------------------------01920000
076100*  DB2 TABLES                                                     01930032
076200*-----------------------------------------------------------------01940000
076400     EXEC SQL                                                     01950032
076500        INCLUDE TDTATTR                                           01960032
076600     END-EXEC.                                                    01970032
076700                                                                  01980032
076400     EXEC SQL                                                     01990032
076500        INCLUDE TCOCNTL                                           02000032
076600     END-EXEC.                                                    02010032
076700                                                                  02020032
082600*-----------------------------------------------------------------02030000
082700*  DB2 COMMUNICATION AREA                                         02040000
082800*-----------------------------------------------------------------02050000
083000     EXEC SQL                                                     02060000
083100        INCLUDE SQLCA                                             02070000
083200     END-EXEC.                                                    02080000
083300                                                                  02090000
083400*-----------------------------------------------------------------02100000
083500*  DB2 COMMUNICATION AREA 2                                       02110000
083600*-----------------------------------------------------------------02120000
083700     COPY SQLCA2.                                                 02130000
083800                                                                  02140000
083600*-----------------------------------------------------------------02150019
010600*COPYBOOK FOR LOGISTIC DOMAIN MODULE                              02160019
083600*-----------------------------------------------------------------02170019
010800     COPY XLWS001.                                                02180019
010900                                                                  02190019
083600*-----------------------------------------------------------------02200019
011000*   MERCHANDISE LEDGER AND FASHION SALES INPUT RECORD LAYOUT.     02210024
083600*-----------------------------------------------------------------02220019
011200     COPY SURD154.                                                02230024
011300                                                                  02240019
083600*-----------------------------------------------------------------02250019
011400*   MERCHANDISE LEDGER OUTPUT RECORD LAYOUT.                      02260019
083600*-----------------------------------------------------------------02270019
011600     COPY MLRD019.                                                02280019
011700                                                                  02290019
083600*-----------------------------------------------------------------02300019
011800*   FASHION SALES MAINTENANCE RECORD LAYOUTS.                     02310019
083600*-----------------------------------------------------------------02320019
012000     COPY FSRD035.                                                02330019
012100                                                                  02340019
012200     COPY FSRD036.                                                02350019
012300                                                                  02360019
083600*-----------------------------------------------------------------02370084
011000*   MISLOAD CARTON OUTPUT RECORD LAYOUT.                          02380084
083600*-----------------------------------------------------------------02390084
011200     COPY SURD151.                                                02400084
011300                                                                  02410084
083900******************************************************************02420000
084000 PROCEDURE DIVISION.                                              02430000
084100******************************************************************02440000
084300 A000-MAIN-DRIVER.                                                02450000
084400                                                                  02460000
084500     PERFORM B050-INITIALIZATION.                                 02470000
085500                                                                  02480000
085600     IF PS-END-OF-STR-MISLDS                                      02490024
085800         CONTINUE                                                 02500030
085900     ELSE                                                         02510000
086400         PERFORM B100-PROCESS-STR-MISLOADS                        02520024
086500             UNTIL PS-END-OF-STR-MISLDS                           02530024
087000     END-IF.                                                      02540000
087100                                                                  02550000
088000     PERFORM B300-DISPLAY-RECORD-COUNTS.                          02560000
088100                                                                  02570000
088200     CLOSE STR-MISLOAD-FILE                                       02580025
088300           MERCHANDISE-LEDGER-FILE                                02590000
088400           SKU-RECEIPTS-FILE                                      02600000
088500           SKU-ADJUST-FILE                                        02610050
008400           SKU-MISLOAD-FILE.                                      02620050
088800                                                                  02630000
088900     GOBACK.                                                      02640000
089000                                                                  02650000
084100******************************************************************02660019
089100 B050-INITIALIZATION.                                             02670000
092600                                                                  02680000
084700     OPEN INPUT  STR-MISLOAD-FILE                                 02690038
084800          OUTPUT MERCHANDISE-LEDGER-FILE                          02700038
084900                 SKU-RECEIPTS-FILE                                02710038
085000                 SKU-ADJUST-FILE                                  02720050
085000                 SKU-MISLOAD-FILE.                                02730050
089600                                                                  02740038
199800     PERFORM B060-RETRIEVE-BATCH-DATE.                            02750059
085300                                                                  02760038
085400     PERFORM Z100-READ-STR-MISLOADS.                              02770038
084600                                                                  02780038
084100******************************************************************02790025
199800 B060-RETRIEVE-BATCH-DATE.                                        02800059
199900                                                                  02810025
200000     EXEC SQL                                                     02820025
200100        SELECT BTCH_PRC_DTE                                       02830025
200200          INTO :PV-BATCH-DATE-ISO-FMT                             02840045
200200          FROM TCOCNTL                                            02850025
200200         WHERE OPER_UNT_ID = 90                                   02860081
200200         WITH UR                                                  02870025
200900     END-EXEC.                                                    02880025
201092                                                                  02890025
201100     EVALUATE TRUE                                                02900025
201200         WHEN SQLCODE = ZERO                                      02910025
028100             MOVE PV-BATCH-DATE-DD      TO PV-BATCH-DAY           02920082
201300                                                                  02930025
201600         WHEN OTHER                                               02940025
201800             MOVE 'B060-RETRIEVE-BATCH-DATE'                      02950059
201900                                        TO PV-ABEND-PARAGRAPH     02960035
205200             MOVE 'TCOCNTL'             TO PV-ABEND-STRUCTURE-1   02970035
202000             MOVE 'SELECT BATCH DATE'   TO PV-ABEND-OPERATION     02980085
202100             PERFORM Z900-SQL-ABEND                               02990025
202200     END-EVALUATE.                                                03000025
202300                                                                  03010025
084100******************************************************************03020019
099600 B100-PROCESS-STR-MISLOADS.                                       03030024
099700                                                                  03040000
101400     PERFORM C300-PROCESS-INPUT-RECORD.                           03050039
101500                                                                  03060000
101600     PERFORM Z100-READ-STR-MISLOADS.                              03070024
101700                                                                  03080000
084100******************************************************************03090019
106300 B300-DISPLAY-RECORD-COUNTS.                                      03100000
106400                                                                  03110000
106500     DISPLAY ' '.                                                 03120000
106600     DISPLAY '   SUKUT185 RECORDS READ:  '.                       03130065
106700                                                                  03140000
106800     MOVE PV-STR-MISLDS-READ TO PV-DISPLAY-COUNT.                 03150024
106900     DISPLAY 'INPUT RECORDS READ      = ' PV-DISPLAY-COUNT.       03160000
107000                                                                  03170000
106500     DISPLAY ' '.                                                 03180064
106600     DISPLAY '   SUKUT185 RECORDS WROTE: '.                       03190065
107100     MOVE PV-MERCH-RECS-WR  TO PV-DISPLAY-COUNT.                  03200000
107200     DISPLAY 'MERCH RECORDS WROTE     = ' PV-DISPLAY-COUNT.       03210076
015800     MOVE PV-MERCH-HIGH-QTY-RECS                                  03220088
107100                            TO PV-DISPLAY-COUNT.                  03230088
107200     DISPLAY 'MERCH RECS QTY > 999    = ' PV-DISPLAY-COUNT.       03240088
107300                                                                  03250000
107400     MOVE PV-RECEIPT-RECS-WR TO PV-DISPLAY-COUNT.                 03260000
107500     DISPLAY 'RECEIPT RECORDS WROTE   = ' PV-DISPLAY-COUNT.       03270076
107600                                                                  03280000
107700     MOVE PV-ADJUST-RECS-WR TO PV-DISPLAY-COUNT.                  03290000
107800     DISPLAY 'ADJUSTMNT RECORDS WROTE = ' PV-DISPLAY-COUNT.       03300076
106500                                                                  03310050
185600     MOVE PV-MISLOAD-RECS-WR TO PV-DISPLAY-COUNT.                 03320050
107800     DISPLAY 'MISLOAD RECORDS WROTE   = ' PV-DISPLAY-COUNT.       03330076
106500     DISPLAY ' '.                                                 03340050
108000                                                                  03350000
084100******************************************************************03360019
117200 C300-PROCESS-INPUT-RECORD.                                       03370039
117300                                                                  03380000
135300     PERFORM E100-EDIT-XLV-SKU.                                   03390087
122300                                                                  03400028
122800     PERFORM D300-CREATE-MERCH-LEDGER-REC.                        03410087
123300                                                                  03420087
122900     PERFORM D400-CREATE-SKU-RECEIPTS-REC.                        03430087
123300                                                                  03440087
123000     PERFORM D500-CREATE-SKU-ADJUST-REC.                          03450087
123300                                                                  03460087
123000     PERFORM D600-CREATE-SKU-MISLOAD-REC.                         03470087
123300                                                                  03480000
146800                                                                  03490000
084100******************************************************************03500019
146900 D300-CREATE-MERCH-LEDGER-REC.                                    03510000
147000                                                                  03520000
147000     INITIALIZE ML019-TRANSFER-RECORD.                            03530047
147000                                                                  03540047
147100     MOVE PC-MERCH-TRAN-CODE    TO ML019-TRANSFER-CODE.           03550000
147200     MOVE SU154-FROM-STR-NBR    TO PV-FROM-STR-NBR-9              03560066
147200                                   ML019-TRANSFER-FROM-STORE-9.   03570061
027800     MOVE PV-BATCH-DATE-MM      TO ML019-TRANSFER-MM.             03580077
028100     MOVE PV-BATCH-DATE-DD      TO ML019-TRANSFER-DD.             03590077
147800                                                                  03600032
147900     PERFORM D350-GET-FISCAL-MM.                                  03610032
200200     MOVE PV-FISCAL-MN-NBR      TO ML019-TRANSFER-KOHLS-MM.       03620032
148000                                                                  03630000
148000     IF XL001-GP-QTY > 1                                          03640032
148000       COMPUTE XL001-UNT-RTL-AMT = XL001-GP-AMT                   03650032
148000                                 / XL001-GP-QTY                   03660032
148000     END-IF.                                                      03670032
148100     MOVE XL001-UNT-RTL-AMT     TO ML019-TRANSFER-PER-UNT-RTL-AMT.03680032
148000                                                                  03690048
070700     MOVE PV-BATCH-NMBR-LAST3   TO ML019-TRANSFER-BATCH-NBR.      03700048
148300                                                                  03710000
148400     MOVE XL001-DEPT-NBR-3CH    TO PV-SKUNUM-DEPT                 03720025
148500                                   PV-NEW-SKU-DEPT.               03730025
148600     MOVE XL001-SUB-CL-NBR-2CH  TO PV-SKUNUM-SUBCLASS             03740025
148700                                   PV-NEW-SKU-SUBCLASS.           03750025
148800     MOVE XL001-MAJ-CL-NBR-2CH  TO PV-SKUNUM-CLASS                03760025
148900                                   PV-NEW-SKU-CLASS.              03770025
149000                                                                  03780000
149100     MOVE PV-NEW-SKU-DEPT       TO ML019-TRANSFER-DEPT-NBR.       03790025
149200     MOVE PV-NEW-SKU-SUBCLASS   TO ML019-TRANSFER-CLASS-NBR.      03800025
149300                                                                  03810000
149400     MOVE XL001-SKU-NBR         TO PV-SKU-NMBR.                   03820039
149500     MOVE PV-SKU                TO ML019-SKU.                     03830039
149501                                                                  03840005
149502     MOVE XL001-ENT-ID          TO ML019-TRANSFER-ENT-ID.         03850025
149600                                                                  03860000
150100     MOVE SU154-TO-STR-NBR      TO PV-TO-STR-NBR-9                03870066
150100                                   ML019-TRANSFER-TO-STORE-9.     03880061
150230                                                                  03890032
150231     MOVE PV-TO-TRANSFER        TO PV-TRANSFER-TO.                03900086
150232     MOVE PV-FROM-TRANSFER      TO PV-TRANSFER-FROM.              03910086
147400     MOVE PV-TRANSFER-NBR       TO ML019-TRANSFER-NBR.            03920061
147400                                                                  03930088
150240     IF SU154-IN-TRNST-QTY > 999                                  03940039
150250        MOVE SU154-IN-TRNST-QTY TO PV-ML-QTY                      03950039
150260        PERFORM UNTIL PV-ML-QTY < 1000                            03960039
015800           ADD 1                TO PV-MERCH-HIGH-QTY-RECS         03970088
150270           MOVE 999             TO ML019-TRANSFER-QTY             03980039
150271           PERFORM Z110-WRITE-MERCH-LEDGER-REC                    03990039
150272           SUBTRACT 999                                           04000039
150273              FROM PV-ML-QTY                                      04010039
150274                 GIVING PV-ML-QTY                                 04020039
150275        END-PERFORM                                               04030039
150276        MOVE PV-ML-QTY          TO ML019-TRANSFER-QTY             04040039
150280     ELSE                                                         04050039
150300        MOVE SU154-IN-TRNST-QTY TO ML019-TRANSFER-QTY             04060039
150500     END-IF.                                                      04070039
150700                                                                  04080000
150410     PERFORM Z110-WRITE-MERCH-LEDGER-REC.                         04090045
150700                                                                  04100045
084100******************************************************************04110032
147900 D350-GET-FISCAL-MM.                                              04120032
199900                                                                  04130032
200000     EXEC SQL                                                     04140032
200100        SELECT FSCL_MN_NBR                                        04150032
200200          INTO :PV-FISCAL-MN-NBR                                  04160032
200200          FROM TDTATTR                                            04170032
200200         WHERE KY_DTE  = :PV-BATCH-DATE-ISO-FMT                   04180045
200200         WITH UR                                                  04190032
200900     END-EXEC.                                                    04200032
201092                                                                  04210032
201100     EVALUATE TRUE                                                04220032
201200         WHEN SQLCODE = ZERO                                      04230032
201200             CONTINUE                                             04240032
212200                                                                  04250032
201200         WHEN SQLCODE = +100                                      04260032
212200             MOVE SPACES                 TO PV-BATCH-DATE-ISO-FMT 04270045
201300                                                                  04280032
201600         WHEN OTHER                                               04290032
201800             MOVE 'D350-GET-FISCAL-MM'   TO PV-ABEND-PARAGRAPH    04300032
205200             MOVE 'TDTATTR'              TO PV-ABEND-STRUCTURE-1  04310032
202000             MOVE 'SELECT FISCAL MONTH'  TO PV-ABEND-OPERATION    04320032
202100             PERFORM Z900-SQL-ABEND                               04330032
202200     END-EVALUATE.                                                04340032
202300                                                                  04350032
084100******************************************************************04360019
150800 D400-CREATE-SKU-RECEIPTS-REC.                                    04370000
150900                                                                  04380000
150900     INITIALIZE FS036-RECEIPT-RECORD.                             04390072
150900                                                                  04400072
151000     MOVE XL001-ITM-NBR               TO FS036-ITM-NBR.           04410024
151200     MOVE SU154-PO-NBR                TO FS036-PO-NBR.            04420071
151300     MOVE SU154-RCVR-SEQ-NBR          TO FS036-RCVR-NBR.          04430071
016300     MOVE PV-BATCH-DATE-ISO-FMT       TO FS036-RCPT-DTE           04440082
016300                                         FS036-VRFD-DTE.          04450082
152000     MOVE PV-BATCH-NMBR               TO FS036-BTCH-NBR.          04460035
152100     MOVE PC-PROGRAM-NAME             TO FS036-RCPT-SRC-PGM-NM.   04470027
152600     MOVE SU154-TO-STR-NBR            TO FS036-LOC-NBR.           04480040
151900     MOVE SU154-IN-TRNST-QTY          TO FS036-TOT-RCPT-QTY       04490070
152800                                         FS036-LOC-RCPT-QTY.      04500070
152900                                                                  04510039
153000     PERFORM Z120-WRITE-SKU-RECEIPTS-REC.                         04520039
153200                                                                  04530000
084100******************************************************************04540019
153300 D500-CREATE-SKU-ADJUST-REC.                                      04550000
153400                                                                  04560000
153400     INITIALIZE FS035-ADJUSTMENT-RECORD.                          04570073
153400                                                                  04580073
153500     MOVE XL001-ITM-NBR         TO FS035-ITM-NBR.                 04590024
153700     MOVE SU154-FROM-STR-NBR    TO FS035-LOC-NBR.                 04600039
153800     MOVE PC-SKU-FIELD-NUM      TO FS035-ADJ-TYP.                 04610000
153900     MOVE PC-SKU-ACTION-MINUS   TO FS035-ACTN-CDE.                04620000
154000     MOVE SU154-IN-TRNST-QTY    TO FS035-ADJ-QTY.                 04630039
154100     MOVE PV-BATCH-NMBR         TO FS035-BTCH-NBR.                04640035
154200     MOVE PC-PROGRAM-NAME       TO FS035-ADJ-SRC-PGM-NM.          04650025
154300                                                                  04660000
154400     PERFORM Z130-WRITE-SKU-ADJUST-REC.                           04670000
154500                                                                  04680000
084100******************************************************************04690050
123000 D600-CREATE-SKU-MISLOAD-REC.                                     04700050
154500                                                                  04710050
           INITIALIZE SU151-MISLOADED-CARTONS.                          04720050
154500                                                                  04730050
           MOVE SU154-TO-STR-NBR      TO SU151-SCAN-LOC.                04740052
           MOVE PV-BATCH-NMBR         TO SU151-BTCH-NBR.                04750052
016300     MOVE PV-BATCH-DATE-ISO-FMT TO SU151-DATE.                    04760082
           MOVE SU154-FROM-STR-NBR    TO SU151-ORIG-STORE.              04770052
           MOVE SU154-SHIPT-UNT-ID    TO SU151-SML-NUMBER.              04780052
005500     MOVE SU154-SML-TYPE        TO SU151-SML-TYPE.                04790078
005500     MOVE SU154-ORIG-TRIP-ID    TO PV-ORIG-TRIP-ID.               04800052
           MOVE PV-ORIG-TRIP-ID-X     TO SU151-ORIG-TRIP-ID.            04810074
005500     MOVE SU154-SCAN-TRIP-ID    TO PV-SCAN-TRIP-ID.               04820052
           MOVE PV-SCAN-TRIP-ID-X     TO SU151-SCAN-TRIP-ID.            04830074
149100     MOVE PV-NEW-SKU-DEPT       TO SU151-DEPT-NBR.                04840052
012000     MOVE XL001-MAJ-CL-NBR      TO PV-MAJ-CL-NBR-9.               04850055
012000     MOVE PV-MAJ-CL-NBR-X       TO SU151-MAJOR-CL.                04860055
021700     MOVE XL001-SUB-CL-NBR      TO PV-SUB-CL-NBR-9.               04870055
021700     MOVE PV-SUB-CL-NBR-X       TO SU151-SUB-CL.                  04880055
149400     MOVE XL001-SKU-NBR         TO SU151-SKU-NBR.                 04890052
010100     MOVE XL001-SKU-DESC        TO SU151-SKU-DESC.                04900052
           MOVE SU154-PO-NBR          TO SU151-PO-NBR.                  04910052
           MOVE SU154-RCVR-SEQ-NBR    TO PV-RCVR-SEQ-NBR-9.             04920057
           MOVE PV-RCVR-SEQ-NBR-X     TO SU151-RCVR-SEQ-NBR.            04930057
           MOVE SU154-TRN-LNE-NBR     TO PV-TRN-LNE-NBR-9.              04940058
           MOVE PV-TRN-LNE-NBR-X      TO SU151-LINE-NBR.                04950057
           MOVE SU154-IN-TRNST-QTY    TO SU151-UNITS.                   04960052
148100     MOVE XL001-UNT-RTL-AMT     TO SU151-RETAIL-AMT.              04970052
                                                                        04980050
154400     PERFORM Z140-WRITE-SKU-MISLOAD-REC.                          04990050
154400                                                                  05000050
084100******************************************************************05010019
174000 E100-EDIT-XLV-SKU.                                               05020000
174100                                                                  05030039
174300     MOVE SU154-SKU-NUMBER           TO DK-SKU.                   05040032
174400                                                                  05050000
174500     INITIALIZE XL001-ITEM-COMMAREA.                              05060000
174600                                                                  05070000
174700     SET XL001-BY-NUMERIC-SKU                                     05080000
174800         XL001-SELECT-SKU                                         05090000
174900         XL001-SELECT-VND-STYL                                    05100000
175000         XL001-SELECT-SKU-STR        TO TRUE.                     05110000
175100                                                                  05120000
175200      MOVE DK-SKU                    TO XL001-KEY-SKU.            05130000
175300                                                                  05140000
175400      CALL 'XLKUT001'                                             05150021
175400          USING XL001-ITEM-COMMAREA.                              05160021
175500                                                                  05170000
175600      EVALUATE TRUE                                               05180000
175700        WHEN XL001-SKU-SQLCODE   = +0                             05190000
175800           PERFORM E150-VND-CHECK-PARA                            05200086
175500                                                                  05210021
175900        WHEN XL001-SKU-SQLCODE   = +100                           05220000
176100           DISPLAY '*** SKU NOT FOUND ==> ' DK-SKU                05230087
176400           MOVE 'E100-EDIT-XLV-SKU'    TO PV-ABEND-PARAGRAPH      05240087
176500           MOVE 'XLV-SKU '             TO PV-ABEND-STRUCTURE-1    05250087
176600           MOVE 'SKU NOT FOUND'        TO PV-ABEND-OPERATION      05260087
176700           MOVE XL001-SKU-SQLCODE      TO SQLCODE                 05270087
176800           PERFORM Z900-SQL-ABEND                                 05280087
176200                                                                  05290000
176300        WHEN XL001-SKU-CONTENTION                                 05300035
176400           MOVE 'E100-EDIT-XLV-SKU'    TO PV-ABEND-PARAGRAPH      05310087
176500           MOVE 'XLV-SKU '             TO PV-ABEND-STRUCTURE-1    05320035
176600           MOVE 'SKU CONTENTION'       TO PV-ABEND-OPERATION      05330035
176700           MOVE XL001-SKU-SQLCODE      TO SQLCODE                 05340035
176800           PERFORM Z900-SQL-ABEND                                 05350000
176900                                                                  05360000
177000        WHEN OTHER                                                05370035
177100           MOVE 'E100-EDIT-XLV-SKU'    TO PV-ABEND-PARAGRAPH      05380087
177200           MOVE 'XLV-SKU '             TO PV-ABEND-STRUCTURE-1    05390035
177300           MOVE 'INVALID SKU ACCESS'   TO PV-ABEND-OPERATION      05400000
177400           MOVE XL001-SKU-SQLCODE      TO SQLCODE                 05410035
176100           DISPLAY '*** SKU ERROR ==> ' DK-SKU                    05420032
177500           PERFORM Z900-SQL-ABEND                                 05430000
177700                                                                  05440086
177600      END-EVALUATE.                                               05450000
177700                                                                  05460000
084100******************************************************************05470019
177800 E150-VND-CHECK-PARA.                                             05480039
184500                                                                  05490026
178000      EVALUATE TRUE                                               05500000
178100        WHEN XL001-VND-STYL-SQLCODE = +0                          05510000
178110             MOVE XL001-DEPT-NBR-3CH     TO PV-SKUNUM-DEPT        05520086
178130             MOVE XL001-SUB-CL-NBR-2CH   TO PV-SKUNUM-SUBCLASS    05530086
178150             MOVE XL001-MAJ-CL-NBR-2CH   TO PV-SKUNUM-CLASS       05540086
178200             PERFORM E200-STR-CHECK-PARA                          05550039
178300                                                                  05560000
178400        WHEN XL001-VND-STYL-SQLCODE = +100                        05570000
178410             MOVE ZERO                   TO PV-SKUNUM-DEPT        05580086
178420                                            PV-SKUNUM-SUBCLASS    05590086
178430                                            PV-SKUNUM-CLASS       05600086
178600                                                                  05610000
178700        WHEN XL001-VND-STYL-CONTENTION                            05620035
178800             MOVE 'E150-VND-CHECK-PARA'  TO PV-ABEND-PARAGRAPH    05630086
178900             MOVE 'XLV-VND-STYL'         TO PV-ABEND-STRUCTURE-1  05640086
179000             MOVE 'VND CONTENTION'       TO PV-ABEND-OPERATION    05650086
179100             MOVE XL001-VND-STYL-SQLCODE TO SQLCODE               05660086
179200             PERFORM Z900-SQL-ABEND                               05670086
179300                                                                  05680000
179400        WHEN OTHER                                                05690035
178800             MOVE 'E150-VND-CHECK-PARA'  TO PV-ABEND-PARAGRAPH    05700086
179600             MOVE 'XLV-VND-STYL'         TO PV-ABEND-STRUCTURE-1  05710086
179700             MOVE XL001-VND-STYL-SQLCODE TO SQLCODE               05720086
179800             MOVE 'INVALID VND ACCESS'   TO PV-ABEND-OPERATION    05730086
179900             MOVE XL001-VND-STYL-SQLCODE TO SQLCODE               05740086
180000             PERFORM Z900-SQL-ABEND                               05750086
180100                                                                  05760000
180200      END-EVALUATE.                                               05770000
180300                                                                  05780000
084100******************************************************************05790019
180400 E200-STR-CHECK-PARA.                                             05800039
180500                                                                  05810000
180600      EVALUATE TRUE                                               05820000
180700        WHEN XL001-SKU-STR-SQLCODE = +0                           05830000
180800           CONTINUE                                               05840035
180900                                                                  05850000
181000        WHEN XL001-SKU-STR-SQLCODE = +100                         05860000
181200           MOVE 0                     TO XL001-UNT-RTL-AMT        05870035
181300                                                                  05880000
181400        WHEN XL001-SKU-STR-CONTENTION                             05890035
181500           MOVE 'E200-STR-CHECK-PARA' TO PV-ABEND-PARAGRAPH       05900086
181600           MOVE 'XLV-SKU-STR'         TO PV-ABEND-STRUCTURE-1     05910035
181700           MOVE 'STR CONTENTION'      TO PV-ABEND-OPERATION       05920035
181800           MOVE XL001-SKU-STR-SQLCODE TO SQLCODE                  05930000
181900           PERFORM Z900-SQL-ABEND                                 05940000
182000                                                                  05950000
182100        WHEN OTHER                                                05960035
182200           MOVE 'E200-STR-CHECK-PARA' TO PV-ABEND-PARAGRAPH       05970039
182300           MOVE 'XLV-STR-STYL'        TO PV-ABEND-STRUCTURE-1     05980035
182400           MOVE XL001-SKU-STR-SQLCODE TO SQLCODE                  05990000
182500           MOVE 'INVALID STR ACCESS'  TO PV-ABEND-OPERATION       06000035
182600           PERFORM Z900-SQL-ABEND                                 06010000
182700                                                                  06020000
182800      END-EVALUATE.                                               06030000
182900                                                                  06040000
084100******************************************************************06050019
183000 Z100-READ-STR-MISLOADS.                                          06060024
183100                                                                  06070000
183200     READ STR-MISLOAD-FILE                                        06080025
183300       INTO SU154-STR-MISLD-TRANS-REC                             06090035
183400         AT END                                                   06100024
183400           SET PS-END-OF-STR-MISLDS TO TRUE.                      06110024
183500                                                                  06120000
183600     IF PS-END-OF-STR-MISLDS                                      06130024
183600         CONTINUE                                                 06140024
183600     ELSE                                                         06150024
183700         ADD +1 TO PV-STR-MISLDS-READ                             06160024
183800     END-IF.                                                      06170000
183900                                                                  06180000
084100******************************************************************06190029
184000 Z110-WRITE-MERCH-LEDGER-REC.                                     06200029
184100                                                                  06210029
184200     WRITE MERCHANDISE-LEDGER-RECORD                              06220029
184300         FROM ML019-TRANSFER-RECORD.                              06230029
183900                                                                  06240029
184400     ADD +1 TO PV-MERCH-RECS-WR.                                  06250029
184100                                                                  06260029
084100******************************************************************06270029
184600 Z120-WRITE-SKU-RECEIPTS-REC.                                     06280029
184700                                                                  06290029
184800     WRITE SKU-RECEIPTS-RECORD                                    06300029
184900         FROM FS036-RECEIPT-RECORD.                               06310029
184500                                                                  06320029
185000     ADD +1 TO PV-RECEIPT-RECS-WR.                                06330029
185100                                                                  06340029
084100******************************************************************06350029
185200 Z130-WRITE-SKU-ADJUST-REC.                                       06360029
185300                                                                  06370029
185400     WRITE SKU-ADJUST-RECORD                                      06380029
185500         FROM FS035-ADJUSTMENT-RECORD.                            06390029
185300                                                                  06400029
185600     ADD +1 TO PV-ADJUST-RECS-WR.                                 06410029
185700                                                                  06420029
084100******************************************************************06430050
154400 Z140-WRITE-SKU-MISLOAD-REC.                                      06440050
185300                                                                  06450050
185400     WRITE SKU-MISLOAD-RECORD                                     06460050
185500         FROM SU151-MISLOADED-CARTONS.                            06470050
185300                                                                  06480050
185600     ADD +1 TO PV-MISLOAD-RECS-WR.                                06490050
185700                                                                  06500050
084100******************************************************************06510019
204100 Z900-SQL-ABEND.                                                  06520000
204200                                                                  06530000
204300     MOVE SQLCODE TO PV-SQLCODE.                                  06540000
204400     DISPLAY '*** DB2 ERROR '.                                    06550000
204500     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       06560000
204600     DISPLAY '*** PROGRAM   = ' PC-PROGRAM-NAME.                  06570027
204700     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               06580000
204800     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               06590000
204900     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       06600000
205000     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       06610000
205100     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       06620000
205200     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             06630000
205300                                                                  06640000
205400                                                                  06650000
205500*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         06660000
205600*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        06670000
205700                                                                  06680000
205800     COPY DPPD004.                                                06690000
205900                                                                  06700000
206000     CALL 'ILBOABN0' USING ABEND-CODE.                            06710000
