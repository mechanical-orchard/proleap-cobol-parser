000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000600******************************************************************00060004
000700 PROGRAM-ID.    CNKUT801.                                         00070099
000800 AUTHOR.        TKMA497.                                          00080007
000900 INSTALLATION.  KOHLS.                                            00090004
001000 DATE-WRITTEN   JULY, 2011.                                       00100007
001100 DATE-COMPILED.                                                   00110004
001200******************************************************************00120004
001300*  NEW DC - TCOCNTL EXTRACT                                       00130099
001310*  THIS PROGRAM EXTRACTS DATA FROM THE COMPANY CONTROL TABLE      00131099
001400*  AND IF THE NEW OPER_UNT_ID VALUE IN THE CONTROL CARD IS        00140099
001500*  DIFFERENT FROM THE VALUE USED IN THE SELECT, IT REPLACES       00150099
001600*  THE VALUE USED IN THE SELECT WITH THE NEW VALUE IN THE         00160099
001700*  CONTROL CARD BEFORE WRITING THE OUTPUT FILE.                   00170009
006600******************************************************************00660004
007000 ENVIRONMENT DIVISION.                                            00700004
007100******************************************************************00710004
007200 CONFIGURATION SECTION.                                           00720004
007300*                                                                 00730004
007400 SOURCE-COMPUTER.        IBM-3090.                                00740004
007500 OBJECT-COMPUTER.        IBM-3090.                                00750004
007600*                                                                 00760004
007700 INPUT-OUTPUT SECTION.                                            00770004
007800*                                                                 00780004
007900 FILE-CONTROL.                                                    00790004
008000*                                                                 00800099
008400     SELECT CONTROL-FILE-OUT                                      00840099
008500         ASSIGN TO OUT01.                                         00850004
008700*                                                                 00870004
008800******************************************************************00880004
008900 DATA DIVISION.                                                   00890004
009000******************************************************************00900004
009100 FILE SECTION.                                                    00910004
009200*                                                                 00920004
010000*                                                                 01000004
010100 FD  CONTROL-FILE-OUT                                             01010099
010200     RECORDING MODE IS F                                          01020004
010300     BLOCK CONTAINS 0 RECORDS                                     01030004
010400     LABEL RECORDS ARE STANDARD.                                  01040004
010500*                                                                 01050004
010600 01  CONTROL-REC-OUT                PIC  X(181).                  01060099
010800*                                                                 01080004
010900 WORKING-STORAGE SECTION.                                         01090004
011000*                                                                 01100004
011100 01  PC-PROGRAM-CONSTANTS.                                        01110004
011200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)    VALUE            01120019
011300         'CNKUT801'.                                              01130099
011400                                                                  01140004
011500 01  DK-DB2-KEYS.                                                 01150099
011600     05  DK-OPER-UNT-ID             PIC S9(04)  VALUE ZERO        01160099
011700                                                   COMP.          01170099
012600*                                                                 01260004
012700 01  CC-CONTROL-CARD.                                             01270004
012800     05  CC-OPER-UNT-ID-CURR1       PIC  9(04).                   01280099
012810     05  CC-OPER-UNT-ID-CURR1-X REDEFINES CC-OPER-UNT-ID-CURR1    01281099
012820                                    PIC  X(04).                   01282099
012900     05  FILLER                     PIC  X.                       01290011
013000     05  CC-OPER-UNT-ID-NEW1        PIC  9(04).                   01300099
013010     05  CC-OPER-UNT-ID-NEW1-X REDEFINES CC-OPER-UNT-ID-NEW1      01301099
013020                                    PIC  X(04).                   01302088
013100     05  FILLER                     PIC  X.                       01310011
013200     05  CC-OPER-UNT-ID-CURR2       PIC  9(04).                   01320099
013210     05  CC-OPER-UNT-ID-CURR2-X REDEFINES CC-OPER-UNT-ID-CURR2    01321099
013220                                    PIC  X(04).                   01322088
013300     05  FILLER                     PIC  X.                       01330011
013400     05  CC-OPER-UNT-ID-NEW2        PIC  9(04).                   01340099
013410     05  CC-OPER-UNT-ID-NEW2-X REDEFINES CC-OPER-UNT-ID-NEW2      01341099
013420                                    PIC  X(04).                   01342088
013500     05  FILLER                     PIC  X.                       01350011
013600     05  CC-OPER-UNT-ID-CURR3       PIC  9(04).                   01360099
013610     05  CC-OPER-UNT-ID-CURR3-X REDEFINES CC-OPER-UNT-ID-CURR3    01361099
013620                                    PIC  X(04).                   01362088
013700     05  FILLER                     PIC  X.                       01370011
013800     05  CC-OPER-UNT-ID-NEW3        PIC  9(04).                   01380099
013810     05  CC-OPER-UNT-ID-NEW3-X REDEFINES CC-OPER-UNT-ID-NEW3      01381099
013820                                    PIC  X(04).                   01382088
013900     05  FILLER                     PIC  X.                       01390011
014000     05  CC-OPER-UNT-ID-CURR4       PIC  9(04).                   01400099
014010     05  CC-OPER-UNT-ID-CURR4-X REDEFINES CC-OPER-UNT-ID-CURR4    01401099
014020                                    PIC  X(04).                   01402088
014100     05  FILLER                     PIC  X.                       01410011
014200     05  CC-OPER-UNT-ID-NEW4        PIC  9(04).                   01420099
014210     05  CC-OPER-UNT-ID-NEW4-X REDEFINES CC-OPER-UNT-ID-NEW4      01421099
014220                                    PIC  X(04).                   01422088
014300     05  FILLER                     PIC  X(41).                   01430011
014500*                                                                 01450004
014600*                                                                 01460004
014700 01  PS-PROGRAM-SWITCHES.                                         01470004
015000     05  PS-CONTROL-CARD-VALID-SW    PIC  X(01)    VALUE SPACE.   01500004
015100         88  PS-CONTROL-CARD-INVALID               VALUE 'N'.     01510004
015200         88  PS-CONTROL-CARD-VALID                 VALUE 'Y'.     01520004
015230     05  PS-TCOCNTL-FOUND-SW         PIC  X(01)    VALUE 'N'.     01523099
015240         88 PS-TCOCNTL-FOUND-NO                    VALUE 'N'.     01524099
015250         88 PS-TCOCNTL-FOUND-YES                   VALUE 'Y'.     01525099
015300*                                                                 01530004
015400*                                                                 01540004
015500 01  PV-PROGRAM-VARIABLES.                                        01550004
015510     05  PV-OPER-UNT                 PIC  X.                      01551099
015520         88  PV-OPER-UNT-1           VALUE '1'.                   01552099
015530         88  PV-OPER-UNT-2           VALUE '2'.                   01553099
015540         88  PV-OPER-UNT-3           VALUE '3'.                   01554099
015550         88  PV-OPER-UNT-4           VALUE '4'.                   01555099
015600     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01560004
015700                                                   COMP.          01570004
015800     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01580004
015810     05  PV-OPER-UNT-ID              PIC S9(04)    VALUE ZERO     01581099
015820                                                   COMP.          01582029
015900     05  PV-TCOCNTL-CNT              PIC S9(05)    VALUE ZERO     01590099
016000                                                   COMP-3.        01600004
016100     05  PV-OPER-UNT-1-CNT           PIC S9(05)    VALUE ZERO     01610099
016200                                                   COMP-3.        01620004
016210     05  PV-OPER-UNT-2-CNT           PIC S9(05)    VALUE ZERO     01621099
016220                                                   COMP-3.        01622097
016230     05  PV-OPER-UNT-3-CNT           PIC S9(05)    VALUE ZERO     01623099
016240                                                   COMP-3.        01624097
016250     05  PV-OPER-UNT-4-CNT           PIC S9(05)    VALUE ZERO     01625099
016260                                                   COMP-3.        01626097
016300     05  PV-OUTPUT-CNT               PIC S9(05)    VALUE ZERO     01630090
016400                                                   COMP-3.        01640004
016410     05  PV-DISPLAY-CNT              PIC ZZZZ9.                   01641033
016500     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01650004
017200*                                                                 01720004
017300*                                                                 01730004
017400 01  PE-PROGRAM-ERROR-MESSAGES.                                   01740004
017500     05  PE-MSG-01                   PIC  X(30)    VALUE          01750004
017600         'OPEN OF CNTL_CSR              '.                        01760099
017700     05  PE-MSG-02                   PIC  X(30)    VALUE          01770004
017800         'FETCH OF CNTL_CSR             '.                        01780099
020100     05  PE-MSG-03                   PIC  X(30)    VALUE          02010022
020200         'CLOSE OF CNTL_CSR             '.                        02020099
020300*                                                                 02030004
021300******************************************************************02130004
021400*  COPY BOOK FOR DB2 FORMATTED MESSAGE AREA                       02140004
021500******************************************************************02150004
021600     COPY DPWS004.                                                02160004
021800*                                                                 02180004
021900******************************************************************02190004
022000*  COMMUNICATIONS AREA FOR DB2                                    02200004
022100******************************************************************02210004
022200     EXEC SQL                                                     02220004
022300          INCLUDE SQLCA                                           02230004
022400     END-EXEC.                                                    02240004
022500*                                                                 02250004
022510*----------------------------------------------------------------*02251035
022520*    DB2 COMPANY CONTROL TABLE                                    02252099
022530*----------------------------------------------------------------*02253035
022540     EXEC SQL                                                     02254035
022550          INCLUDE TCOCNTL                                         02255099
022560     END-EXEC.                                                    02256035
024900*                                                                 02490004
046000*                                                                 04600004
046100******************************************************************04610004
046200 PROCEDURE DIVISION.                                              04620004
046300******************************************************************04630004
046400                                                                  04640004
046500******************************************************************04650004
046600*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   04660004
046700******************************************************************04670004
046800 0000-PROGRAM-MAINLINE.                                           04680004
046900     PERFORM 1000-INITIALIZE.                                     04690004
046910*                                                                 04691099
046920* NOTE:  IF LOC-ID-CURR  =  LOC-ID-NEW THIS IS VALID              04692099
046930*        THAT IS WHAT WILL BE USED TO LOAD THE FILE TO PROD       04693099
046940*                                                                 04694099
047000*                                                                 04700004
047010     IF  CC-OPER-UNT-ID-CURR1-X NUMERIC   AND                     04701099
047011         CC-OPER-UNT-ID-NEW1-X  NUMERIC   AND                     04701199
047012         CC-OPER-UNT-ID-CURR1-X > '0000'  AND                     04701299
047013         CC-OPER-UNT-ID-NEW1-X  > '0000'                          04701399
047024             MOVE CC-OPER-UNT-ID-CURR1 TO DK-OPER-UNT-ID          04702499
047025             MOVE CC-OPER-UNT-ID-NEW1  TO PV-OPER-UNT-ID          04702599
047026             MOVE '1'                  TO PV-OPER-UNT             04702699
047027             PERFORM 7000-SELECT-TCOCNTL                          04702799
047028                                                                  04702899
047029          IF  PS-TCOCNTL-FOUND-YES                                04702999
047030              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR1 '       04703099
047031                                     CC-OPER-UNT-ID-CURR1         04703199
047032              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW1  '       04703299
047033                                     CC-OPER-UNT-ID-NEW1          04703399
047034              PERFORM 2000-PROCESS-TCOCNTL                        04703499
047036          ELSE                                                    04703699
047037             DISPLAY '** CC CURRENT OPER UNT 1 NOT FOUND ==> '    04703799
047038                     CC-OPER-UNT-ID-CURR1-X                       04703899
047039          END-IF                                                  04703999
047041     ELSE                                                         04704125
047042* * *  JUST SKIP IF CURRENT AND NEW OPER UNT ID ARE ZERO          04704299
047043         IF  CC-OPER-UNT-ID-CURR1-X = '0000'  AND                 04704399
047044             CC-OPER-UNT-ID-NEW1-X  = '0000'                      04704499
047045             CONTINUE                                             04704589
047054         ELSE                                                     04705425
047055             DISPLAY '** CC OPER-UNT-ID 1 DATA INVALID'           04705599
047056             DISPLAY '** ' CC-OPER-UNT-ID-CURR1-X ' '             04705699
047057                           CC-OPER-UNT-ID-NEW1-X                  04705799
047059         END-IF                                                   04705986
047091     END-IF.                                                      04709125
047092*                                                                 04709292
047093     IF  CC-OPER-UNT-ID-CURR2-X NUMERIC    AND                    04709399
047094         CC-OPER-UNT-ID-NEW2-X NUMERIC     AND                    04709499
047095         CC-OPER-UNT-ID-CURR2-X > '0000'   AND                    04709599
047096         CC-OPER-UNT-ID-NEW2-X  > '0000'                          04709699
047210             MOVE CC-OPER-UNT-ID-CURR2 TO DK-OPER-UNT-ID          04721099
047220             MOVE CC-OPER-UNT-ID-NEW2  TO PV-OPER-UNT-ID          04722099
047221             MOVE '2'                  TO PV-OPER-UNT             04722199
047240             PERFORM 7000-SELECT-TCOCNTL                          04724099
047241                                                                  04724199
047242          IF  PS-TCOCNTL-FOUND-YES                                04724299
047243              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR2 '       04724399
047244                                     CC-OPER-UNT-ID-CURR2         04724499
047245              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW2  '       04724599
047246                                     CC-OPER-UNT-ID-NEW2          04724699
047250              PERFORM 2000-PROCESS-TCOCNTL                        04725099
047261          ELSE                                                    04726199
047262              DISPLAY '** CC CURRENT OPER UNT 2 NOT FOUND ==> '   04726299
047264                       CC-OPER-UNT-ID-CURR2-X                     04726499
047265          END-IF                                                  04726599
047280     ELSE                                                         04728092
047290* * *  JUST SKIP IF CURRENT AND NEW OPER UNT ID ARE ZERO          04729099
047291         IF  CC-OPER-UNT-ID-CURR2-X = '0000'   AND                04729199
047292             CC-OPER-UNT-ID-NEW2-X  = '0000'                      04729299
047293             CONTINUE                                             04729392
047294         ELSE                                                     04729492
047295             DISPLAY '** CC OPER-UNT-ID 2 DATA INVALID'           04729599
047296             DISPLAY '** ' CC-OPER-UNT-ID-CURR2-X ' '             04729699
047297                           CC-OPER-UNT-ID-NEW2-X                  04729799
047298         END-IF                                                   04729892
047299     END-IF.                                                      04729992
047300*                                                                 04730004
047400     IF  CC-OPER-UNT-ID-CURR3-X NUMERIC   AND                     04740099
047410         CC-OPER-UNT-ID-NEW3-X  NUMERIC   AND                     04741099
047420         CC-OPER-UNT-ID-CURR3-X > '0000'  AND                     04742099
047430         CC-OPER-UNT-ID-NEW3-X  > '0000'                          04743099
047472             MOVE CC-OPER-UNT-ID-CURR3 TO DK-OPER-UNT-ID          04747299
047473             MOVE CC-OPER-UNT-ID-NEW3  TO PV-OPER-UNT-ID          04747399
047474             MOVE '3'                  TO PV-OPER-UNT             04747499
047477             PERFORM 7000-SELECT-TCOCNTL                          04747799
047478                                                                  04747899
047479          IF  PS-TCOCNTL-FOUND-YES                                04747999
047480              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR3 '       04748099
047481                                     CC-OPER-UNT-ID-CURR3         04748199
047482              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW3  '       04748299
047483                                     CC-OPER-UNT-ID-NEW3          04748399
047484              PERFORM 2000-PROCESS-TCOCNTL                        04748499
047485          ELSE                                                    04748599
047486              DISPLAY '** CC CURRENT OPER UNT 3 NOT FOUND ==> '   04748699
047488                       CC-OPER-UNT-ID-CURR3-X                     04748899
047489          END-IF                                                  04748999
047491     ELSE                                                         04749193
047492* * *  JUST SKIP IF CURRENT AND NEW OPER UNT ID ARE ZERO          04749299
047493         IF  CC-OPER-UNT-ID-CURR3-X = '0000'  AND                 04749399
047494             CC-OPER-UNT-ID-NEW3-X  = '0000'                      04749499
047495             CONTINUE                                             04749593
047496         ELSE                                                     04749693
047497             DISPLAY '** CC OPER-UNT-ID 3 DATA INVALID'           04749799
047498             DISPLAY '** ' CC-OPER-UNT-ID-CURR3-X ' '             04749899
047499                           CC-OPER-UNT-ID-NEW3-X                  04749999
047500         END-IF                                                   04750093
047501     END-IF.                                                      04750193
047502*                                                                 04750294
047503     IF  CC-OPER-UNT-ID-CURR4-X NUMERIC  AND                      04750399
047504         CC-OPER-UNT-ID-NEW4-X  NUMERIC  AND                      04750499
047505         CC-OPER-UNT-ID-CURR4-X > '0000' AND                      04750599
047506         CC-OPER-UNT-ID-NEW4-X  > '0000'                          04750699
047510             MOVE CC-OPER-UNT-ID-CURR4 TO DK-OPER-UNT-ID          04751099
047511             MOVE CC-OPER-UNT-ID-NEW4  TO PV-OPER-UNT-ID          04751199
047512             MOVE '4'                  TO PV-OPER-UNT             04751299
047515             PERFORM 7000-SELECT-TCOCNTL                          04751599
047516                                                                  04751699
047517          IF  PS-TCOCNTL-FOUND-YES                                04751799
047518              DISPLAY '** PROCESSING CC-OPER-UNT-ID-CURR4 '       04751899
047519                                     CC-OPER-UNT-ID-CURR4         04751999
047520              DISPLAY '** PROCESSING CC-OPER-UNT-ID-NEW4  '       04752099
047521                                     CC-OPER-UNT-ID-NEW4          04752199
047522              PERFORM 2000-PROCESS-TCOCNTL                        04752299
047523          ELSE                                                    04752399
047524              DISPLAY '** CC CURRENT OPER UNT 4 NOT FOUND ==> '   04752499
047526                       CC-OPER-UNT-ID-CURR4-X                     04752699
047527          END-IF                                                  04752799
047529     ELSE                                                         04752994
047530* * *  JUST SKIP IF CURRENT AND NEW OPER UNT ID ARE ZERO          04753099
047531         IF  CC-OPER-UNT-ID-CURR4-X = '0000'  AND                 04753199
047532             CC-OPER-UNT-ID-NEW4-X  = '0000'                      04753299
047533             CONTINUE                                             04753394
047534         ELSE                                                     04753494
047535             DISPLAY '** CC OPER-UNT-ID 4 DATA INVALID'           04753599
047536             DISPLAY '** ' CC-OPER-UNT-ID-CURR4-X ' '             04753699
047537                           CC-OPER-UNT-ID-NEW4-X                  04753799
047538         END-IF                                                   04753894
047539     END-IF.                                                      04753994
047540*                                                                 04754043
047541     PERFORM 9000-DISPLAY-COUNTS                                  04754143
047542*                                                                 04754204
047550     CLOSE CONTROL-FILE-OUT.                                      04755099
047600     STOP RUN.                                                    04760004
047700*                                                                 04770004
048400******************************************************************04840004
048500 1000-INITIALIZE.                                                 04850004
048610     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04861013
048611     DISPLAY 'PROGRAM:  CNKUT801'.                                04861199
048612     DISPLAY '** CONTROL CARD:  '                                 04861299
048613              CC-CONTROL-CARD.                                    04861399
048614     DISPLAY ' '.                                                 04861499
048620*                                                                 04862099
048700     OPEN OUTPUT CONTROL-FILE-OUT.                                04870099
048800*                                                                 04880099
049600******************************************************************04960099
049700 2000-PROCESS-TCOCNTL.                                            04970099
058600*                                                                 05860099
059400     MOVE PV-OPER-UNT-ID     TO COCNTL-OPER-UNT-ID                05940099
059800*                                                                 05980099
061800     WRITE CONTROL-REC-OUT                                        06180099
061900      FROM DCLTCOCNTL.                                            06190099
061901                                                                  06190199
061910     ADD +1 TO PV-OUTPUT-CNT.                                     06191099
061920     EVALUATE TRUE                                                06192099
061930              WHEN PV-OPER-UNT-1                                  06193099
061940                   ADD +1 TO PV-OPER-UNT-1-CNT                    06194099
061950              WHEN PV-OPER-UNT-2                                  06195099
061951                   ADD +1 TO PV-OPER-UNT-2-CNT                    06195199
061952              WHEN PV-OPER-UNT-3                                  06195299
061953                   ADD +1 TO PV-OPER-UNT-3-CNT                    06195399
061954              WHEN PV-OPER-UNT-4                                  06195499
061955                   ADD +1 TO PV-OPER-UNT-4-CNT                    06195599
061960     END-EVALUATE.                                                06196099
062000*                                                                 06200099
062300******************************************************************06230099
062400*  SELECT COMPANY CONTROL                                         06240099
062500******************************************************************06250099
062600 7000-SELECT-TCOCNTL.                                             06260099
062700                                                                  06270099
062800     EXEC SQL                                                     06280099
062810          SELECT   OPER_UNT_ID                                    06281099
062820                  ,FCLTY_ID                                       06282099
062830                  ,SHIPT_OVRG_PCT                                 06283099
062840                  ,SHIPT_SHTG_PCT                                 06284099
062850                  ,DAYS_PR_CHG_NBR                                06285099
062860                  ,SHIPT_ERL_DAYS_NBR                             06286099
062870                  ,SHIPT_LTE_DAYS_NBR                             06287099
062880                  ,DFLT_SU_PRTR_ID                                06288099
062890                  ,DAYS_ALWD_ADJ_QTY                              06289099
062891                  ,BTCH_PRC_DTE                                   06289199
062892                  ,PRT_TRLR_MFST_IND                              06289299
062893                  ,PRT_MKNG_APRN_IND                              06289399
062894                  ,PRT_APRN_HDR_IND                               06289499
062895                  ,PRT_MSTR_PO_IND                                06289599
062896                  ,PRT_TRBL_DOC_IND                               06289699
062897                  ,DFLT_TRIP_LBL_QTY                              06289799
062898                  ,DFLT_HDR_LBL_QTY                               06289899
062899                  ,CA_TRBL_CRE_IND                                06289999
062900                  ,CA_LGS_PRTR_ID                                 06290099
062901                  ,CA_RCVG_PRTR_ID                                06290199
062902                  ,CA_FLAT_PRTR_ID                                06290299
062903                  ,CA_SHIP_PRTR_ID                                06290399
062904                  ,CA_SPTCK_DFLT_PCT                              06290499
062905                  ,CA_ERR_LMT_PCT                                 06290599
062906                  ,NW_STR_OVRG_PCT                                06290699
062907                  ,NW_STR_SHTG_PCT                                06290799
062908                  ,P2L_DISTRB_TRN_ID                              06290899
062909                  ,P2L_CART_TRN_ID                                06290999
062910                  ,P2L_UPLD_TRN_ID                                06291099
062911                  ,IMPRT_OVRG_PCT                                 06291199
062912                  ,IMPRT_SHTG_PCT                                 06291299
062913                  ,IMPRT_AD_OVRG_PCT                              06291399
062914                  ,IMPRT_AD_SHTG_PCT                              06291499
062915                  ,SPLT_PRC_DAYS_QTY                              06291599
062916                  ,DFLT_CRE_LBL_CDE                               06291699
062917                  ,DFLT_PRT_ORD_CDE                               06291799
062918                  ,DFLT_CNSTK_LBL_QTY                             06291899
062919                  ,DFLT_FCSE_AREA_ID                              06291999
062920                  ,IMPRTPPK_OVRG_PCT                              06292099
062921                  ,IMPRTPPK_SHTG_PCT                              06292199
062922                  ,PRT_LBL_ON_SCN_CNT                             06292299
062923                  ,DFLT_OPER_SET_ID                               06292399
062924                  ,DFLT_CNSTK_PRTR_ID                             06292499
062925                  ,CNSTK_PL_PRT_CD                                06292599
062926                  ,CNSTK_PL_NBR                                   06292699
062927                  ,CK_NW_PL_MNIT_QTY                              06292799
062928                  ,CNSTK_STR_RPTG_IND                             06292899
062929                  ,IMPADVPPK_OVRG_PCT                             06292999
062930                  ,IMPADVPPK_SHTG_PCT                             06293099
062931                  ,PREPK_OVRG_PCT                                 06293199
062932                  ,PREPK_SHTG_PCT                                 06293299
062933                  ,NWSTRPPK_OVRG_PCT                              06293399
062934                  ,NWSTRPPK_SHTG_PCT                              06293499
062935                  ,LNE_ODU_TOL_QTY                                06293599
062936                  ,LNE_ODU_TOL_AMT                                06293699
062937                  ,PREPK_ODU_TOL_QTY                              06293799
062938                  ,PREPK_ODU_TOL_AMT                              06293899
062939                  ,UNT_VRFN_VARN_PCT                              06293999
062940                  ,DOL_VRFN_VARN_PCT                              06294099
062941                  ,DOL_VARN_THRS_AMT                              06294199
062942                  ,SSCC_18_IND                                    06294299
062943                  ,DFLT_CNSTK_LOC_ID                              06294399
062944                  ,P2L_SML_UPLD_ID                                06294499
063000            INTO  :COCNTL-OPER-UNT-ID                             06300099
063100                 ,:COCNTL-FCLTY-ID                                06310099
063200                 ,:COCNTL-SHIPT-OVRG-PCT                          06320099
063300                 ,:COCNTL-SHIPT-SHTG-PCT                          06330099
063400                 ,:COCNTL-DAYS-PR-CHG-NBR                         06340099
063500                 ,:COCNTL-SHIPT-ERL-DAYS-NBR                      06350099
063600                 ,:COCNTL-SHIPT-LTE-DAYS-NBR                      06360099
063700                 ,:COCNTL-DFLT-SU-PRTR-ID                         06370099
063800                 ,:COCNTL-DAYS-ALWD-ADJ-QTY                       06380099
063900                 ,:COCNTL-BTCH-PRC-DTE                            06390099
064000                 ,:COCNTL-PRT-TRLR-MFST-IND                       06400099
064100                 ,:COCNTL-PRT-MKNG-APRN-IND                       06410099
064200                 ,:COCNTL-PRT-APRN-HDR-IND                        06420099
064300                 ,:COCNTL-PRT-MSTR-PO-IND                         06430099
064400                 ,:COCNTL-PRT-TRBL-DOC-IND                        06440099
064500                 ,:COCNTL-DFLT-TRIP-LBL-QTY                       06450099
064600                 ,:COCNTL-DFLT-HDR-LBL-QTY                        06460099
064700                 ,:COCNTL-CA-TRBL-CRE-IND                         06470099
064800                 ,:COCNTL-CA-LGS-PRTR-ID                          06480099
064900                 ,:COCNTL-CA-RCVG-PRTR-ID                         06490099
065000                 ,:COCNTL-CA-FLAT-PRTR-ID                         06500099
065100                 ,:COCNTL-CA-SHIP-PRTR-ID                         06510099
065200                 ,:COCNTL-CA-SPTCK-DFLT-PCT                       06520099
065300                 ,:COCNTL-CA-ERR-LMT-PCT                          06530099
065400                 ,:COCNTL-NW-STR-OVRG-PCT                         06540099
065500                 ,:COCNTL-NW-STR-SHTG-PCT                         06550099
065600                 ,:COCNTL-P2L-DISTRB-TRN-ID                       06560099
065700                 ,:COCNTL-P2L-CART-TRN-ID                         06570099
065800                 ,:COCNTL-P2L-UPLD-TRN-ID                         06580099
065900                 ,:COCNTL-IMPRT-OVRG-PCT                          06590099
066000                 ,:COCNTL-IMPRT-SHTG-PCT                          06600099
066100                 ,:COCNTL-IMPRT-AD-OVRG-PCT                       06610099
066200                 ,:COCNTL-IMPRT-AD-SHTG-PCT                       06620099
066300                 ,:COCNTL-SPLT-PRC-DAYS-QTY                       06630099
066400                 ,:COCNTL-DFLT-CRE-LBL-CDE                        06640099
066500                 ,:COCNTL-DFLT-PRT-ORD-CDE                        06650099
066600                 ,:COCNTL-DFLT-CNSTK-LBL-QTY                      06660099
066700                 ,:COCNTL-DFLT-FCSE-AREA-ID                       06670099
066800                 ,:COCNTL-IMPRTPPK-OVRG-PCT                       06680099
066900                 ,:COCNTL-IMPRTPPK-SHTG-PCT                       06690099
067000                 ,:COCNTL-PRT-LBL-ON-SCN-CNT                      06700099
067100                 ,:COCNTL-DFLT-OPER-SET-ID                        06710099
067200                 ,:COCNTL-DFLT-CNSTK-PRTR-ID                      06720099
067300                 ,:COCNTL-CNSTK-PL-PRT-CD                         06730099
067400                 ,:COCNTL-CNSTK-PL-NBR                            06740099
067500                 ,:COCNTL-CK-NW-PL-MNIT-QTY                       06750099
067600                 ,:COCNTL-CNSTK-STR-RPTG-IND                      06760099
067700                 ,:COCNTL-IMPADVPPK-OVRG-PCT                      06770099
067800                 ,:COCNTL-IMPADVPPK-SHTG-PCT                      06780099
067900                 ,:COCNTL-PREPK-OVRG-PCT                          06790099
068000                 ,:COCNTL-PREPK-SHTG-PCT                          06800099
068100                 ,:COCNTL-NWSTRPPK-OVRG-PCT                       06810099
068200                 ,:COCNTL-NWSTRPPK-SHTG-PCT                       06820099
068300                 ,:COCNTL-LNE-ODU-TOL-QTY                         06830099
068400                 ,:COCNTL-LNE-ODU-TOL-AMT                         06840099
068500                 ,:COCNTL-PREPK-ODU-TOL-QTY                       06850099
068600                 ,:COCNTL-PREPK-ODU-TOL-AMT                       06860099
068700                 ,:COCNTL-UNT-VRFN-VARN-PCT                       06870099
068800                 ,:COCNTL-DOL-VRFN-VARN-PCT                       06880099
068900                 ,:COCNTL-DOL-VARN-THRS-AMT                       06890099
069000                 ,:COCNTL-SSCC-18-IND                             06900099
069100                 ,:COCNTL-DFLT-CNSTK-LOC-ID                       06910099
069200                 ,:COCNTL-P2L-SML-UPLD-ID                         06920099
069210            FROM TCOCNTL                                          06921099
069220           WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                    06922099
069230            WITH UR                                               06923099
069300     END-EXEC.                                                    06930099
069400*                                                                 06940099
069500     EVALUATE TRUE                                                06950099
069600         WHEN SQLCODE = ZERO                                      06960099
069700              ADD +1 TO PV-TCOCNTL-CNT                            06970099
069710              SET PS-TCOCNTL-FOUND-YES                            06971099
069720                                TO TRUE                           06972099
069800         WHEN SQLCODE = +100                                      06980099
069900              SET PS-TCOCNTL-FOUND-NO                             06990099
070000                                TO TRUE                           07000099
070100         WHEN OTHER                                               07010099
070200              PERFORM 9000-DISPLAY-COUNTS                         07020099
070210              EVALUATE TRUE                                       07021099
070220                  WHEN PV-OPER-UNT-1                              07022099
070230                      DISPLAY '*** OPER UNT ID '                  07023099
070231                               CC-OPER-UNT-ID-CURR1-X             07023199
070240                  WHEN PV-OPER-UNT-2                              07024099
070250                      DISPLAY '*** OPER UNT ID '                  07025099
070251                               CC-OPER-UNT-ID-CURR2-X             07025199
070260                  WHEN PV-OPER-UNT-3                              07026099
070270                      DISPLAY '*** OPER UNT ID '                  07027099
070271                               CC-OPER-UNT-ID-CURR3-X             07027199
070280                  WHEN PV-OPER-UNT-4                              07028099
070290                      DISPLAY '*** OPER UNT ID '                  07029099
070291                               CC-OPER-UNT-ID-CURR4-X             07029199
070292              END-EVALUATE                                        07029299
070293                                                                  07029399
070300              MOVE '7000-SELECT-TCOCNTL'                          07030099
070400                                 TO PV-ABEND-PARAGRAPH            07040099
070500              MOVE PE-MSG-02     TO PV-DB2-OPERATION-ATTEMPTED    07050099
070600              PERFORM 9200-SQL-ABEND                              07060099
070700     END-EVALUATE.                                                07070099
112000******************************************************************11200099
144800 9000-DISPLAY-COUNTS.                                             14480099
145100                                                                  14510099
145200     DISPLAY '********************************************'       14520099
145210     MOVE PV-TCOCNTL-CNT   TO PV-DISPLAY-CNT                      14521099
145300     DISPLAY 'TCOCNTL SELECTED .............: ' PV-DISPLAY-CNT.   14530099
145310     MOVE PV-OUTPUT-CNT      TO PV-DISPLAY-CNT                    14531099
145400     DISPLAY 'OUTPUT RECORDS WRITTEN........: ' PV-DISPLAY-CNT.   14540099
145500     MOVE PV-OPER-UNT-1-CNT  TO PV-DISPLAY-CNT                    14550099
145501     DISPLAY 'OPER-UNT-ID 1 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550199
145502     MOVE PV-OPER-UNT-2-CNT  TO PV-DISPLAY-CNT                    14550299
145503     DISPLAY 'OPER-UNT-ID 2 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550399
145504     MOVE PV-OPER-UNT-3-CNT  TO PV-DISPLAY-CNT                    14550499
145505     DISPLAY 'OPER-UNT-ID 3 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550599
145506     MOVE PV-OPER-UNT-4-CNT  TO PV-DISPLAY-CNT                    14550699
145507     DISPLAY 'OPER-UNT-ID 4 RECORDS WRITTEN-: ' PV-DISPLAY-CNT.   14550799
145510     DISPLAY '********************************************'.      14551099
146700*                                                                 14670099
146800******************************************************************14680099
146900*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    14690099
147000*  ERROR OR WARNING CODE OCCURS.                                  14700099
147100******************************************************************14710099
147200 9200-SQL-ABEND.                                                  14720099
147300     DISPLAY '9200-SQL-ABEND'.                                    14730099
147400     DISPLAY '** ABEND     **'.                                   14740099
147500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        14750099
147600     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             14760099
147700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     14770099
147800*                                                                 14780099
147900*                                                                 14790099
148000******************************************************************14800099
148100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    14810099
148200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         14820099
148300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     14830099
148400* FORMAT.                                                         14840099
148500******************************************************************14850099
148600     COPY DPPD004.                                                14860099
148700                                                                  14870099
148800     IF  SQLCODE NOT = -911                                       14880099
148900         EXEC SQL                                                 14890099
149000              COMMIT                                              14900099
149100         END-EXEC                                                 14910099
149200     END-IF.                                                      14920099
149300                                                                  14930099
149400     MOVE +4013                  TO PV-ABEND-CODE.                14940099
149500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         14950099
