000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.      XLKUP043.                                       00020001
000300 AUTHOR.          KOHLS DEPARTMENT STORES.                        00030001
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040001
000500 DATE-WRITTEN.    09/15/2005.                                     00050001
000600 DATE-COMPILED.                                                   00060001
000700******************************************************************00070001
000800**XL DOMAIN TABLE UPDATE - UPDATE FOR TABLE XLT_VND, XLT_VND_DEPT,00080001
000900**XLT_VND_CPBL AND XLT_VND_CPBL_CDE TABLES.                       00090001
001000******************************************************************00100001
001100**THIS PROGRAM USES THE OUTPUT FILE FROM THE XLKUT089 PROGRAM TO  00110001
001200**ADD/DELETE/UPDATE THE TABLES.                                   00120001
001300******************************************************************00130001
001400 ENVIRONMENT DIVISION.                                            00140001
001500 CONFIGURATION SECTION.                                           00150001
001600 SOURCE-COMPUTER.        IBM-3090.                                00160001
001700 OBJECT-COMPUTER.        IBM-3090.                                00170001
001800 INPUT-OUTPUT SECTION.                                            00180001
001900 FILE-CONTROL.                                                    00190001
002000                                                                  00200001
002100     SELECT INPUT-FILE                                            00210001
002200            ASSIGN TO INP01.                                      00220001
002300                                                                  00230001
002400 DATA DIVISION.                                                   00240001
002500 FILE SECTION.                                                    00250001
002600                                                                  00260001
002700 FD  INPUT-FILE                                                   00270001
002800     RECORDING MODE F                                             00280001
002900     BLOCK CONTAINS 0 RECORDS                                     00290001
003000     LABEL RECORDS ARE OMITTED                                    00300001
003100     DATA RECORD IS INPUT-RECORD.                                 00310001
003200 01  INPUT-RECORD                    PIC X(900).                  00320001
003300                                                                  00330001
003400 WORKING-STORAGE SECTION.                                         00340001
003500******************************************************************00350001
003600**SWITCHES                                                        00360001
003700******************************************************************00370001
003800 01  PS-PROGRAM-SWITCHES.                                         00380001
003900     05  PS-END-OF-INPUT-FILE-SW         PIC X(01)   VALUE 'N'.   00390001
004000         88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00400001
004100         88  PS-NOT-END-OF-INPUT-FILE                VALUE 'N'.   00410001
004200 01  PS-PROGRAM-VARIABLE.                                         00420001
004300     05  PV-DISP-ENT-ID                  PIC 9(09).               00430001
004400     05  PV-DISP-DEPT-NBR                PIC 9(04).               00440001
004500******************************************************************00450001
004600**TIMESTAMP VARIABLES                                             00460001
004700******************************************************************00470001
004800 01  SD-TIMESTAMP                        PIC  X(26)  VALUE SPACES.00480001
004900 01  FILLER REDEFINES SD-TIMESTAMP.                               00490001
005000     05  SD-CURR-DTE                     PIC  X(10).              00500001
005100     05  FILLER                          PIC  X(01).              00510001
005200     05  SD-HOUR                         PIC  X(02).              00520001
005300     05  FILLER                          PIC  X(01).              00530001
005400     05  SD-MINUTE                       PIC  X(02).              00540001
005500     05  FILLER                          PIC  X(01).              00550001
005600     05  SD-SECOND                       PIC  X(02).              00560001
005700     05  FILLER                          PIC  X(01).              00570001
005800     05  SD-MICROSEC                     PIC  X(06).              00580001
005900******************************************************************00590001
006000**PROGRAM CONSTANTS                                               00600001
006100******************************************************************00610001
006200 01  PC-PROGRAM-CONSTANTS.                                        00620001
006300     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)                00630001
006400                                         VALUE 'XLKUP043'.        00640001
006500     05  PC-TABLE-NAME                   PIC X(16)                00650001
006600                                         VALUE 'XLT_VND'.         00660001
006700******************************************************************00670001
006800**PROGRAM COUNTERS                                                00680001
006900******************************************************************00690001
007000 01  PC-PROGRAM-COUNTER.                                          00700001
007100     05  PC-INPUT-RECORDS-READ           PIC 9(09) VALUE ZEROS.   00710001
007200     05  PC-VEND-RECS-INSERTED           PIC 9(09) VALUE ZEROS.   00720001
007300     05  PC-VEND-RECS-UPDATED            PIC 9(09) VALUE ZEROS.   00730001
007400     05  PC-VEND-RECS-DELETED            PIC 9(09) VALUE ZEROS.   00740001
007500     05  PC-VEND-DEPT-RECS-INSERTED      PIC 9(09) VALUE ZEROS.   00750001
007600     05  PC-VEND-DEPT-RECS-UPDATED       PIC 9(09) VALUE ZEROS.   00760001
007700     05  PC-VEND-DEPT-RECS-DELETED       PIC 9(09) VALUE ZEROS.   00770001
007800     05  PC-VEND-CPBL-RECS-INSERTED      PIC 9(09) VALUE ZEROS.   00780001
007900     05  PC-VEND-CPBL-RECS-UPDATED       PIC 9(09) VALUE ZEROS.   00790001
008000     05  PC-VEND-CPBL-RECS-DELETED       PIC 9(09) VALUE ZEROS.   00800001
008100     05  PC-VEND-CPBL-CDE-RECS-INSERTED  PIC 9(09) VALUE ZEROS.   00810001
008200     05  PC-VEND-CPBL-CDE-RECS-UPDATED   PIC 9(09) VALUE ZEROS.   00820001
008300     05  PC-VEND-CPBL-CDE-RECS-DELETED   PIC 9(09) VALUE ZEROS.   00830001
008400     05  PC-COMMIT-COUNTER               PIC 9(09) VALUE ZEROS.   00840001
008500     05  PC-UPD-NF-RECORDS               PIC 9(09) VALUE ZEROS.   00850001
008600     05  PC-DEL-NF-RECORDS               PIC 9(09) VALUE ZEROS.   00860001
008700     05  PC-DUP-RECORDS                  PIC 9(09) VALUE ZEROS.   00870001
008800     05  PC-532-RECORDS                  PIC 9(09) VALUE ZEROS.   00880001
008900     05  PV-530-RECORDS                  PIC 9(09) VALUE ZEROS.   00890001
009000******************************************************************00900001
009100**COPYBOOKS                                                       00910001
009200******************************************************************00920001
009300***INPUT FILE LAYOUT                                              00930001
009400     COPY XLRD058.                                                00940001
009500***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00950001
009600     COPY DPWS004.                                                00960001
009700***DB2 ABEND COPYBOOK                                             00970001
009800     COPY DPWS900.                                                00980001
009900***DB2 MESSAGE AREA                                               00990001
010000     COPY SQLCA2.                                                 01000001
010100***KOHLS CALENDAR ROUTINE                                         01010001
010200     COPY DPWS500.                                                01020001
010300******************************************************************01030001
010400**TABLE INCLUSIONS                                                01040001
010500******************************************************************01050001
010600***DB2 COMMUNICATIONS AREA                                        01060001
010700     EXEC SQL                                                     01070001
010800          INCLUDE SQLCA                                           01080001
010900     END-EXEC.                                                    01090001
011000***TABLE XLT_VND                                                  01100001
011100     EXEC SQL                                                     01110001
011200          INCLUDE XLT00035                                        01120002
011300     END-EXEC.                                                    01130001
011400***TABLE XLT_VND_DPT                                              01140001
011500     EXEC SQL                                                     01150001
011600          INCLUDE XLT00039                                        01160001
011700     END-EXEC.                                                    01170001
011800***TABLE XLT_VND_CPBL                                             01180001
011900     EXEC SQL                                                     01190001
012000          INCLUDE XLT00037                                        01200001
012100     END-EXEC.                                                    01210001
012200***TABLE XLT_VND_CPBL_CDE                                         01220001
012300     EXEC SQL                                                     01230001
012400          INCLUDE XLT00036                                        01240001
012500     END-EXEC.                                                    01250001
012600******************************************************************01260001
012700**ERROR HANDLING                                                  01270001
012800******************************************************************01280001
012900 01  PV-MISC-ABEND-FIELDS.                                        01290001
013000     05  PV-PARAGRAPH-NAME               PIC X(30) VALUE SPACE.   01300001
013100     05  PV-OPERATION-MSG-1              PIC X(40) VALUE SPACE.   01310001
013200     05  PV-OPERATION-MSG-2              PIC X(40) VALUE SPACE.   01320001
013300     05  PV-DB2-OPERATION                PIC X(30) VALUE SPACE.   01330001
013400 01  ABEND-CODE                          PIC S9(4) VALUE ZEROS    01340001
013500                                                   COMP SYNC.     01350001
013600     88  ABEND-4001-WRITE-ERROR            VALUE +4001.           01360001
013700     88  ABEND-4002-READ-ERROR             VALUE +4002.           01370001
013800     88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           01380001
013900     88  ABEND-4004-TABLE-ERROR            VALUE +4004.           01390001
014000     88  ABEND-4005-OPEN-ERROR             VALUE +4005.           01400001
014100     88  ABEND-4006-CLOSE-ERROR            VALUE +4006.           01410001
014200     88  ABEND-4007-SEQUENCE-ERROR         VALUE +4007.           01420001
014300     88  ABEND-4008-DATA-ERROR             VALUE +4008.           01430001
014400     88  ABEND-4009-KEY-DATA-ERROR         VALUE +4009.           01440001
014500     88  ABEND-4013-DB2-ERROR              VALUE +4013.           01450001
014600     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01460001
014700     88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01470001
014800                                                                  01480001
014900 PROCEDURE DIVISION.                                              01490001
015000***************************************************************** 01500001
015100                                                                  01510001
015200     PERFORM 1000-INITIALIZATION.                                 01520001
015300     PERFORM 2000-PROCESS-RECORDS                                 01530001
015400             UNTIL PS-END-OF-INPUT-FILE.                          01540001
015500     PERFORM 9999-WRAPUP.                                         01550001
015600     GOBACK.                                                      01560001
015700                                                                  01570001
015800 EJECT.                                                           01580001
015900******************************************************************01590001
016000**INITIALIZATION AREA                                             01600001
016100******************************************************************01610001
016200 1000-INITIALIZATION.                                             01620001
016300                                                                  01630001
016400     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01640001
016500                                                                  01650001
016600     OPEN INPUT INPUT-FILE.                                       01660001
016700                                                                  01670001
016800     PERFORM 1100-SELECT-DB2-TIME.                                01680001
016900                                                                  01690001
017000     PERFORM 9999-READ-INPUT-FILE.                                01700001
017100                                                                  01710001
017200 EJECT.                                                           01720001
017300******************************************************************01730001
017400**RETRIEVE TIME FROM DB2                                          01740001
017500******************************************************************01750001
017600 1100-SELECT-DB2-TIME.                                            01760001
017700                                                                  01770001
017800     MOVE '1100-SELECT-DB2-TIME' TO PV-PARAGRAPH-NAME.            01780001
017900                                                                  01790001
018000     EXEC SQL                                                     01800001
018100          SELECT CURRENT TIMESTAMP                                01810001
018200          INTO  :SD-TIMESTAMP                                     01820001
018300          FROM   SYSIBM.SYSDUMMY1                                 01830001
018400     END-EXEC.                                                    01840001
018500                                                                  01850001
018600     IF  SQLCODE NOT EQUAL ZERO                                   01860001
018700         PERFORM 9999-ABEND-ROUTINE                               01870001
018800     END-IF.                                                      01880001
018900                                                                  01890001
019000 EJECT.                                                           01900001
019100******************************************************************01910001
019200**PROCESSES INPUT FILE                                            01920001
019300******************************************************************01930001
019400 2000-PROCESS-RECORDS.                                            01940001
019500                                                                  01950001
019600     MOVE '2000-PROCESS-RECORDS' TO PV-PARAGRAPH-NAME.            01960001
019700                                                                  01970001
019800     EVALUATE TRUE                                                01980001
019900         WHEN XL058-VND                                           01990001
020000             PERFORM 3000-PROCESS-VENDOR                          02000001
020100         WHEN XL058-VND-DEPT                                      02010001
020200             PERFORM 4000-PROCESS-VENDOR-DEPT                     02020001
020300         WHEN XL058-VND-CPBL                                      02030001
020400             PERFORM 5000-PROCESS-VENDOR-CPBL                     02040001
020500         WHEN XL058-VND-CPBL-CDE                                  02050001
020600             PERFORM 6000-PROCESS-VENDOR-CPBL-CDE                 02060001
020700     END-EVALUATE.                                                02070001
020800     PERFORM 9999-READ-INPUT-FILE.                                02080001
020900                                                                  02090001
021000 3000-PROCESS-VENDOR.                                             02100001
021100     EVALUATE TRUE                                                02110001
021200         WHEN XL058-INSERT                                        02120001
021300             PERFORM 3100-PROCESS-INSERT                          02130001
021400         WHEN XL058-UPDATE                                        02140001
021500             PERFORM 3200-PROCESS-UPDATE                          02150001
021600         WHEN XL058-DELETE                                        02160001
021700             PERFORM 3300-PROCESS-DELETE                          02170001
021800     END-EVALUATE.                                                02180001
021900 3100-PROCESS-INSERT.                                             02190001
022000     MOVE XL058-VEND-ENT-ID             TO XLT00035-ENT-ID.       02200001
022100     MOVE XL058-VEND-VND-NBR            TO XLT00035-VND-NBR.      02210001
022200     MOVE XL058-VEND-VND-TYP-CDE        TO XLT00035-VND-TYP-CDE.  02220001
022300     MOVE XL058-VEND-PRTNR-TYP-CDE      TO XLT00035-PRTNR-TYP-CDE.02230001
022400     MOVE XL058-VEND-PRIM-VND-NM        TO XLT00035-PRIM-VND-NM.  02240001
022500     MOVE XL058-VEND-STAT-CDE           TO XLT00035-STAT-CDE.     02250001
022600     MOVE XL058-VEND-SCAC-CDE           TO XLT00035-SCAC-CDE.     02260001
022700     MOVE XL058-VEND-CFY-SLSRNK-NBR     TO                        02270001
022800                                       XLT00035-CFY-SLSRNK-NBR    02280001
022900     MOVE XL058-VEND-PFY-SLSRNK-NBR     TO                        02290001
023000                                       XLT00035-PFY-SLSRNK-NBR.   02300001
023100     MOVE XL058-VEND-P12MN-SLSRNK-NBR   TO                        02310001
023200                                       XLT00035-P12MN-SLSRNK-NBR. 02320001
023300     MOVE XL058-VEND-EDI-PO-PREPK-CDE   TO                        02330001
023400                                       XLT00035-EDI-PO-PREPK-CDE. 02340001
023500     MOVE XL058-VEND-SOR-CRE-TMST       TO                        02350001
023600                                       XLT00035-SOR-CRE-TMST.     02360001
023700     MOVE XL058-VEND-SOR-LAST-UPD-TMST  TO                        02370001
023800                                       XLT00035-SOR-LAST-UPD-TMST.02380001
023900     MOVE XL058-VEND-SHRT-VND-NM        TO XLT00035-SHRT-VND-NM.  02390001
024000     PERFORM 3150-INSERT-VENDOR.                                  02400001
024100                                                                  02410001
024200 3150-INSERT-VENDOR.                                              02420001
024300                                                                  02430001
024400     MOVE '3150-INSERT-VENDOR'      TO PV-PARAGRAPH-NAME.         02440001
024500                                                                  02450001
024600     EXEC SQL                                                     02460001
024700          INSERT INTO XLT_VND                                     02470001
024800                ( ENT_ID                                          02480001
024900                 ,VND_NBR                                         02490001
025000                 ,VND_TYP_CDE                                     02500001
025100                 ,PRTNR_TYP_CDE                                   02510001
025200                 ,PRIM_VND_NM                                     02520001
025300                 ,STAT_CDE                                        02530001
025400                 ,SCAC_CDE                                        02540001
025500                 ,CFY_SLSRNK_NBR                                  02550001
025600                 ,PFY_SLSRNK_NBR                                  02560001
025700                 ,P12MN_SLSRNK_NBR                                02570001
025800                 ,EDI_PO_PREPK_CDE                                02580001
025900                 ,SOR_CRE_TMST                                    02590001
026000                 ,SOR_LAST_UPD_TMST                               02600001
026100                 ,SHRT_VND_NM)                                    02610001
026200          VALUES                                                  02620001
026300                ( :XLT00035-ENT-ID                                02630001
026400                , :XLT00035-VND-NBR                               02640001
026500                , :XLT00035-VND-TYP-CDE                           02650001
026600                , :XLT00035-PRTNR-TYP-CDE                         02660001
026700                , :XLT00035-PRIM-VND-NM                           02670001
026800                , :XLT00035-STAT-CDE                              02680001
026900                , :XLT00035-SCAC-CDE                              02690001
027000                , :XLT00035-CFY-SLSRNK-NBR                        02700001
027100                , :XLT00035-PFY-SLSRNK-NBR                        02710001
027200                , :XLT00035-P12MN-SLSRNK-NBR                      02720001
027300                , :XLT00035-EDI-PO-PREPK-CDE                      02730001
027400                , :XLT00035-SOR-CRE-TMST                          02740001
027500                , :XLT00035-SOR-LAST-UPD-TMST                     02750001
027600                , :XLT00035-SHRT-VND-NM)                          02760001
027700     END-EXEC.                                                    02770001
027800                                                                  02780001
027900     EVALUATE TRUE                                                02790001
028000        WHEN SQLCODE = ZERO                                       02800001
028100             ADD +1                   TO PC-VEND-RECS-INSERTED    02810001
028200             ADD +1                       TO PC-COMMIT-COUNTER    02820001
028300        WHEN SQLCODE = -803                                       02830001
028400             ADD +1                       TO PC-DUP-RECORDS       02840001
028500        WHEN OTHER                                                02850001
028600             MOVE XLT00035-ENT-ID         TO PV-DISP-ENT-ID       02860001
028700             DISPLAY 'TRYING TO INSERT XLT_VND '                  02870001
028800             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            02880001
028900             PERFORM 9999-DISPLAY-STATISTICS                      02890001
029000             PERFORM 9999-ABEND-ROUTINE                           02900001
029100     END-EVALUATE.                                                02910001
029200                                                                  02920001
029300 3200-PROCESS-UPDATE.                                             02930001
029400     MOVE XL058-VEND-ENT-ID             TO XLT00035-ENT-ID.       02940001
029500     MOVE XL058-VEND-VND-NBR            TO XLT00035-VND-NBR.      02950001
029600     MOVE XL058-VEND-VND-TYP-CDE        TO XLT00035-VND-TYP-CDE.  02960001
029700     MOVE XL058-VEND-PRTNR-TYP-CDE      TO XLT00035-PRTNR-TYP-CDE.02970001
029800     MOVE XL058-VEND-PRIM-VND-NM        TO XLT00035-PRIM-VND-NM.  02980001
029900     MOVE XL058-VEND-STAT-CDE           TO XLT00035-STAT-CDE.     02990001
030000     MOVE XL058-VEND-SCAC-CDE           TO XLT00035-SCAC-CDE.     03000001
030100     MOVE XL058-VEND-CFY-SLSRNK-NBR     TO                        03010001
030200                                       XLT00035-CFY-SLSRNK-NBR    03020001
030300     MOVE XL058-VEND-PFY-SLSRNK-NBR     TO                        03030001
030400                                       XLT00035-PFY-SLSRNK-NBR.   03040001
030500     MOVE XL058-VEND-P12MN-SLSRNK-NBR   TO                        03050001
030600                                       XLT00035-P12MN-SLSRNK-NBR. 03060001
030700     MOVE XL058-VEND-EDI-PO-PREPK-CDE   TO                        03070001
030800                                       XLT00035-EDI-PO-PREPK-CDE. 03080001
030900     MOVE XL058-VEND-SOR-CRE-TMST       TO                        03090001
031000                                       XLT00035-SOR-CRE-TMST.     03100001
031100     MOVE XL058-VEND-SOR-LAST-UPD-TMST  TO                        03110001
031200                                       XLT00035-SOR-LAST-UPD-TMST.03120001
031300     MOVE XL058-VEND-SHRT-VND-NM        TO XLT00035-SHRT-VND-NM.  03130009
031400     PERFORM 3250-UPDATE-VENDOR.                                  03140001
031500                                                                  03150001
031600 3250-UPDATE-VENDOR.                                              03160001
031700                                                                  03170001
031800     MOVE '3250-UPDATE-VENDOR'      TO PV-PARAGRAPH-NAME.         03180001
031900                                                                  03190001
032000     EXEC SQL                                                     03200001
032100          UPDATE XLT_VND                                          03210001
032200          SET     VND_NBR           = :XLT00035-VND-NBR           03220001
032300                 ,VND_TYP_CDE       = :XLT00035-VND-TYP-CDE       03230001
032400                 ,PRTNR_TYP_CDE     = :XLT00035-PRTNR-TYP-CDE     03240001
032500                 ,PRIM_VND_NM       = :XLT00035-PRIM-VND-NM       03250001
032600                 ,STAT_CDE          = :XLT00035-STAT-CDE          03260001
032700                 ,SCAC_CDE          = :XLT00035-SCAC-CDE          03270001
032800                 ,CFY_SLSRNK_NBR    = :XLT00035-CFY-SLSRNK-NBR    03280001
032900                 ,PFY_SLSRNK_NBR    = :XLT00035-PFY-SLSRNK-NBR    03290001
033000                 ,P12MN_SLSRNK_NBR  = :XLT00035-P12MN-SLSRNK-NBR  03300001
033100                 ,EDI_PO_PREPK_CDE  = :XLT00035-EDI-PO-PREPK-CDE  03310001
033200                 ,SOR_CRE_TMST      = :XLT00035-SOR-CRE-TMST      03320001
033300                 ,SOR_LAST_UPD_TMST = :XLT00035-SOR-LAST-UPD-TMST 03330001
033400                 ,SHRT_VND_NM       = :XLT00035-SHRT-VND-NM       03340001
033500          WHERE  ENT_ID             = :XLT00035-ENT-ID            03350001
033600     END-EXEC.                                                    03360001
033700                                                                  03370001
033800     EVALUATE TRUE                                                03380001
033900        WHEN SQLCODE = ZERO                                       03390001
034000             ADD +1                       TO PC-VEND-RECS-UPDATED 03400001
034100             ADD +1                       TO PC-COMMIT-COUNTER    03410001
034200        WHEN SQLCODE = +100                                       03420001
034300             ADD +1                       TO PC-UPD-NF-RECORDS    03430001
034400        WHEN SQLCODE = -803                                       03440001
034500             ADD +1                       TO PC-DUP-RECORDS       03450001
034600        WHEN OTHER                                                03460001
034700             MOVE XLT00035-ENT-ID         TO PV-DISP-ENT-ID       03470001
034800             DISPLAY 'TRYING TO UPDATE XLT_VND '                  03480001
034900             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            03490001
035000             PERFORM 9999-DISPLAY-STATISTICS                      03500001
035100             PERFORM 9999-ABEND-ROUTINE                           03510001
035200     END-EVALUATE.                                                03520001
035300                                                                  03530001
035400 3300-PROCESS-DELETE.                                             03540001
035500                                                                  03550001
035600     MOVE XL058-VEND-ENT-ID             TO XLT00035-ENT-ID.       03560001
035700     PERFORM 3350-DELETE-VENDOR.                                  03570001
035800                                                                  03580001
035900 3350-DELETE-VENDOR.                                              03590001
036000                                                                  03600001
036100     MOVE '3350-DELETE-VENDOR'       TO PV-PARAGRAPH-NAME.        03610001
036200                                                                  03620001
036300     EXEC SQL                                                     03630001
036400          DELETE FROM XLT_VND                                     03640001
036500          WHERE  ENT_ID       = :XLT00035-ENT-ID                  03650001
036600     END-EXEC.                                                    03660001
036700                                                                  03670001
036800     EVALUATE TRUE                                                03680001
036900        WHEN SQLCODE = ZERO                                       03690001
037000             ADD +1                       TO PC-VEND-RECS-DELETED 03700001
037100             ADD +1                       TO PC-COMMIT-COUNTER    03710001
037200        WHEN SQLCODE = +100                                       03720001
037300             ADD +1                       TO PC-DEL-NF-RECORDS    03730001
037400        WHEN SQLCODE = -532                                       03740001
037500             ADD +1                       TO PC-532-RECORDS       03750001
037600        WHEN OTHER                                                03760001
037700             MOVE XLT00035-ENT-ID         TO PV-DISP-ENT-ID       03770001
037800             DISPLAY 'TRYING TO DELETE XLT_VND '                  03780001
037900             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            03790001
038000             PERFORM 9999-ABEND-ROUTINE                           03800001
038100     END-EVALUATE.                                                03810001
038200                                                                  03820001
038300 4000-PROCESS-VENDOR-DEPT.                                        03830001
038400     EVALUATE TRUE                                                03840001
038500         WHEN XL058-INSERT                                        03850001
038600             PERFORM 4100-PROCESS-INSERT                          03860001
038700         WHEN XL058-UPDATE                                        03870001
038800             PERFORM 4200-PROCESS-UPDATE                          03880001
038900         WHEN XL058-DELETE                                        03890001
039000             PERFORM 4300-PROCESS-DELETE                          03900001
039100     END-EVALUATE.                                                03910001
039200                                                                  03920001
039300 4100-PROCESS-INSERT.                                             03930001
039400     MOVE XL058-VNDP-ENT-ID             TO XLT00039-ENT-ID.       03940001
039500     MOVE XL058-VNDP-DEPT-NBR           TO XLT00039-DEPT-NBR.     03950001
039600     MOVE XL058-VNDP-DC-RET-CDE         TO XLT00039-DC-RET-CDE.   03960001
039700     MOVE XL058-VNDP-DEPT-TYP-CDE       TO XLT00039-DEPT-TYP-CDE. 03970001
039800     MOVE XL058-VNDP-VND-DEPT-STAT-CDE  TO                        03980001
039900                                       XLT00039-VND-DEPT-STAT-CDE.03990001
040000     PERFORM 4150-INSERT-VENDOR-DEPT.                             04000001
040100                                                                  04010001
040200 4150-INSERT-VENDOR-DEPT.                                         04020001
040300                                                                  04030001
040400     MOVE '4150-INSERT-VENDOR-DEPT' TO PV-PARAGRAPH-NAME.         04040001
040500                                                                  04050001
040600     EXEC SQL                                                     04060001
040700          INSERT INTO XLT_VND_DEPT                                04070001
040800                ( ENT_ID                                          04080001
040900                , DEPT_NBR                                        04090001
041000                , DC_RET_CDE                                      04100001
041100                , DEPT_TYP_CDE                                    04110001
041200                , VND_DEPT_STAT_CDE)                              04120001
041300          VALUES                                                  04130001
041400                ( :XLT00039-ENT-ID                                04140001
041500                , :XLT00039-DEPT-NBR                              04150001
041600                , :XLT00039-DC-RET-CDE                            04160001
041700                , :XLT00039-DEPT-TYP-CDE                          04170001
041800                , :XLT00039-VND-DEPT-STAT-CDE)                    04180001
041900     END-EXEC.                                                    04190001
042000                                                                  04200001
042100     EVALUATE TRUE                                                04210001
042200        WHEN SQLCODE = ZERO                                       04220001
042300             ADD +1                 TO PC-VEND-DEPT-RECS-INSERTED 04230001
042400             ADD +1                       TO PC-COMMIT-COUNTER    04240001
042500        WHEN SQLCODE = -803                                       04250001
042600             ADD +1                       TO PC-DUP-RECORDS       04260001
042700        WHEN SQLCODE = -530                                       04270006
042800             MOVE XLT00039-ENT-ID   TO PV-DISP-ENT-ID             04280006
042900             MOVE XLT00039-DEPT-NBR TO PV-DISP-DEPT-NBR           04290006
043000             DISPLAY ' CANNOT ADD DEPARTMENT '                    04300006
043100                     PV-DISP-DEPT-NBR ' FOR VENDOR '              04310006
043200                     PV-DISP-ENT-ID                               04320008
043300                     ' BECAUSE DEPT NOT ON DEPT TABLE'            04330006
043400        WHEN OTHER                                                04340001
043500             MOVE XLT00039-ENT-ID         TO PV-DISP-ENT-ID       04350001
043600             MOVE XLT00039-DEPT-NBR       TO PV-DISP-DEPT-NBR     04360001
043700             DISPLAY 'TRYING TO INSERT XLT_VND_DEPT '             04370001
043800             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            04380001
043900             DISPLAY 'DEPT NBR = '      PV-DISP-DEPT-NBR          04390001
044000             PERFORM 9999-DISPLAY-STATISTICS                      04400001
044100             PERFORM 9999-ABEND-ROUTINE                           04410001
044200     END-EVALUATE.                                                04420001
044300                                                                  04430001
044400 4200-PROCESS-UPDATE.                                             04440001
044500     MOVE XL058-VNDP-ENT-ID             TO XLT00039-ENT-ID.       04450001
044600     MOVE XL058-VNDP-DEPT-NBR           TO XLT00039-DEPT-NBR.     04460001
044700     MOVE XL058-VNDP-DC-RET-CDE         TO XLT00039-DC-RET-CDE.   04470001
044800     MOVE XL058-VNDP-DEPT-TYP-CDE       TO XLT00039-DEPT-TYP-CDE. 04480001
044900     MOVE XL058-VNDP-VND-DEPT-STAT-CDE  TO                        04490001
045000                                       XLT00039-VND-DEPT-STAT-CDE.04500001
045100     PERFORM 4250-UPDATE-VENDOR-DEPT.                             04510001
045200                                                                  04520001
045300 4250-UPDATE-VENDOR-DEPT.                                         04530001
045400                                                                  04540001
045500     MOVE '4250-UPDATE-VENDOR-DEPT' TO PV-PARAGRAPH-NAME.         04550001
045600                                                                  04560001
045700     EXEC SQL                                                     04570001
045800          UPDATE XLT_VND_DEPT                                     04580001
045900          SET     DC_RET_CDE        = :XLT00039-DC-RET-CDE        04590001
046000                , DEPT_TYP_CDE      = :XLT00039-DEPT-TYP-CDE      04600003
046100                , VND_DEPT_STAT_CDE = :XLT00039-VND-DEPT-STAT-CDE 04610003
046200          WHERE  ENT_ID             = :XLT00039-ENT-ID            04620001
046300            AND  DEPT_NBR           = :XLT00039-DEPT-NBR          04630001
046400     END-EXEC.                                                    04640001
046500                                                                  04650001
046600     EVALUATE TRUE                                                04660001
046700        WHEN SQLCODE = ZERO                                       04670001
046800             ADD +1                 TO PC-VEND-DEPT-RECS-UPDATED  04680001
046900             ADD +1                       TO PC-COMMIT-COUNTER    04690001
047000        WHEN SQLCODE = +100                                       04700001
047100             ADD +1                       TO PC-UPD-NF-RECORDS    04710001
047200        WHEN SQLCODE = -803                                       04720001
047300             ADD +1                       TO PC-DUP-RECORDS       04730001
047400        WHEN OTHER                                                04740001
047500             MOVE XLT00039-ENT-ID         TO PV-DISP-ENT-ID       04750001
047600             MOVE XLT00039-DEPT-NBR       TO PV-DISP-DEPT-NBR     04760001
047700             DISPLAY 'TRYING TO UPDATE XLT_VND_DEPT '             04770001
047800             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            04780001
047900             DISPLAY 'DEPT NBR = '      PV-DISP-DEPT-NBR          04790001
048000             PERFORM 9999-DISPLAY-STATISTICS                      04800001
048100             PERFORM 9999-ABEND-ROUTINE                           04810001
048200     END-EVALUATE.                                                04820001
048300                                                                  04830001
048400 4300-PROCESS-DELETE.                                             04840001
048500                                                                  04850001
048600     MOVE XL058-VNDP-ENT-ID             TO XLT00039-ENT-ID.       04860001
048700     MOVE XL058-VNDP-DEPT-NBR           TO XLT00039-DEPT-NBR.     04870001
048800     PERFORM 4350-DELETE-VENDOR-DEPT.                             04880001
048900                                                                  04890001
049000 4350-DELETE-VENDOR-DEPT.                                         04900001
049100                                                                  04910001
049200     MOVE '4350-DELETE-VENDOR-DEPT'  TO PV-PARAGRAPH-NAME.        04920001
049300                                                                  04930001
049400     EXEC SQL                                                     04940001
049500          DELETE FROM XLT_VND_DEPT                                04950001
049600          WHERE  ENT_ID       = :XLT00039-ENT-ID                  04960001
049700            AND  DEPT_NBR     = :XLT00039-DEPT-NBR                04970001
049800     END-EXEC.                                                    04980001
049900                                                                  04990001
050000     EVALUATE TRUE                                                05000001
050100        WHEN SQLCODE = ZERO                                       05010001
050200             ADD +1                 TO PC-VEND-DEPT-RECS-DELETED  05020001
050300             ADD +1                       TO PC-COMMIT-COUNTER    05030001
050400        WHEN SQLCODE = +100                                       05040001
050500             ADD +1                       TO PC-DEL-NF-RECORDS    05050001
050600        WHEN SQLCODE = -532                                       05060001
050700             ADD +1                       TO PC-532-RECORDS       05070001
050800        WHEN OTHER                                                05080001
050900             MOVE XLT00039-ENT-ID         TO PV-DISP-ENT-ID       05090001
051000             MOVE XLT00039-DEPT-NBR       TO PV-DISP-DEPT-NBR     05100001
051100             DISPLAY 'TRYING TO DELETE XLT_VND_DEPT '             05110001
051200             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            05120001
051300             DISPLAY 'DEPT NBR = '      PV-DISP-DEPT-NBR          05130001
051400             PERFORM 9999-ABEND-ROUTINE                           05140001
051500     END-EVALUATE.                                                05150001
051600 5000-PROCESS-VENDOR-CPBL.                                        05160001
051700     EVALUATE TRUE                                                05170001
051800         WHEN XL058-INSERT                                        05180001
051900             PERFORM 5100-PROCESS-INSERT                          05190001
052000         WHEN XL058-UPDATE                                        05200001
052100             PERFORM 5200-PROCESS-UPDATE                          05210001
052200         WHEN XL058-DELETE                                        05220001
052300             PERFORM 5300-PROCESS-DELETE                          05230001
052400     END-EVALUATE.                                                05240001
052500                                                                  05250001
052600 5100-PROCESS-INSERT.                                             05260001
052700     MOVE XL058-VNCP-ENT-ID             TO XLT00037-ENT-ID.       05270001
052800     MOVE XL058-VNCP-VND-CPBL-CDE       TO XLT00037-VND-CPBL-CDE. 05280001
052900     MOVE XL058-VNCP-EFF-BEG-DTE        TO XLT00037-EFF-BEG-DTE.  05290001
053000     MOVE XL058-VNCP-EFF-END-DTE        TO XLT00037-EFF-END-DTE.  05300001
053100     MOVE XL058-VNCP-CRE-DTE            TO XLT00037-CRE-DTE.      05310001
053200     MOVE XL058-VNCP-LAST-UPD-TMST      TO XLT00037-LAST-UPD-TMST.05320001
053300     MOVE XL058-VNCP-LAST-UPD-BY-USR-ID TO                        05330001
053400                                      XLT00037-LAST-UPD-BY-USR-ID.05340001
053500     PERFORM 5150-INSERT-VENDOR-CPBL.                             05350001
053600                                                                  05360001
053700 5150-INSERT-VENDOR-CPBL.                                         05370001
053800                                                                  05380001
053900     MOVE '5150-INSERT-VENDOR-CPBL' TO PV-PARAGRAPH-NAME.         05390001
054000                                                                  05400001
054100     EXEC SQL                                                     05410001
054200          INSERT INTO XLT_VND_CPBL                                05420001
054300                ( ENT_ID                                          05430001
054400                 ,VND_CPBL_CDE                                    05440001
054500                 ,EFF_BEG_DTE                                     05450001
054600                 ,EFF_END_DTE                                     05460001
054700                 ,CRE_DTE                                         05470001
054800                 ,LAST_UPD_TMST                                   05480001
054900                 ,LAST_UPD_BY_USR_ID)                             05490001
055000          VALUES                                                  05500001
055100                ( :XLT00037-ENT-ID                                05510001
055200                , :XLT00037-VND-CPBL-CDE                          05520001
055300                , :XLT00037-EFF-BEG-DTE                           05530001
055400                , :XLT00037-EFF-END-DTE                           05540001
055500                , :XLT00037-CRE-DTE                               05550001
055600                , :XLT00037-LAST-UPD-TMST                         05560001
055700                , :XLT00037-LAST-UPD-BY-USR-ID)                   05570001
055800     END-EXEC.                                                    05580001
055900                                                                  05590001
056000     EVALUATE TRUE                                                05600001
056100        WHEN SQLCODE = ZERO                                       05610001
056200             ADD +1                 TO PC-VEND-CPBL-RECS-INSERTED 05620001
056300             ADD +1                       TO PC-COMMIT-COUNTER    05630001
056400        WHEN SQLCODE = -803                                       05640001
056500             ADD +1                       TO PC-DUP-RECORDS       05650001
056600        WHEN OTHER                                                05660001
056700             MOVE XLT00037-ENT-ID         TO PV-DISP-ENT-ID       05670001
056800             DISPLAY 'TRYING TO INSERT XLT_VND_CPBL '             05680001
056900             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            05690001
057000             DISPLAY 'CPBL CDE = '      XLT00037-VND-CPBL-CDE     05700001
057100             DISPLAY 'BEG DATE = '      XLT00037-EFF-BEG-DTE      05710001
057200             PERFORM 9999-DISPLAY-STATISTICS                      05720001
057300             PERFORM 9999-ABEND-ROUTINE                           05730001
057400     END-EVALUATE.                                                05740001
057500                                                                  05750001
057600 5200-PROCESS-UPDATE.                                             05760001
057700     MOVE XL058-VNCP-ENT-ID             TO XLT00037-ENT-ID.       05770001
057800     MOVE XL058-VNCP-VND-CPBL-CDE       TO XLT00037-VND-CPBL-CDE. 05780001
057900     MOVE XL058-VNCP-EFF-BEG-DTE        TO XLT00037-EFF-BEG-DTE.  05790001
058000     MOVE XL058-VNCP-EFF-END-DTE        TO XLT00037-EFF-END-DTE.  05800001
058100     MOVE XL058-VNCP-CRE-DTE            TO XLT00037-CRE-DTE.      05810001
058200     MOVE XL058-VNCP-LAST-UPD-TMST      TO XLT00037-LAST-UPD-TMST.05820001
058300     MOVE XL058-VNCP-LAST-UPD-BY-USR-ID TO                        05830001
058400                                      XLT00037-LAST-UPD-BY-USR-ID.05840001
058500     PERFORM 5250-UPDATE-VENDOR-CPBL.                             05850001
058600                                                                  05860001
058700 5250-UPDATE-VENDOR-CPBL.                                         05870001
058800                                                                  05880001
058900     MOVE '5250-UPDATE-VENDOR-CPBL' TO PV-PARAGRAPH-NAME.         05890001
059000                                                                  05900001
059100     EXEC SQL                                                     05910001
059200          UPDATE XLT_VND_CPBL                                     05920001
059300          SET     EFF_END_DTE       = :XLT00037-EFF-END-DTE       05930001
059400                , CRE_DTE           = :XLT00037-CRE-DTE           05940001
059500                , LAST_UPD_TMST     = :XLT00037-LAST-UPD-TMST     05950001
059600                , LAST_UPD_BY_USR_ID                              05960001
059700                                    = :XLT00037-LAST-UPD-BY-USR-ID05970001
059800          WHERE  ENT_ID             = :XLT00037-ENT-ID            05980001
059900            AND  VND_CPBL_CDE       = :XLT00037-VND-CPBL-CDE      05990001
060000            AND  EFF_BEG_DTE        = :XLT00037-EFF-BEG-DTE       06000001
060100     END-EXEC.                                                    06010001
060200                                                                  06020001
060300     EVALUATE TRUE                                                06030001
060400        WHEN SQLCODE = ZERO                                       06040001
060500             ADD +1                 TO PC-VEND-CPBL-RECS-UPDATED  06050001
060600             ADD +1                       TO PC-COMMIT-COUNTER    06060001
060700        WHEN SQLCODE = +100                                       06070001
060800             ADD +1                       TO PC-UPD-NF-RECORDS    06080001
060900        WHEN SQLCODE = -803                                       06090001
061000             ADD +1                       TO PC-DUP-RECORDS       06100001
061100        WHEN OTHER                                                06110001
061200             MOVE XLT00037-ENT-ID         TO PV-DISP-ENT-ID       06120001
061300             DISPLAY 'TRYING TO UPDATE XLT_VND_CPBL '             06130001
061400             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            06140001
061500             DISPLAY 'CPBL CDE = '      XLT00037-VND-CPBL-CDE     06150001
061600             DISPLAY 'BEG DATE = '      XLT00037-EFF-BEG-DTE      06160001
061700             PERFORM 9999-DISPLAY-STATISTICS                      06170001
061800             PERFORM 9999-ABEND-ROUTINE                           06180001
061900     END-EVALUATE.                                                06190001
062000                                                                  06200001
062100 5300-PROCESS-DELETE.                                             06210001
062200                                                                  06220001
062300     MOVE XL058-VNCP-ENT-ID             TO XLT00037-ENT-ID.       06230001
062400     MOVE XL058-VNCP-VND-CPBL-CDE       TO XLT00037-VND-CPBL-CDE. 06240001
062500     MOVE XL058-VNCP-EFF-BEG-DTE        TO XLT00037-EFF-BEG-DTE.  06250001
062600     PERFORM 5350-DELETE-VENDOR-CPBL.                             06260001
062700                                                                  06270001
062800 5350-DELETE-VENDOR-CPBL.                                         06280001
062900                                                                  06290001
063000     MOVE '5350-DELETE-VENDOR-CPBL'  TO PV-PARAGRAPH-NAME.        06300001
063100                                                                  06310001
063200     EXEC SQL                                                     06320001
063300          DELETE FROM XLT_VND_CPBL                                06330001
063400          WHERE  ENT_ID       = :XLT00037-ENT-ID                  06340001
063500            AND  VND_CPBL_CDE = :XLT00037-VND-CPBL-CDE            06350001
063600            AND  EFF_BEG_DTE  = :XLT00037-EFF-BEG-DTE             06360001
063700     END-EXEC.                                                    06370001
063800                                                                  06380001
063900     EVALUATE TRUE                                                06390001
064000        WHEN SQLCODE = ZERO                                       06400001
064100             ADD +1                 TO PC-VEND-CPBL-RECS-DELETED  06410001
064200             ADD +1                       TO PC-COMMIT-COUNTER    06420001
064300        WHEN SQLCODE = +100                                       06430001
064400             ADD +1                       TO PC-DEL-NF-RECORDS    06440001
064500        WHEN SQLCODE = -532                                       06450001
064600             ADD +1                       TO PC-532-RECORDS       06460001
064700        WHEN OTHER                                                06470001
064800             MOVE XLT00039-ENT-ID         TO PV-DISP-ENT-ID       06480001
064900             DISPLAY 'TRYING TO DELETE XLT_VND_CPBL '             06490001
065000             DISPLAY 'ENT ID = '        PV-DISP-ENT-ID            06500001
065100             DISPLAY 'CPBL CDE = '      XLT00037-VND-CPBL-CDE     06510001
065200             DISPLAY 'BEG DATE = '      XLT00037-EFF-BEG-DTE      06520001
065300             PERFORM 9999-ABEND-ROUTINE                           06530001
065400     END-EVALUATE.                                                06540001
065500 6000-PROCESS-VENDOR-CPBL-CDE.                                    06550001
065600     EVALUATE TRUE                                                06560001
065700         WHEN XL058-INSERT                                        06570001
065800             PERFORM 6100-PROCESS-INSERT                          06580001
065900         WHEN XL058-UPDATE                                        06590001
066000             PERFORM 6200-PROCESS-UPDATE                          06600001
066100         WHEN XL058-DELETE                                        06610001
066200             PERFORM 6300-PROCESS-DELETE                          06620001
066300     END-EVALUATE.                                                06630001
066400                                                                  06640001
066500 6100-PROCESS-INSERT.                                             06650001
066600     MOVE XL058-VNCD-VND-CPBL-CDE       TO XLT00036-VND-CPBL-CDE. 06660001
066700     MOVE XL058-VNCD-VND-CPBL-DESC      TO XLT00036-VND-CPBL-DESC.06670001
066800     MOVE XL058-VNCD-LAST-UPD-TMST      TO XLT00036-LAST-UPD-TMST.06680001
066900     MOVE XL058-VNCD-LAST-UPD-BY-USR-ID TO                        06690001
067000                                      XLT00036-LAST-UPD-BY-USR-ID.06700001
067100     MOVE XL058-VNCD-ACTV-IND           TO  XLT00036-ACTV-IND.    06710005
067200     PERFORM 6150-INSERT-VENDOR-CPBL-CDE.                         06720001
067300                                                                  06730001
067400 6150-INSERT-VENDOR-CPBL-CDE.                                     06740001
067500                                                                  06750001
067600     MOVE '6150-INSERT-VENDOR-CPBL-CDE' TO PV-PARAGRAPH-NAME.     06760001
067700                                                                  06770001
067800     EXEC SQL                                                     06780001
067900          INSERT INTO XLT_VND_CPBL_CDE                            06790001
068000                ( VND_CPBL_CDE                                    06800001
068100                 ,VND_CPBL_DESC                                   06810001
068200                 ,LAST_UPD_TMST                                   06820001
068300                 ,LAST_UPD_BY_USR_ID                              06830001
068400                 ,ACTV_IND)                                       06840001
068500          VALUES                                                  06850001
068600                ( :XLT00036-VND-CPBL-CDE                          06860001
068700                , :XLT00036-VND-CPBL-DESC                         06870001
068800                , :XLT00036-LAST-UPD-TMST                         06880001
068900                , :XLT00036-LAST-UPD-BY-USR-ID                    06890001
069000                , :XLT00036-ACTV-IND)                             06900001
069100     END-EXEC.                                                    06910001
069200                                                                  06920001
069300     EVALUATE TRUE                                                06930001
069400        WHEN SQLCODE = ZERO                                       06940001
069500             ADD +1             TO PC-VEND-CPBL-CDE-RECS-INSERTED 06950001
069600             ADD +1                       TO PC-COMMIT-COUNTER    06960001
069700        WHEN SQLCODE = -803                                       06970001
069800             ADD +1                       TO PC-DUP-RECORDS       06980001
069900        WHEN OTHER                                                06990001
070000             DISPLAY 'TRYING TO INSERT XLT_VND_CPBL_CDE'          07000001
070100             DISPLAY 'CPBTL CDE = '     XLT00036-VND-CPBL-CDE     07010001
070200             PERFORM 9999-DISPLAY-STATISTICS                      07020001
070300             PERFORM 9999-ABEND-ROUTINE                           07030001
070400     END-EVALUATE.                                                07040001
070500                                                                  07050001
070600 6200-PROCESS-UPDATE.                                             07060001
070700     MOVE XL058-VNCD-VND-CPBL-CDE       TO XLT00036-VND-CPBL-CDE. 07070001
070800     MOVE XL058-VNCD-VND-CPBL-DESC      TO XLT00036-VND-CPBL-DESC.07080001
070900     MOVE XL058-VNCD-LAST-UPD-TMST      TO XLT00036-LAST-UPD-TMST.07090001
071000     MOVE XL058-VNCD-LAST-UPD-BY-USR-ID TO                        07100001
071100                                      XLT00036-LAST-UPD-BY-USR-ID.07110001
071200     MOVE XL058-VNCD-ACTV-IND           TO  XLT00036-ACTV-IND.    07120007
071300     PERFORM 6250-UPDATE-VENDOR-CPBL-CDE.                         07130001
071400                                                                  07140001
071500 6250-UPDATE-VENDOR-CPBL-CDE.                                     07150001
071600                                                                  07160001
071700     MOVE '6250-UPDATE-VENDOR-CPBL-CDE' TO PV-PARAGRAPH-NAME.     07170001
071800                                                                  07180001
071900     EXEC SQL                                                     07190001
072000          UPDATE XLT_VND_CPBL_CDE                                 07200001
072100          SET     VND_CPBL_DESC     = :XLT00036-VND-CPBL-DESC     07210001
072200                 ,LAST_UPD_TMST     = :XLT00036-LAST-UPD-TMST     07220001
072300                 ,LAST_UPD_BY_USR_ID                              07230001
072400                                    = :XLT00036-LAST-UPD-BY-USR-ID07240001
072500                 ,ACTV_IND          = :XLT00036-ACTV-IND          07250001
072600          WHERE  VND_CPBL_CDE       = :XLT00036-VND-CPBL-CDE      07260001
072700     END-EXEC.                                                    07270001
072800                                                                  07280001
072900     EVALUATE TRUE                                                07290001
073000        WHEN SQLCODE = ZERO                                       07300001
073100             ADD +1             TO PC-VEND-CPBL-CDE-RECS-UPDATED  07310001
073200             ADD +1                       TO PC-COMMIT-COUNTER    07320001
073300        WHEN SQLCODE = +100                                       07330001
073400             ADD +1                       TO PC-UPD-NF-RECORDS    07340001
073500        WHEN SQLCODE = -803                                       07350001
073600             ADD +1                       TO PC-DUP-RECORDS       07360001
073700        WHEN OTHER                                                07370001
073800             DISPLAY 'TRYING TO UPDATE XLT_VND_CPBL_CDE'          07380001
073900             DISPLAY 'CPBTL CDE = '     XLT00036-VND-CPBL-CDE     07390001
074000             PERFORM 9999-DISPLAY-STATISTICS                      07400001
074100             PERFORM 9999-ABEND-ROUTINE                           07410001
074200     END-EVALUATE.                                                07420001
074300                                                                  07430001
074400 6300-PROCESS-DELETE.                                             07440001
074500                                                                  07450001
074600     MOVE XL058-VNCD-VND-CPBL-CDE       TO XLT00036-VND-CPBL-CDE. 07460001
074700     PERFORM 6350-DELETE-VENDOR-CPBL-CDE.                         07470001
074800                                                                  07480001
074900 6350-DELETE-VENDOR-CPBL-CDE.                                     07490001
075000                                                                  07500001
075100     MOVE '6350-DELETE-VENDOR-CPBL-CDE' TO PV-PARAGRAPH-NAME.     07510001
075200                                                                  07520001
075300     EXEC SQL                                                     07530001
075400          DELETE FROM XLT_VND_CPBL_CDE                            07540001
075500          WHERE  VND_CPBL_CDE = :XLT00036-VND-CPBL-CDE            07550001
075600     END-EXEC.                                                    07560001
075700                                                                  07570001
075800     EVALUATE TRUE                                                07580001
075900        WHEN SQLCODE = ZERO                                       07590001
076000             ADD +1             TO PC-VEND-CPBL-CDE-RECS-DELETED  07600001
076100             ADD +1                       TO PC-COMMIT-COUNTER    07610001
076200        WHEN SQLCODE = +100                                       07620001
076300             ADD +1                       TO PC-DEL-NF-RECORDS    07630001
076400        WHEN SQLCODE = -532                                       07640001
076500             ADD +1                       TO PC-532-RECORDS       07650001
076600        WHEN OTHER                                                07660001
076700             DISPLAY 'TRYING TO DELETE XLT_VND_CPBL_CDE '         07670001
076800             DISPLAY 'CPBTL CDE = '     XLT00036-VND-CPBL-CDE     07680001
076900             PERFORM 9999-ABEND-ROUTINE                           07690001
077000     END-EVALUATE.                                                07700001
077100                                                                  07710001
077200***************************************************************** 07720001
077300**READ INPUT FILE                                                 07730001
077400***************************************************************** 07740001
077500 9999-READ-INPUT-FILE.                                            07750001
077600                                                                  07760001
077700     READ INPUT-FILE INTO XL058-TRANS-REC                         07770002
077800          AT END SET PS-END-OF-INPUT-FILE TO TRUE                 07780001
077900     END-READ.                                                    07790001
078000                                                                  07800001
078100     IF  PS-NOT-END-OF-INPUT-FILE                                 07810001
078200         ADD +1 TO PC-INPUT-RECORDS-READ                          07820001
078300     END-IF.                                                      07830001
078400                                                                  07840001
078500 EJECT.                                                           07850001
078600****************************************************************  07860001
078700*END OF PROGRAM ROUTINE                                           07870001
078800****************************************************************  07880001
078900 9999-WRAPUP.                                                     07890001
079000                                                                  07900001
079100     PERFORM 9999-COMMIT-DATA.                                    07910001
079200                                                                  07920001
079300     CLOSE INPUT-FILE.                                            07930001
079400                                                                  07940001
079500     PERFORM 9999-DISPLAY-STATISTICS.                             07950001
079600                                                                  07960001
079700 EJECT.                                                           07970001
079800****************************************************************  07980001
079900*COMMIT DATA TO DATABASE                                          07990001
080000****************************************************************  08000001
080100 9999-COMMIT-DATA.                                                08010001
080200                                                                  08020001
080300     MOVE '9999-COMMIT-DATA' TO PV-PARAGRAPH-NAME.                08030001
080400                                                                  08040001
080500     EXEC SQL                                                     08050001
080600          COMMIT                                                  08060001
080700     END-EXEC.                                                    08070001
080800                                                                  08080001
080900     EVALUATE TRUE                                                08090001
081000        WHEN SQLCODE = ZERO                                       08100001
081100             CONTINUE                                             08110001
081200        WHEN OTHER                                                08120001
081300             PERFORM 9999-DISPLAY-STATISTICS                      08130001
081400             PERFORM 9999-ABEND-ROUTINE                           08140001
081500     END-EVALUATE.                                                08150001
081600                                                                  08160001
081700 EJECT.                                                           08170001
081800****************************************************************  08180001
081900*DISPLAY PROGRAM STATISTICS                                       08190001
082000****************************************************************  08200001
082100 9999-DISPLAY-STATISTICS.                                         08210001
082200                                                                  08220001
082300     DISPLAY '*************************************************'. 08230001
082400     DISPLAY '* PROGRAM...............: ' PC-CURRENT-PROGRAM-NAME.08240001
082500     DISPLAY '* TABLE.................: ' PC-TABLE-NAME.          08250001
082600     DISPLAY '* TIMESTAMP.............: ' SD-TIMESTAMP.           08260001
082700     DISPLAY '*************************************************'. 08270001
082800     DISPLAY '* DATE/TIMESTAMP.............: '                    08280004
082900                                          SD-TIMESTAMP.           08290004
083000     DISPLAY '* TOTAL RECORDS READ.........: '                    08300004
083100                                          PC-INPUT-RECORDS-READ.  08310004
083200     DISPLAY '* TOTAL VENDORS INSERTED.....: '                    08320004
083300                                          PC-VEND-RECS-INSERTED.  08330004
083400     DISPLAY '* TOTAL VENDORS UPDATED......: '                    08340004
083500                                          PC-VEND-RECS-UPDATED.   08350004
083600     DISPLAY '* TOTAL VENDORS DELETED......: '                    08360004
083700                                          PC-VEND-RECS-DELETED.   08370004
083800     DISPLAY '* TOTAL VND DEPT INSERTED....: '                    08380004
083900                                     PC-VEND-DEPT-RECS-INSERTED.  08390001
084000     DISPLAY '* TOTAL VND DEPT UPDATED.....: '                    08400004
084100                                     PC-VEND-DEPT-RECS-UPDATED.   08410001
084200     DISPLAY '* TOTAL VND DEPT DELETED.....: '                    08420004
084300                                     PC-VEND-DEPT-RECS-DELETED.   08430001
084400     DISPLAY '* TOTAL VND CPBL INSERTED....: '                    08440004
084500                                     PC-VEND-CPBL-RECS-INSERTED.  08450004
084600     DISPLAY '* TOTAL VND CPBL UPDATED.....: '                    08460004
084700                                     PC-VEND-CPBL-RECS-UPDATED.   08470004
084800     DISPLAY '* TOTAL VND CPBL DELETED.....: '                    08480004
084900                                     PC-VEND-CPBL-RECS-DELETED.   08490004
085000     DISPLAY '* TOTAL VND CPBL CDE INSERTED: '                    08500004
085100                                PC-VEND-CPBL-CDE-RECS-INSERTED.   08510004
085200     DISPLAY '* TOTAL VND CPBL CDE UPDATED.: '                    08520004
085300                                PC-VEND-CPBL-CDE-RECS-UPDATED.    08530004
085400     DISPLAY '* TOTAL VND CPBL CDE DELETED.: '                    08540004
085500                                PC-VEND-CPBL-CDE-RECS-DELETED.    08550004
085600     DISPLAY '* DUPLICATE REC IGNORED.: ' PC-DUP-RECORDS.         08560001
085700     DISPLAY '* REC NOT FOUND FOR DEL.: ' PC-DEL-NF-RECORDS.      08570001
085800     DISPLAY '* REC NOT FOUND FOR UPD.: ' PC-UPD-NF-RECORDS.      08580001
085900     DISPLAY '* REC DELETE RESTRICTED.: ' PC-532-RECORDS.         08590001
086000     DISPLAY '* REC INSERT RESTRICTED.: ' PV-530-RECORDS.         08600001
086100     DISPLAY '*************************************************'. 08610001
086200                                                                  08620001
086300 EJECT.                                                           08630001
086400******************************************************************08640001
086500**SQL ABEND ROUTINE                                               08650001
086600******************************************************************08660001
086700 9999-ABEND-ROUTINE.                                              08670001
086800                                                                  08680001
086900     DISPLAY '** ABEND     **'.                                   08690001
087000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08700001
087100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              08710001
087200     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               08720001
087300******************************************************************08730001
087400* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     08740001
087500* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      08750001
087600******************************************************************08760001
087700     COPY DPPD004.                                                08770001
087800     SET ABEND-4013-DB2-ERROR TO TRUE.                            08780001
087900     CALL 'ILBOABN0' USING ABEND-CODE.                            08790001
088000                                                                  08800001
088100 EJECT                                                            08810001
