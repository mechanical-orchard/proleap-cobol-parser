000100******************************************************************00010011
000200 IDENTIFICATION DIVISION.                                         00020011
000300******************************************************************00030011
000400                                                                  00040011
000500 PROGRAM-ID.             WSKCS312.                                00050011
000600 AUTHOR.                 GERMAN BANDA.                            00060011
000700 INSTALLATION.           KOHLS.                                   00070011
000800 DATE-WRITTEN            MARCH 2007.                              00080011
000900 DATE-COMPILED.                                                   00090011
001000                                                                  00100011
001100******************************************************************00110011
001200* THIS PROGRAM WILL CREATE A NEW RECEIVER FOR A FREE-ASTRAY       00120011
001300* CARTON.                                                         00130011
001400******************************************************************00140011
001500* CLT 12-13-2011 WR40574                                          00150012
001510*                ADDED CARR-AUTH-ID (CAN)                         00151012
001600******************************************************************00160011
001700 ENVIRONMENT DIVISION.                                            00170011
001800******************************************************************00180011
001900 DATA DIVISION.                                                   00190011
002000******************************************************************00200011
002100                                                                  00210011
002200******************************************************************00220011
002300 WORKING-STORAGE SECTION.                                         00230011
002400******************************************************************00240011
002500                                                                  00250011
002600     COPY WSWS008.                                                00260011
002700*----------------------------------------------------------------*00270011
002800*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     00280011
002900*----------------------------------------------------------------*00290011
003000     COPY TMWS500.                                                00300011
003100                                                                  00310011
003200*----------------------------------------------------------------*00320011
003300*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                 *00330039
003400*----------------------------------------------------------------*00340011
003500     COPY DPWS902.                                                00350039
003600                                                                  00360011
003700*----------------------------------------------------------------*00370011
003800*  WORK AREA PASSED IN CALL TO DPKUT500                          *00380011
003900*----------------------------------------------------------------*00390011
004000     COPY DPWS500.                                                00400011
004100                                                                  00410011
004200*----------------------------------------------------------------*00420011
004300*    ABEND PROCESSING COPYBOOK.                                  *00430011
004400*----------------------------------------------------------------*00440011
004500     COPY DPWS013.                                                00450011
004600                                                                  00460011
004700***************************************************************** 00470011
004800*    STANDARD COMMAREA.                                           00480011
004900***************************************************************** 00490011
005000                                                                  00500011
005100     COPY DPWS020.                                                00510011
005200                                                                  00520011
005300     COPY RCWS031.                                                00530011
005400                                                                  00540011
005500     COPY DPWS017.                                                00550011
005600*----------------------------------------------------------------*00560011
005700*    COPY BOOK FOR CALENDAR SUBROUTINE (DPKUT500)                 00570011
005800*----------------------------------------------------------------*00580011
005900                                                                  00590011
006000     COPY DPWS500.                                                00600011
006100******************************************************************00610011
006200******************************************************************00620011
006300 01  DN-DB2-NULL-INDICATORS.                                      00630011
006400     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00640011
006500     05  DN-EST-AR-TMST               PIC S9(04) COMP VALUE +0.   00650011
006600*                                                                 00660011
006700 01  DK-DB2-KEYS.                                                 00670011
006800     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   00680011
006900     05  DK-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.   00690011
007000     05  DK-SCAC-ID                   PIC X(04)  VALUE SPACES.    00700011
007100     05  DK-VEH-NBR                   PIC X(10)  VALUE SPACES.    00710011
007200     05  DK-OPER-UNT-ID               PIC S9(04) COMP VALUE +0.   00720011
007300     05  DK-FCLTY-ID                  PIC S9(04) COMP VALUE +0.   00730011
007400     05  DK-SHIPT-UNT-ID              PIC S9(18) COMP-3.          00740011
007500     05  DK-CURR-SHIPT-ID             PIC S9(09) VALUE +0         00750011
007600                                              COMP.               00760011
007700     05  DK-OPER-SET-ID               PIC S9(04) COMP VALUE +0.   00770011
007800     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    00780011
007900     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   00790011
008000     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    00800011
008100                                                                  00810011
008200 01  PC-PROGRAM-CONSTANTS.                                        00820011
008300     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3 COMP.     00830011
008400     05  PC-TMKCS520               PIC X(08)  VALUE  'TMKCS520'.  00840011
008500     05  PC-RANDNBR-PGM           PIC  X(08)  VALUE  'DPKUT902'.  00850039
008600     05  PC-TROUBLE-RTN           PIC X(08)   VALUE  'TMKCS520'.  00860011
008700     05  PC-TROUBLE-RTN-LENGTH    PIC S9(04)  VALUE +600 COMP.    00870011
008800     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00880011
008900                                  '9999-09-09-09.09.09.999999'.   00890011
009000     05  PC-PCKCS756               PIC X(08)  VALUE 'PCKCS756'.   00900011
009100     05  PC-AUDIT-RTN              PIC X(08)  VALUE 'RCKCS290'.   00910011
009200     05  PC-CALENDAR-ROUTINE       PIC X(08)  VALUE 'RCKCS290'.   00920011
009300     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'WSKCS312'.   00930011
009400     05  PC-AUDIT-RTN-LENGTH       PIC S9(4)  VALUE  +300         00940011
009500                                                COMP SYNC.        00950011
009600     05  PC-DEFAULT-DATE           PIC X(10)  VALUE '0001-01-01'. 00960011
009700     05  PC-DEFAULT-9DATE          PIC X(10)  VALUE '9999-09-09'. 00970011
009800     05  PC-DEFAULT-TIME           PIC X(08)  VALUE '00.00.00'.   00980011
009900     05  PC-RECV-CRE-UID           PIC X(08)  VALUE 'F/A SYTM'.   00990011
010000     05  PC-RECV-CRE-UID-CKIN      PIC X(08)  VALUE 'CHECK-IN'.   01000011
010010     05  PC-WM-UNKNOWN             PIC X(10)  VALUE 'WM UNKNOWN'. 01001011
010020     05  PC-OPER-SET-700           PIC 9(03)  VALUE 700.          01002012
010030                                                                  01003012
010040                                                                  01004012
010050 01  PS-PROGRAM-SWITCHES.                                         01005012
010060     05  PS-TRECVER-CURSOR-SW     PIC  X(01)  VALUE 'N'.          01006012
010070         88  PS-EOF-TRECVER-CSR               VALUE 'Y'.          01007012
010080     05  PS-RCVR-FOUND-SW         PIC  X(01)  VALUE 'N'.          01008012
010090         88  PS-RCVR-FOUND                    VALUE 'Y'.          01009012
010100         88  PS-NO-RCVR-FOUND                 VALUE 'N'.          01010012
010200     05  PS-TOSOPFA-CURSOR-SW     PIC  X(01)  VALUE 'N'.          01020012
010300         88  PS-EOF-TOSOPFA-CSR               VALUE 'Y'.          01030012
010400     05  PS-INSTRUCTION-SW        PIC  X(01)  VALUE 'N'.          01040012
010500         88  PS-FIRST-INSTRUCTION             VALUE 'Y'.          01050012
010600     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   01060012
010700         88  PS-LOG-MESSAGE                          VALUE 'Y'.   01070012
010800         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   01080012
010900                                                                  01090012
011000                                                                  01100012
011100     05  PS-BEFORE-ONLY-LOGGING-SW      PIC  X       VALUE 'N'.   01110012
011200         88  PS-BEFORE-ONLY-LOGGING                  VALUE 'Y'.   01120012
011300         88  PS-NOT-BEFORE-ONLY-LOGGING              VALUE 'N'.   01130012
011400     05  PS-TRBL-EXISTS-SW              PIC  X       VALUE 'Y'.   01140012
011500         88  PS-NO-TRBL-EXISTS                       VALUE 'N'.   01150012
011600         88  PS-TRBL-EXISTS                          VALUE 'Y'.   01160012
011700     05  PS-NOT-VERIFIED-STATUS-SW      PIC  X       VALUE 'Y'.   01170012
011800         88  PS-NOT-VERIFIED-STATUS                  VALUE 'N'.   01180012
011900         88  PS-VERIFIED-STATUS                      VALUE 'Y'.   01190012
012000     05  PS-OUTBND-CART-FOUND-SW        PIC  X       VALUE 'Y'.   01200012
012100         88  PS-NO-OUTBND-CART-FOUND                 VALUE 'N'.   01210012
012200         88  PS-OUTBND-CART-FOUND                    VALUE 'Y'.   01220012
012300     05  PS-PRE-RECVR-STAT-SW           PIC  X       VALUE 'Y'.   01230012
012400         88  PS-NOT-PRE-RECVR-STAT                   VALUE 'N'.   01240012
012500         88  PS-PRE-RECVR-STAT                       VALUE 'Y'.   01250012
012600     05  PS-DISTHD-FOUND-SW             PIC  X       VALUE 'Y'.   01260012
012700         88  PS-NO-DISTHD-FOUND                      VALUE 'N'.   01270012
012800         88  PS-DISTHD-FOUND                         VALUE 'Y'.   01280012
012900     05  PS-DISTDT-FOUND-SW             PIC  X       VALUE 'Y'.   01290012
013000         88  PS-NO-DISTDT-FOUND                      VALUE 'N'.   01300012
013100         88  PS-DISTDT-FOUND                         VALUE 'Y'.   01310012
013200     05  PS-AUTO-APPLY-SW               PIC  X       VALUE 'Y'.   01320012
013300         88  PS-NO-AUTO-APPLY                        VALUE 'N'.   01330012
013400         88  PS-AUTO-APPLY                           VALUE 'Y'.   01340012
013500     05  PS-USE-EXPECTED-QTY-SW         PIC  X       VALUE 'N'.   01350012
013600         88  PS-DONT-USE-EXPECTED-QTY                VALUE 'N'.   01360012
013700         88  PS-USE-EXPECTED-QTY                     VALUE 'Y'.   01370012
013800     05  PS-ERROR-SW                    PIC  X       VALUE 'N'.   01380012
013900         88  PS-NO-ERROR                             VALUE 'N'.   01390012
014000         88  PS-ERROR                                VALUE 'Y'.   01400012
014100     05  PS-UPDATE-STORE-SW             PIC X(01).                01410012
014200         88  PS-UPDATE-YES                           VALUE 'Y'.   01420012
014300         88  PS-UPDATE-NO                            VALUE 'N'.   01430012
014400     05  PS-STORE-TYPE-SW               PIC  X(01).               01440012
014500         88  PS-NOT-DC-STORE-TYPE                    VALUE 'N'.   01450012
014600         88  PS-DC-STORE-TYPE                        VALUE 'D'.   01460012
014700     05  PS-RECEIVER-FOUND-SW           PIC  X(01)   VALUE 'N'.   01470012
014800         88  PS-RECEIVER-FOUND                       VALUE 'Y'.   01480012
014900         88  PS-RECEIVER-NOT-FOUND                   VALUE 'N'.   01490012
015000     05  PS-LINE-FOUND-SW               PIC  X(01)   VALUE 'N'.   01500012
015100         88  PS-LINE-FOUND                           VALUE 'Y'.   01510012
015200         88  PS-LINE-NOT-FOUND                       VALUE 'N'.   01520012
015300     05  PS-AUDIT-EXISTS-SW             PIC X(01)    VALUE 'N'.   01530012
015400         88  PS-AUDIT-EXISTS                         VALUE 'Y'.   01540012
015500         88  PS-AUDIT-NOT-EXISTS                     VALUE 'N'.   01550012
015600     05  PS-CARTON-FIRST-PASS-SW        PIC X(01)    VALUE 'N'.   01560012
015700         88  PS-CARTON-FIRST-PASS                    VALUE 'Y'.   01570012
015800         88  PS-NOT-CARTON-FIRST-PASS                VALUE 'N'.   01580012
015900     05  PS-AUDIT-FIRST-PASS-SW         PIC X(01)    VALUE 'N'.   01590012
016000         88  PS-AUDIT-FIRST-PASS                     VALUE 'Y'.   01600012
016100         88  PS-NOT-AUDIT-FIRST-PASS                 VALUE 'N'.   01610012
016200     05  PS-SYSTEM-AUDIT-FOUND-SW       PIC X(01)    VALUE 'N'.   01620012
016300         88  PS-SYSTEM-AUDIT-NOT-FOUND               VALUE 'N'.   01630012
016400         88  PS-SYSTEM-AUDIT-FOUND                   VALUE 'Y'.   01640012
016500     05  PS-OVER-SHORT-IND               PIC  X(01)  VALUE 'N'.   01650012
016600         88  PS-OVER-SHORT-ERROR                     VALUE 'Y'.   01660012
016700         88  PS-NO-OVER-SHORT-ERROR                  VALUE 'N'.   01670012
016800     05  PS-CARTON-ITEM-CURSOR-IND       PIC  X(01)  VALUE 'N'.   01680012
016900         88  PS-NOT-EOC-CARTON-ITEM-CURSOR           VALUE 'N'.   01690012
017000         88  PS-EOC-CARTON-ITEM-CURSOR               VALUE 'Y'.   01700012
017100     05  PS-AUDIT-ITEM-CURSOR-IND        PIC  X(01)  VALUE 'N'.   01710012
017200         88  PS-NOT-EOC-AUDIT-ITEM-CURSOR            VALUE 'N'.   01720012
017300         88  PS-EOC-AUDIT-ITEM-CURSOR                VALUE 'Y'.   01730012
017400     05  PS-CARTON-UPC-CURSOR-IND        PIC  X(01)  VALUE 'N'.   01740012
017500         88  PS-NOT-EOC-CARTON-UPC-CURSOR            VALUE 'N'.   01750012
017600         88  PS-EOC-CARTON-UPC-CURSOR                VALUE 'Y'.   01760012
017700     05  PS-AUDIT-UPC-CURSOR-IND         PIC  X(01)  VALUE 'N'.   01770012
017800         88  PS-NOT-EOC-AUDIT-UPC-CURSOR             VALUE 'N'.   01780012
017900         88  PS-EOC-AUDIT-UPC-CURSOR                 VALUE 'Y'.   01790012
018000     05  PS-CARTON-UPC-CHANGE-IND        PIC  X(01)  VALUE 'N'.   01800012
018100         88  PS-CARTON-UPC-CHANGE                    VALUE 'Y'.   01810012
018200         88  PS-NO-CARTON-UPC-CHANGE                 VALUE 'N'.   01820012
018300     05  PS-AUDIT-UPC-CHANGE-IND         PIC  X(01)  VALUE 'N'.   01830012
018400         88  PS-AUDIT-UPC-CHANGE                     VALUE 'Y'.   01840012
018500         88  PS-NO-AUDIT-UPC-CHANGE                  VALUE 'N'.   01850012
018600     05  PS-PRO-BOL-SCAC-EXISTS-SW       PIC  X(01)  VALUE 'N'.   01860012
018700         88  PS-PRO-BOL-SCAC-EXISTS                  VALUE 'Y'.   01870012
018800         88  PS-PRO-BOL-SCAC-NOT-EXISTS              VALUE 'N'.   01880012
018900                                                                  01890012
019000 01  PV-PROGRAM-VARIABLES.                                        01900012
019100     05  PV-SWITCH-IND                   PIC   X(01) VALUE SPACE. 01910012
019200     05  PV-TRN-CDE               PIC X(1)    VALUE SPACES.       01920012
019300     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01930012
019400                                              COMP SYNC.          01940012
019500     05  PV-SHIPMT-COUNT          PIC S9(09)  VALUE +0            01950012
019600                                              COMP-3.             01960012
019700     05  PV-DISP-SQLCODE          PIC -9(03) VALUE ZEROES.        01970021
019800     05  PV-DISP-PO-NBR           PIC  9(09).                     01980012
019900     05  PV-DISP-TYP-CDE          PIC  9(04).                     01990012
020000     05  PV-DISP-WO-SEQ-NBR       PIC  9(04).                     02000012
020100     05  PV-DISP-WO-INSTR-SEQ-NBR PIC  9(04).                     02010012
020200     05  PV-DISP-SHIPT-ID         PIC  9(18).                     02020012
020300     05  PV-DISP-TRIP-ID          PIC  9(09).                     02030012
020400     05  PV-DISP-REC-SEQ          PIC  9(04).                     02040021
020500     05  PV-DISP-OPER-UNT-ID      PIC  9(04).                     02050012
020600     05  PV-DISP-FCLTY-ID         PIC  9(04).                     02060012
020700     05  PV-DISP-OPER-SET         PIC  9(04).                     02070012
020800     05  PV-DISP-FINCL-ADJ-ID            PIC  9(09) VALUE ZEROES. 02080012
020900     05  PV-DISPLAY-UPC-NBR              PIC   9(15).             02090012
021000     05  PV-DISPLAY-INTR-UPC             PIC   9(9).              02100012
021100     05  PV-DISPLAY-ADJ-ERR-CDE          PIC   9(04).             02110012
021200     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               02120012
021300     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(09).               02130012
021400     05  PV-DISP-LNE-NBR                 PIC 9(09).               02140012
021500     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               02150012
021600     05  PV-DISP-UPC-NBR                 PIC 9(15).               02160012
021700     05  PV-DISP-STR-NBR                 PIC 9(04).               02170012
021800     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           02180012
021900                                                 VALUE ZEROS.     02190012
022000     05  PV-REC-SEQ-NBR           PIC S9(09) COMP VALUE +0.       02200012
022100     05  PV-CURR-SHIPT-ID         PIC S9(09)  VALUE +0            02210012
022200                                              COMP.               02220012
022300     05  PV-TROUBLE-DESC-ALL.                                     02230012
022400         10  PV-TROUBLE-DESC      PIC X(09).                      02240012
022500         10  PV-TROUBLE-ASTERICK  PIC X(01)   VALUE '*'.          02250012
022600     05  PV-COUNT                 PIC S9(09)  VALUE +0            02260012
022700                                              COMP-3.             02270012
022800     05  PV-PKGNG-CDE            PIC X(01).                       02280012
022900     05  PV-PACK-BY-ST-IND       PIC X(01).                       02290012
023000     05  PV-PRE-TICKET-IND       PIC X(01).                       02300012
023100     05  PV-HANGER-IND           PIC X(01).                       02310012
023200     05  PV-DB2-COUNT             PIC S9(09)  VALUE +0            02320012
023300                                              COMP-3.             02330012
023400     05  PV-WO-INSTR-SEQ-NBR      PIC S9(04)  VALUE +0 COMP.      02340012
023500     05  PV-OPER-SET-ID           PIC S9(04) COMP VALUE +0.       02350012
023600     05  PV-VER-NBR               PIC S9(09) COMP.                02360012
023700                                                                  02370012
023710     05  PV-DISP-OPER-UNIT        PIC  9(04)  VALUE ZERO.         02371029
023721     05  PV-DISP-DFLT-OPER        PIC  9(04)  VALUE ZERO.         02372131
023731                                                                  02373141
023740     05  PV-TRIP-STATUS-CDE       PIC  X(02)  VALUE SPACES.       02374041
023750     05  PV-TRIP-STATUS-TMST      PIC  X(26)  VALUE SPACES.       02375044
023760     05  PV-CURRENT-TMST          PIC  X(26)  VALUE SPACES.       02376041
023900                                                                  02390012
024000     05  PV-BOL-NBR               PIC  X(30).                     02400012
024100     05  PV-NOTIF-NBR                    PIC S9(9) VALUE ZERO     02410012
024200                                                COMP SYNC.        02420012
024300     05  PV-CYC-ADJ-NBR                  PIC S9(9) VALUE ZERO     02430012
024400                                                COMP SYNC.        02440012
024500     05  PV-ARRVD-TIMESTAMP              PIC X(26)   VALUE SPACES.02450012
024600     05  PV-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.02460012
024700     05  PV-FORMAT-TIME                  PIC X(06).               02470012
024800     05  FILLER REDEFINES PV-FORMAT-TIME.                         02480012
024900         10  PV-FORMAT-TIME-HH           PIC  9(02).              02490012
025000         10  PV-FORMAT-TIME-MM           PIC  9(02).              02500012
025100         10  PV-FORMAT-TIME-SS           PIC  9(02).              02510012
025200     05  PV-CURRENT-TIME                 PIC  X(08).              02520012
025300     05  FILLER REDEFINES PV-CURRENT-TIME.                        02530012
025400         10  PV-CURRENT-TIME-HH          PIC  9(02).              02540012
025500         10  PV-CURRENT-TIME-FILL-1      PIC  X(01).              02550012
025600         10  PV-CURRENT-TIME-MM          PIC  9(02).              02560012
025700         10  PV-CURRENT-TIME-FILL-2      PIC  X(01).              02570012
025800         10  PV-CURRENT-TIME-SS          PIC  9(02).              02580012
025900     05  PV-FORMAT-DATE.                                          02590012
026000         10  PV-FORMAT-DATE-YY           PIC  9(02).              02600012
026100         10  PV-FORMAT-DATE-MM           PIC  9(02).              02610012
026200         10  PV-FORMAT-DATE-DD           PIC  9(02).              02620012
026300     05  PV-CURRENT-DATE                 PIC  X(10).              02630012
026400     05  FILLER REDEFINES PV-CURRENT-DATE.                        02640012
026500         10  PV-CURRENT-DATE-CC          PIC  9(02).              02650012
026600         10  PV-CURRENT-DATE-YY          PIC  9(02).              02660012
026700         10  PV-CURRENT-DATE-FILL-1      PIC  X(01).              02670012
026800         10  PV-CURRENT-DATE-MM          PIC  9(02).              02680012
026900         10  PV-CURRENT-DATE-FILL-2      PIC  X(01).              02690012
027000         10  PV-CURRENT-DATE-DD          PIC  9(02).              02700012
027100     05  PV-CASEPACK-DELETED-IND         PIC X(01)   VALUE 'N'.   02710012
027200     05  PV-LK-DTE-ISO.                                           02720012
027300         10  PV-LK-DTE-CCYY              PIC  X(04)  VALUE SPACE. 02730012
027400         10  PV-LK-DTE-MO                PIC  X(02)  VALUE SPACE. 02740012
027500         10  PV-LK-DTE-DD                PIC  X(02)  VALUE SPACE. 02750012
027600     05  PV-ACTL-CTOFF-YYYYMMDD          PIC  X(08).              02760012
027700     05  PV-VERIFY-DTE-YYYYMMDD          PIC  X(08).              02770012
027800     05  PV-CURRENT-DTE-YYYYMMDD         PIC  X(08).              02780012
027900     05  PV-RECEIPT-DTE-YYYYMMDD        PIC  X(08).               02790012
028000     05  PV-DB2-INV-FORMAT               PIC X(10).               02800012
028100     05  PV-BEFORE-QTY                   PIC  S9(9) COMP.         02810012
028200     05  PV-AFTER-QTY                    PIC  S9(9) COMP.         02820012
028300     05  PV-ADJUST-QTY                   PIC  S9(9) COMP.         02830012
028400     05  PV-PO-LNE-NBR                   PIC  S9(9) COMP.         02840012
028500     05  PV-ITM-QTY                      PIC  S9(9) COMP.         02850012
028600     05  PV-ITEM-COUNT-CARTON            PIC S9(09)  VALUE ZERO   02860012
028700                                                     COMP SYNC.   02870012
028800     05  PV-ITEM-COUNT-AUDIT             PIC S9(09)  VALUE ZERO   02880012
028900                                                     COMP SYNC.   02890012
029000     05  PV-AUDIT-INTR-UPC               PIC  S9(9)  COMP.        02900012
029100     05  PV-EXPECT-INTR-UPC              PIC  S9(9)  COMP.        02910012
029200     05  PV-SCND-UNT-QTY                 PIC  S9(9)  COMP.        02920012
029300     05  PV-DIFF-UNT-QTY                 PIC  S9(9)  COMP.        02930012
029400     05  PV-AUDIT-UPC-NBR                PIC  S9(15)V COMP-3.     02940012
029500     05  PV-AUDIT-SHPD-QTY               PIC  S9(9)V COMP-3.      02950012
029600     05  PV-CARTON-UPC-NBR               PIC  S9(15)V COMP-3.     02960012
029700     05  PV-CARTON-SHPD-QTY              PIC  S9(9)V COMP-3.      02970012
029800     05  PV-TODAYS-FISCAL-PERIOD         PIC  9(2).               02980012
029900     05  PV-VERIFY-FISCAL-PERIOD         PIC  9(2).               02990012
030000     05  PV-INPUT-DATE.                                           03000012
030100         10  PV-INPUT-DATE-MM            PIC 9(2)  VALUE ZEROES.  03010012
030200         10  FILLER                      PIC X(1)  VALUE SPACES.  03020012
030300         10  PV-INPUT-DATE-DD            PIC 9(2)  VALUE ZEROES.  03030012
030400         10  FILLER                      PIC X(1)  VALUE SPACES.  03040012
030500         10  PV-INPUT-DATE-CCY           PIC 9(4)  VALUE ZEROES.  03050012
030600     05  PV-COMP-DATE-JULIAN             PIC X(08).               03060012
030700     05  PV-END-DATE-JULIAN              PIC X(08).               03070012
030800     05  PV-VFY-DATE-JULIAN              PIC X(08).               03080012
030900     05  PV-FROM-PARAGRAPH               PIC X(35) VALUE SPACES.  03090012
031000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03100012
031100                                                COMP SYNC.        03110012
031200     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     03120012
031300                                                COMP SYNC.        03130012
031400     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 03140012
031500     05  PV-MISDIRECT-OPER-ID            PIC  9(04) VALUE ZEROES. 03150012
031600     05  PV-MISDIRECT-FA-CREATE-SRCE.                             03160012
031700         10  PV-MIS-FA-CRE-OPER       PIC  X(04)  VALUE SPACE.    03170012
031800         10  PV-MIS-FA-CRE-SYST       PIC  X(04)  VALUE 'PBSM'.   03180012
031900     05  PV-WORK-TMST.                                            03190012
032000         10  PV-WORK-TMST-1.                                      03200012
032100             15  PV-WK-CCYY           PIC  X(04)  VALUE SPACE.    03210012
032200             15  FILLER                   PIC  X(01)  VALUE SPACE.03220012
032300             15  PV-WK-MO                 PIC  X(02)  VALUE SPACE.03230012
032400             15  FILLER                   PIC  X(01)  VALUE SPACE.03240012
032500             15  PV-WK-DA                 PIC  X(02)  VALUE SPACE.03250012
032600         10  PV-WORK-TMST-2.                                      03260012
032700             15  FILLER                   PIC  X(01)  VALUE SPACE.03270012
032800             15  PV-WK-HH                 PIC  X(02)  VALUE SPACE.03280012
032900             15  FILLER                   PIC  X(01)  VALUE SPACE.03290012
033000             15  PV-WK-MM                 PIC  X(02)  VALUE SPACE.03300012
033100             15  FILLER                   PIC  X(01)  VALUE SPACE.03310012
033200             15  PV-WK-SS                 PIC  X(02)  VALUE SPACE.03320012
033300             15  FILLER                   PIC  X(01)  VALUE SPACE.03330012
033400             15  FILLER                   PIC  X(06)  VALUE ZERO. 03340012
033500     05  PV-TMST                      PIC X(26).                  03350012
033600     05  FILLER REDEFINES PV-TMST.                                03360012
033700         10  PV-CCYY                  PIC X(04).                  03370012
033800         10  FILLER                   PIC X(01).                  03380012
033900         10  PV-MM                    PIC X(02).                  03390012
034000         10  FILLER                   PIC X(01).                  03400012
034100         10  PV-DD                    PIC X(02).                  03410012
034200         10  FILLER                   PIC X(01).                  03420012
034300         10  PV-HH                    PIC X(02).                  03430012
034400         10  FILLER                   PIC X(01).                  03440012
034500         10  PV-MIN                   PIC X(02).                  03450012
034600         10  FILLER                   PIC X(01).                  03460012
034700         10  PV-SEC                   PIC X(02).                  03470012
034800         10  FILLER                   PIC X(01).                  03480012
034900         10  FILLER                   PIC X(06).                  03490012
035000*                                                                 03500012
035100     05  PV-22-CURR-PRO-NBR          PIC X(22).                   03510012
035200     05  FILLER REDEFINES PV-22-CURR-PRO-NBR.                     03520012
035300         10  PV-22-CURR-CHAR OCCURS 22 TIMES                      03530012
035400                               INDEXED BY PV-PRO-INDEX.           03540012
035500             15  PV-CURR-CHAR-PRO     PIC X(01).                  03550012
035600*                                                                 03560012
035700     05  PV-VERIFY-CHAR               PIC X(01).                  03570012
035800         88  PV-VALID-CHARACTER      VALUE '0' THRU '9',          03580012
035900                                           'A' THRU 'Z'.          03590012
036000     05  PV-CHAR-COUNT                PIC S9(04)  VALUE ZEROS     03600012
036100                                                    COMP SYNC.    03610012
036200     05  PV-SHIPMT-PRO-NBR               PIC  X(22).              03620012
036300     05  PV-PV-PRO-NBR-22 REDEFINES PV-SHIPMT-PRO-NBR.            03630012
036400         10  PV-PRO-NBR-1                PIC  X(01).              03640012
036500         10  PV-PRO-NBR-2                PIC  X(01).              03650012
036600         10  PV-PRO-NBR-3                PIC  X(01).              03660012
036700         10  PV-PRO-NBR-4                PIC  X(01).              03670012
036800         10  PV-PRO-NBR-5                PIC  X(01).              03680012
036900         10  PV-PRO-NBR-6                PIC  X(01).              03690012
037000         10  PV-PRO-NBR-7                PIC  X(01).              03700012
037100         10  PV-PRO-NBR-8                PIC  X(01).              03710012
037200         10  PV-PRO-NBR-9                PIC  X(01).              03720012
037300         10  PV-PRO-NBR-10               PIC  X(01).              03730012
037400         10  PV-PRO-NBR-11               PIC  X(01).              03740012
037500         10  PV-PRO-NBR-12               PIC  X(01).              03750012
037600         10  PV-PRO-NBR-13               PIC  X(01).              03760012
037700         10  PV-PRO-NBR-14               PIC  X(01).              03770012
037800         10  PV-PRO-NBR-15               PIC  X(01).              03780012
037900         10  PV-PRO-NBR-16               PIC  X(01).              03790012
038000         10  PV-PRO-NBR-17               PIC  X(01).              03800012
038100         10  PV-PRO-NBR-18               PIC  X(01).              03810012
038200         10  PV-PRO-NBR-19               PIC  X(01).              03820012
038300         10  PV-PRO-NBR-20               PIC  X(01).              03830012
038400         10  PV-PRO-NBR-21               PIC  X(01).              03840012
038500         10  PV-PRO-NBR-22               PIC  X(01).              03850012
038600                                                                  03860012
038700 01  ALPHABET-TABLE-VALUES.                                       03870012
038800     05  FILLER                      PIC X(01) VALUE 'A'.         03880012
038900     05  FILLER                      PIC X(01) VALUE 'B'.         03890012
039000     05  FILLER                      PIC X(01) VALUE 'C'.         03900012
039100     05  FILLER                      PIC X(01) VALUE 'D'.         03910012
039200     05  FILLER                      PIC X(01) VALUE 'E'.         03920012
039300     05  FILLER                      PIC X(01) VALUE 'F'.         03930012
039400     05  FILLER                      PIC X(01) VALUE 'G'.         03940012
039500     05  FILLER                      PIC X(01) VALUE 'H'.         03950012
039600     05  FILLER                      PIC X(01) VALUE 'I'.         03960012
039700     05  FILLER                      PIC X(01) VALUE 'J'.         03970012
039800     05  FILLER                      PIC X(01) VALUE 'K'.         03980012
039900     05  FILLER                      PIC X(01) VALUE 'L'.         03990012
040000     05  FILLER                      PIC X(01) VALUE 'M'.         04000012
040100     05  FILLER                      PIC X(01) VALUE 'N'.         04010012
040200     05  FILLER                      PIC X(01) VALUE 'O'.         04020012
040300     05  FILLER                      PIC X(01) VALUE 'P'.         04030012
040400     05  FILLER                      PIC X(01) VALUE 'Q'.         04040012
040500     05  FILLER                      PIC X(01) VALUE 'R'.         04050012
040600     05  FILLER                      PIC X(01) VALUE 'S'.         04060012
040700     05  FILLER                      PIC X(01) VALUE 'T'.         04070012
040800     05  FILLER                      PIC X(01) VALUE 'U'.         04080012
040900     05  FILLER                      PIC X(01) VALUE 'V'.         04090012
041000     05  FILLER                      PIC X(01) VALUE 'W'.         04100012
041100     05  FILLER                      PIC X(01) VALUE 'X'.         04110012
041200     05  FILLER                      PIC X(01) VALUE 'Y'.         04120012
041300     05  FILLER                      PIC X(01) VALUE 'Z'.         04130012
041400                                                                  04140012
041500 01  ALPHABET-TABLE REDEFINES ALPHABET-TABLE-VALUES.              04150012
041600     05  ALPHABET-CHAR                PIC X(01)                   04160012
041700                               OCCURS 26 TIMES                    04170012
041800                               INDEXED BY ALPHA-INDEX.            04180012
041900                                                                  04190012
042000                                                                  04200012
042100 01  PW-PROGRAM-WORKAREA.                                         04210012
042200     05  PW-CONTROL-REC.                                          04220012
042300         10  PW-CONTROL-KEYREC.                                   04230012
042400             20  PW-CONTROL-PANL-NBR.                             04240012
042500                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   04250012
042600                 30  PW-CONTROL-KEYREC-NBR                        04260012
042700                                         PIC 9(02)  VALUE ZERO.   04270012
042800             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  04280012
042900                                       PW-CONTROL-PANL-NBR        04290012
043000                                         PIC 9(7).                04300012
043100             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   04310012
043200         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      04320012
043300                                         PIC 9(08).               04330012
043400         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  04340012
043500                                                                  04350012
043600     05  PW-SAVE-PANEL-NBR               PIC X(7)   VALUE SPACES. 04360012
043700                                                                  04370012
043800     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   04380012
043900     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   04390012
044000                                                                  04400012
044100*---------------------------------------------------------------* 04410012
044200*    DB2 AREA FOR SHIPMENT PO AUDIT TABLE                       * 04420012
044300*---------------------------------------------------------------* 04430012
044400     EXEC SQL                                                     04440012
044500          INCLUDE TAUSHPO                                         04450012
044600     END-EXEC.                                                    04460012
044700                                                                  04470012
044800*----------------------------------------------------------------*04480012
044900*    DB2 AREA FOR WORK ORDER INSTRUCTION TABLE                   *04490012
045000*----------------------------------------------------------------*04500012
045100                                                                  04510012
045200     EXEC SQL                                                     04520012
045300          INCLUDE TWKORIN                                         04530012
045400     END-EXEC.                                                    04540012
045500                                                                  04550012
045600*---------------------------------------------------------------* 04560012
045700*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 04570012
045800*---------------------------------------------------------------* 04580012
045900     EXEC SQL                                                     04590012
046000          INCLUDE TENTNME                                         04600012
046100     END-EXEC.                                                    04610012
046200*---------------------------------------------------------------* 04620012
046300*    DB2 AREA FOR SHIPMENT TABLE                                * 04630012
046400*---------------------------------------------------------------* 04640012
046500     EXEC SQL                                                     04650012
046600          INCLUDE TSHIPMT                                         04660012
046700     END-EXEC.                                                    04670012
046800                                                                  04680012
046900*---------------------------------------------------------------* 04690012
047000*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 04700012
047100*---------------------------------------------------------------* 04710012
047200     EXEC SQL                                                     04720012
047300          INCLUDE TSHIPST                                         04730012
047400     END-EXEC.                                                    04740012
047500                                                                  04750012
047600*---------------------------------------------------------------* 04760012
047700*    DB2 AREA FOR SHIPMENT AUDIT TABLE                          * 04770012
047800*---------------------------------------------------------------* 04780012
047900     EXEC SQL                                                     04790012
048000          INCLUDE TAUSHIP                                         04800012
048100     END-EXEC.                                                    04810012
048200                                                                  04820012
048300*----------------------------------------------------------------*04830012
048400*    DB2 AREA FOR OPERATION SET/FACILITY TABLE                   *04840012
048500*----------------------------------------------------------------*04850012
048600                                                                  04860012
048700     EXEC SQL                                                     04870012
048800          INCLUDE TOSOPFA                                         04880012
048900     END-EXEC.                                                    04890012
049000                                                                  04900012
049100*----------------------------------------------------------------*04910012
049200*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            04920012
049300*----------------------------------------------------------------*04930012
049400     EXEC SQL                                                     04940012
049500          INCLUDE TPOAGMT                                         04950012
049600     END-EXEC.                                                    04960012
049700                                                                  04970012
049800*---------------------------------------------------------------* 04980012
049900*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 04990012
050000*---------------------------------------------------------------* 05000012
050100     EXEC SQL                                                     05010012
050200          INCLUDE TPURCHS                                         05020012
050300     END-EXEC.                                                    05030012
050400                                                                  05040012
050500*----------------------------------------------------------------*05050012
050600*    DB2 AREA FOR WORK ORDER TABLE                               *05060012
050700*----------------------------------------------------------------*05070012
050800                                                                  05080012
050900     EXEC SQL                                                     05090012
051000          INCLUDE TWRKORD                                         05100012
051100     END-EXEC.                                                    05110012
051200                                                                  05120012
051300*----------------------------------------------------------------*05130012
051400*    DB2 AREA FOR OPERATION SET TABLE                            *05140012
051500*----------------------------------------------------------------*05150012
051600                                                                  05160012
051700     EXEC SQL                                                     05170012
051800          INCLUDE TOPRSET                                         05180012
051900     END-EXEC.                                                    05190012
052000                                                                  05200012
052100*---------------------------------------------------------------* 05210012
052200*    DB2 AREA FOR THE COMPANY CONTROL TABLE                     * 05220012
052300*---------------------------------------------------------------* 05230012
052400     EXEC SQL                                                     05240012
052500          INCLUDE TCOCNTL                                         05250012
052600     END-EXEC.                                                    05260012
052700                                                                  05270012
052800*----------------------------------------------------------------*05280012
052900*    DB2 AREA FOR TDCFAAS  DEPT/CLASS FACILITY LOC. ASSIGNMENTS  *05290012
053000*----------------------------------------------------------------*05300012
053100                                                                  05310012
053200     EXEC SQL                                                     05320012
053300          INCLUDE TDCFAAS                                         05330012
053400     END-EXEC.                                                    05340012
053500                                                                  05350012
053600*---------------------------------------------------------------* 05360012
053700*    DB2 AREA FOR PURCHASE ORDER LINE ITEM TABLE                * 05370012
053800*---------------------------------------------------------------* 05380012
053900     EXEC SQL                                                     05390012
054000          INCLUDE TPURITM                                         05400012
054100     END-EXEC.                                                    05410012
054200                                                                  05420012
054300*---------------------------------------------------------------* 05430012
054400*    DB2 AREA FOR RECEIVER TABLE                                * 05440012
054500*---------------------------------------------------------------* 05450012
054600     EXEC SQL                                                     05460012
054700          INCLUDE TRECEIV                                         05470012
054800     END-EXEC.                                                    05480012
054900                                                                  05490012
055000*---------------------------------------------------------------* 05500012
055100*    DB2 AREA FOR SHIPMENT PO TABLE                             * 05510012
055200*---------------------------------------------------------------* 05520012
055300     EXEC SQL                                                     05530012
055400          INCLUDE TSHPTPO                                         05540012
055500     END-EXEC.                                                    05550012
055600                                                                  05560012
055700*---------------------------------------------------------------* 05570012
055800*    DB2 AREA FOR PACKING SLIP TABLE                            * 05580012
055900*---------------------------------------------------------------* 05590012
056000     EXEC SQL                                                     05600012
056100          INCLUDE TPKSLIP                                         05610012
056200     END-EXEC.                                                    05620012
056300                                                                  05630012
056400*---------------------------------------------------------------* 05640012
056500*    DB2 AREA FOR PACKING SLIP TABLE                            * 05650012
056600*---------------------------------------------------------------* 05660012
056700     EXEC SQL                                                     05670012
056800          INCLUDE TINPKSU                                         05680012
056900     END-EXEC.                                                    05690012
057000                                                                  05700012
057100*----------------------------------------------------------------*05710012
057200*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     05720012
057300*----------------------------------------------------------------*05730012
057400     EXEC SQL                                                     05740012
057500          INCLUDE TRECVER                                         05750012
057600     END-EXEC.                                                    05760012
057700                                                                  05770012
057800     EXEC SQL                                                     05780012
057900          INCLUDE TPOSYNC                                         05790012
058000     END-EXEC.                                                    05800012
058100                                                                  05810012
058200*----------------------------------------------------------------*05820012
058300*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                05830012
058400*----------------------------------------------------------------*05840012
058500     EXEC SQL                                                     05850012
058600          INCLUDE TTRBNTF                                         05860012
058700     END-EXEC.                                                    05870012
058800/                                                                 05880012
058900*----------------------------------------------------------------*05890012
059000*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      05900012
059100*----------------------------------------------------------------*05910012
059200     EXEC SQL                                                     05920012
059300          INCLUDE TTRBRSN                                         05930012
059400     END-EXEC.                                                    05940012
059500*                                                                 05950012
059600******************************************************************05960012
059700*  DB2 TABLE DECLARATION - WMS INTEGRATION TYPE                   05970012
059800*      (WST_INTGRTN_TYP)                                          05980012
059900******************************************************************05990012
060000     EXEC SQL                                                     06000012
060100          INCLUDE WST00008                                        06010012
060200     END-EXEC.                                                    06020012
060300                                                                  06030012
060400******************************************************************06040012
060500*  DB2 TABLE DECLARATION - WMS ATTRIBUTE DEFINITION               06050012
060600*      (WST_ATTR_DEFN)                                            06060012
060700******************************************************************06070012
060800     EXEC SQL                                                     06080012
060900          INCLUDE WST00009                                        06090012
061000     END-EXEC.                                                    06100012
061100                                                                  06110012
061200******************************************************************06120012
061300*  DB2 TABLE DECLARATION - WMS ATTRIBUTE ELEMENT                  06130012
061400*      (WST_ATTR_ELEM)                                            06140012
061500******************************************************************06150012
061510     EXEC SQL                                                     06151012
061520          INCLUDE WST00010                                        06152012
061530     END-EXEC.                                                    06153012
061540                                                                  06154012
061550******************************************************************06155012
061560*  SQL AND COBOL DECLARATIONS FOR THE TRIP STATUS TABLE           06156012
061570******************************************************************06157012
061580     EXEC SQL                                                     06158012
061590          INCLUDE TTRIPST                                         06159012
061600     END-EXEC.                                                    06160012
061601                                                                  06160145
061602******************************************************************06160245
061603*  SQL AND COBOL DECLARATIONS FOR THE TRIP STATUS TYPE TABLE      06160345
061604******************************************************************06160445
061605     EXEC SQL                                                     06160545
061606          INCLUDE TTRSTYP                                         06160645
061607     END-EXEC.                                                    06160745
061608                                                                  06160845
061610******************************************************************06161012
061620*  COMMUNICATIONS AREA FOR DB2                                    06162012
061630******************************************************************06163012
061640     EXEC SQL                                                     06164012
061650         INCLUDE SQLCA                                            06165012
061660     END-EXEC.                                                    06166012
061670                                                                  06167012
061680******************************************************************06168012
061690*---------------------------------------------------------------* 06169012
061700******************************************************************06170012
061800 LINKAGE SECTION.                                                 06180012
061900 01  DFHCOMMAREA.                                                 06190012
062000     05  FILLER                         OCCURS  1 TO 4072 TIMES   06200012
062100                                      DEPENDING ON EIBCALEN.      06210012
062200         10  FILLER                   PIC X.                      06220012
062300******************************************************************06230012
062400                                                                  06240012
062500******************************************************************06250012
062600 PROCEDURE DIVISION.                                              06260012
062700******************************************************************06270012
062800                                                                  06280012
062900******************************************************************06290012
063000******************************************************************06300012
063100 0000-PROGRAM-MAINLINE.                                           06310012
063170                                                                  06317043
063200     INITIALIZE                        WS008-COMM-AREA            06320012
063300     INITIALIZE                        PV-PROGRAM-VARIABLES       06330012
063400                                       PS-PROGRAM-SWITCHES.       06340012
063500     MOVE DFHCOMMAREA              TO  WS008-COMM-AREA.           06350012
063600     MOVE WS008-OPER-UNT-ID        TO DK-OPER-UNT-ID.             06360012
063700     SET PS-NO-ERROR TO TRUE.                                     06370012
063710                                                                  06371028
063800     PERFORM 8000-CHECK-FOR-LOGGING.                              06380028
063810                                                                  06381028
063820     PERFORM 1000-CREATE-RECEIVER.                                06382028
063900                                                                  06390012
064000     MOVE WS008-COMM-AREA               TO DFHCOMMAREA.           06400012
064100                                                                  06410012
064200     GOBACK.                                                      06420012
064300                                                                  06430012
064400 1000-CREATE-RECEIVER.                                            06440012
064410                                                                  06441020
064411     IF   PS-LOG-MESSAGE                                          06441120
064412          INITIALIZE  PV-CICS-MSG-AREA                            06441220
064420          STRING   ' WSKCS312-1000-CREATE-RECEIVER        '       06442020
064470                      DELIMITED BY SIZE                           06447020
064480                                      INTO PV-CICS-MSG-AREA       06448020
064490             PERFORM 9999-WRITE-TO-CSSL                           06449020
064491     END-IF.                                                      06449120
064500                                                                  06450012
064600     SET  PS-RECEIVER-NOT-FOUND                                   06460012
064700          PS-LINE-NOT-FOUND                                       06470012
064800          PS-AUTO-APPLY           TO TRUE.                        06480012
064900                                                                  06490012
065000     PERFORM 1100-MOVE-DEFAULT-TO-COMMAREA.                       06500012
065100     PERFORM 4000-GET-ENT-NAME-DESC.                              06510012
065200     PERFORM 2000-CREATE-NEW-SHIPMENT.                            06520012
065300     IF PS-NO-ERROR                                               06530012
065400        PERFORM 1200-ADD-RECEIVER                                 06540012
065500        IF PS-NO-ERROR                                            06550012
065600            MOVE WS008-NEW-REC-SEQ-NBR TO SHPTPO-REC-SEQ-NBR      06560012
065700            MOVE ZEROES          TO SHPTPO-EXPTED-CART-CNT        06570012
065800            PERFORM 6000-INSERT-TSHPTPO                           06580012
065900        END-IF                                                    06590012
066000     END-IF.                                                      06600012
066100                                                                  06610012
066200                                                                  06620012
066300 1100-MOVE-DEFAULT-TO-COMMAREA.                                   06630012
066310                                                                  06631020
066320     IF   PS-LOG-MESSAGE                                          06632020
066330          INITIALIZE  PV-CICS-MSG-AREA                            06633020
066340          STRING   ' WSKCS312-1100-MOVE-DEFAULT-TO-COMMAREA'      06634020
066350                      DELIMITED BY SIZE                           06635020
066360                                      INTO PV-CICS-MSG-AREA       06636020
066370             PERFORM 9999-WRITE-TO-CSSL                           06637020
066380     END-IF.                                                      06638020
066390                                                                  06639020
066400                                                                  06640012
066500* SET PRE TICKET INDICATOR                                        06650012
066600     INITIALIZE PV-DB2-COUNT.                                     06660012
066700     MOVE 4                      TO DK-AGRMT-TYP-ID.              06670012
066800     MOVE 1                      TO DK-TYP-CDE.                   06680012
066900                                                                  06690012
067000     PERFORM 4100-CHECK-PO-SERVICE-INFO.                          06700012
067100                                                                  06710012
067200     IF  PV-DB2-COUNT > +0                                        06720012
067300         MOVE 'Y'                TO PV-PRE-TICKET-IND             06730012
067400     ELSE                                                         06740012
067500         MOVE 'N'                TO PV-PRE-TICKET-IND             06750012
067600     END-IF.                                                      06760012
067700                                                                  06770012
067800                                                                  06780012
067900* SET GARMENT ON HANGER (GOH) INDICATOR                           06790012
068000     INITIALIZE PV-DB2-COUNT.                                     06800012
068100     MOVE 4                      TO DK-AGRMT-TYP-ID.              06810012
068200     MOVE 2                      TO DK-TYP-CDE.                   06820012
068300                                                                  06830012
068400     PERFORM 4100-CHECK-PO-SERVICE-INFO.                          06840012
068500                                                                  06850012
068600     IF  PV-DB2-COUNT > +0                                        06860012
068700         MOVE 'Y'                TO PV-HANGER-IND                 06870012
068800     ELSE                                                         06880012
068900         MOVE 'N'                TO PV-HANGER-IND                 06890012
069000     END-IF.                                                      06900012
069100                                                                  06910012
069200* SET PACK BY STORE INDICATOR                                     06920012
069300     INITIALIZE PV-DB2-COUNT.                                     06930012
069400     MOVE 4                      TO DK-AGRMT-TYP-ID.              06940012
069500     MOVE 4                      TO DK-TYP-CDE.                   06950012
069600                                                                  06960012
069700     PERFORM 4100-CHECK-PO-SERVICE-INFO.                          06970012
069800                                                                  06980012
069900     IF  PV-DB2-COUNT > +0                                        06990012
070000         MOVE 'Y'                TO PV-PACK-BY-ST-IND             07000012
070100     ELSE                                                         07010012
070200         MOVE 'N'                TO PV-PACK-BY-ST-IND             07020012
070300     END-IF.                                                      07030012
070400                                                                  07040012
070500     IF WS008-ORIG-REC-SEQ-NBR > 0                                07050012
070600        PERFORM 4550-PKGNG-CDE-FROM-ORIG-RCVR                     07060012
070700     END-IF                                                       07070012
070800                                                                  07080012
070900     IF PV-PACK-BY-ST-IND NOT = 'Y'                               07090012
071000        PERFORM 4600-PKGNG-CDE-FROM-PO                            07100012
071100     ELSE                                                         07110012
071200         MOVE SPACES                   TO PV-PKGNG-CDE            07120012
071300     END-IF.                                                      07130012
071400                                                                  07140012
071500 1200-ADD-RECEIVER.                                               07150012
071510                                                                  07151020
071520     IF   PS-LOG-MESSAGE                                          07152020
071530          INITIALIZE  PV-CICS-MSG-AREA                            07153020
071540          STRING   ' WSKCS312-1200-ADD-RECEIVER            '      07154020
071550                      DELIMITED BY SIZE                           07155020
071560                                      INTO PV-CICS-MSG-AREA       07156020
071570             PERFORM 9999-WRITE-TO-CSSL                           07157020
071580     END-IF.                                                      07158020
071590                                                                  07159020
071600                                                                  07160012
071700     MOVE WS008-PO-NUMBER    TO DK-PO-NBR.                        07170012
071800     MOVE WS008-NEW-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                07180012
071900     MOVE WS008-SCAC-ID      TO DK-SCAC-ID.                       07190012
072000     MOVE WS008-OPER-UNT-ID  TO DK-OPER-UNT-ID.                   07200012
072010     MOVE 1                  TO DK-FCLTY-ID.                      07201034
072100                                                                  07210012
072200     IF  PS-NO-ERROR                                              07220012
072300         PERFORM 4700-GET-MAX-SEQ-NBR                             07230012
072400         PERFORM 1300-BUILD-RECEIVER-INFO                         07240012
072500         IF  PS-NO-ERROR                                          07250012
072600             PERFORM 1400-BUILD-ZERO-LINE-WORK-ORD                07260012
072700         END-IF                                                   07270012
072800     END-IF.                                                      07280012
072900                                                                  07290012
073000     IF  PS-NO-ERROR                                              07300012
073100         IF TM500-NO-TROUBLE                                      07310012
073200             MOVE 391                TO DP020-MSG-NUMBER          07320012
073300             MOVE WS008-NEW-REC-SEQ-NBR TO DP020-MSG-TEXT         07330012
073400         ELSE                                                     07340012
073500             MOVE 847                TO DP020-MSG-NUMBER          07350012
073600             MOVE WS008-NEW-REC-SEQ-NBR TO DP020-MSG-TEXT         07360012
073700                                        DK-REC-SEQ-NBR            07370012
074500         END-IF                                                   07450012
074600         SET DP020-MSG-INFORMATIONAL                              07460012
074700                                 TO TRUE                          07470012
074800     END-IF.                                                      07480012
074900                                                                  07490012
075000*---------------------------------------------------------------* 07500012
075100*  LOAD THE RECEIV FIELDS, PERFORM THE INSERT TO THE TRECEIV    * 07510012
075200*  TABLE, AND CHECK FOR TROUBLE.                                * 07520012
075300*---------------------------------------------------------------* 07530012
075400 1300-BUILD-RECEIVER-INFO.                                        07540012
075419                                                                  07541943
075420     IF   PS-LOG-MESSAGE                                          07542020
075430          INITIALIZE  PV-CICS-MSG-AREA                            07543020
075440          STRING   ' WSKCS312-1300-BUILD-RECEIVER-INFO     '      07544020
075450                      DELIMITED BY SIZE                           07545020
075460                                      INTO PV-CICS-MSG-AREA       07546020
075470             PERFORM 9999-WRITE-TO-CSSL                           07547020
075480     END-IF.                                                      07548020
075490                                                                  07549020
075500                                                                  07550012
075600     INITIALIZE DCLTRECEIV.                                       07560012
075700                                                                  07570012
075800     MOVE WS008-PO-NUMBER        TO RECEIV-ORD-NBR.               07580012
075900     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            07590012
076000                                    RECEIV-REFER-BACK-SEQ-NBR     07600012
076100                                    WS008-NEW-REC-SEQ-NBR.        07610012
076200     MOVE PV-VER-NBR             TO RECEIV-PO-VER-NBR.            07620012
076300                                                                  07630012
076400     MOVE 1                      TO RECEIV-FCLTY-ID.              07640012
076500     MOVE 'IP'                   TO RECEIV-STATUS-CDE.            07650012
076600     MOVE 'P'                    TO RECEIV-SYST-CRE-CDE.          07660012
076700     MOVE 'MR'                   TO RECEIV-REC-TYP-CDE.           07670012
076800     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        07680012
076900     MOVE PV-HANGER-IND          TO RECEIV-GOH-IND.               07690012
077000     MOVE PV-PRE-TICKET-IND      TO RECEIV-PRE-TKT-IND.           07700012
077100     MOVE PV-PACK-BY-ST-IND      TO RECEIV-PACK-BY-ST-IND.        07710012
077200     MOVE ZERO                   TO RECEIV-EXPTED-CART-CNT.       07720012
077300     MOVE ZERO                   TO RECEIV-ACTL-CART-CNT.         07730012
077400     MOVE '9999-09-09'           TO RECEIV-AP-PRC-DTE.            07740012
077500     MOVE '9999-09-09-09.09.09.999999'                            07750012
077600                                 TO RECEIV-ML-POST-TMST           07760012
077700                                    RECEIV-FS-POST-TMST           07770012
077800                                    RECEIV-IN-TRBL-TMST           07780012
077900                                    RECEIV-VERFYD-TMST            07790012
078000                                    RECEIV-MKNG-APRN-PRT-TMST.    07800012
078100     PERFORM 3000-SEL-ARRVD-TRIP-TMST.                            07810012
078190                                                                  07819047
078200     MOVE PV-ARRVD-TIMESTAMP      TO RECEIV-REC-TMST.             07820012
078300                                                                  07830012
078400     MOVE WS008-OPER-UNT-ID       TO RECEIV-CURR-OPER-UNT-ID      07840012
078500     MOVE WS008-OPER-UNT-ID       TO RECEIV-OPER-UNT-ID           07850012
078600                                     RECEIV-CRE-OPER-UNT-ID       07860012
078700                                                                  07870012
078800     MOVE 1                       TO RECEIV-CURR-FCLTY-ID         07880012
078900                                     RECEIV-CRE-FCLTY-ID.         07890012
079000     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID            07900012
079100                                     RECEIV-UPD-UID               07910038
079110                                     RECEIV-CRE-UID.              07911038
079200     MOVE PV-PKGNG-CDE            TO RECEIV-PKGNG-CDE.            07920012
079300                                                                  07930012
079400     MOVE SPACES                 TO RECEIV-RCVG-CLERK-INIT-ID.    07940012
079500     MOVE 'Y'                    TO RECEIV-FRE-ASTRA-IND          07950012
079600                                                                  07960012
079700     SET PS-RCVR-FOUND TO TRUE.                                   07970012
079800     PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   07980012
079900          PV-COUNT > 10 OR PS-NO-RCVR-FOUND                       07990012
080000         PERFORM 5000-OPEN-TRECVER-CSR                            08000012
080100         PERFORM 5020-FETCH-TRECVER-CSR                           08010012
080200                                                                  08020012
080300         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       08030012
080400         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     08040012
080500                                       REMAINDER  PW-REMAINDER    08050012
080600         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      08060012
080700         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        08070012
080800         ADD +1                    TO RECVER-MAX-RCVR-NBR         08080012
080900         PERFORM 5040-DELETE-TRECVER-CSR                          08090012
081000         PERFORM 5060-INSERT-TRECVER                              08100012
081100         PERFORM 5080-CLOSE-TRECVER-CSR                           08110012
081200     END-PERFORM.                                                 08120012
081300                                                                  08130012
081400     IF  PS-NO-ERROR                                              08140012
081500         PERFORM 4800-INSERT-TRECEIV                              08150012
081600         IF SQLCODE = ZERO                                        08160012
081700             PERFORM 4900-INSERT-TPOSYNC                          08170012
081800         END-IF                                                   08180012
081900     END-IF.                                                      08190012
082000                                                                  08200012
082100                                                                  08210012
082200 1400-BUILD-ZERO-LINE-WORK-ORD.                                   08220012
082210                                                                  08221020
082220     IF   PS-LOG-MESSAGE                                          08222020
082230          INITIALIZE  PV-CICS-MSG-AREA                            08223020
082240          STRING   ' WSKCS312-1400-BUILD-ZERO-LINE-WORK-ORD'      08224020
082250                      DELIMITED BY SIZE                           08225020
082260                                      INTO PV-CICS-MSG-AREA       08226020
082270             PERFORM 9999-WRITE-TO-CSSL                           08227020
082280     END-IF.                                                      08228020
082290                                                                  08229020
082300                                                                  08230012
082400     INITIALIZE DCLTWRKORD.                                       08240012
082500                                                                  08250012
082600****  IF THIS IS A MISDIRECT THE WS008-OPER-UNT-ID IS THE         08260012
082700****  CURRENT OPER AND THE CARTON OPER IS THE ORIGINAL            08270012
082800****  THE DK-OPER CONTAINS THE CURRENT OPER                       08280012
082900                                                                  08290012
082920     IF   PS-LOG-MESSAGE                                          08292029
082921          MOVE WS008-OPER-UNT-ID  TO  PV-DISP-OPER-UNIT           08292129
082922          MOVE PV-OPER-SET-ID     TO  PV-DISP-OPER-SET            08292229
082930          INITIALIZE  PV-CICS-MSG-AREA                            08293029
082940          STRING   ' WSKCS312-1400-'                              08294029
082941                   ' OPER-UNIT: '  PV-DISP-OPER-UNIT              08294129
082942                   ' OPER-SET: '   PV-DISP-OPER-SET               08294229
082950                      DELIMITED BY SIZE                           08295029
082960                                      INTO PV-CICS-MSG-AREA       08296029
082970             PERFORM 9999-WRITE-TO-CSSL                           08297029
082980     END-IF.                                                      08298029
082990                                                                  08299029
083000     MOVE WS008-OPER-UNT-ID      TO WRKORD-OPER-UNT-ID            08300012
083100                                                                  08310012
083200     IF  PV-OPER-SET-ID  = ZERO                                   08320012
083300         PERFORM 5300-GET-OPER-SET-INFO                           08330012
083400         IF  SQLCODE = +0                                         08340012
083500             MOVE DCFAAS-OPER-SET-ID   TO PV-OPER-SET-ID          08350012
083600                                          DK-OPER-SET-ID          08360012
083700         ELSE                                                     08370012
083800             PERFORM 5500-GET-OPER-SET-ID                         08380012
083900                MOVE COCNTL-DFLT-OPER-SET-ID                      08390012
084000                                       TO PV-OPER-SET-ID          08400012
084100                                          DK-OPER-SET-ID          08410012
084200             PERFORM 5200-VALIDATE-OPER-SET-ID                    08420012
084300         END-IF                                                   08430012
084400     ELSE                                                         08440012
084500         MOVE PV-OPER-SET-ID   TO DK-OPER-SET-ID                  08450012
084600     END-IF.                                                      08460012
084700                                                                  08470012
084710** DMH - 11/11/14 BEGIN                                           08471029
084720     IF   PS-LOG-MESSAGE                                          08472029
084730          MOVE WS008-OPER-UNT-ID  TO  PV-DISP-OPER-UNIT           08473029
084740          MOVE PV-OPER-SET-ID     TO  PV-DISP-OPER-SET            08474029
084750          INITIALIZE  PV-CICS-MSG-AREA                            08475029
084760          STRING   ' WSKCS312-1400-'                              08476029
084770                   ' OPER-UNIT: '  PV-DISP-OPER-UNIT              08477029
084780                   ' OPER-SET: '   PV-DISP-OPER-SET               08478029
084790                      DELIMITED BY SIZE                           08479029
084791                                      INTO PV-CICS-MSG-AREA       08479129
084792             PERFORM 9999-WRITE-TO-CSSL                           08479229
084793     END-IF.                                                      08479329
084794** DMH - 11/11/14 BEGIN                                           08479429
084795                                                                  08479529
084800     MOVE WS008-PO-NUMBER        TO WRKORD-ORD-NBR.               08480012
084900     MOVE WS008-NEW-REC-SEQ-NBR  TO WRKORD-RCVR-SEQ-NBR.          08490012
085000                                                                  08500012
085100     MOVE 1                      TO WRKORD-FCLTY-ID.              08510012
085200     MOVE +1                     TO WRKORD-WORK-ORD-SEQ-NBR.      08520012
085300     MOVE ZERO                   TO WRKORD-ACTL-CART-CNT.         08530012
085400     MOVE +1                     TO WRKORD-EXPTED-CART-CNT.       08540012
085500     MOVE 'A'                    TO WRKORD-VER-STATUS-CDE.        08550012
085600     MOVE 'IP'                   TO WRKORD-STAT-CDE.              08560012
085700     MOVE 'N'                    TO WRKORD-WORK-ORD-DISTR-IND.    08570012
085800* WHEN CREATING A F/A RECEIVER AND WORK ORDER, THE OPER SET       08580012
085900* MUST BE 700.  4/18/2010 MARJ HOEFS                              08590012
086000     IF WS008-SKU-LVL-RCVING                                      08600012
086100         MOVE PC-OPER-SET-700        TO WRKORD-OPER-SET-ID        08610012
086110     ELSE                                                         08611012
086120         MOVE PV-OPER-SET-ID         TO WRKORD-OPER-SET-ID        08612012
086130     END-IF.                                                      08613012
086140                                                                  08614012
086141* DMH - 04/28/15 - BEGIN                                          08614135
086142* ADDED MOVE OF WRKORD-OPER-SET-ID FIELD TO MAKE SURE THAT        08614235
086143* THE SAME OPER SET ID IS USED FOR TWRKORD & TWKORIN TABLES       08614335
086144*                                                                 08614435
086145     MOVE WRKORD-OPER-SET-ID         TO DK-OPER-SET-ID.           08614535
086146* DMH - 04/28/15 - BEGIN                                          08614635
086147                                                                  08614735
086150     PERFORM 5600-INACTIVATE-TWRKORD.                             08615012
086160     PERFORM 5700-INSERT-TWRKORD.                                 08616012
086170                                                                  08617012
086180     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR.          08618012
086190     MOVE 'N'                    TO PS-TOSOPFA-CURSOR-SW.         08619012
086200     MOVE 'Y'                    TO PS-INSTRUCTION-SW.            08620012
086300                                                                  08630012
086400     PERFORM 5800-OPEN-TOSOPFA-CSR.                               08640012
086500     PERFORM 5820-FETCH-TOSOPFA-CSR.                              08650012
086600                                                                  08660012
086700     PERFORM UNTIL PS-EOF-TOSOPFA-CSR                             08670012
086800        PERFORM 5900-BUILD-WORK-ORDER-INSTR                       08680012
086900        PERFORM 5820-FETCH-TOSOPFA-CSR                            08690012
087000     END-PERFORM.                                                 08700012
087100                                                                  08710012
087200     PERFORM 5840-CLOSE-TOSOPFA-CSR.                              08720012
087300                                                                  08730012
087400                                                                  08740012
087500 2000-CREATE-NEW-SHIPMENT.                                        08750012
087510                                                                  08751020
087520     IF   PS-LOG-MESSAGE                                          08752020
087530          INITIALIZE  PV-CICS-MSG-AREA                            08753020
087540          STRING   ' WSKCS312-2000-CREATE-NEW-SHIPMENT     '      08754020
087550                      DELIMITED BY SIZE                           08755020
087560                                      INTO PV-CICS-MSG-AREA       08756020
087570             PERFORM 9999-WRITE-TO-CSSL                           08757020
087580     END-IF.                                                      08758020
087590                                                                  08759020
087600     PERFORM 2100-GET-RANDOM-NUMBER.                              08760012
087700     PERFORM 4200-READ-DUPL-TSHIPMT                               08770012
087800          WITH TEST AFTER                                         08780012
087900          UNTIL PV-SHIPMT-COUNT = 0.                              08790012
088000                                                                  08800012
088100     MOVE WS008-SHIPT-UNT-ID    TO DK-SHIPT-UNT-ID.               08810012
088200     PERFORM 4300-SELECT-SHIP-DATE.                               08820012
088300                                                                  08830012
088400     IF SQLCODE = +100                                            08840012
088500        EXEC SQL                                                  08850012
088600            SET :PKSLIP-VEND-SHIP-DTE = CURRENT_DATE              08860012
088700        END-EXEC                                                  08870012
088800     END-IF                                                       08880012
088900                                                                  08890012
089000     MOVE WS008-PO-NUMBER       TO DK-PO-NBR.                     08900011
089100     MOVE WS008-ORIG-REC-SEQ-NBR                                  08910011
089200                                TO DK-REC-SEQ-NBR.                08920011
089300     MOVE WS008-ORIG-PRO-NBR TO SHIPMT-PRO-NBR.                   08930011
089320     MOVE WS008-CAN-ORIG     TO SHIPMT-CARR-AUTH-ID.              08932013
089330                                                                  08933049
089400     PERFORM 4450-CHK-SCAC-PRO-BOL.                               08940011
089500     IF PS-PRO-BOL-SCAC-EXISTS                                    08950011
089600        PERFORM 4460-CREATE-NEW-PRO                               08960011
089700     END-IF.                                                      08970011
089800     MOVE DK-CURR-SHIPT-ID      TO PV-CURR-SHIPT-ID.              08980011
089900                                                                  08990011
090000     PERFORM 4500-INSERT-TSHIPMT.                                 09000011
090100                                                                  09010011
090200 2100-GET-RANDOM-NUMBER.                                          09020011
090210                                                                  09021020
090218                                                                  09021843
090220     IF   PS-LOG-MESSAGE                                          09022020
090230          INITIALIZE  PV-CICS-MSG-AREA                            09023020
090240          STRING   ' WSKCS312-2100-GET-RANDOM-NUMBER       '      09024020
090250                      DELIMITED BY SIZE                           09025020
090260                                      INTO PV-CICS-MSG-AREA       09026020
090270             PERFORM 9999-WRITE-TO-CSSL                           09027020
090280     END-IF.                                                      09028020
090290                                                                  09029020
090300     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     09030039
090400                                                                  09040011
092400     CALL PC-RANDNBR-PGM USING DFHEIBLK                           09240040
092410                               DFHCOMMAREA                        09241040
092420                               DP902-RANDNBR-ROUTINE-FIELDS.      09242040
092500                                                                  09250011
092600     IF  DP902-SUCCESSFUL                                         09260039
092700         NEXT SENTENCE                                            09270011
092800     ELSE                                                         09280011
092900         STRING                                                   09290011
093000              ' 2100-  RET CDE = '                                09300011
093100              DP902-RETURN-CODE                                   09310039
093200                         DELIMITED BY SIZE                        09320011
093300                       INTO WS008-CRA-RET-MSG                     09330011
093400         MOVE SQLCA     TO WS008-SQLCA                            09340011
093500         SET WS008-INVALID-SQL TO TRUE                            09350011
093600     END-IF.                                                      09360011
093700  EJECT                                                           09370011
093800                                                                  09380011
093900 3000-SEL-ARRVD-TRIP-TMST.                                        09390011
093910                                                                  09391020
093920     IF   PS-LOG-MESSAGE                                          09392020
093921          MOVE WS008-TRIP-ID   TO  PV-DISP-TRIP-ID                09392123
093930          INITIALIZE  PV-CICS-MSG-AREA                            09393020
093940          STRING   ' WSKCS312-3000-SEL-ARRVD-TRIP-TMST     '      09394020
093941                   ' TRIP:'  PV-DISP-TRIP-ID                      09394121
093950                      DELIMITED BY SIZE                           09395020
093960                                      INTO PV-CICS-MSG-AREA       09396020
093970             PERFORM 9999-WRITE-TO-CSSL                           09397020
093980     END-IF.                                                      09398020
093990                                                                  09399020
094000                                                                  09400011
094100       EXEC SQL                                                   09410011
094200         SELECT TIMESTAMP(STATUS_DTE,STATUS_TME)                  09420011
094300           INTO :PV-ARRVD-TIMESTAMP                               09430011
094400           FROM TTRIPST A                                         09440011
094500          WHERE A.TRIP_ID            =  :WS008-TRIP-ID            09450011
094600            AND A.TRIP_STATUS_CDE    =  'AR'                      09460011
094610           WITH UR                                                09461041
094700       END-EXEC                                                   09470011
094800                                                                  09480011
094900       EVALUATE TRUE                                              09490011
095000           WHEN SQLCODE = +0                                      09500011
095100                CONTINUE                                          09510011
095200           WHEN SQLCODE = +100                                    09520011
095300                PERFORM 3010-SEL-CURRENT-TRIP-TMST                09530041
095400           WHEN SQLWARN0 NOT = SPACES                             09540011
095500           WHEN SQLCODE < +0                                      09550011
095600           WHEN SQLCODE > +0                                      09560011
095610               MOVE WS008-TRIP-ID   TO  PV-DISP-TRIP-ID           09561023
095700               MOVE WS008-PO-NUMBER TO  PV-DISP-PO-NBR            09570021
095800               MOVE SQLCODE TO PV-DISP-SQLCODE                    09580011
095900               STRING                                             09590011
096000                    ' 3000- SQL:' PV-DISP-SQLCODE                 09600021
096200                    ' PO:'        PV-DISP-PO-NBR                  09620021
096300                    ' TRIP:'      PV-DISP-TRIP-ID                 09630021
096400                               DELIMITED BY SIZE                  09640011
096500                             INTO WS008-CRA-RET-MSG               09650011
096600               MOVE SQLCA     TO WS008-SQLCA                      09660011
096700               SET WS008-INVALID-SQL TO TRUE                      09670011
096701                                                                  09670121
096710               INITIALIZE  PV-CICS-MSG-AREA                       09671021
096720               STRING                                             09672021
096721                    ' WSKCS312-3000- '                            09672121
096722                    ' SQL:' PV-DISP-SQLCODE                       09672221
096723                    ' PO:'        PV-DISP-PO-NBR                  09672321
096724                    ' TRIP:'      PV-DISP-TRIP-ID                 09672421
096740                      DELIMITED BY SIZE                           09674021
096750                                      INTO PV-CICS-MSG-AREA       09675021
096760               PERFORM 9999-WRITE-TO-CSSL                         09676021
096770                                                                  09677021
096800       END-EVALUATE.                                              09680011
096900                                                                  09690011
096910 3010-SEL-CURRENT-TRIP-TMST.                                      09691041
096920                                                                  09692041
096930     IF   PS-LOG-MESSAGE                                          09693041
096940          MOVE WS008-TRIP-ID   TO  PV-DISP-TRIP-ID                09694041
096950          INITIALIZE  PV-CICS-MSG-AREA                            09695041
096960          STRING   ' WSKCS312-3010-SEL-CURRENT-TRIP-TMST   '      09696041
096970                   ' TRIP:'  PV-DISP-TRIP-ID                      09697041
096980                      DELIMITED BY SIZE                           09698041
096990                                      INTO PV-CICS-MSG-AREA       09699041
096991             PERFORM 9999-WRITE-TO-CSSL                           09699141
096992     END-IF.                                                      09699241
096994                                                                  09699441
096995       EXEC SQL                                                   09699541
096996         SELECT A.TRIP_STATUS_CDE                                 09699646
096997              , TIMESTAMP(A.STATUS_DTE,A.STATUS_TME)              09699746
096998              , CURRENT TIMESTAMP                                 09699841
096999           INTO :PV-TRIP-STATUS-CDE                               09699941
097002              , :PV-TRIP-STATUS-TMST                              09700241
097003              , :PV-CURRENT-TMST                                  09700341
097004           FROM TTRIPST A                                         09700441
097005              , TTRSTYP B                                         09700541
097006          WHERE A.TRIP_ID            =  :WS008-TRIP-ID            09700641
097007            AND A.TRIP_STATUS_CDE    =  B.TRIP_STATUS_CDE         09700741
097008            AND B.PRTY_CDE  IN                                    09700841
097009                (SELECT MAX(BB.PRTY_CDE)                          09700941
097010                   FROM TTRIPST AA                                09701041
097011                      , TTRSTYP BB                                09701141
097012                  WHERE A.TRIP_ID          =  AA.TRIP_ID          09701241
097013                    AND AA.TRIP_STATUS_CDE = BB.TRIP_STATUS_CDE)  09701341
097014           WITH UR                                                09701441
097015       END-EXEC.                                                  09701541
097016                                                                  09701641
097017       EVALUATE TRUE                                              09701741
097018           WHEN SQLCODE = +0                                      09701841
097019                IF  PV-TRIP-STATUS-CDE NOT = 'EN'                 09701942
097021                    MOVE PV-CURRENT-TMST TO PV-ARRVD-TIMESTAMP    09702141
097022                ELSE                                              09702241
097023                    MOVE PC-DEFAULT-TMST TO PV-ARRVD-TIMESTAMP    09702341
097024                END-IF                                            09702441
097025           WHEN SQLCODE = +100                                    09702541
097026                MOVE PC-DEFAULT-TMST TO PV-ARRVD-TIMESTAMP        09702641
097027           WHEN SQLWARN0 NOT = SPACES                             09702741
097028           WHEN SQLCODE < +0                                      09702841
097029           WHEN SQLCODE > +0                                      09702941
097030               MOVE WS008-TRIP-ID   TO  PV-DISP-TRIP-ID           09703041
097031               MOVE WS008-PO-NUMBER TO  PV-DISP-PO-NBR            09703141
097032               MOVE SQLCODE TO PV-DISP-SQLCODE                    09703241
097033               STRING                                             09703341
097034                    ' 3010- SQL:' PV-DISP-SQLCODE                 09703441
097035                    ' PO:'        PV-DISP-PO-NBR                  09703541
097036                    ' TRIP:'      PV-DISP-TRIP-ID                 09703641
097037                               DELIMITED BY SIZE                  09703741
097038                             INTO WS008-CRA-RET-MSG               09703841
097039               MOVE SQLCA     TO WS008-SQLCA                      09703941
097040               SET WS008-INVALID-SQL TO TRUE                      09704041
097041                                                                  09704141
097042               INITIALIZE  PV-CICS-MSG-AREA                       09704241
097043               STRING                                             09704341
097044                    ' WSKCS312-3010- '                            09704441
097045                    ' SQL:' PV-DISP-SQLCODE                       09704541
097046                    ' PO:'        PV-DISP-PO-NBR                  09704641
097047                    ' TRIP:'      PV-DISP-TRIP-ID                 09704741
097048                      DELIMITED BY SIZE                           09704841
097049                                      INTO PV-CICS-MSG-AREA       09704941
097050               PERFORM 9999-WRITE-TO-CSSL                         09705041
097051                                                                  09705141
097052       END-EVALUATE.                                              09705241
097053                                                                  09705341
097054 4000-GET-ENT-NAME-DESC.                                          09705441
097063                                                                  09706343
097064     IF   PS-LOG-MESSAGE                                          09706441
097065          INITIALIZE  PV-CICS-MSG-AREA                            09706541
097066          STRING   ' WSKCS312-4000-GET-ENT-NAME-DESC       '      09706641
097067                      DELIMITED BY SIZE                           09706741
097068                                      INTO PV-CICS-MSG-AREA       09706820
097070             PERFORM 9999-WRITE-TO-CSSL                           09707020
097080     END-IF.                                                      09708020
097090                                                                  09709020
097100                                                                  09710011
097200                                                                  09720011
097300         EXEC SQL                                                 09730011
097400              SELECT A.DEPT_NBR                                   09740011
097500                 ,   A.VER_NBR                                    09750011
097600                 ,   B.ENT_NAME_DESC                              09760011
097700                 ,   B.ENT_ID                                     09770011
097800                INTO :PURCHS-DEPT-NBR                             09780011
097900                 ,   :PURCHS-VER-NBR                              09790011
098000                 ,   :ENTNME-ENT-NAME-DESC                        09800011
098100                 ,   :ENTNME-ENT-ID                               09810011
098200                FROM TPURCHS A                                    09820011
098300                    ,TENTNME B                                    09830011
098400               WHERE A.PO_NBR         = :DK-PO-NBR                09840011
098500                 AND A.VER_STATUS_CDE = 'A'                       09850011
098600                 AND B.TYPE_CDE       = '01'                      09860011
098700                 AND A.ENT_ID = B.ENT_ID                          09870011
098710                WITH UR                                           09871021
098800         END-EXEC                                                 09880011
098900                                                                  09890011
099000         EVALUATE TRUE                                            09900011
099100             WHEN SQLCODE = +0                                    09910011
099200                  MOVE PURCHS-DEPT-NBR                            09920011
099300                                  TO DK-DEPT-NBR                  09930011
099400                  MOVE PURCHS-VER-NBR                             09940011
099500                                  TO PV-VER-NBR                   09950011
099600             WHEN SQLCODE = +100                                  09960011
099700                  MOVE SPACES     TO DK-DEPT-NBR                  09970011
099800                  MOVE +1         TO PV-VER-NBR                   09980011
099900                                                                  09990011
100000             WHEN SQLCODE = -904                                  10000011
100100             WHEN SQLCODE = -913                                  10010011
100200                  CONTINUE                                        10020011
100300                                                                  10030011
100400             WHEN SQLWARN0 NOT = SPACES                           10040011
100500             WHEN SQLCODE < +0                                    10050011
100600             WHEN SQLCODE > +0                                    10060011
100700                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           10070011
100800                 MOVE SQLCODE TO PV-DISP-SQLCODE                  10080011
100900                 STRING                                           10090011
101000                      ' 4000- SQL:' PV-DISP-SQLCODE               10100021
101200                      ' PO:'        PV-DISP-PO-NBR                10120021
101400                                 DELIMITED BY SIZE                10140011
101500                               INTO WS008-CRA-RET-MSG             10150011
101600                 MOVE SQLCA     TO WS008-SQLCA                    10160011
101700                 SET WS008-INVALID-SQL TO TRUE                    10170011
101710                                                                  10171021
101720               INITIALIZE  PV-CICS-MSG-AREA                       10172021
101730               STRING                                             10173021
101740                    ' WSKCS312-4000- '                            10174021
101750                    ' SQL:'       PV-DISP-SQLCODE                 10175021
101760                    ' PO:'        PV-DISP-PO-NBR                  10176021
101780                      DELIMITED BY SIZE                           10178021
101790                                      INTO PV-CICS-MSG-AREA       10179021
101791               PERFORM 9999-WRITE-TO-CSSL                         10179121
101792                                                                  10179221
101800         END-EVALUATE.                                            10180011
101900                                                                  10190011
102000                                                                  10200011
102100*----------------------------------------------------------------*10210011
102200*    CHECK TO SEE WHAT TYPES OF SERVICES THIS PO HAS             *10220011
102300*----------------------------------------------------------------*10230011
102400 4100-CHECK-PO-SERVICE-INFO.                                      10240011
102410                                                                  10241020
102420     IF   PS-LOG-MESSAGE                                          10242020
102430          INITIALIZE  PV-CICS-MSG-AREA                            10243020
102440          STRING   ' WSKCS312-4100-CHECK-PO-SERVICE-INFO   '      10244020
102450                      DELIMITED BY SIZE                           10245020
102460                                      INTO PV-CICS-MSG-AREA       10246020
102470             PERFORM 9999-WRITE-TO-CSSL                           10247020
102480     END-IF.                                                      10248020
102490                                                                  10249020
102500     MOVE WS008-PO-NUMBER    TO DK-PO-NBR.                        10250011
102600                                                                  10260011
102700                                                                  10270011
102800         EXEC SQL                                                 10280011
102900              SELECT COUNT(*)                                     10290011
103000                INTO :PV-DB2-COUNT                                10300011
103100                FROM TPOAGMT                                      10310011
103200               WHERE PO_NBR         = :DK-PO-NBR                  10320011
103300                 AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID            10330011
103400                 AND VER_STATUS_CDE = 'A'                         10340011
103500                 AND TYP_CDE        = :DK-TYP-CDE                 10350011
103510                WITH UR                                           10351021
103600         END-EXEC                                                 10360011
103700                                                                  10370011
103800         EVALUATE TRUE                                            10380011
103900             WHEN SQLCODE = +0                                    10390011
104000             WHEN SQLCODE = +100                                  10400011
104100             WHEN SQLCODE = -904                                  10410011
104200             WHEN SQLCODE = -913                                  10420011
104300                  CONTINUE                                        10430011
104400                                                                  10440011
104500             WHEN SQLWARN0 NOT = SPACES                           10450011
104600             WHEN SQLCODE < +0                                    10460011
104700             WHEN SQLCODE > +0                                    10470011
104800                 MOVE SQLCODE          TO PV-DISP-SQLCODE         10480021
104900                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          10490011
105000                 MOVE DK-TYP-CDE       TO PV-DISP-TYP-CDE         10500011
105100                 STRING                                           10510011
105200                      ' 4100- SQL:' PV-DISP-SQLCODE               10520021
105500                      ' PO:'        PV-DISP-PO-NBR                10550021
105600                      ' AGRMT TYP:' DK-AGRMT-TYP-ID               10560021
105900                      ' TYP CDE:'   PV-DISP-TYP-CDE               10590021
106000                                 DELIMITED BY SIZE                10600011
106100                               INTO WS008-CRA-RET-MSG             10610011
106200                 MOVE SQLCA     TO WS008-SQLCA                    10620011
106300                 SET WS008-INVALID-SQL TO TRUE                    10630011
106310                                                                  10631021
106320                 INITIALIZE  PV-CICS-MSG-AREA                     10632021
106330                 STRING                                           10633021
106340                      ' WSKCS312-4100- '                          10634021
106350                      ' SQL:'       PV-DISP-SQLCODE               10635021
106360                      ' PO:'        PV-DISP-PO-NBR                10636021
106361                      ' AGRMT TYP:' DK-AGRMT-TYP-ID               10636121
106362                      ' TYP CDE:'   PV-DISP-TYP-CDE               10636221
106370                                    DELIMITED BY SIZE             10637021
106380                               INTO PV-CICS-MSG-AREA              10638021
106390                 PERFORM 9999-WRITE-TO-CSSL                       10639021
106391                                                                  10639121
106400         END-EVALUATE.                                            10640011
106500                                                                  10650011
106600                                                                  10660011
106700 4200-READ-DUPL-TSHIPMT.                                          10670011
106718                                                                  10671843
106720     IF   PS-LOG-MESSAGE                                          10672020
106730          INITIALIZE  PV-CICS-MSG-AREA                            10673020
106740          STRING   ' WSKCS312-4200-READ-DUPL-TSHIPMT       '      10674020
106750                      DELIMITED BY SIZE                           10675020
106760                                      INTO PV-CICS-MSG-AREA       10676020
106770             PERFORM 9999-WRITE-TO-CSSL                           10677020
106780     END-IF.                                                      10678020
106790                                                                  10679020
106800                                                                  10680011
106900     MOVE DP902-RANDOM-NUMBER   TO DK-CURR-SHIPT-ID.              10690039
107000                                                                  10700011
107100     PERFORM                                                      10710011
107200         WITH TEST AFTER                                          10720011
107300         VARYING PV-RETRY-COUNTER                                 10730011
107400         FROM 1 BY 1                                              10740011
107500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10750011
107600             OR (SQLCODE = +0))                                   10760011
107700                                                                  10770011
107800         EXEC SQL                                                 10780011
107900              SELECT COUNT(*)                                     10790011
108000               INTO :PV-SHIPMT-COUNT                              10800011
108100                FROM  TSHIPMT                                     10810011
108200               WHERE (SHIPT_ID        = :DK-CURR-SHIPT-ID)        10820011
108300         END-EXEC                                                 10830011
108400                                                                  10840011
108500         EVALUATE TRUE                                            10850011
108600             WHEN SQLCODE = +0                                    10860011
108700             WHEN SQLCODE = -904                                  10870011
108800             WHEN SQLCODE = -913                                  10880011
108900                 CONTINUE                                         10890011
109000                                                                  10900011
109100             WHEN SQLWARN0 NOT = SPACES                           10910011
109200             WHEN SQLCODE < +0                                    10920011
109300             WHEN SQLCODE > +0                                    10930011
109400                 MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID        10940011
109500                 MOVE SQLCODE          TO PV-DISP-SQLCODE         10950021
109600                 STRING                                           10960011
109700                      ' 4200-  SQL:' PV-DISP-SQLCODE              10970021
109900                      ' SHIPT ID:'   PV-DISP-SHIPT-ID             10990021
110100                                 DELIMITED BY SIZE                11010011
110200                               INTO WS008-CRA-RET-MSG             11020011
110300                 MOVE SQLCA     TO WS008-SQLCA                    11030011
110400                 SET WS008-INVALID-SQL TO TRUE                    11040011
110410                                                                  11041021
110420                 INITIALIZE  PV-CICS-MSG-AREA                     11042021
110430                 STRING                                           11043021
110440                      ' WSKCS312-4200- '                          11044021
110450                      ' SQL:'       PV-DISP-SQLCODE               11045021
110451                      ' SHIPT ID:'   PV-DISP-SHIPT-ID             11045121
110490                                    DELIMITED BY SIZE             11049021
110491                               INTO PV-CICS-MSG-AREA              11049121
110492                 PERFORM 9999-WRITE-TO-CSSL                       11049221
110493                                                                  11049321
110500         END-EVALUATE                                             11050011
110600     END-PERFORM.                                                 11060011
110700                                                                  11070011
110800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11080011
110900             AND (SQLCODE NOT = +0)                               11090011
111000         MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID                11100011
111100         MOVE SQLCODE          TO PV-DISP-SQLCODE                 11110021
111200         STRING                                                   11120011
111300              ' 4200-  SQL:' PV-DISP-SQLCODE                      11130021
111500              ' SHIPT ID = ' PV-DISP-SHIPT-ID                     11150021
111700                         DELIMITED BY SIZE                        11170011
111800                       INTO WS008-CRA-RET-MSG                     11180011
111900         MOVE SQLCA     TO WS008-SQLCA                            11190011
112000         SET WS008-INVALID-SQL TO TRUE                            11200011
112010                                                                  11201021
112020                 INITIALIZE  PV-CICS-MSG-AREA                     11202021
112030                 STRING                                           11203021
112040                      ' WSKCS312-4200- '                          11204021
112050                      ' SQL:'       PV-DISP-SQLCODE               11205021
112060                      ' SHIPT ID:'   PV-DISP-SHIPT-ID             11206021
112070                                    DELIMITED BY SIZE             11207021
112080                               INTO PV-CICS-MSG-AREA              11208021
112090                 PERFORM 9999-WRITE-TO-CSSL                       11209021
112091                                                                  11209121
112100     END-IF.                                                      11210011
112200                                                                  11220011
112300     IF PV-SHIPMT-COUNT > 0                                       11230011
112400         PERFORM 2100-GET-RANDOM-NUMBER                           11240011
112500     END-IF.                                                      11250011
112600/                                                                 11260011
112700                                                                  11270011
112800 4300-SELECT-SHIP-DATE.                                           11280011
112810                                                                  11281020
112820     IF   PS-LOG-MESSAGE                                          11282020
112830          INITIALIZE  PV-CICS-MSG-AREA                            11283020
112840          STRING   ' WSKCS312-4300-SELECT-SHIP-DATE        '      11284020
112850                      DELIMITED BY SIZE                           11285020
112860                                      INTO PV-CICS-MSG-AREA       11286020
112870             PERFORM 9999-WRITE-TO-CSSL                           11287020
112880     END-IF.                                                      11288020
112890                                                                  11289020
112900                                                                  11290011
113000     EXEC SQL                                                     11300011
113100          SELECT  DISTINCT B.VEND_SHIP_DTE                        11310011
113200            INTO  :PKSLIP-VEND-SHIP-DTE                           11320011
113300            FROM  TINPKSU A                                       11330011
113400              ,   TPKSLIP B                                       11340011
113500           WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID             11350011
113600             AND  A.PO_NBR         = B.PO_NBR                     11360011
113700             AND  A.SEQ_NBR        = B.SEQ_NBR                    11370011
113800             AND  B.VER_STAT_CDE   = 'A'                          11380011
113900     END-EXEC.                                                    11390011
114000                                                                  11400011
114100     EVALUATE TRUE                                                11410011
114200         WHEN SQLCODE = ZERO                                      11420011
114210         WHEN SQLCODE = +100                                      11421011
114220              CONTINUE                                            11422011
114230         WHEN SQLWARN0 NOT = SPACES                               11423011
114240         WHEN SQLCODE < ZERO                                      11424011
114250         WHEN SQLCODE > ZERO                                      11425011
114260              MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SHIPT-UNT-ID       11426021
114270              MOVE SQLCODE TO PV-DISP-SQLCODE                     11427011
114280              STRING                                              11428011
114290                   ' 4300-  SQL:' PV-DISP-SQLCODE                 11429021
114400                   ' SHIPT UNT:'  PV-DISP-SHIPT-UNT-ID            11440021
114600                              DELIMITED BY SIZE                   11460011
114700                            INTO WS008-CRA-RET-MSG                11470011
114800              MOVE SQLCA     TO WS008-SQLCA                       11480011
114900              SET WS008-INVALID-SQL TO TRUE                       11490011
114910                                                                  11491021
114920              INITIALIZE  PV-CICS-MSG-AREA                        11492021
114930              STRING                                              11493021
114940                      ' WSKCS312-4200- '                          11494021
114950                      ' SQL:'       PV-DISP-SQLCODE               11495021
114951                      ' SHIPT UNT:' PV-DISP-SHIPT-UNT-ID          11495121
114970                                    DELIMITED BY SIZE             11497021
114980                               INTO PV-CICS-MSG-AREA              11498021
114990              PERFORM 9999-WRITE-TO-CSSL                          11499021
114991                                                                  11499121
115000     END-EVALUATE.                                                11500011
115100                                                                  11510011
115200 4450-CHK-SCAC-PRO-BOL.                                           11520011
115210                                                                  11521020
115220     IF   PS-LOG-MESSAGE                                          11522020
115230          INITIALIZE  PV-CICS-MSG-AREA                            11523020
115240          STRING   ' WSKCS312-4450-CHK-SCAC-PRO-BOL        '      11524020
115250                      DELIMITED BY SIZE                           11525020
115260                                      INTO PV-CICS-MSG-AREA       11526020
115270             PERFORM 9999-WRITE-TO-CSSL                           11527020
115280     END-IF.                                                      11528020
115290                                                                  11529020
115300                                                                  11530011
115400     EXEC SQL                                                     11540011
115500      SELECT  DISTINCT                                            11550037
115501              B.PRO_NBR                                           11550137
115510             ,B.CARR_AUTH_ID                                      11551020
115600         INTO :SHIPMT-PRO-NBR                                     11560011
115610             ,:SHIPMT-CARR-AUTH-ID                                11561020
115700      FROM    TSHPTPO A                                           11570011
115800             ,TSHIPMT B                                           11580011
115900      WHERE A.PO_NBR         = :DK-PO-NBR                         11590011
116000        AND A.PRIM_SHIPT_IND = 'Y'                                11600011
116100        AND A.SHIPT_ID       = B.SHIPT_ID                         11610011
116200        AND B.BOL_NBR        = :WS008-ORIG-BOL-NBR                11620011
116300        AND B.PRO_NBR        = :SHIPMT-PRO-NBR                    11630011
116400        AND B.TRIP_ID        = :WS008-TRIP-ID                     11640011
116500     END-EXEC.                                                    11650012
116600                                                                  11660012
116700     EVALUATE TRUE                                                11670011
116800         WHEN SQLCODE = +0                                        11680011
116900             SET PS-PRO-BOL-SCAC-EXISTS TO TRUE                   11690011
117000         WHEN SQLCODE = +100                                      11700011
117100             SET PS-PRO-BOL-SCAC-NOT-EXISTS TO TRUE               11710011
117200             MOVE SHIPMT-PRO-NBR      TO WS008-NEW-PRO-NBR        11720013
117210             MOVE SHIPMT-CARR-AUTH-ID TO WS008-CAN-NEW            11721014
117220                                                                  11722049
117300         WHEN SQLWARN0 NOT = SPACE                                11730011
117400         WHEN SQLCODE < +0                                        11740011
117500         WHEN SQLCODE > +0                                        11750011
117600             MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SHIPT-UNT-ID        11760021
117700             MOVE SQLCODE          TO PV-DISP-SQLCODE             11770021
117710             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              11771024
117720             MOVE WS008-TRIP-ID    TO PV-DISP-TRIP-ID             11772021
117800             STRING                                               11780011
117900                  ' 4450-  SQL:'  PV-DISP-SQLCODE                 11790021
118100                  ' SHIPT UNT:'   PV-DISP-SHIPT-UNT-ID            11810021
118110                  ' TRIP:'        PV-DISP-TRIP-ID                 11811021
118120                  ' PO:'          PV-DISP-PO-NBR                  11812021
118130                  ' PRO:'         SHIPMT-PRO-NBR                  11813021
118300                             DELIMITED BY SIZE                    11830011
118400                           INTO WS008-CRA-RET-MSG                 11840011
118500             MOVE SQLCA     TO WS008-SQLCA                        11850011
118600             SET WS008-INVALID-SQL TO TRUE                        11860011
118601                                                                  11860121
118610             INITIALIZE  PV-CICS-MSG-AREA                         11861021
118620             STRING   ' WSKCS312-4450-'                           11862021
118621                      ' SQL:'         PV-DISP-SQLCODE             11862121
118622                      ' SHIPT UNT:'   PV-DISP-SHIPT-UNT-ID        11862221
118623                      ' TRIP:'        PV-DISP-TRIP-ID             11862321
118624                      ' PO:'          PV-DISP-PO-NBR              11862421
118625                      ' PRO:'         SHIPMT-PRO-NBR              11862521
118630                                           DELIMITED BY SIZE      11863021
118640                                      INTO PV-CICS-MSG-AREA       11864021
118650             PERFORM 9999-WRITE-TO-CSSL                           11865021
118700     END-EVALUATE.                                                11870011
118800                                                                  11880011
118900 4460-CREATE-NEW-PRO.                                             11890011
118910                                                                  11891020
118920     IF   PS-LOG-MESSAGE                                          11892020
118930          INITIALIZE  PV-CICS-MSG-AREA                            11893020
118940          STRING   ' WSKCS312-4460-CREATE-NEW-PRO          '      11894020
118950                      DELIMITED BY SIZE                           11895020
118960                                      INTO PV-CICS-MSG-AREA       11896020
118970             PERFORM 9999-WRITE-TO-CSSL                           11897020
118980     END-IF.                                                      11898020
118990                                                                  11899020
119000                                                                  11900011
119100     IF WS008-ORIG-PRO-NBR > SPACES                               11910011
119200         MOVE WS008-ORIG-PRO-NBR  TO  PV-22-CURR-PRO-NBR          11920011
119300         SET PV-PRO-INDEX  TO 1                                   11930011
119400         PERFORM 4470-PROCESS-PRO-CHARACTERS                      11940011
119500             VARYING PV-PRO-INDEX FROM 1 BY 1                     11950011
119600             UNTIL PV-PRO-INDEX > 22 OR                           11960011
119700             PS-PRO-BOL-SCAC-NOT-EXISTS                           11970011
119800     ELSE                                                         11980011
119900        MOVE PC-WM-UNKNOWN TO WS008-NEW-PRO-NBR                   11990011
120000     END-IF.                                                      12000011
120100                                                                  12010011
120210     IF WS008-CAN-ORIG     > SPACES                               12021017
120220         MOVE WS008-CAN-ORIG TO WS008-CAN-NEW                     12022018
120280     ELSE                                                         12028017
120290        MOVE PC-WM-UNKNOWN   TO WS008-CAN-NEW                     12029019
120291     END-IF.                                                      12029117
120292                                                                  12029249
120300                                                                  12030011
120400 4470-PROCESS-PRO-CHARACTERS.                                     12040011
120410                                                                  12041020
120420     IF   PS-LOG-MESSAGE                                          12042020
120430          INITIALIZE  PV-CICS-MSG-AREA                            12043020
120440          STRING   ' WSKCS312-4470-PROCESS-PRO-CHARACTERS  '      12044020
120450                      DELIMITED BY SIZE                           12045020
120460                                      INTO PV-CICS-MSG-AREA       12046020
120470             PERFORM 9999-WRITE-TO-CSSL                           12047020
120480     END-IF.                                                      12048020
120490                                                                  12049020
120500     MOVE PV-CURR-CHAR-PRO (PV-PRO-INDEX) TO PV-VERIFY-CHAR.      12050011
120600     IF PV-VALID-CHARACTER                                        12060011
120700         CONTINUE                                                 12070011
120800     ELSE                                                         12080011
120900       PERFORM 4480-CHECK-FOR-EXISTING-PRO                        12090011
121000           VARYING ALPHA-INDEX FROM 1 BY 1                        12100011
121100           UNTIL ALPHA-INDEX  > 26 OR                             12110011
121200           PS-PRO-BOL-SCAC-NOT-EXISTS                             12120011
121300     END-IF.                                                      12130011
121400                                                                  12140011
121500 4480-CHECK-FOR-EXISTING-PRO.                                     12150011
121510                                                                  12151020
121520     IF   PS-LOG-MESSAGE                                          12152020
121530          INITIALIZE  PV-CICS-MSG-AREA                            12153020
121540          STRING   ' WSKCS312-4480-CHECK-FOR-EXISTING-PRO  '      12154020
121550                      DELIMITED BY SIZE                           12155020
121560                                      INTO PV-CICS-MSG-AREA       12156020
121570             PERFORM 9999-WRITE-TO-CSSL                           12157020
121580     END-IF.                                                      12158020
121590                                                                  12159020
121600      MOVE ALPHABET-CHAR (ALPHA-INDEX) TO                         12160011
121700                        PV-CURR-CHAR-PRO (PV-PRO-INDEX)           12170011
121800                                                                  12180011
121900      MOVE PV-22-CURR-PRO-NBR TO SHIPMT-PRO-NBR                   12190011
122000      PERFORM 4450-CHK-SCAC-PRO-BOL.                              12200011
122100                                                                  12210011
122200                                                                  12220011
122300 4500-INSERT-TSHIPMT.                                             12230011
122310                                                                  12231020
122320     IF   PS-LOG-MESSAGE                                          12232020
122330          INITIALIZE  PV-CICS-MSG-AREA                            12233020
122340          STRING   ' WSKCS312-4500-INSERT-TSHIPMT          '      12234020
122350                      DELIMITED BY SIZE                           12235020
122360                                      INTO PV-CICS-MSG-AREA       12236020
122370             PERFORM 9999-WRITE-TO-CSSL                           12237020
122380     END-IF.                                                      12238020
122390                                                                  12239020
122400     INITIALIZE DCLTSHIPMT.                                       12240011
122500                                                                  12250011
122600     MOVE WS008-TRIP-ID            TO SHIPMT-TRIP-ID.             12260011
122700     MOVE PV-CURR-SHIPT-ID         TO SHIPMT-SHIPT-ID.            12270011
122800     MOVE 'PA'                     TO SHIPMT-CRT-SRC-CDE.         12280011
122900     MOVE WS008-SCAC-ID            TO SHIPMT-PRO-SCAC-ID          12290011
123000                                      SHIPMT-ORIG-SCAC-ID.        12300011
123100* ADDED CONDITIONAL SETTING OF PRO NBR VARIABLES BELOW.           12310011
123200* 4/18/2010 MARJ HOEFS                                            12320011
123300     IF WS008-SKU-LVL-RCVING                                      12330011
123310         MOVE PC-WM-UNKNOWN        TO SHIPMT-PRO-NBR              12331011
123320                                      SHIPMT-COMPLETE-PRO-NBR     12332011
123330     ELSE                                                         12333011
123340         MOVE WS008-NEW-PRO-NBR    TO SHIPMT-PRO-NBR              12334011
123350                                      SHIPMT-COMPLETE-PRO-NBR     12335011
123351** CLT 12-13-2011 WR40574 START                                   12335113
123352         MOVE WS008-CAN-NEW        TO SHIPMT-CARR-AUTH-ID         12335214
123353** CLT 12-13-2011 WR40574 ENDRT                                   12335313
123360     END-IF.                                                      12336011
123370     MOVE WS008-ORIG-BOL-NBR       TO SHIPMT-BOL-NBR              12337011
123380                                      SHIPMT-COMPLETE-BOL-NBR.    12338011
123390     MOVE +1                       TO SHIPMT-SHIPT-TYP-CDE.       12339011
123400     MOVE 'CTN'                    TO SHIPMT-PKG-TYP-CDE          12340011
123500     MOVE SPACES                   TO SHIPMT-FRGT-TERMS-CDE       12350011
123600     MOVE +1                       TO SHIPMT-EXPTED-PKG-QTY.      12360011
123700     MOVE ZEROES                   TO SHIPMT-FRGT-CHG-AMT         12370011
123800                                      SHIPMT-EXPTED-PLT-QTY       12380011
123900     MOVE PKSLIP-VEND-SHIP-DTE     TO SHIPMT-VEND-SHIP-DTE.       12390011
124000                                                                  12400011
124100     MOVE PC-CURRENT-PROGRAM-NAME  TO SHIPMT-LAST-UPD-PGM-ID.     12410011
124200     MOVE '0001-01-01'             TO SHIPMT-CARR-LAST-UPD-DTE    12420011
124300                                      SHIPMT-CONFIRM-DTE          12430011
124400                                      SHIPMT-PROCESSED-DTE        12440011
124500                                      SHIPMT-VEND-LAST-UPD-DTE.   12450011
124600     MOVE '00.00.00'               TO SHIPMT-CARR-LAST-UPD-TIME   12460011
124700                                      SHIPMT-CONFIRM-TIME         12470011
124800                                      SHIPMT-VEND-LAST-UPD-TIME.  12480011
124900     MOVE ZEROES                   TO SHIPMT-CARR-CART-CT         12490011
125000                                      SHIPMT-VEND-CART-CT.        12500011
125100*    MOVE WS008-VEH-NBR            TO SHIPMT-VEH-NBR.             12510011
125200     MOVE SPACES                   TO SHIPMT-AUTH-NBR.            12520011
125300     MOVE '0001-01-01'             TO SHIPMT-AUTH-DTE.            12530011
125400                                                                  12540011
125410** CLT 12-13-2011 WR40574 ADD CARR_AUTH_ID BELOW                  12541015
125500     PERFORM                                                      12550011
125600         WITH TEST AFTER                                          12560011
125700         VARYING PV-RETRY-COUNTER                                 12570011
125800         FROM 1 BY 1                                              12580011
125900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12590011
126000             OR (SQLCODE = +0))                                   12600011
126100                                                                  12610011
126200         EXEC SQL                                                 12620011
126300             INSERT  INTO TSHIPMT                                 12630011
126400                   ( TRIP_ID                                      12640011
126500                    ,SHIPT_ID                                     12650011
126600                    ,CRT_SRC_CDE                                  12660011
126700                    ,LAST_UPD_UID                                 12670011
126800                    ,PRO_SCAC_ID                                  12680011
126900                    ,PRO_NBR                                      12690011
127000                    ,BOL_NBR                                      12700011
127100                    ,SHIPPER_NME                                  12710011
127200                    ,SHIPT_TYP_CDE                                12720011
127300                    ,PKG_TYP_CDE                                  12730011
127400                    ,EXPTED_PKG_QTY                               12740011
127500                    ,FRGT_CHG_AMT                                 12750011
127600                    ,FRGT_TERMS_CDE                               12760011
127700                    ,EXPTED_PLT_QTY                               12770011
127800                    ,VEND_SHIP_DTE                                12780011
127900                    ,EST_AR_TMST                                  12790011
128000                    ,ORIG_SCAC_ID                                 12800011
128100                    ,LAST_UPD_PGM_ID                              12810011
128200                    ,CRE_USER_ID                                  12820011
128300                    ,CARR_CART_CT                                 12830011
128400                    ,CARR_LAST_UPD_DTE                            12840011
128500                    ,CARR_LAST_UPD_TIME                           12850011
128600                    ,VEND_CART_CT                                 12860011
128700                    ,VEND_LAST_UPD_DTE                            12870011
128800                    ,VEND_LAST_UPD_TIME                           12880011
128900                    ,VEH_NBR                                      12890011
129000                    ,AUTH_NBR                                     12900011
129100                    ,AUTH_DTE                                     12910011
129200                    ,CONFIRM_DTE                                  12920011
129300                    ,CONFIRM_TIME                                 12930011
129400                    ,COMPLETE_PRO_NBR                             12940011
129500                    ,COMPLETE_BOL_NBR                             12950011
129600                    ,PROCESSED_DTE                                12960015
129610                    ,CARR_AUTH_ID  )                              12961015
129700             VALUES                                               12970011
129800                   ( :SHIPMT-TRIP-ID                              12980011
129900                    ,:SHIPMT-SHIPT-ID                             12990011
130000                    ,:SHIPMT-CRT-SRC-CDE                          13000011
130100                    ,:WS008-SIGNON-USER-ID                        13010011
130200                    ,:SHIPMT-PRO-SCAC-ID                          13020011
130300                    ,:SHIPMT-PRO-NBR                              13030011
130400                    ,:SHIPMT-BOL-NBR                              13040011
130500                    ,:SHIPMT-SHIPPER-NME                          13050011
130600                    ,:SHIPMT-SHIPT-TYP-CDE                        13060011
130700                    ,:SHIPMT-PKG-TYP-CDE                          13070011
130800                    ,:SHIPMT-EXPTED-PKG-QTY                       13080011
130900                    ,:SHIPMT-FRGT-CHG-AMT                         13090011
131000                    ,:SHIPMT-FRGT-TERMS-CDE                       13100011
131100                    ,:SHIPMT-EXPTED-PLT-QTY                       13110011
131200                    ,:SHIPMT-VEND-SHIP-DTE                        13120011
131300                    ,CURRENT TIMESTAMP                            13130011
131400                    ,:SHIPMT-ORIG-SCAC-ID                         13140011
131500                    ,:PC-CURRENT-PROGRAM-NAME                     13150011
131600                    ,:WS008-SIGNON-USER-ID                        13160011
131700                    ,:SHIPMT-CARR-CART-CT                         13170011
131800                    ,:PC-DEFAULT-DATE                             13180011
131900                    ,:PC-DEFAULT-TIME                             13190011
132000                    ,:SHIPMT-VEND-CART-CT                         13200011
132100                    ,:PC-DEFAULT-DATE                             13210011
132200                    ,:PC-DEFAULT-TIME                             13220011
132300                    ,:SHIPMT-VEH-NBR                              13230011
132400                    ,:SHIPMT-AUTH-NBR                             13240011
132500                    ,:SHIPMT-AUTH-DTE                             13250011
132600                    ,:PC-DEFAULT-DATE                             13260011
132700                    ,:PC-DEFAULT-TIME                             13270011
132800                    ,:SHIPMT-COMPLETE-PRO-NBR                     13280011
132900                    ,:SHIPMT-COMPLETE-BOL-NBR                     13290011
133000                    ,:SHIPMT-PROCESSED-DTE                        13300015
133010                    ,:SHIPMT-CARR-AUTH-ID )                       13301015
133100         END-EXEC                                                 13310011
133200                                                                  13320011
133300         EVALUATE TRUE                                            13330011
133400             WHEN SQLCODE = +0                                    13340011
133500             WHEN SQLCODE = -904                                  13350011
133600             WHEN SQLCODE = -913                                  13360011
133700                 CONTINUE                                         13370011
133800                                                                  13380011
133900             WHEN SQLWARN0 NOT = SPACES                           13390011
134000             WHEN SQLCODE < +0                                    13400011
134100             WHEN SQLCODE > +0                                    13410011
134200                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         13420011
134300                 MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID          13430011
134400                 MOVE SQLCODE         TO PV-DISP-SQLCODE          13440021
134500                 STRING                                           13450011
134600                      ' 4500- SQL:'   PV-DISP-SQLCODE             13460021
134800                      ' SHPMT:'       PV-DISP-SHIPT-ID            13480021
135100                      ' TRIP:'        PV-DISP-TRIP-ID             13510021
135200                                 DELIMITED BY SIZE                13520011
135300                               INTO WS008-CRA-RET-MSG             13530011
135400                 MOVE SQLCA     TO WS008-SQLCA                    13540011
135500                 SET WS008-INVALID-SQL TO TRUE                    13550011
135510                                                                  13551021
135520             INITIALIZE  PV-CICS-MSG-AREA                         13552021
135530             STRING   ' WSKCS312-4500-'                           13553021
135540                      ' SQL:'         PV-DISP-SQLCODE             13554021
135550                      ' SHPMT:'       PV-DISP-SHIPT-ID            13555021
135560                      ' TRIP:'        PV-DISP-TRIP-ID             13556021
135580                      ' PRO:'         SHIPMT-PRO-NBR              13558021
135590                                           DELIMITED BY SIZE      13559021
135591                                      INTO PV-CICS-MSG-AREA       13559121
135592             PERFORM 9999-WRITE-TO-CSSL                           13559221
135600         END-EVALUATE                                             13560011
135700     END-PERFORM.                                                 13570011
135800                                                                  13580011
135900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13590011
136000             AND (SQLCODE NOT = +0)                               13600011
136100         MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID                 13610011
136200         MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID                  13620011
136300         MOVE SQLCODE TO PV-DISP-SQLCODE                          13630011
136400         STRING                                                   13640011
136500              ' 4500- MAX RETRIES SQL:' PV-DISP-SQLCODE           13650021
136700              ' SHPMT:'                 PV-DISP-SHIPT-ID          13670021
137000              ' TRIP:'                  PV-DISP-TRIP-ID           13700021
137100                         DELIMITED BY SIZE                        13710011
137200                       INTO WS008-CRA-RET-MSG                     13720011
137300         MOVE SQLCA     TO WS008-SQLCA                            13730011
137400         SET WS008-INVALID-SQL TO TRUE                            13740011
137410                                                                  13741021
137420         INITIALIZE  PV-CICS-MSG-AREA                             13742021
137430         STRING                                                   13743021
137440                      ' WSKCS312-4500- MAX RETRIES'               13744022
137450                      ' SQL:'       PV-DISP-SQLCODE               13745021
137451                      ' SHPMT:'     PV-DISP-SHIPT-ID              13745121
137452                      ' TRIP:'      PV-DISP-TRIP-ID               13745221
137470                                    DELIMITED BY SIZE             13747021
137480                               INTO PV-CICS-MSG-AREA              13748021
137490         PERFORM 9999-WRITE-TO-CSSL                               13749021
137491                                                                  13749121
137500     END-IF.                                                      13750011
137600                                                                  13760011
137700     EVALUATE TRUE                                                13770011
137800         WHEN SQLCODE = ZERO                                      13780011
137900              PERFORM 6100-INSERT-TSHIPST                         13790011
138000              PERFORM 6200-INSERT-TAUSHIP                         13800011
138100     END-EVALUATE.                                                13810011
138200                                                                  13820011
138300 4550-PKGNG-CDE-FROM-ORIG-RCVR.                                   13830011
138310                                                                  13831020
138320     IF   PS-LOG-MESSAGE                                          13832020
138330          INITIALIZE  PV-CICS-MSG-AREA                            13833020
138340          STRING   ' WSKCS312-4550-PKGNG-CDE-FROM-ORIG-RCVR'      13834020
138350                      DELIMITED BY SIZE                           13835020
138360                                      INTO PV-CICS-MSG-AREA       13836020
138370             PERFORM 9999-WRITE-TO-CSSL                           13837020
138380     END-IF.                                                      13838020
138390                                                                  13839020
138400                                                                  13840011
138500     MOVE WS008-PO-NUMBER    TO DK-PO-NBR.                        13850011
138600                                                                  13860011
138700     PERFORM                                                      13870011
138800         WITH TEST AFTER                                          13880011
138900         VARYING PV-RETRY-COUNTER                                 13890011
139000         FROM 1 BY 1                                              13900011
139100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13910011
139200             OR (SQLCODE = +0)                                    13920011
139300             OR (SQLCODE = +100))                                 13930011
139400                                                                  13940011
139500         EXEC SQL                                                 13950011
139600             SELECT PACK_BY_ST_IND                                13960011
139700               INTO :PV-PACK-BY-ST-IND                            13970011
139800               FROM TRECEIV                                       13980011
139900               WHERE ORD_NBR        = :DK-PO-NBR                  13990011
140000                 AND REC_SEQ_NBR    = :WS008-ORIG-REC-SEQ-NBR     14000011
140100                 AND VER_STATUS_CDE = 'A'                         14010011
140200         END-EXEC                                                 14020011
140300                                                                  14030011
140400         EVALUATE TRUE                                            14040011
140500             WHEN SQLCODE = +0                                    14050011
140600             WHEN SQLCODE = +100                                  14060011
140700                 CONTINUE                                         14070011
140800             WHEN SQLCODE = -904                                  14080011
140900             WHEN SQLCODE = -913                                  14090011
141000                 CONTINUE                                         14100011
141100             WHEN SQLWARN0 NOT = SPACES                           14110011
141200             WHEN SQLCODE < +0                                    14120011
141300             WHEN SQLCODE > +0                                    14130011
141400                 MOVE SQLCODE          TO PV-DISP-SQLCODE         14140021
141500                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          14150011
141510                 MOVE WS008-ORIG-REC-SEQ-NBR                      14151021
141520                                       TO PV-DISP-REC-SEQ         14152021
141600                 STRING                                           14160011
141700                      ' 4550- SQL:'   PV-DISP-SQLCODE             14170021
142000                      ' PO:'          PV-DISP-PO-NBR              14200021
142010                      ' RCVR:'        PV-DISP-REC-SEQ             14201021
142100                                 DELIMITED BY SIZE                14210011
142200                               INTO WS008-CRA-RET-MSG             14220011
142300                 MOVE SQLCA     TO WS008-SQLCA                    14230011
142400                 SET WS008-INVALID-SQL TO TRUE                    14240011
142410                                                                  14241021
142420                 INITIALIZE  PV-CICS-MSG-AREA                     14242021
142430                 STRING                                           14243021
142440                      ' WSKCS312-4550- '                          14244021
142450                      ' SQL:'       PV-DISP-SQLCODE               14245021
142451                      ' PO:'        PV-DISP-PO-NBR                14245121
142452                      ' RCVR:'      PV-DISP-REC-SEQ               14245221
142480                                    DELIMITED BY SIZE             14248021
142490                               INTO PV-CICS-MSG-AREA              14249021
142491                 PERFORM 9999-WRITE-TO-CSSL                       14249121
142492                                                                  14249221
142500         END-EVALUATE                                             14250011
142600     END-PERFORM.                                                 14260011
142700                                                                  14270011
142800                                                                  14280011
142900 4600-PKGNG-CDE-FROM-PO.                                          14290011
142910                                                                  14291020
142920     IF   PS-LOG-MESSAGE                                          14292020
142930          INITIALIZE  PV-CICS-MSG-AREA                            14293020
142940          STRING   ' WSKCS312-4600-PKGNG-CDE-FROM-PO       '      14294020
142950                      DELIMITED BY SIZE                           14295020
142960                                      INTO PV-CICS-MSG-AREA       14296020
142970             PERFORM 9999-WRITE-TO-CSSL                           14297020
142980     END-IF.                                                      14298020
142990                                                                  14299020
143000     MOVE WS008-PO-NUMBER    TO DK-PO-NBR.                        14300011
143100     PERFORM                                                      14310011
143200         WITH TEST AFTER                                          14320011
143300         VARYING PV-RETRY-COUNTER                                 14330011
143400         FROM 1 BY 1                                              14340011
143500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14350011
143600             OR (SQLCODE = +0)                                    14360011
143700             OR (SQLCODE = +100))                                 14370011
143800                                                                  14380011
143900         EXEC SQL                                                 14390011
144000             SELECT PKGNG_CDE                                     14400011
144100               INTO :PURCHS-PKGNG-CDE                             14410011
144200               FROM TPURCHS A                                     14420011
144300               WHERE A.PO_NBR = :DK-PO-NBR                        14430011
144400                   AND VER_STATUS_CDE = 'A'                       14440011
144500         END-EXEC                                                 14450011
144600                                                                  14460011
144700         EVALUATE TRUE                                            14470011
144800             WHEN SQLCODE = +0                                    14480011
144900                 MOVE PURCHS-PKGNG-CDE                            14490011
145000                          TO PV-PKGNG-CDE                         14500011
145100             WHEN SQLCODE = +100                                  14510011
145200                 MOVE SPACES TO PV-PKGNG-CDE                      14520011
145300             WHEN SQLCODE = -904                                  14530011
145400             WHEN SQLCODE = -913                                  14540011
145500                 CONTINUE                                         14550011
145600             WHEN SQLWARN0 NOT = SPACES                           14560011
145700             WHEN SQLCODE < +0                                    14570011
145800             WHEN SQLCODE > +0                                    14580011
145900                 MOVE SQLCODE TO PV-DISP-SQLCODE                  14590011
146000                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          14600011
146100                 STRING                                           14610011
146200                      ' 4600- SQL:'  PV-DISP-SQLCODE              14620021
146500                      ' PO:'         PV-DISP-PO-NBR               14650021
146600                                 DELIMITED BY SIZE                14660011
146700                               INTO WS008-CRA-RET-MSG             14670011
146800                 MOVE SQLCA     TO WS008-SQLCA                    14680011
146900                 SET WS008-INVALID-SQL TO TRUE                    14690011
146910                                                                  14691021
146920                 INITIALIZE  PV-CICS-MSG-AREA                     14692021
146930                 STRING                                           14693021
146940                      ' WSKCS312-4600- '                          14694021
146950                      ' SQL:'       PV-DISP-SQLCODE               14695021
146960                      ' PO:'        PV-DISP-PO-NBR                14696021
146980                                    DELIMITED BY SIZE             14698021
146990                               INTO PV-CICS-MSG-AREA              14699021
146991                 PERFORM 9999-WRITE-TO-CSSL                       14699121
146992                                                                  14699221
147000         END-EVALUATE                                             14700011
147100     END-PERFORM.                                                 14710011
147200                                                                  14720011
147300                                                                  14730011
147400*----------------------------------------------------------------*14740011
147500* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *14750011
147600*----------------------------------------------------------------*14760011
147700 4700-GET-MAX-SEQ-NBR.                                            14770011
147710                                                                  14771020
147720     IF   PS-LOG-MESSAGE                                          14772020
147730          INITIALIZE  PV-CICS-MSG-AREA                            14773020
147740          STRING   ' WSKCS312-4700-GET-MAX-SEQ-NBR         '      14774020
147750                      DELIMITED BY SIZE                           14775020
147760                                      INTO PV-CICS-MSG-AREA       14776020
147770             PERFORM 9999-WRITE-TO-CSSL                           14777020
147780     END-IF.                                                      14778020
147790                                                                  14779020
147800                                                                  14780011
147900     PERFORM                                                      14790011
148000         WITH TEST AFTER                                          14800011
148100         VARYING PV-RETRY-COUNTER                                 14810011
148200         FROM 1 BY 1                                              14820011
148300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14830011
148400            OR (SQLCODE = +0)                                     14840011
148500            OR (SQLCODE = +100)                                   14850011
148600            OR (SQLCODE = -305))                                  14860011
148700                                                                  14870011
148800         EXEC SQL                                                 14880011
148900           SELECT MAX(REC_SEQ_NBR)                                14890011
149000           INTO  :RECEIV-REC-SEQ-NBR                              14900011
149100           FROM   TRECEIV                                         14910011
149200           WHERE  ORD_NBR = :DK-PO-NBR                            14920011
149300         END-EXEC                                                 14930011
149400                                                                  14940011
149500         EVALUATE TRUE                                            14950011
149600             WHEN SQLCODE = +0                                    14960011
149700                 MOVE RECEIV-REC-SEQ-NBR                          14970011
149800                                 TO PV-REC-SEQ-NBR                14980011
149900                 ADD +1          TO PV-REC-SEQ-NBR                14990011
150000                 MOVE PV-REC-SEQ-NBR TO WS008-NEW-REC-SEQ-NBR     15000011
150100             WHEN SQLCODE = +100                                  15010011
150200             WHEN SQLCODE = -305                                  15020011
150300                 MOVE +1         TO PV-REC-SEQ-NBR                15030011
150400                                                                  15040011
150500             WHEN SQLCODE = -904                                  15050011
150600             WHEN SQLCODE = -913                                  15060011
150700                 CONTINUE                                         15070011
150800                                                                  15080011
150900             WHEN SQLWARN0 NOT = SPACE                            15090011
151000             WHEN SQLCODE < +0                                    15100011
151100             WHEN SQLCODE > +0                                    15110011
151200                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           15120011
151300                 MOVE SQLCODE TO PV-DISP-SQLCODE                  15130011
151400                 STRING                                           15140011
151500                      ' 4700- SQL:'  PV-DISP-SQLCODE              15150021
151800                      ' PO:'         PV-DISP-PO-NBR               15180021
151900                                 DELIMITED BY SIZE                15190011
152000                               INTO WS008-CRA-RET-MSG             15200011
152100                 MOVE SQLCA     TO WS008-SQLCA                    15210011
152200                 SET WS008-INVALID-SQL TO TRUE                    15220011
152210                                                                  15221021
152220                 INITIALIZE  PV-CICS-MSG-AREA                     15222021
152230                 STRING                                           15223021
152240                      ' WSKCS312-4700- '                          15224021
152250                      ' SQL:'       PV-DISP-SQLCODE               15225021
152260                      ' PO:'        PV-DISP-PO-NBR                15226021
152270                                    DELIMITED BY SIZE             15227021
152280                               INTO PV-CICS-MSG-AREA              15228021
152290                 PERFORM 9999-WRITE-TO-CSSL                       15229021
152291                                                                  15229121
152300         END-EVALUATE                                             15230011
152400     END-PERFORM.                                                 15240011
152500                                                                  15250011
152600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15260011
152700             AND (SQLCODE NOT = +0)                               15270011
152800         MOVE DK-PO-NBR       TO PV-DISP-PO-NBR                   15280011
152900         MOVE SQLCODE TO PV-DISP-SQLCODE                          15290011
153000         STRING                                                   15300011
153100              ' 4700- MAX RETRIES SQL:'  PV-DISP-SQLCODE          15310021
153400              ' PO:'                     PV-DISP-PO-NBR           15340021
153500                         DELIMITED BY SIZE                        15350011
153600                       INTO WS008-CRA-RET-MSG                     15360011
153700         MOVE SQLCA     TO WS008-SQLCA                            15370011
153800         SET WS008-INVALID-SQL TO TRUE                            15380011
153810                                                                  15381021
153820         INITIALIZE  PV-CICS-MSG-AREA                             15382021
153830         STRING                                                   15383021
153840                      ' WSKCS312-4700- MAX RETRIES'               15384022
153850                      ' SQL:'       PV-DISP-SQLCODE               15385021
153860                      ' PO:'        PV-DISP-PO-NBR                15386021
153870                                    DELIMITED BY SIZE             15387021
153880                               INTO PV-CICS-MSG-AREA              15388021
153890         PERFORM 9999-WRITE-TO-CSSL                               15389021
153891                                                                  15389121
153900     END-IF.                                                      15390011
154000                                                                  15400011
154100/                                                                 15410011
154200*---------------------------------------------------------------* 15420011
154300*  PERFORMS THE ACTUAL INSERT TO THE TRECEIV TABLE.             * 15430011
154400*---------------------------------------------------------------* 15440011
154500 4800-INSERT-TRECEIV.                                             15450011
154510                                                                  15451020
154520     IF   PS-LOG-MESSAGE                                          15452020
154530          INITIALIZE  PV-CICS-MSG-AREA                            15453020
154540          STRING   ' WSKCS312-4800-INSERT-TRECEIV          '      15454020
154550                      DELIMITED BY SIZE                           15455020
154560                                      INTO PV-CICS-MSG-AREA       15456020
154570             PERFORM 9999-WRITE-TO-CSSL                           15457020
154580     END-IF.                                                      15458020
154590                                                                  15459020
154600                                                                  15460011
154700     PERFORM                                                      15470011
154800         WITH TEST AFTER                                          15480011
154900         VARYING PV-RETRY-COUNTER                                 15490011
155000         FROM 1 BY 1                                              15500011
155100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15510011
155200             OR (SQLCODE = +0))                                   15520011
155300                                                                  15530011
155400         EXEC SQL                                                 15540011
155500              INSERT INTO TRECEIV                                 15550011
155600                     ( ORD_NBR                                    15560011
155700                      ,REC_SEQ_NBR                                15570011
155800                      ,CRE_TMST                                   15580011
155900                      ,CRE_UID                                    15590011
156000                      ,PO_VER_NBR                                 15600011
156100                      ,OPER_UNT_ID                                15610011
156200                      ,FCLTY_ID                                   15620011
156300                      ,STATUS_CDE                                 15630011
156400                      ,SYST_CRE_CDE                               15640011
156500                      ,REC_TYP_CDE                                15650011
156600                      ,VER_STATUS_CDE                             15660011
156700                      ,PACK_BY_ST_IND                             15670011
156800                      ,REC_TMST                                   15680011
156900                      ,EXPTED_CART_CNT                            15690011
157000                      ,ACTL_CART_CNT                              15700011
157100                      ,EXPTED_ITM_QTY                             15710011
157200                      ,ACTL_ITM_QTY                               15720011
157300                      ,RCVR_NBR                                   15730011
157400                      ,ML_POST_TMST                               15740011
157500                      ,FS_POST_TMST                               15750011
157600                      ,PRE_TKT_IND                                15760011
157700                      ,AD_INFO_DESC                               15770011
157800                      ,IN_TRBL_TMST                               15780011
157900                      ,IN_TRBL_MIN_CNT                            15790011
158000                      ,IN_TRBL_HOUR_CNT                           15800011
158100                      ,VERFYD_TMST                                15810011
158200                      ,RCVG_CLERK_INIT_ID                         15820011
158300                      ,REFER_BACK_SEQ_NBR                         15830011
158400                      ,AP_PRC_CDE                                 15840011
158500                      ,AP_PRC_DTE                                 15850011
158600                      ,MIS_DIRECT_IND                             15860011
158700                      ,IMPRT_IND                                  15870011
158800                      ,CRE_OPER_UNT_ID                            15880011
158900                      ,CRE_FCLTY_ID                               15890011
159000                      ,CURR_OPER_UNT_ID                           15900011
159100                      ,CURR_FCLTY_ID                              15910011
159200                      ,UPD_TMST                                   15920011
159300                      ,UPD_UID                                    15930011
159400                      ,UPD_PGM_ID                                 15940011
159500                      ,MKNG_APRN_PRT_TMST                         15950011
159600                      ,GOH_IND                                    15960011
159700                      ,AP_RVRSL_DTE                               15970011
159800                      ,PKGNG_CDE                                  15980011
159900                      ,FRE_ASTRA_IND                              15990011
160000                      )                                           16000011
160100             VALUES ( :RECEIV-ORD-NBR                             16010011
160200                     ,:RECEIV-REC-SEQ-NBR                         16020011
160300                     ,CURRENT TIMESTAMP                           16030011
160400                     ,:RECEIV-CRE-UID                             16040011
160500                     ,:RECEIV-PO-VER-NBR                          16050011
160600                     ,:RECEIV-OPER-UNT-ID                         16060011
160700                     ,:RECEIV-FCLTY-ID                            16070011
160800                     ,:RECEIV-STATUS-CDE                          16080011
160900                     ,:RECEIV-SYST-CRE-CDE                        16090011
161000                     ,:RECEIV-REC-TYP-CDE                         16100011
161100                     ,:RECEIV-VER-STATUS-CDE                      16110011
161200                     ,:RECEIV-PACK-BY-ST-IND                      16120011
161300                     ,:RECEIV-REC-TMST                            16130011
161400                     ,:RECEIV-EXPTED-CART-CNT                     16140011
161500                     ,:RECEIV-ACTL-CART-CNT                       16150011
161600                     ,:RECEIV-EXPTED-ITM-QTY                      16160011
161700                     ,:RECEIV-ACTL-ITM-QTY                        16170011
161800                     ,:RECEIV-RCVR-NBR                            16180011
161900                     ,:RECEIV-ML-POST-TMST                        16190011
162000                     ,:RECEIV-FS-POST-TMST                        16200011
162100                     ,:RECEIV-PRE-TKT-IND                         16210011
162200                     ,:RECEIV-AD-INFO-DESC                        16220011
162300                     ,:RECEIV-IN-TRBL-TMST                        16230011
162400                     ,:RECEIV-IN-TRBL-MIN-CNT                     16240011
162500                     ,:RECEIV-IN-TRBL-HOUR-CNT                    16250011
162600                     ,:RECEIV-VERFYD-TMST                         16260011
162700                     ,:RECEIV-RCVG-CLERK-INIT-ID                  16270011
162800                     ,:RECEIV-REFER-BACK-SEQ-NBR                  16280011
162900                     ,:RECEIV-AP-PRC-CDE                          16290011
163000                     ,:RECEIV-AP-PRC-DTE                          16300011
163100                     ,:RECEIV-MIS-DIRECT-IND                      16310011
163200                     ,:RECEIV-IMPRT-IND                           16320011
163300                     ,:RECEIV-CRE-OPER-UNT-ID                     16330011
163400                     ,:RECEIV-CRE-FCLTY-ID                        16340011
163500                     ,:RECEIV-CURR-OPER-UNT-ID                    16350011
163600                     ,:RECEIV-CURR-FCLTY-ID                       16360011
163700                     ,CURRENT TIMESTAMP                           16370011
163800                     ,:RECEIV-UPD-UID                             16380011
163900                     ,:RECEIV-UPD-PGM-ID                          16390011
164000                     ,:RECEIV-MKNG-APRN-PRT-TMST                  16400011
164100                     ,:RECEIV-GOH-IND                             16410011
164200                     ,:PC-DEFAULT-9DATE                           16420011
164300                     ,:RECEIV-PKGNG-CDE                           16430011
164400                     ,:RECEIV-FRE-ASTRA-IND                       16440011
164500                     )                                            16450011
164600         END-EXEC                                                 16460011
164700                                                                  16470011
164800         EVALUATE TRUE                                            16480011
164900             WHEN SQLCODE = +0                                    16490011
165000             WHEN SQLCODE = -904                                  16500011
165100             WHEN SQLCODE = -913                                  16510011
165200                 CONTINUE                                         16520011
165300                                                                  16530011
165400             WHEN SQLWARN0 NOT = SPACE                            16540011
165500             WHEN SQLCODE < +0                                    16550011
165600             WHEN SQLCODE > +0                                    16560011
165700                 MOVE RECEIV-ORD-NBR     TO PV-DISP-PO-NBR        16570021
165800                 MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ       16580011
165900                 MOVE SQLCODE TO PV-DISP-SQLCODE                  16590011
166000                 STRING                                           16600011
166100                      ' 4800- SQL:'  PV-DISP-SQLCODE              16610021
166400                      ' PO:'         PV-DISP-PO-NBR               16640021
166600                      '-'            PV-DISP-REC-SEQ              16660021
166700                                 DELIMITED BY SIZE                16670011
166800                               INTO WS008-CRA-RET-MSG             16680011
166900                 MOVE SQLCA     TO WS008-SQLCA                    16690011
167000                 SET WS008-INVALID-SQL TO TRUE                    16700011
167010                                                                  16701021
167020                 INITIALIZE  PV-CICS-MSG-AREA                     16702021
167030                 STRING                                           16703021
167040                      ' WSKCS312-4800- '                          16704021
167050                      ' SQL:'       PV-DISP-SQLCODE               16705021
167060                      ' PO:'        PV-DISP-PO-NBR                16706021
167070                                    DELIMITED BY SIZE             16707021
167080                               INTO PV-CICS-MSG-AREA              16708021
167090                 PERFORM 9999-WRITE-TO-CSSL                       16709021
167091                                                                  16709121
167100         END-EVALUATE                                             16710011
167200     END-PERFORM.                                                 16720011
167300                                                                  16730011
167400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16740011
167500             AND (SQLCODE NOT = +0)                               16750011
167600         MOVE RECEIV-ORD-NBR     TO PV-DISP-PO-NBR                16760021
167700         MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ               16770011
167800         MOVE SQLCODE TO PV-DISP-SQLCODE                          16780011
167900         STRING                                                   16790011
168000              ' 4800- MAX RETRIES SQL:' PV-DISP-SQLCODE           16800021
168300              ' PO:'                    PV-DISP-PO-NBR            16830021
168500              '-'                       PV-DISP-REC-SEQ           16850021
168600                         DELIMITED BY SIZE                        16860011
168700                       INTO WS008-CRA-RET-MSG                     16870011
168800         MOVE SQLCA     TO WS008-SQLCA                            16880011
168900         SET WS008-INVALID-SQL TO TRUE                            16890011
168910                                                                  16891021
168920         INITIALIZE  PV-CICS-MSG-AREA                             16892021
168930         STRING                                                   16893021
168940                      ' WSKCS312-4800- MAX RETRIES'               16894022
168950                      ' SQL:'       PV-DISP-SQLCODE               16895021
168960                      ' PO:'        PV-DISP-PO-NBR                16896021
168970                                    DELIMITED BY SIZE             16897021
168980                               INTO PV-CICS-MSG-AREA              16898021
168990         PERFORM 9999-WRITE-TO-CSSL                               16899021
168991                                                                  16899121
169000     END-IF.                                                      16900011
169100                                                                  16910011
169200 4900-INSERT-TPOSYNC.                                             16920011
169210                                                                  16921020
169220     IF   PS-LOG-MESSAGE                                          16922020
169230          INITIALIZE  PV-CICS-MSG-AREA                            16923020
169240          STRING   ' WSKCS312-4900-INSERT-TPOSYNC          '      16924020
169250                      DELIMITED BY SIZE                           16925020
169260                                      INTO PV-CICS-MSG-AREA       16926020
169270             PERFORM 9999-WRITE-TO-CSSL                           16927020
169280     END-IF.                                                      16928020
169290                                                                  16929020
169300     EXEC SQL                                                     16930011
169400         INSERT INTO TPOSYNC                                      16940011
169500           ( PO_NBR                                               16950011
169600            ,LAST_SYNC_TMST                                       16960011
169700            ,SYNC_STAT_CDE                                        16970011
169800           )                                                      16980011
169900         VALUES                                                   16990011
170000           ( :RECEIV-ORD-NBR                                      17000011
170100           , CURRENT TIMESTAMP                                    17010011
170200           , 'N'                                                  17020011
170300           )                                                      17030011
170400     END-EXEC.                                                    17040011
170500                                                                  17050011
170600     EVALUATE TRUE                                                17060011
170700         WHEN SQLCODE = ZERO                                      17070011
170800         WHEN SQLCODE = -803                                      17080011
170900                 CONTINUE                                         17090011
171000         WHEN SQLCODE = -904                                      17100011
171100         WHEN SQLCODE = -913                                      17110011
171200         WHEN SQLCODE = -911                                      17120011
171300             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO-NBR               17130011
171400             MOVE SQLCODE TO PV-DISP-SQLCODE                      17140011
171500             STRING                                               17150011
171600                  ' 4900- SQL:'  PV-DISP-SQLCODE                  17160021
171900                  ' PO:'         PV-DISP-PO-NBR                   17190021
172000                             DELIMITED BY SIZE                    17200011
172100                           INTO WS008-CRA-RET-MSG                 17210011
172200             MOVE SQLCA     TO WS008-SQLCA                        17220011
172300             SET WS008-INVALID-SQL TO TRUE                        17230011
172310                                                                  17231021
172320             INITIALIZE  PV-CICS-MSG-AREA                         17232021
172330              STRING                                              17233021
172340                      ' WSKCS312-4900- '                          17234021
172350                      ' SQL:'       PV-DISP-SQLCODE               17235021
172360                      ' PO:'        PV-DISP-PO-NBR                17236021
172370                                    DELIMITED BY SIZE             17237021
172380                               INTO PV-CICS-MSG-AREA              17238021
172390              PERFORM 9999-WRITE-TO-CSSL                          17239021
172391                                                                  17239121
172400                                                                  17240011
172500         WHEN SQLWARN0 NOT = SPACE                                17250011
172600         WHEN SQLCODE < ZERO                                      17260011
172700         WHEN SQLCODE > ZERO                                      17270011
172800             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO-NBR               17280011
172900             MOVE SQLCODE TO PV-DISP-SQLCODE                      17290011
173000             STRING                                               17300011
173100                  ' 4900- SQL:'  PV-DISP-SQLCODE                  17310024
173400                  ' PO:'         PV-DISP-PO-NBR                   17340021
173500                             DELIMITED BY SIZE                    17350011
173600                           INTO WS008-CRA-RET-MSG                 17360011
173700             MOVE SQLCA     TO WS008-SQLCA                        17370011
173800             SET WS008-INVALID-SQL TO TRUE                        17380011
173810                                                                  17381021
173820             INITIALIZE  PV-CICS-MSG-AREA                         17382021
173830              STRING                                              17383021
173840                      ' WSKCS312-4900- '                          17384021
173850                      ' SQL:'       PV-DISP-SQLCODE               17385021
173860                      ' PO:'        PV-DISP-PO-NBR                17386021
173870                                    DELIMITED BY SIZE             17387021
173880                               INTO PV-CICS-MSG-AREA              17388021
173890              PERFORM 9999-WRITE-TO-CSSL                          17389021
173891                                                                  17389121
173900     END-EVALUATE.                                                17390011
174000/                                                                 17400011
174100*----------------------------------------------------------------*17410011
174200* OPEN THE TRECVER CURSOR                                        *17420011
174300*----------------------------------------------------------------*17430011
174400                                                                  17440011
174500 5000-OPEN-TRECVER-CSR.                                           17450011
174510                                                                  17451020
174520     IF   PS-LOG-MESSAGE                                          17452020
174530          INITIALIZE  PV-CICS-MSG-AREA                            17453020
174540          STRING   ' WSKCS312-5000-OPEN-TRECVER-CSR        '      17454020
174550                      DELIMITED BY SIZE                           17455020
174560                                      INTO PV-CICS-MSG-AREA       17456020
174570             PERFORM 9999-WRITE-TO-CSSL                           17457020
174580     END-IF.                                                      17458020
174590                                                                  17459020
174600                                                                  17460011
174700     EXEC SQL                                                     17470011
174800          DECLARE TRECVER-CSR CURSOR FOR                          17480011
174900           SELECT MAX_RCVR_NBR                                    17490011
175000           FROM   TRECVER                                         17500011
175100           WHERE  OPERCO_NBR = '03'                               17510011
175200           FOR UPDATE OF MAX_RCVR_NBR                             17520011
175300     END-EXEC.                                                    17530011
175400                                                                  17540011
175500                                                                  17550011
175600         EXEC SQL                                                 17560011
175700              OPEN TRECVER-CSR                                    17570011
175800         END-EXEC                                                 17580011
175900                                                                  17590011
176000         EVALUATE TRUE                                            17600011
176100             WHEN SQLCODE = +0                                    17610011
176200                  CONTINUE                                        17620011
176300             WHEN SQLCODE = -904                                  17630011
176400             WHEN SQLCODE = -913                                  17640011
176500                  CONTINUE                                        17650011
176600             WHEN SQLWARN0 NOT = SPACE                            17660011
176700             WHEN SQLCODE  NOT = +0                               17670011
176800                 MOVE SQLCODE TO PV-DISP-SQLCODE                  17680011
176900                 STRING                                           17690011
177000                      ' 5000- SQL:'  PV-DISP-SQLCODE              17700021
177200                      ' OPEN CURSOR '                             17720011
177300                                 DELIMITED BY SIZE                17730011
177400                               INTO WS008-CRA-RET-MSG             17740011
177500                 MOVE SQLCA     TO WS008-SQLCA                    17750011
177600                 SET WS008-INVALID-SQL TO TRUE                    17760011
177610                                                                  17761021
177620                 INITIALIZE  PV-CICS-MSG-AREA                     17762021
177630                 STRING                                           17763021
177640                      ' WSKCS312-5000- '                          17764021
177650                      ' SQL:'       PV-DISP-SQLCODE               17765021
177651                      ' OPEN CURSOR '                             17765121
177670                                    DELIMITED BY SIZE             17767021
177680                               INTO PV-CICS-MSG-AREA              17768021
177690                 PERFORM 9999-WRITE-TO-CSSL                       17769021
177691                                                                  17769121
177700         END-EVALUATE.                                            17770011
177800                                                                  17780011
177900                                                                  17790011
178000/                                                                 17800011
178100*----------------------------------------------------------------*17810011
178200*    FETCH A TRECVER ROW                                         *17820011
178300*----------------------------------------------------------------*17830011
178400                                                                  17840011
178500 5020-FETCH-TRECVER-CSR.                                          17850011
178510                                                                  17851020
178520     IF   PS-LOG-MESSAGE                                          17852020
178530          INITIALIZE  PV-CICS-MSG-AREA                            17853020
178540          STRING   ' WSKCS312-5020-FETCH-TRECVER-CSR       '      17854020
178550                      DELIMITED BY SIZE                           17855020
178560                                      INTO PV-CICS-MSG-AREA       17856020
178570             PERFORM 9999-WRITE-TO-CSSL                           17857020
178580     END-IF.                                                      17858020
178590                                                                  17859020
178600                                                                  17860011
178700     EXEC SQL                                                     17870011
178800          FETCH TRECVER-CSR                                       17880011
178900          INTO :RECVER-MAX-RCVR-NBR                               17890011
179000     END-EXEC                                                     17900011
179100                                                                  17910011
179200     EVALUATE TRUE                                                17920011
179300         WHEN SQLCODE = +0                                        17930011
179400              CONTINUE                                            17940011
179500                                                                  17950011
179600         WHEN SQLCODE = +100                                      17960011
179700              SET PS-EOF-TRECVER-CSR TO TRUE                      17970011
179800                                                                  17980011
179900         WHEN SQLWARN0 NOT = SPACE                                17990011
180000         WHEN SQLCODE < +0                                        18000011
180100         WHEN SQLCODE > +0                                        18010011
180200             MOVE SQLCODE TO PV-DISP-SQLCODE                      18020011
180300             STRING                                               18030011
180400                  ' 5020- SQL:'  PV-DISP-SQLCODE                  18040021
180600                  ' FETCH CURSOR '                                18060011
180700                             DELIMITED BY SIZE                    18070011
180800                           INTO WS008-CRA-RET-MSG                 18080011
180900             MOVE SQLCA     TO WS008-SQLCA                        18090011
181000             SET WS008-INVALID-SQL TO TRUE                        18100011
181010                                                                  18101021
181020             INITIALIZE  PV-CICS-MSG-AREA                         18102021
181030             STRING                                               18103021
181040                      ' WSKCS312-5020- '                          18104021
181050                      ' SQL:'       PV-DISP-SQLCODE               18105021
181060                      ' OPEN CURSOR '                             18106021
181070                                    DELIMITED BY SIZE             18107021
181080                               INTO PV-CICS-MSG-AREA              18108021
181090             PERFORM 9999-WRITE-TO-CSSL                           18109021
181091                                                                  18109121
181100     END-EVALUATE.                                                18110011
181200                                                                  18120011
181300/                                                                 18130011
181400*----------------------------------------------------------------*18140011
181500*    UDPATE CURRENT CURSOR                                       *18150011
181600*----------------------------------------------------------------*18160011
181700                                                                  18170011
181800 5040-DELETE-TRECVER-CSR.                                         18180011
181810                                                                  18181020
181820     IF   PS-LOG-MESSAGE                                          18182020
181830          INITIALIZE  PV-CICS-MSG-AREA                            18183020
181840          STRING   ' WSKCS312-5040-DELETE-TRECVER-CSR      '      18184020
181850                      DELIMITED BY SIZE                           18185020
181860                                      INTO PV-CICS-MSG-AREA       18186020
181870             PERFORM 9999-WRITE-TO-CSSL                           18187020
181880     END-IF.                                                      18188020
181890                                                                  18189020
181900                                                                  18190011
182000     EXEC SQL                                                     18200011
182100          DELETE FROM TRECVER                                     18210011
182200            WHERE CURRENT OF TRECVER-CSR                          18220011
182300     END-EXEC                                                     18230011
182400                                                                  18240011
182500     EVALUATE TRUE                                                18250011
182600         WHEN SQLCODE = +0                                        18260011
182700              CONTINUE                                            18270011
182800                                                                  18280011
182900         WHEN SQLWARN0 NOT = SPACE                                18290011
183000         WHEN SQLCODE < +0                                        18300011
183100         WHEN SQLCODE > +0                                        18310011
183200             MOVE SQLCODE TO PV-DISP-SQLCODE                      18320011
183300             STRING                                               18330011
183400                  ' 5040- SQL:'  PV-DISP-SQLCODE                  18340021
183600                  ' DELETE FROM CURSOR '                          18360011
183700                             DELIMITED BY SIZE                    18370011
183800                           INTO WS008-CRA-RET-MSG                 18380011
183900             MOVE SQLCA     TO WS008-SQLCA                        18390011
184000             SET WS008-INVALID-SQL TO TRUE                        18400011
184010                                                                  18401021
184020             INITIALIZE  PV-CICS-MSG-AREA                         18402021
184030             STRING                                               18403021
184040                      ' WSKCS312-5040- '                          18404021
184050                      ' SQL:'       PV-DISP-SQLCODE               18405021
184051                      ' DELETE FROM CURSOR '                      18405121
184070                                    DELIMITED BY SIZE             18407021
184080                               INTO PV-CICS-MSG-AREA              18408021
184090             PERFORM 9999-WRITE-TO-CSSL                           18409021
184091                                                                  18409121
184100     END-EVALUATE.                                                18410011
184200                                                                  18420011
184300/                                                                 18430011
184400*----------------------------------------------------------------*18440011
184500* INSERT THE TRECVER ROW                                         *18450011
184600*----------------------------------------------------------------*18460011
184700                                                                  18470011
184800 5060-INSERT-TRECVER.                                             18480011
184810                                                                  18481020
184820     IF   PS-LOG-MESSAGE                                          18482020
184830          INITIALIZE  PV-CICS-MSG-AREA                            18483020
184840          STRING   ' WSKCS312-5060-INSERT-TRECVER          '      18484020
184850                      DELIMITED BY SIZE                           18485020
184860                                      INTO PV-CICS-MSG-AREA       18486020
184870             PERFORM 9999-WRITE-TO-CSSL                           18487020
184880     END-IF.                                                      18488020
184890                                                                  18489020
184900                                                                  18490011
185000     PERFORM                                                      18500011
185100         WITH TEST AFTER                                          18510011
185200         VARYING PV-RETRY-COUNTER                                 18520011
185300         FROM 1 BY 1                                              18530011
185400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18540011
185500             OR (SQLCODE = +0))                                   18550011
185600                                                                  18560011
185700         EXEC SQL                                                 18570011
185800              INSERT INTO TRECVER                                 18580011
185900                     ( OPERCO_NBR                                 18590011
186000                      ,MAX_RCVR_NBR )                             18600011
186100              VALUES ( '03'                                       18610011
186200                      ,:RECVER-MAX-RCVR-NBR )                     18620011
186300         END-EXEC                                                 18630011
186400                                                                  18640011
186500         EVALUATE TRUE                                            18650011
186600             WHEN SQLCODE = +0                                    18660011
186700             WHEN SQLCODE = -904                                  18670011
186800             WHEN SQLCODE = -913                                  18680011
186900                 CONTINUE                                         18690011
187000                                                                  18700011
187100             WHEN SQLWARN0 NOT = SPACE                            18710011
187200             WHEN SQLCODE < +0                                    18720011
187300             WHEN SQLCODE > +0                                    18730011
187400                 MOVE SQLCODE TO PV-DISP-SQLCODE                  18740011
187500                 STRING                                           18750011
187600                      ' 5060- SQL:'  PV-DISP-SQLCODE              18760021
187800                      ' INSERT '                                  18780011
187900                                 DELIMITED BY SIZE                18790011
188000                               INTO WS008-CRA-RET-MSG             18800011
188100                 MOVE SQLCA     TO WS008-SQLCA                    18810011
188200                 SET WS008-INVALID-SQL TO TRUE                    18820011
188210                                                                  18821021
188220                 INITIALIZE  PV-CICS-MSG-AREA                     18822021
188230                 STRING                                           18823021
188240                      ' WSKCS312-5060- '                          18824021
188250                      ' SQL:'       PV-DISP-SQLCODE               18825021
188260                      ' INSERT '                                  18826021
188270                                    DELIMITED BY SIZE             18827021
188280                               INTO PV-CICS-MSG-AREA              18828021
188290                 PERFORM 9999-WRITE-TO-CSSL                       18829021
188291                                                                  18829121
188300         END-EVALUATE                                             18830011
188400     END-PERFORM.                                                 18840011
188500                                                                  18850011
188600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18860011
188700             AND (SQLCODE NOT = +0)                               18870011
188800         MOVE SQLCODE TO PV-DISP-SQLCODE                          18880011
188900         STRING                                                   18890011
189000              ' 5060- MAX RETRIES SQL:' PV-DISP-SQLCODE           18900021
189200              ' INSERT '                                          18920011
189300                         DELIMITED BY SIZE                        18930011
189400                       INTO WS008-CRA-RET-MSG                     18940011
189500         MOVE SQLCA     TO WS008-SQLCA                            18950011
189600         SET WS008-INVALID-SQL TO TRUE                            18960011
189610                                                                  18961021
189620         INITIALIZE  PV-CICS-MSG-AREA                             18962021
189630         STRING                                                   18963021
189640                      ' WSKCS312-5060- MAX RETRIES'               18964022
189650                      ' SQL:'       PV-DISP-SQLCODE               18965021
189660                      ' INSERT '                                  18966021
189670                                    DELIMITED BY SIZE             18967021
189680                               INTO PV-CICS-MSG-AREA              18968021
189690         PERFORM 9999-WRITE-TO-CSSL                               18969021
189691                                                                  18969121
189700     END-IF.                                                      18970011
189800                                                                  18980011
189900/                                                                 18990011
190000*----------------------------------------------------------------*19000011
190100* CLOSE THE TRECVER CURSOR                                       *19010011
190200*----------------------------------------------------------------*19020011
190300                                                                  19030011
190400 5080-CLOSE-TRECVER-CSR.                                          19040011
190410                                                                  19041020
190420     IF   PS-LOG-MESSAGE                                          19042020
190430          INITIALIZE  PV-CICS-MSG-AREA                            19043020
190440          STRING   ' WSKCS312-5080-CLOSE-TRECVER-CSR       '      19044020
190450                      DELIMITED BY SIZE                           19045020
190460                                      INTO PV-CICS-MSG-AREA       19046020
190470             PERFORM 9999-WRITE-TO-CSSL                           19047020
190480     END-IF.                                                      19048020
190490                                                                  19049020
190500                                                                  19050011
190600     EXEC SQL                                                     19060011
190700          CLOSE TRECVER-CSR                                       19070011
190800     END-EXEC                                                     19080011
190900                                                                  19090011
191000     EVALUATE TRUE                                                19100011
191100         WHEN SQLCODE = +0                                        19110011
191200              CONTINUE                                            19120011
191300         WHEN SQLWARN0 NOT = SPACE                                19130011
191400         WHEN SQLCODE  NOT = +0                                   19140011
191500             MOVE SQLCODE TO PV-DISP-SQLCODE                      19150011
191600             STRING                                               19160011
191700                  ' 5080- SQL:'  PV-DISP-SQLCODE                  19170021
191900                  ' CLOSE CURSOR'                                 19190011
192000                             DELIMITED BY SIZE                    19200011
192100                           INTO WS008-CRA-RET-MSG                 19210011
192200             MOVE SQLCA     TO WS008-SQLCA                        19220011
192300             SET WS008-INVALID-SQL TO TRUE                        19230011
192310                                                                  19231021
192320             INITIALIZE  PV-CICS-MSG-AREA                         19232021
192330             STRING                                               19233021
192340                      ' WSKCS312-5080- '                          19234021
192350                      ' SQL:'       PV-DISP-SQLCODE               19235021
192360                      ' CLOSE CURSOR '                            19236021
192370                                    DELIMITED BY SIZE             19237021
192380                               INTO PV-CICS-MSG-AREA              19238021
192390             PERFORM 9999-WRITE-TO-CSSL                           19239021
192391                                                                  19239121
192400     END-EVALUATE.                                                19240011
192500                                                                  19250011
192600/                                                                 19260011
192700                                                                  19270011
192800 5200-VALIDATE-OPER-SET-ID.                                       19280011
192810                                                                  19281020
192820     IF   PS-LOG-MESSAGE                                          19282020
192830          INITIALIZE  PV-CICS-MSG-AREA                            19283020
192840          STRING   ' WSKCS312-5200-VALIDATE-OPER-SET-ID    '      19284020
192850                      DELIMITED BY SIZE                           19285020
192860                                      INTO PV-CICS-MSG-AREA       19286020
192870             PERFORM 9999-WRITE-TO-CSSL                           19287020
192880     END-IF.                                                      19288020
192890                                                                  19289020
192900                                                                  19290011
193000     PERFORM                                                      19300011
193100         WITH TEST AFTER                                          19310011
193200         VARYING PV-RETRY-COUNTER                                 19320011
193300         FROM 1 BY 1                                              19330011
193400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19340011
193500                   OR (SQLCODE = +0)                              19350011
193600                   OR (SQLCODE = +100))                           19360011
193700                                                                  19370011
193800         EXEC SQL                                                 19380011
193900            SELECT  OPER_SET_DESC                                 19390011
194000              INTO :OPRSET-OPER-SET-DESC                          19400011
194100              FROM  TOPRSET                                       19410011
194200             WHERE  OPER_SET_ID    = :DK-OPER-SET-ID              19420011
194300               AND  VER_STATUS_CDE = 'A'                          19430011
194400               AND  OPER_UNT_ID    = :DK-OPER-UNT-ID              19440011
194500               AND  FCLTY_ID       = :DK-FCLTY-ID                 19450011
194600         END-EXEC                                                 19460011
194700                                                                  19470011
194800         EVALUATE TRUE                                            19480011
194900             WHEN SQLCODE = +0                                    19490011
195000             WHEN SQLCODE = +100                                  19500011
195100             WHEN SQLCODE = -904                                  19510011
195200             WHEN SQLCODE = -913                                  19520011
195300                 CONTINUE                                         19530011
195400                                                                  19540011
195500             WHEN SQLWARN0 NOT = SPACES                           19550011
195600             WHEN SQLCODE < +0                                    19560011
195700             WHEN SQLCODE > +0                                    19570011
195800                 MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET         19580011
195900                 MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID      19590011
196000                 MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID         19600011
196100                 MOVE SQLCODE TO PV-DISP-SQLCODE                  19610011
196200                 STRING                                           19620011
196300                      ' 5200- SQL:'   PV-DISP-SQLCODE             19630021
196400                      ' SET:'         PV-DISP-OPER-SET            19640021
196410                      ' OPER:'        PV-DISP-OPER-UNT-ID         19641021
196420                      '-'             PV-DISP-FCLTY-ID            19642021
196500                      ' PO:'          PV-DISP-PO-NBR              19650021
196700                                 DELIMITED BY SIZE                19670011
196800                               INTO WS008-CRA-RET-MSG             19680011
196900                 MOVE SQLCA     TO WS008-SQLCA                    19690011
197000                 SET WS008-INVALID-SQL TO TRUE                    19700011
197010                                                                  19701021
197020                 INITIALIZE  PV-CICS-MSG-AREA                     19702021
197030                 STRING                                           19703021
197040                      ' WSKCS312-5200- '                          19704021
197041                      ' SQL:'       PV-DISP-SQLCODE               19704122
197042                      ' SET:'         PV-DISP-OPER-SET            19704221
197043                      ' OPER:'        PV-DISP-OPER-UNT-ID         19704321
197044                      '-'             PV-DISP-FCLTY-ID            19704421
197045                      ' PO:'          PV-DISP-PO-NBR              19704521
197060                      ' CLOSE CURSOR '                            19706021
197070                                    DELIMITED BY SIZE             19707021
197080                               INTO PV-CICS-MSG-AREA              19708021
197090                 PERFORM 9999-WRITE-TO-CSSL                       19709021
197091                                                                  19709121
197100         END-EVALUATE                                             19710011
197200     END-PERFORM.                                                 19720011
197300                                                                  19730011
197400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19740011
197500             AND (SQLCODE NOT = +0)                               19750011
197600         MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET                 19760011
197700         MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID              19770011
197800         MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                 19780011
197900         MOVE SQLCODE TO PV-DISP-SQLCODE                          19790011
198000         STRING                                                   19800011
198100              ' 5200- MAX RETRIES SQL:'  PV-DISP-SQLCODE          19810021
198110              ' SET:'                    PV-DISP-OPER-SET         19811021
198120              ' OPER:'                   PV-DISP-OPER-UNT-ID      19812021
198130              '-'                        PV-DISP-FCLTY-ID         19813021
198140              ' PO:'                     PV-DISP-PO-NBR           19814021
198500                         DELIMITED BY SIZE                        19850011
198600                       INTO WS008-CRA-RET-MSG                     19860011
198700         MOVE SQLCA     TO WS008-SQLCA                            19870011
198800         SET WS008-INVALID-SQL TO TRUE                            19880011
198810                                                                  19881021
198820         INITIALIZE  PV-CICS-MSG-AREA                             19882021
198830         STRING                                                   19883021
198840                      ' WSKCS312-5200- MAX RETRIES'               19884022
198841                      ' SQL:'         PV-DISP-SQLCODE             19884122
198850                      ' SET:'         PV-DISP-OPER-SET            19885021
198860                      ' OPER:'        PV-DISP-OPER-UNT-ID         19886021
198870                      '-'             PV-DISP-FCLTY-ID            19887021
198880                      ' PO:'          PV-DISP-PO-NBR              19888021
198891                                    DELIMITED BY SIZE             19889121
198892                               INTO PV-CICS-MSG-AREA              19889221
198893         PERFORM 9999-WRITE-TO-CSSL                               19889321
198894                                                                  19889421
198900     END-IF.                                                      19890011
199000                                                                  19900011
199100 5300-GET-OPER-SET-INFO.                                          19910011
199110                                                                  19911020
199120     IF   PS-LOG-MESSAGE                                          19912020
199130          INITIALIZE  PV-CICS-MSG-AREA                            19913020
199140          STRING   ' WSKCS312-5300-GET-OPER-SET-INFO       '      19914020
199150                      DELIMITED BY SIZE                           19915020
199160                                      INTO PV-CICS-MSG-AREA       19916020
199170             PERFORM 9999-WRITE-TO-CSSL                           19917020
199180     END-IF.                                                      19918020
199190                                                                  19919020
199200*  THIS IS THE OPER SET DEFAULT THAT IS ASSIGNED IN CNUDCLOC      19920011
199300*  BY OPER-UNIT, FACILTY, DEPT, AND CLASS.                        19930011
199400                                                                  19940011
199500     PERFORM 5400-GET-MIN-LNE-NBR.                                19950011
199600                                                                  19960011
199700     IF SQLCODE = 0                                               19970011
199800        PERFORM                                                   19980011
199900            WITH TEST AFTER                                       19990011
200000            VARYING PV-RETRY-COUNTER                              20000011
200100            FROM 1 BY 1                                           20010011
200200            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            20020011
200300                OR (SQLCODE = +0)                                 20030011
200400                OR (SQLCODE = +100))                              20040011
200500                                                                  20050011
200600            EXEC SQL                                              20060011
200700                 SELECT A.OPER_SET_ID                             20070011
200800                       ,A.CL_NBR                                  20080011
200900                       ,B.OPER_SET_DESC                           20090011
201000                   INTO :DCFAAS-OPER-SET-ID                       20100011
201100                       ,:DCFAAS-CL-NBR                            20110011
201200                       ,:OPRSET-OPER-SET-DESC                     20120011
201300                   FROM TDCFAAS A                                 20130011
201400                       ,TOPRSET B                                 20140011
201500                  WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID     20150011
201600                    AND A.FCLTY_ID          = :DK-FCLTY-ID        20160011
201700                    AND A.DEPT_NBR          = :DK-DEPT-NBR        20170011
201800                    AND A.FCLTY_LOC_TYP_CDE = 'PA'                20180011
201900                    AND A.RANK_NBR          = 1                   20190011
202000                    AND B.VER_STATUS_CDE    = 'A'                 20200011
202100                    AND A.CL_NBR            = :PURITM-CL-NBR      20210011
202200                    AND A.OPER_SET_ID       = B.OPER_SET_ID       20220011
202300                    AND A.OPER_UNT_ID       = B.OPER_UNT_ID       20230011
202400            END-EXEC                                              20240011
202500                                                                  20250011
202600            EVALUATE TRUE                                         20260011
202700                WHEN SQLCODE = +0                                 20270011
202800                WHEN SQLCODE = +100                               20280011
202900                WHEN SQLCODE = -904                               20290011
203000                WHEN SQLCODE = -913                               20300011
203100                     CONTINUE                                     20310011
203200                                                                  20320011
203300                WHEN SQLWARN0 NOT = SPACES                        20330011
203400                WHEN SQLCODE < +0                                 20340011
203500                WHEN SQLCODE > +0                                 20350011
203600                    MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID   20360011
203700                    MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID      20370011
203800                    MOVE SQLCODE TO PV-DISP-SQLCODE               20380011
203900                    STRING                                        20390011
204000                         ' 5300- SQL:'  PV-DISP-SQLCODE           20400021
204200                         ' DPT:'        DK-DEPT-NBR               20420021
204400                         ' OPER:'       PV-DISP-OPER-UNT-ID       20440021
204700                         '-'            PV-DISP-FCLTY-ID          20470021
204800                                    DELIMITED BY SIZE             20480011
204900                                  INTO WS008-CRA-RET-MSG          20490011
205000                    MOVE SQLCA     TO WS008-SQLCA                 20500011
205100                    SET WS008-INVALID-SQL TO TRUE                 20510011
205110                                                                  20511021
205120                    INITIALIZE  PV-CICS-MSG-AREA                  20512021
205130                    STRING                                        20513021
205140                         ' WSKCS312-5300- '                       20514021
205141                         ' SQL:'           PV-DISP-SQLCODE        20514129
205142                         ' DPT:'           DK-DEPT-NBR            20514229
205143                         ' OPER:'          PV-DISP-OPER-UNT-ID    20514329
205144                         '-'               PV-DISP-FCLTY-ID       20514429
205145                         ' PURITM-CL-NBR:' PURITM-CL-NBR          20514530
205191                                    DELIMITED BY SIZE             20519121
205192                               INTO PV-CICS-MSG-AREA              20519221
205193                    PERFORM 9999-WRITE-TO-CSSL                    20519321
205194                                                                  20519429
205207                                                                  20520729
205210            END-EVALUATE                                          20521011
205300        END-PERFORM                                               20530011
205400                                                                  20540011
205500        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                     20550011
205600                AND (SQLCODE NOT = +0)                            20560011
205700            MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID           20570011
205800            MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID              20580011
205900            MOVE SQLCODE TO PV-DISP-SQLCODE                       20590011
206000            STRING                                                20600011
206100                 ' 5300- MAX RETRIES SQL:' PV-DISP-SQLCODE        20610021
206820                 ' DPT:'                   DK-DEPT-NBR            20682021
206830                 ' OPER:'                  PV-DISP-OPER-UNT-ID    20683021
206840                 '-'                       PV-DISP-FCLTY-ID       20684021
206900                            DELIMITED BY SIZE                     20690011
207000                          INTO WS008-CRA-RET-MSG                  20700011
207100            MOVE SQLCA     TO WS008-SQLCA                         20710011
207200            SET WS008-INVALID-SQL TO TRUE                         20720011
207210                                                                  20721021
207220            INITIALIZE  PV-CICS-MSG-AREA                          20722021
207230            STRING                                                20723021
207240                         ' WSKCS312-5300- MAX RETRIES'            20724022
207241                         ' SQL:'        PV-DISP-SQLCODE           20724122
207250                         ' DPT:'        DK-DEPT-NBR               20725021
207260                         ' OPER:'       PV-DISP-OPER-UNT-ID       20726021
207270                         '-'            PV-DISP-FCLTY-ID          20727021
207280                                    DELIMITED BY SIZE             20728021
207290                               INTO PV-CICS-MSG-AREA              20729021
207291            PERFORM 9999-WRITE-TO-CSSL                            20729121
207292                                                                  20729221
207300        END-IF                                                    20730011
207400     END-IF.                                                      20740011
207401                                                                  20740129
207402** DMH 11/11/14 BEGIN                                             20740229
207410     IF   PS-LOG-MESSAGE                                          20741029
207420          INITIALIZE  PV-CICS-MSG-AREA                            20742029
207431          MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID             20743129
207432          MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                20743229
207433          MOVE SQLCODE TO PV-DISP-SQLCODE                         20743329
207434          STRING   ' WSKCS312-5300-  '                            20743429
207436                   ' SQL:'  PV-DISP-SQLCODE                       20743629
207437                   ' DPT:'        DK-DEPT-NBR                     20743729
207438                   ' OPER:'       PV-DISP-OPER-UNT-ID             20743829
207439                   '-'            PV-DISP-FCLTY-ID                20743929
207440                                  DELIMITED BY SIZE               20744029
207450                             INTO PV-CICS-MSG-AREA                20745029
207460          PERFORM 9999-WRITE-TO-CSSL                              20746029
207461                                                                  20746129
207462          INITIALIZE  PV-CICS-MSG-AREA                            20746229
207463          MOVE  DCFAAS-OPER-SET-ID  TO  PV-DISP-OPER-SET          20746331
207464          STRING                                                  20746429
207465               ' WSKCS312-5300- '                                 20746529
207466               ' DCFAAS-OPER-SET-ID:'   PV-DISP-OPER-SET          20746631
207467               ' DCFAAS-CL-NBR:'        DCFAAS-CL-NBR             20746730
207469               ' OPRSET-OPER-SET-DESC:' OPRSET-OPER-SET-DESC      20746930
207471                          DELIMITED BY SIZE                       20747129
207472                     INTO PV-CICS-MSG-AREA                        20747229
207473          PERFORM 9999-WRITE-TO-CSSL                              20747329
207474     END-IF.                                                      20747429
207480** DMH 11/11/14 BEGIN                                             20748029
207500                                                                  20750011
207510                                                                  20751029
207600 5400-GET-MIN-LNE-NBR.                                            20760011
207610                                                                  20761020
207620     IF   PS-LOG-MESSAGE                                          20762020
207630          INITIALIZE  PV-CICS-MSG-AREA                            20763020
207640          STRING   ' WSKCS312-5400-GET-MIN-LNE-NBR         '      20764020
207650                      DELIMITED BY SIZE                           20765020
207660                                      INTO PV-CICS-MSG-AREA       20766020
207670             PERFORM 9999-WRITE-TO-CSSL                           20767020
207680     END-IF.                                                      20768020
207690                                                                  20769020
207700     PERFORM                                                      20770011
207800         WITH TEST AFTER                                          20780011
207900         VARYING PV-RETRY-COUNTER                                 20790011
208000         FROM 1 BY 1                                              20800011
208100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20810011
208200             OR (SQLCODE = +0)                                    20820011
208300             OR (SQLCODE = +100))                                 20830011
208400                                                                  20840011
208500         EXEC SQL                                                 20850011
208600              SELECT                                              20860011
208700                     A.CL_NBR                                     20870011
208800                INTO :PURITM-CL-NBR                               20880011
208900                FROM TPURITM A                                    20890011
209000               WHERE A.PO_NBR        = :DK-PO-NBR                 20900011
209100                 AND A.VER_STATUS_CDE = 'A'                       20910011
209200                 AND A.PO_LNE_NBR =                               20920011
209300                   (SELECT MIN(B.PO_LNE_NBR)                      20930011
209400                      FROM TPURITM B                              20940011
209500                      WHERE B.PO_NBR = A.PO_NBR                   20950011
209600                        AND B.VER_STATUS_CDE = 'A'                20960011
209700                        AND B.STATUS_CDE IN ('AP','AC'))          20970011
209800         END-EXEC                                                 20980011
209900                                                                  20990011
210000         EVALUATE TRUE                                            21000011
210100             WHEN SQLCODE = +0                                    21010011
210200             WHEN SQLCODE = +100                                  21020011
210300             WHEN SQLCODE = -904                                  21030011
210400             WHEN SQLCODE = -913                                  21040011
210500                  CONTINUE                                        21050011
210600                                                                  21060011
210700             WHEN SQLWARN0 NOT = SPACES                           21070011
210800             WHEN SQLCODE < +0                                    21080011
210900             WHEN SQLCODE > +0                                    21090011
211000                 MOVE DK-PO-NBR       TO PV-DISP-PO-NBR           21100011
211100                 MOVE SQLCODE TO PV-DISP-SQLCODE                  21110011
211200                 STRING                                           21120011
211300                      ' 5400- SQL:' PV-DISP-SQLCODE               21130021
211500                      ' PO:'        PV-DISP-PO-NBR                21150021
211700                                 DELIMITED BY SIZE                21170011
211800                               INTO WS008-CRA-RET-MSG             21180011
211900                 MOVE SQLCA     TO WS008-SQLCA                    21190011
212000                 SET WS008-INVALID-SQL TO TRUE                    21200011
212010                                                                  21201021
212020                 INITIALIZE  PV-CICS-MSG-AREA                     21202021
212030                 STRING                                           21203021
212040                         ' WSKCS312-5400- '                       21204021
212041                         ' SQL:'       PV-DISP-SQLCODE            21204122
212042                         ' PO:'        PV-DISP-PO-NBR             21204221
212080                                    DELIMITED BY SIZE             21208021
212090                               INTO PV-CICS-MSG-AREA              21209021
212091                 PERFORM 9999-WRITE-TO-CSSL                       21209121
212092                                                                  21209221
212100         END-EVALUATE                                             21210011
212200     END-PERFORM.                                                 21220011
212300                                                                  21230011
212400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21240011
212500             AND (SQLCODE = -904 OR -913)                         21250011
212600         MOVE DK-PO-NBR       TO PV-DISP-PO-NBR                   21260011
212700         MOVE SQLCODE TO PV-DISP-SQLCODE                          21270011
212800         STRING                                                   21280011
212900              ' 5400- MAX RETRIES SQL:'  PV-DISP-SQLCODE          21290021
213200              ' PO:'                     PV-DISP-PO-NBR           21320021
213300                         DELIMITED BY SIZE                        21330011
213400                       INTO WS008-CRA-RET-MSG                     21340011
213500         MOVE SQLCA     TO WS008-SQLCA                            21350011
213600         SET WS008-INVALID-SQL TO TRUE                            21360011
213610                                                                  21361021
213620         INITIALIZE  PV-CICS-MSG-AREA                             21362021
213630         STRING                                                   21363021
213640                         ' WSKCS312-5400- MAX RETRIES'            21364022
213641                         ' SQL:'       PV-DISP-SQLCODE            21364122
213650                         ' PO:'        PV-DISP-PO-NBR             21365021
213660                                    DELIMITED BY SIZE             21366021
213670                               INTO PV-CICS-MSG-AREA              21367021
213680         PERFORM 9999-WRITE-TO-CSSL                               21368021
213690                                                                  21369021
213700     END-IF.                                                      21370011
213701                                                                  21370129
213702                                                                  21370229
213703** DMH 11/11/14 BEGIN                                             21370329
213710     IF   PS-LOG-MESSAGE                                          21371029
213720          INITIALIZE  PV-CICS-MSG-AREA                            21372029
213730          STRING   ' WSKCS312-5400-  '                            21373029
213731                   ' PURITM-CL-NBR: '  PURITM-CL-NBR              21373129
213740                      DELIMITED BY SIZE                           21374029
213750                                      INTO PV-CICS-MSG-AREA       21375029
213760             PERFORM 9999-WRITE-TO-CSSL                           21376029
213770     END-IF.                                                      21377029
213771** DMH 11/11/14 BEGIN                                             21377129
213780                                                                  21378029
213800                                                                  21380011
213900/                                                                 21390011
214000*----------------------------------------------------------------*21400011
214100*  GET OPER-SET-ID FROM TCOCNTL                                  *21410011
214200*----------------------------------------------------------------*21420011
214300 5500-GET-OPER-SET-ID.                                            21430011
214310                                                                  21431020
214320     IF   PS-LOG-MESSAGE                                          21432020
214330          INITIALIZE  PV-CICS-MSG-AREA                            21433020
214340          STRING   ' WSKCS312-5500-GET-OPER-SET-ID         '      21434020
214350                      DELIMITED BY SIZE                           21435020
214360                                      INTO PV-CICS-MSG-AREA       21436020
214370             PERFORM 9999-WRITE-TO-CSSL                           21437020
214380     END-IF.                                                      21438020
214390                                                                  21439020
214391** DMH 11/11/14 DMH BEGIN                                         21439129
214392     IF   PS-LOG-MESSAGE                                          21439229
214393          MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID             21439329
214394          MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                21439429
214395          INITIALIZE  PV-CICS-MSG-AREA                            21439529
214396          STRING   ' WSKCS312-5500- '                             21439629
214397                   ' OPER UNIT:' PV-DISP-OPER-UNT-ID              21439729
214398                   ' FCLTY:'     PV-DISP-FCLTY-ID                 21439829
214399                      DELIMITED BY SIZE                           21439929
214400                                      INTO PV-CICS-MSG-AREA       21440029
214401             PERFORM 9999-WRITE-TO-CSSL                           21440129
214402     END-IF.                                                      21440229
214403** DMH 11/11/14 DMH END                                           21440329
214404                                                                  21440429
214410                                                                  21441011
214500     EXEC SQL                                                     21450011
214600          SELECT  DFLT_OPER_SET_ID                                21460011
214700            INTO :COCNTL-DFLT-OPER-SET-ID                         21470011
214800            FROM  TCOCNTL                                         21480011
214900           WHERE  OPER_UNT_ID    = :DK-OPER-UNT-ID                21490011
215000             AND  FCLTY_ID       = :DK-FCLTY-ID                   21500011
215100     END-EXEC.                                                    21510011
215200                                                                  21520011
215300     EVALUATE TRUE                                                21530011
215400         WHEN SQLCODE = +0                                        21540011
215500              CONTINUE                                            21550011
215600                                                                  21560011
215700         WHEN SQLCODE = +100                                      21570011
215800              MOVE  ZEROES  TO  COCNTL-DFLT-OPER-SET-ID           21580011
215900                                                                  21590011
216000         WHEN SQLWARN0 NOT = SPACES                               21600011
216100         WHEN SQLCODE < +0                                        21610011
216200         WHEN SQLCODE > +0                                        21620011
216300             MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID          21630011
216400             MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID             21640011
216500             MOVE SQLCODE TO PV-DISP-SQLCODE                      21650011
216600             STRING                                               21660011
216700                  ' 5500- SQL:'  PV-DISP-SQLCODE                  21670021
216900                  ' OPER:'       PV-DISP-OPER-UNT-ID              21690021
217200                  '-'            PV-DISP-FCLTY-ID                 21720021
217300                             DELIMITED BY SIZE                    21730011
217400                           INTO WS008-CRA-RET-MSG                 21740011
217500             MOVE SQLCA     TO WS008-SQLCA                        21750011
217600             SET WS008-INVALID-SQL TO TRUE                        21760011
217610                                                                  21761021
217620             INITIALIZE  PV-CICS-MSG-AREA                         21762021
217630             STRING                                               21763021
217640                         ' WSKCS312-5500- '                       21764021
217641                         ' SQL:'    PV-DISP-SQLCODE               21764122
217642                         ' OPER:'   PV-DISP-OPER-UNT-ID           21764221
217643                         '-'        PV-DISP-FCLTY-ID              21764321
217660                                    DELIMITED BY SIZE             21766021
217670                               INTO PV-CICS-MSG-AREA              21767021
217680             PERFORM 9999-WRITE-TO-CSSL                           21768021
217690                                                                  21769021
217700     END-EVALUATE.                                                21770011
217701                                                                  21770129
217710** DMH 11/11/14 DMH BEGIN                                         21771029
217720     IF   PS-LOG-MESSAGE                                          21772029
217730          MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID             21773029
217740          MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                21774029
217741          MOVE COCNTL-DFLT-OPER-SET-ID TO  PV-DISP-DFLT-OPER      21774129
217750          INITIALIZE  PV-CICS-MSG-AREA                            21775029
217760          STRING   ' WSKCS312-5500- '                             21776029
217770                   ' OPER UNIT:' PV-DISP-OPER-UNT-ID              21777029
217780                   ' FCLTY:'     PV-DISP-FCLTY-ID                 21778029
217781                   ' DFLT OPER:' PV-DISP-DFLT-OPER                21778129
217790                      DELIMITED BY SIZE                           21779029
217791                                      INTO PV-CICS-MSG-AREA       21779129
217792             PERFORM 9999-WRITE-TO-CSSL                           21779229
217793     END-IF.                                                      21779329
217794** DMH 11/11/14 DMH END                                           21779429
217800                                                                  21780011
217900 5600-INACTIVATE-TWRKORD.                                         21790011
217910                                                                  21791020
217920     IF   PS-LOG-MESSAGE                                          21792020
217930          INITIALIZE  PV-CICS-MSG-AREA                            21793020
217940          STRING   ' WSKCS312-5600-INACTIVATE-TWRKORD      '      21794020
217950                      DELIMITED BY SIZE                           21795020
217960                                      INTO PV-CICS-MSG-AREA       21796020
217970             PERFORM 9999-WRITE-TO-CSSL                           21797020
217971                                                                  21797133
217972          INITIALIZE  PV-CICS-MSG-AREA                            21797233
217973          MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR                  21797333
217974          MOVE WRKORD-RCVR-SEQ-NBR    TO PV-DISP-REC-SEQ          21797433
217976          MOVE WRKORD-ORD-LNE-NBR     TO PV-DISP-LNE-NBR          21797633
217978          MOVE WRKORD-OPER-UNT-ID     TO PV-DISP-OPER-UNT-ID      21797833
217980          MOVE WRKORD-FCLTY-ID        TO PV-DISP-FCLTY-ID         21798033
217982          STRING                                                  21798233
217983               ' WSKCS312-5600- '                                 21798333
217984               ' PO:'         PV-DISP-OPER-UNT-ID                 21798433
217985               '-'            PV-DISP-FCLTY-ID                    21798533
217986               '-'            PV-DISP-PO-NBR                      21798633
217987               '-'            PV-DISP-REC-SEQ                     21798733
217988               '-'            PV-DISP-LNE-NBR                     21798833
217989                              DELIMITED BY SIZE                   21798933
217990                         INTO PV-CICS-MSG-AREA                    21799033
217991          PERFORM 9999-WRITE-TO-CSSL                              21799133
217992     END-IF.                                                      21799220
217993                                                                  21799320
218000                                                                  21800011
218100         EXEC SQL                                                 21810011
218200           UPDATE TWRKORD                                         21820011
218300              SET VER_STATUS_CDE   =  'I'                         21830011
218400           WHERE                                                  21840011
218500                 ORD_NBR           = :WRKORD-ORD-NBR              21850011
218600            AND  RCVR_SEQ_NBR      = :WRKORD-RCVR-SEQ-NBR         21860011
218700            AND  ORD_LNE_NBR       = :WRKORD-ORD-LNE-NBR          21870011
218800            AND  WORK_ORD_SEQ_NBR  = :WRKORD-WORK-ORD-SEQ-NBR     21880011
218900            AND  OPER_UNT_ID       = :WRKORD-OPER-UNT-ID          21890011
219000            AND  FCLTY_ID          = :WRKORD-FCLTY-ID             21900011
219100         END-EXEC.                                                21910011
219200                                                                  21920011
219300         EVALUATE TRUE                                            21930011
219400             WHEN SQLCODE = +0                                    21940011
219500             WHEN SQLCODE = +100                                  21950011
219600                 CONTINUE                                         21960011
219700                                                                  21970011
219800             WHEN SQLWARN0 NOT = SPACES                           21980011
219900             WHEN SQLCODE < +0                                    21990011
220000             WHEN SQLCODE > +0                                    22000011
220100                 MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR           22010011
220200                 MOVE WRKORD-RCVR-SEQ-NBR                         22020011
220300                                      TO PV-DISP-REC-SEQ          22030011
220400                 MOVE WRKORD-ORD-LNE-NBR                          22040011
220500                                      TO PV-DISP-LNE-NBR          22050011
220600                 MOVE WRKORD-OPER-UNT-ID                          22060011
220700                                      TO PV-DISP-OPER-UNT-ID      22070011
220800                 MOVE WRKORD-FCLTY-ID TO PV-DISP-FCLTY-ID         22080011
220900                 MOVE SQLCODE TO PV-DISP-SQLCODE                  22090011
221000                 STRING                                           22100011
221100                      ' 5600- SQL:'  PV-DISP-SQLCODE              22110021
221300                      ' PO:'         PV-DISP-OPER-UNT-ID          22130021
221400                      '-'            PV-DISP-FCLTY-ID             22140021
221410                      '-'            PV-DISP-PO-NBR               22141021
221600                      '-'            PV-DISP-REC-SEQ              22160021
221800                      '-'            PV-DISP-LNE-NBR              22180021
222300                                 DELIMITED BY SIZE                22230011
222400                               INTO WS008-CRA-RET-MSG             22240011
222500                 MOVE SQLCA     TO WS008-SQLCA                    22250011
222600                 SET WS008-INVALID-SQL TO TRUE                    22260011
222610                                                                  22261021
222620             INITIALIZE  PV-CICS-MSG-AREA                         22262021
222630             STRING                                               22263021
222640                         ' WSKCS312-5600- '                       22264021
222641                         ' SQL:'     PV-DISP-SQLCODE              22264122
222642                         ' PO:'      PV-DISP-OPER-UNT-ID          22264221
222643                         '-'         PV-DISP-FCLTY-ID             22264321
222644                         '-'         PV-DISP-PO-NBR               22264421
222645                         '-'         PV-DISP-REC-SEQ              22264521
222646                         '-'         PV-DISP-LNE-NBR              22264621
222670                                    DELIMITED BY SIZE             22267021
222680                               INTO PV-CICS-MSG-AREA              22268021
222690             PERFORM 9999-WRITE-TO-CSSL                           22269021
222691                                                                  22269121
222700         END-EVALUATE.                                            22270011
222800/                                                                 22280011
222900 5700-INSERT-TWRKORD.                                             22290011
222910                                                                  22291020
222920     IF   PS-LOG-MESSAGE                                          22292020
222930          INITIALIZE  PV-CICS-MSG-AREA                            22293020
222940          STRING   ' WSKCS312-5700-INSERT-TWRKORD          '      22294020
222950                      DELIMITED BY SIZE                           22295020
222960                                      INTO PV-CICS-MSG-AREA       22296020
222970             PERFORM 9999-WRITE-TO-CSSL                           22297020
222971                                                                  22297133
222972          INITIALIZE  PV-CICS-MSG-AREA                            22297233
222973          MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR                  22297333
222974          MOVE WRKORD-RCVR-SEQ-NBR    TO PV-DISP-REC-SEQ          22297433
222976          MOVE WRKORD-ORD-LNE-NBR     TO PV-DISP-LNE-NBR          22297633
222978          MOVE WRKORD-OPER-UNT-ID     TO PV-DISP-OPER-UNT-ID      22297833
222980          MOVE WRKORD-FCLTY-ID        TO PV-DISP-FCLTY-ID         22298033
222982          STRING                                                  22298233
222983                  ' WSKCS312-5700- '                              22298333
222984                  ' PO:'         PV-DISP-OPER-UNT-ID              22298433
222985                  '-'            PV-DISP-FCLTY-ID                 22298533
222986                  '-'            PV-DISP-PO-NBR                   22298633
222987                  '-'            PV-DISP-REC-SEQ                  22298733
222988                  '-'            PV-DISP-LNE-NBR                  22298833
222989                                 DELIMITED BY SIZE                22298933
222990                            INTO PV-CICS-MSG-AREA                 22299033
222991             PERFORM 9999-WRITE-TO-CSSL                           22299133
222992     END-IF.                                                      22299220
222993                                                                  22299320
223000                                                                  22300011
223100     PERFORM                                                      22310011
223200         WITH TEST AFTER                                          22320011
223300         VARYING PV-RETRY-COUNTER                                 22330011
223400         FROM 1 BY 1                                              22340011
223500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22350011
223600             OR (SQLCODE = +0))                                   22360011
223700                                                                  22370011
223800         EXEC SQL                                                 22380011
223900              INSERT INTO TWRKORD                                 22390011
224000                     ( ORD_NBR                                    22400011
224100                      ,RCVR_SEQ_NBR                               22410011
224200                      ,ORD_LNE_NBR                                22420011
224300                      ,WORK_ORD_SEQ_NBR                           22430011
224400                      ,OPER_UNT_ID                                22440011
224500                      ,FCLTY_ID                                   22450011
224600                      ,CRE_TMST                                   22460011
224700                      ,VER_STATUS_CDE                             22470011
224800                      ,CRE_UID_ID                                 22480011
224900                      ,EXPTED_CART_CNT                            22490011
225000                      ,ACTL_CART_CNT                              22500011
225100                      ,EXPTED_ITM_CNT                             22510011
225200                      ,ACTL_ITM_CNT                               22520011
225300                      ,STAT_CDE                                   22530011
225400                      ,WORK_ORD_DISTR_IND                         22540011
225500                      ,OPER_SET_ID )                              22550011
225600              VALUES ( :WRKORD-ORD-NBR                            22560011
225700                      ,:WRKORD-RCVR-SEQ-NBR                       22570011
225800                      ,:WRKORD-ORD-LNE-NBR                        22580011
225900                      ,:WRKORD-WORK-ORD-SEQ-NBR                   22590011
226000                      ,:WRKORD-OPER-UNT-ID                        22600011
226100                      ,:WRKORD-FCLTY-ID                           22610011
226200                      ,CURRENT TIMESTAMP                          22620011
226300                      ,:WRKORD-VER-STATUS-CDE                     22630011
226400                      ,:WS008-SIGNON-USER-ID                      22640011
226500                      ,:WRKORD-EXPTED-CART-CNT                    22650011
226600                      ,:WRKORD-ACTL-CART-CNT                      22660011
226700                      ,:WRKORD-EXPTED-ITM-CNT                     22670011
226800                      ,:WRKORD-ACTL-ITM-CNT                       22680011
226900                      ,:WRKORD-STAT-CDE                           22690011
227000                      ,:WRKORD-WORK-ORD-DISTR-IND                 22700011
227100                      ,:WRKORD-OPER-SET-ID )                      22710011
227200         END-EXEC                                                 22720011
227300                                                                  22730011
227400         EVALUATE TRUE                                            22740011
227500             WHEN SQLCODE = +0                                    22750011
227600             WHEN SQLCODE = -904                                  22760011
227700             WHEN SQLCODE = -913                                  22770011
227800                 CONTINUE                                         22780011
227900                                                                  22790011
228000             WHEN SQLWARN0 NOT = SPACE                            22800011
228100             WHEN SQLCODE < +0                                    22810011
228200             WHEN SQLCODE > +0                                    22820011
228300                 MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR           22830011
228400                 MOVE WRKORD-RCVR-SEQ-NBR                         22840011
228500                                      TO PV-DISP-REC-SEQ          22850011
228600                 MOVE WRKORD-ORD-LNE-NBR                          22860011
228700                                      TO PV-DISP-LNE-NBR          22870011
228800                 MOVE WRKORD-OPER-UNT-ID                          22880011
228900                                      TO PV-DISP-OPER-UNT-ID      22890011
229000                 MOVE WRKORD-FCLTY-ID TO PV-DISP-FCLTY-ID         22900011
229100                 MOVE SQLCODE TO PV-DISP-SQLCODE                  22910011
229200                 STRING                                           22920011
229300                      ' 5700- SQL:'  PV-DISP-SQLCODE              22930021
229500                      ' PO:'         PV-DISP-OPER-UNT-ID          22950021
229510                      '-'            PV-DISP-FCLTY-ID             22951021
229600                      '-'            PV-DISP-PO-NBR               22960021
229800                      '-'            PV-DISP-REC-SEQ              22980021
230000                      '-'            PV-DISP-LNE-NBR              23000021
230500                                 DELIMITED BY SIZE                23050011
230600                               INTO WS008-CRA-RET-MSG             23060011
230700                 MOVE SQLCA     TO WS008-SQLCA                    23070011
230800                 SET WS008-INVALID-SQL TO TRUE                    23080011
230810                                                                  23081021
230820                 INITIALIZE  PV-CICS-MSG-AREA                     23082021
230830                 STRING                                           23083021
230840                         ' WSKCS312-5700- '                       23084021
230841                         ' SQL:'     PV-DISP-SQLCODE              23084125
230850                         ' PO:'      PV-DISP-OPER-UNT-ID          23085021
230860                         '-'         PV-DISP-FCLTY-ID             23086021
230870                         '-'         PV-DISP-PO-NBR               23087021
230880                         '-'         PV-DISP-REC-SEQ              23088021
230890                         '-'         PV-DISP-LNE-NBR              23089021
230891                                    DELIMITED BY SIZE             23089121
230892                               INTO PV-CICS-MSG-AREA              23089221
230893                 PERFORM 9999-WRITE-TO-CSSL                       23089321
230894                                                                  23089421
230900         END-EVALUATE                                             23090011
231000     END-PERFORM.                                                 23100011
231100                                                                  23110011
231200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23120011
231300             AND (SQLCODE NOT = +0)                               23130011
231400         MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR                   23140011
231500         MOVE WRKORD-RCVR-SEQ-NBR                                 23150011
231600                              TO PV-DISP-REC-SEQ                  23160011
231700         MOVE WRKORD-ORD-LNE-NBR                                  23170011
231800                              TO PV-DISP-LNE-NBR                  23180011
231900         MOVE WRKORD-OPER-UNT-ID                                  23190011
232000                              TO PV-DISP-OPER-UNT-ID              23200011
232100         MOVE WRKORD-FCLTY-ID TO PV-DISP-FCLTY-ID                 23210011
232200         MOVE SQLCODE TO PV-DISP-SQLCODE                          23220011
232300         STRING                                                   23230011
232400              ' 5700- SQL = ' PV-DISP-SQLCODE                     23240021
232420              ' PO:'          PV-DISP-OPER-UNT-ID                 23242021
232430              '-'             PV-DISP-FCLTY-ID                    23243021
232440              '-'             PV-DISP-PO-NBR                      23244021
232450              '-'             PV-DISP-REC-SEQ                     23245021
232460              '-'             PV-DISP-LNE-NBR                     23246021
233600                         DELIMITED BY SIZE                        23360011
233700                       INTO WS008-CRA-RET-MSG                     23370011
233800         MOVE SQLCA     TO WS008-SQLCA                            23380011
233900         SET WS008-INVALID-SQL TO TRUE                            23390011
233910                                                                  23391021
233920         INITIALIZE  PV-CICS-MSG-AREA                             23392021
233930         STRING                                                   23393021
233940                         ' WSKCS312-5700- '                       23394021
233941                         ' SQL:'        PV-DISP-SQLCODE           23394125
233950                         ' PO:'      PV-DISP-OPER-UNT-ID          23395021
233960                         '-'         PV-DISP-FCLTY-ID             23396021
233970                         '-'         PV-DISP-PO-NBR               23397021
233980                         '-'         PV-DISP-REC-SEQ              23398021
233990                         '-'         PV-DISP-LNE-NBR              23399021
233991                                    DELIMITED BY SIZE             23399121
233992                               INTO PV-CICS-MSG-AREA              23399221
233993         PERFORM 9999-WRITE-TO-CSSL                               23399321
233994                                                                  23399421
234000     END-IF.                                                      23400011
234100                                                                  23410011
234200/                                                                 23420011
234300*----------------------------------------------------------------*23430011
234400* OPEN THE TOSOPFA CURSOR                                        *23440011
234500*----------------------------------------------------------------*23450011
234600                                                                  23460011
234700 5800-OPEN-TOSOPFA-CSR.                                           23470011
234710                                                                  23471020
234720     IF   PS-LOG-MESSAGE                                          23472020
234730          INITIALIZE  PV-CICS-MSG-AREA                            23473020
234740          STRING   ' WSKCS312-5800-OPEN-TOSOPFA-CSR        '      23474020
234750                      DELIMITED BY SIZE                           23475020
234760                                      INTO PV-CICS-MSG-AREA       23476020
234770          PERFORM 9999-WRITE-TO-CSSL                              23477033
234771                                                                  23477133
234772          INITIALIZE  PV-CICS-MSG-AREA                            23477233
234773          MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET                23477333
234774          MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID             23477433
234775          MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                23477533
234776          STRING                                                  23477633
234777                  ' WSKCS312-5800- '                              23477733
234778                  ' OPER SET:'   PV-DISP-OPER-SET                 23477833
234779                  ' OPER:'       PV-DISP-OPER-UNT-ID              23477933
234780                  '-'            PV-DISP-FCLTY-ID                 23478033
234781                                 DELIMITED BY SIZE                23478133
234782                            INTO PV-CICS-MSG-AREA                 23478233
234783          PERFORM 9999-WRITE-TO-CSSL                              23478333
234784     END-IF.                                                      23478420
234790                                                                  23479020
234800                                                                  23480011
234900     EXEC SQL                                                     23490011
235000          DECLARE TOSOPFA-CSR CURSOR FOR                          23500011
235100           SELECT OPER_SET_ID                                     23510011
235200                 ,OPER_ID                                         23520011
235300                 ,OPER_UNT_ID                                     23530011
235400                 ,FCLTY_ID                                        23540011
235500                 ,FCLTY_AREA_ID                                   23550011
235600                 ,PRC_FCLTY_AREA_ID                               23560011
235700                 ,SCRN_SEQ_NBR                                    23570011
235800           FROM   TOSOPFA                                         23580011
235900           WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                23590011
236000             AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                23600011
236100             AND  FCLTY_ID       = :DK-FCLTY-ID                   23610011
236200             AND  VER_STATUS_CDE = 'A'                            23620011
236300           ORDER BY SCRN_SEQ_NBR                                  23630011
236400     END-EXEC.                                                    23640011
236500                                                                  23650011
236600     PERFORM                                                      23660011
236700         WITH TEST AFTER                                          23670011
236800         VARYING PV-RETRY-COUNTER                                 23680011
236900         FROM 1 BY 1                                              23690011
237000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23700011
237100            OR (SQLCODE = +0))                                    23710011
237200                                                                  23720011
237300         EXEC SQL                                                 23730011
237400              OPEN TOSOPFA-CSR                                    23740011
237500         END-EXEC                                                 23750011
237600                                                                  23760011
237700         EVALUATE TRUE                                            23770011
237800             WHEN SQLCODE = +0                                    23780011
237900                  CONTINUE                                        23790011
238000             WHEN SQLCODE = -904                                  23800011
238100             WHEN SQLCODE = -913                                  23810011
238200                  CONTINUE                                        23820011
238300             WHEN SQLWARN0 NOT = SPACE                            23830011
238400             WHEN SQLCODE  NOT = +0                               23840011
238500                 MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET         23850011
238510                 MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID      23851021
238520                 MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID         23852021
238600                 MOVE SQLCODE TO PV-DISP-SQLCODE                  23860011
238700                 STRING                                           23870011
238800                      ' 5800- SQL:'  PV-DISP-SQLCODE              23880021
239000                      ' OPER SET:'   PV-DISP-OPER-SET             23900021
239100                      ' OPER:'       PV-DISP-OPER-UNT-ID          23910021
239110                      '-'            PV-DISP-FCLTY-ID             23911021
239200                                 DELIMITED BY SIZE                23920011
239300                               INTO WS008-CRA-RET-MSG             23930011
239400                 MOVE SQLCA     TO WS008-SQLCA                    23940011
239500                 SET WS008-INVALID-SQL TO TRUE                    23950011
239510                                                                  23951021
239520                 INITIALIZE  PV-CICS-MSG-AREA                     23952021
239530                 STRING                                           23953021
239540                         ' WSKCS312-5800- '                       23954021
239541                         ' SQL:'        PV-DISP-SQLCODE           23954125
239542                         ' OPER SET:'   PV-DISP-OPER-SET          23954221
239543                         ' OPER:'       PV-DISP-OPER-UNT-ID       23954321
239544                         '-'            PV-DISP-FCLTY-ID          23954421
239591                                    DELIMITED BY SIZE             23959121
239592                               INTO PV-CICS-MSG-AREA              23959221
239593                 PERFORM 9999-WRITE-TO-CSSL                       23959321
239594                                                                  23959421
239600         END-EVALUATE                                             23960011
239700     END-PERFORM.                                                 23970011
239800                                                                  23980011
239900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23990011
240000             AND (SQLCODE NOT = +0)                               24000011
240100         MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET                 24010011
240110         MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID              24011021
240120         MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                 24012021
240200         MOVE SQLCODE TO PV-DISP-SQLCODE                          24020011
240300         STRING                                                   24030011
240400              ' 5800- SQL:'  PV-DISP-SQLCODE                      24040021
240710              ' OPER SET:'   PV-DISP-OPER-SET                     24071021
240720              ' OPER:'       PV-DISP-OPER-UNT-ID                  24072021
240730              '-'            PV-DISP-FCLTY-ID                     24073021
240800                         DELIMITED BY SIZE                        24080011
240900                       INTO WS008-CRA-RET-MSG                     24090011
241000         MOVE SQLCA     TO WS008-SQLCA                            24100011
241100         SET WS008-INVALID-SQL TO TRUE                            24110011
241110                                                                  24111021
241120         INITIALIZE  PV-CICS-MSG-AREA                             24112021
241130         STRING                                                   24113021
241140                         ' WSKCS312-5800- '                       24114021
241141                         ' SQL:'        PV-DISP-SQLCODE           24114125
241150                         ' OPER SET:'   PV-DISP-OPER-SET          24115021
241160                         ' OPER:'       PV-DISP-OPER-UNT-ID       24116021
241170                         '-'            PV-DISP-FCLTY-ID          24117021
241180                                    DELIMITED BY SIZE             24118021
241190                               INTO PV-CICS-MSG-AREA              24119021
241191         PERFORM 9999-WRITE-TO-CSSL                               24119121
241192                                                                  24119221
241200     END-IF.                                                      24120011
241300                                                                  24130011
241400/                                                                 24140011
241500*----------------------------------------------------------------*24150011
241600*    FETCH A TOSOPFA ROW                                         *24160011
241700*----------------------------------------------------------------*24170011
241800                                                                  24180011
241900 5820-FETCH-TOSOPFA-CSR.                                          24190011
241910                                                                  24191020
241920     IF   PS-LOG-MESSAGE                                          24192020
241930          INITIALIZE  PV-CICS-MSG-AREA                            24193020
241940          STRING   ' WSKCS312-5820-FETCH-TOSOPFA-CSR       '      24194020
241950                      DELIMITED BY SIZE                           24195020
241960                                      INTO PV-CICS-MSG-AREA       24196020
241970          PERFORM 9999-WRITE-TO-CSSL                              24197033
241971                                                                  24197133
241972          INITIALIZE  PV-CICS-MSG-AREA                            24197233
241973          MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET                24197333
241974          MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID             24197433
241975          MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                24197533
241976          STRING                                                  24197633
241977                 ' WSKCS312-5820- '                               24197733
241978                 ' OPER SET:'   PV-DISP-OPER-SET                  24197833
241979                 ' OPER:'       PV-DISP-OPER-UNT-ID               24197933
241980                 '-'            PV-DISP-FCLTY-ID                  24198033
241981                                DELIMITED BY SIZE                 24198133
241982                           INTO PV-CICS-MSG-AREA                  24198233
241983          PERFORM 9999-WRITE-TO-CSSL                              24198333
241984     END-IF.                                                      24198420
241990                                                                  24199020
242000                                                                  24200011
242100     EXEC SQL                                                     24210011
242200          FETCH TOSOPFA-CSR                                       24220011
242300          INTO :OSOPFA-OPER-SET-ID                                24230011
242400              ,:OSOPFA-OPER-ID                                    24240011
242500              ,:OSOPFA-OPER-UNT-ID                                24250011
242600              ,:OSOPFA-FCLTY-ID                                   24260011
242700              ,:OSOPFA-FCLTY-AREA-ID                              24270011
242800              ,:OSOPFA-PRC-FCLTY-AREA-ID                          24280011
242900              ,:OSOPFA-SCRN-SEQ-NBR                               24290011
243000     END-EXEC                                                     24300011
243100                                                                  24310011
243200     EVALUATE TRUE                                                24320011
243300         WHEN SQLCODE = +0                                        24330011
243400              CONTINUE                                            24340011
243500                                                                  24350011
243600         WHEN SQLCODE = +100                                      24360011
243700              SET PS-EOF-TOSOPFA-CSR TO TRUE                      24370011
243800                                                                  24380011
243900         WHEN SQLWARN0 NOT = SPACE                                24390011
244000         WHEN SQLCODE < +0                                        24400011
244100         WHEN SQLCODE > +0                                        24410011
244200             MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET             24420011
244220             MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID          24422021
244230             MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID             24423021
244300             MOVE SQLCODE TO PV-DISP-SQLCODE                      24430011
244400             STRING                                               24440011
244500                  ' 5820- SQL:'  PV-DISP-SQLCODE                  24450021
244600                  ' OPER SET:'   PV-DISP-OPER-SET                 24460021
244610                  ' OPER:'       PV-DISP-OPER-UNT-ID              24461021
244620                  '-'            PV-DISP-FCLTY-ID                 24462021
244900                             DELIMITED BY SIZE                    24490011
245000                           INTO WS008-CRA-RET-MSG                 24500011
245100             MOVE SQLCA     TO WS008-SQLCA                        24510011
245200             SET WS008-INVALID-SQL TO TRUE                        24520011
245210                                                                  24521021
245220             INITIALIZE  PV-CICS-MSG-AREA                         24522021
245230             STRING                                               24523021
245240                         ' WSKCS312-5820- '                       24524021
245241                         ' SQL:'        PV-DISP-SQLCODE           24524125
245250                         ' OPER SET:'   PV-DISP-OPER-SET          24525021
245260                         ' OPER:'       PV-DISP-OPER-UNT-ID       24526021
245270                         '-'            PV-DISP-FCLTY-ID          24527021
245280                                    DELIMITED BY SIZE             24528021
245290                               INTO PV-CICS-MSG-AREA              24529021
245291             PERFORM 9999-WRITE-TO-CSSL                           24529121
245292                                                                  24529221
245300     END-EVALUATE.                                                24530011
245400                                                                  24540011
245500/                                                                 24550011
245600*----------------------------------------------------------------*24560011
245700* CLOSE THE TOSOPFA CURSOR                                       *24570011
245800*----------------------------------------------------------------*24580011
245900                                                                  24590011
246000 5840-CLOSE-TOSOPFA-CSR.                                          24600011
246010                                                                  24601020
246020     IF   PS-LOG-MESSAGE                                          24602020
246030          INITIALIZE  PV-CICS-MSG-AREA                            24603020
246040          STRING   ' WSKCS312-5840-CLOSE-TOSOPFA-CSR       '      24604022
246050                      DELIMITED BY SIZE                           24605020
246060                                      INTO PV-CICS-MSG-AREA       24606020
246070          PERFORM 9999-WRITE-TO-CSSL                              24607033
246071                                                                  24607133
246072          INITIALIZE  PV-CICS-MSG-AREA                            24607233
246073          MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET                24607333
246074          MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID             24607433
246075          MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID                24607533
246076          STRING                                                  24607633
246077                 ' WSKCS312-5840- '                               24607733
246078                 ' OPER SET:'   PV-DISP-OPER-SET                  24607833
246079                 ' OPER:'       PV-DISP-OPER-UNT-ID               24607933
246080                 '-'            PV-DISP-FCLTY-ID                  24608033
246081                                DELIMITED BY SIZE                 24608133
246082                          INTO PV-CICS-MSG-AREA                   24608233
246083          PERFORM 9999-WRITE-TO-CSSL                              24608333
246084     END-IF.                                                      24608420
246090                                                                  24609020
246100                                                                  24610011
246200     EXEC SQL                                                     24620011
246300          CLOSE TOSOPFA-CSR                                       24630011
246400     END-EXEC                                                     24640011
246500                                                                  24650011
246600     EVALUATE TRUE                                                24660011
246700         WHEN SQLCODE = +0                                        24670011
246800              CONTINUE                                            24680011
246900         WHEN SQLWARN0 NOT = SPACE                                24690011
247000         WHEN SQLCODE  NOT = +0                                   24700011
247100             MOVE DK-OPER-SET-ID  TO PV-DISP-OPER-SET             24710011
247120             MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID          24712021
247130             MOVE DK-FCLTY-ID     TO PV-DISP-FCLTY-ID             24713021
247200             MOVE SQLCODE TO PV-DISP-SQLCODE                      24720011
247300             STRING                                               24730011
247400                  ' 5840- SQL:'  PV-DISP-SQLCODE                  24740025
247710                  ' OPER SET:'   PV-DISP-OPER-SET                 24771021
247720                  ' OPER:'       PV-DISP-OPER-UNT-ID              24772021
247730                  '-'            PV-DISP-FCLTY-ID                 24773021
247800                             DELIMITED BY SIZE                    24780011
247900                           INTO WS008-CRA-RET-MSG                 24790011
248000             MOVE SQLCA     TO WS008-SQLCA                        24800011
248100             SET WS008-INVALID-SQL TO TRUE                        24810011
248110                                                                  24811021
248120             INITIALIZE  PV-CICS-MSG-AREA                         24812021
248130             STRING                                               24813021
248140                         ' WSKCS312-5840- '                       24814021
248141                         ' SQL:'        PV-DISP-SQLCODE           24814125
248150                         ' OPER SET:'   PV-DISP-OPER-SET          24815021
248160                         ' OPER:'       PV-DISP-OPER-UNT-ID       24816021
248170                         '-'            PV-DISP-FCLTY-ID          24817021
248180                                    DELIMITED BY SIZE             24818021
248190                               INTO PV-CICS-MSG-AREA              24819021
248191             PERFORM 9999-WRITE-TO-CSSL                           24819121
248192                                                                  24819221
248200     END-EVALUATE.                                                24820011
248300                                                                  24830011
248400                                                                  24840011
248500 5900-BUILD-WORK-ORDER-INSTR.                                     24850011
248510                                                                  24851020
248520     IF   PS-LOG-MESSAGE                                          24852020
248530          INITIALIZE  PV-CICS-MSG-AREA                            24853020
248540          STRING   ' WSKCS312-5900-BUILD-WORK-ORDER-INSTR  '      24854020
248550                      DELIMITED BY SIZE                           24855020
248560                                      INTO PV-CICS-MSG-AREA       24856020
248570             PERFORM 9999-WRITE-TO-CSSL                           24857020
248580     END-IF.                                                      24858020
248590                                                                  24859020
248600                                                                  24860011
248700     INITIALIZE DCLTWKORIN.                                       24870011
248800                                                                  24880011
248900     MOVE WS008-PO-NUMBER        TO WKORIN-ORD-NBR.               24890011
249000     MOVE WS008-NEW-REC-SEQ-NBR  TO WKORIN-RCVR-SEQ-NBR.          24900011
249100     MOVE +1                     TO WKORIN-WORK-ORD-SEQ-NBR.      24910011
249200     ADD +1                      TO PV-WO-INSTR-SEQ-NBR.          24920011
249300     MOVE PV-WO-INSTR-SEQ-NBR    TO WKORIN-WO-INSTR-SEQ-NBR.      24930011
249400     MOVE 'A'                    TO WKORIN-VER-STATUS-CDE.        24940011
249500     MOVE WRKORD-OPER-UNT-ID     TO WKORIN-OPER-UNT-ID.           24950011
249600     MOVE 1                      TO WKORIN-FCLTY-ID.              24960011
249700     MOVE OSOPFA-OPER-ID         TO WKORIN-OPER-ID.               24970011
249800     MOVE OSOPFA-FCLTY-AREA-ID   TO WKORIN-FCLTY-AREA-ID.         24980011
249900     MOVE OSOPFA-PRC-FCLTY-AREA-ID                                24990011
250000                                 TO WKORIN-PRC-FCLTY-AREA-ID.     25000011
250100     MOVE OSOPFA-SCRN-SEQ-NBR    TO WKORIN-SCREEN-SEQ-NBR.        25010011
250200     MOVE 'N'                    TO PS-INSTRUCTION-SW.            25020011
250300     MOVE 1                      TO WKORIN-EXPTED-CART-CNT.       25030011
250400     MOVE ZERO                   TO WKORIN-ACTL-CART-CNT.         25040011
250500     MOVE 'N'                    TO WKORIN-ALLOC-IND              25050011
250600                                    WKORIN-REPACK-IND.            25060011
250700     MOVE '9999-09-09-09.09.09.000000'                            25070011
250800                                 TO WKORIN-STRT-TMST              25080011
250900                                    WKORIN-STOP-TMST.             25090011
251000                                                                  25100011
251100     PERFORM 5920-INACTIVATE-TWKORIN.                             25110011
251200     PERFORM 5940-INSERT-TWKORIN.                                 25120011
251300                                                                  25130011
251400 5920-INACTIVATE-TWKORIN.                                         25140011
251410                                                                  25141020
251420     IF   PS-LOG-MESSAGE                                          25142020
251430          INITIALIZE  PV-CICS-MSG-AREA                            25143020
251440          STRING   ' WSKCS312-5920-INACTIVATE-TWKORIN      '      25144020
251450                      DELIMITED BY SIZE                           25145020
251460                                      INTO PV-CICS-MSG-AREA       25146020
251470          PERFORM 9999-WRITE-TO-CSSL                              25147033
251471                                                                  25147133
251472          INITIALIZE  PV-CICS-MSG-AREA                            25147233
251473          MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR              25147333
251474          MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ             25147433
251475          MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR             25147533
251476          MOVE WKORIN-WORK-ORD-SEQ-NBR                            25147633
251477                                   TO PV-DISP-WO-SEQ-NBR          25147733
251478          MOVE WKORIN-WO-INSTR-SEQ-NBR                            25147833
251479                                   TO PV-DISP-WO-INSTR-SEQ-NBR    25147933
251480          STRING                                                  25148033
251481                 ' WSKCS312-5920- '                               25148133
251482                 ' PO:'         PV-DISP-PO-NBR                    25148233
251483                 '-'            PV-DISP-REC-SEQ                   25148333
251484                 '-'            PV-DISP-LNE-NBR                   25148433
251485                 ' WO SEQ:'     PV-DISP-WO-SEQ-NBR                25148533
251486                 ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR          25148633
251487                                DELIMITED BY SIZE                 25148733
251488                           INTO PV-CICS-MSG-AREA                  25148833
251489          PERFORM 9999-WRITE-TO-CSSL                              25148933
251490     END-IF.                                                      25149020
251491                                                                  25149120
251500                                                                  25150011
251600     EXEC SQL                                                     25160011
251700          UPDATE                                                  25170011
251800                 TWKORIN                                          25180011
251900             SET                                                  25190011
252000                 VER_STATUS_CDE      =  'I'                       25200011
252100           WHERE                                                  25210011
252200                 ORD_NBR             =  :WKORIN-ORD-NBR           25220011
252300             AND RCVR_SEQ_NBR        =  :WKORIN-RCVR-SEQ-NBR      25230011
252400             AND ORD_LNE_NBR         =  :WKORIN-ORD-LNE-NBR       25240011
252500             AND WORK_ORD_SEQ_NBR    =  :WKORIN-WORK-ORD-SEQ-NBR  25250011
252600             AND WO_INSTR_SEQ_NBR    =  :WKORIN-WO-INSTR-SEQ-NBR  25260011
252700             AND VER_STATUS_CDE      =  'A'                       25270011
252800     END-EXEC.                                                    25280011
252900                                                                  25290011
253000     EVALUATE TRUE                                                25300011
253100         WHEN SQLCODE = ZERO                                      25310011
253200         WHEN SQLCODE = +100                                      25320011
253300              CONTINUE                                            25330011
253400         WHEN SQLWARN0 NOT = SPACES                               25340011
253500         WHEN SQLCODE NOT EQUAL ZERO                              25350011
253600             MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR           25360011
253700             MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ          25370011
253800             MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR          25380011
253900             MOVE WKORIN-WORK-ORD-SEQ-NBR                         25390011
254000                                      TO PV-DISP-WO-SEQ-NBR       25400011
254100             MOVE WKORIN-WO-INSTR-SEQ-NBR                         25410011
254200                                      TO PV-DISP-WO-INSTR-SEQ-NBR 25420011
254300             MOVE SQLCODE TO PV-DISP-SQLCODE                      25430011
254400             STRING                                               25440011
254500                  ' 5920- SQL:'  PV-DISP-SQLCODE                  25450026
254700                  ' PO:'         PV-DISP-PO-NBR                   25470021
255000                  '-'            PV-DISP-REC-SEQ                  25500021
255200                  '-'            PV-DISP-LNE-NBR                  25520021
255400                  ' WO SEQ:'     PV-DISP-WO-SEQ-NBR               25540021
255600                  ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR         25560021
255700                             DELIMITED BY SIZE                    25570011
255800                           INTO WS008-CRA-RET-MSG                 25580011
255900             MOVE SQLCA     TO WS008-SQLCA                        25590011
256000             SET WS008-INVALID-SQL TO TRUE                        25600011
256010                                                                  25601022
256020             INITIALIZE  PV-CICS-MSG-AREA                         25602022
256030             STRING                                               25603022
256040                         ' WSKCS312-5920- '                       25604022
256050                         ' SQL:'        PV-DISP-SQLCODE           25605025
256051                         ' PO:'         PV-DISP-PO-NBR            25605122
256052                         '-'            PV-DISP-REC-SEQ           25605222
256053                         '-'            PV-DISP-LNE-NBR           25605322
256054                         ' WO SEQ:'     PV-DISP-WO-SEQ-NBR        25605422
256055                         ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR  25605522
256090                                    DELIMITED BY SIZE             25609022
256091                               INTO PV-CICS-MSG-AREA              25609122
256092             PERFORM 9999-WRITE-TO-CSSL                           25609222
256093                                                                  25609322
256100     END-EVALUATE.                                                25610011
256200/                                                                 25620011
256300 5940-INSERT-TWKORIN.                                             25630011
256310                                                                  25631020
256320     IF   PS-LOG-MESSAGE                                          25632020
256330          INITIALIZE  PV-CICS-MSG-AREA                            25633020
256340          STRING   ' WSKCS312-5940-INSERT-TWKORIN          '      25634020
256350                      DELIMITED BY SIZE                           25635020
256360                                      INTO PV-CICS-MSG-AREA       25636020
256370          PERFORM 9999-WRITE-TO-CSSL                              25637033
256371                                                                  25637133
256372          INITIALIZE  PV-CICS-MSG-AREA                            25637233
256373          MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR              25637333
256374          MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ             25637433
256375          MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR             25637533
256376          MOVE WKORIN-WORK-ORD-SEQ-NBR                            25637633
256377                                   TO PV-DISP-WO-SEQ-NBR          25637733
256378          MOVE WKORIN-WO-INSTR-SEQ-NBR                            25637833
256379                                   TO PV-DISP-WO-INSTR-SEQ-NBR    25637933
256380          STRING                                                  25638033
256381                 ' WSKCS312-5940- '                               25638133
256382                 ' PO:'         PV-DISP-PO-NBR                    25638233
256383                 '-'            PV-DISP-REC-SEQ                   25638333
256384                 '-'            PV-DISP-LNE-NBR                   25638433
256385                 ' WO SEQ:'     PV-DISP-WO-SEQ-NBR                25638533
256386                 ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR          25638633
256387                                DELIMITED BY SIZE                 25638733
256388                           INTO PV-CICS-MSG-AREA                  25638833
256389          PERFORM 9999-WRITE-TO-CSSL                              25638933
256390     END-IF.                                                      25639020
256391                                                                  25639120
256400                                                                  25640011
256500     PERFORM                                                      25650011
256600         WITH TEST AFTER                                          25660011
256700         VARYING PV-RETRY-COUNTER                                 25670011
256800         FROM 1 BY 1                                              25680011
256900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25690011
257000             OR (SQLCODE = +0))                                   25700011
257100                                                                  25710011
257200         EXEC SQL                                                 25720011
257300              INSERT INTO TWKORIN                                 25730011
257400                     ( ORD_NBR                                    25740011
257500                      ,RCVR_SEQ_NBR                               25750011
257600                      ,ORD_LNE_NBR                                25760011
257700                      ,WORK_ORD_SEQ_NBR                           25770011
257800                      ,OPER_UNT_ID                                25780011
257900                      ,FCLTY_ID                                   25790011
258000                      ,WO_INSTR_SEQ_NBR                           25800011
258100                      ,CRE_TMST                                   25810011
258200                      ,VER_STATUS_CDE                             25820011
258300                      ,CRE_UID_ID                                 25830011
258400                      ,OPER_ID                                    25840011
258500                      ,FCLTY_AREA_ID                              25850011
258600                      ,PRC_FCLTY_AREA_ID                          25860011
258700                      ,EXPTED_CART_CNT                            25870011
258800                      ,ACTL_CART_CNT                              25880011
258900                      ,ALLOC_IND                                  25890011
259000                      ,REPACK_IND                                 25900011
259100                      ,STRT_TMST                                  25910011
259200                      ,STOP_TMST                                  25920011
259300                      ,SCREEN_SEQ_NBR                             25930011
259400                      ,LNE_LOC_CDE                                25940011
259500                      ,REC_SEL_IND )                              25950011
259600              VALUES ( :WKORIN-ORD-NBR                            25960011
259700                      ,:WKORIN-RCVR-SEQ-NBR                       25970011
259800                      ,:WKORIN-ORD-LNE-NBR                        25980011
259900                      ,:WKORIN-WORK-ORD-SEQ-NBR                   25990011
260000                      ,:WKORIN-OPER-UNT-ID                        26000011
260100                      ,:WKORIN-FCLTY-ID                           26010011
260200                      ,:WKORIN-WO-INSTR-SEQ-NBR                   26020011
260300                      ,CURRENT TIMESTAMP                          26030011
260400                      ,:WKORIN-VER-STATUS-CDE                     26040011
260500                      ,:WS008-SIGNON-USER-ID                      26050011
260600                      ,:WKORIN-OPER-ID                            26060011
260700                      ,:WKORIN-FCLTY-AREA-ID                      26070011
260800                      ,:WKORIN-PRC-FCLTY-AREA-ID                  26080011
260900                      ,:WKORIN-EXPTED-CART-CNT                    26090011
261000                      ,:WKORIN-ACTL-CART-CNT                      26100011
261100                      ,:WKORIN-ALLOC-IND                          26110011
261200                      ,:WKORIN-REPACK-IND                         26120011
261300                      ,:WKORIN-STRT-TMST                          26130011
261400                      ,:WKORIN-STOP-TMST                          26140011
261500                      ,:WKORIN-SCREEN-SEQ-NBR                     26150011
261600                      ,:WKORIN-LNE-LOC-CDE                        26160011
261700                      ,:WKORIN-REC-SEL-IND )                      26170011
261800         END-EXEC                                                 26180011
261900                                                                  26190011
262000         EVALUATE TRUE                                            26200011
262100             WHEN SQLCODE = +0                                    26210011
262200             WHEN SQLCODE = -904                                  26220011
262300             WHEN SQLCODE = -913                                  26230011
262400                 CONTINUE                                         26240011
262500                                                                  26250011
262600             WHEN SQLWARN0 NOT = SPACE                            26260011
262700             WHEN SQLCODE < +0                                    26270011
262800             WHEN SQLCODE > +0                                    26280011
262900                 MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR       26290011
263000                 MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      26300011
263100                 MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      26310011
263200                 MOVE WKORIN-WORK-ORD-SEQ-NBR                     26320011
263300                                      TO PV-DISP-WO-SEQ-NBR       26330011
263400                 MOVE WKORIN-WO-INSTR-SEQ-NBR                     26340011
263500                                      TO PV-DISP-WO-INSTR-SEQ-NBR 26350011
263600                 MOVE SQLCODE TO PV-DISP-SQLCODE                  26360011
263700                 STRING                                           26370011
263800                      ' 5940- SQL:'  PV-DISP-SQLCODE              26380021
264100                      ' PO:'         PV-DISP-PO-NBR               26410021
264300                      '-'            PV-DISP-REC-SEQ              26430021
264500                      '-'            PV-DISP-LNE-NBR              26450021
264700                      ' WO SEQ:'     PV-DISP-WO-SEQ-NBR           26470021
264900                      ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR     26490021
265000                                 DELIMITED BY SIZE                26500011
265100                               INTO WS008-CRA-RET-MSG             26510011
265200                 MOVE SQLCA     TO WS008-SQLCA                    26520011
265300                 SET WS008-INVALID-SQL TO TRUE                    26530011
265310                                                                  26531022
265320                 INITIALIZE  PV-CICS-MSG-AREA                     26532022
265330                 STRING                                           26533022
265340                         ' WSKCS312-5940- '                       26534022
265350                         ' SQL:'        PV-DISP-SQLCODE           26535025
265351                         ' PO:'         PV-DISP-PO-NBR            26535122
265352                         '-'            PV-DISP-REC-SEQ           26535222
265353                         '-'            PV-DISP-LNE-NBR           26535322
265354                         ' WO SEQ:'     PV-DISP-WO-SEQ-NBR        26535422
265355                         ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR  26535522
265392                                    DELIMITED BY SIZE             26539222
265393                               INTO PV-CICS-MSG-AREA              26539322
265394                 PERFORM 9999-WRITE-TO-CSSL                       26539422
265395                                                                  26539522
265400         END-EVALUATE                                             26540011
265500     END-PERFORM.                                                 26550011
265600                                                                  26560011
265700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26570011
265800             AND (SQLCODE NOT = +0)                               26580011
265810                 MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR       26581021
265820                 MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ      26582021
265830                 MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      26583021
265840                 MOVE WKORIN-WORK-ORD-SEQ-NBR                     26584021
265850                                      TO PV-DISP-WO-SEQ-NBR       26585021
265860                 MOVE WKORIN-WO-INSTR-SEQ-NBR                     26586021
265870                                      TO PV-DISP-WO-INSTR-SEQ-NBR 26587021
265880                 MOVE SQLCODE TO PV-DISP-SQLCODE                  26588021
265900         STRING                                                   26590011
266000              '5940-MAX RETRIES'                                  26600021
266192              ' SQL:'        PV-DISP-SQLCODE                      26619221
266193              ' PO:'         PV-DISP-PO-NBR                       26619321
266194              '-'            PV-DISP-REC-SEQ                      26619421
266195              '-'            PV-DISP-LNE-NBR                      26619521
266196              ' WO SEQ:'     PV-DISP-WO-SEQ-NBR                   26619621
266197              ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR             26619721
266198                             DELIMITED BY SIZE                    26619821
266300                               INTO WS008-CRA-RET-MSG             26630011
266400         MOVE SQLCA     TO WS008-SQLCA                            26640011
266500         SET WS008-INVALID-SQL TO TRUE                            26650011
266510                                                                  26651022
266520         INITIALIZE  PV-CICS-MSG-AREA                             26652022
266530         STRING                                                   26653022
266540                         ' WSKCS312-5940- MAX RETRIES'            26654022
266550                         ' SQL:'        PV-DISP-SQLCODE           26655025
266560                         ' PO:'         PV-DISP-PO-NBR            26656022
266570                         '-'            PV-DISP-REC-SEQ           26657022
266580                         '-'            PV-DISP-LNE-NBR           26658022
266590                         ' WO SEQ:'     PV-DISP-WO-SEQ-NBR        26659022
266591                         ' WO INST:'    PV-DISP-WO-INSTR-SEQ-NBR  26659122
266592                                    DELIMITED BY SIZE             26659222
266593                               INTO PV-CICS-MSG-AREA              26659322
266594         PERFORM 9999-WRITE-TO-CSSL                               26659422
266595                                                                  26659522
266600     END-IF.                                                      26660011
266700                                                                  26670011
266800*----------------------------------------------------------------*26680011
266900*  INSERT THE PO TO THE SHIPEMENT PO ASSOCIATION TABLE            26690011
267000*----------------------------------------------------------------*26700011
267100 6000-INSERT-TSHPTPO.                                             26710011
267110                                                                  26711020
267120     IF   PS-LOG-MESSAGE                                          26712020
267130          INITIALIZE  PV-CICS-MSG-AREA                            26713020
267140          STRING   ' WSKCS312-6000-INSERT-TSHPTPO          '      26714020
267150                      DELIMITED BY SIZE                           26715020
267160                                      INTO PV-CICS-MSG-AREA       26716020
267170             PERFORM 9999-WRITE-TO-CSSL                           26717020
267180     END-IF.                                                      26718020
267190                                                                  26719020
267200                                                                  26720011
267300     INITIALIZE DCLTSHPTPO.                                       26730011
267400                                                                  26740011
267500     MOVE DK-CURR-SHIPT-ID         TO SHPTPO-SHIPT-ID             26750011
267600                                      WS008-NEW-SHIP.             26760011
267700     MOVE WS008-PO-NUMBER          TO SHPTPO-PO-NBR               26770011
267800                                      DK-PO-NBR.                  26780011
267900     MOVE WS008-NEW-REC-SEQ-NBR    TO SHPTPO-REC-SEQ-NBR.         26790011
268000     MOVE ZEROES                   TO SHPTPO-EXPTED-CART-CNT.     26800011
268100     MOVE ZEROES                   TO SHPTPO-ACTL-CART-CNT        26810011
268200                                      SHPTPO-DMG-CART-CNT.        26820011
268300     MOVE 'N'                      TO SHPTPO-PKSL-IND.            26830011
268400     MOVE ENTNME-ENT-NAME-DESC     TO SHPTPO-VEND-NAME.           26840011
268500     MOVE ZEROES                   TO SHPTPO-FRGT-CHG-AMT.        26850011
268600     MOVE 'Y'                      TO SHPTPO-PRIM-SHIPT-IND.      26860011
268700                                                                  26870011
268800     PERFORM                                                      26880011
268900         WITH TEST AFTER                                          26890011
269000         VARYING PV-RETRY-COUNTER                                 26900011
269100         FROM 1 BY 1                                              26910011
269200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26920011
269300             OR (SQLCODE = +0))                                   26930011
269400                                                                  26940011
269500         EXEC SQL                                                 26950011
269600             INSERT  INTO TSHPTPO                                 26960011
269700                    (SHIPT_ID                                     26970011
269800                    ,PO_NBR                                       26980011
269900                    ,REC_SEQ_NBR                                  26990011
270000                    ,EXPTED_CART_CNT                              27000011
270100                    ,ACTL_CART_CNT                                27010011
270200                    ,DMG_CART_CNT                                 27020011
270300                    ,PKSL_IND                                     27030011
270400                    ,VEND_NAME                                    27040011
270500                    ,FRGT_CHG_AMT                                 27050011
270600                    ,LAST_UPD_PGM_ID                              27060011
270700                    ,CRE_USER_ID                                  27070011
270800                    ,CARR_LAST_UPD_DTE                            27080011
270900                    ,CARR_LAST_UPD_TIME                           27090011
271000                    ,VEND_LAST_UPD_DTE                            27100011
271100                    ,VEND_LAST_UPD_TIME                           27110011
271200                    ,LAST_UPD_USER_ID                             27120011
271300                    ,PRIM_SHIPT_IND                               27130011
271400                    ,SPLT_XMIT_IND                                27140011
271500                    ,SPLT_XMIT_DTE                                27150011
271600                    ,SPLT_XMIT_TM )                               27160011
271700             VALUES                                               27170011
271800                    (:SHPTPO-SHIPT-ID                             27180011
271900                    ,:SHPTPO-PO-NBR                               27190011
272000                    ,:SHPTPO-REC-SEQ-NBR                          27200011
272100                    ,:SHPTPO-EXPTED-CART-CNT                      27210011
272200                    ,:SHPTPO-ACTL-CART-CNT                        27220011
272300                    ,:SHPTPO-DMG-CART-CNT                         27230011
272400                    ,:SHPTPO-PKSL-IND                             27240011
272500                    ,:SHPTPO-VEND-NAME                            27250011
272600                    ,:SHPTPO-FRGT-CHG-AMT                         27260011
272700                    ,:PC-CURRENT-PROGRAM-NAME                     27270011
272800                    ,:WS008-SIGNON-USER-ID                        27280011
272900                    ,:PC-DEFAULT-DATE                             27290011
273000                    ,:PC-DEFAULT-TIME                             27300011
273100                    ,:PC-DEFAULT-DATE                             27310011
273200                    ,:PC-DEFAULT-TIME                             27320011
273300                    ,:WS008-SIGNON-USER-ID                        27330011
273400                    ,:SHPTPO-PRIM-SHIPT-IND                       27340011
273500                    ,:SHPTPO-SPLT-XMIT-IND                        27350011
273600                    ,:PC-DEFAULT-DATE                             27360011
273700                    ,:PC-DEFAULT-TIME )                           27370011
273800         END-EXEC                                                 27380011
273900*                                                                 27390011
274000         EVALUATE TRUE                                            27400011
274100             WHEN SQLCODE = +0                                    27410011
274200             WHEN SQLCODE = -904                                  27420011
274300             WHEN SQLCODE = -913                                  27430011
274400                 CONTINUE                                         27440011
274500                                                                  27450011
274600             WHEN SQLWARN0 NOT = SPACES                           27460011
274700             WHEN SQLCODE < +0                                    27470011
274800             WHEN SQLCODE > +0                                    27480011
274900                 MOVE SHPTPO-SHIPT-ID TO PV-DISP-SHIPT-ID         27490011
275000                 MOVE SHPTPO-PO-NBR   TO PV-DISP-PO-NBR           27500011
275100                 MOVE SHPTPO-REC-SEQ-NBR                          27510011
275200                                      TO PV-DISP-RCVR-SEQ-NBR     27520011
275300                 MOVE SQLCODE TO PV-DISP-SQLCODE                  27530011
275400                 STRING                                           27540011
275500                      ' 6000- SQL:' PV-DISP-SQLCODE               27550021
275800                      ' SHIPT:'     PV-DISP-SHIPT-ID              27580021
276000                      ' PO:'        PV-DISP-PO-NBR                27600021
276200                      '-'           PV-DISP-RCVR-SEQ-NBR          27620021
276300                                 DELIMITED BY SIZE                27630011
276400                               INTO WS008-CRA-RET-MSG             27640011
276500                 MOVE SQLCA     TO WS008-SQLCA                    27650011
276600                 SET WS008-INVALID-SQL TO TRUE                    27660011
276610                                                                  27661022
276620                 INITIALIZE  PV-CICS-MSG-AREA                     27662022
276630                 STRING                                           27663022
276640                         ' WSKCS312-6000- '                       27664022
276650                         ' SQL:'        PV-DISP-SQLCODE           27665025
276651                         ' SHIPT:'      PV-DISP-SHIPT-ID          27665122
276652                         ' PO:'         PV-DISP-PO-NBR            27665222
276653                         '-'            PV-DISP-RCVR-SEQ-NBR      27665322
276692                                    DELIMITED BY SIZE             27669222
276693                               INTO PV-CICS-MSG-AREA              27669322
276694                 PERFORM 9999-WRITE-TO-CSSL                       27669422
276695                                                                  27669522
276700         END-EVALUATE                                             27670011
276800     END-PERFORM.                                                 27680011
276900                                                                  27690011
277000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27700011
277100             AND (SQLCODE NOT = +0)                               27710011
277110                 MOVE SHPTPO-SHIPT-ID TO PV-DISP-SHIPT-ID         27711021
277120                 MOVE SHPTPO-PO-NBR   TO PV-DISP-PO-NBR           27712021
277130                 MOVE SHPTPO-REC-SEQ-NBR                          27713021
277140                                      TO PV-DISP-RCVR-SEQ-NBR     27714021
277150                 MOVE SQLCODE TO PV-DISP-SQLCODE                  27715021
277200         STRING                                                   27720011
277300              '6000- MAX RETRIES'                                 27730021
277400              ' SQL:'      PV-DISP-SQLCODE                        27740021
277410              ' SHIPT:'     PV-DISP-SHIPT-ID                      27741021
277420              ' PO:'        PV-DISP-PO-NBR                        27742021
277430              '-'           PV-DISP-RCVR-SEQ-NBR                  27743021
277500                            DELIMITED BY SIZE                     27750033
277510                       INTO PV-CICS-MSG-AREA                      27751033
277520         PERFORM 9999-WRITE-TO-CSSL                               27752033
277810                                                                  27781022
277900     END-IF.                                                      27790011
278000                                                                  27800011
278003     IF   PS-LOG-MESSAGE                                          27800333
278004          INITIALIZE  PV-CICS-MSG-AREA                            27800433
278010          MOVE SHPTPO-SHIPT-ID TO PV-DISP-SHIPT-ID                27801033
278020          MOVE SHPTPO-PO-NBR   TO PV-DISP-PO-NBR                  27802033
278030          MOVE SHPTPO-REC-SEQ-NBR                                 27803033
278040                               TO PV-DISP-RCVR-SEQ-NBR            27804033
278098          STRING                                                  27809833
278099                 ' WSKCS312-6000- '                               27809933
278100                 ' SQL:'        PV-DISP-SQLCODE                   27810033
278101                 ' SHIPT:'      PV-DISP-SHIPT-ID                  27810133
278102                 ' PO:'         PV-DISP-PO-NBR                    27810233
278103                 '-'            PV-DISP-RCVR-SEQ-NBR              27810333
278104                                DELIMITED BY SIZE                 27810433
278105                           INTO PV-CICS-MSG-AREA                  27810533
278106         PERFORM 9999-WRITE-TO-CSSL                               27810633
278107     END-IF.                                                      27810733
278108                                                                  27810833
278110     EVALUATE TRUE                                                27811011
278200         WHEN SQLCODE = ZERO                                      27820011
278300              MOVE 'A'  TO PV-TRN-CDE                             27830011
278400              PERFORM 6050-INSERT-TAUSHPO                         27840011
278500     END-EVALUATE.                                                27850011
278600                                                                  27860011
278700*----------------------------------------------------------------*27870011
278800*  INSERT THE PO TO THE SHIPMENT PO ASSOCIATION AUDIT TABLE       27880011
278900*----------------------------------------------------------------*27890011
279000                                                                  27900011
279100 6050-INSERT-TAUSHPO.                                             27910011
279110                                                                  27911020
279120     IF   PS-LOG-MESSAGE                                          27912020
279130          INITIALIZE  PV-CICS-MSG-AREA                            27913020
279140          STRING   ' WSKCS312-6050-INSERT-TAUSHPO          '      27914020
279150                      DELIMITED BY SIZE                           27915020
279160                                      INTO PV-CICS-MSG-AREA       27916020
279170          PERFORM 9999-WRITE-TO-CSSL                              27917033
279171                                                                  27917133
279172          INITIALIZE  PV-CICS-MSG-AREA                            27917233
279173          MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID               27917333
279175          MOVE DK-PO-NBR        TO PV-DISP-PO-NBR                 27917533
279176          MOVE SQLCODE TO PV-DISP-SQLCODE                         27917633
279177          STRING                                                  27917733
279178                 ' WSKCS312-6050- '                               27917833
279180                 ' SHIPT:'      PV-DISP-SHIPT-ID                  27918033
279181                 ' PO:'         PV-DISP-PO-NBR                    27918133
279182                                DELIMITED BY SIZE                 27918233
279183                           INTO PV-CICS-MSG-AREA                  27918333
279184          PERFORM 9999-WRITE-TO-CSSL                              27918433
279185     END-IF.                                                      27918520
279190                                                                  27919020
279200                                                                  27920011
279300     PERFORM                                                      27930011
279400         WITH TEST AFTER                                          27940011
279500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27950011
279600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27960011
279700                (SQLCODE = ZERO)   OR                             27970011
279800                (SQLCODE = +100)                                  27980011
279900*                                                                 27990011
280000         EXEC SQL                                                 28000011
280100             SELECT SHIPT_ID,                                     28010011
280200                    PO_NBR,                                       28020011
280300                    REC_SEQ_NBR,                                  28030011
280400                    EXPTED_CART_CNT,                              28040011
280500                    ACTL_CART_CNT,                                28050011
280600                    DMG_CART_CNT,                                 28060011
280700                    PKSL_IND,                                     28070011
280800                    VEND_NAME,                                    28080011
280900                    FRGT_CHG_AMT,                                 28090011
281000                    LAST_UPD_PGM_ID,                              28100011
281100                    CRE_USER_ID,                                  28110011
281200                    CARR_CART_CT,                                 28120011
281300                    CARR_LAST_UPD_DTE,                            28130011
281400                    CARR_LAST_UPD_TIME,                           28140011
281500                    VEND_CART_CT,                                 28150011
281600                    VEND_LAST_UPD_DTE,                            28160011
281700                    VEND_LAST_UPD_TIME,                           28170011
281800                    CRE_TMST,                                     28180011
281900                    LAST_UPD_DTE,                                 28190011
282000                    LAST_UPD_TIME,                                28200011
282100                    LAST_UPD_USER_ID,                             28210011
282200                    PRIM_SHIPT_IND                                28220011
282300                   ,SPLT_XMIT_IND                                 28230011
282400                   ,SPLT_XMIT_DTE                                 28240011
282500                   ,SPLT_XMIT_TM                                  28250011
282600               INTO :SHPTPO-SHIPT-ID,                             28260011
282700                    :SHPTPO-PO-NBR,                               28270011
282800                    :SHPTPO-REC-SEQ-NBR,                          28280011
282900                    :SHPTPO-EXPTED-CART-CNT,                      28290011
283000                    :SHPTPO-ACTL-CART-CNT,                        28300011
283100                    :SHPTPO-DMG-CART-CNT,                         28310011
283200                    :SHPTPO-PKSL-IND,                             28320011
283300                    :SHPTPO-VEND-NAME,                            28330011
283400                    :SHPTPO-FRGT-CHG-AMT,                         28340011
283500                    :SHPTPO-LAST-UPD-PGM-ID,                      28350011
283600                    :SHPTPO-CRE-USER-ID,                          28360011
283700                    :SHPTPO-CARR-CART-CT,                         28370011
283800                    :SHPTPO-CARR-LAST-UPD-DTE,                    28380011
283900                    :SHPTPO-CARR-LAST-UPD-TIME,                   28390011
284000                    :SHPTPO-VEND-CART-CT,                         28400011
284100                    :SHPTPO-VEND-LAST-UPD-DTE,                    28410011
284200                    :SHPTPO-VEND-LAST-UPD-TIME,                   28420011
284300                    :SHPTPO-CRE-TMST,                             28430011
284400                    :SHPTPO-LAST-UPD-DTE,                         28440011
284500                    :SHPTPO-LAST-UPD-TIME,                        28450011
284600                    :SHPTPO-LAST-UPD-USER-ID,                     28460011
284700                    :SHPTPO-PRIM-SHIPT-IND                        28470011
284800                   ,:SHPTPO-SPLT-XMIT-IND                         28480011
284900                   ,:SHPTPO-SPLT-XMIT-DTE                         28490011
285000                   ,:SHPTPO-SPLT-XMIT-TM                          28500011
285100               FROM TSHPTPO                                       28510011
285200              WHERE SHIPT_ID = :DK-CURR-SHIPT-ID                  28520011
285300                AND PO_NBR   = :DK-PO-NBR                         28530011
285400         END-EXEC                                                 28540011
285500*                                                                 28550011
285600         EVALUATE TRUE                                            28560011
285700             WHEN SQLCODE = ZERO                                  28570011
285800             WHEN SQLCODE = +100                                  28580011
285900             WHEN SQLCODE = -904                                  28590011
286000             WHEN SQLCODE = -913                                  28600011
286100                 CONTINUE                                         28610011
286200                                                                  28620011
286300             WHEN SQLWARN0 NOT = SPACE                            28630011
286400             WHEN SQLCODE  NOT = +0                               28640011
286500                 MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID        28650021
286600                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          28660021
286900                 MOVE SQLCODE TO PV-DISP-SQLCODE                  28690011
287000                 STRING                                           28700011
287100                      ' 6050- TSHPTPO'                            28710022
287200                      ' SQL:'        PV-DISP-SQLCODE              28720022
287300                      ' SHIPT:'      PV-DISP-SHIPT-ID             28730021
287600                      ' PO:'         PV-DISP-PO-NBR               28760021
287900                                 DELIMITED BY SIZE                28790011
288000                               INTO WS008-CRA-RET-MSG             28800011
288100                 MOVE SQLCA     TO WS008-SQLCA                    28810011
288200                 SET WS008-INVALID-SQL TO TRUE                    28820011
288210                                                                  28821022
288220                 INITIALIZE  PV-CICS-MSG-AREA                     28822022
288230                 STRING                                           28823022
288240                         ' WSKCS312-6050-TSHPTPO'                 28824022
288250                         ' SQL:'        PV-DISP-SQLCODE           28825025
288251                         ' SHIPT:'      PV-DISP-SHIPT-ID          28825122
288252                         ' PO:'         PV-DISP-PO-NBR            28825222
288290                                    DELIMITED BY SIZE             28829022
288291                               INTO PV-CICS-MSG-AREA              28829122
288292                 PERFORM 9999-WRITE-TO-CSSL                       28829222
288293                                                                  28829322
288300         END-EVALUATE                                             28830011
288400                                                                  28840011
288500     END-PERFORM.                                                 28850011
288600                                                                  28860011
288700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28870011
288800             AND (SQLCODE NOT = +0)                               28880011
288810                 MOVE DK-CURR-SHIPT-ID TO PV-DISP-SHIPT-ID        28881021
288820                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          28882021
288900         STRING                                                   28890011
289000              '6050-TSHPTPO MAX RETRIES'                          28900022
289110              ' SQL:'        PV-DISP-SQLCODE                      28911021
289120              ' SHIPT:'      PV-DISP-SHIPT-ID                     28912021
289130              ' PO:'         PV-DISP-PO-NBR                       28913021
289200                       DELIMITED BY SIZE                          28920011
289300                       INTO WS008-CRA-RET-MSG                     28930011
289400         MOVE SQLCA     TO WS008-SQLCA                            28940011
289500         SET WS008-INVALID-SQL TO TRUE                            28950011
289510                                                                  28951022
289520         INITIALIZE  PV-CICS-MSG-AREA                             28952022
289530         STRING                                                   28953022
289540                         ' WSKCS312-6050- TSHPTPO MMAX RETRIES'   28954022
289550                         ' SQL:'        PV-DISP-SQLCODE           28955025
289560                         ' SHIPT:'      PV-DISP-SHIPT-ID          28956022
289570                         ' PO:'         PV-DISP-PO-NBR            28957022
289580                                    DELIMITED BY SIZE             28958022
289590                               INTO PV-CICS-MSG-AREA              28959022
289591         PERFORM 9999-WRITE-TO-CSSL                               28959122
289592                                                                  28959222
289600     END-IF.                                                      28960011
289700                                                                  28970011
289800     MOVE PV-TRN-CDE               TO AUSHPO-TRN-CDE              28980011
289900     PERFORM                                                      28990011
290000         WITH TEST AFTER                                          29000011
290100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     29010011
290200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            29020011
290300                 SQLCODE = ZERO                                   29030011
290400*                                                                 29040011
290500         EXEC SQL                                                 29050011
290600             INSERT INTO TAUSHPO                                  29060011
290700                   (SHIPT_ID,                                     29070011
290800                    PO_NBR,                                       29080011
290900                    REC_SEQ_NBR,                                  29090011
291000                    EXPTED_CART_CNT,                              29100011
291100                    ACTL_CART_CNT,                                29110011
291200                    DMG_CART_CNT,                                 29120011
291300                    PKSL_IND,                                     29130011
291400                    VEND_NAME,                                    29140011
291500                    FRGT_CHG_AMT,                                 29150011
291600                    LAST_UPD_PGM_ID,                              29160011
291700                    CRE_USER_ID,                                  29170011
291800                    CARR_CART_CT,                                 29180011
291900                    CARR_LAST_UPD_DTE,                            29190011
292000                    CARR_LAST_UPD_TIME,                           29200011
292100                    VEND_CART_CT,                                 29210011
292200                    VEND_LAST_UPD_DTE,                            29220011
292300                    VEND_LAST_UPD_TIME,                           29230011
292400                    CRE_TMST,                                     29240011
292500                    LAST_UPD_DTE,                                 29250011
292600                    LAST_UPD_TIME,                                29260011
292700                    LAST_UPD_USER_ID,                             29270011
292800                    PRIM_SHIPT_IND                                29280011
292900                   ,SPLT_XMIT_IND                                 29290011
293000                   ,SPLT_XMIT_DTE                                 29300011
293100                   ,SPLT_XMIT_TM                                  29310011
293200                   ,TRN_CDE )                                     29320011
293300             VALUES                                               29330011
293400                  (:SHPTPO-SHIPT-ID,                              29340011
293500                   :SHPTPO-PO-NBR,                                29350011
293600                   :SHPTPO-REC-SEQ-NBR,                           29360011
293700                   :SHPTPO-EXPTED-CART-CNT,                       29370011
293800                   :SHPTPO-ACTL-CART-CNT,                         29380011
293900                   :SHPTPO-DMG-CART-CNT,                          29390011
294000                   :SHPTPO-PKSL-IND,                              29400011
294100                   :SHPTPO-VEND-NAME,                             29410011
294200                   :SHPTPO-FRGT-CHG-AMT,                          29420011
294300                   :SHPTPO-LAST-UPD-PGM-ID,                       29430011
294400                   :SHPTPO-CRE-USER-ID,                           29440011
294500                   :SHPTPO-CARR-CART-CT,                          29450011
294600                   :SHPTPO-CARR-LAST-UPD-DTE,                     29460011
294700                   :SHPTPO-CARR-LAST-UPD-TIME,                    29470011
294800                   :SHPTPO-VEND-CART-CT,                          29480011
294900                   :SHPTPO-VEND-LAST-UPD-DTE,                     29490011
295000                   :SHPTPO-VEND-LAST-UPD-TIME,                    29500011
295100                   :SHPTPO-CRE-TMST,                              29510011
295200                   :SHPTPO-LAST-UPD-DTE,                          29520011
295300                   :SHPTPO-LAST-UPD-TIME,                         29530011
295400                   :SHPTPO-LAST-UPD-USER-ID,                      29540011
295500                   :SHPTPO-PRIM-SHIPT-IND                         29550011
295600                  ,:SHPTPO-SPLT-XMIT-IND                          29560011
295700                  ,:SHPTPO-SPLT-XMIT-DTE                          29570011
295800                  ,:SHPTPO-SPLT-XMIT-TM                           29580011
295900                  ,:AUSHPO-TRN-CDE )                              29590011
296000         END-EXEC                                                 29600011
296100*                                                                 29610011
296200         EVALUATE TRUE                                            29620011
296300             WHEN SQLCODE = +0                                    29630011
296400             WHEN SQLCODE = -904                                  29640011
296500             WHEN SQLCODE = -913                                  29650011
296600                 CONTINUE                                         29660011
296700                                                                  29670011
296800             WHEN SQLWARN0 NOT = SPACES                           29680011
296900             WHEN SQLCODE < +0                                    29690011
297000             WHEN SQLCODE > +0                                    29700011
297100                 MOVE SHPTPO-SHIPT-ID TO PV-DISP-SHIPT-ID         29710011
297200                 MOVE SHPTPO-PO-NBR   TO PV-DISP-PO-NBR           29720011
297300                 MOVE SHPTPO-REC-SEQ-NBR                          29730011
297400                                      TO PV-DISP-RCVR-SEQ-NBR     29740011
297500                 MOVE SQLCODE TO PV-DISP-SQLCODE                  29750011
297600                 STRING                                           29760011
297700                      ' 6050- TAUSHPO'                            29770022
297800                      ' SQL:'        PV-DISP-SQLCODE              29780022
298000                      ' SHIPT:'      PV-DISP-SHIPT-ID             29800021
298200                      ' PO:'         PV-DISP-PO-NBR               29820021
298400                      '-'            PV-DISP-RCVR-SEQ-NBR         29840021
298500                                 DELIMITED BY SIZE                29850011
298600                               INTO WS008-CRA-RET-MSG             29860011
298700                 MOVE SQLCA     TO WS008-SQLCA                    29870011
298800                 SET WS008-INVALID-SQL TO TRUE                    29880011
298810                                                                  29881022
298820                 INITIALIZE  PV-CICS-MSG-AREA                     29882022
298830                 STRING                                           29883022
298840                         ' WSKCS312-6050- TAUSHPO'                29884022
298850                         ' SQL:'        PV-DISP-SQLCODE           29885025
298860                         ' SHIPT:'      PV-DISP-SHIPT-ID          29886022
298870                         ' PO:'         PV-DISP-PO-NBR            29887022
298880                                    DELIMITED BY SIZE             29888022
298890                               INTO PV-CICS-MSG-AREA              29889022
298891                 PERFORM 9999-WRITE-TO-CSSL                       29889122
298892                                                                  29889222
298900         END-EVALUATE                                             29890011
299000     END-PERFORM.                                                 29900011
299100                                                                  29910011
299200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29920011
299300             AND (SQLCODE NOT = +0)                               29930011
299400         STRING                                                   29940011
299500              '6050- TAUSHPO MAX RETRIES'                         29950022
299600              ' SQL:'        PV-DISP-SQLCODE                      29960021
299700              ' SHIPT:'      PV-DISP-SHIPT-ID                     29970021
299710              ' PO:'         PV-DISP-PO-NBR                       29971021
299720              '-'            PV-DISP-RCVR-SEQ-NBR                 29972021
299800                                 DELIMITED BY SIZE                29980011
299900                               INTO WS008-CRA-RET-MSG             29990011
300000         MOVE SQLCA     TO WS008-SQLCA                            30000011
300100         SET WS008-INVALID-SQL TO TRUE                            30010011
300110                                                                  30011022
300120         INITIALIZE  PV-CICS-MSG-AREA                             30012022
300130         STRING                                                   30013022
300140                         ' WSKCS312-6050- TAUSHPO MAX RETRIES'    30014022
300150                         ' SQL:'        PV-DISP-SQLCODE           30015025
300160                         ' SHIPT:'      PV-DISP-SHIPT-ID          30016022
300170                         ' PO:'         PV-DISP-PO-NBR            30017022
300180                                    DELIMITED BY SIZE             30018022
300190                               INTO PV-CICS-MSG-AREA              30019022
300191         PERFORM 9999-WRITE-TO-CSSL                               30019122
300192                                                                  30019222
300200     END-IF.                                                      30020011
300300                                                                  30030011
300400                                                                  30040011
300500*----------------------------------------------------------------*30050011
300600*  INSERT A ROW TO THE SHIPMENT STATUS TABLE                      30060011
300700*                                                                 30070011
300800*----------------------------------------------------------------*30080011
300900 6100-INSERT-TSHIPST.                                             30090011
300910                                                                  30091020
300920     IF   PS-LOG-MESSAGE                                          30092020
300930          INITIALIZE  PV-CICS-MSG-AREA                            30093020
300940          STRING   ' WSKCS312-6100-INSERT-TSHIPST          '      30094020
300950                      DELIMITED BY SIZE                           30095020
300960                                      INTO PV-CICS-MSG-AREA       30096020
300970             PERFORM 9999-WRITE-TO-CSSL                           30097020
300980     END-IF.                                                      30098020
300990                                                                  30099020
301000                                                                  30100011
301100     INITIALIZE DCLTSHIPST.                                       30110011
301200                                                                  30120011
301300     PERFORM 6150-SELECT-MAX-TRIPST.                              30130011
301400                                                                  30140011
301500     MOVE PV-CURR-SHIPT-ID         TO SHIPST-SHIPT-ID.            30150011
301600     MOVE 'FASYSTEM'               TO SHIPST-STATUS-UID.          30160011
301700                                                                  30170011
301800     PERFORM                                                      30180011
301900         WITH TEST AFTER                                          30190011
302000         VARYING PV-RETRY-COUNTER                                 30200011
302100         FROM 1 BY 1                                              30210011
302200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30220011
302300             OR (SQLCODE = +0))                                   30230011
302400                                                                  30240011
302500         EXEC SQL                                                 30250011
302600             INSERT  INTO TSHIPST                                 30260011
302700                   ( SHIPT_ID                                     30270011
302800                    ,SHIPT_STATUS_CDE                             30280011
302900                    ,STATUS_UID )                                 30290011
303000             VALUES                                               30300011
303100                   ( :SHIPST-SHIPT-ID                             30310011
303200                    ,:SHIPST-SHIPT-STATUS-CDE                     30320011
303300                    ,:SHIPST-STATUS-UID)                          30330011
303400         END-EXEC                                                 30340011
303500                                                                  30350011
303600         EVALUATE TRUE                                            30360011
303700             WHEN SQLCODE = +0                                    30370011
303800             WHEN SQLCODE = -904                                  30380011
303900             WHEN SQLCODE = -913                                  30390011
304000                 CONTINUE                                         30400011
304100                                                                  30410011
304200             WHEN SQLWARN0 NOT = SPACES                           30420011
304300             WHEN SQLCODE < +0                                    30430011
304400             WHEN SQLCODE > +0                                    30440011
304500                 MOVE SHIPST-SHIPT-ID TO PV-DISP-SHIPT-ID         30450011
304600                 MOVE SQLCODE TO PV-DISP-SQLCODE                  30460011
304700                 STRING                                           30470011
304800                      ' 6100-  SQL:'  PV-DISP-SQLCODE             30480021
305000                      ' SHIPT:'       PV-DISP-SHIPT-ID            30500021
305100                      ' '             SHIPST-SHIPT-STATUS-CDE     30510021
305110                      ' '             SHIPST-STATUS-UID           30511021
305200                                 DELIMITED BY SIZE                30520011
305300                               INTO WS008-CRA-RET-MSG             30530011
305400                 MOVE SQLCA     TO WS008-SQLCA                    30540011
305500                 SET WS008-INVALID-SQL TO TRUE                    30550011
305510                                                                  30551022
305520                 INITIALIZE  PV-CICS-MSG-AREA                     30552022
305530                 STRING                                           30553022
305540                         ' WSKCS312-6100- '                       30554022
305550                         ' SQL:'        PV-DISP-SQLCODE           30555025
305560                         ' SHIPT:'      PV-DISP-SHIPT-ID          30556022
305561                         ' '            SHIPST-SHIPT-STATUS-CDE   30556122
305562                         ' '            SHIPST-STATUS-UID         30556222
305580                                    DELIMITED BY SIZE             30558022
305590                               INTO PV-CICS-MSG-AREA              30559022
305591                 PERFORM 9999-WRITE-TO-CSSL                       30559122
305592                                                                  30559222
305600         END-EVALUATE                                             30560011
305700     END-PERFORM.                                                 30570011
305800                                                                  30580011
305900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30590011
306000             AND (SQLCODE NOT = +0)                               30600011
306100         MOVE SHIPST-SHIPT-ID TO PV-DISP-SHIPT-ID                 30610011
306200         MOVE SQLCODE TO PV-DISP-SQLCODE                          30620011
306300         STRING                                                   30630011
306400              ' 6100-  MAX RETRIES'                               30640021
306500              ' SQL:'         PV-DISP-SQLCODE                     30650021
306600              ' SHIPT:'       PV-DISP-SHIPT-ID                    30660021
306610              ' '             SHIPST-SHIPT-STATUS-CDE             30661021
306620              ' '             SHIPST-STATUS-UID                   30662021
306800                         DELIMITED BY SIZE                        30680011
306900                       INTO WS008-CRA-RET-MSG                     30690011
307000         MOVE SQLCA     TO WS008-SQLCA                            30700011
307100         SET WS008-INVALID-SQL TO TRUE                            30710011
307110                                                                  30711022
307120         INITIALIZE  PV-CICS-MSG-AREA                             30712022
307130         STRING                                                   30713022
307140                         ' WSKCS312-6100- MAX RETRIES'            30714022
307150                         ' SQL:'        PV-DISP-SQLCODE           30715025
307160                         ' SHIPT:'      PV-DISP-SHIPT-ID          30716022
307170                         ' '            SHIPST-SHIPT-STATUS-CDE   30717022
307180                         ' '            SHIPST-STATUS-UID         30718022
307190                                    DELIMITED BY SIZE             30719022
307191                               INTO PV-CICS-MSG-AREA              30719122
307192         PERFORM 9999-WRITE-TO-CSSL                               30719222
307193                                                                  30719322
307200     END-IF.                                                      30720011
307201                                                                  30720133
307210     IF   PS-LOG-MESSAGE                                          30721033
307220          INITIALIZE  PV-CICS-MSG-AREA                            30722033
307221          MOVE SHIPST-SHIPT-ID TO PV-DISP-SHIPT-ID                30722133
307223          STRING                                                  30722333
307224                 ' WSKCS312-6100- '                               30722433
307225                 ' SHIPT:'       PV-DISP-SHIPT-ID                 30722533
307226                 ' '             SHIPST-SHIPT-STATUS-CDE          30722633
307227                 ' '             SHIPST-STATUS-UID                30722733
307228                                 DELIMITED BY SIZE                30722833
307250                                 INTO PV-CICS-MSG-AREA            30725033
307260             PERFORM 9999-WRITE-TO-CSSL                           30726033
307270     END-IF.                                                      30727033
307300                                                                  30730011
307400                                                                  30740011
307500 6150-SELECT-MAX-TRIPST.                                          30750011
307510                                                                  30751020
307520     IF   PS-LOG-MESSAGE                                          30752020
307530          INITIALIZE  PV-CICS-MSG-AREA                            30753020
307540          STRING   ' WSKCS312-6150-SELECT-MAX-TRIPST       '      30754020
307550                      DELIMITED BY SIZE                           30755020
307560                                      INTO PV-CICS-MSG-AREA       30756020
307570             PERFORM 9999-WRITE-TO-CSSL                           30757020
307580     END-IF.                                                      30758020
307590                                                                  30759020
307600                                                                  30760011
307700      MOVE WS008-TRIP-ID TO TRIPST-TRIP-ID.                       30770011
307800                                                                  30780011
307801     IF  PS-LOG-MESSAGE                                           30780133
307810         INITIALIZE  PV-CICS-MSG-AREA                             30781033
307820         STRING                                                   30782033
307830                ' WSKCS312-6150- '                                30783033
307850                ' TRIP:'      PV-DISP-TRIP-ID                     30785033
307860                              DELIMITED BY SIZE                   30786033
307870                         INTO PV-CICS-MSG-AREA                    30787033
307880         PERFORM 9999-WRITE-TO-CSSL                               30788033
307881     END-IF.                                                      30788133
307890                                                                  30789033
307900      EXEC SQL                                                    30790033
308000           SELECT B.TRIP_STATUS_CDE                               30800046
308100              INTO  :TRIPST-TRIP-STATUS-CDE                       30810011
308200             FROM   TTRIPST B                                     30820011
308300        WHERE                                                     30830011
308400             B.TRIP_ID     = :TRIPST-TRIP-ID                      30840011
308500          AND                                                     30850011
308600                TIMESTAMP(B.STATUS_DTE, B.STATUS_TME)             30860011
308700            IN                                                    30870011
308800                (SELECT                                           30880011
308900                       MAX(TIMESTAMP(A.STATUS_DTE, A.STATUS_TME)) 30890011
309000                 FROM   TTRIPST A                                 30900011
309100                 WHERE  A.TRIP_ID     = B.TRIP_ID )               30910011
309200       END-EXEC.                                                  30920011
309300                                                                  30930011
309400       EVALUATE TRUE                                              30940011
309500           WHEN SQLCODE = +0                                      30950011
309600                MOVE TRIPST-TRIP-STATUS-CDE TO                    30960011
309700                                  SHIPST-SHIPT-STATUS-CDE         30970011
309800           WHEN SQLCODE = +100                                    30980011
309900                MOVE 'EN'    TO SHIPST-SHIPT-STATUS-CDE           30990011
310000           WHEN SQLWARN0 NOT = SPACES                             31000011
310100           WHEN SQLCODE < +0                                      31010011
310200           WHEN SQLCODE > +0                                      31020011
310300               MOVE TRIPST-TRIP-ID  TO PV-DISP-TRIP-ID            31030011
310400               MOVE SQLCODE TO PV-DISP-SQLCODE                    31040011
310500               STRING                                             31050011
310600                    ' 6150- SQL:' PV-DISP-SQLCODE                 31060021
310900                    ' TRIP:'      PV-DISP-TRIP-ID                 31090021
311000                               DELIMITED BY SIZE                  31100011
311100                             INTO WS008-CRA-RET-MSG               31110011
311200               MOVE SQLCA     TO WS008-SQLCA                      31120011
311300               SET WS008-INVALID-SQL TO TRUE                      31130011
311310                                                                  31131022
311320               INITIALIZE  PV-CICS-MSG-AREA                       31132022
311330               STRING                                             31133022
311340                         ' WSKCS312-6150- '                       31134022
311350                         ' SQL:'        PV-DISP-SQLCODE           31135025
311351                         ' TRIP:'      PV-DISP-TRIP-ID            31135122
311390                                    DELIMITED BY SIZE             31139022
311391                               INTO PV-CICS-MSG-AREA              31139122
311392               PERFORM 9999-WRITE-TO-CSSL                         31139222
311393                                                                  31139322
311400       END-EVALUATE.                                              31140011
311500                                                                  31150011
311600*----------------------------------------------------------------*31160011
311700*  INSERT A ROW TO THE SHIPTMENT AUDIT TABLE                      31170011
311800*----------------------------------------------------------------*31180011
311900 6200-INSERT-TAUSHIP.                                             31190011
311910                                                                  31191020
311920     IF   PS-LOG-MESSAGE                                          31192020
311930          INITIALIZE  PV-CICS-MSG-AREA                            31193020
311940          STRING   ' WSKCS312-6150-SELECT-MAX-TRIPST       '      31194020
311950                      DELIMITED BY SIZE                           31195020
311960                                      INTO PV-CICS-MSG-AREA       31196020
311970          PERFORM 9999-WRITE-TO-CSSL                              31197033
311971                                                                  31197133
311972          INITIALIZE  PV-CICS-MSG-AREA                            31197233
311973                 STRING                                           31197333
311974                        ' WSKCS312-6200- '                        31197433
311976                        ' SHIPT:'      PV-DISP-SHIPT-ID           31197633
311977                                       DELIMITED BY SIZE          31197733
311978                                  INTO PV-CICS-MSG-AREA           31197833
311979          PERFORM 9999-WRITE-TO-CSSL                              31197933
311980     END-IF.                                                      31198020
311990                                                                  31199020
312100     INITIALIZE DCLTAUSHIP.                                       31210011
312200                                                                  31220011
312210** CLT 12-13-2011 WR40574 ADDED CARR-AUTH-ID BELOW                31221015
312300     PERFORM                                                      31230011
312400         WITH TEST AFTER                                          31240011
312500         VARYING PV-RETRY-COUNTER                                 31250011
312600         FROM 1 BY 1                                              31260011
312700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31270011
312800             OR (SQLCODE = +0))                                   31280011
312900                                                                  31290011
313000         EXEC SQL                                                 31300011
313100             SELECT  A.TRIP_ID                                    31310011
313200                    ,A.SHIPT_ID                                   31320011
313300                    ,A.CRT_SRC_CDE                                31330011
313400                    ,A.LAST_UPD_DTE                               31340011
313500                    ,A.LAST_UPD_TME                               31350011
313600                    ,A.LAST_UPD_UID                               31360011
313700                    ,A.PRO_SCAC_ID                                31370011
313800                    ,A.PRO_NBR                                    31380011
313900                    ,A.BOL_NBR                                    31390011
314000                    ,A.SHIPPER_NME                                31400011
314100                    ,A.SHIPT_TYP_CDE                              31410011
314200                    ,A.EXPTED_GRO_WGHT                            31420011
314300                    ,A.PKG_TYP_CDE                                31430011
314400                    ,A.EXPTED_PKG_QTY                             31440011
314500                    ,A.FRGT_CHG_AMT                               31450011
314600                    ,A.FRGT_TERMS_CDE                             31460011
314700                    ,A.EXPTED_PLT_QTY                             31470011
314800                    ,A.VEND_SHIP_DTE                              31480011
314900                    ,A.EST_AR_TMST                                31490011
315000                    ,A.ORIG_SCAC_ID                               31500011
315100                    ,A.LAST_UPD_PGM_ID                            31510011
315200                    ,A.CRE_USER_ID                                31520011
315300                    ,A.CARR_CART_CT                               31530011
315400                    ,A.CARR_LAST_UPD_DTE                          31540011
315500                    ,A.CARR_LAST_UPD_TIME                         31550011
315600                    ,A.VEND_CART_CT                               31560011
315700                    ,A.VEND_LAST_UPD_DTE                          31570011
315800                    ,A.VEND_LAST_UPD_TIME                         31580011
315900                    ,A.VEH_NBR                                    31590011
316000                    ,A.AUTH_NBR                                   31600011
316100                    ,A.AUTH_DTE                                   31610011
316200                    ,A.CONFIRM_DTE                                31620011
316300                    ,A.CONFIRM_TIME                               31630011
316400                    ,A.COMPLETE_PRO_NBR                           31640011
316500                    ,A.COMPLETE_BOL_NBR                           31650011
316600                    ,A.PROCESSED_DTE                              31660011
316700                    ,A.INVC_NBR                                   31670011
316710                    ,A.CARR_AUTH_ID                               31671015
316800            INTO     :SHIPMT-TRIP-ID                              31680011
316900                       :DN-TRIP-ID                                31690011
317000                    ,:SHIPMT-SHIPT-ID                             31700011
317100                    ,:SHIPMT-CRT-SRC-CDE                          31710011
317200                    ,:SHIPMT-LAST-UPD-DTE                         31720011
317300                    ,:SHIPMT-LAST-UPD-TME                         31730011
317400                    ,:SHIPMT-LAST-UPD-UID                         31740011
317500                    ,:SHIPMT-PRO-SCAC-ID                          31750011
317600                    ,:SHIPMT-PRO-NBR                              31760011
317700                    ,:SHIPMT-BOL-NBR                              31770011
317800                    ,:SHIPMT-SHIPPER-NME                          31780011
317900                    ,:SHIPMT-SHIPT-TYP-CDE                        31790011
318000                    ,:SHIPMT-EXPTED-GRO-WGHT                      31800011
318100                    ,:SHIPMT-PKG-TYP-CDE                          31810011
318200                    ,:SHIPMT-EXPTED-PKG-QTY                       31820011
318300                    ,:SHIPMT-FRGT-CHG-AMT                         31830011
318400                    ,:SHIPMT-FRGT-TERMS-CDE                       31840011
318500                    ,:SHIPMT-EXPTED-PLT-QTY                       31850011
318600                    ,:SHIPMT-VEND-SHIP-DTE                        31860011
318700                    ,:SHIPMT-EST-AR-TMST                          31870011
318800                       :DN-EST-AR-TMST                            31880011
318900                    ,:SHIPMT-ORIG-SCAC-ID                         31890011
319000                    ,:SHIPMT-LAST-UPD-PGM-ID                      31900011
319100                    ,:SHIPMT-CRE-USER-ID                          31910011
319200                    ,:SHIPMT-CARR-CART-CT                         31920011
319300                    ,:SHIPMT-CARR-LAST-UPD-DTE                    31930011
319400                    ,:SHIPMT-CARR-LAST-UPD-TIME                   31940011
319500                    ,:SHIPMT-VEND-CART-CT                         31950011
319600                    ,:SHIPMT-VEND-LAST-UPD-DTE                    31960011
319700                    ,:SHIPMT-VEND-LAST-UPD-TIME                   31970011
319800                    ,:SHIPMT-VEH-NBR                              31980011
319900                    ,:SHIPMT-AUTH-NBR                             31990011
320000                    ,:SHIPMT-AUTH-DTE                             32000011
320100                    ,:SHIPMT-CONFIRM-DTE                          32010011
320200                    ,:SHIPMT-CONFIRM-TIME                         32020011
320300                    ,:SHIPMT-COMPLETE-PRO-NBR                     32030011
320400                    ,:SHIPMT-COMPLETE-BOL-NBR                     32040011
320500                    ,:SHIPMT-PROCESSED-DTE                        32050011
320600                    ,:SHIPMT-INVC-NBR                             32060011
320610                    ,:SHIPMT-CARR-AUTH-ID                         32061015
320700           FROM   TSHIPMT A                                       32070011
320800           WHERE  A.SHIPT_ID         = :SHIPMT-SHIPT-ID           32080011
320900         END-EXEC                                                 32090011
321000                                                                  32100011
321100         EVALUATE TRUE                                            32110011
321200             WHEN SQLCODE = +0                                    32120011
321300             WHEN SQLCODE = -904                                  32130011
321400             WHEN SQLCODE = -913                                  32140011
321500                 CONTINUE                                         32150011
321600                                                                  32160011
321700             WHEN SQLWARN0 NOT = SPACES                           32170011
321800             WHEN SQLCODE < +0                                    32180011
321900             WHEN SQLCODE > +0                                    32190011
322000                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         32200011
322100                 MOVE SQLCODE TO PV-DISP-SQLCODE                  32210011
322200                 STRING                                           32220011
322300                      ' 6200- TSHIPMT'                            32230022
322400                      ' SQL:'        PV-DISP-SQLCODE              32240022
322600                      ' SHIPT:'      PV-DISP-SHIPT-ID             32260021
322700                                 DELIMITED BY SIZE                32270011
322800                               INTO WS008-CRA-RET-MSG             32280011
322900                 MOVE SQLCA     TO WS008-SQLCA                    32290011
323000                 SET WS008-INVALID-SQL TO TRUE                    32300011
323010                                                                  32301022
323020                 INITIALIZE  PV-CICS-MSG-AREA                     32302022
323030                 STRING                                           32303022
323040                         ' WSKCS312-6200- TSHIPMT'                32304022
323050                         ' SQL:'        PV-DISP-SQLCODE           32305025
323051                         ' SHIPT:'      PV-DISP-SHIPT-ID          32305122
323070                                    DELIMITED BY SIZE             32307022
323080                               INTO PV-CICS-MSG-AREA              32308022
323090                 PERFORM 9999-WRITE-TO-CSSL                       32309022
323091                                                                  32309122
323100         END-EVALUATE                                             32310011
323200     END-PERFORM.                                                 32320011
323300                                                                  32330011
323400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32340011
323500             AND (SQLCODE NOT = +0)                               32350011
323600         MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID                 32360011
323700         MOVE SQLCODE TO PV-DISP-SQLCODE                          32370011
323800         STRING                                                   32380011
323900              ' 6200- TSHIPMT MAX RETRIES'                        32390022
324000              ' SQL:'        PV-DISP-SQLCODE                      32400021
324200              ' SHIPT:'      PV-DISP-SHIPT-ID                     32420021
324300                         DELIMITED BY SIZE                        32430011
324400                       INTO WS008-CRA-RET-MSG                     32440011
324500         MOVE SQLCA     TO WS008-SQLCA                            32450011
324600         SET WS008-INVALID-SQL TO TRUE                            32460011
324610                                                                  32461022
324620         INITIALIZE  PV-CICS-MSG-AREA                             32462022
324630         STRING                                                   32463022
324640                         ' WSKCS312-6200- TSHIPMT MAX RETRIES'    32464022
324650                         ' SQL:'        PV-DISP-SQLCODE           32465025
324660                         ' SHIPT:'      PV-DISP-SHIPT-ID          32466022
324670                                    DELIMITED BY SIZE             32467022
324680                               INTO PV-CICS-MSG-AREA              32468022
324690         PERFORM 9999-WRITE-TO-CSSL                               32469022
324691                                                                  32469122
324700     END-IF.                                                      32470011
324701                                                                  32470133
324710     IF   PS-LOG-MESSAGE                                          32471033
324780          INITIALIZE  PV-CICS-MSG-AREA                            32478033
324781          MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID                32478133
324782          MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID                 32478233
324784          STRING                                                  32478433
324785                 ' WSKCS312-6200-INSERT TAUSHIP'                  32478533
324787                 ' SHIPT:' PV-DISP-SHIPT-ID                       32478733
324788                 ' TRIP:'  PV-DISP-TRIP-ID                        32478833
324793                                       DELIMITED BY SIZE          32479333
324794                                  INTO PV-CICS-MSG-AREA           32479433
324795          PERFORM 9999-WRITE-TO-CSSL                              32479533
324796     END-IF.                                                      32479633
324800                                                                  32480011
324810** CLT 12-13-2011 WR40574 ADDED CARR-AUTH-ID BELOW                32481015
324900     PERFORM                                                      32490011
325000         WITH TEST AFTER                                          32500011
325100         VARYING PV-RETRY-COUNTER                                 32510011
325200         FROM 1 BY 1                                              32520011
325300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32530011
325400             OR (SQLCODE = +0))                                   32540011
325500                                                                  32550011
325600         EXEC SQL                                                 32560011
325700             INSERT  INTO TAUSHIP                                 32570011
325800                    (TRIP_ID                                      32580011
325900                    ,SHIPT_ID                                     32590011
326000                    ,CRT_SRC_CDE                                  32600011
326100                    ,LAST_UPD_DTE                                 32610011
326200                    ,LAST_UPD_TME                                 32620011
326300                    ,LAST_UPD_UID                                 32630011
326400                    ,PRO_SCAC_ID                                  32640011
326500                    ,PRO_NBR                                      32650011
326600                    ,BOL_NBR                                      32660011
326700                    ,SHIPPER_NME                                  32670011
326800                    ,SHIPT_TYP_CDE                                32680011
326900                    ,EXPTED_GRO_WGHT                              32690011
327000                    ,PKG_TYP_CDE                                  32700011
327100                    ,EXPTED_PKG_QTY                               32710011
327200                    ,FRGT_CHG_AMT                                 32720011
327300                    ,FRGT_TERMS_CDE                               32730011
327400                    ,EST_AR_TMST                                  32740011
327500                    ,VEND_SHIP_DTE                                32750011
327600                    ,EXPTED_PLT_QTY                               32760011
327700                    ,ORIG_SCAC_ID                                 32770011
327800                    ,LAST_UPD_PGM_ID                              32780011
327900                    ,CRE_USER_ID                                  32790011
328000                    ,CARR_CART_CT                                 32800011
328100                    ,CARR_LAST_UPD_DTE                            32810011
328200                    ,CARR_LAST_UPD_TIME                           32820011
328300                    ,VEND_CART_CT                                 32830011
328400                    ,VEND_LAST_UPD_DTE                            32840011
328500                    ,VEND_LAST_UPD_TIME                           32850011
328600                    ,VEH_NBR                                      32860011
328700                    ,AUTH_NBR                                     32870011
328800                    ,AUTH_DTE                                     32880011
328900                    ,CONFIRM_DTE                                  32890011
329000                    ,CONFIRM_TIME                                 32900011
329100                    ,AUD_STATUS_CDE                               32910011
329200                    ,PROCESSED_DTE                                32920011
329300                    ,INVC_NBR                                     32930015
329310                    ,CARR_AUTH_ID)                                32931016
329400            VALUES  (:SHIPMT-TRIP-ID                              32940011
329500                       :DN-TRIP-ID                                32950011
329600                    ,:SHIPMT-SHIPT-ID                             32960011
329700                    ,:SHIPMT-CRT-SRC-CDE                          32970011
329800                    ,:SHIPMT-LAST-UPD-DTE                         32980011
329900                    ,:SHIPMT-LAST-UPD-TME                         32990011
330000                    ,:SHIPMT-LAST-UPD-UID                         33000011
330100                    ,:SHIPMT-PRO-SCAC-ID                          33010011
330200                    ,:SHIPMT-COMPLETE-PRO-NBR                     33020011
330300                    ,:SHIPMT-COMPLETE-BOL-NBR                     33030011
330400                    ,:SHIPMT-SHIPPER-NME                          33040011
330500                    ,:SHIPMT-SHIPT-TYP-CDE                        33050011
330600                    ,:SHIPMT-EXPTED-GRO-WGHT                      33060011
330700                    ,:SHIPMT-PKG-TYP-CDE                          33070011
330800                    ,:SHIPMT-EXPTED-PKG-QTY                       33080011
330900                    ,:SHIPMT-FRGT-CHG-AMT                         33090011
331000                    ,:SHIPMT-FRGT-TERMS-CDE                       33100011
331100                    ,:SHIPMT-EST-AR-TMST                          33110011
331200                       :DN-EST-AR-TMST                            33120011
331300                    ,:SHIPMT-VEND-SHIP-DTE                        33130011
331400                    ,:SHIPMT-EXPTED-PLT-QTY                       33140011
331500                    ,:SHIPMT-ORIG-SCAC-ID                         33150011
331600                    ,:SHIPMT-LAST-UPD-PGM-ID                      33160011
331700                    ,:SHIPMT-CRE-USER-ID                          33170011
331800                    ,:SHIPMT-CARR-CART-CT                         33180011
331900                    ,:SHIPMT-CARR-LAST-UPD-DTE                    33190011
332000                    ,:SHIPMT-CARR-LAST-UPD-TIME                   33200011
332100                    ,:SHIPMT-VEND-CART-CT                         33210011
332200                    ,:SHIPMT-VEND-LAST-UPD-DTE                    33220011
332300                    ,:SHIPMT-VEND-LAST-UPD-TIME                   33230011
332400                    ,:SHIPMT-VEH-NBR                              33240011
332500                    ,:SHIPMT-AUTH-NBR                             33250011
332600                    ,:SHIPMT-AUTH-DTE                             33260011
332700                    ,:SHIPMT-CONFIRM-DTE                          33270011
332800                    ,:SHIPMT-CONFIRM-TIME                         33280011
332900                    ,:SHIPST-SHIPT-STATUS-CDE                     33290011
333000                    ,:SHIPMT-PROCESSED-DTE                        33300011
333100                    ,:SHIPMT-INVC-NBR                             33310015
333110                    ,:SHIPMT-CARR-AUTH-ID)                        33311015
333200         END-EXEC                                                 33320011
333300                                                                  33330011
333400                                                                  33340011
333500         EVALUATE TRUE                                            33350011
333600             WHEN SQLCODE = +0                                    33360011
333700             WHEN SQLCODE = -904                                  33370011
333800             WHEN SQLCODE = -913                                  33380011
333900                 CONTINUE                                         33390011
334000                                                                  33400011
334100             WHEN SQLWARN0 NOT = SPACES                           33410011
334200             WHEN SQLCODE < +0                                    33420011
334300             WHEN SQLCODE > +0                                    33430011
334400                 MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID         33440011
334500                 MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID          33450011
334600                 MOVE SQLCODE TO PV-DISP-SQLCODE                  33460011
334700                 STRING                                           33470011
334800                      ' 6200-INSERT TAUSHIP'                      33480022
334900                      ' SQL:'   PV-DISP-SQLCODE                   33490021
335100                      ' SHIPT:' PV-DISP-SHIPT-ID                  33510021
335300                      ' TRIP:'  PV-DISP-TRIP-ID                   33530021
335400                                 DELIMITED BY SIZE                33540011
335500                               INTO WS008-CRA-RET-MSG             33550011
335600                 MOVE SQLCA     TO WS008-SQLCA                    33560011
335700                 SET WS008-INVALID-SQL TO TRUE                    33570011
335710                                                                  33571022
335720                 INITIALIZE  PV-CICS-MSG-AREA                     33572022
335730                 STRING                                           33573022
335740                         ' WSKCS312-6200- TAUSHIP'                33574022
335750                         ' SQL:'        PV-DISP-SQLCODE           33575025
335751                      ' SHIPT:' PV-DISP-SHIPT-ID                  33575122
335752                      ' TRIP:'  PV-DISP-TRIP-ID                   33575222
335770                                    DELIMITED BY SIZE             33577022
335780                               INTO PV-CICS-MSG-AREA              33578022
335790                 PERFORM 9999-WRITE-TO-CSSL                       33579022
335791                                                                  33579122
335800         END-EVALUATE                                             33580011
335900     END-PERFORM.                                                 33590011
336000                                                                  33600011
336100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33610011
336200             AND (SQLCODE NOT = +0)                               33620011
336300         MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID                 33630011
336400         MOVE SHIPMT-TRIP-ID  TO PV-DISP-TRIP-ID                  33640011
336500         MOVE SQLCODE TO PV-DISP-SQLCODE                          33650011
336600         STRING                                                   33660011
336700              ' 6200-INSERT TAUSHIP MAX RETRIES'                  33670022
336710              ' SQL:'   PV-DISP-SQLCODE                           33671021
336720              ' SHIPT:' PV-DISP-SHIPT-ID                          33672021
336730              ' TRIP:'  PV-DISP-TRIP-ID                           33673021
337300                         DELIMITED BY SIZE                        33730011
337400                       INTO WS008-CRA-RET-MSG                     33740011
337500         MOVE SQLCA     TO WS008-SQLCA                            33750011
337600         SET WS008-INVALID-SQL TO TRUE                            33760011
337610                                                                  33761022
337620         INITIALIZE  PV-CICS-MSG-AREA                             33762022
337630         STRING                                                   33763022
337640                         ' WSKCS312-6200- TAUSHIP MAX RETRIES'    33764022
337650                         ' SQL:'        PV-DISP-SQLCODE           33765025
337660                         ' SHIPT:'      PV-DISP-SHIPT-ID          33766022
337670                         ' TRIP:'       PV-DISP-TRIP-ID           33767022
337680                                    DELIMITED BY SIZE             33768022
337690                               INTO PV-CICS-MSG-AREA              33769022
337691         PERFORM 9999-WRITE-TO-CSSL                               33769122
337692                                                                  33769222
337700     END-IF.                                                      33770011
337800                                                                  33780011
337900 8000-CHECK-FOR-LOGGING.                                          33790011
337910                                                                  33791020
338100     INITIALIZE WST00010-ATTR-ELEM-TXT-TEXT.                      33810011
338200                                                                  33820011
338300     EXEC SQL                                                     33830011
338400        SELECT  D.ATTR_ELEM_TXT    AS SWITCH_IND                  33840011
338500         INTO  :PV-SWITCH-IND                                     33850011
338600         FROM   WST_INTGRTN_TYP   A                               33860011
338700              , WST_ATTR_DEFN     B                               33870011
338800              , WST_ATTR_ELEM     C                               33880011
338900              , WST_ATTR_ELEM     D                               33890011
339000         WHERE A.INTGRTN_TYP_CDE    =  'CSSLLOG'                  33900011
339100           AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE          33910011
339200           AND B.ATTR_DEFN_SEQ_NBR  =  1                          33920011
339300           AND B.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE          33930011
339400           AND C.ATTR_DEFN_SEQ_NBR  =  1                          33940011
339500           AND B.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE          33950011
339600           AND D.ATTR_DEFN_SEQ_NBR  =  2                          33960011
339700           AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR        33970011
339800           AND C.ATTR_ELEM_TXT      = 'WSKCS312'                  33980027
339900     END-EXEC                                                     33990011
340000                                                                  34000011
340100     EVALUATE TRUE                                                34010011
340200         WHEN SQLCODE = ZERO                                      34020011
340300             IF PV-SWITCH-IND   = 'Y'                             34030011
340400                 SET PS-LOG-MESSAGE  TO TRUE                      34040011
340500             ELSE                                                 34050011
340600                 SET PS-NO-LOG-MESSAGE  TO TRUE                   34060011
340700             END-IF                                               34070011
340800         WHEN SQLCODE = +100                                      34080011
340900             SET PS-NO-LOG-MESSAGE  TO TRUE                       34090011
341000         WHEN SQLWARN0 NOT = SPACES                               34100011
341100         WHEN SQLCODE NOT EQUAL ZERO                              34110011
341200             SET PS-ERROR                                         34120011
341300                 WS008-INVALID-SQL    TO TRUE                     34130011
341400             MOVE  SQLCODE            TO PV-DISP-SQLCODE          34140011
341500             STRING   ' WSKCS312-8000-'                           34150011
341600                      ' CALLED BY-'     WS008-PROGRAM-NAME        34160021
341800                      '  SQL:'          PV-DISP-SQLCODE           34180021
342100                      DELIMITED BY SIZE                           34210011
342200                                      INTO PV-CICS-MSG-AREA       34220011
342300             PERFORM 9999-WRITE-TO-CSSL                           34230011
342400             MOVE PV-CICS-MSG-AREA TO WS008-CRA-RET-MSG           34240011
342500             MOVE SQLCA     TO WS008-SQLCA                        34250011
342600             SET WS008-INVALID-SQL TO TRUE                        34260011
342700     END-EVALUATE.                                                34270011
342800                                                                  34280011
342900 9999-WRITE-TO-CSSL.                                              34290011
343000                                                                  34300011
343100     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      34310011
343200                                                                  34320011
343300     EXEC CICS                                                    34330011
343400          WRITEQ TD                                               34340011
343500           QUEUE   ('CSSL')                                       34350011
343600            FROM   (PV-CICS-MSG-AREA)                             34360011
343700          LENGTH   (PV-COMMAREA-LENGTH)                           34370011
343800            RESP   (PV-CICS-RESPONSE)                             34380011
343900     END-EXEC.                                                    34390011
344000                                                                  34400011
