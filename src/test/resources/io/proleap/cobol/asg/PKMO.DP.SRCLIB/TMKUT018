000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TMKUT018.                                00050000
000600 AUTHOR.                 TKMA497.                                 00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JANUARY 2005.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM WILL CALL 'TMKUT500' FOR THE BATCH  BEGINNING OF  *00120000
001300* THE AUTO ACKNOWLEDGE / AUTO REDISTRO PROCESS, AND DISPLAY      *00130000
001400* ERROR MESSAGES IF THE CALL IS NOT SUCCESSFUL, OR ABEND IF      *00140000
001500* THE CALL ENCOUNTERED AN UNRECOVERABLE DB2 ERROR.               *00150000
001600*----------------------------------------------------------------*00160000
      * CHANGE LOG:                                                             
      *  09/26/2022  JEAN KURK  RECOMPILE FOR COBOL UPGRADE                     
      *                                CHG0274597                               
      ******************************************************************        
001700                                                                  00170000
001800******************************************************************00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000******************************************************************00200000
002100                                                                  00210000
002200 CONFIGURATION SECTION.                                           00220000
002300                                                                  00230000
002400 SOURCE-COMPUTER.        IBM-3090.                                00240000
002500 OBJECT-COMPUTER.        IBM-3090.                                00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800                                                                  00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003500******************************************************************00350000
003600 DATA DIVISION.                                                   00360000
003700******************************************************************00370000
003800                                                                  00380000
003900 FILE SECTION.                                                    00390000
005800*------------------------------------------------------*          00580000
005900 WORKING-STORAGE SECTION.                                         00590000
006000*------------------------------------------------------*          00600000
006100 01 PC-PROGRAM-CONSTANTS.                                         00610000
006200    05  PC-PROGRAM-NAME              PIC X(08) VALUE 'TMKUT018'.  00620000
006300    05  PC-AUTO-ACK-DRIVER           PIC X(08) VALUE 'TMKUT500'.        00
010300                                                                  00850006
004500 01  ABEND-CODE                          PIC S9(04)  VALUE ZERO           
004600                                                     COMP SYNC.           
010400*01 PS-PROGRAM-SWITCHES.                                          00860000
016500 01 PV-PROGRAM-VARIABLES.                                         01073006
          05  PV-PO-NBR                    PIC 9(9).                            
          05  PV-REC-SEQ-NBR               PIC 9(3).                            
          05  PV-OPER-UNT-ID               PIC 9(4).                            
          05  PV-NOTIF-NBR                 PIC 9(9).                            
003300    05  PV-CURRENT-TMST              PIC X(26)  VALUE SPACES.             
031100                                                                  02420000
      *----------------------------------------------------------------*        
      *    THE LAYOUT FOR THE COMMAREA USED TO PASS BETWEEN THIS       *        
      *    PROGRAM AND TMKUT500 (AUTO ACKNOWLEDGE PROCESS).            *        
      *----------------------------------------------------------------*        
031300     COPY TMRD007.                                                02440000
                                                                                
011500*  ABEND COPYBOOK.                                                        
011600     COPY DPWS004.                                                        
                                                                                
016800     EXEC SQL                                                             
016900          INCLUDE SQLCA                                                   
017000     END-EXEC.                                                            
031400                                                                  02450000
033700 PROCEDURE DIVISION.                                              02680000
033800                                                                        00
033900 0000-MAINLINE-PROCESSING.                                        02700000
      * * * THIS EXEC SQL IS JUST TO MAKE IT A DB2 PROGRAM                      
      * * * AND A BASIC CHECK ON THE HEALTH OF DB2                              
088600     EXEC SQL                                                             
088700         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                         
088800     END-EXEC                                                             
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   PERFORM 9900-SQL-ABEND                                       
           END-EVALUATE                                                         
M34000                                                                  02710000
           INITIALIZE TM007-RETURN-DATA                                         
                      TM007-RETURN-DATA-2                                       
           SET TM007-CALL-SUCCESSFUL                                            
               TM007-CALLED-FROM-CICS-NO                                        
               TM007-EMAIL-NONE          TO TRUE                                
           CALL TM007-AUTO-ACK-PGM    USING TM007-COMMUNICATIONS-AREA.          
                                                                        02780000
138600******************************************************************        
138700*  CHECK THE E-MAIL NOTIFICATION RETURN CODES                             
138900******************************************************************        
           IF TM007-EMAIL-CONTENTION                                            
               MOVE 4080 TO RETURN-CODE                                         
           END-IF.                                                              
           IF TM007-EMAIL-ERROR                                                 
               MOVE 4090 TO RETURN-CODE                                         
           END-IF.                                                              
                                                                                
034800     STOP RUN.                                                    02790000
                                                                                
138600******************************************************************        
138700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL            
138800*  ERROR OR WARNING CODE OCCURS.                                          
138900******************************************************************        
139000 9900-SQL-ABEND.                                                          
139200     DISPLAY '** ABEND     **'.                                           
139300     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME                         
139600                                                                          
139700******************************************************************        
139800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
139900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
140000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
140100* FORMAT.                                                                 
140200******************************************************************        
140300     COPY DPPD004.                                                        
140400                                                                          
140500     MOVE +4013                  TO ABEND-CODE.                           
140600     CALL 'ILBOABN0' USING ABEND-CODE.                                    
