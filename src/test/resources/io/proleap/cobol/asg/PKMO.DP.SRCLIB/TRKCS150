000100*-----------------------*                                         00010072
000200 IDENTIFICATION DIVISION.                                         00020072
000300*-----------------------*                                         00030072
000400 PROGRAM-ID.    TRKCS150.                                         00040072
000500 AUTHOR.        LARRY SCHLEICHER (STRATAGEM).                     00050072
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060072
000700 DATE-WRITTEN.  06-10-97.                                         00070072
000800 DATE-COMPILED.                                                   00080072
000900*----------------------------------------------------------------*00090072
001000*    Y150 - FREE ON BOARD CODE CRITERIA SPECIFICATIONS           *00100072
001100*                                                                *00110072
001200*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00120072
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130072
001400*    DETAIL SCREEN.  THE FOB CODE, IF ENTERED, IS EDITTED        *00140072
001500*    TO BE A VALID CODE.  ALL OTHER EDITS ARE DONE IN THE        *00150072
001600*    DESTINATION PROGRAMS WHEN THE 'GO-TO' TYPE FUNCTION IS USED *00160072
001700*    (LOCAL-FUNC-01 THRU LOCAL-FUNC-12, WITH DISPOSITION 'G').   *00170072
001800*                                                                *00180072
001900*    02/19/2003     MADE CHANGES TO INCLUDE THE DECONSOLIDATOR   *00190072
002000*                   SCAC TO FOB SCREENS    -VISWA KARUTURI       *00200072
002100*----------------------------------------------------------------*00210072
P5207 *    11/20/2013   ADDED A NEW FIELD INCOTERM CODE TO TRKCS151 AND*00220072
P5207 *    TRKCS152 SCREENS AND HENCE THE CODE HAS BEEN MODIFIED       *00230072
P5207 *    TO FETCH THE INCOTERM CODE AS WELL FOR A PARTICULAR FOB CODE*00240072
P5207 *    - SHEBENA  CHANGE TAG : P5207  CR # : CHG0081355            *00250082
P5207 *----------------------------------------------------------------*00260072
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00261083
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00262083
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00263083
CICS  *-----------------------------------------------------------------00264083
002200                                                                  00270072
002300 ENVIRONMENT DIVISION.                                            00280072
002400                                                                  00290072
002500 DATA DIVISION.                                                   00300072
002600                                                                  00310072
002700 WORKING-STORAGE SECTION.                                         00320072
002800*                                                                 00330072
002900 01  DK-DB2-CONSTANTS.                                            00340072
003000     05  DK-FOB-CDE                PIC  X(03).                    00350072
003100     05  DK-ENT-ID                 PIC S9(09) COMP.               00360072
003200                                                                  00370072
003300 01  PV-PROGRAM-VARIABLES.                                        00380072
003400     05  PV-ASTRK-CNT              PIC S9(04)  VALUE +0           00390072
003500                                                    COMP SYNC.    00400072
003600     05  PV-FOB-CODE               PIC  X(03)  VALUE SPACE.       00410072
003700 01  PC-PROGRAM-CONSTANTS.                                        00420072
003800     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TR150A  '. 00430072
003900     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TRKM150 '. 00440072
004000     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TRKCS150'. 00450072
004100     05  PC-ASTRK                  PIC  X(01)  VALUE '*'.         00460072
004200     05  PC-A                      PIC  X(01)  VALUE 'A'.         00470072
004300     05  PC-I                      PIC  X(01)  VALUE 'I'.         00480072
004400     05  PC-PRIMARY                PIC XX    VALUE '01'.          00490072
004500     05  PC-TSYMSG-NUMBERS.                                       00500072
004600         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00510072
004700         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00520072
004800         10  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.      00530072
004900         10  PC-TSYMSG-00224       PIC  9(05)  VALUE  00224.      00540072
005000         10  PC-TSYMSG-01451       PIC  9(05)  VALUE  01451.      00550072
005100         10  PC-TSYMSG-01644       PIC  9(05)  VALUE  01644.      00560072
005200*                                                                 00570072
005300 01  PS-PROGRAM-SWITCHES.                                         00620072
005400     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00630072
005500         88  PS-ERROR                          VALUE  'Y'.        00640072
005600         88  PS-NO-ERROR                       VALUE  'N'.        00650072
005700                                                                  00660072
005800 01  PM-PROGRAM-MESSAGES.                                         00670072
005900     05  PM-ABEND-INFO-A.                                         00680072
006000         10  FILLER                PIC X(15)   VALUE              00690072
006100                                   'DP020-SRC-AID: '.             00700072
006200         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00710072
006300         10  FILLER                PIC X(19)   VALUE              00720072
006400                                   '. DP020-FK-ACTION: '.         00730072
006500         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00740072
006600         10  FILLER                PIC X(22)   VALUE              00750072
006700                                   '. DP020-FK-DISPN-IND: '.      00760072
006800         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00770072
006900         10  FILLER                PIC X(01)   VALUE '.'.         00780072
007000         10  FILLER                PIC X(19)   VALUE SPACE.       00790072
007100                                                                  00800072
007200                                                                  00810072
007300*----------------------------------------------------------------*00820072
007400*    MAP LAYOUT                                                  *00830072
007500*----------------------------------------------------------------*00840072
007600                                                                  00850072
007700     COPY TRKM150.                                                00860072
007800     EJECT                                                        00870072
007900*----------------------------------------------------------------*00880072
008000*    ATTRIBUTE SETTINGS COPYBOOK.                                *00890072
008100*----------------------------------------------------------------*00900072
008200                                                                  00910072
008300     COPY DPWS015.                                                00920072
008400                                                                  00930072
008500*----------------------------------------------------------------*00940072
008600*    FUNCTION KEYS COPYBOOK                                      *00950072
008700*----------------------------------------------------------------*00960072
008800                                                                  00970072
008900     COPY DPWS016.                                                00980072
009000 EJECT                                                            00990072
009100******************************************************************01000072
009200** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01010072
009300** SUB-ROUTINE (DPKUT100).                                      **01020072
009400******************************************************************01030072
009500     COPY DPWS010I.                                               01040072
009600 EJECT                                                            01050072
009700******************************************************************01060072
009800** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01070072
009900** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01080072
010000******************************************************************01090072
010100     COPY DPWS030.                                                01100072
CICS       COPY DPWS930.                                                01101083
010200 EJECT                                                            01110072
010300***************************************************************** 01120072
010400*    STANDARD COMMAREA.                                           01130072
010500***************************************************************** 01140072
010600                                                                  01150072
010700     COPY DPWS020.                                                01160072
010800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01170072
010900                                                                  01180072
011000***************************************************************** 01190072
011100*    INTER-APPLICATION COMMAREA.                                  01200072
011200***************************************************************** 01210072
011300                                                                  01220072
011400         10  INTER-APPL-COMM-AREA PIC X(200).                     01230078
011500     COPY TRWS019.                                                01240072
011600***************************************************************** 01250072
011700*    SPECIFIC COMMMAREA FOR TRKCS150.                             01260072
011800***************************************************************** 01270072
011900         10  ASC-SPECIFIC-COMMAREA.                               01280072
012000             15  ASC-FOB-CODE                   PIC  X(03).       01290072
012100             15  ASC-FOB-STD-EDI-CDE            PIC X(05).        01300072
012200             15  ASC-FOB-CITY-NAME              PIC  X(30).       01310072
012300             15  ASC-FOB-CODE-IND               PIC  X(01).       01320072
012400                 88  ASC-VALID-FOB-CODE        VALUE 'Y'.         01330072
012500                 88  ASC-INVALID-FOB-CODE      VALUE 'N'.         01340072
012600             15  ASC-CONSLR-NAME                PIC  X(11).       01350072
012700             15  ASC-CONSLR-ENT-ID              PIC S9(9).        01360072
012800             15  ASC-DECONL-NAME                PIC  X(11).       01370072
012900             15  ASC-DECONL-ENT-ID              PIC S9(9).        01380072
013000             15  ASC-CSTM-BKR-NAME              PIC  X(11).       01390072
013100             15  ASC-CSTM-BKR-ENT-ID            PIC S9(9).        01400072
013200             15  ASC-FOB-CNTRY-CODE             PIC  X(03).       01410072
013300             15  ASC-POE-CODE                   PIC  X(03).       01420072
013400             15  ASC-FOB-STAT-CDE               PIC  X(01).       01430072
P5207              15  ASC-INCOTERM-CODE              PIC  X(03).       01440072
013500     EJECT                                                        01460072
013600*----------------------------------------------------------------*01470072
013700*    ABEND PROCESSING COPYBOOK.                                  *01480072
013800*----------------------------------------------------------------*01490072
013900                                                                  01500072
014000     COPY DPWS013.                                                01510072
014100                                                                  01520072
014200*---------------------------------------------------------------* 01530072
014300*    DB2 AREA FOR FREE ON BOARD TABLE                           * 01540072
014400*---------------------------------------------------------------* 01550072
014500     EXEC SQL                                                     01560072
014600          INCLUDE TIMFOB                                          01570072
014700     END-EXEC.                                                    01580072
014800                                                                  01590072
014900*---------------------------------------------------------------* 01600072
015000*    DB2 AREA FOR TENTNME                                       * 01610072
015100*---------------------------------------------------------------* 01620072
015200     EXEC SQL                                                     01630072
015300          INCLUDE TENTNME                                         01640072
015400     END-EXEC.                                                    01650072
015500                                                                  01660072
015600*---------------------------------------------------------------* 01670072
015700*    DB2 AREA FOR TEXTENT                                       * 01680072
015800*---------------------------------------------------------------* 01690072
015900     EXEC SQL                                                     01700072
016000          INCLUDE TEXTENT                                         01710072
016100     END-EXEC.                                                    01720072
016200                                                                  01730072
016300*---------------------------------------------------------------* 01880072
016400*    DB2 AREA FOR COMMUNICATIONS                                * 01890072
016500*---------------------------------------------------------------* 01900072
016600     EXEC SQL                                                     01910072
016700          INCLUDE SQLCA                                           01920072
016800     END-EXEC.                                                    01930072
016900                                                                  01940072
017000 EJECT                                                            01950072
017100 LINKAGE SECTION.                                                 01960072
017200                                                                  01970072
017300 01  DFHCOMMAREA.                                                 01980072
017400     05  FILLER                         OCCURS  1 TO 4072 TIMES   01990072
017500                                        DEPENDING ON EIBCALEN.    02000072
017600         10  FILLER                     PIC X.                    02010072
017700                                                                  02020072
017800                                                                  02030072
017900 PROCEDURE DIVISION.                                              02040072
018000***************************************************************** 02050072
018100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02060072
018200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02070072
018300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02080072
018400**                                                             ** 02090072
018500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02100072
018600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02110072
018700***************************************************************** 02120072
018800 0000-MAIN-MODULE.                                                02130072
018900     INITIALIZE DP030-CICS-API-FIELDS.                            02140072
019000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02150072
019100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02160072
019200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02170072
019300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02180072
019400     MOVE LENGTH OF TR150AI        TO DP030-MAP-LENGTH (1).       02190072
019500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02200072
019600     PERFORM 0001-CALL-CICS-ARCH-API.                             02210072
019700*                                                                 02220072
019800     PERFORM 1000-CONTROL-PROCESSING                              02230072
019900*                                                                 02240072
020000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02250072
020100     PERFORM 0001-CALL-CICS-ARCH-API.                             02260072
020200                                                                  02270072
020300 0001-CALL-CICS-ARCH-API.                                         02280072
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02290083
020500                                    DFHCOMMAREA                   02300083
020600                                    DP030-CICS-API-FIELDS         02310083
020700                                    DP020-STANDARD-COMMAREA       02320083
020800                                    TR150AI.                      02330083
020900*                                                                 02340072
021000     IF  DP030-RC-CALL-SUCCESSFUL                                 02350072
021100         CONTINUE                                                 02360072
021200     ELSE                                                         02370072
021300         SET DP013-NO-ROLLBACK                                    02380072
021400             DP013-XCTL-DISPLAY-RESTART                           02390072
021500             DP013-CICS-ABEND      TO TRUE                        02400072
021600         MOVE 'BEFORE 0000-MAIN-MODULE'                           02410072
021700                                   TO DP013-PARAGRAPH             02420072
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02430083
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02440083
022000         MOVE DP030-RETURN-CODE                                   02450072
022100                                   TO DP013-MESSAGE-TEXT (3)      02460072
022200         PERFORM DP013-0000-PROCESS-ABEND                         02470072
022300     END-IF.                                                      02480072
022400 EJECT                                                            02490072
022500*----------------------------------------------------------------*02500072
022600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02510072
022700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02520072
022800*----------------------------------------------------------------*02530072
022900                                                                  02540072
023000 1000-CONTROL-PROCESSING.                                         02550072
023100                                                                  02560072
023200     EVALUATE TRUE                                                02570072
023300         WHEN DP020-NEXT-ACT-INITIAL                              02580072
023400             INITIALIZE ASC-SPECIFIC-COMMAREA                     02590072
023500             PERFORM 4000-BUILD-INITIAL-PANEL                     02600072
023600                                                                  02610072
023700         WHEN DP020-NEXT-ACT-READ-MAP                             02620072
023800             PERFORM 2000-FKEY-PROCESSING                         02630072
023900                                                                  02640072
024000         WHEN DP020-NEXT-ACT-RETURN                               02650072
024100             MOVE SPACES  TO ASC-FOB-STAT-CDE                     02660072
024200                                                                  02670072
024300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02680072
024400             MOVE -1               TO AFOBCODL                    02690072
024500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  02700072
024600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02710072
024700                                                                  02720072
024800         WHEN OTHER                                               02730072
024900             SET DP013-LOGIC-ABEND                                02740072
025000                 DP013-NO-ROLLBACK TO TRUE                        02750072
025100             MOVE '1000-CONTROL-PROCESSING'                       02760072
025200                                   TO  DP013-PARAGRAPH            02770072
025300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02780072
025400                                   TO  DP013-MESSAGE-TEXT(1)      02790072
025500             MOVE DP020-NEXT-APPL-ACTIVITY                        02800072
025600                                   TO DP013-MESSAGE-TEXT(2)       02810072
025700             PERFORM DP013-0000-PROCESS-ABEND                     02820072
025800     END-EVALUATE.                                                02830072
025900                                                                  02840072
026000*----------------------------------------------------------------*02850072
026100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02860072
026200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02870072
026300* EDITS.                                                         *02880072
026400*----------------------------------------------------------------*02890072
026500                                                                  02900072
026600 2000-FKEY-PROCESSING.                                            02910072
026700                                                                  02920072
026800     EVALUATE TRUE                                                02930072
026900                                                                  02940072
027000         WHEN DP020-SRC-AID = DP016-CLEAR                         02950072
027100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02960072
027200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02970072
027300                                                                  02980072
027400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02990072
027500             INITIALIZE ASC-SPECIFIC-COMMAREA                     03000072
027600             PERFORM 4000-BUILD-INITIAL-PANEL                     03010072
027700             PERFORM 3200-RESET-ATTRIBUTES                        03020072
027800                                                                  03030072
027900         WHEN OTHER                                               03040072
028000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03050072
028100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03060072
028200             IF PS-NO-ERROR OR                                    03070072
028300                DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)            03080072
028400********        DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)            03090072
028500                 SET DP030-CONTINUE-GO TO TRUE                    03100072
028600                 PERFORM 2100-CHECK-FUNCTION-KEY                  03110072
028700             ELSE                                                 03120072
028800                 SET DP030-OVERRIDE-GO TO TRUE                    03130072
028900             END-IF                                               03140072
029000     END-EVALUATE.                                                03150072
029100******************************************************************03160072
029200** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03170072
029300** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03180072
029400** FROM THE CICS ARCHITECTURE API.                              **03190072
029500******************************************************************03200072
029600 2100-CHECK-FUNCTION-KEY.                                         03210072
029700     EVALUATE TRUE                                                03220072
029800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03230072
029900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03240072
030000             IF ASC-VALID-FOB-CODE                                03250072
030100                 PERFORM 2110-PREPARE-INTER-APPL-COMM             03260072
030200             ELSE                                                 03270072
030300                 SET DP030-OVERRIDE-GO                            03280072
030400                                   TO TRUE                        03290072
030500                 MOVE PC-TSYMSG-00007                             03300072
030600                                   TO DP020-MSG-NUMBER            03310072
030700                 SET DP020-MSG-FATAL                              03320072
030800                                    TO TRUE                       03330072
030900             END-IF                                               03340072
031000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03350072
031100             MOVE 'I' TO ASC-FOB-STAT-CDE                         03360072
031200             MOVE SPACES TO ASC-FOB-CODE                          03370072
031300             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03380072
031400         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03390072
031500             IF ASC-FOB-STAT-CDE = PC-I                           03400072
031600                 SET DP030-OVERRIDE-GO                            03410072
031700                                   TO TRUE                        03420072
031800                 MOVE PC-TSYMSG-01644                             03430072
031900                                   TO DP020-MSG-NUMBER            03440072
032000                 SET DP020-MSG-FATAL                              03450072
032100                                    TO TRUE                       03460072
032200             ELSE                                                 03470072
032300                 MOVE 'A' TO ASC-FOB-STAT-CDE                     03480072
032400                 PERFORM 2110-PREPARE-INTER-APPL-COMM             03490072
032500             END-IF                                               03500072
032600                                                                  03510072
032700         WHEN DP020-SRC-AID = DP016-ENTER                         03520072
032800             CONTINUE                                             03530072
032900                                                                  03540072
033000         WHEN OTHER                                               03550072
033100             SET DP013-NO-ROLLBACK                                03560072
033200                 DP013-XCTL-DISPLAY-RESTART                       03570072
033300                 DP013-CICS-ABEND  TO TRUE                        03580072
033400             MOVE '2100-CHECK-FUNCTION-KEY'                       03590072
033500                                   TO DP013-PARAGRAPH             03600072
033600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03610072
033700                                   TO DP013-MESSAGE-TEXT (1)      03620072
033800             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 03630072
033900                                   TO DP013-MESSAGE-TEXT (2)      03640072
034000             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                03650072
034100             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 03660072
034200                                   TO PM-A-FK-ACTION              03670072
034300             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              03680072
034400                                   TO PM-A-FK-DISPN               03690072
034500             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      03700072
034600             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        03710072
034700                                   TO DP013-MESSAGE-TEXT (4)      03720072
034800             PERFORM DP013-0000-PROCESS-ABEND                     03730072
034900     END-EVALUATE.                                                03740072
035000******************************************************************03750072
035100** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03760072
035200** INTER-APPLICATION COMMAREA.                                  **03770072
035300******************************************************************03780072
035400 2110-PREPARE-INTER-APPL-COMM.                                    03790072
035500     INITIALIZE TR019-INTER-APPL-COMMAREA.                        03800072
035600     MOVE ASC-FOB-CODE             TO PV-FOB-CODE                 03810072
035700                                                                  03820072
035800     PERFORM 4330-SELECT-ENTNME                                   03830072
035900                                                                  03840072
036000     MOVE IMFOB-CONSLR-ENT-ID      TO ASC-CONSLR-ENT-ID           03850072
036100     MOVE IMFOB-DCONSLR-ENT-ID     TO ASC-DECONL-ENT-ID           03860072
036200     MOVE IMFOB-CSTM-BKR-ENT-ID    TO ASC-CSTM-BKR-ENT-ID         03870072
036300     MOVE IMFOB-FOB-CNTRY-CDE      TO ASC-FOB-CNTRY-CODE          03880072
036400     MOVE IMFOB-POE-CDE            TO ASC-POE-CODE                03890072
P5207      MOVE IMFOB-INCTRM-CDE         TO ASC-INCOTERM-CODE           03900072
036500     MOVE IMFOB-FOB-STD-EDI-CDE    TO ASC-FOB-STD-EDI-CDE         03910072
036600     MOVE ASC-FOB-CITY-NAME        TO TR019-FOB-CITY-NAME.        03920072
036700     MOVE ASC-FOB-CODE             TO TR019-FOB-CODE              03930072
036800     MOVE ASC-FOB-STD-EDI-CDE      TO TR019-FOB-STD-EDI-CDE       03940072
036900     MOVE ASC-FOB-CNTRY-CODE       TO TR019-COUNTRY-CODE          03950072
037000     MOVE ASC-FOB-CITY-NAME        TO TR019-FOB-CITY-NAME         03960072
037100     MOVE ASC-CONSLR-ENT-ID        TO TR019-CONSLR-ENT-ID         03970072
037200                                      DK-ENT-ID                   03980072
037300                                                                  03990072
037400     PERFORM 4332-SELECT-SCAC                                     04000072
037500                                                                  04010072
037600     MOVE EXTENT-SCAC-CDE          TO TR019-CONSLR-SCAC           04020072
037700                                                                  04030072
037800     MOVE ASC-DECONL-ENT-ID        TO TR019-DECONL-ENT-ID         04040072
037900                                      DK-ENT-ID                   04050072
038000                                                                  04060072
038100     PERFORM 4332-SELECT-SCAC                                     04070072
038200                                                                  04080072
038300     MOVE EXTENT-SCAC-CDE          TO TR019-DECONL-SCAC           04090072
038400                                                                  04100072
038500     MOVE ASC-CSTM-BKR-ENT-ID      TO TR019-CSTM-BKR-ENT-ID       04110072
038600                                      DK-ENT-ID                   04120072
038700                                                                  04130072
038800     PERFORM 4332-SELECT-SCAC                                     04140072
038900                                                                  04150072
039000     MOVE EXTENT-SCAC-CDE          TO TR019-CSTM-BKR-SCAC         04160072
039100     MOVE ASC-POE-CODE             TO TR019-POE-CODE.             04170072
                                                                        04180072
P5207      MOVE ASC-INCOTERM-CODE        TO TR019-INCOTERM-CODE.        04210072
                                                                        04230072
039200     MOVE ASC-FOB-STAT-CDE         TO TR019-STAT-CDE.             04240072
039300                                                                  04250072
039400     MOVE IMFOB-CONSLR-ENT-ID      TO DK-ENT-ID                   04260072
039500     PERFORM 4331-SELECT-ENTNME                                   04270072
039600     MOVE ENTNME-ENT-NAME-DESC     TO TR019-CONSLR-NAME.          04280072
039700                                                                  04290072
039800     MOVE IMFOB-DCONSLR-ENT-ID     TO DK-ENT-ID                   04300072
039900     PERFORM 4331-SELECT-ENTNME                                   04310072
040000     MOVE ENTNME-ENT-NAME-DESC     TO TR019-DECONL-NAME.          04320072
040100                                                                  04330072
040200     MOVE IMFOB-CSTM-BKR-ENT-ID    TO DK-ENT-ID                   04340072
040300     PERFORM 4331-SELECT-ENTNME                                   04350072
040400     MOVE ENTNME-ENT-NAME-DESC     TO TR019-CSTM-BKR-NAME.        04360072
040500                                                                  04370072
040600 EJECT                                                            04380072
040700*----------------------------------------------------------------*04390072
040800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04400072
040900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04410072
041000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04420072
041100*----------------------------------------------------------------*04430072
041200                                                                  04440072
041300 2200-MOVE-SCREEN-TO-COMMAREA.                                    04450072
041400     IF  AFOBCODL > ZERO                                          04460072
041500         MOVE AFOBCODI             TO ASC-FOB-CODE                04470072
041600     ELSE                                                         04480072
041700         IF  AFOBCODF = DP015-ERASE-EOF                           04490072
041800             MOVE SPACE            TO ASC-FOB-CODE                04500072
041900                                      ASC-FOB-CITY-NAME           04510072
042000         END-IF                                                   04520072
042100     END-IF.                                                      04530072
042200                                                                  04540072
042300*----------------------------------------------------------------*04550072
042400* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04560072
042500* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04570072
042600* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*04580072
042700* IN THE DESTINATION PROGRAM, NOT HERE.                          *04590072
042800*----------------------------------------------------------------*04600072
042900                                                                  04610072
043000 3000-EDIT-DATA-IN-COMMAREA.                                      04620072
043100                                                                  04630072
043200     PERFORM 3200-RESET-ATTRIBUTES.                               04640072
043300                                                                  04650072
043400     IF  ASC-FOB-CODE > SPACE OR                                  04660072
043500        ASC-FOB-CODE = SPACE                                      04670072
043600         MOVE ASC-FOB-CODE         TO DK-FOB-CDE                  04680072
043700         INSPECT DK-FOB-CDE TALLYING PV-ASTRK-CNT FOR ALL         04690072
043800                                           PC-ASTRK               04700072
043900         IF PV-ASTRK-CNT > 0                                      04710072
044000             MOVE SPACES               TO ASC-FOB-CITY-NAME       04720072
044100                                          AFOBDESO                04730072
044200             MOVE PC-A            TO ASC-FOB-STAT-CDE             04740072
044300         ELSE                                                     04750072
044400             PERFORM 3100-SELECT-FOB                              04760072
044500             IF ASC-INVALID-FOB-CODE AND                          04770072
044600               ASC-FOB-STAT-CDE = 'PC-A'                          04780072
044700                 MOVE SPACES           TO ASC-FOB-CITY-NAME       04790072
044800                                      AFOBDESO                    04800072
044900                 SET PS-ERROR                                     04810072
045000                     DP020-MSG-FATAL   TO TRUE                    04820072
045100                 MOVE PC-TSYMSG-01451  TO DP020-MSG-NUMBER        04830072
045200                 MOVE DP015-UNP-ALP-BRT-OFF                       04840072
045300                                       TO AFOBCODA                04850072
045400                 MOVE DP015-RED        TO AFOBCODC                04860072
045500                 MOVE DP015-REVERSE    TO AFOBCODH                04870072
045600                 MOVE -1               TO AFOBCODL                04880072
045700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04890072
045800             ELSE                                                 04900072
045900                 MOVE IMFOB-FOB-CTY-NM TO ASC-FOB-CITY-NAME       04910072
046000                                          AFOBDESO                04920072
046100                                                                  04930072
046200                IF (DP020-SRC-AID = DP016-PF15 OR                 04940072
046300                   DP020-SRC-AID = DP016-PF16 OR                  04950072
046400                   DP020-SRC-AID = DP016-PF17) AND                04960072
046500                 IMFOB-STAT-CDE = PC-I                            04970072
046600                     SET PS-ERROR                                 04980072
046700                         DP020-MSG-FATAL   TO TRUE                04990072
046800***                  SET DP020-NEXT-ACT-APPL-ERROR                05000072
046900***                                        TO TRUE                05010072
047000                     MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER    05020072
047100                END-IF                                            05030072
047200                                                                  05040072
047300             END-IF                                               05050072
047400         END-IF                                                   05060072
047500     END-IF.                                                      05070072
047600*                                                                 05080072
047700     IF  PS-NO-ERROR                                              05090072
047800         MOVE -1                   TO AFOBCODL                    05100072
047900         SET DP030-SET-CURSOR-APPL-1                              05110072
048000                                   TO TRUE                        05120072
048100     END-IF.                                                      05130072
048200                                                                  05140072
048300 3100-SELECT-FOB.                                                 05150072
048400                                                                  05160072
048500     EXEC SQL                                                     05170072
048600         SELECT A.FOB_CTY_NM                                      05180072
048700               ,A.STAT_CDE                                        05190072
048800            INTO :IMFOB-FOB-CTY-NM                                05200072
048900                ,:IMFOB-STAT-CDE                                  05210072
049000             FROM TIMFOB A                                        05220072
049100             WHERE A.FOB_CDE  = :DK-FOB-CDE                       05230072
049200               AND (A.STAT_CDE = :PC-A                            05240072
049300               OR   A.STAT_CDE = :PC-I)                           05250072
049400     END-EXEC                                                     05260072
049500                                                                  05270072
049600         EVALUATE TRUE                                            05280072
049700             WHEN SQLCODE = ZERO                                  05290072
049800                 SET ASC-VALID-FOB-CODE TO TRUE                   05300072
049900             WHEN SQLCODE = +100                                  05310072
050000                 SET ASC-INVALID-FOB-CODE TO TRUE                 05320072
050100                 MOVE SPACES TO IMFOB-FOB-CTY-NM                  05330072
050200             WHEN OTHER                                           05340072
050300                 MOVE '3100-SELECT-FOB'                           05350072
050400                                   TO DP013-PARAGRAPH             05360072
050500                 MOVE 'SQL ERROR SELECTING FOB CITY'              05370072
050600                                   TO DP013-MESSAGE-TEXT (1)      05380072
050700                 MOVE SQLCA        TO DP013-SQLCA                 05390072
050800                 MOVE 'TIMFOB  '   TO DP013-DB2-TABLE-NAME (1)    05400072
050900                 SET DP013-DB2-ABEND                              05410072
051000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05420072
051100                 PERFORM DP013-0000-PROCESS-ABEND                 05430072
051200         END-EVALUATE.                                            05440072
051300                                                                  05450072
051400******************************************************************05460072
051500** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **05470072
051600** MAP.                                                         **05480072
051700******************************************************************05490072
051800 3200-RESET-ATTRIBUTES.                                           05500072
051900                                                                  05510072
052000     MOVE DP015-UNP-ALP-NOR-OFF    TO AFOBCODA.                   05520072
052100     MOVE DP015-GREEN              TO AFOBCODC.                   05530072
052200     MOVE DP015-UNDERLINE          TO AFOBCODH.                   05540072
052300                                                                  05550072
052400     MOVE DP015-HL-OFF             TO AFOBDESH                    05560072
052500     MOVE DP015-PRO-NOR-OFF        TO AFOBDESA                    05570072
052600     MOVE DP015-BLUE               TO AFOBDESC.                   05580072
052700*                                                                 05590072
052800*----------------------------------------------------------------*05600072
052900*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *05610072
053000*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *05620072
053100*  IT HERE.                                                      *05630072
053200*----------------------------------------------------------------*05640072
053300 4000-BUILD-INITIAL-PANEL.                                        05650072
053400     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        05660072
053500     MOVE -1                       TO AFOBCODL.                   05670072
053600*                                                                 05680072
053700  4330-SELECT-ENTNME.                                             05690072
053800                                                                  05700072
053900     EXEC SQL                                                     05710072
054000          SELECT                                                  05720072
054100                FOB_CDE                                           05730072
054200              , FOB_STD_EDI_CDE                                   05740072
054300              , FOB_CTY_NM                                        05750072
054400              , FOB_CNTRY_CDE                                     05760072
054500              , CONSLR_ENT_ID                                     05770072
054600              , CSTM_BKR_ENT_ID                                   05780072
054700              , POE_CDE                                           05790072
P5207               , INCTRM_CDE                                        05800072
054800              , DCONSLR_ENT_ID                                    05810072
054900          INTO  :IMFOB-FOB-CDE                                    05820072
055000              , :IMFOB-FOB-STD-EDI-CDE                            05830072
055100              , :IMFOB-FOB-CTY-NM                                 05840072
055200              , :IMFOB-FOB-CNTRY-CDE                              05850072
055300              , :IMFOB-CONSLR-ENT-ID                              05860072
055400              , :IMFOB-CSTM-BKR-ENT-ID                            05870072
055500              , :IMFOB-POE-CDE                                    05880072
P5207               , :IMFOB-INCTRM-CDE                                 05890072
055600              , :IMFOB-DCONSLR-ENT-ID                             05900072
055700          FROM  TIMFOB                                            05910072
055800          WHERE FOB_CDE = :PV-FOB-CODE                            05920072
055900            AND STAT_CDE = :PC-A                                  05930072
056000     END-EXEC.                                                    05940072
056100                                                                  05950072
056200         EVALUATE TRUE                                            05960072
056300             WHEN SQLCODE = ZERO                                  05970072
056400                 CONTINUE                                         05980072
056500             WHEN SQLCODE = +100                                  05990072
056600                 MOVE ZEROES TO IMFOB-CONSLR-ENT-ID               06000072
056700                 MOVE ZEROES TO IMFOB-CSTM-BKR-ENT-ID             06010072
056800                 MOVE SPACES TO IMFOB-FOB-STD-EDI-CDE             06020072
056900                 MOVE SPACES TO IMFOB-FOB-CNTRY-CDE               06030072
057000                 MOVE SPACES TO IMFOB-POE-CDE                     06040072
P5207                  MOVE SPACES TO IMFOB-INCTRM-CDE                  06050072
057100                 CONTINUE                                         06060072
057200             WHEN OTHER                                           06070072
057300                 MOVE '4330-SELECT-ENTNME'                        06080072
057400                                   TO DP013-PARAGRAPH             06090072
057500                 MOVE 'SQL ERROR SELECTING ENTNME NAME'           06100072
057600                                   TO DP013-MESSAGE-TEXT (1)      06110072
057700                 MOVE SQLCA        TO DP013-SQLCA                 06120072
057800                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    06130072
057900                 SET DP013-DB2-ABEND                              06140072
058000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           06150072
058100                 PERFORM DP013-0000-PROCESS-ABEND                 06160072
058200         END-EVALUATE.                                            06170072
058300                                                                  06180072
058400                                                                  06190072
058500 4331-SELECT-ENTNME.                                              06200072
058600                                                                  06210072
058700     EXEC SQL                                                     06220072
058800         SELECT A.ENT_NAME_DESC                                   06230072
058900            INTO :ENTNME-ENT-NAME-DESC                            06240072
059000             FROM TENTNME A                                       06250072
059100             WHERE A.ENT_ID    = :DK-ENT-ID                       06260072
059200             AND SEQ_NBR =                                        06270072
059300                 (SELECT MAX(SEQ_NBR)                             06280072
059400                    FROM TENTNME                                  06290072
059500                   WHERE ENT_ID   = :DK-ENT-ID                    06300072
059600                     AND TYPE_CDE = :PC-PRIMARY)                  06310072
059700             AND TYPE_CDE = :PC-PRIMARY                           06320072
059800     END-EXEC                                                     06330072
059900                                                                  06340072
060000         EVALUATE TRUE                                            06350072
060100             WHEN SQLCODE = ZERO                                  06360072
060200                 CONTINUE                                         06370072
060300             WHEN SQLCODE = +100                                  06380072
060400                 MOVE SPACES TO ENTNME-ENT-NAME-DESC              06390072
060500                 CONTINUE                                         06400072
060600             WHEN OTHER                                           06410072
060700                 MOVE '4330-SELECT-ENTNME'                        06420072
060800                                   TO DP013-PARAGRAPH             06430072
060900                 MOVE 'SQL ERROR SELECTING ENTNME NAME'           06440072
061000                                   TO DP013-MESSAGE-TEXT (1)      06450072
061100                 MOVE SQLCA        TO DP013-SQLCA                 06460072
061200                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    06470072
061300                 SET DP013-DB2-ABEND                              06480072
061400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           06490072
061500                 PERFORM DP013-0000-PROCESS-ABEND                 06500072
061600         END-EVALUATE.                                            06510072
061700                                                                  06520072
061800 4332-SELECT-SCAC.                                                06530072
061900                                                                  06540072
062000     EXEC SQL                                                     06550072
062100         SELECT A.ENT_ID,                                         06560072
062200                B.SCAC_CDE                                        06570072
062300            INTO :ENTNME-ENT-ID,                                  06580072
062400                 :EXTENT-SCAC-CDE                                 06590072
062500             FROM TENTNME A,                                      06600072
062600                  TEXTENT B                                       06610072
062700             WHERE A.ENT_ID = B.ENT_ID                            06620072
062800               AND A.ENT_ID = :DK-ENT-ID                          06630072
062900               AND A.TYPE_CDE = :PC-PRIMARY                       06640072
063000     END-EXEC                                                     06650072
063100                                                                  06660072
063200         EVALUATE TRUE                                            06670072
063300             WHEN SQLCODE = ZERO                                  06680072
063400                 CONTINUE                                         06690072
063500             WHEN SQLCODE = +100                                  06700072
063600                 MOVE SPACES TO EXTENT-SCAC-CDE                   06710072
063700                 CONTINUE                                         06720072
063800             WHEN OTHER                                           06730072
063900                 MOVE '4332-SELECT-SCAC  '                        06740072
064000                                   TO DP013-PARAGRAPH             06750072
064100                 MOVE 'SQL ERROR SELECTING ENTNME NAME'           06760072
064200                                   TO DP013-MESSAGE-TEXT (1)      06770072
064300                 MOVE SQLCA        TO DP013-SQLCA                 06780072
064400                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    06790072
064500                 SET DP013-DB2-ABEND                              06800072
064600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           06810072
064700                 PERFORM DP013-0000-PROCESS-ABEND                 06820072
064800         END-EVALUATE.                                            06830072
064900                                                                  07310072
065000*----------------------------------------------------------------*07320072
065100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *07330072
065200*----------------------------------------------------------------*07340072
065300 4400-MOVE-COMMAREA-TO-SCREEN.                                    07350072
065400     MOVE ASC-FOB-CODE             TO AFOBCODO.                   07360072
065500     MOVE ASC-FOB-CITY-NAME        TO AFOBDESO.                   07370072
065600 EJECT                                                            07380072
065700*----------------------------------------------------------------*07390072
065800*    ABEND PROCESSOR MODULE                                      *07400072
065900*----------------------------------------------------------------*07410072
066000                                                                  07420072
066100     COPY DPPD013.                                                07430072
