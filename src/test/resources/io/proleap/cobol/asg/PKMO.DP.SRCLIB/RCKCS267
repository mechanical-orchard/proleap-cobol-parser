000100 IDENTIFICATION DIVISION.                                         00010015
000200 PROGRAM-ID.    RCKCS267.                                         00020020
000300 AUTHOR.        LARRY SCHLEICHER                                  00030015
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040015
000500 DATE-WRITTEN.  04/14/95.                                         00050015
000600 DATE-COMPILED.                                                   00060015
000700                                                                  00070015
000800*---------------------------------------------------------------* 00080015
000900*    TRANID      - E267                                         * 00090015
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100015
001100*    DESCRIPTION - PACK SLIP HEADER INQUIRY                     * 00110015
001200*    MAPSET      - RCKM267                                      * 00120015
001300*                                                               * 00130015
001400*    THIS PROGRAM ALLOWS THE USER TO VIEW PACK SLIP HEADER      * 00140015
001500*    INFORMATION.                                               * 00150015
001600*                                                               * 00160015
001700*---------------------------------------------------------------* 00170017
001800*               C H A N G E     L O G                           * 00180015
001900*---------------------------------------------------------------* 00190015
002000* 2012-04-05 CHRISTINE TWIEHAUS                 WR40574         * 00200015
002100*            DISPLAY CAN (CARR-AUTH-ID)                         * 00210015
002200*---------------------------------------------------------------* 00220015
002300                                                                  00230015
002400 ENVIRONMENT DIVISION.                                            00240015
002500 DATA DIVISION.                                                   00250015
002600                                                                  00260015
002700 WORKING-STORAGE SECTION.                                         00270015
002800                                                                  00280015
002900 01  DK-DB2-KEYS.                                                 00290015
003000     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00300015
003100     05  DK-SEQ-NBR                   PIC S9(4) COMP VALUE +0.    00310015
003200     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    00320015
003300     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    00330015
003400     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00340015
003500     05  DK-STR-DEST-NBR              PIC S9(4) COMP VALUE +0.    00350015
003600     05  DK-PRO-NBR                   PIC X(16) VALUE SPACES.     00360015
003700     05  DK-BOL-NBR                   PIC X(16) VALUE SPACES.     00370015
003800     05  DK-SCAC-ID                   PIC X(04) VALUE SPACES.     00380015
003900     05  DK-PKSL-NBR                  PIC X(10) VALUE SPACES.     00390015
004000     05  DK-SCAC-ID-B                 PIC X(04) VALUE SPACES.     00400015
004100     05  DK-SCAC-ID-E                 PIC X(04) VALUE '9999'.     00410015
004200*VML 05  DK-OPER                      PIC S9(4) COMP VALUE +0.    00420015
004300*VML 05  DK-FCLTY                     PIC S9(4) COMP VALUE +0.    00430015
004400     05  DK-SHIPT-ID                  PIC S9(9) COMP VALUE +0.    00440015
004500                                                                  00450015
004600 01  PC-PROGRAM-CONSTANTS.                                        00460015
004700     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E267'.    00470015
004800     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS267'.00480015
004900     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC267A  '.00490015
005000     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM267 '.00500015
005100     05  PC-TROUBLE-RTN               PIC X(08)  VALUE 'TMKCS520'.00510015
005200     05  PC-TROUBLE-RTN-LENGTH        PIC S9(04) VALUE +600       00520015
005300                                                 COMP.            00530015
005400     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00540015
005500                                                 COMP.            00550015
005600     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00560015
005700                                                 COMP.            00570015
005800     05  PC-1                         PIC S9(09) VALUE +1         00580015
005900                                                 COMP.            00590015
006000     05  PC-9000                      PIC S9(9)  VALUE 9000       00600015
006100                                                 COMP.            00610015
006200     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       00620015
006300     05  PC-INACTIVE                  PIC X(01)  VALUE 'I'.       00630015
006400     05  PC-AC                        PIC X(02)  VALUE 'AC'.      00640015
006500     05  PC-CM                        PIC X(02)  VALUE 'CM'.      00650015
006600     05  PC-DE                        PIC X(02)  VALUE 'DE'.      00660015
006700     05  PC-DS                        PIC X(02)  VALUE 'DS'.      00670015
006800     05  PC-IN                        PIC X(02)  VALUE 'IN'.      00680015
006900     05  PC-IP                        PIC X(02)  VALUE 'IP'.      00690015
007000     05  PC-VE                        PIC X(02)  VALUE 'VE'.      00700015
007100     05  PC-03                        PIC X(02)  VALUE '03'.      00710015
007200     05  PC-Y                         PIC X(01)  VALUE 'Y'.       00720015
007300     05  PC-AC-DESC                   PIC X(10)  VALUE            00730015
007400         'ACTIVE    '.                                            00740015
007500     05  PC-CM-DESC                   PIC X(10)  VALUE            00750015
007600         'COMPLETE  '.                                            00760015
007700     05  PC-DE-DESC                   PIC X(10)  VALUE            00770015
007800         'DELETED   '.                                            00780015
007900     05  PC-IN-DESC                   PIC X(10)  VALUE            00790015
008000         'INACTIVE  '.                                            00800015
008100     05  PC-IP-DESC                   PIC X(10)  VALUE            00810015
008200         'IN PROCESS'.                                            00820015
008300     05  PC-VE-DESC                   PIC X(10)  VALUE            00830015
008400         'VERIFIED  '.                                            00840015
008500     05  PC-FA-PREV-RCVR-HDG          PIC X(13)  VALUE            00850015
008600         'FA PREV RCVR:'.                                         00860015
008700     05  PC-DPKUT500                  PIC X(08)  VALUE 'DPKUT500'.00870015
008800     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00880015
008900                                                 '0001-01-01'.    00890015
009000     05  PC-DEFAULT-TIME              PIC X(08)  VALUE            00900015
009100                                                 '00.00.00'.      00910015
009200     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00920015
009300         '9999-09-09-09.09.09.999999'.                            00930015
009400     05  PC-INTER-APPL-CODES.                                     00940015
009500         10  PC-INTER-APPL-LIST       PIC X(01)  VALUE '1'.       00950015
009600         10  PC-LIST-FORMAT-4         PIC X(01)  VALUE '4'.       00960015
009700                                                                  00970015
009800     05  PC-TSYMSG-NUMBERS.                                       00980015
009900         10  PC-TSYMSG-00004          PIC 9(05)  VALUE 00004.     00990015
010000*            PRESS F2 TO CONFIRM REQUEST                          01000015
010100         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     01010015
010200*            INVALID VALUE                                        01020015
010300         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     01030015
010400*            REQUIRED ENTRY                                       01040015
010500         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     01050015
010600*            MUST BE NUMERIC                                      01060015
010700         10  PC-TSYMSG-00009          PIC 9(05)  VALUE 00009.     01070015
010800*            INVALID DATE                                         01080015
010900         10  PC-TSYMSG-00010          PIC 9(05)  VALUE 00010.     01090015
011000*            CANNOT BE ZERO                                       01100015
011100         10  PC-TSYMSG-00017          PIC 9(05)  VALUE 00017.     01110015
011200*            STORE NUMBER DOES NOT EXIST                          01120015
011300         10  PC-TSYMSG-00034          PIC 9(05)  VALUE 00034.     01130015
011400*            ADD SUCCESSFUL                                       01140015
011500         10  PC-TSYMSG-00045          PIC 9(05)  VALUE 00045.     01150015
011600*            INVALID FUNCTION KEY                                 01160015
011700         10  PC-TSYMSG-00046          PIC 9(05)  VALUE 00046.     01170015
011800*            DATA NOT CHANGED; NO UPDATE PERFORMED                01180015
011900         10  PC-TSYMSG-00047          PIC 9(05)  VALUE 00047.     01190015
012000*            ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION 01200015
012100         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01210015
012200*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01220015
012300         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01230015
012400*            UPDATE(S) SUCCESSFUL                                 01240015
012500         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01250015
012600*            TOP OF LIST                                          01260015
012700         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01270015
012800*            BOTTOM OF LIST                                       01280015
012900         10  PC-TSYMSG-00083          PIC 9(05)  VALUE 00083.     01290015
013000*            PURCHASE ORDER DOES NOT EXIST                        01300015
013100         10  PC-TSYMSG-00115          PIC 9(05)  VALUE 00115.     01310015
013200*            DELETE SUCCESSFUL                                    01320015
013300         10  PC-TSYMSG-00116          PIC 9(05)  VALUE 00116.     01330015
013400*            CANNOT DELETE - RECORD DOES NOT EXIST                01340015
013500         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01350015
013600*            DATA DOES NOT EXIST                                  01360015
013700         10  PC-TSYMSG-00254          PIC 9(05)  VALUE 00254.     01370015
013800*            ERRORS OCCURRED; NO UPDATE PERFORMED                 01380015
013900         10  PC-TSYMSG-00308          PIC 9(05)  VALUE 00308.     01390015
014000*            AT LEAST ONE ENTRY IS REQUIRED                       01400015
014100         10  PC-TSYMSG-00352          PIC 9(05)  VALUE 00352.     01410015
014200*            ADD PENDING                                          01420015
014300         10  PC-TSYMSG-00461          PIC 9(05)  VALUE 00461.     01430015
014400*            PURCHASE ORDER NUMBER REQUIRED                       01440015
014500         10  PC-TSYMSG-00464          PIC 9(05)  VALUE 00464.     01450015
014600*            RECEIVER MUST BE ADDED FIRST BEFORE ATTEMPTING UPDATE01460015
014700         10  PC-TSYMSG-00532          PIC 9(05)  VALUE 00532.     01470015
014800*            ONE OR MORE UPDATES UNSUCCESSFUL.  REFRESH TO SEE    01480015
014900         10  PC-TSYMSG-00638          PIC 9(05)  VALUE 00638.     01490015
015000*            SHIPPING DESTINATION IS NOT CORRECT FOR DIRECT TO STR01500015
015100         10  PC-TSYMSG-00724          PIC 9(05)  VALUE 00724.     01510015
015200*            UPDATE / DELETE IS ONLY VALID FOR ACTIVE AND INACTIVE01520015
015300         10  PC-TSYMSG-00729          PIC 9(05)  VALUE 00729.     01530015
015400*            MULTIPLE PACK SLIPS EXIST; USE THE LIST SCREEN       01540015
015500         10  PC-TSYMSG-00730          PIC 9(05)  VALUE 00730.     01550015
015600*            NO PACK SLIPS FOR THE SELECTION CRITERIA WERE FOUND  01560015
015700         10  PC-TSYMSG-00734          PIC 9(05)  VALUE 00734.     01570015
015800*            INVALID STATUS FOR THIS RECEIVER                     01580015
015900         10  PC-TSYMSG-00737          PIC 9(05)  VALUE 00737.     01590015
016000*            RECEIVER SEQUENCE NUMBER REQUIRED                    01600015
016100         10  PC-TSYMSG-00790          PIC 9(5)  VALUE 00790.      01610015
016200*            TRANSCRIPTION COMPLETE -&VAR LINES IN TROUBLE        01620015
016300         10  PC-TSYMSG-00815          PIC 9(5)  VALUE 00815.      01630015
016400*       OPERATING UNIT AND FACILITY ID REQUIRED FOR THIS FUNCTION 01640015
016500         10  PC-TSYMSG-00818          PIC 9(5)  VALUE 00818.      01650015
016600*            STR DEST CONFLICTS WITH RCVR PACKED BY STR IND       01660015
016700         10  PC-TSYMSG-00819          PIC 9(5)  VALUE 00819.      01670015
016800*            USE THE PACK SLIP LIST SCRN TO COMPLETE TRANSCRIPTION01680015
016900         10  PC-TSYMSG-00844          PIC 9(5)  VALUE 00844.      01690015
017000*            STORE CLOSED                                         01700015
017100         10  PC-TSYMSG-00861          PIC 9(5)  VALUE 00861.      01710015
017200*            INCONSISTANT PACK SLIP NUMBER FOR CONS/NON CONS      01720015
017300         10  PC-TSYMSG-00868          PIC 9(05)  VALUE 00868.     01730015
017400*            CANNOT ADD - PACKSLIP ALREADY EXISTS                 01740015
017500                                                                  01750015
017600 01  PS-PROGRAM-SWITCHES.                                         01760015
017700     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01770015
017800         88  PS-ERROR                            VALUE 'Y'.       01780015
017900         88  PS-NO-ERROR                         VALUE 'N'.       01790015
018000     05  PS-DISPLAY-CSSL-SW              PIC  X(01)  VALUE 'N'.   01800015
018100         88  PS-DISPLAY-CSSL-YES                     VALUE 'Y'.   01810015
018200         88  PS-DISPLAY-CSSL-NO                      VALUE 'N'.   01820015
018300     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01830015
018400         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01840015
018500         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01850015
018600     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       01860015
018700         88  PS-LIST-END                         VALUE 'Y'.       01870015
018800         88  PS-NO-LIST-END                      VALUE 'N'.       01880015
018900     05  PS-PO-EXISTS-SW              PIC X(01)  VALUE 'N'.       01890015
019000         88  PS-PO-EXISTS                        VALUE 'Y'.       01900015
019100         88  PS-PO-DOES-NOT-EXIST                VALUE 'N'.       01910015
019200     05  PS-PKSLIP-INSERT-SW          PIC X(01)  VALUE 'N'.       01920015
019300         88  PS-PKSLIP-NOT-INSERTED              VALUE 'N'.       01930015
019400         88  PS-PKSLIP-INSERTED                  VALUE 'Y'.       01940015
019500     05  PS-PKSLIP-EXISTS-SW          PIC X(01)  VALUE 'N'.       01950015
019600         88  PS-PKSLIP-FOUND                     VALUE 'Y'.       01960015
019700         88  PS-PKSLIP-NOT-FOUND                 VALUE 'N'.       01970015
019800         88  PS-MULTI-PKSLIP-FOUND               VALUE 'M'.       01980015
019900     05  PS-RECITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01990015
020000         88  PS-RECITM-FOUND                     VALUE 'Y'.       02000015
020100         88  PS-RECITM-NOT-FOUND                 VALUE 'N'.       02010015
020200     05  PS-RECITM-VERIFIED-SW        PIC X(01)  VALUE 'N'.       02020015
020300         88  PS-RECITM-VERIFIED                  VALUE 'Y'.       02030015
020400         88  PS-RECITM-NOT-VERIFIED              VALUE 'N'.       02040015
020500     05  PS-PURITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       02050015
020600         88  PS-PURITM-FOUND                     VALUE 'Y'.       02060015
020700         88  PS-PURITM-NOT-FOUND                 VALUE 'N'.       02070015
020800     05  PS-RECDIS-EXISTS-SW          PIC X(01)  VALUE 'N'.       02080015
020900         88  PS-RECDIS-FOUND                     VALUE 'Y'.       02090015
021000         88  PS-RECDIS-NOT-FOUND                 VALUE 'N'.       02100015
021100     05  PS-PREV-UPDATE-SW            PIC X(01)  VALUE 'N'.       02110015
021200         88  PS-PREV-UPDATE                      VALUE 'Y'.       02120015
021300         88  PS-NO-PREV-UPDATE                   VALUE 'N'.       02130015
021400     05  PS-PACK-BY-STR-SW            PIC X(01)  VALUE 'N'.       02140015
021500         88  PS-DONT-BYPASS-PACK-BY-STR-CHK      VALUE 'Y'.       02150015
021600         88  PS-BYPASS-PACK-BY-STR-CHK           VALUE 'N'.       02160015
021700                                                                  02170015
021800 01  PV-PROGRAM-VARIABLES.                                        02180015
021900     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         02190015
022000                                                 COMP SYNC.       02200015
022100     05  PV-CICS-MSG-AREA             PIC  X(80)  VALUE SPACE.    02210015
022200     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    02220015
022300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02230015
022400                                                     COMP SYNC.   02240015
022500     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         02250015
022600                                                 COMP SYNC.       02260015
022700     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         02270015
022800                                                 COMP-3.          02280015
022900     05  PV-NULL-IND                  PIC S9(04) VALUE +0         02290015
023000                                                 COMP SYNC.       02300015
023100     05  PV-SEQ-NBR-IND               PIC S9(04) VALUE +0         02310015
023200                                                  COMP.           02320015
023300     05  PV-LINE-NBR-IND              PIC S9(04) VALUE +0         02330015
023400                                                  COMP.           02340015
023500     05  PV-MAX-SEQ-NBR               PIC S9(04) VALUE +0         02350015
023600                                                 COMP.            02360015
023700     05  PV-NEXT-UNPKSL-LINE          PIC S9(04) VALUE +0         02370015
023800                                                 COMP.            02380015
023900     05  PV-NEXT-SEQ-NBR              PIC S9(04) VALUE +0         02390015
024000                                                 COMP.            02400015
024100     05  PV-MAX-SHIPT-NBR             PIC S9(04) VALUE +0         02410015
024200                                                 COMP.            02420015
024300     05  PV-NEXT-SHIPT-NBR            PIC S9(04) VALUE +0         02430015
024400                                                 COMP.            02440015
024500     05  PV-NEXT-LINE-NBR             PIC S9(04) VALUE +0         02450015
024600                                                 COMP.            02460015
024700     05  PV-PKSL-ITM-QTY              PIC S9(09) VALUE +0         02470015
024800                                                 COMP.            02480015
024900     05  PV-COUNT-IND                 PIC S9(4) VALUE ZERO        02490015
025000                                                COMP.             02500015
025100     05  PV-COUNT-NOT-INACTIVE-PKSLIP PIC S9(4) VALUE ZERO        02510015
025200                                                COMP.             02520015
025300     05  PV-PKSL-NBR-CNT              PIC S9(4) VALUE ZERO        02530015
025400                                                COMP.             02540015
025500     05  PV-INPKSU-CRTN-CNT           PIC S9(9) VALUE ZERO        02550015
025600                                                COMP.             02560015
025700     05  PV-STR-DEST-NBR-CNT          PIC S9(4) VALUE ZERO        02570015
025800                                                COMP.             02580015
025900     05  PV-FA-PREV-RECVR             PIC  S9(9) COMP.            02590015
026000                                                                  02600015
026100     05  PV-DISPLAY-TASK              PIC 9(05).                  02610015
026200     05  PV-DISPLAY-SQLCODE           PIC ------9.                02620015
026300     05  PV-DISPLAY-PO-NBR            PIC  9(08) VALUE ZEROES.    02630015
026400     05  PV-DISPLAY-SEQ-NBR           PIC  9(08) VALUE ZEROES.    02640015
026410     05  PV-DISP-SHIPT-ID             PIC  9(09) VALUE ZEROES.    02641021
026500     05  PV-ABSTIME                   PIC S9(15) COMP.            02650015
026600     05  PV-CURRENT-TIME              PIC  9(06).                 02660015
026700     05  PV-CURRENT-DATE              PIC  9(06).                 02670015
026800     05  FILLER REDEFINES PV-CURRENT-DATE.                        02680015
026900         10  PV-CURRENT-DATE-YY       PIC  X(02).                 02690015
027000         10  PV-CURRENT-DATE-MM       PIC  X(02).                 02700015
027100         10  PV-CURRENT-DATE-DD       PIC  X(02).                 02710015
027200                                                                  02720015
027300     05  PV-CURRENT-DATE-ISO          PIC  X(10).                 02730015
027400     05  FILLER REDEFINES PV-CURRENT-DATE-ISO.                    02740015
027500         10  PV-CD-ISO-YEAR           PIC  9(04).                 02750015
027600         10  FILLER                   PIC  X(01).                 02760015
027700         10  PV-CD-ISO-MM             PIC  9(02).                 02770015
027800         10  FILLER                   PIC  X(01).                 02780015
027900         10  PV-CD-ISO-DD             PIC  9(02).                 02790015
028000                                                                  02800015
028100     05  PV-COMPARE-DATE1             PIC  X(04).                 02810015
028200     05  FILLER REDEFINES PV-COMPARE-DATE1.                       02820015
028300         10  PV-CD-YY-N               PIC  9(02).                 02830015
028400         10  PV-CD-MM-N               PIC  9(02).                 02840015
028500     05  PV-COMPARE-DATE2             PIC  X(04).                 02850015
028600     05  PV-DB2-RETURN-AREAS.                                     02860015
028700         10  PV-DB2-MONTH             PIC S9(09)   VALUE +0       02870015
028800                                                   COMP.          02880015
028900         10  PV-DB2-DAY               PIC S9(09)   VALUE +0       02890015
029000                                                   COMP.          02900015
029100         10  PV-DB2-YEAR              PIC S9(09)   VALUE +0       02910015
029200                                                   COMP.          02920015
029300         10  PV-DB2-HOUR              PIC S9(09)   VALUE +0       02930015
029400                                                   COMP.          02940015
029500         10  PV-DB2-MINUTE            PIC S9(09)   VALUE +0       02950015
029600                                                   COMP.          02960015
029700         10  PV-VEND-DATE-MONTH       PIC S9(09)   VALUE +0       02970015
029800                                                   COMP.          02980015
029900         10  PV-VEND-DATE-DAY         PIC S9(09)   VALUE +0       02990015
030000                                                   COMP.          03000015
030100         10  PV-VEND-DATE-YEAR        PIC S9(09)   VALUE +0       03010015
030200                                                   COMP.          03020015
030300     05  PV-DISPLAY-DATE.                                         03030015
030400         10  PV-MONTH                 PIC  9(02)   VALUE ZEROES.  03040015
030500         10  FILLER                   PIC  X(01)   VALUE '-'.     03050015
030600         10  PV-DAY                   PIC  9(02)   VALUE ZEROES.  03060015
030700         10  FILLER                   PIC  X(01)   VALUE '-'.     03070015
030800         10  PV-YEAR                  PIC  9(04)   VALUE ZEROES.  03080015
030900     05  PV-DISPLAY-TIME.                                         03090015
031000         10  PV-HOUR                  PIC  9(02)   VALUE ZEROES.  03100015
031100         10  FILLER                   PIC  X(01)   VALUE ':'.     03110015
031200         10  PV-MINUTE                PIC  9(02)   VALUE ZEROES.  03120015
031300     05  PV-DB2-DATE-HOST             PIC  X(10).                 03130015
031400     05  PV-DB2-DATE                  PIC  X(10).                 03140015
031500     05  FILLER  REDEFINES PV-DB2-DATE.                           03150015
031600         10  PV-DB2-DATE-CC           PIC  X(02).                 03160015
031700         10  PV-DB2-DATE-YY           PIC  X(02).                 03170015
031800         10  FILLER                   PIC  X(01).                 03180015
031900         10  PV-DB2-DATE-MM           PIC  X(02).                 03190015
032000         10  FILLER                   PIC  X(01).                 03200015
032100         10  PV-DB2-DATE-DD           PIC  X(02).                 03210015
032200     05  PV-INTEGER                   PIC  9(6).                  03220015
032300     05  PV-REMAINDER                 PIC  9(3).                  03230015
032400     05  PV-PKSL-STAT-CDE             PIC  X(02)   VALUE SPACES.  03240015
032500         88  PV-PKSL-STAT-CDE-BEING-WORKED         VALUES         03250015
032600            'IP', 'CM'.                                           03260015
032700         88  PV-PKSL-STAT-CDE-ACTIVE               VALUE 'AC'.    03270015
032800         88  PV-PKSL-STAT-CDE-INACTIVE             VALUE 'IN'.    03280015
032900     05  PV-TROUBLE-COUNT             PIC 9(03)    VALUE ZEROS.   03290015
033000     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03)    VALUE ZEROS.   03300015
033100     05  PV-UNPACK-OPER-UNT-ID        PIC 9(04)    VALUE ZEROS.   03310015
033200     05  PV-PRE-RCPT-INFO             PIC X(04)    VALUE SPACES.  03320015
033300         88  PV-VALID-PRE-RCPT-INFO                VALUES '    ', 03330015
033400                                                          'AVIS', 03340015
033500                                                          'ASN ', 03350015
033600                                                          'CONS'. 03360015
033700     05  PV-PKSL-NBR                  PIC X(10)    VALUE SPACES.  03370015
033800                                                                  03380015
033900 01  PV-DB2-TMST                      PIC X(26).                  03390015
034000 01  FILLER  REDEFINES  PV-DB2-TMST.                              03400015
034100         10  PV-DB2-TMST-CCYY         PIC X(04).                  03410015
034200         10  FILLER                   PIC X(01).                  03420015
034300         10  PV-DB2-TMST-MO           PIC X(02).                  03430015
034400         10  FILLER                   PIC X(01).                  03440015
034500         10  PV-DB2-TMST-DA           PIC X(02).                  03450015
034600         10  FILLER                   PIC X(01).                  03460015
034700         10  PV-DB2-TMST-HH           PIC X(02).                  03470015
034800         10  FILLER                   PIC X(01).                  03480015
034900         10  PV-DB2-TMST-MM           PIC X(02).                  03490015
035000         10  FILLER                   PIC X(01).                  03500015
035100         10  PV-DB2-TMST-SS           PIC X(02).                  03510015
035200             88  PV-DB2-TMST-SS-01               VALUE '01'.      03520015
035300         10  FILLER                   PIC X(01).                  03530015
035400         10  PV-DB2-TMST-MS           PIC X(06).                  03540015
035500             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  03550015
035600*----------------------------------------------------------------*03560015
035700*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *03570015
035800*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *03580015
035900*----------------------------------------------------------------*03590015
036000                                                                  03600015
036100     COPY RCWS013.                                                03610015
036200/                                                                 03620015
036300                                                                  03630015
036400*----------------------------------------------------------------*03640015
036500*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     03650015
036600*----------------------------------------------------------------*03660015
036700                                                                  03670015
036800     COPY TMWS500.                                                03680015
036900/                                                                 03690015
037000                                                                  03700015
037100*----------------------------------------------------------------*03710015
037200*    MAP LAYOUT                                                  *03720015
037300*----------------------------------------------------------------*03730015
037400                                                                  03740015
037500     COPY RCKM267.                                                03750015
037600                                                                  03760015
037700/                                                                 03770015
037800*----------------------------------------------------------------*03780015
037900*    ATTRIBUTE SETTINGS COPYBOOK.                                *03790015
038000*----------------------------------------------------------------*03800015
038100                                                                  03810015
038200     COPY DPWS015.                                                03820015
038300                                                                  03830015
038400/                                                                 03840015
038500*----------------------------------------------------------------*03850015
038600*    FUNCTION KEYS COPYBOOK                                      *03860015
038700*----------------------------------------------------------------*03870015
038800                                                                  03880015
038900     COPY DPWS016.                                                03890015
039000                                                                  03900015
039100/                                                                 03910015
039200*----------------------------------------------------------------*03920015
039300*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *03930015
039400*    SUB-ROUTINE (POKUT100).                                     *03940015
039500*----------------------------------------------------------------*03950015
039600     COPY DPWS010I.                                               03960015
039700                                                                  03970015
039800/                                                                 03980015
039900*----------------------------------------------------------------*03990015
040000*  WORK AREA PASSED IN CALL TO DPKUT500                          *04000015
040100*----------------------------------------------------------------*04010015
040200     COPY DPWS500.                                                04020015
040300                                                                  04030015
040400/                                                                 04040015
040500*----------------------------------------------------------------*04050015
040600*  COPYBOOK FOR LOGISTICS DOMAIN LOCATION MODULE (XLKUT071)      *04060015
040700*----------------------------------------------------------------*04070015
040800     COPY XLWS071.                                                04080015
040900                                                                  04090015
041000/                                                                 04100015
041100******************************************************************04110025
041200** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04120025
041300** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04130025
041400******************************************************************04140025
041500     COPY DPWS030.                                                04150015
041510     COPY DPWS930.                                                04151025
041600                                                                  04160015
041700/                                                                 04170015
041800*----------------------------------------------------------------*04180015
041900*    STANDARD COMMAREA.                                          *04190015
042000*----------------------------------------------------------------*04200015
042100                                                                  04210015
042200     COPY DPWS020.                                                04220015
042300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04230015
042400                                                                  04240015
042500*----------------------------------------------------------------*04250015
042600*    INTER-APPLICATION COMMAREA.                                 *04260015
042700*----------------------------------------------------------------*04270015
042800                                                                  04280015
042900         10  INTER-APPL-COMM-AREA PIC X(200).                     04290015
043000     COPY RCWS012.                                                04300015
043100     COPY RCWS015.                                                04310015
043200*----------------------------------------------------------------*04320015
043300*    SPECIFIC COMMMAREA FOR RCKCS267.                            *04330015
043400*----------------------------------------------------------------*04340015
043500         10  ASC-SPECIFIC-COMMAREA.                               04350015
043600             15  ASC-USE-SELECTION-QUEUE-IND                      04360015
043700                                            PIC X(01).            04370015
043800                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        04380015
043900             15  ASC-SEL-QUEUE-NAME.                              04390015
044000                 20  ASC-SEL-TERM-ID        PIC X(04).            04400015
044100                 20  ASC-SEL-TASK           PIC S9(05) COMP-3.    04410015
044200                 20  ASC-SEL-SEQ            PIC 9(01).            04420015
044300             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    04430015
044400             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04440015
044500                                            PIC S9(09) COMP-3.    04450015
044600             15  ASC-SEL-SUB                PIC S9(04) COMP.      04460015
044700             15  ASC-SEL-ITEM               PIC S9(04) COMP.      04470015
044800             15  ASC-CURRENT-DATE           PIC X(10).            04480015
044900             15  ASC-KEY-FIELDS.                                  04490015
045000                 20  ASC-KEY-PO-NBR.                              04500015
045100** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  04510017
045200                     25  ASC-KEY-PO-NBR-N   PIC 9(08).            04520017
045300                 20  ASC-KEY-OPER-UNT-ID.                         04530015
045400                     25  ASC-KEY-OPER-UNT-ID-N                    04540015
045500                                            PIC 9(04).            04550015
045600                 20  ASC-KEY-FCLTY-ID.                            04560015
045700                     25  ASC-KEY-FCLTY-ID-N PIC 9(04).            04570015
045800                 20  ASC-KEY-FCLTY-NME      PIC X(30).            04580015
045900                 20  ASC-KEY-BOL-NBR        PIC X(16).            04590015
046000                 20  ASC-KEY-PRO-NBR        PIC X(16).            04600022
046100                 20  ASC-KEY-PKSL-STAT-CDES.                      04610015
046200                     25  ASC-KEY-AC-STAT    PIC X(02).            04620015
046300                     25  ASC-KEY-IN-STAT    PIC X(02).            04630015
046400                     25  ASC-KEY-IP-STAT    PIC X(02).            04640015
046500                     25  ASC-KEY-CM-STAT    PIC X(02).            04650015
046600                     25  ASC-KEY-VE-STAT    PIC X(02).            04660015
046700                 20  ASC-KEY-PKSL-NBR       PIC X(10).            04670015
046800                 20  ASC-KEY-REC-SEQ-NBR.                         04680015
046900                     25  ASC-KEY-REC-SEQ-NBR-N                    04690015
047000                                            PIC 9(04).            04700015
047100                 20  ASC-KEY-STR-DEST-NBR   PIC 9(04).            04710015
047200             15  ASC-SCREEN-FIELDS.                               04720015
047300                 20  ASC-OPER-UNT-ID.                             04730015
047400                     25  ASC-OPER-UNT-ID-N  PIC 9(04).            04740015
047500                 20  ASC-FCLTY-ID.                                04750015
047600                     25  ASC-FCLTY-ID-N     PIC 9(04).            04760015
047700                 20  ASC-PO-NBR.                                  04770015
047800** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  04780017
047900                     25  ASC-PO-NBR-N       PIC 9(08).            04790017
048000                 20  ASC-PO-TRBL-DESC       PIC X(30).            04800015
048100                 20  ASC-STR-DEST-NBR.                            04810015
048200                     25  ASC-STR-DEST-NBR-N PIC 9(04).            04820015
048300                 20  ASC-STR-DEST-NME       PIC X(30).            04830015
048400                 20  ASC-PKSL-NBR           PIC X(10).            04840015
048500                 20  ASC-PAGE-CNT.                                04850015
048600                     25  ASC-PAGE-CNT-N     PIC 9(04).            04860015
048700                 20  ASC-BOL-NBR            PIC X(22).            04870015
048800                 20  ASC-SHIPMT-BOL-NBR     PIC X(22).            04880015
048900                 20  ASC-PRO-NBR            PIC X(30).            04890015
049000* WR40574 04-24-2012 CT START                                     04900015
049100                 20  ASC-CAN                PIC X(30).            04910015
049200* WR40574 04-24-2012 CT END                                       04920015
049300                 20  ASC-SHIPMT-PRO-NBR     PIC X(30).            04930015
049400                 20  ASC-SHIPMT-PKG-QTY.                          04940015
049500                     25  ASC-SHIPMT-PKG-QTY-N                     04950015
049600                                            PIC 9(06).            04960015
049700                 20  ASC-EXPTED-PKG-QTY.                          04970015
049800                     25  ASC-EXPTED-PKG-QTY-N                     04980015
049900                                            PIC 9(06).            04990015
050000                 20  ASC-ASN-NUMBER         PIC X(30).            05000015
050100                 20  ASC-INPKSU-COUNT       PIC 9(05).            05010015
050200                 20  ASC-CRE-SRC-CDE        PIC X(04).            05020015
050300                 20  ASC-REC-SEQ-NBR.                             05030015
050400                     25  ASC-REC-SEQ-NBR-N  PIC 9(04).            05040015
050500                 20  ASC-FA-PREV-REC-SEQ    PIC 9(04).            05050015
050600                 20  ASC-PKSL-STAT-CDE      PIC X(02).            05060015
050700                 20  ASC-PKSL-STAT-DESC     PIC X(10).            05070015
050800                 20  ASC-SCAC-CODE          PIC X(04).            05080015
050900                 20  ASC-SCAC-CODE-DESC     PIC X(20).            05090015
051000                 20  ASC-VENDOR-SHIP-DATE   PIC X(10).            05100015
051100                 20  ASC-CONTNR-ID          PIC X(12).            05110015
051200                 20  ASC-CREATED-BY-UID     PIC X(08).            05120015
051300                 20  ASC-CREATED-BY-DTE     PIC X(10).            05130015
051400                 20  ASC-CREATED-BY-TME     PIC X(05).            05140015
051500                 20  ASC-LAST-UPD-BY-UID    PIC X(08).            05150015
051600                 20  ASC-LAST-UPD-BY-DTE    PIC X(10).            05160015
051700                 20  ASC-LAST-UPD-BY-TME    PIC X(05).            05170015
051800             15  ASC-SEQ-NBR                PIC S9(4)   COMP.     05180015
051900                                                                  05190015
052000/                                                                 05200015
052100*----------------------------------------------------------------*05210015
052200*    ABEND PROCESSING COPYBOOK.                                  *05220015
052300*----------------------------------------------------------------*05230015
052400                                                                  05240015
052500     COPY DPWS013.                                                05250015
052600/                                                                 05260015
052700                                                                  05270015
052800*----------------------------------------------------------------*05280015
052900*    SYSTEM MESSAGE COPYBOOK                                     *05290015
053000*----------------------------------------------------------------*05300015
053100                                                                  05310015
053200     COPY DPRD507I.                                               05320015
053300/                                                                 05330015
053400                                                                  05340015
053500*----------------------------------------------------------------*05350015
053600*    DB2 SQL COMMUNICATION AREA                                   05360015
053700*----------------------------------------------------------------*05370015
053800     EXEC SQL                                                     05380015
053900          INCLUDE SQLCA                                           05390015
054000     END-EXEC.                                                    05400015
054100                                                                  05410015
054200/                                                                 05420015
054300*----------------------------------------------------------------*05430015
054400*    DB2 DCLGEN FOR SHIPMENT TABLE                                05440015
054500*----------------------------------------------------------------*05450015
054600     EXEC SQL                                                     05460015
054700          INCLUDE TSHIPMT                                         05470015
054800     END-EXEC.                                                    05480015
054900                                                                  05490015
055000/                                                                 05500015
055100*----------------------------------------------------------------*05510015
055200*    DB2 DCLGEN FOR SHIPMENT/PO TABLE                             05520015
055300*----------------------------------------------------------------*05530015
055400     EXEC SQL                                                     05540015
055500          INCLUDE TSHPTPO                                         05550015
055600     END-EXEC.                                                    05560015
055700                                                                  05570015
055800/                                                                 05580015
055900*----------------------------------------------------------------*05590015
056000*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        05600015
056100*----------------------------------------------------------------*05610015
056200     EXEC SQL                                                     05620015
056300          INCLUDE TPKSLIP                                         05630015
056400     END-EXEC.                                                    05640015
056500                                                                  05650015
056600/                                                                 05660015
056700*---------------------------------------------------------------* 05670015
056800*    DB2 AREA FOR THE EXTERNAL ENTERPRISE TABLE                 * 05680015
056900*---------------------------------------------------------------* 05690015
057000     EXEC SQL                                                     05700015
057100          INCLUDE TEXTENT                                         05710015
057200     END-EXEC.                                                    05720015
057300                                                                  05730015
057400/                                                                 05740015
057500*---------------------------------------------------------------* 05750015
057600*    DB2 AREA FOR THE EXTERNAL ENTERPRISE NAME TABLE            * 05760015
057700*---------------------------------------------------------------* 05770015
057800     EXEC SQL                                                     05780015
057900          INCLUDE TENTNME                                         05790015
058000     END-EXEC.                                                    05800015
058100                                                                  05810015
058200/                                                                 05820015
058300*SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT UNIT ASSOC TABLE         05830015
058400     EXEC SQL                                                     05840015
058500          INCLUDE TINPKSU                                         05850015
058600     END-EXEC.                                                    05860015
058700/                                                                 05870015
058800 LINKAGE SECTION.                                                 05880015
058900                                                                  05890015
059000 01  DFHCOMMAREA.                                                 05900015
059100     05  FILLER                       OCCURS  1 TO 4072 TIMES     05910015
059200                                      DEPENDING ON EIBCALEN.      05920015
059300         10  FILLER                   PIC X.                      05930015
059400                                                                  05940015
059500/                                                                 05950015
059600 PROCEDURE DIVISION.                                              05960015
059700                                                                  05970015
059800*----------------------------------------------------------------*05980015
059900*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *05990015
060000*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *06000015
060100*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *06010015
060200*                                                                *06020015
060300*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *06030015
060400*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *06040015
060500*----------------------------------------------------------------*06050015
060600 0000-MAIN-MODULE.                                                06060015
060700                                                                  06070015
060800     INITIALIZE DP030-CICS-API-FIELDS.                            06080015
060900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06090015
061000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06100015
061100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06110015
061200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06120015
061300     MOVE LENGTH OF RC267AI        TO DP030-MAP-LENGTH (1).       06130015
061400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06140015
061500     PERFORM 0001-CALL-CICS-ARCH-API.                             06150015
061600                                                                  06160015
061700     PERFORM 1000-CONTROL-PROCESSING.                             06170015
061800                                                                  06180015
061900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06190015
062000     PERFORM 0001-CALL-CICS-ARCH-API.                             06200015
062100                                                                  06210015
062200/                                                                 06220015
062300 0001-CALL-CICS-ARCH-API.                                         06230015
062400                                                                  06240015
062510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06251025
062600                                    DFHCOMMAREA                   06260025
062700                                    DP030-CICS-API-FIELDS         06270025
062800                                    DP020-STANDARD-COMMAREA       06280025
062900                                    RC267AI.                      06290025
063000                                                                  06300015
063100     IF  DP030-RC-CALL-SUCCESSFUL                                 06310015
063200         CONTINUE                                                 06320015
063300     ELSE                                                         06330015
063400         SET DP013-NO-ROLLBACK                                    06340015
063500             DP013-XCTL-DISPLAY-RESTART                           06350015
063600             DP013-CICS-ABEND      TO TRUE                        06360015
063700         MOVE 'BEFORE 0000-MAIN-MODULE'                           06370015
063800                                   TO DP013-PARAGRAPH             06380015
063820         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O06382025
063830-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06383025
064100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06410015
064200         PERFORM DP013-0000-PROCESS-ABEND                         06420015
064300     END-IF.                                                      06430015
064400                                                                  06440015
064500/                                                                 06450015
064600*----------------------------------------------------------------*06460015
064700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06470015
064800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06480015
064900*----------------------------------------------------------------*06490015
065000                                                                  06500015
065100 1000-CONTROL-PROCESSING.                                         06510015
065200                                                                  06520015
065300     EVALUATE TRUE                                                06530015
065400         WHEN DP020-NEXT-ACT-INITIAL                              06540015
065500              PERFORM 1100-PROCESS-INTER-APPL-COMM                06550015
065600              IF  PS-COMMAREA-NOT-VALID                           06560015
065700                  CONTINUE                                        06570015
065800              ELSE                                                06580015
065900                 MOVE DK-OPER-UNT-ID TO PV-UNPACK-OPER-UNT-ID     06590015
066000*VML                              TO DK-OPER                      06600015
066100*VML             MOVE DK-FCLTY-ID TO DK-FCLTY                     06610015
066200                 PERFORM 3030-VALIDATE-STR-DEST-NBR               06620015
066300*LMM             IF SQLCODE = +0                                  06630015
066400                 IF XL071-SQLCODE-N = +0                          06640015
066500                     MOVE XL071-LOC-NM TO ASC-KEY-FCLTY-NME       06650015
066600                 END-IF                                           06660015
066700                 PERFORM 4000-BUILD-INITIAL-PANEL                 06670015
066800                 IF  PS-NO-ERROR                                  06680015
066900                     PERFORM 3200-RESET-ATTRIBUTES                06690015
067000                 END-IF                                           06700015
067100              END-IF                                              06710015
067200                                                                  06720015
067300         WHEN DP020-NEXT-ACT-READ-MAP                             06730015
067400              PERFORM 2000-PROCESS-PANEL                          06740015
067500                                                                  06750015
067600         WHEN DP020-NEXT-ACT-RETURN                               06760015
067700              PERFORM 3200-RESET-ATTRIBUTES                       06770015
067800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06780015
067900                                                                  06790015
068000         WHEN OTHER                                               06800015
068100              SET DP013-LOGIC-ABEND                               06810015
068200                  DP013-NO-ROLLBACK                               06820015
068300                                   TO TRUE                        06830015
068400              MOVE '1000-CONTROL-PROCESSING'                      06840015
068500                                   TO DP013-PARAGRAPH             06850015
068600              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  06860015
068700                                   TO DP013-MESSAGE-TEXT(1)       06870015
068800              MOVE DP020-NEXT-APPL-ACTIVITY                       06880015
068900                                   TO DP013-MESSAGE-TEXT(2)       06890015
069000              PERFORM DP013-0000-PROCESS-ABEND                    06900015
069100     END-EVALUATE.                                                06910015
069200                                                                  06920015
069300/                                                                 06930015
069400*----------------------------------------------------------------*06940015
069500*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *06950015
069600*    INTER-APPLICATION FORMAT CODE.                              *06960015
069700*                                                                *06970015
069800*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *06980015
069900*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *06990015
070000*----------------------------------------------------------------*07000015
070100 1100-PROCESS-INTER-APPL-COMM.                                    07010015
070200                                                                  07020015
070300     SET PS-COMMAREA-VALID         TO TRUE.                       07030015
070400                                                                  07040015
070500     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07050015
070600                                                                  07060015
070700     EVALUATE DP020-INT-APPL-FORMAT-IND                           07070015
070800                                                                  07080015
070900         WHEN PC-INTER-APPL-LIST                                  07090015
071000             IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO             07100015
071100                 SET DP020-NEXT-ACT-APPL-ERROR                    07110015
071200                     DP030-OVERRIDE-GO                            07120015
071300                     DP020-MSG-WARNING                            07130015
071400                     PS-ERROR                                     07140015
071500                     PS-COMMAREA-NOT-VALID                        07150015
071600                                   TO TRUE                        07160015
071700                 MOVE PC-TSYMSG-00057                             07170015
071800                                   TO DP020-MSG-NUMBER            07180015
071900             ELSE                                                 07190015
072000                 SET ASC-USE-SELECTION-QUEUE                      07200015
072100                     DP030-SET-CURSOR-APPL-1                      07210015
072200                                   TO TRUE                        07220015
072300                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              07230015
072400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07240015
072500                 MOVE RC015-NUMBER-OF-TS-ITEMS                    07250015
072600                                   TO ASC-NUMBER-OF-TS-ITEMS      07260015
072700                 MOVE RC015-SEL-QUEUE-NAME                        07270015
072800                                   TO ASC-SEL-QUEUE-NAME          07280015
072900                 PERFORM 1120-PREPARE-LIST-ENTRY                  07290015
073000                 MOVE RC015-FCLTY-ID                              07300015
073100                                   TO ASC-KEY-FCLTY-ID-N          07310015
073200                                      ASC-FCLTY-ID-N              07320015
073300                                      DK-FCLTY-ID                 07330015
073400                 MOVE RC015-PO-NBR TO ASC-PO-NBR-N                07340015
073500                                      ASC-KEY-PO-NBR-N            07350015
073600                                      DK-PO-NBR                   07360015
073700                 PERFORM 1140-CHECK-DUPL-PKSLIP                   07370015
073800             END-IF                                               07380015
073900                                                                  07390015
074000         WHEN PC-LIST-FORMAT-4                                    07400015
074100             IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO             07410015
074200                 SET DP020-NEXT-ACT-APPL-ERROR                    07420015
074300                     DP030-OVERRIDE-GO                            07430015
074400                     DP020-MSG-WARNING                            07440015
074500                     PS-ERROR                                     07450015
074600                     PS-COMMAREA-NOT-VALID                        07460015
074700                                   TO TRUE                        07470015
074800                 MOVE PC-TSYMSG-00057                             07480015
074900                                   TO DP020-MSG-NUMBER            07490015
075000             ELSE                                                 07500015
075100                 SET ASC-USE-SELECTION-QUEUE                      07510015
075200                     DP030-SET-CURSOR-APPL-1                      07520015
075300                                   TO TRUE                        07530015
075400                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              07540015
075500                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07550015
075600                 MOVE RC015-NUMBER-OF-TS-ITEMS                    07560015
075700                                   TO ASC-NUMBER-OF-TS-ITEMS      07570015
075800                 MOVE RC015-SEL-QUEUE-NAME                        07580015
075900                                   TO ASC-SEL-QUEUE-NAME          07590015
076000                 PERFORM 1120-PREPARE-LIST-ENTRY                  07600015
076100                 MOVE RC015-OPER-UNT-ID                           07610015
076200                                   TO ASC-KEY-OPER-UNT-ID-N       07620015
076300                                      ASC-OPER-UNT-ID-N           07630015
076400                                      DK-OPER-UNT-ID              07640015
076500                 MOVE RC015-FCLTY-ID                              07650015
076600                                   TO ASC-KEY-FCLTY-ID-N          07660015
076700                                      ASC-FCLTY-ID-N              07670015
076800                                      DK-FCLTY-ID                 07680015
076900                 PERFORM 1145-CHECK-DUPL-PKSLIP                   07690015
077000             END-IF                                               07700015
077100                                                                  07710015
077200                                                                  07720015
077300         WHEN OTHER                                               07730015
077400             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            07740015
077500             SET PS-ERROR                                         07750015
077600                 PS-COMMAREA-NOT-VALID                            07760015
077700                 DP020-MSG-FATAL                                  07770015
077800                 DP020-NEXT-ACT-APPL-ERROR                        07780015
077900                                   TO TRUE                        07790015
078000                                                                  07800015
078100     END-EVALUATE.                                                07810015
078200                                                                  07820015
078300/                                                                 07830015
078400*----------------------------------------------------------------*07840015
078500*    ENTRY IS FROM A LIST.  GET THE PO NUMBER FROM THE           *07850015
078600*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *07860015
078700*----------------------------------------------------------------*07870015
078800 1120-PREPARE-LIST-ENTRY.                                         07880015
078900                                                                  07890015
079000     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                07900015
079100     MOVE ZERO                     TO ASC-SEL-ITEM.               07910015
079200                                                                  07920015
079300     PERFORM 2115-GET-NEXT-PACK-SLIP.                             07930015
079400                                                                  07940015
079500 1130-SETUP-PKSLIP-KEYS.                                          07950015
079600                                                                  07960015
079700     IF RC012-OPER-UNT-ID > ZERO                                  07970015
079800         MOVE RC012-OPER-UNT-ID    TO ASC-OPER-UNT-ID-N           07980015
079900     END-IF.                                                      07990015
080000                                                                  08000015
080100     IF RC012-FCLTY-ID > ZERO                                     08010015
080200         MOVE RC012-FCLTY-ID       TO ASC-FCLTY-ID-N              08020015
080300     END-IF.                                                      08030015
080400                                                                  08040015
080500     IF RC012-REC-SEQ-NBR > ZEROES                                08050015
080600         MOVE RC012-REC-SEQ-NBR    TO DK-REC-SEQ-NBR              08060015
080700     END-IF.                                                      08070015
080800                                                                  08080015
080900     IF RC012-PKSL-NBR > SPACES                                   08090015
081000         MOVE RC012-PKSL-NBR       TO DK-PKSL-NBR                 08100015
081100     END-IF.                                                      08110015
081200                                                                  08120015
081300     IF RC012-BOL-NBR > SPACES                                    08130015
081400         MOVE RC012-BOL-NBR        TO DK-BOL-NBR                  08140015
081500     END-IF.                                                      08150015
081600                                                                  08160015
081700     IF RC012-PRO-NBR > SPACES                                    08170015
081800         MOVE RC012-PRO-NBR        TO DK-PRO-NBR                  08180015
081900     END-IF.                                                      08190015
082000                                                                  08200015
082100     EVALUATE DP020-INT-APPL-FORMAT-IND                           08210015
082200                                                                  08220015
082300         WHEN PC-INTER-APPL-LIST                                  08230015
082400            PERFORM 1140-CHECK-DUPL-PKSLIP                        08240015
082500         WHEN PC-LIST-FORMAT-4                                    08250015
082600            PERFORM 1145-CHECK-DUPL-PKSLIP                        08260015
082700     END-EVALUATE.                                                08270015
082800                                                                  08280015
082900 1140-CHECK-DUPL-PKSLIP.                                          08290015
083000                                                                  08300015
083100     PERFORM                                                      08310015
083200         WITH TEST AFTER                                          08320015
083300         VARYING PV-RETRY-COUNTER                                 08330015
083400         FROM 1 BY 1                                              08340015
083500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08350015
083600                   OR (SQLCODE = +0)                              08360015
083700                   OR (SQLCODE = -811)                            08370015
083800                   OR (SQLCODE = +100))                           08380015
083900                                                                  08390015
084000         EXEC SQL                                                 08400015
084100            SELECT  PO_NBR,                                       08410015
084200                    SEQ_NBR,                                      08420015
084300                    MONTH (CRE_TMST),                             08430015
084400                    DAY   (CRE_TMST),                             08440015
084500                    YEAR  (CRE_TMST),                             08450015
084600                    HOUR  (CRE_TMST),                             08460015
084700                    MINUTE(CRE_TMST),                             08470015
084800                    OPER_UNT_ID,                                  08480015
084900                    FCLTY_ID,                                     08490015
085000                    PKSL_NBR,                                     08500015
085100                    STR_DEST_NBR,                                 08510015
085200                    REC_SEQ_NBR,                                  08520015
085300                    BOL_NBR,                                      08530015
085400                    PRO_NBR,                                      08540015
085500                    PKSL_STAT_CDE,                                08550015
085600                    CRE_UID,                                      08560015
085700                    CRE_SRC_CDE,                                  08570015
085800                    EXPTED_PKG_QTY,                               08580015
085900                    OWNER_SCAC_ID,                                08590015
086000                    ASN_NBR,                                      08600015
086100                    MONTH (VEND_SHIP_DTE),                        08610015
086200                    DAY   (VEND_SHIP_DTE),                        08620015
086300                    YEAR  (VEND_SHIP_DTE),                        08630015
086400                    SHIPT_ID ,                                    08640015
086500                    PKSL_PG_CNT,                                  08650015
086600                    CONTNR_ID,                                    08660015
086700                    ORIG_PKSL_SEQ_NBR                             08670015
086800              INTO :PKSLIP-PO-NBR,                                08680015
086900                   :ASC-SEQ-NBR,                                  08690015
087000                   :PV-DB2-MONTH,                                 08700015
087100                   :PV-DB2-DAY,                                   08710015
087200                   :PV-DB2-YEAR,                                  08720015
087300                   :PV-DB2-HOUR,                                  08730015
087400                   :PV-DB2-MINUTE,                                08740015
087500                   :PKSLIP-OPER-UNT-ID,                           08750015
087600                   :PKSLIP-FCLTY-ID,                              08760015
087700                   :PKSLIP-PKSL-NBR,                              08770015
087800                   :PKSLIP-STR-DEST-NBR,                          08780015
087900                   :PKSLIP-REC-SEQ-NBR,                           08790015
088000                   :PKSLIP-BOL-NBR,                               08800015
088100                   :PKSLIP-PRO-NBR,                               08810015
088200                   :PKSLIP-PKSL-STAT-CDE,                         08820015
088300                   :PKSLIP-CRE-UID,                               08830015
088400                   :PKSLIP-CRE-SRC-CDE,                           08840015
088500                   :PKSLIP-EXPTED-PKG-QTY,                        08850015
088600                   :PKSLIP-OWNER-SCAC-ID,                         08860015
088700                   :PKSLIP-ASN-NBR,                               08870015
088800                   :PV-VEND-DATE-MONTH,                           08880015
088900                   :PV-VEND-DATE-DAY,                             08890015
089000                   :PV-VEND-DATE-YEAR,                            08900015
089100                   :PKSLIP-SHIPT-ID,                              08910015
089200                   :PKSLIP-PKSL-PG-CNT,                           08920015
089300                   :PKSLIP-CONTNR-ID,                             08930015
089400                   :PKSLIP-ORIG-PKSL-SEQ-NBR                      08940015
089500              FROM  TPKSLIP                                       08950015
089600             WHERE PO_NBR              = :DK-PO-NBR               08960015
089700               AND VER_STAT_CDE        = :PC-ACTIVE               08970015
089800               AND OPER_UNT_ID         = :DK-OPER-UNT-ID          08980015
089900               AND FCLTY_ID            = :DK-FCLTY-ID             08990015
090000               AND REC_SEQ_NBR         = :DK-REC-SEQ-NBR          09000015
090100               AND PKSL_NBR            = :DK-PKSL-NBR             09010015
090200               AND BOL_NBR             = :DK-BOL-NBR              09020015
090300               AND PRO_NBR             = :DK-PRO-NBR              09030015
090400               AND STR_DEST_NBR        = :DK-STR-DEST-NBR         09040015
090500               AND SEQ_NBR             = :DK-SEQ-NBR              09050015
090600         END-EXEC                                                 09060015
090700                                                                  09070015
090800         EVALUATE TRUE                                            09080015
090900             WHEN SQLCODE = +0                                    09090015
091000                 SET PS-PKSLIP-FOUND                              09100015
091100                                   TO TRUE                        09110015
091200                                                                  09120015
091300             WHEN SQLCODE = +100                                  09130015
091400                 SET PS-PKSLIP-NOT-FOUND                          09140015
091500                                   TO TRUE                        09150015
091600                                                                  09160015
091700             WHEN SQLCODE = -811                                  09170015
091800                 SET PS-MULTI-PKSLIP-FOUND                        09180015
091900                                   TO TRUE                        09190015
092000                                                                  09200015
092100             WHEN SQLCODE = -904                                  09210015
092200             WHEN SQLCODE = -913                                  09220015
092300                 CONTINUE                                         09230015
092400                                                                  09240015
092500             WHEN SQLWARN0 NOT = SPACES                           09250015
092600             WHEN SQLCODE < +0                                    09260015
092700             WHEN SQLCODE > +0                                    09270015
092800                 MOVE '1140-CHECK-DUPL-PKSLIP'                    09280015
092900                                   TO DP013-PARAGRAPH             09290015
093000                 MOVE 'CHECK IF SELECTION CRITERIA OK'            09300015
093100                                   TO DP013-MESSAGE-TEXT (1)      09310015
093200                 MOVE SQLCA        TO DP013-SQLCA                 09320015
093300                 MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)    09330015
093400                 SET DP013-DB2-ABEND                              09340015
093500                                   TO TRUE                        09350015
093600                 SET DP013-XCTL-DISPLAY-RESTART                   09360015
093700                                   TO TRUE                        09370015
093800                 PERFORM DP013-0000-PROCESS-ABEND                 09380015
093900         END-EVALUATE                                             09390015
094000     END-PERFORM.                                                 09400015
094100                                                                  09410015
094200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09420015
094300         SQLCODE NOT = +0                                         09430015
094400         MOVE '1140-CHECK-DUPL-PKSLIP'                            09440015
094500                                   TO DP013-PARAGRAPH             09450015
094600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09460015
094700                                   TO DP013-MESSAGE-TEXT (1)      09470015
094800         MOVE 'PACK SLIP HEADER'   TO DP013-MESSAGE-TEXT (2)      09480015
094900         MOVE SQLCA                TO DP013-SQLCA                 09490015
095000         MOVE 'TPKSLIP'            TO DP013-DB2-TABLE-NAME (1)    09500015
095100         SET DP013-DB2-ABEND       TO TRUE                        09510015
095200         SET DP013-XCTL-DISPLAY-RESTART                           09520015
095300                                   TO TRUE                        09530015
095400         PERFORM DP013-0000-PROCESS-ABEND                         09540015
095500     END-IF.                                                      09550015
095600                                                                  09560015
095700                                                                  09570015
095800*THIS SELECT IS USED WHEN COMING IN WITH DELETED PACKSLIPS        09580015
095900 1145-CHECK-DUPL-PKSLIP.                                          09590015
096000                                                                  09600015
096100     PERFORM                                                      09610015
096200         WITH TEST AFTER                                          09620015
096300         VARYING PV-RETRY-COUNTER                                 09630015
096400         FROM 1 BY 1                                              09640015
096500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09650015
096600                   OR (SQLCODE = +0)                              09660015
096700                   OR (SQLCODE = -811)                            09670015
096800                   OR (SQLCODE = +100))                           09680015
096900                                                                  09690015
097000         EXEC SQL                                                 09700015
097100            SELECT  PO_NBR,                                       09710015
097200                    SEQ_NBR,                                      09720015
097300                    MONTH (CRE_TMST),                             09730015
097400                    DAY   (CRE_TMST),                             09740015
097500                    YEAR  (CRE_TMST),                             09750015
097600                    HOUR  (CRE_TMST),                             09760015
097700                    MINUTE(CRE_TMST),                             09770015
097800                    OPER_UNT_ID,                                  09780015
097900                    FCLTY_ID,                                     09790015
098000                    PKSL_NBR,                                     09800015
098100                    STR_DEST_NBR,                                 09810015
098200                    REC_SEQ_NBR,                                  09820015
098300                    BOL_NBR,                                      09830015
098400                    PRO_NBR,                                      09840015
098500                    PKSL_STAT_CDE,                                09850015
098600                    CRE_UID,                                      09860015
098700                    CRE_SRC_CDE,                                  09870015
098800                    EXPTED_PKG_QTY,                               09880015
098900                    OWNER_SCAC_ID,                                09890015
099000                    ASN_NBR,                                      09900015
099100                    MONTH (VEND_SHIP_DTE),                        09910015
099200                    DAY   (VEND_SHIP_DTE),                        09920015
099300                    YEAR  (VEND_SHIP_DTE),                        09930015
099400                    SHIPT_ID ,                                    09940015
099500                    PKSL_PG_CNT,                                  09950015
099600                    CONTNR_ID,                                    09960015
099700                    ORIG_PKSL_SEQ_NBR                             09970015
099800              INTO :PKSLIP-PO-NBR,                                09980015
099900                   :ASC-SEQ-NBR,                                  09990015
100000                   :PV-DB2-MONTH,                                 10000015
100100                   :PV-DB2-DAY,                                   10010015
100200                   :PV-DB2-YEAR,                                  10020015
100300                   :PV-DB2-HOUR,                                  10030015
100400                   :PV-DB2-MINUTE,                                10040015
100500                   :PKSLIP-OPER-UNT-ID,                           10050015
100600                   :PKSLIP-FCLTY-ID,                              10060015
100700                   :PKSLIP-PKSL-NBR,                              10070015
100800                   :PKSLIP-STR-DEST-NBR,                          10080015
100900                   :PKSLIP-REC-SEQ-NBR,                           10090015
101000                   :PKSLIP-BOL-NBR,                               10100015
101100                   :PKSLIP-PRO-NBR,                               10110015
101200                   :PKSLIP-PKSL-STAT-CDE,                         10120015
101300                   :PKSLIP-CRE-UID,                               10130015
101400                   :PKSLIP-CRE-SRC-CDE,                           10140015
101500                   :PKSLIP-EXPTED-PKG-QTY,                        10150015
101600                   :PKSLIP-OWNER-SCAC-ID,                         10160015
101700                   :PKSLIP-ASN-NBR,                               10170015
101800                   :PV-VEND-DATE-MONTH,                           10180015
101900                   :PV-VEND-DATE-DAY,                             10190015
102000                   :PV-VEND-DATE-YEAR,                            10200015
102100                   :PKSLIP-SHIPT-ID,                              10210015
102200                   :PKSLIP-PKSL-PG-CNT,                           10220015
102300                   :PKSLIP-CONTNR-ID,                             10230015
102400                   :PKSLIP-ORIG-PKSL-SEQ-NBR                      10240015
102500              FROM  TPKSLIP                                       10250015
102600             WHERE PO_NBR              = :DK-PO-NBR               10260015
102700               AND VER_STAT_CDE        = :PC-INACTIVE             10270015
102800               AND OPER_UNT_ID         = :DK-OPER-UNT-ID          10280015
102900               AND FCLTY_ID            = :DK-FCLTY-ID             10290015
103000               AND STR_DEST_NBR        = :DK-STR-DEST-NBR         10300015
103100               AND SEQ_NBR             = :DK-SEQ-NBR              10310015
103200               AND PKSL_STAT_CDE       = 'DE'                     10320015
103300         END-EXEC                                                 10330015
103400                                                                  10340015
103500         EVALUATE TRUE                                            10350015
103600             WHEN SQLCODE = +0                                    10360015
103700                 SET PS-PKSLIP-FOUND                              10370015
103800                                   TO TRUE                        10380015
103900                                                                  10390015
104000             WHEN SQLCODE = +100                                  10400015
104100                 SET PS-PKSLIP-NOT-FOUND                          10410015
104200                                   TO TRUE                        10420015
104300                                                                  10430015
104400             WHEN SQLCODE = -811                                  10440015
104500                 SET PS-MULTI-PKSLIP-FOUND                        10450015
104600                                   TO TRUE                        10460015
104700                                                                  10470015
104800             WHEN SQLCODE = -904                                  10480015
104900             WHEN SQLCODE = -913                                  10490015
105000                 CONTINUE                                         10500015
105100                                                                  10510015
105200             WHEN SQLWARN0 NOT = SPACES                           10520015
105300             WHEN SQLCODE < +0                                    10530015
105400             WHEN SQLCODE > +0                                    10540015
105500                 MOVE '1145-CHECK-DUPL-PKSLIP'                    10550015
105600                                   TO DP013-PARAGRAPH             10560015
105700                 MOVE 'CHECK IF SELECTION CRITERIA OK'            10570015
105800                                   TO DP013-MESSAGE-TEXT (1)      10580015
105900                 MOVE SQLCA        TO DP013-SQLCA                 10590015
106000                 MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)    10600015
106100                 SET DP013-DB2-ABEND                              10610015
106200                                   TO TRUE                        10620015
106300                 SET DP013-XCTL-DISPLAY-RESTART                   10630015
106400                                   TO TRUE                        10640015
106500                 PERFORM DP013-0000-PROCESS-ABEND                 10650015
106600         END-EVALUATE                                             10660015
106700     END-PERFORM.                                                 10670015
106800                                                                  10680015
106900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    10690015
107000         SQLCODE NOT = +0                                         10700015
107100         MOVE '1145-CHECK-DUPL-PKSLIP'                            10710015
107200                                   TO DP013-PARAGRAPH             10720015
107300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10730015
107400                                   TO DP013-MESSAGE-TEXT (1)      10740015
107500         MOVE 'PACK SLIP HEADER'   TO DP013-MESSAGE-TEXT (2)      10750015
107600         MOVE SQLCA                TO DP013-SQLCA                 10760015
107700         MOVE 'TPKSLIP'            TO DP013-DB2-TABLE-NAME (1)    10770015
107800         SET DP013-DB2-ABEND       TO TRUE                        10780015
107900         SET DP013-XCTL-DISPLAY-RESTART                           10790015
108000                                   TO TRUE                        10800015
108100         PERFORM DP013-0000-PROCESS-ABEND                         10810015
108200     END-IF.                                                      10820015
108300                                                                  10830015
108400/                                                                 10840015
108500*----------------------------------------------------------------*10850015
108600*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*10860015
108700*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*10870015
108800*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *10880015
108900*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *10890015
109000*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *10900015
109100*----------------------------------------------------------------*10910015
109200                                                                  10920015
109300 2000-PROCESS-PANEL.                                              10930015
109400                                                                  10940015
109500     EVALUATE TRUE                                                10950015
109600                                                                  10960015
109700         WHEN DP020-SRC-AID = DP016-CLEAR                         10970015
109800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10980015
109900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10990015
110000*F5                                                               11000015
110100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     11010015
110200             INITIALIZE ASC-SCREEN-FIELDS                         11020015
110300             SET DP030-SET-CURSOR-APPL-1                          11030015
110400                               TO TRUE                            11040015
110500             MOVE -1           TO APOL                            11050015
110600             MOVE ASC-KEY-PO-NBR-N      TO DK-PO-NBR              11060015
110700                                           ASC-PO-NBR-N           11070015
110800             MOVE ASC-KEY-OPER-UNT-ID-N TO DK-OPER-UNT-ID         11080015
110900                                           ASC-OPER-UNT-ID-N      11090015
111000             MOVE ASC-KEY-FCLTY-ID-N    TO DK-FCLTY-ID            11100015
111100                                           ASC-FCLTY-ID-N         11110015
111200             MOVE ASC-SEQ-NBR           TO DK-SEQ-NBR             11120015
111300                                                                  11130015
111400             MOVE ASC-KEY-REC-SEQ-NBR-N TO DK-REC-SEQ-NBR         11140015
111500                                           ASC-REC-SEQ-NBR-N      11150015
111600             MOVE ASC-KEY-PKSL-NBR      TO DK-PKSL-NBR            11160015
111700                                           ASC-PKSL-NBR           11170015
111800             MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR             11180015
111900                                           ASC-BOL-NBR            11190015
112000             MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR             11200015
112100                                           ASC-PRO-NBR            11210015
112200             MOVE ASC-KEY-STR-DEST-NBR  TO DK-STR-DEST-NBR        11220015
112300                                           ASC-STR-DEST-NBR-N     11230015
112400                                                                  11240015
112500             EVALUATE DP020-INT-APPL-FORMAT-IND                   11250015
112600                                                                  11260015
112700                 WHEN PC-INTER-APPL-LIST                          11270015
112800                    PERFORM 1140-CHECK-DUPL-PKSLIP                11280015
112900                 WHEN PC-LIST-FORMAT-4                            11290015
113000                    PERFORM 1145-CHECK-DUPL-PKSLIP                11300015
113100             END-EVALUATE                                         11310015
113200                                                                  11320015
113300             PERFORM 4000-BUILD-INITIAL-PANEL                     11330015
113400             PERFORM 3200-RESET-ATTRIBUTES                        11340015
113500*F20                                                              11350015
113600         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11360015
113700             IF  ASC-USE-SELECTION-QUEUE                          11370015
113800                 PERFORM 2115-GET-NEXT-PACK-SLIP                  11380015
113900                 IF PS-LIST-END                                   11390015
114000                    SET PS-NO-LIST-END                            11400015
114100                                   TO TRUE                        11410015
114200                 ELSE                                             11420015
114300                    MOVE ASC-KEY-PO-NBR-N                         11430015
114400                                   TO DK-PO-NBR                   11440015
114500                    MOVE ASC-KEY-OPER-UNT-ID-N                    11450015
114600                                   TO DK-OPER-UNT-ID              11460015
114700                    MOVE ASC-KEY-FCLTY-ID-N                       11470015
114800                                   TO DK-FCLTY-ID                 11480015
114900                                                                  11490015
115000                    EVALUATE DP020-INT-APPL-FORMAT-IND            11500015
115100                                                                  11510015
115200                        WHEN PC-INTER-APPL-LIST                   11520015
115300                           PERFORM 1140-CHECK-DUPL-PKSLIP         11530015
115400                        WHEN PC-LIST-FORMAT-4                     11540015
115500                           MOVE RC015-OPER-UNT-ID                 11550015
115600                                    TO ASC-KEY-OPER-UNT-ID-N      11560015
115700                                       ASC-OPER-UNT-ID-N          11570015
115800                                       DK-OPER-UNT-ID             11580015
115900                           PERFORM 1145-CHECK-DUPL-PKSLIP         11590015
116000                    END-EVALUATE                                  11600015
116100                                                                  11610015
116200                    PERFORM 4000-BUILD-INITIAL-PANEL              11620015
116300                    PERFORM 3200-RESET-ATTRIBUTES                 11630015
116400                 END-IF                                           11640015
116500             ELSE                                                 11650015
116600*                --- BOTTOM OF LIST ---                           11660015
116700                 MOVE PC-TSYMSG-00070                             11670015
116800                                   TO DP020-MSG-NUMBER            11680015
116900                 SET DP020-MSG-INFORMATIONAL                      11690015
117000                     PS-LIST-END   TO TRUE                        11700015
117100             END-IF                                               11710015
117200*F19                                                              11720015
117300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11730015
117400             IF  ASC-USE-SELECTION-QUEUE                          11740015
117500                 PERFORM 2120-GET-PREV-PACK-SLIP                  11750015
117600                 IF PS-LIST-END                                   11760015
117700                    SET PS-NO-LIST-END                            11770015
117800                                   TO TRUE                        11780015
117900                 ELSE                                             11790015
118000                    MOVE ASC-KEY-PO-NBR-N                         11800015
118100                                   TO DK-PO-NBR                   11810015
118200                    MOVE ASC-KEY-OPER-UNT-ID-N                    11820015
118300                                   TO DK-OPER-UNT-ID              11830015
118400                    MOVE ASC-KEY-FCLTY-ID-N                       11840015
118500                                   TO DK-FCLTY-ID                 11850015
118600                                                                  11860015
118700                    EVALUATE DP020-INT-APPL-FORMAT-IND            11870015
118800                                                                  11880015
118900                        WHEN PC-INTER-APPL-LIST                   11890015
119000                           PERFORM 1140-CHECK-DUPL-PKSLIP         11900015
119100                        WHEN PC-LIST-FORMAT-4                     11910015
119200                           MOVE RC015-OPER-UNT-ID                 11920015
119300                                    TO ASC-KEY-OPER-UNT-ID-N      11930015
119400                                       ASC-OPER-UNT-ID-N          11940015
119500                                       DK-OPER-UNT-ID             11950015
119600                           PERFORM 1145-CHECK-DUPL-PKSLIP         11960015
119700                    END-EVALUATE                                  11970015
119800                                                                  11980015
119900                    PERFORM 4000-BUILD-INITIAL-PANEL              11990015
120000                    PERFORM 3200-RESET-ATTRIBUTES                 12000015
120100                 END-IF                                           12010015
120200             ELSE                                                 12020015
120300*                --- TOP OF LIST ---                              12030015
120400                 MOVE PC-TSYMSG-00069                             12040015
120500                                   TO DP020-MSG-NUMBER            12050015
120600                 SET DP020-MSG-INFORMATIONAL                      12060015
120700                     PS-LIST-END   TO TRUE                        12070015
120800             END-IF                                               12080015
120900                                                                  12090015
121000                                                                  12100015
121100                                                                  12110015
121200         WHEN OTHER                                               12120015
121300             IF  PS-NO-ERROR                                      12130015
121400                 SET DP030-CONTINUE-GO                            12140015
121500                                   TO TRUE                        12150015
121600                 PERFORM 2100-CHECK-FUNCTION-KEY                  12160015
121700             ELSE                                                 12170015
121800                 SET DP030-OVERRIDE-GO                            12180015
121900                                   TO TRUE                        12190015
122000             END-IF                                               12200015
122100     END-EVALUATE.                                                12210015
122200                                                                  12220015
122300/                                                                 12230015
122400*----------------------------------------------------------------*12240015
122500*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *12250015
122600*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*12260015
122700*    FROM THE CICS ARCHITECTURE API.                             *12270015
122800*----------------------------------------------------------------*12280015
122900                                                                  12290015
123000 2100-CHECK-FUNCTION-KEY.                                         12300015
123100                                                                  12310015
123200     EVALUATE TRUE                                                12320015
123300                                                                  12330015
123400         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  12340015
123500         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               12350015
123600*F23 CARTON LIST (SUKCS555)                                       12360015
123700         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               12370015
123800             PERFORM 2101-SETUP-LOCAL-GOTO                        12380015
123900                                                                  12390015
124000         WHEN DP020-SRC-AID = DP016-ENTER                         12400015
124100             CONTINUE                                             12410015
124200                                                                  12420015
124300         WHEN OTHER                                               12430015
124400             SET DP013-NO-ROLLBACK                                12440015
124500                 DP013-XCTL-DISPLAY-RESTART                       12450015
124600                 DP013-CICS-ABEND  TO TRUE                        12460015
124700             MOVE '2100-CHECK-FUNCTION-KEY'                       12470015
124800                                   TO DP013-PARAGRAPH             12480015
124900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12490015
125000                                   TO DP013-MESSAGE-TEXT (1)      12500015
125100             PERFORM DP013-0000-PROCESS-ABEND                     12510015
125200     END-EVALUATE.                                                12520015
125300/                                                                 12530015
125400 2101-SETUP-LOCAL-GOTO.                                           12540015
125500                                                                  12550015
125600     MOVE ASC-KEY-PO-NBR-N         TO RC012-PO-NBR.               12560015
125700     MOVE ASC-KEY-OPER-UNT-ID-N    TO RC012-OPER-UNT-ID.          12570015
125800     MOVE ASC-KEY-FCLTY-ID-N       TO RC012-FCLTY-ID.             12580015
125900     MOVE ASC-KEY-PKSL-STAT-CDES   TO RC012-PKSL-STAT-CDES.       12590015
126000                                                                  12600015
126100     IF ASC-REC-SEQ-NBR NUMERIC                                   12610015
126200         MOVE ASC-REC-SEQ-NBR-N    TO RC012-REC-SEQ-NBR           12620015
126300     ELSE                                                         12630015
126400         MOVE ZEROS                TO RC012-REC-SEQ-NBR           12640015
126500     END-IF.                                                      12650015
126600                                                                  12660015
126700     MOVE ASC-PKSL-NBR             TO RC012-PKSL-NBR.             12670015
126800     MOVE ASC-BOL-NBR              TO RC012-BOL-NBR.              12680015
126900     MOVE ASC-PRO-NBR              TO RC012-PRO-NBR.              12690015
127000     MOVE ASC-SEQ-NBR              TO RC012-SEQ-NBR.              12700015
127100                                                                  12710015
127200     IF ASC-STR-DEST-NBR NUMERIC                                  12720015
127300         MOVE ASC-STR-DEST-NBR-N   TO RC012-STR-NBR               12730015
127400     ELSE                                                         12740015
127500         MOVE ZEROS                TO RC012-STR-NBR               12750015
127600     END-IF.                                                      12760015
127700                                                                  12770015
127800/                                                                 12780015
127900*----------------------------------------------------------------*12790015
128000*    GET THE PACK SLIP NUMBER (KEY) OF THE NEXT SELECTED OBJECT  *12800015
128100*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *12810015
128200*----------------------------------------------------------------*12820015
128300 2115-GET-NEXT-PACK-SLIP.                                         12830015
128400                                                                  12840015
128500     ADD +1                        TO ASC-SEL-SUB.                12850015
128600     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            12860015
128700         ADD +1                    TO ASC-SEL-ITEM                12870015
128800         MOVE +1                   TO ASC-SEL-SUB                 12880015
128900     END-IF.                                                      12890015
129000                                                                  12900015
129100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                12910015
129200         PERFORM 9100-READ-SEL-QUEUE                              12920015
129300         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      12930015
129400             INITIALIZE ASC-SCREEN-FIELDS                         12940015
129500             MOVE ASC-KEY-PO-NBR-N TO ASC-PO-NBR-N                12950015
129600             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 12960015
129700                                    TO ASC-KEY-OPER-UNT-ID-N      12970015
129800                                       ASC-OPER-UNT-ID-N          12980015
129900                                       DK-OPER-UNT-ID             12990015
130000             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      13000015
130100                                    TO ASC-PO-NBR-N               13010015
130200                                       ASC-KEY-PO-NBR-N           13020015
130300                                       DK-PO-NBR                  13030015
130400             MOVE ASC-KEY-FCLTY-ID-N                              13040015
130500                                    TO ASC-FCLTY-ID-N             13050015
130600             IF RC013-REC-SEQ-NBR (ASC-SEL-SUB) = ZEROES          13060015
130700                 MOVE SPACES        TO ASC-KEY-REC-SEQ-NBR        13070015
130800             ELSE                                                 13080015
130900                 MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)             13090015
131000                                    TO ASC-KEY-REC-SEQ-NBR-N      13100015
131100                                       DK-REC-SEQ-NBR             13110015
131200             END-IF                                               13120015
131300             MOVE RC013-PKSL-STAT-CDE (ASC-SEL-SUB)               13130015
131400                                   TO ASC-PKSL-STAT-CDE           13140015
131500                                      PV-PKSL-STAT-CDE            13150015
131600             IF RC013-STR-NBR (ASC-SEL-SUB) = ZEROES              13160015
131700                 MOVE SPACES       TO ASC-STR-DEST-NBR            13170015
131800                 MOVE ZERO         TO ASC-KEY-STR-DEST-NBR        13180015
131900             ELSE                                                 13190015
132000                 MOVE RC013-STR-NBR (ASC-SEL-SUB)                 13200015
132100                                   TO ASC-STR-DEST-NBR-N          13210015
132200                                      ASC-KEY-STR-DEST-NBR        13220015
132300                                      DK-STR-DEST-NBR             13230015
132400             END-IF                                               13240015
132500             MOVE RC013-PRO-NBR (ASC-SEL-SUB)                     13250015
132600                               TO ASC-KEY-PRO-NBR                 13260015
132700                                  DK-PRO-NBR                      13270015
132800             MOVE RC013-BOL-NBR (ASC-SEL-SUB)                     13280015
132900                               TO ASC-KEY-BOL-NBR                 13290015
133000                                  DK-BOL-NBR                      13300015
133100             MOVE RC013-PKSL-NBR (ASC-SEL-SUB)                    13310015
133200                               TO ASC-KEY-PKSL-NBR                13320015
133300                                  DK-PKSL-NBR                     13330015
133400             MOVE RC013-SEQ-NBR  (ASC-SEL-SUB)                    13340015
133500                               TO DK-SEQ-NBR                      13350015
133600                                  ASC-SEQ-NBR                     13360015
133700             SET RC013-INQ (ASC-SEL-SUB)                          13370015
133800                               TO TRUE                            13380015
133900             PERFORM 9200-REWRITE-SEL-QUEUE                       13390015
134000         ELSE                                                     13400015
134100             SUBTRACT +1 FROM ASC-SEL-SUB                         13410015
134200*            --- BOTTOM OF LIST ---                               13420015
134300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13430015
134400             SET DP020-MSG-INFORMATIONAL                          13440015
134500                 PS-LIST-END                                      13450015
134600                                   TO TRUE                        13460015
134700         END-IF                                                   13470015
134800     ELSE                                                         13480015
134900         SUBTRACT +1 FROM ASC-SEL-ITEM                            13490015
135000         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 13500015
135100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13510015
135200         SET DP020-MSG-INFORMATIONAL                              13520015
135300             PS-LIST-END                                          13530015
135400                                   TO TRUE                        13540015
135500     END-IF.                                                      13550015
135600                                                                  13560015
135700/                                                                 13570015
135800*----------------------------------------------------------------*13580015
135900*    GET THE PO NUMBER (KEY) OF THE PREVIOUS SELECTED            *13590015
136000*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *13600015
136100*----------------------------------------------------------------*13610015
136200 2120-GET-PREV-PACK-SLIP.                                         13620015
136300                                                                  13630015
136400     SUBTRACT +1 FROM ASC-SEL-SUB.                                13640015
136500     IF  ASC-SEL-SUB < +1                                         13650015
136600         SUBTRACT +1 FROM ASC-SEL-ITEM                            13660015
136700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 13670015
136800     END-IF.                                                      13680015
136900                                                                  13690015
137000     IF  ASC-SEL-ITEM > ZERO                                      13700015
137100         PERFORM 9100-READ-SEL-QUEUE                              13710015
137200         INITIALIZE ASC-SCREEN-FIELDS                             13720015
137300         MOVE ASC-KEY-PO-NBR-N     TO ASC-PO-NBR-N                13730015
137400         MOVE ASC-KEY-OPER-UNT-ID-N                               13740015
137500                                   TO ASC-OPER-UNT-ID-N           13750015
137600         MOVE ASC-KEY-FCLTY-ID-N   TO ASC-FCLTY-ID-N              13760015
137700         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     13770015
137800                                   TO ASC-KEY-OPER-UNT-ID-N       13780015
137900                                      ASC-OPER-UNT-ID-N           13790015
138000                                      DK-OPER-UNT-ID              13800015
138100         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          13810015
138200                                    TO ASC-PO-NBR-N               13820015
138300                                       ASC-KEY-PO-NBR-N           13830015
138400                                       DK-PO-NBR                  13840015
138500         IF RC013-REC-SEQ-NBR (ASC-SEL-SUB) = ZEROES              13850015
138600             MOVE SPACES           TO ASC-KEY-REC-SEQ-NBR         13860015
138700         ELSE                                                     13870015
138800             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 13880015
138900                                   TO ASC-KEY-REC-SEQ-NBR-N       13890015
139000                                      DK-REC-SEQ-NBR              13900015
139100         END-IF                                                   13910015
139200         MOVE RC013-PKSL-STAT-CDE (ASC-SEL-SUB)                   13920015
139300                                   TO ASC-PKSL-STAT-CDE           13930015
139400                                      PV-PKSL-STAT-CDE            13940015
139500         IF RC013-STR-NBR (ASC-SEL-SUB) = ZEROES                  13950015
139600             MOVE SPACES           TO ASC-STR-DEST-NBR            13960015
139700         ELSE                                                     13970015
139800             MOVE RC013-STR-NBR (ASC-SEL-SUB)                     13980015
139900                                   TO ASC-STR-DEST-NBR-N          13990015
140000                                      ASC-KEY-STR-DEST-NBR        14000015
140100                                      DK-STR-DEST-NBR             14010015
140200         END-IF                                                   14020015
140300         MOVE RC013-PRO-NBR (ASC-SEL-SUB)                         14030015
140400                                   TO ASC-KEY-PRO-NBR             14040015
140500                                      DK-PRO-NBR                  14050015
140600         MOVE RC013-BOL-NBR (ASC-SEL-SUB)                         14060015
140700                                   TO ASC-KEY-BOL-NBR             14070015
140800                                      DK-BOL-NBR                  14080015
140900         MOVE RC013-PKSL-NBR (ASC-SEL-SUB)                        14090015
141000                                   TO ASC-KEY-PKSL-NBR            14100015
141100                                      DK-PKSL-NBR                 14110015
141200         MOVE RC013-SEQ-NBR  (ASC-SEL-SUB)                        14120015
141300                                   TO DK-SEQ-NBR                  14130015
141400                                      ASC-SEQ-NBR                 14140015
141500     ELSE                                                         14150015
141600         MOVE +1                   TO ASC-SEL-ITEM                14160015
141700                                      ASC-SEL-SUB                 14170015
141800*        --- TOP OF LIST ---                                      14180015
141900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14190015
142000         SET DP020-MSG-INFORMATIONAL                              14200015
142100             PS-LIST-END           TO TRUE                        14210015
142200     END-IF.                                                      14220015
142300                                                                  14230015
142400*----------------------------------------------------------------*14240015
142500*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *14250015
142600*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *14260015
142700*----------------------------------------------------------------*14270015
142800 2200-MOVE-SCREEN-TO-COMMAREA.                                    14280015
142900                                                                  14290015
143000     IF AOPERL > ZERO                                             14300015
143100         MOVE AOPERI               TO ASC-OPER-UNT-ID             14310015
143200     ELSE                                                         14320015
143300         IF AOPERF = DP015-ERASE-EOF                              14330015
143400             MOVE SPACES           TO ASC-OPER-UNT-ID             14340015
143500         END-IF                                                   14350015
143600     END-IF.                                                      14360015
143700                                                                  14370015
143800     IF APOL > ZERO                                               14380015
143900         MOVE APOI                 TO ASC-PO-NBR                  14390015
144000     ELSE                                                         14400015
144100         IF APOF = DP015-ERASE-EOF                                14410015
144200             MOVE SPACES           TO ASC-PO-NBR                  14420015
144300         END-IF                                                   14430015
144400     END-IF.                                                      14440015
144500                                                                  14450015
144600     IF APKSLIPL > ZERO                                           14460015
144700         MOVE APKSLIPI             TO ASC-PKSL-NBR                14470015
144800     ELSE                                                         14480015
144900         IF APKSLIPF = DP015-ERASE-EOF                            14490015
145000             MOVE SPACES           TO ASC-PKSL-NBR                14500015
145100         END-IF                                                   14510015
145200     END-IF.                                                      14520015
145300                                                                  14530015
145400     IF ABOLL > ZERO                                              14540015
145500         MOVE ABOLI                TO ASC-BOL-NBR                 14550015
145600     ELSE                                                         14560015
145700         IF ABOLF = DP015-ERASE-EOF                               14570015
145800             MOVE SPACES           TO ASC-BOL-NBR                 14580015
145900         END-IF                                                   14590015
146000     END-IF.                                                      14600015
146100                                                                  14610015
146200     IF APROL > ZERO                                              14620015
146300         MOVE APROI                TO ASC-PRO-NBR                 14630015
146400     ELSE                                                         14640015
146500         IF APROF = DP015-ERASE-EOF                               14650015
146600             MOVE SPACES           TO ASC-PRO-NBR                 14660015
146700         END-IF                                                   14670015
146800     END-IF.                                                      14680015
146900                                                                  14690015
147000     IF ASTRL > ZERO                                              14700015
147100         MOVE ASTRI                TO ASC-STR-DEST-NBR            14710015
147200     ELSE                                                         14720015
147300         IF ASTRF = DP015-ERASE-EOF                               14730015
147400             MOVE SPACES           TO ASC-STR-DEST-NBR            14740015
147500         END-IF                                                   14750015
147600     END-IF.                                                      14760015
147700                                                                  14770015
147800     IF ACRTNL > ZERO                                             14780015
147900         MOVE ACRTNI               TO ASC-EXPTED-PKG-QTY          14790015
148000     ELSE                                                         14800015
148100         IF ACRTNF = DP015-ERASE-EOF                              14810015
148200             MOVE ZEROS            TO ASC-EXPTED-PKG-QTY          14820015
148300         END-IF                                                   14830015
148400     END-IF.                                                      14840015
148500                                                                  14850015
148600     IF ASRCL > ZERO                                              14860015
148700         MOVE ASRCI                TO ASC-CRE-SRC-CDE             14870015
148800     ELSE                                                         14880015
148900         IF ASRCF = DP015-ERASE-EOF                               14890015
149000             MOVE SPACES           TO ASC-CRE-SRC-CDE             14900015
149100         END-IF                                                   14910015
149200     END-IF.                                                      14920015
149300                                                                  14930015
149400     IF ARECSEQL > ZERO                                           14940015
149500         MOVE ARECSEQI             TO ASC-REC-SEQ-NBR             14950015
149600     ELSE                                                         14960015
149700         IF ARECSEQF = DP015-ERASE-EOF                            14970015
149800             MOVE ZEROS            TO ASC-REC-SEQ-NBR             14980015
149900         END-IF                                                   14990015
150000     END-IF.                                                      15000015
150100                                                                  15010015
150200/                                                                 15020015
150300*----------------------------------------------------------------*15030015
150400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *15040015
150500*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *15050015
150600*----------------------------------------------------------------*15060015
150700 3000-EDIT-DATA-IN-COMMAREA.                                      15070015
150800                                                                  15080015
150900     SET PS-NO-ERROR               TO TRUE.                       15090015
151000                                                                  15100015
151100     PERFORM 3200-RESET-ATTRIBUTES.                               15110015
151200     MOVE ASC-KEY-OPER-UNT-ID-N    TO DK-OPER-UNT-ID.             15120015
151300     MOVE ASC-KEY-FCLTY-ID-N       TO DK-FCLTY-ID.                15130015
151400                                                                  15140015
151500                                                                  15150015
151600 3030-VALIDATE-STR-DEST-NBR.                                      15160015
151700                                                                  15170015
151800     INITIALIZE XL071-COMMAREA-REC.                               15180015
151900                                                                  15190015
152000*VML MOVE DK-OPER-UNT-ID        TO PV-UNPACK-OPER-UNT-ID.         15200015
152100     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         15210015
152200                                                                  15220015
152300     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    15230015
152400                                      XL071-COMMAREA              15240015
152500                                      XL071-COMMAREA-REC.         15250015
152600                                                                  15260015
152700     EVALUATE TRUE                                                15270015
152800         WHEN XL071-NO-ERRORS                                     15280015
152900             CONTINUE                                             15290015
153000         WHEN XL071-LOC-NOT-FOUND                                 15300015
153100         WHEN XL071-SQLCODE-N = -904                              15310015
153200         WHEN XL071-SQLCODE-N = -913                              15320015
153300             MOVE SPACES TO XL071-LOC-NM                          15330015
153400         WHEN XL071-BAD-DB2-RETURN                                15340015
153500              MOVE '3030-VALIDATE-STR-DEST-NBR' TO DP013-PARAGRAPH15350015
153600              MOVE 'CALL TO XLKUT071' TO DP013-MESSAGE-TEXT (1)   15360015
153700              STRING 'LOCATION NBR: '    DELIMITED BY SIZE        15370015
153800                   XL071-LOCATION-NUMBER DELIMITED BY SIZE        15380015
153900                            INTO DP013-MESSAGE-TEXT(2)            15390015
154000              MOVE XL071-SQLCA     TO DP013-SQLCA                 15400015
154100              MOVE 'XLT_LOC'       TO DP013-DB2-TABLE-NAME (1)    15410015
154200              SET DP013-DB2-ABEND                                 15420015
154300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              15430015
154400              PERFORM DP013-0000-PROCESS-ABEND                    15440015
154500     END-EVALUATE.                                                15450015
154600/                                                                 15460015
154700*----------------------------------------------------------------*15470015
154800*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *15480015
154900*----------------------------------------------------------------*15490015
155000                                                                  15500015
155100 3200-RESET-ATTRIBUTES.                                           15510015
155200                                                                  15520015
155300                                                                  15530015
155400      SET DP030-SET-CURSOR-TRAILER                                15540015
155500                   TO TRUE.                                       15550015
155600                                                                  15560015
155700/                                                                 15570015
155800*----------------------------------------------------------------*15580015
155900*  THIS PARAGRAPH BUILDS THE SCREEN.                             *15590015
156000*----------------------------------------------------------------*15600015
156100                                                                  15610015
156200 4000-BUILD-INITIAL-PANEL.                                        15620015
156300                                                                  15630015
156400     MOVE PV-DB2-MONTH             TO PV-MONTH.                   15640015
156500     MOVE PV-DB2-DAY               TO PV-DAY.                     15650015
156600     MOVE PV-DB2-YEAR              TO PV-YEAR.                    15660015
156700     MOVE PV-DISPLAY-DATE          TO ASC-LAST-UPD-BY-DTE.        15670015
156800     MOVE PV-DB2-HOUR              TO PV-HOUR.                    15680015
156900     MOVE PV-DB2-MINUTE            TO PV-MINUTE.                  15690015
157000     MOVE PV-DISPLAY-TIME          TO ASC-LAST-UPD-BY-TME.        15700015
157100     MOVE PKSLIP-CRE-UID           TO ASC-LAST-UPD-BY-UID.        15710015
157200     MOVE PKSLIP-PKSL-NBR          TO ASC-PKSL-NBR.               15720015
157300     MOVE PKSLIP-PKSL-PG-CNT       TO ASC-PAGE-CNT-N.             15730015
157400                                                                  15740015
157500     IF PKSLIP-STR-DEST-NBR = ZEROS                               15750015
157600         MOVE SPACES               TO ASC-STR-DEST-NBR            15760015
157700     ELSE                                                         15770015
157800         MOVE PKSLIP-STR-DEST-NBR  TO ASC-STR-DEST-NBR-N          15780015
157900     END-IF                                                       15790015
158000                                                                  15800015
158100     MOVE PKSLIP-REC-SEQ-NBR       TO ASC-REC-SEQ-NBR-N.          15810015
158200     MOVE PKSLIP-BOL-NBR           TO ASC-BOL-NBR.                15820015
158300     MOVE PKSLIP-PRO-NBR           TO ASC-PRO-NBR.                15830015
158400     MOVE PKSLIP-PKSL-STAT-CDE     TO ASC-PKSL-STAT-CDE.          15840015
158500                                                                  15850015
158600     PERFORM 8190-SUM-INPKSU-CARTONS.                             15860015
158700     MOVE PV-INPKSU-CRTN-CNT       TO ASC-INPKSU-COUNT.           15870015
158800                                                                  15880015
158900     MOVE PKSLIP-EXPTED-PKG-QTY    TO ASC-EXPTED-PKG-QTY-N.       15890015
159000     MOVE PKSLIP-CRE-SRC-CDE       TO ASC-CRE-SRC-CDE.            15900015
159100     MOVE PKSLIP-ASN-NBR           TO ASC-ASN-NUMBER.             15910015
159200     MOVE PKSLIP-CONTNR-ID         TO ASC-CONTNR-ID.              15920015
159300     MOVE PV-VEND-DATE-MONTH       TO PV-MONTH.                   15930015
159400     MOVE PV-VEND-DATE-DAY         TO PV-DAY.                     15940015
159500     MOVE PV-VEND-DATE-YEAR        TO PV-YEAR.                    15950015
159600     IF PV-DISPLAY-DATE = '01-01-0001'                            15960015
159700         MOVE SPACES               TO ASC-VENDOR-SHIP-DATE        15970015
159800     ELSE                                                         15980015
159900         MOVE PV-DISPLAY-DATE      TO ASC-VENDOR-SHIP-DATE        15990015
160000     END-IF                                                       16000015
160100     MOVE PKSLIP-OWNER-SCAC-ID     TO ASC-SCAC-CODE.              16010015
160200     IF ASC-SCAC-CODE > SPACES                                    16020015
160300         MOVE ASC-SCAC-CODE        TO DK-SCAC-ID                  16030015
160400         PERFORM 4020-GET-ENT-NAME-DESC                           16040015
160500         MOVE ENTNME-ENT-NAME-DESC                                16050015
160600                                   TO ASC-SCAC-CODE-DESC          16060015
160700     ELSE                                                         16070015
160800         MOVE SPACES               TO ASC-SCAC-CODE-DESC          16080015
160900     END-IF                                                       16090015
161000                                                                  16100015
161100     EVALUATE ASC-PKSL-STAT-CDE                                   16110015
161200         WHEN PC-AC                                               16120015
161300             MOVE PC-AC-DESC       TO ASC-PKSL-STAT-DESC          16130015
161400         WHEN PC-CM                                               16140015
161500             MOVE PC-CM-DESC       TO ASC-PKSL-STAT-DESC          16150015
161600         WHEN PC-DE                                               16160015
161700             MOVE PC-DE-DESC       TO ASC-PKSL-STAT-DESC          16170015
161800         WHEN PC-IN                                               16180015
161900             MOVE PC-IN-DESC       TO ASC-PKSL-STAT-DESC          16190015
162000         WHEN PC-IP                                               16200015
162100             MOVE PC-IP-DESC       TO ASC-PKSL-STAT-DESC          16210015
162200         WHEN PC-VE                                               16220015
162300             MOVE PC-VE-DESC       TO ASC-PKSL-STAT-DESC          16230015
162400     END-EVALUATE.                                                16240015
162500                                                                  16250015
162600     PERFORM 4010-SELECT-ORIG-PKSLIP.                             16260015
162700                                                                  16270015
162800     IF PS-PREV-UPDATE                                            16280015
162900         MOVE PV-DB2-MONTH         TO PV-MONTH                    16290015
163000         MOVE PV-DB2-DAY           TO PV-DAY                      16300015
163100         MOVE PV-DB2-YEAR          TO PV-YEAR                     16310015
163200         MOVE PV-DISPLAY-DATE      TO ASC-CREATED-BY-DTE          16320015
163300         MOVE PV-DB2-HOUR          TO PV-HOUR                     16330015
163400         MOVE PV-DB2-MINUTE        TO PV-MINUTE                   16340015
163500         MOVE PV-DISPLAY-TIME      TO ASC-CREATED-BY-TME          16350015
163600         MOVE PKSLIP-CRE-UID       TO ASC-CREATED-BY-UID          16360015
163700     ELSE                                                         16370015
163800         MOVE ASC-LAST-UPD-BY-UID  TO ASC-CREATED-BY-UID          16380015
163900         MOVE ASC-LAST-UPD-BY-DTE  TO ASC-CREATED-BY-DTE          16390015
164000         MOVE ASC-LAST-UPD-BY-TME  TO ASC-CREATED-BY-TME          16400015
164100     END-IF.                                                      16410015
164200                                                                  16420015
164300     MOVE ASC-STR-DEST-NBR-N       TO PV-UNPACK-OPER-UNT-ID       16430015
164400*VML MOVE PC-1                     TO DK-FCLTY.                   16440015
164500                                                                  16450015
164600     PERFORM 3030-VALIDATE-STR-DEST-NBR                           16460015
164700                                                                  16470015
164800     IF XL071-SQLCODE-N = +0                                      16480015
164900         MOVE XL071-LOC-NM    TO ASC-STR-DEST-NME                 16490015
165000     END-IF.                                                      16500015
165100                                                                  16510015
165200     IF PKSLIP-SHIPT-ID > +0                                      16520015
165300     AND DK-REC-SEQ-NBR > +0                                      16530015
165400         MOVE PKSLIP-SHIPT-ID TO SHIPMT-SHIPT-ID                  16540015
165500         PERFORM 4100-GET-SHIP-INFO                               16550015
165600     ELSE                                                         16560015
165700         MOVE SPACES               TO ASC-SHIPMT-BOL-NBR          16570015
165800                                      ASC-SHIPMT-PRO-NBR          16580015
165900                                      ASC-SHIPMT-PKG-QTY          16590015
165910* DMH - 10/12/2021 - BEGIN                                        16591019
165911        IF  PKSLIP-SHIPT-ID > +0  AND                             16591124
165912            DK-PRO-NBR  >  SPACES                                 16591224
165913            MOVE PKSLIP-SHIPT-ID TO SHIPMT-SHIPT-ID               16591324
165914            PERFORM 4105-GET-SHIP-INFO-BY-PRO                     16591419
165915        ELSE                                                      16591519
165920* DMH - 10/12/2021 - END                                          16592019
165930                                                                  16593019
166000* WR40574 04-24-2012 CT START                                     16600015
166100             PERFORM 4110-GET-SHIP-INFO                           16610019
166200* WR40574 04-24-2012 CT END                                       16620015
166300         END-IF                                                   16630019
166310     END-IF.                                                      16631019
166320                                                                  16632019
166400     IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                              16640015
166500        PERFORM 4200-GET-ORIG-FA-RCVR                             16650015
166600     END-IF                                                       16660015
166700                                                                  16670015
166800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16680015
166900                                                                  16690015
167000/                                                                 16700015
167100*----------------------------------------------------------------*16710015
167200*    READ THE ORIGINAL PACK SLIP HEADER                          *16720015
167300*----------------------------------------------------------------*16730015
167400 4010-SELECT-ORIG-PKSLIP.                                         16740015
167500                                                                  16750015
167600     PERFORM                                                      16760015
167700         WITH TEST AFTER                                          16770015
167800         VARYING PV-RETRY-COUNTER                                 16780015
167900         FROM 1 BY 1                                              16790015
168000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16800015
168100             OR (SQLCODE = +0)                                    16810015
168200             OR (SQLCODE = +100))                                 16820015
168300                                                                  16830015
168400         EXEC SQL                                                 16840015
168500              SELECT  MONTH (A.CRE_TMST),                         16850015
168600                      DAY   (A.CRE_TMST),                         16860015
168700                      YEAR  (A.CRE_TMST),                         16870015
168800                      HOUR  (A.CRE_TMST),                         16880015
168900                      MINUTE(A.CRE_TMST),                         16890015
169000                      A.CRE_UID,                                  16900015
169100                      A.ORIG_PKSL_SEQ_NBR                         16910015
169200                INTO :PV-DB2-MONTH,                               16920015
169300                     :PV-DB2-DAY,                                 16930015
169400                     :PV-DB2-YEAR,                                16940015
169500                     :PV-DB2-HOUR,                                16950015
169600                     :PV-DB2-MINUTE,                              16960015
169700                     :PKSLIP-CRE-UID,                             16970015
169800                     :PKSLIP-ORIG-PKSL-SEQ-NBR                    16980015
169900                FROM TPKSLIP A                                    16990015
170000               WHERE A.PO_NBR       = :DK-PO-NBR                  17000015
170100                 AND A.SEQ_NBR      = :ASC-SEQ-NBR                17010015
170200                 AND A.VER_STAT_CDE = :PC-INACTIVE                17020015
170300                 AND A.CRE_TMST =                                 17030015
170400                     (SELECT MIN (B.CRE_TMST)                     17040015
170500                        FROM TPKSLIP B                            17050015
170600                       WHERE A.PO_NBR  = B.PO_NBR                 17060015
170700                         AND A.SEQ_NBR = B.SEQ_NBR)               17070015
170800         END-EXEC                                                 17080015
170900                                                                  17090015
171000         EVALUATE TRUE                                            17100015
171100             WHEN SQLCODE = +0                                    17110015
171200                  SET PS-PREV-UPDATE                              17120015
171300                                   TO TRUE                        17130015
171400                                                                  17140015
171500             WHEN SQLCODE = +100                                  17150015
171600                  SET PS-NO-PREV-UPDATE                           17160015
171700                                   TO TRUE                        17170015
171800                                                                  17180015
171900             WHEN SQLCODE = -904                                  17190015
172000             WHEN SQLCODE = -913                                  17200015
172100                  CONTINUE                                        17210015
172200                                                                  17220015
172300             WHEN SQLWARN0 NOT = SPACES                           17230015
172400             WHEN SQLCODE < +0                                    17240015
172500             WHEN SQLCODE > +0                                    17250015
172600                  MOVE '4010-SELECT-ORIG-PKSLIP'                  17260015
172700                                   TO DP013-PARAGRAPH             17270015
172800                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'     17280015
172900                                   TO DP013-MESSAGE-TEXT (1)      17290015
173000                  MOVE SQLCA       TO DP013-SQLCA                 17300015
173100                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    17310015
173200                  SET DP013-DB2-ABEND                             17320015
173300                      DP013-XCTL-DISPLAY-RESTART                  17330015
173400                                   TO TRUE                        17340015
173500                  PERFORM DP013-0000-PROCESS-ABEND                17350015
173600         END-EVALUATE                                             17360015
173700     END-PERFORM.                                                 17370015
173800                                                                  17380015
173900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    17390015
174000         SQLCODE NOT = +0                                         17400015
174100         MOVE '4010-SELECT-ORIG-PKSLIP'                           17410015
174200                                   TO DP013-PARAGRAPH             17420015
174300         MOVE 'MAX RETRIES EXCEEDED ON SELECT PACK SLIP HEADER'   17430015
174400                                   TO DP013-MESSAGE-TEXT (1)      17440015
174500         MOVE SQLCA                TO DP013-SQLCA                 17450015
174600         MOVE 'TPKSLIP '           TO DP013-DB2-TABLE-NAME (1)    17460015
174700         SET DP013-DB2-ABEND                                      17470015
174800             DP013-XCTL-DISPLAY-RESTART                           17480015
174900                                   TO TRUE                        17490015
175000         PERFORM DP013-0000-PROCESS-ABEND                         17500015
175100     END-IF.                                                      17510015
175200                                                                  17520015
175300/                                                                 17530015
175400*----------------------------------------------------------------*17540015
175500*    GET THE ENTERPRISE NAME DESC                                *17550015
175600*----------------------------------------------------------------*17560015
175700 4020-GET-ENT-NAME-DESC.                                          17570015
175800                                                                  17580015
175900     PERFORM                                                      17590015
176000         WITH TEST AFTER                                          17600015
176100         VARYING PV-RETRY-COUNTER                                 17610015
176200         FROM 1 BY 1                                              17620015
176300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17630015
176400             OR (SQLCODE = +0)                                    17640015
176500             OR (SQLCODE = +100))                                 17650015
176600                                                                  17660015
176700         EXEC SQL                                                 17670015
176800              SELECT ENT_NAME_DESC                                17680015
176900                INTO :ENTNME-ENT-NAME-DESC                        17690015
177000                FROM TEXTENT A                                    17700015
177100                    ,TENTNME B                                    17710015
177200               WHERE A.SCAC_CDE    = :DK-SCAC-ID                  17720015
177300                 AND A.CARRIER_IND = 'Y'                          17730015
177400                 AND B.TYPE_CDE    = '01'                         17740015
177500                 AND A.ENT_ID = B.ENT_ID                          17750015
177600               WITH UR                                            17760016
177700         END-EXEC                                                 17770015
177800                                                                  17780015
177900         EVALUATE TRUE                                            17790015
178000             WHEN SQLCODE = +0                                    17800015
178100             WHEN SQLCODE = +100                                  17810015
178200             WHEN SQLCODE = -904                                  17820015
178300             WHEN SQLCODE = -913                                  17830015
178400                  CONTINUE                                        17840015
178500                                                                  17850015
178600             WHEN SQLWARN0 NOT = SPACES                           17860015
178700             WHEN SQLCODE < +0                                    17870015
178800             WHEN SQLCODE > +0                                    17880015
178900                  MOVE '4020-GET-ENT-NAME-DESC'                   17890015
179000                                  TO DP013-PARAGRAPH              17900015
179100                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME TABLE'     17910015
179200                                  TO DP013-MESSAGE-TEXT (1)       17920015
179300                  MOVE SQLCA      TO DP013-SQLCA                  17930015
179400                  MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     17940015
179500                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     17950015
179600                  SET DP013-DB2-ABEND                             17960015
179700                      DP013-XCTL-DISPLAY-RESTART                  17970015
179800                                  TO TRUE                         17980015
179900                  PERFORM DP013-0000-PROCESS-ABEND                17990015
180000         END-EVALUATE                                             18000015
180100     END-PERFORM.                                                 18010015
180200                                                                  18020015
180300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    18030015
180400         SQLCODE NOT = +0                                         18040015
180500         MOVE '4020-GET-ENT-NAME-DESC'                            18050015
180600                                  TO DP013-PARAGRAPH              18060015
180700         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME TABLE'      18070015
180800                                  TO DP013-MESSAGE-TEXT (1)       18080015
180900         MOVE SQLCA               TO DP013-SQLCA                  18090015
181000         MOVE 'TEXTENT'           TO DP013-DB2-TABLE-NAME (1)     18100015
181100         MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2)     18110015
181200         SET DP013-DB2-ABEND                                      18120015
181300             DP013-XCTL-DISPLAY-RESTART                           18130015
181400                                  TO TRUE                         18140015
181500         PERFORM DP013-0000-PROCESS-ABEND                         18150015
181600     END-IF.                                                      18160015
181700                                                                  18170015
181800/                                                                 18180015
181900*----------------------------------------------------------------*18190015
182000*    GET THE SHIPMENT INFORMATION FOR THE "SHIPMENT WINDOW"      *18200015
182100*----------------------------------------------------------------*18210015
182200 4100-GET-SHIP-INFO.                                              18220015
182300                                                                  18230015
182400* WR40574 04-24-2012 CT ADD CARR AUTH ID AND NOT FOUND (+100)     18240015
182500*                       TO TRY AGAIN WITHOUT TPKSLIP SHIPT-ID     18250015
182600     PERFORM                                                      18260015
182700         WITH TEST AFTER                                          18270015
182800         VARYING PV-RETRY-COUNTER                                 18280015
182900         FROM 1 BY 1                                              18290015
183000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18300015
183100             OR (SQLCODE = +100)                                  18310015
183200             OR (SQLCODE = +0))                                   18320015
183300                                                                  18330015
183400         EXEC SQL                                                 18340015
183500              SELECT A.PRO_NBR                                    18350015
183600                   , A.BOL_NBR                                    18360015
183700                   , A.EXPTED_PKG_QTY                             18370015
183800                   , A.CARR_AUTH_ID                               18380015
183900                INTO :SHIPMT-PRO-NBR                              18390015
184000                   , :SHIPMT-BOL-NBR                              18400015
184100                   , :SHIPMT-EXPTED-PKG-QTY                       18410015
184200                   , :SHIPMT-CARR-AUTH-ID                         18420015
184300                FROM TSHIPMT A                                    18430015
184400                   , TSHPTPO B                                    18440015
184500               WHERE A.SHIPT_ID     =  :SHIPMT-SHIPT-ID           18450015
184600                 AND A.SHIPT_ID     =   B.SHIPT_ID                18460015
184700                 AND B.PO_NBR       =  :DK-PO-NBR                 18470015
184800                 AND B.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR            18480015
184900         END-EXEC                                                 18490015
185000                                                                  18500015
185100         EVALUATE TRUE                                            18510015
185200             WHEN SQLCODE = +0                                    18520015
185300                 MOVE SHIPMT-CARR-AUTH-ID TO ASC-CAN              18530015
185400                 MOVE SHIPMT-BOL-NBR TO ASC-SHIPMT-BOL-NBR        18540015
185500                 MOVE SHIPMT-PRO-NBR TO ASC-SHIPMT-PRO-NBR        18550015
185600                 MOVE SHIPMT-EXPTED-PKG-QTY                       18560015
185700                                     TO ASC-SHIPMT-PKG-QTY-N      18570015
185800                                                                  18580015
185900             WHEN SQLCODE = +100                                  18590015
186000                 PERFORM 4110-GET-SHIP-INFO                       18600015
186100                                                                  18610015
186200             WHEN SQLCODE = -904                                  18620015
186300             WHEN SQLCODE = -913                                  18630015
186400                  CONTINUE                                        18640015
186500                                                                  18650015
186600             WHEN SQLWARN0 NOT = SPACES                           18660015
186700             WHEN SQLCODE < +0                                    18670015
186800             WHEN SQLCODE > +0                                    18680015
186900                  MOVE '4100-GET-SHIP-INFO'                       18690015
187000                                  TO DP013-PARAGRAPH              18700015
187100                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT TABLE'     18710015
187200                                  TO DP013-MESSAGE-TEXT (1)       18720015
187300                  MOVE DK-SHIPT-ID                                18730015
187400                                  TO DP013-MESSAGE-TEXT (2)       18740015
187500                  MOVE SQLCA      TO DP013-SQLCA                  18750015
187600                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     18760015
187700                  SET DP013-DB2-ABEND                             18770015
187800                      DP013-XCTL-DISPLAY-RESTART                  18780015
187900                                  TO TRUE                         18790015
188000                  PERFORM DP013-0000-PROCESS-ABEND                18800015
188100         END-EVALUATE                                             18810015
188200     END-PERFORM.                                                 18820015
188300                                                                  18830015
188400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    18840015
188500         SQLCODE NOT = +0                                         18850015
188600         MOVE '4100-GET-SHIPT-INFO'                               18860015
188700                                  TO DP013-PARAGRAPH              18870015
188800         MOVE DK-SHIPT-ID         TO DP013-MESSAGE-TEXT (2)       18880015
188900         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHIPMT TABLE'      18890015
189000                                  TO DP013-MESSAGE-TEXT (1)       18900015
189100         MOVE SQLCA               TO DP013-SQLCA                  18910015
189200         MOVE 'TSHIPMT'           TO DP013-DB2-TABLE-NAME (1)     18920015
189300         SET DP013-DB2-ABEND                                      18930015
189400             DP013-XCTL-DISPLAY-RESTART                           18940015
189500                                  TO TRUE                         18950015
189600         PERFORM DP013-0000-PROCESS-ABEND                         18960015
189700     END-IF.                                                      18970015
189800                                                                  18980015
189900                                                                  18990019
189910*----------------------------------------------------------------*18991019
189920*    SHIPMENT INFO USING PRO NUMBER                              *18992019
189930*----------------------------------------------------------------*18993019
189940 4105-GET-SHIP-INFO-BY-PRO.                                       18994019
189950                                                                  18995019
189980     PERFORM                                                      18998019
189990         WITH TEST AFTER                                          18999019
189991         VARYING PV-RETRY-COUNTER                                 18999119
189992         FROM 1 BY 1                                              18999219
189993         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18999319
189994             OR (SQLCODE = +100)                                  18999419
189995             OR (SQLCODE = +0))                                   18999519
189996                                                                  18999619
189997         EXEC SQL                                                 18999719
189998              SELECT A.PRO_NBR                                    18999819
189999                   , A.BOL_NBR                                    18999919
190000                   , A.EXPTED_PKG_QTY                             19000019
190001                   , A.CARR_AUTH_ID                               19000119
190002                INTO :SHIPMT-PRO-NBR                              19000219
190003                   , :SHIPMT-BOL-NBR                              19000319
190004                   , :SHIPMT-EXPTED-PKG-QTY                       19000419
190005                   , :SHIPMT-CARR-AUTH-ID                         19000519
190006                FROM TSHIPMT A                                    19000619
190008               WHERE A.SHIPT_ID     =  :SHIPMT-SHIPT-ID           19000824
190009                 AND A.PRO_NBR      =  :DK-PRO-NBR                19000919
190012         END-EXEC                                                 19001219
190013                                                                  19001319
190014         EVALUATE TRUE                                            19001419
190015             WHEN SQLCODE = +0                                    19001519
190016                 MOVE SHIPMT-CARR-AUTH-ID TO ASC-CAN              19001619
190017                 MOVE SHIPMT-BOL-NBR TO ASC-SHIPMT-BOL-NBR        19001719
190018                 MOVE SHIPMT-PRO-NBR TO ASC-SHIPMT-PRO-NBR        19001819
190019                 MOVE SHIPMT-EXPTED-PKG-QTY                       19001919
190020                                     TO ASC-SHIPMT-PKG-QTY-N      19002019
190021                                                                  19002119
190022             WHEN SQLCODE = +100                                  19002219
190023                 PERFORM 4110-GET-SHIP-INFO                       19002319
190024                                                                  19002419
190025             WHEN SQLCODE = -904                                  19002519
190026             WHEN SQLCODE = -913                                  19002619
190027                  CONTINUE                                        19002719
190028                                                                  19002819
190029             WHEN SQLWARN0 NOT = SPACES                           19002919
190030             WHEN SQLCODE < +0                                    19003019
190031             WHEN SQLCODE > +0                                    19003119
190032                  MOVE '4105-GET-SHIP-INFO-BY-PRO'                19003219
190033                                  TO DP013-PARAGRAPH              19003319
190034                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT TABLE'     19003419
190035                                  TO DP013-MESSAGE-TEXT (1)       19003519
190036                  MOVE DK-SHIPT-ID  TO  PV-DISP-SHIPT-ID          19003621
190037                  STRING 'SHIPT_ID:'  PV-DISP-SHIPT-ID            19003721
190038                         '  PRO-NBR:' DK-PRO-NBR                  19003819
190039                                      DELIMITED  BY SIZE          19003919
190040                                INTO DP013-MESSAGE-TEXT (2)       19004019
190042                  MOVE SQLCA      TO DP013-SQLCA                  19004219
190043                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     19004319
190044                  SET DP013-DB2-ABEND                             19004419
190045                      DP013-XCTL-DISPLAY-RESTART                  19004519
190046                                  TO TRUE                         19004619
190047                  PERFORM DP013-0000-PROCESS-ABEND                19004719
190048         END-EVALUATE                                             19004819
190049     END-PERFORM.                                                 19004919
190050                                                                  19005019
190051     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    19005119
190052         SQLCODE NOT = +0                                         19005219
190053         MOVE '4105-GET-SHIP-INFO-BY-PRO'                         19005319
190054                                  TO DP013-PARAGRAPH              19005419
190055         MOVE DK-SHIPT-ID  TO  PV-DISP-SHIPT-ID                   19005521
190056         STRING 'SHIPT_ID:'  PV-DISP-SHIPT-ID                     19005621
190057                '  PRO-NBR:' DK-PRO-NBR                           19005719
190058                                      DELIMITED  BY SIZE          19005819
190059                                INTO DP013-MESSAGE-TEXT (2)       19005919
190060         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHIPMT TABLE'      19006019
190061                                  TO DP013-MESSAGE-TEXT (1)       19006119
190062         MOVE SQLCA               TO DP013-SQLCA                  19006219
190063         MOVE 'TSHIPMT'           TO DP013-DB2-TABLE-NAME (1)     19006319
190064         SET DP013-DB2-ABEND                                      19006419
190065             DP013-XCTL-DISPLAY-RESTART                           19006519
190066                                  TO TRUE                         19006619
190067         PERFORM DP013-0000-PROCESS-ABEND                         19006719
190068     END-IF.                                                      19006819
190069                                                                  19006919
190070                                                                  19007019
190080* WR40574 04-24-2012 CT START                                     19008015
190100*----------------------------------------------------------------*19010015
190200*    GET THE SHIPMENT INFORMATION FOR THE PO AND RECEIVER        *19020015
190300*    WHEN NOT FOUND VIA 'SHIPMENT WINDOW"                        *19030015
190400*----------------------------------------------------------------*19040015
190500 4110-GET-SHIP-INFO.                                              19050015
190600                                                                  19060015
190700     PERFORM                                                      19070015
190800         WITH TEST AFTER                                          19080015
190900         VARYING PV-RETRY-COUNTER                                 19090015
191000         FROM 1 BY 1                                              19100015
191100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19110015
191200             OR (SQLCODE = +100)                                  19120015
191300             OR (SQLCODE = +0))                                   19130015
191400                                                                  19140015
191500         EXEC SQL                                                 19150015
191600              SELECT A.PRO_NBR                                    19160015
191700                   , A.BOL_NBR                                    19170015
191800                   , A.EXPTED_PKG_QTY                             19180015
191900                   , A.CARR_AUTH_ID                               19190015
192000                INTO :SHIPMT-PRO-NBR                              19200015
192100                   , :SHIPMT-BOL-NBR                              19210015
192200                   , :SHIPMT-EXPTED-PKG-QTY                       19220015
192300                   , :SHIPMT-CARR-AUTH-ID                         19230015
192400                FROM TSHIPMT A                                    19240015
192500                   , TSHPTPO B                                    19250015
192600               WHERE A.SHIPT_ID     =   B.SHIPT_ID                19260015
192700                 AND B.PO_NBR       =  :DK-PO-NBR                 19270015
192800                 AND B.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR            19280015
192900         END-EXEC                                                 19290015
193000                                                                  19300015
193100         EVALUATE TRUE                                            19310015
193200             WHEN SQLCODE = +0                                    19320015
193300                 MOVE SHIPMT-CARR-AUTH-ID TO ASC-CAN              19330015
193400                 MOVE SHIPMT-BOL-NBR TO ASC-SHIPMT-BOL-NBR        19340015
193500                 MOVE SHIPMT-PRO-NBR TO ASC-SHIPMT-PRO-NBR        19350015
193600                 MOVE SHIPMT-EXPTED-PKG-QTY                       19360015
193700                                     TO ASC-SHIPMT-PKG-QTY-N      19370015
193800                                                                  19380015
193900             WHEN SQLCODE = +100                                  19390015
194000                 MOVE SPACES         TO ASC-SHIPMT-BOL-NBR        19400015
194100                                        ASC-SHIPMT-PRO-NBR        19410015
194200                                        ASC-CAN                   19420015
194300                 MOVE 0              TO ASC-SHIPMT-PKG-QTY-N      19430015
194400                                                                  19440015
194500             WHEN SQLCODE = -811                                  19450015
194600                 MOVE SPACES         TO ASC-SHIPMT-BOL-NBR        19460015
194700                                        ASC-SHIPMT-PRO-NBR        19470015
194800                 MOVE 0              TO ASC-SHIPMT-PKG-QTY-N      19480015
194900                 PERFORM 4111-GET-LATEST-CAN                      19490015
195000                 MOVE 0 TO SQLCODE                                19500015
195100                                                                  19510015
195200             WHEN SQLCODE = -904                                  19520015
195300             WHEN SQLCODE = -913                                  19530015
195400                  CONTINUE                                        19540015
195500                                                                  19550015
195600             WHEN SQLWARN0 NOT = SPACES                           19560015
195700             WHEN SQLCODE < +0                                    19570015
195800             WHEN SQLCODE > +0                                    19580015
195900                  MOVE '4110-GET-SHIP-INFO'                       19590015
196000                                  TO DP013-PARAGRAPH              19600015
196100                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT TABLE'     19610015
196200                                  TO DP013-MESSAGE-TEXT (1)       19620015
196300                  MOVE DK-SHIPT-ID                                19630015
196400                                  TO DP013-MESSAGE-TEXT (2)       19640015
196500                  MOVE SQLCA      TO DP013-SQLCA                  19650015
196600                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     19660015
196700                  SET DP013-DB2-ABEND                             19670015
196800                      DP013-XCTL-DISPLAY-RESTART                  19680015
196900                                  TO TRUE                         19690015
197000                  PERFORM DP013-0000-PROCESS-ABEND                19700015
197100         END-EVALUATE                                             19710015
197200     END-PERFORM.                                                 19720015
197300                                                                  19730015
197400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    19740015
197500         SQLCODE NOT = +0                                         19750015
197600         MOVE '4110-GET-SHIP-INFO'                                19760015
197700                                  TO DP013-PARAGRAPH              19770015
197800         MOVE DK-SHIPT-ID         TO DP013-MESSAGE-TEXT (2)       19780015
197900         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHIPMT TABLE'      19790015
198000                                  TO DP013-MESSAGE-TEXT (1)       19800015
198100         MOVE SQLCA               TO DP013-SQLCA                  19810015
198200         MOVE 'TSHIPMT'           TO DP013-DB2-TABLE-NAME (1)     19820015
198300         SET DP013-DB2-ABEND                                      19830015
198400             DP013-XCTL-DISPLAY-RESTART                           19840015
198500                                  TO TRUE                         19850015
198600         PERFORM DP013-0000-PROCESS-ABEND                         19860015
198700     END-IF.                                                      19870015
198800                                                                  19880015
198900*----------------------------------------------------------------*19890015
199000*    GET THE LATEST CAN FOR THE PO AND RECEIVER WHEN MORE THAN    19900015
199100*    ONE FOUND                                                    19910015
199200*                                                                 19920015
199300*    CHANGED 10/16/12 DMH                                         19930015
199400*    ADDED DESC SORT SEQUENCE ON LAST_UPD_DTE ALSO                19940015
199500*----------------------------------------------------------------*19950015
199600 4111-GET-LATEST-CAN.                                             19960015
199700                                                                  19970015
199800         EXEC SQL                                                 19980015
199900              SELECT DISTINCT A.CARR_AUTH_ID                      19990015
200000                             ,A.LAST_UPD_DTE                      20000015
200100                             ,A.LAST_UPD_TME                      20010015
200200                INTO :SHIPMT-CARR-AUTH-ID                         20020015
200300                    ,:SHIPMT-LAST-UPD-DTE                         20030015
200400                    ,:SHIPMT-LAST-UPD-TME                         20040015
200500                FROM TSHIPMT A                                    20050015
200600                   , TSHPTPO B                                    20060015
200700               WHERE A.SHIPT_ID     =   B.SHIPT_ID                20070015
200800                 AND B.PO_NBR       =  :DK-PO-NBR                 20080015
200900                 AND B.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR            20090015
201000                 AND A.CARR_AUTH_ID > ' '                         20100015
201100               ORDER BY  A.LAST_UPD_DTE DESC                      20110015
201200                        ,A.LAST_UPD_TME DESC                      20120015
201300         END-EXEC                                                 20130015
201400                                                                  20140015
201500         EVALUATE TRUE                                            20150015
201600             WHEN SQLCODE = +0                                    20160015
201700                 MOVE SHIPMT-CARR-AUTH-ID TO ASC-CAN              20170015
201800                                                                  20180015
201900             WHEN SQLCODE = +100                                  20190015
202000                 MOVE SPACES              TO ASC-CAN              20200015
202100                                                                  20210015
202200             WHEN SQLCODE = -811                                  20220015
202300                 MOVE SHIPMT-CARR-AUTH-ID TO ASC-CAN              20230015
202400                                                                  20240015
202500             WHEN SQLCODE = -904                                  20250015
202600             WHEN SQLCODE = -913                                  20260015
202700                  CONTINUE                                        20270015
202800                                                                  20280015
202900             WHEN SQLWARN0 NOT = SPACES                           20290015
203000             WHEN SQLCODE < +0                                    20300015
203100             WHEN SQLCODE > +0                                    20310015
203200                  MOVE '4111-GET-LATEST-CAN'                      20320015
203300                                  TO DP013-PARAGRAPH              20330015
203400                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT TABLE'     20340015
203500                                  TO DP013-MESSAGE-TEXT (1)       20350015
203600                  MOVE DK-PO-NBR                                  20360015
203700                                  TO DP013-MESSAGE-TEXT (2)       20370015
203800                  MOVE SQLCA      TO DP013-SQLCA                  20380015
203900                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     20390015
204000                  SET DP013-DB2-ABEND                             20400015
204100                      DP013-XCTL-DISPLAY-RESTART                  20410015
204200                                  TO TRUE                         20420015
204300                  PERFORM DP013-0000-PROCESS-ABEND                20430015
204400         END-EVALUATE.                                            20440015
204500                                                                  20450015
204600* WR40574 04-24-2012 CT END                                       20460015
204700                                                                  20470015
204800 4200-GET-ORIG-FA-RCVR.                                           20480015
204900                                                                  20490015
205000         EXEC SQL                                                 20500015
205100              SELECT A.REC_SEQ_NBR                                20510015
205200                INTO :PV-FA-PREV-RECVR                            20520015
205300                FROM TPKSLIP A                                    20530015
205400               WHERE A.PO_NBR   =  :DK-PO-NBR                     20540015
205500                 AND A.SEQ_NBR  =  :PKSLIP-ORIG-PKSL-SEQ-NBR      20550015
205600                 AND A.VER_STAT_CDE = 'A'                         20560015
205700         END-EXEC                                                 20570015
205800                                                                  20580015
205900         EVALUATE TRUE                                            20590015
206000             WHEN SQLCODE = +0                                    20600015
206100             WHEN SQLCODE = -811                                  20610015
206200                 MOVE PV-FA-PREV-RECVR TO ASC-FA-PREV-REC-SEQ     20620015
206300             WHEN SQLCODE = +100                                  20630015
206400                 MOVE 0              TO ASC-FA-PREV-REC-SEQ       20640015
206500             WHEN SQLWARN0 NOT = SPACES                           20650015
206600             WHEN SQLCODE < +0                                    20660015
206700             WHEN SQLCODE > +0                                    20670015
206800                  MOVE '4200-GET-ORIG-FA-RCVR'                    20680015
206900                                  TO DP013-PARAGRAPH              20690015
207000                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP TABLE'     20700015
207100                                  TO DP013-MESSAGE-TEXT (1)       20710015
207200                  MOVE DK-PO-NBR                                  20720015
207300                                  TO DP013-MESSAGE-TEXT (2)       20730015
207400                  MOVE SQLCA      TO DP013-SQLCA                  20740015
207500                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     20750015
207600                  SET DP013-DB2-ABEND                             20760015
207700                      DP013-XCTL-DISPLAY-RESTART                  20770015
207800                                  TO TRUE                         20780015
207900                  PERFORM DP013-0000-PROCESS-ABEND                20790015
208000         END-EVALUATE.                                            20800015
208100                                                                  20810015
208200                                                                  20820015
208300/                                                                 20830015
208400*----------------------------------------------------------------*20840015
208500*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *20850015
208600*----------------------------------------------------------------*20860015
208700 4400-MOVE-COMMAREA-TO-SCREEN.                                    20870015
208800                                                                  20880015
208900     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     20890015
209000     MOVE ASC-KEY-FCLTY-NME        TO AFDESCO.                    20900015
209100     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    20910015
209200     MOVE ASC-PO-NBR               TO APOO.                       20920015
209300     MOVE ASC-STR-DEST-NBR         TO ASTRO.                      20930015
209400                                                                  20940015
209500     IF ASC-STR-DEST-NBR NUMERIC                                  20950015
209600         MOVE ASC-STR-DEST-NBR-N   TO DK-STR-DEST-NBR             20960015
209700         IF ASC-STR-DEST-NBR = ZEROS                              20970015
209800             MOVE SPACES           TO ASTRO                       20980015
209900         END-IF                                                   20990015
210000     END-IF.                                                      21000015
210100                                                                  21010015
210200     MOVE ASC-STR-DEST-NME         TO ASDESCO.                    21020015
210300     MOVE ASC-PKSL-NBR             TO APKSLIPO.                   21030015
210400     IF ASC-PAGE-CNT = ZEROES                                     21040015
210500        MOVE SPACES                TO APAGESO                     21050015
210600     ELSE                                                         21060015
210700        MOVE ASC-PAGE-CNT          TO APAGESO                     21070015
210800     END-IF.                                                      21080015
210900     MOVE ASC-PRO-NBR              TO APROO.                      21090015
211000* WR40574 04-24-2012 CT START                                     21100015
211100     MOVE ASC-CAN                  TO ACANO.                      21110015
211200* WR40574 04-24-2012 CT END                                       21120015
211300     MOVE ASC-SHIPMT-PRO-NBR       TO ASHPPROO.                   21130015
211400     MOVE ASC-EXPTED-PKG-QTY-N     TO ACRTNO.                     21140015
211500     MOVE ASC-SHIPMT-PKG-QTY-N     TO ASHCRTNO.                   21150015
211600     IF ASC-REC-SEQ-NBR = ZEROS                                   21160015
211700         MOVE SPACES               TO ARECSEQO                    21170015
211800     ELSE                                                         21180015
211900         MOVE ASC-REC-SEQ-NBR      TO ARECSEQO                    21190015
212000     END-IF.                                                      21200015
212100                                                                  21210015
212200     MOVE ASC-ASN-NUMBER           TO AASNNBRO.                   21220015
212300     MOVE ASC-BOL-NBR              TO ABOLO.                      21230015
212400     MOVE ASC-SHIPMT-BOL-NBR       TO ASHPBOLO.                   21240015
212500     MOVE ASC-CRE-SRC-CDE          TO ASRCO.                      21250015
212600                                                                  21260015
212700     MOVE ASC-PKSL-STAT-CDE        TO ASTATO.                     21270015
212800     MOVE ASC-PKSL-STAT-DESC       TO ASTDESCO.                   21280015
212900     MOVE ASC-SCAC-CODE            TO AOSCACO.                    21290015
213000     MOVE ASC-SCAC-CODE-DESC       TO ASCACDSO.                   21300015
213100     MOVE ASC-VENDOR-SHIP-DATE     TO AVSHPDTO.                   21310015
213200     MOVE ASC-CONTNR-ID            TO ACONTNRO.                   21320015
213300     MOVE ASC-CREATED-BY-UID       TO ACRTBYO.                    21330015
213400     MOVE ASC-CREATED-BY-DTE       TO ACRTDTEO.                   21340015
213500     MOVE ASC-CREATED-BY-TME       TO ACRTTMEO.                   21350015
213600                                                                  21360015
213700*LMM                                                              21370015
213800     MOVE ASC-INPKSU-COUNT         TO ASSCCO.                     21380015
213900     MOVE ASC-LAST-UPD-BY-UID      TO ALSTBYO.                    21390015
214000     MOVE ASC-LAST-UPD-BY-DTE      TO ALSTDTEO.                   21400015
214100     MOVE ASC-LAST-UPD-BY-TME      TO ALSTTMEO.                   21410015
214200                                                                  21420015
214300     IF ASC-FA-PREV-REC-SEQ > 0                                   21430015
214400        MOVE PC-FA-PREV-RCVR-HDG   TO AFAHDGO                     21440015
214500        MOVE ASC-FA-PREV-REC-SEQ   TO AFARECO                     21450015
214600     ELSE                                                         21460015
214700        MOVE SPACES                TO AFAHDGO                     21470015
214800                                      AFARECO                     21480015
214900     END-IF                                                       21490015
215000                                                                  21500015
215100     SET DP030-SET-CURSOR-TRAILER  TO TRUE.                       21510015
215200                                                                  21520015
215300/                                                                 21530015
215400 8190-SUM-INPKSU-CARTONS.                                         21540015
215500         MOVE ZEROES                 TO PV-INPKSU-CRTN-CNT.       21550015
215600         MOVE RC013-SEQ-NBR (ASC-SEL-SUB)                         21560015
215700                                     TO DK-SEQ-NBR.               21570015
215800                                                                  21580015
215900         EXEC SQL                                                 21590015
216000             SELECT COUNT(*)                                      21600015
216100               INTO :PV-INPKSU-CRTN-CNT                           21610015
216200               FROM TINPKSU                                       21620015
216300              WHERE PO_NBR        = :DK-PO-NBR                    21630015
216400                AND SEQ_NBR       = :DK-SEQ-NBR                   21640015
216500         END-EXEC                                                 21650015
216600                                                                  21660015
216700         EVALUATE TRUE                                            21670015
216800             WHEN SQLCODE = ZERO                                  21680015
216900             WHEN SQLCODE = +100                                  21690015
217000                  CONTINUE                                        21700015
217100             WHEN SQLCODE = -904                                  21710015
217200             WHEN SQLCODE = -911                                  21720015
217300             WHEN SQLCODE = -913                                  21730015
217400                  CONTINUE                                        21740015
217500                                                                  21750015
217600             WHEN SQLWARN0 NOT = SPACES                           21760015
217700             WHEN SQLCODE  NOT = ZERO                             21770015
217800                  MOVE '8190-SUM-INPKSU-CARTONS '                 21780015
217900                                 TO DP013-PARAGRAPH               21790015
218000                  MOVE 'UNSUCCESSFUL SELECT OF INPKSU CARTONS '   21800015
218100                                 TO DP013-MESSAGE-TEXT (1)        21810015
218200                  MOVE SQLCA     TO DP013-SQLCA                   21820015
218300                  MOVE 'TINPKSU' TO DP013-DB2-TABLE-NAME (1)      21830015
218400                  SET DP013-DB2-ABEND                             21840015
218500                      DP013-XCTL-DISPLAY-RESTART                  21850015
218600                                 TO TRUE                          21860015
218700                                                                  21870015
218800                  PERFORM DP013-0000-PROCESS-ABEND                21880015
218900         END-EVALUATE.                                            21890015
219000*FOR TEST ONLY                                                    21900015
219100         INITIALIZE  PV-CICS-MSG-AREA2                            21910015
219200         MOVE DK-PO-NBR           TO  PV-DISPLAY-PO-NBR           21920015
219300         MOVE DK-SEQ-NBR          TO  PV-DISPLAY-SEQ-NBR          21930015
219400         STRING  ' RCKCS267-'              DELIMITED BY SIZE      21940015
219500                 PV-DISPLAY-PO-NBR         DELIMITED BY SIZE      21950015
219600                 ' PO NBR'                 DELIMITED BY SIZE      21960015
219700                 PV-DISPLAY-SEQ-NBR        DELIMITED BY SIZE      21970015
219800                 ' SEQ NBR'                DELIMITED BY SIZE      21980015
219900                                      INTO PV-CICS-MSG-AREA2      21990015
220000         MOVE LENGTH OF PV-CICS-MSG-AREA2                         22000015
220100           TO PV-COMMAREA-LENGTH                                  22010015
220200         EXEC CICS                                                22020015
220300              WRITEQ TD                                           22030015
220400               QUEUE  ('CSSL')                                    22040015
220500                FROM  (PV-CICS-MSG-AREA2)                         22050015
220600              LENGTH  (PV-COMMAREA-LENGTH)                        22060015
220700                RESP  (PV-CICS-RESPONSE)                          22070015
220800         END-EXEC.                                                22080015
220900                                                                  22090015
221000*----------------------------------------------------------------*22100015
221100*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *22110015
221200*----------------------------------------------------------------*22120015
221300                                                                  22130015
221400 9100-READ-SEL-QUEUE.                                             22140015
221500                                                                  22150015
221600     EXEC CICS                                                    22160015
221700         READQ TS                                                 22170015
221800             QUEUE (ASC-SEL-QUEUE-NAME)                           22180015
221900             INTO  (RC013-DC-SELECT-RECORD)                       22190015
222000             ITEM  (ASC-SEL-ITEM)                                 22200015
222100             RESP  (PV-CICS-RESPONSE)                             22210015
222200     END-EXEC.                                                    22220015
222300                                                                  22230015
222400     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       22240015
222500         CONTINUE                                                 22250015
222600     ELSE                                                         22260015
222700         SET DP013-LOGIC-ABEND                                    22270015
222800             DP013-NO-ROLLBACK     TO TRUE                        22280015
222900         MOVE '9100-READ-SEL-QUEUE'                               22290015
223000                                   TO DP013-PARAGRAPH             22300015
223100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   22310015
223200                                   TO DP013-MESSAGE-TEXT (1)      22320015
223300         MOVE ASC-SEL-TASK         TO PV-DISPLAY-TASK             22330015
223400         STRING 'QUEUE ID: '                                      22340015
223500                ASC-SEL-TERM-ID                                   22350015
223600                ' '                                               22360015
223700                PV-DISPLAY-TASK                                   22370015
223800                ' '                                               22380015
223900                ASC-SEL-SEQ DELIMITED BY SIZE                     22390015
224000                               INTO DP013-MESSAGE-TEXT (2)        22400015
224100         PERFORM DP013-0000-PROCESS-ABEND                         22410015
224200     END-IF.                                                      22420015
224300                                                                  22430015
224400/                                                                 22440015
224500*----------------------------------------------------------------*22450015
224600*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *22460015
224700*----------------------------------------------------------------*22470015
224800 9200-REWRITE-SEL-QUEUE.                                          22480015
224900                                                                  22490015
225000     EXEC CICS                                                    22500015
225100          WRITEQ TS                                               22510015
225200              QUEUE  (ASC-SEL-QUEUE-NAME)                         22520015
225300              FROM   (RC013-DC-SELECT-RECORD)                     22530015
225400              ITEM   (ASC-SEL-ITEM)                               22540015
225500              RESP   (PV-CICS-RESPONSE)                           22550015
225600              REWRITE                                             22560015
225700     END-EXEC.                                                    22570015
225800                                                                  22580015
225900     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   22590015
226000         SET DP013-CICS-ABEND                                     22600015
226100             DP013-NO-ROLLBACK     TO TRUE                        22610015
226200         MOVE '9200-REWRITE-SEL-QUEUE'                            22620015
226300                                   TO DP013-PARAGRAPH             22630015
226400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   22640015
226500                                   TO DP013-MESSAGE-TEXT (1)      22650015
226600         PERFORM DP013-0000-PROCESS-ABEND                         22660015
226700     END-IF.                                                      22670015
226800                                                                  22680015
226900/                                                                 22690015
227000*----------------------------------------------------------------*22700015
227100*    ABEND PROCESSOR MODULE                                      *22710015
227200*----------------------------------------------------------------*22720015
227300                                                                  22730015
227400     COPY DPPD013.                                                22740015
