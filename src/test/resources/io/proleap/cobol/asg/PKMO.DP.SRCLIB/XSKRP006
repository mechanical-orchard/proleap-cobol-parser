000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         XSKRP006.                                    00020000
000300 AUTHOR.             JIM LEIKNESS.                                00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       12-17-2002.                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700*                                                                 00070000
000800 ENVIRONMENT DIVISION.                                            00080000
000900                                                                  00090000
001000 CONFIGURATION SECTION.                                           00100000
001100                                                                  00110000
001200 SOURCE-COMPUTER.    IBM-3090.                                    00120000
001300 OBJECT-COMPUTER.    IBM-3090.                                    00130000
001400                                                                  00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT XST-INPUT-FILE       ASSIGN TO INP01.                 00190000
002000     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00200000
002100     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00210000
002200                                                                  00220000
002300 DATA DIVISION.                                                   00230000
002400                                                                  00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  RMS-INPUT-FILE                                               00270000
002800     RECORDING MODE IS F                                          00280000
002900     BLOCK CONTAINS 0 RECORDS                                     00290000
003000     LABEL RECORDS ARE OMITTED.                                   00300000
003100 01  RMS-INPUT-RECORD                          PIC  X(35).        00310000
003200                                                                  00320000
003300 FD  XST-INPUT-FILE                                               00330000
003400     RECORDING MODE IS F                                          00340000
003500     BLOCK CONTAINS 0 RECORDS                                     00350000
003600     LABEL RECORDS ARE OMITTED.                                   00360000
003700 01  XST-INPUT-RECORD                    PIC  X(32).              00370000
003800                                                                  00380000
003900 FD  ERROR-REPORT                                                 00390000
004000     RECORDING MODE IS F                                          00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     LABEL RECORDS ARE OMITTED.                                   00420000
004300 01  ERR-RPT-LINE                        PIC  X(200).             00430000
004400                                                                  00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700     COPY HORD007.                                                00470000
004800                                                                  00480000
005300     COPY DPWS150O.                                               00490000
005301                                                                  00500000
005310 01 XST-REC.                                                      00510000
005320     05 XST-STR-GP-TYP-CDE    PIC S9(04) COMP.                    00520000
005340     05 XST-STR-GP-CTG-NM     PIC X(30) VALUE SPACE.              00530000
005350                                                                  00531000
005351 01 PC-PROGRAM-CONSTANTS.                                         00532000
005352     05 PC-PGM-NAME           PIC X(08)  VALUE 'XSKRP006'.        00533000
005353                                                                  00534000
005360 01 PV-PROGRAM-VARIABLES.                                         00535000
005370     05 PV-XST-KEY.                                               00536000
005380        10 PV-XST-STR-GP-TYP-CDE PIC 9(04).                       00537000
005390     05 PV-XST-STR-GP-CTG-NM     PIC X(30) VALUE SPACE.           00538000
005400                                                                  00539000
005410     05 PV-RMS-KEY.                                               00540000
005420         10 PV-RMS-STR-GP-TYP-CDE PIC 9(04).                      00541000
005430     05 PV-RMS-STR-GP-CTG-NM      PIC X(30) VALUE SPACE.          00542000
005431                                                                  00543000
005440     05 PV-PAGE-CNT               PIC S9(05)  VALUE ZERO.         00544000
005450     05 PV-LINE-CNT               PIC S9(04)  COMP VALUE ZERO.    00545000
005460     05 PV-MAX-LINES              PIC S9(04)  COMP VALUE +71.     00546000
005470                                                                  00547000
005480     05 PV-DISPLAY-CNT            PIC ZZZZ9.                      00548000
005492     05 PV-NBR-ERRORS             PIC S9(04)  COMP                00549000
005493                                                VALUE ZERO.       00549100
005494     05 PV-DATE-YYMMDD.                                           00549200
005495          10 PV-YYMMDD-YY       PIC X(02)  VALUE SPACE.           00549300
005496          10 PV-YYMMDD-MM       PIC X(02)  VALUE SPACE.           00549400
005497          10 PV-YYMMDD-DD       PIC X(02)  VALUE SPACE.           00549500
005498     05 PV-TIME-HHMMSS.                                           00549600
005499          10 PV-HHMMSS-HH       PIC X(02)  VALUE SPACE.           00549700
005500          10 PV-HHMMSS-MM       PIC X(02)  VALUE SPACE.           00549800
005501          10 PV-HHMMSS-SS       PIC X(02)  VALUE SPACE.           00549900
005502     05 PV-MESSAGE              PIC X(58)  VALUE SPACE.           00550000
005510                                                                  00551000
005530 01 RPT-TOTAL-LINE.                                               00552000
005540     05 FILLER     PIC  X(23) VALUE                               00553000
005550                         'TOTAL NUMBER OF ERRORS '.               00554000
005560     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00555000
005561                                                                  00556000
005562 01 RPT-END-OF-REPORT-LINE.                                       00556100
005563     05 FILLER     PIC  X(21) VALUE                               00556200
005564                            '*** END OF REPORT ***'.              00556300
005565 01 PA-PROGRAM-ACCUMULATORS.                                      00556400
005566     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              00556500
005567     05 PA-XST-RECS-READ       PIC 9(13) VALUE ZERO.              00556600
005568     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              00556700
005569                                                                  00556800
005571 01 PS-PROGRAM-SWITCHES.                                          00556900
005572     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           00557000
005573         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           00557100
005574         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           00557200
005575     05 PS-MORE-XST-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           00557300
005576         88 PS-MORE-XST-INPUT-RECS           VALUE 'Y'.           00557400
005577         88 PS-END-OF-XST-INPUT-RECS         VALUE 'N'.           00557500
005578     05 PS-RMS-OR-XST-ERR        PIC X(01)   VALUE '0'.           00557600
005579         88 PS-RMS-ERROR                     VALUE '1'.           00557700
005580         88 PS-XST-ERROR                     VALUE '2'.           00557800
005581         88 PS-DATA-ERROR                    VALUE '3'.           00557900
005582                                                                  00558000
005583 01 RPT-REPORT-HEADING.                                           00558100
005584     05 FILLER     PIC  X(55)    VALUE SPACES.                    00558200
005585     05 FILLER     PIC  X(41)    VALUE                            00558300
005586         'XS STORE GROUP TYPE DATA INTEGRITY ERRORS'.             00558400
005587                                                                  00558500
005588 01 RPT-COL-HEADING-1.                                            00558600
005589     05 FILLER     PIC  X(01) VALUE SPACE.                        00558700
005590     05 FILLER     PIC  X(02) VALUE ALL '-'.                      00558800
005591     05 FILLER     PIC  X(03) VALUE 'KEY'.                        00558900
005592     05 FILLER     PIC  X(02) VALUE ALL '-'.                      00559000
005593                                                                  00559100
005594 01 RPT-COL-HEADING-2.                                            00559200
005595     05 FILLER     PIC  X(01) VALUE SPACE.                        00559300
005596     05 FILLER     PIC  X(19) VALUE 'STR_GP'.                     00559400
005597     05 FILLER     PIC  X(34) VALUE 'XSDOMAIN'.                   00559500
005598     05 FILLER     PIC  X(37) VALUE 'SYSTEM OF RECORD'.           00559600
005599     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    00559700
005600                                                                  00559800
005601 01 RPT-COL-HEADING-3.                                            00559900
005602     05 FILLER     PIC  X(01) VALUE SPACE.                        00560000
005603     05 FILLER     PIC  X(19) VALUE 'TYP_CDE'.                    00560100
005604     05 FILLER     PIC  X(34) VALUE 'VALUE'.                      00560200
005605     05 FILLER     PIC  X(05) VALUE 'VALUE'.                      00560300
005606                                                                  00560400
005607 01 RPT-COL-HEADING-4.                                            00560500
005608     05 FILLER     PIC  X(132) VALUE ALL '-'.                     00560600
005612                                                                  00560700
005613 01 DL-DETAIL-LINE.                                               00560800
005614     05 FILLER              PIC  X(01) VALUE SPACE.               00560900
005615     05 DL-STR-GP-TYP-CDE   PIC  X(04) VALUE SPACE.               00561000
005616     05 FILLER              PIC  X(15) VALUE SPACE.               00561100
005617     05 DL-XST-VALUE        PIC  X(30) VALUE SPACE.               00561200
005618     05 FILLER              PIC  X(06) VALUE SPACE.               00561300
005619     05 DL-RMS-VALUE        PIC  X(30) VALUE SPACE.               00561400
005620     05 FILLER              PIC  X(06) VALUE SPACE.               00561500
005621     05 DL-MESSAGE          PIC  X(58) VALUE SPACE.               00561600
005622                                                                  00561700
005623******************************************************************00561800
005624 PROCEDURE DIVISION.                                              00561900
005625******************************************************************00562000
005640 0000-MAIN-MODULE.                                                00563000
005650                                                                  00564000
005660       OPEN INPUT RMS-INPUT-FILE                                  00565000
005670                  XST-INPUT-FILE                                  00566000
005680            OUTPUT ERROR-REPORT.                                  00567000
005681                                                                  00568000
005690       PERFORM 1000-INITIALIZE.                                   00569000
005691       PERFORM 7000-READ-XST-INPUT-FILE.                          00569100
005692       PERFORM 7100-READ-RMS-INPUT-FILE.                          00569200
005693                                                                  00569300
005694       PERFORM 2000-PROCESS-RECS                                  00569400
005695          UNTIL (PS-END-OF-XST-INPUT-RECS                         00569500
005696            AND PS-END-OF-RMS-INPUT-RECS).                        00569600
005700                                                                  00569700
005710       PERFORM 8400-WRITE-TOTALS.                                 00569800
005720                                                                  00569900
005800       CLOSE RMS-INPUT-FILE                                       00570000
005900             XST-INPUT-FILE                                       00580000
006000             ERROR-REPORT.                                        00590000
006010                                                                  00600000
006100       DISPLAY '**** XSKRP006 STATISTICS ****'                    00610000
006200       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     00620000
006300       DISPLAY 'TOTAL XST RECORDS READ : ' PA-XST-RECS-READ.      00630000
006400       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      00640000
006500       DISPLAY ' '                                                00650000
006600                                                                  00660000
006700       STOP RUN.                                                  00670000
006710                                                                  00671000
006800 1000-INITIALIZE.                                                 00672000
006900                                                                  00673000
007000       ACCEPT PV-DATE-YYMMDD FROM DATE.                           00674000
007100       MOVE PV-YYMMDD-YY TO DP150O-RUN-YEAR.                      00675000
007200       MOVE PV-YYMMDD-MM TO DP150O-RUN-MONTH.                     00676000
007300       MOVE PV-YYMMDD-DD TO DP150O-RUN-DAY.                       00677000
007400                                                                  00678000
007500       ACCEPT PV-TIME-HHMMSS FROM TIME.                           00679000
007600       MOVE PV-HHMMSS-HH TO DP150O-RUN-HOUR.                      00680000
007700       MOVE PV-HHMMSS-MM TO DP150O-RUN-MINUTE.                    00690000
007800       MOVE PC-PGM-NAME TO DP150O-PROGRAM-NAME.                   00700000
007900       MOVE 1        TO DP150O-REPORT-NUMBER.                     00710000
008000                                                                  00720000
008100       PERFORM 8100-WRITE-STD-RPT-HEADING.                        00730000
008200       PERFORM 8200-WRITE-REPORT-HEADING.                         00740000
008300       PERFORM 8300-WRITE-COLUMN-HEADING.                         00750000
008400                                                                  00760000
008500 2000-PROCESS-RECS.                                               00770000
008501                                                                  00780000
008510       MOVE HO007-SGT-STR-TYP-CDE   TO  PV-RMS-STR-GP-TYP-CDE.    00790000
008520       MOVE HO007-SGT-STR-GP-CTG-NM TO  PV-RMS-STR-GP-CTG-NM.     00800000
008530                                                                  00810000
008540       MOVE XST-STR-GP-TYP-CDE  TO  PV-XST-STR-GP-TYP-CDE.        00820000
008550       MOVE XST-STR-GP-CTG-NM   TO  PV-XST-STR-GP-CTG-NM.         00830000
008560                                                                  00840000
008561       IF PV-XST-KEY = PV-RMS-KEY                                 00850000
008563          PERFORM 3000-COMPARE-FIELDS                             00851000
008564          PERFORM 7000-READ-XST-INPUT-FILE                        00852000
008565          PERFORM 7100-READ-RMS-INPUT-FILE                        00853000
008566       ELSE                                                       00854000
008570           IF ((PV-RMS-KEY < PV-XST-KEY)                          00855000
008580              OR PS-END-OF-XST-INPUT-RECS) AND                    00856000
008590              PS-MORE-RMS-INPUT-RECS                              00857000
008591              MOVE '1' TO PS-RMS-OR-XST-ERR                       00858000
008592              MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'          00859000
008593                  TO PV-MESSAGE                                   00859100
008594              PERFORM 8000-WRITE-OUTPUT-REC                       00859200
008595              PERFORM 7100-READ-RMS-INPUT-FILE                    00859300
008596           ELSE                                                   00859400
008620              IF (PV-RMS-KEY > PV-XST-KEY                         00859500
008630                    OR PS-END-OF-RMS-INPUT-RECS)                  00859600
008640                   AND PS-MORE-XST-INPUT-RECS                     00859700
008650                 MOVE '2' TO PS-RMS-OR-XST-ERR                    00859800
008660                 MOVE 'KEY ON XS DOMAIN TABLES ONLY'              00859900
008661                                                  TO PV-MESSAGE   00860000
008670                 PERFORM 8000-WRITE-OUTPUT-REC                    00861000
008680                 PERFORM 7000-READ-XST-INPUT-FILE                 00862000
008690              END-IF                                              00863000
008691           END-IF                                                 00864000
008692       END-IF.                                                    00865000
008693                                                                  00866000
008694 3000-COMPARE-FIELDS.                                             00867000
008695                                                                  00868000
008696      EVALUATE TRUE                                               00869000
008697         WHEN HO007-SGT-STR-GP-CTG-NM NOT = XST-STR-GP-CTG-NM     00870000
008703             MOVE '3' TO PS-RMS-OR-XST-ERR                        00870100
008704             MOVE 'STORE GROUP NAME DATA DOES NOT MATCH'          00870200
008705                                                TO PV-MESSAGE     00870300
008706             PERFORM 8000-WRITE-OUTPUT-REC                        00870400
008708      END-EVALUATE.                                               00870500
008709                                                                  00870600
008710 7000-READ-XST-INPUT-FILE.                                        00870700
008800                                                                  00870800
008900       INITIALIZE XST-REC.                                        00870900
009000                                                                  00871000
009100       READ XST-INPUT-FILE INTO XST-REC                           00872000
009200           AT END SET PS-END-OF-XST-INPUT-RECS TO TRUE.           00873000
009300                                                                  00874000
009400       ADD 1 TO PA-XST-RECS-READ.                                 00875000
009500                                                                  00876000
009600 7100-READ-RMS-INPUT-FILE.                                        00877000
009700                                                                  00878000
009800       INITIALIZE HO007-STR-GP-TYPE-DATA.                         00879000
009900                                                                  00880000
010000       READ RMS-INPUT-FILE INTO HO007-STR-GP-TYPE-DATA            00890000
010100            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          00900000
010200                                                                  00910000
010300       ADD 1 TO PA-RMS-RECS-READ.                                 00920000
010400                                                                  00930000
010500 8000-WRITE-OUTPUT-REC.                                           00940000
010620                                                                  00950000
010700       IF PS-RMS-ERROR                                            00960000
010800          MOVE SPACES TO DL-DETAIL-LINE                           00970000
010900          MOVE PV-RMS-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE         00980000
011000          MOVE PV-RMS-STR-GP-CTG-NM TO DL-RMS-VALUE               00990000
011100          MOVE PV-MESSAGE TO DL-MESSAGE                           01000000
011200       ELSE                                                       01010000
011300          IF PS-XST-ERROR                                         01020000
011310             MOVE SPACES TO DL-DETAIL-LINE                        01030000
011400             MOVE PV-XST-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      01040000
011500             MOVE PV-XST-STR-GP-CTG-NM TO DL-XST-VALUE            01050000
011600             MOVE PV-MESSAGE TO DL-MESSAGE                        01060000
011610          ELSE                                                    01070000
011611             MOVE SPACES TO DL-DETAIL-LINE                        01080000
011612             MOVE PV-RMS-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      01090000
011614             MOVE PV-RMS-STR-GP-CTG-NM TO DL-RMS-VALUE            01100000
011615             MOVE PV-XST-STR-GP-CTG-NM TO DL-XST-VALUE            01110000
011616             MOVE PV-MESSAGE TO DL-MESSAGE                        01120000
011620          END-IF                                                  01130000
011700       END-IF.                                                    01140000
011710                                                                  01150000
011800       IF PV-LINE-CNT > PV-MAX-LINES                              01160000
011810          PERFORM 8100-WRITE-STD-RPT-HEADING                      01170000
011820          PERFORM 8200-WRITE-REPORT-HEADING                       01180000
011830          PERFORM 8300-WRITE-COLUMN-HEADING                       01181000
011840       END-IF.                                                    01182000
011850                                                                  01183000
011900       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     01184000
012000             AFTER ADVANCING 1 LINE.                              01185000
012100       ADD +1 TO PV-LINE-CNT.                                     01186000
012200       MOVE 4095 TO RETURN-CODE.                                  01187000
012300       ADD 1 TO PA-ERROR-MESSAGES.                                01188000
012400                                                                  01189000
012500 8100-WRITE-STD-RPT-HEADING.                                      01190000
012600                                                                  01200000
012700       ADD 1  TO PV-PAGE-CNT.                                     01210000
012800       MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                    01220000
012900       WRITE ERR-RPT-LINE FROM DP150O-STANDRD-HEADER-150-COLS     01230000
013000             AFTER ADVANCING PAGE.                                01240000
013100       MOVE +1 TO PV-LINE-CNT.                                    01250000
013200                                                                  01260000
013300 8200-WRITE-REPORT-HEADING.                                       01270000
013400                                                                  01280000
013500       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 01290000
013600            AFTER ADVANCING 1 LINES.                              01300000
013700       ADD +1 TO PV-LINE-CNT.                                     01310000
013800                                                                  01320000
013900 8300-WRITE-COLUMN-HEADING.                                       01330000
013910                                                                  01340000
013920       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  01350000
013930            AFTER ADVANCING 2 LINES.                              01360000
013940       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  01370000
013950            AFTER ADVANCING 1 LINES.                              01380000
013960       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  01390000
013970            AFTER ADVANCING 1 LINES.                              01391000
013971       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  01392000
013972            AFTER ADVANCING 1 LINES.                              01393000
013980       ADD +5 TO PV-LINE-CNT.                                     01394000
014000                                                                  01395000
014100 8400-WRITE-TOTALS.                                               01396000
014101                                                                  01397000
014102       IF PV-LINE-CNT > PV-MAX-LINES                              01398000
014103          PERFORM 8100-WRITE-STD-RPT-HEADING                      01399000
014104          PERFORM 8200-WRITE-REPORT-HEADING                       01400000
014105          PERFORM 8300-WRITE-COLUMN-HEADING                       01410000
014106       END-IF.                                                    01410100
014107                                                                  01410200
014110      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    01410300
014200      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      01410400
014210            AFTER ADVANCING 1 LINES.                              01410500
014300      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              01410600
014400            AFTER ADVANCING 1 LINES.                              01410700
014500                                                                  01410800
