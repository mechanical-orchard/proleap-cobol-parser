000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   RVKUT028                                           00050081
000600 AUTHOR.       AL PETERS.                                         00060002
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. MAY 2007.                                          00080081
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  GENCO INVENTORY:   PROGRAM WILL READ THE GENCO INVENTORY       00120081
001210*                     FILE DATA, MAKE CHANGES TO SKU AND          00130099
001220*                     SUB-CLASS, WHEN NEEDED AND WRITE OUT THE    00140081
001230*                     RECORDS TO THE OUTPUT FILE.  IT WILL ALSO   00150081
001240*                     CREATE A REPORT OF CHANGES TO SUB-CLASS     00160099
001250*                     AND SKU, PLUS TOTALS FOR EACH RETURN TYPE   00170099
001260*                     AND A GRAND TOTAL.                          00171099
      *--------------------------------------------------------------*  00180099
      * HISTORY LOG:                                                    00190099
W40134*--------------------------------------------------------------*  00200099
W40134* DATE:        2011/10/30                                         00210099
W40134* PROJ#:       3219  GENCO/RTV UPGRADE PROJECT                    00220099
W40134* WR/IR#:      WR40134                                            00221099
W40134* PROGRAMMER:  STEVE ANDERSON - CODEWORKS                         00230099
W40134* DESCRIPTION: USING NEW RV022-RTV-LOC LOCATION, SELECT FROM      00240099
W40134*              XLT_LOC TABLE TO GET LOC_NBR AND LOC_10_ABBR_NM    00250099
W40134*              TO ADD TO NEW SUB-HEADER ON REPORT.                00260099
W40134*            : ALSO "CHANGE BILL OF LADING" COLUMN HEADER TO      00261099
W40134*              "SLOT BY".                                         00262099
W40134*--------------------------------------------------------------*  00270099
001300******************************************************************00280000
018800 ENVIRONMENT DIVISION.                                            00290000
018900******************************************************************00300000
019000                                                                  00310000
019100 CONFIGURATION SECTION.                                           00320000
019200                                                                  00330000
019300 SOURCE-COMPUTER.        IBM-3090.                                00340000
019400 OBJECT-COMPUTER.        IBM-3090.                                00350000
019500                                                                  00360000
019600 INPUT-OUTPUT SECTION.                                            00370000
019700                                                                  00380000
019800 FILE-CONTROL.                                                    00390000
019900                                                                  00400000
020000     SELECT RVK-DTL-FILE                                          00410081
020100         ASSIGN TO INP01.                                         00420000
020200                                                                  00430000
020510     SELECT RVK-NEW-DTL-FILE                                      00440081
020520         ASSIGN TO OUT01.                                         00450001
020530                                                                  00460001
020540     SELECT ERROR-REPORT                                          00470044
020550         ASSIGN TO RPT01.                                         00480044
020600******************************************************************00490000
020700 DATA DIVISION.                                                   00500000
020800******************************************************************00510000
020900                                                                  00520000
021000 FILE SECTION.                                                    00530000
021100                                                                  00540000
021900 FD  RVK-DTL-FILE                                                 00550081
022000     RECORDING MODE IS F                                          00560000
022100     LABEL RECORDS ARE STANDARD                                   00570000
022200     BLOCK CONTAINS 0 RECORDS.                                    00580000
022300                                                                  00590000
022400 01  RVK-DTL-RECORD                   PIC X(189).                 00600099
022401                                                                  00610001
022410 FD  RVK-NEW-DTL-FILE                                             00620081
022420     RECORDING MODE IS F                                          00630001
022430     LABEL RECORDS ARE STANDARD                                   00640001
022440     BLOCK CONTAINS 0 RECORDS.                                    00650001
022450                                                                  00660001
022460 01  RVK-NEW-DTL-RECORD               PIC X(200).                 00670099
022470                                                                  00680001
022480 FD  ERROR-REPORT                                                 00690044
022490     RECORDING MODE IS F                                          00700042
022491     LABEL RECORDS ARE STANDARD                                   00710042
022492     BLOCK CONTAINS 0 RECORDS.                                    00720042
022493                                                                  00730042
022494 01  ERROR-RPT-RECORD                 PIC X(132).                 00740042
022500******************************************************************00750000
022600 WORKING-STORAGE SECTION.                                         00760000
022700******************************************************************00770000
022800                                                                  00780000
037800******************************************************************00790000
037900* INPUT LAYOUT - RV022-INVENTORY-DETAIL-INPUT-RECORD.             00800081
038000******************************************************************00810000
038100     COPY RVRD022.                                                00820081
038200                                                                  00830000
038201******************************************************************00840099
038202* OUTPUT LAYOUT - RV023-INVENTORY-DETAIL-OUTPUT-RECORD.           00850081
038203******************************************************************00860081
038204     COPY RVRD023.                                                00870081
038205                                                                  00880081
038210***  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT               00890042
038220     COPY DPWS132.                                                00900042
038230                                                                  00910042
038300******************************************************************00920017
038400*  DB2 TABLE DECLARATION                                          00930017
038500*  (XLT_SKU - LOGISTICS SKU TABLE)                                00940017
038600******************************************************************00950017
038700     EXEC SQL                                                     00960017
038800         INCLUDE XLT00003                                         00970017
038900     END-EXEC.                                                    00980017
039000                                                                  00990017
039100******************************************************************01000017
039300*  DB2 TABLE DECLARATION                                          01010017
039400*  (XLT_SUB_CL - LOGISTICS SUB CLASS TABLE)                       01020017
039500******************************************************************01030017
039600     EXEC SQL                                                     01040017
039700         INCLUDE XLT00023                                         01050017
039800     END-EXEC.                                                    01060017
039801                                                                  01070017
W40134******************************************************************01071199
W40134*  DB2 TABLE DECLARATION                                          01072099
W40134*  (XLT_LOC    - LOGISTICS LOCATION TABLE)                        01073099
W40134******************************************************************01074099
W40134     EXEC SQL                                                     01075099
W40134         INCLUDE XLT00010                                         01076099
W40134     END-EXEC.                                                    01077099
W40134                                                                  01078099
039810******************************************************************01080017
039820*  COMMUNICATIONS AREA FOR DB2                                    01090017
039830******************************************************************01100017
039840     EXEC SQL                                                     01110017
039850         INCLUDE SQLCA                                            01120017
039860     END-EXEC.                                                    01130017
039870                                                                  01140017
039871***********************************************************       01150081
039872*  COPYBOOK USED BY MBS SYSTEM                            *       01160081
039873***********************************************************       01170081
039874     COPY DPWS003.                                                01180099
039875*                                                                 01190081
039880******************************************************************01200017
039900*  DB2 FORMATTED MESSAGE AREA                                     01210000
040000******************************************************************01220000
040100     COPY DPWS004.                                                01230000
041700                                                                  01240000
041750                                                                  01250019
041800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01260000
041900                                                   COMP SYNC.     01270000
041910 01  DK-DB2-KEYS.                                                 01280017
041920     05  DK-SKU-NBR                   PIC S9(08) VALUE +0 COMP-3. 01290017
W40134     05  DK-LOC-NBR                   PIC S9(04) VALUE +0 COMP.   01291099
041930                                                                  01300017
041940***  PROGRAM ACCUMULATORS                                         01310042
042000 01  PA-PROGRAM-ACCUMULATORS.                                     01320000
042100     05  PA-TOTALS.                                               01330000
042200         10 PA-TOT-RECS-READ          PIC S9(09) VALUE +0 COMP-3. 01340000
042300         10 PA-TOT-HDR-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 01350000
042400         10 PA-TOT-DTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 01360000
043500         10 PA-TOT-DTL-WRITTEN        PIC S9(09) VALUE +0 COMP-3. 01370004
043501                                                                  01380043
043510***  QTY COUNTS                                                   01390045
043511         10 PA-R-TQTY                 PIC 9(09)  VALUE ZERO.      01400045
043512         10 PA-M-TQTY                 PIC 9(09)  VALUE ZERO.      01410045
043513         10 PA-D-TQTY                 PIC 9(09)  VALUE ZERO.      01420045
043514         10 PA-C-TQTY                 PIC 9(09)  VALUE ZERO.      01430081
043515                                                                  01440045
043520***  TYPE RTV TOTALS                                              01450081
043600         10 PA-R-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 01460073
043700         10 PA-R-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 01470073
043711                                                                  01480043
043720***  TYPE MOS TOTALS                                              01490044
043800         10 PA-M-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 01500073
043900         10 PA-M-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 01510073
043911                                                                  01520043
043920***  TYPE D&D TOTALS                                              01530044
044000         10 PA-D-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 01540073
044100         10 PA-D-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 01550073
044700                                                                  01560000
044701***  TYPE CALLBACK TOTALS                                         01570081
044702         10 PA-C-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 01580081
044703         10 PA-C-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 01590081
044704                                                                  01600081
044705***  TYPE FINAL TOTALS                                            01610048
044706         10 PA-FINAL-QTY           PIC 9(09)  VALUE ZERO.         01620073
044707         10 PA-FINAL-UNIT-AMT      PIC S9(09)V99 VALUE +0 COMP-3. 01630073
044708         10 PA-FINAL-RETAIL-AMT    PIC S9(09)V99 VALUE +0 COMP-3. 01640073
044709                                                                  01650048
044710***  PROGRAM SWITCHES                                             01660042
044800 01  PS-PROGRAM-SWITCHES.                                         01670042
045200     05  PS-END-OF-HDR-INPUT-SW        PIC  X(01)    VALUE 'N'.   01680000
045300         88  PS-END-OF-HDR-INPUT-YES                 VALUE 'Y'.   01690000
045400         88  PS-END-OF-HDR-INPUT-NO                  VALUE 'N'.   01700000
045500     05  PS-END-OF-DTL-INPUT-SW        PIC  X(01)    VALUE 'N'.   01710000
045600         88  PS-END-OF-DTL-INPUT-YES                 VALUE 'Y'.   01720000
045700         88  PS-END-OF-DTL-INPUT-NO                  VALUE 'N'.   01730000
045800     05  PS-ERROR-SW                   PIC  X(01)    VALUE 'N'.   01740045
045900         88  PS-ERROR-YES                            VALUE 'Y'.   01750045
046000         88  PS-ERROR-NO                             VALUE 'N'.   01760045
046100     05  PS-SUBCL-SW                   PIC  X(01)    VALUE 'N'.   01770077
046200         88  PS-SUBCL-FOUND                          VALUE 'Y'.   01780077
046300         88  PS-SUBCL-NOT-FOUND                      VALUE 'N'.   01790077
062270                                                                  01800067
062300***  PROGRAM CONSTANTS                                            01810042
062410 01  PC-PROGRAM-CONSTANTS.                                        01820042
062420     05  PC-MAX-REPORT-LINES         PIC 9(02)  VALUE 55.         01830042
062500     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'RVKUT028'. 01840081
066000     05  PC-SPACE                    PIC X(01)  VALUE ' '.        01850000
066100*    05  PC-UNIT-AMT                 PIC Z,ZZZ,ZZ9.99.            01860053
066200*    05  PC-RETAIL-AMT               PIC Z,ZZZ,ZZ9.99.            01870053
066210     05  PC-REC-TYPE-2               PIC X(01) VALUE '2'.         01880089
066220     05  PC-REC-TYPE-9               PIC X(01) VALUE '9'.         01890089
066300     05  PC-R-TYPE                   PIC X(01) VALUE 'R'.         01900045
066400     05  PC-M-TYPE                   PIC X(01) VALUE 'M'.         01910045
066500     05  PC-D-TYPE                   PIC X(01) VALUE 'D'.         01920045
066501     05  PC-C-TYPE                   PIC X(01) VALUE 'C'.         01930081
066510     05  PC-RTV                      PIC X(08) VALUE 'RTV     '.  01940083
066520     05  PC-MOS                      PIC X(08) VALUE 'MOS     '.  01950083
066530     05  PC-DAD                      PIC X(08) VALUE 'D&D     '.  01960083
066540     05  PC-CBK                      PIC X(08) VALUE 'CALLBACK'.  01970081
066600                                                                  01980000
066604     05 PC-PROGRAM-NAME               PIC X(08) VALUE 'RVKUT028'. 01990094
066606     05  PC-MPS-PROGRAM-NAME         PIC  X(08)    VALUE          02000094
066607         'DPKUT039'.                                              02010094
066608     05  PC-CURRENT-OPERATING-COMPANY                             02020094
066609                                     PIC  X(02)    VALUE '03'.    02030094
066610     05  PC-SYSTEM-CODE              PIC  X(02)    VALUE 'MP'.    02040094
066611     05  PC-SYSTEM-DATE              PIC  9(06)    VALUE ZERO.    02050094
066612                                                                  02060094
066613                                                                  02070081
066614                                                                  02080081
066615                                                                  02090081
066620***  PROGRAM VARIABLES                                            02100042
066700 01  PV-PROGRAM-VARIABLES.                                        02110017
066810                                                                  02120017
066811     05  PV-BOL-A                    PIC X(15).                   02130099
066812     05  PV-BOL-N REDEFINES PV-BOL-A                              02140099
066813                                     PIC 9(15).                   02150099
066814                                                                  02160099
066815     05  PV-DISPLAY-RECORD           PIC ZZ,ZZZ,ZZ9-.             02170099
066820     05  PV-PAGE-COUNT               PIC 9(05) VALUE 0.           02180042
066821     05  PV-REPT-LINE-COUNT          PIC 9(02) VALUE 0.           02190042
066822     05  PV-REC-WRITTEN              PIC 9(09) VALUE 0.           02200050
066830                                                                  02210050
066900     05  PV-SKU-REDEFINE.                                         02220017
067000         10  PV-INPUT-SKU-DEPT       PIC X(03) VALUE SPACE.       02230017
067100         10  PV-INPUT-SKU-CLASS      PIC X(02) VALUE SPACE.       02240017
067200         10  PV-INPUT-SKU-SEQ        PIC X(03) VALUE SPACE.       02250017
067400                                                                  02260017
067500     05  PV-SUBCLASS-REDEFINE.                                    02270017
067600         10  PV-INPUT-SUBCLASS-PADDING PIC X(02) VALUE SPACE.     02280017
067700         10  PV-INPUT-SUBCLASS         PIC X(02) VALUE SPACE.     02290099
067800         10  PV-INPUT-SUBCLASS-FILLER  PIC X(06) VALUE SPACE.     02300017
067900                                                                  02310017
068000     05  PV-DEPT-REDEFINE.                                        02320017
068100         10  PV-INPUT-DEPT-PADDING   PIC X(01) VALUE SPACE.       02330017
068200         10  PV-INPUT-DEPT           PIC X(03) VALUE SPACE.       02340017
068300         10  PV-INPUT-DEPT-FILLER    PIC X(06) VALUE SPACE.       02350017
068400                                                                  02360017
068410     05  PV-INPUT-DEPT-9            PIC 9(03) VALUE ZERO.         02370019
068420     05  PV-INPUT-SUBCLASS-9        PIC 9(02) VALUE ZERO.         02380019
068430     05  PV-INPUT-DEPT-COMP3        PIC S9(04) VALUE +0           02390019
068440                                               COMP-3.            02400019
068450     05  PV-INPUT-SUBCLASS-COMP3    PIC S9(04) VALUE +0           02410019
068460                                               COMP-3.            02420019
068470                                                                  02430019
068500     05  PV-INPUT-SUBCLASS-2.                                     02440018
068600         10  PV-INPUT-SUBCLASS-A    PIC X(01) VALUE SPACE.        02450018
068700         10  PV-INPUT-SUBCLASS-B    PIC X(01) VALUE SPACE.        02460018
068800                                                                  02470018
068900     05  PV-INPUT-SUBCLASS-OLD      PIC X(02) VALUE SPACE.        02480018
068910     05  PV-SAVE-SUB-CL             PIC X(02) VALUE SPACE.        02490087
068911                                                                  02500088
068920     05  PV-HOLD-SUB-CL             PIC X(02) VALUE SPACE.        02510088
068930     05  PV-HOLD-SKU                PIC X(08) VALUE SPACE.        02520088
069000                                                                  02530018
071800 01  PV-ABEND-VARIABLES.                                          02540000
W40134     05  PV-ABEND-LOC               PIC X(10)  VALUE SPACE.       02550099
071810     05  PV-ABEND-SKU               PIC X(10)  VALUE SPACE.       02551099
071820     05  PV-ABEND-BL-NBR            PIC X(15)  VALUE ZERO.        02560086
071821     05  PV-ABEND-DEPT              PIC X(10)  VALUE SPACE.       02570039
071830     05  PV-ABEND-SUBCL             PIC X(10)  VALUE SPACE.       02580039
071900     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.02590000
073300     05  PV-ERROR-MSG               PIC X(60)  VALUE SPACE.       02600023
073400     05  PV-PARAGRAPH               PIC X(30)  VALUE SPACE.       02610081
073500     05  PV-ABEND-MESSAGE           PIC X(30)  VALUE SPACE.       02620081
073600     05  PV-SQLCODE                 PIC S9(9)  VALUE ZEROES.      02630081
073800     05  PV-ABEND-TABLE-1           PIC X(20)  VALUE SPACES.      02640081
073810     05  PV-BUYER-NUMBER-HOLD       PIC X(32)  VALUE SPACE.       02650090
073820     05  PV-BUYER-NAME-HOLD         PIC X(46)  VALUE SPACE.       02660090
073830     05  PV-ABEND-STRUCTURE-1       PIC X(8)   VALUE SPACES.      02670097
073840     05  PV-ABEND-STRUCTURE-2       PIC X(8)   VALUE SPACES.      02680097
073850     05  PV-ABEND-STRUCTURE-3       PIC X(8)   VALUE SPACES.      02690097
073860     05  PV-ERROR-MESSAGE-1         PIC  X(60)  VALUE SPACES.     02700097
073870     05  PV-ERROR-MESSAGE-2         PIC  X(60)  VALUE SPACES.     02710097
073900                                                                  02720042
074000***  SYSTEM DATE VARIABLES                                        02730042
074100 01  SD-SYSTEM-DATE.                                              02740042
074200     05  SD-SYSTEM-CCYY              PIC  9(04)  VALUE ZEROS.     02750042
074300     05  SD-SYSTEM-MONTH             PIC  9(02)  VALUE ZEROS.     02760042
074400     05  SD-SYSTEM-DAY               PIC  9(02)  VALUE ZEROS.     02770042
074500                                                                  02780042
074510***  SYSTEM TIME VARIABLES                                        02790042
074520 01  ST-SYSTEM-TIME.                                              02800042
074530     05  ST-SYSTEM-HOUR              PIC  9(02)  VALUE ZEROS.     02810042
074540     05  ST-SYSTEM-MINUTE            PIC  9(02)  VALUE ZEROS.     02820042
074550                                                                  02830042
074600***  REPORT HEADING AND DETAIL LINES                              02840042
074700 01  PH2-PAGE-HEADING-2.                                          02850042
074800     05  FILLER                          PIC  X(40)  VALUE SPACE. 02860081
074900     05  FILLER                          PIC  X(47)  VALUE        02870081
075000         'SUB-CLASS/SKU CHANGES FOR GENCO INVENTORY FILE '.       02880081
075110     05  FILLER                          PIC  X(06)  VALUE        02890081
075120         'REPORT'.                                                02900081
075200                                                                  02910081
W40134  01 PH3-PAGE-HEADING-3.                                          02911099
W40134     05  FILLER                          PIC  X(17)  VALUE        02913199
W40134         '  RTV LOCATION:  '.                                     02914099
W40134     05  PH3-RTV-LOC                     PIC  X(06).              02916099
W40134     05  FILLER                          PIC  X(02)  VALUE SPACE. 02916199
W40134     05  PH3-RTV-NAME                    PIC  X(10).              02916299
W40134                                                                  02917099
075910 01  DH1-DETAIL-HEADING-1.                                        02920042
075920     05  FILLER                          PIC  X(03)  VALUE SPACE. 02930042
W40134     05  FILLER                          PIC  X(07)  VALUE SPACE. 02951099
075950     05  FILLER                          PIC  X(07)  VALUE SPACE. 02960081
075960     05  FILLER                          PIC  X(06)  VALUE        02970042
075970         'RETURN'.                                                02980042
075980     05  FILLER                          PIC  X(08)  VALUE SPACE. 02990081
075990     05  FILLER                          PIC  X(03)  VALUE        03000042
075991         'OLD'.                                                   03010042
075992     05  FILLER                          PIC  X(04)  VALUE SPACE. 03020081
075993     05  FILLER                          PIC  X(03)  VALUE        03030042
075994         'NEW'.                                                   03040042
075995     05  FILLER                          PIC  X(05)  VALUE SPACE. 03050081
075996     05  FILLER                          PIC  X(03)  VALUE        03060051
075997         'OLD'.                                                   03070050
075998     05  FILLER                          PIC  X(08)  VALUE SPACE. 03080081
075999     05  FILLER                          PIC  X(03)  VALUE        03090042
076000         'NEW'.                                                   03100042
076001     05  FILLER                          PIC  X(07)  VALUE SPACE. 03110081
076002     05  FILLER                          PIC  X(06)  VALUE        03120042
076003         'RETAIL'.                                                03130042
076004     05  FILLER                          PIC  X(12)  VALUE SPACE. 03140081
076005     05  FILLER                          PIC  X(04)  VALUE        03150042
076006         'COST'.                                                  03160042
076007     05  FILLER                          PIC  X(06)  VALUE SPACE. 03170081
076008     05  FILLER                          PIC  X(05)  VALUE        03180081
076009         'BUYER'.                                                 03190081
076010     05  FILLER                          PIC  X(13)  VALUE SPACE. 03200081
076011     05  FILLER                          PIC  X(05)  VALUE        03210081
076012         'BUYER'.                                                 03220081
076013                                                                  03230042
076014 01  DH2-DETAIL-HEADING-2.                                        03240042
076015     05  FILLER                          PIC  X(03)  VALUE SPACE. 03250081
W40134     05  FILLER                          PIC  X(07)  VALUE        03271099
W40134         'SLOT BY'.                                               03272099
W40134     05  FILLER                          PIC  X(08)  VALUE SPACE. 03281099
076019     05  FILLER                          PIC  X(04)  VALUE        03290082
076020         'TYPE'.                                                  03300082
076021     05  FILLER                          PIC  X(02)  VALUE SPACE. 03310082
076022     05  FILLER                          PIC  X(04)  VALUE        03320042
076023         'DEPT'.                                                  03330042
076024     05  FILLER                          PIC  X(02)  VALUE SPACE. 03340082
076025     05  FILLER                          PIC  X(06)  VALUE        03350042
076026         'SUB CL'.                                                03360042
076027     05  FILLER                          PIC  X(01)  VALUE SPACE. 03370082
076028     05  FILLER                          PIC  X(06)  VALUE        03380042
076029         'SUB CL'.                                                03390042
076030     05  FILLER                          PIC  X(03)  VALUE SPACE. 03400082
076031     05  FILLER                          PIC  X(03)  VALUE        03410042
076032         'SKU'.                                                   03420042
076033     05  FILLER                          PIC  X(08)  VALUE SPACE. 03430082
076034     05  FILLER                          PIC  X(03)  VALUE        03440042
076035         'SKU'.                                                   03450042
076036     05  FILLER                          PIC  X(07)  VALUE SPACE. 03460082
076037     05  FILLER                          PIC  X(06)  VALUE        03470042
076038         'AMOUNT'.                                                03480042
076039     05  FILLER                          PIC  X(11)  VALUE SPACE. 03490082
076040     05  FILLER                          PIC  X(06)  VALUE        03500042
076041         'AMOUNT'.                                                03510042
076042     05  FILLER                          PIC  X(05)  VALUE SPACE. 03520082
076043     05  FILLER                          PIC  X(06)  VALUE        03530082
076044         'NUMBER'.                                                03540082
076045     05  FILLER                          PIC  X(13)  VALUE SPACE. 03550082
076046     05  FILLER                          PIC  X(04)  VALUE        03560082
076047         'NAME'.                                                  03570082
076048                                                                  03580042
076049 01  DH3-DETAIL-HEADING-3.                                        03590042
076050     05  FILLER                          PIC  X(132) VALUE        03600042
076051                                                       ALL '-'.   03610042
076052 01  DL1-DETAIL-LINE.                                             03620043
076053     05  FILLER                          PIC  X(03)  VALUE SPACE. 03630042
076054     05  DL1-BOL                         PIC  Z(14)9.             03640099
076055     05  FILLER                          PIC  X(02)  VALUE SPACE. 03650082
076056     05  DL1-RETURN-TYPE                 PIC  X(01).              03660042
076057     05  FILLER                          PIC  X(03)  VALUE SPACE. 03670082
076058     05  DL1-DEPT                        PIC  X(03).              03680045
076059     05  FILLER                          PIC  X(04)  VALUE SPACE. 03690045
076060     05  DL1-OLD-SUB-CL                  PIC  X(04).              03700082
076061     05  FILLER                          PIC  X(03)  VALUE SPACE. 03710082
076062     05  DL1-NEW-SUB-CL                  PIC  X(04).              03720082
076063     05  FILLER                          PIC  X(02)  VALUE SPACE. 03730045
076064     05  DL1-OLD-SKU                     PIC  X(08).              03740082
076065     05  FILLER                          PIC  X(02)  VALUE SPACE. 03750082
076066     05  DL1-NEW-SKU                     PIC  X(08).              03760082
076067     05  FILLER                          PIC  X(01)  VALUE SPACE. 03770082
076068     05  DL1-RETAIL-AMT                  PIC  ZZZ,ZZZ,ZZZ.99-.    03780042
076069     05  FILLER                          PIC  X(02)  VALUE SPACE. 03790082
076070     05  DL1-COST-AMT                    PIC  ZZZ,ZZZ,ZZZ.99-.    03800042
076071     05  FILLER                          PIC  X(01)  VALUE SPACE. 03810082
076072     05  DL1-BUYER-NBR                   PIC  X(03).              03820082
076073     05  FILLER                          PIC  X(01)  VALUE SPACE. 03830082
076074     05  DL1-BUYER-NAME                  PIC  X(32).              03840082
076080                                                                  03850042
076084 01  TL1-TOTAL-LINE-HDR.                                          03860042
076085     05  FILLER                          PIC  X(03)  VALUE SPACE. 03870051
076086     05  FILLER                          PIC  X(05)  VALUE        03880042
076087         'TOTAL'.                                                 03890042
076088     05  FILLER                          PIC  X(09)  VALUE SPACE. 03900082
076089     05  FILLER                          PIC  X(03)  VALUE        03910042
076110         'QTY'.                                                   03920042
076120     05  FILLER                          PIC  X(17)  VALUE SPACE. 03930082
076130     05  FILLER                          PIC  X(06)  VALUE        03940042
076140         'RETAIL'.                                                03950042
076150     05  FILLER                          PIC  X(12)  VALUE SPACE. 03960082
076151     05  FILLER                          PIC  X(04)  VALUE        03970042
076152         'COST'.                                                  03980042
076160                                                                  03990042
076161 01  TL2-TOTAL-LINE-DTL.                                          04000047
076162     05  FILLER                          PIC  X(03)  VALUE SPACE. 04010052
076163     05  TL2-TOT-TYPE                    PIC  X(08).              04020082
076164     05  FILLER                          PIC  X(02)  VALUE SPACE. 04030082
076165     05  TL2-QTY                         PIC  ZZZ,ZZZ,ZZ9.        04040042
076166     05  FILLER                          PIC  X(08)  VALUE SPACE. 04050042
076167     05  TL2-TOT-RETAIL                  PIC  ZZZ,ZZZ,ZZ9.99.     04060042
076168     05  FILLER                          PIC  X(04)  VALUE SPACE. 04070042
076169     05  TL2-TOT-COST                    PIC  ZZZ,ZZZ,ZZ9.99.     04080042
076170                                                                  04090042
076184                                                                  04100042
076185 01  FT3-FTOTAL-HEADING-3.                                        04110099
076186     05  FILLER                          PIC  X(65)  VALUE        04120099
076187                                                       ALL '-'.   04130099
076188 01  FT1-FTOTAL-LINE.                                             04140042
076189     05  FILLER                          PIC  X(03)  VALUE SPACE. 04150052
076190     05  FILLER                          PIC  X(06)  VALUE        04160050
076191         'FTOTAL'.                                                04170042
076192     05  FILLER                          PIC  X(04)  VALUE SPACE. 04180042
076193     05  FL1-QTY                         PIC  ZZZ,ZZZ,ZZ9.        04190042
076194     05  FILLER                          PIC  X(08)  VALUE SPACE. 04200042
076195     05  FL1-TOT-RETAIL                  PIC  ZZZ,ZZZ,ZZ9.99.     04210042
076196     05  FILLER                          PIC  X(04)  VALUE SPACE. 04220042
076197     05  FL1-TOT-COST                    PIC  ZZZ,ZZZ,ZZ9.99.     04230042
076198                                                                  04240042
076199 01  BLANK-LINE.                                                  04250042
076200     05  FILLER                          PIC  X(132) VALUE SPACE. 04260042
076201                                                                  04270042
076202 01  END-OF-REPORT-LINE.                                          04280042
076203     05  FILLER                          PIC  X(54)  VALUE SPACE. 04290042
076204     05  FILLER                          PIC  X(25)  VALUE        04300042
076205         '***** END OF REPORT *****'.                             04310042
076206     05  FILLER                          PIC  X(53)  VALUE SPACE. 04320042
076207                                                                  04330042
076208 01  PV-NO-ERROR-LINE.                                            04340042
076209     05  FILLER                          PIC  X(43)  VALUE SPACE. 04350042
076210     05  FILLER                          PIC  X(47)  VALUE        04360042
076211         '******** THERE ARE NO ERRORS TO REPORT ********'.       04370042
076212     05  FILLER                          PIC  X(42)  VALUE SPACE. 04380042
076213                                                                  04390042
076214******************************************************************04400000
076215 LINKAGE SECTION.                                                 04410000
076220******************************************************************04420000
076300                                                                  04430000
076400******************************************************************04440000
076500 PROCEDURE DIVISION.                                              04450000
076600******************************************************************04460000
076700******************************************************************04470000
076800*  MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.        04480099
076900******************************************************************04490000
077000 0000-PROGRAM-MAINLINE.                                           04500000
077100                                                                  04510000
077200     DISPLAY '************ START OF RVKUT028 ***************'     04520081
077300     PERFORM 1000-INITIALIZE.                                     04530000
077400                                                                  04540000
078100     IF PS-END-OF-DTL-INPUT-NO                                    04550002
079000        PERFORM 1200-CONTINUE-PROCESSING                          04560067
079100     ELSE                                                         04570000
079601        IF PS-END-OF-DTL-INPUT-YES                                04580002
079700           DISPLAY ' '                                            04590002
079800           DISPLAY '***** NO RECORDS ON DETAIL INPUT FILE ****'   04600003
079900           DISPLAY ' '                                            04610002
079910        END-IF                                                    04620002
080400        CLOSE RVK-DTL-FILE                                        04630083
080410              RVK-NEW-DTL-FILE                                    04640083
080500     END-IF.                                                      04650000
080600                                                                  04660000
080700     DISPLAY '************  END OF RVKUT028  ***************'     04670081
W40134     GOBACK.                                                      04680099
080900                                                                  04690000
081000******************************************************************04700000
081100* INITIALIZE VARIABLES.                                           04710000
081200* OPEN FILES.                                                     04720003
081500* DO A PRIME READ FOR THE DETAIL FILE                             04730082
081700******************************************************************04740000
081800 1000-INITIALIZE.                                                 04750000
081900                                                                  04760000
082000     INITIALIZE   PA-PROGRAM-ACCUMULATORS                         04770042
082100                  ERROR-RPT-RECORD.                               04780042
083500                                                                  04790008
083600     OPEN INPUT  RVK-DTL-FILE.                                    04800082
083701                                                                  04810001
083710     OPEN OUTPUT RVK-NEW-DTL-FILE                                 04820082
083720                 ERROR-REPORT.                                    04830042
083730                                                                  04840099
083800     ACCEPT PC-SYSTEM-DATE FROM DATE.                             04850099
083810                                                                  04860099
083900     MOVE FUNCTION CURRENT-DATE (1:8) TO SD-SYSTEM-DATE.          04870042
084000     MOVE FUNCTION CURRENT-DATE (9:6) TO ST-SYSTEM-TIME.          04880042
084100                                                                  04890042
084200     MOVE SD-SYSTEM-CCYY   TO DP132-RUN-YEAR.                     04900042
084300     MOVE SD-SYSTEM-MONTH  TO DP132-RUN-MONTH.                    04910042
084400     MOVE SD-SYSTEM-DAY    TO DP132-RUN-DAY.                      04920042
084500                                                                  04930042
084600     MOVE ST-SYSTEM-HOUR   TO DP132-RUN-HOUR.                     04940042
084700     MOVE ST-SYSTEM-MINUTE TO DP132-RUN-MINUTE.                   04950042
084800                                                                  04960042
084900     MOVE 'RVKUT028'       TO DP132-PROGRAM-NAME.                 04970082
085000     MOVE 1                TO DP132-REPORT-NUMBER.                04980042
085100                                                                  04990042
085110**#  PERFORM 4000-WRITE-PAGE-HEADING.                             05000099
085120                                                                  05010042
085500**PRIME READ OF DTL FILE                                          05020000
085600     PERFORM 6000-READ-RVK-DTL-FILE.                              05030082
085120                                                                  05030299
W40134     PERFORM 6060-VALIDATE-LOC.                                   05031099
085120                                                                  05031199
085110     PERFORM 4000-WRITE-PAGE-HEADING.                             05031299
085120                                                                  05031399
085700                                                                  05040000
091400******************************************************************05050000
091500* PERFORM MAIN LOOP UNTIL EOF                                     05060000
091600* EOJ TASKS                                                       05070000
091700******************************************************************05080000
091800 1200-CONTINUE-PROCESSING.                                        05090067
091900                                                                  05100000
092000*PROCESS INPUT FILES TO EOF                                       05110000
092100     PERFORM 2000-REWRITE-DTL-FILE                                05120001
092200       UNTIL PS-END-OF-DTL-INPUT-YES.                             05130015
092300                                                                  05140009
092400*END OF INPUT PROCESSING.                                         05150000
092401                                                                  05160004
092402*    COMPARE TOTAL DETAIL RECORDS READ AND WRITTEN                05170004
092403*    IF EQUAL THEN SUCCESSFUL EOJ                                 05180004
092404*    IF NOT - THEN SUCCESSFUL EOJ WITH RETURN CODE 4090           05190099
092405                                                                  05200004
092410     IF PA-TOT-DTL-RECS-READ = PA-TOT-DTL-WRITTEN                 05210004
092500         PERFORM 8000-EOJ-ROUTINE                                 05220004
092510     ELSE                                                         05230004
092520         MOVE 4090 TO RETURN-CODE                                 05240099
092530     END-IF.                                                      05250004
W40134     GOBACK.                                                      05260099
092600                                                                  05270004
092700******************************************************************05280000
094900** REWRITE THE DETAIL FILE                                        05290099
095000******************************************************************05300000
095100 2000-REWRITE-DTL-FILE.                                           05310001
095200                                                                  05320000
095300     IF RV022-RECORD-TYPE = PC-REC-TYPE-9                         05330086
095400         PERFORM 6000-READ-RVK-DTL-FILE                           05340090
095500     END-IF.                                                      05350086
095600                                                                  05360086
096833     SET PS-ERROR-NO        TO TRUE.                              05370085
096834     PERFORM 6200-GET-BUYER-NMBR.                                 05380085
096835     PERFORM 6050-VALIDATE-DEPT-SUBCL.                            05390085
096836     PERFORM 6055-VALIDATE-SKU.                                   05400085
096837     IF PS-ERROR-YES                                              05410085
096838        PERFORM 4400-BUILD-DETAIL-LINE                            05420085
096839        PERFORM 4100-WRITE-REPORT                                 05430085
096840     END-IF.                                                      05440085
096841                                                                  05450045
096843     PERFORM 7000-WRITE-NEW-DTL-FILE.                             05460085
096844     IF PS-END-OF-DTL-INPUT-NO                                    05470085
096845        PERFORM 6000-READ-RVK-DTL-FILE                            05480090
096846     END-IF.                                                      05490085
096860                                                                  05500004
096870******************************************************************05510042
096880*** WRITE THE PAGE HEADINGS.                                      05520099
096890***   - WRITE HEADING TO THE REPORT.                              05530042
096900***   - EXECUTES WHEN PAGE BREAK OCCURS.                          05540042
097000******************************************************************05550042
097100 4000-WRITE-PAGE-HEADING.                                         05560042
097200     ADD  1             TO PV-PAGE-COUNT.                         05570042
097300     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     05580042
097400                                                                  05590042
097500     WRITE ERROR-RPT-RECORD                                       05600042
097600         FROM DP132-STANDRD-HEADER-132-COLS                       05610042
097700         AFTER ADVANCING PAGE.                                    05620042
097800                                                                  05630042
097900     WRITE ERROR-RPT-RECORD                                       05640042
098000         FROM PH2-PAGE-HEADING-2                                  05650042
098100         AFTER ADVANCING 1 LINES.                                 05660042
098200                                                                  05670042
W40134     WRITE ERROR-RPT-RECORD                                       05671099
W40134         FROM PH3-PAGE-HEADING-3                                  05672099
W40134         AFTER ADVANCING 1 LINES.                                 05673099
W40134                                                                  05676099
099500     WRITE ERROR-RPT-RECORD                                       05680042
099600         FROM BLANK-LINE                                          05690042
099700         AFTER ADVANCING 1 LINES.                                 05700042
099800                                                                  05710042
099900     WRITE ERROR-RPT-RECORD                                       05720042
100000         FROM DH1-DETAIL-HEADING-1                                05730042
100100         AFTER ADVANCING 1 LINES.                                 05740042
100200                                                                  05750042
100300     WRITE ERROR-RPT-RECORD                                       05760042
100400         FROM DH2-DETAIL-HEADING-2                                05770042
100500         AFTER ADVANCING 1 LINES.                                 05780042
100600                                                                  05790042
100700     WRITE ERROR-RPT-RECORD                                       05800064
100800         FROM DH3-DETAIL-HEADING-3                                05810064
100900         AFTER ADVANCING 1 LINES.                                 05820064
101000                                                                  05830064
101100     WRITE ERROR-RPT-RECORD                                       05840042
101200         FROM BLANK-LINE                                          05850042
101300         AFTER ADVANCING 1 LINES.                                 05860042
101400                                                                  05870042
101500     MOVE  6 TO PV-REPT-LINE-COUNT.                               05880042
101600                                                                  05890042
102400                                                                  05900042
102500******************************************************************05910042
102600*** WRITE THE REPORT                                              05920099
102700***   - WRITE DETAIL LINES TO THE REPORT.                         05930042
102800******************************************************************05940042
102810                                                                  05950042
102900 4100-WRITE-REPORT.                                               05960047
103000     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 05970042
103100         PERFORM 4000-WRITE-PAGE-HEADING                          05980042
103200     END-IF.                                                      05990042
103300                                                                  06000042
103600     WRITE ERROR-RPT-RECORD                                       06010045
103700         FROM DL1-DETAIL-LINE                                     06020045
103800         AFTER ADVANCING 2 LINES.                                 06030047
105500     ADD 2 TO PV-REPT-LINE-COUNT                                  06040047
105510     ADD 1 TO PV-REC-WRITTEN.                                     06050045
105511                                                                  06060045
105520     INITIALIZE DL1-DETAIL-LINE.                                  06070045
108100                                                                  06080042
108110******************************************************************06090062
108120* BUILD DETAIL LINE                                               06100062
108130******************************************************************06110062
108140 4400-BUILD-DETAIL-LINE.                                          06120062
108150                                                                  06130085
108160     MOVE RV022-BL-NBR (24:15)       TO PV-BOL-A.                 06140099
108161     MOVE PV-BOL-N                   TO DL1-BOL.                  06150099
108170     MOVE RV022-RETURN-TYPE          TO DL1-RETURN-TYPE.          06160085
108180     MOVE RV022-DEPT-NBR             TO DL1-DEPT.                 06170085
108181     MOVE PV-BUYER-NUMBER-HOLD       TO DL1-BUYER-NBR.            06180085
108182     MOVE PV-BUYER-NAME-HOLD         TO DL1-BUYER-NAME.           06190085
108190                                                                  06200062
108191*** BUILD RTV $AMTS AND QTY'S                                     06210062
108192     IF RV022-RETURN-TYPE = PC-R-TYPE                             06220090
108193         ADD +1                      TO PA-R-TQTY                 06230062
108194         ADD +1                      TO PA-FINAL-QTY              06240062
108195         ADD  RV022-UNT-COST-AMT     TO PA-R-UNIT-TOTAL           06250090
108196                                        PA-FINAL-UNIT-AMT         06260062
108197         ADD  RV022-RTL-AMT          TO PA-R-RETAIL-TOTAL         06270090
108198                                        PA-FINAL-RETAIL-AMT       06280062
108199     END-IF.                                                      06290062
108200                                                                  06300062
108201*** BUILD MOS $AMTS AND QTY'S                                     06310062
108202     IF RV022-RETURN-TYPE = PC-M-TYPE                             06320090
108203         ADD +1                      TO PA-M-TQTY                 06330062
108204         ADD +1                      TO PA-FINAL-QTY              06340062
108205         ADD  RV022-UNT-COST-AMT     TO PA-M-UNIT-TOTAL           06350090
108206                                        PA-FINAL-UNIT-AMT         06360062
108207         ADD  RV022-RTL-AMT          TO PA-M-RETAIL-TOTAL         06370090
108208                                        PA-FINAL-RETAIL-AMT       06380062
108209     END-IF.                                                      06390062
108210                                                                  06400062
108211*** BUILD D&D $AMTS AND QTY'S                                     06410062
108212     IF RV022-RETURN-TYPE = PC-D-TYPE                             06420090
108213         ADD +1                      TO PA-D-TQTY                 06430062
108214         ADD +1                      TO PA-FINAL-QTY              06440062
108215         ADD  RV022-UNT-COST-AMT     TO PA-D-UNIT-TOTAL           06450090
108216                                        PA-FINAL-UNIT-AMT         06460062
108217         ADD  RV022-RTL-AMT          TO PA-D-RETAIL-TOTAL         06470090
108218                                        PA-FINAL-RETAIL-AMT       06480062
108219     END-IF.                                                      06490062
108220                                                                  06500062
108221*** BUILD CALLBACKS $AMTS AND QTY'S                               06510099
108222     IF RV022-RETURN-TYPE = PC-C-TYPE                             06520099
108223         ADD +1                      TO PA-C-TQTY                 06530099
108224         ADD +1                      TO PA-FINAL-QTY              06540099
108225         ADD  RV022-UNT-COST-AMT     TO PA-C-UNIT-TOTAL           06550099
108226                                        PA-FINAL-UNIT-AMT         06560099
108227         ADD  RV022-RTL-AMT          TO PA-C-RETAIL-TOTAL         06570099
108228                                        PA-FINAL-RETAIL-AMT       06580099
108229     END-IF.                                                      06590099
108230                                                                  06600099
108240******************************************************************06610047
108300*** WRITE THE FINAL TOTALS                                        06620099
108400***   - BUILD AND WRITE TOTALS AND FINAL TOTALS TO THE REPORT.    06630047
108500******************************************************************06640047
108600                                                                  06650047
108700 4500-WRITE-FINAL-TOTALS.                                         06660047
108701     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 06670048
108702         PERFORM 4000-WRITE-PAGE-HEADING                          06680048
108703     END-IF.                                                      06690048
108704                                                                  06700048
108710     WRITE ERROR-RPT-RECORD                                       06710048
108711         FROM TL1-TOTAL-LINE-HDR                                  06720048
108712         AFTER ADVANCING 4 LINES.                                 06730063
108713     ADD 4 TO PV-REPT-LINE-COUNT.                                 06740063
108714     ADD 1 TO PV-REC-WRITTEN.                                     06750048
108715                                                                  06760065
108716     WRITE ERROR-RPT-RECORD                                       06770065
108717         FROM DH3-DETAIL-HEADING-3                                06780065
108718         AFTER ADVANCING 1 LINES.                                 06790065
108719     ADD 1 TO PV-REPT-LINE-COUNT.                                 06800065
108721                                                                  06810048
108722*** BUILD AND PRINT RTV TOTALS                                    06820048
108723     MOVE PC-RTV                TO TL2-TOT-TYPE.                  06830048
108724     MOVE PA-R-TQTY             TO TL2-QTY.                       06840048
108730     MOVE PA-R-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                06850048
108740     MOVE PA-R-UNIT-TOTAL       TO TL2-TOT-COST.                  06860048
108750                                                                  06870048
108800     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 06880047
108900         PERFORM 4000-WRITE-PAGE-HEADING                          06890047
109000     END-IF.                                                      06900047
109100                                                                  06910047
109200     WRITE ERROR-RPT-RECORD                                       06920047
109300         FROM TL2-TOTAL-LINE-DTL                                  06930048
109400         AFTER ADVANCING 2 LINES.                                 06940061
109500     ADD 2 TO PV-REPT-LINE-COUNT                                  06950061
109600     ADD 1 TO PV-REC-WRITTEN.                                     06960047
109700                                                                  06970047
109800*** BUILD AND PRINT MOS TOTALS                                    06980048
109810     MOVE PC-MOS                TO TL2-TOT-TYPE.                  06990048
109820     MOVE PA-M-TQTY             TO TL2-QTY.                       07000048
109830     MOVE PA-M-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                07010048
109840     MOVE PA-M-UNIT-TOTAL       TO TL2-TOT-COST.                  07020048
109850                                                                  07030048
109860     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 07040048
109870         PERFORM 4000-WRITE-PAGE-HEADING                          07050048
109880     END-IF.                                                      07060048
109890                                                                  07070048
109891     WRITE ERROR-RPT-RECORD                                       07080048
109892         FROM TL2-TOTAL-LINE-DTL                                  07090048
109893         AFTER ADVANCING 2 LINES.                                 07100061
109894     ADD 2 TO PV-REPT-LINE-COUNT                                  07110061
109895     ADD 1 TO PV-REC-WRITTEN.                                     07120048
109900                                                                  07130047
110000*** BUILD AND PRINT D&D TOTALS                                    07140048
110100     MOVE PC-DAD                TO TL2-TOT-TYPE.                  07150048
110200     MOVE PA-D-TQTY             TO TL2-QTY.                       07160048
110300     MOVE PA-D-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                07170048
110400     MOVE PA-D-UNIT-TOTAL       TO TL2-TOT-COST.                  07180048
110500                                                                  07190048
110600     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 07200048
110700         PERFORM 4000-WRITE-PAGE-HEADING                          07210048
110800     END-IF.                                                      07220048
110900                                                                  07230048
111000     WRITE ERROR-RPT-RECORD                                       07240048
111100         FROM TL2-TOTAL-LINE-DTL                                  07250048
111200         AFTER ADVANCING 2 LINES.                                 07260048
111300     ADD 2 TO PV-REPT-LINE-COUNT                                  07270061
111400     ADD 1 TO PV-REC-WRITTEN.                                     07280048
111500                                                                  07290048
111510*** BUILD AND PRINT CALLBACK TOTALS                               07300099
111520     MOVE PC-CBK                TO TL2-TOT-TYPE.                  07310099
111530     MOVE PA-C-TQTY             TO TL2-QTY.                       07320099
111540     MOVE PA-C-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                07330099
111550     MOVE PA-C-UNIT-TOTAL       TO TL2-TOT-COST.                  07340099
111560                                                                  07350099
111570     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 07360099
111580         PERFORM 4000-WRITE-PAGE-HEADING                          07370099
111590     END-IF.                                                      07380099
111591                                                                  07390099
111592     WRITE ERROR-RPT-RECORD                                       07400099
111593         FROM TL2-TOTAL-LINE-DTL                                  07410099
111594         AFTER ADVANCING 2 LINES.                                 07420099
111595     ADD 2 TO PV-REPT-LINE-COUNT                                  07430099
111596     ADD 1 TO PV-REC-WRITTEN.                                     07440099
111597                                                                  07450099
111600*** BUILD AND PRINT FINAL TOTALS                                  07460048
111800     MOVE PA-FINAL-QTY          TO FL1-QTY.                       07470063
111900     MOVE PA-FINAL-RETAIL-AMT   TO FL1-TOT-RETAIL.                07480063
112000     MOVE PA-FINAL-UNIT-AMT     TO FL1-TOT-COST.                  07490063
112100                                                                  07500048
112200     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 07510048
112300         PERFORM 4000-WRITE-PAGE-HEADING                          07520048
112400     END-IF.                                                      07530048
112500                                                                  07540048
112510     WRITE ERROR-RPT-RECORD                                       07550099
112520         FROM FT3-FTOTAL-HEADING-3                                07560099
112530         AFTER ADVANCING 2 LINES.                                 07570099
112540     ADD 2 TO PV-REPT-LINE-COUNT.                                 07580099
112550                                                                  07590099
112600     WRITE ERROR-RPT-RECORD                                       07600048
112700         FROM FT1-FTOTAL-LINE                                     07610062
112800         AFTER ADVANCING 1 LINES.                                 07620099
112900     ADD 1 TO PV-REPT-LINE-COUNT                                  07630099
113000     ADD 1 TO PV-REC-WRITTEN.                                     07640048
113010                                                                  07650048
224900******************************************************************07660000
225000* READ THE RVK DETAIL FILE                                       *07670099
225100******************************************************************07680000
225200 6000-READ-RVK-DTL-FILE.                                          07690084
225300                                                                  07700000
225310     MOVE SPACE TO PV-HOLD-SUB-CL.                                07710088
225320     MOVE SPACE TO PV-HOLD-SKU.                                   07720088
225330                                                                  07730088
225400     READ RVK-DTL-FILE                                            07740090
225500         INTO RV022-INVENTORY-RECORD                              07750084
225600         AT END                                                   07760000
225700           SET PS-END-OF-DTL-INPUT-YES TO TRUE.                   07770000
225800                                                                  07780000
225900     IF (PS-END-OF-DTL-INPUT-NO AND                               07790095
225910         RV022-RECORD-TYPE = PC-REC-TYPE-2)                       07800095
226000        ADD +1  TO PA-TOT-DTL-RECS-READ                           07810089
226200     END-IF.                                                      07820000
226300                                                                  07830000
226400******************************************************************07840019
226500* VALIDATE DEPT AND SUB-CLASS                                    *07850019
226600******************************************************************07860019
226700 6050-VALIDATE-DEPT-SUBCL.                                        07870019
226800                                                                  07880019
226900     MOVE RV022-SUB-CL-NBR      TO PV-INPUT-SUBCLASS.             07890099
226910     MOVE RV022-SUB-CL-NBR      TO PV-INPUT-SUBCLASS-2.           07900087
227000     MOVE RV022-DEPT-NBR        TO PV-INPUT-DEPT-COMP3.           07910086
227001     MOVE RV022-DEPT-NBR        TO PV-INPUT-DEPT.                 07920086
227010     MOVE RV022-SKU             TO PV-SKU-REDEFINE.               07930086
227020     MOVE PV-INPUT-DEPT         TO PV-INPUT-DEPT-9.               07940031
227030     MOVE PV-INPUT-DEPT-9       TO PV-INPUT-DEPT-COMP3.           07950031
227100     MOVE PV-INPUT-SUBCLASS     TO PV-INPUT-SUBCLASS-9.           07960019
227200     MOVE PV-INPUT-SUBCLASS-9   TO PV-INPUT-SUBCLASS-COMP3.       07970019
227210     MOVE SPACE                 TO PV-SAVE-SUB-CL.                07980058
227220     SET PS-SUBCL-NOT-FOUND     TO TRUE.                          07990077
227300                                                                  08000019
227400     EXEC SQL                                                     08010019
227500       SELECT DEPT_NBR                                            08020019
227600             ,SUB_CL_NBR                                          08030019
227700       INTO   :XLT00023-DEPT-NBR                                  08040019
227800             ,:XLT00023-SUB-CL-NBR                                08050019
227900       FROM XLT_SUB_CL                                            08060024
228000         WHERE (DEPT_NBR      = :PV-INPUT-DEPT-COMP3              08070019
228100           AND  SUB_CL_NBR    = :PV-INPUT-SUBCLASS-COMP3)         08080019
228200     END-EXEC.                                                    08090019
228300                                                                  08100019
228400     EVALUATE TRUE                                                08110019
228500         WHEN SQLCODE = +0                                        08120019
228600         WHEN SQLCODE = -811                                      08130019
228610         SET PS-SUBCL-FOUND           TO TRUE                     08140077
228620         MOVE RV022-SUB-CL-NBR        TO DL1-OLD-SUB-CL           08150099
228630         MOVE RV022-SUB-CL-NBR        TO DL1-NEW-SUB-CL           08160099
228700             CONTINUE                                             08170019
228800         WHEN SQLCODE = +100                                      08180019
228801             SET PS-SUBCL-NOT-FOUND    TO TRUE                    08190077
228802             SET PS-ERROR-YES          TO TRUE                    08200077
228803             MOVE RV022-SUB-CL-NBR     TO PV-SAVE-SUB-CL          08210087
228804             MOVE RV022-SUB-CL-NBR     TO DL1-OLD-SUB-CL          08220090
228805             MOVE RV022-SUB-CL-NBR     TO PV-INPUT-SUBCLASS-2     08230086
228806*                       |                                         08240090
228807*            OLD INFORMATION ABOVE THIS POINT                     08250090
229200*            NEW INFORMATION BELOW THIS POINT                     08260090
229300*                       |                                         08270090
229600*                                                                 08280090
230000             MOVE ZERO                 TO PV-INPUT-SUBCLASS-B     08290019
230003             MOVE PV-INPUT-SUBCLASS-2  TO PV-HOLD-SUB-CL          08300088
230004             MOVE PV-INPUT-SUBCLASS-2  TO DL1-NEW-SUB-CL          08310087
230006             MOVE RV022-UNT-COST-AMT   TO DL1-COST-AMT            08320086
230007             MOVE RV022-RTL-AMT        TO DL1-RETAIL-AMT          08330086
230010                                                                  08340019
230620                                                                  08350019
230700         WHEN SQLWARN0 NOT EQUAL SPACE                            08360019
230800         WHEN SQLCODE NOT EQUAL ZERO                              08370019
230801                                                                  08380022
230810             DISPLAY '** ABEND **'                                08390022
230820             DISPLAY '** PROGRAM = RVKUT028 **'                   08400086
230830             DISPLAY '** PARAGRAPH = 6050-VALIDATE-DEPT-SUBCL'    08410022
230840             MOVE RV022-BL-NBR (14:15) TO PV-ABEND-BL-NBR         08420086
230850             MOVE RV022-SKU            TO PV-ABEND-SKU            08430086
230851             MOVE RV022-DEPT-NBR       TO PV-ABEND-DEPT           08440086
230852             MOVE RV022-SUB-CL-NBR     TO PV-ABEND-SUBCL          08450086
230853             MOVE SQLCODE              TO PV-SQLCODE              08460086
230854             MOVE '6050-VALIDATE-DEPT-SUBCL'                      08470039
230855                                       TO PV-PARAGRAPH            08480086
230856             MOVE 'SELECT DEPT SUBCL'  TO PV-ERROR-MSG            08490086
230860             MOVE 'XLT_SUB_CL'         TO PV-ABEND-TABLE-1        08500086
230870             PERFORM 9100-SQL-ERROR                               08510023
231500     END-EVALUATE.                                                08520019
231600                                                                  08530019
231700******************************************************************08540019
231800* VALIDATE THE SKU                                               *08550099
231900******************************************************************08560019
232000 6055-VALIDATE-SKU.                                               08570019
232100                                                                  08580019
232300     INITIALIZE DCLXLT00003.                                      08590019
232400     MOVE RV022-SKU         TO DK-SKU-NBR.                        08600086
232500                                                                  08610019
232600     EXEC SQL                                                     08620019
232700         SELECT SKU_NBR                                           08630025
232710           INTO :XLT00003-SKU-NBR                                 08640026
232800           FROM XLT_SKU                                           08650019
232900         WHERE SKU_NBR = :DK-SKU-NBR                              08660019
233000     END-EXEC.                                                    08670019
233100                                                                  08680019
233200     EVALUATE TRUE                                                08690019
233300         WHEN SQLCODE = +0                                        08700019
233310             MOVE RV022-SKU  TO DL1-OLD-SKU                       08710099
233320             MOVE RV022-SKU  TO DL1-NEW-SKU                       08720099
233400             CONTINUE                                             08730019
233500         WHEN SQLCODE = +100                                      08740019
233501*  CHECK FOR DUMMY SKU ON A NOT FOUND CONDITION                   08750078
233502*    IF SUB CLASS WAS FOUND ON TABLE AND                          08760080
233503*    SKU WAS NOT FOUND AND SKU WAS A DUMMY SKU                    08770080
233504*    THEN DO NOT PRINT SKU CHANGE REPORT                          08780080
233505*    BY SETTING PS-ERROR-NO TO TRUE                               08790078
233506             IF PS-SUBCL-FOUND AND RV022-SKU (6:3) = ZERO         08800087
233507                 SET PS-ERROR-NO       TO TRUE                    08810078
233508             ELSE                                                 08820079
233509*  OTHERWISE PRINT REPORT BY SETTING ON PS-ERROR-YES              08830080
233510                 SET PS-ERROR-YES          TO TRUE                08840080
233511                 IF PV-SAVE-SUB-CL = SPACE                        08850078
233512                   MOVE RV022-SUB-CL-NBR                          08860086
233513                                       TO DL1-OLD-SUB-CL          08870059
233514                 END-IF                                           08880078
233515                 MOVE RV022-SKU            TO PV-SKU-REDEFINE     08890090
233516                 MOVE RV022-SKU            TO DL1-OLD-SKU         08900086
233517                 MOVE RV022-UNT-COST-AMT   TO DL1-COST-AMT        08910086
233518                 MOVE RV022-RTL-AMT        TO DL1-RETAIL-AMT      08920086
233522*                                                                 08930090
233523*                       |                                         08940090
233524*            OLD INFORMATION ABOVE THIS POINT                     08950090
233525*            NEW INFORMATION BELOW THIS POINT                     08960090
233526*                       |                                         08970090
233527*                                                                 08980090
233528                 MOVE PV-INPUT-DEPT      TO PV-INPUT-SKU-DEPT     08990099
233538                 MOVE ZERO               TO PV-INPUT-SUBCLASS-B   09000078
233539                 MOVE PV-INPUT-SUBCLASS-2 TO DL1-NEW-SUB-CL       09010087
233540                 MOVE PV-INPUT-SUBCLASS-2 TO PV-INPUT-SKU-CLASS   09020087
233541                 MOVE ZERO               TO PV-INPUT-SKU-SEQ      09030078
233542                 MOVE PV-SKU-REDEFINE    TO PV-HOLD-SKU           09040088
233543                 MOVE PV-INPUT-SUBCLASS-2                         09050086
233544                                         TO RV023-SUB-CL-NBR      09060087
233545                 MOVE RV023-SUB-CL-NBR   TO DL1-NEW-SUB-CL        09070087
233546                 MOVE PV-HOLD-SKU        TO DL1-NEW-SKU           09080099
233565             END-IF                                               09090078
233566                                                                  09100032
233567         WHEN SQLWARN0 NOT EQUAL SPACE                            09110032
233568         WHEN SQLCODE NOT EQUAL ZERO                              09120032
233569                                                                  09130032
233570             DISPLAY '** ABEND **'                                09140032
233571             DISPLAY '** PROGRAM = RVKUT028 **'                   09150087
233572             DISPLAY '** PARAGRAPH = 6055-VALIDATE-SKU **'        09160099
233573             MOVE RV022-BL-NBR (14:15) TO PV-ABEND-BL-NBR         09170087
233574             MOVE RV022-SKU            TO PV-ABEND-SKU            09180090
233575             MOVE RV022-DEPT-NBR       TO PV-ABEND-DEPT           09190090
233576             MOVE RV022-SUB-CL-NBR     TO PV-ABEND-SUBCL          09200091
233577             MOVE SQLCODE              TO PV-SQLCODE              09210087
233578             MOVE '6055-VALIDATE-SKU'  TO PV-PARAGRAPH            09220099
233579             MOVE 'SELECT SKU'         TO PV-ERROR-MSG            09230099
233580             MOVE 'XLT_SKU'            TO PV-ABEND-TABLE-1        09240099
233581             PERFORM 9100-SQL-ERROR                               09250032
233590     END-EVALUATE.                                                09260023
233591                                                                  09270081
W40134******************************************************************09271099
W40134* VALIDATE THE LOCATION, MOVE LOC, NAME TO SUB HEADER            *09272099
W40134******************************************************************09273099
W40134  6060-VALIDATE-LOC.                                              09274099
W40134                                                                  09275099
W40134     INITIALIZE DCLXLT00010.                                      09276099
W40134     MOVE RV022-RTV-LOC     TO DK-LOC-NBR.                        09277099
W40134                                                                  09278099
W40134     EXEC SQL                                                     09279099
W40134         SELECT  LOC_NBR                                          09279199
W40134                ,LOC_10_ABBR_NM                                   09279299
W40134           INTO  :XLT00010-LOC-NBR                                09279399
W40134                ,:XLT00010-LOC-10-ABBR-NM                         09279499
W40134           FROM XLT_LOC                                           09279599
W40134         WHERE LOC_NBR = :DK-LOC-NBR                              09279699
W40134     END-EXEC.                                                    09279799
W40134                                                                  09279899
W40134     EVALUATE TRUE                                                09279999
W40134         WHEN SQLCODE = +0                                        09280099
W40134             MOVE XLT00010-LOC-NBR        TO PH3-RTV-LOC          09280399
W40134             MOVE XLT00010-LOC-10-ABBR-NM TO PH3-RTV-NAME         09280499
W40134             CONTINUE                                             09280599
W40134         WHEN SQLCODE = +100                                      09280699
W40134         WHEN SQLWARN0 NOT EQUAL SPACE                            09285999
W40134         WHEN SQLCODE  NOT EQUAL ZERO                             09286099
W40134             DISPLAY '** ABEND **'                                09286299
W40134             DISPLAY '** PROGRAM = RVKUT028 **'                   09286399
W40134             DISPLAY '** PARAGRAPH = 6060-VALIDATE-LOC'           09286499
W40134             MOVE RV022-RTV-LOC        TO PV-ABEND-LOC            09286599
W40134             MOVE RV022-BL-NBR (14:15) TO PV-ABEND-BL-NBR         09286699
W40134             MOVE RV022-SKU            TO PV-ABEND-SKU            09286799
W40134             MOVE RV022-DEPT-NBR       TO PV-ABEND-DEPT           09286899
W40134             MOVE RV022-SUB-CL-NBR     TO PV-ABEND-SUBCL          09286999
W40134             MOVE SQLCODE              TO PV-SQLCODE              09287099
W40134             MOVE '6060-VALIDATE-LOC'                             09287199
W40134                                       TO PV-PARAGRAPH            09287299
W40134             MOVE 'SELECT XLT LOC   '  TO PV-ERROR-MSG            09287399
W40134             MOVE 'XLT_LOC'            TO PV-ABEND-TABLE-1        09287499
W40134             PERFORM 9100-SQL-ERROR                               09287599
W40134     END-EVALUATE.                                                09287699
W40134                                                                  09287799
233595****************************************************************  09288099
233596*  GET THE BUYER NAME AND NUMBER INFORMATION FROM THE MBS         09290081
233597*  TABLES USING SUBROUTINE 'DPKUT039'.                            09300081
233598****************************************************************  09310081
233599 6200-GET-BUYER-NMBR.                                             09320081
233604     MOVE '6200-GET-BUYER-NMBR     '   TO PV-PARAGRAPH.           09330093
233606                                                                  09340081
233607     SET DP003-BYR-LOOKUP-NAME         TO TRUE.                   09350081
233608     MOVE SPACE                        TO DP003-DMM-LOOKUP-IND.   09360081
233610     MOVE RV022-DEPT-NBR               TO DP003-DPT-INPUT.        09370091
233620     MOVE PC-SYSTEM-CODE               TO DP003-SYSTEM-CODE.      09380081
233630     MOVE PC-CURRENT-OPERATING-COMPANY TO DP003-OP-CO-NMBR.       09390081
233640     MOVE PC-SYSTEM-DATE               TO DP003-CURRENT-DATE      09400081
233650                                          DP003-EFF-DATE.         09410081
233660     INITIALIZE                           DP003-RETURN-MSG.       09420081
233670*                                                                 09430081
233680     CALL PC-MPS-PROGRAM-NAME   USING DP003-MBS-SUBROUTINE-FIELDS.09440081
233690*                                                                 09450081
233691     EVALUATE TRUE                                                09460081
233692        WHEN DP003-SUCCESSFUL                                     09470081
233693           MOVE DP003-BYR-NMBR   TO PV-BUYER-NUMBER-HOLD          09480081
233694           MOVE DP003-BYR-NAME   TO PV-BUYER-NAME-HOLD            09490081
233695        WHEN DP003-BYR-NMBR-NOT-FOUND                             09500081
233696           INITIALIZE  PV-BUYER-NUMBER-HOLD                       09510081
233697           INITIALIZE  PV-BUYER-NAME-HOLD                         09520081
233698           MOVE 'BUYER NMBR NOT FOUND' TO PV-BUYER-NAME-HOLD      09530081
233699        WHEN DP003-BYR-NAME-NOT-FOUND                             09540081
233700           INITIALIZE  PV-BUYER-NUMBER-HOLD                       09550081
233710           INITIALIZE  PV-BUYER-NAME-HOLD                         09560081
233721           MOVE 'MISCELLANEOUS'        TO PV-BUYER-NAME-HOLD      09570099
233722           MOVE '099'                  TO PV-BUYER-NUMBER-HOLD    09580099
233730        WHEN DP003-BYR-NMBR-DB2-ERROR                             09590081
233740           MOVE DP003-RETURN-MSG TO PV-ABEND-STRUCTURE-1          09600081
233750           MOVE 'CURRENT DEPARTMENT BEING PROCESSED IS: '         09610081
233760                                 TO PV-ABEND-STRUCTURE-2          09620081
233770           MOVE DP003-DPT-INPUT  TO PV-ABEND-STRUCTURE-3          09630081
233780           MOVE DP003-SQLCA      TO SQLCA                         09640081
233790           PERFORM 9100-SQL-ERROR                                 09650098
233791        WHEN DP003-BYR-NAME-DB2-ERROR                             09660081
233792           MOVE DP003-RETURN-MSG TO PV-ABEND-STRUCTURE-1          09670081
233793           MOVE 'CURRENT DEPARTMENT BEING PROCESSED IS: '         09680081
233794                                 TO PV-ABEND-STRUCTURE-2          09690081
233795           MOVE DP003-DPT-INPUT  TO PV-ABEND-STRUCTURE-3          09700081
233796           MOVE DP003-SQLCA      TO SQLCA                         09710081
233797           PERFORM 9100-SQL-ERROR                                 09720098
233798        WHEN DP003-BYR-NMBR-MAX-RETRIES                           09730081
233799           MOVE DP003-RETURN-MSG TO PV-ABEND-STRUCTURE-1          09740081
233800           MOVE 'CURRENT DEPARTMENT BEING PROCESSED IS: '         09750081
233810                                 TO PV-ABEND-STRUCTURE-2          09760081
233820           MOVE DP003-DPT-INPUT  TO PV-ABEND-STRUCTURE-3          09770081
233830           MOVE DP003-SQLCA      TO SQLCA                         09780081
233840           PERFORM 9100-SQL-ERROR                                 09790098
233850        WHEN DP003-BYR-NAME-MAX-RETRIES                           09800081
233860           MOVE DP003-RETURN-MSG TO PV-ABEND-STRUCTURE-1          09810081
233870           MOVE 'CURRENT DEPARTMENT BEING PROCESSED IS: '         09820081
233880                                 TO PV-ABEND-STRUCTURE-2          09830081
233890           MOVE DP003-DPT-INPUT  TO PV-ABEND-STRUCTURE-3          09840081
233891           MOVE DP003-SQLCA      TO SQLCA                         09850081
233892           PERFORM 9100-SQL-ERROR                                 09860098
233893        WHEN DP003-NO-INPUT-SELECTION                             09870081
233894           MOVE 'CURRENT INPUT FIELDS ARE: '                      09880081
233895                                 TO PV-ERROR-MESSAGE-1            09890081
233896           MOVE DP003-INPUT-FIELDS                                09900081
233897                                 TO PV-ERROR-MESSAGE-2            09910081
233898           PERFORM 9300-ABEND                                     09920097
233899        WHEN DP003-SYSTEM-CODE-ERROR                              09930081
233900           MOVE 'THE SYSTEM CODE IS: '                            09940081
233910                                 TO PV-ERROR-MESSAGE-1            09950081
233920           MOVE DP003-SYSTEM-CODE                                 09960081
233930                                 TO PV-ERROR-MESSAGE-2            09970081
233940           PERFORM 9300-ABEND                                     09980097
233950        WHEN DP003-CURRENT-DATE-ERROR                             09990081
233960           MOVE 'THE CURRENT DATE USED IS:'                       10000081
233970                                 TO PV-ERROR-MESSAGE-1            10010081
233980           MOVE DP003-CURRENT-DATE                                10020081
233990                                 TO PV-ERROR-MESSAGE-2            10030081
233991           PERFORM 9300-ABEND                                     10040097
233992        WHEN DP003-EFF-DATE-ERROR                                 10050081
233993           MOVE 'THE EFFECTIVE DATE USED IS:'                     10060081
233994                                 TO PV-ERROR-MESSAGE-1            10070081
233995           MOVE DP003-EFF-DATE   TO PV-ERROR-MESSAGE-2            10080081
233996           PERFORM 9300-ABEND                                     10090097
233997        WHEN DP003-DPT-MUST-BE-NUMERIC                            10100081
233998           MOVE 'CURRENT DEPARTMENT BEING PROCESSED IS: '         10110081
233999                                 TO PV-ERROR-MESSAGE-1            10120081
234000           MOVE DP003-DPT-INPUT  TO PV-ERROR-MESSAGE-2            10130081
234010           PERFORM 9300-ABEND                                     10140097
234020        WHEN OTHER                                                10150081
234030           MOVE 'ERROR UNIDENTIFIED -  CURRENT INPUT FIELDS ARE: '10160081
234040                                 TO PV-ERROR-MESSAGE-1            10170081
234050           MOVE DP003-INPUT-FIELDS                                10180081
234060                                 TO PV-ERROR-MESSAGE-2            10190081
234070           PERFORM 9300-ABEND                                     10200097
234080     END-EVALUATE.                                                10210081
234090                                                                  10220081
234100                                                                  10230019
260600******************************************************************10240019
260700* WRITE THE NEW DTL RECORD FROM THE ORIGINAL DTL RECORD           10250001
260710* (THE ONLY DIFFERENCE IS THAT THE NEW DTL RECORD WILL HAVE       10260085
260720*  THE BUYER NUMBER AND NAME AND ANY SUB-CLASS AND SKU CHANGES).  10270085
260800******************************************************************10280000
260900 7000-WRITE-NEW-DTL-FILE.                                         10290001
261000                                                                  10300085
261010     INITIALIZE RVK-NEW-DTL-RECORD.                               10310085
261012     MOVE RV022-BL-NBR         TO RV023-BL-NBR.                   10320087
261013     MOVE RV022-BL-STATUS      TO RV023-BL-STATUS.                10330085
261014                                                                  10340088
261015     IF PV-HOLD-SKU = SPACE                                       10350088
261016         MOVE RV022-SKU        TO RV023-SKU                       10360088
261017     ELSE                                                         10370088
261018         MOVE PV-HOLD-SKU      TO RV023-SKU                       10380088
261019     END-IF.                                                      10390088
261020                                                                  10400088
261021     IF PV-HOLD-SUB-CL = SPACE                                    10410088
261022         MOVE RV022-SUB-CL-NBR TO RV023-SUB-CL-NBR                10420088
261023     ELSE                                                         10430088
261024         MOVE PV-HOLD-SUB-CL   TO RV023-SUB-CL-NBR                10440088
261025     END-IF.                                                      10450088
261026                                                                  10460088
261027     MOVE RV022-DEPT-NBR       TO RV023-DEPT-NBR.                 10470088
261028     MOVE RV022-RETURN-TYPE    TO RV023-RETURN-TYPE.              10480085
261030     MOVE RV022-UNT-COST-AMT   TO RV023-UNT-COST-AMT.             10490085
261032     MOVE RV022-RTL-AMT        TO RV023-RTL-AMT.                  10500085
261034     MOVE RV022-UNT-QTY        TO RV023-UNT-QTY.                  10510085
261035     MOVE RV022-SCN-DATE       TO RV023-SCN-DATE.                 10520085
261036     MOVE RV022-LOC-ID         TO RV023-LOC-ID.                   10530085
261037     MOVE RV022-DISP           TO RV023-DISP.                     10540085
261038     MOVE RV022-PUT-AWAY-DATE  TO RV023-PUT-AWAY-DATE.            10550085
261039     MOVE RV022-TRNS-NBR-STR   TO RV023-TRNS-NBR-STR.             10560085
261040     MOVE RV022-TRNS-NBR       TO RV023-TRNS-NBR.                 10570085
261041     MOVE RV022-RTV-LOC        TO RV023-RTV-LOC.                  10580085
261042     MOVE PV-BUYER-NUMBER-HOLD TO RV023-BUYER-NBR.                10590085
261043     MOVE PV-BUYER-NAME-HOLD   TO RV023-BUYER-NAME.               10600085
261050                                                                  10610085
261100     WRITE RVK-NEW-DTL-RECORD                                     10620085
261200      FROM RV023-INVENTORY-RECORD.                                10630096
261300                                                                  10640001
261400     ADD +1 TO PA-TOT-DTL-WRITTEN.                                10650004
261500                                                                  10660001
353460******************************************************************10670045
353500* DISPLAY SUMMARY STATS AND CLOSE FILES.                          10680003
353800******************************************************************10690000
353900 8000-EOJ-ROUTINE.                                                10700000
354000      PERFORM 4500-WRITE-FINAL-TOTALS.                            10710051
355100                                                                  10720000
355300      CLOSE RVK-DTL-FILE                                          10730090
355310            RVK-NEW-DTL-FILE                                      10740090
355320            ERROR-REPORT.                                         10750045
355400                                                                  10760000
355500     DISPLAY '***********************************************'.   10770000
355600     DISPLAY '**    * RVKUT028 SUMMARY STATISTICS *        **'.   10780088
355700     DISPLAY '**                                           **'.   10790000
355800     DISPLAY '**  ---------------------------------        **'.   10800088
355900     DISPLAY '**  REFORMAT GENCO INVENTORY DTL FILE  **'.         10810088
356000     DISPLAY '**  ---------------------------------        **'.   10820088
356100     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         10830000
356500     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     10840000
356600     DISPLAY '** TOT DTL RECS WRITTEN:' PA-TOT-DTL-WRITTEN.       10850004
358900     DISPLAY '***********************************************'.   10860000
359000                                                                  10870000
359010******************************************************************10880021
359020* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *10890021
359030* ERROR OR WARNING CODE OCCURS.                                  *10900021
359040******************************************************************10910021
359090 9100-SQL-ERROR.                                                  10920023
359100     DISPLAY '************************************************'.  10930023
359200     DISPLAY '********** PROGRAM ABEND ***********************'.  10940023
359220     DISPLAY '*** DB2 ERROR '.                                    10950097
359221     MOVE SQLCODE TO PV-DISPLAY-RECORD                            10960099
359222     DISPLAY '*** SQLCODE   = ' PV-DISPLAY-RECORD .               10970099
359300     DISPLAY '** PROGRAM       : ' PC-CURRENT-PROGRAM-NAME.       10980023
359400     DISPLAY '** PARAGRAPH     : ' PV-PARAGRAPH.                  10990023
359500     DISPLAY '** TABLE         : ' PV-ABEND-TABLE-1.              11000023
359600     DISPLAY '** ERROR MESSAGE : ' PV-ERROR-MSG.                  11010023
359610     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             11020097
359620                                                                  11030097
359630     IF PV-ABEND-STRUCTURE-2 > SPACES                             11040097
359640         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          11050097
359650     END-IF.                                                      11060097
359700     DISPLAY '***********************************************'.   11070023
359800     MOVE +4013 TO PV-ABEND-CODE.                                 11080023
359900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11090023
360000                                                                  11100023
363600****************************************************************  11110000
363700** PERFORM NON SQL ABEND PROCESSING                               11120000
363800****************************************************************  11130000
363900 9200-NON-SQL-ABEND.                                              11140000
364000                                                                  11150000
364100     DISPLAY '************************************************'.  11160000
364200     DISPLAY '********** PROGRAM ABEND ***********************'.  11170005
364300     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          11180000
364700     DISPLAY '***********************************'.               11190000
364800     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               11200000
364810     DISPLAY '* DETAIL RECS READ DOES NOT MATCH *'.               11210008
364820     DISPLAY '* DETAIL RECS WRITTEN             *'.               11220008
364900     DISPLAY '***********************************'.               11230000
365000     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         11240000
365400     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     11250000
365500     DISPLAY '** TOT DTL RECS WRITTEN:' PA-TOT-DTL-WRITTEN.       11260004
366600     DISPLAY '***********************************************'.   11270000
366700     MOVE +4013 TO ABEND-CODE.                                    11280000
366800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11290000
366900                                                                  11300000
367000*                                                                 11310097
367010 9300-ABEND.                                                      11320097
367011******************************************************************11330097
367012*  PERFORMS A NON-SQL ABEND FOR THE BUYER NAME AND NUMBER         11340097
367013******************************************************************11350097
367014     DISPLAY '***************************'.                       11360097
367015     DISPLAY '**       ABEND           **'.                       11370097
367016     DISPLAY '**  IN PROGRAM RVKUT028  **'.                       11380097
367017     DISPLAY '***************************'.                       11390097
367018     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH.             11400099
367019     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         11410097
367020     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       11420097
367021     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       11430097
367022     DISPLAY '**  RV022-DEPT-NBR ** = ' RV022-DEPT-NBR.           11440097
367023                                                                  11450097
367024     MOVE +4014                  TO PV-ABEND-CODE.                11460097
367025     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11470097
367026*                                                                 11480097
367030******************************************************************11490000
367100*                       END OF PROGRAM                            11500000
367200******************************************************************11510000
