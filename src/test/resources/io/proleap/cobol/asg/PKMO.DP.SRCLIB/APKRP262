000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP262.                                        00020000
000300 AUTHOR.         P.THOMPSON, G&R.                                 00030000
000400 DATE-WRITTEN.   JUNE '94.                                        00040000
000500*************************************************************     00050000
000600*    COBOL 2                                                *     00060000
000700*                                                           *     00070000
000800*    OPEN INVOICE AGING REPORT                              *     00080007
000900*                                                           *     00090007
001000*   PROGRAM OVERVIEW:                                       *     00100000
001100*                                                           *     00110000
001200*     THIS PROGRAM CREATES THE INVOICE AGING REPORT FROM    *     00120000
001300*   A FLAT FILE.                                            *     00130000
001400*                                                           *     00140000
001500*   INPUT:                                                  *     00150000
001600*  1) OPEN-INVOICE-FILE                (APRD262)            *     00160007
001700*                                                           *     00170000
001800*   OUTPUT:                                                 *     00180000
001900*  1) MANUAL-FILE                      (DPWS150O)           *     00190007
002000*  2) EDI-FILE                         (DPWS150O)           *     00200007
002100*                                                           *     00210000
002200******************************************************************00220000
002300*   CHANGES:                                                     *00230000
002400*                                                                *00240000
002500*   08/22/97   THE WS ABEND-CODE AREA WAS REMOVED                *00250000
002600*                                                                *00260000
002700*   04/05/00   ADDED CODE THAT WILL ACCUMULATE THE NEW INTRANSIT *00270000
002800*              BY VENDOR/PO NUMBER AND PRINT OUT JUST ONE LINE   *00280000
002900*              OF DETAIL ON THE REPORT FOR EACH COMBINATION.     *00290000
003000*              THE INTRANSIT DATA THAT APPEARS WILL ONLY BE FOR  *00300000
003100*              DATA > 90 DAYS.  APPLIED CURRENT STANDARDS TO THE *00310000
003200*              FORMAT OF THE PROGRAM.  INCREASED THE SIZE OF THE *00320000
003300*              REPORT FROM 132 TO 150 CHARACTERS TO ALLOW FOR    *00330000
003400*              EXPANSION.                                        *00340000
003500*              CHANGED BY: MIKE BESKE            WR#: 20977      *00350000
003600*                                                                *00360000
003700*   04/08/00   CHANGED THE CODE SO THAT THE REPORT WILL BREAK    *00370002
003800*              ON VENDOR NAME INSTEAD OF VENDOR NUMBER.  THIS    *00380002
003900*              WAS AN ADDITIONAL REQUEST FROM SHERI SMITH FOR    *00390002
004000*              THIS WR #.                                        *00400002
004100*              CHANGED BY: MIKE BESKE            WR#: 20977      *00410002
004200*                                                                *00420002
004300* 11/17/00 - CHANGED THE RECORD LENGTH ON THE INPUT FILE         *00430003
004400*            FROM 77 TO 78.  CHANGED THE APRD262I COPYBOOK       *00440004
004500*            TO APRD262 AND RENAMED ALL FIELDS TO CONFORM        *00450004
004600*            TO CURRENT STANDARDS.  EXPANDED THE                 *00460004
004700*            DAYS-DELINQUENT FIELD FROM 3 TO 5 POSITIONS.        *00470004
004800*        BY: NANCY EILBES                      WR#: 20704        *00480004
004900*                                                                *00490006
005000* 02/27/01 - CHANGED THE RECORD LENGTH ON THE INPUT FILE         *00500006
005100*            FROM 78 TO 100.  MODIFIED THE WORKING STORAGE THAT  *00510006
005200*            IS USED TO REFORMAT THE DUE DATE FOR PRINTING -     *00520006
005300*            THE INPUT FORMAT OF THIS DATE WAS CHANGED TO        *00530006
005400*            CCYY-MM-DD.                                         *00540006
005500*        BY: NANCY EILBES                      WR#: 20704        *00550006
005600*                                                                *00560007
005700* 02/05/2003                                                     *00570007
005800*    CHANGE MADE: ARKPO PHASE3 PROJECT.                          *00580007
005900*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.          *00590007
006000*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK.        *00600007
006100*    UPDATED THE PRINT PO NBR TO BE Z(9) AND RENAMED IT TO       *00610007
006200*    MATCH THE COPYBOOK NAME (IE, -PO-NBR). REALIGNED THE        *00620007
006300*    PRINT HEADER BECAUSE OF THE INCREASED PO NBR.               *00630007
006400* MADE BY:  MIKE BESKE                          WR#: 23500       *00640007
006410*                                                                *00641017
006420* 06/12/2008                                                     *00642017
006430*    CHANGE MADE: MATCH BY DC PHASE 2 PROJECT.                   *00643018
006440*    REMOVED ALL REFERENCES TO REPORT2 SINCE THIS PROGRAM WILL   *00644018
006450*    ONLY GENERATE ONE REPORT.  ALSO, REMOVED ALL REFERENCES TO  *00645018
006460*    ENTRY-METHOD, PO-STATUS, AND HOLD-IND SINCE THESE HAVE BEEN *00646018
006470*    REMOVED FROM THE COPYBOOK APRD262.                          *00647018
006490* MADE BY:  ROLF NOHE                           WR#: 32804       *00649017
006491*                                                                *00649123
006492* 08/31/2021                                                     *00649223
006493*    CHANGE MADE: RECOMPILE FOR NEW VERSION OF APRD262           *00649323
006494* MADE BY:  JEAN KURK                       CHG0260549           *00649423
006495*                                                                *00649523
006496* 10/12/2023                                                     *00649623
006497*    CHANGE MADE: REPLACED RECEIVER STATUS COLUMN ON THE REPORT  *00649723
006498*    WITH RECEIVERS INCOMPLETE COLUMN.                           *00649823
006499* MADE BY:  NANCY EILBES                    CHG0294992           *00649923
006500******************************************************************00650000
006600/                                                                 00660000
006700 ENVIRONMENT DIVISION.                                            00670000
006800 CONFIGURATION SECTION.                                           00680000
006900 INPUT-OUTPUT SECTION.                                            00690000
007000 FILE-CONTROL.                                                    00700000
007100     SELECT OPEN-INVOICE-FILE ASSIGN TO UT-S-INP01.               00710000
007311     SELECT ALL-INVOICE-FILE  ASSIGN TO UT-S-OUT01.               00731109
007400/                                                                 00740000
007500 DATA DIVISION.                                                   00750000
007600 FILE SECTION.                                                    00760000
007700 FD  OPEN-INVOICE-FILE                                            00770000
007800     RECORDING MODE IS F                                          00780000
007900     LABEL RECORDS ARE STANDARD                                   00790000
008000     BLOCK CONTAINS 0 RECORDS                                     00800000
008100     DATA RECORD IS RECON-NOTICE-RECORD.                          00810000
008200 01  RECON-NOTICE-RECORD              PIC  X(100).                00820004
008300                                                                  00830000
008420 FD  ALL-INVOICE-FILE                                             00842009
008500     RECORDING MODE IS F                                          00850000
008600     LABEL RECORDS ARE STANDARD                                   00860000
008700     BLOCK CONTAINS 0 RECORDS                                     00870000
008800     DATA RECORD IS MANUAL-REC.                                   00880000
008910 01  ALL-INVOICE-REC                  PIC  X(150).                00891009
009000                                                                  00900000
009700/                                                                 00970000
009800 WORKING-STORAGE SECTION.                                         00980000
009900 01  PROGRAM-WORKAREA.                                            00990000
010000     05  FILLER                      PIC  X(30) VALUE             01000000
010100                                 '** BEGINING OF APKRP262 W/S **'.01010000
010200     05  PW-REPORT-NAME               PIC  X(08)    VALUE         01020000
010300                                      'APKRP262'.                 01030000
010400     05  PW-BREAK-COUNT               PIC  9(08)    VALUE ZEROES  01040000
010500                                                    COMP-3.       01050000
010600     05  PW-INTRANSIT-COUNT           PIC  9(08)    VALUE ZEROES  01060000
010700                                                    COMP-3.       01070000
010800     05  PW-LINE-COUNT                PIC  9(03)    VALUE 99      01080000
010900                                                    COMP-3.       01090000
011000     05  PW-PAGE-COUNT                PIC  9(05)    VALUE ZEROES  01100000
011100                                                    COMP-3.       01110000
011200     05  PW-INPUT-COUNT               PIC  9(08)    VALUE ZEROES  01120000
011300                                                    COMP-3.       01130000
011400     05  PW-MAX-LINES                 PIC  9(03)    VALUE 60      01140000
011500                                                    COMP-3.       01150000
011600     05  PW-DISPLAY-COUNT             PIC  9(08)    VALUE 0.      01160000
011700     05  PW-DISPLAY-INTRANSIT-COUNT   PIC  9(08)    VALUE 0.      01170000
011800     05  PW-GROSS-INVOICE-AMT         PIC  9(09)V99 VALUE ZERO    01180000
011900                                                    COMP-3.       01190000
012000     05  PW-UNDER30-AMT               PIC  9(09)V99 VALUE ZERO    01200000
012100                                                    COMP-3.       01210000
012200     05  PW-31-60-AMT                 PIC  9(09)V99 VALUE ZERO    01220000
012300                                                    COMP-3.       01230000
012400     05  PW-61-90-AMT                 PIC  9(09)V99 VALUE ZERO    01240000
012500                                                    COMP-3.       01250000
012600     05  PW-91-120-AMT                PIC  9(09)V99 VALUE ZERO    01260000
012700                                                    COMP-3.       01270000
012800     05  PW-OVER120-AMT               PIC  9(09)V99 VALUE ZERO    01280000
012900                                                    COMP-3.       01290000
013000     05  PW-NIR-UNJ-AMT               PIC  9(09)V99 VALUE ZERO    01300000
013100                                                    COMP-3.       01310000
013200     05  PW-TOT-GROSS-INVOICE-AMT     PIC  9(09)V99 VALUE ZERO    01320000
013300                                                    COMP-3.       01330000
013400     05  PW-TOT-UNDER30-AMT           PIC  9(09)V99 VALUE ZERO    01340000
013500                                                    COMP-3.       01350000
013600     05  PW-TOT-31-60-AMT             PIC  9(09)V99 VALUE ZERO    01360000
013700                                                    COMP-3.       01370000
013800     05  PW-TOT-61-90-AMT             PIC  9(09)V99 VALUE ZERO    01380000
013900                                                    COMP-3.       01390000
014000     05  PW-TOT-91-120-AMT            PIC  9(09)V99 VALUE ZERO    01400000
014100                                                    COMP-3.       01410000
014200     05  PW-TOT-OVER120-AMT           PIC  9(09)V99 VALUE ZERO    01420000
014300                                                    COMP-3.       01430000
014400     05  PW-TOT-NIR-UNJ-AMT           PIC  9(09)V99 VALUE ZERO    01440000
014500                                                    COMP-3.       01450000
014600     05  PV-NIR-UNJ-AMT               PIC  9(09)V99 VALUE ZERO    01460000
014700                                                    COMP-3.       01470000
014800                                                                  01480000
014900     05  PW-SAVE-ENTRY-METHOD         PIC  X(01)    VALUE SPACE.  01490000
015000     05  PW-SAVE-VENDOR-NUMBER        PIC  9(09)    VALUE ZERO.   01500000
015100     05  PW-SAVE-VENDOR-NAME          PIC  X(15)    VALUE SPACES. 01510000
015200     05  PW-SAVE-INVOICE-NUMBER       PIC  X(22)    VALUE SPACES. 01520000
015300                                                                  01530000
015400 01  PROGRAM-SWITCHES.                                            01540000
015500     05  PW-END-PROCESSING-SW         PIC  X(01)    VALUE 'N'.    01550000
015600         88  END-OF-PROCESSING                      VALUE 'Y'.    01560000
015700     05  PS-FIRST-TIME-SW             PIC  X(01)    VALUE 'Y'.    01570000
015800         88  PS-FIRST-TIME                          VALUE 'Y'.    01580000
015900         88  PS-NOT-FIRST-TIME                      VALUE 'N'.    01590000
016000                                                                  01600000
016100 01  PW-CURRENT-DATE.                                             01610000
016200     05  PW-CURRENT-YEAR              PIC  9(02)    VALUE ZEROES. 01620000
016300     05  PW-CURRENT-MONTH             PIC  9(02)    VALUE ZEROES. 01630000
016400     05  PW-CURRENT-DAY               PIC  9(02)    VALUE ZEROES. 01640000
016500 01  PW-CURRENT-TIME.                                             01650000
016600     05  PW-CURRENT-HOUR              PIC  9(02)    VALUE ZEROES. 01660000
016700     05  PW-CURRENT-MINUTE            PIC  9(02)    VALUE ZEROES. 01670000
016800     05  FILLER                       PIC  9(02)    VALUE ZEROES. 01680000
016900 01  PW-DATE-BREAK-DOWN.                                          01690000
017000     05  PW-DATE-CC                   PIC  9(02)    VALUE ZEROES. 01700005
017100     05  PW-DATE-YY                   PIC  9(02)    VALUE ZEROES. 01710005
017200     05  PW-DASH-ONE                  PIC  X(01)    VALUE ZEROES. 01720005
017300     05  PW-DATE-MM                   PIC  9(02)    VALUE ZEROES. 01730000
017400     05  PW-DASH-TWO                  PIC  X(01)    VALUE ZEROES. 01740005
017500     05  PW-DATE-DD                   PIC  9(02)    VALUE ZEROES. 01750000
018100/                                                                 01810000
018200     COPY DPWS150O.                                               01820000
018300                                                                  01830000
018400 01  HDR-LINE-2.                                                  01840000
018501     05  FILLER                       PIC  X(66)   VALUE SPACES.  01850115
018600     05  FILLER                       PIC  X(18)  VALUE           01860015
018720         'ALL INVOICES AGING'.                                    01872008
018802     05  FILLER                       PIC  X(68)   VALUE SPACES.  01880208
019000                                                                  01900000
019100 01  HDR-LINE-3.                                                  01910000
019200     05  FILLER                       PIC  X(68)   VALUE SPACES.  01920000
019300     05  FILLER                       PIC  X(06)   VALUE 'AS OF '.01930000
019400     05  HDR-3-DATE                   PIC  X(08)   VALUE SPACES.  01940000
019500     05  FILLER                       PIC  X(68)   VALUE SPACES.  01950000
019600                                                                  01960000
019700 01  RPT-LINE-1.                                                  01970000
019701     05  FILLER                       PIC  X(147)   VALUE SPACES. 01970121
019702     05  FILLER                       PIC  X(03)    VALUE         01970221
019703                                      'RCV'.                      01970321
019710                                                                  01971021
019720 01  RPT-LINE-2.                                                  01972021
019800     05  FILLER                       PIC  X(10)    VALUE         01980007
019900                                      'P/O#'.                     01990000
020200     05  FILLER                       PIC  X(08)    VALUE         02020000
020300                                      'INVOICE#'.                 02030000
020401     05  FILLER                       PIC  X(12)    VALUE SPACES. 02040109
020500     05  FILLER                       PIC  X(04)    VALUE         02050000
020600                                      ' TYP'.                     02060000
020700     05  FILLER                       PIC  X(02)    VALUE         02070000
020800                                      ' S'.                       02080000
021001     05  FILLER                       PIC  X(05)    VALUE         02100109
021002                                      '  LVL'.                    02100209
021300     05  FILLER                       PIC  X(09)    VALUE         02130000
021400                                      ' DUE DATE'.                02140000
021500     05  FILLER                       PIC  X(14)    VALUE         02150000
021600                                      ' GROSS INVOICE'.           02160000
021700     05  FILLER                       PIC  X(01)    VALUE SPACES. 02170001
021800     05  FILLER                       PIC  X(13)    VALUE         02180000
021900                                      '    UNDER 30 '.            02190000
022000     05  FILLER                       PIC  X(01)    VALUE SPACES. 02200001
022100     05  FILLER                       PIC  X(13)    VALUE         02210000
022200                                      '     31 - 60 '.            02220000
022300     05  FILLER                       PIC  X(01)    VALUE SPACES. 02230001
022400     05  FILLER                       PIC  X(13)    VALUE         02240000
022500                                      '     61 - 90 '.            02250000
022600     05  FILLER                       PIC  X(01)    VALUE SPACES. 02260001
022700     05  FILLER                       PIC  X(13)    VALUE         02270000
022800                                      '     91 - 120'.            02280000
022900     05  FILLER                       PIC  X(01)    VALUE SPACES. 02290001
023000     05  FILLER                       PIC  X(13)    VALUE         02300000
023100                                      '     OVER 120'.            02310000
023200     05  FILLER                       PIC  X(13)    VALUE         02320000
023300                                      '     NIR/UNJ '.            02330000
023310     05  FILLER                       PIC  X(03)    VALUE         02331021
023320                                      'INC'.                      02332021
023400                                                                  02340000
023500 01  PRINT-VENDOR-HEADER.                                         02350000
023600     05  FILLER                       PIC  X(05)    VALUE SPACES. 02360000
023700     05  FILLER                       PIC  X(08)    VALUE         02370000
023800                                      'VENDOR# '.                 02380000
023900     05  PRINT-VENDOR-NUMBER          PIC  X(09).                 02390000
024000     05  FILLER                       PIC  X(16)    VALUE         02400000
024100                                      '   VENDOR NAME: '.         02410000
024200     05  PRINT-VENDOR-NAME            PIC  X(15).                 02420000
024300     05  FILLER                       PIC  X(97)    VALUE SPACES. 02430000
024400                                                                  02440000
024500 01  PRINT-LINE.                                                  02450000
024600     05  PRINT-PO-NBR                 PIC  Z(09).                 02460007
024700     05  FILLER                       PIC  X(01)    VALUE SPACES. 02470000
025000     05  PRINT-INVOICE-NUMBER         PIC  X(20).                 02500007
025100     05  FILLER                       PIC  X(01)    VALUE SPACES. 02510000
025200     05  PRINT-INVOICE-TYPE           PIC  X(02).                 02520000
025300     05  FILLER                       PIC  X(01)    VALUE SPACES. 02530000
025400     05  PRINT-INVOICE-STATUS         PIC  X(02).                 02540000
025701     05  FILLER                       PIC  X(03)    VALUE SPACES. 02570109
025702     05  PRINT-MTCH-LVL-CDE           PIC  X(01).                 02570210
025910     05  FILLER                       PIC  X(02)    VALUE SPACES. 02591021
026000     05  PRINT-DUE-DATE.                                          02600000
026100         10  PRINT-DUE-DATE-MM        PIC  X(02).                 02610000
026200         10  PRINT-DUE-DATE-1ST-DASH  PIC  X(01).                 02620000
026300         10  PRINT-DUE-DATE-DD        PIC  X(02).                 02630000
026400         10  PRINT-DUE-DATE-2ND-DASH  PIC  X(01).                 02640000
026500         10  PRINT-DUE-DATE-YY        PIC  X(02).                 02650000
026600     05  FILLER                       PIC  X(01)    VALUE SPACES. 02660000
026700     05  PRINT-GROSS-INVOICE-AMT      PIC  ZZ,ZZZ,ZZZ.ZZ          02670000
026800                                                    VALUE ZERO.   02680000
026900     05  FILLER                       PIC  X(01)    VALUE SPACES. 02690001
027000     05  PRINT-UNDER30-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          02700000
027100                                                    VALUE ZERO.   02710000
027200     05  FILLER                       PIC  X(01)    VALUE SPACES. 02720001
027300     05  PRINT-31-60-AMT              PIC  ZZ,ZZZ,ZZZ.ZZ          02730000
027400                                                    VALUE ZERO.   02740000
027500     05  FILLER                       PIC  X(01)    VALUE SPACES. 02750001
027600     05  PRINT-61-90-AMT              PIC  ZZ,ZZZ,ZZZ.ZZ          02760000
027700                                                    VALUE ZERO.   02770000
027800     05  FILLER                       PIC  X(01)    VALUE SPACES. 02780001
027900     05  PRINT-91-120-AMT             PIC  ZZ,ZZZ,ZZZ.ZZ          02790000
028000                                                    VALUE ZERO.   02800000
028100     05  FILLER                       PIC  X(01)    VALUE SPACES. 02810001
028200     05  PRINT-OVER120-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          02820000
028300                                                    VALUE ZERO.   02830000
028400     05  PRINT-NIR-UNJ-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          02840000
028500                                                    VALUE ZERO.   02850000
028510     05  FILLER                       PIC  X(01)    VALUE SPACES. 02851021
028520     05  PRINT-RCV-INCOM-IND          PIC  X(01).                 02852021
028530     05  FILLER                       PIC  X(01)    VALUE SPACES. 02853021
028600                                                                  02860000
028700 01  PRINT-VENDOR-TOTAL.                                          02870000
028800     05  FILLER                       PIC  X(05)    VALUE SPACES. 02880000
028900     05  FILLER                       PIC  X(12)    VALUE         02890000
029000                                      'VENDOR TOTAL'.             02900000
029100     05  FILLER                       PIC  X(34)    VALUE SPACES. 02910021
029200     05  VENDOR-GROSS-INVOICE-AMT     PIC  ZZ,ZZZ,ZZ9.99          02920000
029300                                                    VALUE ZERO.   02930000
029400     05  FILLER                       PIC  X(01)    VALUE SPACES. 02940001
029500     05  VENDOR-UNDER30-AMT           PIC  ZZ,ZZZ,ZZZ.ZZ          02950000
029600                                                    VALUE ZERO.   02960000
029700     05  FILLER                       PIC  X(01)    VALUE SPACES. 02970001
029800     05  VENDOR-31-60-AMT             PIC  ZZ,ZZZ,ZZZ.ZZ          02980000
029900                                                    VALUE ZERO.   02990000
030000     05  FILLER                       PIC  X(01)    VALUE SPACES. 03000001
030100     05  VENDOR-61-90-AMT             PIC  ZZ,ZZZ,ZZZ.ZZ          03010000
030200                                                    VALUE ZERO.   03020000
030300     05  FILLER                       PIC  X(01)    VALUE SPACES. 03030001
030400     05  VENDOR-91-120-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          03040000
030500                                                    VALUE ZERO.   03050000
030600     05  FILLER                       PIC  X(01)    VALUE SPACES. 03060001
030700     05  VENDOR-OVER120-AMT           PIC  ZZ,ZZZ,ZZZ.ZZ          03070000
030800                                                    VALUE ZERO.   03080000
030900     05  VENDOR-NIR-UNJ-AMT           PIC  ZZ,ZZZ,ZZZ.ZZ          03090000
031000                                                    VALUE ZERO.   03100000
031010     05  FILLER                       PIC  X(03)    VALUE SPACES. 03101021
031100                                                                  03110000
031200 01  PRINT-GRAND-TOTAL.                                           03120000
031300     05  FILLER                       PIC  X(05)    VALUE SPACES. 03130000
031611     05  FILLER                       PIC  X(27)    VALUE         03161108
031612         'GRAND TOTAL ALL INVOICES'.                              03161208
031700     05  FILLER                       PIC  X(19)    VALUE SPACES. 03170022
031800     05  GRAND-GROSS-INVOICE-AMT      PIC  ZZ,ZZZ,ZZ9.99          03180000
031900                                                    VALUE ZERO.   03190000
032000     05  FILLER                       PIC  X(01)    VALUE SPACES. 03200001
032100     05  GRAND-UNDER30-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          03210000
032200                                                    VALUE ZERO.   03220000
032300     05  FILLER                       PIC  X(01)    VALUE SPACES. 03230001
032400     05  GRAND-31-60-AMT              PIC  ZZ,ZZZ,ZZZ.ZZ          03240000
032500                                                    VALUE ZERO.   03250000
032600     05  FILLER                       PIC  X(01)    VALUE SPACES. 03260001
032700     05  GRAND-61-90-AMT              PIC  ZZ,ZZZ,ZZZ.ZZ          03270000
032800                                                    VALUE ZERO.   03280000
032900     05  FILLER                       PIC  X(01)    VALUE SPACES. 03290001
033000     05  GRAND-91-120-AMT             PIC  ZZ,ZZZ,ZZZ.ZZ          03300000
033100                                                    VALUE ZERO.   03310000
033200     05  FILLER                       PIC  X(01)    VALUE SPACES. 03320001
033300     05  GRAND-OVER120-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          03330000
033400                                                    VALUE ZERO.   03340000
033410     05  FILLER                       PIC  X(02)    VALUE SPACES. 03341021
033500     05  GRAND-NIR-UNJ-AMT            PIC  ZZ,ZZZ,ZZZ.ZZ          03350000
033600                                                    VALUE ZERO.   03360000
033700                                                                  03370000
033800 01  TOTAL-LINE.                                                  03380000
033900     05  FILLER                       PIC  X(13)    VALUE SPACES. 03390000
034011     05  FILLER                       PIC  X(21)    VALUE         03401108
034012         'TOTAL ALL INVOICES   '.                                 03401208
034100     05  FILLER                       PIC  X(02)    VALUE SPACES. 03410000
034200     05  TOTAL-BREAK-COUNT            PIC  ZZZZZ9   VALUE ZERO.   03420000
034300     05  FILLER                       PIC  X(108)   VALUE SPACES. 03430000
034400                                                                  03440000
034500 01  EOR-END-OF-REPORT.                                           03450000
034600     05  FILLER                  PIC  X(52)  VALUE SPACES.        03460000
034700     05  FILLER                  PIC  X(98)  VALUE                03470000
034800         '*****  END OF REPORT *****'.                            03480000
034900/                                                                 03490000
035000     COPY APRD262.                                                03500003
035100/                                                                 03510000
035200 PROCEDURE DIVISION.                                              03520000
035300 A100-MAINLINE.                                                   03530000
035400                                                                  03540000
035500     PERFORM B100-INITIALIZATION.                                 03550000
035600                                                                  03560000
035700     PERFORM B200-DETAIL-PROCESSING UNTIL END-OF-PROCESSING.      03570000
035800                                                                  03580000
035900     PERFORM B300-END-OF-INPUT.                                   03590000
036000                                                                  03600000
036100     GOBACK.                                                      03610000
036200/                                                                 03620000
036300 B100-INITIALIZATION.                                             03630000
036400                                                                  03640000
036500     OPEN INPUT OPEN-INVOICE-FILE.                                03650000
036701     OPEN OUTPUT ALL-INVOICE-FILE.                                03670109
036800     ACCEPT PW-CURRENT-DATE FROM DATE.                            03680000
036900     MOVE PW-CURRENT-MONTH            TO DP150O-RUN-MONTH.        03690000
037000     MOVE PW-CURRENT-DAY              TO DP150O-RUN-DAY.          03700000
037100     MOVE PW-CURRENT-YEAR             TO DP150O-RUN-YEAR.         03710000
037200     MOVE DP150O-RUN-DATE             TO HDR-3-DATE.              03720000
037300     ACCEPT PW-CURRENT-TIME FROM TIME.                            03730000
037400     MOVE PW-CURRENT-HOUR             TO DP150O-RUN-HOUR.         03740000
037500     MOVE PW-CURRENT-MINUTE           TO DP150O-RUN-MINUTE.       03750000
037600     MOVE PW-REPORT-NAME              TO DP150O-PROGRAM-NAME.     03760000
037700     MOVE 1                           TO DP150O-REPORT-NUMBER.    03770000
037800                                                                  03780000
037900     PERFORM R100-READ-OPEN-INVOICE-FILE.                         03790000
038000                                                                  03800000
039120     MOVE ZERO                        TO PW-PAGE-COUNT.           03912016
039130     PERFORM P100-NEW-PAGE-PROCESSING.                            03913016
039200     MOVE AP262-VENDOR-NUMBER         TO PRINT-VENDOR-NUMBER.     03920016
039300     MOVE AP262-VENDOR-NAME           TO PRINT-VENDOR-NAME        03930016
039400                                         PW-SAVE-VENDOR-NAME.     03940016
039500     PERFORM P300-PRINT-VENDOR-HEADER.                            03950016
040600                                                                  04060000
040700/                                                                 04070000
040800 B200-DETAIL-PROCESSING.                                          04080000
040900                                                                  04090000
041000     IF ( PW-SAVE-INVOICE-NUMBER = '99999Z/UNJOURNALIZED' ) AND   04100000
041100        ( PS-FIRST-TIME )                                         04110000
041200        SET PS-NOT-FIRST-TIME TO TRUE                             04120000
041300        PERFORM F200-FORMAT-INTRANSIT-DETAIL                      04130000
041400        MOVE SPACES           TO PW-SAVE-INVOICE-NUMBER           04140000
041500     END-IF.                                                      04150000
041600                                                                  04160000
043500     IF AP262-VENDOR-NAME NOT = PW-SAVE-VENDOR-NAME               04350003
043600        PERFORM P400-PRINT-VENDOR-TOTAL                           04360000
043700        MOVE AP262-VENDOR-NUMBER TO PRINT-VENDOR-NUMBER           04370003
043800        MOVE AP262-VENDOR-NAME    TO PRINT-VENDOR-NAME            04380003
043900                                     PW-SAVE-VENDOR-NAME          04390000
044000        PERFORM P300-PRINT-VENDOR-HEADER                          04400000
044100     END-IF.                                                      04410000
044200                                                                  04420000
044300     IF ( PW-SAVE-INVOICE-NUMBER = '99999Z/UNJOURNALIZED' ) AND   04430000
044400        ( PS-NOT-FIRST-TIME )                                     04440000
044500        PERFORM C200-ACCUM-INTRANSIT-TOTALS                       04450000
044600     ELSE                                                         04460000
044700        SET PS-FIRST-TIME TO TRUE                                 04470000
044800        PERFORM F100-FORMAT-INVOICE-DETAIL                        04480000
044900     END-IF.                                                      04490000
045000                                                                  04500000
045100     PERFORM R100-READ-OPEN-INVOICE-FILE.                         04510000
045200                                                                  04520000
045300/                                                                 04530000
045400 B300-END-OF-INPUT.                                               04540000
045500                                                                  04550000
045600     DISPLAY '** APKRP262 SUMMARY **'.                            04560000
045700     MOVE PW-INPUT-COUNT     TO PW-DISPLAY-COUNT.                 04570000
045800     MOVE PW-INTRANSIT-COUNT TO PW-DISPLAY-INTRANSIT-COUNT.       04580000
045900     DISPLAY '** INPUT COUNT      = ' PW-DISPLAY-COUNT.           04590000
046000     DISPLAY '** INTRANSIT WRITTEN= ' PW-DISPLAY-INTRANSIT-COUNT. 04600000
046100                                                                  04610000
046200     IF PW-SAVE-VENDOR-NAME   NOT = SPACES                        04620000
046300        PERFORM P400-PRINT-VENDOR-TOTAL                           04630000
046400     END-IF.                                                      04640000
046500                                                                  04650000
046600     PERFORM P600-PRINT-GRAND-TOTAL.                              04660000
046700     PERFORM P500-PRINT-TOTAL-LINE.                               04670000
046800                                                                  04680000
047700                                                                  04770000
047800     CLOSE OPEN-INVOICE-FILE                                      04780000
048001           ALL-INVOICE-FILE.                                      04800109
048100                                                                  04810000
048200/                                                                 04820000
048300 C100-ACCUM-VENDOR-TOTALS.                                        04830000
048400                                                                  04840000
048500     ADD  AP262-GROSS-INVOICE-AMT TO PW-GROSS-INVOICE-AMT.        04850003
048600     ADD  AP262-GROSS-INVOICE-AMT TO PW-TOT-GROSS-INVOICE-AMT.    04860003
048700                                                                  04870000
048800     EVALUATE AP262-DAYS-DELINQUENT                               04880003
048900         WHEN 00 THRU 30                                          04890000
049000             MOVE AP262-GROSS-INVOICE-AMT TO PRINT-UNDER30-AMT    04900003
049100             ADD  AP262-GROSS-INVOICE-AMT TO PW-UNDER30-AMT       04910003
049200             ADD  AP262-GROSS-INVOICE-AMT TO PW-TOT-UNDER30-AMT   04920003
049300         WHEN 31 THRU 60                                          04930000
049400             MOVE AP262-GROSS-INVOICE-AMT TO PRINT-31-60-AMT      04940003
049500             ADD  AP262-GROSS-INVOICE-AMT TO PW-31-60-AMT         04950003
049600             ADD  AP262-GROSS-INVOICE-AMT TO PW-TOT-31-60-AMT     04960003
049700         WHEN 61 THRU 90                                          04970000
049800             MOVE AP262-GROSS-INVOICE-AMT TO PRINT-61-90-AMT      04980003
049900             ADD  AP262-GROSS-INVOICE-AMT TO PW-61-90-AMT         04990003
050000             ADD  AP262-GROSS-INVOICE-AMT TO PW-TOT-61-90-AMT     05000003
050100         WHEN 91 THRU 120                                         05010000
050200             MOVE AP262-GROSS-INVOICE-AMT TO PRINT-91-120-AMT     05020003
050300             ADD  AP262-GROSS-INVOICE-AMT TO PW-91-120-AMT        05030003
050400             ADD  AP262-GROSS-INVOICE-AMT TO PW-TOT-91-120-AMT    05040003
050500         WHEN OTHER                                               05050000
050600             MOVE AP262-GROSS-INVOICE-AMT TO PRINT-OVER120-AMT    05060003
050700             ADD  AP262-GROSS-INVOICE-AMT TO PW-OVER120-AMT       05070003
050800             ADD  AP262-GROSS-INVOICE-AMT TO PW-TOT-OVER120-AMT   05080003
050900     END-EVALUATE.                                                05090000
051000                                                                  05100000
051100/                                                                 05110000
051200 C200-ACCUM-INTRANSIT-TOTALS.                                     05120000
051300                                                                  05130000
051400     ADD AP262-GROSS-INVOICE-AMT TO PV-NIR-UNJ-AMT.               05140003
051500                                                                  05150000
051600/                                                                 05160000
051700 F100-FORMAT-INVOICE-DETAIL.                                      05170000
051800                                                                  05180000
051900     MOVE AP262-PO-NBR             TO PRINT-PO-NBR.               05190007
052100     MOVE AP262-INVOICE-STATUS     TO PRINT-INVOICE-STATUS.       05210003
052200     MOVE AP262-INVOICE-NUMBER     TO PRINT-INVOICE-NUMBER.       05220003
052300     MOVE AP262-INVOICE-TYPE       TO PRINT-INVOICE-TYPE.         05230003
052500     MOVE AP262-RCV-INCOM-IND      TO PRINT-RCV-INCOM-IND.        05250021
052600     MOVE AP262-DUE-DATE           TO PW-DATE-BREAK-DOWN.         05260003
052700     MOVE PW-DATE-YY               TO PRINT-DUE-DATE-YY.          05270000
052800     MOVE PW-DATE-MM               TO PRINT-DUE-DATE-MM.          05280000
052900     MOVE PW-DATE-DD               TO PRINT-DUE-DATE-DD.          05290000
053000     MOVE '-'                      TO PRINT-DUE-DATE-1ST-DASH     05300000
053100                                      PRINT-DUE-DATE-2ND-DASH.    05310000
053200     MOVE AP262-GROSS-INVOICE-AMT  TO PRINT-GROSS-INVOICE-AMT.    05320016
053210     MOVE AP262-MTCH-LVL-CDE       TO PRINT-MTCH-LVL-CDE.         05321016
053300     PERFORM C100-ACCUM-VENDOR-TOTALS.                            05330000
053400                                                                  05340000
053500     ADD 1                         TO PW-BREAK-COUNT.             05350000
053600     PERFORM P200-PRINT-DETAIL-LINE.                              05360000
053700                                                                  05370000
053800/                                                                 05380000
053900 F200-FORMAT-INTRANSIT-DETAIL.                                    05390000
054000                                                                  05400000
054100     MOVE SPACE                TO PRINT-DUE-DATE.                 05410000
054200     MOVE PV-NIR-UNJ-AMT       TO PRINT-NIR-UNJ-AMT.              05420000
054300     ADD  PV-NIR-UNJ-AMT       TO PW-NIR-UNJ-AMT                  05430000
054400                                  PW-TOT-NIR-UNJ-AMT.             05440000
054500                                                                  05450000
054600     ADD 1                     TO PW-INTRANSIT-COUNT.             05460000
054700     PERFORM P200-PRINT-DETAIL-LINE.                              05470000
054800                                                                  05480000
054900     MOVE ZEROES               TO PV-NIR-UNJ-AMT.                 05490000
055000                                                                  05500000
055100/                                                                 05510000
055200 P100-NEW-PAGE-PROCESSING.                                        05520000
055300                                                                  05530000
055400     ADD 1                            TO PW-PAGE-COUNT.           05540000
055500     MOVE PW-PAGE-COUNT               TO DP150O-PAGE-NUMBER.      05550000
055600                                                                  05560000
058820     WRITE ALL-INVOICE-REC                                        05882009
058830           FROM  DP150O-STANDRD-HEADER-150-COLS                   05883008
058840           AFTER ADVANCING PAGE.                                  05884008
058841     WRITE ALL-INVOICE-REC                                        05884109
058860           FROM HDR-LINE-2                                        05886008
058870           AFTER ADVANCING 1 LINE.                                05887008
058871     WRITE ALL-INVOICE-REC                                        05887109
058890           FROM HDR-LINE-3                                        05889008
058891           AFTER ADVANCING 1 LINE.                                05889108
058892     WRITE ALL-INVOICE-REC                                        05889209
058894           FROM RPT-LINE-1                                        05889408
058895           AFTER ADVANCING 2 LINES.                               05889508
058896     WRITE ALL-INVOICE-REC                                        05889621
058897           FROM RPT-LINE-2                                        05889721
058898           AFTER ADVANCING 1 LINES.                               05889821
058899     INITIALIZE ALL-INVOICE-REC.                                  05889921
058900                                                                  05890021
058910     MOVE 6                           TO PW-LINE-COUNT.           05891021
059000                                                                  05900000
059100/                                                                 05910000
059200 P200-PRINT-DETAIL-LINE.                                          05920000
059300                                                                  05930000
059400     ADD 1                            TO PW-LINE-COUNT.           05940000
059500                                                                  05950000
059600     IF PW-LINE-COUNT >= PW-MAX-LINES                             05960000
059700        PERFORM P100-NEW-PAGE-PROCESSING                          05970000
059800        ADD 1           TO PW-LINE-COUNT                          05980000
059900     END-IF.                                                      05990000
060000                                                                  06000000
060701     MOVE PRINT-LINE    TO ALL-INVOICE-REC.                       06070116
060702     WRITE ALL-INVOICE-REC AFTER ADVANCING 1 LINE.                06070209
060800                                                                  06080000
060900     INITIALIZE PRINT-LINE.                                       06090000
061000                                                                  06100000
061100/                                                                 06110000
061200 P300-PRINT-VENDOR-HEADER.                                        06120000
061300                                                                  06130000
061400     ADD 3                            TO PW-LINE-COUNT.           06140000
061500                                                                  06150000
061600     IF PW-LINE-COUNT >= PW-MAX-LINES                             06160000
061700        PERFORM P100-NEW-PAGE-PROCESSING                          06170000
061800        ADD 2                    TO PW-LINE-COUNT                 06180000
061900     ELSE                                                         06190000
062000        SUBTRACT 1 FROM PW-LINE-COUNT                             06200000
062100     END-IF.                                                      06210000
062200                                                                  06220000
062901     MOVE PRINT-VENDOR-HEADER    TO ALL-INVOICE-REC.              06290116
062902     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               06290209
063000                                                                  06300000
063100     INITIALIZE PRINT-LINE.                                       06310000
063200                                                                  06320000
063300/                                                                 06330000
063400 P400-PRINT-VENDOR-TOTAL.                                         06340000
063500                                                                  06350000
063600     ADD 2                            TO PW-LINE-COUNT.           06360000
063700                                                                  06370000
063800     IF PW-LINE-COUNT >= PW-MAX-LINES                             06380000
063900        PERFORM P100-NEW-PAGE-PROCESSING                          06390000
064000        ADD 2                   TO PW-LINE-COUNT                  06400000
064100     END-IF.                                                      06410000
064200                                                                  06420000
064300     MOVE PW-GROSS-INVOICE-AMT TO VENDOR-GROSS-INVOICE-AMT.       06430000
064400     MOVE PW-UNDER30-AMT       TO VENDOR-UNDER30-AMT.             06440000
064500     MOVE PW-31-60-AMT         TO VENDOR-31-60-AMT.               06450000
064600     MOVE PW-61-90-AMT         TO VENDOR-61-90-AMT.               06460000
064700     MOVE PW-91-120-AMT        TO VENDOR-91-120-AMT.              06470000
064800     MOVE PW-OVER120-AMT       TO VENDOR-OVER120-AMT.             06480000
064900     MOVE PW-NIR-UNJ-AMT       TO VENDOR-NIR-UNJ-AMT.             06490000
065000                                                                  06500000
065701     MOVE PRINT-VENDOR-TOTAL   TO ALL-INVOICE-REC.                06570116
065702     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               06570209
065800                                                                  06580000
065900     INITIALIZE PRINT-LINE                                        06590000
066000                PW-GROSS-INVOICE-AMT                              06600000
066100                PW-UNDER30-AMT                                    06610000
066200                PW-31-60-AMT                                      06620000
066300                PW-61-90-AMT                                      06630000
066400                PW-91-120-AMT                                     06640000
066500                PW-OVER120-AMT                                    06650000
066600                PW-NIR-UNJ-AMT.                                   06660000
066700                                                                  06670000
066800/                                                                 06680000
066900 P500-PRINT-TOTAL-LINE.                                           06690000
067000                                                                  06700000
067100     ADD 2                            TO PW-LINE-COUNT.           06710000
067200                                                                  06720000
067300     IF PW-LINE-COUNT >= PW-MAX-LINES                             06730000
067400        PERFORM P100-NEW-PAGE-PROCESSING                          06740000
067500     END-IF.                                                      06750000
067600                                                                  06760000
068200                                                                  06820000
068300     MOVE PW-BREAK-COUNT              TO TOTAL-BREAK-COUNT.       06830000
068400                                                                  06840000
069101     MOVE TOTAL-LINE       TO ALL-INVOICE-REC.                    06910109
069102     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               06910209
069200                                                                  06920000
069300     INITIALIZE PW-BREAK-COUNT.                                   06930000
069400     ADD 2                            TO PW-LINE-COUNT.           06940000
069500                                                                  06950000
069600     IF PW-LINE-COUNT >= PW-MAX-LINES                             06960000
069700        PERFORM P100-NEW-PAGE-PROCESSING                          06970000
069800     END-IF.                                                      06980000
069900                                                                  06990000
070401     WRITE ALL-INVOICE-REC FROM EOR-END-OF-REPORT AFTER 2.        07040109
070500                                                                  07050000
070600/                                                                 07060000
070700 P600-PRINT-GRAND-TOTAL.                                          07070000
070800                                                                  07080000
070900     ADD 2                         TO PW-LINE-COUNT.              07090000
071000                                                                  07100000
071100     IF PW-LINE-COUNT >= PW-MAX-LINES                             07110000
071200        PERFORM P100-NEW-PAGE-PROCESSING                          07120000
071300        ADD 2                      TO PW-LINE-COUNT               07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
072100                                                                  07210000
072200     MOVE PW-TOT-GROSS-INVOICE-AMT TO GRAND-GROSS-INVOICE-AMT.    07220000
072300     MOVE PW-TOT-UNDER30-AMT       TO GRAND-UNDER30-AMT.          07230000
072400     MOVE PW-TOT-31-60-AMT         TO GRAND-31-60-AMT.            07240000
072500     MOVE PW-TOT-61-90-AMT         TO GRAND-61-90-AMT.            07250000
072600     MOVE PW-TOT-91-120-AMT        TO GRAND-91-120-AMT.           07260000
072700     MOVE PW-TOT-OVER120-AMT       TO GRAND-OVER120-AMT.          07270000
072800     MOVE PW-TOT-NIR-UNJ-AMT       TO GRAND-NIR-UNJ-AMT.          07280000
072900                                                                  07290000
073510     MOVE PRINT-GRAND-TOTAL        TO ALL-INVOICE-REC.            07351016
073520     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               07352009
073700                                                                  07370000
073800     INITIALIZE PW-TOT-GROSS-INVOICE-AMT                          07380000
073900                PW-TOT-UNDER30-AMT                                07390000
074000                PW-TOT-31-60-AMT                                  07400000
074100                PW-TOT-61-90-AMT                                  07410000
074200                PW-TOT-91-120-AMT                                 07420000
074300                PW-TOT-OVER120-AMT                                07430000
074400                PW-TOT-NIR-UNJ-AMT.                               07440000
074500                                                                  07450000
074600/                                                                 07460000
074700 R100-READ-OPEN-INVOICE-FILE.                                     07470000
074800                                                                  07480000
074900     READ OPEN-INVOICE-FILE                                       07490000
075000          INTO AP262-INPUT-RECORD                                 07500003
075100          AT END SET END-OF-PROCESSING TO TRUE.                   07510000
075200                                                                  07520000
075300     IF NOT END-OF-PROCESSING                                     07530000
075400        ADD 1 TO PW-INPUT-COUNT                                   07540000
075500     END-IF.                                                      07550000
075600                                                                  07560000
075700     IF AP262-INVOICE-NUMBER NOT = '99999Z/UNJOURNALIZED'         07570003
075800        SET PS-FIRST-TIME TO TRUE                                 07580000
075900     END-IF.                                                      07590000
076000                                                                  07600000
076100     IF ( AP262-INVOICE-NUMBER = '99999Z/UNJOURNALIZED' ) AND     07610003
076200        ( PS-FIRST-TIME )                                         07620000
076300        SET PS-NOT-FIRST-TIME       TO TRUE                       07630000
076400        MOVE AP262-INVOICE-NUMBER   TO PW-SAVE-INVOICE-NUMBER     07640003
076500        MOVE 'NIR/UNJ             ' TO PRINT-INVOICE-NUMBER       07650000
076600        MOVE AP262-PO-NBR           TO PRINT-PO-NBR               07660007
076700     END-IF.                                                      07670000
