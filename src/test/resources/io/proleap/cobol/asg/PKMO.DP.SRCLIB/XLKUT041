000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT041.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   APRIL, 2003.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900****************************************************************  00090000
001000*    THIS PROGRAM WILL COMPARE RMS PO / LEGACY PO              *  00100000
001100* PO DOMAIN TEMPLATE.........:  XXT_PO                         *  00110000
001200* PO DOMAIN TEMPLATE COPYBOOK:  XLRD015   400 - LENGTH         *  00120000
001300*                                                              *  00130000
001400*        INPUT COMES TO THIS PROGRAM FROM XLKUT036 AND MUST    *  00140000
001500*    BE SORTED BY THE COMPLETE RECORD. THAT WAY, IF YOU HAVE   *  00150000
001600*    DUPLICATE KEY FIELDS THAT YOU ARE MATCHING ON, BUT THE    *  00160000
001700*    DATA IS DIFFERENT, THEY WILL MATCH.  IF YOU DON'T SORT    *  00170000
001800*    BY THE COMPLETE RECORD, RECORDS WITH DUPLICATE KEY        *  00180000
001900*    FIELDS COULD POSSIBLY CREATE MISLEADING DATA MISMATCHING  *  00190000
002000*    RECORDS WHEN NONE REALLY EXIST.                           *  00200000
002100*                                                              *  00210000
002200*    INPUT COMES TO THIS PROGRAM FROM XLKUT036. THIS PROGRAM   *  00220000
002300*    MATCHES THE LEGACY AND RMS FILES BY PO NUMBER.  IT        *  00230000
002400*    WRITES ERROR RECORDS OUT FOR ANY UNMATCHED RECORDS. IT    *  00240000
002500*    ALSO CHECKS TO SEE IF THERE ARE ANY DATA DIFFERENCES FOR  *  00250000
002600*    THOSE RECORDS WHOSE PO NUMBERS MATCH. IF THERE ARE ANY,   *  00260000
002700*    AN ERROR RECORD IS WRITTEN INDICATING THE FIELDS THAT     *  00270000
002800*    ARE DIFFERENT.                                            *  00280000
002900*        THERE ARE SOME MOVES OF FIELDS COMMENTED OUT. THIS    *  00290000
003000*    HAS BEEN DONE BECAUSE SOME OF THESE FIELDS AREN'T AVAIL-  *  00300000
003100*    ABLE ON ONE OF THE SYSTEMS.  YOU MAY FIND THESE BY DOING  *  00310000
003200*    A F '**??'.                                               *  00320000
003300*                                                              *  00330000
003400* ****************************************************************00340000
003500* CHANGE DESCRIPTION                                              00350000
003600* ****************************************************************00360000
003700* DATE  05/12/2010                                                00370000
003800*  CHANGE MADE: ADDED A NEW IR INDICATOR(WHSE_RPLNT_IND) IN       00380000
003900*  TPURCHS TABLE UNDER IMPORT REPLENISHMENT PROJECT. CHANGES MADE 00390000
004000*  ACCORDINGLY FOR THE SAME.                                      00400000
004100* MADE BY: MONIKA SACHDEVA         TKID: TKMAW78                  00410000
004200* CHANGES TAGGED AS MS 05/12/2010                                 00420000
003600* ****************************************************************00420100
P5207G* DATE  11/25/2013                                                00420200
P5207G*  CHANGE MADE: REMOVED THE CHECKS FOR BELOW FIELDS               00420300
P5207G*      - SEASONAL SET CODE                                        00420400
P5207G*      - SEASONAL SET YEAR                                        00420500
P5207G*      - HANGER INDICATOR                                         00420600
P5207G*      - RELEASE DATE                                             00420700
P5207G* MADE BY: COGNIZANT (PRITHIVI)    TKID: TKMAJC7                  00420800
P5207G* CHANGES TAGGED AS 'P5207G' CR : CHG0081355                      00420901
004300****************************************************************  00421000
      * DATE  06/23/2014                                                00421100
      *  CHANGE MADE: REMOVED THE CHECKS FOR BELOW FIELD                00421200
      *      - EXTENDED NOT AFTER DATE                                  00421300
      * MADE BY: CHERI PARMLEY           TKID: TKMAF76                  00421400
      * CHANGES TAGGED AS 'CLP 06/23/14' CR : CHG0081355                00421501
004300****************************************************************  00421600
      * DATE  07/29/2014                                                00421702
      *  CHANGE MADE: REMOVED THE CHECKS FOR BELOW FIELDS               00421802
      *      - DELY ID                                                  00421902
      *      - CONSLR REQ DTE                                           00422002
      *      - TKT MKR REQ DTE                                          00422102
      *      - PTKT IND                                                 00422202
      *      - PTKT LDTM DAYS QTY                                       00422302
      * MADE BY: CHERI PARMLEY           TKID: TKMAF76                  00422802
      * CHANGES TAGGED AS 'CLP 07/29/14' CR : CHG0088280                00422907
004300****************************************************************  00423002
      * DATE  08/04/2014                                                00423208
      *  CHANGE MADE: REMOVED THE CHECKS FOR BELOW FIELDS               00423308
      *      - UNT PER CBMT QTY                                         00423408
      * MADE BY: CHERI PARMLEY           TKID: TKMAF76                  00423908
      * CHANGES TAGGED AS 'CLP 08/04/14' CR : CHG0088660                00424009
004300****************************************************************  00424108
004300****************************************************************  00424210
      * DATE  08/12/2014                                                00424310
      *  CHANGE MADE: REMOVED THE CHECKS FOR BELOW FIELDS               00424410
      *      - IMPRT PO IND                                             00424510
      * MADE BY: CHERI PARMLEY           TKID: TKMAF76                  00424610
      * CHANGES TAGGED AS 'CLP 08/12/14' CR : CHG0089457                00424711
004300****************************************************************  00424810
004400 ENVIRONMENT DIVISION.                                            00424900
004500 INPUT-OUTPUT SECTION.                                            00425000
004600                                                                  00425100
004700 FILE-CONTROL.                                                    00425200
004800                                                                  00425300
004900     SELECT RMS-PO-FILE                                           00425400
005000         ASSIGN TO INP01.                                         00425500
005100                                                                  00426000
005200     SELECT LEGACY-FILE                                           00427000
005300         ASSIGN TO INP02.                                         00428000
005400                                                                  00429000
005500     SELECT ERROR-FILE                                            00430000
005600         ASSIGN TO OUT01.                                         00440000
005700                                                                  00450000
005800***************************************************************** 00460000
005900 DATA DIVISION.                                                   00470000
006000***************************************************************** 00480000
006100 FILE SECTION.                                                    00490000
006200                                                                  00500000
006300 FD  RMS-PO-FILE                                                  00510000
006400     RECORDING MODE IS F                                          00520000
006500     BLOCK CONTAINS 0 RECORDS                                     00530000
006600     LABEL RECORDS ARE STANDARD.                                  00540000
006700                                                                  00550000
006800** CHANGE THE RECORD LENGTH TO ACCOMODATE THE NEW INDICATOR **    00560000
006900** MS 05/12/2010 BEG                                              00570000
007000*01  RMS-PO-RECORD                PIC X(372).                     00580000
007100 01  RMS-PO-RECORD                PIC X(373).                     00590000
007200** MS 05/12/2010 END                                              00600000
007300                                                                  00610000
007400 FD  LEGACY-FILE                                                  00620000
007500     RECORDING MODE IS F                                          00630000
007600     BLOCK CONTAINS 0 RECORDS                                     00640000
007700     LABEL RECORDS ARE STANDARD.                                  00650000
007800                                                                  00660000
007900** CHANGE THE RECORD LENGTH TO ACCOMODATE THE NEW INDICATOR **    00670000
008000** MS 05/12/2010 BEG                                              00680000
008100*01  LEGACY-RECORD                PIC X(372).                     00690000
008200 01  LEGACY-RECORD                PIC X(373).                     00700000
008300** MS 05/12/2010 END                                              00710000
008400                                                                  00720000
008500                                                                  00730000
008600 FD  ERROR-FILE                                                   00740000
008700     RECORDING MODE IS F                                          00750000
008800     BLOCK CONTAINS 0 RECORDS                                     00760000
008900     LABEL RECORDS ARE STANDARD.                                  00770000
009000                                                                  00780000
009100 01  ERROR-RECORD                 PIC X(830).                     00790000
009200                                                                  00800000
009300 WORKING-STORAGE SECTION.                                         00810000
009400                                                                  00820000
009500 01  PS-PROGRAM-SWITCHES.                                         00830000
009600     05  PS-EOF-INPUT1-SW             PIC X(01)  VALUE 'N'.       00840000
009700         88  PS-EOF-INPUT1-YES                   VALUE 'Y'.       00850000
009800         88  PS-EOF-INPUT1-NO                    VALUE 'N'.       00860000
009900     05  PS-EOF-INPUT2-SW             PIC X(01)  VALUE 'N'.       00870000
010000         88  PS-EOF-INPUT2-YES                   VALUE 'Y'.       00880000
010100         88  PS-EOF-INPUT2-NO                    VALUE 'N'.       00890000
010200     05  PS-EMAIL-SW                  PIC X(01)  VALUE 'N'.       00900000
010300         88  PS-EMAIL-YES                        VALUE 'Y'.       00910000
010400         88  PS-EMAIL-NO                         VALUE 'N'.       00920000
010500     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00930000
010600         88  PS-ERROR-YES                        VALUE 'Y'.       00940000
010700         88  PS-ERROR-NO                         VALUE 'N'.       00950000
010800                                                                  00960000
010900 01  PC-PROGRAM-CONSTANTS.                                        00970000
011000     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT041'.00980000
011100     05  PC-FIVE-BLANKS               PIC  X(05) VALUE SPACES.    00990000
011100     05  PC-P                         PIC  X(01) VALUE 'P'.       01000000
011200                                                                  01010000
011300 01  PV-PROGRAM-VARIABLES.                                        01020000
011400     05  PV-RECORDS-READ-1            PIC  9(09) VALUE  0.        01030000
011500     05  PV-RECORDS-READ-2            PIC  9(09) VALUE  0.        01040000
011600     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        01050000
011700     05  PV-RECORDS-ON-BOTH           PIC  9(09) VALUE  0.        01060000
011800     05  PV-RECORDS-ON-RMS-ONLY       PIC  9(09) VALUE  0.        01070000
011900     05  PV-RECORDS-ON-LEGACY-ONLY    PIC  9(09) VALUE  0.        01080000
012000     05  PV-RECORDS-DATA-MISMATCH     PIC  9(09) VALUE  0.        01090000
012100     05  PV-ALL-NINES                 PIC  9(09) VALUE 99999999.  01100000
012200     05  PV-DELY-ID-X                 PIC  X(10) VALUE SPACES.    01110000
012300     05  PV-DELY-ID-REFORMAT          PIC  X(10) VALUE SPACES.    01120000
012400     05  PV-SUB-1                     PIC S9(3) COMP-3 VALUE ZERO.01130000
012500     05  PV-SUB-2                     PIC S9(3) COMP-3 VALUE ZERO.01140000
012600     05  PV-WORK-TABLE.                                           01150000
012700         10  PV-WORK-DELY OCCURS 10 TIMES PIC X(01).              01160000
012800     05  PV-NEW-TABLE.                                            01170000
012900         10  PV-NEW-DELY  OCCURS 10 TIMES PIC X(01).              01180000
013000                                                                  01190000
013100 01  PV-ABEND-FIELDS.                                             01200000
013200     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         01210000
013300                                                 COMP SYNC.       01220000
013400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT041'.01230000
013500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01240000
013600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01250000
013700     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    01260000
013800                                                                  01270000
013900 01  PV-RMS-INPUT.                                                01280000
014000     COPY XLRD015.                                                01290000
014100                                                                  01300000
014200 01  PV-LEGACY-INPUT.                                             01310000
014300     COPY XLRD015.                                                01320000
014400                                                                  01330000
014500 01  PV-ERROR-OUTPUT.                                             01340000
014600     COPY XLRD023.                                                01350000
014700                                                                  01360000
014800***************************************************************** 01370000
014900 PROCEDURE DIVISION.                                              01380000
015000***************************************************************** 01390000
015100     DISPLAY ' '.                                                 01400000
015200     DISPLAY '**** BEGINNING XLKUT041 ****'.                      01410000
015300     DISPLAY ' '.                                                 01420000
015400                                                                  01430000
015500     OPEN INPUT  RMS-PO-FILE                                      01440000
015600                 LEGACY-FILE                                      01450000
015700          OUTPUT ERROR-FILE.                                      01460000
015800     SET PS-EMAIL-NO       TO TRUE.                               01470000
015900                                                                  01480000
016000     PERFORM 1000-READ-RMS-INPUT.                                 01490000
016100     PERFORM 1100-READ-LEGACY-INPUT.                              01500000
016200                                                                  01510000
016300     PERFORM 2000-PROCESS-INPUT-FILE                              01520000
016400       UNTIL PS-EOF-INPUT1-YES AND                                01530000
016500             PS-EOF-INPUT2-YES.                                   01540000
016600                                                                  01550000
016700     CLOSE RMS-PO-FILE                                            01560000
016800           LEGACY-FILE                                            01570000
016900           ERROR-FILE.                                            01580000
017000                                                                  01590000
017100     DISPLAY ' '.                                                 01600000
017200     DISPLAY '  INPUT RMS PO REC = ' PV-RECORDS-READ-1.           01610000
017300     DISPLAY '  INPUT LEGACY REC = ' PV-RECORDS-READ-2.           01620000
017400     DISPLAY ' '.                                                 01630000
017500     DISPLAY '      XLRD015'.                                     01640000
017600     DISPLAY 'FILES ARE MATCHED BY PO NUMBER'.                    01650000
017700     DISPLAY ' '.                                                 01660000
017800     DISPLAY PC-FIVE-BLANKS                                       01670000
017900             'RECORDS ON BOTH FILES ---------> '                  01680000
018000              PV-RECORDS-ON-BOTH.                                 01690000
018100     DISPLAY ' '.                                                 01700000
018200     DISPLAY '  OUTPUT RECORDS WRITTEN ------> '                  01710000
018300              PV-RECORDS-WRITTEN.                                 01720000
018400     DISPLAY PC-FIVE-BLANKS                                       01730000
018500             'RECORDS ON RMS ONLY -----------> '                  01740000
018600              PV-RECORDS-ON-RMS-ONLY                              01750000
018700             ' - "A" RECORD CODE'.                                01760000
018800     DISPLAY PC-FIVE-BLANKS                                       01770000
018900             'RECORDS ON LEGACY ONLY --------> '                  01780000
019000              PV-RECORDS-ON-LEGACY-ONLY                           01790000
019100             ' - "B" RECORD CODE'.                                01800000
019200     DISPLAY PC-FIVE-BLANKS                                       01810000
019300             'RECORDS WITH DATA MISMATCH ----> '                  01820000
019400              PV-RECORDS-DATA-MISMATCH                            01830000
019500             ' - "C" RECORD CODE'.                                01840000
019600     DISPLAY ' '.                                                 01850000
019700     DISPLAY '****  END OF  XLKUT041  ****'.                      01860000
019800                                                                  01870000
019900*    SET RETURN CODE IF E-MAIL SWITCH IS TRUE.                    01880000
020000     IF PS-EMAIL-YES                                              01890000
020100         MOVE 4095 TO RETURN-CODE                                 01900000
020200     END-IF.                                                      01910000
020300     GOBACK.                                                      01920000
020400                                                                  01930000
020500                                                                  01940000
020600***************************************************************** 01950000
020700*  READ A RMS PO RECORD                                           01960000
020800***************************************************************** 01970000
020900 1000-READ-RMS-INPUT.                                             01980000
021000                                                                  01990000
021100     MOVE '1000-READ-RMS-INPUT    ' TO PV-ABEND-PARAGRAPH.        02000000
021200                                                                  02010000
021300     INITIALIZE PV-RMS-INPUT.                                     02020000
021400                                                                  02030000
021500     READ RMS-PO-FILE                                             02040000
021600          INTO PV-RMS-INPUT                                       02050000
021700            AT END                                                02060000
021800               SET PS-EOF-INPUT1-YES TO TRUE                      02070000
021900     END-READ.                                                    02080000
022000                                                                  02090000
022100     IF PS-EOF-INPUT1-YES                                         02100000
022200        MOVE PV-ALL-NINES TO XL015-PO-NBR OF PV-RMS-INPUT         02110000
022300     ELSE                                                         02120000
022400        ADD +1 TO PV-RECORDS-READ-1                               02130000
022500     END-IF.                                                      02140000
022600                                                                  02150000
022700***************************************************************** 02160000
022800*  READ A LEGACY RECORD                                           02170000
022900***************************************************************** 02180000
023000 1100-READ-LEGACY-INPUT.                                          02190000
023100                                                                  02200000
023200     MOVE '1100-READ-LEGACY-INPUT' TO PV-ABEND-PARAGRAPH.         02210000
023300                                                                  02220000
023400     INITIALIZE PV-LEGACY-INPUT.                                  02230000
023500                                                                  02240000
023600     READ LEGACY-FILE                                             02250000
023700          INTO PV-LEGACY-INPUT                                    02260000
023800            AT END                                                02270000
023900               SET PS-EOF-INPUT2-YES TO TRUE                      02280000
024000     END-READ.                                                    02290000
024100                                                                  02300000
024200     IF PS-EOF-INPUT2-YES                                         02310000
024300        MOVE PV-ALL-NINES TO XL015-PO-NBR OF PV-LEGACY-INPUT      02320000
024400     ELSE                                                         02330000
024500        ADD +1 TO PV-RECORDS-READ-2                               02340000
024600     END-IF.                                                      02350000
024700                                                                  02360000
024800***************************************************************** 02370000
024900*  REFORMAT THE RMS PO EXTRACT FILE                               02380000
025000***************************************************************** 02390000
025100 2000-PROCESS-INPUT-FILE.                                         02400000
025200                                                                  02410000
025300     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       02420000
025400                                                                  02430000
025500     IF XL015-PO-NBR   OF PV-RMS-INPUT    <                       02440000
025600        XL015-PO-NBR   OF PV-LEGACY-INPUT                         02450000
025700******************************                                    02460000
025800***  ON RMS NOT ON LEGACY                                         02470000
025900******************************                                    02480000
026000        ADD 1 TO PV-RECORDS-ON-RMS-ONLY                           02490000
026100        SET XL023-ON-RMS-ONLY TO TRUE                             02500000
026200        PERFORM 2100-WRITE-RMS-ERROR                              02510000
026300        PERFORM 1000-READ-RMS-INPUT                               02520000
026400     ELSE                                                         02530000
026500        IF XL015-PO-NBR  OF PV-RMS-INPUT    =                     02540000
026600           XL015-PO-NBR  OF PV-LEGACY-INPUT                       02550000
026700******************************                                    02560000
026800***  ON RMS AND ON LEGACY                                         02570000
026900******************************                                    02580000
027000           ADD 1 TO PV-RECORDS-ON-BOTH                            02590000
027100           IF XL015-DATA-AREA OF PV-RMS-INPUT    =                02600000
027200              XL015-DATA-AREA OF PV-LEGACY-INPUT                  02610000
027300                   PERFORM 1000-READ-RMS-INPUT                    02620000
027400                   PERFORM 1100-READ-LEGACY-INPUT                 02630000
027500           ELSE                                                   02640000
027600***  BUT SOMETHING DOESNT MATCH                                   02650000
027700              SET XL023-ON-BOTH-RMS-LEGACY TO TRUE                02660000
027800              PERFORM 2100-WRITE-RMS-ERROR                        02670000
027900              PERFORM 2200-WRITE-LEGACY-ERROR                     02680000
028000              PERFORM 1000-READ-RMS-INPUT                         02690000
028100              PERFORM 1100-READ-LEGACY-INPUT                      02700000
028200           END-IF                                                 02710000
028300        ELSE                                                      02720000
028400           IF XL015-PO-NBR  OF PV-RMS-INPUT    >                  02730000
028500              XL015-PO-NBR  OF PV-LEGACY-INPUT                    02740000
028600******************************                                    02750000
028700***   ON LEGACY NOT ON RMS                                        02760000
028800******************************                                    02770000
028900                ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                02780000
029000                SET XL023-ON-LEGACY-ONLY TO TRUE                  02790000
029100                PERFORM 2200-WRITE-LEGACY-ERROR                   02800000
029200                PERFORM 1100-READ-LEGACY-INPUT                    02810000
029300           END-IF                                                 02820000
029400        END-IF                                                    02830000
029500     END-IF.                                                      02840000
029600                                                                  02850000
029700***************************************************************** 02860000
029800*  WRITE A RMS RECORD TO THE ERROR FILE                           02870000
029900***************************************************************** 02880000
030000 2100-WRITE-RMS-ERROR.                                            02890000
030100                                                                  02900000
030200     SET XL023-XXT-PO     TO TRUE.                                02910000
030300     MOVE XL015-PO-NBR OF PV-RMS-INPUT TO XL023-PO-SORT-KEY-PO.   02920000
030400     MOVE SPACES          TO XL023-PO-SORT-KEY-DATA.              02930000
030500     INITIALIZE XL023-PO.                                         02940000
030600                                                                  02950000
030700     MOVE XL015-PO-NBR OF PV-RMS-INPUT        TO XL023-PO-NBR-RMS.02960000
030800     MOVE XL015-DEPT-NBR OF PV-RMS-INPUT    TO XL023-DEPT-NBR-RMS.02970000
030900**?? MOVE XL015-BYR-NBR OF PV-RMS-INPUT      TO XL023-BYR-NBR-RMS.02980000
031000     MOVE XL015-ENT-ID OF PV-RMS-INPUT        TO XL023-ENT-ID-RMS.02990000
031100**?? MOVE XL015-AGNT-ENT-ID OF PV-RMS-INPUT                       03000000
031200**??                                     TO XL023-AGNT-ENT-ID-RMS.03010000
031300     MOVE XL015-CRE-DTE OF PV-RMS-INPUT      TO XL023-CRE-DTE-RMS.03020000
031400     MOVE XL015-NOT-BEF-DTE OF PV-RMS-INPUT                       03030000
031500                                         TO XL023-NOT-BEF-DTE-RMS.03040000
031600     MOVE XL015-NOT-AFT-DTE OF PV-RMS-INPUT                       03050000
031700                                         TO XL023-NOT-AFT-DTE-RMS.03060000
031800**GB MOVE XL015-OTB-EOW-DTE OF PV-RMS-INPUT                       03070000
031900**GB                                     TO XL023-OTB-EOW-DTE-RMS.03080000
032000**?? MOVE XL015-CLOSE-DTE OF PV-RMS-INPUT  TO XL023-CLOSE-DTE-RMS.03090000
032100     MOVE XL015-PAYT-TERM-ID OF PV-RMS-INPUT                      03100000
032200                                        TO XL023-PAYT-TERM-ID-RMS.03110000
032300**?? MOVE XL015-FRGT-TERM-ID OF PV-RMS-INPUT                      03120000
032400**??                                    TO XL023-FRGT-TERM-ID-RMS.03130000
032500     MOVE XL015-STAT-CDE OF PV-RMS-INPUT    TO XL023-STAT-CDE-RMS.03140000
032600**?? MOVE XL015-ORIG-PO-APVL-DTE OF PV-RMS-INPUT                  03150000
032700**??                                TO XL023-ORIG-PO-APVL-DTE-RMS.03160000
032800**?? MOVE XL015-ORIG-APP-BY-USR-ID OF PV-RMS-INPUT                03170000
032900**??                              TO XL023-ORIG-APP-BY-USR-ID-RMS.03180000
033000     MOVE XL015-EDI-SNT-IND OF PV-RMS-INPUT                       03190000
033100                                         TO XL023-EDI-SNT-IND-RMS.03200000
033200     MOVE XL015-EDI-PO-IND OF PV-RMS-INPUT                        03210000
033300                                          TO XL023-EDI-PO-IND-RMS.03220000
033400     MOVE XL015-IMPRT-PO-IND OF PV-RMS-INPUT                      03230000
033500                                        TO XL023-IMPRT-PO-IND-RMS.03240000
033600     MOVE XL015-FCTRY-NM OF PV-RMS-INPUT    TO XL023-FCTRY-NM-RMS.03250000
033700     MOVE XL015-POE-CDE OF PV-RMS-INPUT      TO XL023-POE-CDE-RMS.03260000
033800     MOVE XL015-FOB-CDE OF PV-RMS-INPUT      TO XL023-FOB-CDE-RMS.03270000
033900     MOVE XL015-PO-TYP-CDE OF PV-RMS-INPUT                        03280000
034000                                          TO XL023-PO-TYP-CDE-RMS.03290000
034100     MOVE XL015-PK-BY-STR-IND OF PV-RMS-INPUT                     03300000
034200                                       TO XL023-PK-BY-STR-IND-RMS.03310000
034300     MOVE XL015-CONSLR-ACTL-DTE OF PV-RMS-INPUT                   03320000
034400                                     TO XL023-CONSLR-ACTL-DTE-RMS.03330000
034500     MOVE XL015-CONSLR-REQR-DTE OF PV-RMS-INPUT                   03340000
034600                                     TO XL023-CONSLR-REQR-DTE-RMS.03350000
034700     MOVE XL015-CONSLR-RLSE-CDE OF PV-RMS-INPUT                   03360000
034800                                     TO XL023-CONSLR-RLSE-CDE-RMS.03370000
034900     MOVE XL015-TKT-MKR-ACTL-DTE OF PV-RMS-INPUT                  03380000
035000                                    TO XL023-TKT-MKR-ACTL-DTE-RMS.03390000
035100     MOVE XL015-TKT-MKR-REQR-DTE OF PV-RMS-INPUT                  03400000
035200                                    TO XL023-TKT-MKR-REQR-DTE-RMS.03410000
035300     MOVE XL015-TKT-MKR-RLSE-CDE OF PV-RMS-INPUT                  03420000
035400                                    TO XL023-TKT-MKR-RLSE-CDE-RMS.03430000
035500     MOVE XL015-RLSE-DTE OF PV-RMS-INPUT    TO XL023-RLSE-DTE-RMS.03440000
035600     MOVE XL015-FRST-FCTRY-DTE OF PV-RMS-INPUT                    03450000
035700                                      TO XL023-FRST-FCTRY-DTE-RMS.03460000
035800     MOVE XL015-LAST-FCTRY-DTE OF PV-RMS-INPUT                    03470000
035900                                      TO XL023-LAST-FCTRY-DTE-RMS.03480000
036000     MOVE XL015-DIR-STR-IND OF PV-RMS-INPUT                       03490000
036100                                         TO XL023-DIR-STR-IND-RMS.03500000
036200     MOVE XL015-EXTD-NOT-AFT-DTE OF PV-RMS-INPUT                  03510000
036300                                    TO XL023-EXTD-NOT-AFT-DTE-RMS.03520000
036400     MOVE XL015-HNG-IND OF PV-RMS-INPUT      TO XL023-HNG-IND-RMS.03530000
036500     MOVE XL015-NW-STR-ORD-IND OF PV-RMS-INPUT                    03540000
036600                                      TO XL023-NW-STR-ORD-IND-RMS.03550000
036700     MOVE XL015-PKGNG-CDE OF PV-RMS-INPUT  TO XL023-PKGNG-CDE-RMS.03560000
036800**?? MOVE XL015-PKGNG-DESC OF PV-RMS-INPUT                        03570000
036900**??                                      TO XL023-PKGNG-DESC-RMS.03580000
037000     MOVE XL015-PTKT-LDTM-DAYS-QTY OF PV-RMS-INPUT                03590000
037100                                  TO XL023-PTKT-LDTM-DAYS-QTY-RMS.03600000
037200     MOVE XL015-SEASET-SHRT-DESC OF PV-RMS-INPUT                  03610000
037300                                    TO XL023-SEASET-SHRT-DESC-RMS.03620000
037400     MOVE XL015-SEASET-YR OF PV-RMS-INPUT  TO XL023-SEASET-YR-RMS.03630000
037500     MOVE XL015-CRE-BY-USR-ID OF PV-RMS-INPUT                     03640000
037600                                       TO XL023-CRE-BY-USR-ID-RMS.03650000
037700     MOVE XL015-PTKT-IND OF PV-RMS-INPUT    TO XL023-PTKT-IND-RMS.03660000
037800     MOVE XL015-C-O-PROD-CDE OF PV-RMS-INPUT                      03670000
037900                                        TO XL023-C-O-PROD-CDE-RMS.03680000
038000     MOVE XL015-AGNT-OFC-CNTRY-CDE OF PV-RMS-INPUT                03690000
038100                                   TO XL023-AGNT-OFC-CNTRY-CDE-RMS03700000
038200     MOVE XL015-IMPRT-VND-NM OF PV-RMS-INPUT                      03710000
038300                                        TO XL023-IMPRT-VND-NM-RMS.03720000
038400     MOVE XL015-IMPRT-FCTRY-NM OF PV-RMS-INPUT                    03730000
038500                                      TO XL023-IMPRT-FCTRY-NM-RMS.03740000
038600     MOVE XL015-IMPRT-VND-ID OF PV-RMS-INPUT                      03750000
038700                                        TO XL023-IMPRT-VND-ID-RMS.03760000
038800     MOVE XL015-IMPRT-FCTRY-ID OF PV-RMS-INPUT                    03770000
038900                                      TO XL023-IMPRT-FCTRY-ID-RMS.03780000
039000     MOVE XL015-DERVD-LBL-TYP-CDE OF PV-RMS-INPUT                 03790000
039100                                  TO XL023-DERVD-LBL-TYP-CDE-RMS. 03800000
039200     IF XL015-UNT-PER-CBMT-QTY OF PV-RMS-INPUT NUMERIC            03810000
039300         MOVE XL015-UNT-PER-CBMT-QTY OF PV-RMS-INPUT              03820000
039400                                    TO XL023-UNT-PER-CBMT-QTY-RMS 03830000
039500     ELSE                                                         03840000
039600         MOVE ZEROES                TO XL023-UNT-PER-CBMT-QTY-RMS 03850000
039700     END-IF.                                                      03860000
039800** TO INCLUDE NEW WAREHOUSE INDICATOR **                          03870000
039900** MS 05/12/2010 BEG                                              03880000
040000     MOVE XL015-WHSE-RPLNT-IND OF PV-RMS-INPUT                    03890000
040100                                  TO XL023-PO-WHSE-RPLNT-IND-RMS. 03900000
040200** MS 05/12/2010 END                                              03910000
040300                                                                  03920000
040400                                                                  03930000
040500     MOVE XL015-DELY-ID         OF PV-RMS-INPUT                   03940000
040600                             TO XL023-DELY-ID-RMS                 03950000
040700     MOVE XL015-PO-SHRT-CYC-IND OF PV-RMS-INPUT                   03960000
040800                                  TO XL023-PO-SHRT-CYC-IND-RMS    03970000
040900                                                                  03980000
041000     IF XL023-ON-BOTH-RMS-LEGACY                                  03990000
041100         CONTINUE                                                 04000000
041200     ELSE                                                         04010000
041300         PERFORM P5000-WRITE-ERROR-RECORD                         04020000
041400     END-IF.                                                      04030000
041500                                                                  04040000
041600***************************************************************** 04050000
041700*  WRITE A LEGACY RECORD TO THE ERROR FILE                        04060000
041800***************************************************************** 04070000
041900 2200-WRITE-LEGACY-ERROR.                                         04080000
042000                                                                  04090000
042100     IF XL023-ON-BOTH-RMS-LEGACY                                  04100000
042200         CONTINUE                                                 04110000
042300     ELSE                                                         04120000
042400         SET XL023-XXT-PO     TO TRUE                             04130000
042500         MOVE XL015-PO-NBR OF PV-LEGACY-INPUT                     04140000
042600                              TO XL023-PO-SORT-KEY-PO             04150000
042700         MOVE SPACES          TO XL023-PO-SORT-KEY-DATA           04160000
042800         INITIALIZE XL023-PO                                      04170000
042900     END-IF.                                                      04180000
043000                                                                  04190000
043100     MOVE XL015-PO-NBR OF PV-LEGACY-INPUT    TO XL023-PO-NBR-LGCY.04200000
043200     MOVE XL015-DEPT-NBR OF PV-LEGACY-INPUT                       04210000
043300                                           TO XL023-DEPT-NBR-LGCY.04220000
043400**?? MOVE XL015-BYR-NBR OF PV-LEGACY-INPUT  TO XL023-BYR-NBR-LGCY.04230000
043500     MOVE XL015-ENT-ID OF PV-LEGACY-INPUT    TO XL023-ENT-ID-LGCY.04240000
043600**?? MOVE XL015-AGNT-ENT-ID OF PV-LEGACY-INPUT                    04250000
043700**??                                    TO XL023-AGNT-ENT-ID-LGCY.04260000
043800     MOVE XL015-CRE-DTE OF PV-LEGACY-INPUT  TO XL023-CRE-DTE-LGCY.04270000
043900     MOVE XL015-NOT-BEF-DTE OF PV-LEGACY-INPUT                    04280000
044000                                        TO XL023-NOT-BEF-DTE-LGCY.04290000
044100     MOVE XL015-NOT-AFT-DTE OF PV-LEGACY-INPUT                    04300000
044200                                        TO XL023-NOT-AFT-DTE-LGCY.04310000
044300**GB MOVE XL015-OTB-EOW-DTE OF PV-LEGACY-INPUT                    04320000
044400**GB                                 TO XL023-OTB-EOW-DTE-LGCY.   04330000
044500**?? MOVE XL015-CLOSE-DTE OF PV-LEGACY-INPUT                      04340000
044600**??                                      TO XL023-CLOSE-DTE-LGCY.04350000
044700     MOVE XL015-PAYT-TERM-ID OF PV-LEGACY-INPUT                   04360000
044800                                       TO XL023-PAYT-TERM-ID-LGCY.04370000
044900**?? MOVE XL015-FRGT-TERM-ID OF PV-LEGACY-INPUT                   04380000
045000**??                                   TO XL023-FRGT-TERM-ID-LGCY.04390000
045100     MOVE XL015-STAT-CDE OF PV-LEGACY-INPUT                       04400000
045200                                           TO XL023-STAT-CDE-LGCY.04410000
045300**?? MOVE XL015-ORIG-PO-APVL-DTE OF PV-LEGACY-INPUT               04420000
045400**??                               TO XL023-ORIG-PO-APVL-DTE-LGCY.04430000
045500**?? MOVE XL015-ORIG-APP-BY-USR-ID OF PV-LEGACY-INPUT             04440000
045600**??                             TO XL023-ORIG-APP-BY-USR-ID-LGCY.04450000
045700     MOVE XL015-EDI-SNT-IND OF PV-LEGACY-INPUT                    04460000
045800                                        TO XL023-EDI-SNT-IND-LGCY.04470000
045900     MOVE XL015-EDI-PO-IND OF PV-LEGACY-INPUT                     04480000
046000                                         TO XL023-EDI-PO-IND-LGCY.04490000
046100     MOVE XL015-IMPRT-PO-IND OF PV-LEGACY-INPUT                   04500000
046200                                       TO XL023-IMPRT-PO-IND-LGCY.04510000
046300     MOVE XL015-FCTRY-NM OF PV-LEGACY-INPUT                       04520000
046400                                           TO XL023-FCTRY-NM-LGCY.04530000
046500     IF XL015-POE-CDE OF PV-LEGACY-INPUT = LOW-VALUES             04540000
046600         MOVE SPACES                        TO XL023-POE-CDE-LGCY 04550000
046700     ELSE                                                         04560000
046800         MOVE XL015-POE-CDE OF PV-LEGACY-INPUT TO                 04570000
046900                                               XL023-POE-CDE-LGCY 04580000
047000     END-IF.                                                      04590000
047100     IF XL015-FOB-CDE OF PV-LEGACY-INPUT = LOW-VALUES             04600000
047200         MOVE SPACES                        TO XL023-FOB-CDE-LGCY 04610000
047300     ELSE                                                         04620000
047400         MOVE XL015-FOB-CDE OF PV-LEGACY-INPUT TO                 04630000
047500                                               XL023-FOB-CDE-LGCY 04640000
047600     END-IF.                                                      04650000
047700     MOVE XL015-PO-TYP-CDE OF PV-LEGACY-INPUT                     04660000
047800                                         TO XL023-PO-TYP-CDE-LGCY.04670000
047900     MOVE XL015-PK-BY-STR-IND OF PV-LEGACY-INPUT                  04680000
048000                                      TO XL023-PK-BY-STR-IND-LGCY.04690000
048100     MOVE XL015-CONSLR-ACTL-DTE OF PV-LEGACY-INPUT                04700000
048200                                    TO XL023-CONSLR-ACTL-DTE-LGCY.04710000
048300     MOVE XL015-CONSLR-REQR-DTE OF PV-LEGACY-INPUT                04720000
048400                                    TO XL023-CONSLR-REQR-DTE-LGCY.04730000
048500     MOVE XL015-CONSLR-RLSE-CDE OF PV-LEGACY-INPUT                04740000
048600                                    TO XL023-CONSLR-RLSE-CDE-LGCY.04750000
048700     MOVE XL015-TKT-MKR-ACTL-DTE OF PV-LEGACY-INPUT               04760000
048800                                   TO XL023-TKT-MKR-ACTL-DTE-LGCY.04770000
048900     MOVE XL015-TKT-MKR-REQR-DTE OF PV-LEGACY-INPUT               04780000
049000                                   TO XL023-TKT-MKR-REQR-DTE-LGCY.04790000
049100     MOVE XL015-TKT-MKR-RLSE-CDE OF PV-LEGACY-INPUT               04800000
049200                                   TO XL023-TKT-MKR-RLSE-CDE-LGCY.04810000
049300     MOVE XL015-RLSE-DTE OF PV-LEGACY-INPUT                       04820000
049400                                           TO XL023-RLSE-DTE-LGCY.04830000
049500     MOVE XL015-FRST-FCTRY-DTE OF PV-LEGACY-INPUT                 04840000
049600                                     TO XL023-FRST-FCTRY-DTE-LGCY.04850000
049700     MOVE XL015-LAST-FCTRY-DTE OF PV-LEGACY-INPUT                 04860000
049800                                     TO XL023-LAST-FCTRY-DTE-LGCY.04870000
049900     MOVE XL015-DIR-STR-IND OF PV-LEGACY-INPUT                    04880000
050000                                        TO XL023-DIR-STR-IND-LGCY.04890000
050100     MOVE XL015-EXTD-NOT-AFT-DTE OF PV-LEGACY-INPUT               04900000
050200                                   TO XL023-EXTD-NOT-AFT-DTE-LGCY.04910000
050300     MOVE XL015-HNG-IND OF PV-LEGACY-INPUT  TO XL023-HNG-IND-LGCY.04920000
050400     MOVE XL015-NW-STR-ORD-IND OF PV-LEGACY-INPUT                 04930000
050500                                     TO XL023-NW-STR-ORD-IND-LGCY.04940000
050600     MOVE XL015-PKGNG-CDE OF PV-LEGACY-INPUT                      04950000
050700                                          TO XL023-PKGNG-CDE-LGCY.04960000
050800**?? MOVE XL015-PKGNG-DESC OF PV-LEGACY-INPUT                     04970000
050900**??                                     TO XL023-PKGNG-DESC-LGCY.04980000
051000     MOVE XL015-PTKT-LDTM-DAYS-QTY OF PV-LEGACY-INPUT             04990000
051100                                 TO XL023-PTKT-LDTM-DAYS-QTY-LGCY.05000000
051200     MOVE XL015-SEASET-SHRT-DESC OF PV-LEGACY-INPUT               05010000
051300                                   TO XL023-SEASET-SHRT-DESC-LGCY.05020000
051400     MOVE XL015-SEASET-YR OF PV-LEGACY-INPUT                      05030000
051500                                          TO XL023-SEASET-YR-LGCY.05040000
051600     MOVE XL015-CRE-BY-USR-ID OF PV-LEGACY-INPUT                  05050000
051700                                      TO XL023-CRE-BY-USR-ID-LGCY.05060000
051800     MOVE XL015-PTKT-IND OF PV-LEGACY-INPUT                       05070000
051900                                           TO XL023-PTKT-IND-LGCY.05080000
052000     MOVE XL015-C-O-PROD-CDE OF PV-LEGACY-INPUT                   05090000
052100                                       TO XL023-C-O-PROD-CDE-LGCY.05100000
052200     MOVE XL015-AGNT-OFC-CNTRY-CDE OF PV-LEGACY-INPUT             05110000
052300                                 TO XL023-AGNT-OFC-CNTRY-CDE-LGCY.05120000
052400     MOVE XL015-UNT-PER-CBMT-QTY OF PV-LEGACY-INPUT               05130000
052500                                   TO XL023-UNT-PER-CBMT-QTY-LGCY.05140000
052600     MOVE XL015-IMPRT-VND-ID OF PV-LEGACY-INPUT                   05150000
052700                                       TO XL023-IMPRT-VND-ID-LGCY.05160000
052800     MOVE XL015-IMPRT-FCTRY-ID OF PV-LEGACY-INPUT                 05170000
052900                                     TO XL023-IMPRT-FCTRY-ID-LGCY.05180000
053000     MOVE XL015-IMPRT-VND-NM OF PV-LEGACY-INPUT                   05190000
053100                                       TO XL023-IMPRT-VND-NM-LGCY.05200000
053200     MOVE XL015-IMPRT-FCTRY-NM OF PV-LEGACY-INPUT                 05210000
053300                                     TO XL023-IMPRT-FCTRY-NM-LGCY.05220000
053400     MOVE XL015-DERVD-LBL-TYP-CDE OF PV-LEGACY-INPUT              05230000
053500                                  TO XL023-DERVD-LBL-TYP-CDE-LGCY.05240000
053600** TO INCLUDE THE NEW WAREHOUSE INDICATOR **                      05250000
053700** MS 05/12/2010 BEG                                              05260000
053800     MOVE XL015-WHSE-RPLNT-IND OF PV-LEGACY-INPUT                 05270000
053900                              TO XL023-PO-WHSE-RPLNT-IND-LGCY.    05280000
054000** MS 05/12/2010 END                                              05290000
054100                                                                  05300000
054200     INITIALIZE PV-NEW-TABLE                                      05310000
054300                PV-WORK-TABLE                                     05320000
054400     MOVE XL015-DELY-ID         OF PV-LEGACY-INPUT                05330000
054500                             TO PV-WORK-TABLE                     05340000
054600                                                                  05350000
054700     INSPECT PV-WORK-TABLE REPLACING LEADING ZEROES BY SPACES.    05360000
054800                                                                  05370000
054900     MOVE 1                           TO PV-SUB-2                 05380000
055000     PERFORM VARYING PV-SUB-1 FROM 1 BY 1 UNTIL PV-SUB-1 > 10     05390000
055100         IF PV-WORK-DELY (PV-SUB-1) = SPACE                       05400000
055200             CONTINUE                                             05410000
055300         ELSE                                                     05420000
055400             MOVE PV-WORK-DELY (PV-SUB-1) TO                      05430000
055500                                PV-NEW-DELY (PV-SUB-2)            05440000
055600             ADD 1                        TO PV-SUB-2             05450000
055700         END-IF                                                   05460000
055800     END-PERFORM                                                  05470000
055900                                                                  05480000
056000     MOVE PV-NEW-TABLE       TO XL023-DELY-ID-LGCY                05490000
056100                                                                  05500000
056200     MOVE XL015-PO-SHRT-CYC-IND OF PV-LEGACY-INPUT                05510000
056300                                  TO XL023-PO-SHRT-CYC-IND-LGCY   05520000
056400                                                                  05530000
056500     IF XL023-ON-BOTH-RMS-LEGACY                                  05540000
056600         SET PS-ERROR-NO  TO  TRUE                                05550000
056700         PERFORM 2300-COMPARE                                     05560000
056800     ELSE                                                         05570000
056900         PERFORM P5000-WRITE-ERROR-RECORD                         05580000
057000     END-IF.                                                      05590000
057100                                                                  05600000
057200***************************************************************** 05610000
057300*  COMPARE FIELDS TO FIND DISCREPANCIES.                          05620000
057400***************************************************************** 05630000
057500 2300-COMPARE.                                                    05640000
057600                                                                  05650000
057700     IF XL023-PO-NBR-RMS  NOT =  XL023-PO-NBR-LGCY                05660000
057800         MOVE '*' TO  XL023-PO-NBR-DIFF                           05670000
057900         SET PS-ERROR-YES TO  TRUE                                05680000
058000     END-IF.                                                      05690000
058100     IF XL023-DEPT-NBR-RMS NOT =  XL023-DEPT-NBR-LGCY             05700000
058200         MOVE '*'  TO XL023-DEPT-NBR-DIFF                         05710000
058300         SET PS-ERROR-YES TO  TRUE                                05720000
058400     END-IF.                                                      05730000
058500**?? IF XL023-BYR-NBR-RMS NOT =  XL023-BYR-NBR-LGCY               05740000
058600**??     MOVE '*'  TO XL023-BYR-NBR-DIFF                          05750000
058700**??     SET PS-ERROR-YES TO  TRUE                                05760000
058800**?? END-IF.                                                      05770000
058900     IF XL023-ENT-ID-RMS  NOT =  XL023-ENT-ID-LGCY                05780000
059000         MOVE '*'  TO XL023-ENT-ID-DIFF                           05790000
059100         SET PS-ERROR-YES TO  TRUE                                05800000
059200     END-IF.                                                      05810000
059300**?? IF XL023-AGNT-ENT-ID-RMS  NOT =  XL023-AGNT-ENT-ID-LGCY      05820000
059400**??     MOVE '*'  TO XL023-AGNT-ENT-ID-DIFF                      05830000
059500**??     SET PS-ERROR-YES TO  TRUE                                05840000
059600**?? END-IF.                                                      05850000
059700**?? IF XL023-CRE-DTE-RMS NOT  =  XL023-CRE-DTE-LGCY              05860000
059800**??     MOVE '*'  TO XL023-CRE-DTE-DIFF                          05870000
059900**??     SET PS-ERROR-YES TO  TRUE                                05880000
060000**?? END-IF.                                                      05890000
060100     IF XL023-NOT-BEF-DTE-RMS NOT  =  XL023-NOT-BEF-DTE-LGCY      05900000
060200         MOVE '*'  TO XL023-NOT-BEF-DTE-DIFF                      05910000
060300         SET PS-ERROR-YES TO  TRUE                                05920000
060400     END-IF.                                                      05930000
060500     IF XL023-NOT-AFT-DTE-RMS(1:8) NOT =                          05940000
060600                                      XL023-NOT-AFT-DTE-LGCY(1:8) 05950000
060700         MOVE '*'  TO XL023-NOT-AFT-DTE-DIFF                      05960000
060800         SET PS-ERROR-YES TO  TRUE                                05970000
060900     END-IF.                                                      05980000
      **GB 5/11/13 RMS13 FIELD HAS NO CURRENT VALUE                     05990000
061000**GB IF XL023-OTB-EOW-DTE-RMS NOT =   XL023-OTB-EOW-DTE-LGCY      06000000
061100**GB     MOVE '*'  TO XL023-OTB-EOW-DTE-DIFF                      06010000
061200**GB     SET PS-ERROR-YES TO  TRUE                                06020000
061300**GB END-IF.                                                      06030000
061400**?? IF XL023-CLOSE-DTE-RMS NOT =  XL023-CLOSE-DTE-LGCY           06040000
061500**??     MOVE '*'  TO XL023-CLOSE-DTE-DIFF                        06050000
061600**??     SET PS-ERROR-YES TO  TRUE                                06060000
061700**?? END-IF.                                                      06070000
061800     IF XL023-PAYT-TERM-ID-RMS NOT =  XL023-PAYT-TERM-ID-LGCY     06080000
061900         MOVE '*'  TO XL023-PAYT-TERM-ID-DIFF                     06090000
062000         SET PS-ERROR-YES TO  TRUE                                06100000
062100     END-IF.                                                      06110000
062200**?? IF XL023-FRGT-TERM-ID-RMS NOT =  XL023-FRGT-TERM-ID-LGCY     06120000
062300**??     MOVE '*'  TO XL023-FRGT-TERM-ID-DIFF                     06130000
062400**??     SET PS-ERROR-YES TO  TRUE                                06140000
062500**?? END-IF.                                                      06150000
062600     IF XL023-STAT-CDE-RMS =  'W'                                 06160000
062700         IF XL023-STAT-CDE-LGCY =  'A' OR                         06170000
062800            XL023-STAT-CDE-LGCY =  'C' OR                         06180000
062900            XL023-STAT-CDE-LGCY =  'W' OR                         06190000
063000            XL023-STAT-CDE-LGCY =  'P'                            06200000
063100              MOVE ' '     TO XL023-STAT-CDE-DIFF                 06210000
063200         ELSE                                                     06220000
063300             IF XL023-STAT-CDE-LGCY NOT = 'W'                     06230000
063400                 MOVE '*'  TO XL023-STAT-CDE-DIFF                 06240000
063500                 SET PS-ERROR-YES TO  TRUE                        06250000
063600             END-IF                                               06260000
063700         END-IF                                                   06270000
063800     ELSE                                                         06280000
063900         IF XL023-STAT-CDE-RMS =  'P'                             06290000
064000             IF XL023-STAT-CDE-LGCY =  'C' OR                     06300000
064100                XL023-STAT-CDE-LGCY =  'P'                        06310000
064200                  MOVE ' '     TO XL023-STAT-CDE-DIFF             06320000
064300             ELSE                                                 06330000
064400                 IF XL023-STAT-CDE-LGCY NOT = 'P'                 06340000
064500                     MOVE '*'  TO XL023-STAT-CDE-DIFF             06350000
064600                     SET PS-ERROR-YES TO  TRUE                    06360000
064700                 END-IF                                           06370000
064800             END-IF                                               06380000
064900         ELSE                                                     06390000
065000             IF XL023-STAT-CDE-RMS NOT =  XL023-STAT-CDE-LGCY     06400000
065100                 MOVE '*'  TO XL023-STAT-CDE-DIFF                 06410000
065200                 SET PS-ERROR-YES TO  TRUE                        06420000
065300             END-IF                                               06430000
065400         END-IF                                                   06440000
065500     END-IF.                                                      06450000
065600**?? IF XL023-ORIG-PO-APVL-DTE-RMS  NOT =                         06460000
065700**??                       XL023-ORIG-PO-APVL-DTE-LGCY            06470000
065800**??     MOVE '*'  TO XL023-ORIG-PO-APVL-DTE-DIFF                 06480000
065900**??     SET PS-ERROR-YES TO  TRUE                                06490000
066000**?? END-IF.                                                      06500000
066100**?? IF XL023-ORIG-APP-BY-USR-ID-RMS  NOT =                       06510000
066200**??                     XL023-ORIG-APP-BY-USR-ID-LGCY            06520000
066300**??     MOVE '*'  TO XL023-ORIG-APP-BY-USR-ID-DIFF               06530000
066400**??     SET PS-ERROR-YES TO  TRUE                                06540000
066500**?? END-IF.                                                      06550000
066600**?? IF XL023-EDI-SNT-IND-RMS NOT =                               06560000
066700**??    XL023-EDI-SNT-IND-LGCY                                    06570000
066800**??      MOVE '*'  TO XL023-EDI-SNT-IND-DIFF                     06580000
066900**?? END-IF.                                                      06590000
067000* IT WAS DECIDED BY D. GARBISCH, J. KRAMER, K. WALL, ON 7/17, THAT06600000
067100* COULD NOT BE A DATA INTEGRITY CHECK ON THE EDI-PO-IND FIELD.  TH06610000
067200* REASON IS THAT DURING CONVERSION FROM LEGACY TO RMS THE INDICATO06620000
067300* MIGHT GET CHANGED BUT NO MESSAGE WOULD BE SENT TO LEGACY.  ALSO,06630000
067400* THIS INDICATOR CAN BE CHANGED ON LEGACY BUT NOT RMS.            06640000
067500**?? IF XL023-EDI-PO-IND-RMS  NOT =  XL023-EDI-PO-IND-LGCY        06650000
067600**??     MOVE '*'  TO XL023-EDI-PO-IND-DIFF                       06660000
067700**??     SET PS-ERROR-YES TO  TRUE                                06670000
067800**?? END-IF.                                                      06680000
      *CLP 08/12/14 - START                                             06681010
067900*    IF XL023-IMPRT-PO-IND-RMS = 'N'   AND                        06690010
068000*       XL023-IMPRT-PO-IND-LGCY = ' '                             06700010
068100*         MOVE ' '  TO XL023-IMPRT-PO-IND-DIFF                    06710010
068200*    ELSE                                                         06720010
068300*        IF XL023-IMPRT-PO-IND-RMS  NOT =  XL023-IMPRT-PO-IND-LGCY06730010
068400*            MOVE '*'  TO XL023-IMPRT-PO-IND-DIFF                 06740010
068500*            SET PS-ERROR-YES TO  TRUE                            06750010
068600*        END-IF                                                   06760010
068700*    END-IF.                                                      06770010
      *CLP 08/12/14 - END                                               06771010
068800**?? IF XL023-FCTRY-NM-RMS  NOT =  XL023-FCTRY-NM-LGCY            06780000
068900**??     MOVE '*'  TO XL023-FCTRY-NM-DIFF                         06790000
069000**??     SET PS-ERROR-YES TO  TRUE                                06800000
069100**?? END-IF.                                                      06810000
069200     IF XL023-POE-CDE-RMS  NOT =  XL023-POE-CDE-LGCY              06820000
069300         MOVE '*'  TO XL023-POE-CDE-DIFF                          06830000
069400         SET PS-ERROR-YES TO  TRUE                                06840000
069500     END-IF.                                                      06850000
069600     IF XL023-FOB-CDE-RMS  NOT =  XL023-FOB-CDE-LGCY              06860000
069700         MOVE '*'  TO XL023-FOB-CDE-DIFF                          06870000
069800         SET PS-ERROR-YES TO  TRUE                                06880000
069900     END-IF.                                                      06890000
070000     IF XL023-PO-TYP-CDE-RMS  NOT =  XL023-PO-TYP-CDE-LGCY        06900000
070100         MOVE '*'  TO XL023-PO-TYP-CDE-DIFF                       06910000
070200         SET PS-ERROR-YES TO  TRUE                                06920000
070300     END-IF.                                                      06930000
070400     IF XL023-PK-BY-STR-IND-RMS = 'N'  AND                        06940000
070500        XL023-PK-BY-STR-IND-LGCY = ' '                            06950000
070600          MOVE ' '  TO XL023-PK-BY-STR-IND-DIFF                   06960000
070700     ELSE                                                         06970000
070800         IF XL023-PK-BY-STR-IND-RMS    NOT =                      06980000
070900            XL023-PK-BY-STR-IND-LGCY                              06990000
071000              MOVE '*'  TO XL023-PK-BY-STR-IND-DIFF               07000000
071100              SET PS-ERROR-YES TO  TRUE                           07010000
071200         END-IF                                                   07020000
071300     END-IF.                                                      07030000
071400     IF XL023-CONSLR-ACTL-DTE-RMS  NOT =                          07040000
071500                         XL023-CONSLR-ACTL-DTE-LGCY               07050000
071600         MOVE '*'  TO XL023-CONSLR-ACTL-DTE-DIFF                  07060000
071700         SET PS-ERROR-YES TO  TRUE                                07070000
071800     END-IF.                                                      07080000
      *CLP 07/29/14 START                                               07081003
071900*    IF XL023-CONSLR-REQR-DTE-RMS  NOT =                          07090003
072000*                        XL023-CONSLR-REQR-DTE-LGCY               07100003
072100*        MOVE '*'  TO XL023-CONSLR-REQR-DTE-DIFF                  07110003
072200*        SET PS-ERROR-YES TO  TRUE                                07120003
072300*    END-IF.                                                      07130003
      *CLP 07/29/14 END                                                 07131003
072400     IF XL023-CONSLR-RLSE-CDE-RMS = 'D' AND                       07140000
072500                         XL023-CONSLR-RLSE-CDE-LGCY  = 'N'        07150000
072600         MOVE ' '  TO XL023-CONSLR-RLSE-CDE-DIFF                  07160000
072700     ELSE                                                         07170000
072800         IF XL023-CONSLR-RLSE-CDE-RMS NOT =                       07180000
072900                               XL023-CONSLR-RLSE-CDE-LGCY         07190000
073000             MOVE '*'  TO XL023-CONSLR-RLSE-CDE-DIFF              07200000
073100             SET PS-ERROR-YES TO  TRUE                            07210000
073200         END-IF                                                   07220000
073300     END-IF.                                                      07230000
073400     IF XL023-TKT-MKR-ACTL-DTE-RMS  NOT =                         07240000
073500                         XL023-TKT-MKR-ACTL-DTE-LGCY              07250000
073600         MOVE '*'  TO XL023-TKT-MKR-ACTL-DTE-DIFF                 07260000
073700         SET PS-ERROR-YES TO  TRUE                                07270000
073800     END-IF.                                                      07280000
      *CLP 07/29/14 - START                                             07281003
073900*    IF XL023-TKT-MKR-REQR-DTE-RMS  NOT =                         07290003
074000*                        XL023-TKT-MKR-REQR-DTE-LGCY              07300003
074100*        MOVE '*'  TO XL023-TKT-MKR-REQR-DTE-DIFF                 07310003
074200*        SET PS-ERROR-YES TO  TRUE                                07320003
074300*    END-IF.                                                      07330003
      *CLP 07/29/14 - END                                               07331003
074400     IF XL023-TKT-MKR-RLSE-CDE-RMS = 'D' AND                      07340000
074500                         XL023-TKT-MKR-RLSE-CDE-LGCY = 'N'        07350000
074600         MOVE ' '  TO XL023-TKT-MKR-RLSE-CDE-DIFF                 07360000
074700     ELSE                                                         07370000
074800         IF XL023-TKT-MKR-RLSE-CDE-RMS  NOT =                     07380000
074900                             XL023-TKT-MKR-RLSE-CDE-LGCY          07390000
075000             MOVE '*'  TO XL023-TKT-MKR-RLSE-CDE-DIFF             07400000
075100             SET PS-ERROR-YES TO  TRUE                            07410000
075200         END-IF                                                   07420000
075300     END-IF.                                                      07430000
P5207G*    IF XL023-RLSE-DTE-RMS  NOT =  XL023-RLSE-DTE-LGCY            07440000
P5207G*        MOVE '*'  TO XL023-RLSE-DTE-DIFF                         07450000
P5207G*        SET PS-ERROR-YES TO  TRUE                                07460000
P5207G*    END-IF.                                                      07470000
075800     IF XL023-FRST-FCTRY-DTE-RMS  NOT =  XL023-FRST-FCTRY-DTE-LGCY07480000
075900         MOVE '*'  TO XL023-FRST-FCTRY-DTE-DIFF                   07490000
076000         SET PS-ERROR-YES TO  TRUE                                07500000
076100     END-IF.                                                      07510000
076200     IF XL023-LAST-FCTRY-DTE-RMS  NOT =  XL023-LAST-FCTRY-DTE-LGCY07520000
076300         MOVE '*'  TO XL023-LAST-FCTRY-DTE-DIFF                   07530000
076400         SET PS-ERROR-YES TO  TRUE                                07540000
076500     END-IF.                                                      07550000
076600     IF XL023-DIR-STR-IND-RMS  NOT =  XL023-DIR-STR-IND-LGCY      07560000
076700         MOVE '*'  TO XL023-DIR-STR-IND-DIFF                      07570000
076800         SET PS-ERROR-YES TO  TRUE                                07580000
076900     END-IF.                                                      07590000
      *CLP 06/23/14 - START                                             07600000
077000*    IF XL023-EXTD-NOT-AFT-DTE-RMS  NOT =                         07610000
077100*                                      XL023-EXTD-NOT-AFT-DTE-LGCY07620000
077200*        MOVE '*'  TO XL023-EXTD-NOT-AFT-DTE-DIFF                 07630000
077300*        SET PS-ERROR-YES TO  TRUE                                07640000
077400*    END-IF.                                                      07650000
      *CLP 06/23/14 - END                                               07660000
P5207G*    IF XL023-HNG-IND-RMS = 'N' AND XL023-HNG-IND-LGCY = ' '      07670000
P5207G*            MOVE ' '  TO XL023-HNG-IND-DIFF                      07680000
P5207G*    ELSE                                                         07690000
P5207G*        IF XL023-HNG-IND-RMS  NOT =  XL023-HNG-IND-LGCY          07700000
P5207G*            MOVE '*'  TO XL023-HNG-IND-DIFF                      07710000
P5207G*            SET PS-ERROR-YES TO  TRUE                            07720000
P5207G*        END-IF                                                   07730000
P5207G*    END-IF.                                                      07740000
078300     IF XL023-NW-STR-ORD-IND-RMS  NOT =  XL023-NW-STR-ORD-IND-LGCY07750000
078400         MOVE '*'  TO XL023-NW-STR-ORD-IND-DIFF                   07760000
078500         SET PS-ERROR-YES TO  TRUE                                07770000
078600     END-IF.                                                      07780000
      ** GB 05/08/13  BEG RMS13 PASSED A 'P' FOR PBS ORDERS             07790000
      ** LEGACY IS POPULATED BY SPACES, CHECK TO MOVE SPACE             07800000
           IF XL023-PKGNG-CDE-RMS  = PC-P                               07810000
                MOVE SPACE TO XL023-PKGNG-CDE-RMS                       07820000
           END-IF                                                       07830000
      ** GB 05/08/13  END                                               07840000
078700     IF XL023-PKGNG-CDE-RMS  NOT =  XL023-PKGNG-CDE-LGCY          07850000
078800         MOVE '*'  TO XL023-PKGNG-CDE-DIFF                        07860000
078900         SET PS-ERROR-YES TO  TRUE                                07870000
079000     END-IF.                                                      07880000
079100**?? IF XL023-PKGNG-DESC-RMS  NOT =  XL023-PKGNG-DESC-LGCY        07890000
079200**??     MOVE '*'  TO XL023-PKGNG-DESC-DIFF                       07900000
079300**??     SET PS-ERROR-YES TO  TRUE                                07910000
079400**?? END-IF.                                                      07920000
      *CLP 07/29/14 - START                                             07921003
079500*    IF XL023-PTKT-LDTM-DAYS-QTY-RMS  NOT =                       07930003
079600*                       XL023-PTKT-LDTM-DAYS-QTY-LGCY             07940003
079700*        MOVE '*'  TO XL023-PTKT-LDTM-DAYS-QTY-DIFF               07950003
079800*        SET PS-ERROR-YES TO  TRUE                                07960003
079900*    END-IF.                                                      07970003
      *CLP 07/29/14 - END                                               07971003
P5207G*    IF XL023-SEASET-SHRT-DESC-RMS  NOT =                         07980000
P5207G*                                      XL023-SEASET-SHRT-DESC-LGCY07990000
P5207G*        MOVE '*'  TO XL023-SEASET-SHRT-DESC-DIFF                 08000000
P5207G*        SET PS-ERROR-YES TO  TRUE                                08010000
P5207G*    END-IF.                                                      08020000
P5207G*    IF XL023-SEASET-YR-RMS  NOT =  XL023-SEASET-YR-LGCY          08030000
P5207G*        MOVE '*'  TO XL023-SEASET-YR-DIFF                        08040000
P5207G*        SET PS-ERROR-YES TO  TRUE                                08050000
P5207G*    END-IF.                                                      08060000
080900**?? IF XL023-CRE-BY-USR-ID-RMS  NOT =  XL023-CRE-BY-USR-ID-LGCY  08070000
081000**??     MOVE '*'  TO XL023-CRE-BY-USR-ID-DIFF                    08080000
081100**??     SET PS-ERROR-YES TO  TRUE                                08090000
081200**?? END-IF.                                                      08100000
      *CLP 07/29/14 -START                                              08101003
081300*    IF XL023-PTKT-IND-RMS = 'N' AND XL023-PTKT-IND-LGCY = ' '    08110003
081400*        MOVE ' '  TO XL023-PTKT-IND-DIFF                         08120003
081500*    ELSE                                                         08130003
081600*        IF XL023-PTKT-IND-RMS  NOT =  XL023-PTKT-IND-LGCY        08140003
081700*            MOVE '*'  TO XL023-PTKT-IND-DIFF                     08150003
081800*            SET PS-ERROR-YES TO  TRUE                            08160003
081900*        END-IF                                                   08170003
082000*    END-IF.                                                      08180003
      *CLP 07/29/14 -END                                                08181003
082100     IF XL023-C-O-PROD-CDE-RMS  NOT =  XL023-C-O-PROD-CDE-LGCY    08190000
082200         MOVE '*'  TO XL023-C-O-PROD-CDE-DIFF                     08200000
082300         SET PS-ERROR-YES TO  TRUE                                08210000
082400     END-IF.                                                      08220000
082500     IF XL023-AGNT-OFC-CNTRY-CDE-RMS  NOT =                       08230000
082600                                XL023-AGNT-OFC-CNTRY-CDE-LGCY     08240000
082700         MOVE '*'  TO XL023-AGNT-OFC-CNTRY-CDE-DIFF               08250000
082800         SET PS-ERROR-YES TO  TRUE                                08260000
082900     END-IF.                                                      08270000
      *CLP 08/04/2014 START                                             08271008
083000*    IF XL023-UNT-PER-CBMT-QTY-RMS  NOT =                         08280008
083100*                                      XL023-UNT-PER-CBMT-QTY-LGCY08290008
083200*        MOVE '*'  TO XL023-UNT-PER-CBMT-QTY-DIFF                 08300008
083300*        SET PS-ERROR-YES TO  TRUE                                08310008
083400*    END-IF.                                                      08320008
      *CLP 08/04/2014 END                                               08321008
083500     IF XL023-QTA-CTG-CDE-RMS  NOT =   XL023-QTA-CTG-CDE-LGCY     08330000
083600         MOVE '*'  TO XL023-QTA-CTG-CDE-DIFF                      08340000
083700         SET PS-ERROR-YES TO  TRUE                                08350000
083800     END-IF.                                                      08360000
083900*    IF XL023-IMPRT-VND-NM-RMS  NOT =  XL023-IMPRT-VND-NM-LGCY    08370000
084000*        MOVE '*'  TO XL023-IMPRT-VND-NM-DIFF                     08380000
084100*        SET PS-ERROR-YES TO  TRUE                                08390000
084200*    END-IF.                                                      08400000
084300*    IF XL023-IMPRT-FCTRY-NM-RMS  NOT =  XL023-IMPRT-FCTRY-NM-LGCY08410000
084400*        MOVE '*'  TO XL023-IMPRT-FCTRY-NM-DIFF                   08420000
084500*        SET PS-ERROR-YES TO  TRUE                                08430000
084600*    END-IF.                                                      08440000
084700     IF XL023-IMPRT-VND-ID-RMS  NOT =  XL023-IMPRT-VND-ID-LGCY    08450000
084800         MOVE '*'  TO XL023-IMPRT-VND-ID-DIFF                     08460000
084900         SET PS-ERROR-YES TO  TRUE                                08470000
085000     END-IF.                                                      08480000
085100     IF XL023-IMPRT-FCTRY-ID-RMS  NOT =  XL023-IMPRT-FCTRY-ID-LGCY08490000
085200         MOVE '*'  TO XL023-IMPRT-FCTRY-ID-DIFF                   08500000
085300         SET PS-ERROR-YES TO  TRUE                                08510000
085400     END-IF.                                                      08520000
085500     IF XL023-DERVD-LBL-TYP-CDE-RMS                               08530000
085600                                NOT = XL023-DERVD-LBL-TYP-CDE-LGCY08540000
085700         MOVE '*'  TO XL023-DERVD-LBL-TYP-CDE-DIFF                08550000
085800         SET PS-ERROR-YES TO  TRUE                                08560000
085900     END-IF.                                                      08570000
086000**?? IF XL023-AGNT-ENT-ID-RMS  NOT =   XL023-AGNT-ENT-ID-LGCY     08580000
086100**??     MOVE '*'  TO XL023-AGNT-ENT-ID-DIFF                      08590000
086200**??     SET PS-ERROR-YES TO  TRUE                                08600000
086300**?? END-IF.                                                      08610000
086400                                                                  08620000
      *CLP 07/29/14 START                                               08621003
086500*    IF XL023-DELY-ID-RMS                                         08630003
086600*                               NOT = XL023-DELY-ID-LGCY          08640003
086700*        MOVE '*'  TO XL023-DELY-ID-DIFF                          08650003
086800*        SET PS-ERROR-YES TO  TRUE                                08660003
086900*    END-IF.                                                      08670003
      *CLP 07/29/14 END                                                 08671003
087000                                                                  08680000
087100     IF XL023-PO-SHRT-CYC-IND-RMS                                 08690000
087200                                NOT = XL023-PO-SHRT-CYC-IND-LGCY  08700000
087300         MOVE '*'  TO XL023-PO-SHRT-CYC-IND-DIFF                  08710000
087400         SET PS-ERROR-YES TO  TRUE                                08720000
087500     END-IF.                                                      08730000
087600                                                                  08740000
087700                                                                  08750000
087800** TO COMPARE THE RMS AND LEGACY WAREHOUSE REPLENISHMENT INDICATOR08760000
087900** FIELD **                                                       08770000
088000** MS 05/12/2010 BEG                                              08780000
088100     IF XL023-PO-WHSE-RPLNT-IND-RMS                               08790000
088200                          NOT =  XL023-PO-WHSE-RPLNT-IND-LGCY     08800000
088300          MOVE '*' TO  XL023-PO-WHSE-RPLNT-IND-DIFF               08810000
088400          SET PS-ERROR-YES TO  TRUE                               08820000
088500     END-IF.                                                      08830000
088600** MS 05/12/2010 END                                              08840000
088700                                                                  08850000
088800     IF PS-ERROR-YES                                              08860000
088900         ADD 1   TO PV-RECORDS-DATA-MISMATCH                      08870000
089000         PERFORM P5000-WRITE-ERROR-RECORD                         08880000
089100     END-IF.                                                      08890000
089200                                                                  08900000
089300 P5000-WRITE-ERROR-RECORD.                                        08910000
089400                                                                  08920000
089500     ADD +1  TO PV-RECORDS-WRITTEN.                               08930000
089600     WRITE ERROR-RECORD FROM   PV-ERROR-OUTPUT.                   08940000
089700                                                                  08950000
089800*    SET SWITCH FOR E-MAIL NOTIFICATION OF ERROR.                 08960000
089900*    SET PS-EMAIL-YES       TO TRUE.                              08970000
090000                                                                  08980000
