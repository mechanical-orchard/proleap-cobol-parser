       IDENTIFICATION DIVISION.                                         00010099
       PROGRAM-ID.    POKCS111.                                         00020099
       AUTHOR.        CHRIS KUNSTMANN.                                  00030099
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040099
       DATE-WRITTEN.  03/2000.                                          00050099
       DATE-COMPILED.                                                   00060099
      *---------------------------------------------------------------* 00070099
      *    W111 - MULTIPLE PACK INQUIRY PROGRAM                         00080099
      *---------------------------------------------------------------* 00090099
      *                                                               * 00100099
      *   THIS PROGRAM DISPLAYS SELECTED PACK DATA FOR A GIVEN PO NBR.* 00110099
      *   F7/F8 TO SCROLL THROUGH LINES IN A PACK, IN CASE IT         * 00120099
      *   DOESN'T FIT ON ONE SCREEN. F19/F20 TO SCROLL FROM PACK TO   * 00130099
      *   PACK FOR A SPECIFIC PO.                                     * 00140099
      *                                                               * 00150099
      *---------------------------------------------------------------* 00160099
                                                                        00170099
W24803******************************************************************00180099
W24803* 04/25/03 - RAMAKRISHNA PRASAD V - WR NO. W24803*                00190099
W24803*          - IN MAP POKM111 REPLACED DEPARTMENT, CLASS AND        00200099
W24803*            SEQUENCE NUMBER BY DEPARTMENT, MAJOR CLASS, SUB CLASS00210099
W24803*            AND SKU NUMBER.                                      00220099
W24803*          - DCLGEN OF DB2 TABLES XLT00003 AND XLT00004 WERE      00230099
W24803*            ADDED.                                               00240099
W24803*          - DK-DB2-KEYS WERE REMOVED FROM WORKING-STORAGE        00250099
W24803*            SECTION                                              00260099
W24803*          - ADDED THE NEW FILLER AFTER THE STRUCTURE             00270099
W24803*            ASC-SPECIFIC-COMMAREA                                00280099
W24803*          - ADDED LOGIC TO HANDLE DUMMY AND DELETED SKU.         00290099
W24803******************************************************************00300099
C98147* DATE  20/11/2014                                              * 00310099
C98147*       CHANGE MADE: PO EXTENDED DIGIT CHANGES.                 * 00320099
C98147*       EXTENDED PO# FROM 7 TO 8 IN MAP POKM111.                * 00330099
C98147*      MADE BY: COGNIZANT              WR/IR: CHG0098147        * 00340099
      ***************************************************************** 00350099
076319* DATE  10/27/2021                                                00351099
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00352099
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00353099
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00354099
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00355099
076312*                                                               * 00356099
076318*---------------------------------------------------------------* 00357099
CICS  *  CHANGED 11/16/2022    BY BARB SCHULTZ    WR: CHG0278485        00358099
CICS  *                                                               * 00359099
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00359199
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00359299
CICS  *---------------------------------------------------------------* 00359599
       ENVIRONMENT DIVISION.                                            00360099
                                                                        00370099
       DATA DIVISION.                                                   00380099
                                                                        00390099
       WORKING-STORAGE SECTION.                                         00400099
      *                                                                 00410099
                                                                        00420099
       01  PC-PROGRAM-CONSTANTS.                                        00430099
           05  PC-CURRENT-MAP-NAME          PIC  X(08)     VALUE        00440099
                                                           'PO111A  '.  00450099
           05  PC-CURRENT-MAPSET-NAME       PIC  X(08)     VALUE        00460099
                                                           'POKM111 '.  00470099
           05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)     VALUE        00480099
                                                           'POKCS111'.  00490099
           05  PC-LIST-QUEUE-SEQ            PIC  9(01)     VALUE 1.     00500099
           05  PC-LIST2-QUEUE-SEQ           PIC  9(01)     VALUE 4.     00510099
           05  PC-ITEMS-PER-PANEL           PIC S9(04)     VALUE +10    00520099
                                                            COMP SYNC.  00530099
           05  PC-MAX-BLOCKS                PIC S9(04)     VALUE +2     00540099
                                                            COMP SYNC.  00550099
           05  PC-MAX-ITEMS                 PIC S9(09)     VALUE        00560099
                                                               +1000000 00570099
                                                            COMP-3.     00580099
           05  PC-NUMBER-LENGTH             PIC S9(04)     VALUE +7     00590099
                                                            COMP SYNC.  00600099
                                                                        00610099
       01  PC-TSYMSG-NUMBERS.                                           00620099
           05  PC-TSYMSG-00008              PIC 9(5)       VALUE 00008. 00630099
           05  PC-TSYMSG-00057              PIC 9(5)       VALUE 00057. 00640099
           05  PC-TSYMSG-00069              PIC 9(5)       VALUE 00069. 00650099
           05  PC-TSYMSG-00070              PIC 9(5)       VALUE 00070. 00660099
           05  PC-TSYMSG-00279              PIC 9(5)       VALUE 00279. 00670099
           05  PC-TSYMSG-00461              PIC 9(5)       VALUE 00461. 00680099
           05  PC-TSYMSG-00588              PIC 9(5)       VALUE 00588. 00690099
           05  PC-TSYMSG-01279              PIC 9(5)       VALUE 01279. 00700099
           05  PC-TSYMSG-02092              PIC 9(5)       VALUE 02092. 00710099
           05  PC-TSYMSG-02095              PIC 9(5)       VALUE 02095. 00720099
           05  PC-TSYMSG-02096              PIC 9(5)       VALUE 02096. 00730099
           05  PC-TSYMSG-02117              PIC 9(5)       VALUE 02117. 00740099
           05  PC-TSYMSG-02762              PIC 9(5)       VALUE 02762. 00750099
                                                                        00760099
       01  PS-PROGRAM-SUBSCRIPTS.                                       00770099
           05  PS-SUB                       PIC S9(04)   VALUE +0       00780099
                                                           COMP SYNC.   00790099
                                                                        00800099
       01  PS-PROGRAM-SWITCHES.                                         00810099
           05  PS-ERROR-SW                  PIC X(01)      VALUE 'Y'.   00820099
               88  PS-ERROR-NO                             VALUE 'Y'.   00830099
               88  PS-ERROR                                VALUE 'N'.   00840099
           05  PS-COMMAREA-SW               PIC X(01)      VALUE 'N'.   00850099
               88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00860099
               88  PS-COMMAREA-VALID                       VALUE 'Y'.   00870099
           05  PS-LIST-END-SW               PIC X(01)      VALUE 'N'.   00880099
               88  PS-LIST-NOT-END                         VALUE 'N'.   00890099
               88  PS-LIST-END                             VALUE 'Y'.   00900099
           05  PS-RV-STATUS-SW              PIC X(01)      VALUE 'N'.   00910099
               88  PS-RV-STATUS                            VALUE 'Y'.   00920099
               88  PS-NOT-RV-STATUS                        VALUE 'N'.   00930099
                                                                        00940099
       01  PV-PROGRAM-VARIABLES.                                        00950099
           05  PV-COMP3-FIELDS              COMP-3.                     00960099
               10  PV-READ-COUNT            PIC S9(09)     VALUE ZEROES.00970099
               10  PV-TOP-ITEM              PIC S9(09)     VALUE ZEROES.00980099
               10  PV-BOTTOM-ITEM           PIC S9(09)     VALUE ZEROES.00990099
                                                                        01000099
           05  PV-REMAINDER                 PIC S9(04)     VALUE ZEROES 01010099
                                                           COMP SYNC.   01020099
           05  PV-BLOCK-NUMBER              PIC S9(04)     VALUE ZEROES 01030099
                                                           COMP SYNC.   01040099
           05  PV-CICS-RESP                 PIC S9(04)     VALUE ZEROES 01050099
                                                           COMP SYNC.   01060099
           05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(04)     VALUE ZEROES 01070099
                                                           COMP SYNC.   01080099
           05  PV-PACK-HIGH-BLOCK-WRITTEN   PIC S9(04)     VALUE ZEROES 01090099
                                                           COMP SYNC.   01100099
           05  PV-PO-PREPK-ID               PIC S9(04)     VALUE ZEROES 01110099
                                                           COMP SYNC.   01120099
           05  PV-NBR-ITEMS-READ            PIC S9(09)     VALUE ZEROES 01130099
                                                           COMP-3.      01140099
           05  PV-KEY-DATA.                                             01150099
               10  PV-LIST-QUEUE-NAME.                                  01160099
                   15  PV-LIST-TERM-ID      PIC  X(04).                 01170099
                   15  PV-LIST-TASK-NBR     PIC S9(05)     COMP-3.      01180099
                   15  PV-LIST-SEQ          PIC  9(01).                 01190099
               10  PV-PACK-QUEUE-NAME.                                  01200099
                   15  PV-PACK-TERM-ID      PIC  X(04).                 01210099
                   15  PV-PACK-TASK-NBR     PIC S9(05)     COMP-3.      01220099
                   15  PV-PACK-SEQ          PIC  9(01).                 01230099
               10  PV-PO-NBR                PIC S9(09)     COMP.        01240099
               10  FILLER                   PIC S9(09)     COMP.        01250099
W24803     05  PV-NULL-INDICATORS.                                      01260099
W24803         10  PV-MAJ-CL-NBR-IND        PIC S9(04)     VALUE +0     01270099
W24803                                                     COMP.        01280099
W24803         10  PV-SUB-CL-NBR-IND        PIC S9(04)     VALUE +0     01290099
W24803                                                     COMP.        01300099
W24803         10  PV-SKU-NBR-IND           PIC S9(04)     VALUE +0     01310099
W24803                                                     COMP.        01320099
W24803         10  PV-SKU-DESC-IND          PIC S9(04)     VALUE +0     01330099
W24803                                                     COMP.        01340099
W24803         10  PV-VS-NBR-IND            PIC S9(04)     VALUE +0     01350099
W24803                                                     COMP.        01360099
W24803         10  PV-CSTM-CLOR-DESC-IND    PIC S9(04)     VALUE +0     01370099
W24803                                                     COMP.        01380099
W24803         10  PV-SIZE-DESC-IND         PIC S9(04)     VALUE +0     01390099
W24803                                                     COMP.        01400099
W24803     05  PV-TEMP-SKU.                                             01410099
W24803         10 PV-TEMP-SKU-DEPT          PIC  9(03)     VALUE 0.     01420099
W24803         10 PV-TEMP-SKU-CLASS         PIC  9(02)     VALUE 0.     01430099
W24803         10 PV-TEMP-SKU-SEQ           PIC  9(03)     VALUE 0.     01440099
W24803     05  PV-SKU-NBR REDEFINES PV-TEMP-SKU                         01450099
W24803                                      PIC  9(08).                 01460099
W24803     05  PV-MAJ-CL.                                               01470099
W24803         10 PV-MAJ-CL-1               PIC  9         VALUE 0.     01480099
W24803         10 FILLER                    PIC  9         VALUE 0.     01490099
W24803     05  PV-MAJ-CLASS REDEFINES PV-MAJ-CL                         01500099
W24803                                      PIC  9(02).                 01510099
      *---------------------------------------------------------------* 01520099
      *    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING      * 01530099
      *    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.       * 01540099
      *---------------------------------------------------------------* 01550099
                                                                        01560099
           COPY POWS012.                                                01570099
                                                                        01580099
      *---------------------------------------------------------------* 01590099
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01600099
      *---------------------------------------------------------------* 01610099
                                                                        01620099
           COPY DPWS030.                                                01630099
CICS       COPY DPWS930.                                                01631099
                                                                        01640099
      *---------------------------------------------------------------* 01650099
      *    STANDARD COMMAREA.                                         * 01660099
      *---------------------------------------------------------------* 01670099
                                                                        01680099
           COPY DPWS020.                                                01690099
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01700099
                                                                        01710099
      *---------------------------------------------------------------* 01720099
      *    INTER-APPLICATION COMMAREA.                                * 01730099
      *---------------------------------------------------------------* 01740099
                                                                        01750099
               10  INTER-APPL-COMM-AREA     PIC X(200).                 01760099
           COPY POWS013.                                                01770099
                                                                        01780099
      *---------------------------------------------------------------* 01790099
      *    SPECIFIC COMMMAREA FOR POKCS111.                           * 01800099
      *---------------------------------------------------------------* 01810099
               10  ASC-SPECIFIC-COMMAREA.                               01820099
                   15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            01830099
                   15  ASC-USE-SELECTION-QUEUE-IND                      01840099
                                                 PIC  X(01).            01850099
                       88  ASC-USE-SELECTION-QUEUE          VALUE 'Y'.  01860099
      *            15  ASC-SEL-QUEUE-NAME        PIC  X(08).            01870099
                   15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     01880099
                   15  ASC-NUMBER-OF-SELECTED-ITEMS                     01890099
                                                 PIC S9(09) COMP-3.     01900099
                   15  ASC-SEL-SUB               PIC S9(04) COMP.       01910099
                   15  ASC-SEL-ITEM              PIC S9(04) COMP.       01920099
                   15  ASC-ITEM-NBR              PIC S9(04) COMP.       01930099
                   15  ASC-KEY-FIELDS.                                  01940099
                       20  ASC-KEY-PO-NBR        PIC S9(09) COMP.       01950099
                       20  ASC-KEY-PACK-ID       PIC S9(04) COMP.       01960099
                                                                        01970099
                   15  ASC-KEY-DATA.                                    01980099
                       20  ASC-LIST-QUEUE-NAME.                         01990099
                           25  ASC-LIST-TERM-ID  PIC  X(04).            02000099
                           25  ASC-LIST-TASK-NBR PIC S9(05) COMP-3.     02010099
                           25  ASC-LIST-SEQ      PIC  9(01).            02020099
                       20  ASC-SEL-QUEUE-NAME.                          02030099
                           25  ASC-SEL-TERM-ID   PIC  X(04).            02040099
                           25  ASC-SEL-TASK-NBR  PIC S9(05) COMP-3.     02050099
                           25  ASC-SEL-SEQ       PIC  9(01).            02060099
                       20  ASC-PO-NBR            PIC S9(09) COMP.       02070099
                       20  ASC-TOTAL-UNITS       PIC S9(09) COMP.       02080099
                                                                        02090099
                   15  ASC-PACK-LIST-NUMBER      PIC S9(03) COMP-3.     02100099
                   15  ASC-PACK-PREPK-ID         PIC S9(04) COMP.       02110099
                   15  ASC-PACK-SKU              PIC  9(08).            02120099
                   15  ASC-PACK-DESC             PIC  X(40).            02130099
                   15  ASC-PACK-UPC-NBR          PIC  9(15).            02140099
                   15  ASC-PACK-ORD-QTY          PIC S9(09) COMP.       02150099
                   15  ASC-PACK-UNT-QTY          PIC S9(09) COMP.       02160099
                   15  ASC-PACK-SUB              PIC S9(04) COMP SYNC.  02170099
                   15  ASC-NBR-PACKS-READ        PIC S9(09) COMP-3.     02180099
                   15  ASC-PACK-DISPLAYED        PIC S9(04) COMP SYNC.  02190099
                   15  ASC-PACK-HIGH-BLOCK-WRITTEN                      02200099
                                                 PIC S9(04) COMP SYNC.  02210099
                                                                        02220099
      * LINE LEVEL DATA FOR ONE PACK.                                   02230099
                   15  ASC-BLOCK-ENTRIES         OCCURS 2 TIMES.        02240099
                       20  ASC-ITEM-ENTRIES      OCCURS 10 TIMES.       02250099
                           25  ASC-LIST-ITEM-NUMBER                     02260099
                                                 PIC S9(09) COMP-3.     02270099
                           25  ASC-DEP-NBR       PIC  X(03).            02280099
W24803                     25  ASC-MAJ-CL-NBR    PIC  9(02).            02290099
W24803                     25  ASC-SUB-CL-NBR    PIC  9(02).            02300099
W24803                     25  ASC-SKU-NBR       PIC  9(08).            02310099
                           25  ASC-VEND-STYL-NAME PIC  X(10).           02320099
W24803                     25  ASC-SKU-DESC      PIC  X(13).            02330099
                           25  ASC-COLOR-DESC    PIC  X(10).            02340099
                           25  ASC-SIZE-DESC     PIC  X(10).            02350099
                           25  ASC-PREPK-RATO-QTY PIC S9(04) COMP.      02360099
                           25  ASC-UNT-QTY       PIC S9(05) COMP.       02370099
                   15  ASC-BLK-SUB               PIC S9(04) COMP SYNC.  02380099
                   15  ASC-ITEM-SUB              PIC S9(04) COMP SYNC.  02390099
                   15  ASC-NBR-ITEMS-READ        PIC S9(09) COMP-3.     02400099
                   15  ASC-ITEM-AT-TOP-OF-PANEL  PIC S9(09) COMP-3.     02410099
                   15  ASC-ITEM-AT-BOT-OF-PANEL  PIC S9(09) COMP-3.     02420099
                   15  ASC-HIGH-BLOCK-WRITTEN    PIC S9(04) COMP SYNC.  02430099
                   15  ASC-ITEMS-LEFT-INDICATOR  PIC  X(01).            02440099
                       88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  02450099
                       88  ASC-ITEMS-LEFT-ON-DB-NO          VALUE 'N'.  02460099
                                                                        02470099
                   15  ASC-START-ITEM-REQUEST.                          02480099
                       20  ASC-START-ITEM-REQUEST-N PIC  9(07).         02490099
                                                                        02500099
W24803       10  FILLER                           PIC X(1322).          02510099
      *---------------------------------------------------------------* 02520099
      *    ABEND PROCESSING COPYBOOK.                                 * 02530099
      *---------------------------------------------------------------* 02540099
                                                                        02550099
           COPY DPWS013.                                                02560099
                                                                        02570099
      *---------------------------------------------------------------* 02580099
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 02590099
      *---------------------------------------------------------------* 02600099
                                                                        02610099
           COPY DPWS015.                                                02620099
                                                                        02630099
      *---------------------------------------------------------------* 02640099
      *    FUNCTION KEYS COPYBOOK.                                    * 02650099
      *---------------------------------------------------------------* 02660099
                                                                        02670099
           COPY DPWS016.                                                02680099
                                                                        02690099
      *---------------------------------------------------------------* 02700099
      *    NUMERIC EDIT LAYOUT.                                       * 02710099
      *---------------------------------------------------------------* 02720099
                                                                        02730099
           COPY DPWS010I.                                               02740099
                                                                        02750099
      *---------------------------------------------------------------* 02760099
      *    MAP LAYOUT                                                 * 02770099
      *---------------------------------------------------------------* 02780099
                                                                        02790099
           COPY POKM111.                                                02800099
                                                                        02810099
       01  MR-OCCURS-LAYOUT          REDEFINES  PO111AO.                02820099
C98147     05  FILLER                PIC X(229).                        02830099
           05  MR-SCROLL-AREA OCCURS 10 TIMES.                          02840099
W24803         10  MR-DEPTL          PIC S9(04) COMP.                   02850099
W24803         10  MR-DEPTA          PIC  X(01).                        02860099
W24803         10  MR-DEPTC          PIC  X(01).                        02870099
W24803         10  FILLER            PIC  X(01).                        02880099
W24803         10  MR-DEPTH          PIC  X(01).                        02890099
W24803         10  FILLER            PIC  X(01).                        02900099
W24803         10  MR-DEPT           PIC  X(03).                        02910099
W24803                                                                  02920099
W24803         10  MR-MAJ-CLL        PIC S9(04) COMP.                   02930099
W24803         10  MR-MAJ-CLA        PIC  X(01).                        02940099
W24803         10  MR-MAJ-CLC        PIC  X(01).                        02950099
W24803         10  FILLER            PIC  X(01).                        02960099
W24803         10  MR-MAJ-CLH        PIC  X(01).                        02970099
W24803         10  FILLER            PIC  X(01).                        02980099
W24803         10  MR-MAJ-CL         PIC  X(02).                        02990099
W24803                                                                  03000099
W24803         10  MR-SUB-CLASSL     PIC S9(04) COMP.                   03010099
W24803         10  MR-SUB-CLASSA     PIC  X(01).                        03020099
W24803         10  MR-SUB-CLASSC     PIC  X(01).                        03030099
W24803         10  FILLER            PIC  X(01).                        03040099
W24803         10  MR-SUB-CLASSH     PIC  X(01).                        03050099
W24803         10  FILLER            PIC  X(01).                        03060099
W24803         10  MR-SUB-CLASS      PIC  X(02).                        03070099
W24803                                                                  03080099
W24803         10  MR-SKUL           PIC S9(04) COMP.                   03090099
W24803         10  MR-SKUA           PIC  X(01).                        03100099
W24803         10  MR-SKUC           PIC  X(01).                        03110099
W24803         10  FILLER            PIC  X(01).                        03120099
W24803         10  MR-SKUH           PIC  X(01).                        03130099
W24803         10  FILLER            PIC  X(01).                        03140099
W24803         10  MR-SKU            PIC  X(08).                        03150099
                                                                        03160099
               10  MR-STYLEL         PIC S9(04) COMP.                   03170099
               10  MR-STYLEA         PIC  X(01).                        03180099
               10  MR-STYLEC         PIC  X(01).                        03190099
               10  FILLER            PIC  X(01).                        03200099
               10  MR-STYLEH         PIC  X(01).                        03210099
               10  FILLER            PIC  X(01).                        03220099
               10  MR-STYLE          PIC  X(10).                        03230099
      *                                                                 03240099
               10  MR-DESCL          PIC S9(04) COMP.                   03250099
               10  MR-DESCA          PIC  X(01).                        03260099
               10  MR-DESCC          PIC  X(01).                        03270099
               10  FILLER            PIC  X(01).                        03280099
               10  MR-DESCH          PIC  X(01).                        03290099
               10  FILLER            PIC  X(01).                        03300099
W24803         10  MR-DESC           PIC  X(13).                        03310099
      *                                                                 03320099
               10  MR-COLORL         PIC S9(04) COMP.                   03330099
               10  MR-COLORA         PIC  X(01).                        03340099
               10  MR-COLORC         PIC  X(01).                        03350099
               10  FILLER            PIC  X(01).                        03360099
               10  MR-COLORH         PIC  X(01).                        03370099
               10  FILLER            PIC  X(01).                        03380099
               10  MR-COLOR          PIC  X(10).                        03390099
      *                                                                 03400099
               10  MR-SIZEL          PIC S9(04) COMP.                   03410099
               10  MR-SIZEA          PIC  X(01).                        03420099
               10  MR-SIZEC          PIC  X(01).                        03430099
               10  FILLER            PIC  X(01).                        03440099
               10  MR-SIZEH          PIC  X(01).                        03450099
               10  FILLER            PIC  X(01).                        03460099
               10  MR-SIZE           PIC  X(10).                        03470099
      *                                                                 03480099
               10  MR-CRTN-UNITSL    PIC S9(04) COMP.                   03490099
               10  MR-CRTN-UNITSA    PIC  X(01).                        03500099
               10  MR-CRTN-UNITSC    PIC  X(01).                        03510099
               10  FILLER            PIC  X(01).                        03520099
               10  MR-CRTN-UNITSH    PIC  X(01).                        03530099
               10  FILLER            PIC  X(01).                        03540099
               10  MR-CRTN-UNITS-X.                                     03550099
               15  MR-CRTN-UNITS     PIC  ZZ9.                          03560099
      *                                                                 03570099
               10  MR-QTYL           PIC S9(04) COMP.                   03580099
               10  MR-QTYA           PIC  X(01).                        03590099
               10  MR-QTYC           PIC  X(01).                        03600099
               10  FILLER            PIC  X(01).                        03610099
               10  MR-QTYH           PIC  X(01).                        03620099
               10  FILLER            PIC  X(01).                        03630099
               10  MR-QTY-X.                                            03640099
                   15  MR-QTY        PIC  Z(6).                         03650099
                                                                        03660099
      *---------------------------------------------------------------* 03670099
      *    DB2 AREA FOR PO DATA                                       * 03680099
      *---------------------------------------------------------------* 03690099
           EXEC SQL                                                     03700099
                INCLUDE TPURCHS                                         03710099
           END-EXEC.                                                    03720099
                                                                        03730099
      *---------------------------------------------------------------* 03740099
      *    DB2 AREA FOR PO PREPACK DATA                               * 03750099
      *---------------------------------------------------------------* 03760099
           EXEC SQL                                                     03770099
                INCLUDE TPOPRPK                                         03780099
           END-EXEC.                                                    03790099
      *---------------------------------------------------------------* 03800099
      *    DB2 AREA FOR PO ITEM DATA                                    03810099
      *---------------------------------------------------------------* 03820099
           EXEC SQL                                                     03830099
                INCLUDE TPURITM                                         03840099
           END-EXEC.                                                    03850099
W24830*---------------------------------------------------------------* 03860099
W24803*    DB2 AREA FOR SKU                                           * 03870099
W24803*---------------------------------------------------------------* 03880099
W24830     EXEC SQL                                                     03890099
W24803          INCLUDE XLT00003                                        03900099
W24803     END-EXEC.                                                    03910099
W24830*---------------------------------------------------------------* 03920099
W24803*    DB2 AREA FOR VENDOR STYLE                                  * 03930099
W24803*---------------------------------------------------------------* 03940099
W24830     EXEC SQL                                                     03950099
W24803          INCLUDE XLT00004                                        03960099
W24803     END-EXEC.                                                    03970099
      *---------------------------------------------------------------* 03980099
      *    DB2 AREA FOR COMMUNICATIONS                                * 03990099
      *---------------------------------------------------------------* 04000099
           EXEC SQL                                                     04010099
                INCLUDE SQLCA                                           04020099
           END-EXEC.                                                    04030099
                                                                        04040099
      *---------------------------------------------------------------* 04050099
      *    CURSOR TO OBTAIN EXISTING PREPACK DATA                     * 04060099
      *---------------------------------------------------------------* 04070099
                                                                        04080099
           EXEC SQL                                                     04090099
              DECLARE POPRPK-CSR CURSOR                                 04100099
                FOR SELECT                                              04110099
                      PO_NBR                                            04120099
                    , PO_PREPK_ID                                       04130099
                    , PREPK_UPC_NBR                                     04140099
                    , PREPK_DESC                                        04150099
                    , INPK_UNT_QTY                                      04160099
                    , OTPK_ORD_QTY                                      04170099
                    , PK_SKU_NBR                                        04180099
                FROM                                                    04190099
                      TPOPRPK                                           04200099
                WHERE                                                   04210099
                      PO_NBR         =  :ASC-KEY-PO-NBR                 04220099
                AND   PO_PREPK_ID    =  :ASC-KEY-PACK-ID                04230099
                ORDER BY                                                04240099
                      PO_NBR                                            04250099
                    , PO_PREPK_ID                                       04260099
           END-EXEC.                                                    04270099
                                                                        04280099
      *---------------------------------------------------------------* 04290099
      *    CURSOR TO OBTAIN PREPACK/PURITM DATA                       * 04300099
      *---------------------------------------------------------------* 04310099
           EXEC SQL                                                     04320099
                DECLARE PURITM-CSR CURSOR                               04330099
                FOR SELECT                                              04340099
                      PO_LNE_NBR                                        04350099
W24803              , MAJ_CL_NBR                                        04360099
W24803              , SUB_CL_NBR                                        04370099
W24803              , SKU_NBR                                           04380099
W24803              , SU.SKU_DESC                                       04390099
W24803              , VS_NBR                                            04400099
W24803              , CSTM_CLOR_DESC                                    04410099
W24803              , SU.SIZE_DESC                                      04420099
W24803              , CL_NBR                                            04430099
W24803              , SKU_SEQ_NBR                                       04440099
W24803              , PI.SKU_DESC                                       04450099
W24803              , VEND_STYL_NAME                                    04460099
W24803              , COLOR_DESC                                        04470099
W24803              , PI.SIZE_DESC                                      04480099
                    , PI.PO_PREPK_ID                                    04490099
                    , PI.STATUS_CDE                                     04500099
                    , PREPK_RATO_QTY                                    04510099
                    , UNT_QTY                                           04520099
                    , PU.DEPT_NBR                                       04530099
                FROM                                                    04540099
                      TPOPRPK PK                                        04550099
W24803               ,TPURCHS PU                                        04560099
W24803               ,TPURITM PI                                        04570099
W24803          LEFT OUTER JOIN                                         04580099
W24803                XLT_SKU SU                                        04590099
W24803          ON    PI.ITM_NBR = SU.ITM_NBR                           04600099
W24803          LEFT OUTER JOIN                                         04610099
W24803                XLT_VND_STYL VS                                   04620099
W24803          ON    SU.STYL_ID = VS.STYL_ID                           04630099
                WHERE                                                   04640099
W24803                PK.PO_NBR         = :POPRPK-PO-NBR                04650099
W24803          AND   PK.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID           04660099
                AND   PK.PO_NBR         = PI.PO_NBR                     04670099
                AND   PK.PO_NBR         = PU.PO_NBR                     04680099
                AND   PK.PO_PREPK_ID    = PI.PO_PREPK_ID                04690099
                AND   PI.VER_STATUS_CDE = 'A'                           04700099
                AND   PU.VER_STATUS_CDE = 'A'                           04710099
                ORDER BY                                                04720099
                      PO_LNE_NBR                                        04730099
           END-EXEC.                                                    04740099
                                                                        04750099
       LINKAGE SECTION.                                                 04760099
                                                                        04770099
       01  DFHCOMMAREA.                                                 04780099
           05  FILLER                         OCCURS  1 TO 4072 TIMES   04790099
                                              DEPENDING ON EIBCALEN.    04800099
               10  FILLER                     PIC X.                    04810099
                                                                        04820099
                                                                        04830099
       PROCEDURE DIVISION.                                              04840099
                                                                        04850099
       0000-MAIN-MODULE.                                                04860099
                                                                        04870099
           INITIALIZE DP030-CICS-API-FIELDS.                            04880099
           MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04890099
           MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04900099
           MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04910099
           SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04920099
           MOVE LENGTH OF PO111AI       TO DP030-MAP-LENGTH (1).        04930099
           MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04940099
           PERFORM 0001-CALL-CICS-ARCH-API.                             04950099
                                                                        04960099
           PERFORM 1000-CONTROL-PROCESSING.                             04970099
                                                                        04980099
           MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      04990099
           PERFORM 0001-CALL-CICS-ARCH-API.                             05000099
                                                                        05010099
      *----------------------------------------------------------------*05020099
      *   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *05030099
      *   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *05040099
      *----------------------------------------------------------------*05050099
                                                                        05060099
       0001-CALL-CICS-ARCH-API.                                         05070099
                                                                        05080099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05090099
                                          DFHCOMMAREA                   05100099
                                          DP030-CICS-API-FIELDS         05110099
                                          DP020-STANDARD-COMMAREA       05120099
                                          PO111AI.                      05130099
                                                                        05140099
           IF  DP030-RC-CALL-SUCCESSFUL                                 05150099
               CONTINUE                                                 05160099
           ELSE                                                         05170099
               SET DP013-NO-ROLLBACK        TO TRUE                     05180099
               SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   05190099
               SET DP013-CICS-ABEND         TO TRUE                     05200099
               MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        05210099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05220099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05230099
               MOVE DP030-RETURN-CODE       TO DP013-MESSAGE-TEXT (3)   05240099
               PERFORM DP013-0000-PROCESS-ABEND                         05250099
           END-IF.                                                      05260099
                                                                        05270099
                                                                        05280099
       1000-CONTROL-PROCESSING.                                         05290099
      *----------------------------------------------------------------*05300099
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05310099
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05320099
      *                                                                *05330099
      * NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05340099
      *  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05350099
      *  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05360099
      *  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05370099
      *----------------------------------------------------------------*05380099
                                                                        05390099
           EVALUATE TRUE                                                05400099
               WHEN DP020-NEXT-ACT-INITIAL                              05410099
                                                                        05420099
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 05430099
                   IF PS-COMMAREA-NOT-VALID                             05440099
                       CONTINUE                                         05450099
                   ELSE                                                 05460099
                       PERFORM 5000-CREATE-PACK-QUEUE                   05470099
                       PERFORM 4000-BUILD-INITIAL-PANEL                 05480099
                   END-IF                                               05490099
                                                                        05500099
               WHEN DP020-NEXT-ACT-READ-MAP                             05510099
                   PERFORM 2000-PROCESS-PANEL                           05520099
                                                                        05530099
               WHEN DP020-NEXT-ACT-RETURN                               05540099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05550099
                                                                        05560099
               WHEN OTHER                                               05570099
                   SET DP013-LOGIC-ABEND    TO TRUE                     05580099
                   SET DP013-NO-ROLLBACK    TO TRUE                     05590099
                   MOVE '1000-CONTROL-PROCESSING'                       05600099
                                            TO DP013-PARAGRAPH          05610099
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05620099
                                            TO DP013-MESSAGE-TEXT(1)    05630099
                   PERFORM DP013-0000-PROCESS-ABEND                     05640099
           END-EVALUATE.                                                05650099
                                                                        05660099
                                                                        05670099
       1100-PROCESS-INTER-APPL-COMM.                                    05680099
      *----------------------------------------------------------------*05690099
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05700099
      * IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05710099
      *----------------------------------------------------------------*05720099
                                                                        05730099
           SET PS-COMMAREA-VALID            TO TRUE.                    05740099
           MOVE SPACE                       TO ASC-START-ITEM-REQUEST.  05750099
           INITIALIZE ASC-SPECIFIC-COMMAREA.                            05760099
                                                                        05770099
           IF PO013-PO-PKGNG-CDE NOT = 'M'                              05780099
               SET PS-COMMAREA-NOT-VALID                                05790099
                   DP020-MSG-FATAL          TO  TRUE                    05800099
               MOVE PC-TSYMSG-02092         TO DP020-MSG-NUMBER         05810099
           END-IF.                                                      05820099
                                                                        05830099
           IF PO013-PO-NBR = ZERO                                       05840099
               MOVE PC-TSYMSG-00461         TO DP020-MSG-NUMBER         05850099
               SET PS-COMMAREA-NOT-VALID                                05860099
                   DP020-MSG-FATAL          TO TRUE                     05870099
           ELSE                                                         05880099
               MOVE PO013-PO-NBR            TO ASC-KEY-PO-NBR           05890099
           END-IF.                                                      05900099
                                                                        05910099
           IF PO013-DEPT-NBR = SPACES                                   05920099
               MOVE PC-TSYMSG-00588         TO DP020-MSG-NUMBER         05930099
               SET PS-COMMAREA-NOT-VALID                                05940099
                   DP020-MSG-FATAL          TO TRUE                     05950099
           END-IF.                                                      05960099
           IF PS-COMMAREA-NOT-VALID                                     05970099
              SET DP020-NEXT-ACT-APPL-ERROR                             05980099
                  DP020-MSG-FATAL TO TRUE                               05990099
           END-IF.                                                      06000099
                                                                        06010099
           SET ASC-USE-SELECTION-QUEUE TO TRUE.                         06020099
           MOVE PO013-NUMBER-OF-SELECTED-ITEMS                          06030099
                                       TO ASC-NUMBER-OF-SELECTED-ITEMS. 06040099
           MOVE PO013-NUMBER-OF-TS-ITEMS                                06050099
                                       TO ASC-NUMBER-OF-TS-ITEMS.       06060099
           MOVE PO013-SEL-QUEUE-NAME   TO ASC-SEL-QUEUE-NAME.           06070099
           MOVE ZEROES                      TO PV-PO-PREPK-ID.          06080099
           MOVE +1                          TO ASC-BLK-SUB              06090099
                                               ASC-ITEM-SUB.            06100099
           PERFORM 1120-PREPARE-LIST-ENTRY.                             06110099
                                                                        06120099
       1120-PREPARE-LIST-ENTRY.                                         06130099
      *----------------------------------------------------------------*06140099
      *                                                                *06150099
      *----------------------------------------------------------------*06160099
                                                                        06170099
           MOVE PO012-MAX-ITEMS        TO ASC-SEL-SUB.                  06180099
           MOVE ZERO                   TO ASC-SEL-ITEM                  06190099
                                          ASC-ITEM-NBR.                 06200099
           PERFORM 2010-GET-NEXT-PO-PACK.                               06210099
                                                                        06220099
                                                                        06230099
       2000-PROCESS-PANEL.                                              06240099
      *----------------------------------------------------------------*06250099
      *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *06260099
      *    ON WHAT FUNCTION KEY WAS SELECTED.                          *06270099
      *----------------------------------------------------------------*06280099
                                                                        06290099
           EVALUATE TRUE                                                06300099
               WHEN DP020-SRC-AID = DP016-CLEAR                         06310099
                   MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                06320099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06330099
                   PERFORM 3200-RESET-ATTRIBUTES                        06340099
                                                                        06350099
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06360099
                   MOVE ZERO                TO ASC-ITEM-AT-TOP-OF-PANEL 06370099
                   PERFORM 4000-BUILD-INITIAL-PANEL                     06380099
                                                                        06390099
                                                                        06400099
      * F20 'NEXT PK'                                                   06410099
      ** ---------------------- FK-NEXT-SELECTION ------------------*   06420099
               WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06430099
                   IF ASC-ITEM-NBR <                                    06440099
                      ASC-NUMBER-OF-SELECTED-ITEMS                      06450099
                       PERFORM 2010-GET-NEXT-PO-PACK                    06460099
                       IF PS-LIST-END                                   06470099
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06480099
                           SET PS-LIST-NOT-END TO TRUE                  06490099
                       ELSE                                             06500099
                           ADD +1 TO ASC-ITEM-NBR                       06510099
                           PERFORM 5000-CREATE-PACK-QUEUE               06520099
                           PERFORM 4000-BUILD-INITIAL-PANEL             06530099
                       END-IF                                           06540099
                       PERFORM 3200-RESET-ATTRIBUTES                    06550099
                   ELSE                                                 06560099
                       MOVE PC-TSYMSG-02096 TO DP020-MSG-NUMBER         06570099
                       SET DP020-MSG-INFORMATIONAL TO TRUE              06580099
                   END-IF                                               06590099
                                                                        06600099
      * F19 'PREV PK'                                                   06610099
      ** ---------------------- FK-PREV-SELECTION ------------------*   06620099
               WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06630099
                   IF ASC-ITEM-NBR > 1                                  06640099
                                                                        06650099
                      PERFORM 2020-GET-PREV-PO-PACK                     06660099
                       IF PS-LIST-END                                   06670099
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06680099
                           SET PS-LIST-NOT-END TO TRUE                  06690099
                       ELSE                                             06700099
                           SUBTRACT +1 FROM ASC-ITEM-NBR                06710099
                           PERFORM 5000-CREATE-PACK-QUEUE               06720099
                           PERFORM 4000-BUILD-INITIAL-PANEL             06730099
                       END-IF                                           06740099
                       PERFORM 3200-RESET-ATTRIBUTES                    06750099
                   ELSE                                                 06760099
                       MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         06770099
                       SET DP020-MSG-INFORMATIONAL TO TRUE              06780099
                   END-IF                                               06790099
                                                                        06800099
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06810099
                   MOVE +1 TO PV-TOP-ITEM                               06820099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06830099
                   PERFORM 3200-RESET-ATTRIBUTES                        06840099
                                                                        06850099
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06860099
                   PERFORM 2110-BROWSE-BACKWARD                         06870099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06880099
                   PERFORM 3200-RESET-ATTRIBUTES                        06890099
                                                                        06900099
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06910099
                   PERFORM 2120-BROWSE-FORWARD                          06920099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06930099
                   PERFORM 3200-RESET-ATTRIBUTES                        06940099
                                                                        06950099
               WHEN DP020-SRC-AID = DP016-ENTER                         06960099
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06970099
                   PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06980099
                   IF  PS-ERROR                                         06990099
                       CONTINUE                                         07000099
                   ELSE                                                 07010099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07020099
                       PERFORM 3200-RESET-ATTRIBUTES                    07030099
                   END-IF                                               07040099
                                                                        07050099
               WHEN OTHER                                               07060099
                   SET DP013-NO-ROLLBACK    TO TRUE                     07070099
                   SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07080099
                   SET DP013-CICS-ABEND     TO TRUE                     07090099
                   MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         07100099
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07110099
                                            TO DP013-MESSAGE-TEXT (1)   07120099
                   PERFORM DP013-0000-PROCESS-ABEND                     07130099
                                                                        07140099
           END-EVALUATE.                                                07150099
                                                                        07160099
                                                                        07170099
       2010-GET-NEXT-PO-PACK.                                           07180099
      *----------------------------------------------------------------*07190099
      *                                                                *07200099
      *----------------------------------------------------------------*07210099
           ADD +1                          TO ASC-SEL-SUB.              07220099
           IF ASC-SEL-SUB > PO012-MAX-ITEMS                             07230099
              ADD +1                       TO ASC-SEL-ITEM              07240099
                                              ASC-ITEM-NBR              07250099
              MOVE +1                      TO ASC-SEL-SUB               07260099
           END-IF.                                                      07270099
           IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 07280099
              PERFORM 9100-READ-SEL-QUEUE                               07290099
              IF PO012-ITEM (ASC-SEL-SUB) > ZERO                        07300099
                 MOVE PO012-PACK-ID (ASC-SEL-SUB)                       07310099
                                           TO ASC-KEY-PACK-ID           07320099
                 SET PO012-INQ (ASC-SEL-SUB) TO TRUE                    07330099
                 PERFORM 9200-REWRITE-LIST-QUEUE                        07340099
           ELSE                                                         07350099
                 SUBTRACT +1 FROM ASC-SEL-SUB                           07360099
      *          ------BOTTOM OF LIST--------                           07370099
                 MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER        07380099
                 SET DP020-MSG-INFORMATIONAL                            07390099
                 PS-LIST-END             TO TRUE                        07400099
              END-IF                                                    07410099
           ELSE                                                         07420099
               SUBTRACT +1 FROM ASC-SEL-ITEM                            07430099
                                ASC-ITEM-NBR                            07440099
               MOVE PO012-MAX-ITEMS     TO ASC-SEL-SUB                  07450099
               MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07460099
               SET DP020-MSG-INFORMATIONAL TO TRUE                      07470099
               SET PS-LIST-END             TO TRUE                      07480099
           END-IF.                                                      07490099
                                                                        07500099
       2020-GET-PREV-PO-PACK.                                           07510099
           SUBTRACT +1 FROM ASC-SEL-SUB.                                07520099
           IF  ASC-SEL-SUB < +1                                         07530099
               SUBTRACT +1 FROM ASC-SEL-ITEM                            07540099
                                ASC-ITEM-NBR                            07550099
               MOVE PO012-MAX-ITEMS     TO ASC-SEL-SUB                  07560099
           END-IF.                                                      07570099
                                                                        07580099
           IF  ASC-SEL-ITEM > ZERO                                      07590099
               PERFORM 9100-READ-SEL-QUEUE                              07600099
               MOVE PO012-PACK-ID (ASC-SEL-SUB)                         07610099
                                        TO ASC-KEY-PACK-ID              07620099
           ELSE                                                         07630099
               MOVE +1                  TO ASC-SEL-ITEM                 07640099
                                           ASC-ITEM-NBR                 07650099
                                           ASC-SEL-SUB                  07660099
               MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             07670099
               SET DP020-MSG-INFORMATIONAL TO TRUE                      07680099
               SET PS-LIST-END             TO TRUE                      07690099
           END-IF.                                                      07700099
                                                                        07710099
       2110-BROWSE-BACKWARD.                                            07720099
      *----------------------------------------------------------------*07730099
      *    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07740099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07750099
      *    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07760099
      *    MESSAGE.                                                    *07770099
      *----------------------------------------------------------------*07780099
                                                                        07790099
           SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07800099
               GIVING PV-TOP-ITEM.                                      07810099
                                                                        07820099
           IF  PV-TOP-ITEM < +1                                         07830099
               MOVE +1                      TO PV-TOP-ITEM              07840099
      *        -- TOP OF LIST --                                        07850099
               MOVE PC-TSYMSG-00069         TO DP020-MSG-NUMBER         07860099
               SET DP020-MSG-INFORMATIONAL  TO TRUE                     07870099
           END-IF.                                                      07880099
                                                                        07890099
                                                                        07900099
       2120-BROWSE-FORWARD.                                             07910099
      *----------------------------------------------------------------*07920099
      *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07930099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07940099
      *    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07950099
      *----------------------------------------------------------------*07960099
                                                                        07970099
           ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07980099
               GIVING PV-TOP-ITEM.                                      07990099
           IF  PV-TOP-ITEM > ASC-NBR-ITEMS-READ                         08000099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08010099
                                            TO PV-TOP-ITEM              08020099
      *        -- BOTTOM OF LIST --                                     08030099
               MOVE PC-TSYMSG-00070         TO DP020-MSG-NUMBER         08040099
               SET DP020-MSG-INFORMATIONAL  TO TRUE                     08050099
           ELSE                                                         08060099
               COMPUTE PV-BOTTOM-ITEM =                                 08070099
                   PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08080099
               IF  PV-BOTTOM-ITEM > ASC-NBR-ITEMS-READ                  08090099
      *            -- BOTTOM OF LIST --                                 08100099
                   MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER         08110099
                   SET DP020-MSG-INFORMATIONAL                          08120099
                                            TO TRUE                     08130099
               END-IF                                                   08140099
           END-IF.                                                      08150099
                                                                        08160099
       2130-CHECK-FOR-JUMP-BROWSE.                                      08170099
      *----------------------------------------------------------------*08180099
      *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *08190099
      *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *08200099
      *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *08210099
      *    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *08220099
      *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *08230099
      *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *08240099
      *----------------------------------------------------------------*08250099
                                                                        08260099
           SET PS-ERROR-NO                  TO TRUE.                    08270099
           IF (ASC-START-ITEM-REQUEST = SPACE)                          08280099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08290099
                                            TO PV-TOP-ITEM              08300099
           ELSE                                                         08310099
               MOVE ASC-START-ITEM-REQUEST  TO DP010I-UNEDITED-FIELD    08320099
               MOVE PC-NUMBER-LENGTH        TO DP010I-MAXIMUM-DIGITS    08330099
               MOVE +0                      TO DP010I-MAXIMUM-DECIMALS  08340099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          08350099
                                            TO TRUE                     08360099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         08371099
                               USING DP010I-NUMERIC-EDIT-AREA           08372099
                                                                        08380099
               IF  NOT DP010I-ERROR-DETECTED                            08390099
                   MOVE DP010I-NUMERIC-FIELD                            08400099
                                            TO ASC-START-ITEM-REQUEST-N 08410099
                   IF  ASC-START-ITEM-REQUEST-N > ZERO                  08420099
                       IF  ASC-START-ITEM-REQUEST-N >                   08430099
                                                ASC-NBR-ITEMS-READ      08440099
                           MOVE SPACE       TO ASC-START-ITEM-REQUEST   08450099
                           COMPUTE PV-TOP-ITEM =                        08460099
                                   ASC-NBR-ITEMS-READ                   08470099
                                   - PC-ITEMS-PER-PANEL + 1             08480099
                           IF  PV-TOP-ITEM < +1                         08490099
                               MOVE +1      TO PV-TOP-ITEM              08500099
                               MOVE PC-TSYMSG-00070                     08510099
                                            TO DP020-MSG-NUMBER         08520099
                               SET DP020-MSG-INFORMATIONAL              08530099
                                            TO TRUE                     08540099
                           END-IF                                       08550099
                       ELSE                                             08560099
                           MOVE ASC-START-ITEM-REQUEST-N                08570099
                                            TO PV-TOP-ITEM              08580099
                           MOVE SPACE       TO ASC-START-ITEM-REQUEST   08590099
                           COMPUTE PV-BOTTOM-ITEM =                     08600099
                               PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     08610099
                           IF  PV-BOTTOM-ITEM > ASC-NBR-ITEMS-READ      08620099
      *                        -- BOTTOM OF LIST --                     08630099
                               MOVE PC-TSYMSG-00070                     08640099
                                            TO DP020-MSG-NUMBER         08650099
                               SET DP020-MSG-INFORMATIONAL              08660099
                                            TO TRUE                     08670099
                           END-IF                                       08680099
                       END-IF                                           08690099
                   ELSE                                                 08700099
      *                --- VALUE OUT OF RANGE ----                      08710099
                       MOVE PC-TSYMSG-01279 TO DP020-MSG-NUMBER         08720099
                       MOVE -1              TO ASTRTITL                 08730099
                       SET DP030-SET-CURSOR-APPL-1                      08740099
                                            TO TRUE                     08750099
                       MOVE DP015-REVERSE   TO ASTRTITH                 08760099
                       MOVE DP015-RED       TO ASTRTITC                 08770099
                       MOVE DP015-UNP-NUM-BRT-MDT                       08780099
                                            TO ASTRTITA                 08790099
                       SET DP020-MSG-FATAL                              08800099
                           PS-ERROR         TO TRUE                     08810099
                   END-IF                                               08820099
                                                                        08830099
               ELSE                                                     08840099
                   MOVE PC-TSYMSG-00008     TO DP020-MSG-NUMBER         08850099
                   MOVE -1                  TO ASTRTITL                 08860099
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08870099
                   MOVE DP015-REVERSE       TO ASTRTITH                 08880099
                   MOVE DP015-RED           TO ASTRTITC                 08890099
                   MOVE DP015-UNP-NUM-BRT-MDT                           08900099
                                            TO ASTRTITA                 08910099
                   SET DP020-MSG-FATAL                                  08920099
                       PS-ERROR             TO TRUE                     08930099
               END-IF                                                   08940099
           END-IF.                                                      08950099
                                                                        08960099
       2200-MOVE-SCREEN-TO-COMMAREA.                                    08970099
      *----------------------------------------------------------------*08980099
      *    RESET ATTRIBUTES.                                           *08990099
      *----------------------------------------------------------------*09000099
                                                                        09010099
           IF ASTRTITL > ZERO                                           09020099
               MOVE ASTRTITI                TO ASC-START-ITEM-REQUEST   09030099
           ELSE                                                         09040099
               IF ASTRTITF = DP015-ERASE-EOF                            09050099
                   INITIALIZE ASC-START-ITEM-REQUEST                    09060099
               END-IF                                                   09070099
           END-IF.                                                      09080099
                                                                        09090099
                                                                        09100099
       3200-RESET-ATTRIBUTES.                                           09110099
      *----------------------------------------------------------------*09120099
      *    RESET ATTRIBUTES.                                           *09130099
      *----------------------------------------------------------------*09140099
                                                                        09150099
           MOVE DP015-UNP-ALP-NOR-OFF       TO ASTRTITA.                09160099
           MOVE DP015-GREEN                 TO ASTRTITC.                09170099
           MOVE DP015-UNDERLINE             TO ASTRTITH.                09180099
           MOVE -1                          TO ASTRTITL.                09190099
           SET DP030-SET-CURSOR-APPL-1      TO TRUE.                    09200099
                                                                        09210099
                                                                        09220099
       4000-BUILD-INITIAL-PANEL.                                        09230099
      *----------------------------------------------------------------*09240099
      *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *09250099
      *    INITIALIZE ALL COUNTERS AND FLAGS.                          *09260099
      *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *09270099
      *    DISPLAY THE PANEL TO USER.                                  *09280099
      *----------------------------------------------------------------*09290099
                                                                        09300099
           IF ASC-NBR-PACKS-READ > ZERO                                 09310099
      *  GET ALL THE PREPACK LINE DATA FOR THIS PO.                     09320099
                                                                        09330099
               PERFORM 8200-DELETE-ITEM-QUEUE                           09340099
               INITIALIZE ASC-BLOCK-ENTRIES (1)                         09350099
                          ASC-BLOCK-ENTRIES (2)                         09360099
               MOVE +1                      TO ASC-BLK-SUB              09370099
                                               ASC-ITEM-SUB             09380099
      *        MOVE +0                      TO ASC-ITEM-SUB             09390099
               MOVE +0                      TO ASC-NBR-ITEMS-READ       09400099
                                               ASC-HIGH-BLOCK-WRITTEN   09410099
                                               ASC-ITEM-AT-TOP-OF-PANEL 09420099
                                                                        09430099
               SET ASC-ITEMS-LEFT-ON-DB     TO TRUE                     09440099
               INITIALIZE ASC-TOTAL-UNITS                               09450099
                                                                        09460099
               PERFORM 4200-OPEN-PURITM-CSR                             09470099
               PERFORM 4250-PROCESS-PURITM-LINE                         09480099
               PERFORM 4299-CLOSE-PURITM-CSR                            09490099
           END-IF.                                                      09500099
                                                                        09510099
           MOVE +1                          TO  PV-TOP-ITEM.            09520099
           IF ASC-NBR-ITEMS-READ = ZERO                                 09530099
               SET DP020-NEXT-ACT-APPL-ERROR                            09540099
                   DP020-MSG-FATAL          TO TRUE                     09550099
               MOVE PC-TSYMSG-02117         TO DP020-MSG-NUMBER         09560099
           ELSE                                                         09570099
               MOVE -1                      TO ASTRTITL                 09580099
               SET DP030-SET-CURSOR-APPL-1  TO TRUE                     09590099
               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09600099
           END-IF.                                                      09610099
                                                                        09620099
           IF PS-RV-STATUS                                              09630099
              MOVE PC-TSYMSG-02762     TO DP020-MSG-NUMBER              09640099
              SET DP020-MSG-INFORMATIONAL TO TRUE                       09650099
           END-IF.                                                      09660099
                                                                        09670099
       4200-OPEN-PURITM-CSR.                                            09680099
W24803      INITIALIZE DCLTPOPRPK                                       09690099
W24803                 DCLTPURITM                                       09700099
W24803                 DCLTPURCHS                                       09710099
W24803      MOVE ASC-KEY-PO-NBR   TO POPRPK-PO-NBR                      09720099
W24803      MOVE ASC-KEY-PACK-ID  TO POPRPK-PO-PREPK-ID                 09730099
      *----------------------------------------------------------------*09740099
      * OPEN THE CURSOR.                                               *09750099
      *----------------------------------------------------------------*09760099
                                                                        09770099
           EXEC SQL                                                     09780099
                OPEN PURITM-CSR                                         09790099
           END-EXEC.                                                    09800099
                                                                        09810099
           EVALUATE TRUE                                                09820099
               WHEN SQLCODE = ZERO                                      09830099
                 CONTINUE                                               09840099
               WHEN SQLWARN0 NOT EQUAL SPACE                            09850099
               WHEN SQLCODE NOT EQUAL ZERO                              09860099
                 MOVE '4200-OPEN-PURITM-CSR'                            09870099
                                            TO DP013-PARAGRAPH          09880099
                 MOVE 'OPEN PURITM CURSOR'  TO DP013-MESSAGE-TEXT (1)   09890099
                 MOVE SQLCA                 TO DP013-SQLCA              09900099
                 MOVE 'TPURITM'             TO DP013-DB2-TABLE-NAME (1) 09910099
                 MOVE 'TPOPRPK'             TO DP013-DB2-TABLE-NAME (2) 09920099
                 SET DP013-DB2-ABEND        TO TRUE                     09930099
                 PERFORM DP013-0000-PROCESS-ABEND                       09940099
           END-EVALUATE.                                                09950099
                                                                        09960099
                                                                        09970099
       4250-PROCESS-PURITM-LINE.                                        09980099
      *----------------------------------------------------------------*09990099
      * PROCESS PREPACK LINE INFORMATION                               *10000099
      *----------------------------------------------------------------*10010099
                                                                        10020099
           PERFORM                                                      10030099
             VARYING PV-READ-COUNT                                      10040099
             FROM 1 BY 1                                                10050099
             UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                      10060099
                OR (ASC-ITEMS-LEFT-ON-DB-NO))                           10070099
                                                                        10080099
               PERFORM 4275-FETCH-PURITM                                10090099
                                                                        10100099
               IF  PURITM-STATUS-CDE = 'RV'                             10110099
                   SET PS-RV-STATUS TO TRUE                             10120099
               END-IF                                                   10130099
                                                                        10140099
               IF  ASC-ITEMS-LEFT-ON-DB                                 10150099
                   IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                10160099
                       ADD +1               TO ASC-ITEM-SUB             10170099
                   ELSE                                                 10180099
                       ADD +1               TO ASC-BLK-SUB              10190099
                       MOVE +1              TO ASC-ITEM-SUB             10200099
                                                                        10210099
                       IF  ASC-BLK-SUB > PC-MAX-BLOCKS                  10220099
                           MOVE +1          TO ASC-BLK-SUB              10230099
                           PERFORM 7200-WRITE-ITEM-QUEUE                10240099
                           MOVE ASC-BLOCK-ENTRIES (PC-MAX-BLOCKS)       10250099
                                      TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 10260099
                           ADD +1           TO ASC-BLK-SUB              10270099
                           INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   10280099
                       END-IF                                           10290099
                   END-IF                                               10300099
                   ADD +1                   TO ASC-NBR-ITEMS-READ       10310099
                   MOVE ASC-NBR-ITEMS-READ                              10320099
                                            TO ASC-LIST-ITEM-NUMBER     10330099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  10340099
                   MOVE PURCHS-DEPT-NBR     TO ASC-DEP-NBR              10350099
                                            (ASC-BLK-SUB, ASC-ITEM-SUB) 10360099
W24803                                         PV-TEMP-SKU-DEPT         10370099
W24803             IF PV-SKU-NBR-IND = +0                               10380099
W24803               MOVE XLT00004-MAJ-CL-NBR TO ASC-MAJ-CL-NBR         10390099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10400099
W24803               MOVE XLT00004-SUB-CL-NBR TO ASC-SUB-CL-NBR         10410099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10420099
W24803               MOVE XLT00003-SKU-NBR    TO ASC-SKU-NBR            10430099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10440099
W24803               MOVE XLT00004-VS-NBR     TO ASC-VEND-STYL-NAME     10450099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10460099
W24803               MOVE XLT00003-SKU-DESC   TO ASC-SKU-DESC           10470099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10480099
W24803               MOVE XLT00003-CSTM-CLOR-DESC                       10490099
W24803                                        TO ASC-COLOR-DESC         10500099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10510099
W24803               MOVE XLT00003-SIZE-DESC TO ASC-SIZE-DESC           10520099
W24803                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  10530099
W24803             ELSE                                                 10540099
W24803               MOVE PURITM-CL-NBR       TO ASC-SUB-CL-NBR         10550099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10560099
W24803                                           PV-TEMP-SKU-CLASS      10570099
W24803               MOVE PURITM-CL-NBR (1:1) TO PV-MAJ-CL-1            10580099
W24803               MOVE PV-MAJ-CLASS        TO ASC-MAJ-CL-NBR         10590099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10600099
W24803               MOVE PURITM-SKU-SEQ-NBR  TO PV-TEMP-SKU-SEQ        10610099
W24803               MOVE PV-SKU-NBR          TO ASC-SKU-NBR            10620099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10630099
W24803               MOVE PURITM-VEND-STYL-NAME                         10640099
W24803                                        TO ASC-VEND-STYL-NAME     10650099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10660099
W24803               MOVE PURITM-SKU-DESC     TO ASC-SKU-DESC           10670099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10680099
W24803               MOVE PURITM-COLOR-DESC   TO ASC-COLOR-DESC         10690099
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10700099
W24803               MOVE PURITM-SIZE-DESC    TO ASC-SIZE-DESC          10710099
W24803                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  10720099
W24803             END-IF                                               10730099
                   MOVE PURITM-PREPK-RATO-QTY                           10740099
                                            TO ASC-PREPK-RATO-QTY       10750099
                                   (ASC-BLK-SUB, ASC-ITEM-SUB)          10760099
                   MOVE PURITM-UNT-QTY      TO ASC-UNT-QTY              10770099
                                   (ASC-BLK-SUB, ASC-ITEM-SUB)          10780099
                   ADD PURITM-UNT-QTY       TO ASC-TOTAL-UNITS          10790099
               END-IF                                                   10800099
           END-PERFORM.                                                 10810099
           IF  ASC-NBR-ITEMS-READ > ZERO                                10820099
               MOVE +1                      TO ASC-BLK-SUB              10830099
               PERFORM 7200-WRITE-ITEM-QUEUE                            10840099
               ADD +1                       TO ASC-BLK-SUB              10850099
               PERFORM 7200-WRITE-ITEM-QUEUE                            10860099
                                                                        10870099
               MOVE 1                       TO ASC-BLK-SUB              10880099
                                               PV-BLOCK-NUMBER          10890099
           END-IF.                                                      10900099
                                                                        10910099
                                                                        10920099
       4275-FETCH-PURITM.                                               10930099
      *----------------------------------------------------------------*10940099
      * FETCH PREPACK LINE INFORMATION                                 *10950099
      *----------------------------------------------------------------*10960099
W24803     INITIALIZE PV-NULL-INDICATORS                                10970099
           EXEC SQL                                                     10980099
             FETCH PURITM-CSR                                           10990099
               INTO :PURITM-PO-LNE-NBR                                  11000099
W24803             ,:XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND              11010099
W24803             ,:XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND              11020099
W24803             ,:XLT00003-SKU-NBR:PV-SKU-NBR-IND                    11030099
W24803             ,:XLT00003-SKU-DESC:PV-SKU-DESC-IND                  11040099
W24803             ,:XLT00004-VS-NBR:PV-VS-NBR-IND                      11050099
W24803             ,:XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND      11060099
W24803             ,:XLT00003-SIZE-DESC:PV-SIZE-DESC-IND                11070099
W24803             ,:PURITM-CL-NBR                                      11080099
W24803             ,:PURITM-SKU-SEQ-NBR                                 11090099
W24803             ,:PURITM-SKU-DESC                                    11100099
W24803             ,:PURITM-VEND-STYL-NAME                              11110099
W24803             ,:PURITM-COLOR-DESC                                  11120099
W24803             ,:PURITM-SIZE-DESC                                   11130099
                   ,:PURITM-PO-PREPK-ID                                 11140099
                   ,:PURITM-STATUS-CDE                                  11150099
                   ,:PURITM-PREPK-RATO-QTY                              11160099
                   ,:PURITM-UNT-QTY                                     11170099
                   ,:PURCHS-DEPT-NBR                                    11180099
           END-EXEC.                                                    11190099
                                                                        11200099
           EVALUATE TRUE                                                11210099
             WHEN SQLCODE = +0                                          11220099
               CONTINUE                                                 11230099
             WHEN SQLCODE = +100                                        11240099
               SET ASC-ITEMS-LEFT-ON-DB-NO  TO TRUE                     11250099
                                                                        11260099
             WHEN SQLWARN0 NOT = SPACE                                  11270099
             WHEN SQLCODE < +0                                          11280099
             WHEN SQLCODE > +0                                          11290099
               MOVE '4275-FETCH-PURITM'     TO DP013-PARAGRAPH          11300099
               MOVE 'FETCH PURITM CURSOR'   TO DP013-MESSAGE-TEXT(1)    11310099
               MOVE SQLCA                   TO DP013-SQLCA              11320099
               MOVE 'TPURITM'               TO DP013-DB2-TABLE-NAME (1) 11330099
               MOVE 'TPOPRPK'               TO DP013-DB2-TABLE-NAME (2) 11340099
               SET DP013-DB2-ABEND                                      11350099
                   DP013-XCTL-DISPLAY-RESTART TO TRUE                   11360099
               PERFORM DP013-0000-PROCESS-ABEND                         11370099
           END-EVALUATE.                                                11380099
                                                                        11390099
                                                                        11400099
       4299-CLOSE-PURITM-CSR.                                           11410099
      *----------------------------------------------------------------*11420099
      * CLOSE THE CURSOR.                                              *11430099
      *----------------------------------------------------------------*11440099
                                                                        11450099
           EXEC SQL                                                     11460099
               CLOSE PURITM-CSR                                         11470099
           END-EXEC.                                                    11480099
                                                                        11490099
           EVALUATE TRUE                                                11500099
               WHEN SQLCODE = ZERO                                      11510099
                 CONTINUE                                               11520099
               WHEN SQLWARN0 NOT EQUAL SPACE                            11530099
               WHEN SQLCODE NOT EQUAL ZERO                              11540099
                 MOVE '4299-CLOSE-PURITM-CSR'                           11550099
                                            TO DP013-PARAGRAPH          11560099
                 MOVE 'CLOSE PURITM CURSOR' TO DP013-MESSAGE-TEXT (1)   11570099
                 MOVE SQLCA                 TO DP013-SQLCA              11580099
                 SET DP013-DB2-ABEND        TO TRUE                     11590099
                 PERFORM DP013-0000-PROCESS-ABEND                       11600099
           END-EVALUATE.                                                11610099
                                                                        11620099
                                                                        11630099
       4400-MOVE-COMMAREA-TO-SCREEN.                                    11640099
      *----------------------------------------------------------------*11650099
      *    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *11660099
      *----------------------------------------------------------------*11670099
                                                                        11680099
           MOVE ASC-KEY-PO-NBR              TO APONUMO.                 11690099
           MOVE ASC-TOTAL-UNITS             TO ATOTUNTO.                11700099
                                                                        11710099
           MOVE ASC-KEY-PACK-ID                                         11720099
                                            TO APACKIDO.                11730099
           MOVE ASC-PACK-DESC                                           11740099
                                            TO APDESCRO.                11750099
           MOVE ASC-PACK-UPC-NBR                                        11760099
                                            TO APCKUPCO.                11770099
           MOVE ASC-PACK-ORD-QTY                                        11780099
                                            TO ANOFCTNO.                11790099
           MOVE ASC-PACK-UNT-QTY                                        11800099
                                            TO ATUNCTNO.                11810099
           MOVE ASC-PACK-SKU                                            11820099
                                            TO APCKSKUO.                11830099
                                                                        11840099
           IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             11850099
               AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          11860099
               OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          11870099
                   DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             11880099
                       GIVING PV-BLOCK-NUMBER                           11890099
                       REMAINDER PV-REMAINDER                           11900099
                   IF  PV-REMAINDER > ZERO                              11910099
                       ADD +1               TO PV-BLOCK-NUMBER          11920099
                   END-IF                                               11930099
      *    END-IF.                                                      11940099
                   MOVE +1                  TO ASC-BLK-SUB              11950099
                   PERFORM 9120-READ-ITEM-QUEUE                         11960099
      *    PERFORM 9100-READ-SEL-QUEUE                                  11970099
                   ADD +1                   TO ASC-BLK-SUB              11980099
                                               PV-BLOCK-NUMBER          11990099
                   PERFORM 9120-READ-ITEM-QUEUE                         12000099
      *    PERFORM 9100-READ-SEL-QUEUE                                  12010099
           END-IF.                                                      12020099
           MOVE +1 TO ASC-BLK-SUB.                                      12030099
           COMPUTE ASC-ITEM-SUB =                                       12040099
               ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              12050099
               + PC-ITEMS-PER-PANEL).                                   12060099
                                                                        12070099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        12080099
               ADD +1                       TO ASC-BLK-SUB              12090099
               SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12100099
           END-IF.                                                      12110099
                                                                        12120099
           COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           12130099
               ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                12140099
           PERFORM 4420-FORMAT-ITEM-LINES                               12150099
               VARYING PS-SUB                                           12160099
               FROM PC-ITEMS-PER-PANEL BY -1                            12170099
               UNTIL PS-SUB < +1.                                       12180099
                                                                        12190099
           MOVE PV-TOP-ITEM                 TO ASC-ITEM-AT-TOP-OF-PANEL 12200099
                                               ASTRTITO.                12210099
           MOVE ASC-ITEM-AT-BOT-OF-PANEL    TO AENDITO.                 12220099
           MOVE ASC-NBR-ITEMS-READ          TO ATOTITO.                 12230099
                                                                        12240099
           MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ATOTPKO.                12250099
           IF ASC-NBR-PACKS-READ = ZEROES                               12260099
               MOVE ZEROES                  TO ASTRTPKO                 12270099
           ELSE                                                         12280099
               MOVE ASC-ITEM-NBR                                        12290099
                                            TO ASTRTPKO                 12300099
           END-IF.                                                      12310099
                                                                        12320099
           IF  DP020-MSG-NUMBER-X = SPACE                               12330099
               IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NBR-ITEMS-READ        12340099
      *            --- MORE ITEMS TO DISPLAY ----                       12350099
                   MOVE PC-TSYMSG-00279     TO DP020-MSG-NUMBER         12360099
                   SET DP020-MSG-INFORMATIONAL TO TRUE                  12370099
               ELSE                                                     12380099
                   MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER         12390099
                   SET DP020-MSG-INFORMATIONAL TO TRUE                  12400099
               END-IF                                                   12410099
           END-IF.                                                      12420099
                                                                        12430099
       4420-FORMAT-ITEM-LINES.                                          12440099
      *----------------------------------------------------------------*12450099
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *12460099
      *----------------------------------------------------------------*12470099
                                                                        12480099
           IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NBR-ITEMS-READ            12490099
               SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                12500099
W24803         MOVE SPACES                  TO MR-DEPT (PS-SUB)         12510099
W24803                                         MR-MAJ-CL (PS-SUB)       12520099
W24803                                         MR-SUB-CLASS (PS-SUB)    12530099
W24803                                         MR-SKU (PS-SUB)          12540099
                                               MR-STYLE (PS-SUB)        12550099
                                               MR-DESC (PS-SUB)         12560099
                                               MR-COLOR (PS-SUB)        12570099
                                               MR-SIZE (PS-SUB)         12580099
                                               MR-CRTN-UNITS-X (PS-SUB) 12590099
                                               MR-QTY-X (PS-SUB)        12600099
           ELSE                                                         12610099
               IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           12620099
W24803             MOVE ASC-DEP-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)         12630099
W24803                                      TO MR-DEPT (PS-SUB)         12640099
W24803             MOVE ASC-MAJ-CL-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)      12650099
W24803                                      TO MR-MAJ-CL (PS-SUB)       12660099
W24803             MOVE ASC-SUB-CL-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)      12670099
W24803                                      TO MR-SUB-CLASS (PS-SUB)    12680099
W24803             MOVE ASC-SKU-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)         12690099
W24803                                      TO MR-SKU (PS-SUB)          12700099
                   MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB, ASC-ITEM-SUB)  12710099
                                            TO MR-STYLE (PS-SUB)        12720099
                   MOVE ASC-SKU-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)        12730099
                                            TO MR-DESC (PS-SUB)         12740099
                   MOVE ASC-COLOR-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)      12750099
                                            TO MR-COLOR (PS-SUB)        12760099
                   MOVE ASC-SIZE-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)       12770099
                                            TO MR-SIZE (PS-SUB)         12780099
                   MOVE ASC-PREPK-RATO-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)  12790099
                                            TO MR-CRTN-UNITS (PS-SUB)   12800099
                   MOVE ASC-UNT-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)         12810099
                                            TO MR-QTY (PS-SUB)          12820099
               END-IF                                                   12830099
           END-IF.                                                      12840099
           SUBTRACT +1 FROM ASC-ITEM-SUB.                               12850099
           IF  ASC-ITEM-SUB < + 1                                       12860099
               MOVE PC-ITEMS-PER-PANEL      TO ASC-ITEM-SUB             12870099
               MOVE +1                      TO ASC-BLK-SUB              12880099
           END-IF.                                                      12890099
                                                                        12900099
                                                                        12910099
       5000-CREATE-PACK-QUEUE.                                          12920099
      *----------------------------------------------------------------*12930099
      *    WRITE A NEW PACK BLOCK FROM THE ARRAY TO TEMPORARY STORAGE. *12940099
      *----------------------------------------------------------------*12950099
                                                                        12960099
      *    PERFORM 8100-DELETE-SEL-QUEUE.                               12970099
           SET ASC-ITEMS-LEFT-ON-DB         TO TRUE.                    12980099
                                                                        12990099
           PERFORM 5100-OPEN-POPRPK-CSR.                                13000099
           PERFORM 5200-PROCESS-POPRPK.                                 13010099
           PERFORM 5300-CLOSE-POPRPK-CSR.                               13020099
                                                                        13030099
                                                                        13040099
       5100-OPEN-POPRPK-CSR.                                            13050099
      *----------------------------------------------------------------*13060099
      * OPEN THE CURSOR.                                               *13070099
      *----------------------------------------------------------------*13080099
                                                                        13090099
           EXEC SQL                                                     13100099
                OPEN POPRPK-CSR                                         13110099
           END-EXEC.                                                    13120099
                                                                        13130099
           EVALUATE TRUE                                                13140099
               WHEN SQLCODE = ZERO                                      13150099
                    CONTINUE                                            13160099
               WHEN SQLWARN0 NOT EQUAL SPACE                            13170099
               WHEN SQLCODE NOT EQUAL ZERO                              13180099
                    MOVE '5100-OPEN-POPRPK-CSR'                         13190099
                                 TO  DP013-PARAGRAPH                    13200099
                    MOVE 'OPEN PREPACK CURSOR'                          13210099
                                 TO  DP013-MESSAGE-TEXT (1)             13220099
                    MOVE SQLCA   TO  DP013-SQLCA                        13230099
                    SET DP013-DB2-ABEND                                 13240099
                                 TO  TRUE                               13250099
                    PERFORM DP013-0000-PROCESS-ABEND                    13260099
           END-EVALUATE.                                                13270099
                                                                        13280099
       5200-PROCESS-POPRPK.                                             13290099
      ******************************************************            13300099
      *  PROCESS ALL POPRPK DATA HERE                                   13310099
      ******************************************************            13320099
                                                                        13330099
           PERFORM                                                      13340099
             VARYING PV-READ-COUNT                                      13350099
             FROM    1 BY 1                                             13360099
             UNTIL   ((PV-READ-COUNT > PC-MAX-ITEMS)                    13370099
               OR    (ASC-ITEMS-LEFT-ON-DB-NO))                         13380099
                                                                        13390099
               PERFORM 5250-FETCH-POPRPK                                13400099
                                                                        13410099
               IF ASC-ITEMS-LEFT-ON-DB                                  13420099
                   ADD +1                   TO ASC-PACK-SUB             13430099
                   IF PV-PO-PREPK-ID = ZEROES                           13440099
                     AND POPRPK-PO-PREPK-ID > ZEROES                    13450099
      * SAVE THE FIRST PREPACK DATA FOUND.                              13460099
                       MOVE POPRPK-PO-PREPK-ID                          13470099
                                            TO PV-PO-PREPK-ID           13480099
                   END-IF                                               13490099
                   ADD +1                   TO  ASC-NBR-PACKS-READ      13500099
      * SAVE ALL PREPACK DATA IN PACK QUEUE                             13510099
                   MOVE ASC-NBR-PACKS-READ  TO ASC-PACK-LIST-NUMBER     13520099
                                                                        13530099
                   MOVE POPRPK-PO-PREPK-ID  TO ASC-PACK-PREPK-ID        13540099
                                                                        13550099
                   MOVE POPRPK-PREPK-UPC-NBR                            13560099
                                            TO ASC-PACK-UPC-NBR         13570099
                                                                        13580099
                   MOVE POPRPK-PREPK-DESC   TO ASC-PACK-DESC            13590099
                                                                        13600099
                   MOVE POPRPK-OTPK-ORD-QTY TO ASC-PACK-ORD-QTY         13610099
                                                                        13620099
                   MOVE POPRPK-INPK-UNT-QTY TO ASC-PACK-UNT-QTY         13630099
                                                                        13640099
                   MOVE POPRPK-PK-SKU-NBR   TO ASC-PACK-SKU             13650099
               END-IF                                                   13660099
           END-PERFORM.                                                 13670099
                                                                        13680099
       5250-FETCH-POPRPK.                                               13690099
      *----------------------------------------------------------------*13700099
      * FETCH PREPACK INFORMATION                                      *13710099
      *----------------------------------------------------------------*13720099
                                                                        13730099
           EXEC SQL                                                     13740099
               FETCH POPRPK-CSR                                         13750099
               INTO :POPRPK-PO-NBR                                      13760099
                   ,:POPRPK-PO-PREPK-ID                                 13770099
                   ,:POPRPK-PREPK-UPC-NBR                               13780099
                   ,:POPRPK-PREPK-DESC                                  13790099
                   ,:POPRPK-INPK-UNT-QTY                                13800099
                   ,:POPRPK-OTPK-ORD-QTY                                13810099
                   ,:POPRPK-PK-SKU-NBR                                  13820099
           END-EXEC.                                                    13830099
                                                                        13840099
           EVALUATE TRUE                                                13850099
             WHEN SQLCODE = +0                                          13860099
                 CONTINUE                                               13870099
             WHEN SQLCODE = +100                                        13880099
                 SET ASC-ITEMS-LEFT-ON-DB-NO TO TRUE                    13890099
                                                                        13900099
             WHEN SQLWARN0 NOT = SPACE                                  13910099
             WHEN SQLCODE < +0                                          13920099
             WHEN SQLCODE > +0                                          13930099
                   MOVE '5250-FETCH-POPRPK'                             13940099
                                            TO DP013-PARAGRAPH          13950099
                   MOVE 'FETCH CURSOR'      TO DP013-MESSAGE-TEXT(1)    13960099
                   MOVE SQLCA               TO DP013-SQLCA              13970099
                   MOVE 'TPOPRPK'           TO DP013-DB2-TABLE-NAME (1) 13980099
                   SET DP013-DB2-ABEND                                  13990099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               14000099
                   PERFORM DP013-0000-PROCESS-ABEND                     14010099
           END-EVALUATE.                                                14020099
                                                                        14030099
                                                                        14040099
       5300-CLOSE-POPRPK-CSR.                                           14050099
      *----------------------------------------------------------------*14060099
      * CLOSE THE CURSOR.                                              *14070099
      *----------------------------------------------------------------*14080099
                                                                        14090099
           EXEC SQL                                                     14100099
               CLOSE POPRPK-CSR                                         14110099
           END-EXEC.                                                    14120099
                                                                        14130099
           EVALUATE TRUE                                                14140099
               WHEN SQLCODE = ZERO                                      14150099
                 CONTINUE                                               14160099
               WHEN SQLWARN0 NOT EQUAL SPACE                            14170099
               WHEN SQLCODE NOT EQUAL ZERO                              14180099
                 MOVE '5300-CLOSE-POPRPK-CSR'                           14190099
                                            TO  DP013-PARAGRAPH         14200099
                 MOVE 'CLOSE PREPACK CURSOR'                            14210099
                                            TO  DP013-MESSAGE-TEXT (1)  14220099
                 MOVE SQLCA                 TO  DP013-SQLCA             14230099
                 SET DP013-DB2-ABEND        TO  TRUE                    14240099
                 PERFORM DP013-0000-PROCESS-ABEND                       14250099
           END-EVALUATE.                                                14260099
       7200-WRITE-ITEM-QUEUE.                                           14270099
      *----------------------------------------------------------------*14280099
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *14290099
      *----------------------------------------------------------------*14300099
                                                                        14310099
           COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           14320099
              ASC-HIGH-BLOCK-WRITTEN + 1.                               14330099
                                                                        14340099
           EXEC CICS                                                    14350099
                WRITEQ TS                                               14360099
                    QUEUE (ASC-LIST-QUEUE-NAME)                         14370099
                    FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))              14380099
                    ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                    14390099
                    RESP  (PV-CICS-RESP)                                14400099
           END-EXEC.                                                    14410099
                                                                        14420099
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      14430099
               SET DP013-CICS-ABEND                                     14440099
                   DP013-NO-ROLLBACK        TO TRUE                     14450099
               MOVE '7200-WRITE-ITEM-QUEUE' TO DP013-PARAGRAPH          14460099
               MOVE 'ATTEMPTING TO WRITE IEM QUEUE  '                   14470099
                                            TO DP013-MESSAGE-TEXT(1)    14480099
               PERFORM DP013-0000-PROCESS-ABEND                         14490099
           END-IF.                                                      14500099
           ADD +1                           TO ASC-HIGH-BLOCK-WRITTEN.  14510099
                                                                        14520099
       8100-DELETE-SEL-QUEUE.                                           14530099
      *----------------------------------------------------------------*14540099
      *  DELETE THE PACK TEMP STORAGE QUEUE.                           *14550099
      *----------------------------------------------------------------*14560099
                                                                        14570099
           EXEC CICS                                                    14580099
               DELETEQ TS                                               14590099
                   QUEUE (ASC-SEL-QUEUE-NAME)                           14600099
                   RESP  (PV-CICS-RESP)                                 14610099
           END-EXEC.                                                    14620099
                                                                        14630099
           IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14640099
              (PV-CICS-RESP = DFHRESP(QIDERR))                          14650099
               CONTINUE                                                 14660099
           ELSE                                                         14670099
               SET DP013-CICS-ABEND         TO TRUE                     14680099
               SET DP013-NO-ROLLBACK        TO TRUE                     14690099
                                                                        14700099
               MOVE '8100-DELETE-SEL-QUEUE'                             14710099
                                            TO DP013-PARAGRAPH          14720099
               MOVE 'ERROR TRYING TO DELETE PACK ID QUEUE'              14730099
                                            TO DP013-MESSAGE-TEXT (1)   14740099
               PERFORM DP013-0000-PROCESS-ABEND                         14750099
           END-IF.                                                      14760099
                                                                        14770099
                                                                        14780099
       8200-DELETE-ITEM-QUEUE.                                          14790099
      *----------------------------------------------------------------*14800099
      *  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14810099
      *----------------------------------------------------------------*14820099
                                                                        14830099
           EXEC CICS                                                    14840099
               DELETEQ TS                                               14850099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          14860099
                   RESP  (PV-CICS-RESP)                                 14870099
           END-EXEC.                                                    14880099
                                                                        14890099
           IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14900099
              (PV-CICS-RESP = DFHRESP(QIDERR))                          14910099
               CONTINUE                                                 14920099
           ELSE                                                         14930099
               SET DP013-CICS-ABEND         TO TRUE                     14940099
               SET DP013-NO-ROLLBACK        TO TRUE                     14950099
                                                                        14960099
               MOVE '8200-DELETE-ITEM-QUEUE'                            14970099
                                            TO DP013-PARAGRAPH          14980099
               MOVE 'ERROR TRYING TO DELETE ITEM QUEUE'                 14990099
                                            TO DP013-MESSAGE-TEXT (1)   15000099
               PERFORM DP013-0000-PROCESS-ABEND                         15010099
           END-IF.                                                      15020099
                                                                        15030099
           MOVE +0                          TO ASC-HIGH-BLOCK-WRITTEN.  15040099
                                                                        15050099
                                                                        15060099
       9100-READ-SEL-QUEUE.                                             15070099
      *----------------------------------------------------------------*15080099
      *    READ A BLOCK FROM PACK TEMP STORAGE QUEUE INTO THE ARRAY.   *15090099
      *----------------------------------------------------------------*15100099
                                                                        15110099
           EXEC CICS                                                    15120099
               READQ TS                                                 15130099
                   QUEUE (ASC-SEL-QUEUE-NAME)                           15140099
                   INTO  (PO012-PO-SELECT-RECORD)                       15150099
                   ITEM  (ASC-SEL-ITEM)                                 15160099
                   RESP  (PV-CICS-RESP)                                 15170099
           END-EXEC.                                                    15180099
                                                                        15190099
           IF PV-CICS-RESP = DFHRESP (NORMAL)                           15200099
               CONTINUE                                                 15210099
           ELSE                                                         15220099
              IF PV-CICS-RESP = DFHRESP(QIDERR)                         15230099
                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER               15240099
                 SET DP020-MSG-WARNING TO TRUE                          15250099
                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                  15260099
              ELSE                                                      15270099
               SET DP013-LOGIC-ABEND                                    15280099
                   DP013-NO-ROLLBACK        TO TRUE                     15290099
               MOVE '9100-READ-SEL-QUEUE'   TO DP013-PARAGRAPH          15300099
               MOVE 'ERROR TRYING TO READ FROM TS QUEUE'                15310099
                                            TO DP013-MESSAGE-TEXT(1)    15320099
               PERFORM DP013-0000-PROCESS-ABEND                         15330099
              END-IF                                                    15340099
           END-IF.                                                      15350099
                                                                        15360099
       9120-READ-ITEM-QUEUE.                                            15370099
      *----------------------------------------------------------------*15380099
      *    READ A BLOCK FROM ITEM TEMP STORAGE QUEUE INTO THE ARRAY.   *15390099
      *----------------------------------------------------------------*15400099
                                                                        15410099
           EXEC CICS                                                    15420099
              READQ TS                                                  15430099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          15440099
                   INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               15450099
                   ITEM  (PV-BLOCK-NUMBER)                              15460099
                   RESP  (PV-CICS-RESP)                                 15470099
           END-EXEC.                                                    15480099
                                                                        15490099
           IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       15500099
            OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                      15510099
               CONTINUE                                                 15520099
           ELSE                                                         15530099
              SET DP013-CICS-ABEND                                      15540099
                  DP013-NO-ROLLBACK        TO TRUE                      15550099
              MOVE '9120-READ-ITEM-QUEUE'  TO DP013-PARAGRAPH           15560099
              MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'       15570099
                                           TO DP013-MESSAGE-TEXT(1)     15580099
              PERFORM DP013-0000-PROCESS-ABEND                          15590099
           END-IF.                                                      15600099
                                                                        15610099
           IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         15620099
              INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)                15630099
           END-IF.                                                      15640099
                                                                        15650099
       9200-REWRITE-LIST-QUEUE.                                         15660099
      *----------------------------------------------------------------*15670099
      *    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.    *15680099
      *----------------------------------------------------------------*15690099
                                                                        15700099
           EXEC CICS                                                    15710099
               WRITEQ TS                                                15720099
                   QUEUE (ASC-SEL-QUEUE-NAME)                           15730099
                   FROM  (PO012-PO-SELECT-RECORD)                       15740099
                   ITEM  (ASC-SEL-ITEM)                                 15750099
                   RESP  (PV-CICS-RESP)                                 15760099
                   REWRITE                                              15770099
           END-EXEC.                                                    15780099
                                                                        15790099
           IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    15800099
               SET DP013-CICS-ABEND                                     15810099
                   DP013-NO-ROLLBACK        TO TRUE                     15820099
               MOVE '9200-REWRITE-LIST-QUEUE'  TO DP013-PARAGRAPH       15830099
               MOVE 'ERROR TRYING TO REWRITE LIST SELECTIONS QUEUE'     15840099
                                            TO DP013-MESSAGE-TEXT(1)    15850099
               PERFORM DP013-0000-PROCESS-ABEND                         15860099
           END-IF.                                                      15870099
                                                                        15880099
      *----------------------------------------------------------------*15890099
      *    ABEND PROCESSOR MODULE                                      *15900099
      *----------------------------------------------------------------*15910099
                                                                        15920099
           COPY DPPD013.                                                15930099
