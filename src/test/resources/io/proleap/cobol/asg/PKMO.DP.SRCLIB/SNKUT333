000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      SNKUT333.                                       00040000
000500 AUTHOR.          NATALIYA PALATNIK.                              00050000
000600 DATE-WRITTEN.    03/11/93.                                       00060000
000700******************************************************************00070000
000800* ASN TABLES VERIFICATION PROGRAM                                *00080000
000900*                                                                *00090000
001000*                                                                *00100000
001100*                                                                *00110000
001200******************************************************************00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 CONFIGURATION SECTION.                                           00140000
001500 SOURCE-COMPUTER. IBM-3090.                                       00150000
001600 OBJECT-COMPUTER. IBM-3090.                                       00160000
001700                                                                  00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900 FILE-CONTROL.                                                    00190000
002000                                                                  00200000
002100     SELECT ADV-SHIP-NOTICE-REPORT                                00210000
002200         ASSIGN                       TO RPT01.                   00220000
002300                                                                  00230000
002400     SELECT ASNHDR-DELETE-FILE                                    00240000
002500            ASSIGN TO OUT01.                                      00250000
002600                                                                  00260000
002700/                                                                 00270000
002800                                                                  00280000
002900***************                                                   00290000
003000 DATA DIVISION.                                                   00300000
003100***************                                                   00310000
003200 FILE SECTION.                                                    00320000
003300                                                                  00330000
003400                                                                  00340000
003500 FD  ADV-SHIP-NOTICE-REPORT                                       00350000
003600     RECORDING MODE F                                             00360000
003700     BLOCK CONTAINS 0 RECORDS                                     00370000
003800     RECORD CONTAINS 132 CHARACTERS                               00380000
003900     LABEL RECORDS ARE OMITTED                                    00390000
004000     DATA RECORD IS ADV-SHIP-NOTICE-LINE.                         00400000
004100 01  ADV-SHIP-NOTICE-LINE                PIC X(132).              00410000
004200                                                                  00420000
004300 FD  ASNHDR-DELETE-FILE                                           00430000
004400     RECORDING MODE IS F                                          00440000
004500     LABEL RECORDS ARE STANDARD                                   00450000
004600     RECORD CONTAINS 5  CHARACTERS                                00460000
004700     BLOCK CONTAINS 0 RECORDS.                                    00470000
004800                                                                  00480000
004900 01  ASNHDR-DELETE-RECORD        PIC X(5).                        00490000
005000                                                                  00500000
005100/                                                                 00510000
005200/                                                                 00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400/                                                                 00540000
005500****************************************************************  00550000
005600 01  FILLER                           PIC X(08) VALUE 'BEGIN WS'. 00560000
005700****************************************************************  00570000
005800/                                                                 00580000
005900*                                                                 00590000
006000*  STANDARD HEADER LINE - KOHLS 132 COL                           00600000
006100*                                                                 00610000
006200     COPY DPWS132O.                                               00620000
006300/                                                                 00630000
006400 01  H2-HEADING-LINE2.                                            00640000
006500     05  FILLER                       PIC X(46)      VALUE SPACE. 00650000
006600     05  FILLER                       PIC X(42)      VALUE        00660000
006700         'ADVANCE SHIP NOTICE TABLES CHECK REPORT'.               00670000
006800     05  FILLER                       PIC X(44)      VALUE SPACE. 00680000
006900                                                                  00690000
007000 01  H3-HEADING-LINE3.                                            00700000
007100     05  FILLER                       PIC X(02)      VALUE SPACE. 00710000
007200     05  FILLER                       PIC X(13)      VALUE        00720000
007300         'ERROR MESSAGE'.                                         00730000
007400     05  FILLER                       PIC X(117)     VALUE SPACE. 00740000
007500                                                                  00750000
007600/                                                                 00760000
007700 01  END-OF-REPORT-LINE.                                          00770000
007800     05  FILLER                       PIC X(132)     VALUE        00780000
007900         '  ** END OF REPORT **         '.                        00790000
008000/                                                                 00800000
008100/                                                                 00810000
008200 01  CD-CPU-DATE.                                                 00820000
008300     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE ZEROS. 00830000
008400     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE ZEROS. 00840000
008500     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE ZEROS. 00850000
008600                                                                  00860000
008700 01  CT-CPU-TIME.                                                 00870000
008800     05  CD-CPU-TIME-HH               PIC 9(02)      VALUE ZEROS. 00880000
008900     05  CD-CPU-TIME-MM               PIC 9(02)      VALUE ZEROS. 00890000
009000     05  CD-CPU-TIME-SS               PIC 9(02)      VALUE ZEROS. 00900000
009100     05  CD-CPU-TIME-HS               PIC 9(02)      VALUE ZEROS. 00910000
009200                                                                  00920000
009300 01  PA-PROGRAM-ACCUMULATORS.                                     00930000
009400                                                                  00940000
009500     05  PA-LINE-CNT                  PIC S9(03)     VALUE +99    00950000
009600                                                     COMP-3.      00960000
009700     05  PA-PAGE-CNT                  PIC 9(03)      VALUE ZEROS  00970000
009800                                                     COMP-3.      00980000
009900                                                                  00990000
010000                                                                  01000000
010100 01  PC-PROGRAM-CONTROLS.                                         01010000
010200     05  PC-MAX-LINES                 PIC S9(03)     VALUE +48    01020000
010300                                                     COMP-3.      01030000
010400     05  PC-OPERCO-NBR                PIC  X(02)     VALUE '03'.  01040000
010500     05  PC-NEG-1                     PIC S9(03)     VALUE -1     01050000
010600                                                     COMP-3.      01060000
010700     05  PC-NEG-803                   PIC S9(03)     VALUE -803   01070000
010800                                                     COMP-3.      01080000
010900     05  PC-POS-1                     PIC S9(03)     VALUE +1     01090000
011000                                                     COMP-3.      01100000
011100     05  PC-POS-2                     PIC S9(03)     VALUE +2     01110000
011200                                                     COMP-3.      01120000
011300     05  PC-POS-3                     PIC S9(03)     VALUE +3     01130000
011400                                                     COMP-3.      01140000
011500     05  PC-POS-4                     PIC S9(03)     VALUE +4     01150000
011600                                                     COMP-3.      01160000
011700     05  PC-POS-10                    PIC S9(03)     VALUE +10    01170000
011800                                                     COMP-3.      01180000
011900     05  PC-POS-19                    PIC S9(03)     VALUE +19    01190000
012000                                                     COMP-3.      01200000
012100     05  PC-POS-20                    PIC S9(03)     VALUE +20    01210000
012200                                                     COMP-3.      01220000
012300     05  PC-POS-30                    PIC S9(04)     VALUE +30    01230000
012400                                                     COMP-3.      01240000
012500     05  PC-POS-54                    PIC S9(04)     VALUE +54    01250000
012600                                                     COMP-3.      01260000
012700     05  PC-POS-100                   PIC S9(04)     VALUE +100   01270000
012800                                                     COMP-3.      01280000
012900     05  PC-POS-2400                  PIC S9(04)     VALUE +2400  01290000
013000                                                     COMP-3.      01300000
013100     05  PC-POINT-5                   PIC S9(01)V99  VALUE +.5    01310000
013200                                                     COMP-3.      01320000
013300     05  PC-MAX-RETRIES               PIC S9(03)     VALUE +5     01330000
013400                                                     COMP-3.      01340000
013500     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   01350000
013600                                                     COMP SYNC.   01360000
013700     05  PC-NEG-904                   PIC S9(04)     VALUE -904   01370000
013800                                                     COMP SYNC.   01380000
013900     05  PC-NEG-913                   PIC S9(04)     VALUE -913   01390000
014000                                                     COMP SYNC.   01400000
014100                                                                  01410000
014200 01  PS-PROGRAM-SWITCHES.                                         01420000
014300     05  PS-END-OF-ISA-SW             PIC X(01)      VALUE 'N'.   01430000
014400         88  END-OF-ISA                              VALUE 'Y'.   01440000
014500         88  NEW-ISA                                 VALUE 'N'.   01450000
014600     05  PS-DB2-DATA-SW               PIC X(01)      VALUE 'N'.   01460000
014700         88  PS-NO-DATA-LEFT                         VALUE 'Y'.   01470000
014800         88  PS-DATA-ON-TABLE                        VALUE 'N'.   01480000
014900     05  PS-ERROR-SW                  PIC X(01)      VALUE 'N'.   01490000
015000         88 ERROR-DETECTED                           VALUE 'Y'.   01500000
015100         88 ERROR-NOT-DETECTED                       VALUE 'N'.   01510000
015200     05  PS-RET-CODE-SW               PIC X(01)      VALUE 'N'.   01520000
015300         88 SET-RET-CODE                             VALUE 'Y'.   01530000
015400         88 DONT-SET-RET-CODE                        VALUE 'N'.   01540000
015500     05  PS-DUPLICATE-SHIPMENT-SW     PIC X(01)      VALUE 'N'.   01550000
015600         88  DUPLICATE-SHIPMENT                      VALUE 'Y'.   01560000
015700         88  NOT-DUPLICATE-SHIPMENT                  VALUE 'N'.   01570000
015800/                                                                 01580000
015900/                                                                 01590000
016000 01  PW-PROGRAM-WORKAREA.                                         01600000
016100     05  PW-RETRY-COUNTER             PIC S9(04)     VALUE +0     01610000
016200                                                     COMP SYNC.   01620000
016300     05  PW-SUB                       PIC S9(03)     COMP-3       01630000
016400                                                     VALUE ZERO.  01640000
016500     05  PW-SQLCODE                   PIC  9(06)     VALUE ZERO.  01650000
016600     05  PW-ASNPKG-SUB                PIC S9(03)     COMP-3       01660000
016700                                                     VALUE ZERO.  01670000
016800     05  PW-NAME-SUB                  PIC S9(03)     COMP-3       01680000
016900                                                     VALUE ZERO.  01690000
017000     05  PW-ADDR-SUB                  PIC S9(03)     COMP-3       01700000
017100                                                     VALUE ZERO.  01710000
017200     05  PW-LIN-SUB                   PIC S9(03)     COMP-3       01720000
017300                                                     VALUE ZERO.  01730000
017400     05  PW-DATE-YYMMDD.                                          01740000
017500         10  PW-DATE-YY               PIC 9(02)       VALUE ZEROS.01750000
017600         10  PW-DATE-MM               PIC 9(02)       VALUE ZEROS.01760000
017700         10  PW-DATE-DD               PIC 9(02)       VALUE ZEROS.01770000
017800                                                                  01780000
017900 01  PW-CURRENT-PARA                  PIC X(35)       VALUE SPACE.01790000
018000                                                                  01800000
018100 01  PW-ADV-SHIP-NOTICE-LINE          PIC X(132).                 01810000
018200/                                                                 01820000
018300 01  MSG-LINES.                                                   01830000
018400     05  MSG-1A.                                                  01840000
018500         10  FILLER                   PIC X(02)       VALUE SPACE.01850000
018600         10  FILLER                   PIC X(25)       VALUE       01860000
018700             'RECORD DOESN''T EXIST ON '.                         01870000
018800         10  MSG-1A-PARENT-NAME       PIC X(07).                  01880000
018900         10  FILLER                   PIC X(05)     VALUE ' FOR '.01890000
019000         10  MSG-1A-CHILD-NAME        PIC X(07).                  01900000
019100         10  FILLER                   PIC X(72)       VALUE SPACE.01910000
019200     05  MSG-1B.                                                  01920000
019300         10  FILLER                   PIC X(02)       VALUE SPACE.01930000
019400         10  FILLER                   PIC X(21)       VALUE       01940000
019500             'EVERYTHING IS OK FOR '.                             01950000
019600         10  MSG-1B-TABLE-NAME        PIC X(07).                  01960000
019700         10  FILLER                   PIC X(72)       VALUE SPACE.01970000
019800     05  MSG-1C.                                                  01980000
019900         10  FILLER                   PIC X(02)       VALUE SPACE.01990000
020000         10  FILLER                   PIC X(21)       VALUE       02000000
020100             '**ERROR DETECTED FOR '.                             02010000
020200         10  MSG-1C-TABLE-NAME        PIC X(07).                  02020000
020300         10  FILLER                   PIC X(72)       VALUE SPACE.02030000
020400/                                                                 02040000
020500                                                                  02050000
020600 01  PW-ASNHDR-RECORD.                                            02060000
020700      05 FILLER                       PIC  X(13)      VALUE       02070000
020800                                             ' ASNHDR-ID = '.     02080000
020900      05 PW-ASNHDR-ASNHDR-ID          PIC  9(09)      VALUE ZERO. 02090000
021000 01  PW-ASOADR-RECORD.                                            02100000
021100      05 PW-ASOADR-ASNHDR-ID          PIC S9(09)      COMP        02110000
021200                                                      VALUE ZEROS.02120000
021300      05 PW-ASOADR-PO-NBR             PIC  X(22)      VALUE SPACE.02130000
021600      05 PW-ASOADR-NAME-CDE           PIC  X(02)      VALUE SPACE.02160000
021700      05 PW-ASOADR-ASOADT-NBR         PIC S9V         COMP-3      02170000
021800                                                      VALUE ZEROS.02180000
021900      05 PW-ASOADR-ASOANM-NBR         PIC S9V         COMP-3      02190000
022000                                                      VALUE ZEROS.02200000
022100      05 PW-ASOADR-SELR-INV-NBR       PIC  X(30)      VALUE SPACE.02210000
022200/                                                                 02220000
022300 01  PO-ASOADR-RECORD.                                            02230000
022400      05 FILLER                       PIC  X(12)      VALUE       02240000
022500                                             'ASNHDR-ID = '.      02250000
022600      05 PO-ASOADR-ASNHDR-ID          PIC  9(09)      VALUE ZEROS.02260000
022700      05 FILLER                       PIC  X(01)      VALUE SPACE.02270000
022800      05 FILLER                       PIC  X(04)      VALUE       02280000
022900                                             'PO= '.              02290000
023000      05 PO-ASOADR-PO-NBR             PIC  X(22)      VALUE SPACE.02300000
023400      05 FILLER                       PIC  X(01)      VALUE SPACE.02340000
023500      05 FILLER                       PIC  X(08)      VALUE       02350000
023600                                             'NM-CDE= '.          02360000
023700      05 PO-ASOADR-NAME-CDE           PIC  X(02)      VALUE SPACE.02370000
023800      05 PO-ASOADR-ASOADT-NBR         PIC S9V         COMP-3      02380000
023900                                                      VALUE ZEROS.02390000
024000      05 PO-ASOADR-ASOANM-NBR         PIC S9V         COMP-3      02400000
024100                                                      VALUE ZEROS.02410000
024200      05 FILLER                       PIC  X(01)      VALUE SPACE.02420000
024300      05 FILLER                       PIC  X(10)      VALUE       02430000
024400                                             'SLR-INV#= '.        02440000
024500      05 FILLER                       PIC  X(01)      VALUE SPACE.02450000
024600      05 PO-ASOADR-SELR-INV-NBR       PIC  X(30)      VALUE SPACE.02460000
024700/                                                                 02470000
024800 01  PW-ASNDTL-RECORD.                                            02480000
024900      05 PW-ASNDTL-ASNHDR-ID          PIC S9(09)      COMP        02490000
025000                                                      VALUE ZEROS.02500000
025100      05 PW-ASNDTL-ASNDTL-NBR         PIC S9(07)V     COMP-3      02510000
025200                                                      VALUE ZEROS.02520000
025300 01  PO-ASNDTL-RECORD.                                            02530000
025400      05 FILLER                       PIC  X(12)      VALUE       02540000
025500                                              'ASNHDR-ID = '.     02550000
025600      05 PO-ASNDTL-ASNHDR-ID          PIC  X(30)      VALUE SPACE.02560000
025700      05 FILLER                       PIC  X(01)      VALUE SPACE.02570000
025800      05 FILLER                       PIC  X(12)      VALUE       02580000
025900                                              'ASNDTL-NBR= '.     02590000
026000      05 PO-ASNDTL-ASNDTL-NBR         PIC  9(04)      VALUE ZEROS.02600000
026100                                                                  02610000
026200 01  PO-ASCRIT-RECORD.                                            02620000
026300      05 FILLER                       PIC  X(12)      VALUE       02630000
026400                                              'ASNHDR-ID = '.     02640000
026500      05 PO-ASCRIT-ASNHDR-ID          PIC  9(09)      VALUE ZEROS.02650000
026600      05 FILLER                       PIC  X(01)      VALUE SPACE.02660000
026700      05 FILLER                       PIC  X(08)      VALUE       02670000
026800                                              'ASNCAR= '.         02680000
026900      05 PO-ASCRIT-ASNCAR-NBR         PIC  X(45)      VALUE ZEROS.02690000
027000      05 FILLER                       PIC  X(01)      VALUE SPACE.02700000
027100      05 FILLER                       PIC  X(08)      VALUE       02710000
027200                                              'ASNDTL= '.         02720000
027300      05 PO-ASCRIT-ASNDTL-NBR         PIC  9(04)      VALUE ZEROS.02730000
027400                                                                  02740000
027500/                                                                 02750000
027600 01  ABEND-CODE                       PIC S9(04)     VALUE +0     02760000
027700                                                     COMP SYNC.   02770000
027800     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 02780000
027900     88  ABEND-4002-READ-ERROR                       VALUE +4002. 02790000
028000     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 02800000
028100     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 02810000
028200     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 02820000
028300     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 02830000
028400     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 02840000
028500     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 02850000
028600     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 02860000
028700     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 02870000
028800                                                                  02880000
028900*  ASNHDR DELETE RECORD LAYOUT                                    02890000
029000*                                                                 02900000
029100     COPY SNRD002O.                                               02910000
029200/                                                                 02920000
029300/                                                                 02930000
029400*  VE ADVANCE SHIP NOTICE TABLE LAYOUT                            02940000
029500*                                                                 02950000
029600     EXEC SQL                                                     02960000
029700         INCLUDE TASNHDR                                          02970000
029800     END-EXEC.                                                    02980000
029900/                                                                 02990000
030000*  VE ASN PACKING DETAILS TABLE LAYOUT                            03000000
030100*                                                                 03010000
030200     EXEC SQL                                                     03020000
030300         INCLUDE TASNPKG                                          03030000
030400     END-EXEC.                                                    03040000
030500/                                                                 03050000
030600*  VE ASN NAME AND ADDRESS DTL TABLE LAYOUT                       03060000
030700*                                                                 03070000
030800     EXEC SQL                                                     03080000
030900         INCLUDE TASHADR                                          03090000
031000     END-EXEC.                                                    03100000
031100/                                                                 03110000
031200*  VE ASN ADDITIONAL NAME TEXT TABLE LAYOUT                       03120000
031300*                                                                 03130000
031400     EXEC SQL                                                     03140000
031500         INCLUDE TASHANM                                          03150000
031600     END-EXEC.                                                    03160000
031700/                                                                 03170000
031800*  VE ASN ADDITIONAL ADDRESS TEXT TABLE LAYOUT                    03180000
031900*                                                                 03190000
032000     EXEC SQL                                                     03200000
032100         INCLUDE TASHADT                                          03210000
032200     END-EXEC.                                                    03220000
032300/                                                                 03230000
032400*  VE ASN SHIPPED ORDER TABLE LAYOUT                              03240000
032500*                                                                 03250000
032600     EXEC SQL                                                     03260000
032700         INCLUDE TASNORD                                          03270000
032800     END-EXEC.                                                    03280000
032900/                                                                 03290000
033000*  VE ASN ORDER NAME AND ADDR DTL TABLE LAYOUT                    03300000
033100*                                                                 03310000
033200     EXEC SQL                                                     03320000
033300         INCLUDE TASOADR                                          03330000
033400     END-EXEC.                                                    03340000
033500/                                                                 03350000
033600*  VE ASN ORDER ADDITIONAL NAME TABLE LAYOUT                      03360000
033700*                                                                 03370000
033800     EXEC SQL                                                     03380000
033900         INCLUDE TASOANM                                          03390000
034000     END-EXEC.                                                    03400000
034100/                                                                 03410000
034200*  VE ASN ORDER ADDITIONAL ADDR TABLE LAYOUT                      03420000
034300*                                                                 03430000
034400     EXEC SQL                                                     03440000
034500         INCLUDE TASOADT                                          03450000
034600     END-EXEC.                                                    03460000
034700/                                                                 03470000
034800*  VE ASN CARTON TABLE LAYOUT                                     03480000
034900*                                                                 03490000
035000     EXEC SQL                                                     03500000
035100         INCLUDE TASNCAR                                          03510000
035200     END-EXEC.                                                    03520000
035300/                                                                 03530000
035400*  VE ASN ITEM TABLE LAYOUT                                       03540000
035500*                                                                 03550000
035600     EXEC SQL                                                     03560000
035700         INCLUDE TASNDTL                                          03570000
035800     END-EXEC.                                                    03580000
035900/                                                                 03590000
036000*  VE ASN DTPL TABLE LAYOUT                                       03600000
036100*                                                                 03610000
036200     EXEC SQL                                                     03620000
036300         INCLUDE TASDTPL                                          03630000
036400     END-EXEC.                                                    03640000
036500/                                                                 03650000
036600*  VE ASN CARTON:ITEM XREF TABLE LAYOUT                           03660000
036700*                                                                 03670000
036800     EXEC SQL                                                     03680000
036900         INCLUDE TASCRIT                                          03690000
037000     END-EXEC.                                                    03700000
037100/                                                                 03710000
037200* DB2 COMMUNICATION AREA.                                         03720000
037300*                                                                 03730000
037400     EXEC SQL                                                     03740000
037500         INCLUDE SQLCA                                            03750000
037600     END-EXEC.                                                    03760000
037700/                                                                 03770000
037800* DB2 COMMUNICATION AREA 2                                        03780000
037900*                                                                 03790000
038000     COPY SQLCA2.                                                 03800000
038100/                                                                 03810000
038200*                                                                 03820000
038300* CURSOR TO FETCH ASN ORDER TABLE                                 03830000
038400*                                                                 03840000
038500     EXEC SQL                                                     03850000
038600       DECLARE ASN_ASNORD_CURSOR CURSOR FOR                       03860000
038700         SELECT DISTINCT                                          03870000
038800            ASNHDR_ID                                             03880000
038900         FROM TASNORD DEP                                         03890000
039000         WHERE NOT EXISTS                                         03900000
039100         (SELECT 1                                                03910000
039200           FROM TASNHDR PAR                                       03920000
039300           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID)                 03930000
039400     END-EXEC.                                                    03940000
039500/                                                                 03950000
039600*                                                                 03960000
039700* CURSOR TO FETCH ASN PACKAGE TABLE                               03970000
039800*                                                                 03980000
039900     EXEC SQL                                                     03990000
040000       DECLARE ASN_ASNPKG_CURSOR CURSOR FOR                       04000000
040100         SELECT DISTINCT                                          04010000
040200            ASNHDR_ID                                             04020000
040300         FROM TASNPKG DEP                                         04030000
040400         WHERE NOT EXISTS                                         04040000
040500         (SELECT 1                                                04050000
040600           FROM TASNHDR PAR                                       04060000
040700           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID)                 04070000
040800     END-EXEC.                                                    04080000
040900/                                                                 04090000
041000*                                                                 04100000
041100* CURSOR TO FETCH ASN SHIPMENT ADDRESS TABLE                      04110000
041200*                                                                 04120000
041300     EXEC SQL                                                     04130000
041400       DECLARE ASN_ASHADR_CURSOR CURSOR FOR                       04140000
041500         SELECT DISTINCT                                          04150000
041600            ASNHDR_ID                                             04160000
041700         FROM TASHADR DEP                                         04170000
041800         WHERE NOT EXISTS                                         04180000
041900         (SELECT 1                                                04190000
042000           FROM TASNHDR PAR                                       04200000
042100           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID)                 04210000
042200     END-EXEC.                                                    04220000
042300/                                                                 04230000
042400*                                                                 04240000
042500* CURSOR TO FETCH ASN ORDER ADDRESS TABLE                         04250000
042600*                                                                 04260000
042700     EXEC SQL                                                     04270000
042800       DECLARE ASN_ASOADR_CURSOR CURSOR FOR                       04280000
042900         SELECT DISTINCT                                          04290000
043000            PO_NBR,                                               04300000
043200            SELR_INV_NBR,                                         04320000
043300            ASNHDR_ID                                             04330000
043400         FROM TASOADR DEP                                         04340000
043500         WHERE NOT EXISTS                                         04350000
043600         (SELECT 1                                                04360000
043700           FROM TASNORD PAR                                       04370000
043800           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  04380000
043900             AND  DEP.PO_NBR = PAR.PO_NBR                         04390000
044100             AND  DEP.SELR_INV_NBR =  SELR_INV_NBR)               04410000
044200     END-EXEC.                                                    04420000
044300/                                                                 04430000
044400*                                                                 04440000
044500* CURSOR TO FETCH ASN DETAIL TABLE                                04450000
044600*                                                                 04460000
044700     EXEC SQL                                                     04470000
044800       DECLARE ASN_ASNDTL_CURSOR CURSOR FOR                       04480000
044900         SELECT DISTINCT                                          04490000
045000            PO_NBR,                                               04500000
045200            SELR_INV_NBR,                                         04520000
045300            ASNHDR_ID                                             04530000
045400         FROM TASNDTL DEP                                         04540000
045500         WHERE NOT EXISTS                                         04550000
045600         (SELECT 1                                                04560000
045700           FROM TASNORD PAR                                       04570000
045800           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  04580000
045900             AND  DEP.PO_NBR = PAR.PO_NBR                         04590000
046100             AND  DEP.SELR_INV_NBR =  PAR.SELR_INV_NBR)           04610000
046200     END-EXEC.                                                    04620000
046300/                                                                 04630000
046400*                                                                 04640000
046500* CURSOR TO FETCH ASN CARTON TABLE                                04650000
046600*                                                                 04660000
046700     EXEC SQL                                                     04670000
046800       DECLARE ASN_ASNCAR_CURSOR CURSOR FOR                       04680000
046900         SELECT DISTINCT                                          04690000
047000            PO_NBR,                                               04700000
047200            SELR_INV_NBR,                                         04720000
047300            ASNHDR_ID                                             04730000
047400         FROM TASNCAR  DEP                                        04740000
047500         WHERE NOT EXISTS                                         04750000
047600         (SELECT 1                                                04760000
047700           FROM TASNORD PAR                                       04770000
047800           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  04780000
047900             AND  DEP.PO_NBR = PAR.PO_NBR                         04790000
048100             AND  DEP.SELR_INV_NBR =  PAR.SELR_INV_NBR)           04810000
048200     END-EXEC.                                                    04820000
048300/                                                                 04830000
048400*                                                                 04840000
048500* CURSOR TO FETCH ASN ORDER ADDITIONAL TEXT TABLE                 04850000
048600*                                                                 04860000
048700     EXEC SQL                                                     04870000
048800       DECLARE ASN_ASOADT_CURSOR CURSOR FOR                       04880000
048900         SELECT DISTINCT                                          04890000
049000            PO_NBR,                                               04900000
049200            NAME_CDE,                                             04920000
049300            SELR_INV_NBR,                                         04930000
049400            ASNHDR_ID                                             04940000
049500         FROM TASOADT DEP                                         04950000
049600         WHERE NOT EXISTS                                         04960000
049700         (SELECT 1                                                04970000
049800           FROM TASOADR PAR                                       04980000
049900           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  04990000
050000             AND  DEP.PO_NBR = PAR.PO_NBR                         05000000
050200             AND  DEP.NAME_CDE =  PAR.NAME_CDE                    05020000
050300             AND  DEP.SELR_INV_NBR =  PAR.SELR_INV_NBR)           05030000
050400     END-EXEC.                                                    05040000
050500/                                                                 05050000
050600*                                                                 05060000
050700* CURSOR TO FETCH ASN SHIPMENT HEADER ADD ADDRESS TEXT TABLE      05070000
050800*                                                                 05080000
050900     EXEC SQL                                                     05090000
051000       DECLARE ASN_ASHADT_CURSOR CURSOR FOR                       05100000
051100         SELECT DISTINCT                                          05110000
051200            NAME_CDE,                                             05120000
051300            ASNHDR_ID                                             05130000
051400         FROM TASHADT DEP                                         05140000
051500         WHERE NOT EXISTS                                         05150000
051600         (SELECT 1                                                05160000
051700           FROM TASHADR PAR                                       05170000
051800           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  05180000
051900             AND  DEP.NAME_CDE =  PAR.NAME_CDE)                   05190000
052000     END-EXEC.                                                    05200000
052100/                                                                 05210000
052200*                                                                 05220000
052300* CURSOR TO FETCH ASN SHIPMENT HEADER ADD NAME TEXT TABLE         05230000
052400*                                                                 05240000
052500     EXEC SQL                                                     05250000
052600       DECLARE ASN_ASHANM_CURSOR CURSOR FOR                       05260000
052700         SELECT DISTINCT                                          05270000
052800            NAME_CDE,                                             05280000
052900            ASNHDR_ID                                             05290000
053000         FROM TASHANM DEP                                         05300000
053100         WHERE NOT EXISTS                                         05310000
053200         (SELECT 1                                                05320000
053300           FROM TASHADR PAR                                       05330000
053400           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  05340000
053500             AND  DEP.NAME_CDE =  PAR.NAME_CDE)                   05350000
053600     END-EXEC.                                                    05360000
053700/                                                                 05370000
053800*                                                                 05380000
053900* CURSOR TO FETCH ASN ORDER ADDITIONAL NAME TABLE                 05390000
054000*                                                                 05400000
054100     EXEC SQL                                                     05410000
054200       DECLARE ASN_ASOANM_CURSOR CURSOR FOR                       05420000
054300         SELECT DISTINCT                                          05430000
054400            PO_NBR,                                               05440000
054600            NAME_CDE,                                             05460000
054700            SELR_INV_NBR,                                         05470000
054800            ASNHDR_ID                                             05480000
054900         FROM TASOANM DEP                                         05490000
055000         WHERE NOT EXISTS                                         05500000
055100         (SELECT 1                                                05510000
055200           FROM TASOADR PAR                                       05520000
055300           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  05530000
055400             AND  DEP.PO_NBR = PAR.PO_NBR                         05540000
055600             AND  DEP.NAME_CDE =  PAR.NAME_CDE                    05560000
055700             AND  DEP.SELR_INV_NBR =  PAR.SELR_INV_NBR)           05570000
055800     END-EXEC.                                                    05580000
055900/                                                                 05590000
056000*                                                                 05600000
056100* CURSOR TO FETCH ASN DETAIL PO ITEM ASSOCIATION                  05610000
056200*                                                                 05620000
056300     EXEC SQL                                                     05630000
056400       DECLARE ASN_ASDTPL_CURSOR CURSOR FOR                       05640000
056500         SELECT DISTINCT                                          05650000
056600            ASNDTL_NBR,                                           05660000
056700            ASNHDR_ID                                             05670000
056800         FROM TASDTPL DEP                                         05680000
056900         WHERE NOT EXISTS                                         05690000
057000         (SELECT 1                                                05700000
057100           FROM TASNDTL PAR                                       05710000
057200           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  05720000
057300             AND  DEP.ASNDTL_NBR  = PAR.ASNDTL_NBR)               05730000
057400     END-EXEC.                                                    05740000
057500/                                                                 05750000
057600*                                                                 05760000
057700* CURSOR TO FETCH ASN CARTON :  ITEM XREF TABLE                   05770000
057800*                                                                 05780000
057900     EXEC SQL                                                     05790000
058000       DECLARE ASN_ASCRIT_DTL   CURSOR FOR                        05800000
058100         SELECT                                                   05810000
058200            ASNCAR_NBR,                                           05820000
058300            ASNDTL_NBR,                                           05830000
058400            ASNHDR_ID                                             05840000
058500         FROM TASCRIT DEP                                         05850000
058600         WHERE NOT EXISTS                                         05860000
058700         (SELECT 1                                                05870000
058800           FROM TASNDTL PAR                                       05880000
058900           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  05890000
059000             AND  DEP.ASNDTL_NBR  = PAR.ASNDTL_NBR)               05900000
059100     END-EXEC.                                                    05910000
059200/                                                                 05920000
059300*                                                                 05930000
059400* CURSOR TO FETCH ASN CARTON :  ITEM XREF TABLE                   05940000
059500*                                                                 05950000
059600     EXEC SQL                                                     05960000
059700       DECLARE ASN_ASCRIT_CAR  CURSOR FOR                         05970000
059800         SELECT                                                   05980000
059900            ASNCAR_NBR,                                           05990000
060000            ASNDTL_NBR,                                           06000000
060100            ASNHDR_ID                                             06010000
060200         FROM TASCRIT DEP                                         06020000
060300         WHERE NOT EXISTS                                         06030000
060400         (SELECT 1                                                06040000
060500           FROM TASNCAR PAR                                       06050000
060600           WHERE  DEP.ASNHDR_ID  = PAR.ASNHDR_ID                  06060000
060700             AND  DEP.ASNCAR_NBR  = PAR.ASNCAR_NBR)               06070000
060800     END-EXEC.                                                    06080000
060900/                                                                 06090000
061000****************************************************************  06100000
061100 01  FILLER                           PIC X(08) VALUE 'END WS  '. 06110000
061200****************************************************************  06120000
061300/                                                                 06130000
061400****************************************************************  06140000
061500 PROCEDURE DIVISION.                                              06150000
061600****************************************************************  06160000
061700                                                                  06170000
061800***************************************************************** 06180000
061900*     MAINLINE                                                  * 06190000
062000*                                                               * 06200000
062100*   - MAINLINE PROCESSING                                       * 06210000
062200***************************************************************** 06220000
062300 0000-MAINLINE.                                                   06230000
062400     MOVE '0000-MAINLINE                  '                       06240000
062500                                 TO PW-CURRENT-PARA.              06250000
062600*    DISPLAY '0000-MAINLINE'.                                     06260000
062700     OPEN  OUTPUT ADV-SHIP-NOTICE-REPORT                          06270000
062800                  ASNHDR-DELETE-FILE.                             06280000
062900                                                                  06290000
063000     INITIALIZE SN002O-ASN-DELETE-RECORD.                         06300000
063100                                                                  06310000
063200        PERFORM A000-ACCEPT-CURR-DATE-TIME.                       06320000
063300        PERFORM Z600-PROCESS-HEADING-LINES.                       06330000
063400                                                                  06340000
063500        PERFORM A100-PROCESS-TASNORD.                             06350000
063600        PERFORM A110-PROCESS-TASNPKG.                             06360000
063700        PERFORM A120-PROCESS-TASHADR.                             06370000
063800                                                                  06380000
063900        PERFORM A200-PROCESS-TASOADR.                             06390000
064000        PERFORM A210-PROCESS-TASNDTL.                             06400000
064100        PERFORM A220-PROCESS-TASNCAR.                             06410000
064200                                                                  06420000
064300        PERFORM A300-PROCESS-TASOADT.                             06430000
064400        PERFORM A310-PROCESS-TASOANM.                             06440000
064500        PERFORM A320-PROCESS-TASDTPL.                             06450000
064600        PERFORM A330-PROCESS-TASCRIT-DTL.                         06460000
064700        PERFORM A331-PROCESS-TASCRIT-CAR.                         06470000
064800        PERFORM A340-PROCESS-TASHADT.                             06480000
064900        PERFORM A350-PROCESS-TASHANM.                             06490000
065000                                                                  06500000
065100        MOVE  END-OF-REPORT-LINE                                  06510000
065200                  TO  PW-ADV-SHIP-NOTICE-LINE.                    06520000
065300        PERFORM  Z510-WRITE-REPORT-LINE.                          06530000
065400                                                                  06540000
065500     CLOSE    ADV-SHIP-NOTICE-REPORT                              06550000
065600                  ASNHDR-DELETE-FILE.                             06560000
065700     IF SET-RET-CODE                                              06601000
065800         MOVE +4008 TO ABEND-CODE                                 06602000
065900         CALL 'ILBOABN0'  USING ABEND-CODE                        06603000
066000     END-IF.                                                      06604000
066100     STOP RUN.                                                    06610000
066200*                                                                 06620000
066300***************************************************************** 06630000
066400 A000-ACCEPT-CURR-DATE-TIME.                                      06640000
066500     MOVE 'A000-ACCEPT-CURR-DATE-TIME     '                       06650000
066600                                 TO PW-CURRENT-PARA.              06660000
066700*    DISPLAY 'A000-ACCEPT-CURR-DATE-TIME'.                        06670000
066800                                                                  06680000
066900     ACCEPT CT-CPU-TIME FROM TIME.                                06690000
067000     MOVE CD-CPU-TIME-HH         TO DP132O-RUN-HOUR.              06700000
067100     MOVE CD-CPU-TIME-MM         TO DP132O-RUN-MINUTE.            06710000
067200                                                                  06720000
067300     ACCEPT CD-CPU-DATE FROM DATE.                                06730000
067400     MOVE CD-CPU-DATE-MM         TO DP132O-RUN-MONTH.             06740000
067500     MOVE CD-CPU-DATE-DD         TO DP132O-RUN-DAY.               06750000
067600     MOVE CD-CPU-DATE-YY         TO DP132O-RUN-YEAR.              06760000
067700/                                                                 06770000
067800***************************************************************** 06780000
067900*                                                               * 06790000
068000*                                                               * 06800000
068100***************************************************************** 06810000
068200 A100-PROCESS-TASNORD.                                            06820000
068300     MOVE 'A100-PROCESS-TASNORD           '                       06830000
068400                                 TO PW-CURRENT-PARA.              06840000
068500                                                                  06850000
068600      PERFORM  X100-OPEN-ASNORD-CURSOR.                           06860000
068700                                                                  06870000
068800      MOVE 'TASNORD' TO MSG-1A-CHILD-NAME                         06880000
068900                        MSG-1B-TABLE-NAME                         06890000
069000                        MSG-1C-TABLE-NAME.                        06900000
069100      SET ERROR-NOT-DETECTED  TO TRUE.                            06910000
069200                                                                  06920000
069300      PERFORM  UNTIL PS-NO-DATA-LEFT                              06930000
069400        PERFORM  B100-PROCESS-TASNORD                             06940000
069500      END-PERFORM.                                                06950000
069600      PERFORM  X300-CLOSE-ASNORD-CURSOR.                          06960000
069700        IF ERROR-NOT-DETECTED                                     06970000
                 DISPLAY MSG-1B                                         06971000
069800           MOVE MSG-1B                                            06980000
069900                  TO  PW-ADV-SHIP-NOTICE-LINE                     06990000
070000            PERFORM  Z510-WRITE-REPORT-LINE                       07000000
070100        ELSE                                                      07010000
                 DISPLAY MSG-1C                                         07011000
070200           MOVE MSG-1C                                            07020000
070300                  TO  PW-ADV-SHIP-NOTICE-LINE                     07030000
070400            PERFORM  Z510-WRITE-REPORT-LINE                       07040000
070500            SET SET-RET-CODE  TO TRUE                             07050000
070600        END-IF.                                                   07060000
070700                                                                  07070000
070800*                                                                 07080000
070900***************************************************************** 07090000
071000*                                                               * 07100000
071100*                                                               * 07110000
071200***************************************************************** 07120000
071300 A110-PROCESS-TASNPKG.                                            07130000
071400     MOVE 'A110-PROCESS-TASNPKG           '                       07140000
071500                                 TO PW-CURRENT-PARA.              07150000
071600                                                                  07160000
071700      MOVE 'TASNPKG' TO MSG-1A-CHILD-NAME                         07170000
071800                        MSG-1B-TABLE-NAME                         07180000
071900                        MSG-1C-TABLE-NAME.                        07190000
072000                                                                  07200000
072100      INITIALIZE PW-ASNHDR-RECORD.                                07210000
072200      SET PS-DATA-ON-TABLE  TO TRUE.                              07220000
072300      SET ERROR-NOT-DETECTED  TO TRUE.                            07230000
072400                                                                  07240000
072500      PERFORM  X150-OPEN-ASNPKG-CURSOR.                           07250000
072600      PERFORM  UNTIL PS-NO-DATA-LEFT                              07260000
072700        PERFORM  B250-PROCESS-TASNPKG                             07270000
072800      END-PERFORM.                                                07280000
072900      PERFORM  X350-CLOSE-ASNPKG-CURSOR.                          07290000
073000        IF ERROR-NOT-DETECTED                                     07300000
                 DISPLAY MSG-1B                                         07301000
073100           MOVE MSG-1B                                            07310000
073200                  TO  PW-ADV-SHIP-NOTICE-LINE                     07320000
073300            PERFORM  Z510-WRITE-REPORT-LINE                       07330000
073400        ELSE                                                      07340000
                 DISPLAY MSG-1C                                         07341000
073500           MOVE MSG-1C                                            07350000
073600                  TO  PW-ADV-SHIP-NOTICE-LINE                     07360000
073700            PERFORM  Z510-WRITE-REPORT-LINE                       07370000
073800            SET SET-RET-CODE  TO TRUE                             07380000
073900        END-IF.                                                   07390000
074000                                                                  07400000
074100                                                                  07410000
074200*                                                                 07420000
074300*                                                                 07430000
074400***************************************************************** 07440000
074500*                                                               * 07450000
074600*                                                               * 07460000
074700***************************************************************** 07470000
074800 A120-PROCESS-TASHADR.                                            07480000
074900     MOVE 'A120-PROCESS-TASHADR           '                       07490000
075000                                 TO PW-CURRENT-PARA.              07500000
075100                                                                  07510000
075200      INITIALIZE PW-ASNHDR-RECORD.                                07520000
075300      SET PS-DATA-ON-TABLE  TO TRUE.                              07530000
075400      SET ERROR-NOT-DETECTED  TO TRUE.                            07540000
075500                                                                  07550000
075600      MOVE 'TASHADR' TO MSG-1A-CHILD-NAME                         07560000
075700                        MSG-1B-TABLE-NAME                         07570000
075800                        MSG-1C-TABLE-NAME.                        07580000
075900                                                                  07590000
076000      PERFORM  X160-OPEN-ASHADR-CURSOR.                           07600000
076100      PERFORM  UNTIL PS-NO-DATA-LEFT                              07610000
076200        PERFORM  B260-PROCESS-TASHADR                             07620000
076300      END-PERFORM.                                                07630000
076400      PERFORM  X360-CLOSE-ASHADR-CURSOR.                          07640000
076500        IF ERROR-NOT-DETECTED                                     07650000
                 DISPLAY MSG-1B                                         07651000
076600           MOVE MSG-1B                                            07660000
076700                  TO  PW-ADV-SHIP-NOTICE-LINE                     07670000
076800            PERFORM  Z510-WRITE-REPORT-LINE                       07680000
076900        ELSE                                                      07690000
                 DISPLAY MSG-1C                                         07691000
077000           MOVE MSG-1C                                            07700000
077100                  TO  PW-ADV-SHIP-NOTICE-LINE                     07710000
077200            PERFORM  Z510-WRITE-REPORT-LINE                       07720000
077300            SET SET-RET-CODE  TO TRUE                             07730000
077400        END-IF.                                                   07740000
077500                                                                  07750000
077600                                                                  07760000
077700                                                                  07770000
077800                                                                  07780000
077900*                                                                 07790000
078000***************************************************************** 07800000
078100*                                                               * 07810000
078200*                                                               * 07820000
078300***************************************************************** 07830000
078400 A200-PROCESS-TASOADR.                                            07840000
078500     MOVE 'A200-PROCESS-TASOADR           '                       07850000
078600                                 TO PW-CURRENT-PARA.              07860000
078700                                                                  07870000
078800      INITIALIZE PW-ASOADR-RECORD                                 07880000
078900                 PO-ASOADR-RECORD.                                07890000
079000      SET PS-DATA-ON-TABLE  TO TRUE.                              07900000
079100      SET ERROR-NOT-DETECTED  TO TRUE.                            07910000
079200                                                                  07920000
079300      MOVE 'TASOADR' TO MSG-1A-CHILD-NAME                         07930000
079400                        MSG-1B-TABLE-NAME                         07940000
079500                        MSG-1C-TABLE-NAME.                        07950000
079600                                                                  07960000
079700                                                                  07970000
079800      PERFORM  X110-OPEN-ASOADR-CURSOR.                           07980000
079900      PERFORM  UNTIL PS-NO-DATA-LEFT                              07990000
080000        PERFORM  B200-PROCESS-TASOADR                             08000000
080100      END-PERFORM.                                                08010000
080200      PERFORM  X310-CLOSE-ASOADR-CURSOR.                          08020000
080300        IF ERROR-NOT-DETECTED                                     08030000
                 DISPLAY MSG-1B                                         08031000
080400           MOVE MSG-1B                                            08040000
080500                  TO  PW-ADV-SHIP-NOTICE-LINE                     08050000
080600            PERFORM  Z510-WRITE-REPORT-LINE                       08060000
080700        ELSE                                                      08070000
                 DISPLAY MSG-1C                                         08071000
080800           MOVE MSG-1C                                            08080000
080900                  TO  PW-ADV-SHIP-NOTICE-LINE                     08090000
081000            PERFORM  Z510-WRITE-REPORT-LINE                       08100000
081100            SET SET-RET-CODE  TO TRUE                             08110000
081200        END-IF.                                                   08120000
081300                                                                  08130000
081400*                                                                 08140000
081500***************************************************************** 08150000
081600 A210-PROCESS-TASNDTL.                                            08160000
081700     MOVE 'A210-PROCESS-TASNDTL           '                       08170000
081800                                 TO PW-CURRENT-PARA.              08180000
081900                                                                  08190000
082000      INITIALIZE PW-ASOADR-RECORD                                 08200000
082100                 PO-ASOADR-RECORD.                                08210000
082200      SET PS-DATA-ON-TABLE  TO TRUE.                              08220000
082300      SET ERROR-NOT-DETECTED  TO TRUE.                            08230000
082400                                                                  08240000
082500      MOVE 'TASNDTL' TO MSG-1A-CHILD-NAME                         08250000
082600                        MSG-1B-TABLE-NAME                         08260000
082700                        MSG-1C-TABLE-NAME.                        08270000
082800                                                                  08280000
082900                                                                  08290000
083000                                                                  08300000
083100      PERFORM  X130-OPEN-ASNDTL-CURSOR.                           08310000
083200      PERFORM  UNTIL PS-NO-DATA-LEFT                              08320000
083300        PERFORM  B400-PROCESS-TASNDTL                             08330000
083400      END-PERFORM.                                                08340000
083500      PERFORM  X330-CLOSE-ASNDTL-CURSOR.                          08350000
083600        IF ERROR-NOT-DETECTED                                     08360000
                 DISPLAY MSG-1B                                         08361000
083700           MOVE MSG-1B                                            08370000
083800                  TO  PW-ADV-SHIP-NOTICE-LINE                     08380000
083900            PERFORM  Z510-WRITE-REPORT-LINE                       08390000
084000        ELSE                                                      08400000
                 DISPLAY MSG-1C                                         08401000
084100           MOVE MSG-1C                                            08410000
084200                  TO  PW-ADV-SHIP-NOTICE-LINE                     08420000
084300            PERFORM  Z510-WRITE-REPORT-LINE                       08430000
084400            SET SET-RET-CODE  TO TRUE                             08440000
084500        END-IF.                                                   08450000
084600*                                                                 08460000
084700***************************************************************** 08470000
084800*                                                                 08480000
084900***************************************************************** 08490000
085000 A220-PROCESS-TASNCAR.                                            08500000
085100     MOVE 'A220-PROCESS-TASNCAR           '                       08510000
085200                                 TO PW-CURRENT-PARA.              08520000
085300                                                                  08530000
085400      INITIALIZE PW-ASOADR-RECORD                                 08540000
085500                 PO-ASOADR-RECORD.                                08550000
085600      SET PS-DATA-ON-TABLE  TO TRUE.                              08560000
085700      SET ERROR-NOT-DETECTED  TO TRUE.                            08570000
085800                                                                  08580000
085900      MOVE 'TASNCAR' TO MSG-1A-CHILD-NAME                         08590000
086000                        MSG-1B-TABLE-NAME                         08600000
086100                        MSG-1C-TABLE-NAME.                        08610000
086200                                                                  08620000
086300      PERFORM  X140-OPEN-ASNCAR-CURSOR.                           08630000
086400      PERFORM  UNTIL PS-NO-DATA-LEFT                              08640000
086500        PERFORM  B500-PROCESS-TASNCAR                             08650000
086600      END-PERFORM.                                                08660000
086700      PERFORM  X340-CLOSE-ASNCAR-CURSOR.                          08670000
086800        IF ERROR-NOT-DETECTED                                     08680000
                 DISPLAY MSG-1B                                         08681000
086900           MOVE MSG-1B                                            08690000
087000                  TO  PW-ADV-SHIP-NOTICE-LINE                     08700000
087100            PERFORM  Z510-WRITE-REPORT-LINE                       08710000
087200        ELSE                                                      08720000
                 DISPLAY MSG-1C                                         08721000
087300           MOVE MSG-1C                                            08730000
087400                  TO  PW-ADV-SHIP-NOTICE-LINE                     08740000
087500            PERFORM  Z510-WRITE-REPORT-LINE                       08750000
087600            SET SET-RET-CODE  TO TRUE                             08760000
087700        END-IF.                                                   08770000
087800*                                                                 08780000
087900***************************************************************** 08790000
088000*                                                               * 08800000
088100*                                                               * 08810000
088200***************************************************************** 08820000
088300 A310-PROCESS-TASOANM.                                            08830000
088400     MOVE 'A310-PROCESS-TASOANM           '                       08840000
088500                                 TO PW-CURRENT-PARA.              08850000
088600                                                                  08860000
088700      INITIALIZE PW-ASOADR-RECORD                                 08870000
088800                 PO-ASOADR-RECORD.                                08880000
088900      SET PS-DATA-ON-TABLE  TO TRUE.                              08890000
089000      SET ERROR-NOT-DETECTED  TO TRUE.                            08900000
089100                                                                  08910000
089200      MOVE 'TASOANM' TO MSG-1A-CHILD-NAME                         08920000
089300                        MSG-1B-TABLE-NAME                         08930000
089400                        MSG-1C-TABLE-NAME.                        08940000
089500                                                                  08950000
089600      PERFORM  X170-OPEN-ASOANM-CURSOR.                           08960000
089700      PERFORM  UNTIL PS-NO-DATA-LEFT                              08970000
089800        PERFORM  B310-PROCESS-TASOANM                             08980000
089900      END-PERFORM.                                                08990000
090000      PERFORM  X370-CLOSE-ASOANM-CURSOR.                          09000000
090100        IF ERROR-NOT-DETECTED                                     09010000
                 DISPLAY MSG-1B                                         09011000
090200           MOVE MSG-1B                                            09020000
090300                  TO  PW-ADV-SHIP-NOTICE-LINE                     09030000
090400            PERFORM  Z510-WRITE-REPORT-LINE                       09040000
090500        ELSE                                                      09050000
                 DISPLAY MSG-1C                                         09051000
090600           MOVE MSG-1C                                            09060000
090700                  TO  PW-ADV-SHIP-NOTICE-LINE                     09070000
090800            PERFORM  Z510-WRITE-REPORT-LINE                       09080000
090900            SET SET-RET-CODE  TO TRUE                             09090000
091000        END-IF.                                                   09100000
091100                                                                  09110000
091200***************************************************************** 09120000
091300 A320-PROCESS-TASDTPL.                                            09130000
091400     MOVE 'A320-PROCESS-TASDTPL           '                       09140000
091500                                 TO PW-CURRENT-PARA.              09150000
091600                                                                  09160000
091700      INITIALIZE PW-ASNDTL-RECORD.                                09170000
091800      SET PS-DATA-ON-TABLE  TO TRUE.                              09180000
091900      SET ERROR-NOT-DETECTED  TO TRUE.                            09190000
092000                                                                  09200000
092100      MOVE 'TASDTPL' TO MSG-1A-CHILD-NAME                         09210000
092200                        MSG-1B-TABLE-NAME                         09220000
092300                        MSG-1C-TABLE-NAME.                        09230000
092400                                                                  09240000
092500      PERFORM  X180-OPEN-ASDTPL-CURSOR.                           09250000
092600      PERFORM  UNTIL PS-NO-DATA-LEFT                              09260000
092700        PERFORM  B320-PROCESS-TASDTPL                             09270000
092800      END-PERFORM.                                                09280000
092900      PERFORM  X380-CLOSE-ASDTPL-CURSOR.                          09290000
093000        IF ERROR-NOT-DETECTED                                     09300000
                 DISPLAY MSG-1B                                         09301000
093100           MOVE MSG-1B                                            09310000
093200                  TO  PW-ADV-SHIP-NOTICE-LINE                     09320000
093300            PERFORM  Z510-WRITE-REPORT-LINE                       09330000
093400        ELSE                                                      09340000
                 DISPLAY MSG-1C                                         09341000
093500           MOVE MSG-1C                                            09350000
093600                  TO  PW-ADV-SHIP-NOTICE-LINE                     09360000
093700            PERFORM  Z510-WRITE-REPORT-LINE                       09370000
093800            SET SET-RET-CODE  TO TRUE                             09380000
093900        END-IF.                                                   09390000
094000                                                                  09400000
094100***************************************************************** 09410000
094200 A330-PROCESS-TASCRIT-DTL.                                        09420000
094300     MOVE 'A330-PROCESS-TASCRIT-DTL       '                       09430000
094400                                 TO PW-CURRENT-PARA.              09440000
094500                                                                  09450000
094600      INITIALIZE PW-ASNDTL-RECORD.                                09460000
094700      SET PS-DATA-ON-TABLE  TO TRUE.                              09470000
094800      SET ERROR-NOT-DETECTED  TO TRUE.                            09480000
094900                                                                  09490000
095000      MOVE 'TASCRIT' TO MSG-1A-CHILD-NAME                         09500000
095100                        MSG-1B-TABLE-NAME                         09510000
095200                        MSG-1C-TABLE-NAME.                        09520000
095300                                                                  09530000
095400      PERFORM  X190-OPEN-ASCRIT-DTL-CURSOR.                       09540000
095500      PERFORM  UNTIL PS-NO-DATA-LEFT                              09550000
095600        PERFORM  B330-PROCESS-TASCRIT-DTL                         09560000
095700      END-PERFORM.                                                09570000
095800      PERFORM  X390-CLOSE-ASCRIT-DTL-CURSOR.                      09580000
095900        IF ERROR-NOT-DETECTED                                     09590000
                 DISPLAY MSG-1B                                         09591000
096000           MOVE MSG-1B                                            09600000
096100                  TO  PW-ADV-SHIP-NOTICE-LINE                     09610000
096200            PERFORM  Z510-WRITE-REPORT-LINE                       09620000
096300        ELSE                                                      09630000
                 DISPLAY MSG-1C                                         09631000
096400           MOVE MSG-1C                                            09640000
096500                  TO  PW-ADV-SHIP-NOTICE-LINE                     09650000
096600            PERFORM  Z510-WRITE-REPORT-LINE                       09660000
096700            SET SET-RET-CODE  TO TRUE                             09670000
096800        END-IF.                                                   09680000
096900                                                                  09690000
097000***************************************************************** 09700000
097100 A331-PROCESS-TASCRIT-CAR.                                        09710000
097200     MOVE 'A331-PROCESS-TASCRIT-CAR       '                       09720000
097300                                 TO PW-CURRENT-PARA.              09730000
097400                                                                  09740000
097500      INITIALIZE PW-ASNDTL-RECORD.                                09750000
097600      SET PS-DATA-ON-TABLE  TO TRUE.                              09760000
097700      SET ERROR-NOT-DETECTED  TO TRUE.                            09770000
097800                                                                  09780000
097900      MOVE 'TASCRIT' TO MSG-1A-CHILD-NAME                         09790000
098000                        MSG-1B-TABLE-NAME                         09800000
098100                        MSG-1C-TABLE-NAME.                        09810000
098200                                                                  09820000
098300      PERFORM  X191-OPEN-ASCRIT-CAR-CURSOR.                       09830000
098400      PERFORM  UNTIL PS-NO-DATA-LEFT                              09840000
098500        PERFORM  B331-PROCESS-TASCRIT-CAR                         09850000
098600      END-PERFORM.                                                09860000
098700      PERFORM  X391-CLOSE-ASCRIT-CAR-CURSOR.                      09870000
098800        IF ERROR-NOT-DETECTED                                     09880000
                 DISPLAY MSG-1B                                         09881000
098900           MOVE MSG-1B                                            09890000
099000                  TO  PW-ADV-SHIP-NOTICE-LINE                     09900000
099100            PERFORM  Z510-WRITE-REPORT-LINE                       09910000
099200        ELSE                                                      09920000
                 DISPLAY MSG-1C                                         09921000
099300           MOVE MSG-1C                                            09930000
099400                  TO  PW-ADV-SHIP-NOTICE-LINE                     09940000
099500            PERFORM  Z510-WRITE-REPORT-LINE                       09950000
099600            SET SET-RET-CODE  TO TRUE                             09960000
099700        END-IF.                                                   09970000
099800                                                                  09980000
099900***************************************************************** 09990000
100000 A340-PROCESS-TASHADT.                                            10000000
100100     MOVE 'A340-PROCESS-TASHADT           '                       10010000
100200                                 TO PW-CURRENT-PARA.              10020000
100300                                                                  10030000
100400      INITIALIZE PW-ASOADR-RECORD                                 10040000
100500                 PO-ASOADR-RECORD.                                10050000
100600      SET PS-DATA-ON-TABLE  TO TRUE.                              10060000
100700      SET ERROR-NOT-DETECTED  TO TRUE.                            10070000
100800                                                                  10080000
100900      MOVE 'TASHADT' TO MSG-1A-CHILD-NAME                         10090000
101000                        MSG-1B-TABLE-NAME                         10100000
101100                        MSG-1C-TABLE-NAME.                        10110000
101200                                                                  10120000
101300      PERFORM  X195-OPEN-ASHADT-CURSOR.                           10130000
101400      PERFORM  UNTIL PS-NO-DATA-LEFT                              10140000
101500        PERFORM  B340-PROCESS-TASHADT                             10150000
101600      END-PERFORM.                                                10160000
101700      PERFORM  X395-CLOSE-ASHADT-CURSOR.                          10170000
101800        IF ERROR-NOT-DETECTED                                     10180000
                 DISPLAY MSG-1B                                         10181000
101900           MOVE MSG-1B                                            10190000
102000                  TO  PW-ADV-SHIP-NOTICE-LINE                     10200000
102100            PERFORM  Z510-WRITE-REPORT-LINE                       10210000
102200        ELSE                                                      10220000
                 DISPLAY MSG-1C                                         10221000
102300           MOVE MSG-1C                                            10230000
102400                  TO  PW-ADV-SHIP-NOTICE-LINE                     10240000
102500            PERFORM  Z510-WRITE-REPORT-LINE                       10250000
102600            SET SET-RET-CODE  TO TRUE                             10260000
102700        END-IF.                                                   10270000
102800                                                                  10280000
102900***************************************************************** 10290000
103000 A350-PROCESS-TASHANM.                                            10300000
103100     MOVE 'A345-PROCESS-TASHANM           '                       10310000
103200                                 TO PW-CURRENT-PARA.              10320000
103300                                                                  10330000
103400      INITIALIZE PW-ASOADR-RECORD                                 10340000
103500                 PO-ASOADR-RECORD.                                10350000
103600      SET PS-DATA-ON-TABLE  TO TRUE.                              10360000
103700      SET ERROR-NOT-DETECTED  TO TRUE.                            10370000
103800                                                                  10380000
103900      MOVE 'TASHANM' TO MSG-1A-CHILD-NAME                         10390000
104000                        MSG-1B-TABLE-NAME                         10400000
104100                        MSG-1C-TABLE-NAME.                        10410000
104200                                                                  10420000
104300      PERFORM  X198-OPEN-ASHANM-CURSOR.                           10430000
104400      PERFORM  UNTIL PS-NO-DATA-LEFT                              10440000
104500        PERFORM  B350-PROCESS-TASHANM                             10450000
104600      END-PERFORM.                                                10460000
104700      PERFORM  X398-CLOSE-ASHANM-CURSOR.                          10470000
104800        IF ERROR-NOT-DETECTED                                     10480000
                 DISPLAY MSG-1B                                         10481000
104900           MOVE MSG-1B                                            10490000
105000                  TO  PW-ADV-SHIP-NOTICE-LINE                     10500000
105100            PERFORM  Z510-WRITE-REPORT-LINE                       10510000
105200        ELSE                                                      10520000
                 DISPLAY MSG-1C                                         10521000
105300           MOVE MSG-1C                                            10530000
105400                  TO  PW-ADV-SHIP-NOTICE-LINE                     10540000
105500            PERFORM  Z510-WRITE-REPORT-LINE                       10550000
105600            SET SET-RET-CODE  TO TRUE                             10560000
105700        END-IF.                                                   10570000
105800                                                                  10580000
105900***************************************************************** 10590000
106000 A300-PROCESS-TASOADT.                                            10600000
106100     MOVE 'A300-PROCESS-TASOADT           '                       10610000
106200                                 TO PW-CURRENT-PARA.              10620000
106300                                                                  10630000
106400      INITIALIZE PW-ASOADR-RECORD                                 10640000
106500                 PO-ASOADR-RECORD.                                10650000
106600      SET PS-DATA-ON-TABLE  TO TRUE.                              10660000
106700      SET ERROR-NOT-DETECTED  TO TRUE.                            10670000
106800                                                                  10680000
106900      MOVE 'TASOADT' TO MSG-1A-CHILD-NAME                         10690000
107000                        MSG-1B-TABLE-NAME                         10700000
107100                        MSG-1C-TABLE-NAME.                        10710000
107200                                                                  10720000
107300      PERFORM  X120-OPEN-ASOADT-CURSOR.                           10730000
107400      PERFORM  UNTIL PS-NO-DATA-LEFT                              10740000
107500        PERFORM  B300-PROCESS-TASOADT                             10750000
107600      END-PERFORM.                                                10760000
107700      PERFORM  X320-CLOSE-ASOADT-CURSOR.                          10770000
107800        IF ERROR-NOT-DETECTED                                     10780000
                 DISPLAY MSG-1B                                         10781000
107900           MOVE MSG-1B                                            10790000
108000                  TO  PW-ADV-SHIP-NOTICE-LINE                     10800000
108100            PERFORM  Z510-WRITE-REPORT-LINE                       10810000
108200        ELSE                                                      10820000
108300           DISPLAY MSG-1C                                         10830000
108300           MOVE MSG-1C                                            10831000
108400                  TO  PW-ADV-SHIP-NOTICE-LINE                     10840000
108500            PERFORM  Z510-WRITE-REPORT-LINE                       10850000
108600            SET SET-RET-CODE  TO TRUE                             10860000
108700        END-IF.                                                   10870000
108800                                                                  10880000
108900***************************************************************** 10890000
109000*                                                               * 10900000
109100***************************************************************** 10910000
109200 B100-PROCESS-TASNORD.                                            10920000
109300     MOVE 'B100-PROCESS-TASNORD           '                       10930000
109400                                 TO PW-CURRENT-PARA.              10940000
109500     INITIALIZE SN002O-ASN-DELETE-RECORD.                         10950000
109600                                                                  10960000
109700      PERFORM  X200-FETCH-ASNORD-CURSOR.                          10970000
109800      IF SQLCODE = ZERO                                           10980000
109900            MOVE 'TASNHDR' TO MSG-1A-PARENT-NAME                  10990000
110000            MOVE MSG-1A                                           11000000
110100                  TO  PW-ADV-SHIP-NOTICE-LINE                     11010000
                  DISPLAY MSG-1A                                        11011000
110200            PERFORM  Z510-WRITE-REPORT-LINE                       11020000
110300            MOVE PW-ASNHDR-RECORD                                 11030000
110400                  TO  PW-ADV-SHIP-NOTICE-LINE                     11040000
110500            PERFORM  Z500-WRITE-REPORT-LINE                       11050000
110600                 SET ERROR-DETECTED  TO TRUE                      11060000
110700                                                                  11070000
110800*           MOVE  PW-ASNHDR-OPERCO-NBR  TO SN002O-OPERCO-NBR      11080000
110900*           MOVE  PW-ASNHDR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     11090000
111000*           MOVE  PW-ASNHDR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       11100000
111100            MOVE  ASNORD-ASNHDR-ID TO SN002O-ASNHDR-ID            11110000
111200                                                                  11120000
111300            WRITE ASNHDR-DELETE-RECORD                            11130000
111400               FROM SN002O-ASN-DELETE-RECORD                      11140000
111500                                                                  11150000
111600      END-IF.                                                     11160000
111700***************************************************************** 11170000
111800*                                                               * 11180000
111900***************************************************************** 11190000
112000 B200-PROCESS-TASOADR.                                            11200000
112100     MOVE 'B200-PROCESS-TASOADR           '                       11210000
112200                                 TO PW-CURRENT-PARA.              11220000
112300     INITIALIZE SN002O-ASN-DELETE-RECORD.                         11230000
112400                                                                  11240000
112500      PERFORM  X210-FETCH-ASOADR-CURSOR.                          11250000
112600      IF SQLCODE = ZERO                                           11260000
112700            MOVE 'TASNORD' TO MSG-1A-PARENT-NAME                  11270000
112800            MOVE MSG-1A                                           11280000
112900                  TO  PW-ADV-SHIP-NOTICE-LINE                     11290000
                  DISPLAY MSG-1A                                        11291000
113000            PERFORM  Z510-WRITE-REPORT-LINE                       11300000
113100            PERFORM  Z100-MOVE-DATA                               11310000
113200            MOVE PO-ASOADR-RECORD                                 11320000
113300                  TO  PW-ADV-SHIP-NOTICE-LINE                     11330000
113400            PERFORM  Z500-WRITE-REPORT-LINE                       11340000
113500                 SET ERROR-DETECTED  TO TRUE                      11350000
113600                                                                  11360000
113700*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      11370000
113800*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     11380000
113900*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       11390000
114000            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        11400000
114100                                                                  11410000
114200            WRITE ASNHDR-DELETE-RECORD                            11420000
114300               FROM SN002O-ASN-DELETE-RECORD                      11430000
114400      END-IF.                                                     11440000
114500                                                                  11450000
114600***************************************************************** 11460000
114700*                                                               * 11470000
114800***************************************************************** 11480000
114900 B250-PROCESS-TASNPKG.                                            11490000
115000     MOVE 'B250-PROCESS-TASNPKG           '                       11500000
115100                                 TO PW-CURRENT-PARA.              11510000
115200     INITIALIZE SN002O-ASN-DELETE-RECORD.                         11520000
115300                                                                  11530000
115400      PERFORM  X250-FETCH-ASNPKG-CURSOR.                          11540000
115500      IF SQLCODE = ZERO                                           11550000
115600            MOVE 'TASNHDR' TO MSG-1A-PARENT-NAME                  11560000
115700            MOVE MSG-1A                                           11570000
115800                  TO  PW-ADV-SHIP-NOTICE-LINE                     11580000
                  DISPLAY MSG-1A                                        11581000
115900            PERFORM  Z510-WRITE-REPORT-LINE                       11590000
116000            MOVE PW-ASNHDR-RECORD                                 11600000
116100                  TO  PW-ADV-SHIP-NOTICE-LINE                     11610000
116200            PERFORM  Z500-WRITE-REPORT-LINE                       11620000
116300                 SET ERROR-DETECTED  TO TRUE                      11630000
116400                                                                  11640000
116500*           MOVE  PW-ASNHDR-OPERCO-NBR  TO SN002O-OPERCO-NBR      11650000
116600*           MOVE  PW-ASNHDR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     11660000
116700*           MOVE  PW-ASNHDR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       11670000
116800            MOVE  ASNORD-ASNHDR-ID TO SN002O-ASNHDR-ID            11680000
116900                                                                  11690000
117000            WRITE ASNHDR-DELETE-RECORD                            11700000
117100               FROM SN002O-ASN-DELETE-RECORD                      11710000
117200      END-IF.                                                     11720000
117300                                                                  11730000
117400***************************************************************** 11740000
117500*                                                               * 11750000
117600***************************************************************** 11760000
117700 B260-PROCESS-TASHADR.                                            11770000
117800     MOVE 'B260-PROCESS-TASHADR           '                       11780000
117900                                 TO PW-CURRENT-PARA.              11790000
118000     INITIALIZE SN002O-ASN-DELETE-RECORD.                         11800000
118100                                                                  11810000
118200      PERFORM  X260-FETCH-ASHADR-CURSOR.                          11820000
118300      IF SQLCODE = ZERO                                           11830000
118400            MOVE 'TASNHDR' TO MSG-1A-PARENT-NAME                  11840000
118500            MOVE MSG-1A                                           11850000
118600                  TO  PW-ADV-SHIP-NOTICE-LINE                     11860000
                  DISPLAY MSG-1A                                        11861000
118700            PERFORM  Z510-WRITE-REPORT-LINE                       11870000
118800            MOVE PW-ASNHDR-RECORD                                 11880000
118900                  TO  PW-ADV-SHIP-NOTICE-LINE                     11890000
119000            PERFORM  Z500-WRITE-REPORT-LINE                       11900000
119100                 SET ERROR-DETECTED  TO TRUE                      11910000
119200                                                                  11920000
119300*           MOVE  PW-ASNHDR-OPERCO-NBR  TO SN002O-OPERCO-NBR      11930000
119400*           MOVE  PW-ASNHDR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     11940000
119500*           MOVE  PW-ASNHDR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       11950000
119600            MOVE ASNORD-ASNHDR-ID TO SN002O-ASNHDR-ID             11960000
119700                                                                  11970000
119800            WRITE ASNHDR-DELETE-RECORD                            11980000
119900               FROM SN002O-ASN-DELETE-RECORD                      11990000
120000      END-IF.                                                     12000000
120100                                                                  12010000
120200***************************************************************** 12020000
120300*                                                               * 12030000
120400***************************************************************** 12040000
120500 B300-PROCESS-TASOADT.                                            12050000
120600     MOVE 'B300-PROCESS-TASOADT           '                       12060000
120700                                 TO PW-CURRENT-PARA.              12070000
120800     INITIALIZE SN002O-ASN-DELETE-RECORD.                         12080000
120900                                                                  12090000
121000      PERFORM  X220-FETCH-ASOADT-CURSOR.                          12100000
121100      IF SQLCODE = ZERO                                           12110000
121200            MOVE 'TASOADR' TO MSG-1A-PARENT-NAME                  12120000
121300            MOVE MSG-1A                                           12130000
121400                  TO  PW-ADV-SHIP-NOTICE-LINE                     12140000
                  DISPLAY MSG-1A                                        12141000
121500            PERFORM  Z510-WRITE-REPORT-LINE                       12150000
121600            PERFORM  Z100-MOVE-DATA                               12160000
121700            MOVE PO-ASOADR-RECORD                                 12170000
121800                  TO  PW-ADV-SHIP-NOTICE-LINE                     12180000
121900            PERFORM  Z500-WRITE-REPORT-LINE                       12190000
122000                 SET ERROR-DETECTED  TO TRUE                      12200000
122100                                                                  12210000
122200*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      12220000
122300*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     12230000
122400*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       12240000
122500            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        12250000
122600                                                                  12260000
122700            WRITE ASNHDR-DELETE-RECORD                            12270000
122800               FROM SN002O-ASN-DELETE-RECORD                      12280000
122900      END-IF.                                                     12290000
123000                                                                  12300000
123100***************************************************************** 12310000
123200 B310-PROCESS-TASOANM.                                            12320000
123300     MOVE 'B310-PROCESS-TASOANM           '                       12330000
123400                                 TO PW-CURRENT-PARA.              12340000
123500     INITIALIZE SN002O-ASN-DELETE-RECORD.                         12350000
123600                                                                  12360000
123700      PERFORM  X270-FETCH-ASOANM-CURSOR.                          12370000
123800      IF SQLCODE = ZERO                                           12380000
123900            MOVE 'TASOADR' TO MSG-1A-PARENT-NAME                  12390000
124000            MOVE MSG-1A                                           12400000
124100                  TO  PW-ADV-SHIP-NOTICE-LINE                     12410000
                  DISPLAY MSG-1A                                        12411000
124200            PERFORM  Z510-WRITE-REPORT-LINE                       12420000
124300            PERFORM  Z100-MOVE-DATA                               12430000
124400            MOVE PO-ASOADR-RECORD                                 12440000
124500                  TO  PW-ADV-SHIP-NOTICE-LINE                     12450000
124600            PERFORM  Z500-WRITE-REPORT-LINE                       12460000
124700                 SET ERROR-DETECTED  TO TRUE                      12470000
124800                                                                  12480000
124900*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      12490000
125000*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     12500000
125100*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       12510000
125200            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        12520000
125300                                                                  12530000
125400            WRITE ASNHDR-DELETE-RECORD                            12540000
125500               FROM SN002O-ASN-DELETE-RECORD                      12550000
125600      END-IF.                                                     12560000
125700                                                                  12570000
125800***************************************************************** 12580000
125900 B320-PROCESS-TASDTPL.                                            12590000
126000     MOVE 'B320-PROCESS-TASDTPL           '                       12600000
126100                                 TO PW-CURRENT-PARA.              12610000
126200     INITIALIZE SN002O-ASN-DELETE-RECORD.                         12620000
126300                                                                  12630000
126400      PERFORM  X280-FETCH-ASDTPL-CURSOR.                          12640000
126500      IF SQLCODE = ZERO                                           12650000
126600            MOVE 'TASNDTL' TO MSG-1A-PARENT-NAME                  12660000
126700            MOVE MSG-1A                                           12670000
126800                  TO  PW-ADV-SHIP-NOTICE-LINE                     12680000
                  DISPLAY MSG-1A                                        12681000
126900            PERFORM  Z510-WRITE-REPORT-LINE                       12690000
127000*        MOVE PW-ASNDTL-OPERCO-NBR   TO  PO-ASNDTL-OPERCO-NBR     12700000
127100*        MOVE PW-ASNDTL-EDI-VEND-ID  TO  PO-ASNDTL-EDI-VEND-ID    12710000
127200*        MOVE PW-ASNDTL-ASNHDR-NBR   TO  PO-ASNDTL-ASNHDR-NBR     12720000
127300         MOVE PW-ASNDTL-ASNHDR-ID    TO  PO-ASNDTL-ASNHDR-ID      12730000
127400         MOVE PW-ASNDTL-ASNDTL-NBR   TO  PO-ASNDTL-ASNDTL-NBR     12740000
127500            MOVE PO-ASNDTL-RECORD                                 12750000
127600                  TO  PW-ADV-SHIP-NOTICE-LINE                     12760000
127700            PERFORM  Z500-WRITE-REPORT-LINE                       12770000
127800                 SET ERROR-DETECTED  TO TRUE                      12780000
127900                                                                  12790000
128000*           MOVE  PW-ASNDTL-OPERCO-NBR  TO SN002O-OPERCO-NBR      12800000
128100*           MOVE  PW-ASNDTL-EDI-VEND-ID TO SN002O-EDI-VEND-ID     12810000
128200*           MOVE  PW-ASNDTL-ASNHDR-NBR TO SN002O-ASNHDR-NBR       12820000
128300            MOVE  PW-ASNDTL-ASNHDR-ID  TO SN002O-ASNHDR-ID        12830000
128400                                                                  12840000
128500            WRITE ASNHDR-DELETE-RECORD                            12850000
128600               FROM SN002O-ASN-DELETE-RECORD                      12860000
128700      END-IF.                                                     12870000
128800                                                                  12880000
128900***************************************************************** 12890000
129000 B330-PROCESS-TASCRIT-DTL.                                        12900000
129100     MOVE 'B330-PROCESS-TASCRIT-DTL       '                       12910000
129200                                 TO PW-CURRENT-PARA.              12920000
129300      INITIALIZE DCLTASCRIT.                                      12930000
129400     INITIALIZE SN002O-ASN-DELETE-RECORD.                         12940000
129500                                                                  12950000
129600      PERFORM  X290-FETCH-ASCRIT-DTL-CURSOR.                      12960000
129700      IF SQLCODE = ZERO                                           12970000
129800            MOVE 'TASNDTL' TO MSG-1A-PARENT-NAME                  12980000
129900            MOVE MSG-1A                                           12990000
130000                  TO  PW-ADV-SHIP-NOTICE-LINE                     13000000
                  DISPLAY MSG-1A                                        13001000
130100            PERFORM  Z510-WRITE-REPORT-LINE                       13010000
130200*           MOVE ASCRIT-OPERCO-NBR TO PO-ASCRIT-OPERCO-NBR        13020000
130300*           MOVE ASCRIT-EDI-VEND-ID TO PO-ASCRIT-EDI-VEND-ID      13030000
130400*           MOVE ASCRIT-ASNHDR-NBR  TO PO-ASCRIT-ASNHDR-NBR       13040000
130500            MOVE ASCRIT-ASNHDR-ID  TO PO-ASCRIT-ASNHDR-ID         13050000
130600            MOVE ASCRIT-ASNCAR-NBR  TO PO-ASCRIT-ASNCAR-NBR       13060000
130700            MOVE ASCRIT-ASNDTL-NBR  TO PO-ASCRIT-ASNDTL-NBR       13070000
130800            MOVE PO-ASCRIT-RECORD                                 13080000
130900                  TO  PW-ADV-SHIP-NOTICE-LINE                     13090000
131000            PERFORM  Z500-WRITE-REPORT-LINE                       13100000
131100                 SET ERROR-DETECTED  TO TRUE                      13110000
131200                                                                  13120000
131300*           MOVE  ASCRIT-OPERCO-NBR  TO SN002O-OPERCO-NBR         13130000
131400*           MOVE  ASCRIT-EDI-VEND-ID TO SN002O-EDI-VEND-ID        13140000
131500*           MOVE  ASCRIT-ASNHDR-NBR TO SN002O-ASNHDR-NBR          13150000
131600            MOVE  ASCRIT-ASNHDR-ID  TO SN002O-ASNHDR-ID           13160000
131700                                                                  13170000
131800            WRITE ASNHDR-DELETE-RECORD                            13180000
131900               FROM SN002O-ASN-DELETE-RECORD                      13190000
132000      END-IF.                                                     13200000
132100                                                                  13210000
132200***************************************************************** 13220000
132300 B331-PROCESS-TASCRIT-CAR.                                        13230000
132400     MOVE 'B330-PROCESS-TASCRIT           '                       13240000
132500                                 TO PW-CURRENT-PARA.              13250000
132600                                                                  13260000
132700      INITIALIZE DCLTASCRIT.                                      13270000
132800     INITIALIZE SN002O-ASN-DELETE-RECORD.                         13280000
132900                                                                  13290000
133000      PERFORM  X291-FETCH-ASCRIT-CAR-CURSOR.                      13300000
133100      IF SQLCODE = ZERO                                           13310000
133200            MOVE 'TASNCAR' TO MSG-1A-PARENT-NAME                  13320000
133300            MOVE MSG-1A                                           13330000
133400                  TO  PW-ADV-SHIP-NOTICE-LINE                     13340000
                  DISPLAY MSG-1A                                        13341000
133500            PERFORM  Z510-WRITE-REPORT-LINE                       13350000
133600*           MOVE ASCRIT-OPERCO-NBR TO PO-ASCRIT-OPERCO-NBR        13360000
133700*           MOVE ASCRIT-EDI-VEND-ID TO PO-ASCRIT-EDI-VEND-ID      13370000
133800*           MOVE ASCRIT-ASNHDR-NBR  TO PO-ASCRIT-ASNHDR-NBR       13380000
133900            MOVE ASCRIT-ASNHDR-ID  TO PO-ASCRIT-ASNHDR-ID         13390000
134000            MOVE ASCRIT-ASNCAR-NBR  TO PO-ASCRIT-ASNCAR-NBR       13400000
134100            MOVE ASCRIT-ASNDTL-NBR  TO PO-ASCRIT-ASNDTL-NBR       13410000
134200            MOVE PO-ASCRIT-RECORD                                 13420000
134300                  TO  PW-ADV-SHIP-NOTICE-LINE                     13430000
134400            PERFORM  Z500-WRITE-REPORT-LINE                       13440000
134500                 SET ERROR-DETECTED  TO TRUE                      13450000
134600                                                                  13460000
134700*           MOVE  ASCRIT-OPERCO-NBR  TO SN002O-OPERCO-NBR         13470000
134800*           MOVE  ASCRIT-EDI-VEND-ID TO SN002O-EDI-VEND-ID        13480000
134900*           MOVE  ASCRIT-ASNHDR-NBR TO SN002O-ASNHDR-NBR          13490000
135000            MOVE  ASCRIT-ASNHDR-ID TO SN002O-ASNHDR-ID            13500000
135100                                                                  13510000
135200            WRITE ASNHDR-DELETE-RECORD                            13520000
135300               FROM SN002O-ASN-DELETE-RECORD                      13530000
135400      END-IF.                                                     13540000
135500                                                                  13550000
135600***************************************************************** 13560000
135700 B340-PROCESS-TASHADT.                                            13570000
135800     MOVE 'B340-PROCESS-TASHADT           '                       13580000
135900                                 TO PW-CURRENT-PARA.              13590000
136000     INITIALIZE SN002O-ASN-DELETE-RECORD.                         13600000
136100                                                                  13610000
136200      PERFORM  X295-FETCH-ASHADT-CURSOR.                          13620000
136300      IF SQLCODE = ZERO                                           13630000
136400            MOVE 'TASHADR' TO MSG-1A-PARENT-NAME                  13640000
136500            MOVE MSG-1A                                           13650000
136600                  TO  PW-ADV-SHIP-NOTICE-LINE                     13660000
                  DISPLAY MSG-1A                                        13661000
136700            PERFORM  Z510-WRITE-REPORT-LINE                       13670000
136800            PERFORM  Z100-MOVE-DATA                               13680000
136900            MOVE PO-ASOADR-RECORD                                 13690000
137000                  TO  PW-ADV-SHIP-NOTICE-LINE                     13700000
137100            PERFORM  Z500-WRITE-REPORT-LINE                       13710000
137200                 SET ERROR-DETECTED  TO TRUE                      13720000
137300                                                                  13730000
137400*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      13740000
137500*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     13750000
137600*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       13760000
137700            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        13770000
137800                                                                  13780000
137900            WRITE ASNHDR-DELETE-RECORD                            13790000
138000               FROM SN002O-ASN-DELETE-RECORD                      13800000
138100      END-IF.                                                     13810000
138200                                                                  13820000
138300***************************************************************** 13830000
138400 B350-PROCESS-TASHANM.                                            13840000
138500     MOVE 'B350-PROCESS-TASHANM           '                       13850000
138600                                 TO PW-CURRENT-PARA.              13860000
138700     INITIALIZE SN002O-ASN-DELETE-RECORD.                         13870000
138800                                                                  13880000
138900      PERFORM  X298-FETCH-ASHANM-CURSOR.                          13890000
139000      IF SQLCODE = ZERO                                           13900000
139100            MOVE 'TASHADR' TO MSG-1A-PARENT-NAME                  13910000
139200            MOVE MSG-1A                                           13920000
139300                  TO  PW-ADV-SHIP-NOTICE-LINE                     13930000
                  DISPLAY MSG-1A                                        13931000
139400            PERFORM  Z510-WRITE-REPORT-LINE                       13940000
139500            PERFORM  Z100-MOVE-DATA                               13950000
139600            MOVE PO-ASOADR-RECORD                                 13960000
139700                  TO  PW-ADV-SHIP-NOTICE-LINE                     13970000
139800            PERFORM  Z500-WRITE-REPORT-LINE                       13980000
139900                 SET ERROR-DETECTED  TO TRUE                      13990000
140000                                                                  14000000
140100*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      14010000
140200*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     14020000
140300*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       14030000
140400            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        14040000
140500                                                                  14050000
140600            WRITE ASNHDR-DELETE-RECORD                            14060000
140700               FROM SN002O-ASN-DELETE-RECORD                      14070000
140800      END-IF.                                                     14080000
140900                                                                  14090000
141000***************************************************************** 14100000
141100*                                                               * 14110000
141200***************************************************************** 14120000
141300 B400-PROCESS-TASNDTL.                                            14130000
141400     MOVE 'B400-PROCESS-TASNDTL           '                       14140000
141500                                 TO PW-CURRENT-PARA.              14150000
141600     INITIALIZE SN002O-ASN-DELETE-RECORD.                         14160000
141700                                                                  14170000
141800      PERFORM  X230-FETCH-ASNDTL-CURSOR.                          14180000
141900      IF SQLCODE = ZERO                                           14190000
142000            MOVE 'TASNORD' TO MSG-1A-PARENT-NAME                  14200000
142100            MOVE MSG-1A                                           14210000
142200                  TO  PW-ADV-SHIP-NOTICE-LINE                     14220000
                  DISPLAY MSG-1A                                        14221000
142300            PERFORM  Z510-WRITE-REPORT-LINE                       14230000
142400            PERFORM  Z100-MOVE-DATA                               14240000
142500            MOVE PO-ASOADR-RECORD                                 14250000
142600                  TO  PW-ADV-SHIP-NOTICE-LINE                     14260000
142700            PERFORM  Z500-WRITE-REPORT-LINE                       14270000
142800                 SET ERROR-DETECTED  TO TRUE                      14280000
142900                                                                  14290000
143000*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      14300000
143100*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     14310000
143200*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       14320000
143300            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        14330000
143400                                                                  14340000
143500            WRITE ASNHDR-DELETE-RECORD                            14350000
143600               FROM SN002O-ASN-DELETE-RECORD                      14360000
143700      END-IF.                                                     14370000
143800                                                                  14380000
143900***************************************************************** 14390000
144000 B500-PROCESS-TASNCAR.                                            14400000
144100     MOVE 'B500-PROCESS-TASNCAR           '                       14410000
144200                                 TO PW-CURRENT-PARA.              14420000
144300     INITIALIZE SN002O-ASN-DELETE-RECORD.                         14430000
144400                                                                  14440000
144500      PERFORM  X240-FETCH-ASNCAR-CURSOR.                          14450000
144600      IF SQLCODE = ZERO                                           14460000
144700            MOVE 'TASNORD' TO MSG-1A-PARENT-NAME                  14470000
144800            MOVE MSG-1A                                           14480000
144900                  TO  PW-ADV-SHIP-NOTICE-LINE                     14490000
                  DISPLAY MSG-1A                                        14491000
145000            PERFORM  Z510-WRITE-REPORT-LINE                       14500000
145100            PERFORM  Z100-MOVE-DATA                               14510000
145200            MOVE PO-ASOADR-RECORD                                 14520000
145300                  TO  PW-ADV-SHIP-NOTICE-LINE                     14530000
145400            PERFORM  Z500-WRITE-REPORT-LINE                       14540000
145500                 SET ERROR-DETECTED  TO TRUE                      14550000
145600                                                                  14560000
145700*           MOVE  PW-ASOADR-OPERCO-NBR  TO SN002O-OPERCO-NBR      14570000
145800*           MOVE  PW-ASOADR-EDI-VEND-ID TO SN002O-EDI-VEND-ID     14580000
145900*           MOVE  PW-ASOADR-ASNHDR-NBR TO SN002O-ASNHDR-NBR       14590000
146000            MOVE  PW-ASOADR-ASNHDR-ID  TO SN002O-ASNHDR-ID        14600000
146100                                                                  14610000
146200            WRITE ASNHDR-DELETE-RECORD                            14620000
146300               FROM SN002O-ASN-DELETE-RECORD                      14630000
146400      END-IF.                                                     14640000
146500                                                                  14650000
146600***************************************************************** 14660000
146700*     SQL FETCH CURSOR ON TASOADT                               * 14670000
146800*                                                               * 14680000
146900***************************************************************** 14690000
147000 X200-FETCH-ASNORD-CURSOR.                                        14700000
147100                                                                  14710000
147200     MOVE 'X200-FETCH-ASNORD-CURSOR           '                   14720000
147300                                 TO PW-CURRENT-PARA.              14730000
147400         EXEC SQL                                                 14740000
147500          FETCH ASN_ASNORD_CURSOR                                 14750000
147600          INTO :ASNORD-ASNHDR-ID                                  14760000
147700         END-EXEC.                                                14770000
147800                                                                  14780000
147900                                                                  14790000
148000         EVALUATE TRUE                                            14800000
148100           WHEN SQLCODE = ZERO                                    14810000
148200                 MOVE ASNORD-ASNHDR-ID TO PW-ASNHDR-ASNHDR-ID     14820000
148300                 CONTINUE                                         14830000
148400           WHEN SQLCODE = +100                                    14840000
148500              SET PS-NO-DATA-LEFT      TO TRUE                    14850000
148600           WHEN SQLCODE < ZERO                                    14860000
148700                 DISPLAY '**************************************' 14870000
148800                 DISPLAY 'ERROR ISSUED ON FETCH OF ASNORD CURSOR' 14880000
148900                 DISPLAY 'ASNHDR-ID:         '                    14890000
149000                          ASNORD-ASNHDR-ID                        14900000
149100                 DISPLAY '**************************************' 14910000
149200                 PERFORM Z900-SQL-ERROR                           14920000
149300                                                                  14930000
149400         END-EVALUATE.                                            14940000
149500                                                                  14950000
149600/                                                                 14960000
149700***************************************************************** 14970000
149800*     SQL FETCH CURSOR ON TASOADR                               * 14980000
149900*                                                               * 14990000
150000***************************************************************** 15000000
150100 X210-FETCH-ASOADR-CURSOR.                                        15010000
150200                                                                  15020000
150300     MOVE 'X210-FETCH-ASOADR-CURSOR           '                   15030000
150400                                 TO PW-CURRENT-PARA.              15040000
150500         EXEC SQL                                                 15050000
150600          FETCH ASN_ASOADR_CURSOR                                 15060000
150700          INTO :PW-ASOADR-PO-NBR,                                 15070000
150900               :PW-ASOADR-SELR-INV-NBR,                           15090000
151000               :PW-ASOADR-ASNHDR-ID                               15100000
151100         END-EXEC.                                                15110000
151200                                                                  15120000
151300                                                                  15130000
151400         EVALUATE TRUE                                            15140000
151500           WHEN SQLCODE = ZERO                                    15150000
151600                 CONTINUE                                         15160000
151700           WHEN SQLCODE = +100                                    15170000
151800              SET PS-NO-DATA-LEFT      TO TRUE                    15180000
151900           WHEN SQLCODE < ZERO                                    15190000
152000                 DISPLAY '**************************************' 15200000
152100                 DISPLAY 'ERROR ISSUED ON FETCH OF ASOADR CURSOR' 15210000
152200                 DISPLAY 'ASNHDR-ID:         '                    15220000
152300                       PW-ASOADR-ASNHDR-ID                        15230000
152400                 DISPLAY 'PO-NBR:    '                            15240000
152500                       PW-ASOADR-PO-NBR                           15250000
152800                 DISPLAY 'SELR-INV-NBR:'                          15280000
152900                       PW-ASOADR-SELR-INV-NBR                     15290000
153000                 DISPLAY '**************************************' 15300000
153100                 PERFORM Z900-SQL-ERROR                           15310000
153200                                                                  15320000
153300         END-EVALUATE.                                            15330000
153400                                                                  15340000
153500/                                                                 15350000
153600***************************************************************** 15360000
153700*     SQL FETCH CURSOR ON TASOADT                               * 15370000
153800*                                                               * 15380000
153900***************************************************************** 15390000
154000 X220-FETCH-ASOADT-CURSOR.                                        15400000
154100                                                                  15410000
154200     MOVE 'X220-FETCH-ASOADT-CURSOR           '                   15420000
154300                                 TO PW-CURRENT-PARA.              15430000
154400         EXEC SQL                                                 15440000
154500          FETCH ASN_ASOADT_CURSOR                                 15450000
154600          INTO :PW-ASOADR-PO-NBR,                                 15460000
154800               :PW-ASOADR-NAME-CDE,                               15480000
154900               :PW-ASOADR-SELR-INV-NBR,                           15490000
155000               :PW-ASOADR-ASNHDR-ID                               15500000
155100         END-EXEC.                                                15510000
155200                                                                  15520000
155300                                                                  15530000
155400         EVALUATE TRUE                                            15540000
155500           WHEN SQLCODE = ZERO                                    15550000
155600                 CONTINUE                                         15560000
155700           WHEN SQLCODE = +100                                    15570000
155800              SET PS-NO-DATA-LEFT      TO TRUE                    15580000
155900           WHEN SQLCODE < ZERO                                    15590000
156000                 DISPLAY '**************************************' 15600000
156100                 DISPLAY 'ERROR ISSUED ON FETCH OF ASOADT CURSOR' 15610000
156200                 DISPLAY 'ASNHDR-ID:         '                    15620000
156300                       PW-ASOADR-ASNHDR-ID                        15630000
156400                 DISPLAY 'PO-NBR:    '                            15640000
156500                       PW-ASOADR-PO-NBR                           15650000
156800                 DISPLAY 'ASOADT-NBR:'                            15680000
156900                       PW-ASOADR-ASOANM-NBR                       15690000
157000                 DISPLAY 'SELR-INV-NBR:'                          15700000
157100                       PW-ASOADR-SELR-INV-NBR                     15710000
157200                 DISPLAY '**************************************' 15720000
157300                 PERFORM Z900-SQL-ERROR                           15730000
157400                                                                  15740000
157500         END-EVALUATE.                                            15750000
157600                                                                  15760000
157700/                                                                 15770000
157800***************************************************************** 15780000
157900 X230-FETCH-ASNDTL-CURSOR.                                        15790000
158000                                                                  15800000
158100     MOVE 'X230-FETCH-ASNDTL-CURSOR           '                   15810000
158200                                 TO PW-CURRENT-PARA.              15820000
158300         EXEC SQL                                                 15830000
158400          FETCH ASN_ASNDTL_CURSOR                                 15840000
158500          INTO :PW-ASOADR-PO-NBR,                                 15850000
158700               :PW-ASOADR-SELR-INV-NBR,                           15870000
158800               :PW-ASOADR-ASNHDR-ID                               15880000
158900         END-EXEC.                                                15890000
159000                                                                  15900000
159100                                                                  15910000
159200         EVALUATE TRUE                                            15920000
159300           WHEN SQLCODE = ZERO                                    15930000
159400                 CONTINUE                                         15940000
159500           WHEN SQLCODE = +100                                    15950000
159600              SET PS-NO-DATA-LEFT      TO TRUE                    15960000
159700           WHEN SQLCODE < ZERO                                    15970000
159800                 DISPLAY '**************************************' 15980000
159900                 DISPLAY 'ERROR ISSUED ON FETCH OF ASNDTL CURSOR' 15990000
160000                 DISPLAY 'ASNHDR-ID:         '                    16000000
160100                       PW-ASOADR-ASNHDR-ID                        16010000
160200                 DISPLAY 'PO-NBR:    '                            16020000
160300                       PW-ASOADR-PO-NBR                           16030000
160600                 DISPLAY 'SELR-INV-NBR:'                          16060000
160700                       PW-ASOADR-SELR-INV-NBR                     16070000
160800                 DISPLAY '**************************************' 16080000
160900                 PERFORM Z900-SQL-ERROR                           16090000
161000                                                                  16100000
161100         END-EVALUATE.                                            16110000
161200                                                                  16120000
161300/                                                                 16130000
161400***************************************************************** 16140000
161500 X240-FETCH-ASNCAR-CURSOR.                                        16150000
161600                                                                  16160000
161700     MOVE 'X240-FETCH-ASNCAR-CURSOR           '                   16170000
161800                                 TO PW-CURRENT-PARA.              16180000
161900         EXEC SQL                                                 16190000
162000          FETCH ASN_ASNCAR_CURSOR                                 16200000
162100           INTO:PW-ASOADR-PO-NBR,                                 16210000
162300               :PW-ASOADR-SELR-INV-NBR,                           16230000
162400               :PW-ASOADR-ASNHDR-ID                               16240000
162500         END-EXEC.                                                16250000
162600                                                                  16260000
162700                                                                  16270000
162800         EVALUATE TRUE                                            16280000
162900           WHEN SQLCODE = ZERO                                    16290000
163000                 CONTINUE                                         16300000
163100           WHEN SQLCODE = +100                                    16310000
163200              SET PS-NO-DATA-LEFT      TO TRUE                    16320000
163300           WHEN SQLCODE < ZERO                                    16330000
163400                 DISPLAY '**************************************' 16340000
163500                 DISPLAY 'ERROR ISSUED ON FETCH OF ASNCAR CURSOR' 16350000
163600                 DISPLAY 'ASNHDR-ID:         '                    16360000
163700                       PW-ASOADR-ASNHDR-ID                        16370000
163800                 DISPLAY 'PO-NBR:    '                            16380000
163900                       PW-ASOADR-PO-NBR                           16390000
164200                 DISPLAY 'SELR-INV-NBR:'                          16420000
164300                       PW-ASOADR-SELR-INV-NBR                     16430000
164400                 DISPLAY '**************************************' 16440000
164500                 PERFORM Z900-SQL-ERROR                           16450000
164600                                                                  16460000
164700         END-EVALUATE.                                            16470000
164800                                                                  16480000
164900/                                                                 16490000
165000***************************************************************** 16500000
165100*     SQL FETCH CURSOR ON TASNPKG                               * 16510000
165200*                                                               * 16520000
165300***************************************************************** 16530000
165400 X250-FETCH-ASNPKG-CURSOR.                                        16540000
165500                                                                  16550000
165600     MOVE 'X250-FETCH-ASNPKG-CURSOR           '                   16560000
165700                                 TO PW-CURRENT-PARA.              16570000
165800         EXEC SQL                                                 16580000
165900          FETCH ASN_ASNPKG_CURSOR                                 16590000
166000           INTO:ASNORD-ASNHDR-ID                                  16600000
166100         END-EXEC.                                                16610000
166200                                                                  16620000
166300                                                                  16630000
166400         EVALUATE TRUE                                            16640000
166500           WHEN SQLCODE = ZERO                                    16650000
166600                 MOVE ASNORD-ASNHDR-ID TO PW-ASNHDR-ASNHDR-ID     16660000
166700                 CONTINUE                                         16670000
166800           WHEN SQLCODE = +100                                    16680000
166900              SET PS-NO-DATA-LEFT      TO TRUE                    16690000
167000           WHEN SQLCODE < ZERO                                    16700000
167100                 DISPLAY '**************************************' 16710000
167200                 DISPLAY 'ERROR ISSUED ON FETCH OF ASNPKG CURSOR' 16720000
167300                 DISPLAY 'ASNHDR-ID:         '                    16730000
167400                       PW-ASNHDR-ASNHDR-ID                        16740000
167500*                DISPLAY 'ASNPKG-CDE:'                            16750000
167600*                         ASNPKG-ASNPKG-CDE                       16760000
167700                 DISPLAY '**************************************' 16770000
167800                 PERFORM Z900-SQL-ERROR                           16780000
167900                                                                  16790000
168000         END-EVALUATE.                                            16800000
168100                                                                  16810000
168200/                                                                 16820000
168300***************************************************************** 16830000
168400 X260-FETCH-ASHADR-CURSOR.                                        16840000
168500                                                                  16850000
168600     MOVE 'X260-FETCH-ASHADR-CURSOR           '                   16860000
168700                                 TO PW-CURRENT-PARA.              16870000
168800         EXEC SQL                                                 16880000
168900          FETCH ASN_ASHADR_CURSOR                                 16890000
169000           INTO :ASNORD-ASNHDR-ID                                 16900000
169100         END-EXEC.                                                16910000
169200                                                                  16920000
169300                                                                  16930000
169400         EVALUATE TRUE                                            16940000
169500           WHEN SQLCODE = ZERO                                    16950000
169600                 MOVE ASNORD-ASNHDR-ID TO PW-ASNHDR-ASNHDR-ID     16960000
169700                 CONTINUE                                         16970000
169800           WHEN SQLCODE = +100                                    16980000
169900              SET PS-NO-DATA-LEFT      TO TRUE                    16990000
170000           WHEN SQLCODE < ZERO                                    17000000
170100                 DISPLAY '**************************************' 17010000
170200                 DISPLAY 'ERROR ISSUED ON FETCH OF ASHADR CURSOR' 17020000
170300                 DISPLAY 'ASNHDR-ID:         '                    17030000
170400                       PW-ASNHDR-ASNHDR-ID                        17040000
170500*                DISPLAY 'NAME-CDE:  '                            17050000
170600*                         ASHADR-NAME-CDE                         17060000
170700                 DISPLAY '**************************************' 17070000
170800                 PERFORM Z900-SQL-ERROR                           17080000
170900                                                                  17090000
171000         END-EVALUATE.                                            17100000
171100                                                                  17110000
171200/                                                                 17120000
171300***************************************************************** 17130000
171400 X270-FETCH-ASOANM-CURSOR.                                        17140000
171500                                                                  17150000
171600     MOVE 'X270-FETCH-ASOANM-CURSOR           '                   17160000
171700                                 TO PW-CURRENT-PARA.              17170000
171800         EXEC SQL                                                 17180000
171900          FETCH ASN_ASOANM_CURSOR                                 17190000
172000          INTO :PW-ASOADR-PO-NBR,                                 17200000
172200               :PW-ASOADR-NAME-CDE,                               17220000
172300               :PW-ASOADR-SELR-INV-NBR,                           17230000
172400               :PW-ASOADR-ASNHDR-ID                               17240000
172500         END-EXEC.                                                17250000
172600                                                                  17260000
172700                                                                  17270000
172800         EVALUATE TRUE                                            17280000
172900           WHEN SQLCODE = ZERO                                    17290000
173000                 CONTINUE                                         17300000
173100           WHEN SQLCODE = +100                                    17310000
173200              SET PS-NO-DATA-LEFT      TO TRUE                    17320000
173300           WHEN SQLCODE < ZERO                                    17330000
173400                 DISPLAY '**************************************' 17340000
173500                 DISPLAY 'ERROR ISSUED ON FETCH OF ASOANM CURSOR' 17350000
173600                 DISPLAY 'ASNHDR-ID:         '                    17360000
173700                       PW-ASOADR-ASNHDR-ID                        17370000
173800                 DISPLAY 'PO-NBR:    '                            17380000
173900                       PW-ASOADR-PO-NBR                           17390000
174200                 DISPLAY 'ASOADT-NBR:'                            17420000
174300                       PW-ASOADR-ASOANM-NBR                       17430000
174400                 DISPLAY 'SELR-INV-NBR:'                          17440000
174500                       PW-ASOADR-SELR-INV-NBR                     17450000
174600                 DISPLAY '**************************************' 17460000
174700                 PERFORM Z900-SQL-ERROR                           17470000
174800                                                                  17480000
174900         END-EVALUATE.                                            17490000
175000                                                                  17500000
175100/                                                                 17510000
175200***************************************************************** 17520000
175300 X280-FETCH-ASDTPL-CURSOR.                                        17530000
175400                                                                  17540000
175500     MOVE 'X280-FETCH-ASDTPL-CURSOR           '                   17550000
175600                                 TO PW-CURRENT-PARA.              17560000
175700         EXEC SQL                                                 17570000
175800          FETCH ASN_ASDTPL_CURSOR                                 17580000
175900           INTO:PW-ASNDTL-ASNDTL-NBR,                             17590000
176000               :PW-ASNDTL-ASNHDR-ID                               17600000
176100         END-EXEC.                                                17610000
176200                                                                  17620000
176300                                                                  17630000
176400         EVALUATE TRUE                                            17640000
176500           WHEN SQLCODE = ZERO                                    17650000
176600                 CONTINUE                                         17660000
176700           WHEN SQLCODE = +100                                    17670000
176800              SET PS-NO-DATA-LEFT      TO TRUE                    17680000
176900           WHEN SQLCODE < ZERO                                    17690000
177000                 DISPLAY '**************************************' 17700000
177100                 DISPLAY 'ERROR ISSUED ON FETCH OF ASDTPL CURSOR' 17710000
177200                 DISPLAY 'ASNHDR-ID:         '                    17720000
177300                       PW-ASNDTL-ASNHDR-ID                        17730000
177400                 DISPLAY 'ASNDTL-NBR:         '                   17740000
177500                       PW-ASNDTL-ASNDTL-NBR                       17750000
177600                 DISPLAY '**************************************' 17760000
177700                 PERFORM Z900-SQL-ERROR                           17770000
177800                                                                  17780000
177900         END-EVALUATE.                                            17790000
178000                                                                  17800000
178100/                                                                 17810000
178200***************************************************************** 17820000
178300 X290-FETCH-ASCRIT-DTL-CURSOR.                                    17830000
178400                                                                  17840000
178500     MOVE 'X290-FETCH-ASCRIT-DTL-CURSOR       '                   17850000
178600                                 TO PW-CURRENT-PARA.              17860000
178700         EXEC SQL                                                 17870000
178800          FETCH ASN_ASCRIT_DTL                                    17880000
178900          INTO :ASCRIT-ASNCAR-NBR,                                17890000
179000               :ASCRIT-ASNDTL-NBR,                                17900000
179100               :ASCRIT-ASNHDR-ID                                  17910000
179200         END-EXEC.                                                17920000
179300                                                                  17930000
179400                                                                  17940000
179500         EVALUATE TRUE                                            17950000
179600           WHEN SQLCODE = ZERO                                    17960000
179700                 CONTINUE                                         17970000
179800           WHEN SQLCODE = +100                                    17980000
179900              SET PS-NO-DATA-LEFT      TO TRUE                    17990000
180000           WHEN SQLCODE < ZERO                                    18000000
180100                 DISPLAY '**************************************' 18010000
180200                 DISPLAY 'ERROR ISSUED ON FETCH OF ASCRIT CURSOR' 18020000
180300                 DISPLAY 'ASNHDR-ID:         '                    18030000
180400                          ASCRIT-ASNHDR-ID                        18040000
180500                 DISPLAY 'ASNDTL-NBR:         '                   18050000
180600                          ASCRIT-ASNDTL-NBR                       18060000
180700                 DISPLAY 'ASNCAR-NBR:         '                   18070000
180800                          ASCRIT-ASNCAR-NBR                       18080000
180900                 DISPLAY '**************************************' 18090000
181000                 PERFORM Z900-SQL-ERROR                           18100000
181100                                                                  18110000
181200         END-EVALUATE.                                            18120000
181300                                                                  18130000
181400/                                                                 18140000
181500***************************************************************** 18150000
181600 X291-FETCH-ASCRIT-CAR-CURSOR.                                    18160000
181700                                                                  18170000
181800     MOVE 'X291-FETCH-ASCRIT-CAR-CURSOR       '                   18180000
181900                                 TO PW-CURRENT-PARA.              18190000
182000         EXEC SQL                                                 18200000
182100          FETCH ASN_ASCRIT_CAR                                    18210000
182200           INTO:ASCRIT-ASNCAR-NBR,                                18220000
182300               :ASCRIT-ASNDTL-NBR,                                18230000
182400               :ASCRIT-ASNHDR-ID                                  18240000
182500         END-EXEC.                                                18250000
182600                                                                  18260000
182700                                                                  18270000
182800         EVALUATE TRUE                                            18280000
182900           WHEN SQLCODE = ZERO                                    18290000
183000                 CONTINUE                                         18300000
183100           WHEN SQLCODE = +100                                    18310000
183200              SET PS-NO-DATA-LEFT      TO TRUE                    18320000
183300           WHEN SQLCODE < ZERO                                    18330000
183400                 DISPLAY '**************************************' 18340000
183500                 DISPLAY 'ERROR ISSUED ON FETCH OF ASCRIT CURSOR' 18350000
183600                 DISPLAY 'ASNHDR-ID:         '                    18360000
183700                          ASCRIT-ASNHDR-ID                        18370000
183800                 DISPLAY 'ASNDTL-NBR:         '                   18380000
183900                          ASCRIT-ASNDTL-NBR                       18390000
184000                 DISPLAY 'ASNCAR-NBR:         '                   18400000
184100                          ASCRIT-ASNCAR-NBR                       18410000
184200                 DISPLAY '**************************************' 18420000
184300                 PERFORM Z900-SQL-ERROR                           18430000
184400                                                                  18440000
184500         END-EVALUATE.                                            18450000
184600                                                                  18460000
184700/                                                                 18470000
184800***************************************************************** 18480000
184900 X295-FETCH-ASHADT-CURSOR.                                        18490000
185000                                                                  18500000
185100     MOVE 'X295-FETCH-ASHADT-CURSOR           '                   18510000
185200                                 TO PW-CURRENT-PARA.              18520000
185300         EXEC SQL                                                 18530000
185400          FETCH ASN_ASHADT_CURSOR                                 18540000
185500          INTO :PW-ASOADR-NAME-CDE,                               18550000
185600               :PW-ASOADR-ASNHDR-ID                               18560000
185700         END-EXEC.                                                18570000
185800                                                                  18580000
185900                                                                  18590000
186000         EVALUATE TRUE                                            18600000
186100           WHEN SQLCODE = ZERO                                    18610000
186200                 CONTINUE                                         18620000
186300           WHEN SQLCODE = +100                                    18630000
186400              SET PS-NO-DATA-LEFT      TO TRUE                    18640000
186500           WHEN SQLCODE < ZERO                                    18650000
186600                 DISPLAY '**************************************' 18660000
186700                 DISPLAY 'ERROR ISSUED ON FETCH OF ASHADT CURSOR' 18670000
186800                 DISPLAY 'ASNHDR-ID:         '                    18680000
186900                       PW-ASOADR-ASNHDR-ID                        18690000
187000                 DISPLAY 'NAME-CDE:           '                   18700000
187100                       PW-ASOADR-NAME-CDE                         18710000
187200                 DISPLAY '**************************************' 18720000
187300                 PERFORM Z900-SQL-ERROR                           18730000
187400                                                                  18740000
187500         END-EVALUATE.                                            18750000
187600                                                                  18760000
187700/                                                                 18770000
187800***************************************************************** 18780000
187900 X298-FETCH-ASHANM-CURSOR.                                        18790000
188000                                                                  18800000
188100     MOVE 'X298-FETCH-ASHANM-CURSOR           '                   18810000
188200                                 TO PW-CURRENT-PARA.              18820000
188300         EXEC SQL                                                 18830000
188400          FETCH ASN_ASHANM_CURSOR                                 18840000
188500           INTO:PW-ASOADR-NAME-CDE,                               18850000
188600               :PW-ASOADR-ASNHDR-ID                               18860000
188700         END-EXEC.                                                18870000
188800                                                                  18880000
188900                                                                  18890000
189000         EVALUATE TRUE                                            18900000
189100           WHEN SQLCODE = ZERO                                    18910000
189200                 CONTINUE                                         18920000
189300           WHEN SQLCODE = +100                                    18930000
189400              SET PS-NO-DATA-LEFT      TO TRUE                    18940000
189500           WHEN SQLCODE < ZERO                                    18950000
189600                 DISPLAY '**************************************' 18960000
189700                 DISPLAY 'ERROR ISSUED ON FETCH OF ASHANM CURSOR' 18970000
189800                 DISPLAY 'ASNHDR-ID:         '                    18980000
189900                       PW-ASOADR-ASNHDR-ID                        18990000
190000                 DISPLAY 'NAME-CDE:           '                   19000000
190100                       PW-ASOADR-NAME-CDE                         19010000
190200                 DISPLAY '**************************************' 19020000
190300                 PERFORM Z900-SQL-ERROR                           19030000
190400                                                                  19040000
190500         END-EVALUATE.                                            19050000
190600                                                                  19060000
190700/                                                                 19070000
190800***************************************************************** 19080000
190900*     SQL OPEN  CURSOR ON TASOADT                               * 19090000
191000*                                                               * 19100000
191100***************************************************************** 19110000
191200 X100-OPEN-ASNORD-CURSOR.                                         19120000
191300                                                                  19130000
191400     MOVE 'X100-OPEN-ASNORD-CURSOR           '                    19140000
191500                                 TO PW-CURRENT-PARA.              19150000
191600         EXEC SQL                                                 19160000
191700          OPEN ASN_ASNORD_CURSOR                                  19170000
191800         END-EXEC.                                                19180000
191900                                                                  19190000
192000         EVALUATE TRUE                                            19200000
192100           WHEN SQLCODE = ZERO                                    19210000
192200           WHEN SQLCODE = +100                                    19220000
192300                 CONTINUE                                         19230000
192400           WHEN  OTHER                                            19240000
192500                 DISPLAY '**************************************' 19250000
192600                 DISPLAY 'ERROR ISSUED ON OPEN OF ASNORD CURSOR'  19260000
192700                 DISPLAY '**************************************' 19270000
192800                 PERFORM Z900-SQL-ERROR                           19280000
192900                                                                  19290000
193000         END-EVALUATE.                                            19300000
193100                                                                  19310000
193200/                                                                 19320000
193300***************************************************************** 19330000
193400 X110-OPEN-ASOADR-CURSOR.                                         19340000
193500                                                                  19350000
193600     MOVE 'X110-OPEN-ASOADR-CURSOR           '                    19360000
193700                                 TO PW-CURRENT-PARA.              19370000
193800         EXEC SQL                                                 19380000
193900          OPEN ASN_ASOADR_CURSOR                                  19390000
194000         END-EXEC.                                                19400000
194100                                                                  19410000
194200         EVALUATE TRUE                                            19420000
194300           WHEN SQLCODE = ZERO                                    19430000
194400           WHEN SQLCODE = +100                                    19440000
194500                 CONTINUE                                         19450000
194600           WHEN  OTHER                                            19460000
194700                 DISPLAY '**************************************' 19470000
194800                 DISPLAY 'ERROR ISSUED ON OPEN OF ASOADR CURSOR'  19480000
194900                 DISPLAY '**************************************' 19490000
195000                 PERFORM Z900-SQL-ERROR                           19500000
195100                                                                  19510000
195200         END-EVALUATE.                                            19520000
195300                                                                  19530000
195400/                                                                 19540000
195500***************************************************************** 19550000
195600 X120-OPEN-ASOADT-CURSOR.                                         19560000
195700                                                                  19570000
195800     MOVE 'X120-OPEN-ASOADT-CURSOR           '                    19580000
195900                                 TO PW-CURRENT-PARA.              19590000
196000         EXEC SQL                                                 19600000
196100          OPEN ASN_ASOADT_CURSOR                                  19610000
196200         END-EXEC.                                                19620000
196300                                                                  19630000
196400         EVALUATE TRUE                                            19640000
196500           WHEN SQLCODE = ZERO                                    19650000
196600           WHEN SQLCODE = +100                                    19660000
196700                 CONTINUE                                         19670000
196800           WHEN  OTHER                                            19680000
196900                 DISPLAY '**************************************' 19690000
197000                 DISPLAY 'ERROR ISSUED ON OPEN OF ASOADT CURSOR'  19700000
197100                 DISPLAY '**************************************' 19710000
197200                 PERFORM Z900-SQL-ERROR                           19720000
197300                                                                  19730000
197400         END-EVALUATE.                                            19740000
197500                                                                  19750000
197600/                                                                 19760000
197700***************************************************************** 19770000
197800 X130-OPEN-ASNDTL-CURSOR.                                         19780000
197900                                                                  19790000
198000     MOVE 'X130-OPEN-ASNDTL-CURSOR           '                    19800000
198100                                 TO PW-CURRENT-PARA.              19810000
198200         EXEC SQL                                                 19820000
198300          OPEN ASN_ASNDTL_CURSOR                                  19830000
198400         END-EXEC.                                                19840000
198500                                                                  19850000
198600         EVALUATE TRUE                                            19860000
198700           WHEN SQLCODE = ZERO                                    19870000
198800           WHEN SQLCODE = +100                                    19880000
198900                 CONTINUE                                         19890000
199000           WHEN  OTHER                                            19900000
199100                 DISPLAY '**************************************' 19910000
199200                 DISPLAY 'ERROR ISSUED ON OPEN OF ASNDTL CURSOR'  19920000
199300                 DISPLAY '**************************************' 19930000
199400                 PERFORM Z900-SQL-ERROR                           19940000
199500                                                                  19950000
199600         END-EVALUATE.                                            19960000
199700                                                                  19970000
199800/                                                                 19980000
199900***************************************************************** 19990000
200000 X140-OPEN-ASNCAR-CURSOR.                                         20000000
200100                                                                  20010000
200200     MOVE 'X140-OPEN-ASNCAR-CURSOR           '                    20020000
200300                                 TO PW-CURRENT-PARA.              20030000
200400         EXEC SQL                                                 20040000
200500          OPEN ASN_ASNCAR_CURSOR                                  20050000
200600         END-EXEC.                                                20060000
200700                                                                  20070000
200800         EVALUATE TRUE                                            20080000
200900           WHEN SQLCODE = ZERO                                    20090000
201000           WHEN SQLCODE = +100                                    20100000
201100                 CONTINUE                                         20110000
201200           WHEN  OTHER                                            20120000
201300                 DISPLAY '**************************************' 20130000
201400                 DISPLAY 'ERROR ISSUED ON OPEN OF ASNCAR CURSOR'  20140000
201500                 DISPLAY '**************************************' 20150000
201600                 PERFORM Z900-SQL-ERROR                           20160000
201700                                                                  20170000
201800         END-EVALUATE.                                            20180000
201900                                                                  20190000
202000/                                                                 20200000
202100***************************************************************** 20210000
202200 X150-OPEN-ASNPKG-CURSOR.                                         20220000
202300                                                                  20230000
202400     MOVE 'X150-OPEN-ASNPKG-CURSOR           '                    20240000
202500                                 TO PW-CURRENT-PARA.              20250000
202600         EXEC SQL                                                 20260000
202700          OPEN ASN_ASNPKG_CURSOR                                  20270000
202800         END-EXEC.                                                20280000
202900                                                                  20290000
203000         EVALUATE TRUE                                            20300000
203100           WHEN SQLCODE = ZERO                                    20310000
203200           WHEN SQLCODE = +100                                    20320000
203300                 CONTINUE                                         20330000
203400           WHEN  OTHER                                            20340000
203500                 DISPLAY '**************************************' 20350000
203600                 DISPLAY 'ERROR ISSUED ON OPEN OF ASNPKG CURSOR'  20360000
203700                 DISPLAY '**************************************' 20370000
203800                 PERFORM Z900-SQL-ERROR                           20380000
203900                                                                  20390000
204000         END-EVALUATE.                                            20400000
204100                                                                  20410000
204200/                                                                 20420000
204300***************************************************************** 20430000
204400 X160-OPEN-ASHADR-CURSOR.                                         20440000
204500                                                                  20450000
204600     MOVE 'X160-OPEN-ASHADR-CURSOR           '                    20460000
204700                                 TO PW-CURRENT-PARA.              20470000
204800         EXEC SQL                                                 20480000
204900          OPEN ASN_ASHADR_CURSOR                                  20490000
205000         END-EXEC.                                                20500000
205100                                                                  20510000
205200         EVALUATE TRUE                                            20520000
205300           WHEN SQLCODE = ZERO                                    20530000
205400           WHEN SQLCODE = +100                                    20540000
205500                 CONTINUE                                         20550000
205600           WHEN  OTHER                                            20560000
205700                 DISPLAY '**************************************' 20570000
205800                 DISPLAY 'ERROR ISSUED ON OPEN OF ASHADR CURSOR'  20580000
205900                 DISPLAY '**************************************' 20590000
206000                 PERFORM Z900-SQL-ERROR                           20600000
206100                                                                  20610000
206200         END-EVALUATE.                                            20620000
206300                                                                  20630000
206400/                                                                 20640000
206500***************************************************************** 20650000
206600 X170-OPEN-ASOANM-CURSOR.                                         20660000
206700                                                                  20670000
206800     MOVE 'X170-OPEN-ASOANM-CURSOR           '                    20680000
206900                                 TO PW-CURRENT-PARA.              20690000
207000         EXEC SQL                                                 20700000
207100          OPEN ASN_ASOANM_CURSOR                                  20710000
207200         END-EXEC.                                                20720000
207300                                                                  20730000
207400         EVALUATE TRUE                                            20740000
207500           WHEN SQLCODE = ZERO                                    20750000
207600           WHEN SQLCODE = +100                                    20760000
207700                 CONTINUE                                         20770000
207800           WHEN  OTHER                                            20780000
207900                 DISPLAY '**************************************' 20790000
208000                 DISPLAY 'ERROR ISSUED ON OPEN OF ASOANM CURSOR'  20800000
208100                 DISPLAY '**************************************' 20810000
208200                 PERFORM Z900-SQL-ERROR                           20820000
208300                                                                  20830000
208400         END-EVALUATE.                                            20840000
208500                                                                  20850000
208600/                                                                 20860000
208700***************************************************************** 20870000
208800 X180-OPEN-ASDTPL-CURSOR.                                         20880000
208900                                                                  20890000
209000     MOVE 'X180-OPEN-ASDTPL-CURSOR           '                    20900000
209100                                 TO PW-CURRENT-PARA.              20910000
209200         EXEC SQL                                                 20920000
209300          OPEN ASN_ASDTPL_CURSOR                                  20930000
209400         END-EXEC.                                                20940000
209500                                                                  20950000
209600         EVALUATE TRUE                                            20960000
209700           WHEN SQLCODE = ZERO                                    20970000
209800           WHEN SQLCODE = +100                                    20980000
209900                 CONTINUE                                         20990000
210000           WHEN  OTHER                                            21000000
210100                 DISPLAY '**************************************' 21010000
210200                 DISPLAY 'ERROR ISSUED ON OPEN OF ASDTPL CURSOR'  21020000
210300                 DISPLAY '**************************************' 21030000
210400                 PERFORM Z900-SQL-ERROR                           21040000
210500                                                                  21050000
210600         END-EVALUATE.                                            21060000
210700                                                                  21070000
210800/                                                                 21080000
210900***************************************************************** 21090000
211000 X190-OPEN-ASCRIT-DTL-CURSOR.                                     21100000
211100                                                                  21110000
211200     MOVE 'X190-OPEN-ASCRIT-CURSOR           '                    21120000
211300                                 TO PW-CURRENT-PARA.              21130000
211400         EXEC SQL                                                 21140000
211500          OPEN ASN_ASCRIT_DTL                                     21150000
211600         END-EXEC.                                                21160000
211700                                                                  21170000
211800         EVALUATE TRUE                                            21180000
211900           WHEN SQLCODE = ZERO                                    21190000
212000           WHEN SQLCODE = +100                                    21200000
212100                 CONTINUE                                         21210000
212200           WHEN  OTHER                                            21220000
212300                 DISPLAY '**************************************' 21230000
212400             DISPLAY 'ERROR ISSUED ON OPEN OF ASCRIT DTL CURSOR'  21240000
212500                 DISPLAY '**************************************' 21250000
212600                 PERFORM Z900-SQL-ERROR                           21260000
212700                                                                  21270000
212800         END-EVALUATE.                                            21280000
212900                                                                  21290000
213000/                                                                 21300000
213100***************************************************************** 21310000
213200 X191-OPEN-ASCRIT-CAR-CURSOR.                                     21320000
213300                                                                  21330000
213400     MOVE 'X191-OPEN-ASCRIT-CAR-CURSOR       '                    21340000
213500                                 TO PW-CURRENT-PARA.              21350000
213600         EXEC SQL                                                 21360000
213700          OPEN ASN_ASCRIT_CAR                                     21370000
213800         END-EXEC.                                                21380000
213900                                                                  21390000
214000         EVALUATE TRUE                                            21400000
214100           WHEN SQLCODE = ZERO                                    21410000
214200           WHEN SQLCODE = +100                                    21420000
214300                 CONTINUE                                         21430000
214400           WHEN  OTHER                                            21440000
214500                 DISPLAY '**************************************' 21450000
214600              DISPLAY 'ERROR ISSUED ON OPEN OF ASCRIT CAR CURSOR' 21460000
214700                 DISPLAY '**************************************' 21470000
214800                 PERFORM Z900-SQL-ERROR                           21480000
214900                                                                  21490000
215000         END-EVALUATE.                                            21500000
215100                                                                  21510000
215200/                                                                 21520000
215300***************************************************************** 21530000
215400 X195-OPEN-ASHADT-CURSOR.                                         21540000
215500                                                                  21550000
215600     MOVE 'X195-OPEN-ASHADT-CURSOR           '                    21560000
215700                                 TO PW-CURRENT-PARA.              21570000
215800         EXEC SQL                                                 21580000
215900          OPEN ASN_ASHADT_CURSOR                                  21590000
216000         END-EXEC.                                                21600000
216100                                                                  21610000
216200         EVALUATE TRUE                                            21620000
216300           WHEN SQLCODE = ZERO                                    21630000
216400           WHEN SQLCODE = +100                                    21640000
216500                 CONTINUE                                         21650000
216600           WHEN  OTHER                                            21660000
216700                 DISPLAY '**************************************' 21670000
216800                 DISPLAY 'ERROR ISSUED ON OPEN OF ASHADT CURSOR'  21680000
216900                 DISPLAY '**************************************' 21690000
217000                 PERFORM Z900-SQL-ERROR                           21700000
217100                                                                  21710000
217200         END-EVALUATE.                                            21720000
217300                                                                  21730000
217400/                                                                 21740000
217500***************************************************************** 21750000
217600 X198-OPEN-ASHANM-CURSOR.                                         21760000
217700                                                                  21770000
217800     MOVE 'X198-OPEN-ASHANM-CURSOR           '                    21780000
217900                                 TO PW-CURRENT-PARA.              21790000
218000         EXEC SQL                                                 21800000
218100          OPEN ASN_ASHANM_CURSOR                                  21810000
218200         END-EXEC.                                                21820000
218300                                                                  21830000
218400         EVALUATE TRUE                                            21840000
218500           WHEN SQLCODE = ZERO                                    21850000
218600           WHEN SQLCODE = +100                                    21860000
218700                 CONTINUE                                         21870000
218800           WHEN  OTHER                                            21880000
218900                 DISPLAY '**************************************' 21890000
219000                 DISPLAY 'ERROR ISSUED ON OPEN OF ASHANM CURSOR'  21900000
219100                 DISPLAY '**************************************' 21910000
219200                 PERFORM Z900-SQL-ERROR                           21920000
219300                                                                  21930000
219400         END-EVALUATE.                                            21940000
219500                                                                  21950000
219600/                                                                 21960000
219700***************************************************************** 21970000
219800*     SQL CLOSE CURSOR ON TASNORD                               * 21980000
219900*                                                               * 21990000
220000***************************************************************** 22000000
220100 X300-CLOSE-ASNORD-CURSOR.                                        22010000
220200                                                                  22020000
220300     MOVE 'X300-CLOSE-ASOADT-CURSOR          '                    22030000
220400                                 TO PW-CURRENT-PARA.              22040000
220500         EXEC SQL                                                 22050000
220600          CLOSE ASN_ASNORD_CURSOR                                 22060000
220700         END-EXEC.                                                22070000
220800                                                                  22080000
220900         EVALUATE TRUE                                            22090000
221000           WHEN SQLCODE = ZERO                                    22100000
221100           WHEN SQLCODE = +100                                    22110000
221200                 CONTINUE                                         22120000
221300           WHEN  OTHER                                            22130000
221400               DISPLAY '**************************************'   22140000
221500               DISPLAY 'ERROR ISSUED ON CLOSE OF ASOADT CURSOR'   22150000
221600               DISPLAY '**************************************'   22160000
221700                 PERFORM Z900-SQL-ERROR                           22170000
221800                                                                  22180000
221900         END-EVALUATE.                                            22190000
222000                                                                  22200000
222100/                                                                 22210000
222200***************************************************************** 22220000
222300 X310-CLOSE-ASOADR-CURSOR.                                        22230000
222400                                                                  22240000
222500     MOVE 'X310-CLOSE-ASOADR-CURSOR          '                    22250000
222600                                 TO PW-CURRENT-PARA.              22260000
222700         EXEC SQL                                                 22270000
222800          CLOSE ASN_ASOADR_CURSOR                                 22280000
222900         END-EXEC.                                                22290000
223000                                                                  22300000
223100         EVALUATE TRUE                                            22310000
223200           WHEN SQLCODE = ZERO                                    22320000
223300           WHEN SQLCODE = +100                                    22330000
223400                 CONTINUE                                         22340000
223500           WHEN  OTHER                                            22350000
223600               DISPLAY '**************************************'   22360000
223700               DISPLAY 'ERROR ISSUED ON CLOSE OF ASOADR CURSOR'   22370000
223800               DISPLAY '**************************************'   22380000
223900                 PERFORM Z900-SQL-ERROR                           22390000
224000                                                                  22400000
224100         END-EVALUATE.                                            22410000
224200                                                                  22420000
224300/                                                                 22430000
224400***************************************************************** 22440000
224500 X320-CLOSE-ASOADT-CURSOR.                                        22450000
224600                                                                  22460000
224700     MOVE 'X320-CLOSE-ASOADT-CURSOR          '                    22470000
224800                                 TO PW-CURRENT-PARA.              22480000
224900         EXEC SQL                                                 22490000
225000          CLOSE ASN_ASOADT_CURSOR                                 22500000
225100         END-EXEC.                                                22510000
225200                                                                  22520000
225300         EVALUATE TRUE                                            22530000
225400           WHEN SQLCODE = ZERO                                    22540000
225500           WHEN SQLCODE = +100                                    22550000
225600                 CONTINUE                                         22560000
225700           WHEN  OTHER                                            22570000
225800               DISPLAY '**************************************'   22580000
225900               DISPLAY 'ERROR ISSUED ON CLOSE OF ASOADT CURSOR'   22590000
226000               DISPLAY '**************************************'   22600000
226100                 PERFORM Z900-SQL-ERROR                           22610000
226200                                                                  22620000
226300         END-EVALUATE.                                            22630000
226400                                                                  22640000
226500/                                                                 22650000
226600***************************************************************** 22660000
226700 X330-CLOSE-ASNDTL-CURSOR.                                        22670000
226800                                                                  22680000
226900     MOVE 'X330-CLOSE-ASNDTL-CURSOR          '                    22690000
227000                                 TO PW-CURRENT-PARA.              22700000
227100         EXEC SQL                                                 22710000
227200          CLOSE ASN_ASNDTL_CURSOR                                 22720000
227300         END-EXEC.                                                22730000
227400                                                                  22740000
227500         EVALUATE TRUE                                            22750000
227600           WHEN SQLCODE = ZERO                                    22760000
227700           WHEN SQLCODE = +100                                    22770000
227800                 CONTINUE                                         22780000
227900           WHEN  OTHER                                            22790000
228000               DISPLAY '**************************************'   22800000
228100               DISPLAY 'ERROR ISSUED ON CLOSE OF ASNDTL CURSOR'   22810000
228200               DISPLAY '**************************************'   22820000
228300                 PERFORM Z900-SQL-ERROR                           22830000
228400                                                                  22840000
228500         END-EVALUATE.                                            22850000
228600                                                                  22860000
228700/                                                                 22870000
228800***************************************************************** 22880000
228900 X340-CLOSE-ASNCAR-CURSOR.                                        22890000
229000                                                                  22900000
229100     MOVE 'X340-CLOSE-ASNCAR-CURSOR          '                    22910000
229200                                 TO PW-CURRENT-PARA.              22920000
229300         EXEC SQL                                                 22930000
229400          CLOSE ASN_ASNCAR_CURSOR                                 22940000
229500         END-EXEC.                                                22950000
229600                                                                  22960000
229700         EVALUATE TRUE                                            22970000
229800           WHEN SQLCODE = ZERO                                    22980000
229900           WHEN SQLCODE = +100                                    22990000
230000                 CONTINUE                                         23000000
230100           WHEN  OTHER                                            23010000
230200               DISPLAY '**************************************'   23020000
230300               DISPLAY 'ERROR ISSUED ON CLOSE OF ASNCAR CURSOR'   23030000
230400               DISPLAY '**************************************'   23040000
230500                 PERFORM Z900-SQL-ERROR                           23050000
230600                                                                  23060000
230700         END-EVALUATE.                                            23070000
230800                                                                  23080000
230900/                                                                 23090000
231000***************************************************************** 23100000
231100 X350-CLOSE-ASNPKG-CURSOR.                                        23110000
231200                                                                  23120000
231300     MOVE 'X350-CLOSE-ASNPKG-CURSOR          '                    23130000
231400                                 TO PW-CURRENT-PARA.              23140000
231500         EXEC SQL                                                 23150000
231600          CLOSE ASN_ASNPKG_CURSOR                                 23160000
231700         END-EXEC.                                                23170000
231800                                                                  23180000
231900         EVALUATE TRUE                                            23190000
232000           WHEN SQLCODE = ZERO                                    23200000
232100           WHEN SQLCODE = +100                                    23210000
232200                 CONTINUE                                         23220000
232300           WHEN  OTHER                                            23230000
232400               DISPLAY '**************************************'   23240000
232500               DISPLAY 'ERROR ISSUED ON CLOSE OF ASNPKG CURSOR'   23250000
232600               DISPLAY '**************************************'   23260000
232700                 PERFORM Z900-SQL-ERROR                           23270000
232800                                                                  23280000
232900         END-EVALUATE.                                            23290000
233000                                                                  23300000
233100/                                                                 23310000
233200***************************************************************** 23320000
233300 X360-CLOSE-ASHADR-CURSOR.                                        23330000
233400                                                                  23340000
233500     MOVE 'X360-CLOSE-ASHADR-CURSOR          '                    23350000
233600                                 TO PW-CURRENT-PARA.              23360000
233700         EXEC SQL                                                 23370000
233800          CLOSE ASN_ASHADR_CURSOR                                 23380000
233900         END-EXEC.                                                23390000
234000                                                                  23400000
234100         EVALUATE TRUE                                            23410000
234200           WHEN SQLCODE = ZERO                                    23420000
234300           WHEN SQLCODE = +100                                    23430000
234400                 CONTINUE                                         23440000
234500           WHEN  OTHER                                            23450000
234600               DISPLAY '**************************************'   23460000
234700               DISPLAY 'ERROR ISSUED ON CLOSE OF ASHADR CURSOR'   23470000
234800               DISPLAY '**************************************'   23480000
234900                 PERFORM Z900-SQL-ERROR                           23490000
235000                                                                  23500000
235100         END-EVALUATE.                                            23510000
235200                                                                  23520000
235300/                                                                 23530000
235400***************************************************************** 23540000
235500 X370-CLOSE-ASOANM-CURSOR.                                        23550000
235600                                                                  23560000
235700     MOVE 'X370-CLOSE-ASOANM-CURSOR          '                    23570000
235800                                 TO PW-CURRENT-PARA.              23580000
235900         EXEC SQL                                                 23590000
236000          CLOSE ASN_ASOANM_CURSOR                                 23600000
236100         END-EXEC.                                                23610000
236200                                                                  23620000
236300         EVALUATE TRUE                                            23630000
236400           WHEN SQLCODE = ZERO                                    23640000
236500           WHEN SQLCODE = +100                                    23650000
236600                 CONTINUE                                         23660000
236700           WHEN  OTHER                                            23670000
236800               DISPLAY '**************************************'   23680000
236900               DISPLAY 'ERROR ISSUED ON CLOSE OF ASOANM CURSOR'   23690000
237000               DISPLAY '**************************************'   23700000
237100                 PERFORM Z900-SQL-ERROR                           23710000
237200                                                                  23720000
237300         END-EVALUATE.                                            23730000
237400                                                                  23740000
237500/                                                                 23750000
237600***************************************************************** 23760000
237700 X380-CLOSE-ASDTPL-CURSOR.                                        23770000
237800                                                                  23780000
237900     MOVE 'X380-CLOSE-ASDTPL-CURSOR          '                    23790000
238000                                 TO PW-CURRENT-PARA.              23800000
238100         EXEC SQL                                                 23810000
238200          CLOSE ASN_ASDTPL_CURSOR                                 23820000
238300         END-EXEC.                                                23830000
238400                                                                  23840000
238500         EVALUATE TRUE                                            23850000
238600           WHEN SQLCODE = ZERO                                    23860000
238700           WHEN SQLCODE = +100                                    23870000
238800                 CONTINUE                                         23880000
238900           WHEN  OTHER                                            23890000
239000               DISPLAY '**************************************'   23900000
239100               DISPLAY 'ERROR ISSUED ON CLOSE OF ASDTPL CURSOR'   23910000
239200               DISPLAY '**************************************'   23920000
239300                 PERFORM Z900-SQL-ERROR                           23930000
239400                                                                  23940000
239500         END-EVALUATE.                                            23950000
239600                                                                  23960000
239700/                                                                 23970000
239800***************************************************************** 23980000
239900 X390-CLOSE-ASCRIT-DTL-CURSOR.                                    23990000
240000                                                                  24000000
240100     MOVE 'X390-CLOSE-ASCRIT-DTL-CURSOR      '                    24010000
240200                                 TO PW-CURRENT-PARA.              24020000
240300         EXEC SQL                                                 24030000
240400          CLOSE ASN_ASCRIT_DTL                                    24040000
240500         END-EXEC.                                                24050000
240600                                                                  24060000
240700         EVALUATE TRUE                                            24070000
240800           WHEN SQLCODE = ZERO                                    24080000
240900           WHEN SQLCODE = +100                                    24090000
241000                 CONTINUE                                         24100000
241100           WHEN  OTHER                                            24110000
241200               DISPLAY '**************************************'   24120000
241300           DISPLAY 'ERROR ISSUED ON CLOSE OF ASCRIT DTL CURSOR'   24130000
241400               DISPLAY '**************************************'   24140000
241500                 PERFORM Z900-SQL-ERROR                           24150000
241600                                                                  24160000
241700         END-EVALUATE.                                            24170000
241800                                                                  24180000
241900/                                                                 24190000
242000***************************************************************** 24200000
242100 X391-CLOSE-ASCRIT-CAR-CURSOR.                                    24210000
242200                                                                  24220000
242300     MOVE 'X391-CLOSE-ASCRIT-CAR-CURSOR      '                    24230000
242400                                 TO PW-CURRENT-PARA.              24240000
242500         EXEC SQL                                                 24250000
242600          CLOSE ASN_ASCRIT_CAR                                    24260000
242700         END-EXEC.                                                24270000
242800                                                                  24280000
242900         EVALUATE TRUE                                            24290000
243000           WHEN SQLCODE = ZERO                                    24300000
243100           WHEN SQLCODE = +100                                    24310000
243200                 CONTINUE                                         24320000
243300           WHEN  OTHER                                            24330000
243400               DISPLAY '**************************************'   24340000
243500           DISPLAY 'ERROR ISSUED ON CLOSE OF ASCRIT CAR CURSOR'   24350000
243600               DISPLAY '**************************************'   24360000
243700                 PERFORM Z900-SQL-ERROR                           24370000
243800                                                                  24380000
243900         END-EVALUATE.                                            24390000
244000                                                                  24400000
244100/                                                                 24410000
244200***************************************************************** 24420000
244300 X395-CLOSE-ASHADT-CURSOR.                                        24430000
244400                                                                  24440000
244500     MOVE 'X395-CLOSE-ASHADT-CURSOR          '                    24450000
244600                                 TO PW-CURRENT-PARA.              24460000
244700         EXEC SQL                                                 24470000
244800          CLOSE ASN_ASHADT_CURSOR                                 24480000
244900         END-EXEC.                                                24490000
245000                                                                  24500000
245100         EVALUATE TRUE                                            24510000
245200           WHEN SQLCODE = ZERO                                    24520000
245300           WHEN SQLCODE = +100                                    24530000
245400                 CONTINUE                                         24540000
245500           WHEN  OTHER                                            24550000
245600               DISPLAY '**************************************'   24560000
245700               DISPLAY 'ERROR ISSUED ON CLOSE OF ASHADT CURSOR'   24570000
245800               DISPLAY '**************************************'   24580000
245900                 PERFORM Z900-SQL-ERROR                           24590000
246000                                                                  24600000
246100         END-EVALUATE.                                            24610000
246200                                                                  24620000
246300/                                                                 24630000
246400***************************************************************** 24640000
246500 X398-CLOSE-ASHANM-CURSOR.                                        24650000
246600                                                                  24660000
246700     MOVE 'X398-CLOSE-ASHANM-CURSOR          '                    24670000
246800                                 TO PW-CURRENT-PARA.              24680000
246900         EXEC SQL                                                 24690000
247000          CLOSE ASN_ASHANM_CURSOR                                 24700000
247100         END-EXEC.                                                24710000
247200                                                                  24720000
247300         EVALUATE TRUE                                            24730000
247400           WHEN SQLCODE = ZERO                                    24740000
247500           WHEN SQLCODE = +100                                    24750000
247600                 CONTINUE                                         24760000
247700           WHEN  OTHER                                            24770000
247800               DISPLAY '**************************************'   24780000
247900               DISPLAY 'ERROR ISSUED ON CLOSE OF ASHANM CURSOR'   24790000
248000               DISPLAY '**************************************'   24800000
248100                 PERFORM Z900-SQL-ERROR                           24810000
248200                                                                  24820000
248300         END-EVALUATE.                                            24830000
248400                                                                  24840000
248500/                                                                 24850000
248600***************************************************************** 24860000
248700* MOVE DATA TO PRINT RECORD                                     * 24870000
248800***************************************************************** 24880000
248900 Z100-MOVE-DATA.                                                  24890000
249000                                                                  24900000
249100*     MOVE PW-ASOADR-OPERCO-NBR  TO PO-ASOADR-OPERCO-NBR.         24910000
249200*     MOVE PW-ASOADR-EDI-VEND-ID TO PO-ASOADR-EDI-VEND-ID.        24920000
249300*     MOVE PW-ASOADR-ASNHDR-NBR  TO PO-ASOADR-ASNHDR-NBR.         24930000
249400      MOVE PW-ASOADR-ASNHDR-ID   TO PO-ASOADR-ASNHDR-ID.          24940000
249500      MOVE PW-ASOADR-PO-NBR      TO PO-ASOADR-PO-NBR.             24950000
249700      MOVE PW-ASOADR-NAME-CDE    TO PO-ASOADR-NAME-CDE.           24970000
249800      MOVE PW-ASOADR-ASOADT-NBR  TO PO-ASOADR-ASOADT-NBR.         24980000
249900      MOVE PW-ASOADR-ASOANM-NBR  TO PO-ASOADR-ASOANM-NBR.         24990000
250000      MOVE PW-ASOADR-SELR-INV-NBR TO PO-ASOADR-SELR-INV-NBR.      25000000
250100*                                                                 25010000
250200****************************************************************  25020000
250300*     WRITE-REPORT-LINE                                        *  25030000
250400*                                                              *  25040000
250500*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  25050000
250600****************************************************************  25060000
250700 Z500-WRITE-REPORT-LINE.                                          25070000
250800     MOVE 'Z500-WRITE-REPORT-LINE         '                       25080000
250900                                 TO PW-CURRENT-PARA.              25090000
251000*    DISPLAY 'Z500-WRITE-REPORT-LINE'.                            25100000
251100                                                                  25110000
251200     ADD 1                       TO PA-LINE-CNT.                  25120000
251300                                                                  25130000
251400     IF PA-LINE-CNT > PC-POS-54                                   25140000
251500         PERFORM Z600-PROCESS-HEADING-LINES                       25150000
251600     END-IF.                                                      25160000
251700                                                                  25170000
251800     WRITE ADV-SHIP-NOTICE-LINE                                   25180000
251900       FROM PW-ADV-SHIP-NOTICE-LINE                               25190000
252000       AFTER ADVANCING 1 LINE.                                    25200000
252100/                                                                 25210000
252200****************************************************************  25220000
252300*     WRITE-REPORT-LINE                                        *  25230000
252400*                                                              *  25240000
252500*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  25250000
252600****************************************************************  25260000
252700 Z510-WRITE-REPORT-LINE.                                          25270000
252800     MOVE 'Z510-WRITE-REPORT-LINE         '                       25280000
252900                                 TO PW-CURRENT-PARA.              25290000
253000*    DISPLAY 'Z510-WRITE-REPORT-LINE'.                            25300000
253100                                                                  25310000
253200     ADD 2                       TO PA-LINE-CNT.                  25320000
253300                                                                  25330000
253400     IF PA-LINE-CNT > PC-POS-54                                   25340000
253500         PERFORM Z600-PROCESS-HEADING-LINES                       25350000
253600     END-IF.                                                      25360000
253700                                                                  25370000
253800     WRITE ADV-SHIP-NOTICE-LINE                                   25380000
253900       FROM PW-ADV-SHIP-NOTICE-LINE                               25390000
254000       AFTER ADVANCING 2 LINE.                                    25400000
254100/                                                                 25410000
254200****************************************************************  25420000
254300*     PROCESS-HEADING-LINES                                    *  25430000
254400*                                                              *  25440000
254500*     -  CONTROL THE LOADING AND PRINTING OF THE HEADING LINES *  25450000
254600****************************************************************  25460000
254700 Z600-PROCESS-HEADING-LINES.                                      25470000
254800     MOVE 'Z600-PROCESS-HEADING-LINES     '                       25480000
254900                                 TO PW-CURRENT-PARA.              25490000
255000*    DISPLAY 'Z600-PROCESS-HEADING-LINES'.                        25500000
255100                                                                  25510000
255200     MOVE 'SNKRP333'             TO DP132O-PROGRAM-NAME.          25520000
255300     MOVE 1                      TO DP132O-REPORT-NUMBER.         25530000
255400                                                                  25540000
255500     ADD 1                       TO PA-PAGE-CNT.                  25550000
255600     MOVE PA-PAGE-CNT            TO DP132O-PAGE-NUMBER.           25560000
255700                                                                  25570000
255800     WRITE ADV-SHIP-NOTICE-LINE                                   25580000
255900        FROM DP132O-STANDRD-HEADER-132-COLS                       25590000
256000        AFTER ADVANCING PAGE.                                     25600000
256100                                                                  25610000
256200     WRITE ADV-SHIP-NOTICE-LINE                                   25620000
256300         FROM H2-HEADING-LINE2                                    25630000
256400         AFTER ADVANCING 1 LINE.                                  25640000
256500                                                                  25650000
256600     WRITE ADV-SHIP-NOTICE-LINE                                   25660000
256700         FROM H3-HEADING-LINE3                                    25670000
256800         AFTER ADVANCING 2 LINE.                                  25680000
256900                                                                  25690000
257000     MOVE 1                      TO PA-LINE-CNT.                  25700000
257100/                                                                 25710000
257200 Z800-SQL-WARNING.                                                25720000
257300******************************************************************25730000
257400*  THIS MODULE PERFORMS THE SQL WARNING.                         *25740000
257500******************************************************************25750000
257600      MOVE SQLCODE               TO SQLCODE2.                     25760000
257700      MOVE SQLERRD(3)            TO SQLERRD3.                     25770000
257800      DISPLAY '** ABEND **       ** = SQLWARNING'.                25780000
257900      DISPLAY '** PROGRAM        ** = SNKUT333'.                  25790000
258000      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 25800000
258100      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 25810000
258200      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 25820000
258300      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 25830000
258400      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 25840000
258500      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 25850000
258600      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 25860000
258700      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 25870000
258800      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 25880000
258900      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 25890000
259000                                                                  25900000
259100      EXEC SQL                                                    25910000
259200          ROLLBACK                                                25920000
259300      END-EXEC.                                                   25930000
259400                                                                  25940000
259500      SET ABEND-4013-DB2-ERROR   TO TRUE                          25950000
259600      CALL 'ILBOABN0' USING ABEND-CODE.                           25960000
259700/                                                                 25970000
259800 Z900-SQL-ERROR.                                                  25980000
259900******************************************************************25990000
260000* THIS MODULE PERFORMS THE SQL ERROR.                            *26000000
260100******************************************************************26010000
260200      MOVE SQLCODE               TO SQLCODE2.                     26020000
260300      MOVE SQLERRD(3)            TO SQLERRD3.                     26030000
260400      DISPLAY '** ABEND **       ** = SQLERROR'.                  26040000
260500      DISPLAY '** PROGRAM        ** = SNKUT333'.                  26050000
260600      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 26060000
260700      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 26070000
260800      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  26080000
260900      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 26090000
261000                                                                  26100000
261100      EXEC SQL                                                    26110000
261200          ROLLBACK                                                26120000
261300      END-EXEC.                                                   26130000
261400                                                                  26140000
261500      SET ABEND-4013-DB2-ERROR   TO TRUE                          26150000
261600      CALL 'ILBOABN0' USING ABEND-CODE.                           26160000
261700*                                                                 26170000
