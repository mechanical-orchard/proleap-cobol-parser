       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.           DAKRP111.                                  00030000
       AUTHOR.               JILL LIN.                                  00040000
       INSTALLATION.         KOHLS DEPARTMENT STORES.                   00050000
       DATE-WRITTEN.         MAY 2006.                                  00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ***************************************************************** 00090000
      *  PROGRAM NARRATIVE:                                           * 00100000
      *  THIS PROGRAM READS AN EXTRACT CREATED FROM DAKUT313 AND      * 00110000
      *  CREATES A REPORT OF DEBIT ALLOWANCE AVAILABLE VENDOR FUNDING * 00120000
      *  REMAINING AVAILABLE COST DOLLAR BALANCES FOR CURRENT AND     * 00120100
      *  PREVIOUS FISCAL QUARTER. THIS PROGRAM RUNS DAILY.            * 00121000
      ***************************************************************** 00140000
      *                                                               * 00160000
      *    WR/PITS#     DATE        DESCRIPTION                       * 00310000
      *    --------   ----------   ---------------------------------  * 00320000
      ***************************************************************** 00400000
      *                                                                 00410000
       ENVIRONMENT DIVISION.                                            00430000
                                                                        00440000
       CONFIGURATION SECTION.                                           00450000
                                                                        00460000
       SOURCE-COMPUTER.                        IBM-3090.                00470000
       OBJECT-COMPUTER.                        IBM-3090.                00480000
                                                                        00490000
       INPUT-OUTPUT SECTION.                                            00500000
                                                                        00510000
       FILE-CONTROL.                                                    00520000
                                                                        00530000
           SELECT  INPUT-FILE                ASSIGN TO INP01.           00540000
           SELECT  REPORT-FILE               ASSIGN TO RPT01.           00580000
                                                                        00590000
      ******************************************************************00600000
       DATA DIVISION.                                                   00610000
      ******************************************************************00620000
                                                                        00630000
       FILE SECTION.                                                    00640000
      *                                                                 00650000
       FD  INPUT-FILE                                                   00660000
           LABEL RECORDS ARE STANDARD                                   00670000
           RECORDING MODE IS F                                          00680000
           BLOCK CONTAINS 0 RECORDS.                                    00690000
       01  INPUT-FILE-REC             PIC X(165).                       00710019
                                                                        00720000
       FD  REPORT-FILE                                                  00930000
           RECORDING MODE F                                             00940000
           LABEL RECORDS OMITTED                                        00950000
           BLOCK CONTAINS  0 RECORDS.                                   00960000
       01  REPORT-RECORD.                                               00970000
           05  REPORT-LINE            PIC X(132).                       00980002
      *                                                                 00990000
       WORKING-STORAGE SECTION.                                         01000000
                                                                        01010000
       01  PA-PROGRAM-ACCUMULATORS.                                     01050000
           05  PA-LINE-NO             PIC S9(03)    COMP-3 VALUE ZEROES.01070008
           05  PA-PAGE-COUNT          PIC S9(05)    COMP-3 VALUE ZEROES.01080008
           05  PA-TOTAL-READ          PIC S9(09)    COMP-3 VALUE ZEROES.01100008
           05  PA-TTL-OFF-BALANCE     PIC S9(11)V99 COMP-3 VALUE ZEROES.01210008
           05  PA-TTL-CRRNT-VND-FUND  PIC S9(11)V99 COMP-3 VALUE ZEROES.01211008
           05  PA-TTL-PREV-VND-FUND   PIC S9(11)V99 COMP-3 VALUE ZEROES.01212008
           05  PA-GTL-OFF-BALANCE     PIC S9(11)V99 COMP-3 VALUE ZEROES.01213038
           05  PA-GTL-CRRNT-VND-FUND  PIC S9(11)V99 COMP-3 VALUE ZEROES.01213138
           05  PA-GTL-PREV-VND-FUND   PIC S9(11)V99 COMP-3 VALUE ZEROES.01214038
                                                                        01220000
       01  PC-CONSTANTS.                                                01230000
           05  PC-DAKRP111-PGM            PIC  X(08)   VALUE 'DAKRP111'.01270008
           05  PC-MAX-LINES               PIC S9(03)   VALUE 62.        01310037
           05  PC-DASH                    PIC  X(01)   VALUE '-'.       01316008
                                                                        01320000
       01  PM-PROGRAM-MESSAGES.                                         01330000
           05  PM-NO-INPUT-MSG.                                         01400008
               10 FILLER                  PIC  X(55)    VALUE SPACES.   01401008
               10 FILLER                  PIC  X(22)    VALUE           01402008
               '=====> NO INPUT <====='.                                01410008
               10 FILLER                  PIC  X(55)    VALUE SPACES.   01412008
           05  PM-END-RPT-MSG.                                          01420008
               10 FILLER                  PIC  X(52)    VALUE SPACES.   01421008
               10 FILLER                  PIC  X(27)    VALUE           01422008
               '* * *  END OF REPORT  * * *'.                           01430008
               10 FILLER                  PIC  X(53)    VALUE SPACES.   01431008
                                                                        01440000
       01  PS-SWITCHES.                                                 01450000
           05  PS-EOF-EXTRACT-SWITCH      PIC  X(01)    VALUE 'N'.      01460008
               88  PS-EOF-EXTRACT                       VALUE 'Y'.      01470008
           05  PS-FST-REC-SWITCH          PIC  X(01)    VALUE 'N'.      01471014
               88  PS-FST-REC-PROCESSED                 VALUE 'Y'.      01472014
                                                                        01480000
       01  PV-VARIABLES.                                                01490000
           05  PV-DISP-NUMBER             PIC Z,ZZZ,ZZ9.                01500008
           05  PV-HOLD-GMM                PIC X(02)     VALUE SPACES.   01731008
           05  PV-HOLD-DMM                PIC X(02)     VALUE SPACES.   01732008
           05  PV-HOLD-VND-NAME           PIC X(30)     VALUE SPACES.   01732136
           05  PV-HOLD-BUYER              PIC X(03)     VALUE SPACES.   01733008
           05  PV-HOLD-DEPT-NBR           PIC X(03)     VALUE SPACES.   01736009
           05  PV-TODAYS-DATE-FORMATTED.                                01737028
               10 PV-YEAR                 PIC 99        VALUE ZEROES.   01739033
               10 PV-MONTH                PIC 99        VALUE ZEROES.   01739233
               10 PV-DAY                  PIC 99        VALUE ZEROES.   01739433
       01  PV-ABEND-CODE     COMP  SYNC   PIC S9(04)    VALUE +0000.    01739546
           88  ABEND-4001-SEQUENCE-ERROR                VALUE +4001.    01739646
      ***************************************************************** 01741000
      *  KOHL'S STANDARD FIRST HEADING LINE                             01750000
      ***************************************************************** 01760000
           COPY DPWS132O.                                               01770000
                                                                        01780000
       01  H2-HEADING2.                                                 01790000
           05  FILLER                     PIC X(45) VALUE SPACES.       01800008
           05  H2-HEADING-TITLE           PIC X(42) VALUE               01810008
           'PROFIT ASSISTANCE/AD COOP FUNDING BY BUYER'.                01831004
           05  FILLER                     PIC X(45) VALUE SPACES.       01891008
                                                                        01900000
       01  H3-HEADING3.                                                 01901004
           05  FILLER                     PIC X(52) VALUE SPACES.       01902008
           05  H3-HEADING-TITLE           PIC X(29) VALUE               01903008
           'AGING OF OUTSTANDING BALANCES'.                             01904004
           05  FILLER                     PIC X(51) VALUE SPACES.       01905008
                                                                        01906004
       01  H4-HEADING4.                                                 01907004
           05  FILLER                     PIC X(02) VALUE SPACES.       01908008
           05  FILLER                     PIC X(07) VALUE 'GMM:   '.    01908136
           05  FILLER                     PIC 9(01) VALUE ZEROES.       01908336
           05  H4-GMM-NUMBER              PIC 9(02) VALUE ZEROES.       01908436
           05  FILLER                     PIC X(01) VALUE SPACE.        01908536
           05  H4-GMM-NAME                PIC X(31) VALUE SPACES.       01909042
           05  FILLER                     PIC X(88) VALUE SPACES.       01909336
       01  HH4-HOLD-HEADING4              PIC X(132) VALUE SPACES.      01909414
                                                                        01909504
       01  H5-HEADING5.                                                 01909804
           05  FILLER                     PIC X(02) VALUE SPACES.       01909908
           05  FILLER                     PIC X(07) VALUE 'DMM:   '.    01910036
           05  FILLER                     PIC 9(01) VALUE ZEROES.       01910236
           05  H5-DMM-NUMBER              PIC 9(02) VALUE ZEROES.       01910336
           05  FILLER                     PIC X(01) VALUE SPACE.        01910436
           05  H5-DMM-NAME                PIC X(31) VALUE SPACES.       01910542
           05  FILLER                     PIC X(88) VALUE SPACES.       01910836
       01  HH5-HOLD-HEADING5              PIC X(132) VALUE SPACES.      01910936
                                                                        01911036
       01  H6-HEADING6.                                                 01911204
           05  FILLER                     PIC X(02) VALUE SPACES.       01911308
           05  FILLER                     PIC X(07) VALUE 'BUYER: '.    01911408
           05  H6-BYR-NUMBER              PIC 9(03) VALUE ZEROES.       01911621
           05  FILLER                     PIC X(01) VALUE SPACE.        01911721
           05  H6-BYR-NAME                PIC X(31) VALUE SPACES.       01911842
           05  FILLER                     PIC X(88) VALUE SPACES.       01912136
       01  HH6-HOLD-HEADING6              PIC X(132) VALUE SPACES.      01912221
                                                                        01912321
       01  DH1-DETAIL-HEADING1.                                         01913005
           05  FILLER                     PIC X(58) VALUE SPACES.       01980008
           05  FILLER                     PIC X(17) VALUE 'OFF INVOICE'.01990041
           05  FILLER                     PIC X(04) VALUE SPACES.       02000008
           05  FILLER                     PIC X(17) VALUE 'CURRENT'.    02010041
           05  FILLER                     PIC X(04) VALUE SPACES.       02020008
           05  FILLER                     PIC X(17) VALUE 'PREVIOUS'.   02030041
           05  FILLER                     PIC X(05) VALUE SPACES.       02040041
                                                                        02050000
       01  DH2-DETAIL-HEADING2.                                         02060005
           05  FILLER                     PIC X(02) VALUE SPACES.       02070008
           05  FILLER                     PIC X(30) VALUE 'VENDOR'.     02080008
           05  FILLER                     PIC X(04) VALUE SPACES.       02090008
           05  FILLER                     PIC X(10) VALUE 'VENDOR #'.   02100008
           05  FILLER                     PIC X(04) VALUE SPACES.       02110008
           05  FILLER                     PIC X(04) VALUE 'DEPT'.       02120008
           05  FILLER                     PIC X(04) VALUE SPACES.       02130008
           05  FILLER                     PIC X(17) VALUE 'BALANCE'.    02140041
           05  FILLER                     PIC X(04) VALUE SPACES.       02141008
           05  FILLER                     PIC X(17) VALUE 'QTR'.        02142041
           05  FILLER                     PIC X(04) VALUE SPACES.       02143008
           05  FILLER                     PIC X(17) VALUE 'QTRS'.       02144041
           05  FILLER                     PIC X(05) VALUE SPACES.       02145041
                                                                        02146005
       01  DH3-DETAIL-HEADING3.                                         02146109
           05  FILLER                     PIC X(02) VALUE SPACES.       02146209
           05  FILLER                     PIC X(30) VALUE               02146320
               '------------------------------'.                        02146420
           05  FILLER                     PIC X(04) VALUE SPACES.       02146620
           05  FILLER                     PIC X(10) VALUE '----------'. 02146720
           05  FILLER                     PIC X(04) VALUE SPACES.       02146820
           05  FILLER                     PIC X(04) VALUE '----'.       02146920
           05  FILLER                     PIC X(04) VALUE SPACES.       02147020
           05  FILLER                     PIC X(17) VALUE               02147141
               '-----------------'.                                     02147241
           05  FILLER                     PIC X(04) VALUE SPACES.       02147420
           05  FILLER                     PIC X(17) VALUE               02147541
               '-----------------'.                                     02147641
           05  FILLER                     PIC X(04) VALUE SPACES.       02147720
           05  FILLER                     PIC X(17) VALUE               02147841
               '-----------------'.                                     02147941
           05  FILLER                     PIC X(05) VALUE SPACES.       02148041
                                                                        02148120
       01  DL1-DETAIL-LINE1.                                            02148220
           05  FILLER                     PIC X(02) VALUE SPACES.       02148308
           05  DL1-VENDOR-NAME            PIC X(30) VALUE SPACES.       02149008
           05  FILLER                     PIC X(04) VALUE SPACES.       02149108
           05  DL1-VENDOR-NUMBER          PIC X(10) VALUE ZEROES.       02149216
           05  FILLER                     PIC X(05) VALUE SPACES.       02149321
           05  DL1-DEPT-NUMBER            PIC 9(03) VALUE ZEROES.       02149421
           05  FILLER                     PIC X(04) VALUE SPACES.       02149508
           05  DL1-OFF-INVOICE-BAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99.        02149641
           05  FILLER                     PIC X(04) VALUE SPACES.       02149808
           05  DL1-CURRENT-QTR            PIC ZZ,ZZZ,ZZZ,ZZ9.99.        02149941
           05  FILLER                     PIC X(04) VALUE SPACES.       02150108
           05  DL1-PREVIOUS-QTR           PIC ZZ,ZZZ,ZZZ,ZZ9.99.        02150241
           05  FILLER                     PIC X(05) VALUE SPACES.       02150441
                                                                        02330000
       01  TL1-TOTAL-LINE1.                                             02331005
           05  FILLER                     PIC X(02) VALUE SPACES.       02332008
           05  TL1-TOTAL-DESC             PIC X(11) VALUE 'BUYER TOTAL'.02333038
           05  FILLER                     PIC X(45) VALUE SPACES.       02336008
           05  TL1-OFF-INVOICE-BAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99.        02339041
           05  FILLER                     PIC X(04) VALUE SPACES.       02339108
           05  TL1-CURRENT-QTR            PIC ZZ,ZZZ,ZZZ,ZZ9.99.        02339241
           05  FILLER                     PIC X(04) VALUE SPACES.       02339308
           05  TL1-PREVIOUS-QTR           PIC ZZ,ZZZ,ZZZ,ZZ9.99.        02339441
           05  FILLER                     PIC X(05) VALUE SPACES.       02339541
                                                                        02339605
      ****************************************************************  02580000
      * DARD106 COPYBOOK                                                02590000
      ****************************************************************  02600000
           COPY DARD106.                                                02610012
                                                                        02620000
      *                                                                 03030000
       PROCEDURE DIVISION.                                              03040000
                                                                        03050000
      ******************************************************************03051008
      * 0000-DAKRP111.                                                  03052108
      ******************************************************************03053008
       0000-DAKRP111.                                                   03060000
                                                                        03070000
           PERFORM 1000-INITIALIZE                                      03080000
                                                                        03090000
           PERFORM 2000-PROCESS-EXTRACT                                 03100000
               UNTIL PS-EOF-EXTRACT.                                    03110000
                                                                        03111038
           PERFORM 5000-PRINT-BUYER-TOTALS.                             03112039
                                                                        03112140
           PERFORM 8100-PRINT-GRAND-TOTALS.                             03120039
                                                                        03121038
           PERFORM 9900-EOJ.                                            03130008
                                                                        03140000
           GOBACK.                                                      03150000
                                                                        03160000
      ******************************************************************03170008
      * 1000-INITIALIZE.                                                03170108
      ******************************************************************03172008
       1000-INITIALIZE.                                                 03180000
                                                                        03190000
           OPEN INPUT  INPUT-FILE.                                      03200000
           OPEN OUTPUT REPORT-FILE.                                     03240000
                                                                        03250000
           PERFORM 9000-READ-EXTRACT.                                   03290008
           IF PS-EOF-EXTRACT                                            03300000
               DISPLAY 'NO DA INPUT -- REPORT WILL BE EMPTY'            03310000
           END-IF.                                                      03382014
                                                                        03500000
      ******************************************************************03501008
      * 2000-PROCESS-EXTRACT.                                           03501108
      ******************************************************************03503008
       2000-PROCESS-EXTRACT.                                            03510000
                                                                        03510114
           IF PS-FST-REC-PROCESSED                                      03511014
               IF DA106-GMM = PV-HOLD-GMM                               03520014
                   AND DA106-DMM = PV-HOLD-DMM                          03530014
                   AND DA106-BUYER = PV-HOLD-BUYER                      03540014
                   PERFORM 3000-ACCUM-BUYER-TOTALS                      03541014
                   PERFORM 4000-PRINT-DETAIL-LINE                       03550014
               ELSE                                                     03552114
                   PERFORM 5000-PRINT-BUYER-TOTALS                      03560114
                   PERFORM 5200-INIT-BUYER-TOTALS                       03560314
                   PERFORM 6000-WRITE-REPORT-HEADING                    03560424
                   PERFORM 3000-ACCUM-BUYER-TOTALS                      03560535
                   PERFORM 4000-PRINT-DETAIL-LINE                       03560834
               END-IF                                                   03560914
           ELSE                                                         03561014
               PERFORM 6000-WRITE-REPORT-HEADING                        03561114
               MOVE DA106-CRRNT-AVL-COST-AMT TO PA-TTL-CRRNT-VND-FUND   03561214
                                                PA-GTL-CRRNT-VND-FUND   03561338
               MOVE DA106-PREV-AVL-COST-AMT  TO PA-TTL-PREV-VND-FUND    03561438
                                                PA-GTL-PREV-VND-FUND    03561538
               PERFORM 4000-PRINT-DETAIL-LINE                           03562014
               MOVE 'Y' TO PS-FST-REC-SWITCH                            03563026
           END-IF.                                                      03640000
                                                                        03670000
           PERFORM 3200-HOLD-DA106-RECORD.                              03670114
           PERFORM 9000-READ-EXTRACT.                                   03671008
                                                                        03672008
      ******************************************************************03673008
      * 3000-ACCUM-BUYER-TOTALS.                                        03674108
      ******************************************************************03675008
       3000-ACCUM-BUYER-TOTALS.                                         03680008
           COMPUTE PA-TTL-CRRNT-VND-FUND =                              03681014
               DA106-CRRNT-AVL-COST-AMT + PA-TTL-CRRNT-VND-FUND.        03682014
           COMPUTE PA-TTL-PREV-VND-FUND =                               03683014
               DA106-PREV-AVL-COST-AMT + PA-TTL-PREV-VND-FUND.          03684014
           COMPUTE PA-GTL-CRRNT-VND-FUND =                              03685038
               DA106-CRRNT-AVL-COST-AMT + PA-GTL-CRRNT-VND-FUND.        03686038
           COMPUTE PA-GTL-PREV-VND-FUND =                               03687038
               DA106-PREV-AVL-COST-AMT + PA-GTL-PREV-VND-FUND.          03688038
                                                                        03730004
      ******************************************************************03730114
      * 3200-HOLD-DA106-RECORD.                                         03730214
      ******************************************************************03730314
       3200-HOLD-DA106-RECORD.                                          03730414
           MOVE DA106-GMM         TO PV-HOLD-GMM.                       03730536
           MOVE DA106-DMM         TO PV-HOLD-DMM.                       03730636
           MOVE DA106-VENDOR-NAME TO PV-HOLD-VND-NAME.                  03730736
           MOVE DA106-BUYER       TO PV-HOLD-BUYER.                     03730847
           MOVE DA106-DEPT-NBR    TO PV-HOLD-DEPT-NBR.                  03731036
                                                                        03731114
      ******************************************************************03732008
      * 4000-PRINT-DETAIL-LINE.                                         03732108
      ******************************************************************03733008
       4000-PRINT-DETAIL-LINE.                                          03740008
           COMPUTE PA-TTL-OFF-BALANCE =                                 03741009
               DA106-CRRNT-AVL-COST-AMT + DA106-PREV-AVL-COST-AMT.      03741114
                                                                        03742109
           IF DA106-VENDOR-NAME = PV-HOLD-VND-NAME                      03742236
               IF DA106-DEPT-NBR = PV-HOLD-DEPT-NBR                     03742409
                   DISPLAY '** ABEND **'                                03742646
                   DISPLAY '** PROGRAM DAKRP111 **'                     03742746
                   DISPLAY '** INCORRECT SORTING SEQUENCE'              03742846
                   MOVE +4001 TO PV-ABEND-CODE                          03742946
                   PERFORM 9999-ABEND                                   03743046
               ELSE                                                     03743109
                   IF DA106-BUYER = PV-HOLD-BUYER                       03743347
                       MOVE SPACES               TO DL1-VENDOR-NAME     03743647
                       MOVE SPACES               TO DL1-VENDOR-NUMBER   03743747
                   ELSE                                                 03743847
                       MOVE DA106-VENDOR-NAME    TO DL1-VENDOR-NAME     03743947
                       MOVE DA106-VENDOR-NBR     TO DL1-VENDOR-NUMBER   03744047
                   END-IF                                               03744147
                   MOVE DA106-DEPT-NBR           TO DL1-DEPT-NUMBER     03744217
                   MOVE PA-TTL-OFF-BALANCE       TO DL1-OFF-INVOICE-BAL 03744309
                   MOVE DA106-CRRNT-AVL-COST-AMT TO DL1-CURRENT-QTR     03744409
                   MOVE DA106-PREV-AVL-COST-AMT  TO DL1-PREVIOUS-QTR    03744509
                   PERFORM 7000-WRITE-REPORT-LINE                       03744610
               END-IF                                                   03744709
           ELSE                                                         03744809
               IF PS-FST-REC-PROCESSED                                  03744914
                   PERFORM 7200-WRITE-BLANK-LINE                        03745014
               END-IF                                                   03745114
               MOVE DA106-VENDOR-NAME        TO DL1-VENDOR-NAME         03745209
               MOVE DA106-VENDOR-NBR         TO DL1-VENDOR-NUMBER       03745317
               MOVE DA106-DEPT-NBR           TO DL1-DEPT-NUMBER         03745417
               MOVE PA-TTL-OFF-BALANCE       TO DL1-OFF-INVOICE-BAL     03745509
               MOVE DA106-CRRNT-AVL-COST-AMT TO DL1-CURRENT-QTR         03745609
               MOVE DA106-PREV-AVL-COST-AMT  TO DL1-PREVIOUS-QTR        03745709
               PERFORM 7000-WRITE-REPORT-LINE                           03745810
           END-IF.                                                      03745909
                                                                        03746009
      ******************************************************************03801008
      * 5000-PRINT-BUYER-TOTALS.                                        03802109
      ******************************************************************03803008
       5000-PRINT-BUYER-TOTALS.                                         03810009
                                                                        04050008
           PERFORM 7200-WRITE-BLANK-LINE 2 TIMES.                       04050140
                                                                        04050240
           COMPUTE PA-TTL-OFF-BALANCE =                                 04051009
               PA-TTL-CRRNT-VND-FUND + PA-TTL-PREV-VND-FUND.            04060015
                                                                        04070015
           MOVE PA-TTL-OFF-BALANCE    TO TL1-OFF-INVOICE-BAL.           04071009
           MOVE PA-TTL-CRRNT-VND-FUND TO TL1-CURRENT-QTR.               04072009
           MOVE PA-TTL-PREV-VND-FUND  TO TL1-PREVIOUS-QTR.              04073009
           PERFORM 8000-WRITE-TOTAL-LINE.                               04140008
                                                                        04150008
           PERFORM 7200-WRITE-BLANK-LINE 3 TIMES.                       04150140
                                                                        04150240
      ******************************************************************04151015
      * 5200-INIT-BUYER-TOTALS.                                         04151115
      ******************************************************************04152015
       5200-INIT-BUYER-TOTALS.                                          04160015
           MOVE ZEROES TO PA-TTL-OFF-BALANCE                            04161015
                          PA-TTL-CRRNT-VND-FUND                         04162015
                          PA-TTL-PREV-VND-FUND.                         04163015
                                                                        04170015
      ******************************************************************04441000
      * 6000-WRITE-REPORT-HEADING                                      *04442008
      ******************************************************************04443000
       6000-WRITE-REPORT-HEADING.                                       04450008
                                                                        04500000
      * HEADING LINE1                                                   04502009
           MOVE ZEROES                         TO PA-LINE-NO.           04510013
           ADD 1                               TO PA-PAGE-COUNT.        04520010
           ACCEPT PV-TODAYS-DATE-FORMATTED     FROM DATE.               04521028
           MOVE PV-YEAR                        TO DP132O-RUN-YEAR.      04523028
           MOVE PV-MONTH                       TO DP132O-RUN-MONTH.     04525028
           MOVE PV-DAY                         TO DP132O-RUN-DAY.       04527028
           MOVE SPACES                         TO DP132O-RUN-TIME.      04529033
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   04530010
           MOVE PC-DAKRP111-PGM                TO DP132O-PROGRAM-NAME.  04531031
           MOVE '1'                            TO DP132O-REPORT-NUMBER. 04532028
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        04540010
           WRITE REPORT-RECORD                                          04550000
               AFTER ADVANCING PAGE.                                    04560010
                                                                        04570000
      * HEADING LINE2                                                   04620009
           MOVE H2-HEADING2 TO REPORT-RECORD.                           04630014
           WRITE REPORT-RECORD                                          04640000
               AFTER ADVANCING 1 LINE.                                  04650009
                                                                        04660000
      * HEADING LINE3                                                   04661009
           MOVE H3-HEADING3 TO REPORT-RECORD.                           04670010
           WRITE REPORT-RECORD                                          04680000
               AFTER ADVANCING 1 LINES.                                 04690009
                                                                        04700000
      * HEADING LINE4                                                   04701009
           IF DA106-GMM EQUAL SPACES                                    04701121
               MOVE ZEROES TO H4-GMM-NUMBER                             04701221
           ELSE                                                         04701321
               MOVE DA106-GMM TO H4-GMM-NUMBER                          04702021
           END-IF.                                                      04702121
                                                                        04702248
           MOVE SPACES TO H4-GMM-NAME.                                  04702348
           STRING DA106-GMM-FIR-NAME  DELIMITED BY SPACES               04702448
                  ' '                 DELIMITED BY SIZE                 04702548
                  DA106-GMM-LAST-NAME DELIMITED BY SPACES               04702648
                  INTO H4-GMM-NAME                                      04702748
           END-STRING.                                                  04702848
                                                                        04705010
           MOVE H4-HEADING4 TO REPORT-RECORD                            04710014
                               HH4-HOLD-HEADING4.                       04711014
           WRITE REPORT-RECORD                                          04720000
               AFTER ADVANCING 1 LINES.                                 04730000
                                                                        04740000
      * HEADING LINE5                                                   04742609
           IF DA106-DMM EQUAL SPACES                                    04742721
               MOVE ZEROES TO H5-DMM-NUMBER                             04742821
           ELSE                                                         04742921
               MOVE DA106-DMM TO H5-DMM-NUMBER                          04743021
           END-IF.                                                      04743121
                                                                        04743243
           MOVE SPACES TO H5-DMM-NAME.                                  04743348
           STRING DA106-DMM-FIR-NAME  DELIMITED BY SPACES               04743443
                  ' '                 DELIMITED BY SIZE                 04743543
                  DA106-DMM-LAST-NAME DELIMITED BY SPACES               04743643
                  INTO H5-DMM-NAME                                      04743744
           END-STRING.                                                  04743843
                                                                        04744010
           MOVE H5-HEADING5 TO REPORT-RECORD                            04744114
                               HH5-HOLD-HEADING5.                       04744214
           WRITE REPORT-RECORD                                          04744309
               AFTER ADVANCING 1 LINES.                                 04744409
                                                                        04745009
      * HEADING LINE6                                                   04746009
           IF DA106-BUYER EQUAL SPACES                                  04746121
               MOVE ZEROES TO H6-BYR-NUMBER                             04746221
           ELSE                                                         04746321
               MOVE DA106-BUYER TO H6-BYR-NUMBER                        04746421
           END-IF.                                                      04746521
                                                                        04746643
           MOVE SPACES TO H6-BYR-NAME.                                  04746748
           STRING DA106-BYR-FIR-NAME  DELIMITED BY SPACES               04746843
                  ' '                 DELIMITED BY SIZE                 04746943
                  DA106-BYR-LAST-NAME DELIMITED BY SPACES               04747043
                  INTO H6-BYR-NAME                                      04747144
           END-STRING.                                                  04747243
                                                                        04747410
           MOVE H6-HEADING6 TO REPORT-RECORD                            04747514
                               HH6-HOLD-HEADING6.                       04747614
           WRITE REPORT-RECORD                                          04748009
               AFTER ADVANCING 1 LINES.                                 04749009
                                                                        04749109
      * DETAIL HEADING1                                                 04749809
           MOVE DH1-DETAIL-HEADING1 TO REPORT-RECORD.                   04749909
           WRITE REPORT-RECORD                                          04750009
               AFTER ADVANCING 1 LINES.                                 04750109
                                                                        04750209
      * DETAIL HEADING2                                                 04750309
           MOVE DH2-DETAIL-HEADING2 TO REPORT-RECORD.                   04750409
           WRITE REPORT-RECORD                                          04750509
               AFTER ADVANCING 1 LINES.                                 04750609
                                                                        04750709
      * DETAIL HEADING DASH LINE                                        04750809
           MOVE DH3-DETAIL-HEADING3 TO REPORT-RECORD.                   04750909
           WRITE REPORT-RECORD                                          04751009
               AFTER ADVANCING 1 LINES.                                 04751109
                                                                        04752009
           MOVE 9 TO PA-LINE-NO.                                        04790010
                                                                        04800000
      ******************************************************************04800114
      * 6200-WRITE-SV-RPT-HEADING                                      *04800214
      ******************************************************************04800314
       6200-WRITE-SV-RPT-HEADING.                                       04800414
                                                                        04800514
      * HEADING LINE1                                                   04800614
           MOVE ZEROES                         TO PA-LINE-NO.           04800714
           ADD 1                               TO PA-PAGE-COUNT.        04800814
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   04800914
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        04801828
           WRITE REPORT-RECORD                                          04801928
               AFTER ADVANCING PAGE.                                    04802028
                                                                        04802414
      * HEADING LINE2                                                   04802814
           MOVE H2-HEADING2 TO REPORT-RECORD.                           04802914
           WRITE REPORT-RECORD                                          04803014
               AFTER ADVANCING 1 LINE.                                  04803114
                                                                        04803214
      * HEADING LINE3                                                   04803314
           MOVE H3-HEADING3 TO REPORT-RECORD.                           04803414
           WRITE REPORT-RECORD                                          04803514
               AFTER ADVANCING 1 LINES.                                 04803614
                                                                        04803714
      * HEADING LINE4                                                   04803814
           MOVE HH4-HOLD-HEADING4 TO REPORT-RECORD.                     04803914
           WRITE REPORT-RECORD                                          04804014
               AFTER ADVANCING 1 LINES.                                 04804114
                                                                        04804214
      * HEADING LINE5                                                   04804314
           MOVE HH5-HOLD-HEADING5 TO REPORT-RECORD.                     04804416
           WRITE REPORT-RECORD                                          04804514
               AFTER ADVANCING 1 LINES.                                 04804614
                                                                        04804714
      * HEADING LINE6                                                   04804814
           MOVE HH6-HOLD-HEADING6    TO REPORT-RECORD.                  04805014
           WRITE REPORT-RECORD                                          04805114
               AFTER ADVANCING 1 LINES.                                 04805214
                                                                        04805314
      * DETAIL HEADING1                                                 04805414
           MOVE DH1-DETAIL-HEADING1 TO REPORT-RECORD.                   04805514
           WRITE REPORT-RECORD                                          04805614
               AFTER ADVANCING 1 LINES.                                 04805714
                                                                        04805814
      * DETAIL HEADING2                                                 04805914
           MOVE DH2-DETAIL-HEADING2 TO REPORT-RECORD.                   04806014
           WRITE REPORT-RECORD                                          04806114
               AFTER ADVANCING 1 LINES.                                 04806214
                                                                        04806314
      * DETAIL HEADING DASH LINE                                        04806414
           MOVE DH3-DETAIL-HEADING3 TO REPORT-RECORD.                   04806514
           WRITE REPORT-RECORD                                          04806614
               AFTER ADVANCING 1 LINES.                                 04806714
                                                                        04806814
           MOVE 9 TO PA-LINE-NO.                                        04806927
                                                                        04807027
      * KEEP THE VENDOR NAME AND NUMBER FOR SAVE HEADING                04807127
           MOVE DA106-VENDOR-NAME        TO DL1-VENDOR-NAME.            04807227
           MOVE DA106-VENDOR-NBR         TO DL1-VENDOR-NUMBER.          04807327
                                                                        04807514
      ******************************************************************04807614
      * 7000-WRITE-REPORT-LINE.                                         04807714
      ******************************************************************04808014
       7000-WRITE-REPORT-LINE.                                          04810008
                                                                        04820000
           IF PA-LINE-NO > PC-MAX-LINES                                 04830000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04840014
           END-IF.                                                      04850000
                                                                        04860000
           WRITE REPORT-RECORD FROM DL1-DETAIL-LINE1                    04870009
                  AFTER ADVANCING 1 LINES.                              04880000
           ADD 1 TO PA-LINE-NO.                                         04890000
                                                                        04900000
      ******************************************************************04910010
      * 7200-WRITE-BLANK-LINE.                                          04910110
      ******************************************************************04910210
       7200-WRITE-BLANK-LINE.                                           04910310
                                                                        04910410
           IF PA-LINE-NO > PC-MAX-LINES                                 04910510
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04910614
           END-IF.                                                      04910710
                                                                        04910810
           MOVE SPACES TO REPORT-RECORD.                                04910910
           WRITE REPORT-RECORD                                          04911010
               AFTER ADVANCING 1 LINES.                                 04911110
                                                                        04911810
           ADD 1 TO PA-LINE-NO.                                         04912110
                                                                        04912210
      ******************************************************************04912310
      * 8000-WRITE-TOTAL-LINE.                                          04912408
      ******************************************************************04913008
       8000-WRITE-TOTAL-LINE.                                           04920008
                                                                        04930000
           IF PA-LINE-NO > PC-MAX-LINES                                 04940000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04950014
           END-IF.                                                      04960000
                                                                        04970000
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE1                     04980016
                  AFTER ADVANCING 2 LINES.                              04990025
           ADD 2 TO PA-LINE-NO.                                         05000025
                                                                        05010000
      ******************************************************************05020038
      * 8100-PRINT-GRAND-TOTALS.                                        05030038
      ******************************************************************05040038
       8100-PRINT-GRAND-TOTALS.                                         05050038
                                                                        05060038
           COMPUTE PA-GTL-OFF-BALANCE =                                 05070038
               PA-GTL-CRRNT-VND-FUND + PA-GTL-PREV-VND-FUND.            05080038
                                                                        05090038
           MOVE 'GRAND TOTAL'         TO TL1-TOTAL-DESC.                05091038
           MOVE PA-GTL-OFF-BALANCE    TO TL1-OFF-INVOICE-BAL.           05100038
           MOVE PA-GTL-CRRNT-VND-FUND TO TL1-CURRENT-QTR.               05110038
           MOVE PA-GTL-PREV-VND-FUND  TO TL1-PREVIOUS-QTR.              05120038
           PERFORM 8000-WRITE-TOTAL-LINE.                               05130038
                                                                        05140038
      *************************************************************     05660000
      *  9000-READ-EXTRACT.                                       *     05670008
      *************************************************************     05680000
       9000-READ-EXTRACT.                                               05720008
           READ INPUT-FILE INTO DA106-AVL-VND-FUND-REC                  05730000
               AT END                                                   05740000
                   SET PS-EOF-EXTRACT TO TRUE                           05750000
               NOT AT END                                               05760000
                   ADD 1 TO PA-TOTAL-READ                               05770000
           END-READ.                                                    05780000
                                                                        05790000
      *************************************************************     05860000
      *  9900-EOJ IS PERFORMED FROM 0000-DAKRP111.                *     05870008
      *************************************************************     05880000
       9900-EOJ.                                                        05890008
                                                                        05900000
           IF PA-TOTAL-READ = ZERO                                      05910000
               WRITE REPORT-RECORD FROM PM-NO-INPUT-MSG                 05920018
                   AFTER ADVANCING 5 LINES                              05930018
           END-IF.                                                      05980000
                                                                        05990000
           WRITE REPORT-RECORD FROM PM-END-RPT-MSG                      06000000
                AFTER ADVANCING 5 LINES                                 06010000
                                                                        06020000
           CLOSE INPUT-FILE.                                            06030000
           CLOSE REPORT-FILE.                                           06070000
                                                                        06080000
           DISPLAY SPACES.                                              06090000
           MOVE PA-TOTAL-READ        TO PV-DISP-NUMBER.                 06100000
           DISPLAY 'RECS READ    =    ' PV-DISP-NUMBER.                 06110000
                                                                        06120000
      *************************************************************     06121046
      * 9999-ABEND.                                               *     06121146
      *************************************************************     06122046
       9999-ABEND.                                                      06130046
                                                                        06140046
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        06150046
                                                                        06160046
