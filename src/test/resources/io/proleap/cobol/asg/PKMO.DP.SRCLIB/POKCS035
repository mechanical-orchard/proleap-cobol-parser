000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKCS035.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  09/06/93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - W035                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE INQUIRY - DB2              * 00100000
001100*    DESCRIPTION - PURCHASE ORDER ITEM INQUIRY                  * 00110000
001200*    MAPSET      - POKM035                                      * 00120000
001300*                                                               * 00130000
001400*    THIS PROGRAM ALLOWS ONE TO VIEW INFORMATION FOR A GIVEN    * 00140000
001500*    PURCHASE ORDER LINE ITEM.                                  * 00150000
001600*                                                               * 00160000
001700***************************************************************** 00170000
001800* DATE     WHO      DESCRIPTION                                 * 00180000
001900* 050899   TKMA340  WR6398                                      * 00190000
002000*                   ADD TSK STICKER/BOXID# FOR SHOE VENDORS     * 00200000
002100* 090199   TKMA518  FOR PROD PKGNG PROJECT, ZERO'D OUT INNER/   * 00210000
002200*                   OUTER QUANTITIES FOR M AND I TYPE PO'S      * 00220000
002210***************************************************************** 00221032
002220* DATE     WHO      DESCRIPTION                                 * 00222033
002230* 011701   TKMA537  WR #21643, E-COMMERCE EDITS                 * 00223033
002240*                   ADDED CODE TO HIGHLIGHT WEB ITEMS IN RED    * 00224033
002250***************************************************************** 00225033
002260* DATE     WHO      DESCRIPTION                                 * 00226033
002270* 042903   TK21263  WR #21263, NI SKU CONVERSION                * 00227033
002271*                  -ALL THE DCLGEN COPYBOOKS TSK,               * 00227133
002272*                   TUPCSKU ARE REMOVED.                        * 00227233
002273*                  -NEW DCLGEN COPYBOOKS XLT00003, XLT00004,    * 00227333
002274*                   XLT00006 ARE ADDED.                         * 00227433
002275*                  -ALL THE OCCURENCES OF CLASS AND 3-DIGIT     * 00227533
002276*                   SEQUENCE NUMBER ARE REPLACED WITH MAJOR-    * 00227633
002277*                   CLASS,SUB-CLASS AND 8-DIGIT SKU.            * 00227733
002278*                  -THE PROGRAM WAS RECOMPILED TO BRING THE NEW * 00227833
002279*                   VERSION OF COPYBOOK P0WS017.                * 00227933
002280*                  -IN PARAGRAPH 4450-CHECK-TWEBUPC THE TABLES  * 00228033
002281*                   TUPCPLS AND TWEBITM ARE NOT REPLACED BY     * 00228133
002282*                   LOGISTICS DOMAIN TABLES BECAUSE OF          * 00228233
002283*                   PERFORMANCE ISSUES.                         * 00228333
002284***************************************************************** 00228433
C98147* 11/25/14 LINDA FRIESS                 - CHG0098147              00228537
C98147*       RECOMPILED PROGRAM TO BRING IN NEW MAP WITH 8-DIGIT PO    00228637
C98147***************************************************************** 00228837
C66632***************************************************************** 00228944
C66632* 05/05/17 COGNIZANT                    - CHG0166632            * 00229044
C66632*  CHANGE MADE: TO DISPLAY ROUNDED 1ST-COST-AMT IN CICS SCREEN  * 00229144
C66632*  WITH 2 DIGITS AFTER DECIMAL.                                 * 00229244
C66632***************************************************************** 00240044
CICS  *  CHANGED 11/11/2022    BY BARB SCHULTZ    WR: CHG0278485      * 00250047
CICS  *                                                               * 00260045
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00261045
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00262045
C66632***************************************************************** 00262145
C66632*                                                               * 00263045
002700                                                                  00270000
002800 ENVIRONMENT DIVISION.                                            00280000
002900 DATA DIVISION.                                                   00290000
003000/                                                                 00300000
003100 WORKING-STORAGE SECTION.                                         00310000
003200                                                                  00320000
003300 01  DK-DB2-KEYS.                                                 00330000
003400     05  DK-PO-NBR                    PIC S9(09) VALUE +0         00340000
003500                                                 COMP.            00350000
003600     05  DK-PO-LNE-NBR                PIC S9(09) VALUE +0         00360000
003700                                                 COMP.            00370000
003800     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    00380000
004100     05  DK-ENT-ID                    PIC S9(09) VALUE +0         00410000
004200                                                 COMP.            00420000
004300     05  DK-PO-TYP-CDE                PIC X(02)  VALUE SPACES.    00430000
004400                                                                  00440000
004500 01  PC-PROGRAM-CONSTANTS.                                        00450000
004600     05  PC-TRANS-ID                  PIC X(04)  VALUE 'W035'.    00460000
004700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'POKCS035'.00470000
004800     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'PO035A  '.00480000
004900     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'POKM035 '.00490000
005000     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00500000
005100                                                 COMP.            00510000
005200     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00520000
005300                                                 COMP.            00530000
005400     05  PC-MAX-MSG-VAR               PIC S9(04) VALUE  +1        00540000
005500                                                 COMP.            00550000
005600     05  PC-1                         PIC S9(04) VALUE  +1        00560000
005700                                                 COMP.            00570000
005800     05  PC-MULTIPLE-UPC              PIC X(15)  VALUE            00580000
005900         'MORE THAN 1 UPC'.                                       00590000
006000     05  PC-NO-VENDOR-UPC             PIC X(15)  VALUE            00600000
006100         'NO VENDOR UPC  '.                                       00610000
006200     05  PC-SPECIAL                   PIC X(02)  VALUE 'SP'.      00620000
006300     05  PC-INTER-APPL-CODES.                                     00630000
006400         10  PC-INTER-APPL-PO-INQ     PIC X(01)  VALUE ' '.       00640000
006500         10  PC-INTER-APPL-WO         PIC X(01)  VALUE '1'.       00650000
006600         10  PC-INTER-APPL-ITM-ADD-LST PIC X(01) VALUE '2'.       00660000
006700         10  PC-INTER-APPL-ITM-ADD    PIC X(01)  VALUE '3'.       00670000
006800     05  PC-MSG-VAR-SYMBOLIC          PIC X(04)  VALUE '&VAR'.    00680000
006900     05  PC-MIN-UPC                   PIC S9(15)V                 00690000
007000                                       VALUE +000400000000000     00700000
007100                                       COMP-3.                    00710000
007200     05  PC-MAX-UPC                   PIC S9(15)V                 00720000
007300                                       VALUE +000409999999999     00730000
007400                                       COMP-3.                    00740000
007500                                                                  00750000
007600     05  PC-TSYMSG-NUMBERS.                                       00760000
007700         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00770000
007800         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00780000
007900         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00790000
008000         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00800000
008100         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00810000
008200         10  PC-TSYMSG-00010      PIC  9(05)  VALUE  00010.       00820000
008300         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00830000
008400         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00840000
008500         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00850000
008600         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00860000
008700         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00870000
008800         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00880000
008900         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       00890000
009000         10  PC-TSYMSG-00118      PIC  9(05)  VALUE  00118.       00900000
009100         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00910000
009200         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00920000
009300         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       00930000
009400         10  PC-TSYMSG-00656      PIC  9(05)  VALUE  00656.       00940000
009500         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00950000
009600*                                                                 00960000
009700 01  PS-PROGRAM-SWITCHES.                                         00970000
009800     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00980000
009900         88  PS-ERROR                         VALUE  'Y'.         00990000
010000         88  PS-NO-ERROR                      VALUE  'N'.         01000000
010100     05  PS-COMMAREA-SW           PIC  X(01)  VALUE 'N'.          01010000
010200         88  PS-COMMAREA-VALID                VALUE 'Y'.          01020000
010300         88  PS-COMMAREA-NOT-VALID            VALUE 'N'.          01030000
010400     05  PS-LIST-SW               PIC  X(01)  VALUE  'N'.         01040000
010500         88  PS-LIST-END                      VALUE  'Y'.         01050000
010600         88  PS-LIST-NOT-END                  VALUE  'N'.         01060000
010700*                                                                 01070000
010800 01  PV-PROGRAM-VARIABLES.                                        01080000
010900     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01090000
011000                                              COMP SYNC.          01100000
011100     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01110000
011200                                              COMP SYNC.          01120000
011210     05  PV-DB2-COUNT             PIC S9(09)  VALUE +0            01121033
011220                                              COMP-3.             01122033
011300     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            01130000
011400                                              COMP SYNC.          01140000
011500     05  PV-QUANTITY              PIC  9(06)  VALUE ZERO.         01150000
011600     05  PV-QUOTIENT              PIC S9(05)  VALUE +0            01160000
011700                                              COMP-3.             01170000
011800     05  PV-REMINDER              PIC S9(05)  VALUE +0            01180000
011900                                              COMP-3.             01190000
012000     05  PV-UNIT-COST             PIC S9(05)V999 VALUE +0         01200000
012100                                              COMP-3.             01210000
012200     05  PV-UNIT-RETAIL           PIC S9(06)V99 VALUE +0          01220000
012300                                              COMP-3.             01230000
012800     05  PV-TOTAL-SKUS            PIC S9(09)    VALUE ZERO COMP.  01280000
012900     05  PV-MARKUP-PCT            PIC S9(03)V99 VALUE +0          01290000
013000                                              COMP-3.             01300000
013100     05  PV-ALPHA-FIELD           PIC X(09)     VALUE SPACES.     01310000
013110     05  PV-NULL-INDICATORS.                                      01311033
013111         10 PV-SKU-NBR-IND        PIC S9(04)  VALUE +0 COMP.      01311133
013112         10 PV-MAJ-CL-NBR-IND     PIC S9(04)  VALUE +0 COMP.      01311233
013113         10 PV-SUB-CL-NBR-IND     PIC S9(04)  VALUE +0 COMP.      01311333
013114         10 PV-VS-NBR-IND         PIC S9(04)  VALUE +0 COMP.      01311433
013115         10 PV-NRF-CLOR-CDE-IND   PIC S9(04)  VALUE +0 COMP.      01311533
013116         10 PV-CSTM-CLOR-DESC-IND PIC S9(04)  VALUE +0 COMP.      01311633
013117         10 PV-KOHLS-SIZE-CDE-IND PIC S9(04)  VALUE +0 COMP.      01311733
013118         10 PV-SIZE-DESC-IND      PIC S9(04)  VALUE +0 COMP.      01311833
013119         10 PV-SKU-DESC-IND       PIC S9(04)  VALUE +0 COMP.      01311933
013120     05  PV-SUB-CL-NBR            PIC 9(02).                      01312033
013121     05  PV-MAJ-CLASS.                                            01312133
013122         10 PV-MAJ-CL-1           PIC 9        VALUE 0.           01312233
013123         10 FILLER                PIC 9        VALUE 0.           01312333
013124     05  PV-MAJ-CL-NBR REDEFINES PV-MAJ-CLASS                     01312433
013125                                  PIC 9(02).                      01312533
013126     05  PV-SKU.                                                  01312633
013127         10 PV-SKU-DEPT           PIC 9(03)     VALUE 0.          01312733
013128         10 PV-SKU-CLASS          PIC 9(02)     VALUE 0.          01312833
013129         10 PV-SKU-SEQ            PIC 9(03)     VALUE 0.          01312933
013130     05  PV-SKU-NBR REDEFINES PV-SKU                              01313033
013131                                  PIC 9(08).                      01313133
013132     05  PV-SIZE-CDE.                                             01313233
013133         10 FILLER                PIC 9(04)     VALUE 0.          01313333
013134         10 PV-SIZE-4-9           PIC 9(05)     VALUE 0.          01313433
013135     05  PV-SIZE REDEFINES PV-SIZE-CDE                            01313533
013136                                  PIC 9(09).                      01313633
013137     05  PV-INNR-PACK-QTY         PIC 9(04).                      01313733
013138     05  PV-OUTR-PACK-QTY         PIC 9(04).                      01313833
013139     05  PV-STKR-NBR              PIC 9(04).                      01313933
013200     05  PV-AD-DATE-10.                                           01320000
013300         10  PV-AD-DATE-CC         PIC X(02).                     01330000
013400         10  PV-AD-DATE.                                          01340000
013500             15  PV-AD-DATE-YY     PIC X(02).                     01350000
013600             15  FILLER            PIC X(01)    VALUE '-'.        01360000
013700             15  PV-AD-DATE-MM     PIC X(02).                     01370000
013800             15  FILLER            PIC X(01)    VALUE '-'.        01380000
013900             15  PV-AD-DATE-DD     PIC X(02).                     01390000
014000     05  PV-SLASH-DATE.                                           01400000
014100         10  PV-SL-DATE.                                          01410000
014200             15  PV-SL-DATE-MM     PIC X(02).                     01420000
014300             15  FILLER            PIC X(01)    VALUE '/'.        01430000
014400             15  PV-SL-DATE-DD     PIC X(02).                     01440000
014500             15  FILLER            PIC X(01)    VALUE '/'.        01450000
014600             15  PV-SL-DATE-YY     PIC X(02).                     01460000
014700         10  PV-SL-DATE-CC         PIC X(02).                     01470000
014800     05  PV-TMST-BREAK.                                           01480000
014900         10  FILLER                PIC X(02).                     01490000
015000         10  PV-TMSTB-YY           PIC X(02).                     01500000
015100         10  FILLER                PIC X(01).                     01510000
015200         10  PV-TMSTB-MM           PIC X(02).                     01520000
015300         10  FILLER                PIC X(01).                     01530000
015400         10  PV-TMSTB-DD           PIC X(02).                     01540000
015500         10  FILLER                PIC X(01).                     01550000
015600         10  PV-TMSTB-HH           PIC X(02).                     01560000
015700         10  FILLER                PIC X(01).                     01570000
015800         10  PV-TMSTB-MN           PIC X(02).                     01580000
015900         10  FILLER                PIC X(01).                     01590000
016000         10  PV-TMSTB-SS           PIC X(02).                     01600000
016100         10  FILLER                PIC X(07).                     01610000
016200     05  PV-DATE-DISPLAY.                                         01620000
016300         10  PV-DATE-MM            PIC X(02).                     01630000
016400         10  FILLER                PIC X(01) VALUE '/'.           01640000
016500         10  PV-DATE-DD            PIC X(02).                     01650000
016600         10  FILLER                PIC X(01) VALUE '/'.           01660000
016700         10  PV-DATE-YY            PIC X(02).                     01670000
016800     05  PV-TIME-DISPLAY.                                         01680000
016900         10  PV-TIME-HH            PIC X(02).                     01690000
017000         10  FILLER                PIC X(01) VALUE ':'.           01700000
017100         10  PV-TIME-MM            PIC X(02).                     01710000
017200         10  FILLER                PIC X(01) VALUE ':'.           01720000
017300         10  PV-TIME-SS            PIC X(02).                     01730000
017400     05  PV-UPC-NBR                PIC 9(15).                     01740000
017500     05  PV-UPC-NBR-X REDEFINES PV-UPC-NBR                        01750000
017600                                   PIC X(15).                     01760000
017700/                                                                 01770000
017800**--------------------------------------------------------------**01780000
017900** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **01790000
018000** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **01800000
018100**--------------------------------------------------------------**01810000
018200     COPY POWS012.                                                01820000
018300/                                                                 01830000
018400*----------------------------------------------------------------*01840000
018500*    MAP LAYOUT                                                  *01850000
018600*----------------------------------------------------------------*01860000
018700     COPY POKM035.                                                01870000
018800/                                                                 01880000
018900*----------------------------------------------------------------*01890000
019000*    ATTRIBUTE SETTINGS COPYBOOK.                                *01900000
019100*----------------------------------------------------------------*01910000
019200     COPY DPWS015.                                                01920000
019300/                                                                 01930000
019400*----------------------------------------------------------------*01940000
019500*    FUNCTION KEYS COPYBOOK                                      *01950000
019600*----------------------------------------------------------------*01960000
019700     COPY DPWS016.                                                01970000
019800/                                                                 01980000
019900**--------------------------------------------------------------**01990000
020000** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02000000
020100** SUB-ROUTINE (DPKUT100).                                      **02010000
020200**--------------------------------------------------------------**02020000
020300     COPY DPWS010I.                                               02030000
020400/                                                                 02040000
020500*----------------------------------------------------------------*02050000
020600*    NAME REFORMATOR COPYBOOK                                    *02060000
020700*----------------------------------------------------------------*02070000
020800     COPY DPWS024.                                                02080000
020900/                                                                 02090000
021000**--------------------------------------------------------------**02100000
CICS  ** PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            **02110048
021300**--------------------------------------------------------------**02130000
021400     COPY DPWS030.                                                02140000
CICS       COPY DPWS930.                                                02141045
021500/                                                                 02150000
021600******************************************************************02160000
021700*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02170000
021800******************************************************************02180000
021900     COPY RCWS013.                                                02190000
022000                                                                  02200000
022100******************************************************************02210000
022200*    SELECTED ITEMS TEMPORARY STORAGE QUEUE WO ITEM LAYOUT        02220000
022300******************************************************************02230000
022400     COPY PCWS016.                                                02240000
022500                                                                  02250000
022600/                                                                 02260000
022700**--------------------------------------------------------------**02270000
022800*    STANDARD COMMAREA.                                           02280000
022900**--------------------------------------------------------------**02290000
023000                                                                  02300000
023100     COPY DPWS020.                                                02310000
023200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02320000
023300                                                                  02330000
023400***************************************************************** 02340000
023500*    INTER-APPLICATION COMMAREA.                                  02350000
023600***************************************************************** 02360000
023700                                                                  02370000
023800         10  INTER-APPL-COMM-AREA PIC X(200).                     02380000
023900     COPY POWS013.                                                02390000
024000     COPY POWS017.                                                02400000
024100     COPY PCWS000.                                                02410000
024200***************************************************************** 02420000
024300*    SPECIFIC COMMMAREA FOR POKCS035.                             02430000
024400***************************************************************** 02440000
024500         10  ASC-SPECIFIC-COMMAREA.                               02450000
024600             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            02460000
024700             15  ASC-USE-SELECTION-QUEUE-IND                      02470000
024800                                           PIC  X(01).            02480000
024900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02490000
025000             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02500000
025100             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02510000
025200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02520000
025300                                           PIC S9(09)  COMP-3.    02530000
025400             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02540000
025500             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02550000
025600             15  ASC-KEY-FIELDS.                                  02560000
025700                 20  ASC-KEY-PO-NBR        PIC S9(09)  COMP.      02570000
025800                 20  ASC-KEY-DEPT-NBR      PIC X(03).             02580000
025900                 20  ASC-KEY-ENT-NAME-DESC PIC X(30).             02590000
026000                 20  ASC-KEY-PO-LNE-NBR    PIC S9(09)  COMP.      02600000
026100                 20  ASC-KEY-PO-LNE-VAR-NBR PIC S9(09) COMP.      02610000
026200                 20  ASC-KEY-APP-PO-LNE-NBR PIC S9(09) COMP.      02620000
026300                 20  ASC-KEY-ENT-ID         PIC S9(09) COMP.      02630000
026400             15  ASC-PO-TYP-CDE             PIC X(02).            02640000
026500             15  ASC-PKGNG-CDE              PIC X(01).            02650000
026600             15  ASC-SCREEN-FIELDS.                               02660000
026700                 20  ASC-ENT-NAME-DESC     PIC X(30).             02670000
026800                 20  ASC-DEPT-NBR          PIC X(03).             02680000
026900                 20  ASC-PO-LNE-NBR        PIC 9(03).             02690000
027000                 20  ASC-MAJ-CL-NBR        PIC X(02).             02700033
027100                 20  ASC-SUB-CL-NBR        PIC X(02).             02710033
027110                 20  ASC-SKU-NBR           PIC X(08).             02711033
027200                 20  ASC-VEND-STYL-NAME    PIC X(20).             02720000
027300                 20  ASC-SKU-DESC          PIC X(25).             02730000
027400                 20  ASC-AD-EVENT-DATE.                           02740000
027500                     25  ASC-AD-DATE.                             02750000
027600                         30  ASC-AD-DATE-MM PIC X(02).            02760000
027700                         30  FILLER         PIC X(01).            02770000
027800                         30  ASC-AD-DATE-DD PIC X(02).            02780000
027900                         30  FILLER         PIC X(01).            02790000
028000                         30  ASC-AD-DATE-YY PIC X(02).            02800000
028100                     25  ASC-AD-DATE-CC    PIC X(02).             02810000
028200                 20  ASC-COLOR             PIC X(03).             02820000
028300                 20  ASC-COLOR-DESC        PIC X(25).             02830000
028400                 20  ASC-SIZE              PIC X(09).             02840033
028500                 20  ASC-SIZE-DESC         PIC X(25).             02850000
028600                 20  ASC-UNT-QTY           PIC 9(06).             02860000
028700                 20  ASC-UNT-COST-AMT      PIC 9(04)V99.          02870000
028800                 20  ASC-FIRST-COST        PIC S9(04)V99 COMP-3.  02880000
028900                 20  ASC-UOM               PIC XX.                02890000
029000                 20  ASC-TOT-VAL-COST-AMT  PIC 9(08)V99.          02900000
029100                 20  ASC-UNT-RTL-PR-AMT    PIC 9(06)V99.          02910000
029200                 20  ASC-TOT-VAL-RTL-AMT   PIC 9(08)V99.          02920000
029300                 20  ASC-MU-PCT            PIC S999V99.           02930000
029400                 20  ASC-UPC-NBR           PIC X(16).             02940000
029500                 20  ASC-INNER-PACK-QTY    PIC 9(5).              02950000
029600                 20  ASC-OUTER-PACK-QTY    PIC 9(5).              02960000
029700                 20  ASC-GP-RTL-AMT        PIC 9(5)V99.           02970000
029800                 20  ASC-GP-QTY            PIC 9(03).             02980000
029900                 20  ASC-VER-STATUS-CDE    PIC X(01).             02990000
030000                 20  ASC-VER-NBR           PIC S9(04) COMP.       03000000
030100                 20  ASC-LAST-UPD-TMST     PIC X(26).             03010000
030200                 20  ASC-LAST-UPD-BY-UID   PIC X(08).             03020000
030300                 20  ASC-PIC-IND           PIC X(01).             03030000
030400                 20  ASC-PAGE-NBR          PIC 9(03).             03040000
030500                 20  ASC-BOXID             PIC X(03).             03050000
030600             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       03060000
030700                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03070000
030800                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03080000
030900             15  ASC-INTER-APPL-CODES                PIC X.       03090000
031000                 88  ASC-INTER-APPL-PO-INQ           VALUE ' '.   03100000
031100                 88  ASC-INTER-APPL-WO               VALUE '1'.   03110000
031200                 88  ASC-INTER-APPL-ITM-ADD-LST      VALUE '2'.   03120000
031300                 88  ASC-INTER-APPL-ITM-ADD          VALUE '3'.   03130000
031310         10 FILLER                         PIC X(2489).           03131033
031400/                                                                 03140000
031500*----------------------------------------------------------------*03150000
031600*    ABEND PROCESSING COPYBOOK.                                  *03160000
031700*----------------------------------------------------------------*03170000
031800     COPY DPWS013.                                                03180000
031900                                                                  03190000
032000/                                                                 03200000
032100                                                                  03210000
032200*    DB2 AREA FOR TPURCHS PO PURCHASE ORDER TABLE                 03220000
032300                                                                  03230000
032400     EXEC SQL                                                     03240000
032500          INCLUDE TPURCHS                                         03250000
032600     END-EXEC.                                                    03260000
032700                                                                  03270000
032800*    DB2 AREA FOR TPURITM PO PURCHASE ITEM TABLE                  03280000
032900                                                                  03290000
033000     EXEC SQL                                                     03300000
033100          INCLUDE TPURITM                                         03310000
033200     END-EXEC.                                                    03320000
033300                                                                  03330000
033400*    DB2 AREA FOR TMESTDS MERCHANDISE STORE DISTRIBUTION TABLE    03340000
033500                                                                  03350000
033600     EXEC SQL                                                     03360000
033700          INCLUDE TMESTDS                                         03370000
033800     END-EXEC.                                                    03380000
033900                                                                  03390000
034000*    DB2 AREA FOR TENTNME EXTERNAL ENTERPRISE NAME                03400000
034100                                                                  03410000
034200     EXEC SQL                                                     03420000
034300          INCLUDE TENTNME                                         03430000
034400     END-EXEC.                                                    03440000
034500                                                                  03450000
034600*    DB2 AREA FOR TSK SKU TABLE                                   03460000
034700                                                                  03470000
034800     EXEC SQL                                                     03480000
034900          INCLUDE XLT00003                                        03490033
035000     END-EXEC.                                                    03500000
035010*---------------------------------------------------------------* 03501033
035020*    DB2 AREA FOR VENDOR STYLE                                  * 03502033
035030*---------------------------------------------------------------* 03503033
035040     EXEC SQL                                                     03504033
035050          INCLUDE XLT00004                                        03505033
035060     END-EXEC.                                                    03506033
035070*---------------------------------------------------------------* 03507033
035080*    DB2 AREA FOR UPC                                           * 03508033
035090*---------------------------------------------------------------* 03509033
035091     EXEC SQL                                                     03509133
035092          INCLUDE XLT00006                                        03509233
035093     END-EXEC.                                                    03509333
035100                                                                  03510000
035110     EXEC SQL                                                     03511033
035120          INCLUDE TUPCPLS                                         03512033
035130     END-EXEC.                                                    03513033
035140*                                                                 03514033
035150     EXEC SQL                                                     03515033
035160          INCLUDE TWEBITM                                         03516033
035170     END-EXEC.                                                    03517033
035180*                                                                 03518033
035800*    DB2 AREA FOR WORKER ID TABLE                                 03580000
035900                                                                  03590000
036000     EXEC SQL                                                     03600000
036100          INCLUDE TWORKER                                         03610000
036200     END-EXEC.                                                    03620000
036300                                                                  03630000
036400*    DB2 AREA FOR COMMUNICATIONS                                  03640000
036500                                                                  03650000
036600     EXEC SQL                                                     03660000
036700          INCLUDE SQLCA                                           03670000
036800     END-EXEC.                                                    03680000
036900                                                                  03690000
037000******************************************************************03700000
037100* CURSOR TO SELECT WORKER NAME                                    03710000
037200******************************************************************03720000
037300                                                                  03730000
037400     EXEC SQL                                                     03740000
037500          DECLARE WORKER-CSR  CURSOR FOR                          03750000
037600              SELECT LAST_NAME,                                   03760000
037700                     FIR_NAME                                     03770000
037800              FROM TWORKER                                        03780000
037900              WHERE UID_NBR = :WORKER-UID-NBR                     03790000
038000     END-EXEC.                                                    03800000
038100/                                                                 03810000
038200 LINKAGE SECTION.                                                 03820000
038300                                                                  03830000
038400 01  DFHCOMMAREA.                                                 03840000
038500     05  FILLER                         OCCURS  1 TO 4072 TIMES   03850000
038600                                        DEPENDING ON EIBCALEN.    03860000
038700         10  FILLER                     PIC X.                    03870000
038800                                                                  03880000
038900/                                                                 03890000
039000 PROCEDURE DIVISION.                                              03900000
039100*************24344*********************************************** 03910000
039200** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03920000
039300** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03930000
039400** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03940000
039500**                                                             ** 03950000
039600** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03960000
039700** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03970000
039800***************************************************************** 03980000
039900 0000-MAIN-MODULE.                                                03990000
040000     INITIALIZE DP030-CICS-API-FIELDS.                            04000000
040100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04010000
040200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04020000
040300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04030000
040400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04040000
040500     MOVE LENGTH OF PO035AI        TO DP030-MAP-LENGTH (1).       04050000
040600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04060000
040700     PERFORM 0001-CALL-CICS-ARCH-API.                             04070000
040800*                                                                 04080000
040900     PERFORM 1000-CONTROL-PROCESSING                              04090000
041000*                                                                 04100000
041100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04110000
041200     PERFORM 0001-CALL-CICS-ARCH-API.                             04120000
041300                                                                  04130000
041400/                                                                 04140000
041500 0001-CALL-CICS-ARCH-API.                                         04150000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04160045
041700                                    DFHCOMMAREA                   04170045
041800                                    DP030-CICS-API-FIELDS         04180045
041900                                    DP020-STANDARD-COMMAREA       04190045
042000                                    PO035AI.                      04200045
042100*                                                                 04210000
042200     IF  DP030-RC-CALL-SUCCESSFUL                                 04220000
042300         CONTINUE                                                 04230000
042400     ELSE                                                         04240000
042500         SET DP013-NO-ROLLBACK                                    04250000
042600             DP013-XCTL-DISPLAY-RESTART                           04260000
042700             DP013-CICS-ABEND      TO TRUE                        04270000
CICS           MOVE '0001-CALL-CICS-ARCH-API'                           04280045
042900                                   TO DP013-PARAGRAPH             04290000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04300045
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04310045
043200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04320000
043300         PERFORM DP013-0000-PROCESS-ABEND                         04330000
043400     END-IF.                                                      04340000
043500                                                                  04350000
043600/                                                                 04360000
043700*----------------------------------------------------------------*04370000
043800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04380000
043900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04390000
044000*----------------------------------------------------------------*04400000
044100                                                                  04410000
044200 1000-CONTROL-PROCESSING.                                         04420000
044300                                                                  04430000
044400     EVALUATE TRUE                                                04440000
044500         WHEN DP020-NEXT-ACT-INITIAL                              04450000
044600              PERFORM 1100-PROCESS-INTER-APPL-COMM                04460000
044700              IF  PS-COMMAREA-NOT-VALID                           04470000
044800                  CONTINUE                                        04480000
044900              ELSE                                                04490000
045000                  PERFORM 4000-BUILD-INITIAL-PANEL                04500000
045100              END-IF                                              04510000
045200                                                                  04520000
045300         WHEN DP020-NEXT-ACT-READ-MAP                             04530000
045400             PERFORM 2000-PROCESS-PANEL                           04540000
045500                                                                  04550000
045600         WHEN DP020-NEXT-ACT-RETURN                               04560000
045700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04570000
045800                                                                  04580000
045900         WHEN OTHER                                               04590000
046000             SET DP013-LOGIC-ABEND                                04600000
046100                 DP013-NO-ROLLBACK TO TRUE                        04610000
046200             MOVE '1000-CONTROL-PROCESSING'                       04620000
046300                                   TO DP013-PARAGRAPH             04630000
046400             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04640000
046500                                   TO DP013-MESSAGE-TEXT(1)       04650000
046600             MOVE DP020-NEXT-APPL-ACTIVITY                        04660000
046700                                   TO DP013-MESSAGE-TEXT(2)       04670000
046800             PERFORM DP013-0000-PROCESS-ABEND                     04680000
046900     END-EVALUATE.                                                04690000
047000                                                                  04700000
047100/                                                                 04710000
047200*----------------------------------------------------------------*04720000
047300*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *04730000
047400*    INTER-APPLICATION FORMAT CODE.                              *04740000
047500*----------------------------------------------------------------*04750000
047600 1100-PROCESS-INTER-APPL-COMM.                                    04760000
047700                                                                  04770000
047800     SET PS-COMMAREA-VALID            TO TRUE.                    04780000
047900                                                                  04790000
048000     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04800000
048100                                                                  04810000
048200     EVALUATE DP020-INT-APPL-FORMAT-IND                           04820000
048300         WHEN PC-INTER-APPL-PO-INQ                                04830000
048400             SET ASC-USE-SELECTION-QUEUE                          04840000
048500                                 TO TRUE                          04850000
048600             MOVE PO013-NUMBER-OF-SELECTED-ITEMS                  04860000
048700                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  04870000
048800             MOVE PO013-NUMBER-OF-TS-ITEMS                        04880000
048900                                 TO ASC-NUMBER-OF-TS-ITEMS        04890000
049000             MOVE PO013-SEL-QUEUE-NAME                            04900000
049100                                 TO ASC-SEL-QUEUE-NAME            04910000
049200             MOVE PO013-PO-NBR   TO ASC-KEY-PO-NBR                04920000
049300                                    DK-PO-NBR                     04930000
049400             MOVE PO013-DEPT-NBR TO ASC-KEY-DEPT-NBR              04940000
049500                                    DK-DEPT-NBR                   04950000
049600             MOVE PO013-ENT-ID   TO ASC-KEY-ENT-ID                04960000
049700                                    DK-ENT-ID                     04970000
049800             PERFORM 1125-GET-PO-TYP-CDE                          04980000
049900             PERFORM 1120-PREPARE-LIST-ENTRY                      04990000
050000                                                                  05000000
050100         WHEN PC-INTER-APPL-ITM-ADD-LST                           05010000
050200             IF PC000-NUMBER-OF-SELECTED-ITEMS = ZERO             05020000
050300                 SET ASC-NO-TSQ-UPDATE                            05030000
050400                                 TO TRUE                          05040000
050500                 SET DP020-MSG-FATAL                              05050000
050600                     DP020-NEXT-ACT-APPL-ERROR                    05060000
050700                     PS-ERROR    TO TRUE                          05070000
050800                 MOVE PC-TSYMSG-00057                             05080000
050900                                 TO DP020-MSG-NUMBER              05090000
051000             ELSE                                                 05100000
051100                 MOVE PC000-PO-NBR-N                              05110000
051200                                 TO ASC-KEY-PO-NBR                05120000
051300                                    DK-PO-NBR                     05130000
051400                 MOVE PC000-DEPT-NBR                              05140000
051500                                 TO ASC-KEY-DEPT-NBR              05150000
051600                                    DK-DEPT-NBR                   05160000
051700                 MOVE PC000-ENT-ID                                05170000
051800                                 TO ASC-KEY-ENT-ID                05180000
051900                                    DK-ENT-ID                     05190000
052000                 MOVE PC000-LINE-NBR-N                            05200000
052100                                 TO ASC-KEY-PO-LNE-NBR            05210000
052200                                    ASC-PO-LNE-NBR                05220000
052300                                                                  05230000
052400                 SET ASC-USE-SELECTION-QUEUE                      05240000
052500                                 TO TRUE                          05250000
052600                                                                  05260000
052700                 MOVE PC000-NUMBER-OF-SELECTED-ITEMS              05270000
052800                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  05280000
052900                 MOVE PC000-NUMBER-OF-TS-ITEMS                    05290000
053000                                 TO ASC-NUMBER-OF-TS-ITEMS        05300000
053100                 MOVE PC000-SEL-QUEUE-NAME                        05310000
053200                                 TO ASC-SEL-QUEUE-NAME            05320000
053300                 MOVE PC016-MAX-ITEMS                             05330000
053400                                 TO ASC-SEL-SUB                   05340000
053500                 MOVE ZERO       TO ASC-SEL-ITEM                  05350000
053600                 PERFORM 2400-GET-NEXT-WO-RECORD                  05360000
053700                 PERFORM 1125-GET-PO-TYP-CDE                      05370000
053800             END-IF                                               05380000
053900                                                                  05390000
054000         WHEN PC-INTER-APPL-ITM-ADD                               05400000
054100         WHEN PC-INTER-APPL-WO                                    05410000
054200             MOVE PC000-PO-NBR-N TO ASC-KEY-PO-NBR                05420000
054300                                    DK-PO-NBR                     05430000
054400             MOVE PC000-DEPT-NBR TO ASC-KEY-DEPT-NBR              05440000
054500                                    DK-DEPT-NBR                   05450000
054600             MOVE PC000-ENT-ID   TO ASC-KEY-ENT-ID                05460000
054700                                    DK-ENT-ID                     05470000
054800             MOVE PC000-LINE-NBR-N                                05480000
054900                                 TO ASC-KEY-PO-LNE-NBR            05490000
055000                                    ASC-PO-LNE-NBR                05500000
055100             PERFORM 1125-GET-PO-TYP-CDE                          05510000
055200                                                                  05520000
055300         WHEN OTHER                                               05530000
055400             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             05540000
055500             SET PS-ERROR                                         05550000
055600                 PS-COMMAREA-NOT-VALID                            05560000
055700                 DP020-MSG-FATAL                                  05570000
055800                 DP020-NEXT-ACT-APPL-ERROR                        05580000
055900                                 TO TRUE                          05590000
056000     END-EVALUATE.                                                05600000
056100                                                                  05610000
056200/                                                                 05620000
056300*----------------------------------------------------------------*05630000
056400* ENTRY IS FROM A LIST.  GET THE PO LIENENUMBER FROM THE TEMP    *05640000
056500* STORAGE QUEUE PASSED FROM THE LIST.                            *05650000
056600*----------------------------------------------------------------*05660000
056700 1120-PREPARE-LIST-ENTRY.                                         05670000
056800     MOVE PO012-MAX-ITEMS        TO ASC-SEL-SUB.                  05680000
056900     MOVE ZERO                   TO ASC-SEL-ITEM.                 05690000
057000     PERFORM 2110-GET-NEXT-PO-LNE.                                05700000
057100                                                                  05710000
057200                                                                  05720000
057300 1125-GET-PO-TYP-CDE.                                             05730000
057400                                                                  05740000
057500         EXEC SQL                                                 05750000
057600           SELECT   PO_TYP_CDE                                    05760000
057700                   ,PKGNG_CDE                                     05770000
057800              INTO :PURCHS-PO-TYP-CDE                             05780000
057900                  ,:PURCHS-PKGNG-CDE                              05790000
058000             FROM   TPURCHS                                       05800000
058100             WHERE PO_NBR = :DK-PO-NBR                            05810000
058200              AND  VER_STATUS_CDE = 'A'                           05820000
058300         END-EXEC                                                 05830000
058400                                                                  05840000
058500         EVALUATE TRUE                                            05850000
058600             WHEN SQLCODE = ZERO                                  05860000
058700                 MOVE PURCHS-PO-TYP-CDE TO ASC-PO-TYP-CDE         05870000
058800                 MOVE PURCHS-PKGNG-CDE  TO ASC-PKGNG-CDE          05880000
058900                 IF ASC-PO-TYP-CDE NOT = ('IM' AND 'IE' AND 'IF') 05890000
059000                     MOVE DP015-HL-OFF         TO AFIRCSTH        05900000
059100                     MOVE DP015-ASK-DRK-OFF    TO AFCSTNMA        05910000
059200                                                  AFIRCSTA        05920000
059300                 END-IF                                           05930000
059400             WHEN SQLCODE = -904                                  05940000
059500             WHEN SQLCODE = -913                                  05950000
059600             WHEN SQLWARN0 NOT = SPACES                           05960000
059700             WHEN SQLCODE < ZERO                                  05970000
059800             WHEN SQLCODE > ZERO                                  05980000
059900                 MOVE '1125-GET-PO-TYP-CDE'                       05990000
060000                                   TO DP013-PARAGRAPH             06000000
060100                 MOVE 'SELECT PO TYPE CODE  '                     06010000
060200                                   TO DP013-MESSAGE-TEXT (1)      06020000
060300                 MOVE SQLCA        TO DP013-SQLCA                 06030000
060400                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    06040000
060500                 SET DP013-DB2-ABEND                              06050000
060600                     DP013-XCTL-DISPLAY-RESTART                   06060000
060700                                   TO TRUE                        06070000
060800                 PERFORM DP013-0000-PROCESS-ABEND                 06080000
060900         END-EVALUATE.                                            06090000
061000/                                                                 06100000
061100*----------------------------------------------------------------*06110000
061200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06120000
061300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06130000
061400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06140000
061500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06150000
061600* FUNCTION KEYS CAN GET THIS FAR.                                *06160000
061700*----------------------------------------------------------------*06170000
061800                                                                  06180000
061900 2000-PROCESS-PANEL.                                              06190000
062000                                                                  06200000
062100     EVALUATE TRUE                                                06210000
062200                                                                  06220000
062300         WHEN DP020-SRC-AID = DP016-CLEAR                         06230000
062400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06240000
062500                                                                  06250000
062600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06260000
062700             SET DP030-DONT-ERASE                                 06270000
062800                 DP030-SEND-DATAONLY (PC-APPL-MAP)                06280000
062900                                   TO TRUE                        06290000
063000             PERFORM 4000-BUILD-INITIAL-PANEL                     06300000
063100                                                                  06310000
063200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06320000
063300             IF  ASC-USE-SELECTION-QUEUE                          06330000
063400                 IF ASC-INTER-APPL-ITM-ADD-LST                    06340000
063500                     PERFORM 2400-GET-NEXT-WO-RECORD              06350000
063600                 ELSE                                             06360000
063700                     PERFORM 2110-GET-NEXT-PO-LNE                 06370000
063800                 END-IF                                           06380000
063900                 IF PS-LIST-END                                   06390000
064000                    SET PS-LIST-NOT-END TO TRUE                   06400000
064100                 ELSE                                             06410000
064200                    PERFORM 4000-BUILD-INITIAL-PANEL              06420000
064300                 END-IF                                           06430000
064400             ELSE                                                 06440000
064500*                --- BOTTOM OF LIST ---                           06450000
064600                 MOVE PC-TSYMSG-00070                             06460000
064700                                   TO DP020-MSG-NUMBER            06470000
064800                 SET DP020-MSG-INFORMATIONAL                      06480000
064900                     PS-LIST-END   TO TRUE                        06490000
065000             END-IF                                               06500000
065100                                                                  06510000
065200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06520000
065300             IF  ASC-USE-SELECTION-QUEUE                          06530000
065400                 IF ASC-INTER-APPL-ITM-ADD-LST                    06540000
065500                     PERFORM 2410-GET-PREV-WO-RECORD              06550000
065600                 ELSE                                             06560000
065700                     PERFORM 2120-GET-PREV-PO-LNE                 06570000
065800                 END-IF                                           06580000
065900                 IF PS-LIST-END                                   06590000
066000                    SET PS-LIST-NOT-END TO TRUE                   06600000
066100                 ELSE                                             06610000
066200                    PERFORM 4000-BUILD-INITIAL-PANEL              06620000
066300               END-IF                                             06630000
066400             ELSE                                                 06640000
066500*                --- TOP OF LIST ---                              06650000
066600                 MOVE PC-TSYMSG-00069                             06660000
066700                                   TO DP020-MSG-NUMBER            06670000
066800                 SET DP020-MSG-INFORMATIONAL                      06680000
066900                     PS-LIST-END   TO TRUE                        06690000
067000             END-IF                                               06700000
067100                                                                  06710000
067200         WHEN OTHER                                               06720000
067300             PERFORM 2100-CHECK-FUNCTION-KEY                      06730000
067400                                                                  06740000
067500     END-EVALUATE.                                                06750000
067600                                                                  06760000
067700/                                                                 06770000
067800*----------------------------------------------------------------*06780000
067900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *06790000
068000* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *06800000
068100* FROM THE CICS ARCHITECTURE API.                                *06810000
068200*----------------------------------------------------------------*06820000
068300                                                                  06830000
068400 2100-CHECK-FUNCTION-KEY.                                         06840000
068500                                                                  06850000
068600     EVALUATE TRUE                                                06860000
068700         WHEN DP020-SRC-AID = DP016-ENTER                         06870000
068800             CONTINUE                                             06880000
068900                                                                  06890000
069000         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  06900000
069100             INITIALIZE PO013-INTER-APPL-COMMAREA                 06910000
069200             MOVE ASC-KEY-PO-NBR   TO PO013-PO-NBR                06920000
069300             MOVE ASC-KEY-PO-LNE-NBR                              06930000
069400                                   TO PO013-PO-LNE-NBR            06940000
069500             MOVE ASC-PO-LNE-NBR   TO PO013-PO-LNE-VAR-NBR        06950000
069600                                                                  06960000
069700         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               06970000
069800             COMPUTE PURITM-VER-NBR = ASC-VER-NBR - 1             06980000
069900             PERFORM 5000-BUILD-VER-PANEL                         06990000
070000                                                                  07000000
070100         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               07010000
070200             COMPUTE PURITM-VER-NBR = ASC-VER-NBR + 1             07020000
070300             PERFORM 5000-BUILD-VER-PANEL                         07030000
070400                                                                  07040000
070500         WHEN OTHER                                               07050000
070600             SET DP013-NO-ROLLBACK                                07060000
070700                 DP013-XCTL-DISPLAY-RESTART                       07070000
070800                 DP013-CICS-ABEND  TO TRUE                        07080000
070900             MOVE '2000-PROCESS-PANEL'                            07090000
071000                                   TO DP013-PARAGRAPH             07100000
071100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07110000
071200                                   TO DP013-MESSAGE-TEXT (1)      07120000
071300             PERFORM DP013-0000-PROCESS-ABEND                     07130000
071400                                                                  07140000
071500     END-EVALUATE.                                                07150000
071600                                                                  07160000
071700/                                                                 07170000
071800 2110-GET-NEXT-PO-LNE.                                            07180000
071900     ADD +1                        TO ASC-SEL-SUB.                07190000
072000     IF  ASC-SEL-SUB > PO012-MAX-ITEMS                            07200000
072100         ADD +1                    TO ASC-SEL-ITEM                07210000
072200         MOVE +1                   TO ASC-SEL-SUB                 07220000
072300     END-IF.                                                      07230000
072400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07240000
072500         PERFORM 9100-READ-SEL-QUEUE                              07250000
072600         IF  PO012-ITEM (ASC-SEL-SUB) > ZERO                      07260000
072700             INITIALIZE ASC-SCREEN-FIELDS                         07270000
072800             MOVE PO012-PO-LNE-NBR(ASC-SEL-SUB)                   07280000
072900                                   TO ASC-KEY-PO-LNE-NBR          07290000
073000             IF  PO012-PO-LNE-VAR-NBR(ASC-SEL-SUB) > ZEROES       07300000
073100                 MOVE PO012-PO-LNE-VAR-NBR(ASC-SEL-SUB)           07310000
073200                                   TO ASC-PO-LNE-NBR              07320000
073300             ELSE                                                 07330000
073400                 MOVE PO012-APP-PO-LNE-NBR(ASC-SEL-SUB)           07340000
073500                                   TO ASC-PO-LNE-NBR              07350000
073600             END-IF                                               07360000
073700             SET PO012-INQ (ASC-SEL-SUB)                          07370000
073800                                   TO TRUE                        07380000
073900             PERFORM 9200-REWRITE-LIST-QUEUE                      07390000
074000         ELSE                                                     07400000
074100             SUBTRACT +1 FROM ASC-SEL-SUB                         07410000
074200*            --- BOTTOM OF LIST ---                               07420000
074300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07430000
074400             SET DP020-MSG-INFORMATIONAL                          07440000
074500                 PS-LIST-END       TO TRUE                        07450000
074600         END-IF                                                   07460000
074700     ELSE                                                         07470000
074800         SUBTRACT +1 FROM ASC-SEL-ITEM                            07480000
074900         MOVE PO012-MAX-ITEMS      TO ASC-SEL-SUB                 07490000
075000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07500000
075100         SET DP020-MSG-INFORMATIONAL                              07510000
075200             PS-LIST-END           TO TRUE                        07520000
075300     END-IF.                                                      07530000
075400                                                                  07540000
075500/                                                                 07550000
075600 2120-GET-PREV-PO-LNE.                                            07560000
075700     SUBTRACT +1 FROM ASC-SEL-SUB.                                07570000
075800     IF  ASC-SEL-SUB < +1                                         07580000
075900         SUBTRACT +1 FROM ASC-SEL-ITEM                            07590000
076000         MOVE PO012-MAX-ITEMS      TO ASC-SEL-SUB                 07600000
076100     END-IF.                                                      07610000
076200*                                                                 07620000
076300     IF  ASC-SEL-ITEM > ZERO                                      07630000
076400         PERFORM 9100-READ-SEL-QUEUE                              07640000
076500         INITIALIZE ASC-SCREEN-FIELDS                             07650000
076600         MOVE PO012-PO-LNE-NBR(ASC-SEL-SUB)                       07660000
076700                                   TO ASC-KEY-PO-LNE-NBR          07670000
076800         IF  PO012-PO-LNE-VAR-NBR(ASC-SEL-SUB) > ZEROES           07680000
076900             MOVE PO012-PO-LNE-VAR-NBR(ASC-SEL-SUB)               07690000
077000                                   TO ASC-PO-LNE-NBR              07700000
077100         ELSE                                                     07710000
077200             MOVE PO012-APP-PO-LNE-NBR(ASC-SEL-SUB)               07720000
077300                                   TO ASC-PO-LNE-NBR              07730000
077400         END-IF                                                   07740000
077500         SET PO012-INQ (ASC-SEL-SUB)                              07750000
077600                                   TO TRUE                        07760000
077700         PERFORM 9200-REWRITE-LIST-QUEUE                          07770000
077800     ELSE                                                         07780000
077900         MOVE +1                   TO ASC-SEL-ITEM                07790000
078000                                      ASC-SEL-SUB                 07800000
078100*        --- TOP OF LIST ---                                      07810000
078200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07820000
078300         SET DP020-MSG-INFORMATIONAL                              07830000
078400             PS-LIST-END           TO TRUE                        07840000
078500     END-IF.                                                      07850000
078600                                                                  07860000
078700/                                                                 07870000
078800                                                                  07880000
078900******************************************************************07890000
079000* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE WO           *07900000
079100* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *07910000
079200******************************************************************07920000
079300 2400-GET-NEXT-WO-RECORD.                                         07930000
079400                                                                  07940000
079500     ADD +1                      TO ASC-SEL-SUB.                  07950000
079600                                                                  07960000
079700     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             07970000
079800         ADD +1                  TO ASC-SEL-ITEM                  07980000
079900         MOVE +1                 TO ASC-SEL-SUB                   07990000
080000     END-IF.                                                      08000000
080100                                                                  08010000
080200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 08020000
080300         PERFORM 9300-READ-WO-SEL-QUEUE                           08030000
080400         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       08040000
080500             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  08050000
080600                                   TO ASC-KEY-PO-LNE-NBR          08060000
080700                                      ASC-PO-LNE-NBR              08070000
080800             SET PC016-INQ (ASC-SEL-SUB)                          08080000
080900                                 TO TRUE                          08090000
081000             PERFORM 9400-REWRITE-WO-LIST-QUEUE                   08100000
081100         ELSE                                                     08110000
081200             SUBTRACT +1 FROM ASC-SEL-SUB                         08120000
081300*            --- BOTTOM OF LIST ---                               08130000
081400             MOVE PC-TSYMSG-00070                                 08140000
081500                                 TO DP020-MSG-NUMBER              08150000
081600             SET DP020-MSG-INFORMATIONAL                          08160000
081700                                 TO TRUE                          08170000
081800         END-IF                                                   08180000
081900     ELSE                                                         08190000
082000         SUBTRACT +1 FROM ASC-SEL-ITEM                            08200000
082100         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   08210000
082200         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              08220000
082300         SET DP020-MSG-INFORMATIONAL                              08230000
082400                                 TO TRUE                          08240000
082500     END-IF.                                                      08250000
082600                                                                  08260000
082700/                                                                 08270000
082800******************************************************************08280000
082900* GET THE KEYS OF THE PREVIOUS SELECTED WORK ORDER OBJECT FROM   *08290000
083000* THE INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                   *08300000
083100******************************************************************08310000
083200 2410-GET-PREV-WO-RECORD.                                         08320000
083300                                                                  08330000
083400     SUBTRACT +1 FROM ASC-SEL-SUB.                                08340000
083500                                                                  08350000
083600     IF ASC-SEL-SUB < +1                                          08360000
083700         SUBTRACT +1 FROM ASC-SEL-ITEM                            08370000
083800         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   08380000
083900     END-IF.                                                      08390000
084000                                                                  08400000
084100     IF ASC-SEL-ITEM > ZERO                                       08410000
084200         PERFORM 9300-READ-WO-SEL-QUEUE                           08420000
084300         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      08430000
084400                                 TO ASC-KEY-PO-LNE-NBR            08440000
084500                                    ASC-PO-LNE-NBR                08450000
084600     ELSE                                                         08460000
084700         MOVE +1                 TO ASC-SEL-ITEM                  08470000
084800                                    ASC-SEL-SUB                   08480000
084900*        --- TOP OF LIST ---                                      08490000
085000         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              08500000
085100         SET DP020-MSG-INFORMATIONAL                              08510000
085200                                 TO TRUE                          08520000
085300     END-IF.                                                      08530000
085400                                                                  08540000
085500*----------------------------------------------------------------*08550000
085600*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *08560000
085700*    ENTRY.                                                      *08570000
085800*----------------------------------------------------------------*08580000
085900                                                                  08590000
086000 4000-BUILD-INITIAL-PANEL.                                        08600000
086100                                                                  08610000
086200     SET DP030-SET-CURSOR-TRAILER                                 08620000
086300         PS-NO-ERROR             TO TRUE.                         08630000
086400                                                                  08640000
086500     MOVE ASC-KEY-PO-LNE-NBR     TO DK-PO-LNE-NBR.                08650000
086600     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    08660000
086700     MOVE ASC-KEY-DEPT-NBR       TO DK-DEPT-NBR.                  08670000
086800     MOVE ASC-KEY-ENT-ID         TO DK-ENT-ID.                    08680000
086900                                                                  08690000
087000     PERFORM 4010-GET-PRIMARY-ENT-NAME-DESC.                      08700000
087100                                                                  08710000
087200     PERFORM 4020-GET-PO-LNE-INFO.                                08720000
087300                                                                  08730000
087400     IF ASC-SKU-NBR (6:3) NOT EQUAL TO '000'                      08740033
087500       PERFORM 4030-GET-SKU-INFO                                  08750033
087600       PERFORM 4040-GET-UPC-INFO                                  08760033
087610     ELSE                                                         08761033
087620       MOVE +1               TO ASC-INNER-PACK-QTY                08762033
087621                                ASC-OUTER-PACK-QTY                08762133
087622       MOVE SPACES           TO ASC-BOXID                         08762233
087623       MOVE PC-NO-VENDOR-UPC TO ASC-UPC-NBR                       08762333
087624     END-IF.                                                      08762433
087700                                                                  08770000
087800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08780000
087900                                                                  08790000
088000/                                                                 08800000
088100*----------------------------------------------------------------*08810000
088200*  RETRIEVE THE PRIMARY VENDOR NAME                               08820000
088300*----------------------------------------------------------------*08830000
088400                                                                  08840000
088500 4010-GET-PRIMARY-ENT-NAME-DESC.                                  08850000
088600                                                                  08860000
088700     PERFORM                                                      08870000
088800         WITH TEST AFTER                                          08880000
088900         VARYING PV-RETRY-COUNTER                                 08890000
089000         FROM 1 BY 1                                              08900000
089100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08910000
089200             OR (SQLCODE = +0))                                   08920000
089300                                                                  08930000
089400         EXEC SQL                                                 08940000
089500              SELECT ENT_NAME_DESC                                08950000
089600                INTO :ENTNME-ENT-NAME-DESC                        08960000
089700                FROM TENTNME                                      08970000
089800               WHERE ENT_ID   = :DK-ENT-ID                        08980000
089900                 AND TYPE_CDE = '01'                              08990000
090000         END-EXEC                                                 09000000
090100                                                                  09010000
090200         EVALUATE TRUE                                            09020000
090300             WHEN SQLCODE = +0                                    09030000
090400                  MOVE ENTNME-ENT-NAME-DESC                       09040000
090500                                  TO ASC-KEY-ENT-NAME-DESC        09050000
090600             WHEN SQLCODE = -904                                  09060000
090700             WHEN SQLCODE = -913                                  09070000
090800                  CONTINUE                                        09080000
090900                                                                  09090000
091000             WHEN SQLWARN0 NOT = SPACES                           09100000
091100             WHEN SQLCODE < +0                                    09110000
091200             WHEN SQLCODE > +0                                    09120000
091300                  MOVE '4010-GET-PRIMARY-ENT-NAME-DESC'           09130000
091400                                  TO DP013-PARAGRAPH              09140000
091500                  MOVE 'UNSUCCESSFUL SELECT ENTERPRISE NAME'      09150000
091600                                  TO DP013-MESSAGE-TEXT (1)       09160000
091700                  MOVE SQLCA      TO DP013-SQLCA                  09170000
091800                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     09180000
091900                  SET DP013-DB2-ABEND                             09190000
092000                      DP013-XCTL-DISPLAY-RESTART                  09200000
092100                                  TO TRUE                         09210000
092200                  PERFORM DP013-0000-PROCESS-ABEND                09220000
092300         END-EVALUATE                                             09230000
092400     END-PERFORM.                                                 09240000
092500                                                                  09250000
092600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09260000
092700         MOVE '4010-GET-PRIMARY-NAME'                             09270000
092800                                  TO DP013-PARAGRAPH              09280000
092900         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    09290000
093000                                  TO DP013-MESSAGE-TEXT (1)       09300000
093100         MOVE SQLCA               TO DP013-SQLCA                  09310000
093200         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (1)     09320000
093300         SET DP013-DB2-ABEND                                      09330000
093400             DP013-XCTL-DISPLAY-RESTART                           09340000
093500                                  TO TRUE                         09350000
093600         PERFORM DP013-0000-PROCESS-ABEND                         09360000
093700     END-IF.                                                      09370000
093800                                                                  09380000
093900/                                                                 09390000
094000*----------------------------------------------------------------*09400000
094100* SELECT A ROW FROM THE DB2 TPURITM TABLE.                       *09410000
094200*----------------------------------------------------------------*09420000
094300 4020-GET-PO-LNE-INFO.                                            09430000
094400                                                                  09440000
094410     INITIALIZE DCLXLT00003                                       09441033
094411                DCLXLT00004                                       09441133
094412                DCLTPURITM                                        09441233
094413                PV-NULL-INDICATORS.                               09441333
094414     MOVE DK-PO-NBR     TO PURITM-PO-NBR                          09441433
094415     MOVE DK-PO-LNE-NBR TO PURITM-PO-LNE-NBR                      09441533
094500     PERFORM                                                      09450000
094600         WITH TEST AFTER                                          09460000
094700         VARYING PV-RETRY-COUNTER                                 09470000
094800         FROM 1 BY 1                                              09480000
094900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09490000
095000             OR (SQLCODE = +0))                                   09500000
095100                                                                  09510000
095200         EXEC SQL                                                 09520000
095300             SELECT SKU_NBR                                       09530033
095400                   ,MAJ_CL_NBR                                    09540033
095500                   ,SUB_CL_NBR                                    09550033
095510                   ,VS_NBR                                        09551033
095520                   ,CL_NBR                                        09552033
095530                   ,SKU_SEQ_NBR                                   09553033
095540                   ,VEND_STYL_NAME                                09554033
095600                   ,AD_EVNT_DTE                                   09560000
095700                   ,NRF_CLOR_CDE                                  09570033
095800                   ,CSTM_CLOR_DESC                                09580033
095900                   ,KOHLS_SIZE_CDE                                09590033
096000                   ,B.SIZE_DESC                                   09600033
096100                   ,B.SKU_DESC                                    09610033
096110                   ,COLOR_CDE                                     09611033
096120                   ,COLOR_DESC                                    09612033
096130                   ,SIZE_CDE                                      09613033
096140                   ,A.SIZE_DESC                                   09614033
096150                   ,A.SKU_DESC                                    09615033
096200                   ,UNT_QTY                                       09620000
096300                   ,UM_IND                                        09630000
096400                   ,UNT_COST_AMT                                  09640000
096500                   ,TOT_VAL_COST_AMT                              09650000
096600                   ,UNT_RTL_PR_AMT                                09660000
096700                   ,TOT_VAL_RTL_AMT                               09670000
096800                   ,MU_PCT                                        09680000
096900                   ,GP_RTL_AMT                                    09690000
097000                   ,GP_QTY                                        09700000
097100                   ,VER_NBR                                       09710000
097200                   ,VER_STATUS_CDE                                09720000
097300                   ,A.LAST_UPD_TMST                               09730032
097400                   ,LAST_UPD_BY_UID                               09740000
097500                   ,PIC_ITM_IND                                   09750000
097600                   ,PIC_PG_NBR                                    09760000
097700                   ,PRD_1ST_COST_AMT                              09770000
097710                   ,A.INNR_PK_QTY                                 09771036
097720                   ,A.OUTR_PK_QTY                                 09772036
097800             INTO   :XLT00003-SKU-NBR:PV-SKU-NBR-IND              09780033
097900                   ,:XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND        09790033
098000                   ,:XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND        09800033
098010                   ,:XLT00004-VS-NBR:PV-VS-NBR-IND                09801033
098020                   ,:PURITM-CL-NBR                                09802033
098030                   ,:PURITM-SKU-SEQ-NBR                           09803033
098040                   ,:PURITM-VEND-STYL-NAME                        09804033
098100                   ,:PURITM-AD-EVNT-DTE                           09810000
098110                   ,:XLT00003-NRF-CLOR-CDE:PV-NRF-CLOR-CDE-IND    09811033
098120                   ,:XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND09812033
098130                   ,:XLT00003-KOHLS-SIZE-CDE:PV-KOHLS-SIZE-CDE-IND09813033
098140                   ,:XLT00003-SIZE-DESC:PV-SIZE-DESC-IND          09814033
098150                   ,:XLT00003-SKU-DESC:PV-SKU-DESC-IND            09815033
098160                   ,:PURITM-COLOR-CDE                             09816033
098170                   ,:PURITM-COLOR-DESC                            09817033
098180                   ,:PURITM-SIZE-CDE                              09818033
098190                   ,:PURITM-SIZE-DESC                             09819033
098200                   ,:PURITM-SKU-DESC                              09820033
098700                   ,:PURITM-UNT-QTY                               09870000
098800                   ,:PURITM-UM-IND                                09880000
098900                   ,:PURITM-UNT-COST-AMT                          09890000
099000                   ,:PURITM-TOT-VAL-COST-AMT                      09900000
099100                   ,:PURITM-UNT-RTL-PR-AMT                        09910000
099200                   ,:PURITM-TOT-VAL-RTL-AMT                       09920000
099300                   ,:PURITM-MU-PCT                                09930000
099400                   ,:PURITM-GP-RTL-AMT                            09940000
099500                   ,:PURITM-GP-QTY                                09950000
099600                   ,:PURITM-VER-NBR                               09960000
099700                   ,:PURITM-VER-STATUS-CDE                        09970000
099800                   ,:PURITM-LAST-UPD-TMST                         09980000
099900                   ,:PURITM-LAST-UPD-BY-UID                       09990000
100000                   ,:PURITM-PIC-ITM-IND                           10000000
100100                   ,:PURITM-PIC-PG-NBR                            10010000
100200                   ,:PURITM-PRD-1ST-COST-AMT                      10020000
100210                   ,:PURITM-INNR-PK-QTY                           10021035
100220                   ,:PURITM-OUTR-PK-QTY                           10022035
100300             FROM  TPURITM A                                      10030033
100310             LEFT OUTER JOIN                                      10031033
100320                   XLT_SKU B                                      10032033
100321             ON    A.ITM_NBR = B.ITM_NBR                          10032133
100322             LEFT OUTER JOIN                                      10032233
100323                   XLT_VND_STYL  C                                10032333
100324             ON    B.STYL_ID = C.STYL_ID                          10032433
100325             WHERE PO_NBR         = :PURITM-PO-NBR                10032533
100326               AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR            10032633
100600               AND VER_STATUS_CDE = 'A'                           10060000
100700         END-EXEC                                                 10070000
100800                                                                  10080000
100900         EVALUATE TRUE                                            10090000
101000                                                                  10100000
101100             WHEN SQLCODE = +0                                    10110000
101200                 IF PV-SKU-NBR-IND = +0                           10120033
101300                   MOVE XLT00004-MAJ-CL-NBR TO PV-MAJ-CL-NBR      10130033
101400                   MOVE PV-MAJ-CL-NBR       TO ASC-MAJ-CL-NBR     10140033
101500                   MOVE XLT00004-SUB-CL-NBR TO PV-SUB-CL-NBR      10150033
101510                   MOVE PV-SUB-CL-NBR       TO ASC-SUB-CL-NBR     10151033
101520                   MOVE XLT00003-SKU-NBR    TO PV-SKU-NBR         10152033
101530                   MOVE PV-SKU-NBR          TO ASC-SKU-NBR        10153033
101540                   MOVE XLT00004-VS-NBR     TO ASC-VEND-STYL-NAME 10154033
101550                   MOVE XLT00003-NRF-CLOR-CDE                     10155033
101560                                            TO ASC-COLOR          10156033
101570                   MOVE XLT00003-CSTM-CLOR-DESC                   10157033
101571                                            TO ASC-COLOR-DESC     10157133
101572                   MOVE XLT00003-KOHLS-SIZE-CDE                   10157233
101573                                            TO PV-SIZE            10157333
101574                   MOVE PV-SIZE             TO ASC-SIZE           10157433
101575                   MOVE XLT00003-SIZE-DESC  TO ASC-SIZE-DESC      10157533
101576                   MOVE XLT00003-SKU-DESC   TO ASC-SKU-DESC       10157633
101577                 ELSE                                             10157733
101578                   MOVE PURITM-CL-NBR       TO ASC-SUB-CL-NBR     10157833
101579                   MOVE PURITM-CL-NBR (1:1) TO PV-MAJ-CL-1        10157933
101580                   MOVE PV-MAJ-CL-NBR       TO ASC-MAJ-CL-NBR     10158033
101590                   MOVE ASC-KEY-DEPT-NBR    TO PV-SKU-DEPT        10159033
101591                   MOVE PURITM-CL-NBR       TO PV-SKU-CLASS       10159133
101592                   MOVE PURITM-SKU-SEQ-NBR  TO PV-SKU-SEQ         10159233
101593                   MOVE PV-SKU-NBR          TO ASC-SKU-NBR        10159333
101594                   MOVE PURITM-VEND-STYL-NAME                     10159433
101595                                            TO ASC-VEND-STYL-NAME 10159533
101596                   MOVE PURITM-COLOR-CDE    TO ASC-COLOR          10159633
101597                   MOVE PURITM-COLOR-DESC   TO ASC-COLOR-DESC     10159733
101598                   MOVE PURITM-SIZE-CDE     TO PV-SIZE-4-9        10159833
101599                   MOVE PV-SIZE             TO ASC-SIZE           10159933
101600                   MOVE PURITM-SIZE-DESC    TO ASC-SIZE-DESC      10160033
101601                   MOVE PURITM-SKU-DESC     TO ASC-SKU-DESC       10160133
101602                 END-IF                                           10160233
101610                 MOVE PURITM-AD-EVNT-DTE  TO PV-AD-DATE-10        10161000
101700                 IF  PV-AD-DATE-10 = '0001-01-01'                 10170000
101800                     MOVE SPACES          TO ASC-AD-EVENT-DATE    10180000
101900                 ELSE                                             10190000
102000                     MOVE PV-AD-DATE-CC   TO PV-SL-DATE-CC        10200000
102100                     MOVE PV-AD-DATE-YY   TO PV-SL-DATE-YY        10210000
102200                     MOVE PV-AD-DATE-MM   TO PV-SL-DATE-MM        10220000
102300                     MOVE PV-AD-DATE-DD   TO PV-SL-DATE-DD        10230000
102400                     MOVE PV-SLASH-DATE   TO ASC-AD-EVENT-DATE    10240000
102500                 END-IF                                           10250000
102600                 MOVE PURITM-PIC-ITM-IND  TO ASC-PIC-IND          10260000
102700                 MOVE PURITM-PIC-PG-NBR   TO ASC-PAGE-NBR         10270000
103300                 MOVE PURITM-UNT-QTY      TO ASC-UNT-QTY          10330000
103400                 MOVE PURITM-UM-IND       TO ASC-UOM              10340000
103500                 MOVE PURITM-UNT-COST-AMT TO ASC-UNT-COST-AMT     10350000
103600                 MOVE PURITM-TOT-VAL-COST-AMT                     10360000
103700                                          TO ASC-TOT-VAL-COST-AMT 10370000
103800                 MOVE PURITM-UNT-RTL-PR-AMT                       10380000
103900                                          TO ASC-UNT-RTL-PR-AMT   10390000
104000                 MOVE PURITM-TOT-VAL-RTL-AMT                      10400000
104100                                          TO ASC-TOT-VAL-RTL-AMT  10410000
104200                 MOVE PURITM-MU-PCT       TO ASC-MU-PCT           10420000
104300                 MOVE PURITM-GP-RTL-AMT   TO ASC-GP-RTL-AMT       10430000
104400                 MOVE PURITM-GP-QTY       TO ASC-GP-QTY           10440000
104500                 MOVE PURITM-VER-NBR      TO ASC-VER-NBR          10450000
104600                 MOVE PURITM-VER-STATUS-CDE                       10460000
104700                                          TO ASC-VER-STATUS-CDE   10470000
104800                 MOVE PURITM-LAST-UPD-TMST                        10480000
104900                                          TO ASC-LAST-UPD-TMST    10490000
105000                 MOVE PURITM-LAST-UPD-BY-UID                      10500000
105100                                          TO ASC-LAST-UPD-BY-UID  10510000
C66632        COMPUTE ASC-FIRST-COST ROUNDED = PURITM-PRD-1ST-COST-AMT  10511044
105400                                                                  10540000
105410**GB 3/25/12 WR3372A  BEG                                         10541035
105420                 MOVE PURITM-INNR-PK-QTY  TO PV-INNR-PACK-QTY     10542035
105430                 MOVE PURITM-OUTR-PK-QTY  TO PV-OUTR-PACK-QTY     10543035
105440                 MOVE PV-INNR-PACK-QTY                            10544035
105450                                    TO ASC-INNER-PACK-QTY         10545035
105460                 MOVE PV-OUTR-PACK-QTY                            10546035
105470                                    TO ASC-OUTER-PACK-QTY         10547035
105480                IF PURITM-INNR-PK-QTY   = ZEROES                  10548035
105490                   MOVE +1          TO ASC-INNER-PACK-QTY         10549035
105491                END-IF                                            10549135
105492                IF PURITM-OUTR-PK-QTY     = ZEROES                10549235
105493                   MOVE +1          TO ASC-OUTER-PACK-QTY         10549335
105494                END-IF                                            10549435
105495**GB 3/25/12 WR3372A  END                                         10549535
105500             WHEN SQLCODE = -904                                  10550000
105600             WHEN SQLCODE = -913                                  10560000
105700                 CONTINUE                                         10570000
105800             WHEN SQLWARN0 NOT = SPACES                           10580000
105900             WHEN SQLCODE < +0                                    10590000
106000             WHEN SQLCODE > +0                                    10600000
106100                 MOVE '4020-GET-PO-LNE-INFO'                      10610000
106200                                 TO DP013-PARAGRAPH               10620000
106300                 MOVE 'SELECT PO-LNE INFO  '                      10630000
106400                                 TO DP013-MESSAGE-TEXT (1)        10640000
106500                 MOVE SQLCA      TO DP013-SQLCA                   10650000
106600                 MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (1)      10660000
106610                 MOVE ' XLT_SKU' TO DP013-DB2-TABLE-NAME (2)      10661000
106620                 MOVE ' XLT_VND_STYL'                             10662000
106630                                 TO DP013-DB2-TABLE-NAME (3)      10663000
106700                 SET DP013-DB2-ABEND                              10670000
106800                     DP013-XCTL-DISPLAY-RESTART                   10680000
106900                                 TO TRUE                          10690000
107000                 PERFORM DP013-0000-PROCESS-ABEND                 10700000
107100         END-EVALUATE                                             10710000
107200     END-PERFORM.                                                 10720000
107300                                                                  10730000
107400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10740000
107500         MOVE '4020-GET-PO-LNE-INFO'                              10750000
107600                                 TO DP013-PARAGRAPH               10760000
107700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10770000
107800                                 TO DP013-MESSAGE-TEXT (1)        10780000
107900         MOVE 'PO LINE INFO '    TO DP013-MESSAGE-TEXT (2)        10790000
108000         MOVE SQLCA              TO DP013-SQLCA                   10800000
108100         MOVE 'TPURITM'          TO DP013-DB2-TABLE-NAME (1)      10810000
108110         MOVE ' XLT_SKU'         TO DP013-DB2-TABLE-NAME (2)      10811000
108120         MOVE ' XLT_VND_STYL'    TO DP013-DB2-TABLE-NAME (3)      10812000
108200         SET DP013-DB2-ABEND                                      10820000
108300             DP013-XCTL-DISPLAY-RESTART                           10830000
108400                                   TO TRUE                        10840000
108500         PERFORM DP013-0000-PROCESS-ABEND                         10850000
108600     END-IF.                                                      10860000
108700                                                                  10870000
108800/                                                                 10880000
108900*----------------------------------------------------------------*10890000
109000* SELECT A ROW FROM THE DB2 TSK     TABLE.                       *10900000
109100*----------------------------------------------------------------*10910000
109200 4030-GET-SKU-INFO.                                               10920000
109300                                                                  10930000
109400     PERFORM                                                      10940000
109500         WITH TEST AFTER                                          10950000
109600         VARYING PV-RETRY-COUNTER                                 10960000
109700         FROM 1 BY 1                                              10970000
109800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10980000
109900             OR (SQLCODE = 0)                                     10990000
110000             OR (SQLCODE = +100))                                 11000000
110100                                                                  11010000
111310         EXEC SQL                                                 11131000
111340             SELECT STKR_NBR                                      11134033
111370             INTO   :XLT00004-STKR-NBR                            11137034
111380             FROM   XLT_SKU A,                                    11138000
111390                    XLT_VND_STYL  B                               11139000
111391             WHERE A.SKU_NBR = :XLT00003-SKU-NBR                  11139100
111392               AND A.STYL_ID = B.STYL_ID                          11139200
111393         END-EXEC                                                 11139300
111400                                                                  11140000
111500         EVALUATE TRUE                                            11150000
111600                                                                  11160000
111700             WHEN SQLCODE = +0                                    11170000
112810                 IF XLT00004-STKR-NBR = ZEROES                    11281000
112900                    MOVE SPACES          TO ASC-BOXID             11290000
113000                 ELSE                                             11300000
113110                    MOVE XLT00004-STKR-NBR  TO PV-STKR-NBR        11311000
113120                    MOVE PV-STKR-NBR(2:3)   TO ASC-BOXID          11312031
113200                 END-IF                                           11320000
113300             WHEN SQLCODE = +100                                  11330000
113400             WHEN SQLCODE = -811                                  11340000
113500             WHEN SQLCODE = -904                                  11350000
113600             WHEN SQLCODE = -913                                  11360000
113700                 CONTINUE                                         11370000
113800                                                                  11380000
113900             WHEN SQLWARN0 NOT = SPACES                           11390000
114000             WHEN SQLCODE < +0                                    11400000
114100             WHEN SQLCODE > +0                                    11410000
114200                 MOVE '4030-GET-SKU-INFO'                         11420000
114300                                 TO DP013-PARAGRAPH               11430000
114400                 MOVE 'SELECT SKU INFO  '                         11440000
114500                                 TO DP013-MESSAGE-TEXT (1)        11450000
114600                 MOVE SQLCA      TO DP013-SQLCA                   11460000
114700                 MOVE 'TSK'      TO DP013-DB2-TABLE-NAME (1)      11470000
114710                 MOVE ' XLT_SKU' TO DP013-DB2-TABLE-NAME (2)      11471000
114720                 MOVE ' XLT_VND_STYL'                             11472000
114730                                 TO DP013-DB2-TABLE-NAME (3)      11473000
114800                 SET DP013-DB2-ABEND                              11480000
114900                     DP013-XCTL-DISPLAY-RESTART                   11490000
115000                                 TO TRUE                          11500000
115100                 PERFORM DP013-0000-PROCESS-ABEND                 11510000
115200         END-EVALUATE                                             11520000
115300     END-PERFORM.                                                 11530000
115400                                                                  11540000
115500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11550000
115600         MOVE '4030-GET-SKU-INFO'                                 11560000
115700                                 TO DP013-PARAGRAPH               11570000
115800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11580000
115900                                 TO DP013-MESSAGE-TEXT (1)        11590000
116000         MOVE 'SKU INFO '        TO DP013-MESSAGE-TEXT (2)        11600000
116100         MOVE SQLCA              TO DP013-SQLCA                   11610000
116210         MOVE ' XLT_SKU'         TO DP013-DB2-TABLE-NAME (1)      11621000
116220         MOVE ' XLT_VND_STYL'    TO DP013-DB2-TABLE-NAME (2)      11622000
116300         SET DP013-DB2-ABEND                                      11630000
116400             DP013-XCTL-DISPLAY-RESTART                           11640000
116500                                 TO TRUE                          11650000
116600         PERFORM DP013-0000-PROCESS-ABEND                         11660000
116700     END-IF.                                                      11670000
116800                                                                  11680000
116900/                                                                 11690000
117000 4040-GET-UPC-INFO.                                               11700000
117100                                                                  11710000
117200     PERFORM                                                      11720000
117300         WITH TEST AFTER                                          11730000
117400         VARYING PV-RETRY-COUNTER                                 11740000
117500         FROM 1 BY 1                                              11750000
117600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11760000
117700             OR (SQLCODE = 0)                                     11770000
117800             OR (SQLCODE = +100)                                  11780000
117900             OR (SQLCODE = -811))                                 11790000
118000                                                                  11800000
118100         EXEC SQL                                                 11810000
118200             SELECT DISTINCT                                      11820000
118300                  A.UPC_NBR                                       11830000
118610              INTO :XLT00006-UPC-NBR                              11861000
118620              FROM XLT_UPC A                                      11862000
118630                  ,XLT_SKU B                                      11863000
119010             WHERE B.SKU_NBR          = :XLT00003-SKU-NBR         11901000
119020               AND A.INTR_UPC_ID      = B.INTR_UPC_ID             11902000
119100               AND UPC_TYP_CDE        = 'V'                       11910000
119300         END-EXEC                                                 11930000
119400                                                                  11940000
119500         EVALUATE TRUE                                            11950000
119600         WHEN SQLCODE = +0                                        11960000
119710           MOVE XLT00006-UPC-NBR TO PV-UPC-NBR                    11971000
119800           STRING PV-UPC-NBR-X(3:2)  DELIMITED BY SIZE            11980000
119900                  '-'                DELIMITED BY SIZE            11990000
120000                  PV-UPC-NBR-X(5:5)  DELIMITED BY SIZE            12000000
120100                  '-'                DELIMITED BY SIZE            12010000
120200                  PV-UPC-NBR-X(10:5) DELIMITED BY SIZE            12020000
120300                  '-'                DELIMITED BY SIZE            12030000
120400                  PV-UPC-NBR-X(15:1) DELIMITED BY SIZE            12040000
120500                               INTO ASC-UPC-NBR                   12050000
120600                                                                  12060000
120700         WHEN SQLCODE = +100                                      12070000
120800           MOVE PC-NO-VENDOR-UPC TO ASC-UPC-NBR                   12080000
120900                                                                  12090000
121000         WHEN SQLCODE = -811                                      12100000
121100           MOVE PC-MULTIPLE-UPC  TO ASC-UPC-NBR                   12110000
121200                                                                  12120000
121300             WHEN SQLCODE = -904                                  12130000
121400             WHEN SQLCODE = -913                                  12140000
121500                 CONTINUE                                         12150000
121600                                                                  12160000
121700             WHEN SQLWARN0 NOT = SPACES                           12170000
121800             WHEN SQLCODE < +0                                    12180000
121900             WHEN SQLCODE > +0                                    12190000
122000                 MOVE '4040-GET-UPC-INFO'                         12200000
122100                                   TO DP013-PARAGRAPH             12210000
122200                 MOVE 'SELECT UPC INFO  '                         12220000
122300                                   TO DP013-MESSAGE-TEXT (1)      12230000
122400                 MOVE SQLCA        TO DP013-SQLCA                 12240000
122610                 MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (1)    12261000
122620                 MOVE 'XLT_VND_STYL'                              12262000
122630                                   TO DP013-DB2-TABLE-NAME (2)    12263000
122700                 SET DP013-DB2-ABEND                              12270000
122800                     DP013-XCTL-DISPLAY-RESTART                   12280000
122900                                   TO TRUE                        12290000
123000                 PERFORM DP013-0000-PROCESS-ABEND                 12300000
123100         END-EVALUATE                                             12310000
123200     END-PERFORM.                                                 12320000
123300                                                                  12330000
123400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12340000
123500         MOVE '4040-GET-UPC-INFO'                                 12350000
123600                                 TO DP013-PARAGRAPH               12360000
123700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     12370000
123800                                 TO DP013-MESSAGE-TEXT (1)        12380000
123900         MOVE 'UPC INFO '        TO DP013-MESSAGE-TEXT (2)        12390000
124000         MOVE SQLCA              TO DP013-SQLCA                   12400000
124210         MOVE 'XLT_SKU'          TO DP013-DB2-TABLE-NAME (1)      12421000
124220         MOVE 'XLT_VND_STYL'     TO DP013-DB2-TABLE-NAME (2)      12422000
124300         SET DP013-DB2-ABEND                                      12430000
124400             DP013-XCTL-DISPLAY-RESTART                           12440000
124500                                 TO TRUE                          12450000
124600         PERFORM DP013-0000-PROCESS-ABEND                         12460000
124700     END-IF.                                                      12470000
124800                                                                  12480000
124900/                                                                 12490000
125000*----------------------------------------------------------------*12500000
125100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12510000
125200*----------------------------------------------------------------*12520000
125300                                                                  12530000
125400 4400-MOVE-COMMAREA-TO-SCREEN.                                    12540000
125500                                                                  12550000
125600     MOVE ASC-KEY-PO-NBR         TO APONUMO.                      12560000
125700     MOVE ASC-KEY-DEPT-NBR       TO ADEPTO                        12570000
125800                                    ADPTDO.                       12580000
125900     MOVE ASC-KEY-ENT-NAME-DESC  TO AVENDNMO.                     12590000
126000                                                                  12600000
126100     MOVE ASC-PO-LNE-NBR         TO ALNEO.                        12610000
126110                                                                  12611000
126111     PERFORM 4450-CHECK-TWEBUPC                                   12611100
126112                                                                  12611200
126113     IF PV-DB2-COUNT > 0                                          12611300
126114        MOVE DP015-RED  TO ADPTDC                                 12611400
126115                           AMCLC                                  12611500
126116                           ACLSC                                  12611600
126118                           ASKUC                                  12611800
126119     ELSE                                                         12611900
126120        MOVE DP015-BLUE TO ADPTDC                                 12612000
126121                           AMCLC                                  12612100
126122                           ACLSC                                  12612200
126124                           ASKUC                                  12612400
126125     END-IF                                                       12612500
126130                                                                  12613000
126140     MOVE ASC-MAJ-CL-NBR         TO AMCLO.                        12614000
126210     MOVE ASC-SUB-CL-NBR         TO ACLSO.                        12621000
126330     MOVE ASC-SKU-NBR            TO ASKUO.                        12633000
126400     MOVE ASC-VEND-STYL-NAME     TO ASTYLEO.                      12640000
126500     MOVE ASC-SKU-DESC           TO ADESCO.                       12650000
126600     MOVE ASC-AD-DATE            TO AADATEO.                      12660000
126700     MOVE ASC-PIC-IND            TO APICINDO.                     12670000
126800     MOVE ASC-PAGE-NBR           TO APGENBRO.                     12680000
126900     MOVE ASC-COLOR              TO ACOLRO.                       12690000
127000     MOVE ASC-COLOR-DESC         TO ACLDSCRO.                     12700000
127100     MOVE ASC-SIZE               TO ASIZEO.                       12710000
127200     MOVE ASC-SIZE-DESC          TO ASZDSCRO.                     12720000
127300     MOVE ASC-UNT-QTY            TO AQNTYO.                       12730000
127400     MOVE ASC-UNT-COST-AMT       TO AUCOSTO.                      12740000
127500     MOVE ASC-FIRST-COST         TO AFIRCSTO.                     12750000
127600     MOVE ASC-UOM                TO AUOMO.                        12760000
127700     MOVE ASC-TOT-VAL-COST-AMT   TO ATOTCSTO.                     12770000
127800     MOVE ASC-UNT-RTL-PR-AMT     TO AURETO.                       12780000
127900     MOVE ASC-TOT-VAL-RTL-AMT    TO ATOTRETO.                     12790000
128000     MOVE ASC-MU-PCT             TO AMARKUPO.                     12800000
128100     MOVE ASC-UPC-NBR            TO AUPCO.                        12810000
128200     IF ASC-PKGNG-CDE = 'M' OR 'I'                                12820000
128300        MOVE ZEROES              TO AIPKQTYO                      12830000
128400                                    AOPKQTYO                      12840000
128500     ELSE                                                         12850000
128600        MOVE ASC-INNER-PACK-QTY     TO AIPKQTYO                   12860000
128700        MOVE ASC-OUTER-PACK-QTY     TO AOPKQTYO                   12870000
128800     END-IF.                                                      12880000
128900                                                                  12890000
129000     IF  ASC-GP-QTY > 1                                           12900000
129100         MOVE ASC-GP-QTY         TO AGRPQTYO                      12910000
129200         MOVE ASC-GP-RTL-AMT     TO AGRPRETO                      12920000
129300     ELSE                                                         12930000
129400         MOVE ZEROES             TO AGRPQTYO                      12940000
129500                                    AGRPRETO                      12950000
129600     END-IF.                                                      12960000
129700     IF ASC-VER-STATUS-CDE = 'A'                                  12970000
129800         MOVE 'ACTIVE'           TO AVERSTO                       12980000
129900     ELSE                                                         12990000
130000         MOVE 'INACTIVE'         TO AVERSTO                       13000000
130100     END-IF.                                                      13010000
130200     MOVE ASC-LAST-UPD-TMST      TO PV-TMST-BREAK.                13020000
130300     MOVE PV-TMSTB-YY            TO PV-DATE-YY.                   13030000
130400     MOVE PV-TMSTB-MM            TO PV-DATE-MM.                   13040000
130500     MOVE PV-TMSTB-DD            TO PV-DATE-DD.                   13050000
130600     MOVE PV-TMSTB-HH            TO PV-TIME-HH.                   13060000
130700     MOVE PV-TMSTB-MN            TO PV-TIME-MM.                   13070000
130800     MOVE PV-TMSTB-SS            TO PV-TIME-SS.                   13080000
130900     MOVE PV-DATE-DISPLAY        TO ACHGDTO.                      13090000
131000     MOVE PV-TIME-DISPLAY        TO ACHGTMO.                      13100000
131100     MOVE ASC-LAST-UPD-BY-UID    TO WORKER-UID-NBR.               13110000
131200     PERFORM 4499-GET-TWORKER.                                    13120000
131300     IF  SQLCODE = +0                                             13130000
131400         MOVE 17                 TO DP024-FLNAME-LENGTH           13140000
131500         MOVE WORKER-LAST-NAME   TO DP024-LNAME                   13150000
131600         MOVE WORKER-FIR-NAME    TO DP024-FNAME                   13160000
131700         PERFORM DP024-0000-FORMAT-NAME                           13170000
131800         MOVE DP024-FLNAME       TO ACHGBYO                       13180000
131900     ELSE                                                         13190000
132000         MOVE SPACES             TO ACHGBYO                       13200000
132100     END-IF.                                                      13210000
132200                                                                  13220000
132300     IF ASC-PO-TYP-CDE NOT = ('IM' AND 'IE' AND 'IF')             13230000
132400         MOVE DP015-HL-OFF         TO AFIRCSTH                    13240000
132500         MOVE DP015-ASK-DRK-OFF    TO AFCSTNMA                    13250000
132600                                      AFIRCSTA                    13260000
132700     END-IF.                                                      13270000
132800                                                                  13280000
132900     MOVE ASC-BOXID                TO ABOXIDO.                    13290000
133000/                                                                 13300000
133010*----------------------------------------------------------------*13301000
133020* DETERMINE IF LINE ITEM IS ON TWEBUPC TABLE                     *13302000
133021* NOTE : TABLES TWEBITM AND TUPCPLS ARE NOT REPLACED BY LOGISTICS*13302100
133022*        DOMAIN TABLES BECAUSE OF PERFORMANCE ISSUES.            *13302200
133030*----------------------------------------------------------------*13303000
133040 4450-CHECK-TWEBUPC.                                              13304000
133041     MOVE ASC-KEY-PO-NBR TO PURCHS-PO-NBR                         13304100
133042     MOVE DK-PO-LNE-NBR  TO PURITM-PO-LNE-NBR                     13304200
133050     PERFORM                                                      13305000
133060         WITH TEST AFTER                                          13306000
133070         VARYING PV-RETRY-COUNTER                                 13307000
133080         FROM 1 BY 1                                              13308000
133090         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13309000
133091             OR (SQLCODE = +0) OR (SQLCODE = +100))               13309100
133092         EXEC SQL                                                 13309200
133093              SELECT COUNT(*)                                     13309300
133094               INTO :PV-DB2-COUNT                                 13309400
133095               FROM TWEBITM A                                     13309500
133096                   ,TUPCPLS C                                     13309600
133097                   ,TPURITM E                                     13309700
133098                   ,TPURCHS F                                     13309800
133099             WHERE F.PO_NBR = :PURCHS-PO-NBR                      13309900
133100               AND F.PO_NBR = E.PO_NBR                            13310000
133110               AND F.VER_STATUS_CDE = 'A'                         13311000
133120               AND E.VER_STATUS_CDE = 'A'                         13312000
133121               AND E.PO_LNE_NBR = :PURITM-PO-LNE-NBR              13312100
133122               AND E.ITM_NBR = C.ITM_NBR                          13312200
133123               AND C.OPERCO_NBR = '03'                            13312300
133124               AND C.STR_NBR = 0                                  13312400
133125               AND ((C.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      13312500
133126                     C.EFF_END_TMST IS NULL) OR                   13312600
133127                    (C.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      13312700
133128                     C.EFF_END_TMST > CURRENT TIMESTAMP))         13312800
133129               AND   C.UPC_ID = A.INTR_UPC_ID                     13312900
133130               AND  (A.EFF_BEG_TMST <= CURRENT TIMESTAMP          13313000
133131                       AND A.EFF_END_TMST IS NULL)                13313100
133132         END-EXEC                                                 13313200
133133                                                                  13313300
133134         EVALUATE TRUE                                            13313400
133135             WHEN SQLCODE = +0                                    13313500
133136             WHEN SQLCODE = +100                                  13313600
133137             WHEN SQLCODE = -904                                  13313700
133138             WHEN SQLCODE = -913                                  13313800
133139                  CONTINUE                                        13313900
133140             WHEN SQLWARN0 NOT = SPACES                           13314000
133141             WHEN SQLCODE < +0                                    13314100
133142             WHEN SQLCODE > +0                                    13314200
133143                  MOVE '4450-CHECK-TWEBUPC '                      13314300
133144                                  TO DP013-PARAGRAPH              13314400
133145                  MOVE 'UNSUCCESSFUL SELECT COUNT(*)'             13314500
133146                                  TO DP013-MESSAGE-TEXT (1)       13314600
133147                  MOVE SQLCA      TO DP013-SQLCA                  13314700
133148                  MOVE 'TWEBITM ' TO DP013-DB2-TABLE-NAME (1)     13314800
133149                  MOVE 'TUPCPLS ' TO DP013-DB2-TABLE-NAME (2)     13314900
133150                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (3)     13315000
133151                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (4)     13315100
133153                  SET DP013-DB2-ABEND                             13315300
133154                  DP013-XCTL-DISPLAY-RESTART                      13315400
133155                                  TO TRUE                         13315500
133156                  PERFORM DP013-0000-PROCESS-ABEND                13315600
133157         END-EVALUATE                                             13315700
133158     END-PERFORM.                                                 13315800
133159                                                                  13315900
133160     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13316000
133161         MOVE '4450-CHECK-TWEBUPC' TO DP013-PARAGRAPH             13316100
133162         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TWEBUPC'        13316200
133163                                   TO DP013-MESSAGE-TEXT (1)      13316300
133164         MOVE SQLCA               TO DP013-SQLCA                  13316400
133165         MOVE 'XLT_WEB_SKU '      TO DP013-DB2-TABLE-NAME (1)     13316500
133166         MOVE 'XLT_SKU '          TO DP013-DB2-TABLE-NAME (2)     13316600
133167         MOVE 'XLV_SKU_STR '      TO DP013-DB2-TABLE-NAME (3)     13316700
133168         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (4)     13316800
133169         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (5)     13316900
133170         SET DP013-DB2-ABEND                                      13317000
133171             DP013-XCTL-DISPLAY-RESTART                           13317100
133172                                  TO TRUE                         13317200
133173         PERFORM DP013-0000-PROCESS-ABEND                         13317300
133174     END-IF.                                                      13317400
133175                                                                  13317500
133180*----------------------------------------------------------------*13318000
133200*    DECODE USERIDS TO DISPLAY NAMES                             *13320000
133300*----------------------------------------------------------------*13330000
133400 4499-GET-TWORKER.                                                13340000
133500                                                                  13350000
133600     PERFORM 4510-OPEN-WORKER-CSR.                                13360000
133700                                                                  13370000
133800                                                                  13380000
133900     EXEC SQL                                                     13390000
134000          FETCH WORKER-CSR                                        13400000
134100           INTO :WORKER-LAST-NAME,                                13410000
134200                :WORKER-FIR-NAME                                  13420000
134300     END-EXEC.                                                    13430000
134400                                                                  13440000
134500     EVALUATE TRUE                                                13450000
134600         WHEN SQLCODE = +0                                        13460000
134700              CONTINUE                                            13470000
134800                                                                  13480000
134900         WHEN SQLCODE = +100                                      13490000
135000              MOVE SPACES        TO WORKER-LAST-NAME              13500000
135100                                WORKER-FIR-NAME                   13510000
135200         WHEN SQLCODE = -904                                      13520000
135300         WHEN SQLCODE = -913                                      13530000
135400              CONTINUE                                            13540000
135500                                                                  13550000
135600         WHEN SQLWARN0 NOT = SPACES                               13560000
135700         WHEN SQLCODE < +0                                        13570000
135800         WHEN SQLCODE > +0                                        13580000
135900          MOVE '4499-GET-TWORKER'                                 13590000
136000                          TO DP013-PARAGRAPH                      13600000
136100          MOVE 'UNSUCCESSFUL SELECT TWORKER'                      13610000
136200                          TO DP013-MESSAGE-TEXT (1)               13620000
136300          MOVE SQLCA              TO DP013-SQLCA                  13630000
136400          MOVE 'TWORKER ' TO DP013-DB2-TABLE-NAME (1)             13640000
136500          SET DP013-DB2-ABEND                                     13650000
136600                  DP013-XCTL-DISPLAY-RESTART                      13660000
136700                              TO TRUE                             13670000
136800          PERFORM DP013-0000-PROCESS-ABEND                        13680000
136900     END-EVALUATE.                                                13690000
137000                                                                  13700000
137100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13710000
137200         MOVE '4499-GET-TWORKER'  TO DP013-PARAGRAPH              13720000
137300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TWORKER'            13730000
137400                                  TO DP013-MESSAGE-TEXT (1)       13740000
137500         MOVE SQLCA               TO DP013-SQLCA                  13750000
137600         MOVE 'TWORKER '          TO DP013-DB2-TABLE-NAME (1)     13760000
137700         SET DP013-DB2-ABEND                                      13770000
137800             DP013-XCTL-DISPLAY-RESTART                           13780000
137900                                  TO TRUE                         13790000
138000         PERFORM DP013-0000-PROCESS-ABEND                         13800000
138100     END-IF.                                                      13810000
138200                                                                  13820000
138300     PERFORM 4520-CLOSE-WORKER-CSR.                               13830000
138400                                                                  13840000
138500 4510-OPEN-WORKER-CSR.                                            13850000
138600                                                                  13860000
138700     PERFORM                                                      13870000
138800         WITH TEST AFTER                                          13880000
138900         VARYING PV-RETRY-COUNTER                                 13890000
139000         FROM 1 BY 1                                              13900000
139100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13910000
139200            OR (SQLCODE = +0))                                    13920000
139300                                                                  13930000
139400         EXEC SQL                                                 13940000
139500             OPEN WORKER-CSR                                      13950000
139600         END-EXEC                                                 13960000
139700                                                                  13970000
139800         EVALUATE TRUE                                            13980000
139900             WHEN SQLCODE = +0                                    13990000
140000                  CONTINUE                                        14000000
140100             WHEN SQLCODE = -904                                  14010000
140200             WHEN SQLCODE = -913                                  14020000
140300                  CONTINUE                                        14030000
140400             WHEN SQLWARN0 NOT = SPACE                            14040000
140500             WHEN SQLCODE  NOT = +0                               14050000
140600                  MOVE '4510-OPEN-WORKER-CSR'                     14060000
140700                                   TO DP013-PARAGRAPH             14070000
140800                  MOVE 'OPEN WORKER-CSR CURSOR'                   14080000
140900                                   TO DP013-MESSAGE-TEXT (1)      14090000
141000                  MOVE SQLCA       TO DP013-SQLCA                 14100000
141100                  MOVE 'TWORKER'   TO DP013-DB2-TABLE-NAME (1)    14110000
141200                  SET DP013-DB2-ABEND                             14120000
141300                                   TO TRUE                        14130000
141400                  PERFORM DP013-0000-PROCESS-ABEND                14140000
141500         END-EVALUATE                                             14150000
141600     END-PERFORM.                                                 14160000
141700                                                                  14170000
141800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14180000
141900         MOVE '4510-OPEN-WORKER-CURSOR' TO DP013-PARAGRAPH        14190000
142000         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              14200000
142100                                   TO DP013-MESSAGE-TEXT (1)      14210000
142200         MOVE SQLCA                TO DP013-SQLCA                 14220000
142300         SET DP013-DB2-ABEND       TO TRUE                        14230000
142400         PERFORM DP013-0000-PROCESS-ABEND                         14240000
142500     END-IF.                                                      14250000
142600                                                                  14260000
142700 4520-CLOSE-WORKER-CSR.                                           14270000
142800                                                                  14280000
142900     EXEC SQL                                                     14290000
143000         CLOSE WORKER-CSR                                         14300000
143100     END-EXEC.                                                    14310000
143200                                                                  14320000
143300     EVALUATE TRUE                                                14330000
143400         WHEN SQLCODE = +0                                        14340000
143500              CONTINUE                                            14350000
143600         WHEN SQLWARN0 NOT = SPACE                                14360000
143700         WHEN SQLCODE  NOT = +0                                   14370000
143800              MOVE '4520-CLOSE-WORKER-CURSOR'                     14380000
143900                                   TO DP013-PARAGRAPH             14390000
144000              MOVE 'CLOSE WORKER-CSR CURSOR'                      14400000
144100                                   TO DP013-MESSAGE-TEXT (1)      14410000
144200              MOVE SQLCA           TO DP013-SQLCA                 14420000
144300              MOVE 'TWORKER'       TO DP013-DB2-TABLE-NAME (1)    14430000
144400              SET DP013-DB2-ABEND  TO TRUE                        14440000
144500              PERFORM DP013-0000-PROCESS-ABEND                    14450000
144600     END-EVALUATE.                                                14460000
144700                                                                  14470000
144800/                                                                 14480000
144900*----------------------------------------------------------------*14490000
145000*    BUILD PREV OR NEXT VERSION INQUIRY PANEL                    *14500000
145100*----------------------------------------------------------------*14510000
145200                                                                  14520000
145300 5000-BUILD-VER-PANEL.                                            14530000
145400                                                                  14540000
145500     SET DP030-SET-CURSOR-TRAILER                                 14550000
145600         PS-NO-ERROR             TO TRUE.                         14560000
145700                                                                  14570000
145800     MOVE ASC-KEY-PO-LNE-NBR     TO DK-PO-LNE-NBR.                14580000
145900     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    14590000
146000     MOVE ASC-KEY-DEPT-NBR       TO DK-DEPT-NBR.                  14600000
146100                                                                  14610000
146200     PERFORM 5020-GET-PO-LNE-INFO.                                14620000
146300                                                                  14630000
146400     IF SQLCODE = +100                                            14640000
146500         MOVE PC-TSYMSG-00656    TO DP020-MSG-NUMBER              14650000
146600         SET DP020-MSG-INFORMATIONAL                              14660000
146700                                 TO TRUE                          14670000
146800     ELSE                                                         14680000
146810       IF ASC-SKU-NBR IS NOT EQUAL TO '000'                       14681000
146900         PERFORM 4030-GET-SKU-INFO                                14690000
147000         PERFORM 4040-GET-UPC-INFO                                14700000
147010       ELSE                                                       14701000
147020         MOVE 0                TO ASC-INNER-PACK-QTY              14702000
147030                                  ASC-OUTER-PACK-QTY              14703000
147040         MOVE SPACES           TO ASC-BOXID                       14704000
147050         MOVE PC-NO-VENDOR-UPC TO ASC-UPC-NBR                     14705000
147100       END-IF                                                     14710000
147110     END-IF.                                                      14711000
147200                                                                  14720000
147300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14730000
147400                                                                  14740000
147500/                                                                 14750000
147600*----------------------------------------------------------------*14760000
147700* SELECT A ROW FROM THE DB2 TPURITM TABLE.                       *14770000
147800*----------------------------------------------------------------*14780000
147900 5020-GET-PO-LNE-INFO.                                            14790000
148000                                                                  14800000
148001     INITIALIZE DCLXLT00003                                       14800100
148002                DCLXLT00004                                       14800200
148003                DCLTPURITM                                        14800300
148004                PV-NULL-INDICATORS.                               14800400
148010     MOVE DK-PO-NBR TO PURITM-PO-NBR                              14801000
148020     MOVE DK-PO-LNE-NBR TO PURITM-PO-LNE-NBR                      14802000
148100     PERFORM                                                      14810000
148200         WITH TEST AFTER                                          14820000
148300         VARYING PV-RETRY-COUNTER                                 14830000
148400         FROM 1 BY 1                                              14840000
148500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14850000
148600             OR (SQLCODE = +0)                                    14860000
148700             OR (SQLCODE = +100))                                 14870000
148800                                                                  14880000
148900         EXEC SQL                                                 14890000
149010             SELECT SKU_NBR                                       14901000
149020                   ,MAJ_CL_NBR                                    14902000
149030                   ,SUB_CL_NBR                                    14903000
149040                   ,VS_NBR                                        14904000
149050                   ,CL_NBR                                        14905000
149060                   ,VEND_STYL_NAME                                14906000
149300                   ,AD_EVNT_DTE                                   14930000
149610                   ,NRF_CLOR_CDE                                  14961000
149620                   ,CSTM_CLOR_DESC                                14962000
149630                   ,KOHLS_SIZE_CDE                                14963000
149700                   ,B.SIZE_DESC                                   14970000
149800                   ,B.SKU_DESC                                    14980000
149810                   ,COLOR_CDE                                     14981000
149820                   ,COLOR_DESC                                    14982000
149830                   ,SIZE_CDE                                      14983000
149840                   ,A.SIZE_DESC                                   14984000
149850                   ,A.SKU_DESC                                    14985000
149900                   ,UNT_QTY                                       14990000
150000                   ,UM_IND                                        15000000
150100                   ,UNT_COST_AMT                                  15010000
150200                   ,TOT_VAL_COST_AMT                              15020000
150300                   ,UNT_RTL_PR_AMT                                15030000
150400                   ,TOT_VAL_RTL_AMT                               15040000
150500                   ,MU_PCT                                        15050000
150600                   ,GP_RTL_AMT                                    15060000
150700                   ,GP_QTY                                        15070000
150800                   ,VER_NBR                                       15080000
150900                   ,VER_STATUS_CDE                                15090000
151000                   ,A.LAST_UPD_TMST                               15100032
151100                   ,LAST_UPD_BY_UID                               15110000
151200                   ,PRD_1ST_COST_AMT                              15120000
151300                   ,A.INNR_PK_QTY                                 15130033
151400                   ,A.OUTR_PK_QTY                                 15140033
151511             INTO   :XLT00003-SKU-NBR:PV-SKU-NBR-IND              15151100
151512                   ,:XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND        15151200
151513                   ,:XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND        15151300
151514                   ,:XLT00004-VS-NBR:PV-VS-NBR-IND                15151400
151515                   ,:PURITM-CL-NBR                                15151500
151516                   ,:PURITM-VEND-STYL-NAME                        15151600
151517                   ,:PURITM-AD-EVNT-DTE                           15151700
151518                   ,:XLT00003-NRF-CLOR-CDE:PV-NRF-CLOR-CDE-IND    15151800
151519                   ,:XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND15151900
151520                   ,:XLT00003-KOHLS-SIZE-CDE:PV-KOHLS-SIZE-CDE-IND15152000
151521                   ,:XLT00003-SIZE-DESC:PV-SIZE-DESC-IND          15152100
151522                   ,:XLT00003-SKU-DESC:PV-SKU-DESC-IND            15152200
151523                   ,:PURITM-COLOR-CDE                             15152300
151524                   ,:PURITM-COLOR-DESC                            15152400
151525                   ,:PURITM-SIZE-CDE                              15152500
151526                   ,:PURITM-SIZE-DESC                             15152600
151527                   ,:PURITM-SKU-DESC                              15152700
152200                   ,:PURITM-UNT-QTY                               15220000
152300                   ,:PURITM-UM-IND                                15230000
152400                   ,:PURITM-UNT-COST-AMT                          15240000
152500                   ,:PURITM-TOT-VAL-COST-AMT                      15250000
152600                   ,:PURITM-UNT-RTL-PR-AMT                        15260000
152700                   ,:PURITM-TOT-VAL-RTL-AMT                       15270000
152800                   ,:PURITM-MU-PCT                                15280000
152900                   ,:PURITM-GP-RTL-AMT                            15290000
153000                   ,:PURITM-GP-QTY                                15300000
153100                   ,:PURITM-VER-NBR                               15310000
153200                   ,:PURITM-VER-STATUS-CDE                        15320000
153300                   ,:PURITM-LAST-UPD-TMST                         15330000
153400                   ,:PURITM-LAST-UPD-BY-UID                       15340000
153500                   ,:PURITM-PRD-1ST-COST-AMT                      15350000
153510                   ,:PURITM-INNR-PK-QTY                           15351033
153520                   ,:PURITM-OUTR-PK-QTY                           15352033
153600             FROM  TPURITM A                                      15360000
153601             LEFT OUTER JOIN                                      15360100
153602                   XLT_SKU B                                      15360200
153603             ON    A.ITM_NBR = B.ITM_NBR                          15360300
153604             LEFT OUTER JOIN                                      15360400
153605                   XLT_VND_STYL  C                                15360500
153606             ON    B.STYL_ID = C.STYL_ID                          15360600
153607             WHERE PO_NBR         = :PURITM-PO-NBR                15360700
153608               AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR            15360800
153900               AND VER_NBR        = :PURITM-VER-NBR               15390000
154000         END-EXEC                                                 15400000
154100                                                                  15410000
154200         EVALUATE TRUE                                            15420000
154300                                                                  15430000
154400             WHEN SQLCODE = +0                                    15440000
154500                 IF PV-SKU-NBR-IND = +0                           15450000
154600                   MOVE XLT00004-MAJ-CL-NBR TO PV-MAJ-CL-NBR      15460000
154700                   MOVE PV-MAJ-CL-NBR       TO ASC-MAJ-CL-NBR     15470000
154800                   MOVE XLT00004-SUB-CL-NBR TO PV-SUB-CL-NBR      15480000
154801                   MOVE PV-SUB-CL-NBR       TO ASC-SUB-CL-NBR     15480100
154802                   MOVE XLT00003-SKU-NBR    TO PV-SKU-NBR         15480200
154803                   MOVE PV-SKU-NBR          TO ASC-SKU-NBR        15480300
154804                   MOVE XLT00004-VS-NBR     TO ASC-VEND-STYL-NAME 15480400
154805                   MOVE XLT00003-NRF-CLOR-CDE                     15480500
154806                                            TO ASC-COLOR          15480600
154807                   MOVE XLT00003-CSTM-CLOR-DESC                   15480700
154808                                            TO ASC-COLOR-DESC     15480800
154809                   MOVE XLT00003-KOHLS-SIZE-CDE                   15480900
154810                                            TO PV-SIZE            15481000
154811                   MOVE PV-SIZE             TO ASC-SIZE           15481100
154812                   MOVE XLT00003-SIZE-DESC  TO ASC-SIZE-DESC      15481200
154813                   MOVE XLT00003-SKU-DESC   TO ASC-SKU-DESC       15481300
154814                 ELSE                                             15481400
154815                   MOVE PURITM-CL-NBR       TO ASC-SUB-CL-NBR     15481500
154816                   MOVE PURITM-CL-NBR (1:1) TO PV-MAJ-CL-1        15481600
154817                   MOVE PV-MAJ-CL-NBR       TO ASC-MAJ-CL-NBR     15481700
154818                   MOVE ASC-KEY-DEPT-NBR    TO PV-SKU-DEPT        15481800
154819                   MOVE PURITM-CL-NBR       TO PV-SKU-CLASS       15481900
154820                   MOVE PV-SKU-NBR          TO ASC-SKU-NBR        15482000
154821                   MOVE PURITM-VEND-STYL-NAME                     15482100
154822                                            TO ASC-VEND-STYL-NAME 15482200
154823                   MOVE PURITM-COLOR-CDE    TO ASC-COLOR          15482300
154824                   MOVE PURITM-COLOR-DESC   TO ASC-COLOR-DESC     15482400
154825                   MOVE PURITM-SIZE-CDE     TO PV-SIZE-4-9        15482500
154826                   MOVE PV-SIZE             TO ASC-SIZE           15482600
154827                   MOVE PURITM-SIZE-DESC    TO ASC-SIZE-DESC      15482700
154828                   MOVE PURITM-SKU-DESC     TO ASC-SKU-DESC       15482800
154829                 END-IF                                           15482900
154900                 MOVE PURITM-AD-EVNT-DTE  TO PV-AD-DATE-10        15490000
155000                 IF  PV-AD-DATE-10 = '0001-01-01'                 15500000
155100                     MOVE SPACES          TO ASC-AD-EVENT-DATE    15510000
155200                 ELSE                                             15520000
155300                     MOVE PV-AD-DATE-CC   TO PV-SL-DATE-CC        15530000
155400                     MOVE PV-AD-DATE-YY   TO PV-SL-DATE-YY        15540000
155500                     MOVE PV-AD-DATE-MM   TO PV-SL-DATE-MM        15550000
155600                     MOVE PV-AD-DATE-DD   TO PV-SL-DATE-DD        15560000
155700                     MOVE PV-SLASH-DATE   TO ASC-AD-EVENT-DATE    15570000
155800                 END-IF                                           15580000
156400                 MOVE PURITM-UNT-QTY      TO ASC-UNT-QTY          15640000
156500                 MOVE PURITM-UM-IND       TO ASC-UOM              15650000
156600                 MOVE PURITM-UNT-COST-AMT TO ASC-UNT-COST-AMT     15660000
156700                 MOVE PURITM-TOT-VAL-COST-AMT                     15670000
156800                                          TO ASC-TOT-VAL-COST-AMT 15680000
156900                 MOVE PURITM-UNT-RTL-PR-AMT                       15690000
157000                                          TO ASC-UNT-RTL-PR-AMT   15700000
157100                 MOVE PURITM-TOT-VAL-RTL-AMT                      15710000
157200                                          TO ASC-TOT-VAL-RTL-AMT  15720000
157300                 MOVE PURITM-MU-PCT       TO ASC-MU-PCT           15730000
157400                 MOVE PURITM-GP-RTL-AMT   TO ASC-GP-RTL-AMT       15740000
157500                 MOVE PURITM-GP-QTY       TO ASC-GP-QTY           15750000
157600                 MOVE PURITM-VER-NBR      TO ASC-VER-NBR          15760000
157700                 MOVE PURITM-VER-STATUS-CDE                       15770000
157800                                          TO ASC-VER-STATUS-CDE   15780000
157900                 MOVE PURITM-LAST-UPD-TMST                        15790000
158000                                          TO ASC-LAST-UPD-TMST    15800000
158100                 MOVE PURITM-LAST-UPD-BY-UID                      15810000
158200                                          TO ASC-LAST-UPD-BY-UID  15820000
C66632        COMPUTE ASC-FIRST-COST ROUNDED = PURITM-PRD-1ST-COST-AMT  15841044
158500**GB 3/25/12 WR3372A  BEG                                         15850033
158510                 MOVE PURITM-INNR-PK-QTY  TO PV-INNR-PACK-QTY     15851033
158520                 MOVE PURITM-OUTR-PK-QTY  TO PV-OUTR-PACK-QTY     15852033
158523                 MOVE PV-INNR-PACK-QTY                            15852333
158524                                    TO ASC-INNER-PACK-QTY         15852433
158527                 MOVE PV-OUTR-PACK-QTY                            15852733
158528                                    TO ASC-OUTER-PACK-QTY         15852833
158529                IF PURITM-INNR-PK-QTY   = ZEROES                  15852933
158530                   MOVE +1          TO ASC-INNER-PACK-QTY         15853033
158531                END-IF                                            15853133
158532                IF PURITM-OUTR-PK-QTY     = ZEROES                15853233
158533                   MOVE +1          TO ASC-OUTER-PACK-QTY         15853333
158534                END-IF                                            15853433
158540**GB 3/25/12 WR3372A  END                                         15854033
158600             WHEN SQLCODE = +100                                  15860000
158700             WHEN SQLCODE = -904                                  15870000
158800             WHEN SQLCODE = -913                                  15880000
158900                 CONTINUE                                         15890000
159000             WHEN SQLWARN0 NOT = SPACES                           15900000
159100             WHEN SQLCODE < +0                                    15910000
159200             WHEN SQLCODE > +0                                    15920000
159300                 MOVE '5020-GET-PO-LNE-INFO'                      15930000
159400                                 TO DP013-PARAGRAPH               15940000
159500                 MOVE 'SELECT PO-LNE INFO  '                      15950000
159600                                 TO DP013-MESSAGE-TEXT (1)        15960000
159700                 MOVE SQLCA      TO DP013-SQLCA                   15970000
159800                 MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (1)      15980000
159810                 MOVE ' XLT_SKU' TO DP013-DB2-TABLE-NAME (2)      15981000
159820                 MOVE ' XLT_VND_STYL'                             15982000
159830                                 TO DP013-DB2-TABLE-NAME (3)      15983000
159900                 SET DP013-DB2-ABEND                              15990000
160000                     DP013-XCTL-DISPLAY-RESTART                   16000000
160100                                 TO TRUE                          16010000
160200                 PERFORM DP013-0000-PROCESS-ABEND                 16020000
160300         END-EVALUATE                                             16030000
160400     END-PERFORM.                                                 16040000
160500                                                                  16050000
160600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16060000
160700         MOVE '5020-GET-PO-LNE-INFO'                              16070000
160800                                 TO DP013-PARAGRAPH               16080000
160900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     16090000
161000                                 TO DP013-MESSAGE-TEXT (1)        16100000
161100         MOVE 'PO LINE INFO '    TO DP013-MESSAGE-TEXT (2)        16110000
161200         MOVE SQLCA              TO DP013-SQLCA                   16120000
161300         MOVE 'TPURITM'          TO DP013-DB2-TABLE-NAME (1)      16130000
161310         MOVE ' XLT_SKU'         TO DP013-DB2-TABLE-NAME (2)      16131000
161320         MOVE ' XLT_VND_STYL'    TO DP013-DB2-TABLE-NAME (3)      16132000
161400         SET DP013-DB2-ABEND                                      16140000
161500             DP013-XCTL-DISPLAY-RESTART                           16150000
161600                                   TO TRUE                        16160000
161700         PERFORM DP013-0000-PROCESS-ABEND                         16170000
161800     END-IF.                                                      16180000
161900                                                                  16190000
162000/                                                                 16200000
162100*----------------------------------------------------------------*16210000
162200* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *16220000
162300*----------------------------------------------------------------*16230000
162400                                                                  16240000
162500 9100-READ-SEL-QUEUE.                                             16250000
162600     EXEC CICS                                                    16260000
162700         READQ TS                                                 16270000
162800             QUEUE (ASC-SEL-QUEUE-NAME)                           16280000
162900             INTO  (PO012-PO-SELECT-RECORD)                       16290000
163000             ITEM  (ASC-SEL-ITEM)                                 16300000
163100             RESP  (PV-CICS-RESPONSE)                             16310000
163200     END-EXEC.                                                    16320000
163300                                                                  16330000
163400     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   16340000
163500         CONTINUE                                                 16350000
163600     ELSE                                                         16360000
163700        IF  PV-CICS-RESPONSE EQUAL DFHRESP(QIDERR)                16370000
163800            MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER              16380000
163900            SET DP020-MSG-WARNING TO TRUE                         16390000
164000            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 16400000
164100        ELSE                                                      16410000
164200         SET DP013-LOGIC-ABEND                                    16420000
164300             DP013-NO-ROLLBACK     TO TRUE                        16430000
164400         MOVE '9100-READ-SEL-QUEUE'                               16440000
164500                                   TO DP013-PARAGRAPH             16450000
164600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   16460000
164700                                   TO DP013-MESSAGE-TEXT (1)      16470000
164800         PERFORM DP013-0000-PROCESS-ABEND                         16480000
164900        END-IF                                                    16490000
165000     END-IF.                                                      16500000
165100                                                                  16510000
165200/                                                                 16520000
165300*----------------------------------------------------------------*16530000
165400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *16540000
165500*----------------------------------------------------------------*16550000
165600 9200-REWRITE-LIST-QUEUE.                                         16560000
165700                                                                  16570000
165800     EXEC CICS                                                    16580000
165900          WRITEQ TS                                               16590000
166000              QUEUE  (ASC-SEL-QUEUE-NAME)                         16600000
166100              FROM (PO012-PO-SELECT-RECORD)                       16610000
166200              ITEM   (ASC-SEL-ITEM)                               16620000
166300              RESP   (PV-CICS-RESPONSE)                           16630000
166400              REWRITE                                             16640000
166500     END-EXEC.                                                    16650000
166600                                                                  16660000
166700     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               16670000
166800         SET DP013-CICS-ABEND                                     16680000
166900             DP013-NO-ROLLBACK     TO TRUE                        16690000
167000         MOVE '9200-REWRITE-LIST-QUEUE'                           16700000
167100                                   TO DP013-PARAGRAPH             16710000
167200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   16720000
167300                                   TO DP013-MESSAGE-TEXT (1)      16730000
167400         PERFORM DP013-0000-PROCESS-ABEND                         16740000
167500     END-IF.                                                      16750000
167600                                                                  16760000
167700/                                                                 16770000
167800******************************************************************16780000
167900* READ AN ITEM FROM THE INPUT SELECTED WORK ORDER ITEMS          *16790000
168000* TEMP STORAGE QUEUE.                                            *16800000
168100******************************************************************16810000
168200 9300-READ-WO-SEL-QUEUE.                                          16820000
168300                                                                  16830000
168400     EXEC CICS                                                    16840000
168500         READQ TS                                                 16850000
168600             QUEUE (ASC-SEL-QUEUE-NAME)                           16860000
168700             INTO  (PC016-TS-SEL-REC)                             16870000
168800             ITEM  (ASC-SEL-ITEM)                                 16880000
168900             RESP  (PV-CICS-RESPONSE)                             16890000
169000     END-EXEC.                                                    16900000
169100                                                                  16910000
169200     IF PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                    16920000
169300         CONTINUE                                                 16930000
169400     ELSE                                                         16940000
169500        IF  PV-CICS-RESPONSE EQUAL DFHRESP(QIDERR)                16950000
169600            MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER              16960000
169700            SET DP020-MSG-WARNING TO TRUE                         16970000
169800            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 16980000
169900        ELSE                                                      16990000
170000         SET DP013-LOGIC-ABEND                                    17000000
170100             DP013-NO-ROLLBACK     TO TRUE                        17010000
170200         MOVE '9300-READ-WO-SEL-QUEUE'                            17020000
170300                                   TO DP013-PARAGRAPH             17030000
170400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   17040000
170500                                   TO DP013-MESSAGE-TEXT (1)      17050000
170600         PERFORM DP013-0000-PROCESS-ABEND                         17060000
170700        END-IF                                                    17070000
170800     END-IF.                                                      17080000
170900                                                                  17090000
171000/                                                                 17100000
171100******************************************************************17110000
171200* UPDATE AN ITEM IN THE INPUT SELECTED WORK ORDER ITEMS          *17120000
171300* TEMP STORAGE QUEUE.                                            *17130000
171400******************************************************************17140000
171500 9400-REWRITE-WO-LIST-QUEUE.                                      17150000
171600     EXEC CICS                                                    17160000
171700          WRITEQ TS                                               17170000
171800              QUEUE   (ASC-SEL-QUEUE-NAME)                        17180000
171900              FROM    (PC016-TS-SEL-REC)                          17190000
172000              ITEM    (ASC-SEL-ITEM)                              17200000
172100              RESP    (PV-CICS-RESPONSE)                          17210000
172200              REWRITE                                             17220000
172300     END-EXEC.                                                    17230000
172400                                                                  17240000
172500     IF PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)                17250000
172600         SET DP013-CICS-ABEND                                     17260000
172700             DP013-NO-ROLLBACK   TO TRUE                          17270000
172800         MOVE '9400-REWRITE-WO-LIST-QUEUE'                        17280000
172900                                 TO DP013-PARAGRAPH               17290000
173000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   17300000
173100                                 TO DP013-MESSAGE-TEXT (1)        17310000
173200         PERFORM DP013-0000-PROCESS-ABEND                         17320000
173300     END-IF.                                                      17330000
173400/                                                                 17340000
173500/                                                                 17350000
173600*----------------------------------------------------------------*17360000
173700*    NAME REFORMATOR MODULE                                      *17370000
173800*----------------------------------------------------------------*17380000
173900                                                                  17390000
174000     COPY DPPD024.                                                17400000
174100/                                                                 17410000
174200*----------------------------------------------------------------*17420000
174300*    ABEND PROCESSOR MODULE                                      *17430000
174400*----------------------------------------------------------------*17440000
174500                                                                  17450000
174600     COPY DPPD013.                                                17460000
