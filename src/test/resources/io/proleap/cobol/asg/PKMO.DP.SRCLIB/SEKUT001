000200 IDENTIFICATION DIVISION.                                         00020000
000300*                                                                 00030000
000400 PROGRAM-ID.    SEKUT001.                                         00040015
000500*                                                                 00050000
000600 AUTHOR.        LYNN KELLING.                                     00060002
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  02/26/03.                                         00080002
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100***************************************************************** 00110000
001200** THIS PROGRAM WILL READ IN THE E-MAIL USER INFORMATION TABLE ** 00120067
001300** AND GENERATE A SEQUENTIAL FILE FOR BUSINESS CONTINUITY      ** 00130067
001400***************************************************************** 00140000
001500                                                                  00150052
001600 ENVIRONMENT DIVISION.                                            00160000
001700*                                                                 00170000
001800 CONFIGURATION SECTION.                                           00180000
001900*                                                                 00190000
002000 SOURCE-COMPUTER.  IBM-3090.                                      00200000
002100 OBJECT-COMPUTER.  IBM-3090.                                      00210000
002200*                                                                 00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400*                                                                 00240000
002500 FILE-CONTROL.                                                    00250000
002510                                                                  00251052
002600     SELECT ORACLE-LOGON-FILE                                     00260052
002700         ASSIGN TO ORALOGON.                                      00270052
002701                                                                  00270152
002710     SELECT OUTPUT-LNOTE-USERID-FILE                              00271052
002720         ASSIGN TO OUT01.                                         00272052
002800                                                                  00280052
002900 DATA DIVISION.                                                   00290000
003000*                                                                 00300000
003100 FILE SECTION.                                                    00310000
003200*                                                                 00320000
003300 FD  ORACLE-LOGON-FILE                                            00330053
003410     RECORDING MODE IS F                                          00341053
003420     LABEL RECORDS ARE STANDARD                                   00342053
003430     BLOCK CONTAINS 0 RECORDS                                     00343053
003440     RECORD CONTAINS 80 CHARACTERS                                00344053
003450     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00345053
003460                                                                  00346053
003500 01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       00350053
003501                                                                  00350153
003510 FD  OUTPUT-LNOTE-USERID-FILE                                     00351053
003520     RECORDING MODE IS F                                          00352053
003530     LABEL RECORDS ARE STANDARD                                   00353053
003540     BLOCK CONTAINS 0 RECORDS                                     00354053
003550     RECORD CONTAINS 383 CHARACTERS                               00355067
003560     DATA RECORDS IS OUTPUT-LNOTE-USERID-RECORD.                  00356053
003570                                                                  00357053
003580 01  OUTPUT-LNOTE-USERID-RECORD  PIC X(383).                      00358067
003600*                                                                 00360000
003800 WORKING-STORAGE SECTION.                                         00380000
003900*                                                                 00390012
004000*  LOTUS NOTES USER INFORMATION                                   00400012
004100*                                                                 00410012
004200     COPY SERD001.                                                00420013
004210                                                                  00421048
004220 01  ABEND-CODE                    PIC S9(04)  COMP SYNC          00422048
004230                                               VALUE ZERO.        00423048
004241     88  AC-CONTROL-CARD-ERROR                 VALUE +4003.       00424152
004250     88  AC-ORACLE-ERROR                       VALUE +4013.       00425048
004300                                                                  00430012
004400*                                                                 00440000
004500 01  PC-PROGRAM-CONSTANTS.                                        00450000
004600     05  PC-PROGRAM-NAME         PIC  X(8)  VALUE 'SEKUT001'.     00460052
004610     05  PC-AUTO-LOGON           PIC  X(1)  VALUE '/'.            00461052
004620     05  PC-NULL-VALUE           PIC S9(4)  VALUE -1.             00462063
004700                                                                  00470048
004800* DECLARE VARIABLES FOR SUBROUTINE CALL  (SQLCODE TEXT)           00480048
004900                                                                  00490048
005000 01  WS-MSG-TEXT                   PIC X(512).                    00500048
005100 01  WS-MAX-SIZE                   PIC S9(09) COMP                00510048
005200                                              VALUE 512.          00520048
005300 01  WS-MSG-LENGTH                 PIC S9(09) COMP.               00530048
005400*                                                                 00540048
005500 01  PV-PROGRAM-VARIABLES.                                        00550048
005600     05  PV-ABEND-PARAGRAPH        PIC X(30)   VALUE SPACES.      00560048
005900     05  PV-OUTPUT-RECS            PIC S9(09)  COMP SYNC          00590048
006000                                               VALUE ZERO.        00600048
006100     05  PV-PRINT-NUM              PIC  ZZZZZZ9                   00610048
006200                                               VALUE ZERO.        00620048
006300     05  PV-LOC-NBR                PIC X(18)   VALUE SPACES.      00630048
006301     05  PV-PHONE-NBR              PIC X(26)   VALUE SPACES.      00630156
006302     05  FILLER                    REDEFINES PV-PHONE-NBR.        00630256
006305         10  PV-PN1-AREA-CODE      PIC X(3).                      00630556
006306         10  FILLER                PIC X(1).                      00630656
006307             88  PV-PN1-AC-SEPARATOR           VALUE '-', '/',    00630759
006308                                                     '.', ' '.    00630859
006310         10  PV-PN1-CO-CODE        PIC X(3).                      00631056
006311         10  FILLER                PIC X(1).                      00631156
006312             88  PV-PN1-CO-SEPARATOR           VALUE '-', '/',    00631259
006313                                                     '.', ' '.    00631359
006315         10  PV-PN1-LINE-NBR       PIC X(4).                      00631556
006316         10  FILLER                PIC X(14).                     00631656
006324     05  FILLER                    REDEFINES PV-PHONE-NBR.        00632458
006325         10  FILLER                PIC X(1).                      00632558
006326             88  PV-PN2-AC-OPEN-PAREN          VALUE '('.         00632658
006327         10  PV-PN2-AREA-CODE      PIC X(3).                      00632758
006328         10  FILLER                PIC X(1).                      00632858
006329             88  PV-PN2-AC-CLOSE-PAREN         VALUE ')'.         00632958
006330         10  FILLER                PIC X(1).                      00633058
006331             88  PV-PN2-AC-SEPARATOR           VALUE ' ', '.'.    00633161
006332         10  PV-PN2-CO-CODE        PIC X(3).                      00633258
006333         10  FILLER                PIC X(1).                      00633358
006334             88  PV-PN2-CO-SEPARATOR           VALUE '-'.         00633458
006335         10  PV-PN2-LINE-NBR       PIC X(4).                      00633558
006336         10  FILLER                PIC X(12).                     00633658
006337     05  FILLER                    REDEFINES PV-PHONE-NBR.        00633758
006338         10  FILLER                PIC X(1).                      00633858
006339             88  PV-PN3-AC-OPEN-PAREN          VALUE '('.         00633958
006340         10  PV-PN3-AREA-CODE      PIC X(3).                      00634058
006341         10  FILLER                PIC X(1).                      00634158
006342             88  PV-PN3-AC-CLOSE-PAREN         VALUE ')'.         00634258
006345         10  PV-PN3-CO-CODE        PIC X(3).                      00634558
006346         10  FILLER                PIC X(1).                      00634658
006347             88  PV-PN3-CO-SEPARATOR           VALUE '-'.         00634758
006348         10  PV-PN3-LINE-NBR       PIC X(4).                      00634858
006349         10  FILLER                PIC X(13).                     00634958
006350     05  FILLER                    REDEFINES PV-PHONE-NBR.        00635058
006351         10  PV-PN4-AREA-CODE      PIC X(3).                      00635158
006352         10  FILLER                PIC X(1).                      00635261
006353             88  PV-PN4-AC-SEPARATOR           VALUE '-', '/',    00635361
006354                                                     '.', ' '.    00635461
006355         10  PV-PN4-CO-CODE        PIC X(3).                      00635558
006356         10  PV-PN4-LINE-NBR       PIC X(4).                      00635658
006357         10  FILLER                PIC X(1).                      00635758
006358             88  PV-PN4-PN-SEPARATOR           VALUE SPACES.      00635858
006359         10  FILLER                PIC X(14).                     00635961
006360     05  FILLER                    REDEFINES PV-PHONE-NBR.        00636062
006361         10  PV-PN5-AREA-CODE      PIC X(3).                      00636162
006365         10  PV-PN5-CO-CODE        PIC X(3).                      00636562
006366         10  FILLER                PIC X(1).                      00636662
006367             88  PV-PN5-CO-SEPARATOR           VALUE '-', '/',    00636762
006368                                                     '.', ' '.    00636862
006369         10  PV-PN5-LINE-NBR       PIC X(4).                      00636962
006370         10  FILLER                PIC X(1).                      00637062
006371             88  PV-PN5-PN-SEPARATOR           VALUE SPACES.      00637162
006372         10  FILLER                PIC X(14).                     00637262
006373     05  FILLER                    REDEFINES PV-PHONE-NBR.        00637362
006374         10  PV-PN6-AREA-CODE      PIC X(3).                      00637462
006375         10  PV-PN6-CO-CODE        PIC X(3).                      00637562
006376         10  PV-PN6-LINE-NBR       PIC X(4).                      00637662
006377         10  FILLER                PIC X(1).                      00637762
006378             88  PV-PN6-PN-SEPARATOR           VALUE SPACES.      00637862
006379         10  FILLER                PIC X(15).                     00637962
006380     05  PV-REFORMATTED-PHONE-NBR  PIC X(12)   VALUE SPACES.      00638062
006381     05  FILLER                    REDEFINES                      00638162
006382                                       PV-REFORMATTED-PHONE-NBR.  00638262
006383         10  PV-RP-AREA-CODE       PIC X(3).                      00638362
006384         10  FILLER                PIC X(1).                      00638462
006385             88  PV-RP-AC-SEPARATOR            VALUE '-'.         00638562
006386         10  PV-RP-CO-CODE         PIC X(3).                      00638662
006387         10  FILLER                PIC X(1).                      00638762
006388             88  PV-RP-CO-SEPARATOR            VALUE '-'.         00638862
006389         10  PV-RP-LINE-NBR        PIC X(4).                      00638962
006390     05  PV-ORACLE-USERID-LEN      PIC S9(4)   VALUE ZEROS        00639062
006391                                               COMP SYNC.         00639162
006392     05  PV-ORACLE-PASSWORD-LEN    PIC S9(4)   VALUE ZEROS        00639262
006393                                               COMP SYNC.         00639362
006400*                                                                 00640048
006500 01  PS-PROGRAM-SWITCHES.                                         00650048
006510     05  PS-END-OF-LOGON-FILE-SW PIC X(1)     VALUE 'N'.          00651052
006530         88  PS-END-OF-LOGON-FILE             VALUE 'Y'.          00653052
006600     05  PS-USER-INFO-LEFT-SW    PIC X(1)     VALUE 'Y'.          00660052
006700         88  PS-NO-MORE-USR-INFO-LEFT         VALUE 'N'.          00670052
006800         88  PS-MORE-USR-INFO-LEFT            VALUE 'Y'.          00680052
006801                                                                  00680148
006810 01  CC-ORACLE-CONNECTION.                                        00681048
006820     05  CC-ORACLE-USERID        PIC X(40).                       00682048
006830         88 CC-AUTO-LOGON                     VALUE '/'.          00683051
006850     05  CC-ORACLE-PASSWORD      PIC X(40).                       00685048
007300*                                                                 00730048
007400*                                                                 00740048
007500******************************************************************00750048
007600* ORACLE DECLARE SECTION                                          00760048
007700* ORACLE USED AND RETURNED VARIABLES                              00770048
007800******************************************************************00780048
007900     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     00790048
008000                                                                  00800048
008100*----------------------------------------------------------------*00810048
008200* ORACLE LOGON WORKING STORAGE COPYBOOK                           00820048
008300*----------------------------------------------------------------*00830048
008400 01      PC-ENT01-TYPE-CDE         PIC  X(02)  VALUE '01'.        00840048
008600                                                                  00860048
008700 01      USERNAME                  PIC  X(10)  VARYING.           00870048
008800 01      PASSWD                    PIC  X(10)  VARYING.           00880048
008900                                                                  00890048
009000 01  NULL-PROG-VALUES.                                            00900048
009100     05  NV-USR-FRST-NM-NULL        PIC S9(04)     COMP           00910048
009200                                                   VALUE ZERO.    00920048
009300     05  NV-KOHLS-LOC-NBR-NULL      PIC S9(04)     COMP           00930048
009400                                                   VALUE ZERO.    00940048
009500     05  NV-BUS-LOC-NM-NULL         PIC S9(04)     COMP           00950048
009600                                                   VALUE ZERO.    00960048
009700     05  NV-USR-JOB-TITL-NM-NULL    PIC S9(04)     COMP           00970048
009800                                                   VALUE ZERO.    00980048
009900     05  NV-USR-PHN-NBR-NULL        PIC S9(04)     COMP           00990048
010000                                                   VALUE ZERO.    01000048
010100     05  NV-USR-CELL-PHN-NBR-NULL   PIC S9(04)     COMP           01010048
010200                                                   VALUE ZERO.    01020048
010300     05  NV-USR-PGR-NBR-NULL        PIC S9(04)     COMP           01030048
010400                                                   VALUE ZERO.    01040048
010500     05  NV-USR-EMAL-ADDR-NULL      PIC S9(04)     COMP           01050048
010600                                                   VALUE ZERO.    01060048
010700     05  NV-SUPVR-NM-NULL           PIC S9(04)     COMP           01070048
010800                                                   VALUE ZERO.    01080048
010900     05  NV-STR-GP-TYP-DESC-NULL    PIC S9(04)     COMP           01090048
011000                                                   VALUE ZERO.    01100048
011100                                                                  01110015
011200***************************************************************** 01120015
011300*  SQL AND COBOL DECLARATIONS FOR THE NOTES USERID TABLE          01130015
011400*  THE DCLGEN NAME IS SE FOR SYSID, T FOR TABLE, AND 5 DIGIT    * 01140015
011500*  NUMBER                                                       * 01150015
011600*  *** TABLE:  SET_LNOTE_USR_INFO                               * 01160015
011700***************************************************************** 01170015
011800                                                                  01180015
011900     EXEC SQL                                                     01190015
012000         INCLUDE SET00001                                         01200015
012100     END-EXEC.                                                    01210015
012200                                                                  01220015
012300                                                                  01230015
012400     EXEC SQL END DECLARE SECTION END-EXEC.                       01240015
012500                                                                  01250021
012600* ORA COMMUNICATION AREA                                          01260021
012700*                                                                 01270021
012800  01       SQLCA.                                                 01280021
012900           05  SQLCAID               PIC X(8).                    01290021
013000           05  SQLCABC               PIC S9(9) COMPUTATIONAL.     01300021
013100           05  SQLCODE               PIC S9(9) COMPUTATIONAL.     01310021
013200           05  SQLERRM.                                           01320021
013300               49 SQLERRML           PIC S9(4) COMPUTATIONAL.     01330021
013400               49 SQLERRMC           PIC X(70).                   01340021
013500           05  SQLERRP               PIC X(8).                    01350021
013600           05  SQLERRD OCCURS 6 TIMES                             01360021
013700                                     PIC S9(9) COMPUTATIONAL.     01370021
013800           05  SQLWARN.                                           01380021
013900               10 SQLWARN0           PIC X(1).                    01390021
014000               10 SQLWARN1           PIC X(1).                    01400021
014100               10 SQLWARN2           PIC X(1).                    01410021
014200               10 SQLWARN3           PIC X(1).                    01420021
014300               10 SQLWARN4           PIC X(1).                    01430021
014400               10 SQLWARN5           PIC X(1).                    01440021
014500               10 SQLWARN6           PIC X(1).                    01450021
014600               10 SQLWARN7           PIC X(1).                    01460021
014700           05  SQLEXT                PIC X(8).                    01470021
014800*                                                                 01480021
014900*                                                                 01490016
015000     COPY SQLCA2.                                                 01500021
015300                                                                  01530004
015400 PROCEDURE DIVISION.                                              01540000
015500***************************************************************** 01550000
015600**  THIS MODULE CONTROLS ALL PROCESSING DONE IN THIS PROGRAM.  ** 01560000
015700***************************************************************** 01570000
015800 0000-MAIN-DRIVER.                                                01580000
015900                                                                  01590000
016000     PERFORM 1000-INITIALIZATION.                                 01600000
016100     PERFORM 1500-OPEN-USER-CURSOR.                               01610009
016200     PERFORM 1600-FETCH-USER-CURSOR.                              01620009
016300     PERFORM 2000-PROCESS-USER-INFO                               01630012
016400         UNTIL PS-NO-MORE-USR-INFO-LEFT.                          01640021
016500     PERFORM 9000-TERMINATION.                                    01650052
016600                                                                  01660000
016700     GOBACK.                                                      01670000
016800****************************************************************  01680000
016900** CONNECT TO ORACLE, OPEN FILES AND DO THE PRIMING READ.     **  01690007
017000****************************************************************  01700000
017100 1000-INITIALIZATION.                                             01710000
017110     MOVE '1000-INITIALIZATION' TO PV-ABEND-PARAGRAPH.            01711048
017200                                                                  01720007
017300****************************************************************  01730007
017400* LOGON                                                        *  01740007
017500****************************************************************  01750007
017511     OPEN INPUT ORACLE-LOGON-FILE.                                01751152
017512                                                                  01751252
017513     PERFORM 7000-READ-ORACLE-LOGON.                              01751352
017514                                                                  01751452
017515     CLOSE ORACLE-LOGON-FILE.                                     01751552
017516                                                                  01751652
017517     IF ((PS-END-OF-LOGON-FILE)                                   01751752
017518             OR (CC-ORACLE-CONNECTION = SPACES))                  01751852
017519         DISPLAY '** ABEND **'                                    01751952
017520         DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  01752052
017521                   'NOT PROVIDED'                                 01752152
017522         SET AC-CONTROL-CARD-ERROR TO TRUE                        01752252
017523         CALL 'ILBOABN0' USING ABEND-CODE                         01752352
017524     END-IF.                                                      01752452
017525                                                                  01752552
017526     IF CC-AUTO-LOGON                                             01752652
017530         DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        01753052
017540         EXEC SQL                                                 01754052
017550              CONNECT :USERNAME                                   01755052
017560         END-EXEC                                                 01756052
017570     ELSE                                                         01757052
017600         INITIALIZE PV-ORACLE-USERID-LEN                          01760052
017700                    PV-ORACLE-PASSWORD-LEN                        01770052
017800         INSPECT CC-ORACLE-USERID                                 01780052
017810             TALLYING PV-ORACLE-USERID-LEN                        01781052
017900             FOR CHARACTERS BEFORE INITIAL SPACE                  01790052
018000         INSPECT CC-ORACLE-PASSWORD                               01800052
018010             TALLYING PV-ORACLE-PASSWORD-LEN                      01801052
018100             FOR CHARACTERS BEFORE INITIAL SPACE                  01810052
018200         MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO        01820052
018300                   USERNAME-ARR                                   01830052
018400         MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                01840052
018600         MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO    01860052
018700                   PASSWD-ARR                                     01870052
018800         MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                01880052
019710         DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '    01971051
019720                   USERNAME-ARR                                   01972048
019800         EXEC SQL                                                 01980048
019900           CONNECT :USERNAME IDENTIFIED BY :PASSWD                01990048
020000         END-EXEC                                                 02000048
020010         INITIALIZE CC-ORACLE-PASSWORD                            02001052
020020                    PASSWD                                        02002052
020100     END-IF.                                                      02010048
020410                                                                  02041048
020500     IF (SQLCODE NOT = 0)                                         02050048
020900         DISPLAY PV-ABEND-PARAGRAPH                               02090048
020910         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  02091051
021000         PERFORM 9100-ORACLE-ERROR                                02100048
021200     END-IF.                                                      02120048
021800*                                                                 02180009
021900* CURSOR FOR USER INFORMATION                                     02190009
022000*                                                                 02200009
022100     EXEC SQL                                                     02210019
022200       DECLARE USER_INFO CURSOR FOR                               02220019
022300         SELECT LNOTE_USR_ID                                      02230021
022400              , USR_FRST_NM                                       02240021
022500              , USR_LAST_NM                                       02250021
022600              , KOHLS_LOC_NBR                                     02260021
022700              , BUS_LOC_NM                                        02270021
022800              , USR_JOB_TITL_NM                                   02280021
022900              , USR_PHN_NBR                                       02290021
023000              , USR_CELL_PHN_NBR                                  02300021
023100              , USR_PGR_NBR                                       02310022
023200              , USR_EMAL_ADDR                                     02320021
023300              , SUPVR_NM                                          02330021
023400              , STR_GP_TYP_DESC                                   02340042
023500         FROM SET_LNOTE_USR_INFO                                  02350021
023600         ORDER BY                                                 02360018
023700               LNOTE_USR_ID                                       02370018
023800     END-EXEC.                                                    02380018
023900*                                                                 02390009
024000* OPEN I-O FILES                                                  02400007
024100     OPEN OUTPUT OUTPUT-LNOTE-USERID-FILE.                        02410015
024200                                                                  02420009
024300***************************************************************** 02430009
024400* 1500-OPEN-USER-CURSOR.                                       *  02440009
024500***************************************************************** 02450009
024600*                                                                 02460009
024700 1500-OPEN-USER-CURSOR.                                           02470009
024800     MOVE '1500-OPEN-USER-CURSOR' TO PV-ABEND-PARAGRAPH.          02480015
024900                                                                  02490009
025000     EXEC SQL                                                     02500009
025100         OPEN  USER_INFO                                          02510009
025200     END-EXEC.                                                    02520009
025300                                                                  02530009
025400     EVALUATE TRUE                                                02540009
025500       WHEN SQLCODE = ZEROS                                       02550009
025600         CONTINUE                                                 02560009
025700       WHEN OTHER                                                 02570009
025800         DISPLAY PV-ABEND-PARAGRAPH                               02580009
025900         PERFORM 9100-ORACLE-ERROR                                02590015
026000     END-EVALUATE.                                                02600009
026100                                                                  02610009
026200* 1500-END-OPEN-USER-CURSOR.                                      02620009
026300*                                                                 02630009
026400******************************************************************02640009
026500*                                                                *02650009
026600******************************************************************02660009
026700 1600-FETCH-USER-CURSOR.                                          02670009
026800     MOVE '1600-FETCH-USER-CURSOR' TO PV-ABEND-PARAGRAPH.         02680009
027100                                                                  02710026
027200     EXEC SQL                                                     02720009
027300       FETCH  USER_INFO                                           02730009
027400          INTO  :LNOTE-USR-ID                                     02740015
027500              , :USR-FRST-NM          :NV-USR-FRST-NM-NULL        02750024
027600              , :USR-LAST-NM                                      02760024
027700              , :KOHLS-LOC-NBR        :NV-KOHLS-LOC-NBR-NULL      02770024
027800              , :BUS-LOC-NM           :NV-BUS-LOC-NM-NULL         02780024
027900              , :USR-JOB-TITL-NM      :NV-USR-JOB-TITL-NM-NULL    02790024
028000              , :USR-PHN-NBR          :NV-USR-PHN-NBR-NULL        02800024
028100              , :USR-CELL-PHN-NBR     :NV-USR-CELL-PHN-NBR-NULL   02810025
028200              , :USR-PGR-NBR          :NV-USR-PGR-NBR-NULL        02820024
028300              , :USR-EMAL-ADDR        :NV-USR-EMAL-ADDR-NULL      02830024
028400              , :SUPVR-NM             :NV-SUPVR-NM-NULL           02840024
028500              , :STR-GP-TYP-DESC      :NV-STR-GP-TYP-DESC-NULL    02850043
028600     END-EXEC.                                                    02860009
028700     DISPLAY LNOTE-USR-ID, KOHLS-LOC-NBR, USR-LAST-NM,            02870042
028800              STR-GP-TYP-DESC                                     02880042
028900     EVALUATE TRUE                                                02890009
029000       WHEN SQLCODE = ZEROS                                       02900009
029100            CONTINUE                                              02910009
029200       WHEN SQLCODE = 1403                                        02920021
029300            SET PS-NO-MORE-USR-INFO-LEFT TO TRUE                  02930021
029400       WHEN OTHER                                                 02940009
029500         DISPLAY PV-ABEND-PARAGRAPH                               02950009
029600         PERFORM 9100-ORACLE-ERROR                                02960015
029700     END-EVALUATE.                                                02970009
029800                                                                  02980009
029900****************************************************************  02990000
030000**                                                            **  03000000
030100****************************************************************  03010000
030200 2000-PROCESS-USER-INFO.                                          03020012
030300     PERFORM 2100-FORMAT-OUTPUT.                                  03030000
030400     PERFORM 2300-WRITE-OUTPUT-RECORD.                            03040000
030500     PERFORM 1600-FETCH-USER-CURSOR.                              03050012
030600**   MOVE 0 TO NV-KOHLS-LOC-NBR-NULL.                             03060027
030700****************************************************************  03070000
030800** FORMAT THE OUTPUT RECORD.                                  **  03080000
030900** IF THE TYPE IS A GROUP, THE GROUP DESCRIPTION IS PUT INTO  **  03090000
031000** THE LAST NAME FIELD, IF NOT, THE NAME IS SPLIT AND THE     **  03100000
031100** PIECES ARE PUT INTO APPROPRIATE NAME FIELDS.               **  03110000
031200****************************************************************  03120000
031300 2100-FORMAT-OUTPUT.                                              03130000
031400                                                                  03140034
032200     INITIALIZE SE001-FORMATTED-OUTPUT-RECORD.                    03220026
032300     MOVE FUNCTION UPPER-CASE(LNOTE-USR-ID) TO                    03230066
032310               SE001-EMPLOYEE-USER-ID.                            03231066
032400*                                                                 03240000
032410     IF (NV-USR-FRST-NM-NULL NOT = PC-NULL-VALUE)                 03241063
032500         MOVE USR-FRST-NM         TO SE001-FIRST-NAME             03250063
032510     END-IF.                                                      03251063
032600     MOVE USR-LAST-NM         TO SE001-LAST-NAME.                 03260015
032610     IF (NV-KOHLS-LOC-NBR-NULL NOT = PC-NULL-VALUE)               03261063
032700         MOVE KOHLS-LOC-NBR       TO PV-LOC-NBR                   03270063
032800         MOVE PV-LOC-NBR(15:4)    TO SE001-LOCATION-NBR           03280063
032810     END-IF.                                                      03281063
032820     IF (NV-BUS-LOC-NM-NULL NOT = PC-NULL-VALUE)                  03282063
032900         MOVE BUS-LOC-NM          TO SE001-LOCATION-NAME          03290063
032910     END-IF.                                                      03291063
032920     IF (NV-USR-JOB-TITL-NM-NULL NOT = PC-NULL-VALUE)             03292063
033000         MOVE USR-JOB-TITL-NM     TO SE001-JOB-TITLE              03300065
033100     END-IF.                                                      03310063
033110     IF (NV-USR-PHN-NBR-NULL NOT = PC-NULL-VALUE)                 03311063
033111         MOVE USR-PHN-NBR         TO PV-PHONE-NBR                 03311164
033112     ELSE                                                         03311264
033113         INITIALIZE PV-PHONE-NBR                                  03311364
033114     END-IF.                                                      03311464
033115     PERFORM 2210-REFORMAT-PHONE-NBR.                             03311556
033116     MOVE PV-REFORMATTED-PHONE-NBR                                03311656
033117                              TO SE001-WORK-PHONE.                03311756
033118     IF (NV-USR-CELL-PHN-NBR-NULL NOT = PC-NULL-VALUE)            03311864
033200         MOVE USR-CELL-PHN-NBR    TO PV-PHONE-NBR                 03320064
033210     ELSE                                                         03321064
033211         INITIALIZE PV-PHONE-NBR                                  03321164
033212     END-IF.                                                      03321264
033213     PERFORM 2210-REFORMAT-PHONE-NBR.                             03321356
033214     MOVE PV-REFORMATTED-PHONE-NBR                                03321456
033215                              TO SE001-CELL-PHONE                 03321560
033216     IF (NV-USR-PGR-NBR-NULL NOT = PC-NULL-VALUE)                 03321664
033300         MOVE USR-PGR-NBR         TO SE001-PAGER-PIN              03330064
033310     END-IF.                                                      03331064
033320     IF (NV-USR-EMAL-ADDR-NULL NOT = PC-NULL-VALUE)               03332064
033400         MOVE USR-EMAL-ADDR       TO SE001-WORK-EMAIL-ADDRESS     03340065
033410     END-IF.                                                      03341064
033420     IF (NV-SUPVR-NM-NULL NOT = PC-NULL-VALUE)                    03342064
033500         MOVE SUPVR-NM            TO SE001-SUPERVISOR             03350065
033510     END-IF.                                                      03351064
033520     IF (NV-STR-GP-TYP-DESC-NULL NOT = PC-NULL-VALUE)             03352064
033600         MOVE STR-GP-TYP-DESC     TO SE001-STR-GP-TYP-DESC        03360065
033610     END-IF.                                                      03361064
033700                                                                  03370015
033710****************************************************************  03371056
033720 2210-REFORMAT-PHONE-NBR.                                         03372056
033730     INITIALIZE PV-REFORMATTED-PHONE-NBR.                         03373056
033740     EVALUATE TRUE                                                03374056
033750         WHEN ((PV-PN1-AREA-CODE NUMERIC) AND                     03375056
033753                 (PV-PN1-AC-SEPARATOR) AND                        03375356
033754                 (PV-PN1-CO-CODE NUMERIC) AND                     03375456
033755                 (PV-PN1-CO-SEPARATOR) AND                        03375556
033757                 (PV-PN1-LINE-NBR NUMERIC))                       03375756
033758             MOVE PV-PN1-AREA-CODE   TO PV-RP-AREA-CODE           03375856
033759             SET PV-RP-AC-SEPARATOR  TO TRUE                      03375956
033760             MOVE PV-PN1-CO-CODE     TO PV-RP-CO-CODE             03376056
033761             SET PV-RP-CO-SEPARATOR  TO TRUE                      03376156
033764             MOVE PV-PN1-LINE-NBR    TO PV-RP-LINE-NBR            03376456
033765         WHEN ((PV-PN2-AC-OPEN-PAREN) AND                         03376556
033766                 (PV-PN2-AREA-CODE NUMERIC) AND                   03376656
033767                 (PV-PN2-AC-CLOSE-PAREN) AND                      03376756
033768                 (PV-PN2-AC-SEPARATOR) AND                        03376856
033769                 (PV-PN2-CO-CODE NUMERIC) AND                     03376956
033770                 (PV-PN2-CO-SEPARATOR) AND                        03377056
033771                 (PV-PN2-LINE-NBR NUMERIC))                       03377156
033772             MOVE PV-PN2-AREA-CODE   TO PV-RP-AREA-CODE           03377256
033773             SET PV-RP-AC-SEPARATOR  TO TRUE                      03377356
033774             MOVE PV-PN2-CO-CODE     TO PV-RP-CO-CODE             03377456
033775             SET PV-RP-CO-SEPARATOR  TO TRUE                      03377556
033776             MOVE PV-PN2-LINE-NBR    TO PV-RP-LINE-NBR            03377656
033777         WHEN ((PV-PN3-AC-OPEN-PAREN) AND                         03377758
033778                 (PV-PN3-AREA-CODE NUMERIC) AND                   03377858
033779                 (PV-PN3-AC-CLOSE-PAREN) AND                      03377958
033781                 (PV-PN3-CO-CODE NUMERIC) AND                     03378158
033782                 (PV-PN3-CO-SEPARATOR) AND                        03378258
033783                 (PV-PN3-LINE-NBR NUMERIC))                       03378358
033784             MOVE PV-PN3-AREA-CODE   TO PV-RP-AREA-CODE           03378458
033785             SET PV-RP-AC-SEPARATOR  TO TRUE                      03378558
033786             MOVE PV-PN3-CO-CODE     TO PV-RP-CO-CODE             03378658
033787             SET PV-RP-CO-SEPARATOR  TO TRUE                      03378758
033788             MOVE PV-PN3-LINE-NBR    TO PV-RP-LINE-NBR            03378858
033789         WHEN ((PV-PN4-AREA-CODE NUMERIC) AND                     03378958
033790                 (PV-PN4-AC-SEPARATOR) AND                        03379061
033791                 (PV-PN4-CO-CODE NUMERIC) AND                     03379158
033792                 (PV-PN4-LINE-NBR NUMERIC) AND                    03379258
033793                 (PV-PN4-PN-SEPARATOR))                           03379358
033794             MOVE PV-PN4-AREA-CODE   TO PV-RP-AREA-CODE           03379458
033795             SET PV-RP-AC-SEPARATOR  TO TRUE                      03379558
033796             MOVE PV-PN4-CO-CODE     TO PV-RP-CO-CODE             03379658
033797             SET PV-RP-CO-SEPARATOR  TO TRUE                      03379758
033798             MOVE PV-PN4-LINE-NBR    TO PV-RP-LINE-NBR            03379858
033799         WHEN ((PV-PN5-AREA-CODE NUMERIC) AND                     03379962
033801                 (PV-PN5-CO-CODE NUMERIC) AND                     03380162
033802                 (PV-PN5-CO-SEPARATOR) AND                        03380262
033803                 (PV-PN5-LINE-NBR NUMERIC) AND                    03380362
033804                 (PV-PN5-PN-SEPARATOR))                           03380462
033805             MOVE PV-PN5-AREA-CODE   TO PV-RP-AREA-CODE           03380562
033806             SET PV-RP-AC-SEPARATOR  TO TRUE                      03380662
033807             MOVE PV-PN5-CO-CODE     TO PV-RP-CO-CODE             03380762
033808             SET PV-RP-CO-SEPARATOR  TO TRUE                      03380862
033809             MOVE PV-PN5-LINE-NBR    TO PV-RP-LINE-NBR            03380962
033810         WHEN ((PV-PN6-AREA-CODE NUMERIC) AND                     03381062
033811                 (PV-PN6-CO-CODE NUMERIC) AND                     03381162
033812                 (PV-PN6-LINE-NBR NUMERIC) AND                    03381262
033813                 (PV-PN6-PN-SEPARATOR))                           03381362
033814             MOVE PV-PN6-AREA-CODE   TO PV-RP-AREA-CODE           03381462
033815             SET PV-RP-AC-SEPARATOR  TO TRUE                      03381562
033816             MOVE PV-PN6-CO-CODE     TO PV-RP-CO-CODE             03381662
033817             SET PV-RP-CO-SEPARATOR  TO TRUE                      03381762
033818             MOVE PV-PN6-LINE-NBR    TO PV-RP-LINE-NBR            03381862
033819         WHEN (PV-PHONE-NBR = SPACES)                             03381962
033820             CONTINUE                                             03382062
033821         WHEN OTHER                                               03382162
033822             DISPLAY SE001-EMPLOYEE-USER-ID ' PHONE NUMBER '      03382262
033823                     'DROPPED DUE TO FORMATTING: ' PV-PHONE-NBR   03382362
033824     END-EVALUATE.                                                03382462
033830*                                                                 03383062
033900****************************************************************  03390000
034000** FORMAT THE OUTPUT RECORD.                                  **  03400000
034100****************************************************************  03410000
034200 2300-WRITE-OUTPUT-RECORD.                                        03420000
034300     WRITE OUTPUT-LNOTE-USERID-RECORD                             03430015
034400         FROM SE001-FORMATTED-OUTPUT-RECORD.                      03440015
034500     ADD +1 TO PV-OUTPUT-RECS.                                    03450000
034501                                                                  03450152
034502*                                                                 03450252
034503****************************************************************  03450352
034504** READ THE ORACLE LOGON CONTROL CARD.                        **  03450452
034505****************************************************************  03450552
034506 7000-READ-ORACLE-LOGON.                                          03450652
034510     READ ORACLE-LOGON-FILE                                       03451052
034520         INTO CC-ORACLE-CONNECTION                                03452052
034530         AT END                                                   03453052
034540             SET PS-END-OF-LOGON-FILE TO TRUE                     03454052
034550     END-READ.                                                    03455052
034600*                                                                 03460015
034700****************************************************************  03470000
034800** CLOSE FILES                                                **  03480000
034900****************************************************************  03490000
035000 9000-TERMINATION.                                                03500052
035100     CLOSE OUTPUT-LNOTE-USERID-FILE.                              03510015
035200     MOVE PV-OUTPUT-RECS TO PV-PRINT-NUM.                         03520000
035300     DISPLAY 'SEKUT001 OUTPUT RECORDS: ' PV-PRINT-NUM.            03530015
037000*                                                                 03700017
037100******************************************************************03710004
037200*  FORMAT A ORACLE ERROR MESSAGE, AND ABEND THE PROGRAM.        * 03720007
037300******************************************************************03730004
037400                                                                  03740004
037500 9100-ORACLE-ERROR.                                               03750007
037600                                                                  03760004
037700     MOVE SQLCODE    TO SQLCODE2.                                 03770007
037800     MOVE SQLERRD(3) TO SQLERRD3.                                 03780007
037900     DISPLAY '** ABEND **'                                        03790052
038000     DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.           03800052
038100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  03810007
038200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  03820007
038300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   03830007
038400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  03840007
038500     DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                03850007
038600                                                                  03860007
038700     MOVE SPACES TO WS-MSG-TEXT.                                  03870007
038800*    GET FULL TEXT OF ERROR MESSAGE                               03880007
038900                                                                  03890007
039000     CALL 'SQLGLM' USING WS-MSG-TEXT,                             03900007
039100                         WS-MAX-SIZE,                             03910007
039200                         WS-MSG-LENGTH.                           03920007
039300                                                                  03930007
039400     DISPLAY 'MESSAGE TEXT      ** = ' WS-MSG-TEXT.               03940007
039500                                                                  03950007
039600     EXEC SQL                                                     03960007
039700      ROLLBACK WORK RELEASE                                       03970007
039800     END-EXEC.                                                    03980007
039900                                                                  03990007
040000     SET AC-ORACLE-ERROR   TO TRUE                                04000007
040100     CALL 'ILBOABN0' USING ABEND-CODE.                            04010052
040200*                                                                 04020007
040300* 9100-EXIT.                                                      04030007
