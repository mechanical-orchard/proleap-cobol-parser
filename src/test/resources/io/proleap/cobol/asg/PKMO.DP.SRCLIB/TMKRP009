000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TMKRP009.                                00050000
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            OCTOBER, 1996                            00080000
000900 DATE-COMPILED.                                                   00090000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL PRINT THE DAILY TROUBLE BY VENDOR REPORT   * 00130000
001400*  AND THE WEEKLY TROUBLE BY VENDOR REPORT.                     * 00140000
001500***************************************************************** 00150000
002600* Change History                                                *         
001300*    CHANGES                                                    *         
001300*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              *         
001300*     DATE:    10/10/2014                                       *         
001300*                                                               *         
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# *         
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/10/2014    *         
001600***************************************************************** 00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800***************************************************************** 00180000
001900                                                                  00190000
002000 CONFIGURATION SECTION.                                           00200000
002100                                                                  00210000
002200 SOURCE-COMPUTER.        IBM-3090.                                00220000
002300 OBJECT-COMPUTER.        IBM-3090.                                00230000
002400                                                                  00240000
002500 INPUT-OUTPUT SECTION.                                            00250000
002600                                                                  00260000
002700 FILE-CONTROL.                                                    00270000
002800*                                                                 00280000
002900     SELECT EXTRACT-FILE                                          00290000
003000         ASSIGN TO INP01.                                         00300000
003100                                                                  00310000
003200     SELECT TM-TROUBLE-FILE                                       00320000
003300         ASSIGN TO RPT01.                                         00330000
003400*                                                                 00340000
003500***************************************************************** 00350000
003600 DATA DIVISION.                                                   00360000
003700***************************************************************** 00370000
003800*                                                                 00380000
003900 FILE SECTION.                                                    00390000
004000*                                                                 00400000
004100 FD  EXTRACT-FILE                                                 00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0 RECORDS                                     00440000
004500     RECORD CONTAINS 400 CHARACTERS.                              00450000
004600 01  EXTRACT-RECORD                  PIC X(400).                  00460000
004700                                                                  00470000
004800 FD  TM-TROUBLE-FILE                                              00480000
004900     RECORDING MODE IS F                                          00490000
005000     BLOCK CONTAINS 0  RECORDS.                                   00500000
005100 01  TM-TROUBLE-RECORD               PIC  X(132).                 00510000
005200*                                                                 00520000
005300                                                                  00530000
005400 WORKING-STORAGE SECTION.                                         00540000
005500*                                                                 00550000
005600 01  PROGRAM-SWITCHES.                                            00560000
005700     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00570000
005800         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00580000
005810     05  PS-END-SHORT-AND-OVER-SW    PIC  X(01)    VALUE 'N'.     00570000
005820         88  PS-END-SHORT-AND-OVER                 VALUE 'Y'.     00580000
005830         88  PS-NOT-END-SHORT-AND-OVER             VALUE 'N'.     00580000
005900     05  PS-END-OF-CURSOR-SW         PIC  X(01)    VALUE 'N'.     00590000
006000         88  PS-END-OF-CURSOR                      VALUE 'Y'.     00600000
006100         88  PS-START-OF-CURSOR                    VALUE 'N'.     00610000
006200     05  PS-RUN-FREQUENCY-SW         PIC  X(01)    VALUE SPACES.  00620000
006300         88  PS-DAILY                              VALUE 'D'.     00630000
006400         88  PS-WEEKLY                             VALUE 'W'.     00640000
006500         88  PS-MONTHLY                            VALUE 'M'.     00650000
006600     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        00654099
006700         88  PS-CALL-API-NO                     VALUE 'N'.        00655099
006800         88  PS-CALL-API-YES                    VALUE 'Y'.        00656099
006900*                                                                 00660000
007000 01  DK-DB2-KEYS.                                                 00670000
007100     05  DK-PO-NBR                   PIC S9(9)  COMP VALUE +0.    00680000
007200     05  DK-PREPK-ID                 PIC S9(4)  COMP VALUE +0.    00690000
007300*                                                                 00700000
007400 01  PC-CONSTANTS.                                                00710000
007500     05  PC-00                       PIC X(02)     VALUE '00'.    00720000
007600     05  PC-000                      PIC X(03)     VALUE '000'.   00730000
007700     05  PC-100                      PIC S9(04)    COMP           00740000
007800                                                   VALUE +100.    00750000
007900     05  PC-1                        PIC S9(03)    VALUE +1       00760000
008000                                                   COMP-3.        00770000
008100     05  PC-2                        PIC S9(03)    VALUE +2       00780000
008200                                                   COMP-3.        00790000
008300     05  PC-4                        PIC S9(03)    VALUE +4       00800000
008400                                                   COMP-3.        00810000
008500     05  PC-6                        PIC S9(03)    VALUE +6       00820000
008600                                                   COMP-3.        00830000
008700     05  PC-55                       PIC S9(03)    VALUE +55      00840000
008800                                                   COMP-3.        00850000
008900     05  PC-60                       PIC S9(03)    VALUE +60      00860000
009000                                                   COMP-3.        00870000
009100     05  PC-269                      PIC S9(04)    VALUE +269     00880000
009200                                                   COMP-3.        00890000
009300     05  PC-271                      PIC S9(04)    VALUE +271     00900000
009400                                                   COMP-3.        00910000
009500     05  PC-501                      PIC S9(04)    VALUE +501     00920000
009600                                                   COMP.          00930000
009700     05  PC-502                      PIC S9(04)    VALUE +502     00940000
009800                                                   COMP.          00950000
009900     05  PC-508                      PIC S9(04)    VALUE +508     00960000
010000                                                   COMP.          00970000
010100     05  PC-509                      PIC S9(04)    VALUE +509     00980000
010200                                                   COMP.          00990000
010300     05  PC-510                      PIC S9(04)    VALUE +510     01000000
010400                                                   COMP.          01010000
010500     05  PC-512                      PIC S9(04)    VALUE +512     01020000
010600                                                   COMP.          01030000
010700     05  PC-520                      PIC S9(04)    VALUE +520     01040000
010800                                                   COMP.          01050000
010900     05  PC-521                      PIC S9(04)    VALUE +521     01060000
011000                                                   COMP.          01070000
011100     05  PC-530                      PIC S9(04)    VALUE +530     01080000
011200                                                   COMP.          01090000
011300     05  PC-570                      PIC S9(04)    VALUE +570     01100000
011400                                                   COMP.          01110000
011500     05  PC-571                      PIC S9(04)    VALUE +571     01120000
011600                                                   COMP.          01130000
011700     05  PC-579                      PIC S9(04)    VALUE +579     01140000
011800                                                   COMP.          01150000
011900     05  PC-580                      PIC S9(04)    VALUE +580     01160000
012000                                                   COMP.          01170000
012100     05  PC-582                      PIC S9(04)    VALUE +582     01180000
012200                                                   COMP.          01190000
012300     05  PC-583                      PIC S9(04)    VALUE +583     01200000
012400                                                   COMP.          01210000
012500     05  PC-591                      PIC S9(04)    VALUE +591     01220000
012600                                                   COMP.          01230000
012700     05  PC-592                      PIC S9(04)    VALUE +592     01240000
012800                                                   COMP.          01250000
012900     05  PC-999                       PIC X(03) VALUE '999'.      01255099
013000                                                                          
013100*--------------------------------------------------------------*          
013200*                                                              *          
013300*                                                              *          
013400*--------------------------------------------------------------*          
013500                                                                          
013600     05  PV-REASON-CODE              PIC S9(4)     VALUE 0 COMP.          
013700         88  PC-SHORT-REASON         VALUES  510, 512, 450, 451,          
013800                                             452, 453, 454, 455,          
013900                                             456, 457, 458,               
013910                                             470, 471, 473.               
014000                                                                          
014100         88  PC-PACK-SHORT-REASON    VALUES  570, 571,                    
014200                                             459, 460,                    
014210                                             461, 462, 463, 464,          
014300                                             465, 466, 467,               
014310                                             468, 469, 472.               
014400                                                                          
014500         88  PC-OVER-REASON          VALUES  520, 521,                    
014510                                             610, 611, 612, 613,          
014600                                             614, 615, 616, 617,          
014700                                             618, 619,                    
014800                                             620, 621, 622, 623,          
014900                                             624, 625, 626, 627,          
015000                                             628, 629,                    
015100                                             630, 631, 632, 633,          
015200                                             634, 635, 636, 637,          
015300                                             638, 639,                    
015400                                             640, 641, 642, 643,          
015500                                             644, 645, 646, 647,          
015600                                             648, 649.                    
015700                                                                          
015800         88  PC-PACK-OVER-REASON     VALUES  579, 580,                    
015810                                             650, 651, 652, 653,          
015900                                             654, 655, 656, 657,          
016000                                             658, 659,                    
016100                                             660, 661, 662, 663,          
016200                                             664, 665, 666, 667,          
016300                                             668, 669,                    
016400                                             670, 671, 672, 673,          
016500                                             674, 675, 676, 677,          
016600                                             678, 679,                    
016700                                             680, 681, 682, 683,          
016800                                             684, 685, 686, 687,          
016900                                             688, 689.                    
017000                                                                          
017020     05  PC-SAVE-REASON-CODE         PIC S9(4)     VALUE 0 COMP.          
017030         88  PC-SAVE-SHORT-REASON    VALUES  510, 512, 450, 451,          
017040                                             452, 453, 454, 455,          
017050                                             456, 457, 458.               
017060                                                                          
017070         88  PC-SAVE-PACK-SHORT-REASON VALUES 520, 521, 459, 460,         
017080                                             461, 462, 463, 464,          
017090                                             465, 466, 467.               
017091                                                                          
017092         88  PC-SAVE-OVER-REASON     VALUES  610, 611, 612, 613,          
017093                                             614, 615, 616, 617,          
017094                                             618, 619,                    
017095                                             620, 621, 622, 623,          
017096                                             624, 625, 626, 627,          
017097                                             628, 629,                    
017098                                             630, 631, 632, 633,          
017099                                             634, 635, 636, 637,          
017100                                             638, 639,                    
017101                                             640, 641, 642, 643,          
017102                                             644, 645, 646, 647,          
017103                                             648, 649.                    
017104                                                                          
017105         88  PC-SAVE-PACK-OVER-REASON VALUES 650, 651, 652, 653,          
017106                                             654, 655, 656, 657,          
017107                                             658, 659,                    
017108                                             660, 661, 662, 663,          
017109                                             664, 665, 666, 667,          
017110                                             668, 669,                    
017111                                             670, 671, 672, 673,          
017112                                             674, 675, 676, 677,          
017113                                             678, 679,                    
017114                                             680, 681, 682, 683,          
017115                                             684, 685, 686, 687,          
017116                                             688, 689.                    
017117                                                                          
017120     05  PC-MIN-UPC                  PIC S9(15)V                  01260000
017200                                     VALUE +000400000000000       01270000
017300                                     COMP-3.                      01280000
017400     05  PC-MAX-UPC                  PIC S9(15)V                  01290000
017500                                     VALUE +000409999999999       01300000
017600                                     COMP-3.                      01310000
017700     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01320000
017800     05  PC-ACTIVE                   PIC  X(01)    VALUE 'A'.     01330000
017900     05  PC-TMKRP009                 PIC  X(08)    VALUE          01340000
018000         'TMKRP009'.                                              01350000
018100     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       01360000
018200     05  PC-REPORT-NBR-2             PIC  9(01)    VALUE 2.       01370000
018300     05  PC-REPORT-NBR-3             PIC  9(01)    VALUE 3.       01380000
018400     05  PC-NOT-FOUND                PIC  X(25)    VALUE          01390000
018500         '** NOT FOUND **          '.                             01400000
018600     05  PC-DETAIL                   PIC  X(09)    VALUE          01410000
018700         'DETAIL:  '.                                             01420000
018800     05  PC-SPECIAL-REQUEST          PIC  X(27)    VALUE          01430000
018900         '** SPECIAL REQUESTED RUN **'.                           01440000
019000     05  PC-MULTIPLE-UPCS            PIC  X(15)    VALUE          01450000
019100         'MORE THAN 1 UPC'.                                       01460000
019200     05  PC-NO-VENDOR-UPC            PIC  X(15)    VALUE          01470000
019300         'NO VENDOR UPC  '.                                       01480000
019400     05  PC-TEXT-EMPTY           PIC X(50) VALUE                  01490000
019500         '.                                                 '.    01500000
019600     05  PC-EARLY-TOTAL          PIC  X(33)    VALUE              01510000
019700         'TOTAL NUMBER OF EARLY SHIPMENTS  '.                     01520000
019800     05  PC-LATE-TOTAL          PIC  X(33)    VALUE               01530000
019900         'TOTAL NUMBER OF LATE SHIPMENTS   '.                     01540000
020000     05  PC-SHORT-TOTAL          PIC  X(33)    VALUE              01550000
020100         'TOTAL NUMBER OF SHORT SHIPMENTS  '.                     01560000
020200     05  PC-OVER-TOTAL           PIC  X(33)    VALUE              01570000
020300         'TOTAL NUMBER OF OVER SHIPMENTS   '.                     01580000
020400     05  PC-BADPK-TOTAL          PIC  X(33)    VALUE              01590000
020500         'TOTAL NUMBER OF BAD PK SHIPMENTS '.                     01600000
020600                                                                  01610000
020700     05  PC-OVER-SHORT-TEXT.                                      01620000
020800             15  PC-OS-TEXT-1         PIC X(25) VALUE             01630000
020900             '         UNITS RECEIVED: '.                         01640000
021000             15  PC-OS-TEXT-2         PIC X(25) VALUE             01650000
021100             '  UNITS OPEN-TO-RECEIVE: '.                         01660000
021200             15  PC-OS-TEXT-3         PIC X(25) VALUE             01670000
021300             '            UNITS  OVER: '.                         01680000
021400             15  PC-OS-TEXT-4         PIC X(25) VALUE             01690000
021500             '            UNITS SHORT: '.                         01700000
021600                                                                  01710000
021700******************************************************            01720000
021800*** FOR PROCESSING REPORTING GROUP G, F OR H                      01730000
021900******************************************************            01740000
022000     05  PC-PK-OVER-SHORT-TEXT.                                   01750000
022100             15  PC-PKOS-TEXT-1       PIC X(14) VALUE             01760000
022200             'PACK RECEIVED:'.                                    01770000
022300             15  PC-PKOS-TEXT-2       PIC X(14) VALUE             01780000
022400             'PACK OTR     :'.                                    01790000
022500             15  PC-PKOS-TEXT-3       PIC X(14) VALUE             01800000
022600             'PACKS SHORT  :'.                                    01810000
022700             15  PC-PKOS-TEXT-4       PIC X(14) VALUE             01820000
022800             'PACKS  OVER  :'.                                    01830000
022900             15  PC-PKOS-TEXT-5       PIC X(19) VALUE             01840000
023000             'ODD UNIT          :'.                               01850000
023100             15  PC-PKOS-TEXT-6       PIC X(19) VALUE             01860000
023200             'ODD UNIT DOLLARS  :'.                               01870000
023300                                                                  01880000
023400******************************************************            01890000
023500*** FOR PROCESSING REPORTING GROUP I OR J                         01900000
023600******************************************************            01910000
023700     05  PC-PKLN-OVER-SHORT-TEXT.                                 01920000
023800             15  PC-PKLOS-TEXT-1      PIC X(14) VALUE             01930000
023900             'LINE RECEIVED:'.                                    01940000
024000             15  PC-PKLOS-TEXT-2      PIC X(14) VALUE             01950000
024100             'LINE OTR     :'.                                    01960000
024200             15  PC-PKLOS-TEXT-3      PIC X(14) VALUE             01970000
024300             'LINE  SHORT  :'.                                    01980000
024400             15  PC-PKLOS-TEXT-4      PIC X(14) VALUE             01990000
024500             'LINE   OVER  :'.                                    02000000
024600                                                                  02010000
024700*                                                                 02020000
024800 01  PV-MISC-FIELDS.                                              02030000
024900     05  PV-DIFFERENCE               PIC 9(09)     VALUE ZERO.    02040000
025000     05  PV-PK-OTR                   PIC 9(09)     VALUE ZERO.    02050000
025100     05  PV-PK-RECEIVED              PIC 9(09)     VALUE ZERO.    02060000
025200     05  PV-PK-PERCENT               PIC S9(04)V99 VALUE ZERO     02070000
025300                                                   COMP-3.        02080000
025400     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     02090000
025500                                                   COMP-3.        02100000
025600     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     02110000
025700                                                   COMP-3.        02120000
025800     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     02130000
025900                                                   COMP-3.        02140000
026000     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     02150000
026100                                                   COMP SYNC.     02160000
026200     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  02170000
026300     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    02170100
026400     05  PV-ABEND-INFO.                                           02171099
026500         10  PV-ABEND-MESSAGE-TEXT   PIC  X(40)    VALUE SPACES.  02172000
026600         10  PV-SQLCODE              PIC  S9(9)    VALUE ZEROES.  02173000
026700         10  PV-DB2-VIEW-NAME        PIC  X(10)    VALUE SPACES.  02174000
026800                                                                  02175000
026900     05  PV-SKU.                                                  02240200
027000         10  PV-SKU-DEPT             PIC  X(03)    VALUE SPACES.  02240300
027100         10  FILLER                  PIC  X(01)    VALUE SPACE.   02240400
027200         10  PV-SKU-CLASS            PIC  X(02)    VALUE SPACES.  02240500
027300         10  FILLER                  PIC  X(01)    VALUE SPACE.   02240600
027400         10  PV-SKU-SEQ              PIC  X(08)    VALUE SPACES.  02240700
027500     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    02250000
027600     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    02260000
027700     05  PV-PO-RECEIVER.                                          02270000
027800* *PS 10/10/2014 STARTS                                           02280000
027800         10  PV-PO                   PIC  9(08)    VALUE ZERO.    02280000
027800* *PS 10/10/2014 ENDS                                             02280000
027900         10  FILLER                  PIC  X(01)    VALUE '-'.     02290000
028000         10  PV-RECEIVER             PIC  9(04)    VALUE ZERO.    02300000
028100         10  PV-RECEIVER-X REDEFINES PV-RECEIVER                  02310000
028200                                     PIC  X(04).                  02320000
028300     05  PV-TODAYS-DATE.                                          02330000
028400         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    02340000
028500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    02350000
028600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    02360000
028700     05  PV-TODAYS-TIME.                                          02370000
028800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    02380000
028900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02390000
029000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02400000
029100         10  FILLER                  PIC  9(02)    VALUE ZERO.    02410000
029200     05  PV-FORMAT-DATE.                                          02420000
029300         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  02430000
029400         10  FILLER                  PIC  X(01)    VALUE '/'.     02440000
029500         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  02450000
029600         10  FILLER                  PIC  X(01)    VALUE '/'.     02460000
029700         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  02470000
029800     05  PV-FORMAT-TIME.                                          02480000
029900         10  PV-FORMAT-TIME-HH       PIC  X(02)    VALUE SPACES.  02490000
030000         10  FILLER                  PIC  X(01)    VALUE ':'.     02500000
030100         10  PV-FORMAT-TIME-MN       PIC  X(02)    VALUE SPACES.  02510000
030200         10  FILLER                  PIC  X(01)    VALUE ':'.     02520000
030300         10  PV-FORMAT-TIME-SS       PIC  X(02)    VALUE SPACES.  02530000
030400     05  PV-DB2-TMST.                                             02540000
030500         10  PV-DB2-TMST-YYYY        PIC  X(04)    VALUE SPACES.  02550000
030600         10  FILLER                  PIC  X(01)    VALUE '/'.     02560000
030700         10  PV-DB2-TMST-MM          PIC  X(02)    VALUE SPACES.  02570000
030800         10  FILLER                  PIC  X(01)    VALUE '/'.     02580000
030900         10  PV-DB2-TMST-DD          PIC  X(02)    VALUE SPACES.  02590000
031000         10  FILLER                  PIC  X(01)    VALUE '/'.     02600000
031100         10  PV-DB2-TMST-HH          PIC  X(02)    VALUE SPACES.  02610000
031200         10  FILLER                  PIC  X(01)    VALUE '/'.     02620000
031300         10  PV-DB2-TMST-MN          PIC  X(02)    VALUE SPACES.  02630000
031400         10  FILLER                  PIC  X(01)    VALUE '/'.     02640000
031500         10  PV-DB2-TMST-SS          PIC  X(02)    VALUE SPACES.  02650000
031600         10  FILLER                  PIC  X(01)    VALUE '/'.     02660000
031700         10  PV-DB2-TMST-MS          PIC  X(06)    VALUE SPACES.  02670000
031800     05  PV-DB2-DATE.                                             02680000
031900         10  PV-DB2-DATE-YYYY        PIC  X(04)    VALUE SPACES.  02690000
032000         10  FILLER                  PIC  X(01)    VALUE '/'.     02700000
032100         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE SPACES.  02710000
032200         10  FILLER                  PIC  X(01)    VALUE '/'.     02720000
032300         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE SPACES.  02730000
032400     05  PV-SAVE-PO-NUMBER           PIC S9(09)    VALUE ZERO     02740000
032500                                                   COMP SYNC.     02750000
032600     05  PV-SAVE-REC-SEQ-NBR         PIC S9(09)    VALUE ZERO     02760000
032700                                                   COMP SYNC.     02770000
032800     05  PV-SAVE-TRBL-RSN-CDE        PIC S9(04)    VALUE ZERO     02780000
032900                                                   COMP SYNC.     02790000
033000     05  PV-SAVE-PREPK-ID            PIC S9(09)    VALUE ZERO     02800000
033100                                                   COMP SYNC.     02810000
033200     05  PV-SAVE-PO-LNE-NBR          PIC S9(09)    VALUE ZERO     02820000
033300                                                   COMP SYNC.     02830000
033400     05  PV-SAVE-NOTIF-TMST          PIC  X(26)    VALUE SPACES.  02840000
033500     05  PV-TEXT-TABLE               PIC  X(250).                 02850000
033600     05  FILLER REDEFINES PV-TEXT-TABLE.                          02860000
033700         10  PV-TEXT  OCCURS 5 TIMES.                             02870000
033800             15  PV-TEXT-1           PIC  X(25).                  02880000
033900             15  PV-TEXT-2           PIC  X(25).                  02890000
034000                                                                  02900000
034100*******************************************************           02910000
034200*** FOR PROCESSING REPORTING GROUP G, F OR H                      02920000
034300*******************************************************           02930000
034400     05  PV-TEXT-TABLE-2           PIC X(250).                    02940000
034500     05  FILLER REDEFINES PV-TEXT-TABLE-2.                        02950000
034600         10  PV-PK-TEST    OCCURS 5 TIMES.                        02960000
034700             15  PV-PK-TEXT-1      PIC X(14).                     02970000
034800             15  PV-PK-TEXT-2      PIC X(05).                     02980000
034900             15  PV-PK-TEXT-3      PIC X(05).                     02990000
035000             15  PV-PK-TEXT-4      PIC X(19).                     03000000
035100             15  PV-PK-TEXT-5      PIC X(07).                     03010000
035200                                                                  03020000
035300*******************************************************           03030000
035400*** FOR PROCESSING REPORTING GROUP I OR J                         03040000
035500*******************************************************           03050000
035600     05  PV-TEXT-TABLE-3           PIC X(250).                    03060000
035700     05  FILLER REDEFINES PV-TEXT-TABLE-3.                        03070000
035800         10  PV-PKLN-TEXT  OCCURS 5 TIMES.                        03080000
035900             15  PV-PKLN-TEXT-1      PIC X(14).                   03090000
036000             15  PV-PKLN-TEXT-2      PIC X(05).                   03100000
036100             15  PV-PKLN-TEXT-3      PIC X(31).                   03110000
036200*******************************************************           03120000
036300                                                                  03130000
036400     05  PV-SUB                      PIC S9(04)    VALUE ZERO     03140000
036500                                                   COMP SYNC.     03150000
036600     05  PV-NUM-SUB                  PIC S9(04)    VALUE ZERO     03160000
036700                                                   COMP SYNC.     03170000
036800     05  PV-NUMERIC-REDEF.                                        03180000
036900         10  PV-NUMERIC-Z         PIC  X(09).                     03190000
037000         10  FILLER REDEFINES PV-NUMERIC-Z.                       03200000
037100             15  PV-NUM OCCURS 9 TIMES                            03210000
037200                                  PIC  X(01).                     03220000
037300         10  FILLER               PIC  X(16).                     03230000
037400                                                                  03240000
037500     05  PV-NUMERIC-REDEF-1.                                      03250000
037600         10  PV-NUMERIC-Z-1       PIC  X(05).                     03260000
037700         10  FILLER REDEFINES PV-NUMERIC-Z-1.                     03270000
037800             15  PV-NUM-1 OCCURS 5 TIMES                          03280000
037900                                  PIC  X(01).                     03290000
038000                                                                  03300000
038100     05  PV-NUMERIC-REDEF-2.                                      03310000
038200         10  PV-NUMERIC-Z-2       PIC  X(07).                     03320000
038300         10  FILLER REDEFINES PV-NUMERIC-Z-2.                     03330000
038400             15  PV-NUM-2 OCCURS 7 TIMES                          03340000
038500                                  PIC  X(01).                     03350000
038600                                                                  03360000
038700     05  PV-EXTRACT-NUMBER        PIC  9(09).                     03370000
038800     05  FILLER REDEFINES PV-EXTRACT-NUMBER.                      03380000
038900         10  PV-NUMBER OCCURS 5 TIMES                             03390000
039000                                  PIC  X(01).                     03400000
039100                                                                  03410000
039200     05  PV-EXTRACT-NUMBER-1      PIC  9(05).                     03420000
039300     05  FILLER REDEFINES PV-EXTRACT-NUMBER-1.                    03430000
039400         10  PV-NUMBER-1 OCCURS 5 TIMES                           03440000
039500                                  PIC  X(01).                     03450000
039600                                                                  03460000
039700     05  PV-EXTRACT-NUMBER-2      PIC  9(07).                     03470000
039800     05  FILLER REDEFINES PV-EXTRACT-NUMBER-2.                    03480000
039900         10  PV-NUMBER-2 OCCURS 7 TIMES                           03490000
040000                                  PIC  X(01).                     03500000
040100                                                                  03510000
040200*                                                                 03520000
040300 01  PV-TOTAL-FIELDS.                                             03530000
040400     05  PV-EARLY-LATE-TOT            PIC S9(05)  COMP-3          03540000
040500                                                  VALUE ZERO.     03550000
040600     05  PV-SHORT-OVER-TOT            PIC S9(05)  COMP-3          03560000
040700                                                  VALUE ZERO.     03570000
040800     05  PV-STYLE-SUB-CRTN-TOT        PIC S9(05)  COMP-3          03580000
040900                                                  VALUE ZERO.     03590000
041000     05  PV-TEMP-SEQ-NBR              PIC  9(08).                 03611000
041100     05  DK-ITM-NBR                   PIC  S9(15)V COMP-3.        03613000
041200     05  PV-TEMP-UPC-NBR              PIC  9(15).                 03613100
041300                                                                  03615099
041400     COPY DPWS024.                                                03620099
041500                                                                  03630000
041600     COPY TMRD001.                                                03640099
041500                                                                  03630000
041600     COPY XLWS067.                                                03640099
041700 EJECT                                                            03650000
041800*                                                                 03660000
041900******************************************************************03670000
042000*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               03680000
042100******************************************************************03690000
042200     COPY DPWS132O.                                               03700099
042300*                                                                 03710000
042400*                                                                 03720000
042500 01  HEADING-LINES.                                               03730000
042600     05  HEADING-LINE-1.                                          03740000
042700         10  HL1-SPECIAL-RUN-MSG     PIC  X(27)    VALUE SPACES.  03750000
042800         10  FILLER                  PIC  X(20)    VALUE SPACES.  03760000
042900         10  FILLER                  PIC  X(27)    VALUE          03770000
043000             'DAILY TROUBLE BY VENDOR ON '.                       03780000
043100         10  HL1-TROUBLE-DATE        PIC  X(10).                  03790000
043200         10  FILLER                  PIC  X(48)    VALUE SPACES.  03800000
043300                                                                  03810000
043400     05  HEADING-LINE-1W.                                         03820000
043500         10  HL1W-SPECIAL-RUN-MSG    PIC  X(27)    VALUE SPACES.  03830000
043600         10  FILLER                  PIC  X(13)    VALUE SPACES.  03840000
043700         10  FILLER                  PIC  X(41)    VALUE          03850000
043800             'WEEKLY TROUBLE BY VENDOR FOR WEEK ENDING '.         03860000
043900         10  HL1W-TROUBLE-DATE       PIC  X(10).                  03870000
044000         10  FILLER                  PIC  X(41)    VALUE SPACES.  03880000
044100                                                                  03890000
044200     05  HEADING-LINE-1M.                                         03900000
044300         10  HL1M-SPECIAL-RUN-MSG    PIC  X(27)    VALUE SPACES.  03910000
044400         10  FILLER                  PIC  X(13)    VALUE SPACES.  03920000
044500         10  FILLER                  PIC  X(43)    VALUE          03930000
044600             'MONTHLY TROUBLE BY VENDOR FOR MONTH ENDING '.       03940000
044700         10  HL1M-TROUBLE-DATE       PIC  X(10).                  03950000
044800         10  FILLER                  PIC  X(39)    VALUE SPACES.  03960000
044900*                                                                 03970000
045000     05  HEADING-LINE-2.                                          03980000
045100         10  FILLER                  PIC  X(46)    VALUE SPACE.   03990000
045200         10  FILLER                  PIC  X(39)    VALUE          04000000
045300             'EARLY SHIPMENTS AND STYLE SUBSTITUTIONS'.           04010000
045400         10  FILLER                  PIC  X(47)    VALUE SPACES.  04020000
045500*                                                                 04030000
045600     05  HEADING-LINE-2W.                                         04040000
045700         10  FILLER                  PIC  X(22)    VALUE SPACE.   04050000
045800         10  FILLER                  PIC  X(50)    VALUE          04060000
045900             'EARLY SHIPMENTS, LATE SHIPMENTS, SHORT SHIPMENTS, '.04070000
046000         10  FILLER                  PIC  X(38)    VALUE          04080000
046100             'OVER SHIPMENTS AND STYLE SUBSTITUTIONS'.            04090000
046200         10  FILLER                  PIC  X(22)    VALUE SPACES.  04100000
046300*                                                                 04110000
046400     05  HEADING-LINE-2M.                                         04120000
046500         10  FILLER                  PIC  X(22)    VALUE SPACE.   04130000
046600         10  FILLER                  PIC  X(50)    VALUE          04140000
046700             'EARLY SHIPMENTS, LATE SHIPMENTS, SHORT SHIPMENTS, '.04150000
046800         10  FILLER                  PIC  X(38)    VALUE          04160000
046900             'OVER SHIPMENTS AND STYLE SUBSTITUTIONS'.            04170000
047000         10  FILLER                  PIC  X(22)    VALUE SPACES.  04180000
047100*                                                                 04190000
047200     05  HEADING-LINE-3.                                          04200000
047300         10  FILLER                  PIC  X(14)    VALUE          04210000
047400             'VENDOR NAME:  '.                                    04220000
047500         10  HL3-VENDOR-NAME         PIC  X(30).                  04230000
047600         10  FILLER                  PIC  X(88)    VALUE SPACES.  04240000
047700*                                                                 04250000
047800     05  HEADING-LINE-4-EARLY.                                    04260000
047900         10  FILLER                  PIC  X(02)    VALUE SPACES.  04270000
048000         10  FILLER                  PIC  X(15)    VALUE          04280000
048100             'EARLY SHIPMENTS'.                                   04290000
048200         10  FILLER                  PIC  X(115)   VALUE SPACES.  04300000
048300*                                                                 04310000
048400     05  HEADING-LINE-4-LATE.                                     04320000
048500         10  FILLER                  PIC  X(02)    VALUE SPACES.  04330000
048600         10  FILLER                  PIC  X(14)    VALUE          04340000
048700             'LATE SHIPMENTS'.                                    04350000
048800         10  FILLER                  PIC  X(116)   VALUE SPACES.  04360000
048900*                                                                 04370000
049000     05  HEADING-LINE-5.                                          04380000
049100         10  FILLER                  PIC  X(28)    VALUE SPACES.  04390000
049200         10  FILLER                  PIC  X(11)    VALUE          04400000
049300             'DO NOT SHIP'.                                       04410000
049400         10  FILLER                  PIC  X(09)    VALUE SPACES.  04420000
049500         10  FILLER                  PIC  X(06)    VALUE          04430000
049600             'VENDOR'.                                            04440000
049700         10  FILLER                  PIC  X(14)    VALUE SPACES.  04450000
049800         10  FILLER                  PIC  X(07)    VALUE          04460000
049900             'RECEIPT'.                                           04470000
050000         10  FILLER                  PIC  X(13)    VALUE SPACES.  04480000
050100         10  FILLER                  PIC  X(08)    VALUE          04490000
050200             'TROUBLE'.                                           04500000
050300         10  FILLER                  PIC  X(36)    VALUE SPACES.  04510000
050400*                                                                 04520000
050500     05  HEADING-LINE-6.                                          04530000
050600         10  FILLER                  PIC  X(06)    VALUE SPACES.  04540000
050700         10  FILLER                  PIC  X(11)    VALUE          04550000
050800             'PO/RECEIVER'.                                       04560000
050900         10  FILLER                  PIC  X(11)    VALUE SPACES.  04570000
051000         10  FILLER                  PIC  X(11)    VALUE          04580000
051100             'BEFORE DATE'.                                       04590000
051200         10  FILLER                  PIC  X(09)    VALUE SPACES.  04600000
051300         10  FILLER                  PIC  X(09)    VALUE          04610000
051400             'SHIP DATE'.                                         04620000
051500         10  FILLER                  PIC  X(11)    VALUE SPACES.  04630000
051600         10  FILLER                  PIC  X(04)    VALUE          04640000
051700             'DATE'.                                              04650000
051800         10  FILLER                  PIC  X(16)    VALUE SPACES.  04660000
051900         10  FILLER                  PIC  X(06)    VALUE          04670000
052000             'REASON'.                                            04680000
052100         10  FILLER                  PIC  X(38)    VALUE SPACES.  04690000
052200*                                                                 04700000
052300     05  HEADING-LINE-7-SHORT.                                    04710000
052400         10  FILLER                  PIC  X(02)    VALUE SPACES.  04720000
052500         10  FILLER                  PIC  X(15)    VALUE          04730000
052600             'SHORT SHIPMENTS'.                                   04740000
052700         10  FILLER                  PIC  X(115)   VALUE SPACES.  04750000
052800*                                                                 04760000
052900     05  HEADING-LINE-7-OVER.                                     04770000
053000         10  FILLER                  PIC  X(02)    VALUE SPACES.  04780000
053100         10  FILLER                  PIC  X(14)    VALUE          04790000
053200             'OVER SHIPMENTS'.                                    04800000
053300         10  FILLER                  PIC  X(116)   VALUE SPACES.  04810000
053400*                                                                 04820000
053500     05  HEADING-LINE-8.                                          04830000
053600         10  FILLER                  PIC  X(20)    VALUE SPACES.  04831100
053700         10  FILLER                  PIC  X(10)    VALUE          04832000
053800             'PO  SKU   '.                                        04833000
053900         10  FILLER                  PIC  X(13)    VALUE SPACES.  04834000
054000         10  FILLER                  PIC  X(12)    VALUE          04835000
054100             'UPC ORDERED/'.                                      04836000
054200         10  FILLER                  PIC  X(07)    VALUE SPACES.  04837000
054300         10  FILLER                  PIC  X(12)    VALUE          04838000
054400             'VENDOR STYLE'.                                      04839000
054500         10  FILLER                  PIC  X(06)    VALUE SPACES.  04839100
054600         10  FILLER                  PIC  X(10)    VALUE          04839200
054700             'UNITS OPEN'.                                        04839300
054800         10  FILLER                  PIC  X(04)    VALUE SPACES.  04839400
054900         10  FILLER                  PIC  X(05)    VALUE          04839500
055000             'UNITS'.                                             04839600
055100         10  FILLER                  PIC  X(06)    VALUE SPACES.  04839700
055200         10  FILLER                  PIC  X(05)    VALUE          04839800
055300             'UNITS'.                                             04839900
055400         10  FILLER                  PIC  X(03)    VALUE SPACES.  04840000
055500         10  FILLER                  PIC  X(07)    VALUE          04840100
055600             'PERCENT'.                                           04840200
055700         10  FILLER                  PIC  X(03)    VALUE SPACES.  04840300
055800         10  FILLER                  PIC  X(07)    VALUE          04840400
055900             'TROUBLE'.                                           04840500
056000         10  FILLER                  PIC  X(02)    VALUE SPACES.  04840600
056100*                                                                 04840700
056200     05  HEADING-LINE-9-SHORT.                                    04840800
056300         10  FILLER                  PIC  X(06)    VALUE SPACES.  04840900
056400         10  FILLER                  PIC  X(11)    VALUE          04841000
056500             'PO/RECEIVER'.                                       04841100
056600         10  FILLER                  PIC  X(02)    VALUE SPACES.  04841200
056700         10  FILLER                  PIC  X(04)    VALUE          04841300
056800             'LINE'.                                              04841400
056900         10  FILLER                  PIC  X(01)    VALUE SPACES.  04841500
057000         10  FILLER                  PIC  X(07)    VALUE          04841600
057100             'ORDERED'.                                           04841700
057200         10  FILLER                  PIC  X(12)    VALUE SPACES.  04841800
057300         10  FILLER                  PIC  X(16)    VALUE          04841900
057400             'ITEM DESCRIPTION'.                                  04842000
057500         10  FILLER                  PIC  X(03)    VALUE SPACES.  04842100
057600         10  FILLER                  PIC  X(07)    VALUE          04842200
057700             'ORDERED'.                                           04842300
057800         10  FILLER                  PIC  X(11)    VALUE SPACES.  04842400
057900         10  FILLER                  PIC  X(10)    VALUE          04842500
058000             'TO RECEIVE'.                                        04842600
058100         10  FILLER                  PIC  X(03)    VALUE SPACES.  04842700
058200         10  FILLER                  PIC  X(08)    VALUE          04842800
058300             'RECEIVED'.                                          04842900
058400         10  FILLER                  PIC  X(04)    VALUE SPACES.  04843000
058500         10  FILLER                  PIC  X(05)    VALUE          04843100
058600             'SHORT'.                                             04843200
058700         10  FILLER                  PIC  X(04)    VALUE SPACES.  04843300
058800         10  FILLER                  PIC  X(05)    VALUE          04843400
058900             'SHORT'.                                             04843500
059000         10  FILLER                  PIC  X(04)    VALUE SPACES.  04843600
059100         10  FILLER                  PIC  X(06)    VALUE          04843700
059200             'REASON'.                                            04843800
059300         10  FILLER                  PIC  X(03)    VALUE SPACES.  04843900
059400*                                                                 05420000
059500     05  HEADING-LINE-9-OVER.                                     05430000
059600         10  FILLER                  PIC  X(06)    VALUE SPACES.  05440000
059700         10  FILLER                  PIC  X(11)    VALUE          05450000
059800             'PO/RECEIVER'.                                       05460000
059900         10  FILLER                  PIC  X(02)    VALUE SPACES.  05470000
060000         10  FILLER                  PIC  X(04)    VALUE          05480000
060100             'LINE'.                                              05490000
060200         10  FILLER                  PIC  X(01)    VALUE SPACES.  05500000
060300         10  FILLER                  PIC  X(07)    VALUE          05510000
060400             'ORDERED'.                                           05520000
060500         10  FILLER                  PIC  X(12)    VALUE SPACES.  05530000
060600         10  FILLER                  PIC  X(16)    VALUE          05540000
060700             'ITEM DESCRIPTION'.                                  05550000
060800         10  FILLER                  PIC  X(03)    VALUE SPACES.  05560000
060900         10  FILLER                  PIC  X(07)    VALUE          05570000
061000             'ORDERED'.                                           05580000
061100         10  FILLER                  PIC  X(11)    VALUE SPACES.  05590000
061200         10  FILLER                  PIC  X(10)    VALUE          05600000
061300             'TO RECEIVE'.                                        05610000
061400         10  FILLER                  PIC  X(03)    VALUE SPACES.  05620000
061500         10  FILLER                  PIC  X(08)    VALUE          05630000
061600             'RECEIVED'.                                          05640000
061700         10  FILLER                  PIC  X(04)    VALUE SPACES.  05650000
061800         10  FILLER                  PIC  X(04)    VALUE          05660000
061900             'OVER'.                                              05670000
062000         10  FILLER                  PIC  X(05)    VALUE SPACES.  05680000
062100         10  FILLER                  PIC  X(04)    VALUE          05690000
062200             'OVER'.                                              05700000
062300         10  FILLER                  PIC  X(05)    VALUE SPACES.  05710000
062400         10  FILLER                  PIC  X(06)    VALUE          05720000
062500             'REASON'.                                            05730000
062600         10  FILLER                  PIC  X(03)    VALUE SPACES.  05740000
062700*                                                                 05750000
062800     05  HEADING-LINE-10.                                         05760000
062900         10  FILLER                  PIC  X(02)    VALUE SPACES.  05770000
063000         10  FILLER                  PIC  X(19)    VALUE          05780000
063100             'STYLE SUBSTITUTIONS'.                               05790000
063200         10  FILLER                  PIC  X(111)   VALUE SPACES.  05800000
063300*                                                                 05810000
063400     05  HEADING-LINE-11.                                         05820000
063500         10  FILLER                  PIC  X(23)    VALUE SPACES.  05830000
063600         10  FILLER                  PIC  X(10)    VALUE          05840000
063700             'PO     SKU'.                                        05850000
063800         10  FILLER                  PIC  X(35)    VALUE SPACES.  05860000
063900         10  FILLER                  PIC  X(12)    VALUE          05870000
064000             'VENDOR STYLE'.                                      05880000
064100         10  FILLER                  PIC  X(52)    VALUE SPACES.  05890000
064200*                                                                 05900000
064300     05  HEADING-LINE-12.                                         05910000
064400         10  FILLER                  PIC  X(06)    VALUE SPACES.  05920000
064500         10  FILLER                  PIC  X(11)    VALUE          05930000
064600             'PO/RECEIVER'.                                       05940000
064700         10  FILLER                  PIC  X(05)    VALUE SPACES.  05950000
064800         10  FILLER                  PIC  X(04)    VALUE          05960000
064900             'LINE'.                                              05970000
065000         10  FILLER                  PIC  X(04)    VALUE SPACES.  05980000
065100         10  FILLER                  PIC  X(07)    VALUE          05990000
065200             'ORDERED'.                                           06000000
065300         10  FILLER                  PIC  X(12)    VALUE SPACES.  06010000
065400         10  FILLER                  PIC  X(11)    VALUE          06020000
065500             'UPC ORDERED'.                                       06030000
065600         10  FILLER                  PIC  X(08)    VALUE SPACES.  06040000
065700         10  FILLER                  PIC  X(07)    VALUE          06050000
065800             'ORDERED'.                                           06060000
065900         10  FILLER                  PIC  X(11)    VALUE SPACES.  06070000
066000         10  FILLER                  PIC  X(16)    VALUE          06080000
066100             'ITEM DESCRIPTION'.                                  06090000
066200         10  FILLER                  PIC  X(30)    VALUE SPACES.  06100000
066300                                                                  06110000
066400*************                                                     06120000
066500                                                                  06130000
066600     05  HEADING-PACK-OVER.                                       06140000
066700         10  FILLER                  PIC  X(02)    VALUE SPACES.  06150000
066800         10  FILLER                  PIC  X(19)    VALUE          06160000
066900             'PACK OVER SHIPMENTS'.                               06170000
067000         10  FILLER                  PIC  X(111)   VALUE SPACES.  06180000
067100                                                                  06190000
067200     05  HEADING-PACK-SHORT.                                      06200000
067300         10  FILLER                  PIC  X(02)    VALUE SPACES.  06210000
067400         10  FILLER                  PIC  X(20)    VALUE          06220000
067500             'PACK SHORT SHIPMENTS'.                              06230000
067600         10  FILLER                  PIC  X(110)   VALUE SPACES.  06240000
067700                                                                  06250000
067800     05  HEADING-PACK-BAD.                                        06260000
067900         10  FILLER                  PIC  X(02)    VALUE SPACES.  06270000
068000         10  FILLER                  PIC  X(18)    VALUE          06280000
068100             'BAD PACK SHIPMENTS'.                                06290000
068200         10  FILLER                  PIC  X(112)   VALUE SPACES.  06300000
068300                                                                  06310000
068400     05  HEADING-PACK-LINE-SHORT.                                 06320000
068500         10  FILLER                  PIC  X(02)    VALUE SPACES.  06330000
068600         10  FILLER                  PIC  X(15)    VALUE          06340000
068700             'PACK LINE SHORT'.                                   06350000
068800         10  FILLER                  PIC  X(115)   VALUE SPACES.  06360000
068900                                                                  06370000
069000     05  HEADING-PACK-LINE-OVER.                                  06380000
069100         10  FILLER                  PIC  X(02)    VALUE SPACES.  06390000
069200         10  FILLER                  PIC  X(14)    VALUE          06400000
069300             'PACK LINE OVER'.                                    06410000
069400         10  FILLER                  PIC  X(116)   VALUE SPACES.  06420000
069500                                                                  06430000
069600     05  HEADING-PKLINE-1.                                        06440000
069700         10  FILLER                  PIC  X(32)    VALUE SPACES.  06450000
069800         10  FILLER                  PIC  X(04)    VALUE          06460000
069900             'PACK'.                                              06470000
070000         10  FILLER                  PIC  X(35)    VALUE SPACES.  06480000
070100         10  FILLER                  PIC  X(04)    VALUE          06490000
070200             'PACK'.                                              06500000
070300         10  FILLER                  PIC  X(05)    VALUE SPACES.  06510000
070400         10  FILLER                  PIC  X(05)    VALUE          06520000
070500             'PACKS'.                                             06530000
070600         10  FILLER                  PIC  X(04)    VALUE SPACES.  06540000
070700         10  FILLER                  PIC  X(05)    VALUE          06550000
070800             'PACKS'.                                             06560000
070900         10  FILLER                  PIC  X(02)    VALUE SPACES.  06570000
071000         10  FILLER                  PIC  X(07)    VALUE          06580000
071100             'PERCENT'.                                           06590000
071200         10  FILLER                  PIC  X(05)    VALUE SPACES.  06600000
071300         10  FILLER                  PIC  X(03)    VALUE          06610000
071400             'ODD'.                                               06620000
071500         10  FILLER                  PIC  X(02)    VALUE SPACES.  06630000
071600         10  FILLER                  PIC  X(07)    VALUE          06640000
071700             'ODD UNT'.                                           06650000
071800         10  FILLER                  PIC  X(02)    VALUE SPACES.  06660000
071900         10  FILLER                  PIC  X(07)    VALUE          06670000
072000             'TROUBLE'.                                           06680000
072100                                                                  06690000
072200     05  HEADING-PKLINE-2.                                        06700000
072300         10  FILLER                  PIC  X(06)    VALUE SPACES.  06710000
072400         10  FILLER                  PIC  X(11)    VALUE          06720000
072500             'PO/RECEIVER'.                                       06730000
072600         10  FILLER                  PIC  X(04)    VALUE SPACES.  06740000
072700         10  FILLER                  PIC  X(07)    VALUE          06750000
072800             'PACK ID'.                                           06760000
072900         10  FILLER                  PIC  X(01)    VALUE SPACES.  06770000
073000         10  FILLER                  PIC  X(11)    VALUE          06780000
073100             'DESCRIPTION'.                                       06790000
073200         10  FILLER                  PIC  X(32)    VALUE SPACES.  06800000
073300         10  FILLER                  PIC  X(03)    VALUE          06810000
073400             'OTR'.                                               06820000
073500         10  FILLER                  PIC  X(02)    VALUE SPACES.  06830000
073600         10  FILLER                  PIC  X(08)    VALUE          06840000
073700             'RECEIVED'.                                          06850000
073800         10  FILLER                  PIC  X(04)    VALUE SPACES.  06860000
073900         10  FILLER                  PIC  X(05)    VALUE          06870000
074000             'OV/SH'.                                             06880000
074100         10  FILLER                  PIC  X(04)    VALUE SPACES.  06890000
074200         10  FILLER                  PIC  X(05)    VALUE          06900000
074300             'OV/SH'.                                             06910000
074400         10  FILLER                  PIC  X(03)    VALUE SPACES.  06920000
074500         10  FILLER                  PIC  X(05)    VALUE          06930000
074600             'UNITS'.                                             06940000
074700         10  FILLER                  PIC  X(02)    VALUE SPACES.  06950000
074800         10  FILLER                  PIC  X(07)    VALUE          06960000
074900             'DOLLARS'.                                           06970000
075000         10  FILLER                  PIC  X(02)    VALUE SPACES.  06980000
075100         10  FILLER                  PIC  X(06)    VALUE          06990000
075200             'REASON'.                                            07000000
075300                                                                  07010000
075400     05  HEADING-PKLINE-OVR.                                      07020000
075500         10  FILLER                  PIC  X(06)    VALUE SPACES.  07030000
075600         10  FILLER                  PIC  X(11)    VALUE          07040000
075700             'PO/RECEIVER'.                                       07050000
075800         10  FILLER                  PIC  X(04)    VALUE SPACES.  07060000
075900         10  FILLER                  PIC  X(07)    VALUE          07070000
076000             'PACK ID'.                                           07080000
076100         10  FILLER                  PIC  X(01)    VALUE SPACES.  07090000
076200         10  FILLER                  PIC  X(11)    VALUE          07100000
076300             'DESCRIPTION'.                                       07110000
076400         10  FILLER                  PIC  X(32)    VALUE SPACES.  07120000
076500         10  FILLER                  PIC  X(03)    VALUE          07130000
076600             'OTR'.                                               07140000
076700         10  FILLER                  PIC  X(02)    VALUE SPACES.  07150000
076800         10  FILLER                  PIC  X(08)    VALUE          07160000
076900             'RECEIVED'.                                          07170000
077000         10  FILLER                  PIC  X(04)    VALUE SPACES.  07180000
077100         10  FILLER                  PIC  X(05)    VALUE          07190000
077200             ' OVER'.                                             07200000
077300         10  FILLER                  PIC  X(04)    VALUE SPACES.  07210000
077400         10  FILLER                  PIC  X(05)    VALUE          07220000
077500             ' OVER'.                                             07230000
077600         10  FILLER                  PIC  X(03)    VALUE SPACES.  07240000
077700         10  FILLER                  PIC  X(05)    VALUE          07250000
077800             'UNITS'.                                             07260000
077900         10  FILLER                  PIC  X(02)    VALUE SPACES.  07270000
078000         10  FILLER                  PIC  X(07)    VALUE          07280000
078100             'DOLLARS'.                                           07290000
078200         10  FILLER                  PIC  X(02)    VALUE SPACES.  07300000
078300         10  FILLER                  PIC  X(06)    VALUE          07310000
078400             'REASON'.                                            07320000
078500                                                                  07330000
078600     05  HEADING-PKLINE-SHT.                                      07340000
078700         10  FILLER                  PIC  X(06)    VALUE SPACES.  07350000
078800         10  FILLER                  PIC  X(11)    VALUE          07360000
078900             'PO/RECEIVER'.                                       07370000
079000         10  FILLER                  PIC  X(04)    VALUE SPACES.  07380000
079100         10  FILLER                  PIC  X(07)    VALUE          07390000
079200             'PACK ID'.                                           07400000
079300         10  FILLER                  PIC  X(01)    VALUE SPACES.  07410000
079400         10  FILLER                  PIC  X(11)    VALUE          07420000
079500             'DESCRIPTION'.                                       07430000
079600         10  FILLER                  PIC  X(32)    VALUE SPACES.  07440000
079700         10  FILLER                  PIC  X(03)    VALUE          07450000
079800             'OTR'.                                               07460000
079900         10  FILLER                  PIC  X(02)    VALUE SPACES.  07470000
080000         10  FILLER                  PIC  X(08)    VALUE          07480000
080100             'RECEIVED'.                                          07490000
080200         10  FILLER                  PIC  X(04)    VALUE SPACES.  07500000
080300         10  FILLER                  PIC  X(05)    VALUE          07510000
080400             'SHORT'.                                             07520000
080500         10  FILLER                  PIC  X(04)    VALUE SPACES.  07530000
080600         10  FILLER                  PIC  X(05)    VALUE          07540000
080700             'SHORT'.                                             07550000
080800         10  FILLER                  PIC  X(03)    VALUE SPACES.  07560000
080900         10  FILLER                  PIC  X(05)    VALUE          07570000
081000             'UNITS'.                                             07580000
081100         10  FILLER                  PIC  X(02)    VALUE SPACES.  07590000
081200         10  FILLER                  PIC  X(07)    VALUE          07600000
081300             'DOLLARS'.                                           07610000
081400         10  FILLER                  PIC  X(02)    VALUE SPACES.  07620000
081500         10  FILLER                  PIC  X(06)    VALUE          07630000
081600             'REASON'.                                            07640000
081700*                                                                 07650000
081800*                                                                 07660000
081900 01  MISCELLANEOUS-LINES.                                         07670000
082000     05  END-OF-REPORT-LINE.                                      07680000
082100         10  FILLER                  PIC  X(44)    VALUE SPACES.  07690000
082200         10  FILLER                  PIC  X(45)    VALUE          07700000
082300             '*******   E N D   O F   R E P O R T   *******'.     07710000
082400         10  FILLER                  PIC  X(43)    VALUE SPACES.  07720000
082500*                                                                 07730000
082600 01  DETAIL-LINES.                                                07740000
082700     05  DETAIL-LINE-1.                                           07750000
082800         10  FILLER                  PIC  X(06)    VALUE SPACES.  07760000
082900*PS 10/10/2014 STARTS                                             07770000
082900         10  DL1-PO-RECEIVER         PIC  X(13)    VALUE SPACES.  07770000
082900*PS 10/10/2014 ENDS                                               07770000
083000         10  FILLER                  PIC  X(10)    VALUE SPACES.  07780000
083100         10  DL1-DONT-SHIP-B4-DATE   PIC  X(10)    VALUE SPACES.  07790000
083200         10  FILLER                  PIC  X(10)    VALUE SPACES.  07800000
083300         10  DL1-VENDOR-SHIP-DATE    PIC  X(10)    VALUE SPACES.  07810000
083400         10  FILLER                  PIC  X(10)    VALUE SPACES.  07820000
083500         10  DL1-RECEIPT-DATE        PIC  X(10)    VALUE SPACES.  07830000
083600         10  FILLER                  PIC  X(10)    VALUE SPACES.  07840000
083700         10  DL1-REASON-CODE         PIC  ZZ9      VALUE ZERO.    07850000
082900*PS 10/10/2014 STARTS                                             07770000
083800         10  FILLER                  PIC  X(40)    VALUE SPACES.  07860000
082900*PS 10/10/2014 ENDS                                               07770000
083900                                                                  07870000
084000     05  DETAIL-LINE-2.                                           07880000
084100         10  FILLER                  PIC  X(06)    VALUE SPACES.  07890000
084200         10  DL2-PO-RECEIVER         PIC  X(13)    VALUE SPACES.  07900000
084300         10  DL2-PO-LINE             PIC  ZZZ9     VALUE ZERO.    07920000
084400         10  FILLER                  PIC  X(01)    VALUE SPACES.  07930000
084500         10  DL2-SKU                 PIC  X(15)    VALUE SPACES.  07941000
084600         10  FILLER                  PIC  X(04)    VALUE SPACES.  07950000
084700         10  DL2-UPC                 PIC  9(15).                  07960000
084800         10  DL2-UPC-X REDEFINES DL2-UPC                          07970000
084900                                     PIC  X(15).                  07980000
085000         10  FILLER                  PIC  X(04)    VALUE SPACES.  07990000
085100         10  DL2-VENDOR-STYLE        PIC  X(15)    VALUE SPACES.  08000000
085200         10  FILLER                  PIC  X(05)    VALUE SPACES.  08010000
085300         10  DL2-UNITS-OTR           PIC  ZZ,ZZ9   VALUE ZERO.    08020000
085400         10  FILLER                  PIC  X(06)    VALUE SPACES.  08030000
085500         10  DL2-RECEIVED            PIC  ZZ,ZZ9   VALUE ZERO.    08040000
085600         10  FILLER                  PIC  X(04)    VALUE SPACES.  08050000
085700         10  DL2-SHORT-OVER          PIC  ZZ,ZZ9   VALUE ZERO.    08060000
085800         10  FILLER                  PIC  X(06)    VALUE SPACES.  08070000
085900         10  DL2-PERCENT             PIC  ZZ9      VALUE ZERO.    08080000
086000         10  FILLER                  PIC  X(07)    VALUE SPACES.  08090000
086100         10  DL2-REASON-CODE         PIC  ZZ9      VALUE ZERO.    08100000
086200         10  FILLER                  PIC  X(03)    VALUE SPACES.  08110000
086300                                                                  08120000
086400     05  DETAIL-LINE-3.                                           08130000
086500         10  FILLER                  PIC  X(43)    VALUE SPACES.  08140000
086600         10  DL3-DESCRIPTION         PIC  X(25)    VALUE SPACES.  08150000
086700         10  FILLER                  PIC  X(64)    VALUE SPACES.  08160000
086800                                                                  08170000
086900     05  DETAIL-LINE-4.                                           08180000
087000         10  FILLER                  PIC  X(06)    VALUE SPACES.  08190000
087100         10  DL4-PO-RECEIVER         PIC  X(13)    VALUE SPACES.  08200000
087200         10  FILLER                  PIC  X(03)    VALUE SPACES.  08210000
087300         10  DL4-PO-LINE             PIC  ZZZ9     VALUE ZERO.    08220000
087400         10  FILLER                  PIC  X(04)    VALUE SPACES.  08230000
087500         10  DL4-SKU                 PIC  X(15)    VALUE SPACES.  08240100
087600         10  FILLER                  PIC  X(04)    VALUE SPACES.  08250000
087700         10  DL4-UPC                 PIC  9(15).                  08260000
087800         10  DL4-UPC-X REDEFINES DL4-UPC                          08270000
087900                                     PIC  X(15).                  08280000
088000         10  FILLER                  PIC  X(04)    VALUE SPACES.  08290000
088100         10  DL4-VENDOR-STYLE        PIC  X(15)    VALUE SPACES.  08300000
088200         10  FILLER                  PIC  X(03)    VALUE SPACES.  08310000
088300         10  DL4-DESCRIPTION         PIC  X(25)    VALUE SPACES.  08320000
088400         10  FILLER                  PIC  X(26)    VALUE SPACES.  08330000
088500                                                                  08340000
088600     05  DETAIL-LINE-5.                                           08350000
088700         10  FILLER                  PIC  X(09)    VALUE SPACES.  08360000
088800         10  FILLER                  PIC  X(14)    VALUE          08370000
088900             'COMMENTS:  ON '.                                    08380000
089000         10  DL5-DATE                PIC  X(10)    VALUE SPACES.  08390000
089100         10  FILLER                  PIC  X(04)    VALUE          08400000
089200             ' AT '.                                              08410000
089300         10  DL5-TIME                PIC  X(08)    VALUE SPACES.  08420000
089400         10  FILLER                  PIC  X(04)    VALUE          08430000
089500             ' BY '.                                              08440000
089600         10  DL5-USER-NAME           PIC  X(30)    VALUE SPACES.  08450000
089700         10  FILLER                  PIC  X(53)    VALUE SPACES.  08460000
089800                                                                  08470000
089900     05  DETAIL-LINE-6.                                           08480000
090000         10  FILLER                  PIC  X(20)    VALUE SPACES.  08490000
090100         10  DL6-DETAIL-CONSTANT     PIC  X(09)    VALUE SPACES.  08500000
090200         10  DL6-DETAIL              PIC  X(50)    VALUE SPACES.  08510000
090300         10  FILLER                  PIC  X(53)    VALUE SPACES.  08520000
090400                                                                  08530000
090500********                                                          08540000
090600     05  DETAIL-PKLINE.                                           08550000
090700         10  FILLER                  PIC  X(06)    VALUE SPACES.  08560000
090800*PS 10/10/2014 STARTS                                             08570000
090800         10  DLPK-PO-RECEIVER        PIC  X(13)    VALUE SPACES.  08570000
090800*PS 10/10/2014 ENDS                                               08570000
090900         10  FILLER                  PIC  X(02)    VALUE SPACES.  08580000
091000         10  DLPK-PK-ID              PIC  ZZZ9     VALUE ZERO.    08590000
091100         10  FILLER                  PIC  X(05)    VALUE SPACES.  08600000
091200         10  DLPK-DESC               PIC  X(40)    VALUE SPACES.  08610000
091300         10  FILLER                  PIC  X(01)    VALUE SPACES.  08620000
091400         10  DLPK-OTR                PIC  ZZ,ZZ9   VALUE ZERO.    08630000
091500         10  FILLER                  PIC  X(03)    VALUE SPACES.  08640000
091600         10  DLPK-RECEIVED           PIC  ZZ,ZZ9   VALUE ZERO.    08650000
091700         10  FILLER                  PIC  X(03)    VALUE SPACES.  08660000
091800         10  DLPK-PKS-OVSH           PIC  ZZ,ZZ9   VALUE ZERO.    08670000
091900         10  FILLER                  PIC  X(03)    VALUE SPACES.  08680000
092000         10  DLPK-PCNT-OVSH          PIC  ZZ,ZZ9   VALUE ZERO.    08690000
092100         10  FILLER                  PIC  X(02)    VALUE SPACES.  08700000
092200         10  DLPK-ODD-UNTS           PIC  ZZ,ZZ9   VALUE ZERO.    08710000
092300         10  FILLER                  PIC  X(02)    VALUE SPACES.  08720000
092400         10  DLPK-DOL-ODD-UNT        PIC  $$$,$$9  VALUE ZERO.    08730000
092500         10  FILLER                  PIC  X(04)    VALUE SPACES.  08740000
092600         10  DLPK-REASON-CODE        PIC  ZZ9      VALUE ZERO.    08750000
090800*PS 10/10/2014 STARTS                                             08570000
092700         10  FILLER                  PIC  X(05)    VALUE SPACES.  08760000
090800*PS 10/10/2014 ends                                               08570000
092800                                                                  08770000
092900*                                                                 08780000
093000 01  TOTAL-LINES.                                                 08790000
093100     05  TOTAL-LINE-1.                                            08800000
093200         10  FILLER                  PIC  X(06)    VALUE SPACES.  08810000
093300         10  TL1-EARLY-LATE          PIC  X(33)    VALUE SPACES.  08820000
093400         10  TL1-TOT-EARLY-LATE      PIC  ZZ,ZZ9   VALUE ZERO.    08830000
093500         10  FILLER                  PIC  X(87)    VALUE SPACES.  08840000
093600                                                                  08850000
093700     05  TOTAL-LINE-2.                                            08860000
093800         10  FILLER                  PIC  X(06)    VALUE SPACES.  08870000
093900         10  TL2-SHORT-OVER          PIC  X(33)    VALUE SPACES.  08880000
094000         10  TL2-TOT-SHORT-OVER      PIC  ZZ,ZZ9   VALUE ZERO.    08890000
094100         10  FILLER                  PIC  X(87)    VALUE SPACES.  08900000
094200                                                                  08910000
094300     05  TOTAL-LINE-3.                                            08920000
094400         10  FILLER                  PIC  X(06)    VALUE SPACES.  08930000
094500         10  FILLER                  PIC  X(37)    VALUE          08940000
094600             'TOTAL NUMBER OF STYLE SUBSTITUTIONS  '.             08950000
094700         10  TL3-TOT-STYLE-SUBS      PIC  ZZ,ZZ9   VALUE ZERO.    08960000
094800         10  FILLER                  PIC  X(83)    VALUE SPACES.  08970000
094900                                                                  08980000
095000     05  TOTAL-BP-LINE-4.                                         08990000
095100         10  FILLER                  PIC  X(06)    VALUE SPACES.  09000000
095200         10  TL4-BAD-PACK            PIC  X(33)    VALUE SPACES.  09010000
095300         10  TL4-TOT-BAD-PACK        PIC  ZZ,ZZ9   VALUE ZERO.    09020000
095400         10  FILLER                  PIC  X(87)    VALUE SPACES.  09030000
095500*                                                                 09040000
095600 01  EXCEIPTION-LINES.                                            09050000
095700                                                                  09060000
095800     05  NO-DATA-LINE.                                            09070000
095900         10  FILLER                  PIC  X(36)    VALUE          09080000
096000             '** NO DATA TO REPORT FOR THIS RUN **'.              09090000
096100         10  FILLER                  PIC  X(96)    VALUE SPACES.  09100000
096200                                                                  09110000
096300*                                                                 09120000
096400*  COPY BOOK FOR TROUBLE DETAIL TABLE                             09130000
096500*                                                                 09140000
096600     EXEC SQL                                                     09150000
096700          INCLUDE TTRBDTL                                         09160000
096800     END-EXEC.                                                    09170000
096900*                                                                 09180000
097000*  COPY BOOK FOR SHIPMENT TABLE                                   09190000
097100*                                                                 09200000
097200     EXEC SQL                                                     09210000
097300          INCLUDE TSHIPMT                                         09220000
097400     END-EXEC.                                                    09230000
097500*                                                                 09240000
097600*  COPY BOOK FOR SHIPMENT TO PO TABLE                             09250000
097700*                                                                 09260000
097800     EXEC SQL                                                     09270000
097900          INCLUDE TSHPTPO                                         09280000
098000     END-EXEC.                                                    09290000
098100*                                                                 09300000
098200*  COPY BOOK FOR VEHICLE TRIP TABLE                               09310000
098300*                                                                 09320000
098400     EXEC SQL                                                     09330000
098500          INCLUDE TVHTRIP                                         09340000
098600     END-EXEC.                                                    09350000
098700*                                                                 09360000
099400*  COPY BOOK FOR PURCHASE ITEM TABLE                              09430000
099500*                                                                 09440000
099600     EXEC SQL                                                     09450000
099700          INCLUDE TPURITM                                         09460000
099800     END-EXEC.                                                    09470000
099900*                                                                 09480000
100000*  COPY BOOK FOR ENTITY NAME TABLE                                09490000
100100*                                                                 09500000
100200     EXEC SQL                                                     09510000
100300          INCLUDE TENTNME                                         09520000
100400     END-EXEC.                                                    09530000
100500*                                                                 09540000
100600*  COPY BOOK FOR RECEIVER TABLE                                   09550000
100700*                                                                 09560000
100800     EXEC SQL                                                     09570000
100900          INCLUDE TRECEIV                                         09580000
101000     END-EXEC.                                                    09590000
101100*                                                                 09600000
101200*  COPY BOOK FOR PLAN SHIPMENT TABLE                              09610000
101300*                                                                 09620000
101400     EXEC SQL                                                     09630000
101500          INCLUDE TPLNSHP                                         09640000
101600     END-EXEC.                                                    09650000
101700*                                                                 09660000
101800*----------------------------------------------------------------*09840000
101900*                                                                 09850000
102000*  COPY BOOK FOR PO PREPK TABLE                                   09860000
102100*                                                                 09870000
102200     EXEC SQL                                                     09880000
102300          INCLUDE TPOPRPK                                         09890000
102400     END-EXEC.                                                    09900000
102500                                                                  09910000
102600*----------------------------------------------------------------*09911000
102700*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               09912099
102800*                                                                 09913099
102900     COPY XLWS001.                                                09915000
103000*----------------------------------------------------------------*09918000
103100*  DB2 COMMUNICATION AREA                                         09920000
103200*                                                                 09930000
103300     EXEC SQL                                                     09940000
103400         INCLUDE SQLCA                                            09950000
103500     END-EXEC.                                                    09960000
103600                                                                  09970000
103700*  DB2 COMMUNICATION AREA2                                        09980000
103800*                                                                 09990000
103900     COPY SQLCA2.                                                 10000099
104000                                                                  10010000
104100                                                                  10020000
104200                                                                  10030000
104300     EXEC SQL                                                     10040000
104400       DECLARE TROUBLE-CSR CURSOR FOR                             10050000
104500         SELECT CRE_TMST                                          10060000
104600              , CRE_UID                                           10070000
104700              , FREEFORM_TEXT                                     10080000
104800          FROM  TTRBDTL                                           10090000
104900          WHERE NOTIF_NBR         = :TRBDTL-NOTIF-NBR             10100000
105000       ORDER BY CRE_TMST                                          10110000
105100     END-EXEC.                                                    10120000
105200                                                                  10130000
105300                                                                  10140000
105400                                                                  10150000
105500 PROCEDURE DIVISION.                                              10160000
105600                                                                  10170000
105700 0000-MAINLINE-PROCESSING.                                        10180000
105800******************************************************************10190000
105900**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      10200000
106000******************************************************************10210000
106100     OPEN INPUT  EXTRACT-FILE                                     10220000
106200          OUTPUT TM-TROUBLE-FILE.                                 10230000
106300                                                                  10240000
106400     PERFORM 2200-READ-EXTRACT.                                   10250000
106500     PERFORM 1000-INITIALIZATION.                                 10260000
106600                                                                  10270000
106700     PERFORM 2000-PROCESS-TM                                      10280000
106800         UNTIL PS-END-OF-EXTRACT.                                 10290000
106900                                                                  10300000
107000     WRITE TM-TROUBLE-RECORD                                      10310000
107100       FROM END-OF-REPORT-LINE                                    10320000
107200         AFTER ADVANCING 2 LINES.                                 10330000
107300                                                                  10340000
107400     CLOSE EXTRACT-FILE                                           10350000
107500           TM-TROUBLE-FILE.                                       10360000
107600                                                                  10370000
107700     GOBACK.                                                      10380000
107800                                                                  10390000
107900 1000-INITIALIZATION.                                             10400000
108000******************************************************************10410000
108100**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               10420000
108200******************************************************************10430000
108300     IF TM001-RECORD-TYPE-HEADER                                  10440000
108400         CONTINUE                                                 10450000
108500     ELSE                                                         10460000
108600         DISPLAY '** ABEND **'                                    10470000
108700         DISPLAY '** PROGRAM   ** = ' PC-TMKRP009                 10480000
108800         DISPLAY '** PARAGRAPH ** =  1000-INITIALIZATION'         10490000
108900         DISPLAY '** NO HEADER RECORD EXISTS'                     10500000
109000         DISPLAY '** FIRST RECORD TYPE  = ' TM001-RECORD-TYPE-CDE 10510000
109100         MOVE +4003 TO PV-ABEND-CODE                              10520000
109200         CALL 'ILBOABN0' USING PV-ABEND-CODE                      10530000
109300     END-IF.                                                      10540000
109400                                                                  10550000
109500     ACCEPT PV-TODAYS-DATE                                        10560000
109600       FROM DATE.                                                 10570000
109700                                                                  10580000
109800     ACCEPT PV-TODAYS-TIME                                        10590000
109900       FROM TIME.                                                 10600000
110000                                                                  10610000
110100     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             10620000
110200     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               10630000
110300     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              10640000
110400                                                                  10650000
110500     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              10660000
110600     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            10670000
110700     MOVE PC-TMKRP009            TO DP132O-PROGRAM-NAME.          10680000
110800                                                                  10690000
110900     MOVE TM001-END-MM         TO PV-FORMAT-DATE-MM.              10700000
111000     MOVE TM001-END-DD         TO PV-FORMAT-DATE-DD.              10710000
111100     MOVE TM001-END-YYYY       TO PV-FORMAT-DATE-YYYY.            10720000
111200     MOVE PV-FORMAT-DATE       TO HL1-TROUBLE-DATE                10730000
111300                                  HL1W-TROUBLE-DATE               10740000
111400                                  HL1M-TROUBLE-DATE.              10750000
111500     IF TM001-RUN-SPECIAL                                         10760000
111600         MOVE PC-SPECIAL-REQUEST TO HL1-SPECIAL-RUN-MSG           10770000
111700                                    HL1W-SPECIAL-RUN-MSG          10780000
111800                                    HL1M-SPECIAL-RUN-MSG          10790000
111900     END-IF.                                                      10800000
112000     MOVE TM001-RUN-FREQ-CDE     TO PS-RUN-FREQUENCY-SW.          10810000
112100     IF PS-DAILY                                                  10820000
112200         MOVE PC-REPORT-NBR-1    TO DP132O-REPORT-NUMBER          10830000
112300     ELSE                                                         10840000
112400         IF PS-WEEKLY                                             10850000
112500             MOVE PC-REPORT-NBR-2    TO DP132O-REPORT-NUMBER      10860000
112600         ELSE                                                     10870000
112700             MOVE PC-REPORT-NBR-3    TO DP132O-REPORT-NUMBER      10880000
112800     END-IF.                                                      10890000
112900     PERFORM 2200-READ-EXTRACT.                                   10900000
113000     IF  PS-END-OF-EXTRACT                                        10910000
113100         MOVE SPACES TO HL3-VENDOR-NAME                           10920000
113200         PERFORM 8000-WRITE-REPORT-HEADERS                        10930000
113300         WRITE TM-TROUBLE-RECORD                                  10940000
113400           FROM NO-DATA-LINE                                      10950000
113500             AFTER ADVANCING 2 LINES                              10960000
113600     END-IF.                                                      10970000
113700                                                                  10980000
113800 2000-PROCESS-TM.                                                 10990000
113900******************************************************************11000000
114000*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *11010000
114100*  EARLY SHIPMENTS AND SYTLE SUBSTITUTIONS REPORT                *11020000
114200*  PACK SHORT AND OVER REPORT                                    *11030000
114300*  BAD PACK REPORT                                               *11040000
114400*  PACK LINE REPORT                                              *11050000
114500******************************************************************11060000
114600     IF NOT TM001-RECORD-TYPE-HEADER                              11070000
114700         CONTINUE                                                 11080000
114800     ELSE                                                         11090000
114900         DISPLAY '** ABEND **'                                    11100000
115000         DISPLAY '** PROGRAM   ** = ' PC-TMKRP009                 11110000
115100         DISPLAY '** PARAGRAPH ** =  1000-INITIALIZATION'         11120000
115200         DISPLAY '** DUPLICATE HEADER RECORDS'                    11130000
115300         DISPLAY '** RECORD TYPE  = ' TM001-RECORD-TYPE-CDE       11140000
115400         MOVE +4003 TO PV-ABEND-CODE                              11150000
115500         CALL 'ILBOABN0' USING PV-ABEND-CODE                      11160000
115600     END-IF.                                                      11170000
115700                                                                  11180000
115800     IF TM001-ENT-ID NOT = ENTNME-ENT-ID                          11190000
115900         MOVE TM001-ENT-ID         TO ENTNME-ENT-ID               11200000
116000         PERFORM 2100-SELECT-ENT-NAME                             11210000
116100         MOVE ENTNME-ENT-NAME-DESC TO HL3-VENDOR-NAME             11220000
116200         PERFORM 8000-WRITE-REPORT-HEADERS                        11230000
116300     END-IF.                                                      11240000
116400                                                                  11250000
116500     MOVE TM001-TRBL-RSN-CDE TO PV-REASON-CODE.                           
116600                                                                          
116700***********************************************************       11260000
116800**   BAD PACK   SHORT AND OVERS                                   11270000
116900**              GROUP CODE H = 269, 271                           11280000
117000***********************************************************       11290000
117100                                                                          
117200     EVALUATE TRUE                                                11300000
117300         WHEN TM001-TRBL-RSN-CDE = PC-269 OR PC-271               11310000
117400             IF  PV-LINE-CNT > PC-55                              11320000
117500                 PERFORM 8000-WRITE-REPORT-HEADERS                11330000
117600             ELSE                                                 11340000
117700                 MOVE PC-2            TO PV-LINE-SUB              11350000
117800             END-IF                                               11360000
117900             IF TM001-TRBL-RSN-CDE = PC-269 OR PC-271             11370000
118000                 WRITE TM-TROUBLE-RECORD                          11380000
118100                   FROM HEADING-PACK-BAD                          11390000
118200                     AFTER ADVANCING 2 LINES                      11400000
118300                                                                  11410000
118400                 WRITE TM-TROUBLE-RECORD                          11420000
118500                   FROM HEADING-PKLINE-1                          11430000
118600                     AFTER ADVANCING 2 LINES                      11440000
118700                                                                  11450000
118800                 WRITE TM-TROUBLE-RECORD                          11460000
118900                   FROM HEADING-PKLINE-2                          11470000
119000                     AFTER ADVANCING 1 LINES                      11480000
119100             END-IF                                               11490000
119200                                                                  11500000
119300             ADD 5                           TO PV-LINE-CNT       11510000
119400             PERFORM 6010-PROCESS-BADPK-SHORT-OVERS               11520000
119500                 UNTIL (TM001-TRBL-RSN-CDE < PC-269 OR            11530000
119600                        TM001-TRBL-RSN-CDE > PC-271) OR           11540000
119700                       TM001-ENT-ID NOT = ENTNME-ENT-ID OR        11550000
119800                       PS-END-OF-EXTRACT                          11560000
119900             MOVE PV-SHORT-OVER-TOT       TO TL4-TOT-BAD-PACK     11570000
120000             IF PV-SAVE-TRBL-RSN-CDE = PC-269 OR PC-271           11580000
120100                 MOVE PC-BADPK-TOTAL      TO TL4-BAD-PACK         11590000
120200             END-IF                                               11600000
120300             MOVE ZERO                    TO PV-SHORT-OVER-TOT    11610000
120400                                             PV-SAVE-TRBL-RSN-CDE 11620000
120500             WRITE TM-TROUBLE-RECORD                              11630000
120600               FROM TOTAL-BP-LINE-4                               11640000
120700                 AFTER ADVANCING 2 LINES                          11650000
120800             ADD 2                        TO PV-LINE-CNT          11660000
120900                                                                  11670000
121000*********************************************************         11680000
121100**  EARLY AND LATE                                                11690000
121200**                GROUP CODE A = 501, 502                         11700000
121300**                GROUP CODE B = 508, 509                         11710000
121400*********************************************************         11720000
121500                                                                  11730000
121600         WHEN TM001-TRBL-RSN-CDE = PC-501 OR PC-502 OR            11740000
121700                                 PC-508 OR PC-509                 11750000
121800             IF  PV-LINE-CNT > PC-55                              11760000
121900                  PERFORM 8000-WRITE-REPORT-HEADERS               11770000
122000             ELSE                                                 11780000
122100                 MOVE PC-2            TO PV-LINE-SUB              11790000
122200             END-IF                                               11800000
122300             IF TM001-TRBL-RSN-CDE = PC-501 OR PC-502             11810000
122400                 WRITE TM-TROUBLE-RECORD                          11820000
122500                   FROM HEADING-LINE-4-EARLY                      11830000
122600                     AFTER ADVANCING 2 LINES                      11840000
122700             ELSE                                                 11850000
122800                 WRITE TM-TROUBLE-RECORD                          11860000
122900                   FROM HEADING-LINE-4-LATE                       11870000
123000                     AFTER ADVANCING 2 LINES                      11880000
123100             END-IF                                               11890000
123200                                                                  11900000
123300             WRITE TM-TROUBLE-RECORD                              11910000
123400               FROM HEADING-LINE-5                                11920000
123500                 AFTER ADVANCING 2 LINES                          11930000
123600                                                                  11940000
123700             WRITE TM-TROUBLE-RECORD                              11950000
123800               FROM HEADING-LINE-6                                11960000
123900                 AFTER ADVANCING 1 LINES                          11970000
124000                                                                  11980000
124100             ADD 5                           TO PV-LINE-CNT       11990000
124200             PERFORM 3000-PROCESS-EARLY-LATES                     12000000
124300                 UNTIL TM001-TRBL-RSN-CDE > PC-509 OR             12010000
124400                       TM001-ENT-ID NOT = ENTNME-ENT-ID OR        12020000
124500                       PS-END-OF-EXTRACT                          12030000
124600             MOVE PV-EARLY-LATE-TOT       TO TL1-TOT-EARLY-LATE   12040000
124700             IF PV-SAVE-TRBL-RSN-CDE = PC-501 OR PC-502           12050000
124800                 MOVE PC-EARLY-TOTAL      TO TL1-EARLY-LATE       12060000
124900             ELSE                                                 12070000
125000                 MOVE PC-LATE-TOTAL       TO TL1-EARLY-LATE       12080000
125100             END-IF                                               12090000
125200             MOVE ZERO                    TO PV-EARLY-LATE-TOT    12100000
125300                                             PV-SAVE-TRBL-RSN-CDE 12110000
125400             WRITE TM-TROUBLE-RECORD                              12120000
125500               FROM TOTAL-LINE-1                                  12130000
125600                 AFTER ADVANCING 2 LINES                          12140000
125700             ADD 2                        TO PV-LINE-CNT          12150000
125800                                                                  12160000
125900*********************************************************         12170000
126000**  SHORT & OVER  GROUP CODE C = 510, 512                         12180000
126100*                 GROUP CODE D = 520, 521                         12190000
126200*                       ALSO     450 THRU 458  SHORT              12190000
126300*                       ALSO     610 THRU 649  OVER               12190000
126400*********************************************************         12200000
126500                                                                  12210000
126600         WHEN PC-SHORT-REASON  OR                                       00
126700              PC-OVER-REASON                                            00
126800                                                                   2210000
127100             IF  PV-LINE-CNT > PC-55                              12240000
127200                 PERFORM 8000-WRITE-REPORT-HEADERS                12250000
127300             ELSE                                                 12260000
127400                 MOVE PC-2            TO PV-LINE-SUB              12270000
127500             END-IF                                               12280000
127600             IF PC-SHORT-REASON                                         00
127800                 WRITE TM-TROUBLE-RECORD                          12300000
127900                   FROM HEADING-LINE-7-SHORT                      12310000
128000                     AFTER ADVANCING 2 LINES                      12320000
128100                                                                  12330000
128200                 WRITE TM-TROUBLE-RECORD                          12340000
128300                   FROM HEADING-LINE-8                            12350000
128400                     AFTER ADVANCING 2 LINES                      12360000
128500                                                                  12370000
128600                 WRITE TM-TROUBLE-RECORD                          12380000
128700                   FROM HEADING-LINE-9-SHORT                      12390000
128800                     AFTER ADVANCING 1 LINES                      12400000
128900             ELSE                                                 12410000
129000                 WRITE TM-TROUBLE-RECORD                          12420000
129100                   FROM HEADING-LINE-7-OVER                       12430000
129200                     AFTER ADVANCING 2 LINES                      12440000
129300                                                                  12450000
129400                 WRITE TM-TROUBLE-RECORD                          12460000
129500                   FROM HEADING-LINE-8                            12470000
129600                     AFTER ADVANCING 2 LINES                      12480000
129700                                                                  12490000
129800                 WRITE TM-TROUBLE-RECORD                          12500000
129900                   FROM HEADING-LINE-9-OVER                       12510000
130000                     AFTER ADVANCING 1 LINES                      12520000
130100             END-IF                                               12530000
130200                                                                  12540000
130300             ADD 5                           TO PV-LINE-CNT       12550000
130411             SET PS-NOT-END-SHORT-AND-OVER TO TRUE                        
130412                                                                          
130413             PERFORM UNTIL (PS-END-OF-EXTRACT OR                          
130414                            PS-END-SHORT-AND-OVER)                        
130420                                                                          
130500                 PERFORM 4000-PROCESS-SHORT-OVERS                       00
131101                                                                          
131110                 PERFORM 2200-READ-EXTRACT                              00
131111                                                                          
131112                 IF (PC-SHORT-REASON  OR                                00
131113                     PC-OVER-REASON)  AND                               00
131114                     TM001-ENT-ID = ENTNME-ENT-ID                       00
131115                    CONTINUE                                              
131118                 ELSE                                                   00
131119                    SET PS-END-SHORT-AND-OVER TO TRUE                     
131121                 END-IF                                                 00
131122                                                                          
131123             END-PERFORM                                                  
131130                                                                          
131200             MOVE PV-SHORT-OVER-TOT       TO TL2-TOT-SHORT-OVER   12610000
131400             MOVE PV-SAVE-TRBL-RSN-CDE TO PC-SAVE-REASON-CODE           00
131401             IF PC-SAVE-SHORT-REASON                                    00
131500                 MOVE PC-SHORT-TOTAL      TO TL2-SHORT-OVER       12630000
131600             ELSE                                                 12640000
131700                 MOVE PC-OVER-TOTAL       TO TL2-SHORT-OVER       12650000
131800             END-IF                                               12660000
131900             MOVE ZERO                    TO PV-SHORT-OVER-TOT    12670000
132000                                             PV-SAVE-TRBL-RSN-CDE 12680000
132100             WRITE TM-TROUBLE-RECORD                              12690000
132200               FROM TOTAL-LINE-2                                  12700000
132300                 AFTER ADVANCING 2 LINES                          12710000
132400             ADD 2                        TO PV-LINE-CNT          12720000
132500                                                                  12730000
132600                                                                  12740000
132700***********************************************************       12750000
132800**    STYLE SUBSTITUTION                                          12760000
132900*     GROUP CODE E = 530                                          12770000
133000***********************************************************       12780000
133100                                                                  12790000
133200         WHEN TM001-TRBL-RSN-CDE = PC-530                         12800000
133300             IF  PV-LINE-CNT > PC-55                              12810000
133400                  PERFORM 8000-WRITE-REPORT-HEADERS               12820000
133500             END-IF                                               12830000
133600             WRITE TM-TROUBLE-RECORD                              12840000
133700               FROM HEADING-LINE-10                               12850000
133800                 AFTER ADVANCING 2 LINES                          12860000
133900                                                                  12870000
134000             WRITE TM-TROUBLE-RECORD                              12880000
134100               FROM HEADING-LINE-11                               12890000
134200                 AFTER ADVANCING 2 LINES                          12900000
134300                                                                  12910000
134400             WRITE TM-TROUBLE-RECORD                              12920000
134500               FROM HEADING-LINE-12                               12930000
134600                 AFTER ADVANCING 1 LINES                          12940000
134700                                                                  12950000
134800             ADD 5                           TO PV-LINE-CNT       12960000
134900             PERFORM 5000-PROCESS-STYLE-SUBS                      12970000
135000                 UNTIL TM001-TRBL-RSN-CDE NOT = PC-530 OR         12980000
135100                       TM001-ENT-ID NOT = ENTNME-ENT-ID OR        12990000
135200                       PS-END-OF-EXTRACT                          13000000
135300             MOVE PV-STYLE-SUB-CRTN-TOT   TO TL3-TOT-STYLE-SUBS   13010000
135400             MOVE ZERO                    TO PV-STYLE-SUB-CRTN-TOT13020000
135500                                             PV-SAVE-TRBL-RSN-CDE 13030000
135600             WRITE TM-TROUBLE-RECORD                              13040000
135700               FROM TOTAL-LINE-3                                  13050000
135800                 AFTER ADVANCING 2 LINES                          13060000
135900             ADD 2                        TO PV-LINE-CNT          13070000
136000                                                                  13080000
136100***********************************************************       13090000
136200**   PACK SHORT AND OVERS                                         13100000
136300**        GROUP CODE F = 570, 571                                 13110000
136400**        GROUP CODE G = 579, 580                                 13120000
136500*                       ALSO     459 THRU 467  SHORT              12190000
136600*                       ALSO     650 THRU 689  OVER               12190000
136700***********************************************************       13130000
136800                                                                          
136900         WHEN PC-PACK-SHORT-REASON OR                                   00
137000              PC-PACK-OVER-REASON                                       00
137100                                                                          
137400             IF  PV-LINE-CNT > PC-55                              13160000
137500                 PERFORM 8000-WRITE-REPORT-HEADERS                13170000
137600             ELSE                                                 13180000
137700                 MOVE PC-2            TO PV-LINE-SUB              13190000
137800             END-IF                                               13200000
137900             IF PC-PACK-SHORT-REASON                                    00
138100                 WRITE TM-TROUBLE-RECORD                          13220000
138200                   FROM HEADING-PACK-SHORT                        13230000
138300                     AFTER ADVANCING 2 LINES                      13240000
138400                                                                  13250000
138500                 WRITE TM-TROUBLE-RECORD                          13260000
138600                   FROM HEADING-PKLINE-1                          13270000
138700                     AFTER ADVANCING 2 LINES                      13280000
138800                                                                  13290000
138900                 WRITE TM-TROUBLE-RECORD                          13300000
139000                   FROM HEADING-PKLINE-SHT                        13310000
139100                     AFTER ADVANCING 1 LINES                      13320000
139200             ELSE                                                 13330000
139300                 WRITE TM-TROUBLE-RECORD                          13340000
139400                   FROM HEADING-PACK-OVER                         13350000
139500                     AFTER ADVANCING 2 LINES                      13360000
139600                                                                  13370000
139700                 WRITE TM-TROUBLE-RECORD                          13380000
139800                   FROM HEADING-PKLINE-1                          13390000
139900                     AFTER ADVANCING 2 LINES                      13400000
140000                                                                  13410000
140100                 WRITE TM-TROUBLE-RECORD                          13420000
140200                   FROM HEADING-PKLINE-OVR                        13430000
140300                     AFTER ADVANCING 1 LINES                      13440000
140400             END-IF                                               13450000
140500                                                                  13460000
140600             ADD 5                           TO PV-LINE-CNT       13470000
140720             SET PS-NOT-END-SHORT-AND-OVER TO TRUE                        
140730                                                                          
140740             PERFORM UNTIL (PS-END-OF-EXTRACT OR                          
140750                            PS-END-SHORT-AND-OVER)                        
140760                                                                          
140770                 PERFORM 6000-PROCESS-PACK-SHORT-OVERS            13480000
140780                                                                          
140790                 PERFORM 2200-READ-EXTRACT                              00
140791                                                                          
140792                 IF (PC-PACK-SHORT-REASON  OR                           00
140793                     PC-PACK-OVER-REASON)  AND                          00
140794                     TM001-ENT-ID = ENTNME-ENT-ID                       00
140795                    CONTINUE                                              
140796                 ELSE                                                   00
140797                    SET PS-END-SHORT-AND-OVER TO TRUE                     
140798                 END-IF                                                 00
140799                                                                          
140800             END-PERFORM                                                  
141210                                                                        00
141300             MOVE PV-SHORT-OVER-TOT       TO TL2-TOT-SHORT-OVER   13530000
141320             MOVE PV-SAVE-TRBL-RSN-CDE TO PC-SAVE-REASON-CODE           00
141400                                                                          
141410             IF PC-SAVE-PACK-SHORT-REASON                                 
141600                 MOVE PC-SHORT-TOTAL      TO TL2-SHORT-OVER       13550000
141700             ELSE                                                 13560000
141800                 MOVE PC-OVER-TOTAL       TO TL2-SHORT-OVER       13570000
141900             END-IF                                               13580000
142000             MOVE ZERO                    TO PV-SHORT-OVER-TOT    13590000
142100                                             PV-SAVE-TRBL-RSN-CDE 13600000
142200             WRITE TM-TROUBLE-RECORD                              13610000
142300               FROM TOTAL-LINE-2                                  13620000
142400                 AFTER ADVANCING 2 LINES                          13630000
142500             ADD 2                        TO PV-LINE-CNT          13640000
142600                                                                  13650000
142700***********************************************************       13660000
142800**   PACK LINE SHORT AND OVERS                                    13670000
142900**             GROUP CODE I = 582, 583                            13680000
143000**             GROUP CODE J = 591, 592                            13690000
143100***********************************************************       13700000
143200         WHEN TM001-TRBL-RSN-CDE = PC-582 OR PC-583 OR            13710000
143300                                   PC-591 OR PC-592               13720000
143400             IF  PV-LINE-CNT > PC-55                              13730000
143500                 PERFORM 8000-WRITE-REPORT-HEADERS                13740000
143600             ELSE                                                 13750000
143700                 MOVE PC-2            TO PV-LINE-SUB              13760000
143800             END-IF                                               13770000
143900             IF TM001-TRBL-RSN-CDE = PC-582 OR PC-583             13780000
144000                 WRITE TM-TROUBLE-RECORD                          13790000
144100                   FROM HEADING-PACK-LINE-SHORT                   13800000
144200                     AFTER ADVANCING 2 LINES                      13810000
144300                                                                  13820000
144400                 WRITE TM-TROUBLE-RECORD                          13830000
144500                   FROM HEADING-LINE-8                            13840000
144600                     AFTER ADVANCING 2 LINES                      13850000
144700                                                                  13860000
144800                 WRITE TM-TROUBLE-RECORD                          13870000
144900                   FROM HEADING-LINE-9-SHORT                      13880000
145000                     AFTER ADVANCING 1 LINES                      13890000
145100             ELSE                                                 13900000
145200                 WRITE TM-TROUBLE-RECORD                          13910000
145300                   FROM HEADING-PACK-LINE-OVER                    13920000
145400                     AFTER ADVANCING 2 LINES                      13930000
145500                                                                  13940000
145600                 WRITE TM-TROUBLE-RECORD                          13950000
145700                   FROM HEADING-LINE-8                            13960000
145800                     AFTER ADVANCING 2 LINES                      13970000
145900                                                                  13980000
146000                 WRITE TM-TROUBLE-RECORD                          13990000
146100                   FROM HEADING-LINE-9-OVER                       14000000
146200                     AFTER ADVANCING 1 LINES                      14010000
146300             END-IF                                               14020000
146400                                                                  14030000
146500             ADD 5                           TO PV-LINE-CNT       14040000
146600             PERFORM 6020-PROCESS-PKLN-SHORT-OVERS                14050000
146700                 UNTIL (TM001-TRBL-RSN-CDE < PC-582 OR            14060000
146800                        TM001-TRBL-RSN-CDE > PC-592) OR           14070000
146900                       TM001-ENT-ID NOT = ENTNME-ENT-ID OR        14080000
147000                       PS-END-OF-EXTRACT                          14090000
147100             MOVE PV-SHORT-OVER-TOT       TO TL2-TOT-SHORT-OVER   14100000
147200             IF PV-SAVE-TRBL-RSN-CDE = PC-582 OR PC-583           14110000
147300                 MOVE PC-SHORT-TOTAL      TO TL2-SHORT-OVER       14120000
147400             ELSE                                                 14130000
147500                 MOVE PC-OVER-TOTAL       TO TL2-SHORT-OVER       14140000
147600             END-IF                                               14150000
147700             MOVE ZERO                    TO PV-SHORT-OVER-TOT    14160000
147800                                             PV-SAVE-TRBL-RSN-CDE 14170000
147900             WRITE TM-TROUBLE-RECORD                              14180000
148000               FROM TOTAL-LINE-2                                  14190000
148100                 AFTER ADVANCING 2 LINES                          14200000
148200             ADD 2                        TO PV-LINE-CNT          14210000
148300         WHEN OTHER                                               14211099
148400             PERFORM 2200-READ-EXTRACT                            14212099
148500     END-EVALUATE.                                                14220000
148600                                                                  14230000
148700 2100-SELECT-ENT-NAME.                                            14240000
148800     MOVE '2100-SELECT-ENT-NAME' TO                               14250000
148900                      PV-ABEND-PARAGRAPH.                         14260000
149000                                                                  14270000
149100     EXEC SQL                                                     14280000
149200         SELECT  ENT_NAME_DESC                                    14290000
149300         INTO   :ENTNME-ENT-NAME-DESC                             14300000
149400         FROM   TENTNME                                           14310000
149500         WHERE  ENT_ID           = :ENTNME-ENT-ID                 14320000
149600          AND   TYPE_CDE         = '01'                           14330000
149700     END-EXEC.                                                    14340000
149800                                                                  14350000
149900     EVALUATE TRUE                                                14360000
150000         WHEN SQLCODE = +0                                        14370000
150100              CONTINUE                                            14380000
150200         WHEN SQLWARN0 NOT = SPACE                                14390000
150300         WHEN SQLCODE  NOT = +0                                   14400000
150400              DISPLAY PV-ABEND-PARAGRAPH                          14410000
150500              DISPLAY 'SELECT FOR ENT NAME DESC'                  14420000
150600              DISPLAY 'SELECT FOR ENT ID ' ENTNME-ENT-ID          14430000
150700              PERFORM Z999-SQL-ERROR                              14440000
150800     END-EVALUATE.                                                14450000
150900 2200-READ-EXTRACT.                                               14460000
151000     READ EXTRACT-FILE INTO TM001-TROUBLE-EXT-RECORD              14470000
151100        AT END                                                    14480000
151200           SET PS-END-OF-EXTRACT TO TRUE.                         14490000
151300                                                                  14500000
151400 3000-PROCESS-EARLY-LATES.                                        14510000
151500                                                                  14520000
151600     IF (TM001-TRBL-RSN-CDE = PC-501 OR PC-502 OR                 14530000
151700                              PC-508 OR PC-509) AND               14540000
151800        (PV-SAVE-PO-NUMBER NOT = TM001-PO-NBR OR                  14550000
151900         PV-SAVE-REC-SEQ-NBR NOT = TM001-REC-SEQ-NBR OR           14560000
152000         PV-SAVE-TRBL-RSN-CDE NOT = TM001-TRBL-RSN-CDE OR         14570000
152100         PV-SAVE-NOTIF-TMST NOT = TM001-NOTIF-TMST)               14580000
152200         IF  PV-LINE-CNT > PC-55 OR                               14590000
152300            ((PV-SAVE-TRBL-RSN-CDE = PC-501 OR PC-502) AND        14600000
152400             (TM001-TRBL-RSN-CDE = PC-508 OR PC-509))             14610000
152500             IF  PV-LINE-CNT > PC-55                              14620000
152600                 PERFORM 8000-WRITE-REPORT-HEADERS                14630000
152700             ELSE                                                 14640000
152800                 MOVE PV-EARLY-LATE-TOT   TO TL1-TOT-EARLY-LATE   14650000
152900                 MOVE PC-EARLY-TOTAL  TO TL1-EARLY-LATE           14660000
153000                 MOVE ZERO                TO PV-EARLY-LATE-TOT    14670000
153100                 WRITE TM-TROUBLE-RECORD                          14680000
153200                   FROM TOTAL-LINE-1                              14690000
153300                     AFTER ADVANCING 2 LINES                      14700000
153400                 ADD 2                    TO PV-LINE-CNT          14710000
153500                 MOVE PC-2                TO PV-LINE-SUB          14720000
153600             END-IF                                               14730000
153700             IF TM001-TRBL-RSN-CDE = PC-501 OR PC-502             14740000
153800                 WRITE TM-TROUBLE-RECORD                          14750000
153900                   FROM HEADING-LINE-4-EARLY                      14760000
154000                     AFTER ADVANCING 2 LINES                      14770000
154100             ELSE                                                 14780000
154200                 WRITE TM-TROUBLE-RECORD                          14790000
154300                   FROM HEADING-LINE-4-LATE                       14800000
154400                     AFTER ADVANCING 2 LINES                      14810000
154500             END-IF                                               14820000
154600                                                                  14830000
154700             WRITE TM-TROUBLE-RECORD                              14840000
154800               FROM HEADING-LINE-5                                14850000
154900                 AFTER ADVANCING 2 LINES                          14860000
155000                                                                  14870000
155100             WRITE TM-TROUBLE-RECORD                              14880000
155200               FROM HEADING-LINE-6                                14890000
155300                 AFTER ADVANCING 1 LINES                          14900000
155400                                                                  14910000
155500             ADD 5                 TO PV-LINE-CNT                 14920000
155600         END-IF                                                   14930000
155700         MOVE TM001-PO-NBR         TO RECEIV-ORD-NBR              14940000
155800                                      SHPTPO-PO-NBR               14950000
155900                                      PLNSHP-PO-NBR               14960000
156000                                      PV-PO                       14970000
156100                                      PV-SAVE-PO-NUMBER           14980000
156200         MOVE TM001-REC-SEQ-NBR    TO RECEIV-REC-SEQ-NBR          14990000
156300                                      SHPTPO-REC-SEQ-NBR          15000000
156400                                      PV-RECEIVER                 15010000
156500                                      PV-SAVE-REC-SEQ-NBR         15020000
156600         MOVE TM001-TRBL-RSN-CDE   TO PV-SAVE-TRBL-RSN-CDE        15030000
156700         MOVE TM001-NOTIF-TMST     TO PV-SAVE-NOTIF-TMST          15040000
156800         MOVE PV-PO-RECEIVER       TO DL1-PO-RECEIVER             15050000
156900         PERFORM 3100-SELECT-START-SHIP-DATE                      15060000
157000         MOVE PLNSHP-DONT-SHIP-BEF-DTE                            15070000
157100                                   TO PV-DB2-DATE                 15080000
157200         MOVE PV-DB2-DATE-YYYY     TO PV-FORMAT-DATE-YYYY         15090000
157300         MOVE PV-DB2-DATE-MM       TO PV-FORMAT-DATE-MM           15100000
157400         MOVE PV-DB2-DATE-DD       TO PV-FORMAT-DATE-DD           15110000
157500         MOVE PV-FORMAT-DATE       TO DL1-DONT-SHIP-B4-DATE       15120000
157600         PERFORM 3200-SELECT-TSHIPMT                              15130000
157700         IF SHIPMT-VEND-SHIP-DTE NOT = '0001-01-01'               15140000
157800             MOVE SHIPMT-VEND-SHIP-DTE TO PV-DB2-DATE             15150000
157900             MOVE PV-DB2-DATE-YYYY     TO PV-FORMAT-DATE-YYYY     15160000
158000             MOVE PV-DB2-DATE-MM       TO PV-FORMAT-DATE-MM       15170000
158100             MOVE PV-DB2-DATE-DD       TO PV-FORMAT-DATE-DD       15180000
158200             MOVE PV-FORMAT-DATE       TO DL1-VENDOR-SHIP-DATE    15190000
158300         ELSE                                                     15200000
158400             MOVE VHTRIP-OWNR-SCAC-SHIP-DTE                       15210000
158500                                       TO PV-DB2-DATE             15220000
158600             MOVE PV-DB2-DATE-YYYY     TO PV-FORMAT-DATE-YYYY     15230000
158700             MOVE PV-DB2-DATE-MM       TO PV-FORMAT-DATE-MM       15240000
158800             MOVE PV-DB2-DATE-DD       TO PV-FORMAT-DATE-DD       15250000
158900             MOVE PV-FORMAT-DATE       TO DL1-VENDOR-SHIP-DATE    15260000
159000         END-IF                                                   15270000
159100         PERFORM 3300-SELECT-REC-TMST                             15280000
159200         MOVE RECEIV-REC-TMST      TO PV-DB2-TMST                 15290000
159300         MOVE PV-DB2-TMST-YYYY     TO PV-FORMAT-DATE-YYYY         15300000
159400         MOVE PV-DB2-TMST-MM       TO PV-FORMAT-DATE-MM           15310000
159500         MOVE PV-DB2-TMST-DD       TO PV-FORMAT-DATE-DD           15320000
159600         MOVE PV-FORMAT-DATE       TO DL1-RECEIPT-DATE            15330000
159700         MOVE TM001-TRBL-RSN-CDE   TO DL1-REASON-CODE             15340000
159800         PERFORM 8400-WRITE-DETAIL-LINES                          15350000
159900         ADD 1 TO PV-EARLY-LATE-TOT                               15360000
160000     END-IF.                                                      15370000
160100     PERFORM 2200-READ-EXTRACT.                                   15380000
160200                                                                  15390000
160300 3100-SELECT-START-SHIP-DATE.                                     15400000
160400     MOVE '3100-SELECT-START-SHIP-DATE' TO                        15410000
160500                      PV-ABEND-PARAGRAPH.                         15420000
160600                                                                  15430000
160700     EXEC SQL                                                     15440000
160800         SELECT  DONT_SHIP_BEF_DTE                                15450000
160900         INTO   :PLNSHP-DONT-SHIP-BEF-DTE                         15460000
161000         FROM   TPLNSHP                                           15470000
161100         WHERE  PO_NBR           = :PLNSHP-PO-NBR                 15480000
161200           AND  VER_STATUS_CDE   = :PC-ACTIVE                     15490000
161300     END-EXEC.                                                    15500000
161400                                                                  15510000
161500     EVALUATE TRUE                                                15520000
161600         WHEN SQLCODE = +0                                        15530000
161700              CONTINUE                                            15540000
161800         WHEN SQLWARN0 NOT = SPACE                                15550000
161900         WHEN SQLCODE  NOT = +0                                   15560000
162000              DISPLAY PV-ABEND-PARAGRAPH                          15570000
162100              DISPLAY 'SELECT FOR REC TMST'                       15580000
162200              DISPLAY 'SELECT FOR PO NBR ' RECEIV-ORD-NBR         15590000
162300              DISPLAY 'SELECT FOR REC SEQ' RECEIV-REC-SEQ-NBR     15600000
162400              PERFORM Z999-SQL-ERROR                              15610000
162500     END-EVALUATE.                                                15620000
162600                                                                  15630000
162700 3200-SELECT-TSHIPMT.                                             15640000
162800     MOVE '3200-SELECT-TSHIPMT' TO                                15650000
162900                      PV-ABEND-PARAGRAPH.                         15660000
163000                                                                  15670000
163100     EXEC SQL                                                     15680000
163200          SELECT VEND_SHIP_DTE                                    15690000
163300               , OWNR_SCAC_SHIP_DTE                               15700000
163400            INTO :SHIPMT-VEND-SHIP-DTE                            15710000
163500               , :VHTRIP-OWNR-SCAC-SHIP-DTE                       15720000
163600            FROM TSHIPMT A                                        15730000
163700                ,TSHPTPO B                                        15740000
163800                ,TVHTRIP C                                        15750000
163900           WHERE A.SHIPT_ID    = B.SHIPT_ID                       15760000
164000             AND B.PO_NBR      = :SHPTPO-PO-NBR                   15770000
164100             AND B.REC_SEQ_NBR = :SHPTPO-REC-SEQ-NBR              15780000
164200             AND B.PRIM_SHIPT_IND = :PC-Y                         15790000
164300             AND A.TRIP_ID     = C.TRIP_ID                        15800000
164400     END-EXEC.                                                    15810000
164500                                                                  15820000
164600     EVALUATE TRUE                                                15830000
164700         WHEN SQLCODE = +0                                        15840000
164800             CONTINUE                                             15850000
164900         WHEN SQLCODE = +100                                      15860000
165000             MOVE ZEROS TO  SHIPMT-VEND-SHIP-DTE                  15870000
165100                            VHTRIP-OWNR-SCAC-SHIP-DTE             15880000
165200         WHEN SQLWARN0 NOT = SPACES                               15890000
165300         WHEN SQLCODE < +0                                        15900000
165400         WHEN SQLCODE > +0                                        15910000
165500              DISPLAY PV-ABEND-PARAGRAPH                          15920000
165600              DISPLAY 'SELECT FOR SHIPMT'                         15930000
165700              DISPLAY 'SELECT FOR PO NBR ' SHPTPO-PO-NBR          15940000
165800              DISPLAY 'SELECT FOR REC SEQ' SHPTPO-REC-SEQ-NBR     15950000
165900              PERFORM Z999-SQL-ERROR                              15960000
166000     END-EVALUATE.                                                15970000
166100                                                                  15980000
166200                                                                  15990000
166300 3300-SELECT-REC-TMST.                                            16000000
166400                                                                  16010000
166500     MOVE '3300-SELECT-REC-TMST' TO                               16020000
166600                      PV-ABEND-PARAGRAPH.                         16030000
166700     EXEC SQL                                                     16040000
166800         SELECT  REC_TMST                                         16050000
166900         INTO   :RECEIV-REC-TMST                                  16060000
167000         FROM   TRECEIV                                           16070000
167100         WHERE  ORD_NBR          = :RECEIV-ORD-NBR                16080000
167200           AND  REC_SEQ_NBR      = :RECEIV-REC-SEQ-NBR            16090000
167300     END-EXEC.                                                    16100000
167400                                                                  16110000
167500     EVALUATE TRUE                                                16120000
167600         WHEN SQLCODE = +0                                        16130000
167700              CONTINUE                                            16140000
167800         WHEN SQLWARN0 NOT = SPACE                                16150000
167900         WHEN SQLCODE  NOT = +0                                   16160000
168000              DISPLAY PV-ABEND-PARAGRAPH                          16170000
168100              DISPLAY 'SELECT FOR REC TMST'                       16180000
168200              DISPLAY 'SELECT FOR PO NBR ' RECEIV-ORD-NBR         16190000
168300              DISPLAY 'SELECT FOR REC SEQ' RECEIV-REC-SEQ-NBR     16200000
168400              PERFORM Z999-SQL-ERROR                              16210000
168500     END-EVALUATE.                                                16220000
168600                                                                  16230000
168700                                                                  16240000
168800 4000-PROCESS-SHORT-OVERS.                                        16250000
168900                                                                  16260000
169000     IF (PC-SHORT-REASON  OR                                            00
169100         PC-OVER-REASON)  AND                                           00
169400        (PV-SAVE-PO-NUMBER NOT = TM001-PO-NBR OR                  16290000
169500         PV-SAVE-REC-SEQ-NBR NOT = TM001-REC-SEQ-NBR OR           16300000
169600         PV-SAVE-TRBL-RSN-CDE NOT = TM001-TRBL-RSN-CDE OR         16310000
169700         PV-SAVE-NOTIF-TMST NOT = TM001-NOTIF-TMST)               16320000
169800         IF  PV-LINE-CNT > PC-55 OR                               16330000
170100             (PC-SAVE-SHORT-REASON AND                                    
170101              PC-OVER-REASON)                                             
170200             IF  PV-LINE-CNT > PC-55                              16360000
170300                 PERFORM 8000-WRITE-REPORT-HEADERS                16370000
170400             ELSE                                                 16380000
170500                 MOVE PV-SHORT-OVER-TOT   TO TL2-TOT-SHORT-OVER   16390000
170600                 MOVE PC-SHORT-TOTAL      TO TL2-SHORT-OVER       16400000
170700                 MOVE ZERO                TO PV-SHORT-OVER-TOT    16410000
170800                 WRITE TM-TROUBLE-RECORD                          16420000
170900                   FROM TOTAL-LINE-2                              16430000
171000                     AFTER ADVANCING 2 LINES                      16440000
171100                 ADD 2                    TO PV-LINE-CNT          16450000
171200                 MOVE PC-2                TO PV-LINE-SUB          16460000
171300             END-IF                                               16470000
171400                                                                  16480000
171500             IF PC-SHORT-REASON                                         00
171700                 WRITE TM-TROUBLE-RECORD                          16500000
171800                   FROM HEADING-LINE-7-SHORT                      16510000
171900                     AFTER ADVANCING 2 LINES                      16520000
172000                                                                  16530000
172100                 WRITE TM-TROUBLE-RECORD                          16540000
172200                   FROM HEADING-LINE-8                            16550000
172300                     AFTER ADVANCING 2 LINES                      16560000
172400                                                                  16570000
172500                 WRITE TM-TROUBLE-RECORD                          16580000
172600                   FROM HEADING-LINE-9-SHORT                      16590000
172700                     AFTER ADVANCING 1 LINES                      16600000
172800             ELSE                                                 16610000
172900                 WRITE TM-TROUBLE-RECORD                          16620000
173000                   FROM HEADING-LINE-7-OVER                       16630000
173100                     AFTER ADVANCING 2 LINES                      16640000
173200                                                                  16650000
173300                 WRITE TM-TROUBLE-RECORD                          16660000
173400                   FROM HEADING-LINE-8                            16670000
173500                     AFTER ADVANCING 2 LINES                      16680000
173600                                                                  16690000
173700                 WRITE TM-TROUBLE-RECORD                          16700000
173800                   FROM HEADING-LINE-9-OVER                       16710000
173900                     AFTER ADVANCING 1 LINES                      16720000
174000             END-IF                                               16730000
174100                                                                  16740000
174200             ADD 5                           TO PV-LINE-CNT       16750000
174300         END-IF                                                   16760000
174400         MOVE TM001-PO-NBR         TO PURITM-PO-NBR               16770000
174500                                      PV-PO                       16780000
174600                                      PV-SAVE-PO-NUMBER           16790000
174700         MOVE TM001-REC-SEQ-NBR    TO PV-RECEIVER                 16800000
174800                                      PV-SAVE-REC-SEQ-NBR         16810000
174900         MOVE TM001-PO-LNE-NBR     TO PURITM-APP-PO-LNE-NBR       16820000
175000         MOVE TM001-TRBL-RSN-CDE   TO PV-SAVE-TRBL-RSN-CDE        16830000
175100         MOVE TM001-NOTIF-TMST     TO PV-SAVE-NOTIF-TMST          16840000
175200         MOVE PV-PO-RECEIVER       TO DL2-PO-RECEIVER             16850000
175300         MOVE TM001-PO-LNE-NBR     TO DL2-PO-LINE                 16860000
175400         MOVE TM001-DEPT-NBR       TO PV-SKU-DEPT                 16870000
175500         PERFORM 5100-SELECT-PURITM                               16890000
175700                                                                  16910100
175800         INITIALIZE XL001-ITEM-COMMAREA                           16910200
175900                    PV-TEMP-SEQ-NBR                               16910300
176000                    PV-TEMP-UPC-NBR                               16910499
176100                                                                  16910599
176200         IF (PURITM-SKU-SEQ-NBR = PC-000)                         16910699
176300            MOVE '00000000'    TO PV-SKU-SEQ                      16910799
176400         ELSE                                                     16910999
176500            IF (PURITM-SKU-SEQ-NBR = PC-999)                      16911099
176600               MOVE '99999999' TO PV-SKU-SEQ                      16911199
176700            END-IF                                                16911299
176800         END-IF                                                   16911399
176900                                                                  16911499
177000         IF PS-CALL-API-YES                    AND                16911599
177100            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                16911699
177200             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   16911799
177300              PERFORM 5200-CALL-XLKUT-DOMAIN-PGM                  16911899
177400         END-IF                                                   16911999
177500                                                                  16912000
175600         MOVE XL001-SUB-CL-NBR-2CH TO PV-SKU-CLASS                16900000
177600         MOVE PV-SKU                TO DL2-SKU                    16940099
177700         MOVE PURITM-VEND-STYL-NAME TO DL2-VENDOR-STYLE           17050000
177800         MOVE PURITM-SKU-DESC      TO DL3-DESCRIPTION             17060000
177900         PERFORM 4100-PROCESS-TROUBLE-CURSOR                      17070000
178000         MOVE TM001-OVER-SHT-PCT   TO DL2-PERCENT                 17080000
178100         MOVE TM001-TRBL-RSN-CDE   TO DL2-REASON-CODE             17090000
178200         PERFORM 8500-WRITE-DETAIL-LINES                          17100000
178300         ADD 1 TO PV-SHORT-OVER-TOT                               17110000
178400     END-IF.                                                      17120000
178500     MOVE PC-2                       TO PV-LINE-SUB.              17130000
178700                                                                  17150000
178800 4100-PROCESS-TROUBLE-CURSOR.                                     17160000
178900     MOVE TM001-NOTIF-NBR      TO TRBDTL-NOTIF-NBR.               17170000
179000     SET PS-START-OF-CURSOR    TO TRUE.                           17180000
179100     PERFORM 4200-OPEN-CURSOR.                                    17190000
179200     MOVE SPACES               TO PV-TEXT-TABLE.                  17200000
179300     PERFORM 4300-FETCH-CURSOR.                                   17210000
179400     PERFORM 4400-PROCESS-CURSOR UNTIL                            17220000
179500          PS-END-OF-CURSOR.                                       17230000
179600     PERFORM 4500-CLOSE-CURSOR.                                   17240000
179700                                                                  17250000
179800 4200-OPEN-CURSOR.                                                17260000
179900     MOVE '4200-OPEN-CURSOR' TO PV-ABEND-PARAGRAPH.               17270000
180000     EXEC SQL                                                     17280000
180100          OPEN TROUBLE-CSR                                        17290000
180200     END-EXEC.                                                    17300000
180300                                                                  17310000
180400     EVALUATE TRUE                                                17320000
180500         WHEN SQLCODE = +0                                        17330000
180600             CONTINUE                                             17340000
180700         WHEN OTHER                                               17350000
180800           DISPLAY PV-ABEND-PARAGRAPH                             17360000
180900           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                17370000
181000           PERFORM Z999-SQL-ERROR                                 17380000
181100     END-EVALUATE.                                                17390000
181200 4300-FETCH-CURSOR.                                               17400000
181300     MOVE '4300-FETCH-CURSOR' TO PV-ABEND-PARAGRAPH.              17410000
181400     EXEC SQL                                                     17420000
181500          FETCH  TROUBLE-CSR                                      17430000
181600           INTO :TRBDTL-CRE-TMST                                  17440000
181700              , :TRBDTL-CRE-UID                                   17450000
181800              , :PV-TEXT-TABLE                                    17460000
181900     END-EXEC.                                                    17470000
182000                                                                  17480000
182100     EVALUATE TRUE                                                17490000
182200         WHEN SQLCODE = +0                                        17500000
182300             CONTINUE                                             17510000
182400         WHEN SQLCODE = +100                                      17520000
182500             SET PS-END-OF-CURSOR TO TRUE                         17530000
182600         WHEN OTHER                                               17540000
182700           DISPLAY PV-ABEND-PARAGRAPH                             17550000
182800           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                17560000
182900           PERFORM Z999-SQL-ERROR                                 17570000
183000     END-EVALUATE.                                                17580000
183100 4400-PROCESS-CURSOR.                                             17590000
183200     PERFORM 4600-PROCESS-TEXT VARYING                            17600000
183300         PV-SUB FROM 1 BY 1 UNTIL                                 17610000
183400         PV-SUB > 5.                                              17620000
183500     MOVE SPACES               TO PV-TEXT-TABLE.                  17630000
183600     PERFORM 4300-FETCH-CURSOR.                                   17640000
183700                                                                  17650000
183800 4500-CLOSE-CURSOR.                                               17660000
183900     MOVE '4500-CLOSE-CURSOR' TO PV-ABEND-PARAGRAPH.              17670000
184000     EXEC SQL                                                     17680000
184100          CLOSE TROUBLE-CSR                                       17690000
184200     END-EXEC.                                                    17700000
184300                                                                  17710000
184400     EVALUATE TRUE                                                17720000
184500         WHEN SQLCODE = +0                                        17730000
184600             CONTINUE                                             17740000
184700         WHEN OTHER                                               17750000
184800           DISPLAY PV-ABEND-PARAGRAPH                             17760000
184900           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                17770000
185000           PERFORM Z999-SQL-ERROR                                 17780000
185100     END-EVALUATE.                                                17790000
185200                                                                  17800000
185300 4600-PROCESS-TEXT.                                               17810000
185400     EVALUATE TRUE                                                17820000
185500         WHEN PV-TEXT-1(PV-SUB) = PC-OS-TEXT-1                    17830000
185600             MOVE ZERO TO PV-EXTRACT-NUMBER                       17840000
185700             MOVE PV-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF           17850000
185800             PERFORM 4700-EXTRACT-NUMBER VARYING                  17860000
185900                 PV-NUM-SUB FROM 9 BY -1 UNTIL                    17870000
186000                 PV-NUM-SUB = 0 OR                                17880000
186100                 PV-NUM(PV-NUM-SUB) = SPACES                      17890000
186200             MOVE PV-EXTRACT-NUMBER TO DL2-RECEIVED               17900000
186300         WHEN PV-TEXT-1(PV-SUB) = PC-OS-TEXT-2                    17910000
186400             MOVE ZERO TO PV-EXTRACT-NUMBER                       17920000
186500             MOVE PV-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF           17930000
186600             PERFORM 4700-EXTRACT-NUMBER VARYING                  17940000
186700                 PV-NUM-SUB FROM 9 BY -1 UNTIL                    17950000
186800                 PV-NUM-SUB = 0 OR                                17960000
186900                 PV-NUM(PV-NUM-SUB) = SPACES                      17970000
187000             MOVE PV-EXTRACT-NUMBER TO DL2-UNITS-OTR              17980000
187100         WHEN PV-TEXT-1(PV-SUB) = PC-OS-TEXT-3                    17990000
187200             MOVE ZERO TO PV-EXTRACT-NUMBER                       18000000
187300             MOVE PV-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF           18010000
187400             PERFORM 4700-EXTRACT-NUMBER VARYING                  18020000
187500                 PV-NUM-SUB FROM 9 BY -1 UNTIL                    18030000
187600                 PV-NUM-SUB = 0 OR                                18040000
187700                 PV-NUM(PV-NUM-SUB) = SPACES                      18050000
187800             MOVE PV-EXTRACT-NUMBER TO DL2-UNITS-OTR              18060000
187900             MOVE 6 TO PV-SUB                                     18070000
188000             SET PS-END-OF-CURSOR TO TRUE                         18080000
188100         WHEN PV-TEXT-1(PV-SUB) = PC-OS-TEXT-4                    18090000
188200             MOVE ZERO TO PV-EXTRACT-NUMBER                       18100000
188300             MOVE PV-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF           18110000
188400             PERFORM 4700-EXTRACT-NUMBER VARYING                  18120000
188500                 PV-NUM-SUB FROM 9 BY -1 UNTIL                    18130000
188600                 PV-NUM-SUB = 0 OR                                18140000
188700                 PV-NUM(PV-NUM-SUB) = SPACES                      18150000
188800             MOVE PV-EXTRACT-NUMBER TO DL2-SHORT-OVER             18160000
188900             MOVE 6 TO PV-SUB                                     18170000
189000             SET PS-END-OF-CURSOR TO TRUE                         18180000
189100     END-EVALUATE.                                                18190000
189200                                                                  18200000
189300 4700-EXTRACT-NUMBER.                                             18210000
189400     IF PV-NUM(PV-NUM-SUB) IS NUMERIC                             18220000
189500         MOVE PV-NUM(PV-NUM-SUB) TO PV-NUMBER(PV-NUM-SUB)         18230000
189600     ELSE                                                         18240000
189700         MOVE 0 TO PV-NUM-SUB                                     18250000
189800     END-IF.                                                      18260000
189900 5000-PROCESS-STYLE-SUBS.                                         18270000
190000                                                                  18280000
190100     IF TM001-TRBL-RSN-CDE = PC-530 AND                           18290000
190200        (PV-SAVE-PO-NUMBER NOT = TM001-PO-NBR OR                  18300000
190300         PV-SAVE-REC-SEQ-NBR NOT = TM001-REC-SEQ-NBR OR           18310000
190400         PV-SAVE-TRBL-RSN-CDE NOT = TM001-TRBL-RSN-CDE OR         18320000
190500         PV-SAVE-NOTIF-TMST NOT = TM001-NOTIF-TMST)               18330000
190600         IF  PV-LINE-CNT > PC-55                                  18340000
190700             PERFORM 8000-WRITE-REPORT-HEADERS                    18350000
190800             WRITE TM-TROUBLE-RECORD                              18360000
190900               FROM HEADING-LINE-10                               18370000
191000                 AFTER ADVANCING 2 LINES                          18380000
191100                                                                  18390000
191200             WRITE TM-TROUBLE-RECORD                              18400000
191300               FROM HEADING-LINE-11                               18410000
191400                 AFTER ADVANCING 2 LINES                          18420000
191500                                                                  18430000
191600             WRITE TM-TROUBLE-RECORD                              18440000
191700               FROM HEADING-LINE-12                               18450000
191800                 AFTER ADVANCING 1 LINES                          18460000
191900                                                                  18470000
192000             ADD 5                           TO PV-LINE-CNT       18480000
192100         END-IF                                                   18490000
192200         MOVE TM001-PO-NBR         TO PURITM-PO-NBR               18500000
192300                                      PV-PO                       18510000
192400                                      PV-SAVE-PO-NUMBER           18520000
192500         MOVE TM001-REC-SEQ-NBR    TO PV-RECEIVER                 18530000
192600                                      PV-SAVE-REC-SEQ-NBR         18540000
192700         MOVE TM001-PO-LNE-NBR     TO PURITM-APP-PO-LNE-NBR       18550000
192800         MOVE TM001-TRBL-RSN-CDE   TO PV-SAVE-TRBL-RSN-CDE        18560000
192900         MOVE TM001-NOTIF-TMST     TO PV-SAVE-NOTIF-TMST          18570000
193000         MOVE PV-PO-RECEIVER       TO DL4-PO-RECEIVER             18580000
193100         MOVE TM001-PO-LNE-NBR     TO DL4-PO-LINE                 18590000
193200         MOVE TM001-DEPT-NBR       TO PV-SKU-DEPT                 18600000
193300         PERFORM 5100-SELECT-PURITM                               18620000
193500                                                                  18640100
193600*  CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *             18640299
193700         INITIALIZE XL001-ITEM-COMMAREA                           18640300
193800                    PV-TEMP-SEQ-NBR                               18640400
193900                    PV-TEMP-UPC-NBR                               18641099
194000                                                                  18641199
194100         IF (PURITM-SKU-SEQ-NBR = PC-000)                         18641299
194200            MOVE '00000000'    TO PV-SKU-SEQ                      18641399
194300         ELSE                                                     18641499
194400            IF (PURITM-SKU-SEQ-NBR = PC-999)                      18641599
194500               MOVE '99999999' TO PV-SKU-SEQ                      18641699
194600            END-IF                                                18641799
194700         END-IF                                                   18641899
194800                                                                  18641999
194900         IF PS-CALL-API-YES                    AND                18642099
195000            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                18642199
195100             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   18642299
195200              PERFORM 5200-CALL-XLKUT-DOMAIN-PGM                  18642399
195300         END-IF                                                   18642499
195400                                                                  18642599
193410         MOVE XL001-SUB-CL-NBR-2CH TO PV-SKU-CLASS                18630000
195500         MOVE PV-SKU                TO DL4-SKU                    18670099
195600         MOVE PURITM-VEND-STYL-NAME TO DL4-VENDOR-STYLE           18780000
195700         MOVE PURITM-SKU-DESC      TO DL4-DESCRIPTION             18790000
195800         PERFORM 8600-WRITE-DETAIL-LINES                          18800000
195900         PERFORM 5300-PROCESS-TROUBLE-CURSOR                      18810000
196000         ADD 1 TO PV-STYLE-SUB-CRTN-TOT                           18820000
196100     END-IF.                                                      18830000
196200     MOVE PC-2                       TO PV-LINE-SUB.              18840000
196300     PERFORM 2200-READ-EXTRACT.                                   18850000
196400                                                                  18860000
196500 5100-SELECT-PURITM.                                              18880000
196600     MOVE '5100-SELECT-PURITM '                                   18890000
196700                                 TO PV-ABEND-PARAGRAPH.           18900000
196800     EXEC SQL                                                     18910000
197000         SELECT SKU_SEQ_NBR,                                      18930000
197100                SKU_DESC,                                         18940000
197200                VEND_STYL_NAME,                                   18950000
197300                ITM_NBR                                           18951000
197500          INTO  :PURITM-SKU-SEQ-NBR,                              18970000
197600                :PURITM-SKU-DESC,                                 18980000
197700                :PURITM-VEND-STYL-NAME,                           18990000
197800                :PURITM-ITM-NBR                                   18991000
197900           FROM TPURITM                                           19000000
198000          WHERE PO_NBR         = :PURITM-PO-NBR                   19010000
198100            AND APP_PO_LNE_NBR = :PURITM-APP-PO-LNE-NBR           19020000
198200            AND VER_STATUS_CDE = :PC-ACTIVE                       19030000
198300     END-EXEC.                                                    19040000
198400                                                                  19050000
198500     MOVE ZEROES TO DK-ITM-NBR                                    19059200
198600                                                                  19059300
198700     EVALUATE TRUE                                                19060000
198800       WHEN SQLCODE = ZEROS                                       19070000
198900         SET PS-CALL-API-YES       TO TRUE                        19070199
199000         MOVE PURITM-ITM-NBR       TO DK-ITM-NBR                  19071000
199100         CONTINUE                                                 19080000
199200       WHEN SQLCODE = +100                                        19090000
199300         MOVE PC-00                TO PURITM-CL-NBR               19100000
199400         MOVE PC-000               TO PURITM-SKU-SEQ-NBR          19110000
199500         MOVE PC-NOT-FOUND         TO PURITM-SKU-DESC             19120000
199600                                      PURITM-VEND-STYL-NAME       19130000
199700       WHEN OTHER                                                 19140000
199800         DISPLAY PV-ABEND-PARAGRAPH                               19150000
199900         DISPLAY 'PO NUMBER: ' PURITM-PO-NBR                      19160000
200000         DISPLAY 'PO LINE : ' PURITM-APP-PO-LNE-NBR               19170000
200100         PERFORM Z999-SQL-ERROR                                   19180000
200200     END-EVALUATE.                                                19190000
200300                                                                  19200000
200400 5150-SELECT-DESC.                                                19210000
200500     MOVE '5150-SELECT-DESC'                                      19220000
200600                                 TO PV-ABEND-PARAGRAPH.           19230000
200700     EXEC SQL                                                     19240000
200800         SELECT PREPK_DESC                                        19250000
200900           INTO  :POPRPK-PREPK-DESC                               19260000
201000           FROM  TPOPRPK                                          19270000
201100          WHERE  PO_NBR          = :DK-PO-NBR                     19280000
201200            AND  PO_PREPK_ID     = :DK-PREPK-ID                   19290000
201300     END-EXEC                                                     19300000
201400                                                                  19310000
201500     EVALUATE TRUE                                                19320000
201600       WHEN SQLCODE = ZERO                                        19330000
201700           MOVE POPRPK-PREPK-DESC TO DLPK-DESC                    19340000
201800       WHEN SQLCODE = +100                                        19350000
201900           MOVE PC-NOT-FOUND      TO DLPK-DESC                    19360000
202000                                                                  19370000
202100       WHEN OTHER                                                 19380000
202200           DISPLAY PV-ABEND-PARAGRAPH                             19390000
202300           DISPLAY 'PO NUMBER: ' DK-PO-NBR                        19400000
202400           DISPLAY 'PO PREPK ID: ' DK-PREPK-ID                    19410000
202500           PERFORM Z999-SQL-ERROR                                 19420000
202600     END-EVALUATE.                                                19430000
202700                                                                  19440000
202800*----------------------------------------------------------------*19772100
202900*  ACCESS LOGISTICS DOMAIN ITEM ACCESS MODULE                     19772399
203000*----------------------------------------------------------------*19772400
203100 5200-CALL-XLKUT-DOMAIN-PGM.                                      19772500
203200                                                                  19772700
203300     MOVE '7010-SELECT-SKU-BY-SKU'                                19772800
203400                               TO PV-ABEND-PARAGRAPH.             19772900
203500     MOVE DK-ITM-NBR           TO XL001-KEY-ITM-NBR.              19773000
203600     MOVE 'V'                  TO XL001-KEY-UPC-TYP-CDE.          19773299
203700                                                                  19773300
203800     SET  XL001-BY-ITEM                                           19773400
203900          XL001-SELECT-SKU                                        19773500
203910          XL001-SELECT-VND-STYL                                   19773500
204000          XL001-SELECT-UPC     TO TRUE.                           19773600
204100                                                                  19773700
204200     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               19773800
204300                                                                  19773900
204400     EVALUATE TRUE                                                19774000
204500                                                                  19774100
204600      WHEN XL001-SKU-SQLCODE = +0                                 19774200
204700        MOVE XL001-SKU-NBR     TO  PV-TEMP-SEQ-NBR                19774300
204800        MOVE PV-TEMP-SEQ-NBR   TO  PV-SKU-SEQ                     19774400
204900                                                                  19774599
205000        PERFORM 5210-SELECT-UPC                                   19774700
205100                                                                  19774800
205200      WHEN XL001-SKU-SQLCODE = +100                               19774900
205300        CONTINUE                                                  19775000
205400                                                                  19775100
205500      WHEN XL001-SKU-CONTENTION                                   19775200
205600        MOVE '7010-SELECT-SKU-BY-SKU'                             19775300
205700                               TO PV-ABEND-PARAGRAPH              19775400
205800        MOVE 'XL001-SKU-CONTENTION'                               19775500
205900                               TO PV-ABEND-MESSAGE-TEXT           19775600
206000        MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                      19775700
206100        MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME                19775800
206200        PERFORM 9000-PROCESS-ABEND                                19775900
206300                                                                  19776000
206400      WHEN OTHER                                                  19776100
206500        MOVE '7010-SELECT-SKU-BY-SKU'                             19776200
206600                               TO PV-ABEND-PARAGRAPH              19776300
206700        MOVE 'SELECT ROW FROM XLV_SKU'                            19776400
206800                               TO PV-ABEND-MESSAGE-TEXT           19776500
206900        MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                      19776600
207000        MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME                19776700
207010        DISPLAY 'XL001-SQLCA --> '                                        
207020                 XL001-SQLCA                                              
207100        PERFORM 9000-PROCESS-ABEND                                19776900
207200                                                                  19777000
207300     END-EVALUATE.                                                19777400
207400                                                                  19777500
207500 5210-SELECT-UPC.                                                 19778000
207600                                                                  19779000
207700     MOVE '7300-SELECT-UPC'    TO PV-ABEND-PARAGRAPH.             19779199
207800                                                                  19780000
207900     EVALUATE TRUE                                                19780100
208000                                                                  19780200
208100      WHEN XL001-UPC-SQLCODE = +0                                 19780300
208200        MOVE XL001-UPC-NBR     TO PV-TEMP-UPC-NBR                 19780400
208300        MOVE PV-TEMP-UPC-NBR   TO DL2-UPC                         19780599
208400                                  DL4-UPC                         19780699
208500                                                                  19780700
208600      WHEN XL001-UPC-SQLCODE = +100                               19780800
208700        MOVE PC-NO-VENDOR-UPC  TO DL2-UPC-X                       19780900
208800                                  DL4-UPC-X                       19781000
208900                                                                  19781100
209000      WHEN XL001-UPC-SQLCODE = -811                               19781200
209100        MOVE PC-MULTIPLE-UPCS  TO DL2-UPC-X                       19781300
209200                                  DL4-UPC-X                       19781400
209300                                                                  19781500
209400      WHEN XL001-UPC-CONTENTION                                   19781600
209500        MOVE '7300-SELECT-UPC' TO PV-ABEND-PARAGRAPH              19781700
209600        MOVE 'XL001-UPC-CONTENTION'                               19781800
209700                               TO PV-ABEND-MESSAGE-TEXT           19781900
209800        MOVE XL001-UPC-SQLCODE TO PV-SQLCODE                      19782000
209900        MOVE 'XLV_UPC'         TO PV-DB2-VIEW-NAME                19782200
210000        PERFORM 9000-PROCESS-ABEND                                19782400
210100                                                                  19782500
210200      WHEN OTHER                                                  19782800
210300        MOVE '7300-SELECT-UPC'    TO PV-ABEND-PARAGRAPH           19782900
210400        MOVE 'SELECT ROW FROM XLV_UPC'                            19783000
210500                               TO PV-ABEND-MESSAGE-TEXT           19783100
210600        MOVE XL001-UPC-SQLCODE TO PV-SQLCODE                      19783200
210700        MOVE 'XLV_UPC'         TO PV-DB2-VIEW-NAME                19783400
210800        PERFORM 9000-PROCESS-ABEND                                19783500
210900     END-EVALUATE.                                                19783600
211000                                                                  19783700
211100 5300-PROCESS-TROUBLE-CURSOR.                                     19810000
211200     MOVE TM001-NOTIF-NBR      TO TRBDTL-NOTIF-NBR.               19820000
211300     SET PS-START-OF-CURSOR    TO TRUE.                           19830000
211400     PERFORM 5400-OPEN-CURSOR.                                    19840000
211500     MOVE SPACES               TO PV-TEXT-TABLE.                  19850000
211600     PERFORM 5500-FETCH-CURSOR.                                   19860000
211700     PERFORM 5600-PROCESS-CURSOR UNTIL                            19870000
211800          PS-END-OF-CURSOR.                                       19880000
211900     PERFORM 5700-CLOSE-CURSOR.                                   19890000
212000                                                                  19900000
212100 5400-OPEN-CURSOR.                                                19910000
212200     MOVE '5400-OPEN-CURSOR' TO PV-ABEND-PARAGRAPH.               19920000
212300     EXEC SQL                                                     19930000
212400          OPEN TROUBLE-CSR                                        19940000
212500     END-EXEC.                                                    19950000
212600                                                                  19960000
212700     EVALUATE TRUE                                                19970000
212800         WHEN SQLCODE = +0                                        19980000
212900             CONTINUE                                             19990000
213000         WHEN OTHER                                               20000000
213100           DISPLAY PV-ABEND-PARAGRAPH                             20010000
213200           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                20020000
213300           PERFORM Z999-SQL-ERROR                                 20030000
213400     END-EVALUATE.                                                20040000
213500 5500-FETCH-CURSOR.                                               20050000
213600     MOVE '5500-FETCH-CURSOR' TO PV-ABEND-PARAGRAPH.              20060000
213700     EXEC SQL                                                     20070000
213800          FETCH  TROUBLE-CSR                                      20080000
213900           INTO :TRBDTL-CRE-TMST                                  20090000
214000              , :TRBDTL-CRE-UID                                   20100000
214100              , :PV-TEXT-TABLE                                    20110000
214200     END-EXEC.                                                    20120000
214300                                                                  20130000
214400     EVALUATE TRUE                                                20140000
214500         WHEN SQLCODE = +0                                        20150000
214600             CONTINUE                                             20160000
214700         WHEN SQLCODE = +100                                      20170000
214800             SET PS-END-OF-CURSOR TO TRUE                         20180000
214900         WHEN OTHER                                               20190000
215000           DISPLAY PV-ABEND-PARAGRAPH                             20200000
215100           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                20210000
215200           PERFORM Z999-SQL-ERROR                                 20220000
215300     END-EVALUATE.                                                20230000
215400 5600-PROCESS-CURSOR.                                             20240000
215500     MOVE TRBDTL-CRE-TMST      TO PV-DB2-TMST.                    20250000
215600     MOVE PV-DB2-TMST-YYYY     TO PV-FORMAT-DATE-YYYY.            20260000
215700     MOVE PV-DB2-TMST-MM       TO PV-FORMAT-DATE-MM.              20270000
215800     MOVE PV-DB2-TMST-DD       TO PV-FORMAT-DATE-DD.              20280000
215900     MOVE PV-FORMAT-DATE       TO DL5-DATE.                       20290000
216000     MOVE PV-DB2-TMST-HH       TO PV-FORMAT-TIME-HH.              20300000
216100     MOVE PV-DB2-TMST-MN       TO PV-FORMAT-TIME-MN.              20310000
216200     MOVE PV-DB2-TMST-SS       TO PV-FORMAT-TIME-SS.              20320000
216300     MOVE PV-FORMAT-TIME       TO DL5-TIME.                       20330000
216500     PERFORM 5800-SELECT-USER-NAME                                20350000
217500     IF  PV-LINE-CNT > PC-55                                      20450000
217600          PERFORM 8000-WRITE-REPORT-HEADERS                       20460000
217700          WRITE TM-TROUBLE-RECORD                                 20470000
217800            FROM HEADING-LINE-10                                  20480000
217900              AFTER ADVANCING 2 LINES                             20490000
218000                                                                  20500000
218100          WRITE TM-TROUBLE-RECORD                                 20510000
218200            FROM HEADING-LINE-11                                  20520000
218300              AFTER ADVANCING 2 LINES                             20530000
218400                                                                  20540000
218500          WRITE TM-TROUBLE-RECORD                                 20550000
218600            FROM HEADING-LINE-12                                  20560000
218700              AFTER ADVANCING 1 LINES                             20570000
218800                                                                  20580000
218900          ADD 5                           TO PV-LINE-CNT          20590000
219000     END-IF.                                                      20600000
219100     WRITE TM-TROUBLE-RECORD                                      20610000
219200       FROM DETAIL-LINE-5                                         20620000
219300         AFTER ADVANCING 2 LINES.                                 20630000
219400     ADD 2                     TO PV-LINE-CNT.                    20640000
219500     IF PV-TEXT(1) = SPACE AND                                    20650000
219600        PV-TEXT(2) = SPACE AND                                    20660000
219700        PV-TEXT(3) = SPACE AND                                    20670000
219800        PV-TEXT(4) = SPACE AND                                    20680000
219900        PV-TEXT(5) = SPACE                                        20690000
220000         CONTINUE                                                 20700000
220100     ELSE                                                         20710000
220200         MOVE PC-DETAIL        TO DL6-DETAIL-CONSTANT             20720000
220300         PERFORM 5900-PROCESS-TEXT VARYING                        20730000
220400             PV-SUB FROM 1 BY 1 UNTIL                             20740000
220500             PV-SUB > 5                                           20750000
220600     END-IF.                                                      20760000
220700     MOVE SPACES               TO PV-TEXT-TABLE.                  20770000
220800     PERFORM 5500-FETCH-CURSOR.                                   20780000
220900                                                                  20790000
221000 5700-CLOSE-CURSOR.                                               20800000
221100     MOVE '5700-CLOSE-CURSOR' TO PV-ABEND-PARAGRAPH.              20810000
221200     EXEC SQL                                                     20820000
221300          CLOSE TROUBLE-CSR                                       20830000
221400     END-EXEC.                                                    20840000
221500                                                                  20850000
221600     EVALUATE TRUE                                                20860000
221700         WHEN SQLCODE = +0                                        20870000
221800             CONTINUE                                             20880000
221900         WHEN OTHER                                               20890000
222000           DISPLAY PV-ABEND-PARAGRAPH                             20900000
222100           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                20910000
222200           PERFORM Z999-SQL-ERROR                                 20920000
222300     END-EVALUATE.                                                20930000
222400 5800-SELECT-USER-NAME.                                           20940000
222500     MOVE '5800-SELECT-USER-NAME' TO PV-ABEND-PARAGRAPH.          20950000
222600                                                                  20960000
222700     INITIALIZE XL067-USER-COMMAREA.                              20970000
222800     SET XL067-BY-USER-ID                                         20980000
222900         XL067-SELECT-KOHLS-USER TO TRUE.                         20990000
216400     MOVE TRBDTL-CRE-UID         TO XL067-KEY-USER-ID.            20340000
223000                                                                  21000000
223100     CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               21010000
223500                                                                  21050000
223600     EVALUATE TRUE                                                21060000
223700         WHEN XL067-SUCCESSFUL                                    21070000
223710             MOVE SPACES                TO DL5-USER-NAME          21080000
223800             MOVE XL067-COMBINED-NAME-2 TO DL5-USER-NAME          21080000
223900         WHEN XL067-KOHLS-NOT-FOUND                               21090000
223900         WHEN XL067-KOHLS-CONTENTION                              21090000
223910             MOVE SPACES                TO DL5-USER-NAME          21080000
223800             MOVE TRBDTL-CRE-UID        TO DL5-USER-NAME          21080000
224000         WHEN OTHER                                               21100000
224100           DISPLAY PV-ABEND-PARAGRAPH                             21110000
224200           DISPLAY 'USED ID : ' TRBDTL-CRE-UID                    21120000
224300           PERFORM Z999-SQL-ERROR                                 21130000
224400     END-EVALUATE.                                                21140000
224500                                                                  21150000
224800 5900-PROCESS-TEXT.                                               21180000
224900     IF PV-TEXT(PV-SUB) > SPACES AND                              21190000
225000        PV-TEXT(PV-SUB) NOT = PC-TEXT-EMPTY                       21200000
225100         MOVE PV-TEXT(PV-SUB)  TO DL6-DETAIL                      21210000
225200         WRITE TM-TROUBLE-RECORD                                  21220000
225300           FROM DETAIL-LINE-6                                     21230000
225400             AFTER ADVANCING 1 LINES                              21240000
225500         ADD 1                     TO PV-LINE-CNT                 21250000
225600         MOVE SPACES           TO DL6-DETAIL-CONSTANT             21260000
225700                                  DL6-DETAIL                      21270000
225800     END-IF.                                                      21280000
225900                                                                  21290000
226000********************************************************          21300000
226100 6000-PROCESS-PACK-SHORT-OVERS.                                   21310000
226200                                                                  21320000
226300     IF (PC-PACK-SHORT-REASON OR                                        00
226400         PC-PACK-OVER-REASON) AND                                       00
226700        (PV-SAVE-PO-NUMBER NOT = TM001-PO-NBR OR                  21350000
226800         PV-SAVE-REC-SEQ-NBR NOT = TM001-REC-SEQ-NBR OR           21360000
226900         PV-SAVE-TRBL-RSN-CDE NOT = TM001-TRBL-RSN-CDE OR         21370000
227000         PV-SAVE-PREPK-ID     NOT = TM001-PREPK-ID     OR         21380000
227100         PV-SAVE-NOTIF-TMST NOT = TM001-NOTIF-TMST)               21390000
227200         IF  PV-LINE-CNT > PC-55 OR                               21400000
227400             (PC-SAVE-PACK-SHORT-REASON AND                             00
227401              PC-PACK-OVER-REASON)                                      00
227600             IF  PV-LINE-CNT > PC-55                              21430000
227700                 PERFORM 8000-WRITE-REPORT-HEADERS                21440000
227800             ELSE                                                 21450000
227900                 MOVE PV-SHORT-OVER-TOT   TO TL2-TOT-SHORT-OVER   21460000
228000                 MOVE PC-SHORT-TOTAL      TO TL2-SHORT-OVER       21470000
228100                 MOVE ZERO                TO PV-SHORT-OVER-TOT    21480000
228200                 WRITE TM-TROUBLE-RECORD                          21490000
228300                   FROM TOTAL-LINE-2                              21500000
228400                     AFTER ADVANCING 2 LINES                      21510000
228500                 ADD 2                    TO PV-LINE-CNT          21520000
228600                 MOVE PC-2                TO PV-LINE-SUB          21530000
228700             END-IF                                               21540000
228800                                                                  21550000
228900             IF PC-PACK-SHORT-REASON                                    00
229100                 WRITE TM-TROUBLE-RECORD                          21570000
229200                   FROM HEADING-PACK-SHORT                        21580000
229300                     AFTER ADVANCING 2 LINES                      21590000
229400                                                                  21600000
229500                 WRITE TM-TROUBLE-RECORD                          21610000
229600                   FROM HEADING-PKLINE-1                          21620000
229700                     AFTER ADVANCING 2 LINES                      21630000
229800                                                                  21640000
229900                 WRITE TM-TROUBLE-RECORD                          21650000
230000                   FROM HEADING-PKLINE-SHT                        21660000
230100                     AFTER ADVANCING 1 LINES                      21670000
230200             ELSE                                                 21680000
230300                 WRITE TM-TROUBLE-RECORD                          21690000
230400                   FROM HEADING-PACK-OVER                         21700000
230500                     AFTER ADVANCING 2 LINES                      21710000
230600                                                                  21720000
230700                 WRITE TM-TROUBLE-RECORD                          21730000
230800                   FROM HEADING-PKLINE-1                          21740000
230900                     AFTER ADVANCING 2 LINES                      21750000
231000                                                                  21760000
231100                 WRITE TM-TROUBLE-RECORD                          21770000
231200                   FROM HEADING-PKLINE-OVR                        21780000
231300                     AFTER ADVANCING 1 LINES                      21790000
231400             END-IF                                               21800000
231500                                                                  21810000
231600             ADD 5                           TO PV-LINE-CNT       21820000
231700         END-IF                                                   21830000
231800                                                                  21840000
231900         MOVE TM001-PO-NBR         TO DK-PO-NBR                   21850000
232000                                      PV-PO                       21860000
232100                                      PV-SAVE-PO-NUMBER           21870000
232200         MOVE TM001-REC-SEQ-NBR    TO PV-RECEIVER                 21880000
232300                                      PV-SAVE-REC-SEQ-NBR         21890000
232400         MOVE TM001-TRBL-RSN-CDE   TO PV-SAVE-TRBL-RSN-CDE        21900000
232500                                      DLPK-REASON-CODE            21910000
232600         MOVE TM001-NOTIF-TMST     TO PV-SAVE-NOTIF-TMST          21920000
232700         MOVE PV-PO-RECEIVER       TO DLPK-PO-RECEIVER            21930000
232800         MOVE TM001-PREPK-ID       TO DK-PREPK-ID                 21940000
232900                                      DLPK-PK-ID                  21950000
233000                                      PV-SAVE-PREPK-ID            21960000
233100         PERFORM 5150-SELECT-DESC                                 21970000
233200         PERFORM 6100-PROCESS-TROUBLE-CURSOR                      21980000
233300         MOVE TM001-OVER-SHT-PCT   TO DLPK-PCNT-OVSH              21990000
233400         MOVE TM001-TRBL-RSN-CDE   TO DLPK-REASON-CODE            22000000
233500         PERFORM 8550-WRITE-PKDETAIL-LINES                        22010000
233600         ADD 1 TO PV-SHORT-OVER-TOT                               22020000
233700     END-IF.                                                      22030000
233800     MOVE PC-2                       TO PV-LINE-SUB.              22040000
234000                                                                  22060000
234100********************************************************          22070000
234200 6010-PROCESS-BADPK-SHORT-OVERS.                                  22080000
234300                                                                  22090000
234400     IF (TM001-TRBL-RSN-CDE = PC-269 OR PC-271) AND               22100000
234500        (PV-SAVE-PO-NUMBER NOT = TM001-PO-NBR OR                  22110000
234600         PV-SAVE-REC-SEQ-NBR NOT = TM001-REC-SEQ-NBR OR           22120000
234700         PV-SAVE-TRBL-RSN-CDE NOT = TM001-TRBL-RSN-CDE OR         22130000
234800         PV-SAVE-PREPK-ID     NOT = TM001-PREPK-ID     OR         22140000
234900         PV-SAVE-NOTIF-TMST NOT = TM001-NOTIF-TMST)               22150000
235000         IF  PV-LINE-CNT > PC-55 OR                               22160000
235100            ((PV-SAVE-TRBL-RSN-CDE = PC-269 OR PC-271) AND        22170000
235200             (TM001-TRBL-RSN-CDE > PC-271))                       22180000
235300             IF  PV-LINE-CNT > PC-55                              22190000
235400                 PERFORM 8000-WRITE-REPORT-HEADERS                22200000
235500             ELSE                                                 22210000
235600                 MOVE PV-SHORT-OVER-TOT   TO TL4-TOT-BAD-PACK     22220000
235700                 MOVE PC-SHORT-TOTAL      TO TL4-BAD-PACK         22230000
235800                 MOVE ZERO                TO PV-SHORT-OVER-TOT    22240000
235900                 WRITE TM-TROUBLE-RECORD                          22250000
236000                   FROM TOTAL-LINE-2                              22260000
236100                     AFTER ADVANCING 2 LINES                      22270000
236200                 ADD 2                    TO PV-LINE-CNT          22280000
236300                 MOVE PC-2                TO PV-LINE-SUB          22290000
236400             END-IF                                               22300000
236500                                                                  22310000
236600             IF TM001-TRBL-RSN-CDE = PC-269 OR PC-271             22320000
236700                 WRITE TM-TROUBLE-RECORD                          22330000
236800                   FROM HEADING-PACK-BAD                          22340000
236900                     AFTER ADVANCING 2 LINES                      22350000
237000                                                                  22360000
237100                 WRITE TM-TROUBLE-RECORD                          22370000
237200                   FROM HEADING-PKLINE-1                          22380000
237300                     AFTER ADVANCING 2 LINES                      22390000
237400                                                                  22400000
237500                 WRITE TM-TROUBLE-RECORD                          22410000
237600                   FROM HEADING-PKLINE-2                          22420000
237700                     AFTER ADVANCING 1 LINES                      22430000
237800             END-IF                                               22440000
237900                                                                  22450000
238000             ADD 5                           TO PV-LINE-CNT       22460000
238100         END-IF                                                   22470000
238200                                                                  22480000
238300         MOVE TM001-PO-NBR         TO DK-PO-NBR                   22490000
238400                                      PV-PO                       22500000
238500                                      PV-SAVE-PO-NUMBER           22510000
238600         MOVE TM001-REC-SEQ-NBR    TO PV-RECEIVER                 22520000
238700                                      PV-SAVE-REC-SEQ-NBR         22530000
238800         MOVE TM001-TRBL-RSN-CDE   TO PV-SAVE-TRBL-RSN-CDE        22540000
238900                                      DLPK-REASON-CODE            22550000
239000         MOVE TM001-NOTIF-TMST     TO PV-SAVE-NOTIF-TMST          22560000
239100         MOVE PV-PO-RECEIVER       TO DLPK-PO-RECEIVER            22570000
239200         MOVE TM001-PREPK-ID       TO DK-PREPK-ID                 22580000
239300                                      DLPK-PK-ID                  22590000
239400                                      PV-SAVE-PREPK-ID            22600000
239500         PERFORM 5150-SELECT-DESC                                 22610000
239600         PERFORM 6100-PROCESS-TROUBLE-CURSOR                      22620000
239700         MOVE TM001-TRBL-RSN-CDE   TO DLPK-REASON-CODE            22630000
239800         PERFORM 8550-WRITE-PKDETAIL-LINES                        22640000
239900         ADD 1 TO PV-SHORT-OVER-TOT                               22650000
240000     END-IF.                                                      22660000
240100     MOVE PC-2                       TO PV-LINE-SUB.              22670000
240200     PERFORM 2200-READ-EXTRACT.                                   22680000
240300                                                                  22690000
240400********************************************************          22700000
240500 6020-PROCESS-PKLN-SHORT-OVERS.                                   22710000
240600                                                                  22720000
240700     IF (TM001-TRBL-RSN-CDE = PC-582 OR PC-583 OR                 22730000
240800                              PC-591 OR PC-592)  AND              22740000
240900        (PV-SAVE-PO-NUMBER NOT = TM001-PO-NBR OR                  22750000
241000         PV-SAVE-REC-SEQ-NBR NOT = TM001-REC-SEQ-NBR OR           22760000
241100         PV-SAVE-TRBL-RSN-CDE NOT = TM001-TRBL-RSN-CDE OR         22770000
241200         PV-SAVE-PO-LNE-NBR NOT = TM001-PO-LNE-NBR  OR            22780000
241300         PV-SAVE-NOTIF-TMST NOT = TM001-NOTIF-TMST)               22790000
241400         IF  PV-LINE-CNT > PC-55 OR                               22800000
241500            ((PV-SAVE-TRBL-RSN-CDE = PC-582 OR PC-583) AND        22810000
241600             (TM001-TRBL-RSN-CDE = PC-591 OR PC-592))             22820000
241700             IF  PV-LINE-CNT > PC-55                              22830000
241800                 PERFORM 8000-WRITE-REPORT-HEADERS                22840000
241900             ELSE                                                 22850000
242000                 MOVE PV-SHORT-OVER-TOT   TO TL2-TOT-SHORT-OVER   22860000
242100                 MOVE PC-SHORT-TOTAL      TO TL2-SHORT-OVER       22870000
242200                 MOVE ZERO                TO PV-SHORT-OVER-TOT    22880000
242300                 WRITE TM-TROUBLE-RECORD                          22890000
242400                   FROM TOTAL-LINE-2                              22900000
242500                     AFTER ADVANCING 2 LINES                      22910000
242600                 ADD 2                    TO PV-LINE-CNT          22920000
242700                 MOVE PC-2                TO PV-LINE-SUB          22930000
242800             END-IF                                               22940000
242900                                                                  22950000
243000             IF TM001-TRBL-RSN-CDE = PC-582 OR PC-583             22960000
243100                 WRITE TM-TROUBLE-RECORD                          22970000
243200                   FROM HEADING-PACK-LINE-SHORT                   22980000
243300                     AFTER ADVANCING 2 LINES                      22990000
243400                                                                  23000000
243500                 WRITE TM-TROUBLE-RECORD                          23010000
243600                   FROM HEADING-LINE-8                            23020000
243700                     AFTER ADVANCING 2 LINES                      23030000
243800                                                                  23040000
243900                 WRITE TM-TROUBLE-RECORD                          23050000
244000                   FROM HEADING-LINE-9-SHORT                      23060000
244100                     AFTER ADVANCING 1 LINES                      23070000
244200             ELSE                                                 23080000
244300                 WRITE TM-TROUBLE-RECORD                          23090000
244400                   FROM HEADING-PACK-LINE-OVER                    23100000
244500                     AFTER ADVANCING 2 LINES                      23110000
244600                                                                  23120000
244700                 WRITE TM-TROUBLE-RECORD                          23130000
244800                   FROM HEADING-LINE-8                            23140000
244900                     AFTER ADVANCING 2 LINES                      23150000
245000                                                                  23160000
245100                 WRITE TM-TROUBLE-RECORD                          23170000
245200                   FROM HEADING-LINE-9-OVER                       23180000
245300                     AFTER ADVANCING 1 LINES                      23190000
245400             END-IF                                               23200000
245500                                                                  23210000
245600             ADD 5                           TO PV-LINE-CNT       23220000
245700         END-IF                                                   23230000
245800         MOVE TM001-PO-NBR         TO PURITM-PO-NBR               23240000
245900                                      PV-PO                       23250000
246000                                      PV-SAVE-PO-NUMBER           23260000
246100         MOVE TM001-REC-SEQ-NBR    TO PV-RECEIVER                 23270000
246200                                      PV-SAVE-REC-SEQ-NBR         23280000
246300         MOVE TM001-PO-LNE-NBR     TO PURITM-APP-PO-LNE-NBR       23290000
246400         MOVE TM001-TRBL-RSN-CDE   TO PV-SAVE-TRBL-RSN-CDE        23300000
246500         MOVE TM001-NOTIF-TMST     TO PV-SAVE-NOTIF-TMST          23310000
246600         MOVE PV-PO-RECEIVER       TO DL2-PO-RECEIVER             23320000
246700         MOVE TM001-PO-LNE-NBR     TO DL2-PO-LINE                 23330000
246800                                      PV-SAVE-PO-LNE-NBR          23340000
246900         MOVE TM001-DEPT-NBR       TO PV-SKU-DEPT                 23350000
247000         PERFORM 5100-SELECT-PURITM                               23370000
247100         MOVE PURITM-CL-NBR        TO PV-SKU-CLASS                23380000
247200                                                                  23390100
247300* INITIALIZED XL001-ITEM-COMMAREA.                               *23390299
247400* CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001                    23390399
247500         INITIALIZE XL001-ITEM-COMMAREA                           23390400
247600                    PV-TEMP-SEQ-NBR                               23390500
247700                    PV-TEMP-UPC-NBR                               23391099
247800                                                                  23391199
247900         IF (PURITM-SKU-SEQ-NBR = PC-000)                         23391299
248000            MOVE '00000000'    TO PV-SKU-SEQ                      23391399
248100         ELSE                                                     23391499
248200            IF (PURITM-SKU-SEQ-NBR = PC-999)                      23391599
248300               MOVE '99999999' TO PV-SKU-SEQ                      23391699
248400            END-IF                                                23391799
248500         END-IF                                                   23391899
248600                                                                  23391999
248700         IF PS-CALL-API-YES                    AND                23392099
248800            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                23392199
248900             (PURITM-SKU-SEQ-NBR NOT = PC-999))                   23392299
249000              PERFORM 5200-CALL-XLKUT-DOMAIN-PGM                  23392399
249100         END-IF                                                   23392499
249200                                                                  23393000
249300         MOVE PV-SKU                TO DL2-SKU                    23420099
249400         MOVE PURITM-VEND-STYL-NAME TO DL2-VENDOR-STYLE           23530000
249500         MOVE PURITM-SKU-DESC      TO DL3-DESCRIPTION             23540000
249600         PERFORM 7100-PROCESS-TROUBLE-CURSOR                      23550000
249700         MOVE TM001-OVER-SHT-PCT   TO DL2-PERCENT                 23560000
249800         MOVE TM001-TRBL-RSN-CDE   TO DL2-REASON-CODE             23570000
249900         PERFORM 8500-WRITE-DETAIL-LINES                          23580000
250000         ADD 1 TO PV-SHORT-OVER-TOT                               23590000
250100     END-IF.                                                      23600000
250200     MOVE PC-2                       TO PV-LINE-SUB.              23610000
250300     PERFORM 2200-READ-EXTRACT.                                   23620000
250400                                                                  23630000
250500***********************************************************       23640000
250600 6100-PROCESS-TROUBLE-CURSOR.                                     23650000
250700     MOVE TM001-NOTIF-NBR      TO TRBDTL-NOTIF-NBR.               23660000
250800     SET PS-START-OF-CURSOR    TO TRUE.                           23670000
250900     PERFORM 6200-OPEN-CURSOR.                                    23680000
251000     MOVE SPACES               TO PV-TEXT-TABLE-2.                23690000
251100     PERFORM 6300-FETCH-CURSOR.                                   23700000
251200     PERFORM 6400-PROCESS-CURSOR UNTIL                            23710000
251300          PS-END-OF-CURSOR.                                       23720000
251400     PERFORM 6500-CLOSE-CURSOR.                                   23730000
251500                                                                  23740000
251600 6200-OPEN-CURSOR.                                                23750000
251700     MOVE '6200-OPEN-CURSOR' TO PV-ABEND-PARAGRAPH.               23760000
251800     EXEC SQL                                                     23770000
251900          OPEN TROUBLE-CSR                                        23780000
252000     END-EXEC.                                                    23790000
252100                                                                  23800000
252200     EVALUATE TRUE                                                23810000
252300         WHEN SQLCODE = +0                                        23820000
252400             CONTINUE                                             23830000
252500         WHEN OTHER                                               23840000
252600           DISPLAY PV-ABEND-PARAGRAPH                             23850000
252700           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                23860000
252800           PERFORM Z999-SQL-ERROR                                 23870000
252900     END-EVALUATE.                                                23880000
253000 6300-FETCH-CURSOR.                                               23890000
253100     MOVE '6300-FETCH-CURSOR' TO PV-ABEND-PARAGRAPH.              23900000
253200     EXEC SQL                                                     23910000
253300          FETCH  TROUBLE-CSR                                      23920000
253400           INTO :TRBDTL-CRE-TMST                                  23930000
253500              , :TRBDTL-CRE-UID                                   23940000
253600              , :PV-TEXT-TABLE-2                                  23950000
253700     END-EXEC.                                                    23960000
253800                                                                  23970000
253900     EVALUATE TRUE                                                23980000
254000         WHEN SQLCODE = +0                                        23990000
254100             CONTINUE                                             24000000
254200         WHEN SQLCODE = +100                                      24010000
254300             SET PS-END-OF-CURSOR TO TRUE                         24020000
254400         WHEN OTHER                                               24030000
254500           DISPLAY PV-ABEND-PARAGRAPH                             24040000
254600           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                24050000
254700           PERFORM Z999-SQL-ERROR                                 24060000
254800     END-EVALUATE.                                                24070000
254900 6400-PROCESS-CURSOR.                                             24080000
255000     PERFORM 6600-PROCESS-TEXT VARYING                            24090000
255100         PV-SUB FROM 1 BY 1 UNTIL                                 24100000
255200         PV-SUB > 5.                                              24110000
255300     MOVE SPACES               TO PV-TEXT-TABLE-2.                24120000
255400     PERFORM 6300-FETCH-CURSOR.                                   24130000
255500                                                                  24140000
255600 6500-CLOSE-CURSOR.                                               24150000
255700     MOVE '6500-CLOSE-CURSOR' TO PV-ABEND-PARAGRAPH.              24160000
255800     EXEC SQL                                                     24170000
255900          CLOSE TROUBLE-CSR                                       24180000
256000     END-EXEC.                                                    24190000
256100                                                                  24200000
256200     EVALUATE TRUE                                                24210000
256300         WHEN SQLCODE = +0                                        24220000
256400             CONTINUE                                             24230000
256500         WHEN OTHER                                               24240000
256600           DISPLAY PV-ABEND-PARAGRAPH                             24250000
256700           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                24260000
256800           PERFORM Z999-SQL-ERROR                                 24270000
256900     END-EVALUATE.                                                24280000
257000                                                                  24290000
257100**********************************************************        24300000
257200***   PROCESS TEXT FOR PACK GROUPS G, F OR H                      24310000
257300**********************************************************        24320000
257400 6600-PROCESS-TEXT.                                               24330000
257500     EVALUATE TRUE                                                24340000
257600         WHEN PV-PK-TEXT-1(PV-SUB) = PC-PKOS-TEXT-1               24350000
257700             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     24360000
257800             MOVE PV-PK-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1      24370000
257900             PERFORM 6700-EXTRACT-NUMBER VARYING                  24380000
258000                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    24390000
258100                 PV-NUM-SUB = 0                                   24400000
258200             MOVE PV-EXTRACT-NUMBER-1 TO DLPK-RECEIVED            24410000
258300                                         PV-PK-RECEIVED           24420000
258400         WHEN PV-PK-TEXT-1(PV-SUB) = PC-PKOS-TEXT-2               24430000
258500             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     24440000
258600             MOVE PV-PK-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1      24450000
258700             PERFORM 6700-EXTRACT-NUMBER VARYING                  24460000
258800                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    24470000
258900                 PV-NUM-SUB = 0                                   24480000
259000             MOVE PV-EXTRACT-NUMBER-1 TO DLPK-OTR                 24490000
259100                                         PV-PK-OTR                24500000
259200             IF TM001-TRBL-RSN-CDE = PC-269 OR PC-271             24510000
259300                 PERFORM 6650-CALCULATE-PKPCNT                    24520000
259400                 MOVE PV-PK-PERCENT TO DLPK-PCNT-OVSH             24530000
259500             END-IF                                               24540000
259600         WHEN PV-PK-TEXT-1(PV-SUB) = PC-PKOS-TEXT-3               24550000
259700             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     24560000
259800             MOVE PV-PK-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1      24570000
259900             PERFORM 6700-EXTRACT-NUMBER VARYING                  24580000
260000                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    24590000
260100                 PV-NUM-SUB = 0                                   24600000
260200             MOVE PV-EXTRACT-NUMBER-1 TO DLPK-PKS-OVSH            24610000
260300         WHEN PV-PK-TEXT-1(PV-SUB) = PC-PKOS-TEXT-4               24620000
260400             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     24630000
260500             MOVE PV-PK-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1      24640000
260600             PERFORM 6700-EXTRACT-NUMBER VARYING                  24650000
260700                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    24660000
260800                 PV-NUM-SUB = 0                                   24670000
260900             MOVE PV-EXTRACT-NUMBER-1 TO DLPK-PKS-OVSH            24680000
261000     END-EVALUATE.                                                24690000
261100     EVALUATE TRUE                                                24700000
261200         WHEN PV-PK-TEXT-4(PV-SUB) = PC-PKOS-TEXT-5               24710000
261300             MOVE ZERO TO PV-EXTRACT-NUMBER-2                     24720000
261400             MOVE PV-PK-TEXT-5(PV-SUB) TO PV-NUMERIC-REDEF-2      24730000
261500             PERFORM 6800-EXTRACT-NUMBER VARYING                  24740000
261600                 PV-NUM-SUB FROM 7 BY -1 UNTIL                    24750000
261700                 PV-NUM-SUB = 0                                   24760000
261800             MOVE PV-EXTRACT-NUMBER-2 TO DLPK-ODD-UNTS            24770000
261900         WHEN PV-PK-TEXT-4(PV-SUB) = PC-PKOS-TEXT-6               24780000
262000             MOVE ZERO TO PV-EXTRACT-NUMBER-2                     24790000
262100             MOVE PV-PK-TEXT-5(PV-SUB) TO PV-NUMERIC-REDEF-2      24800000
262200             PERFORM 6800-EXTRACT-NUMBER VARYING                  24810000
262300                 PV-NUM-SUB FROM 7 BY -1 UNTIL                    24820000
262400                 PV-NUM-SUB = 0                                   24830000
262500             MOVE PV-EXTRACT-NUMBER-2 TO DLPK-DOL-ODD-UNT         24840000
262600             MOVE 6 TO PV-SUB                                     24850000
262700             SET PS-END-OF-CURSOR TO TRUE                         24860000
262800     END-EVALUATE.                                                24870000
262900                                                                  24880000
263000 6650-CALCULATE-PKPCNT.                                           24890000
263100     IF PV-PK-OTR > PV-PK-RECEIVED                                24900000
263200         COMPUTE PV-DIFFERENCE = PV-PK-OTR - PV-PK-RECEIVED       24910000
263300     ELSE                                                         24920000
263400         COMPUTE PV-DIFFERENCE = PV-PK-RECEIVED - PV-PK-OTR       24930000
263500     END-IF                                                       24940000
263600     IF PV-PK-OTR > 0                                             24950000
263700            COMPUTE PV-PK-PERCENT ROUNDED =                       24960000
263800               (PV-DIFFERENCE / PV-PK-OTR) * PC-100               24970000
263900     ELSE                                                         24980000
264000            MOVE +999 TO PV-PK-PERCENT.                           24990000
264100                                                                  25000000
264200 6700-EXTRACT-NUMBER.                                             25010000
264300     IF PV-NUM-1(PV-NUM-SUB) IS NUMERIC                           25020000
264400         MOVE PV-NUM-1(PV-NUM-SUB) TO PV-NUMBER-1(PV-NUM-SUB)     25030000
264500     END-IF.                                                      25040000
264600                                                                  25050000
264700 6800-EXTRACT-NUMBER.                                             25060000
264800     IF PV-NUM-2(PV-NUM-SUB) IS NUMERIC                           25070000
264900         MOVE PV-NUM-2(PV-NUM-SUB) TO PV-NUMBER-2(PV-NUM-SUB)     25080000
265000     END-IF.                                                      25090000
265100***********************************************************       25100000
265200 7100-PROCESS-TROUBLE-CURSOR.                                     25110000
265300     MOVE TM001-NOTIF-NBR      TO TRBDTL-NOTIF-NBR.               25120000
265400     SET PS-START-OF-CURSOR    TO TRUE.                           25130000
265500     PERFORM 7200-OPEN-CURSOR.                                    25140000
265600     MOVE SPACES               TO PV-TEXT-TABLE-3.                25150000
265700     PERFORM 7300-FETCH-CURSOR.                                   25160000
265800     PERFORM 7400-PROCESS-CURSOR UNTIL                            25170000
265900          PS-END-OF-CURSOR.                                       25180000
266000     PERFORM 7500-CLOSE-CURSOR.                                   25190000
266100                                                                  25200000
266200 7200-OPEN-CURSOR.                                                25210000
266300     MOVE '7200-OPEN-CURSOR' TO PV-ABEND-PARAGRAPH.               25220000
266400     EXEC SQL                                                     25230000
266500          OPEN TROUBLE-CSR                                        25240000
266600     END-EXEC.                                                    25250000
266700                                                                  25260000
266800     EVALUATE TRUE                                                25270000
266900         WHEN SQLCODE = +0                                        25280000
267000             CONTINUE                                             25290000
267100         WHEN OTHER                                               25300000
267200           DISPLAY PV-ABEND-PARAGRAPH                             25310000
267300           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                25320000
267400           PERFORM Z999-SQL-ERROR                                 25330000
267500     END-EVALUATE.                                                25340000
267600 7300-FETCH-CURSOR.                                               25350000
267700     MOVE '7300-FETCH-CURSOR' TO PV-ABEND-PARAGRAPH.              25360000
267800     EXEC SQL                                                     25370000
267900          FETCH  TROUBLE-CSR                                      25380000
268000           INTO :TRBDTL-CRE-TMST                                  25390000
268100              , :TRBDTL-CRE-UID                                   25400000
268200              , :PV-TEXT-TABLE-3                                  25410000
268300     END-EXEC.                                                    25420000
268400                                                                  25430000
268500     EVALUATE TRUE                                                25440000
268600         WHEN SQLCODE = +0                                        25450000
268700             CONTINUE                                             25460000
268800         WHEN SQLCODE = +100                                      25470000
268900             SET PS-END-OF-CURSOR TO TRUE                         25480000
269000         WHEN OTHER                                               25490000
269100           DISPLAY PV-ABEND-PARAGRAPH                             25500000
269200           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                25510000
269300           PERFORM Z999-SQL-ERROR                                 25520000
269400     END-EVALUATE.                                                25530000
269500 7400-PROCESS-CURSOR.                                             25540000
269600     PERFORM 7700-PROCESS-TEXT VARYING                            25550000
269700         PV-SUB FROM 1 BY 1 UNTIL                                 25560000
269800         PV-SUB > 5.                                              25570000
269900     MOVE SPACES               TO PV-TEXT-TABLE-3.                25580000
270000     PERFORM 7300-FETCH-CURSOR.                                   25590000
270100                                                                  25600000
270200 7500-CLOSE-CURSOR.                                               25610000
270300     MOVE '7500-CLOSE-CURSOR' TO PV-ABEND-PARAGRAPH.              25620000
270400     EXEC SQL                                                     25630000
270500          CLOSE TROUBLE-CSR                                       25640000
270600     END-EXEC.                                                    25650000
270700                                                                  25660000
270800     EVALUATE TRUE                                                25670000
270900         WHEN SQLCODE = +0                                        25680000
271000             CONTINUE                                             25690000
271100         WHEN OTHER                                               25700000
271200           DISPLAY PV-ABEND-PARAGRAPH                             25710000
271300           DISPLAY 'NOTIFY NBR: ' TRBDTL-NOTIF-NBR                25720000
271400           PERFORM Z999-SQL-ERROR                                 25730000
271500     END-EVALUATE.                                                25740000
271600                                                                  25750000
271700**********************************************************        25760000
271800***   PROCESS TEXT FOR PACK GROUPS I, J                           25770000
271900**********************************************************        25780000
272000 7700-PROCESS-TEXT.                                               25790000
272100     EVALUATE TRUE                                                25800000
272200         WHEN PV-PKLN-TEXT-1(PV-SUB) = PC-PKLOS-TEXT-1            25810000
272300             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     25820000
272400             MOVE PV-PKLN-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1    25830000
272500             PERFORM 6700-EXTRACT-NUMBER VARYING                  25840000
272600                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    25850000
272700                 PV-NUM-SUB = 0                                   25860000
272800             MOVE PV-EXTRACT-NUMBER-1 TO DL2-RECEIVED             25870000
272900         WHEN PV-PKLN-TEXT-1(PV-SUB) = PC-PKLOS-TEXT-2            25880000
273000             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     25890000
273100             MOVE PV-PKLN-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1    25900000
273200             PERFORM 6700-EXTRACT-NUMBER VARYING                  25910000
273300                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    25920000
273400                 PV-NUM-SUB = 0                                   25930000
273500             MOVE PV-EXTRACT-NUMBER-1 TO DL2-UNITS-OTR            25940000
273600         WHEN PV-PKLN-TEXT-1(PV-SUB) = PC-PKLOS-TEXT-3            25950000
273700             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     25960000
273800             MOVE PV-PKLN-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1    25970000
273900             PERFORM 6700-EXTRACT-NUMBER VARYING                  25980000
274000                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    25990000
274100                 PV-NUM-SUB = 0                                   26000000
274200             MOVE PV-EXTRACT-NUMBER-1 TO DL2-SHORT-OVER           26010000
274300             MOVE 6 TO PV-SUB                                     26020000
274400             SET PS-END-OF-CURSOR TO TRUE                         26030000
274500         WHEN PV-PKLN-TEXT-1(PV-SUB) = PC-PKLOS-TEXT-4            26040000
274600             MOVE ZERO TO PV-EXTRACT-NUMBER-1                     26050000
274700             MOVE PV-PKLN-TEXT-2(PV-SUB) TO PV-NUMERIC-REDEF-1    26060000
274800             PERFORM 6700-EXTRACT-NUMBER VARYING                  26070000
274900                 PV-NUM-SUB FROM 5 BY -1 UNTIL                    26080000
275000                 PV-NUM-SUB = 0                                   26090000
275100             MOVE PV-EXTRACT-NUMBER-1 TO DL2-SHORT-OVER           26100000
275200             MOVE 6 TO PV-SUB                                     26110000
275300             SET PS-END-OF-CURSOR TO TRUE                         26120000
275400                                                                  26130000
275500     END-EVALUATE.                                                26140000
275600*******************************************************           26150000
275700                                                                  26160000
275800 8000-WRITE-REPORT-HEADERS.                                       26170000
275900******************************************************************26180000
276000*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *26190000
276100*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *26200000
276200******************************************************************26210000
276300     PERFORM 8200-WRITE-TOP-LINE.                                 26220000
276400                                                                  26230000
276500     IF PS-DAILY                                                  26240000
276600         WRITE TM-TROUBLE-RECORD                                  26250000
276700           FROM HEADING-LINE-1                                    26260000
276800             AFTER ADVANCING 2 LINE                               26270000
276900                                                                  26280000
277000         WRITE TM-TROUBLE-RECORD                                  26290000
277100           FROM HEADING-LINE-2                                    26300000
277200             AFTER ADVANCING 1 LINES                              26310000
277300                                                                  26320000
277400         WRITE TM-TROUBLE-RECORD                                  26330000
277500           FROM HEADING-LINE-3                                    26340000
277600             AFTER ADVANCING 2 LINES                              26350000
277700     ELSE                                                         26360000
277800         IF PS-WEEKLY                                             26370000
277900             WRITE TM-TROUBLE-RECORD                              26380000
278000               FROM HEADING-LINE-1W                               26390000
278100                 AFTER ADVANCING 2 LINE                           26400000
278200                                                                  26410000
278300             WRITE TM-TROUBLE-RECORD                              26420000
278400               FROM HEADING-LINE-2W                               26430000
278500                 AFTER ADVANCING 1 LINES                          26440000
278600                                                                  26450000
278700             WRITE TM-TROUBLE-RECORD                              26460000
278800               FROM HEADING-LINE-3                                26470000
278900                 AFTER ADVANCING 2 LINES                          26480000
279000         ELSE                                                     26490000
279100             WRITE TM-TROUBLE-RECORD                              26500000
279200               FROM HEADING-LINE-1M                               26510000
279300                 AFTER ADVANCING 2 LINE                           26520000
279400                                                                  26530000
279500             WRITE TM-TROUBLE-RECORD                              26540000
279600               FROM HEADING-LINE-2M                               26550000
279700                 AFTER ADVANCING 1 LINES                          26560000
279800                                                                  26570000
279900             WRITE TM-TROUBLE-RECORD                              26580000
280000               FROM HEADING-LINE-3                                26590000
280100                 AFTER ADVANCING 2 LINES                          26600000
280200     END-IF.                                                      26610000
280300     MOVE PC-6            TO PV-LINE-CNT.                         26620000
280400     MOVE PC-2            TO PV-LINE-SUB.                         26630000
280500                                                                  26640000
280600 8200-WRITE-TOP-LINE.                                             26650000
280700******************************************************************26660000
280800*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *26670000
280900*     NEEDED FOR AN ASN NUMBER.                                  *26680000
281000******************************************************************26690000
281100     ADD 1                        TO PV-PAGE-CNT.                 26700000
281200                                                                  26710000
281300     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          26720000
281400                                                                  26730000
281500     WRITE TM-TROUBLE-RECORD                                      26740000
281600       FROM DP132O-STANDRD-HEADER-132-COLS                        26750000
281700         AFTER ADVANCING PAGE.                                    26760000
281800                                                                  26770000
281900 8400-WRITE-DETAIL-LINES.                                         26780000
282000******************************************************************26790000
282100*     WRITES THE DETAIL LINE INFORMATION.                        *26800000
282200******************************************************************26810000
282300     WRITE TM-TROUBLE-RECORD                                      26820000
282400       FROM DETAIL-LINE-1                                         26830000
282500         AFTER ADVANCING PV-LINE-SUB LINES.                       26840000
282600                                                                  26850000
282700     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              26860000
282800     MOVE PC-1                       TO PV-LINE-SUB.              26870000
282900                                                                  26880000
283000 8500-WRITE-DETAIL-LINES.                                         26890000
283100******************************************************************26900000
283200*     WRITES THE DETAIL LINE INFORMATION.                        *26910000
283300******************************************************************26920000
283400     WRITE TM-TROUBLE-RECORD                                      26930000
283500       FROM DETAIL-LINE-2                                         26940000
283600         AFTER ADVANCING PV-LINE-SUB LINES.                       26950000
283700                                                                  26960000
283800     WRITE TM-TROUBLE-RECORD                                      26970000
283900       FROM DETAIL-LINE-3                                         26980000
284000         AFTER ADVANCING PC-1 LINES.                              26990000
284100                                                                  27000000
284200     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              27010000
284300     ADD PC-1                        TO PV-LINE-CNT.              27020000
284400     MOVE PC-1                       TO PV-LINE-SUB.              27030000
284500                                                                  27040000
284600 8550-WRITE-PKDETAIL-LINES.                                       27050000
284700******************************************************************27060000
284800*     WRITES THE PACK DETAIL LINE INFORMATION.                   *27070000
284900******************************************************************27080000
285000     WRITE TM-TROUBLE-RECORD                                      27090000
285100       FROM DETAIL-PKLINE                                         27100000
285200         AFTER ADVANCING PC-1 LINES.                              27110000
285300     ADD PC-1                        TO PV-LINE-CNT.              27120000
285400     MOVE PC-1                       TO PV-LINE-SUB.              27130000
285500                                                                  27140000
285600 8600-WRITE-DETAIL-LINES.                                         27150000
285700******************************************************************27160000
285800*     WRITES THE DETAIL LINE INFORMATION.                        *27170000
285900******************************************************************27180000
286000     WRITE TM-TROUBLE-RECORD                                      27190000
286100       FROM DETAIL-LINE-4                                         27200000
286200         AFTER ADVANCING PV-LINE-SUB LINES.                       27210000
286300                                                                  27220000
286400     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              27230000
286500     MOVE PC-1                       TO PV-LINE-SUB.              27240000
286600                                                                  27250000
286700******************************************************************27260000
286800*     SQL WARNING OR ERROR PROCESSING                            *27270000
286900*                                                                *27280000
287000******************************************************************27290000
287100                                                                  27300000
287200                                                                  27310000
287300 Z999-SQL-ERROR.                                                  27320000
287400*---------------                                                  27330000
287500                                                                  27340000
287600     MOVE SQLCODE    TO SQLCODE2.                                 27350000
287700     MOVE SQLERRD(3) TO SQLERRD3.                                 27360000
287800     DISPLAY '** ABEND **       ** = SQLERROR'.                   27370000
287900     DISPLAY '** PROGRAM        ** = TMKRP009'.                   27380000
288000     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  27390000
288100     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  27400000
288200     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   27410000
288300     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  27420000
288400     EXEC SQL                                                     27430000
288500         COMMIT                                                   27440000
288600     END-EXEC.                                                    27450000
288700     MOVE +4013 TO PV-ABEND-CODE.                                 27460000
288800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         27470000
288900                                                                  27471000
289000*----------------------------------------------------------------*27472000
289100* DISPLAY MESSAGES,WHEN ABEND OCCURS FROM                         27472299
289200* LOGISTICS DOMAIN ITEM ACCESS MODULE.                          * 27472399
289300*----------------------------------------------------------------*27473000
289400 9000-PROCESS-ABEND.                                              27480000
289500                                                                  27490000
289600     DISPLAY '** ABEND **       ** = SQLERROR'.                   27491000
289700     DISPLAY '** PROGRAM        ** = TMKRP009'.                   27492000
289800     DISPLAY '** ABEND PARAGRAPH **  ' PV-ABEND-PARAGRAPH.        27500000
289900     DISPLAY '** ERROR MESSAGE   **  ' PV-ABEND-MESSAGE-TEXT.     27510000
290000     DISPLAY '** SQLCODE         **  ' PV-SQLCODE.                27520000
290100     DISPLAY '** VIEW  NAME      **  ' PV-DB2-VIEW-NAME.          27530000
290200     MOVE +4013 TO PV-ABEND-CODE.                                 27570000
290300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         27580000
