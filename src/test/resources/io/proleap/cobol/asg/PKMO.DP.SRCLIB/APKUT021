000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT021.                                        00020000
000300 AUTHOR.         NANCY EILBES.                                    00030000
000400 DATE-WRITTEN.   06/28/2006.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060000
000800*     ACCUMULATE MATCH STATISTICS AND CALCULATE PERCENTAGES      *00080000
000801*----------------------------------------------------------------*00080100
000810*     COBOL 2                                                    *00081000
000900*                                                                *00090000
000910*     THIS PROGRAM READS A WEEK WORTH OF TPOSTRR BACKUP FILES    *00091000
000920*     AND COUNTS OCCURRENCES OF BULK VS BY-STORE WITHIN EACH     *00092000
000930*     PAY-RELEASE SOURCE AND CALCULATES PERCENT TO TOTAL OF      *00093000
000931*     EACH CATEGORY.  ALSO COUNTS IMPORTS SO THEY CAN BE         *00093100
000932*     BACKED OUT OF THE BATCH/BULK TOTAL IF NECESSARY.           *00093200
000933*                                                                *00093300
000934*     NOTE THAT THE IMPORT TALLY IS NOT PERFECT.  IT ASSUMES     *00093400
000935*     THAT IMPORT POS ARE THE ONLY ONES THAT CAN HAVE TOLERANCE  *00093500
000936*     OVER $200, BUT IT COULD MISS IMPORT POS IF THE TOLERANCE   *00093600
000937*     WERE UNDER $200.                                           *00093700
000940*                                                                *00094000
001000* INPUT:                                                         *00100000
001100*  1. PO/STORE RELEASE FILE        COPYBOOK TPOSTRR              *00110000
001200*                                                                *00120000
001300* OUTPUT:                                                        *00130000
001400*  1. STATISTICS TEXT FILE                                       *00140000
001400*  2. VENDOR DATA FILE                                           *00141010
001500*                                                                *00150000
001600*----------------------------------------------------------------*00160000
001601* CHANGE LOG:                                                   * 00160108
001602*                                                               * 00160209
001603* DATE  03/11/2007                                              * 00160309
001604*     CHANGE MADE: MATCH BY DC PROJECT - ADDED DC LOGIC FOR     * 00160409
001605*     STATISTIC REPORTING                                       * 00160509
001606*     MADE BY: GREG WISIALOWSKI        WR/IR #: WR21578         * 00160609
001603* DATE  04/25/2022                                              * 00160710
001604*     CHANGE MADE: ADD LOOKUP FOR VENDOR INFO, WRITE OUT 2ND    * 00160810
001605*     FILE THAT CONTAINS THE VENDOR FIELDS                      * 00160910
001606*     MADE BY: JEAN KURK               WR/IR #: CHG0269057      * 00161010
001607*----------------------------------------------------------------*00162009
001700   EJECT                                                          00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT POSTRR-FILE   ASSIGN TO UT-S-INP01.                   00250000
002600     SELECT STATS-FILE    ASSIGN TO UT-S-OUT01.                   00260000
002600     SELECT VENDOR-FILE   ASSIGN TO UT-S-OUT02.                   00261016
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  POSTRR-FILE                                                  00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS.                                    00340000
003500 01  POSTRR-REC.                                                  00350000
003600     05  FILLER                       PIC  X(60).                 00360008
003700                                                                  00370000
003800 FD  STATS-FILE                                                   00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS.                                    00410000
004200 01  STATS-REC.                                                   00420000
004300     05  FILLER                       PIC  X(184).                00430006
004400                                                                  00440000
003800 FD  VENDOR-FILE                                                  00441010
003900     RECORDING MODE IS F                                          00442010
004000     LABEL RECORDS ARE STANDARD                                   00443010
004100     BLOCK CONTAINS 0 RECORDS.                                    00444010
004200 01  VENDOR-REC.                                                  00445010
004300     05  FILLER                       PIC  X(100).                00446011
004400                                                                  00447010
004500 EJECT                                                            00450000
004600 WORKING-STORAGE SECTION.                                         00460000
004700                                                                  00470000
004800 01  EOF-SW                           PIC X     VALUE 'N'.        00480000
004900     88  IN-EOF                                 VALUE 'Y'.        00490000
005000 01  PROGRAM-VARIABLES.                                           00500000
005100     05  PV-BATCH-COUNT               PIC S9(7) VALUE ZERO.       00510000
005110     05  PV-BATCH-BULK-COUNT          PIC S9(7) VALUE ZERO.       00511000
005120     05  PV-BATCH-DC-COUNT            PIC S9(7) VALUE ZERO.       00512006
005121     05  PV-BATCH-STORE-COUNT         PIC S9(7) VALUE ZERO.       00512109
005130     05  PV-MANUAL-COUNT              PIC S9(7) VALUE ZERO.       00513000
005131     05  PV-MANUAL-BULK-COUNT         PIC S9(7) VALUE ZERO.       00513100
005132     05  PV-MANUAL-DC-COUNT           PIC S9(7) VALUE ZERO.       00513206
005133     05  PV-MANUAL-STORE-COUNT        PIC S9(7) VALUE ZERO.       00513309
005134     05  PV-AUTO-COUNT                PIC S9(7) VALUE ZERO.       00513406
005135     05  PV-AUTO-BULK-COUNT           PIC S9(7) VALUE ZERO.       00513506
005136     05  PV-AUTO-DC-COUNT             PIC S9(7) VALUE ZERO.       00513606
005137     05  PV-AUTO-STORE-COUNT          PIC S9(7) VALUE ZERO.       00513706
005138     05  PV-TOTAL-COUNT               PIC S9(8) VALUE ZERO.       00513806
005139     05  PV-TOTAL-BULK-COUNT          PIC S9(7) VALUE ZERO.       00513906
005140     05  PV-TOTAL-DC-COUNT            PIC S9(7) VALUE ZERO.       00514006
005141     05  PV-TOTAL-STORE-COUNT         PIC S9(7) VALUE ZERO.       00514106
005142     05  PV-BATCH-PERCENT             PIC S9(3)V99999 VALUE ZERO. 00514206
005143     05  PV-MANUAL-PERCENT            PIC S9(3)V99999 VALUE ZERO. 00514306
005144     05  PV-AUTO-PERCENT              PIC S9(3)V99999 VALUE ZERO. 00514406
005145     05  PV-BULK-PERCENT              PIC S9(3)V99999 VALUE ZERO. 00514506
005146     05  PV-DC-PERCENT                PIC S9(3)V99999 VALUE ZERO. 00514606
005147     05  PV-STORE-PERCENT             PIC S9(3)V99999 VALUE ZERO. 00514706
005148     05  PV-IMPORT-COUNT              PIC S9(7) VALUE ZERO.       00514806
005148     05  PV-HOLD-PO-NBR               PIC S9(9) COMP VALUE ZERO.  00514910
005149                                                                  00515010
005150 01  STATS-RECORD.                                                00515110
005151     05  STATS-BATCH-COUNT            PIC 9999999.                00515210
005152     05  FILLER                       PIC X     VALUE SPACES.     00515310
005153     05  STATS-BATCH-BULK-COUNT       PIC 9999999.                00515410
005154     05  FILLER                       PIC X     VALUE SPACES.     00515510
005160     05  STATS-BATCH-DC-COUNT         PIC 9999999.                00516006
005161     05  FILLER                       PIC X     VALUE SPACES.     00516106
005162     05  STATS-BATCH-STORE-COUNT      PIC 9999999.                00516206
005170     05  FILLER                       PIC X     VALUE SPACES.     00517000
005180     05  STATS-IMPORT-COUNT           PIC 9999999.                00518000
005190     05  FILLER                       PIC X     VALUE SPACES.     00519000
005200     05  STATS-AUTO-COUNT             PIC 9999999.                00520000
005300     05  FILLER                       PIC X     VALUE SPACES.     00530000
005400     05  STATS-AUTO-BULK-COUNT        PIC 9999999.                00540000
005410     05  FILLER                       PIC X     VALUE SPACES.     00541000
005411     05  STATS-AUTO-DC-COUNT          PIC 9999999.                00541106
005412     05  FILLER                       PIC X     VALUE SPACES.     00541206
005413     05  STATS-AUTO-STORE-COUNT       PIC 9999999.                00541306
005414     05  FILLER                       PIC X     VALUE SPACES.     00541406
005415     05  STATS-MANUAL-COUNT           PIC 9999999.                00541506
005416     05  FILLER                       PIC X     VALUE SPACES.     00541606
005417     05  STATS-MANUAL-BULK-COUNT      PIC 9999999.                00541706
005418     05  FILLER                       PIC X     VALUE SPACES.     00541806
005419     05  STATS-MANUAL-DC-COUNT        PIC 9999999.                00541906
005420     05  FILLER                       PIC X     VALUE SPACES.     00542006
005421     05  STATS-MANUAL-STORE-COUNT     PIC 9999999.                00542106
005422     05  FILLER                       PIC X     VALUE SPACES.     00542206
005423     05  STATS-TOTAL-COUNT            PIC 99999999.               00542306
005424     05  FILLER                       PIC X     VALUE SPACES.     00542406
005425     05  STATS-TOTAL-BULK-COUNT       PIC 9999999.                00542506
005426     05  FILLER                       PIC X     VALUE SPACES.     00542606
005427     05  STATS-TOTAL-DC-COUNT         PIC 9999999.                00542706
005428     05  FILLER                       PIC X     VALUE SPACES.     00542806
005429     05  STATS-TOTAL-STORE-COUNT      PIC 9999999.                00542906
005430     05  FILLER                       PIC X     VALUE SPACES.     00543006
005431     05  STATS-BATCH-PERCENT          PIC 999.999.                00543106
005432     05  FILLER                       PIC X     VALUE SPACES.     00543206
005433     05  STATS-AUTO-PERCENT           PIC 999.999.                00543306
005434     05  FILLER                       PIC X     VALUE SPACES.     00543406
005435     05  STATS-MANUAL-PERCENT         PIC 999.999.                00543506
005436     05  FILLER                       PIC X     VALUE SPACES.     00543606
005440     05  STATS-BULK-PERCENT           PIC 999.999.                00544000
005450     05  FILLER                       PIC X     VALUE SPACES.     00545000
005460     05  STATS-DC-PERCENT             PIC 999.999.                00546006
005461     05  FILLER                       PIC X     VALUE SPACES.     00546106
005462     05  STATS-STORE-PERCENT          PIC 999.999.                00546206
005470                                                                  00547000
011300*---------------------------------------------------------------- 00547116
011400*  WORKING STORAGE AREA FOR DPPD004                               00547216
011500*---------------------------------------------------------------- 00547316
011600     COPY DPWS004.                                                00547416
011700                                                                  00547516
005471*---------------------------------------------------------------  00547602
005472*  RELEASED PO/STORES - USED FOR INPUT FILE LAYOUT                00547710
005473*---------------------------------------------------------------  00547802
005474     EXEC SQL                                                     00547905
005475          INCLUDE TPOSTRR                                         00548005
005477     END-EXEC.                                                    00548105
005471*---------------------------------------------------------------  00548210
005472*  PURCHASE ORDER TABLE                                           00548310
005473*---------------------------------------------------------------  00548410
005474     EXEC SQL                                                     00548510
005475          INCLUDE TPURCHS                                         00548610
005477     END-EXEC.                                                    00548714
005490                                                                  00548814
005471*---------------------------------------------------------------  00548910
005472*  ENTITY NAME TABLE                                              00549010
005473*---------------------------------------------------------------  00549110
005474     EXEC SQL                                                     00549210
005475          INCLUDE TENTNME                                         00549310
005477     END-EXEC.                                                    00549410
005490                                                                  00549515
005471*---------------------------------------------------------------  00549615
005472*  EXTERNAL ENTERPRISE TABLE                                      00549715
005473*---------------------------------------------------------------  00549815
005474     EXEC SQL                                                     00549915
005475          INCLUDE TEXTENT                                         00550015
005477     END-EXEC.                                                    00550115
005490                                                                  00550211
012500*---------------------------------------------------------------- 00550312
012600*    SQL COMMUNICATIONS AREA DCLGEN                               00550412
012700*---------------------------------------------------------------- 00550512
010500     COPY SQLCA2.                                                 00550613
010600                                                                  00550713
012800     EXEC SQL                                                     00550812
012900         INCLUDE SQLCA                                            00550912
013000     END-EXEC.                                                    00551012
013100                                                                  00551112
009500*--------------------------------------------------------------*  00551211
009600*  RECORD LAYOUT FOR VENDOR FILE                                  00551311
009700*--------------------------------------------------------------*  00551411
009800     COPY APRD444.                                                00551511
005490                                                                  00551611
013200*----------------------------------------------------------------*00551711
013300*  ABEND DATA AREAS                                              *00551811
013400*----------------------------------------------------------------*00551911
013500 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          00552011
013600                                             COMP SYNC.           00552111
013800     88  AC-DB2-ERROR                        VALUE +4013.         00552211
014000                                                                  00552311
014100                                                                  00552411
014200 01  ABEND-AREAS.                                                 00552511
014300     05  AA-ABEND-LIT            PIC  X(40)  VALUE                00552611
014400             '*****       ABEND'.                                 00552711
014500     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                00552811
014600             '*****   PROGRAM: APKUT002'.                         00552911
014700     05  AA-PARAGRAPH-LIT.                                        00553011
014800         10  FILLER              PIC  X(17)  VALUE                00553111
014900             '***** PARAGRAPH: '.                                 00553211
015000         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        00553311
015100     05  AA-MESSAGE-LINE.                                         00553411
015200         10  FILLER              PIC  X(06)  VALUE '*****'.       00553511
015300         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        00553611
015400     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                00553711
015500             '*****    DB2 ERROR'.                                00553811
015600     05  AA-DB2-OPERATION-LIT.                                    00553911
015700         10  FILLER              PIC  X(17)  VALUE                00554011
015800             '***** OPERATION: '.                                 00554111
015900         10  AA-DB2-OPERATION.                                    00554211
016000             15  AA-DB2-OP-1     PIC  X(50)  VALUE SPACES.        00554311
016100             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        00554411
016200     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        00554511
016200     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        00554616
016200     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        00554716
016300                                                                  00554816
005479 EJECT                                                            00554916
005490                                                                  00555000
005600 PROCEDURE DIVISION.                                              00560000
005700 A100-MAIN.                                                       00570000
005800                                                                  00580000
005900     PERFORM B100-INITIALIZE.                                     00590000
006000                                                                  00600000
006100     PERFORM B200-ACCUMULATE-STATS                                00610000
006200         UNTIL IN-EOF.                                            00620000
006300                                                                  00630000
006400     PERFORM C100-CREATE-STATS-RECORD.                            00640001
006410                                                                  00641001
006420     PERFORM B300-END-PROCESS.                                    00642001
006500                                                                  00650000
006600     GOBACK.                                                      00660000
006700 EJECT                                                            00670000
006800*----------------------------------------------------------------*00680000
006900*    INITIALIZATION PROCESSING                                   *00690000
007100*----------------------------------------------------------------*00710000
007200 B100-INITIALIZE.                                                 00720000
007300                                                                  00730000
007400     OPEN INPUT  POSTRR-FILE                                      00740000
007500          OUTPUT VENDOR-FILE                                      00741010
007500          OUTPUT STATS-FILE.                                      00750010
007600                                                                  00760000
007700     PERFORM R100-READ-INPUT.                                     00770000
007800                                                                  00780000
007810*----------------------------------------------------------------*00781000
007820*  ACCUMULATE MATCH STATISTICS BASED ON VALUES IN VARIOUS POSTRR *00782000
007821*  FIELDS.                                                       *00782100
007830*----------------------------------------------------------------*00783000
007900 B200-ACCUMULATE-STATS.                                           00790000
008000                                                                  00800000
008000     IF POSTRR-PO-NBR NOT = PV-HOLD-PO-NBR                        00801011
008000         PERFORM T100-GET-VENDOR-DATA                             00802011
008000         MOVE POSTRR-PO-NBR TO PV-HOLD-PO-NBR                     00803011
008000     END-IF.                                                      00804011
008000                                                                  00805018
008100     IF POSTRR-STATUS-CDE = 'P'                                   00810000
008100     AND POSTRR-PAYT-RLSE-USR-ID NOT = 'BYPASS'                   00810120
008000        PERFORM W200-WRITE-VENDOR-RECORD                          00811019
008200        IF POSTRR-CRE-PRC-CDE = 'B'                               00820000
008300           ADD 1 TO PV-BATCH-COUNT                                00830000
008301           ADD 1 TO PV-TOTAL-COUNT                                00830100
008302           IF POSTRR-MTCH-LVL-CDE = 'P'                           00830206
008303              ADD 1 TO PV-BATCH-BULK-COUNT                        00830300
008304              ADD 1 TO PV-TOTAL-BULK-COUNT                        00830400
008305              IF POSTRR-TOLR-ADJ-AMT > 200                        00830500
008306                 ADD 1 TO PV-IMPORT-COUNT                         00830600
008307              END-IF                                              00830700
008308           ELSE                                                   00830800
008309              IF POSTRR-MTCH-LVL-CDE = 'S'                        00830906
008310                 ADD 1 TO PV-BATCH-STORE-COUNT                    00831006
008311                 ADD 1 TO PV-TOTAL-STORE-COUNT                    00831106
008312              ELSE                                                00831206
008313                 ADD 1 TO PV-BATCH-DC-COUNT                       00831306
008314                 ADD 1 TO PV-TOTAL-DC-COUNT                       00831406
008315              END-IF                                              00831506
008316           END-IF                                                 00831606
008317        ELSE                                                      00831706
008318           IF POSTRR-CRE-PRC-CDE = 'O'                            00831806
008319              ADD 1 TO PV-MANUAL-COUNT                            00831906
008320              ADD 1 TO PV-TOTAL-COUNT                             00832006
008321              IF POSTRR-MTCH-LVL-CDE = 'P'                        00832106
008322                 ADD 1 TO PV-MANUAL-BULK-COUNT                    00832206
008323                 ADD 1 TO PV-TOTAL-BULK-COUNT                     00832306
008324              ELSE                                                00832406
008325                  IF POSTRR-MTCH-LVL-CDE = 'S'                    00832506
008326                     ADD 1 TO PV-MANUAL-STORE-COUNT               00832606
008327                     ADD 1 TO PV-TOTAL-STORE-COUNT                00832706
008328                  ELSE                                            00832806
008329                     ADD 1 TO PV-MANUAL-DC-COUNT                  00832906
008330                     ADD 1 TO PV-TOTAL-DC-COUNT                   00833006
008331                  END-IF                                          00833106
008332              END-IF                                              00833206
008333           ELSE                                                   00833306
008334              IF POSTRR-CRE-PRC-CDE = 'A'                         00833406
008335              AND POSTRR-PAYT-RLSE-USR-ID = 'APKUP230'            00833507
008336                 ADD 1 TO PV-AUTO-COUNT                           00833606
008337                 ADD 1 TO PV-TOTAL-COUNT                          00833706
008338                 IF POSTRR-MTCH-LVL-CDE = 'P'                     00833806
008339                    ADD 1 TO PV-AUTO-BULK-COUNT                   00833906
008340                    ADD 1 TO PV-TOTAL-BULK-COUNT                  00834006
008341                 ELSE                                             00834106
008342                     IF POSTRR-MTCH-LVL-CDE = 'S'                 00834206
008343                        ADD 1 TO PV-AUTO-STORE-COUNT              00834306
008344                        ADD 1 TO PV-TOTAL-STORE-COUNT             00834406
008345                     ELSE                                         00834506
008346                        ADD 1 TO PV-AUTO-DC-COUNT                 00834606
008347                        ADD 1 TO PV-TOTAL-DC-COUNT                00834706
008348                     END-IF                                       00834806
008349                 END-IF                                           00834906
008350              END-IF                                              00835006
008351           END-IF                                                 00835106
008352        END-IF                                                    00835206
008353     END-IF.                                                      00835306
008354                                                                  00835406
008355     PERFORM R100-READ-INPUT.                                     00835506
008360                                                                  00836000
008370 B300-END-PROCESS.                                                00837000
008380                                                                  00838000
008390     DISPLAY 'PROGRAM APKUT021 ENDS SUCCESSFULLY'.                00839000
008750                                                                  00875000
008751     DISPLAY 'BATCH-COUNT    = ' STATS-BATCH-COUNT.               00875100
008752     DISPLAY 'MANUAL-COUNT   = ' STATS-MANUAL-COUNT.              00875200
008753     DISPLAY 'AUTO-COUNT     = ' STATS-AUTO-COUNT.                00875300
008754     DISPLAY 'TOTAL-COUNT    = ' STATS-TOTAL-COUNT.               00875400
008755     DISPLAY 'BATCH-PERCENT  = ' STATS-BATCH-PERCENT.             00875500
008756     DISPLAY 'MANUAL-PERCENT = ' STATS-MANUAL-PERCENT.            00875600
008757     DISPLAY 'AUTO-PERCENT   = ' STATS-AUTO-PERCENT.              00875700
008758     DISPLAY '-------------------------------------'.             00875800
008759     DISPLAY 'BATCH-BULK-COUNT  = ' STATS-BATCH-BULK-COUNT.       00875900
008760     DISPLAY 'MANUAL-BULK-COUNT = ' STATS-MANUAL-BULK-COUNT.      00876000
008761     DISPLAY 'AUTO-BULK-COUNT   = ' STATS-AUTO-BULK-COUNT.        00876100
008762     DISPLAY 'TOTAL-BULK-COUNT  = ' STATS-TOTAL-BULK-COUNT.       00876200
008763     DISPLAY '-------------------------------------'.             00876300
008764     DISPLAY 'BATCH-DC-COUNT  = ' STATS-BATCH-DC-COUNT.           00876406
008765     DISPLAY 'MANUAL-DC-COUNT = ' STATS-MANUAL-DC-COUNT.          00876506
008766     DISPLAY 'AUTO-DC-COUNT   = ' STATS-AUTO-DC-COUNT.            00876606
008767     DISPLAY 'TOTAL-DC-COUNT  = ' STATS-TOTAL-DC-COUNT.           00876706
008768     DISPLAY '-------------------------------------'.             00876806
008769     DISPLAY 'BATCH-STORE-COUNT  = ' STATS-BATCH-STORE-COUNT.     00876906
008770     DISPLAY 'MANUAL-STORE-COUNT = ' STATS-MANUAL-STORE-COUNT.    00877006
008771     DISPLAY 'AUTO-STORE-COUNT   = ' STATS-AUTO-STORE-COUNT.      00877106
008772     DISPLAY 'TOTAL-STORE-COUNT  = ' STATS-TOTAL-STORE-COUNT.     00877206
008773     DISPLAY '-------------------------------------'.             00877306
008774     DISPLAY 'BULK-PERCENT    = ' STATS-BULK-PERCENT.             00877406
008775     DISPLAY 'DC-PERCENT      = ' STATS-DC-PERCENT.               00877506
008776     DISPLAY 'STORE-PERCENT   = ' STATS-STORE-PERCENT.            00877606
008777     DISPLAY '-------------------------------------'.             00877706
008778     DISPLAY 'IMPORT-COUNT    = ' STATS-IMPORT-COUNT.             00877806
008779                                                                  00877906
008780     CLOSE POSTRR-FILE                                            00878006
008780           VENDOR-FILE                                            00878110
008781           STATS-FILE.                                            00878210
008782                                                                  00878310
008783 C100-CREATE-STATS-RECORD.                                        00878410
008784                                                                  00878510
008785     COMPUTE PV-BATCH-PERCENT =                                   00878610
008786         PV-BATCH-COUNT / PV-TOTAL-COUNT * 100.                   00878710
008787                                                                  00878810
008788     COMPUTE PV-MANUAL-PERCENT =                                  00878910
008789         PV-MANUAL-COUNT / PV-TOTAL-COUNT * 100.                  00879010
008790                                                                  00879110
008791     COMPUTE PV-AUTO-PERCENT =                                    00879210
008792         PV-AUTO-COUNT / PV-TOTAL-COUNT * 100.                    00879310
008793                                                                  00879410
008794     COMPUTE PV-BULK-PERCENT =                                    00879510
008795         PV-TOTAL-BULK-COUNT / PV-TOTAL-COUNT * 100.              00879610
008796                                                                  00879710
008797     COMPUTE PV-DC-PERCENT =                                      00879810
008798         PV-TOTAL-DC-COUNT / PV-TOTAL-COUNT * 100.                00879910
008799                                                                  00880010
008800     COMPUTE PV-STORE-PERCENT =                                   00880110
008801         PV-TOTAL-STORE-COUNT / PV-TOTAL-COUNT * 100.             00880210
008802                                                                  00880310
008803                                                                  00880410
008804     MOVE PV-BATCH-COUNT        TO STATS-BATCH-COUNT.             00880510
008805     MOVE PV-BATCH-BULK-COUNT   TO STATS-BATCH-BULK-COUNT.        00880610
008806     MOVE PV-BATCH-DC-COUNT     TO STATS-BATCH-DC-COUNT.          00880710
008807     MOVE PV-BATCH-STORE-COUNT  TO STATS-BATCH-STORE-COUNT.       00880810
008808     MOVE PV-MANUAL-COUNT       TO STATS-MANUAL-COUNT.            00880910
008809     MOVE PV-MANUAL-BULK-COUNT  TO STATS-MANUAL-BULK-COUNT.       00881010
008810     MOVE PV-MANUAL-DC-COUNT    TO STATS-MANUAL-DC-COUNT.         00881110
008811     MOVE PV-MANUAL-STORE-COUNT TO STATS-MANUAL-STORE-COUNT.      00881210
008812     MOVE PV-AUTO-COUNT         TO STATS-AUTO-COUNT.              00881310
008813     MOVE PV-AUTO-BULK-COUNT    TO STATS-AUTO-BULK-COUNT.         00881410
008814     MOVE PV-AUTO-DC-COUNT      TO STATS-AUTO-DC-COUNT.           00881510
008815     MOVE PV-AUTO-STORE-COUNT   TO STATS-AUTO-STORE-COUNT.        00881610
008816     MOVE PV-TOTAL-COUNT        TO STATS-TOTAL-COUNT.             00881710
008817     MOVE PV-TOTAL-BULK-COUNT   TO STATS-TOTAL-BULK-COUNT.        00881810
008818     MOVE PV-TOTAL-DC-COUNT     TO STATS-TOTAL-DC-COUNT.          00881910
008819     MOVE PV-TOTAL-STORE-COUNT  TO STATS-TOTAL-STORE-COUNT.       00882010
008820     MOVE PV-BATCH-PERCENT      TO STATS-BATCH-PERCENT.           00882110
008821     MOVE PV-MANUAL-PERCENT     TO STATS-MANUAL-PERCENT.          00882210
008822     MOVE PV-AUTO-PERCENT       TO STATS-AUTO-PERCENT.            00882310
008823     MOVE PV-BULK-PERCENT       TO STATS-BULK-PERCENT.            00882410
008824     MOVE PV-DC-PERCENT         TO STATS-DC-PERCENT.              00882510
008825     MOVE PV-STORE-PERCENT      TO STATS-STORE-PERCENT.           00882610
008826     MOVE PV-IMPORT-COUNT       TO STATS-IMPORT-COUNT.            00882710
008827                                                                  00882810
008828     PERFORM W100-WRITE-STATS-RECORD.                             00882910
008829                                                                  00883010
008830 R100-READ-INPUT.                                                 00883110
008831                                                                  00883210
008832     READ POSTRR-FILE INTO DCLTPOSTRR                             00883310
008840         AT END SET IN-EOF TO TRUE.                               00884006
008900                                                                  00885011
008920                                                                  00887011
136900*----------------------------------------------------------------*00893511
137000* RETRIEVES THE VENDOR NAME AND NUMBER                           *00893611
137100* NOTE: A NOT FOUND CONDITION IN THIS INSTANCE RESULTS IN THE    *00893711
137200*       VENDOR NAME AND NUMBER FIELDS BEING FILLED WITH DEFAULT  *00893811
137300*       VALUES.                                                  *00893911
137400*----------------------------------------------------------------*00894011
008910 T100-GET-VENDOR-DATA.                                            00894111
137600                                                                  00894311
137700     EXEC SQL                                                     00894411
137800         SELECT                                                   00894511
137900              EN.ENT_NAME_DESC                                    00894611
138100             ,EE.DUN_NBR                                          00894811
138300         INTO                                                     00895111
138400              :ENTNME-ENT-NAME-DESC                               00895211
138600             ,:EXTENT-DUN-NBR                                     00895411
138800         FROM TENTNME EN                                          00895711
138900             ,TEXTENT EE                                          00895811
139000             ,TPURCHS PU                                          00895911
139100         WHERE PU.PO_NBR         = :POSTRR-PO-NBR                 00896011
139200           AND PU.VER_STATUS_CDE = 'A'                            00896111
139300           AND EE.ENT_ID         = PU.ENT_ID                      00896211
139400           AND EN.ENT_ID         = PU.ENT_ID                      00896311
139500           AND EN.TYPE_CDE       = '01'                           00896411
139600     END-EXEC.                                                    00896511
139700                                                                  00896611
139800     EVALUATE TRUE                                                00896711
139900       WHEN SQLCODE = ZERO                                        00896811
140000         CONTINUE                                                 00897311
140200       WHEN SQLCODE = +100                                        00897411
140300         MOVE 'VENDOR PRIMARY NAME NOT FOUND'                     00897511
140400                                        TO ENTNME-ENT-NAME-DESC   00897612
140500         MOVE SPACES                    TO EXTENT-DUN-NBR         00897711
140900       WHEN SQLWARN0 NOT = SPACES                                 00898011
141000       WHEN SQLCODE  NOT = ZERO                                   00898111
141100         MOVE 'T100-GET-VENDOR-DATA'    TO AA-PARAGRAPH-NAME      00898212
141200         MOVE 'UNSUCCESSFUL SELECT'     TO AA-DB2-OPERATION       00898311
141300         MOVE 'TENTNME'                 TO AA-DB2-TABLE-1         00898411
141400         MOVE 'TEXTENT'                 TO AA-DB2-TABLE-2         00898511
141500         MOVE 'TPURCHS'                 TO AA-DB2-TABLE-3         00898611
141600         PERFORM Z998-DB2-ABEND                                   00898711
141700     END-EVALUATE.                                                00898811
026500                                                                  00899011
028800                                                                  00899111
008910 W100-WRITE-STATS-RECORD.                                         00899211
008920                                                                  00899311
008930     WRITE STATS-REC FROM STATS-RECORD.                           00899400
009000                                                                  00900000
009100                                                                  00910000
008910 W200-WRITE-VENDOR-RECORD.                                        00911011
008920                                                                  00912011
008920     INITIALIZE AP444-VENDOR-RECORD.                              00912111
000080     MOVE EXTENT-DUN-NBR           TO AP444-VENDOR-NBR.           00912211
000080     MOVE ENTNME-ENT-NAME-DESC     TO AP444-VENDOR-NAME.          00912311
000080     MOVE POSTRR-PO-NBR            TO AP444-PO-NBR.               00912417
000080     MOVE POSTRR-PAYT-RLSE-USR-ID  TO AP444-PAYT-RLSE-USR-ID.     00912517
000080     MOVE POSTRR-MTCH-LVL-CDE      TO AP444-MTCH-LVL-CDE.         00912617
000080     MOVE POSTRR-STATUS-CDE        TO AP444-STATUS-CDE.           00912717
000080     MOVE POSTRR-CRE-PRC-CDE       TO AP444-CRE-PRC-CDE.          00912817
000080     MOVE POSTRR-TOLR-ADJ-AMT      TO AP444-TOLR-ADJ-AMT.         00912917
008930     WRITE VENDOR-REC FROM AP444-VENDOR-RECORD.                   00913011
009000                                                                  00914011
009100                                                                  00915011
029700*----------------------------------------------------------------*00920011
029800*    ABEND ROUTINE FOR DB2 ERRORS                                *00930011
030000*----------------------------------------------------------------*00950011
030100 Z998-DB2-ABEND.                                                  00960011
030200                                                                  00970011
030300     DISPLAY 'PO BEING PROCESSED    = ' POSTRR-PO-NBR.            00980011
030400     DISPLAY AA-ABEND-LIT.                                        00990011
030500     DISPLAY AA-DB2-ERROR-LIT.                                    01000011
030600     DISPLAY AA-PROGRAM-LIT.                                      01010011
030700     DISPLAY AA-PARAGRAPH-LIT.                                    01020011
030800     DISPLAY AA-DB2-OPERATION-LIT.                                01030011
030900     DISPLAY AA-DB2-TABLE-1.                                      01040011
031000     SET AC-DB2-ERROR TO TRUE.                                    01050011
031100                                                                  01060011
031200     COPY DPPD004.                                                01070011
031300                                                                  01080011
031400     CALL 'ILBOABN0' USING ABEND-CODE.                            01090011
031500                                                                  01100011
