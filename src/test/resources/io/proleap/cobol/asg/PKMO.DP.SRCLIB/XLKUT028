000100 IDENTIFICATION DIVISION.                                         00010002
000200 PROGRAM-ID.    XLKUT028.                                         00020002
000300 AUTHOR.        RON KRIER.                                        00030002
000400 INSTALLATION.  KOHLS.                                            00040002
000500 DATE-WRITTEN   MARCH, 29, 2003.                                  00050002
000600 DATE-COMPILED.                                                   00060002
000700                                                                  00070002
000800* ************************************************************** *00080002
000900* * XLKUT028.  "PURCHASE ORDER DOMAIN INTEGRITY"               * *00090002
001000* *                                                            * *00100002
001100* * PURPOSE:                                                   * *00110002
001200* * THIS PROGRAM CREATES AN EXTRACT FILE FROM: TIMPORL.        * *00120002
001300* * THIS EXTRACT FILE CONSISTS OF ROWS ELIGIBLE TO BE TO PART  * *00130002
001400* * OF THE INTEGRITY PROCESS BETWEEN THE RMS PURCHASE ORDER    * *00140002
001500* * SYSTEM AND THE LOGISTICS DOMAIN PURCHASE ORDER TABLES.     * *00150002
001600* *                                                            * *00160002
001700* * PROCESSING OVERVIEW:                                       * *00170002
001800* *   THIS PROGRAM WILL READ THE INPUT DRIVER FILE AND THEN    * *00180002
001900* *   PERFORM A SELECT ON THE TIMPORL TABLE.  DATA RETRIEVED   * *00190002
002000* *   FROM THE SELECT WILL THEN BE WRITTEN TO THE OUTPUT FILE. * *00200002
002100**************************************************************** *00210002
002200 ENVIRONMENT DIVISION.                                            00220002
002300 CONFIGURATION SECTION.                                           00230002
002400 SOURCE-COMPUTER.        IBM-3090.                                00240002
002500 OBJECT-COMPUTER.        IBM-3090.                                00250002
002600                                                                  00260002
002700 INPUT-OUTPUT SECTION.                                            00270002
002800 FILE-CONTROL.                                                    00280002
002900                                                                  00290002
003000     SELECT IN-DRIVER-FILE                ASSIGN TO IN01.         00300002
003100     SELECT OUT-EXTRACT-FILE              ASSIGN TO OUT01.        00310002
003110     SELECT OUT-ERROR-FILE                ASSIGN TO OUT02.        00310002
003200                                                                  00320002
003300******************************************************************00330002
003400 DATA DIVISION.                                                   00340002
003500 FILE SECTION.                                                    00350002
003600                                                                  00360002
003700 FD  IN-DRIVER-FILE                                               00370002
003800     RECORDING MODE IS F                                          00380002
003900     LABEL RECORDS ARE STANDARD                                   00390002
004000     BLOCK CONTAINS 0 RECORDS.                                    00400002
004100 01  IN-DRIVER-RECORD                PIC  X(030).                 00410002
004200                                                                  00420002
004300**** TIMPORL:                                                     00430002
004400 FD  OUT-EXTRACT-FILE                                             00440002
004500     RECORDING MODE IS F                                          00450002
004600     LABEL RECORDS ARE STANDARD                                   00460002
004700     BLOCK CONTAINS 0 RECORDS.                                    00470002
004800 01  OUT-EXTRACT-RECORD              PIC  X(159).                 00480002
004900                                                                  00490002
004910 FD  OUT-ERROR-FILE                                               00440002
004920     RECORDING MODE IS F                                          00450002
004930     LABEL RECORDS ARE STANDARD                                   00460002
004940     BLOCK CONTAINS 0 RECORDS.                                    00470002
004950 01  OUT-ERROR-RECORD                PIC  X(200).                 00480002
004960                                                                  00490002
005000                                                                  00500002
005100                                                                  00510002
005200 WORKING-STORAGE SECTION.                                         00520002
005300                                                                  00530002
005400 01  PC-PROGRAM-CONSTANTS.                                        00540002
005500     05  PC-CURRENT-PROGRAM-NAME     PIC X(08) VALUE 'XLKUT028'.  00550002
005600     05  PC-PGM-PROGRESS-DESC.                                    00560002
005700         10  PC-BEGINNING            PIC X(09) VALUE 'BEGINNING'. 00570002
005800         10  PC-CONTINUING           PIC X(10) VALUE              00580002
005900                                               'CONTINUING'.      00590002
006000         10  PC-ENDING               PIC X(06) VALUE 'ENDING'.    00600002
006100         10  PC-ABENDING             PIC X(08) VALUE 'ABENDING'.  00610002
006200     05  PC-ABEND-INFO.                                           00620002
006300         10  PC-ABEND                PIC X(11) VALUE              00630002
006400                                               '** ABEND **'.     00640002
006500         10  PC-ABEND-MSG-PARA       PIC X(15) VALUE              00650002
006600                                               '- PARA       : '. 00660002
006700         10  PC-ABEND-MSG-DISPLAY-PARA                            00670002
006800                                     PIC X(15) VALUE              00680002
006900                                               '  CALLED PARA: '. 00690002
007000         10  PC-ABEND-MSG-NUMBER     PIC X(15) VALUE              00700002
007100                                               '  FOR ABEND# : '. 00710002
007200         10  PC-ABEND-MSG-DESC       PIC X(15) VALUE              00720002
007300                                               '- ERROR IS   : '. 00730002
007400         10  PC-ABEND-MSG-INDENT-15  PIC X(15) VALUE SPACES.      00740002
007500         10  PC-ABEND-MSG-ACTION     PIC X(15) VALUE              00750002
007600                                               '- ACTION     : '. 00760002
007700     05  PC-HOW-OFTEN-TO-DISPLAY     PIC 9(9)  VALUE 5000.        00770002
007800                                                                  00780002
007900 01  PS-PROGRAM-SWITCHES.                                         00790002
008000     05  PS-IN-DRIVER-EOF-SW         PIC X(01) VALUE 'N'.         00800002
008100         88  PS-IN-DRIVER-EOF                  VALUE 'Y'.         00810002
008200         88  PS-IN-DRIVER-NOT-EOF              VALUE 'N'.         00820002
008300     05  PS-TABLE-DATA-FOUND-SW      PIC X(01) VALUE 'N'.         00830002
008400         88  PS-TABLE-DATA-FOUND               VALUE 'Y'.         00840002
008500         88  PS-TABLE-DATA-NOT-FOUND           VALUE 'N'.         00850002
008600                                                                  00860002
008700 01  PV-PROGRAM-VARIABLES.                                        00870002
008800     05  PV-PO-NBR-COMP              PIC S9(9) VALUE 0 COMP.      00880002
008900     05  PV-PO-NBR-NUM               PIC  9(9) VALUE 0.           00890002
009000     05  PV-IN-DRIVER-RECS-READ-CNT  PIC  9(9) VALUE 0.           00900002
009100     05  PV-RECS-WITH-MATCHES-CNT    PIC  9(9) VALUE 0.           00910002
009200     05  PV-TABLE-ROW-SELECT-CNT     PIC  9(9) VALUE 0.           00920002
009300     05  PV-EXTRACT-WRITTEN-CNT      PIC  9(9) VALUE 0.           00930002
009310     05  PV-ERROR-WRITTEN-CNT        PIC  9(9) VALUE 0.           00930002
009400                                                                  00940002
009500     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      00950002
009600     05  PV-DB2-OPERATION-MSG-1      PIC X(79) VALUE SPACES.      00960002
009700     05  PV-DB2-TABLE-NAME           PIC X(18) VALUE SPACES.      00970002
009710     05  PV-ERROR-RECORD             PIC X(200) VALUE SPACES.     00970002
009800     05  PV-DISPLAY-NTH-MULTIPLE     PIC 9(9)  VALUE 0.           00980002
009900     05  PV-DISPLAY-NTH-REMAINDER    PIC 9(9)  VALUE 0.           00990002
010000     05  PV-SQLCODE                  PIC +999  VALUE ZERO.        01000002
010100                                                                  01010002
010200     05  PV-TMST                     PIC X(26) VALUE SPACES.      01020002
010300     05  PV-TIMESTAMP-DETAIL                                      01030002
010400         REDEFINES                                                01040002
010500         PV-TMST.                                                 01050002
010600         10  PV-TIMESTAMP-19.                                     01060002
010700             15  PV-TMS-DATE.                                     01070002
010800                 20  PV-TMS-YEAR.                                 01080002
010900                     25  PV-TMS-CC   PIC X(02).                   01090002
011000                     25  PV-TMS-YY   PIC X(02).                   01100002
011100                 20  FILLER          PIC X(01).                   01110002
011200                 20  PV-TMS-MONTH    PIC X(02).                   01120002
011300                 20  FILLER          PIC X(01).                   01130002
011400                 20  PV-TMS-DAY      PIC X(02).                   01140002
011500             15  FILLER              PIC X(01).                   01150002
011600             15  PV-TMS-HOUR         PIC X(02).                   01160002
011700             15  FILLER              PIC X(01).                   01170002
011800             15  PV-TMS-MINUTE       PIC X(02).                   01180002
011900             15  FILLER              PIC X(01).                   01190002
012000             15  PV-TMS-SECOND       PIC X(02).                   01200002
012100         10  FILLER                  PIC X(01).                   01210002
012200         10  PV-TMS-MSECOND          PIC X(06).                   01220002
012300                                                                  01230002
012400 01  DM-DISPLAY-MESSAGE.                                          01240002
012500     05  DM-01-10.                                                01250002
012600         10  DM-PROGRAM              PIC X(08) VALUE SPACE.       01260002
012700         10  FILLER                  PIC X(02) VALUE ': '.        01270002
012800     05  DM-11-80.                                                01280002
012900         10  FILLER                  PIC X(37) VALUE              01290002
013000                        'SELECT ROWS MATCHING PO DRIVER FILE, '.  01300002
013100         10  FILLER                  PIC X(30) VALUE              01310002
013200                        'CREATING TIMPORL EXTRACT FILE.'.         01320002
013300         10  FILLER                  PIC X(01) VALUE SPACE.       01330002
013400         10  FILLER                  PIC X(01) VALUE ALL '*'.     01340002
013500     05  DM-81-120.                                               01350002
013600         10  FILLER                  PIC X(40) VALUE ALL '*'.     01360002
013700                                                                  01370002
013800 01  DP-DISPLAY-PROGRESS-MSG.                                     01380002
013900     05  DP-PROGRAM                  PIC X(08) VALUE SPACE.       01390002
014000     05  FILLER                      PIC X(02) VALUE SPACE.       01400002
014100     05  DP-STATUS-DESCRIPTION       PIC X(10) VALUE SPACE.       01410002
014200     05  FILLER                      PIC X(04) VALUE ' AT '.      01420002
014300     05  DP-TIMESTAMP-19             PIC X(19) VALUE SPACE.       01430002
014400     05  FILLER                      PIC X(03) VALUE '.  '.       01440002
014500     05  FILLER                      PIC X(03) VALUE              01450002
014600                                         'IN:'.                   01460002
014700     05  DP-IN-CNT                   PIC ZZZ,ZZZ,ZZ9              01470002
014800                                               VALUE ZERO.        01480002
014900     05  FILLER                      PIC X(02) VALUE ', '.        01490002
015000*    05  FILLER                      PIC X(16) VALUE              01500002
015100*                                        'DRIVER W/ROW(S):'.      01510002
015200*    05  DP-MATCHES-FOUND-CNT        PIC ZZZ,ZZZ,ZZ9              01520002
015300*                                              VALUE ZERO.        01530002
015400*    05  FILLER                      PIC X(02) VALUE ', '.        01540002
015500     05  FILLER                      PIC X(14) VALUE              01550002
015600                                         'ROWS SELECTED:'.        01560002
015700     05  DP-ROWS-SELECTED-CNT        PIC ZZZ,ZZZ,ZZ9              01570002
015800                                               VALUE ZERO.        01580002
015900     05  FILLER                      PIC X(02) VALUE ', '.        01590002
016000     05  FILLER                      PIC X(04) VALUE              01600002
016100                                         'OUT:'.                  01610002
016200     05  DP-OUT-CNT                  PIC ZZZ,ZZZ,ZZ9              01620002
016300                                               VALUE ZERO.        01630002
016400     05  FILLER                      PIC X(01) VALUE '.'.         01640002
016500                                                                  01650002
016600 01  ABEND-CODE                      PIC S9(04)                   01660002
016700                                               VALUE ZEROES       01670002
016800                                               COMP SYNC.         01680002
016900                                                                  01690002
017000*---------------------------------------------------------------* 01700002
017100*  DB2 FORMATTED MESSAGE AREA                                     01710002
017200*---------------------------------------------------------------* 01720002
017300     COPY DPWS004.                                                01730002
017400                                                                  01740002
017500                                                                  01750002
017600*---------------------------------------------------------------* 01760002
017700*  XLRD013 - RECORD LAYOUT FOR PO DRIVER FILE, INPUT.             01770002
017800*---------------------------------------------------------------* 01780002
017900     COPY XLRD013.                                                01790002
018000                                                                  01800002
018100                                                                  01810002
018200*---------------------------------------------------------------* 01820002
018300*    DB2 AREA FOR TIMPORL                                       * 01830002
018400*---------------------------------------------------------------* 01840002
018500     EXEC SQL                                                     01850002
018600          INCLUDE TIMPORL                                         01860002
018700     END-EXEC.                                                    01870002
018800                                                                  01880002
018900*---------------------------------------------------------------* 01890002
019000*    DB2 AREA FOR COMMUNICATIONS                                * 01900002
019100*---------------------------------------------------------------* 01910002
019200     EXEC SQL                                                     01920002
019300          INCLUDE SQLCA                                           01930002
019400     END-EXEC.                                                    01940002
019500                                                                  01950002
019600                                                                  01960002
019700 PROCEDURE DIVISION.                                              01970002
019800********************                                              01980002
019900                                                                  01990002
020000 0000-PROGRAM-MAINLINE.                                           02000002
020100                                                                  02010002
020200     PERFORM 1000-INITIALIZE.                                     02020002
020300                                                                  02030002
020400     SET PS-IN-DRIVER-NOT-EOF TO TRUE.                            02040002
020500     PERFORM 2000-PROCESS-DRIVER-FILE                             02050002
020600         UNTIL PS-IN-DRIVER-EOF.                                  02060002
020700                                                                  02070002
020800     PERFORM 6000-EOJ-ROUTINE.                                    02080002
020900     STOP RUN.                                                    02090002
021000                                                                  02100002
021100                                                                  02110002
021200* ************************************************************** *02120002
021300* * INITIALIZATIONS                                            * *02130002
021400* ************************************************************** *02140002
021500                                                                  02150002
021600 1000-INITIALIZE.                                                 02160002
021700                                                                  02170002
021800     MOVE PC-CURRENT-PROGRAM-NAME TO DM-PROGRAM.                  02180002
021900     DISPLAY DM-DISPLAY-MESSAGE.                                  02190002
022000                                                                  02200002
022100     MOVE PC-BEGINNING              TO DP-STATUS-DESCRIPTION.     02210002
022200     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02220002
022300                                                                  02230002
022400     PERFORM 9000-OPEN-IN-DRIVER-FILE.                            02240002
022500     PERFORM 9700-OPEN-OUT-EXTRACT-FILE.                          02250002
022510     PERFORM 9800-OPEN-OUT-ERROR-FILE.                            02250002
022600                                                                  02260002
022700                                                                  02270002
022800* ************************************************************** *02280002
022900* * READ DRIVER FILE                                           * *02290002
023000* * SELECT DATA FROM TIMPORL BASED ON PO NUMBER FROM DRIVER    * *02300002
023100* * FILE                                                       * *02310002
023200* * WRITE DATA FROM TIMPORL TO THE OUTPUT FILE                 * *02320002
023300* *        ROWS FOR THIS INPUT DRIVER RECORD                   * *02330002
023400* ************************************************************** *02340002
023500                                                                  02350002
023600 2000-PROCESS-DRIVER-FILE.                                        02360002
023700                                                                  02370002
023800     PERFORM 9050-READ-IN-DRIVER-FILE.                            02380002
023900                                                                  02390002
024000     IF  PS-IN-DRIVER-EOF                                         02400002
024100         CONTINUE                                                 02410002
024200     ELSE                                                         02420002
024300         MOVE XL013-PO-NBR TO         PV-PO-NBR-COMP              02430002
024400                                      PV-PO-NBR-NUM               02440002
024500         PERFORM 2100-CHECK-PGM-PROGRESS                          02450002
024600         INITIALIZE DCLTIMPORL                                    02460002
024700         SET PS-TABLE-DATA-NOT-FOUND TO TRUE                      02470002
024800         PERFORM 9100-SELECT-TABLE                                02480002
024900         IF  PS-TABLE-DATA-NOT-FOUND                              02490002
025000             CONTINUE                                             02500002
025100         ELSE                                                     02510002
025200             PERFORM 9750-WRITE-EXTRACT-RECORD                    02520002
025300         END-IF                                                   02530002
025400     END-IF.                                                      02540002
025500                                                                  02550002
025600                                                                  02560002
025700* ************************************************************** *02570002
025800* *    EVERY NTH RECORD (IE: INITIAL SETTING 1000), REPORT     * *02580002
025900* *    RECORD COUNT AND CURRENT DATE/TIME.  THIS WILL ASSIST   * *02590002
026000* *    WITH RUN-TIME ESTIMATE OF TIME REMAINING TO COMPLETE.   * *02600002
026100* ************************************************************** *02610002
026200                                                                  02620002
026300 2100-CHECK-PGM-PROGRESS.                                         02630002
026400     DIVIDE    PV-IN-DRIVER-RECS-READ-CNT                         02640002
026500         BY        PC-HOW-OFTEN-TO-DISPLAY                        02650002
026600         GIVING    PV-DISPLAY-NTH-MULTIPLE                        02660002
026700         REMAINDER PV-DISPLAY-NTH-REMAINDER.                      02670002
026800                                                                  02680002
026900     IF PV-DISPLAY-NTH-REMAINDER = ZERO                           02690002
027000         MOVE PC-CONTINUING         TO DP-STATUS-DESCRIPTION      02700002
027100         PERFORM 6200-DISPLAY-PGM-PROGRESS                        02710002
027200     END-IF.                                                      02720002
027300                                                                  02730002
027400                                                                  02740002
027500* ************************************************************** *02750002
027600* * DISPLAY END OF RUN MESSAGE, CLOSE THE OUTPUT FILES         * *02760002
027700* ************************************************************** *02770002
027800                                                                  02780002
027900 6000-EOJ-ROUTINE.                                                02790002
028000                                                                  02800002
028100     PERFORM 9090-CLOSE-IN-DRIVER-FILE.                           02810002
028200     PERFORM 9790-CLOSE-OUT-EXTRACT-FILE.                         02820002
028210     PERFORM 9890-CLOSE-OUT-ERROR-FILE.                           02820002
028300                                                                  02830002
028400     MOVE PC-ENDING                 TO DP-STATUS-DESCRIPTION.     02840002
028500     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02850002
028600                                                                  02860002
028700                                                                  02870002
028800* ************************************************************** *02880002
028900* * DISPLAY PROGRAM PROGRESS.                                  * *02890002
029000* ************************************************************** *02900002
029100                                                                  02910002
029200 6200-DISPLAY-PGM-PROGRESS.                                       02920002
029300                                                                  02930002
029400     EXEC SQL                                                     02940002
029500          SET :PV-TMST = CURRENT TIMESTAMP                        02950002
029600     END-EXEC.                                                    02960002
029700                                                                  02970002
029800     MOVE PC-CURRENT-PROGRAM-NAME   TO DP-PROGRAM.                02980002
029900     MOVE PV-TIMESTAMP-19           TO DP-TIMESTAMP-19.           02990002
030000     MOVE PV-IN-DRIVER-RECS-READ-CNT                              03000002
030100                                    TO DP-IN-CNT.                 03010002
030200*    MOVE PV-RECS-WITH-MATCHES-CNT  TO DP-MATCHES-FOUND-CNT.      03020002
030300     MOVE PV-TABLE-ROW-SELECT-CNT   TO DP-ROWS-SELECTED-CNT.      03030002
030400     MOVE PV-EXTRACT-WRITTEN-CNT    TO DP-OUT-CNT.                03040002
030500                                                                  03050002
030600     DISPLAY DP-DISPLAY-PROGRESS-MSG.                             03060002
030700                                                                  03070002
030800                                                                  03080002
030900* ************************************************************** *03090002
031000* * OPEN  INPUT DRIVER FILE                                    * *03100002
031100* ************************************************************** *03110002
031200                                                                  03120002
031300 9000-OPEN-IN-DRIVER-FILE.                                        03130002
031400                                                                  03140002
031500     OPEN  INPUT  IN-DRIVER-FILE.                                 03150002
031600                                                                  03160002
031700                                                                  03170002
031800* ************************************************************** *03180002
031900* * READ  INPUT DRIVER FILE OF ELIGIBLE DATA TO EXTRACT        * *03190002
032000* ************************************************************** *03200002
032100                                                                  03210002
032200 9050-READ-IN-DRIVER-FILE.                                        03220002
032300                                                                  03230002
032400     READ IN-DRIVER-FILE                                          03240002
032500          INTO XL013-DRIVER-RECORD-LAYOUT                         03250002
032600          AT END                                                  03260002
032700              SET PS-IN-DRIVER-EOF TO TRUE.                       03270002
032800                                                                  03280002
032900     IF PS-IN-DRIVER-EOF                                          03290002
033000         CONTINUE                                                 03300002
033100     ELSE                                                         03310002
033200         ADD +1 TO PV-IN-DRIVER-RECS-READ-CNT                     03320002
033300     END-IF.                                                      03330002
033400                                                                  03340002
033500                                                                  03350002
033600* ************************************************************** *03360002
033700* * CLOSE INPUT DRIVER FILE                                    * *03370002
033800* ************************************************************** *03380002
033900                                                                  03390002
034000 9090-CLOSE-IN-DRIVER-FILE.                                       03400002
034100                                                                  03410002
034200     CLOSE IN-DRIVER-FILE.                                        03420002
034300                                                                  03430002
034400                                                                  03440002
034500* ************************************************************** *03450002
034600* * OPEN  TABLE CURSOR                                         * *03460002
034700* ************************************************************** *03470002
034800                                                                  03480002
034900 9100-SELECT-TABLE.                                               03490002
035000                                                                  03500002
035100     EXEC SQL                                                     03510002
035200           SELECT PO_NBR                                          03520002
035300                 ,VER_NBR                                         03530002
035400                 ,VER_STATUS_CDE                                  03540002
035500                 ,CONSLR_RLSE_CDE                                 03550002
035600                 ,CONSLR_REQR_DTE                                 03560002
035700                 ,CONSLR_ACTL_DTE                                 03570002
035800                 ,CONSLR_ACTL_TM                                  03580002
035900                 ,CSTM_BKR_RLSE_CDE                               03590002
036000                 ,CSTM_BKR_REQR_DTE                               03600002
036100                 ,CSTM_BKR_ACTL_DTE                               03610002
036200                 ,CSTM_BKR_ACTL_TM                                03620002
036300                 ,TKT_PRTR_RLSE_CDE                               03630002
036400                 ,TKT_PRTR_REQR_DTE                               03640002
036500                 ,TKT_PRTR_ACTL_DTE                               03650002
036600                 ,TKT_PRTR_ACTL_TM                                03660002
036700                 ,DCONSLR_RLSE_CDE                                03670002
036800                 ,DCONSLR_REQR_DTE                                03680002
036900                 ,DCONSLR_ACTL_DTE                                03690002
037000                 ,DCONSLR_ACTL_TM                                 03700002
037100                 ,LAST_UPD_TMST                                   03710002
037200                 ,LAST_UPD_BY_UID                                 03720002
040600          INTO  :IMPORL-PO-NBR                                    04060002
040700               ,:IMPORL-VER-NBR                                   04070002
040800               ,:IMPORL-VER-STATUS-CDE                            04080002
040900               ,:IMPORL-CONSLR-RLSE-CDE                           04090002
041000               ,:IMPORL-CONSLR-REQR-DTE                           04100002
041100               ,:IMPORL-CONSLR-ACTL-DTE                           04110002
041200               ,:IMPORL-CONSLR-ACTL-TM                            04120002
041300               ,:IMPORL-CSTM-BKR-RLSE-CDE                         04130002
041400               ,:IMPORL-CSTM-BKR-REQR-DTE                         04140002
041500               ,:IMPORL-CSTM-BKR-ACTL-DTE                         04150002
041600               ,:IMPORL-CSTM-BKR-ACTL-TM                          04160002
041700               ,:IMPORL-TKT-PRTR-RLSE-CDE                         04170002
041800               ,:IMPORL-TKT-PRTR-REQR-DTE                         04180002
041900               ,:IMPORL-TKT-PRTR-ACTL-DTE                         04190002
042000               ,:IMPORL-TKT-PRTR-ACTL-TM                          04200002
042100               ,:IMPORL-DCONSLR-RLSE-CDE                          04210002
042200               ,:IMPORL-DCONSLR-REQR-DTE                          04220002
042300               ,:IMPORL-DCONSLR-ACTL-DTE                          04230002
042400               ,:IMPORL-DCONSLR-ACTL-TM                           04240002
042500               ,:IMPORL-LAST-UPD-TMST                             04250002
042600               ,:IMPORL-LAST-UPD-BY-UID                           04260002
046000           FROM   TIMPORL                                         04600002
046100          WHERE  PO_NBR = :PV-PO-NBR-COMP                         04610002
046200            AND  VER_STATUS_CDE = 'A'                             04620002
046300           WITH  UR                                               04630002
046400     END-EXEC.                                                    04640002
046500                                                                  04650002
046600     EVALUATE TRUE                                                04660002
046700         WHEN SQLCODE = ZERO                                      04670002
046800              ADD +1                  TO PV-TABLE-ROW-SELECT-CNT  04680002
046900              SET PS-TABLE-DATA-FOUND TO TRUE                     04690002
047000         WHEN SQLCODE = +100                                      04700002
047100              CONTINUE                                            04710002
047200         WHEN SQLWARN0 NOT EQUAL SPACE                            04720002
047300         WHEN SQLCODE NOT EQUAL ZERO                              04730002
047400              MOVE '9100-SELECT-TABLE'                            04740002
047500                                 TO PV-PARAGRAPH-NAME             04750002
047600              MOVE 'SELECT DATA'                                  04760002
047700                                 TO PV-DB2-OPERATION-MSG-1        04770002
047800              MOVE 'TIMPORL'     TO PV-DB2-TABLE-NAME             04780002
047900              PERFORM 9999-DB2-ABEND                              04790002
048000     END-EVALUATE.                                                04800002
048100                                                                  04810002
048200                                                                  04820002
048300                                                                  04830002
048400* ************************************************************** *04840002
048500* * OPEN OUTPUT EXTRACT FILE                                   * *04850002
048600* ************************************************************** *04860002
048700                                                                  04870002
048800 9700-OPEN-OUT-EXTRACT-FILE.                                      04880002
048900                                                                  04890002
049000     OPEN OUTPUT OUT-EXTRACT-FILE.                                04900002
049100                                                                  04910002
049200                                                                  04920002
049300* ************************************************************** *04930002
049400* * WRITE A RECORD TO THE TABLE EXTRACT FILE                   * *04940002
049500* ************************************************************** *04950002
049600                                                                  04960002
049700 9750-WRITE-EXTRACT-RECORD.                                       04970002
049800                                                                  04980002
049900     WRITE  OUT-EXTRACT-RECORD  FROM  DCLTIMPORL.                 04990002
050000     ADD +1 TO PV-EXTRACT-WRITTEN-CNT.                            05000002
050100                                                                  05010002
050200                                                                  05020002
050300* ************************************************************** *05030002
050400* * CLOSE OUTPUT EXTRACT FILE                                  * *05040002
050500* ************************************************************** *05050002
050600                                                                  05060002
050700 9790-CLOSE-OUT-EXTRACT-FILE.                                     05070002
050800                                                                  05080002
050900     CLOSE OUT-EXTRACT-FILE.                                      05090002
050910                                                                  04830002
050920* ************************************************************** *04840002
050930* * OPEN OUTPUT ERROR FILE                                     * *04850002
050940* ************************************************************** *04860002
050950                                                                  04870002
050960 9800-OPEN-OUT-ERROR-FILE.                                        04880002
050970                                                                  04890002
050980     OPEN OUTPUT OUT-ERROR-FILE.                                  04900002
050990                                                                  04910002
050991                                                                  04920002
050992* ************************************************************** *04930002
050993* * WRITE A RECORD TO THE TABLE ERROR FILE                     * *04940002
050994* ************************************************************** *04950002
050995                                                                  04960002
050996 9850-WRITE-ERROR-RECORD.                                         04970002
050997                                                                  04980002
050998     WRITE  OUT-ERROR-RECORD    FROM  PV-ERROR-RECORD.            04990002
050999     ADD +1 TO PV-ERROR-WRITTEN-CNT.                              05000002
051000                                                                  05010002
051001                                                                  05020002
051002* ************************************************************** *05030002
051003* * CLOSE OUTPUT ERROR FILE                                    * *05040002
051004* ************************************************************** *05050002
051005                                                                  05060002
051006 9890-CLOSE-OUT-ERROR-FILE.                                       05070002
051007                                                                  05080002
051008     CLOSE OUT-ERROR-FILE.                                        05090002
051010                                                                  05100002
051100                                                                  05110002
051200* ************************************************************** *05120002
051300* * DISPLAY INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT *05130002
051400* * AND CALL THE ABEND PROCESSOR IN THE EVENT THAT AN          * *05140002
051500* * SQL ERROR OR WARNING CODE OCCURS.                          * *05150002
051600* ************************************************************** *05160002
051700                                                                  05170002
051800 9999-DB2-ABEND.                                                  05180002
053903                                                                  05190002
053904     MOVE SQLCODE TO PV-SQLCODE.                                        02
053906     STRING  'PROGRAM - '    PC-CURRENT-PROGRAM-NAME                    02
053911             ' PARAGRAPH - ' PV-PARAGRAPH-NAME                          02
053913             ' TABLE - '     PV-DB2-TABLE-NAME                          02
053915             ' OPERATION - ' PV-DB2-OPERATION-MSG-1 (1:30)              02
053917             ' SQLCODE --- ' PV-SQLCODE                                 02
053926             ' PO NBR ---- ' PV-PO-NBR-NUM                              04
053927             DELIMITED BY SIZE                                            
053928             INTO PV-ERROR-RECORD.                                        
053929                                                                        03
053930     PERFORM 9850-WRITE-ERROR-RECORD.                                     
054000                                                                        02
