000100******************************************************************00010008
000200 IDENTIFICATION DIVISION.                                         00020008
000300 PROGRAM-ID.             SUKRF537.                                00030008
000400 AUTHOR.                 GERMAN BANDA.                            00040008
000500 INSTALLATION.           KOHLS.                                   00050008
000600 DATE-WRITTEN.           DECEMBER 2001.                           00060008
000700 DATE-COMPILED.                                                   00070008
000800                                                                  00080008
000900******************************************************************00090008
001000* THIS PROGRAM WILL ALLOW THE USER TO ENTER A UPC TOTAL QUANTITY  00100008
001100* FOR BULK OR CASEPACK  TYPE CARTONS. THE PROGRAM WILL UPDATE     00110008
001200* THE TSUAUPC TABLE WITH THE TOTAL QUANTITY SCANNED.              00120008
001400******************************************************************00130008
      * 10/16/13 DW BEG                                                 00140008
      * 10/16/2013 DAVE WELLER CHG0068598 TKID: TKMA602                 00150067
      *            CHANGE TO MAKE MESSAGE FIELD CONTENTS VARIABLE.      00160008
      * 10/16/13 DW END                                                 00170008
001400******************************************************************00180008
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00182073
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00183073
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00184073
001400******************************************************************00186073
001500 ENVIRONMENT DIVISION.                                            00190008
001600 DATA DIVISION.                                                   00200008
001700******************************************************************00210008
001800*RLK 4/1/14 CHANGE TO SET SU006-WRONG-RFID-CTR SO IT IS NOT       00220069
001800*RLK 4/1/14 GREATER THAT SCANNED QTY. THIS IS DONE IN VARIOUS     00220172
001800*RLK 4/1/14 PLACES IN PF2 AND 3 LOGIC IN MAINLINE AND ALSO IN     00220272
001800*RLK 4/1/14 PARA 2300-UPDATE-RFID-TAG-SCAN-QTY.                   00220372
001800                                                                  00221069
001900******************************************************************00230008
002000 WORKING-STORAGE SECTION.                                         00240008
002100******************************************************************00250008
002200 01  CA-COMMAREA.                                                 00260008
002300     COPY SUWS006.                                                00270008
      * 10/16/13 DW BEG                                                 00280067
003000* * * * * * * * * * * *  PLEASE NOTE * * * * * * * * * * * *      00290053
003100* THE COMMAREA FROM HERE....                                      00300053
003200    05 CA-SUKRF513-COMMAREA.                                      00310053
003300       10 FILLER                         PIC  X(35).              00320053
003400       10 CA-SYSTEM-RETAIL-X             PIC  X(08).              00330053
003500       10 CA-SYSTEM-RETAIL     REDEFINES CA-SYSTEM-RETAIL-X       00340053
003600                                         PIC  ZZZZ9.99.           00350053
003700                                                                  00360053
003800       10 CA-SYSTEM-SKU-DESC             PIC  X(19).              00370053
003900       10 CA-SYSTEM-COLOR                PIC  X(10).              00380053
004000       10 CA-SYSTEM-SIZE                 PIC  X(10).              00390053
004100       10 CA-SYSTEM-STYLE                PIC  X(19).              00400053
004200* ... TO HERE IS COPIED FROM SUKRF513, AND IS THEN SENT ALONG TO  00410053
004300* SUKRF522 AND SUKRF524                                           00420053
004400*     -- ANY CHANGES TO THIS AREA IN ANY OF THE PROGRAMS MUST     00430053
004500*         BE COPIED TO ALL THREE                                  00440053
004600    05 CA-PROGRAM-COMMAREA.                                       00450053
004700       10 CA-SCREEN-FIELDS.                                       00460053
005400          15 CA-SCRN-COLOR               PIC  X(10).              00470053
005500          15 CA-SCRN-SIZE                PIC  X(10).              00480053
005600          15 CA-SCRN-SKU-X.                                       00490053
005700             20 CA-SCRN-DEPT-X           PIC  X(03).              00500053
005800             20 FILLER                   PIC  X(01)  VALUE '-'.   00510053
005900             20 CA-SCRN-MAJ-CLS-X        PIC  X(02).              00520053
006000             20 FILLER                   PIC  X(01)  VALUE '-'.   00530053
006100             20 CA-SCRN-SUB-CLS-X        PIC  X(02).              00540053
006200          15 CA-SCRN-SKU        REDEFINES CA-SCRN-SKU-X.          00550053
006300             20 CA-SCRN-DEPT             PIC  9(03).              00560053
006400             20 FILLER                   PIC  X(01).              00570053
006500             20 CA-SCRN-MAJ-CLASS        PIC  9(02).              00580053
006600             20 FILLER                   PIC  X(01).              00590053
006700             20 CA-SCRN-SUB-CLASS        PIC  9(02).              00600053
006800          15 CA-SCRN-STYLE               PIC  X(12).              00610053
006800          15 CA-SCRN-LOGO                PIC  X(01).              00620053
002400    05  CA-PROGRAM-COMMAREA-1.                                    00630053
002500         10  CA-UPC-KEYED-QTY-X          PIC  X(03)  VALUE SPACE. 00640068
002600         10  CA-UPC-KEYED-QTY REDEFINES                           00650008
002700             CA-UPC-KEYED-QTY-X          PIC  9(03).              00660068
002500         10  CA-UPC-KEYED-SCND-QTY-X     PIC  X(03)  VALUE SPACE. 00670068
002600         10  CA-UPC-KEYED-SCND-QTY REDEFINES                      00680009
002700             CA-UPC-KEYED-SCND-QTY-X     PIC  9(03).              00690068
002800         10  CA-CNFRM-KEYED-QTY-SW       PIC  X(01)  VALUE 'N'.   00700008
002900             88  CA-CNFRM-KEYED-QTY                  VALUE 'Y'.   00710008
003000             88  CA-NO-CNFRM-KEYED-QTY               VALUE 'N'.   00720008
      * 10/16/13 DW END                                                 00730067
003100*                                                                 00740008
003200 01  DK-DB2-KEYS.                                                 00750008
003300     05  DK-UPC-QTY                      PIC S9(09) COMP.         00760008
003300     05  DK-UPC-SCND-QTY                 PIC S9(09) COMP.         00770009
003400     05  DK-SHIP-UNIT-NBR                PIC S9(18) COMP-3.       00780008
003500*                                                                 00790008
003600 01  PC-PROGRAM-CONSTANTS.                                        00800008
003700     05  PC-N                            PIC  X(01)  VALUE 'N'.   00810008
003800     05  PC-PO                           PIC  X(02)  VALUE 'PO'.  00820008
003900     05  PC-RCV                          PIC  X(03)  VALUE 'RCV'. 00830008
004000     05  PC-0                            PIC  X(01)  VALUE '0'.   00840008
004100     05  PC-4                            PIC  X(01)  VALUE '4'.   00850008
004200     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00860008
004300     05  PC-0-9                          PIC  9(01)  VALUE 0.     00870008
004400     05  PC-ACTIVE                       PIC  X(01)  VALUE 'A'.   00880008
004500     05  PC-18                           PIC S9(04)  VALUE 18     00890008
004600                                                     COMP SYNC.   00900008
004700     05  PC-19                           PIC S9(04)  VALUE 19     00910008
004800                                                     COMP SYNC.   00920008
004900     05  PC-01                           PIC  X(02)  VALUE '01'.  00930008
005000     05  PC-PF-MATCH-PF-KEY-MSG          PIC  X(19)  VALUE        00940008
005100         'F2-MTCH  F9-NO MTCH'.                                   00950008
005200     05  PC-UPC-QTY-WARNING              PIC  X(18)  VALUE        00960008
005300         'QTY MUST BE GRTR 0'.                                    00970008
005400     05  PC-UPC-CONFIRM-QTY              PIC  X(18)  VALUE        00980008
005500         'F2 TO CONFIRM     '.                                    00990008
005600     05  PC-EXCEED-MAX-QTY.                                       01000008
005700         10  FILLER        PIC X(12) VALUE  'CANT EXCEED '.       01010008
005800         10  PC-MAX-QTY    PIC Z(05) VALUE  ZEROES.               01020008
005900     05  PC-INVALID-PO                   PIC  X(18)  VALUE        01030008
006000         'INVALID PO        '.                                    01040008
006100     05  PC-RETURN-PGM                   PIC  X(08)  VALUE        01050008
006200         'SUKRF509'.                                              01060008
006300     05  PC-PRTR-VALIDATION-PGM          PIC  X(08)  VALUE        01070008
006400         'DPKCS060'.                                              01080008
006500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01090008
006600         'SUKRF537'.                                              01100008
006700     05  PC-CARTON-CONTINUE-PGM          PIC  X(08)  VALUE        01110008
006800         'SUKRF512'.                                              01120008
006900     05  PC-AUDIT-CONT-PROGRAM           PIC  X(08)  VALUE        01130008
007000         'SUKRF520'.                                              01140008
007100     05  PC-AUDIT-CLOSE-PROGRAM          PIC  X(08)  VALUE        01150008
007200         'SUKRF516'.                                              01160008
007300     05  PC-SCAN-UPC-PROGRAM             PIC  X(08)  VALUE        01170008
007400         'SUKRF518'.                                              01180008
007500     05  PC-MESSAGE-PROGRAM              PIC  X(08)  VALUE        01190008
007600         'SUKRF514'.                                              01200008
      * 10/16/13 DW BEG                                                 01210008
007500     05  PC-LABEL-CHECK-PROGRAM          PIC  X(08)  VALUE        01220008
007600         'SUKRF513'.                                              01230008
007500     05  PC-VISUAL-TICK-INFO-PROGRAM     PIC  X(08)  VALUE        01240008
007600         'SUKRF517'.                                              01250008
007500     05  PC-VISUAL-TICK-EXCP-PROGRAM     PIC  X(08)  VALUE        01260020
007600         'SUKRF524'.                                              01270020
007500     05  PC-VISUAL-MDSE-INFO-PROGRAM     PIC  X(08)  VALUE        01280008
007600         'SUKRF522'.                                              01290008
           05  PC-SCAN-RFID-ERR-CHK-PROGRAM    PIC  X(08)  VALUE        01300008
               'SUKRF710'.                                              01310008
           05  PC-SCAN-RFID-ERR-PRC-PROGRAM    PIC  X(08)  VALUE        01320025
               'SUKRF711'.                                              01330025
008000     05  PC-CARTON-AUDIT-GROUP-CODE      PIC  X(03)  VALUE 'VA'.  01340026
008000     05  PC-TKT-ERR-MSNG-EPC-VILN-SEQ    PIC  9(02)  VALUE 42.    01350026
      * 10/16/13 DW END                                                 01360008
007700     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'S537'.01370008
007800     05  PC-ENTER-THROUGH-MENU-MSG       PIC  X(19)  VALUE        01380008
007900         'ENTER THROUGH MENU '.                                   01390008
008000     05  PC-ENTER-CARTON-MSG             PIC  X(19)  VALUE        01400008
008100         'ENTER CARTON #     '.                                   01410008
008200     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01420008
008300         'TRANS NOT AVAILABLE'.                                   01430008
008400     05  PC-MUST-BE-NUM-MSG              PIC  X(19)  VALUE        01440008
008500         'MUST BE NUMERIC    '.                                   01450008
008600     05  PC-MUST-BE-GT-0-MSG             PIC  X(19)  VALUE        01460008
008700         'MUST BE > ZERO     '.                                   01470008
008800     05  PC-CICS-ERR-MSG                 PIC  X(19)  VALUE        01480008
008900         'CICS ACCESS ERROR  '.                                   01490008
009000     05  PC-UPC-NOT-NUMERIC               PIC  X(19)  VALUE       01500008
009100         'UPC QTY NOT NUMERIC'.                                   01510008
      * 10/16/13 DW BEG                                                 01520067
009000     05  PC-UPC-RFID-NOT-NUMERIC          PIC  X(19)  VALUE       01530011
009100         'UPC RF QTY NOT NUM '.                                   01540012
009000     05  PC-WRG-RF-GT-UPC-QTY             PIC  X(19)  VALUE       01550034
009100         'WRG RF QT > TOT UPC'.                                   01560034
009000     05  PC-UPC-GT-ZERO                   PIC  X(19)  VALUE       01570054
009100         'UPC QTY MUST BE > 0'.                                   01580054
009000     05  PC-TOT-UPC-MSG                   PIC  X(19)  VALUE       01590023
009100         'ENTER TOTAL UPC '.                                      01600023
009000     05  PC-UPC-QTY-MSG                   PIC  X(19)  VALUE       01610023
009100         'QTY             '.                                      01620023
009000     05  PC-RF-ONLY-PFKEYS                PIC  X(19)  VALUE       01630027
009100         'F9-FAIL RFID AUD'.                                      01640027
009000     05  PC-RF-ONLY-MSG1                  PIC  X(19)  VALUE       01650027
009100         'ENTER # EPC TAGS'.                                      01660027
009000     05  PC-RF-ONLY-MSG2                  PIC  X(19)  VALUE       01670024
009100         'WRNG/MISSING    '.                                      01680025
009000     05  PC-RF-ONLY-MSG3                  PIC  X(19)  VALUE       01690024
009100         'ENTER TOTAL UPC '.                                      01700010
009000     05  PC-RF-ONLY-MSG4                  PIC  X(19)  VALUE       01710024
009100         'IN CARTON       '.                                      01720023
      * 10/16/13 DW END                                                 01730067
009200                                                                  01740008
009300                                                                  01750008
009400 01  PS-PROGRAM-SWITCHES.                                         01760008
009500     05  PS-CHECK-DIGIT-IND              PIC  X(01)  VALUE 'N'.   01770008
009600         88  PS-VALID-CHECK-DIGIT                    VALUE 'Y'.   01780008
009700         88  PS-INVALID-CHECK-DIGIT                  VALUE 'N'.   01790008
009800     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01800008
009900         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01810008
010000         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01820008
010100     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   01830008
010200         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   01840008
010300         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   01850008
010400                                                                  01860008
010500 01  PV-PROGRAM-VARIABLES.                                        01870008
010600     05  PV-DISPLAY-CNTL-NBR             PIC  9(09)  VALUE ZERO.  01880008
010700     05  PV-UPC-QTY                      PIC  X(05)  VALUE SPACE. 01890008
010800     05  PV-UPC-QTY-N          REDEFINES PV-UPC-QTY               01900008
010900                                         PIC  ZZZZ9.              01910008
011000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   01920008
011100                                                     COMP SYNC.   01930008
011200     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 01940008
011300     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01950008
011400     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01960008
011500                                                     COMP SYNC.   01970008
011600     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01980008
011700     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   01990008
011800                                                     COMP.        02000008
011900     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   02010008
012000                                                     COMP SYNC.   02020008
012100     05  PV-EXP-QTY                      PIC S9(09)  VALUE ZERO   02030008
012200                                                     COMP.        02040008
012300     05  PV-TWICE-EXP-QTY                PIC S9(09)  VALUE ZERO   02050008
012400                                                     COMP.        02060008
      * 10/16/13 DW BEG                                                 02070067
012300     05  PV-SCND-UNT-QTY                 PIC S9(09)  VALUE ZERO   02080025
012400                                                     COMP.        02090025
012300     05  PV-DISP-AUD-CNTL-NBR         PIC  9(09).                 02100027
      * 10/16/13 DW END                                                 02110067
012500******************************************************************02120008
012600*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02130008
012700******************************************************************02140008
012800     COPY DFHAID.                                                 02150008
012900                                                                  02160008
013000******************************************************************02170008
013100*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                02180008
013200******************************************************************02190008
013300     COPY DPWS013.                                                02200008
013400                                                                  02210008
013500******************************************************************02220008
013600*  SENDING/RECEIVING AREA FOR THE                                 02230008
013700*  PRINTER VALIDATION ROUTING (DPKCS060)                          02240008
013800******************************************************************02250008
013900     COPY DPWS072.                                                02260008
014000                                                                  02270008
014100******************************************************************02280008
014200*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02290008
014300*****************************************************************.02300008
014400     COPY DPWS010I.                                               02310008
014500                                                                  02320008
014600******************************************************************02330008
014700*  RANDOM NUMBER AREA.                                            02340008
014800******************************************************************02350008
014900     COPY DPWS902.                                                02360008
015000                                                                  02370008
015100******************************************************************02380008
015200*  GENERATED DSECT FOR THE SUKM537 MAPSET                         02390008
015300******************************************************************02400008
015400     COPY SUKM537.                                                02410008
015500                                                                  02420008
015600******************************************************************02430008
015700*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02440008
015800******************************************************************02450008
015900     COPY DPWS015.                                                02460008
016000                                                                  02470008
016100*----------------------------------------------------------------*02480008
016200* HELP SCREEN COMMAREA                                            02490008
016300     COPY PCWS192.                                                02500008
016400*----------------------------------------------------------------*02510008
016500* HELP SCREEN WORK AREA                                           02520008
016600     COPY PCWS188.                                                02530008
016700                                                                  02540008
016800******************************************************************02550008
016900*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      02560008
017000*  TO BE DISPLAYED ON THE LRT                                     02570008
017100******************************************************************02580008
017200     COPY SUWS005.                                                02590008
017300                                                                  02600008
017400******************************************************************02610008
017500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02620008
017600*  UPC AUDIT TABLE (TSUAUPC)                                      02630008
017700******************************************************************02640008
017800     EXEC SQL                                                     02650008
017900         INCLUDE TSUAUPC                                          02660008
018000     END-EXEC.                                                    02670008
018100                                                                  02680008
018200******************************************************************02690008
018300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02700008
018400*  UPC ASSOCIATION TABLE (TSHUUPC)                                02710008
018500******************************************************************02720008
018600     EXEC SQL                                                     02730008
018700         INCLUDE TSHUUPC                                          02740008
018800     END-EXEC.                                                    02750008
018900                                                                  02760008
019000******************************************************************02770008
019100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARAMETER TABLE    02780008
019200*   (TKRPRPM)                                                     02790008
019300******************************************************************02800008
019400     EXEC SQL                                                     02810008
019500         INCLUDE TKRPRPM                                          02820008
019600     END-EXEC.                                                    02830008
019700                                                                  02840008
      * 10/16/13 DW BEG                                                 02850067
055200******************************************************************02860026
055300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02870026
055400*  ITEM AUDIT EXCEPTION TABLE (TSUEXCP)                           02880026
055500******************************************************************02890026
055600     EXEC SQL                                                     02900026
055700         INCLUDE TSUEXCP                                          02910026
055800     END-EXEC.                                                    02920026
055900                                                                  02930026
055200******************************************************************02940027
055300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSACTION        02950027
055400*  TABLE (TSUATRN)                                                02960027
055500******************************************************************02970027
055600     EXEC SQL                                                     02980027
055700         INCLUDE TSUATRN                                          02990027
055800     END-EXEC.                                                    03000027
055900                                                                  03010027
      * 10/16/13 DW END                                                 03020067
019800******************************************************************03030008
019900*  COMMUNICATIONS AREA FOR DB2                                    03040008
020000******************************************************************03050008
020100     EXEC SQL                                                     03060008
020200         INCLUDE SQLCA                                            03070008
020300     END-EXEC.                                                    03080008
020400                                                                  03090008
020500******************************************************************03100008
020600 LINKAGE SECTION.                                                 03110008
020700******************************************************************03120008
020800 01  DFHCOMMAREA.                                                 03130008
020900     05  FILLER                         OCCURS  1 TO 4072 TIMES   03140008
021000                                        DEPENDING ON EIBCALEN.    03150008
021100         10  FILLER                     PIC X.                    03160008
021200                                                                  03170008
021300                                                                  03180008
021400******************************************************************03190008
021500 PROCEDURE DIVISION.                                              03200008
021600******************************************************************03210008
021700 0000-PROGRAM-MAINLINE.                                           03220008
021800     MOVE DFHCOMMAREA  TO  CA-COMMAREA.                           03230008
021900     MOVE LOW-VALUES   TO  SU537AI.                               03240008
022000     INITIALIZE PV-UPC-QTY.                                       03250008
022100                                                                  03260008
022200     EVALUATE TRUE                                                03270008
022300****************************************************************  03280008
022400* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        03290008
022500****************************************************************  03300008
022600         WHEN EIBTRNID = 'Z278'                                   03310008
022700             MOVE DFHCOMMAREA          TO PC192-COMMAREA          03320008
022800             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             03330008
022900             SET SU006-PROCESS-SCREEN  TO TRUE                    03340008
023000             INITIALIZE CA-UPC-KEYED-QTY                          03350065
023100             MOVE +0                      TO AUPCQTYO             03360055
023200             MOVE +0                      TO CA-UPC-KEYED-QTY     03370055
023200                                             CA-UPC-KEYED-SCND-QTY03380009
023300             MOVE DP015-UNP-ALP-NOR-OFF      TO AUPCQTYA          03390008
023400             MOVE -1                         TO AUPCQTYL          03400008
023500             MOVE SPACES                     TO AMSGLNO           03410008
      * 10/16/13 DW BEG                                                 03420008
                   MOVE PC-TOT-UPC-MSG             TO AMSG1O            03430010
                   MOVE PC-UPC-QTY-MSG             TO AMSG2O            03440010
      * 10/16/13 DW END                                                 03450008
023600             PERFORM 8000-SEND-MAP                                03460008
023700             PERFORM 8200-RETURN-TRANID                           03470008
023800                                                                  03480008
023900         WHEN EIBCALEN = ZERO                                     03490008
024000         WHEN EIBAID = DFHCLEAR                                   03500008
024100         WHEN SU006-INITIALIZE-SCREEN                             03510008
024200             INITIALIZE CA-PROGRAM-COMMAREA                       03520008
      * 10/16/13 DW BEG                                                 03530067
024200             INITIALIZE CA-PROGRAM-COMMAREA-1                     03540057
024300             SET SU006-PROCESS-SCREEN  TO  TRUE                   03550008
024400             INITIALIZE CA-UPC-KEYED-QTY                          03560065
      * 10/16/13 DW END                                                 03570067
                   IF SU006-RFID-AUD-ONLY                               03580042
                     MOVE +0                    TO AUPCQTYO             03590065
                                                   CA-UPC-KEYED-QTY     03600065
                   ELSE                                                 03610042
                     MOVE +1                    TO AUPCQTYO             03620065
                                                   CA-UPC-KEYED-QTY     03630065
                   END-IF                                               03640042
024600             MOVE +0                      TO CA-UPC-KEYED-SCND-QTY03650055
024700             MOVE DP015-UNP-ALP-NOR-OFF      TO AUPCQTYA          03660008
024800             MOVE -1                         TO AUPCQTYL          03670008
024900             MOVE SPACES                     TO AMSGLNO           03680008
      * 10/16/13 DW BEG                                                 03690008
                   IF (SU006-LAST-PROGRAM =                             03700064
                           PC-LABEL-CHECK-PROGRAM OR                    03710008
                       SU006-LAST-PROGRAM =                             03720008
                           PC-VISUAL-TICK-INFO-PROGRAM OR               03730008
                       SU006-LAST-PROGRAM =                             03740020
                           PC-VISUAL-TICK-EXCP-PROGRAM OR               03750020
                       SU006-LAST-PROGRAM =                             03760008
                           PC-VISUAL-MDSE-INFO-PROGRAM)                 03770008
                     MOVE PC-TOT-UPC-MSG           TO AMSG1O            03780023
                     MOVE PC-UPC-QTY-MSG           TO AMSG2O            03790023
                   ELSE                                                 03800008
                     MOVE PC-RF-ONLY-PFKEYS        TO AMSGPFO           03810028
                     MOVE PC-RF-ONLY-MSG1          TO AMSG1O            03820027
                     MOVE PC-RF-ONLY-MSG2          TO AMSG2O            03830023
                     IF SU006-RFID-AUD-ONLY                             03840009
                       MOVE +0                     TO AUPSQTYO          03850040
                       MOVE PC-RF-ONLY-MSG3        TO AMSG3O            03860023
                       MOVE PC-RF-ONLY-MSG4        TO AMSG4O            03870023
                     ELSE                                               03880010
                       MOVE SPACES                 TO AUPSQTYO          03890047
                       MOVE DP015-ASK-NOR-MDT      TO AUPSQTYA          03900010
                     END-IF                                             03910009
                   END-IF                                               03920009
      * 10/16/13 DW END                                                 03930009
025000             PERFORM 8000-SEND-MAP                                03940009
025100             PERFORM 8200-RETURN-TRANID                           03950009
025200                                                                  03960009
025300         WHEN EIBAID = DFHENTER                                   03970009
025400         WHEN EIBAID = DFHPF3                                     03980009
025500             PERFORM 1200-RECEIVE-MAP                             03990009
025600             PERFORM 1300-EDIT-SELECTION                          04000009
025700                                                                  04010009
      * 10/16/13 DW BEG                                                 04020008
      *** LAST PROGRAM WAS SUKRF513. THIS MEANS PROGRAM IS WORKING      04030008
      *** ON QC AUDIT AS SUKRF710 WOULD BE THE LAST PROGRAM WHEN AN     04040008
      *** RFID AUDIT IS BEING PROCESSED.                                04050008
                 IF SU006-LAST-PROGRAM =                                04060008
                         PC-LABEL-CHECK-PROGRAM OR                      04070037
                         PC-VISUAL-MDSE-INFO-PROGRAM OR                 04080037
                         PC-VISUAL-TICK-EXCP-PROGRAM OR                 04090046
                         PC-VISUAL-TICK-INFO-PROGRAM                    04100037
      * 10/16/13 DW END                                                 04110008
025800             PERFORM 2400-GET-EXP-QTY                             04120008
025900             PERFORM 2500-GET-MAX-QTY                             04130008
026000                                                                  04140008
026100             IF CA-UPC-KEYED-QTY > KRPRPM-FUNC-QTY                04150065
026200                  MOVE KRPRPM-FUNC-QTY     TO PC-MAX-QTY          04160008
026300                  MOVE -1                  TO AUPCQTYL            04170008
026400                  MOVE PC-EXCEED-MAX-QTY   TO AMSGLNO             04180008
026500                  PERFORM 8100-SEND-DATA-ONLY                     04190008
026600                  PERFORM 8200-RETURN-TRANID                      04200008
026700             END-IF                                               04210008
026900                                                                  04220008
027000             IF CA-UPC-KEYED-QTY > PV-TWICE-EXP-QTY               04230008
027100                  MOVE -1                  TO AUPCQTYL            04240008
027200                  MOVE PC-UPC-CONFIRM-QTY  TO AMSGLNO             04250065
027400                  SET CA-CNFRM-KEYED-QTY   TO TRUE                04260065
027500                  PERFORM 8100-SEND-DATA-ONLY                     04270008
027600                  PERFORM 8200-RETURN-TRANID                      04280008
027700             END-IF                                               04290008
027800                                                                  04300008
028000             PERFORM 2250-UPDATE-TSUAUPC                          04310008
      * 10/16/13 DW BEG                                                 04320008
                 ELSE                                                   04330008
                   IF SU006-RFID-AUD-ONLY                               04340036
                       MOVE SU006-AUDIT-CNTL-NBR                        04350067
                                           TO SUAUPC-AUD-CNTL-NBR       04360067
                       IF CA-UPC-KEYED-SCND-QTY > 0                     04370050
                         PERFORM 2300-UPDATE-RFID-TAG-SCAN-QTY          04380050
                       END-IF                                           04390050
      *RLK 4/1/14                                                       04390169
                       IF CA-UPC-KEYED-SCND-QTY < CA-UPC-KEYED-QTY      04391069
                         MOVE CA-UPC-KEYED-SCND-QTY TO                  04392070
                            SU006-WRONG-RFID-CTR                        04393069
                       ELSE                                             04394069
                         MOVE CA-UPC-KEYED-QTY    TO                    04395069
                            SU006-WRONG-RFID-CTR                        04396069
                       END-IF                                           04397069
      *RLK 4/1/14                                                       04398069
                   ELSE                                                 04400067
                       IF (SU006-QC-AND-RFID-AUD                        04410018
                       AND SU006-MANUAL-GENERATED-AUDIT)                04420018
                           MOVE SU006-AUDIT-CNTL-NBR                    04430067
                                                 TO SUAUPC-AUD-CNTL-NBR 04440067
                         IF CA-UPC-KEYED-QTY > 0                        04450025
                           PERFORM 2360-SELECT-SCND-QTY                 04470043
                           MOVE PV-SCND-UNT-QTY  TO SUAUPC-RFID-TGD-QTY 04480051
                                                    SUAUPC-SCND-UNT-QTY 04490052
      *RLK 4/1/14                                                       04490169
                           IF SUAUPC-SCND-UNT-QTY < CA-UPC-KEYED-QTY    04490269
                             MOVE SUAUPC-SCND-UNT-QTY TO                04491069
                                                    SU006-WRONG-RFID-CTR04492069
                           ELSE                                         04492169
                             MOVE CA-UPC-KEYED-QTY    TO                04493069
                                                    SU006-WRONG-RFID-CTR04494069
                           END-IF                                       04495069
      *RLK 4/1/14                                                       04496069
                           PERFORM 2355-UPDATE-SCND-QTY                 04500052
                         END-IF                                         04510025
                       ELSE                                             04520018
                         IF CA-UPC-KEYED-QTY > 0                        04530025
      ** THIS SELECT IS TO GET THE SCANNED QTY FROM QC AUDIT TO         04540025
      ** USE AS TAGGED QTY FOR RFID AUDIT. THIS WILL BE DECREASE        04550025
      ** EACH TIME SUKRF711 PROCESSES A MISSING EPC TAG.                04560025
                           MOVE SU006-AUDIT-CNTL-NBR                    04570067
                                           TO SUAUPC-AUD-CNTL-NBR       04580067
                           PERFORM 2360-SELECT-SCND-QTY                 04590025
                           MOVE SU006-RFID-AUDIT-CNTL-NBR               04600067
                                           TO SUAUPC-AUD-CNTL-NBR       04610067
      *RLK 4/1/14                                                       04620069
                           IF SUAUPC-SCND-UNT-QTY < CA-UPC-KEYED-QTY    04631069
                             MOVE SUAUPC-SCND-UNT-QTY TO                04632069
                                                    SU006-WRONG-RFID-CTR04633069
                           ELSE                                         04634069
                             MOVE CA-UPC-KEYED-QTY    TO                04635069
                                                    SU006-WRONG-RFID-CTR04636069
                           END-IF                                       04637069
      *RLK 4/1/14                                                       04638069
                           MOVE PV-SCND-UNT-QTY                         04640065
                                           TO SUAUPC-RFID-TGD-QTY       04650065
                                              SUAUPC-SCND-UNT-QTY       04660065
                           PERFORM 2355-UPDATE-SCND-QTY                 04670052
                         END-IF                                         04680025
                       END-IF                                           04690067
                   END-IF                                               04700018
                 END-IF                                                 04710008
      * 10/16/13 DW END                                                 04720008
                 SET CA-NO-CNFRM-KEYED-QTY         TO TRUE              04730008
      * 10/16/13 DW BEG                                                 04740008
      *** IF LAST PROGRAM IS ONE OF THE 3 QC AUDIT PROGRAMS THAT        04750008
      *** ONLY PROCESS THE QC PORTION OF COMBINED AUDITS AND THIS       04760008
      *** IS A COMBINED AUDIT, THEN, THE PROGRAM SHOULD XFER TO THE     04770008
      *** RFID PROGRAM TO ALLOW CHECKING OF RFID TAG DATA.              04780008
                 IF (SU006-LAST-PROGRAM =                               04790008
                         PC-LABEL-CHECK-PROGRAM OR                      04800008
                     SU006-LAST-PROGRAM =                               04810008
                         PC-VISUAL-TICK-INFO-PROGRAM OR                 04820008
                     SU006-LAST-PROGRAM =                               04830020
                         PC-VISUAL-TICK-EXCP-PROGRAM OR                 04840020
                     SU006-LAST-PROGRAM =                               04850008
                         PC-VISUAL-MDSE-INFO-PROGRAM)                   04860008
                     AND SU006-QC-AND-RFID-AUD                          04870008
                   MOVE PC-SCAN-RFID-ERR-CHK-PROGRAM                    04880008
                                            TO PV-TRANSFER-PROGRAM      04890008
                 ELSE                                                   04900008
      * 10/16/13 DW END                                                 04910008
                   IF SU006-QC-AUD-ONLY                                 04920035
028100               MOVE PC-SCAN-UPC-PROGRAM                           04930035
028200                                        TO PV-TRANSFER-PROGRAM    04940035
                                                                        04950035
                   ELSE                                                 04960035
                     IF CA-UPC-KEYED-QTY > 0                            04970036
      *RLK 4/1/14                                                       04981070
                       IF SUAUPC-SCND-UNT-QTY < CA-UPC-KEYED-QTY        04982070
                         MOVE SUAUPC-SCND-UNT-QTY TO                    04983070
                                                SU006-WRONG-RFID-CTR    04984070
                       ELSE                                             04985070
                         MOVE CA-UPC-KEYED-QTY    TO                    04986070
                                                SU006-WRONG-RFID-CTR    04987070
                       END-IF                                           04988070
      *RLK 4/1/14                                                       04989070
028100                 MOVE PC-SCAN-RFID-ERR-PRC-PROGRAM                04990035
028200                                        TO PV-TRANSFER-PROGRAM    05000025
                     ELSE                                               05010035
028100                 MOVE PC-SCAN-UPC-PROGRAM                         05020035
028200                                        TO PV-TRANSFER-PROGRAM    05030025
                     END-IF                                             05040035
                   END-IF                                               05050035
                 END-IF                                                 05060008
      * 10/16/13 DW END                                                 05070008
028300           PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                  05080008
028400                                                                  05090008
028500           MOVE DP015-UNP-ALP-NOR-OFF      TO AUPCQTYA            05100008
028600           MOVE -1                         TO AUPCQTYL            05110008
028700           MOVE SPACES                     TO AMSGLNO             05120008
028800                                                                  05130008
028900         WHEN EIBAID = DFHPF2                                     05140008
029000           PERFORM 1200-RECEIVE-MAP                               05150008
029100           PERFORM 1300-EDIT-SELECTION                            05160008
029200                                                                  05170008
      * 11/15/13 DW BEG                                                 05180008
      *** LAST PROGRAM WAS SUKRF513,524. THIS MEANS PROGRAM IS WORKING  05190020
      *** ON QC AUDIT AS SUKRF710 WOULD BE THE LAST PROGRAM WHEN AN     05200008
      *** RFID AUDIT IS BEING PROCESSED.                                05210008
                 IF SU006-LAST-PROGRAM = PC-LABEL-CHECK-PROGRAM         05220016
                   OR SU006-LAST-PROGRAM = PC-VISUAL-TICK-EXCP-PROGRAM  05230020
029300             PERFORM 2400-GET-EXP-QTY                             05240008
029400                                                                  05250008
029500             PERFORM 2500-GET-MAX-QTY                             05260008
029600                                                                  05270008
029700             IF CA-UPC-KEYED-QTY > KRPRPM-FUNC-QTY                05280065
029800                  MOVE KRPRPM-FUNC-QTY     TO PC-MAX-QTY          05290008
029900                  MOVE -1                  TO AUPCQTYL            05300008
030000                  MOVE PC-EXCEED-MAX-QTY   TO AMSGLNO             05310008
030100                  PERFORM 8100-SEND-DATA-ONLY                     05320008
030200                  PERFORM 8200-RETURN-TRANID                      05330008
030300             END-IF                                               05340008
030400                                                                  05350008
030500             IF CA-CNFRM-KEYED-QTY                                05360065
030600                 CONTINUE                                         05370008
030700             ELSE                                                 05380008
030800                 MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO  AMSGLNO     05390008
030900                 PERFORM 8100-SEND-DATA-ONLY                      05400008
031000                 PERFORM 8200-RETURN-TRANID                       05410008
031100             END-IF                                               05420008
031400             PERFORM 2250-UPDATE-TSUAUPC                          05430008
                 ELSE                                                   05440008
                   IF SU006-RFID-AUD-ONLY                               05450017
                      MOVE SU006-AUDIT-CNTL-NBR                         05460067
                                           TO SUAUPC-AUD-CNTL-NBR       05470067
                      IF CA-UPC-KEYED-SCND-QTY > 0                      05480049
                        PERFORM 2300-UPDATE-RFID-TAG-SCAN-QTY           05490025
                      END-IF                                            05500025
                   ELSE                                                 05510067
                     MOVE SUAUPC-SCND-UNT-QTY TO SUAUPC-RFID-TGD-QTY    05520025
      *RLK 4/1/14                                                       05530069
                     IF SUAUPC-SCND-UNT-QTY < CA-UPC-KEYED-QTY          05531069
                       MOVE SUAUPC-SCND-UNT-QTY TO                      05532069
                                        SU006-WRONG-RFID-CTR            05533069
                     ELSE                                               05534069
                       MOVE CA-UPC-KEYED-QTY    TO                      05535069
                                        SU006-WRONG-RFID-CTR            05536069
                     END-IF                                             05537069
      *RLK 4/1/14                                                       05538069
                     IF (SU006-QC-AND-RFID-AUD                          05540018
                     AND SU006-MANUAL-GENERATED-AUDIT)                  05550018
                         MOVE SU006-AUDIT-CNTL-NBR                      05560067
                                           TO SUAUPC-AUD-CNTL-NBR       05570067
                         IF CA-UPC-KEYED-QTY > 0                        05580025
      *RLK 4/1/14                                                       05590069
                           IF SUAUPC-SCND-UNT-QTY < CA-UPC-KEYED-QTY    05601069
                             MOVE SUAUPC-SCND-UNT-QTY TO                05602069
                                        SU006-WRONG-RFID-CTR            05603069
                           ELSE                                         05604069
                             MOVE CA-UPC-KEYED-QTY    TO                05605069
                                        SU006-WRONG-RFID-CTR            05606069
                           END-IF                                       05607069
      *RLK 4/1/14                                                       05608069
                           PERFORM 2350-UPDATE-RFID-TAGD-QTY            05610052
                         END-IF                                         05620025
                     ELSE                                               05630018
      ** THIS SELECT IS TO GET THE SCANNED QTY FROM QC AUDIT TO         05640025
      ** USE AS TAGGED QTY FOR RFID AUDIT. THIS WILL BE DECREASED       05650066
      ** EACH TIME SUKRF711 PROCESSES A MISSING EPC TAG.                05660025
                         MOVE SU006-AUDIT-CNTL-NBR                      05670067
                                         TO SUAUPC-AUD-CNTL-NBR         05680067
                         PERFORM 2360-SELECT-SCND-QTY                   05690025
                         MOVE SU006-RFID-AUDIT-CNTL-NBR                 05700067
                                         TO SUAUPC-AUD-CNTL-NBR         05710067
      *RLK 4/1/14                                                       05720069
                         IF SUAUPC-SCND-UNT-QTY < CA-UPC-KEYED-QTY      05731069
                           MOVE SUAUPC-SCND-UNT-QTY TO                  05732069
                                      SU006-WRONG-RFID-CTR              05733069
                         ELSE                                           05734069
                           MOVE CA-UPC-KEYED-QTY    TO                  05735069
                                      SU006-WRONG-RFID-CTR              05736069
                         END-IF                                         05737069
      *RLK 4/1/14                                                       05738069
                         MOVE PV-SCND-UNT-QTY                           05740065
                                         TO SUAUPC-RFID-TGD-QTY         05750065
                                            SUAUPC-SCND-UNT-QTY         05760065
                       PERFORM 2355-UPDATE-SCND-QTY                     05770052
                      END-IF                                            05780067
                   END-IF                                               05790018
                 END-IF                                                 05800008
031200                                                                  05810008
031300           SET CA-NO-CNFRM-KEYED-QTY  TO TRUE                     05820008
                 IF (SU006-LAST-PROGRAM =                               05830008
                         PC-LABEL-CHECK-PROGRAM OR                      05840008
                     SU006-LAST-PROGRAM =                               05850008
                         PC-VISUAL-TICK-INFO-PROGRAM OR                 05860008
                     SU006-LAST-PROGRAM =                               05870020
                         PC-VISUAL-TICK-EXCP-PROGRAM OR                 05880020
                     SU006-LAST-PROGRAM =                               05890008
                         PC-VISUAL-MDSE-INFO-PROGRAM)                   05900008
                     AND SU006-QC-AND-RFID-AUD                          05910008
                   MOVE PC-SCAN-RFID-ERR-CHK-PROGRAM                    05920008
031600                                      TO PV-TRANSFER-PROGRAM      05930008
                 ELSE                                                   05940008
                   IF SU006-QC-AUD-ONLY                                 05950035
028100               MOVE PC-SCAN-UPC-PROGRAM                           05960035
028200                                        TO PV-TRANSFER-PROGRAM    05970035
                                                                        05980035
                   ELSE                                                 05990035
                     IF SU006-WRONG-RFID-CTR > 0                        06000035
028100                 MOVE PC-SCAN-RFID-ERR-PRC-PROGRAM                06010035
028200                                        TO PV-TRANSFER-PROGRAM    06020035
                     ELSE                                               06030035
028100                 MOVE PC-SCAN-UPC-PROGRAM                         06040035
028200                                        TO PV-TRANSFER-PROGRAM    06050035
                     END-IF                                             06060035
                   END-IF                                               06070035
                 END-IF                                                 06080008
      * 11/15/13 DW END                                                 06090008
031700           PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                  06100008
031800                                                                  06110008
031900           MOVE DP015-UNP-ALP-NOR-OFF      TO AUPCQTYA            06120008
032000           MOVE -1                         TO AUPCQTYL            06130008
032100           MOVE SPACES                     TO AMSGLNO             06140008
032200                                                                  06150008
032300         WHEN EIBAID = DFHPF1                                     06160008
032400              PERFORM 1400-HELP-SCREEN                            06170008
032500                                                                  06180008
      * 11/15/13 DW BEG                                                 06190067
      ** PF9 ALLOWS USERS TO FAIL AUDIT WITHOUT GOING TO SUKRF711.      06200027
      ** THIS PF KEY IS ONLY ALLOWED WHEN PROCESSING RF AUDITS.         06210027
032300         WHEN EIBAID = DFHPF9                                     06220026
025500             PERFORM 1200-RECEIVE-MAP                             06230055
                   IF (SU006-LAST-PROGRAM =                             06240027
                           PC-LABEL-CHECK-PROGRAM OR                    06250027
                       SU006-LAST-PROGRAM =                             06260027
                           PC-VISUAL-TICK-INFO-PROGRAM OR               06270027
                       SU006-LAST-PROGRAM =                             06280027
                           PC-VISUAL-TICK-EXCP-PROGRAM OR               06290027
                       SU006-LAST-PROGRAM =                             06300027
                           PC-VISUAL-MDSE-INFO-PROGRAM)                 06310027
                     MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO  AMSGLNO       06320027
                   ELSE                                                 06330027
      *** WHEN PF9 IS PRESSED PROGRAM WILL UPDATE TSUAUPC ROW TO        06340032
      *** SET SCND QTY TO WHAT WAS ENTERED AND TAGD QTY TO ZERO         06350032
      *** TO ERROR OUT ALL ITEM. PROGRAM WILL THEN XFER TO SUKRF518.    06360032
                     PERFORM 1350-EDIT-PF9-SELECTION                    06370029
                     IF SU006-RFID-AUD-ONLY                             06380031
                       MOVE SU006-AUDIT-CNTL-NBR                        06390031
                                           TO SUAUPC-AUD-CNTL-NBR       06400031
                       MOVE CA-UPC-KEYED-SCND-QTY TO SUAUPC-SCND-UNT-QTY06410038
                       MOVE 0                     TO SUAUPC-RFID-TGD-QTY06420038
                       PERFORM 2355-UPDATE-SCND-QTY                     06430038
                     ELSE                                               06440031
                       IF (SU006-QC-AND-RFID-AUD                        06450031
                       AND SU006-MANUAL-GENERATED-AUDIT)                06460031
                           MOVE SU006-AUDIT-CNTL-NBR                    06470038
                                           TO SUAUPC-AUD-CNTL-NBR       06480031
      *                    MOVE CA-UPC-KEYED-SCND-QTY TO                06490066
      *                                       SUAUPC-SCND-UNT-QTY       06500066
                           MOVE 0                     TO                06510038
                                              SUAUPC-RFID-TGD-QTY       06520038
                           PERFORM 2355-UPDATE-SCND-QTY                 06530052
                       ELSE                                             06540038
                            MOVE SU006-SHIP-UNIT-NBR                    06550066
                                   TO  SUAUPC-SHIPT-UNT-ID              06560066
                           MOVE SU006-RFID-AUDIT-CNTL-NBR               06570066
                                         TO SUAUPC-AUD-CNTL-NBR         06580066
                           PERFORM 2360-SELECT-SCND-QTY                 06590066
                           MOVE PV-SCND-UNT-QTY       TO                06600066
                                              SUAUPC-SCND-UNT-QTY       06610066
                           MOVE 0                     TO                06620038
                                              SUAUPC-RFID-TGD-QTY       06630038
                           PERFORM 2355-UPDATE-SCND-QTY                 06640066
                       END-IF                                           06650038
                     END-IF                                             06660038
                     MOVE PC-SCAN-UPC-PROGRAM                           06670038
                                                TO PV-TRANSFER-PROGRAM  06680038
                     PERFORM 2100-XCTL-TO-SELECTED-PROGRAM              06690027
                   END-IF                                               06700027
032600         WHEN OTHER                                               06710008
032700             MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO  AMSGLNO         06720008
      * 11/15/13 DW BEG                                                 06730067
032800                                                                  06740008
032900     END-EVALUATE.                                                06750008
033000                                                                  06760008
033100     PERFORM 8100-SEND-DATA-ONLY.                                 06770008
033200     PERFORM 8200-RETURN-TRANID.                                  06780008
033300                                                                  06790008
033400     GOBACK.                                                      06800008
033500****************************************************************  06810008
033600* 1000-SETUP-SCREEN                                               06820008
033700*    INITIAL SETUP OF SCREEN FIELDS                               06830008
033800****************************************************************  06840008
033900 1000-SETUP-SCREEN.                                               06850008
034000                                                                  06860008
034100*                                                                 06870008
034200      INITIALIZE CA-PROGRAM-COMMAREA                              06880008
034200      INITIALIZE CA-PROGRAM-COMMAREA-1                            06890057
034300      MOVE SPACES                 TO SU006-SHIP-UNIT-NBR-X        06900008
034400                                                                  06910008
034500      MOVE DP015-UNP-ALP-NOR-OFF  TO AUPCQTYA                     06920008
034600      MOVE -1                     TO AUPCQTYL                     06930008
034700      MOVE SPACES                 TO AMSGLNO.                     06940008
034800                                                                  06950008
034900                                                                  06960008
035000*    IN ALL CASES, MOVE THE CURRENT COMMAREA TO THE SCREEN        06970008
035100*                                                                 06980008
035200*                                                                 06990008
035300 1200-RECEIVE-MAP.                                                07000008
035400     EXEC CICS                                                    07010008
035500         RECEIVE                                                  07020008
035600             MAP     ('SU537A')                                   07030008
035700             MAPSET  ('SUKM537')                                  07040008
035800             RESP    (PV-CICS-RESPONSE)                           07050008
035900     END-EXEC.                                                    07060008
036000                                                                  07070008
036100     EVALUATE TRUE                                                07080008
036200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07090008
036300              PERFORM 1210-RECEIVE-SCREEN-FIELDS                  07100008
036400         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                07110008
036500              CONTINUE                                            07120008
036600         WHEN OTHER                                               07130008
036700              MOVE '1200-RECEIVE-MAP'                             07140008
036800                                      TO DP013-PARAGRAPH          07150008
036900              MOVE 'UNABLE TO RECEIVE MAP'                        07160008
037000                                      TO DP013-MESSAGE-TEXT (1)   07170008
037100              SET DP013-LOGIC-ABEND   TO TRUE                     07180008
037200              SET DP013-NO-ROLLBACK   TO TRUE                     07190008
037300              PERFORM 9999-WRITE-CICS-LOG-MSG                     07200008
037400     END-EVALUATE.                                                07210008
037500*                                                                 07220008
037600 1210-RECEIVE-SCREEN-FIELDS.                                      07230008
037700*                                                                 07240008
037800     IF  AUPCQTYL   > ZERO                                        07250008
037900         MOVE AUPCQTYI                TO CA-UPC-KEYED-QTY-X       07260008
038000     ELSE                                                         07270008
038100         IF AUPCQTYA   = DP015-ERASE-EOF                          07280008
038200             MOVE SPACES              TO CA-UPC-KEYED-QTY-X       07290008
038300         END-IF                                                   07300008
038400     END-IF.                                                      07310008
038400                                                                  07320057
      * 11/15/13 DW BEG                                                 07330067
037800     IF  AUPSQTYL   > ZERO                                        07340014
037900         MOVE AUPSQTYI                TO CA-UPC-KEYED-SCND-QTY-X  07350009
038000     ELSE                                                         07360009
038100         IF AUPSQTYA   = DP015-ERASE-EOF                          07370009
038200             MOVE SPACES              TO CA-UPC-KEYED-SCND-QTY-X  07380009
038300         END-IF                                                   07390009
038400     END-IF.                                                      07400009
038500                                                                  07410008
      * 11/15/13 DW END                                                 07420067
038600                                                                  07430008
038700*                                                                 07440008
038800**************************************************************    07450008
038900* EDIT ALL ENTERABLE FIELDS (OPERATING UNIT ID, AND SELECT)  *    07460008
039000**************************************************************    07470008
039100 1300-EDIT-SELECTION.                                             07480008
039200                                                                  07490008
039300*    VALIDATE THE UPC NUMBER THAT WAS ENTERED (IF ANY)            07500008
039400     IF CA-UPC-KEYED-QTY-X > SPACES                               07510008
039500        IF CA-UPC-KEYED-QTY   > ZEROES                            07520008
039600            MOVE CA-UPC-KEYED-QTY-X TO DP010I-UNEDITED-FIELD      07530008
039700            MOVE LENGTH OF CA-UPC-KEYED-QTY TO                    07540008
039800                                          DP010I-MAXIMUM-DIGITS   07550008
039900            MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS  07560008
040000            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE               07570008
040100                                                                  07580008
263968            CALL DP010I-NUMERIC-EDIT-ROUTINE                      07591073
263968                 USING DP010I-NUMERIC-EDIT-AREA                   07592073
040300                                                                  07600008
040400            IF  DP010I-ERROR-DETECTED                             07610008
040500                MOVE -1                  TO AUPCQTYL              07620008
040600                MOVE PC-UPC-NOT-NUMERIC                           07630008
040700                                         TO AMSGLNO               07640008
040800                PERFORM 8100-SEND-DATA-ONLY                       07650008
040900                PERFORM 8200-RETURN-TRANID                        07660008
041000            ELSE                                                  07670008
041100                MOVE DP010I-NUMERIC-FIELD TO CA-UPC-KEYED-QTY     07680008
041200                                             DK-UPC-QTY           07690008
041300            END-IF                                                07700008
041400        ELSE                                                      07710008
      * 11/15/13 DW BEG                                                 07720067
                 IF (SU006-LAST-PROGRAM =                               07730013
                         PC-LABEL-CHECK-PROGRAM OR                      07740013
                     SU006-LAST-PROGRAM =                               07750013
                         PC-VISUAL-TICK-INFO-PROGRAM OR                 07760013
                     SU006-LAST-PROGRAM =                               07770020
                         PC-VISUAL-TICK-EXCP-PROGRAM OR                 07780020
                     SU006-LAST-PROGRAM =                               07790013
                         PC-VISUAL-MDSE-INFO-PROGRAM)                   07800013
      * THIS IS FOR QC AUDITS WHERE YOU MUST ENTER AT LEAST A QTY       07810013
      * OF ONE                                                          07820013
                   MOVE -1                  TO AUPCQTYL                 07830013
                   MOVE PC-UPC-QTY-WARNING TO  AMSGLNO                  07840013
                   PERFORM 8100-SEND-DATA-ONLY                          07850013
                   PERFORM 8200-RETURN-TRANID                           07860013
                 ELSE                                                   07870013
      * FOR RFID AUDITS A QTY OF ZERO IS VALID                          07880013
                   CONTINUE                                             07890013
                 END-IF                                                 07900013
              END-IF                                                    07910013
           IF SU006-RFID-AUD-ONLY                                       07920009
             IF CA-UPC-KEYED-SCND-QTY-X > SPACES                        07930009
039500        IF CA-UPC-KEYED-SCND-QTY   > ZEROES                       07940011
039600            MOVE CA-UPC-KEYED-SCND-QTY-X TO DP010I-UNEDITED-FIELD 07950009
039700            MOVE LENGTH OF CA-UPC-KEYED-SCND-QTY  TO              07960041
039800                                          DP010I-MAXIMUM-DIGITS   07970009
039900            MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS  07980009
040000            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE               07990009
040100                                                                  08000009
263968            CALL DP010I-NUMERIC-EDIT-ROUTINE                      08011073
263968                 USING DP010I-NUMERIC-EDIT-AREA                   08012073
040300                                                                  08020009
040400            IF  DP010I-ERROR-DETECTED                             08030009
040500                MOVE -1                  TO AUPSQTYL              08040009
040600                MOVE PC-UPC-RFID-NOT-NUMERIC                      08050011
040700                                         TO AMSGLNO               08060009
040800                PERFORM 8100-SEND-DATA-ONLY                       08070009
040900                PERFORM 8200-RETURN-TRANID                        08080009
041000            ELSE                                                  08090009
041100                MOVE DP010I-NUMERIC-FIELD TO CA-UPC-KEYED-SCND-QTY08100009
041200                                             DK-UPC-SCND-QTY      08110009
041300            END-IF                                                08120009
                  IF CA-UPC-KEYED-QTY > CA-UPC-KEYED-SCND-QTY           08130034
040500                MOVE -1                  TO AUPSQTYL              08140034
040600                MOVE PC-WRG-RF-GT-UPC-QTY                         08150034
040700                                         TO AMSGLNO               08160034
040800                PERFORM 8100-SEND-DATA-ONLY                       08170034
040900                PERFORM 8200-RETURN-TRANID                        08180034
041300            END-IF                                                08190034
                  IF CA-UPC-KEYED-SCND-QTY > 0                          08200059
                    CONTINUE                                            08210054
                  ELSE                                                  08220054
040500                MOVE -1                  TO AUPSQTYL              08230059
041940                MOVE PC-UPC-GT-ZERO      TO AMSGLNO               08240059
040800                PERFORM 8100-SEND-DATA-ONLY                       08250054
040900                PERFORM 8200-RETURN-TRANID                        08260054
041300            END-IF                                                08270054
041400          ELSE                                                    08280009
041500            MOVE -1                  TO AUPSQTYL                  08290009
041600            MOVE PC-UPC-QTY-WARNING  TO AMSGLNO                   08300058
041700            PERFORM 8100-SEND-DATA-ONLY                           08310009
041800            PERFORM 8200-RETURN-TRANID                            08320009
                END-IF                                                  08330009
041900        END-IF                                                    08340009
1900        END-IF                                                      08350013
041901*                                                                 08360013
041902*** DMH 7/30/13 BEGIN                                             08370008
041903*                                                                 08380008
041910     ELSE                                                         08390008
041930        MOVE -1                  TO AUPCQTYL                      08400008
041940        MOVE PC-UPC-QTY-WARNING  TO  AMSGLNO                      08410008
041950        PERFORM 8100-SEND-DATA-ONLY                               08420008
041960        PERFORM 8200-RETURN-TRANID                                08430008
041970*                                                                 08440008
041980*** DMH 7/30/13 END                                               08450008
041990*                                                                 08460008
042000     END-IF.                                                      08470008
042100                                                                  08480008
      * 11/15/13 DW BEG                                                 08490067
038800**************************************************************    08500029
038900* EDIT ALL ENTERABLE FIELDS (RFID TAG ERROR QTY AND SCND QTY *    08510029
039000**************************************************************    08520029
039100 1350-EDIT-PF9-SELECTION.                                         08530029
039200                                                                  08540029
      * 11/15/13 DW BEG SCANNED QTY WAS ENTERED.                        08550029
           IF SU006-RFID-AUD-ONLY                                       08560029
             IF CA-UPC-KEYED-SCND-QTY-X > SPACES                        08570029
039500        IF CA-UPC-KEYED-SCND-QTY   > ZEROES                       08580029
039600            MOVE CA-UPC-KEYED-SCND-QTY-X TO DP010I-UNEDITED-FIELD 08590029
039700            MOVE LENGTH OF CA-UPC-KEYED-QTY TO                    08600029
039800                                          DP010I-MAXIMUM-DIGITS   08610029
039900            MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS  08620029
040000            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE               08630029
040100                                                                  08640029
263968            CALL DP010I-NUMERIC-EDIT-ROUTINE                      08651073
263968                 USING DP010I-NUMERIC-EDIT-AREA                   08652073
040300                                                                  08660029
040400            IF  DP010I-ERROR-DETECTED                             08670029
040500                MOVE -1                  TO AUPSQTYL              08680029
040600                MOVE PC-UPC-RFID-NOT-NUMERIC                      08690029
040700                                         TO AMSGLNO               08700029
040800                PERFORM 8100-SEND-DATA-ONLY                       08710029
040900                PERFORM 8200-RETURN-TRANID                        08720029
041000            ELSE                                                  08730029
041100                MOVE DP010I-NUMERIC-FIELD TO CA-UPC-KEYED-SCND-QTY08740029
041200                                             DK-UPC-SCND-QTY      08750029
041300            END-IF                                                08760029
041400        ELSE                                                      08770054
041500            MOVE -1                  TO AUPSQTYL                  08780029
041600            MOVE PC-UPC-QTY-WARNING TO  AMSGLNO                   08790029
041700            PERFORM 8100-SEND-DATA-ONLY                           08800029
041800            PERFORM 8200-RETURN-TRANID                            08810029
              END-IF                                                    08820054
             ELSE                                                       08830054
040500         MOVE -1                  TO AUPSQTYL                     08840054
040600         MOVE PC-UPC-GT-ZERO                                      08850054
040700                                  TO AMSGLNO                      08860054
040800         PERFORM 8100-SEND-DATA-ONLY                              08870054
040900         PERFORM 8200-RETURN-TRANID                               08880054
041300       END-IF                                                     08890054
1900        END-IF.                                                     08900029
      * 11/15/13 DW END                                                 08910067
042100                                                                  08920029
042200 1400-HELP-SCREEN.                                                08930029
042300     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      08940008
042400     MOVE 'SUKRF537'                  TO PC192-PROGRAM-NAME       08950008
042500     COPY PCPD188.                                                08960008
042600     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      08970008
042700     PERFORM 4200-XCTL-TO-HELP.                                   08980008
042800*                                                                 08990008
074900                                                                  09000026
042900 2100-XCTL-TO-SELECTED-PROGRAM.                                   09010008
043000     SET SU006-INITIALIZE-SCREEN   TO  TRUE.                      09020008
043100     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        09030008
043200     MOVE PC-CURRENT-PROGRAM-NAME  TO  SU006-LAST-PROGRAM.        09040008
043300                                                                  09050008
043400     EXEC CICS                                                    09060008
043500         XCTL                                                     09070008
043600             PROGRAM   (PV-TRANSFER-PROGRAM)                      09080008
043700             COMMAREA  (CA-COMMAREA)                              09090008
043800             LENGTH    (PV-COMMAREA-LENGTH)                       09100008
043900             RESP      (PV-CICS-RESPONSE)                         09110008
044000     END-EXEC.                                                    09120008
044100                                                                  09130008
044200     EVALUATE TRUE                                                09140008
044300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09150008
044400              CONTINUE                                            09160008
044500         WHEN OTHER                                               09170008
044600              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                09180008
044700                                 TO DP013-PARAGRAPH               09190008
044800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09200008
044900                                 TO DP013-MESSAGE-TEXT (1)        09210008
045000              MOVE PV-TRANSFER-PROGRAM                            09220008
045100                                 TO DP013-MESSAGE-TEXT (2)        09230008
045200              SET DP013-CICS-ABEND   TO TRUE                      09240008
045300              SET DP013-NO-ROLLBACK  TO TRUE                      09250008
045400              PERFORM 9999-WRITE-CICS-LOG-MSG                     09260008
045500              MOVE PM-TRANS-NOT-AVAILABLE-MSG                     09270008
045600                                     TO AMSGLNO                   09280008
045700              SET SU006-PROCESS-SCREEN TO TRUE                    09290008
045800              PERFORM 8100-SEND-DATA-ONLY                         09300008
045900              PERFORM 8200-RETURN-TRANID                          09310008
046000     END-EVALUATE.                                                09320008
046100                                                                  09330008
046200******************************************************************09340008
046300* UPDATE TSUAUPC - UPDATE ROW WITH LABEL SEQUENCE NUMBER         *09350022
046400******************************************************************09360008
046500 2250-UPDATE-TSUAUPC.                                             09370008
046600                                                                  09380008
046700     MOVE CA-UPC-KEYED-QTY     TO  SUAUPC-SCND-UNT-QTY.           09390065
046800     MOVE SU006-AUDIT-CNTL-NBR TO  SUAUPC-AUD-CNTL-NBR.           09400065
046900     MOVE SU006-SHIP-UNIT-NBR  TO  SUAUPC-SHIPT-UNT-ID.           09410065
047000     MOVE SU006-SCN-TMST       TO  SUAUPC-SCN-TMST.               09420065
047100                                                                  09430008
047200     EXEC SQL                                                     09440008
047300         UPDATE TSUAUPC                                           09450008
047400         SET                                                      09460008
047500              SCND_UNT_QTY    =  :SUAUPC-SCND-UNT-QTY             09470008
047600          WHERE                                                   09480008
047700              AUD_CNTL_NBR    =  :SUAUPC-AUD-CNTL-NBR             09490008
047800          AND SHIPT_UNT_ID    =  :SUAUPC-SHIPT-UNT-ID             09500008
047900          AND SCN_TMST        =  :SUAUPC-SCN-TMST                 09510008
048000     END-EXEC.                                                    09520008
048100                                                                  09530008
048200     EVALUATE TRUE                                                09540008
048300         WHEN SQLCODE = ZERO                                      09550008
048400             CONTINUE                                             09560008
048500         WHEN SQLCODE = +100                                      09570008
048600              CONTINUE                                            09580008
048700         WHEN SQLWARN0 NOT = SPACES                               09590008
048800         WHEN SQLCODE NOT EQUAL ZERO                              09600008
048900             MOVE  SUAUPC-AUD-CNTL-NBR TO PV-DISPLAY-CNTL-NBR     09610008
049000             MOVE '2250-UPDATE-TSUAUPC'                           09620008
049100                             TO DP013-PARAGRAPH                   09630008
049200             MOVE 'UPDATE TSUAUPC QTY'                            09640008
049300                             TO DP013-MESSAGE-TEXT(1)             09650008
049400             MOVE SUAUPC-SHIPT-UNT-ID                             09660008
049500                             TO DP013-MESSAGE-TEXT(2)             09670008
049600             STRING  'TMST-' SUAUPC-SCN-TMST ' - '                09680060
049700                     'AUDIT # - '                                 09690008
049800                     PV-DISPLAY-CNTL-NBR                          09700008
049900                     DELIMITED BY SIZE                            09710008
050000                           INTO DP013-MESSAGE-TEXT(3)             09720008
050100             MOVE SQLCA      TO DP013-SQLCA                       09730008
050200             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME(1)           09740008
050300             SET DP013-DB2-ABEND                                  09750008
050400                             TO TRUE                              09760008
050500             SET DP013-NO-ROLLBACK                                09770008
050600                             TO TRUE                              09780008
050700             PERFORM 9999-WRITE-CICS-LOG-MSG                      09790008
050800             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               09800008
050900             PERFORM 8100-SEND-DATA-ONLY                          09810008
051000             PERFORM 8200-RETURN-TRANID                           09820008
051100     END-EVALUATE.                                                09830008
051200                                                                  09840008
      * 10/16/13 DRW BEG                                                09850008
046200******************************************************************09860008
046300* UPDATE TSUAUPC RFID AND SCANNED QUANTITIES                     *09870018
046400******************************************************************09880008
046500 2300-UPDATE-RFID-TAG-SCAN-QTY.                                   09890067
046600                                                                  09900018
      * USER WILL ENTER NUMBER OF WRONG RFID TAGS AND THAT WILL BE      09910025
      * USED TO TELL SUKRF711 HOW MANY ERRORS TO PROCESS.               09920025
      * FOR RFID ONLY AUDITS THE USER WILL ENTER THE TOTAL # OF UNITS   09940009
      * IN CARTON AND THAT IS WHAT IS BEING UPDATED HERE. INITIALLY     09950025
      * TAGGED QTY WILL BE SET TO SCANNED QTY AND FOR EACH MISSING      09960025
      * RFID TAG SUKRF711 PROCESSES 1 WILL BE SUBRACTED FROM THE        09970025
      * TAGGED QTY.                                                     09980025
           MOVE CA-UPC-KEYED-SCND-QTY      TO SUAUPC-SCND-UNT-QTY       09990065
                                              SUAUPC-RFID-TGD-QTY.      10000065
      *RLK 4/1/14                                                       10000169
           IF CA-UPC-KEYED-SCND-QTY < CA-UPC-KEYED-QTY                  10001069
             MOVE SUAUPC-SCND-UNT-QTY TO                                10002069
                        SU006-WRONG-RFID-CTR                            10003069
           ELSE                                                         10004069
             MOVE CA-UPC-KEYED-QTY    TO                                10005069
                        SU006-WRONG-RFID-CTR                            10006069
           END-IF.                                                      10007069
      *RLK 4/1/14                                                       10008069
046900     MOVE SU006-SHIP-UNIT-NBR        TO SUAUPC-SHIPT-UNT-ID.      10010065
047000     MOVE SU006-SCN-TMST             TO SUAUPC-SCN-TMST.          10020065
047100                                                                  10030008
047200     EXEC SQL                                                     10040008
047300         UPDATE TSUAUPC                                           10050008
047400         SET                                                      10060008
047500              RFID_TGD_QTY    =  :SUAUPC-RFID-TGD-QTY             10070008
                   ,SCND_UNT_QTY    =  :SUAUPC-SCND-UNT-QTY             10080067
047600          WHERE                                                   10090008
047700              AUD_CNTL_NBR    =  :SUAUPC-AUD-CNTL-NBR             10100008
047800          AND SHIPT_UNT_ID    =  :SUAUPC-SHIPT-UNT-ID             10110008
047900          AND SCN_TMST        =  :SUAUPC-SCN-TMST                 10120008
048000     END-EXEC.                                                    10130008
048100                                                                  10140008
048200     EVALUATE TRUE                                                10150008
048300         WHEN SQLCODE = ZERO                                      10160008
048400             CONTINUE                                             10170008
048500         WHEN SQLCODE = +100                                      10180008
048600              CONTINUE                                            10190008
048700         WHEN SQLWARN0 NOT = SPACES                               10200008
048800         WHEN SQLCODE NOT EQUAL ZERO                              10210008
048900             MOVE  SUAUPC-AUD-CNTL-NBR TO PV-DISPLAY-CNTL-NBR     10220008
049000             MOVE '2300-UPDATE-RFID-TAG-SCAN-QTY'                 10230018
049100                             TO DP013-PARAGRAPH                   10240008
049200             MOVE 'UPDATE TSUAUPC RFID QTY'                       10250008
049300                             TO DP013-MESSAGE-TEXT(1)             10260008
049400             MOVE SUAUPC-SHIPT-UNT-ID                             10270008
049500                             TO DP013-MESSAGE-TEXT(2)             10280008
049600             STRING  'TMST-' SUAUPC-SCN-TMST ' - '                10290060
049700                     'AUDIT # - '                                 10300008
049800                     PV-DISPLAY-CNTL-NBR                          10310008
049900                     DELIMITED BY SIZE                            10320008
050000                           INTO DP013-MESSAGE-TEXT(3)             10330008
050100             MOVE SQLCA      TO DP013-SQLCA                       10340008
050200             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME(1)           10350008
050300             SET DP013-DB2-ABEND                                  10360008
050400                             TO TRUE                              10370008
050500             SET DP013-NO-ROLLBACK                                10380008
050600                             TO TRUE                              10390008
050700             PERFORM 9999-WRITE-CICS-LOG-MSG                      10400008
050800             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               10410008
050900             PERFORM 8100-SEND-DATA-ONLY                          10420008
051000             PERFORM 8200-RETURN-TRANID                           10430008
051100     END-EVALUATE.                                                10440008
                                                                        10450008
046500 2350-UPDATE-RFID-TAGD-QTY.                                       10460018
046600                                                                  10470008
046900     MOVE  SU006-SHIP-UNIT-NBR  TO  SUAUPC-SHIPT-UNT-ID.          10480018
047000     MOVE  SU006-SCN-TMST       TO  SUAUPC-SCN-TMST.              10490018
047100                                                                  10500008
047200     EXEC SQL                                                     10510008
047300         UPDATE TSUAUPC                                           10520008
047400         SET                                                      10530008
047500              RFID_TGD_QTY    =  :SUAUPC-RFID-TGD-QTY             10540008
047600          WHERE                                                   10550008
047700              AUD_CNTL_NBR    =  :SUAUPC-AUD-CNTL-NBR             10560008
047800          AND SHIPT_UNT_ID    =  :SUAUPC-SHIPT-UNT-ID             10570008
047900          AND SCN_TMST        =  :SUAUPC-SCN-TMST                 10580008
048000     END-EXEC.                                                    10590008
048100                                                                  10600008
048200     EVALUATE TRUE                                                10610008
048300         WHEN SQLCODE = ZERO                                      10620008
048400             CONTINUE                                             10630008
048500         WHEN SQLCODE = +100                                      10640008
048600              CONTINUE                                            10650008
048700         WHEN SQLWARN0 NOT = SPACES                               10660008
048800         WHEN SQLCODE NOT EQUAL ZERO                              10670008
048900             MOVE  SUAUPC-AUD-CNTL-NBR TO PV-DISPLAY-CNTL-NBR     10680008
049000             MOVE '2350-UPDATE-RFID-TAGD-QTY'                     10690018
049100                             TO DP013-PARAGRAPH                   10700008
049200             MOVE 'UPDATE TSUAUPC QTY'                            10710008
049300                             TO DP013-MESSAGE-TEXT(1)             10720008
049400             MOVE SUAUPC-SHIPT-UNT-ID                             10730008
049500                             TO DP013-MESSAGE-TEXT(2)             10740008
049600             STRING  'TMST-' SUAUPC-SCN-TMST ' - '                10750060
049700                     'AUDIT # - '                                 10760008
049800                     PV-DISPLAY-CNTL-NBR                          10770008
049900                     DELIMITED BY SIZE                            10780008
050000                           INTO DP013-MESSAGE-TEXT(3)             10790008
050100             MOVE SQLCA      TO DP013-SQLCA                       10800008
050200             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME(1)           10810008
050300             SET DP013-DB2-ABEND                                  10820008
050400                             TO TRUE                              10830008
050500             SET DP013-NO-ROLLBACK                                10840008
050600                             TO TRUE                              10850008
050700             PERFORM 9999-WRITE-CICS-LOG-MSG                      10860008
050800             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               10870008
050900             PERFORM 8100-SEND-DATA-ONLY                          10880008
051000             PERFORM 8200-RETURN-TRANID                           10890008
051100     END-EVALUATE.                                                10900008
051200                                                                  10910008
      **************************************************************    10920032
      * THIS PARA WILL SET THE SCANNED QTY TO WHAT USER ENTERED AND     10930032
      * RFID TAGGED QTY TO ZERO TO CAUSE ERROR OF ALL UNITS             10940032
      **************************************************************    10950032
046500 2355-UPDATE-SCND-QTY.                                            10960032
046600                                                                  10970030
046900     MOVE  SU006-SHIP-UNIT-NBR  TO  SUAUPC-SHIPT-UNT-ID.          10980030
047000     MOVE  SU006-SCN-TMST       TO  SUAUPC-SCN-TMST.              10990030
047100                                                                  11000030
047200     EXEC SQL                                                     11010030
047300         UPDATE TSUAUPC                                           11020030
047400         SET                                                      11030030
047500              SCND_UNT_QTY    =  :SUAUPC-SCND-UNT-QTY             11040030
047500             ,RFID_TGD_QTY    =  :SUAUPC-RFID-TGD-QTY             11050031
047600          WHERE                                                   11060031
047700              AUD_CNTL_NBR    =  :SUAUPC-AUD-CNTL-NBR             11070031
047800          AND SHIPT_UNT_ID    =  :SUAUPC-SHIPT-UNT-ID             11080031
047900          AND SCN_TMST        =  :SUAUPC-SCN-TMST                 11090031
048000     END-EXEC.                                                    11100031
048100                                                                  11110031
048200     EVALUATE TRUE                                                11120031
048300         WHEN SQLCODE = ZERO                                      11130031
048400             CONTINUE                                             11140031
048500         WHEN SQLCODE = +100                                      11150031
048600              CONTINUE                                            11160031
048700         WHEN SQLWARN0 NOT = SPACES                               11170031
048800         WHEN SQLCODE NOT EQUAL ZERO                              11180031
048900             MOVE  SUAUPC-AUD-CNTL-NBR TO PV-DISPLAY-CNTL-NBR     11190031
049000             MOVE '2355-UPDATE-SCND-QTY'                          11200032
049100                             TO DP013-PARAGRAPH                   11210031
049200             MOVE 'UPDATE TSUAUPC QTY'                            11220031
049300                             TO DP013-MESSAGE-TEXT(1)             11230031
049400             MOVE SUAUPC-SHIPT-UNT-ID                             11240031
049500                             TO DP013-MESSAGE-TEXT(2)             11250031
049600             STRING  'TMST-' SUAUPC-SCN-TMST ' - '                11260060
049700                     'AUDIT # - '                                 11270031
049800                     PV-DISPLAY-CNTL-NBR                          11280031
049900                     DELIMITED BY SIZE                            11290031
050000                           INTO DP013-MESSAGE-TEXT(3)             11300031
050100             MOVE SQLCA      TO DP013-SQLCA                       11310031
050200             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME(1)           11320031
050300             SET DP013-DB2-ABEND                                  11330031
050400                             TO TRUE                              11340031
050500             SET DP013-NO-ROLLBACK                                11350031
050600                             TO TRUE                              11360031
050700             PERFORM 9999-WRITE-CICS-LOG-MSG                      11370031
050800             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               11380031
050900             PERFORM 8100-SEND-DATA-ONLY                          11390031
051000             PERFORM 8200-RETURN-TRANID                           11400031
051100     END-EVALUATE.                                                11410031
051200                                                                  11420031
046500 2360-SELECT-SCND-QTY.                                            11430031
046600                                                                  11440031
046900     MOVE  SU006-SHIP-UNIT-NBR  TO  SUAUPC-SHIPT-UNT-ID.          11450031
047100                                                                  11460031
047200     EXEC SQL                                                     11470025
047300         SELECT SCND_UNT_QTY                                      11480025
047500         INTO  :PV-SCND-UNT-QTY                                   11490025
047400         FROM TSUAUPC                                             11500027
047600         WHERE                                                    11510025
047700              AUD_CNTL_NBR    =  :SUAUPC-AUD-CNTL-NBR             11520025
047800          AND SHIPT_UNT_ID    =  :SUAUPC-SHIPT-UNT-ID             11530025
047900          AND SCN_TMST        =                                   11540033
                (SELECT MAX(SCN_TMST)                                   11550033
                   FROM TSUAUPC B                                       11560039
                    WHERE B.AUD_CNTL_NBR  = :SUAUPC-AUD-CNTL-NBR        11570033
                      AND B.SHIPT_UNT_ID  = :SUAUPC-SHIPT-UNT-ID)       11580033
048000     END-EXEC.                                                    11590025
048100                                                                  11600025
048200     EVALUATE TRUE                                                11610025
048300         WHEN SQLCODE = ZERO                                      11620025
048400             CONTINUE                                             11630025
048500         WHEN SQLCODE = +100                                      11640025
048600              CONTINUE                                            11650025
048700         WHEN SQLWARN0 NOT = SPACES                               11660025
048800         WHEN SQLCODE NOT EQUAL ZERO                              11670025
048900             MOVE  SUAUPC-AUD-CNTL-NBR TO PV-DISPLAY-CNTL-NBR     11680025
049000             MOVE '2360-SELECT-SCND-QTY'                          11690025
049100                             TO DP013-PARAGRAPH                   11700025
049200             MOVE 'SELECT TSUAUPC QTY'                            11710025
049300                             TO DP013-MESSAGE-TEXT(1)             11720025
049400             MOVE SUAUPC-SHIPT-UNT-ID                             11730025
049500                             TO DP013-MESSAGE-TEXT(2)             11740025
049600             STRING  'TMST-' SUAUPC-SCN-TMST ' - '                11750060
049700                     'AUDIT # - '                                 11760025
049800                     PV-DISPLAY-CNTL-NBR                          11770025
049900                     DELIMITED BY SIZE                            11780025
050000                           INTO DP013-MESSAGE-TEXT(3)             11790025
050100             MOVE SQLCA      TO DP013-SQLCA                       11800025
050200             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME(1)           11810025
050300             SET DP013-DB2-ABEND                                  11820025
050400                             TO TRUE                              11830025
050500             SET DP013-NO-ROLLBACK                                11840025
050600                             TO TRUE                              11850025
050700             PERFORM 9999-WRITE-CICS-LOG-MSG                      11860025
050800             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               11870025
050900             PERFORM 8100-SEND-DATA-ONLY                          11880025
051000             PERFORM 8200-RETURN-TRANID                           11890025
051100     END-EVALUATE.                                                11900025
051200                                                                  11910025
051300                                                                  11920025
      * 10/16/13 DRW END                                                11930008
051400******************************************************************11940008
051500* 2400-GET-EXP-QTY                                               *11950008
051600*    SELECT THE QUANTITY EXPECTED IN THE CARTON                  *11960008
051700******************************************************************11970008
051800 2400-GET-EXP-QTY.                                                11980008
051900                                                                  11990008
052000     MOVE SU006-SHIP-UNIT-NBR   TO DK-SHIP-UNIT-NBR.              12000008
052100                                                                  12010008
052200     EXEC SQL                                                     12020008
052300          SELECT SUM(SHPD_QTY)                                    12030008
052400            INTO :PV-EXP-QTY                                      12040008
052500            FROM TSHUUPC                                          12050008
052600            WHERE SHIPT_UNT_ID = :DK-SHIP-UNIT-NBR                12060008
052700     END-EXEC.                                                    12070008
052800                                                                  12080008
052900     IF SQLCODE = ZERO                                            12090008
053000         COMPUTE PV-TWICE-EXP-QTY  = PV-EXP-QTY * 2               12100008
053100     ELSE                                                         12110008
053200        IF SQLCODE = +100 OR                                      12120008
053300           SQLCODE = -305                                         12130008
053400           MOVE ZERO          TO PV-EXP-QTY                       12140008
053500        ELSE                                                      12150008
053600             MOVE '2400-GET-EXP-QTY'                              12160008
053700                                         TO DP013-PARAGRAPH       12170008
053800             MOVE 'SELECT OF TSHUUPC'    TO DP013-MESSAGE-TEXT (1)12180008
053900             MOVE DK-SHIP-UNIT-NBR       TO DP013-MESSAGE-TEXT (2)12190008
054000             MOVE SQLCA                  TO DP013-SQLCA           12200008
054100             MOVE 'TSHUUPC'            TO DP013-DB2-TABLE-NAME (1)12210008
054200             SET DP013-DB2-ABEND         TO TRUE                  12220008
054300             SET DP013-NO-ROLLBACK       TO TRUE                  12230008
054400             PERFORM 9999-WRITE-CICS-LOG-MSG                      12240008
054500                                                                  12250008
054600             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               12260008
054700             MOVE -1                     TO AUPCQTYL              12270008
054800             PERFORM 8100-SEND-DATA-ONLY                          12280008
054900             PERFORM 8200-RETURN-TRANID                           12290008
055000        END-IF                                                    12300008
055100     END-IF.                                                      12310008
055200                                                                  12320008
055300                                                                  12330008
055400******************************************************************12340008
055500*  2500-GET-MAX-QTY                                              *12350008
055600*  GET THE MAXIMUM UNIT QTY FOR CARTON FROM PARM TABLE           *12360008
055700******************************************************************12370008
055800 2500-GET-MAX-QTY.                                                12380008
055900                                                                  12390008
056000     EXEC SQL                                                     12400008
056100          SELECT FUNC_QTY                                         12410008
056200            INTO :KRPRPM-FUNC-QTY                                 12420008
056300            FROM TKRPRPM                                          12430008
056400           WHERE LOC_ID            = 90                           12440008
056500             AND INTFC_SYS_CDE    = 'KHL'                         12450008
056600             AND SYS_PRC_FUNC_CDE = 'AUDMXQ'                      12460008
056700             AND FUNC_PRC_STAT_CDE = 'AC'                         12470008
056800     END-EXEC.                                                    12480008
056900                                                                  12490008
057000     EVALUATE TRUE                                                12500008
057100         WHEN SQLCODE = ZERO                                      12510008
057200              CONTINUE                                            12520008
057300                                                                  12530008
057400         WHEN OTHER                                               12540008
057500             MOVE '2500-GET-MAX-QTY'                              12550008
057600                                         TO DP013-PARAGRAPH       12560008
057700             MOVE 'SELECT OF TKRPRPM-AUDMXQ'                      12570008
057800                                         TO DP013-MESSAGE-TEXT (1)12580008
057900             MOVE SQLCA                  TO DP013-SQLCA           12590008
058000             MOVE 'TKRPRPM'            TO DP013-DB2-TABLE-NAME (1)12600008
058100             SET DP013-DB2-ABEND         TO TRUE                  12610008
058200             SET DP013-NO-ROLLBACK       TO TRUE                  12620008
058300             PERFORM 9999-WRITE-CICS-LOG-MSG                      12630008
058400                                                                  12640008
058500             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               12650008
058600             MOVE -1                     TO AUPCQTYL              12660008
058700             PERFORM 8100-SEND-DATA-ONLY                          12670008
058800             PERFORM 8200-RETURN-TRANID                           12680008
058900     END-EVALUATE.                                                12690008
059000                                                                  12700008
059100 4200-XCTL-TO-HELP.                                               12710008
059200                                                                  12720008
059300     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      12730008
059400     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    12740008
059500     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    12750008
059600                                                                  12760008
059700     EXEC CICS                                                    12770008
059800         XCTL                                                     12780008
059900             PROGRAM   (PV-TRANSFER-PROGRAM)                      12790008
060000             COMMAREA  (PC192-COMMAREA)                           12800008
060100             LENGTH    (PV-COMMAREA-LENGTH)                       12810008
060200             RESP      (PV-CICS-RESPONSE)                         12820008
060300     END-EXEC.                                                    12830008
060400                                                                  12840008
060500     EVALUATE TRUE                                                12850008
060600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12860008
060700              CONTINUE                                            12870008
060800         WHEN OTHER                                               12880008
060900             MOVE '4200-XCTL-TO-HELP '                            12890008
061000                 TO DP013-PARAGRAPH                               12900008
061100             MOVE 'SUKRF537 - UNABLE TO XCTL TO PROGRAM: '        12910008
061200                 TO DP013-MESSAGE-TEXT (1)                        12920008
061300             MOVE PV-TRANSFER-PROGRAM                             12930008
061400                 TO DP013-MESSAGE-TEXT (2)                        12940008
061500             SET DP013-CICS-ABEND  TO TRUE                        12950008
061600             SET DP013-ROLLBACK TO TRUE                           12960008
061700             PERFORM 9999-WRITE-CICS-LOG-MSG                      12970008
061800             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             12980008
061900             SET SU006-PROCESS-SCREEN TO TRUE                     12990008
062000             PERFORM 8000-SEND-MAP                                13000008
062100             PERFORM 8200-RETURN-TRANID                           13010008
062200     END-EVALUATE.                                                13020008
062300                                                                  13030008
062400******************************************************************13040008
062500*  8000-SEND-MAP                                                 *13050008
062600*  SEND THE REFRESHED MAP IMAGE TO THE SCREEN                    *13060008
062700******************************************************************13070008
062800 8000-SEND-MAP.                                                   13080008
062900     EXEC CICS                                                    13090008
063000         SEND                                                     13100008
063100             MAP     ('SU537A')                                   13110008
063200             MAPSET  ('SUKM537')                                  13120008
063300             ERASE                                                13130008
063400             RESP    (PV-CICS-RESPONSE)                           13140008
063500     END-EXEC.                                                    13150008
063600                                                                  13160008
063700     EVALUATE TRUE                                                13170008
063800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13180008
063900             CONTINUE                                             13190008
064000         WHEN OTHER                                               13200008
064100             MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH            13210008
064200             MOVE 'UNABLE TO SEND MAP'                            13220008
064300                                    TO DP013-MESSAGE-TEXT (1)     13230008
064400             SET DP013-CICS-ABEND   TO TRUE                       13240008
064500             SET DP013-NO-ROLLBACK  TO TRUE                       13250008
064600             PERFORM 9999-WRITE-CICS-LOG-MSG                      13260008
064700     END-EVALUATE.                                                13270008
064800*                                                                 13280008
064900 8100-SEND-DATA-ONLY.                                             13290008
065000                                                                  13300008
065100     EXEC CICS                                                    13310008
065200         SEND                                                     13320008
065300             MAP       ('SU537A')                                 13330008
065400             MAPSET    ('SUKM537')                                13340008
065500             CURSOR                                               13350008
065600             DATAONLY                                             13360008
065700             RESP      (PV-CICS-RESPONSE)                         13370008
065800     END-EXEC.                                                    13380008
065900                                                                  13390008
066000     EVALUATE TRUE                                                13400008
066100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13410008
066200             CONTINUE                                             13420008
066300         WHEN OTHER                                               13430008
066400             MOVE '8100-SEND-DATA-ONLY'                           13440008
066500                                    TO DP013-PARAGRAPH            13450008
066600             MOVE 'UNABLE TO SEND DATA'                           13460008
066700                                    TO DP013-MESSAGE-TEXT (1)     13470008
066800             SET DP013-CICS-ABEND   TO TRUE                       13480008
066900             SET DP013-NO-ROLLBACK  TO TRUE                       13490008
067000             PERFORM 9999-WRITE-CICS-LOG-MSG                      13500008
067100     END-EVALUATE.                                                13510008
067200*                                                                 13520008
067300 8200-RETURN-TRANID.                                              13530008
067400     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          13540008
067500                                                                  13550008
067600     EXEC CICS                                                    13560008
067700         RETURN                                                   13570008
067800             TRANSID   (PC-CURRENT-TRANID)                        13580008
067900             COMMAREA  (CA-COMMAREA)                              13590008
068000             LENGTH    (PV-COMMAREA-LENGTH)                       13600008
068100             RESP      (PV-CICS-RESPONSE)                         13610008
068200     END-EXEC.                                                    13620008
068300                                                                  13630008
068400     EVALUATE TRUE                                                13640008
068500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13650008
068600             CONTINUE                                             13660008
068700         WHEN OTHER                                               13670008
068800             MOVE '8200-RETURN-TRANID'                            13680008
068900                                    TO DP013-PARAGRAPH            13690008
069000             MOVE 'UNABLE TO RETURN TO TRANID'                    13700008
069100                                    TO DP013-MESSAGE-TEXT (1)     13710008
069200             SET DP013-CICS-ABEND   TO TRUE                       13720008
069300             SET DP013-NO-ROLLBACK  TO TRUE                       13730008
069400             PERFORM 9999-WRITE-CICS-LOG-MSG                      13740008
069500     END-EVALUATE.                                                13750008
069600*                                                                 13760008
069700*                                                                 13770008
069800 9999-WRITE-CICS-LOG-MSG.                                         13780008
069900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            13790008
070000     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           13800008
070100     INITIALIZE DP013-SRC-TASK-NUMBER                             13810008
070200                DP013-STACK.                                      13820008
070300     SET DP013-LINK-RETURN           TO TRUE.                     13830008
070400                                                                  13840008
070500     EXEC CICS                                                    13850008
070600         LINK                                                     13860008
070700             PROGRAM   (DP013-NAME)                               13870008
070800             COMMAREA  (DP013-PARAMETERS)                         13880008
070900             LENGTH    (DP013-LENGTH)                             13890008
071000     END-EXEC.                                                    13900008
071100                                                                  13910008
071200*----------------------------------------------------------------*13920008
071300*    ABEND PROCESSOR MODULE                                      *13930008
071400*----------------------------------------------------------------*13940008
071500                                                                  13950008
071600     COPY DPPD014.                                                13960008
071700                                                                  13970008
