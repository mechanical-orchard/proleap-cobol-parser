000100*************************                                         07/31/95
000200 IDENTIFICATION DIVISION.                                         MRKRP010
000300*************************                                            LV021
000400 PROGRAM-ID.      MRKRP010.                                       MRKRP010
000500 AUTHOR.          CHRISTINE FOLEY.                                MRKRP010
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        MRKRP010
000700 DATE-WRITTEN.    05/XX/93.                                       MRKRP010
000800 DATE-COMPILED.                                                   MRKRP010
000900****************************************************************  MRKRP010
001000* THIS PROGRAM WILL PRINT TWO REPORTS. THE DEMAND EXCEPTIONS   *  MRKRP010
001100* FOR A GIVEN PTAG WITHIN A DEPARTMENT AND A SUMMARY BASED ON  *  MRKRP010
001200* ALL OF THE PTAGS FOR A GIVEN DEPARTMENT.                     *  MRKRP010
001300****************************************************************  MRKRP010
001310* 05-02-2002  DON TOMLINSON  MR PHASE 4 NI-SKU CHANGES         *  MRKRP010
001311*      CHANGED REPORT TO ZERO SUPPRESS THE DEPARTMENT FIELD.   *  MRKRP010
001320****************************************************************  MRKRP010
001400*                                                                 MRKRP010
001500 ENVIRONMENT DIVISION.                                            MRKRP010
001600*                                                                 MRKRP010
001700*                                                                 MRKRP010
001800 CONFIGURATION SECTION.                                           MRKRP010
001900 SOURCE-COMPUTER. IBM-3090.                                       MRKRP010
002000 OBJECT-COMPUTER. IBM-3090.                                       MRKRP010
002100*                                                                 MRKRP010
002200*                                                                 MRKRP010
002300 INPUT-OUTPUT SECTION.                                            MRKRP010
002400 FILE-CONTROL.                                                    MRKRP010
002500                                                                  MRKRP010
002600     SELECT DEMAND-EXCEPT-FILE                                    MRKRP010
002700         ASSIGN                       TO INP01.                   MRKRP010
002800                                                                  MRKRP010
002900     SELECT DEMAND-EXCEPT-DETAIL-REPORT                           MRKRP010
003000         ASSIGN                       TO RPT01.                   MRKRP010
003100                                                                  MRKRP010
003200     SELECT DEMAND-EXCEPT-SUMMARY-REPORT                          MRKRP010
003300         ASSIGN                       TO RPT02.                   MRKRP010
003400                                                                  MRKRP010
003500     EJECT                                                        MRKRP010
003600*                                                                 MRKRP010
003700*                                                                 MRKRP010
003800*                                                                 MRKRP010
003900***************                                                   MRKRP010
004000 DATA DIVISION.                                                   MRKRP010
004100***************                                                   MRKRP010
004200*                                                                 MRKRP010
004300*                                                                 MRKRP010
004400 FILE SECTION.                                                    MRKRP010
004500                                                                  MRKRP010
004600 FD  DEMAND-EXCEPT-FILE                                           MRKRP010
004700     RECORDING MODE F                                             MRKRP010
004800     BLOCK CONTAINS 0 RECORDS                                     MRKRP010
004900     RECORD CONTAINS 333 CHARACTERS                                  CL*11
005000     LABEL RECORDS ARE OMITTED                                    MRKRP010
005100     DATA RECORD IS DEMAND-EXCEPT-RECS.                           MRKRP010
005200*                                                                 MRKRP010
005300 01  DEMAND-EXCEPT-RECS                              PIC X(333).     CL*10
005400                                                                  MRKRP010
005500 FD  DEMAND-EXCEPT-DETAIL-REPORT                                  MRKRP010
005600     RECORDING MODE F                                             MRKRP010
005700     BLOCK CONTAINS 0 RECORDS                                     MRKRP010
005800     RECORD CONTAINS 132 CHARACTERS                               MRKRP010
005900     LABEL RECORDS ARE OMITTED                                    MRKRP010
006000     DATA RECORD IS PRINT-DETAIL-LINE.                            MRKRP010
006100*                                                                 MRKRP010
006200 01  PRINT-DETAIL-LINE                               PIC X(132).  MRKRP010
006300                                                                  MRKRP010
006400 FD  DEMAND-EXCEPT-SUMMARY-REPORT                                 MRKRP010
006500     RECORDING MODE F                                             MRKRP010
006600     BLOCK CONTAINS 0 RECORDS                                     MRKRP010
006700     RECORD CONTAINS 132 CHARACTERS                               MRKRP010
006800     LABEL RECORDS ARE OMITTED                                    MRKRP010
006900     DATA RECORD IS PRINT-SUMMARY-LINE.                           MRKRP010
007000*                                                                 MRKRP010
007100 01  PRINT-SUMMARY-LINE                              PIC X(132).  MRKRP010
007200                                                                  MRKRP010
007300     EJECT                                                        MRKRP010
007400*                                                                 MRKRP010
007500 WORKING-STORAGE SECTION.                                         MRKRP010
007600*                                                                 MRKRP010
007700****************************************************************  MRKRP010
007800** STANDARD HEADER LINE - KOHLS 132 COL                        *  MRKRP010
007900****************************************************************  MRKRP010
008000     COPY DPWS132.                                                MRKRP010
008100****************************************************************  MRKRP010
008200** COPYBOOKS FOR THE CALENDAR ROUTINE                          *  MRKRP010
008300****************************************************************  MRKRP010
008400     COPY DPWS024.                                                MRKRP010
008500     EJECT                                                        MRKRP010
008600*                                                                 MRKRP010
008700 01 PV-PROGRAM-VARIABLES.                                         MRKRP010
008800                                                                  MRKRP010
008900     05 PV-DEPT-CONVERT-X-3           PIC X(03).                        12
008901     05 PV-DEPT-CONVERT-9-3 REDEFINES PV-DEPT-CONVERT-X-3               12
008902                                      PIC 9(03).                          
008903                                                                          
008910     05 PV-PREV-GMM-NMBR              PIC 9(01)      VALUE ZERO.     CL*12
009000     05 PV-PREV-DMM-NMBR              PIC 9(03)      VALUE ZERO.     CL*12
009100     05 PV-PREV-DEPT-NMBR             PIC X(03)      VALUE SPACES.MRKRP010
009200     05 PV-PREV-PTAG-ID               PIC X(07)      VALUE SPACES.MRKRP010
009300     05 PV-DETAIL-SUB                 PIC 9(01)      VALUE ZERO.  MRKRP010
009400     05 PV-SUMM-SUB                   PIC 9(01)      VALUE ZERO.  MRKRP010
009500     05 PV-GMA-NBR                    PIC 9(02).                     CL*21
009600     05 PV-GMA-NBR-X REDEFINES PV-GMA-NBR.                           CL*20
009700        10 PV-GMA-NBR-DB2             PIC X(02).                     CL*20
009800                                                                     CL*17
009900     05 PV-DMA-NBR                    PIC 9(03).                     CL*18
010000     05 PV-DMA-NBR-X REDEFINES PV-DMA-NBR.                           CL*17
010100        10 FILLER                     PIC X(01).                     CL*19
010200        10 PV-DMA-NBR-DB2             PIC X(02).                     CL*19
010300                                                                  MRKRP010
010400     05  PV-CALENDAR-DAYS             PIC 9(03).                  MRKRP010
010500     05  PV-DAY-NUMBER                PIC S9(1)      COMP-3.      MRKRP010
010600                                                                  MRKRP010
010700     05  PV-FIRST-DATE.                                           MRKRP010
010800         10  PV-FIRST-MO              PIC 9(2).                   MRKRP010
010900         10  FILLER                   PIC X(1)       VALUE '/'.   MRKRP010
011000         10  PV-FIRST-DY              PIC 9(2).                   MRKRP010
011100         10  FILLER                   PIC X(1)       VALUE '/'.   MRKRP010
011200         10  PV-FIRST-YR              PIC 9(2).                   MRKRP010
011300                                                                  MRKRP010
011400 01  PV-TOTAL-VARIABLES.                                          MRKRP010
011500     05  PV-TOTAL-NBR-ITEMS           PIC S9(09)     COMP-3.      MRKRP010
011600     05  PV-TOTAL-ITEMS-STORES        PIC S9(09)     COMP-3.      MRKRP010
011700     05  PV-TOTAL-DEMAND-HISTORY OCCURS 5 TIMES.                  MRKRP010
011800         10  PV-DEREG-CODE            PIC X.                      MRKRP010
011900         10  PV-TTL-NBR-ITEMS-CURR    PIC S9(09)     COMP-3.      MRKRP010
012000         10  PV-TTL-PCT-TRIPS-CURR    PIC S9(05)V999 COMP-3.      MRKRP010
012100         10  PV-TTL-NBR-ITEMS-1-WK    PIC S9(09)     COMP-3.      MRKRP010
012200         10  PV-TTL-PCT-TRIPS-1-WK    PIC S9(05)V999 COMP-3.      MRKRP010
012300         10  PV-TTL-NBR-ITEMS-2-WK    PIC S9(09)     COMP-3.      MRKRP010
012400         10  PV-TTL-PCT-TRIPS-2-WK    PIC S9(05)V999 COMP-3.      MRKRP010
012500         10  PV-TTL-NBR-ITEMS-3-WK    PIC S9(09)     COMP-3.      MRKRP010
012600         10  PV-TTL-PCT-TRIPS-3-WK    PIC S9(05)V999 COMP-3.      MRKRP010
012700         10  PV-TTL-NBR-ITEMS-4-WK    PIC S9(09)     COMP-3.      MRKRP010
012800         10  PV-TTL-AVG-ITEMS-4-WK    PIC S9(05)V999 COMP-3.      MRKRP010
012900         10  PV-TTL-PCT-TRIPS-4-WK    PIC S9(05)V999 COMP-3.      MRKRP010
013000                                                                  MRKRP010
013100     05  PV-TOTAL-NBR-ITEMS-CURR      PIC S9(09)     COMP-3.      MRKRP010
013200     05  PV-TOTAL-PCT-TRIPS-CURR      PIC S9(05)V999 COMP-3.      MRKRP010
013300     05  PV-TOTAL-NBR-ITEMS-1-WK      PIC S9(09)     COMP-3.      MRKRP010
013400     05  PV-TOTAL-PCT-TRIPS-1-WK      PIC S9(05)V999 COMP-3.      MRKRP010
013500     05  PV-TOTAL-NBR-ITEMS-2-WK      PIC S9(09)     COMP-3.      MRKRP010
013600     05  PV-TOTAL-PCT-TRIPS-2-WK      PIC S9(05)V999 COMP-3.      MRKRP010
013700     05  PV-TOTAL-NBR-ITEMS-3-WK      PIC S9(09)     COMP-3.      MRKRP010
013800     05  PV-TOTAL-PCT-TRIPS-3-WK      PIC S9(05)V999 COMP-3.      MRKRP010
013900     05  PV-TOTAL-NBR-ITEMS-4-WK      PIC S9(09)     COMP-3.      MRKRP010
014000     05  PV-TOTAL-AVG-ITEMS-4-WK      PIC S9(05)V999 COMP-3.      MRKRP010
014100     05  PV-TOTAL-PCT-TRIPS-4-WK      PIC S9(05)V999 COMP-3.      MRKRP010
014200                                                                  MRKRP010
014300 01  PV-PAGE-LINE-COUNTERS.                                       MRKRP010
014400     05  PV-LINE-CNT-1                PIC S9(3)      VALUE +0     MRKRP010
014500                                                     COMP-3.      MRKRP010
014600     05  PV-PAGE-CNT-1                PIC 9(3)       VALUE ZEROS  MRKRP010
014700                                                     COMP-3.      MRKRP010
014800     05  PV-LINE-CNT-2                PIC S9(3)      VALUE +0     MRKRP010
014900                                                     COMP-3.      MRKRP010
015000     05  PV-PAGE-CNT-2                PIC 9(3)       VALUE ZEROS  MRKRP010
015100                                                     COMP-3.      MRKRP010
015200     05  PV-ABEND-PARAGRAPH           PIC X(30)      VALUE SPACES.MRKRP010
015300*                                                                 MRKRP010
015400 01  ERROR-MESSAGES.                                              MRKRP010
015500     05 FILLER                        PIC X(46)      VALUE        MRKRP010
015600        'ERROR DETAIL RECORD NOT FOUND FOR REF-NO   #: '.         MRKRP010
015700     05 ERROR-REF-NO                  PIC X(21).                  MRKRP010
015800     05 FILLER                        PIC X(72)      VALUE SPACES.MRKRP010
015900*                                                                 MRKRP010
016000 01  PV-ABEND-CODE                    PIC S9(04)     VALUE +0     MRKRP010
016100                                                     COMP SYNC.   MRKRP010
016200     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. MRKRP010
016300     88  ABEND-4002-READ-ERROR                       VALUE +4002. MRKRP010
016400     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. MRKRP010
016500     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. MRKRP010
016600     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. MRKRP010
016700     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. MRKRP010
016800     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. MRKRP010
016900     88  ABEND-4008-DATA-ERROR                       VALUE +4008. MRKRP010
017000     88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. MRKRP010
017300     88  ABEND-4013-DB2-ERROR                        VALUE +4013. MRKRP010
017400*                                                                 MRKRP010
017500 01  CD-CPU-DATE.                                                    CL*23
017600     05  CD-CPU-FULL-YEAR.                                                
017700         10  CD-CPU-CC                PIC 9(2)     VALUE ZEROS.           
017800         10  CD-CPU-YR                PIC 9(2)     VALUE ZEROS.      CL*23
017900     05  CD-CPU-MO                    PIC 9(2)     VALUE ZEROS.      CL*23
018000     05  CD-CPU-DY                    PIC 9(2)     VALUE ZEROS.      CL*23
018100                                                                     CL*23
018200******************************************************************   CL*31
018300 01  CD-NUMERIC-DATE REDEFINES CD-CPU-DATE.                               
018400     05  CD-CPU-NUMERIC-DATE          PIC 9(8).                           
018500******************************************************************   CL*31
018600                                                                          
018700 01  CT-CPU-TIME.                                                 MRKRP010
018800     05  CT-CPU-HR                    PIC 9(2)       VALUE ZEROS. MRKRP010
018900     05  CT-CPU-MIN                   PIC 9(2)       VALUE ZEROS. MRKRP010
019000     05  CT-CPU-SEC                   PIC 9(2)       VALUE ZEROS. MRKRP010
019100     05  CT-CPU-HSEC                  PIC 9(2)       VALUE ZEROS. MRKRP010
019200*                                                                 MRKRP010
019300 01  END-OF-REPORT-LINE.                                          MRKRP010
019400     05  FILLER                       PIC X(25)      VALUE        MRKRP010
019500         ' ** END OF REPORT **     '.                             MRKRP010
019600*                                                                 MRKRP010
019700 01  NO-DATA-REPORT-LINE.                                         MRKRP010
019800     05  FILLER                       PIC X(51)      VALUE        MRKRP010
019900         '** NO PTAGS WITHIN TOLERENCE FOR THIS DEPARTMENT **'.   MRKRP010
020000*                                                                 MRKRP010
020100 01  HL-HEADING-BLANK.                                            MRKRP010
020200     05  FILLER                       PIC X(20)      VALUE        MRKRP010
020300         '                    '.                                  MRKRP010
020400*                                                                 MRKRP010
020500 01  HL-HEADING-LINE1.                                            MRKRP010
020600     05  FILLER                       PIC X(53)      VALUE SPACE. MRKRP010
020700     05  FILLER                       PIC X(31)      VALUE        MRKRP010
020800         'DEMAND EXCEPTION DETAIL REPORT '.                       MRKRP010
020900     05  FILLER                       PIC X(48)      VALUE SPACE. MRKRP010
021000*                                                                 MRKRP010
021100 01  HL-HEADING-LINE1A.                                           MRKRP010
021200     05  FILLER                       PIC X(53)      VALUE SPACE. MRKRP010
021300     05  FILLER                       PIC X(31)      VALUE        MRKRP010
021400         'DEMAND EXCEPTION SUMMARY REPORT'.                       MRKRP010
021500     05  FILLER                       PIC X(48)      VALUE SPACE. MRKRP010
021600*                                                                 MRKRP010
021700 01  HL-HEADING-LINE2.                                            MRKRP010
021800     05  FILLER                       PIC X(02)      VALUE SPACES.   CL**2
021900     05  FILLER                       PIC X(05)      VALUE           CL**2
022000         'GMM: '.                                                    CL**2
022100     05  HL2-GMM-NMBR                 PIC 9(01).                     CL**7
022200     05  FILLER                       PIC X(02)      VALUE SPACES.   CL**2
022300     05  HL2-GMM-NAME                 PIC X(20).                     CL**2
022400     05  FILLER                       PIC X(02)      VALUE SPACES.   CL**2
022500     05  FILLER                       PIC X(05)      VALUE           CL**2
022600         'DMM: '.                                                    CL**2
022700     05  HL2-DMM-NMBR                 PIC 9(03).                     CL**7
022800     05  FILLER                       PIC X(02)      VALUE SPACES.   CL**2
022900     05  HL2-DMM-NAME                 PIC X(20).                     CL**2
023000     05  FILLER                       PIC X(02)      VALUE SPACES.   CL**2
023100     05  FILLER                       PIC X(12)      VALUE        MRKRP010
023200         'DEPARTMENT: '.                                          MRKRP010
023300     05  HL2-DEPT-NO                  PIC Z(03).                  MRKRP010
023400     05  FILLER                       PIC X(02)      VALUE SPACES.MRKRP010
023500     05  HL2-DEPT-DESC                PIC X(25).                  MRKRP010
023600     05  FILLER                       PIC X(26)      VALUE SPACES.   CL**2
023700*                                                                 MRKRP010
023800 01  HL-HEADING-LINE3.                                            MRKRP010
023900     05  FILLER                       PIC X(02)      VALUE SPACES.MRKRP010
024000     05  FILLER                       PIC X(6)       VALUE        MRKRP010
024100         'PTAG: '.                                                MRKRP010
024200     05  HL3-PTAG-NO                  PIC X(07).                  MRKRP010
024300     05  FILLER                       PIC X(26)      VALUE SPACES.MRKRP010
024400     05  FILLER                       PIC X(18)      VALUE        MRKRP010
024500         'NUMBER OF ITEMS:  '.                                    MRKRP010
024600     05  HL3-NBR-ITEMS                PIC ZZZ,ZZ9.                MRKRP010
024700     05  FILLER                       PIC X(09)      VALUE SPACES.MRKRP010
024800     05  FILLER                       PIC X(25)      VALUE        MRKRP010
024900         'NUMBER OF ITEMS/STORES:  '.                             MRKRP010
025000     05  HL3-NBR-ITEMS-STORES         PIC ZZZ,ZZ9.                MRKRP010
025100     05  FILLER                       PIC X(25)      VALUE SPACES.MRKRP010
025200*                                                                 MRKRP010
025300 01  HL-HEADING-LINE4.                                            MRKRP010
025400     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
025500     05  FILLER                       PIC X(13)      VALUE        MRKRP010
025600         'DEMAND FILTER'.                                         MRKRP010
025700     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
025800     05  FILLER                       PIC X(14)      VALUE        MRKRP010
025900         'CURRENT DD UPD'.                                        MRKRP010
026000     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
026100     05  FILLER                       PIC X(15)      VALUE        MRKRP010
026200         'DD UPD - 1 WEEK'.                                       MRKRP010
026300     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
026400     05  FILLER                       PIC X(16)      VALUE        MRKRP010
026500         'DD UPD - 2 WEEKS'.                                      MRKRP010
026600     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
026700     05  FILLER                       PIC X(16)      VALUE        MRKRP010
026800         'DD UPD - 3 WEEKS'.                                      MRKRP010
026900     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
027000     05  FILLER                       PIC X(10)      VALUE        MRKRP010
027100         '4 WEEK AVG'.                                            MRKRP010
027200     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
027300*                                                                 MRKRP010
027400 01  HL-HEADING-LINE5.                                            MRKRP010
027500     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
027600     05  FILLER                       PIC X(08)      VALUE        MRKRP010
027700         'REGISTER'.                                              MRKRP010
027800     05  FILLER                       PIC X(10)      VALUE SPACES.MRKRP010
027900     05  FILLER                       PIC X(03)      VALUE        MRKRP010
028000         'NBR'.                                                   MRKRP010
028100     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
028200     05  FILLER                       PIC X(05)      VALUE        MRKRP010
028300         '% TOT'.                                                 MRKRP010
028400     05  FILLER                       PIC X(08)      VALUE SPACES.MRKRP010
028500     05  FILLER                       PIC X(03)      VALUE        MRKRP010
028600         'NBR'.                                                   MRKRP010
028700     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
028800     05  FILLER                       PIC X(05)      VALUE        MRKRP010
028900         '% TOT'.                                                 MRKRP010
029000     05  FILLER                       PIC X(08)      VALUE SPACES.MRKRP010
029100     05  FILLER                       PIC X(03)      VALUE        MRKRP010
029200         'NBR'.                                                   MRKRP010
029300     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
029400     05  FILLER                       PIC X(05)      VALUE        MRKRP010
029500         '% TOT'.                                                 MRKRP010
029600     05  FILLER                       PIC X(08)      VALUE SPACES.MRKRP010
029700     05  FILLER                       PIC X(03)      VALUE        MRKRP010
029800         'NBR'.                                                   MRKRP010
029900     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
030000     05  FILLER                       PIC X(05)      VALUE        MRKRP010
030100         '% TOT'.                                                 MRKRP010
030200     05  FILLER                       PIC X(08)      VALUE SPACES.MRKRP010
030300     05  FILLER                       PIC X(03)      VALUE        MRKRP010
030400         'NBR'.                                                   MRKRP010
030500     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
030600     05  FILLER                       PIC X(05)      VALUE        MRKRP010
030700         '% TOT'.                                                 MRKRP010
030800*                                                                 MRKRP010
030900 01  HL-HEADING-LINE6.                                            MRKRP010
031000     05  FILLER                       PIC X(13)      VALUE SPACES.MRKRP010
031100     05  FILLER                       PIC X(06)      VALUE        MRKRP010
031200         'NBR OF'.                                                MRKRP010
031300     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
031400     05  FILLER                       PIC X(06)      VALUE        MRKRP010
031500         'NBR OF'.                                                MRKRP010
031600     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
031700     05  FILLER                       PIC X(14)      VALUE        MRKRP010
031800         'CURRENT DD UPD'.                                        MRKRP010
031900     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
032000     05  FILLER                       PIC X(15)      VALUE        MRKRP010
032100         'DD UPD - 1 WEEK'.                                       MRKRP010
032200     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
032300     05  FILLER                       PIC X(16)      VALUE        MRKRP010
032400         'DD UPD - 2 WEEKS'.                                      MRKRP010
032500     05  FILLER                       PIC X(04)      VALUE SPACES.MRKRP010
032600     05  FILLER                       PIC X(16)      VALUE        MRKRP010
032700         'DD UPD - 3 WEEKS'.                                      MRKRP010
032800     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
032900     05  FILLER                       PIC X(10)      VALUE        MRKRP010
033000         '4 WEEK AVG'.                                            MRKRP010
033100     05  FILLER                       PIC X(10)      VALUE SPACES.MRKRP010
033200*                                                                 MRKRP010
033300 01  HL-HEADING-LINE7.                                            MRKRP010
033400     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
033500     05  FILLER                       PIC X(04)      VALUE        MRKRP010
033600         'PTAG'.                                                  MRKRP010
033700     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
033800     05  FILLER                       PIC X(05)      VALUE        MRKRP010
033900         'ITEMS'.                                                 MRKRP010
034000     05  FILLER                       PIC X(04)      VALUE SPACES.MRKRP010
034100     05  FILLER                       PIC X(07)      VALUE        MRKRP010
034200         'ITM/STR'.                                               MRKRP010
034300     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
034400     05  FILLER                       PIC X(14)      VALUE        MRKRP010
034500         'NBR      % TOT'.                                        MRKRP010
034600     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
034700     05  FILLER                       PIC X(14)      VALUE        MRKRP010
034800         'NBR      % TOT'.                                        MRKRP010
034900     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
035000     05  FILLER                       PIC X(14)      VALUE        MRKRP010
035100         'NBR      % TOT'.                                        MRKRP010
035200     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
035300     05  FILLER                       PIC X(14)      VALUE        MRKRP010
035400         'NBR      % TOT'.                                        MRKRP010
035500     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
035600     05  FILLER                       PIC X(14)      VALUE        MRKRP010
035700         'NBR      % TOT'.                                        MRKRP010
035800     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
035900*                                                                 MRKRP010
036000 01  HL-HEADING-LINE8.                                            MRKRP010
036100     05  FILLER                       PIC X(02)      VALUE SPACES.MRKRP010
036200     05  FILLER                       PIC X(16)      VALUE        MRKRP010
036300         'DEPARTMENT TOTAL'.                                      MRKRP010
036400     05  FILLER                       PIC X(23)      VALUE SPACES.MRKRP010
036500     05  FILLER                       PIC X(18)      VALUE        MRKRP010
036600         'NUMBER OF ITEMS:  '.                                    MRKRP010
036700     05  HL8-DEPT-NBR-ITEMS           PIC Z,ZZZ,ZZ9.              MRKRP010
036800     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
036900     05  FILLER                       PIC X(25)      VALUE        MRKRP010
037000         'NUMBER OF ITEMS/STORES:  '.                             MRKRP010
037100     05  HL8-DEPT-NBR-ITEMS-STORES    PIC Z,ZZZ,ZZ9.              MRKRP010
037200     05  FILLER                       PIC X(23)      VALUE SPACES.MRKRP010
037300*                                                                 MRKRP010
037400 01  HL-UNDERLINES-1.                                             MRKRP010
037500     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
037600     05  FILLER                       PIC X(13)      VALUE        MRKRP010
037700         '-------------' .                                        MRKRP010
037800     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
037900     05  FILLER                       PIC X(15)      VALUE        MRKRP010
038000         '---------------'.                                       MRKRP010
038100     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
038200     05  FILLER                       PIC X(15)      VALUE        MRKRP010
038300         '---------------'.                                       MRKRP010
038400     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
038500     05  FILLER                       PIC X(15)      VALUE        MRKRP010
038600         '---------------'.                                       MRKRP010
038700     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
038800     05  FILLER                       PIC X(15)      VALUE        MRKRP010
038900         '---------------'.                                       MRKRP010
039000     05  FILLER                       PIC X(07)      VALUE SPACES.MRKRP010
039100     05  FILLER                       PIC X(15)      VALUE        MRKRP010
039200         '---------------'.                                       MRKRP010
039300     05  FILLER                       PIC X(01)      VALUE SPACES.MRKRP010
039400*                                                                 MRKRP010
039500 01  HL-UNDERLINES-2.                                             MRKRP010
039600     05  FILLER                       PIC X(02)      VALUE SPACES.MRKRP010
039700     05  FILLER                       PIC X(07)      VALUE        MRKRP010
039800         '-------' .                                              MRKRP010
039900     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
040000     05  FILLER                       PIC X(07)      VALUE        MRKRP010
040100         '-------'.                                               MRKRP010
040200     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
040300     05  FILLER                       PIC X(07)      VALUE        MRKRP010
040400         '-------'.                                               MRKRP010
040500     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
040600     05  FILLER                       PIC X(15)      VALUE        MRKRP010
040700         '---------------'.                                       MRKRP010
040800     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
040900     05  FILLER                       PIC X(15)      VALUE        MRKRP010
041000         '---------------'.                                       MRKRP010
041100     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
041200     05  FILLER                       PIC X(15)      VALUE        MRKRP010
041300         '---------------'.                                       MRKRP010
041400     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
041500     05  FILLER                       PIC X(15)      VALUE        MRKRP010
041600         '---------------'.                                       MRKRP010
041700     05  FILLER                       PIC X(05)      VALUE SPACES.MRKRP010
041800     05  FILLER                       PIC X(15)      VALUE        MRKRP010
041900         '---------------'.                                       MRKRP010
042000     05  FILLER                       PIC X(03)      VALUE SPACES.MRKRP010
042100*                                                                 MRKRP010
042200 01  DTL-DIVIDING-LINES.                                          MRKRP010
042300     05  FILLER                       PIC X(54)      VALUE        MRKRP010
042400         '------------------------------------------------------'.MRKRP010
042500     05  FILLER                       PIC X(54)      VALUE        MRKRP010
042600         '------------------------------------------------------'.MRKRP010
042700     05  FILLER                       PIC X(24)      VALUE        MRKRP010
042800         '------------------------'.                              MRKRP010
042900*                                                                 MRKRP010
043000 01  DETAIL-LINE-1.                                               MRKRP010
043100     05  FILLER                       PIC X(05)      VALUE SPACE. MRKRP010
043200     05  PRT-DEMAND-REG               PIC X(09).                  MRKRP010
043300     05  FILLER                       PIC X(08)      VALUE SPACE. MRKRP010
043400     05  PRT-NBR-CURRENT              PIC ZZZ,ZZ9.                MRKRP010
043500     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
043600     05  PRT-PCT-CURRENT              PIC ZZ9.9.                  MRKRP010
043700     05  FILLER                       PIC X(07)      VALUE SPACE. MRKRP010
043800     05  PRT-NBR-1-WEEK               PIC ZZZ,ZZ9.                MRKRP010
043900     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
044000     05  PRT-PCT-1-WEEK               PIC ZZ9.9.                  MRKRP010
044100     05  FILLER                       PIC X(07)      VALUE SPACE. MRKRP010
044200     05  PRT-NBR-2-WEEK               PIC ZZZ,ZZ9.                MRKRP010
044300     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
044400     05  PRT-PCT-2-WEEK               PIC ZZ9.9.                  MRKRP010
044500     05  FILLER                       PIC X(07)      VALUE SPACE. MRKRP010
044600     05  PRT-NBR-3-WEEK               PIC ZZZ,ZZ9.                MRKRP010
044700     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
044800     05  PRT-PCT-3-WEEK               PIC ZZ9.9.                  MRKRP010
044900     05  FILLER                       PIC X(08)      VALUE SPACE. MRKRP010
045000     05  PRT-AVG-4-WEEK               PIC ZZZ9.9.                 MRKRP010
045100     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
045200     05  PRT-PCT-4-WEEK               PIC ZZ9.9.                  MRKRP010
045300*                                                                 MRKRP010
045400 01  DETAIL-LINE-2.                                               MRKRP010
045500     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
045600     05  PRT-PTAG-NUMBER              PIC X(07).                  MRKRP010
045700     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
045800     05  PRT-TTL-NBR-OF-ITEMS         PIC ZZZ,ZZ9.                MRKRP010
045900     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
046000     05  PRT-TTL-NBR-OF-ITEMS-STRS    PIC ZZZ,ZZ9.                MRKRP010
046100     05  FILLER                       PIC X(05)      VALUE SPACE. MRKRP010
046200     05  PRT-TTL-NBR-CURR             PIC ZZZ,ZZ9.                MRKRP010
046300     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
046400     05  PRT-TTL-PCT-CURR             PIC ZZ9.9.                  MRKRP010
046500     05  FILLER                       PIC X(05)      VALUE SPACE. MRKRP010
046600     05  PRT-TTL-NBR-1-WEEK           PIC ZZZ,ZZ9.                MRKRP010
046700     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
046800     05  PRT-TTL-PCT-1-WEEK           PIC ZZ9.9.                  MRKRP010
046900     05  FILLER                       PIC X(05)      VALUE SPACE. MRKRP010
047000     05  PRT-TTL-NBR-2-WEEK           PIC ZZZ,ZZ9.                MRKRP010
047100     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
047200     05  PRT-TTL-PCT-2-WEEK           PIC ZZ9.9.                  MRKRP010
047300     05  FILLER                       PIC X(05)      VALUE SPACE. MRKRP010
047400     05  PRT-TTL-NBR-3-WEEK           PIC ZZZ,ZZ9.                MRKRP010
047500     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
047600     05  PRT-TTL-PCT-3-WEEK           PIC ZZ9.9.                  MRKRP010
047700     05  FILLER                       PIC X(06)      VALUE SPACE. MRKRP010
047800     05  PRT-TTL-AVG-4-WEEK           PIC ZZZ9.9.                 MRKRP010
047900     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
048000     05  PRT-TTL-PCT-4-WEEK           PIC ZZ9.9.                  MRKRP010
048100     05  FILLER                       PIC X(03)      VALUE SPACE. MRKRP010
048200*                                                                 MRKRP010
048300 01  TOTAL-LINE1.                                                 MRKRP010
048400     05  FILLER                       PIC X(06)      VALUE SPACES.MRKRP010
048500     05  FILLER                       PIC X(07)      VALUE        MRKRP010
048600         'TOTAL: '.                                               MRKRP010
048700     05  FILLER                       PIC X(09)      VALUE SPACE. MRKRP010
048800     05  TOTAL-NBR-OCCUR-CURR         PIC ZZZ,ZZ9.                MRKRP010
048900     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
049000     05  TOTAL-PCT-TRIPS-CURR         PIC ZZZ9.9.                 MRKRP010
049100     05  FILLER                       PIC X(07)      VALUE SPACE. MRKRP010
049200     05  TOTAL-NBR-OCCUR-1-WK         PIC ZZZ,ZZ9.                MRKRP010
049300     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
049400     05  TOTAL-PCT-TRIPS-1-WK         PIC ZZZ9.9.                 MRKRP010
049500     05  FILLER                       PIC X(07)      VALUE SPACE. MRKRP010
049600     05  TOTAL-NBR-OCCUR-2-WK         PIC ZZZ,ZZ9.                MRKRP010
049700     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
049800     05  TOTAL-PCT-TRIPS-2-WK         PIC ZZZ9.9.                 MRKRP010
049900     05  FILLER                       PIC X(07)      VALUE SPACE. MRKRP010
050000     05  TOTAL-NBR-OCCUR-3-WK         PIC ZZZ,ZZ9.                MRKRP010
050100     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
050200     05  TOTAL-PCT-TRIPS-3-WK         PIC ZZZ9.9.                 MRKRP010
050300     05  FILLER                       PIC X(08)      VALUE SPACE. MRKRP010
050400     05  TOTAL-AVG-OCCUR-TOTAL        PIC ZZZ9.9.                 MRKRP010
050500     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
050600     05  TOTAL-PCT-TRIPS-TOTAL        PIC ZZZ9.9.                 MRKRP010
050700     05  FILLER                       PIC X(02)      VALUE SPACE. MRKRP010
050800*                                                                 MRKRP010
050900 01  PC-PROGRAM-CONSTANTS.                                        MRKRP010
051000     05  PC-Y                         PIC X(01)      VALUE 'Y'.   MRKRP010
051100     05  PC-N                         PIC X(01)      VALUE 'N'.   MRKRP010
051200     05  PC-D                         PIC X(01)      VALUE 'D'.   MRKRP010
051300     05  PC-H                         PIC X(01)      VALUE 'H'.   MRKRP010
051400     05  PC-I                         PIC X(01)      VALUE 'I'.   MRKRP010
051500     05  PC-L                         PIC X(01)      VALUE 'L'.   MRKRP010
051600     05  PC-U                         PIC X(01)      VALUE 'U'.   MRKRP010
051700     05  PC-D-DESC                    PIC X(09)                   MRKRP010
051800         VALUE 'D (LOPCT)'.                                       MRKRP010
051900     05  PC-H-DESC                    PIC X(09)                   MRKRP010
052000         VALUE 'H (HIDFL)'.                                       MRKRP010
052100     05  PC-I-DESC                    PIC X(09)                   MRKRP010
052200         VALUE 'I (IDFL )'.                                       MRKRP010
052300     05  PC-L-DESC                    PIC X(09)                   MRKRP010
052400         VALUE 'L (LODFL)'.                                       MRKRP010
052500     05  PC-U-DESC                    PIC X(09)                   MRKRP010
052600         VALUE 'U (HIPCT)'.                                       MRKRP010
052700     05  PC-DPT                       PIC X(03)      VALUE 'DPT'. MRKRP010
052800     05  PC-ONE                       PIC 9(01)      VALUE 1.     MRKRP010
052900     05  PC-TWO                       PIC 9(01)      VALUE 2.     MRKRP010
053000     05  PC-THREE                     PIC 9(01)      VALUE 3.     MRKRP010
053100     05  PC-FOUR                      PIC 9(01)      VALUE 4.     MRKRP010
053200     05  PC-FIVE                      PIC 9(01)      VALUE 5.     MRKRP010
053300     05  PC-PLUS-1                    PIC S9(1)      VALUE +1.    MRKRP010
053400     05  PC-PLUS-4                    PIC S9(1)      VALUE +4.    MRKRP010
053500     05  PC-MAX-LINES                 PIC S9(3)      VALUE +50    MRKRP010
053600                                                     COMP-3.      MRKRP010
053700     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   MRKRP010
053800                                                     COMP SYNC.   MRKRP010
053900     05  PC-DUPLICATE-ROW             PIC S9(04)     VALUE -811   MRKRP010
054000                                                     COMP SYNC.   MRKRP010
054100*                                                                 MRKRP010
054200 01  MSG-LINE1.                                                   MRKRP010
054300     05  FILLER                       PIC X(15)      VALUE SPACES.MRKRP010
054400     05  FILLER                       PIC X(48)                   MRKRP010
054500         VALUE 'L (LODFL) = ITEM/STORE SALES WERE LOWER THAN SET'.MRKRP010
054600     05  FILLER                       PIC X(24)                   MRKRP010
054700         VALUE ' LIMITS - DD NOT UPDATED'.                        MRKRP010
054800*                                                                 MRKRP010
054900 01  MSG-LINE2.                                                   MRKRP010
055000     05  FILLER                       PIC X(15)      VALUE SPACES.MRKRP010
055100     05  FILLER                       PIC X(46)                   MRKRP010
055200         VALUE 'H (HIDFL) = ITEM/STORE SALES WERE HIGHER THAN '.  MRKRP010
055300     05  FILLER                       PIC X(27)                   MRKRP010
055400         VALUE 'SET LIMITS - DD NOT UPDATED'.                     MRKRP010
055500*                                                                 MRKRP010
055600 01  MSG-LINE3.                                                   MRKRP010
055700     05  FILLER                       PIC X(15)      VALUE SPACES.MRKRP010
055800     05  FILLER                       PIC X(45)                   MRKRP010
055900         VALUE 'I (IDFL ) = INITIAL ITEM/STORE SALES WERE OUT'.   MRKRP010
056000     05  FILLER                       PIC X(42)                   MRKRP010
056100         VALUE 'SIDE SET LIMITS - DD IS RECALCULATED USING'.      MRKRP010
056200     05  FILLER                       PIC X(15)                   MRKRP010
056300         VALUE ' MOVING AVERAGE'.                                 MRKRP010
056400*                                                                 MRKRP010
056500 01  MSG-LINE4.                                                   MRKRP010
056600     05  FILLER                       PIC X(15)      VALUE SPACES.MRKRP010
056700     05  FILLER                       PIC X(47)                   MRKRP010
056800         VALUE 'D (LOPCT) = ITEM/STORE DD WAS UPDATED DOWN DUE '. MRKRP010
056900     05  FILLER                       PIC X(47)                   MRKRP010
057000         VALUE 'TO SALES REPEATEDLY BEING LOWER THAN SET LIMITS'. MRKRP010
057100*                                                                 MRKRP010
057200 01  MSG-LINE5.                                                   MRKRP010
057300     05  FILLER                       PIC X(15)      VALUE SPACES.MRKRP010
057400     05  FILLER                       PIC X(47)                   MRKRP010
057500         VALUE 'U (HIPCT) = ITEM/STORE DD WAS UPDATED UP DUE TO'. MRKRP010
057600     05  FILLER                       PIC X(46)                   MRKRP010
057700         VALUE ' SALES REPEATEDLY BEING HIGHER THAN SET LIMITS'.  MRKRP010
057800*                                                                 MRKRP010
057900*                                                                 MRKRP010
058000 01  PS-PROGRAM-SWITCHES.                                         MRKRP010
058100     05  PS-EOC-PTAG-CSR              PIC X(01)      VALUE 'N'.   MRKRP010
058200         88  EOC-PTAG-CSR                            VALUE 'Y'.   MRKRP010
058300     05  PS-DEMAND-EXCEPT-EOF         PIC X(01)      VALUE 'N'.   MRKRP010
058400         88  DEMAND-EXCEPT-EOF                       VALUE 'Y'.   MRKRP010
058500     05  PS-HAS-GMM-CHANGED           PIC X(01).                     CL**3
058600         88  PS-GMM-CHANGE                           VALUE 'Y'.      CL**3
058700         88  PS-GMM-NO-CHANGE                        VALUE 'N'.      CL**3
058800     05  PS-HAS-DMM-CHANGED           PIC X(01).                     CL**3
058900         88  PS-DMM-CHANGE                           VALUE 'Y'.      CL**3
059000         88  PS-DMM-NO-CHANGE                        VALUE 'N'.      CL**3
059100     05  PS-HAS-DEPT-CHANGED          PIC X(01).                     CL**3
059200         88  PS-DEPT-CHANGE                          VALUE 'Y'.      CL**3
059300         88  PS-DEPT-NO-CHANGE                       VALUE 'N'.      CL**3
059400     05  PS-PTAG-DATA-SWITCH          PIC X(01).                  MRKRP010
059500         88  PS-PTAG-DATA                            VALUE 'Y'.   MRKRP010
059600         88  PS-NO-PTAG-DATA                         VALUE 'N'.   MRKRP010
059700*                                                                 MRKRP010
059800* DEMAND EXCEPTION CONTROL PARM LAYOUT                            MRKRP010
059900     COPY MRRD024.                                                MRKRP010
060000*                                                                 MRKRP010
060100* DEMAND EXCEPTION FILE LAYOUT                                    MRKRP010
060200     COPY MRRD025.                                                MRKRP010
060300*                                                                 MRKRP010
060400* RESPONSIBLITY TABLE                                                CL**4
060500*                                                                 MRKRP010
060600     EXEC SQL                                                        CL**4
060700         INCLUDE TRSPBAR                                             CL**4
060800     END-EXEC.                                                       CL**4
060900 EJECT                                                               CL**4
061000*                                                                    CL**4
061100* DEPT ACCESS TABLE                                                  CL**4
061200*                                                                 MRKRP010
061300     EXEC SQL                                                        CL**4
061400         INCLUDE TMDSEAR                                             CL**4
061500     END-EXEC.                                                       CL**4
061600 EJECT                                                               CL**4
061700*                                                                    CL**4
061800* DB2 COMMUNICATION AREA                                             CL**4
061900*                                                                    CL**4
062000     EXEC SQL                                                        CL**4
062100         INCLUDE SQLCA                                               CL**4
062200     END-EXEC.                                                       CL**4
062300 EJECT                                                               CL**4
062400*                                                                    CL**4
062500* DB2 COMMUNICATION AREA2                                            CL**4
062600*                                                                    CL**4
062700     COPY SQLCA2.                                                    CL**4
062800 EJECT                                                               CL**4
062900*                                                                 MRKRP010
063000****************************************************************  MRKRP010
063100 PROCEDURE DIVISION.                                              MRKRP010
063200****************************************************************  MRKRP010
063300                                                                  MRKRP010
063400****************************************************************  MRKRP010
063500* A100-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  MRKRP010
063600* PROGRAM.                                                     *  MRKRP010
063700****************************************************************  MRKRP010
063800                                                                  MRKRP010
063900 A100-PROGRAM-MAINLINE.                                           MRKRP010
064000                                                                  MRKRP010
064100     PERFORM B100-INITIALIZATION.                                 MRKRP010
064200                                                                  MRKRP010
064300     PERFORM B200-PROCESS-DMD-EXCEPT-FILE                         MRKRP010
064400         UNTIL DEMAND-EXCEPT-EOF.                                 MRKRP010
064500                                                                  MRKRP010
064600     PERFORM B300-END-ROUTINE.                                    MRKRP010
064700                                                                  MRKRP010
064800     GOBACK.                                                      MRKRP010
064900                                                                  MRKRP010
065000     EJECT                                                        MRKRP010
065100*                                                                 MRKRP010
065200****************************************************************  MRKRP010
065300* B100-INITIALIZATION OPENS ALL FILES AND INITAILZES ALL OF    *  MRKRP010
065400* THE NECESSARY FIELDS.  ALSO IT CREATES THE REPORT HEADINGS   *  MRKRP010
065500****************************************************************  MRKRP010
065600 B100-INITIALIZATION.                                             MRKRP010
065700                                                                  MRKRP010
065800     OPEN INPUT  DEMAND-EXCEPT-FILE                               MRKRP010
065900          OUTPUT DEMAND-EXCEPT-DETAIL-REPORT                      MRKRP010
066000                 DEMAND-EXCEPT-SUMMARY-REPORT.                    MRKRP010
066100*                                                                 MRKRP010
066200     INITIALIZE PV-TOTAL-VARIABLES.                               MRKRP010
066300                                                                  MRKRP010
066400     ACCEPT CT-CPU-TIME FROM TIME.                                MRKRP010
066500     ACCEPT CD-CPU-NUMERIC-DATE FROM DATE.                                
066600*********************** ##Y2K MODIFICATION ***********************        
066700     IF CD-CPU-YR > 80                                                    
066800        MOVE 19 TO CD-CPU-CC                                              
066900     ELSE                                                                 
067000        MOVE 20 TO CD-CPU-CC                                              
067100     END-IF                                                               
067200************************ END MODIFICATION ************************        
067300                                                                          
067400     ACCEPT MR024-DEMAND-EXC-SUMMARY-CTL.                         MRKRP010
067500                                                                  MRKRP010
067600     MOVE CT-CPU-HR                   TO DP132-RUN-HOUR.          MRKRP010
067700     MOVE CT-CPU-MIN                  TO DP132-RUN-MINUTE.        MRKRP010
067800                                                                  MRKRP010
067900     MOVE CD-CPU-MO                   TO DP132-RUN-MONTH.         MRKRP010
068000     MOVE CD-CPU-DY                   TO DP132-RUN-DAY.           MRKRP010
068100                                                                          
068200*********************** ##Y2K MODIFICATION ***********************        
068300     MOVE CD-CPU-FULL-YEAR            TO DP132-RUN-YEAR.                  
068400************************ END MODIFICATION ************************        
068500                                                                          
068600                                                                  MRKRP010
068700     MOVE 'MRKRP010'                  TO DP132-PROGRAM-NAME.      MRKRP010
068800*                                                                 MRKRP010
068900     PERFORM R100-READ-DEMAND-EXCEPT-FILE.                        MRKRP010
069000*                                                                 MRKRP010
069100     MOVE MR025-MERCH-DEPT-NMBR       TO PV-PREV-DEPT-NMBR.          CL**4
069200     MOVE MR025-MERCH-DIV-CODE        TO PV-PREV-GMM-NMBR.           CL**8
069300     MOVE MR025-DMM-NMBR              TO PV-PREV-DMM-NMBR.           CL**8
069400*                                                                    CL**8
069500     MOVE PV-PREV-GMM-NMBR            TO HL2-GMM-NMBR.               CL**8
069600     MOVE PV-PREV-DMM-NMBR            TO HL2-DMM-NMBR.               CL*12
069700*                                                                    CL**8
069800     PERFORM I100-SELECT-GMM.                                        CL**8
069900     PERFORM I200-SELECT-DMM.                                        CL**8
070000*                                                                 MRKRP010
070100     MOVE 2                           TO DP132-REPORT-NUMBER.     MRKRP010
070200     PERFORM H200-FORMAT-RPT2-HEADINGS.                           MRKRP010
070300*                                                                 MRKRP010
070400     SET PS-DEPT-CHANGE               TO TRUE.                       CL**4
070500     SET PS-NO-PTAG-DATA              TO TRUE.                    MRKRP010
070600*                                                                 MRKRP010
070700****************************************************************  MRKRP010
070800* B200-PROCESS-DMD-EXCEPT-FILE THIS MODULE CONTROLS THE MAIN   *  MRKRP010
070900* FLOW OF THE PROGRAM.                                         *  MRKRP010
071000****************************************************************  MRKRP010
071100                                                                  MRKRP010
071200 B200-PROCESS-DMD-EXCEPT-FILE.                                    MRKRP010
071300                                                                  MRKRP010
071400*    DISPLAY 'B200-PROCESS-DMD-EXCEPT-FILE'.                      MRKRP010
071500                                                                  MRKRP010
071600                                                                  MRKRP010
071700     IF MR025-MERCH-DEPT-NMBR EQUAL PV-PREV-DEPT-NMBR             MRKRP010
071800         PERFORM C100-CHECK-PTAG-CONTROLS                         MRKRP010
071900                                                                  MRKRP010
072000         MOVE MR025-PTAG-ID         TO PV-PREV-PTAG-ID            MRKRP010
072100     ELSE                                                         MRKRP010
072200         PERFORM C200-FORMAT-DEPT-TOTALS                          MRKRP010
072300                                                                  MRKRP010
072400         INITIALIZE PV-TOTAL-VARIABLES                            MRKRP010
072500                                                                  MRKRP010
072600         MOVE 2                     TO DP132-REPORT-NUMBER        MRKRP010
072700         PERFORM H200-FORMAT-RPT2-HEADINGS                        MRKRP010
072800                                                                  MRKRP010
072900         SET PS-DEPT-CHANGE  TO TRUE                              MRKRP010
073000         SET PS-NO-PTAG-DATA TO TRUE                              MRKRP010
073100         MOVE MR025-MERCH-DEPT-NMBR TO PV-PREV-DEPT-NMBR          MRKRP010
073200         PERFORM C100-CHECK-PTAG-CONTROLS                         MRKRP010
073300                                                                  MRKRP010
073400     END-IF.                                                      MRKRP010
073500*                                                                 MRKRP010
073600     PERFORM R100-READ-DEMAND-EXCEPT-FILE.                        MRKRP010
073700                                                                  MRKRP010
073800*                                                                 MRKRP010
073900****************************************************************  MRKRP010
074000* C100-CHECK-PTAG-CONTROLS.                                       MRKRP010
074100*                                                                 MRKRP010
074200*                                                                 MRKRP010
074300****************************************************************  MRKRP010
074400                                                                  MRKRP010
074500 C100-CHECK-PTAG-CONTROLS.                                        MRKRP010
074600                                                                  MRKRP010
074700*    DISPLAY 'C100-CHECK-PTAG-CONTROL'.                           MRKRP010
074800                                                                  MRKRP010
074900     IF (MR025-REG-PCT-TRIPS-TOTAL (1)                            MRKRP010
075000                                 GREATER THAN MR024-LODFL-LIMIT   MRKRP010
075100             OR MR025-REG-PCT-TRIPS-TOTAL (2)                     MRKRP010
075200                                 GREATER THAN MR024-HIDFL-LIMIT   MRKRP010
075300             OR MR025-REG-PCT-TRIPS-TOTAL (3)                     MRKRP010
075400                                 GREATER THAN MR024-IDFL-LIMIT    MRKRP010
075500             OR MR025-REG-PCT-TRIPS-TOTAL (4)                     MRKRP010
075600                                 GREATER THAN MR024-LOPCT-LIMIT   MRKRP010
075700             OR MR025-REG-PCT-TRIPS-TOTAL (5)                     MRKRP010
075800                                 GREATER THAN MR024-HIPCT-LIMIT   MRKRP010
075900             OR MR025-TTL-PCT-TRIPS-TOTAL                         MRKRP010
076000                                 GREATER THAN MR024-TOTAL-LIMIT)  MRKRP010
076100                                                                  MRKRP010
076200         SET PS-PTAG-DATA TO TRUE                                 MRKRP010
076300         PERFORM D100-FORMAT-PTAG-DETAIL                          MRKRP010
076400         PERFORM D200-FORMAT-PTAG-SUMMARY                         MRKRP010
076500         PERFORM D300-ADD-DEPT-TOTALS                             MRKRP010
076600     ELSE                                                         MRKRP010
076700         PERFORM D300-ADD-DEPT-TOTALS                             MRKRP010
076800     END-IF.                                                      MRKRP010
076900*                                                                 MRKRP010
077000***************************************************************** MRKRP010
077100* C200-FORMAT-DEPT-TOTALS                                         MRKRP010
077200***************************************************************** MRKRP010
077300 C200-FORMAT-DEPT-TOTALS.                                         MRKRP010
077400                                                                  MRKRP010
077500*    DISPLAY 'C200-FORMAT-DEPT-TOTALS'.                           MRKRP010
077600                                                                  MRKRP010
077700     IF PS-NO-PTAG-DATA                                           MRKRP010
077800         WRITE PRINT-SUMMARY-LINE FROM NO-DATA-REPORT-LINE        MRKRP010
077900              AFTER ADVANCING 1                                   MRKRP010
078000         ADD  1                  TO PV-LINE-CNT-2                 MRKRP010
078100     END-IF.                                                      MRKRP010
078200                                                                  MRKRP010
078300     PERFORM D400-CALCULATE-PCT-OF-TRIPS.                         MRKRP010
078400*                                                                 MRKRP010
078500     MOVE PV-TOTAL-NBR-ITEMS     TO HL8-DEPT-NBR-ITEMS.           MRKRP010
078600     MOVE PV-TOTAL-ITEMS-STORES  TO HL8-DEPT-NBR-ITEMS-STORES.    MRKRP010
078700     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-BLANK               MRKRP010
078800         AFTER ADVANCING 1.                                       MRKRP010
078900     WRITE PRINT-SUMMARY-LINE FROM DTL-DIVIDING-LINES             MRKRP010
079000         AFTER ADVANCING 1.                                       MRKRP010
079100     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE8               MRKRP010
079200         AFTER ADVANCING 1.                                       MRKRP010
079300     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE4               MRKRP010
079400         AFTER ADVANCING 2.                                       MRKRP010
079500     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE5               MRKRP010
079600         AFTER ADVANCING 1.                                       MRKRP010
079700     WRITE PRINT-SUMMARY-LINE FROM HL-UNDERLINES-1                MRKRP010
079800         AFTER ADVANCING 1.                                       MRKRP010
079900     ADD  7                      TO PV-LINE-CNT-2.                MRKRP010
080000                                                                  MRKRP010
080100     PERFORM D500-FORMAT-SUMMARY-LINE                             MRKRP010
080200         VARYING PV-SUMM-SUB                                      MRKRP010
080300         FROM 1 BY 1                                              MRKRP010
080400         UNTIL PV-SUMM-SUB GREATER THAN PC-FIVE.                  MRKRP010
080500                                                                  MRKRP010
080600     WRITE PRINT-SUMMARY-LINE FROM HL-UNDERLINES-1                MRKRP010
080700         AFTER ADVANCING 1.                                       MRKRP010
080800     ADD  1                           TO PV-LINE-CNT-2.           MRKRP010
080900                                                                  MRKRP010
081000     MOVE PV-TOTAL-NBR-ITEMS-CURR     TO TOTAL-NBR-OCCUR-CURR.    MRKRP010
081100     MOVE PV-TOTAL-PCT-TRIPS-CURR     TO TOTAL-PCT-TRIPS-CURR.    MRKRP010
081200     MOVE PV-TOTAL-NBR-ITEMS-1-WK     TO TOTAL-NBR-OCCUR-1-WK.    MRKRP010
081300     MOVE PV-TOTAL-PCT-TRIPS-1-WK     TO TOTAL-PCT-TRIPS-1-WK.    MRKRP010
081400     MOVE PV-TOTAL-NBR-ITEMS-2-WK     TO TOTAL-NBR-OCCUR-2-WK.    MRKRP010
081500     MOVE PV-TOTAL-PCT-TRIPS-2-WK     TO TOTAL-PCT-TRIPS-2-WK.    MRKRP010
081600     MOVE PV-TOTAL-NBR-ITEMS-3-WK     TO TOTAL-NBR-OCCUR-3-WK.    MRKRP010
081700     MOVE PV-TOTAL-PCT-TRIPS-3-WK     TO TOTAL-PCT-TRIPS-3-WK.    MRKRP010
081800     MOVE PV-TOTAL-AVG-ITEMS-4-WK     TO TOTAL-AVG-OCCUR-TOTAL.   MRKRP010
081900     MOVE PV-TOTAL-PCT-TRIPS-4-WK     TO TOTAL-PCT-TRIPS-TOTAL.   MRKRP010
082000                                                                  MRKRP010
082100     WRITE PRINT-SUMMARY-LINE FROM TOTAL-LINE1                    MRKRP010
082200         AFTER ADVANCING 1.                                       MRKRP010
082300     ADD  1                           TO PV-LINE-CNT-2.           MRKRP010
082400                                                                  MRKRP010
082500     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-BLANK               MRKRP010
082600         AFTER ADVANCING 1.                                       MRKRP010
082700     ADD  1                           TO PV-LINE-CNT-2.           MRKRP010
082800                                                                  MRKRP010
082900     EJECT                                                        MRKRP010
083000*                                                                 MRKRP010
083100****************************************************************  MRKRP010
083200* D100-FORMAT-PTAG-DETAIL.                                        MRKRP010
083300*                                                                 MRKRP010
083400****************************************************************  MRKRP010
083500                                                                  MRKRP010
083600 D100-FORMAT-PTAG-DETAIL.                                         MRKRP010
083700                                                                  MRKRP010
083800*    DISPLAY 'D100-FORMAT-PTAG-DETAIL'.                           MRKRP010
083900                                                                  MRKRP010
084000*    DISPLAY 'MR025 DEPT: ' MR025-MERCH-DEPT-NMBR.                MRKRP010
084100*    DISPLAY 'PREV DPT: ' PV-PREV-DEPT-NMBR.                      MRKRP010
084200                                                                  MRKRP010
084300     IF PV-LINE-CNT-1 > PC-MAX-LINES OR PS-DEPT-CHANGE            MRKRP010
084400         MOVE 1                      TO DP132-REPORT-NUMBER       MRKRP010
084500         PERFORM H100-FORMAT-RPT1-HEADINGS                        MRKRP010
084600                                                                  MRKRP010
084700         IF PS-DEPT-CHANGE                                        MRKRP010
084800             SET PS-DEPT-NO-CHANGE      TO TRUE                   MRKRP010
084900         END-IF                                                   MRKRP010
085000     END-IF.                                                      MRKRP010
085100                                                                  MRKRP010
085200     MOVE MR025-PTAG-ID              TO HL3-PTAG-NO.              MRKRP010
085300     MOVE MR025-NMBR-OF-ITEMS        TO HL3-NBR-ITEMS.            MRKRP010
085400     MOVE MR025-NMBR-OF-ITEMS-STORES TO HL3-NBR-ITEMS-STORES.     MRKRP010
085500     WRITE PRINT-DETAIL-LINE FROM DTL-DIVIDING-LINES              MRKRP010
085600         AFTER ADVANCING 1.                                       MRKRP010
085700     WRITE PRINT-DETAIL-LINE FROM HL-HEADING-LINE3                MRKRP010
085800         AFTER ADVANCING 2.                                       MRKRP010
085900     WRITE PRINT-DETAIL-LINE FROM HL-HEADING-LINE4                MRKRP010
086000         AFTER ADVANCING 2.                                       MRKRP010
086100     WRITE PRINT-DETAIL-LINE FROM HL-HEADING-LINE5                MRKRP010
086200         AFTER ADVANCING 1.                                       MRKRP010
086300     WRITE PRINT-DETAIL-LINE FROM HL-UNDERLINES-1                 MRKRP010
086400         AFTER ADVANCING 1.                                       MRKRP010
086500     ADD  7                           TO PV-LINE-CNT-1.           MRKRP010
086600                                                                  MRKRP010
086700     PERFORM E100-FORMAT-DETAIL-LINE                              MRKRP010
086800         VARYING PV-DETAIL-SUB                                    MRKRP010
086900         FROM 1 BY 1                                              MRKRP010
087000         UNTIL PV-DETAIL-SUB GREATER THAN PC-FIVE.                MRKRP010
087100                                                                  MRKRP010
087200     WRITE PRINT-DETAIL-LINE FROM HL-UNDERLINES-1                 MRKRP010
087300         AFTER ADVANCING 1.                                       MRKRP010
087400     ADD  1                           TO PV-LINE-CNT-1.           MRKRP010
087500                                                                  MRKRP010
087600     MOVE MR025-TTL-ITEMS-CURR        TO TOTAL-NBR-OCCUR-CURR.    MRKRP010
087700     MOVE MR025-TTL-PCT-TRIPS-CURR    TO TOTAL-PCT-TRIPS-CURR.    MRKRP010
087800     MOVE MR025-TTL-ITEMS-1-WK        TO TOTAL-NBR-OCCUR-1-WK.    MRKRP010
087900     MOVE MR025-TTL-PCT-TRIPS-1-WK    TO TOTAL-PCT-TRIPS-1-WK.    MRKRP010
088000     MOVE MR025-TTL-ITEMS-2-WK        TO TOTAL-NBR-OCCUR-2-WK.    MRKRP010
088100     MOVE MR025-TTL-PCT-TRIPS-2-WK    TO TOTAL-PCT-TRIPS-2-WK.    MRKRP010
088200     MOVE MR025-TTL-ITEMS-3-WK        TO TOTAL-NBR-OCCUR-3-WK.    MRKRP010
088300     MOVE MR025-TTL-PCT-TRIPS-3-WK    TO TOTAL-PCT-TRIPS-3-WK.    MRKRP010
088400     MOVE MR025-TTL-AVG-ITEMS-TOTAL   TO TOTAL-AVG-OCCUR-TOTAL.   MRKRP010
088500     MOVE MR025-TTL-PCT-TRIPS-TOTAL   TO TOTAL-PCT-TRIPS-TOTAL.   MRKRP010
088600                                                                  MRKRP010
088700     WRITE PRINT-DETAIL-LINE FROM TOTAL-LINE1                     MRKRP010
088800         AFTER ADVANCING 1.                                       MRKRP010
088900     ADD  2                           TO PV-LINE-CNT-1.           MRKRP010
089000                                                                  MRKRP010
089100     WRITE PRINT-DETAIL-LINE FROM HL-HEADING-BLANK                MRKRP010
089200         AFTER ADVANCING 1.                                       MRKRP010
089300     ADD  1                           TO PV-LINE-CNT-2.           MRKRP010
089400                                                                  MRKRP010
089500     EJECT                                                        MRKRP010
089600*                                                                 MRKRP010
089700***************************************************************** MRKRP010
089800* D200-FORMAT-PTAG-SUMMARY.                                       MRKRP010
089900***************************************************************** MRKRP010
090000                                                                  MRKRP010
090100 D200-FORMAT-PTAG-SUMMARY.                                        MRKRP010
090200                                                                  MRKRP010
090300*    DISPLAY 'D200-FORMAT-PTAG-SUMMARY'.                          MRKRP010
090400                                                                  MRKRP010
090500     IF PV-LINE-CNT-2 > PC-MAX-LINES                              MRKRP010
090600         MOVE 2                     TO DP132-REPORT-NUMBER        MRKRP010
090700         PERFORM H200-FORMAT-RPT2-HEADINGS                        MRKRP010
090800     END-IF.                                                      MRKRP010
090900                                                                  MRKRP010
091000     MOVE MR025-PTAG-ID             TO PRT-PTAG-NUMBER.           MRKRP010
091100     MOVE MR025-NMBR-OF-ITEMS       TO PRT-TTL-NBR-OF-ITEMS.      MRKRP010
091200     MOVE MR025-NMBR-OF-ITEMS-STORES                              MRKRP010
091300                                    TO PRT-TTL-NBR-OF-ITEMS-STRS. MRKRP010
091400     MOVE MR025-TTL-ITEMS-CURR      TO PRT-TTL-NBR-CURR.          MRKRP010
091500     MOVE MR025-TTL-PCT-TRIPS-CURR  TO PRT-TTL-PCT-CURR.          MRKRP010
091600     MOVE MR025-TTL-ITEMS-1-WK      TO PRT-TTL-NBR-1-WEEK.        MRKRP010
091700     MOVE MR025-TTL-PCT-TRIPS-1-WK  TO PRT-TTL-PCT-1-WEEK.        MRKRP010
091800     MOVE MR025-TTL-ITEMS-2-WK      TO PRT-TTL-NBR-2-WEEK.        MRKRP010
091900     MOVE MR025-TTL-PCT-TRIPS-2-WK  TO PRT-TTL-PCT-2-WEEK.        MRKRP010
092000     MOVE MR025-TTL-ITEMS-3-WK      TO PRT-TTL-NBR-3-WEEK.        MRKRP010
092100     MOVE MR025-TTL-PCT-TRIPS-3-WK  TO PRT-TTL-PCT-3-WEEK.        MRKRP010
092200     MOVE MR025-TTL-AVG-ITEMS-TOTAL TO PRT-TTL-AVG-4-WEEK.        MRKRP010
092300     MOVE MR025-TTL-PCT-TRIPS-TOTAL TO PRT-TTL-PCT-4-WEEK.        MRKRP010
092400                                                                  MRKRP010
092500     WRITE PRINT-SUMMARY-LINE FROM DETAIL-LINE-2                  MRKRP010
092600         AFTER ADVANCING 1.                                       MRKRP010
092700                                                                  MRKRP010
092800     ADD 1                          TO PV-LINE-CNT-2.             MRKRP010
092900*                                                                 MRKRP010
093000****************************************************************  MRKRP010
093100* D300-ADD-DEPT-TOTALS                                            MRKRP010
093200*                                                                 MRKRP010
093300*                                                                 MRKRP010
093400****************************************************************  MRKRP010
093500                                                                  MRKRP010
093600 D300-ADD-DEPT-TOTALS.                                            MRKRP010
093700                                                                  MRKRP010
093800*    DISPLAY 'D300-ADD-DEPT-TOTALS'.                              MRKRP010
093900                                                                  MRKRP010
094000     ADD MR025-NMBR-OF-ITEMS        TO PV-TOTAL-NBR-ITEMS         MRKRP010
094100     ADD MR025-NMBR-OF-ITEMS-STORES TO PV-TOTAL-ITEMS-STORES      MRKRP010
094200                                                                  MRKRP010
094300     ADD MR025-NMBR-ITEMS-CURR (1)  TO PV-TTL-NBR-ITEMS-CURR (1). MRKRP010
094400     ADD MR025-NMBR-ITEMS-1-WK (1)  TO PV-TTL-NBR-ITEMS-1-WK (1). MRKRP010
094500     ADD MR025-NMBR-ITEMS-2-WK (1)  TO PV-TTL-NBR-ITEMS-2-WK (1). MRKRP010
094600     ADD MR025-NMBR-ITEMS-3-WK (1)  TO PV-TTL-NBR-ITEMS-3-WK (1). MRKRP010
094700     ADD MR025-NMBR-ITEMS-TOTAL (1) TO PV-TTL-NBR-ITEMS-4-WK (1). MRKRP010
094800                                                                  MRKRP010
094900     ADD MR025-NMBR-ITEMS-CURR (2)  TO PV-TTL-NBR-ITEMS-CURR (2). MRKRP010
095000     ADD MR025-NMBR-ITEMS-1-WK (2)  TO PV-TTL-NBR-ITEMS-1-WK (2). MRKRP010
095100     ADD MR025-NMBR-ITEMS-2-WK (2)  TO PV-TTL-NBR-ITEMS-2-WK (2). MRKRP010
095200     ADD MR025-NMBR-ITEMS-3-WK (2)  TO PV-TTL-NBR-ITEMS-3-WK (2). MRKRP010
095300     ADD MR025-NMBR-ITEMS-TOTAL (2) TO PV-TTL-NBR-ITEMS-4-WK (2). MRKRP010
095400                                                                  MRKRP010
095500     ADD MR025-NMBR-ITEMS-CURR (3)  TO PV-TTL-NBR-ITEMS-CURR (3). MRKRP010
095600     ADD MR025-NMBR-ITEMS-1-WK (3)  TO PV-TTL-NBR-ITEMS-1-WK (3). MRKRP010
095700     ADD MR025-NMBR-ITEMS-2-WK (3)  TO PV-TTL-NBR-ITEMS-2-WK (3). MRKRP010
095800     ADD MR025-NMBR-ITEMS-3-WK (3)  TO PV-TTL-NBR-ITEMS-3-WK (3). MRKRP010
095900     ADD MR025-NMBR-ITEMS-TOTAL (3) TO PV-TTL-NBR-ITEMS-4-WK (3). MRKRP010
096000                                                                  MRKRP010
096100     ADD MR025-NMBR-ITEMS-CURR (4)  TO PV-TTL-NBR-ITEMS-CURR (4). MRKRP010
096200     ADD MR025-NMBR-ITEMS-1-WK (4)  TO PV-TTL-NBR-ITEMS-1-WK (4). MRKRP010
096300     ADD MR025-NMBR-ITEMS-2-WK (4)  TO PV-TTL-NBR-ITEMS-2-WK (4). MRKRP010
096400     ADD MR025-NMBR-ITEMS-3-WK (4)  TO PV-TTL-NBR-ITEMS-3-WK (4). MRKRP010
096500     ADD MR025-NMBR-ITEMS-TOTAL (4) TO PV-TTL-NBR-ITEMS-4-WK (4). MRKRP010
096600                                                                  MRKRP010
096700     ADD MR025-NMBR-ITEMS-CURR (5)  TO PV-TTL-NBR-ITEMS-CURR (5). MRKRP010
096800     ADD MR025-NMBR-ITEMS-1-WK (5)  TO PV-TTL-NBR-ITEMS-1-WK (5). MRKRP010
096900     ADD MR025-NMBR-ITEMS-2-WK (5)  TO PV-TTL-NBR-ITEMS-2-WK (5). MRKRP010
097000     ADD MR025-NMBR-ITEMS-3-WK (5)  TO PV-TTL-NBR-ITEMS-3-WK (5). MRKRP010
097100     ADD MR025-NMBR-ITEMS-TOTAL (5) TO PV-TTL-NBR-ITEMS-4-WK (5). MRKRP010
097200                                                                  MRKRP010
097300     ADD MR025-TTL-ITEMS-CURR       TO PV-TOTAL-NBR-ITEMS-CURR.   MRKRP010
097400     ADD MR025-TTL-ITEMS-1-WK       TO PV-TOTAL-NBR-ITEMS-1-WK.   MRKRP010
097500     ADD MR025-TTL-ITEMS-2-WK       TO PV-TOTAL-NBR-ITEMS-2-WK.   MRKRP010
097600     ADD MR025-TTL-ITEMS-3-WK       TO PV-TOTAL-NBR-ITEMS-3-WK.   MRKRP010
097700     ADD MR025-TTL-ITEMS-TOTAL      TO PV-TOTAL-NBR-ITEMS-4-WK.   MRKRP010
097800*                                                                 MRKRP010
097900****************************************************************  MRKRP010
098000* D400-CALCULATE-PCT-OF-TRIPS.                                    MRKRP010
098100****************************************************************  MRKRP010
098200                                                                  MRKRP010
098300 D400-CALCULATE-PCT-OF-TRIPS.                                     MRKRP010
098400                                                                  MRKRP010
098500*    DISPLAY 'D400-CALCULATE-PCT-OF-TRIPS'.                       MRKRP010
098600                                                                  MRKRP010
098700     COMPUTE PV-TTL-AVG-ITEMS-4-WK (1) ROUNDED =                  MRKRP010
098800             (PV-TTL-NBR-ITEMS-4-WK (1) / PC-PLUS-4).             MRKRP010
098900                                                                  MRKRP010
099000     COMPUTE PV-TTL-AVG-ITEMS-4-WK (2) ROUNDED =                  MRKRP010
099100             (PV-TTL-NBR-ITEMS-4-WK (2) / PC-PLUS-4).             MRKRP010
099200                                                                  MRKRP010
099300     COMPUTE PV-TTL-AVG-ITEMS-4-WK (3) ROUNDED =                  MRKRP010
099400             (PV-TTL-NBR-ITEMS-4-WK (3) / PC-PLUS-4).             MRKRP010
099500                                                                  MRKRP010
099600     COMPUTE PV-TTL-AVG-ITEMS-4-WK (4) ROUNDED =                  MRKRP010
099700             (PV-TTL-NBR-ITEMS-4-WK (4) / PC-PLUS-4).             MRKRP010
099800                                                                  MRKRP010
099900     COMPUTE PV-TTL-AVG-ITEMS-4-WK (5) ROUNDED =                  MRKRP010
100000             (PV-TTL-NBR-ITEMS-4-WK (5) / PC-PLUS-4).             MRKRP010
100100                                                                  MRKRP010
100200     COMPUTE PV-TOTAL-AVG-ITEMS-4-WK ROUNDED =                    MRKRP010
100300             (PV-TOTAL-NBR-ITEMS-4-WK / PC-PLUS-4).               MRKRP010
100400                                                                  MRKRP010
100500     IF PV-TOTAL-NBR-ITEMS-CURR = ZEROES                          MRKRP010
100600         MOVE ZEROES TO PV-TTL-PCT-TRIPS-CURR (1)                 MRKRP010
100700                        PV-TTL-PCT-TRIPS-CURR (2)                 MRKRP010
100800                        PV-TTL-PCT-TRIPS-CURR (3)                 MRKRP010
100900                        PV-TTL-PCT-TRIPS-CURR (4)                 MRKRP010
101000                        PV-TTL-PCT-TRIPS-CURR (5)                 MRKRP010
101100                        PV-TOTAL-PCT-TRIPS-CURR                   MRKRP010
101200     ELSE                                                         MRKRP010
101300         COMPUTE PV-TTL-PCT-TRIPS-CURR (1) ROUNDED =              MRKRP010
101400                 (PV-TTL-NBR-ITEMS-CURR (1)/                      MRKRP010
101500                        PV-TOTAL-NBR-ITEMS-CURR) * 100            MRKRP010
101600         COMPUTE PV-TTL-PCT-TRIPS-CURR (2) ROUNDED =              MRKRP010
101700                 (PV-TTL-NBR-ITEMS-CURR (2)/                      MRKRP010
101800                        PV-TOTAL-NBR-ITEMS-CURR) * 100            MRKRP010
101900         COMPUTE PV-TTL-PCT-TRIPS-CURR (3) ROUNDED =              MRKRP010
102000                 (PV-TTL-NBR-ITEMS-CURR (3)/                      MRKRP010
102100                        PV-TOTAL-NBR-ITEMS-CURR) * 100            MRKRP010
102200         COMPUTE PV-TTL-PCT-TRIPS-CURR (4) ROUNDED =              MRKRP010
102300                 (PV-TTL-NBR-ITEMS-CURR (4)/                      MRKRP010
102400                        PV-TOTAL-NBR-ITEMS-CURR) * 100            MRKRP010
102500         COMPUTE PV-TTL-PCT-TRIPS-CURR (5) ROUNDED =              MRKRP010
102600                 (PV-TTL-NBR-ITEMS-CURR (5)/                      MRKRP010
102700                        PV-TOTAL-NBR-ITEMS-CURR) * 100            MRKRP010
102800         COMPUTE PV-TOTAL-PCT-TRIPS-CURR ROUNDED =                MRKRP010
102900                 (PV-TOTAL-NBR-ITEMS-CURR /                       MRKRP010
103000                        PV-TOTAL-ITEMS-STORES) * 100              MRKRP010
103100     END-IF.                                                      MRKRP010
103200                                                                  MRKRP010
103300     IF PV-TOTAL-NBR-ITEMS-1-WK = ZEROES                          MRKRP010
103400         MOVE ZEROES TO PV-TTL-PCT-TRIPS-1-WK (1)                 MRKRP010
103500                        PV-TTL-PCT-TRIPS-1-WK (2)                 MRKRP010
103600                        PV-TTL-PCT-TRIPS-1-WK (3)                 MRKRP010
103700                        PV-TTL-PCT-TRIPS-1-WK (4)                 MRKRP010
103800                        PV-TTL-PCT-TRIPS-1-WK (5)                 MRKRP010
103900                        PV-TOTAL-PCT-TRIPS-1-WK                   MRKRP010
104000     ELSE                                                         MRKRP010
104100         COMPUTE PV-TTL-PCT-TRIPS-1-WK (1) ROUNDED =              MRKRP010
104200                 (PV-TTL-NBR-ITEMS-1-WK (1)/                      MRKRP010
104300                        PV-TOTAL-NBR-ITEMS-1-WK) * 100            MRKRP010
104400         COMPUTE PV-TTL-PCT-TRIPS-1-WK (2) ROUNDED =              MRKRP010
104500                 (PV-TTL-NBR-ITEMS-1-WK (2)/                      MRKRP010
104600                        PV-TOTAL-NBR-ITEMS-1-WK) * 100            MRKRP010
104700         COMPUTE PV-TTL-PCT-TRIPS-1-WK (3) ROUNDED =              MRKRP010
104800                 (PV-TTL-NBR-ITEMS-1-WK (3)/                      MRKRP010
104900                        PV-TOTAL-NBR-ITEMS-1-WK) * 100            MRKRP010
105000         COMPUTE PV-TTL-PCT-TRIPS-1-WK (4) ROUNDED =              MRKRP010
105100                 (PV-TTL-NBR-ITEMS-1-WK (4)/                      MRKRP010
105200                        PV-TOTAL-NBR-ITEMS-1-WK) * 100            MRKRP010
105300         COMPUTE PV-TTL-PCT-TRIPS-1-WK (5) ROUNDED =              MRKRP010
105400                 (PV-TTL-NBR-ITEMS-1-WK (5)/                      MRKRP010
105500                        PV-TOTAL-NBR-ITEMS-1-WK) * 100            MRKRP010
105600         COMPUTE PV-TOTAL-PCT-TRIPS-1-WK ROUNDED =                MRKRP010
105700                 (PV-TOTAL-NBR-ITEMS-1-WK /                       MRKRP010
105800                        PV-TOTAL-ITEMS-STORES) * 100              MRKRP010
105900     END-IF.                                                      MRKRP010
106000                                                                  MRKRP010
106100     IF PV-TOTAL-NBR-ITEMS-2-WK = ZEROES                          MRKRP010
106200         MOVE ZEROES TO PV-TTL-PCT-TRIPS-2-WK (1)                 MRKRP010
106300                        PV-TTL-PCT-TRIPS-2-WK (2)                 MRKRP010
106400                        PV-TTL-PCT-TRIPS-2-WK (3)                 MRKRP010
106500                        PV-TTL-PCT-TRIPS-2-WK (4)                 MRKRP010
106600                        PV-TTL-PCT-TRIPS-2-WK (5)                 MRKRP010
106700                        PV-TOTAL-PCT-TRIPS-2-WK                   MRKRP010
106800     ELSE                                                         MRKRP010
106900         COMPUTE PV-TTL-PCT-TRIPS-2-WK (1) ROUNDED =              MRKRP010
107000                 (PV-TTL-NBR-ITEMS-2-WK (1)/                      MRKRP010
107100                        PV-TOTAL-NBR-ITEMS-2-WK) * 100            MRKRP010
107200         COMPUTE PV-TTL-PCT-TRIPS-2-WK (2) ROUNDED =              MRKRP010
107300                 (PV-TTL-NBR-ITEMS-2-WK (2)/                      MRKRP010
107400                        PV-TOTAL-NBR-ITEMS-2-WK) * 100            MRKRP010
107500         COMPUTE PV-TTL-PCT-TRIPS-2-WK (3) ROUNDED =              MRKRP010
107600                 (PV-TTL-NBR-ITEMS-2-WK (3)/                      MRKRP010
107700                        PV-TOTAL-NBR-ITEMS-2-WK) * 100            MRKRP010
107800         COMPUTE PV-TTL-PCT-TRIPS-2-WK (4) ROUNDED =              MRKRP010
107900                 (PV-TTL-NBR-ITEMS-2-WK (4)/                      MRKRP010
108000                        PV-TOTAL-NBR-ITEMS-2-WK) * 100            MRKRP010
108100         COMPUTE PV-TTL-PCT-TRIPS-2-WK (5) ROUNDED =              MRKRP010
108200                 (PV-TTL-NBR-ITEMS-2-WK (5)/                      MRKRP010
108300                        PV-TOTAL-NBR-ITEMS-2-WK) * 100            MRKRP010
108400         COMPUTE PV-TOTAL-PCT-TRIPS-2-WK ROUNDED =                MRKRP010
108500                 (PV-TOTAL-NBR-ITEMS-2-WK /                       MRKRP010
108600                        PV-TOTAL-ITEMS-STORES) * 100              MRKRP010
108700     END-IF.                                                      MRKRP010
108800                                                                  MRKRP010
108900     IF PV-TOTAL-NBR-ITEMS-3-WK = ZEROES                          MRKRP010
109000         MOVE ZEROES TO PV-TTL-PCT-TRIPS-3-WK (1)                 MRKRP010
109100                        PV-TTL-PCT-TRIPS-3-WK (2)                 MRKRP010
109200                        PV-TTL-PCT-TRIPS-3-WK (3)                 MRKRP010
109300                        PV-TTL-PCT-TRIPS-3-WK (4)                 MRKRP010
109400                        PV-TTL-PCT-TRIPS-3-WK (5)                 MRKRP010
109500                        PV-TOTAL-PCT-TRIPS-3-WK                   MRKRP010
109600     ELSE                                                         MRKRP010
109700         COMPUTE PV-TTL-PCT-TRIPS-3-WK (1) ROUNDED =              MRKRP010
109800                 (PV-TTL-NBR-ITEMS-3-WK (1)/                      MRKRP010
109900                        PV-TOTAL-NBR-ITEMS-3-WK) * 100            MRKRP010
110000         COMPUTE PV-TTL-PCT-TRIPS-3-WK (2) ROUNDED =              MRKRP010
110100                 (PV-TTL-NBR-ITEMS-3-WK (2)/                      MRKRP010
110200                        PV-TOTAL-NBR-ITEMS-3-WK) * 100            MRKRP010
110300         COMPUTE PV-TTL-PCT-TRIPS-3-WK (3) ROUNDED =              MRKRP010
110400                 (PV-TTL-NBR-ITEMS-3-WK (3)/                      MRKRP010
110500                        PV-TOTAL-NBR-ITEMS-3-WK) * 100            MRKRP010
110600         COMPUTE PV-TTL-PCT-TRIPS-3-WK (4) ROUNDED =              MRKRP010
110700                 (PV-TTL-NBR-ITEMS-3-WK (4)/                      MRKRP010
110800                        PV-TOTAL-NBR-ITEMS-3-WK) * 100            MRKRP010
110900         COMPUTE PV-TTL-PCT-TRIPS-3-WK (5) ROUNDED =              MRKRP010
111000                 (PV-TTL-NBR-ITEMS-3-WK (5)/                      MRKRP010
111100                        PV-TOTAL-NBR-ITEMS-3-WK) * 100            MRKRP010
111200         COMPUTE PV-TOTAL-PCT-TRIPS-3-WK ROUNDED =                MRKRP010
111300                 (PV-TOTAL-NBR-ITEMS-3-WK /                       MRKRP010
111400                        PV-TOTAL-ITEMS-STORES) * 100              MRKRP010
111500     END-IF.                                                      MRKRP010
111600                                                                  MRKRP010
111700     IF PV-TOTAL-NBR-ITEMS-4-WK = ZEROES                          MRKRP010
111800         MOVE ZEROES TO PV-TTL-PCT-TRIPS-4-WK (1)                 MRKRP010
111900                        PV-TTL-PCT-TRIPS-4-WK (2)                 MRKRP010
112000                        PV-TTL-PCT-TRIPS-4-WK (3)                 MRKRP010
112100                        PV-TTL-PCT-TRIPS-4-WK (4)                 MRKRP010
112200                        PV-TTL-PCT-TRIPS-4-WK (5)                 MRKRP010
112300                        PV-TOTAL-PCT-TRIPS-4-WK                   MRKRP010
112400     ELSE                                                         MRKRP010
112500         COMPUTE PV-TTL-PCT-TRIPS-4-WK (1) ROUNDED =              MRKRP010
112600                 (PV-TTL-NBR-ITEMS-4-WK (1)/                      MRKRP010
112700                        PV-TOTAL-NBR-ITEMS-4-WK) * 100            MRKRP010
112800         COMPUTE PV-TTL-PCT-TRIPS-4-WK (2) ROUNDED =              MRKRP010
112900                 (PV-TTL-NBR-ITEMS-4-WK (2)/                      MRKRP010
113000                        PV-TOTAL-NBR-ITEMS-4-WK) * 100            MRKRP010
113100         COMPUTE PV-TTL-PCT-TRIPS-4-WK (3) ROUNDED =              MRKRP010
113200                 (PV-TTL-NBR-ITEMS-4-WK (3)/                      MRKRP010
113300                        PV-TOTAL-NBR-ITEMS-4-WK) * 100            MRKRP010
113400         COMPUTE PV-TTL-PCT-TRIPS-4-WK (4) ROUNDED =              MRKRP010
113500                 (PV-TTL-NBR-ITEMS-4-WK (4)/                      MRKRP010
113600                        PV-TOTAL-NBR-ITEMS-4-WK) * 100            MRKRP010
113700         COMPUTE PV-TTL-PCT-TRIPS-4-WK (5) ROUNDED =              MRKRP010
113800                 (PV-TTL-NBR-ITEMS-4-WK (5)/                      MRKRP010
113900                        PV-TOTAL-NBR-ITEMS-4-WK) * 100            MRKRP010
114000         COMPUTE PV-TOTAL-PCT-TRIPS-4-WK ROUNDED =                MRKRP010
114100                 (PV-TOTAL-AVG-ITEMS-4-WK /                       MRKRP010
114200                        PV-TOTAL-ITEMS-STORES) * 100              MRKRP010
114300     END-IF.                                                      MRKRP010
114400                                                                  MRKRP010
114500*                                                                 MRKRP010
114600***************************************************************** MRKRP010
114700* D500-FORMAT-SUMMARY-LINE                                        MRKRP010
114800***************************************************************** MRKRP010
114900                                                                  MRKRP010
115000 D500-FORMAT-SUMMARY-LINE.                                        MRKRP010
115100                                                                  MRKRP010
115200*    DISPLAY 'D500-FORMAT-SUMMARY-LINE'.                          MRKRP010
115300                                                                  MRKRP010
115400     EVALUATE TRUE                                                MRKRP010
115500         WHEN PV-SUMM-SUB EQUAL PC-ONE                            MRKRP010
115600             MOVE PC-L-DESC           TO PRT-DEMAND-REG           MRKRP010
115700         WHEN PV-SUMM-SUB EQUAL PC-TWO                            MRKRP010
115800             MOVE PC-H-DESC           TO PRT-DEMAND-REG           MRKRP010
115900         WHEN PV-SUMM-SUB EQUAL PC-THREE                          MRKRP010
116000             MOVE PC-I-DESC           TO PRT-DEMAND-REG           MRKRP010
116100         WHEN PV-SUMM-SUB EQUAL PC-FOUR                           MRKRP010
116200             MOVE PC-D-DESC           TO PRT-DEMAND-REG           MRKRP010
116300         WHEN PV-SUMM-SUB EQUAL PC-FIVE                           MRKRP010
116400             MOVE PC-U-DESC           TO PRT-DEMAND-REG           MRKRP010
116500     END-EVALUATE.                                                MRKRP010
116600                                                                  MRKRP010
116700     MOVE PV-TTL-NBR-ITEMS-CURR (PV-SUMM-SUB)                     MRKRP010
116800                                      TO PRT-NBR-CURRENT.         MRKRP010
116900     MOVE PV-TTL-PCT-TRIPS-CURR (PV-SUMM-SUB)                     MRKRP010
117000                                      TO PRT-PCT-CURRENT.         MRKRP010
117100     MOVE PV-TTL-NBR-ITEMS-1-WK (PV-SUMM-SUB)                     MRKRP010
117200                                      TO PRT-NBR-1-WEEK.          MRKRP010
117300     MOVE PV-TTL-PCT-TRIPS-1-WK (PV-SUMM-SUB)                     MRKRP010
117400                                      TO PRT-PCT-1-WEEK.          MRKRP010
117500     MOVE PV-TTL-NBR-ITEMS-2-WK (PV-SUMM-SUB)                     MRKRP010
117600                                      TO PRT-NBR-2-WEEK.          MRKRP010
117700     MOVE PV-TTL-PCT-TRIPS-2-WK (PV-SUMM-SUB)                     MRKRP010
117800                                      TO PRT-PCT-2-WEEK.          MRKRP010
117900     MOVE PV-TTL-NBR-ITEMS-3-WK (PV-SUMM-SUB)                     MRKRP010
118000                                      TO PRT-NBR-3-WEEK.          MRKRP010
118100     MOVE PV-TTL-PCT-TRIPS-3-WK (PV-SUMM-SUB)                     MRKRP010
118200                                      TO PRT-PCT-3-WEEK.          MRKRP010
118300     MOVE PV-TTL-AVG-ITEMS-4-WK (PV-SUMM-SUB)                     MRKRP010
118400                                      TO PRT-AVG-4-WEEK.          MRKRP010
118500     MOVE PV-TTL-PCT-TRIPS-4-WK (PV-SUMM-SUB)                     MRKRP010
118600                                      TO PRT-PCT-4-WEEK.          MRKRP010
118700                                                                  MRKRP010
118800     WRITE PRINT-SUMMARY-LINE FROM DETAIL-LINE-1                  MRKRP010
118900         AFTER ADVANCING 1.                                       MRKRP010
119000                                                                  MRKRP010
119100     ADD 1                            TO PV-LINE-CNT-2.           MRKRP010
119200     EJECT                                                        MRKRP010
119300*                                                                 MRKRP010
119400***************************************************************** MRKRP010
119500* E100-FORMAT-DETAIL-LINE                                         MRKRP010
119600***************************************************************** MRKRP010
119700                                                                  MRKRP010
119800 E100-FORMAT-DETAIL-LINE.                                         MRKRP010
119900                                                                  MRKRP010
120000*    DISPLAY 'E100-FORMAT-DETAIL-LINE'.                           MRKRP010
120100                                                                  MRKRP010
120200     EVALUATE TRUE                                                MRKRP010
120300         WHEN PV-DETAIL-SUB EQUAL PC-ONE                          MRKRP010
120400             MOVE PC-L-DESC           TO PRT-DEMAND-REG           MRKRP010
120500         WHEN PV-DETAIL-SUB EQUAL PC-TWO                          MRKRP010
120600             MOVE PC-H-DESC           TO PRT-DEMAND-REG           MRKRP010
120700         WHEN PV-DETAIL-SUB EQUAL PC-THREE                        MRKRP010
120800             MOVE PC-I-DESC           TO PRT-DEMAND-REG           MRKRP010
120900         WHEN PV-DETAIL-SUB EQUAL PC-FOUR                         MRKRP010
121000             MOVE PC-D-DESC           TO PRT-DEMAND-REG           MRKRP010
121100         WHEN PV-DETAIL-SUB EQUAL PC-FIVE                         MRKRP010
121200             MOVE PC-U-DESC           TO PRT-DEMAND-REG           MRKRP010
121300     END-EVALUATE.                                                MRKRP010
121400                                                                  MRKRP010
121500     MOVE MR025-NMBR-ITEMS-CURR (PV-DETAIL-SUB)                   MRKRP010
121600                                      TO PRT-NBR-CURRENT.         MRKRP010
121700     MOVE MR025-REG-PCT-TRIPS-CURR (PV-DETAIL-SUB)                MRKRP010
121800                                      TO PRT-PCT-CURRENT.         MRKRP010
121900     MOVE MR025-NMBR-ITEMS-1-WK (PV-DETAIL-SUB)                   MRKRP010
122000                                      TO PRT-NBR-1-WEEK.          MRKRP010
122100     MOVE MR025-REG-PCT-TRIPS-1-WK (PV-DETAIL-SUB)                MRKRP010
122200                                      TO PRT-PCT-1-WEEK.          MRKRP010
122300     MOVE MR025-NMBR-ITEMS-2-WK (PV-DETAIL-SUB)                   MRKRP010
122400                                      TO PRT-NBR-2-WEEK.          MRKRP010
122500     MOVE MR025-REG-PCT-TRIPS-2-WK (PV-DETAIL-SUB)                MRKRP010
122600                                      TO PRT-PCT-2-WEEK.          MRKRP010
122700     MOVE MR025-NMBR-ITEMS-3-WK (PV-DETAIL-SUB)                   MRKRP010
122800                                      TO PRT-NBR-3-WEEK.          MRKRP010
122900     MOVE MR025-REG-PCT-TRIPS-3-WK (PV-DETAIL-SUB)                MRKRP010
123000                                      TO PRT-PCT-3-WEEK.          MRKRP010
123100     MOVE MR025-AVG-NMBR-ITEMS-TOTAL (PV-DETAIL-SUB)              MRKRP010
123200                                      TO PRT-AVG-4-WEEK.          MRKRP010
123300     MOVE MR025-REG-PCT-TRIPS-TOTAL (PV-DETAIL-SUB)               MRKRP010
123400                                      TO PRT-PCT-4-WEEK.          MRKRP010
123500                                                                  MRKRP010
123600     WRITE PRINT-DETAIL-LINE FROM DETAIL-LINE-1                   MRKRP010
123700         AFTER ADVANCING 1.                                       MRKRP010
123800     ADD 1                            TO PV-LINE-CNT-1.           MRKRP010
123900                                                                  MRKRP010
124000     EJECT                                                        MRKRP010
124100*                                                                 MRKRP010
124200***************************************************************** MRKRP010
124300* H100-FORMAT-RPT1-HEADINGS                                       MRKRP010
124400***************************************************************** MRKRP010
124500                                                                  MRKRP010
124600 H100-FORMAT-RPT1-HEADINGS.                                       MRKRP010
124700                                                                  MRKRP010
124800*    DISPLAY 'H100-FORMAT-RPT1-HEADINGS'.                         MRKRP010
124900                                                                  MRKRP010
125000     ADD +1                      TO PV-PAGE-CNT-1.                MRKRP010
125100     MOVE PV-PAGE-CNT-1          TO DP132-PAGE-NUMBER.            MRKRP010
125200     WRITE PRINT-DETAIL-LINE FROM DP132-STANDRD-HEADER-132-COLS   MRKRP010
125300         AFTER ADVANCING PAGE.                                    MRKRP010
125400     WRITE PRINT-DETAIL-LINE FROM HL-HEADING-LINE1                MRKRP010
125500         AFTER ADVANCING 1.                                       MRKRP010
125600                                                                  MRKRP010
125700     MOVE 1                      TO PV-LINE-CNT-1.                MRKRP010
125800                                                                  MRKRP010
125900     IF MR025-MERCH-DIV-CODE EQUAL PV-PREV-GMM-NMBR                  CL**5
126000         CONTINUE                                                    CL**5
126100     ELSE                                                            CL**5
126200         MOVE MR025-MERCH-DIV-CODE   TO HL2-GMM-NMBR                 CL*20
126300         PERFORM I100-SELECT-GMM                                     CL**5
126400         MOVE MR025-MERCH-DIV-CODE   TO PV-PREV-GMM-NMBR             CL**5
126500     END-IF.                                                         CL**5
126600                                                                     CL**5
126700     IF MR025-DMM-NMBR EQUAL PV-PREV-DMM-NMBR                        CL**8
126800         CONTINUE                                                    CL**5
126900     ELSE                                                            CL**5
127000         MOVE MR025-DMM-NMBR         TO HL2-DMM-NMBR                 CL*20
127100         PERFORM I200-SELECT-DMM                                     CL**5
127200         MOVE MR025-DMM-NMBR         TO PV-PREV-DMM-NMBR             CL**5
127300     END-IF.                                                         CL**5
127400                                                                     CL**5
127500     MOVE MR025-MERCH-DEPT-NMBR      TO PV-DEPT-CONVERT-X-3.      MRKRP010
127510     MOVE PV-DEPT-CONVERT-9-3        TO HL2-DEPT-NO.              MRKRP010
127600     MOVE MR025-MDSEAR-DESC          TO HL2-DEPT-DESC.            MRKRP010
127700     WRITE PRINT-DETAIL-LINE FROM HL-HEADING-LINE2                MRKRP010
127800         AFTER ADVANCING 2.                                       MRKRP010
127900                                                                  MRKRP010
128000     WRITE PRINT-DETAIL-LINE FROM MSG-LINE1 AFTER ADVANCING 2.    MRKRP010
128100     WRITE PRINT-DETAIL-LINE FROM MSG-LINE2 AFTER ADVANCING 1.    MRKRP010
128200     WRITE PRINT-DETAIL-LINE FROM MSG-LINE3 AFTER ADVANCING 1.    MRKRP010
128300     WRITE PRINT-DETAIL-LINE FROM MSG-LINE4 AFTER ADVANCING 1.    MRKRP010
128400     WRITE PRINT-DETAIL-LINE FROM MSG-LINE5 AFTER ADVANCING 1.    MRKRP010
128500                                                                  MRKRP010
128600     ADD 6                           TO PV-LINE-CNT-1.            MRKRP010
128700                                                                  MRKRP010
128800*                                                                 MRKRP010
128900***************************************************************** MRKRP010
129000* H200-FORMAT-RPT2-HEADINGS                                       MRKRP010
129100***************************************************************** MRKRP010
129200                                                                  MRKRP010
129300 H200-FORMAT-RPT2-HEADINGS.                                       MRKRP010
129400                                                                  MRKRP010
129500*    DISPLAY 'H200-FORMAT-RPT2-HEADINGS'.                         MRKRP010
129600                                                                  MRKRP010
129700     IF MR025-MERCH-DIV-CODE EQUAL PV-PREV-GMM-NMBR                  CL**5
129800         CONTINUE                                                    CL**5
129900     ELSE                                                            CL**5
130000         MOVE MR025-MERCH-DIV-CODE   TO HL2-GMM-NMBR                 CL*20
130100         PERFORM I100-SELECT-GMM                                     CL**5
130200         MOVE MR025-MERCH-DIV-CODE   TO PV-PREV-GMM-NMBR             CL**5
130300     END-IF.                                                         CL**5
130400                                                                     CL**5
130500     IF MR025-DMM-NMBR EQUAL PV-PREV-DMM-NMBR                        CL**5
130600         CONTINUE                                                    CL**5
130700     ELSE                                                            CL**5
130800         MOVE MR025-DMM-NMBR         TO HL2-DMM-NMBR                 CL*20
130900         PERFORM I200-SELECT-DMM                                     CL**5
131000         MOVE MR025-DMM-NMBR         TO PV-PREV-DMM-NMBR             CL**5
131100     END-IF.                                                         CL**5
131200                                                                     CL**5
131300     MOVE MR025-MERCH-DEPT-NMBR  TO PV-DEPT-CONVERT-X-3.          MRKRP010
131310     MOVE PV-DEPT-CONVERT-9-3    TO HL2-DEPT-NO.                  MRKRP010
131400     MOVE MR025-MDSEAR-DESC      TO HL2-DEPT-DESC.                MRKRP010
131500     ADD +1                      TO PV-PAGE-CNT-2.                MRKRP010
131600     MOVE PV-PAGE-CNT-2          TO DP132-PAGE-NUMBER.            MRKRP010
131700     WRITE PRINT-SUMMARY-LINE FROM DP132-STANDRD-HEADER-132-COLS  MRKRP010
131800         AFTER ADVANCING PAGE.                                    MRKRP010
131900     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE1A              MRKRP010
132000         AFTER ADVANCING 1.                                       MRKRP010
132100     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE2               MRKRP010
132200         AFTER ADVANCING 2.                                       MRKRP010
132300     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE6               MRKRP010
132400         AFTER ADVANCING 2.                                       MRKRP010
132500     WRITE PRINT-SUMMARY-LINE FROM HL-HEADING-LINE7               MRKRP010
132600         AFTER ADVANCING 1.                                       MRKRP010
132700     WRITE PRINT-SUMMARY-LINE FROM HL-UNDERLINES-2                MRKRP010
132800         AFTER ADVANCING 1.                                       MRKRP010
132900                                                                  MRKRP010
133000     MOVE 7                  TO PV-LINE-CNT-2.                    MRKRP010
133100*                                                                 MRKRP010
133200*****************************************************************    CL**7
133300* I100-SELECT-GMM.                                              *    CL**7
133400*****************************************************************    CL**7
133500*                                                               *    CL**7
133600  I100-SELECT-GMM.                                                   CL**7
133700                                                                     CL**7
133800     MOVE 'I100-SELECT-GMM       '                                   CL**7
133900                                 TO PV-ABEND-PARAGRAPH.              CL**7
134000                                                                     CL**7
134100     MOVE MR025-MERCH-DIV-CODE   TO PV-GMA-NBR.                      CL*21
134200     MOVE PV-GMA-NBR-DB2         TO MDSEAR-GMA-NBR.                  CL*20
134300                                                                     CL**7
134400     MOVE SPACES                 TO HL2-GMM-NAME.                    CL*14
134500                                                                     CL**7
134600     EXEC SQL                                                        CL**7
134700          SELECT DISTINCT(B.WORKER_LAST_NAME), B.WORKER_FIR_NAME,    CL**7
134800                 B.RSPLVL_CDE                                        CL**7
134900            INTO :RSPBAR-WORKER-LAST-NAME,                           CL**7
135000                 :RSPBAR-WORKER-FIR-NAME,                            CL**7
135100                 :RSPBAR-RSPLVL-CDE                                  CL**7
135200          FROM TMDSEAR A,                                            CL**7
135300               TRSPBAR B                                             CL**7
135400          WHERE A.OPERCO_NBR = '03'                                  CL**7
135500            AND A.GMA_NBR   = :MDSEAR-GMA-NBR                        CL**7
135600            AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        CL**7
135700            AND B.RSPLVL_CDE  = 'GMM'                                CL**7
135800            AND WORKER_STRT_DTE <= CURRENT DATE                      CL**7
135900            AND WORKER_END_DTE >= CURRENT DATE                       CL**7
136000     END-EXEC.                                                       CL**7
136100                                                                     CL**7
136200     EVALUATE TRUE                                                   CL**7
136300       WHEN SQLCODE = ZEROS                                          CL**7
136400         STRING RSPBAR-WORKER-FIR-NAME DELIMITED BY ' '              CL**7
136500              ' '                      DELIMITED BY SIZE             CL**7
136600              RSPBAR-WORKER-LAST-NAME  DELIMITED BY SIZE             CL**7
136700                                      INTO  HL2-GMM-NAME             CL**7
136800       WHEN SQLCODE = +803                                           CL**7
136900         CONTINUE                                                    CL**7
137000       WHEN SQLCODE = +100                                           CL**7
137100         CONTINUE                                                    CL**7
137200       WHEN OTHER                                                    CL**7
137300         DISPLAY PV-ABEND-PARAGRAPH                                  CL**7
137400         PERFORM Z999-SQL-ERROR                                      CL**7
137500     END-EVALUATE.                                                   CL**7
137600                                                                     CL**7
137700*                                                                    CL**7
137800*****************************************************************    CL**6
137900* I200-SELECT-DMM.                                              *    CL**6
138000*****************************************************************    CL**6
138100*                                                               *    CL**6
138200  I200-SELECT-DMM.                                                   CL**6
138300                                                                     CL**6
138400     MOVE 'I200-SELECT-DMM       '                                   CL**6
138500                                 TO PV-ABEND-PARAGRAPH.              CL**6
138600     MOVE SPACES                 TO HL2-DMM-NAME.                    CL*14
138700                                                                     CL**6
138800     MOVE MR025-MERCH-DIV-CODE   TO PV-GMA-NBR.                      CL*21
138900     MOVE PV-GMA-NBR-DB2         TO MDSEAR-GMA-NBR.                  CL*20
139000     MOVE MR025-DMM-NMBR         TO PV-DMA-NBR.                      CL*17
139100     MOVE PV-DMA-NBR-DB2         TO MDSEAR-DMA-NBR.                  CL*17
139200                                                                     CL*14
139300     DISPLAY 'I200-SELECT-DMM       '.                               CL*14
139400     DISPLAY  ' GMM   '             MDSEAR-GMA-NBR.                  CL*14
139500     DISPLAY  ' DMM   '             MDSEAR-DMA-NBR.                  CL*14
139600     DISPLAY  '       '.                                             CL*14
139700                                                                     CL**6
139800     EXEC SQL                                                        CL**6
139900          SELECT DISTINCT(B.WORKER_LAST_NAME), B.WORKER_FIR_NAME,    CL**6
140000                 B.RSPLVL_CDE                                        CL**6
140100            INTO :RSPBAR-WORKER-LAST-NAME,                           CL**6
140200                 :RSPBAR-WORKER-FIR-NAME,                            CL**6
140300                 :RSPBAR-RSPLVL-CDE                                  CL**6
140400          FROM TMDSEAR A,                                            CL**6
140500               TRSPBAR B                                             CL**6
140600          WHERE A.OPERCO_NBR = '03'                                  CL**6
140700            AND A.GMA_NBR   = :MDSEAR-GMA-NBR                        CL**6
140800            AND A.DMA_NBR   = :MDSEAR-DMA-NBR                        CL**6
140900            AND MDSELV_CDE    = 'DMA'                                CL**6
141000            AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        CL**6
141100            AND B.RSPLVL_CDE  = 'DMM'                                CL**6
141200            AND WORKER_STRT_DTE <= CURRENT DATE                      CL**6
141300            AND WORKER_END_DTE >= CURRENT DATE                       CL**6
141400     END-EXEC.                                                       CL**6
141500                                                                     CL**6
141600     EVALUATE TRUE                                                   CL**6
141700       WHEN SQLCODE = ZEROS                                          CL**6
141800           STRING RSPBAR-WORKER-FIR-NAME  DELIMITED BY ' '           CL**6
141900                  ' '                     DELIMITED BY SIZE          CL**6
142000                  RSPBAR-WORKER-LAST-NAME DELIMITED BY SIZE          CL**6
142100                                       INTO  HL2-DMM-NAME            CL**7
142200       WHEN SQLCODE = +803                                           CL**6
142300         CONTINUE                                                    CL**6
142400       WHEN SQLCODE = +100                                           CL**6
142500         CONTINUE                                                    CL**6
142600       WHEN OTHER                                                    CL**6
142700         DISPLAY PV-ABEND-PARAGRAPH                                  CL**6
142800         PERFORM Z999-SQL-ERROR                                      CL**6
142900     END-EVALUATE.                                                   CL**6
143000                                                                     CL**6
143100*                                                                    CL**6
143200***************************************************************** MRKRP010
143300* R100-READ-DEMAND-EXCEPT-FILE                                  * MRKRP010
143400*                                                               * MRKRP010
143500*                                                               * MRKRP010
143600***************************************************************** MRKRP010
143700                                                                  MRKRP010
143800 R100-READ-DEMAND-EXCEPT-FILE.                                    MRKRP010
143900                                                                  MRKRP010
144000*    DISPLAY 'R100-READ-DEMAND-EXCEPT-FILE'.                      MRKRP010
144100                                                                  MRKRP010
144200     MOVE 'R100-READ-DEMAND-EXCEPT-FILE'                          MRKRP010
144300                                 TO PV-ABEND-PARAGRAPH.           MRKRP010
144400*                                                                 MRKRP010
144500     READ DEMAND-EXCEPT-FILE   INTO MR025-DEMAND-EXCEPT-REC       MRKRP010
144600         AT END                                                   MRKRP010
144700            MOVE PC-Y TO PS-DEMAND-EXCEPT-EOF.                    MRKRP010
144800*                                                                 MRKRP010
144900*                                                                 MRKRP010
145000***************************************************************** MRKRP010
145100* B300-END-ROUTINE                                              * MRKRP010
145200*                                                               * MRKRP010
145300*                                                               * MRKRP010
145400***************************************************************** MRKRP010
145500                                                                  MRKRP010
145600 B300-END-ROUTINE.                                                MRKRP010
145700                                                                  MRKRP010
145800     PERFORM C200-FORMAT-DEPT-TOTALS.                             MRKRP010
145900                                                                  MRKRP010
146000     WRITE PRINT-DETAIL-LINE  FROM END-OF-REPORT-LINE.            MRKRP010
146100     WRITE PRINT-SUMMARY-LINE FROM END-OF-REPORT-LINE.            MRKRP010
146200                                                                  MRKRP010
146300     CLOSE DEMAND-EXCEPT-FILE                                     MRKRP010
146400           DEMAND-EXCEPT-DETAIL-REPORT                            MRKRP010
146500           DEMAND-EXCEPT-SUMMARY-REPORT.                          MRKRP010
146600                                                                  MRKRP010
146700     EJECT                                                        MRKRP010
146800*                                                                 MRKRP010
146900******************************************************************   CL**6
147000*Z999-SQL-ERROR.                                                     CL**6
147100******************************************************************   CL**6
147200                                                                     CL**6
147300 Z999-SQL-ERROR.                                                     CL**6
147400*---------------                                                     CL**6
147500                                                                     CL**6
147600     MOVE SQLCODE    TO SQLCODE2.                                    CL**6
147700     MOVE SQLERRD(3) TO SQLERRD3.                                    CL**6
147800     DISPLAY '** ABEND **       ** = SQLERROR'.                      CL**6
147900     DISPLAY '** PROGRAM        ** = MRKRP022'.                      CL**6
148000     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                     CL**6
148100     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                     CL**6
148200     DISPLAY '** SQLERRM        ** = ' SQLERRM.                      CL**6
148300     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                     CL**6
148400     MOVE +4013 TO PV-ABEND-CODE.                                    CL**6
148500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                            CL**6
148600*                                                                    CL**6
148700******************************************************************   CL**6
148800******************************************************************MRKRP010
148900***                    END  OF  PROGRAM                        ***MRKRP010
149000******************************************************************MRKRP010
