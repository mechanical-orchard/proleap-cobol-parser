000100******************************************************************00010028
000200 IDENTIFICATION DIVISION.                                         00020028
000300******************************************************************00030028
000400                                                                  00040028
000500 PROGRAM-ID.                DPKCS200.                             00050028
000600 AUTHOR.                    BRUCE BORCHARDT.                      00060028
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070028
000800 DATE-WRITTEN.              01-23-90.                             00080028
000900 DATE-COMPILED.                                                   00090028
001000                                                                  00100028
001100******************************************************************00110028
001200*  CICS PROGRAM - DPKCS200                                       *00120028
001300*                                                                *00130028
001400*  PLT TRANSACTION TO KICK OFF K019 AND OTHER PLT TIME DB2 PROGS.*00140028
001410*  11/8/99 REMOVED S101 FROM START  B.B                         .*00141028
001420******************************************************************00142028
001430                                                                  00143028
001440******************************************************************00144028
001450 ENVIRONMENT DIVISION.                                            00145028
001460******************************************************************00146028
001470                                                                  00147028
001480******************************************************************00148028
001490 DATA DIVISION.                                                   00149028
001500******************************************************************00150028
001600                                                                  00160028
001700 WORKING-STORAGE SECTION.                                         00170028
001800                                                                  00180028
001900 01  PC-PROGRAM-CONSTANTS.                                        00190028
002000     05  PC-CREDIT-LINE-ACQUIRE-TRANSID                           00200028
002100                                 PIC X(4)     VALUE 'Z201'.       00210028
002200     05  PC-STORE-STATS-INIT-TRANSID                              00220028
002300                                 PIC X(4)     VALUE 'S101'.       00230028
002400     05  PC-STORE-TABLE-BUILD-TRANSID                             00240028
002500                                 PIC X(4)     VALUE 'K019'.       00250028
002600     05  PC-CREDIT-AUTH-SIGNON-TRANSID                            00260028
002700                                 PIC X(4)     VALUE 'K028'.       00270028
002800     05  PC-VISA-NETWORK-REQUEST-TRANS                            00280028
002900                                 PIC X(4)     VALUE 'K029'.       00290028
003000     05  PC-CRFND-AUTH-PARM-BLD-TRANSID                           00300028
003100                                 PIC X(4)     VALUE 'U010'.       00310028
003400*    05  PC-EP-KOHLS-CHARGE-AUTH-TRANS                            00340028
003500*                                PIC X(4)     VALUE 'S200'.       00350028
003600     05  PC-EP-VISA-CHARGE-AUTH-TRANSID                           00360028
003700                                 PIC X(4)     VALUE 'S202'.       00370028
003800     05  PC-EP-DISCOVER-CHARGE-TRANSID                            00380028
003900                                 PIC X(4)     VALUE 'S204'.       00390028
004000     05  PC-EP-CHECK-AUTH-TRANSID                                 00400028
004100                                 PIC X(4)     VALUE 'S206'.       00410028
004200     05  PC-EP-GIFT-CARD-AUTH-TRANSID                             00420028
004300                                 PIC X(4)     VALUE 'S208'.       00430028
004400     05  PC-EP-CASH-REFUND-AUTH-TRANSID                           00440028
004500                                 PIC X(4)     VALUE 'S210'.       00450028
004600     05  PC-EP-STORE-STATS-TRANSID                                00460028
004700                                 PIC X(4)     VALUE 'S222'.       00470028
004800     05  PC-EP-STORE-CNST-TRANSID                                 00480028
004900                                 PIC X(4)     VALUE 'S223'.       00490028
005000     05  PC-END-OF-FIRST-HALF-HOUR                                00500028
005100                                 PIC 9(2)     VALUE 29.           00510028
005200     05  PC-END-OF-SECOND-HALF-HOUR                               00520028
005300                                 PIC 9(2)     VALUE 59.           00530028
005400     05  PC-SECONDS-PER-MINUTE   PIC 9(2)     VALUE 60.           00540028
005500     05  PC-THIRTY-SECONDS-INTERVAL                               00550028
005600                                 PIC S9(7)    VALUE +030          00560028
005700                                              COMP-3.             00570028
005800     05  PC-ONE-MINUTE-INTERVAL  PIC S9(7)    VALUE +100          00580028
005900                                              COMP-3.             00590028
006000     05  PC-NINETY-SECONDS-INTERVAL                               00600028
006100                                 PIC S9(7)    VALUE +130          00610028
006200                                              COMP-3.             00620028
006300     05  PC-TWO-MINUTE-INTERVAL  PIC S9(7)    VALUE +200          00630028
006400                                              COMP-3.             00640028
006500     05  PC-THREE-MINUTE-INTERVAL                                 00650028
006600                                 PIC S9(7)    VALUE +300          00660028
006700                                              COMP-3.             00670028
006800     05  PC-FIVE-O-CLOCK-A-M     PIC S9(7)    VALUE +50000        00680028
006900                                              COMP-3.             00690028
007000     05  PC-FIVE-0-1-A-M         PIC S9(7)    VALUE +50100        00700028
007100                                              COMP-3.             00710028
007200     05  PC-FOUR-0-1-A-M         PIC S9(7)    VALUE +40100        00720028
007300                                              COMP-3.             00730028
007400     05  PC-K029-INPUT           PIC X(7)     VALUE 'K029001'.    00740028
007500                                                                  00750028
007600 01  PV-PROGRAM-VARIABLES.                                        00760028
007700     05  PV-CURRENT-SYSID        PIC X(4)     VALUE SPACES.       00770028
007800         88  PV-KOHLS-PROD-REGION             VALUE 'CIPS'.       00780028
007900     05  PV-EIBTIME              PIC 9(6)     VALUE ZEROS.        00790028
008000     05  FILLER                  REDEFINES PV-EIBTIME.            00800028
008100         10  PV-EIBTIME-HOUR     PIC 9(2).                        00810028
008200         10  PV-EIBTIME-MINUTE   PIC 9(2).                        00820028
008300         10  PV-EIBTIME-SECOND   PIC 9(2).                        00830028
008400     05  PV-INTERVAL             PIC 9(6)     VALUE ZEROS.        00840028
008500     05  FILLER                  REDEFINES PV-INTERVAL.           00850028
008600         10  PV-INTERVAL-HOUR    PIC 9(2).                        00860028
008700         10  PV-INTERVAL-MINUTE  PIC 9(2).                        00870028
008800         10  PV-INTERVAL-SECOND  PIC 9(2).                        00880028
008900     05  PV-INTERVAL-PACKED      PIC S9(7)    VALUE ZEROS         00890028
009000                                              COMP-3.             00900028
009100                                                                  00910028
009200******************************************************************00920028
009300 PROCEDURE DIVISION.                                              00930028
009400******************************************************************00940028
009500                                                                  00950028
009600 0000-MAIN-LINE.                                                  00960028
009700     EXEC CICS                                                    00970028
009800         ASSIGN                                                   00980028
009900             SYSID (PV-CURRENT-SYSID)                             00990028
010000     END-EXEC.                                                    01000028
010100                                                                  01010028
010200*    IF PV-KOHLS-PROD-REGION                                      01020029
010300*        EXEC CICS                                                01030029
010400*            START                                                01040029
010500*                TRANSID  (PC-CREDIT-LINE-ACQUIRE-TRANSID)        01050029
010600*                INTERVAL (PC-ONE-MINUTE-INTERVAL)                01060029
010700*        END-EXEC                                                 01070029
010800*    END-IF.                                                      01080029
010900                                                                  01090028
011000     IF EIBTIME > PC-FIVE-O-CLOCK-A-M                             01100028
011100         MOVE EIBTIME TO PV-EIBTIME                               01110028
011200         INITIALIZE PV-INTERVAL                                   01120028
011300         IF PV-EIBTIME-MINUTE > PC-END-OF-FIRST-HALF-HOUR         01130028
011400             COMPUTE PV-INTERVAL-MINUTE =                         01140028
011500                       (PC-END-OF-SECOND-HALF-HOUR -              01150028
011600                       PV-EIBTIME-MINUTE)                         01160028
011700         ELSE                                                     01170028
011800             COMPUTE PV-INTERVAL-MINUTE =                         01180028
011900                       (PC-END-OF-FIRST-HALF-HOUR -               01190028
012000                       PV-EIBTIME-MINUTE)                         01200028
012100         END-IF                                                   01210028
012200         COMPUTE PV-INTERVAL-SECOND =                             01220028
012300                   (PC-SECONDS-PER-MINUTE - PV-EIBTIME-SECOND)    01230028
012400         MOVE PV-INTERVAL TO PV-INTERVAL-PACKED                   01240028
012500*        EXEC CICS                                                01250028
012600*            START                                                01260028
012700*                TRANSID  (PC-STORE-STATS-INIT-TRANSID)           01270028
012800*                INTERVAL (PV-INTERVAL-PACKED)                    01280028
012900*        END-EXEC                                                 01290028
013000*        EXEC CICS                                                01300028
013100*            START                                                01310028
013200*                TRANSID  (PC-EP-STORE-STATS-TRANSID)             01320028
013300*                INTERVAL (PV-INTERVAL-PACKED)                    01330028
013400*        END-EXEC                                                 01340028
013500*        EXEC CICS                                                01350028
013600*            START                                                01360028
013700*                TRANSID  (PC-EP-STORE-CNST-TRANSID)              01370028
013800*                INTERVAL (PV-INTERVAL-PACKED)                    01380028
013810*        END-EXEC                                                 01381028
013820*    ELSE                                                         01382028
013830*        EXEC CICS                                                01383028
013840*            START                                                01384028
013850*                TRANSID  (PC-STORE-STATS-INIT-TRANSID)           01385028
013860*                TIME     (PC-FIVE-O-CLOCK-A-M)                   01386028
013870*        END-EXEC                                                 01387028
013880*        EXEC CICS                                                01388028
013890*            START                                                01389028
013900*                TRANSID  (PC-EP-STORE-STATS-TRANSID)             01390028
014000*                TIME     (PC-FIVE-0-1-A-M)                       01400028
014100*        END-EXEC                                                 01410028
014200*        EXEC CICS                                                01420028
014300*            START                                                01430028
014400*                TRANSID  (PC-EP-STORE-CNST-TRANSID)              01440028
014500*                TIME     (PC-FOUR-0-1-A-M)                       01450028
014600*        END-EXEC                                                 01460028
014700     END-IF.                                                      01470028
014800                                                                  01480028
014900*    EXEC CICS                                                    01490028
015000*        START                                                    01500028
015100*            TRANSID  (PC-STORE-TABLE-BUILD-TRANSID)              01510028
015200*            INTERVAL (PC-ONE-MINUTE-INTERVAL)                    01520028
015300*    END-EXEC.                                                    01530028
015400                                                                  01540028
015500*    EXEC CICS                                                    01550028
015600*        START                                                    01560028
015700*            TRANSID  (PC-CREDIT-AUTH-SIGNON-TRANSID)             01570028
015800*            INTERVAL (001000)                                    01580028
015900*            INTERVAL (PC-NINETY-SECONDS-INTERVAL)                01590028
016000*    END-EXEC.                                                    01600028
016100                                                                  01610028
016200*    EXEC CICS                                                    01620028
016300*        START                                                    01630028
016400*            TRANSID  (PC-VISA-NETWORK-REQUEST-TRANS)             01640028
016500*            INTERVAL (PC-TWO-MINUTE-INTERVAL)                    01650028
016600*            FROM(PC-K029-INPUT) LENGTH(7)                        01660028
016700*    END-EXEC.                                                    01670028
016800                                                                  01680028
016900     EXEC CICS                                                    01690028
017000         START                                                    01700028
017100             TRANSID  (PC-CRFND-AUTH-PARM-BLD-TRANSID)            01710028
017200             INTERVAL (PC-ONE-MINUTE-INTERVAL)                    01720028
017300     END-EXEC.                                                    01730028
017400                                                                  01740028
018100*    EXEC CICS                                                    01810028
018200*        START                                                    01820028
018300*            TRANSID  (PC-EP-KOHLS-CHARGE-AUTH-TRANS)             01830028
018400*            INTERVAL (PC-THREE-MINUTE-INTERVAL)                  01840028
018500*    END-EXEC.                                                    01850028
018600                                                                  01860028
018700*    EXEC CICS                                                    01870028
018800*        START                                                    01880028
018900*            TRANSID  (PC-EP-VISA-CHARGE-AUTH-TRANSID)            01890028
019000*            INTERVAL (010000)                                    01900028
019100*    END-EXEC.                                                    01910028
019200                                                                  01920028
019300*    EXEC CICS                                                    01930028
019400*        START                                                    01940028
019500*            TRANSID  (PC-EP-DISCOVER-CHARGE-TRANSID)             01950028
019600*            INTERVAL (010000)                                    01960028
019700*    END-EXEC.                                                    01970028
019800                                                                  01980028
019900*    EXEC CICS                                                    01990028
020000*        START                                                    02000028
020100*            TRANSID  (PC-EP-CHECK-AUTH-TRANSID)                  02010028
020200*            INTERVAL (010000)                                    02020028
020300*    END-EXEC.                                                    02030028
020400                                                                  02040028
020500*    EXEC CICS                                                    02050028
020600*        START                                                    02060028
020700*            TRANSID  (PC-EP-GIFT-CARD-AUTH-TRANSID)              02070028
020800*            INTERVAL (010000)                                    02080028
020900*    END-EXEC.                                                    02090028
021000                                                                  02100028
021100*    EXEC CICS                                                    02110028
021200*        START                                                    02120028
021300*            TRANSID  (PC-EP-CASH-REFUND-AUTH-TRANSID)            02130028
021400*            INTERVAL (010000)                                    02140028
021500*    END-EXEC.                                                    02150028
021600     EXEC CICS                                                    02160028
021700         RETURN                                                   02170028
021800     END-EXEC.                                                    02180028
