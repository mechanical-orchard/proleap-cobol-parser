000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TRKUT240.                                          00050000
000600 AUTHOR.       THERESE RAMSEYER.                                  00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. JANUARY, 1999.                                     00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM EDITS THE CUSTOMS DATA.                          *00120000
001300*  THE INPUT FOR THIS PROGRAM CONSISTS OF 11 DIFFERENT RECORD     00130000
001400*  TYPES THAT MAY BE PRESENT ON A FILE.                           00140000
001500*  ENF    = THE CUSTOMS ENTRY FILED BY THE CUSTOMS BROKER WITH    00150000
001600*           UNITED STATES CUSTOMS.                                00160000
001700*  ENFBOL = THE BILL OF LADING NUMBERS ON THE CUSTOMS ENTRY.      00170000
001800*  ENFCON = THE CONTAINER IDENTIFIERS ON THE CUSTOMS ENTRY.       00180000
001810*  DOP    = DATE THE DELIVERY ORDER WAS CREATED.                  00181000
001900*  ENFPO  = THE PURCHASE ORDER NUMBERS ON THE CUSTOMS ENTRY.      00190000
002000*  EXD    = WHEN U.S.CUSTOMS NOTIFIES THE CUSTOMS BROKER TO SET   00200000
002100*           UP AN EXAM DATE.                                      00210000
002200*  REJ    = THE U.S.CUSTOMS REJECTION DATE OF A CUSTOMS ENTRY AND 00220000
002300*           AND THE REASON FOR THE REJECTION.                     00230000
002400*  ECR    = ESTIMATED DATE U.S.CUSTOMS SHOULD CLEAR THE ENTRY.    00240000
002500*  RLS    = THE DATE U.S. CUSTOMS CLEARED THE ENTRY.              00250000
002600*  LIQ    = THE DATE U.S.CUSTOMS DECLARES THE ENTRY LIQUIDATED.   00260000
002700*  LSU    = THE DATE U.S.CUSTOMS DECLARES THE ENTRY SUSPENDED     00270000
002800*           FROM LIQUIDATION.                                     00280000
002900*                                                                 00290000
003000*  EACH OF THE 11 RECORD TYPES MAY BE ANY TRANSACTION TYPE:       00300000
003100*            (A) ADD, (D) DELETE OR (C) CHANGE.                   00310000
003200*                                                                 00320000
003300*  THE KEY FIELD IS : CSTM-ENTR-ID  (CUSTOMS ENTRY IDENTIFIER)    00330000
003400*                                                                 00340000
003500*  A PROCESS SEQUENCE NUMBER IS ASSIGNED TO EACH RECORD. THIS     00350000
003600*  NUMBER WILL BE REFLECTED IN THE LOAD PROGRAM ON EACH CONTAINER 00360000
003700*  RECORD. THIS WAY, THE ERROR EXTRACT CAN BE SORTED AND ALL OF   00370000
003800*  THE ERROR/WARNING MESSAGES WILL BE INCLUDED TOGETHER FOR EACH  00380000
003900*  CONTAINER RECORD WHETHER IT CAME FROM THE EDIT PROGRAM OR THE  00390000
004000*  LOAD.                                                          00400000
004100*  DATES ARE CHECKED FOR VALIDITY BY CALLING THE KOHL'S CALENDAR  00410000
004200*  ROUTINE DPKUT500.                                              00420000
004300*  TIME FIELDS ARE GENERALLY ONLY EDITED FOR VALIDITY IF THEY ARE 00430000
004400*  SENT. MOST ARE NOT REQUIRED SINCE IT IS NECESSARY TO USE A     00440000
004500*  DEFAULT TIME WHEN UPDATING AND DEFAULT DATE AND TIME WHEN      00450000
004600*  DELETING.                                                      00460000
004700*  EACH RECORD TYPE IS INDEPENDENT OF EACH OTHER. NO ONE TYPE     00470000
004800*  OF RECORD IS REQUIRED BEFORE THE PROCESSING OF ANOTHER.        00480000
004900*                                                                 00490000
005000******************************************************************00500000
005100******************************************************************00510000
005200 ENVIRONMENT DIVISION.                                            00520000
005300******************************************************************00530000
005400                                                                  00540000
005500 CONFIGURATION SECTION.                                           00550000
005600                                                                  00560000
005700 SOURCE-COMPUTER.        IBM-3090.                                00570000
005800 OBJECT-COMPUTER.        IBM-3090.                                00580000
005900                                                                  00590000
006000 INPUT-OUTPUT SECTION.                                            00600000
006100                                                                  00610000
006200 FILE-CONTROL.                                                    00620000
006300                                                                  00630000
006400     SELECT TR017-CUSTOMS-FILE                                    00640000
006500         ASSIGN TO INP01.                                         00650000
006600                                                                  00660000
006700     SELECT TR027-UPDATE-CUSTOMS-FILE                             00670000
006800         ASSIGN TO OUT01.                                         00680000
006900                                                                  00690000
007000     SELECT TR241-CUSTOMS-ERROR-FILE                              00700000
007100         ASSIGN TO OUT02.                                         00710000
007200                                                                  00720000
007300******************************************************************00730000
007400 DATA DIVISION.                                                   00740000
007500******************************************************************00750000
007600                                                                  00760000
007700 FILE SECTION.                                                    00770000
007800                                                                  00780000
007900 FD  TR017-CUSTOMS-FILE                                           00790000
008000     RECORDING MODE IS F                                          00800000
008100     LABEL RECORDS ARE STANDARD                                   00810000
008200     BLOCK CONTAINS 0 RECORDS.                                    00820000
008300                                                                  00830000
008400 01  TR017-CUSTOMS-RECORD            PIC X(300).                  00840000
008500                                                                  00850000
008600 FD  TR027-UPDATE-CUSTOMS-FILE                                    00860000
008700     RECORDING MODE IS F                                          00870000
008800     LABEL RECORDS ARE STANDARD                                   00880000
008900     BLOCK CONTAINS 0 RECORDS.                                    00890000
009000                                                                  00900000
009100 01  TR027-UPDATE-CUSTOMS-RECORD     PIC X(300).                  00910000
009200                                                                  00920000
009300 FD  TR241-CUSTOMS-ERROR-FILE                                     00930000
009400     RECORDING MODE IS F                                          00940000
009500     LABEL RECORDS ARE STANDARD                                   00950000
009600     BLOCK CONTAINS 0 RECORDS.                                    00960000
009700                                                                  00970000
009800 01  TR241-CUSTOMS-ERROR-RECORD      PIC X(508).                  00980000
009900                                                                  00990000
010000******************************************************************01000000
010100 WORKING-STORAGE SECTION.                                         01010000
010200******************************************************************01020000
010300                                                                  01030000
010400******************************************************************01040000
010500*  DB2 FORMATTED MESSAGE AREA                                     01050000
010600******************************************************************01060000
010700     COPY DPWS004.                                                01070000
010800                                                                  01080000
010900******************************************************************01090000
011000*  COMMUNICATIONS AREA FOR DB2                                    01100000
011100******************************************************************01110000
011200     EXEC SQL                                                     01120000
011300          INCLUDE SQLCA                                           01130000
011400     END-EXEC.                                                    01140000
011500                                                                  01150000
011600******************************************************************01160000
011700*  DB2 TABLE DECLARATION -  ET-TRADING PARTNERSHIP TABLE.         01170000
011800*      (TTRDPRT)                                                  01180000
011900******************************************************************01190000
012000     EXEC SQL                                                     01200000
012100          INCLUDE TTRDPRT                                         01210000
012200     END-EXEC.                                                    01220000
012300                                                                  01230000
012400******************************************************************01240000
012500*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                01250000
012600*      (TENTNME)                                                  01260000
012700******************************************************************01270000
012800     EXEC SQL                                                     01280000
012900          INCLUDE TENTNME                                         01290000
013000     END-EXEC.                                                    01300000
013100                                                                  01310000
013200******************************************************************01320000
013300*  DB2 TABLE DECLARATION -  PORT OF ENTRY TABLE.                  01330000
013400*      (TIMPOE)                                                   01340000
013500******************************************************************01350000
013600     EXEC SQL                                                     01360000
013700          INCLUDE TIMPOE                                          01370000
013800     END-EXEC.                                                    01380000
013900                                                                  01390000
014000******************************************************************01400000
014100*  DB2 TABLE DECLARATION -  CUSTOMS ENTRY TABLE.                  01410000
014200*      (TIMCSEN)                                                  01420000
014300******************************************************************01430000
014400     EXEC SQL                                                     01440000
014500          INCLUDE TIMCSEN                                         01450000
014600     END-EXEC.                                                    01460000
014700                                                                  01470000
014701******************************************************************01470100
014702*  DB2 TABLE DECLARATION -  CONTAINER PO TABLE.                   01470200
014703*      (TIMCSEN)                                                  01470300
014704******************************************************************01470400
014705     EXEC SQL                                                     01470500
014706          INCLUDE TIMCNPO                                         01470600
014707     END-EXEC.                                                    01470700
014708                                                                  01470800
014710******************************************************************01471000
014720*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE TABLE.             01472000
014730*      (TEXTENT)                                                  01473000
014740******************************************************************01474000
014750     EXEC SQL                                                     01475000
014760          INCLUDE TEXTENT                                         01476000
014770     END-EXEC.                                                    01477000
014780                                                                  01478000
014781******************************************************************01478100
014782*  DB2 TABLE DECLARATION - IMPORTS CODE MASTER                    01478200
014783*      (TICDMST)                                                  01478300
014784******************************************************************01478400
014785     EXEC SQL                                                     01478500
014786          INCLUDE TICDMST                                         01478600
014787     END-EXEC.                                                    01478700
014788                                                                  01478800
014789******************************************************************01478900
014790*  DB2 TABLE DECLARATION - IMPORTS CODE VALUE                     01479000
014791*      (TICDVAL)                                                  01479100
014792******************************************************************01479200
014793     EXEC SQL                                                     01479300
014794          INCLUDE TICDVAL                                         01479400
014795     END-EXEC.                                                    01479500
014796                                                                  01479600
014797******************************************************************01479700
014798*  DB2 TABLE DECLARATION -  PLANNED SHIPMENT TABLE.               01479800
014799*      (TPLNSHP)                                                  01479900
014800******************************************************************01480000
014801     EXEC SQL                                                     01480100
014802          INCLUDE TPLNSHP                                         01480200
014803     END-EXEC.                                                    01480300
014804                                                                  01480400
014805******************************************************************01480500
014806*  DB2 TABLE DECLARATION -  FOR TABLE TIMFOB.                     01480600
014807*      (TIMFOB)                                                   01480700
014808******************************************************************01480800
014809     EXEC SQL                                                     01480900
014810          INCLUDE TIMFOB                                          01481000
014811     END-EXEC.                                                    01481100
014812                                                                  01481200
014820******************************************************************01482000
014900*  CUSTOMS DATA LAYOUT                                            01490000
015000******************************************************************01500000
015100     COPY TRRD017.                                                01510000
015200 EJECT                                                            01520000
015300                                                                  01530000
015400******************************************************************01540000
015500*  EDITED CUSTOMS DATA LAYOUT                                     01550000
015600******************************************************************01560000
015700     COPY TRRD027.                                                01570000
015800 EJECT                                                            01580000
015900                                                                  01590000
016000******************************************************************01600000
016100*  CUSTOMS REPORT RECORD LAYOUT - EXTRACT FOR THE ERROR REPORT.  *01610000
016200*  IT IS USED TO FORMAT THE ERROR RECORDS.  THEY ARE THEN        *01620000
016300*  WRITTEN TO AN OUTPUT FILE.  THE ERRORS WILL BE COMBINED WITH  *01630000
016400*  ERRORS FROM PROGRAM TRKUP245 AND WILL LATER BE USED AS INPUT  *01640000
016500*  TO THE ERROR REPORT PROGRAM WHICH WILL CREATE AN ERROR REPORT *01650000
016600*  OF CUSTOMS RECORDS.                                           *01660000
016700******************************************************************01670000
016800     COPY TRRD241.                                                01680000
016900 EJECT                                                            01690000
017000                                                                  01700000
017100     COPY DPWS500.                                                01710000
017200 EJECT                                                            01720000
017300                                                                  01730000
017400                                                                  01740000
017500                                                                  01750000
017600 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01760000
017700                                                   COMP SYNC.     01770000
017800 01  PA-PROGRAM-ACCUMULATORS.                                     01780000
017900     05  PA-TOTALS.                                               01790000
018000         10 PA-TOTAL-INPUT-READ       PIC  S9(09)  VALUE +0       01800000
018100                                                     COMP-3.      01810000
018200         10 PA-TOTAL-EDI-REC-READ     PIC  S9(13)  VALUE +0       01820000
018300                                                     COMP-3.      01830000
018400         10 PA-TOT-CSTM-RECS-ADD      PIC  S9(13)  VALUE +0       01840000
018500                                                     COMP-3.      01850000
018600         10 PA-TOT-CSTM-RECS-DELETE   PIC  S9(13)  VALUE +0       01860000
018700                                                     COMP-3.      01870000
018800         10 PA-TOT-CSTM-RECS-CHANGE   PIC  S9(13)  VALUE +0       01880000
018900                                                     COMP-3.      01890000
019000         10 PA-TOT-INVALID-REC-TYP    PIC  S9(13)  VALUE +0       01900000
019100                                                     COMP-3.      01910000
019200         10 PA-TOT-INVALID-TRN-TYP    PIC  S9(13)  VALUE +0       01920000
019300                                                     COMP-3.      01930000
019400                                                                  01940000
019500 01  PS-PROGRAM-SWITCHES.                                         01950000
019600     05  PS-END-OF-ENTRIES-SW          PIC  X(01)    VALUE 'N'.   01960000
019700         88  PS-END-OF-ENTRIES                       VALUE 'Y'.   01970000
019800         88  PS-END-OF-ENTRIES-NO                    VALUE 'N'.   01980000
019900     05  PS-VALID-REC-TYP-CDE-SW       PIC  X(01)    VALUE 'N'.   01990000
020000         88  PS-VALID-REC-TYP-CDE                    VALUE 'Y'.   02000000
020100         88  PS-VALID-REC-TYP-CDE-NO                 VALUE 'N'.   02010000
020200     05  PS-VALID-TRN-TYP-SW           PIC  X(01)    VALUE 'N'.   02020000
020300         88  PS-VALID-TRN-TYP                        VALUE 'Y'.   02030000
020400         88  PS-VALID-TRN-TYP-NO                     VALUE 'N'.   02040000
020500     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   02050000
020600         88  PS-GOOD-RECORD                          VALUE 'Y'.   02060000
020700         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   02070000
020800     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.   02080000
020900         88  PS-EDIT-ERROR                           VALUE 'Y'.   02090000
021000         88  PS-EDIT-ERROR-NO                        VALUE 'N'.   02100000
021100     05  PS-EDI-RECORD-SW              PIC  X(01)    VALUE 'N'.   02110000
021200         88  PS-EDI-RECORD                           VALUE 'Y'.   02120000
021300         88  PS-EDI-RECORD-NO                        VALUE 'N'.   02130000
021400     05  PS-END-ID-SW                  PIC  X(01)    VALUE 'N'.   02140000
021500         88  PS-ENT-ID-PRESENT                       VALUE 'Y'.   02150000
021600         88  PS-ENT-ID-PRESENT-NO                    VALUE 'N'.   02160000
022000     05  PS-ENTNME-SW                  PIC X(01)     VALUE 'Y'.   02200000
022100         88  PS-VALID-ENTNME                         VALUE 'Y'.   02210000
022200         88  PS-INVALID-ENTNME                       VALUE 'N'.   02220000
022300     05  PS-WRITE-THIS-EDI-SW          PIC  X(01)    VALUE 'N'.   02230000
022400         88  PS-WRITE-THIS-EDI                       VALUE 'Y'.   02240000
022500         88  PS-WRITE-THIS-EDI-NO                    VALUE 'N'.   02250000
022600     05  PS-POE-FOUND-SW               PIC  X(01)    VALUE 'N'.   02260000
022700         88  PS-POE-FOUND                            VALUE 'Y'.   02270000
022800         88  PS-POE-FOUND-NO                         VALUE 'N'.   02280000
022900     05  PS-POE-CDE-PRESENT-SW         PIC  X(01)    VALUE 'N'.   02290000
023000         88  PS-POE-CDE-PRESENT                      VALUE 'Y'.   02300000
023100         88  PS-POE-CDE-PRESENT-NO                   VALUE 'N'.   02310000
023110     05  PS-VALID-SCAC-SW               PIC X(01)     VALUE 'Y'.  02311000
023120         88  PS-VALID-SCAC                           VALUE 'Y'.   02312000
023130         88  PS-VALID-SCAC-NO                         VALUE 'N'.  02313000
023131     05  PS-VALID-ENTR-TYP-CDE-SW       PIC X(01)    VALUE 'N'.   02313100
023132         88  PS-VALID-ENTR-TYP-CDE                   VALUE 'Y'.   02313200
023133         88  PS-VALID-ENTR-TYP-CDE-NO                VALUE 'N'.   02313300
023134     05  PS-PO-FOUND-SW                 PIC X(01)    VALUE 'N'.   02313400
023135         88  PS-PO-FOUND                             VALUE 'Y'.   02313500
023136         88  PS-PO-FOUND-NO                          VALUE 'N'.   02313600
023137     05  PS-EXTL-REF-FOUND-SW           PIC X(01)    VALUE 'N'.   02313700
023138         88  PS-EXTL-REF-FOUND                       VALUE 'Y'.   02313800
023139         88  PS-EXTL-REF-FOUND-NO                    VALUE 'N'.   02313900
023140     05  PS-MSTR-BOL-FOUND-SW           PIC X(01)    VALUE 'N'.   02314000
023141         88  PS-MSTR-BOL-FOUND                       VALUE 'Y'.   02314100
023142         88  PS-MSTR-BOL-FOUND-NO                    VALUE 'N'.   02314200
023143     05  PS-HSE-BOL-FOUND-SW            PIC X(01)    VALUE 'N'.   02314300
023144         88  PS-HSE-BOL-FOUND                        VALUE 'Y'.   02314400
023145         88  PS-HSE-BOL-FOUND-NO                     VALUE 'N'.   02314500
023146     05  PS-NEED-ENFPO-FOB-SCAC-SW      PIC X(01)    VALUE 'N'.   02314600
023147         88  PS-NEED-ENFPO-FOB-SCAC                  VALUE 'Y'.   02314700
023148         88  PS-NEED-ENFPO-FOB-SCAC-NO               VALUE 'N'.   02314800
023150                                                                  02315000
023200                                                                  02320000
023300 01  PC-PROGRAM-CONSTANTS.                                        02330000
023400     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          02340000
023500         'TRKUT240'.                                              02350000
023600     05  PC-01                       PIC X(02)     VALUE '01'.    02360000
023700     05  PC-10                       PIC X(02)     VALUE '10'.    02370000
023800     05  PC-11                       PIC X(02)     VALUE '11'.    02380000
023900     05  PC-19                       PIC X(02)     VALUE '19'.    02390000
024000     05  PC-20                       PIC X(02)     VALUE '20'.    02400000
024100     05  PC-21                       PIC X(02)     VALUE '21'.    02410000
024200     05  PC-22                       PIC X(02)     VALUE '22'.    02420000
024300     05  PC-98                       PIC X(02)     VALUE '98'.    02430000
024400     05  PC-99                       PIC X(02)     VALUE '99'.    02440000
024500     05  PC-A                        PIC X(01)     VALUE 'A'.     02450000
024600     05  PC-B                        PIC X(01)     VALUE 'B'.     02460000
024700     05  PC-C                        PIC X(01)     VALUE 'C'.     02470000
024800     05  PC-D                        PIC X(01)     VALUE 'D'.     02480000
024900     05  PC-E                        PIC X(01)     VALUE 'E'.     02490000
025000     05  PC-M                        PIC X(01)     VALUE 'M'.     02500000
025100     05  PC-O                        PIC X(01)     VALUE 'O'.     02510000
025200     05  PC-Y                        PIC X(01)     VALUE 'Y'.     02520000
025210     05  PC-Z                        PIC X(01)     VALUE 'Z'.     02521000
025300     05  PC-A0                       PIC X(02)     VALUE 'A0'.    02530000
025400     05  PC-CFS                      PIC X(03)     VALUE 'CFS'.   02540000
025500     05  PC-CY                       PIC X(02)     VALUE 'CY'.    02550000
025600                                                                  02560000
025700     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   02570000
025800     05  PC-CTT                      PIC X(03)     VALUE 'CTT'.   02580000
025900     05  PC-IEA                      PIC X(03)     VALUE 'IEA'.   02590000
026000     05  PC-ENF                      PIC X(06)     VALUE 'ENF   '.02600000
026100     05  PC-ENFBOL                   PIC X(06)     VALUE 'ENFBOL'.02610000
026200     05  PC-ENFCON                   PIC X(06)     VALUE 'ENFCON'.02620000
026210     05  PC-DOP                      PIC X(06)     VALUE 'DOP   '.02621000
026300     05  PC-ENFPO                    PIC X(06)     VALUE 'ENFPO '.02630000
026400     05  PC-EXD                      PIC X(06)     VALUE 'EXD   '.02640000
026500     05  PC-REJ                      PIC X(06)     VALUE 'REJ   '.02650000
026600     05  PC-ECR                      PIC X(06)     VALUE 'ECR   '.02660000
026700     05  PC-RLS                      PIC X(06)     VALUE 'RLS   '.02670000
026800     05  PC-LIQ                      PIC X(06)     VALUE 'LIQ   '.02680000
026900     05  PC-LSU                      PIC X(06)     VALUE 'LSU   '.02690000
027000                                                                  02700000
027100     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   02710000
027200     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   02720000
027300     05  PC-EMPTY                    PIC X(03)     VALUE 'EMT'.   02730000
027400     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.02740000
027500     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.   02750000
027600     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.   02760000
027700     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   02770000
027800     05  PC-DASH                     PIC X(01)     VALUE '-'.     02780000
027900     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          02790000
028000                                     '9999-09-09-00.00.00.000000'.02800000
028100     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          02810000
028200                                     '0001-01-01-00.00.00.000000'.02820000
028410     05  PC-DEFAULT-DTE              PIC X(10)     VALUE          02841000
028420                                     '0001-01-01'.                02842000
028500     05  PC-DEFAULT-DATE             PIC X(08)     VALUE          02850000
028600                                     '00010101'.                  02860000
028700     05  PC-DEFAULT-TIME             PIC X(04)     VALUE          02870000
028800                                     '0000'.                      02880000
028900     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       02890000
029000                                                     COMP-3.      02900000
029001     05  PC-DATA-ID-900              PIC S9(4)     VALUE +900     02900100
029010                                                    COMP.         02901000
029020     05  PC-FOB-SCAC-MSG.                                         02902000
029030         10  PC-FIL1           PIC X(12) VALUE 'KOHLS FOB= '.     02903000
029040         10  PC-FOB            PIC X(03)     VALUE SPACE.         02904000
029050         10  PC-FIL2           PIC X(03)     VALUE SPACE.         02905000
029060         10  PC-FIL3           PIC X(13) VALUE 'CONSOL SCAC= '.   02906000
029070         10  PC-SCAC           PIC X(04)     VALUE SPACE.         02907000
029080         10  PC-FIL4           PIC X(02)     VALUE SPACE.         02908000
029090         10  PC-FIL5           PIC X(04) VALUE 'PO= '.            02909000
029091         10  PC-PO             PIC X(09)     VALUE SPACE.         02909100
029100                                                                  02910000
029200 01  PV-PROGRAM-VARIABLES.                                        02920000
029300     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.  02930000
029400     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.  02940000
029500     05  PV-PO-NBR                   PIC  X(9)     VALUE SPACES.  02950000
029600     05  PV-CURRENT-POE-CDE          PIC  X(4)     VALUE SPACES.  02960000
029610     05  PV-LAST-GOOD-POE-CDE        PIC  X(4)     VALUE SPACES.  02961000
029620     05  PV-LAST-GOOD-POE-NM         PIC X(30)     VALUE SPACES.  02962000
029700     05  PV-CURRENT-POE-NM           PIC X(30)     VALUE SPACES.  02970000
029900     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0       02990000
029901                                                   COMP.          02990100
029902     05  PV-SAVE-ER-SEQ-NBR          PIC S9(06)    VALUE +0       02990200
029903                                                   COMP.          02990300
029910     05  PV-FOB-CDE                  PIC X(03)     VALUE SPACES.  02991000
029911     05  PV-SCAC-CDE                 PIC X(04)     VALUE SPACES.  02991100
029912     05  PV-PO-NBR-FOB               PIC S9(09)    VALUE ZEROS    02991200
029920                                                   COMP.          02992000
030100                                                                  03010000
030400     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.  03040000
030500     05  PV-HOLD-LAST-REC-TYP        PIC X(03)     VALUE SPACES.  03050000
030600                                                                  03060000
030610     05  PV-CARR-SCAC-ID             PIC X(04)     VALUE SPACES.  03061000
030611     05  PV-MOM-TRIP-TYP             PIC X(01)     VALUE SPACES.  03061100
030612     05  PV-CSTM-ENTR-ID             PIC X(12)     VALUE SPACES.  03061200
030620                                                                  03062000
030700     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                   03070000
030800         88  TRN-TYP-ADD                           VALUE 'A'.     03080000
030900         88  TRN-TYP-CHG                           VALUE 'C'.     03090000
031000         88  TRN-TYP-DEL                           VALUE 'D'.     03100000
031100                                                                  03110000
031200     05  PV-EVAL-REC-TYP-CDE         PIC X(06).                   03120000
031300         88  REC-TYP-ENF                           VALUE 'ENF   '.03130000
031400         88  REC-TYP-ENFBOL                        VALUE 'ENFBOL'.03140000
031500         88  REC-TYP-ENFCON                        VALUE 'ENFCON'.03150000
031510         88  REC-TYP-DOP                           VALUE 'DOP   '.03151000
031600         88  REC-TYP-ENFPO                         VALUE 'ENFPO '.03160000
031700         88  REC-TYP-EXD                           VALUE 'EXD   '.03170000
031800         88  REC-TYP-REJ                           VALUE 'REJ   '.03180000
031900         88  REC-TYP-ECR                           VALUE 'ECR   '.03190000
032000         88  REC-TYP-RLS                           VALUE 'RLS   '.03200000
032100         88  REC-TYP-LIQ                           VALUE 'LIQ   '.03210000
032200         88  REC-TYP-LSU                           VALUE 'LSU   '.03220000
032300                                                                  03230000
032400     05  PV-CHECK-REC-TYP-CDE        PIC X(06).                   03240000
032500         88  VALID-REC-TYP-CDE                     VALUE 'ENF   ',03250000
032600                                                         'ENFBOL',03260000
032700                                                         'ENFCON',03270000
032710                                                         'DOP   ',03271000
032800                                                         'ENFPO ',03280000
032900                                                         'EXD   ',03290000
033000                                                         'REJ   ',03300000
033100                                                         'ECR   ',03310000
033200                                                         'RLS   ',03320000
033300                                                         'LIQ   ',03330000
033400                                                         'LSU   ',03340000
033500                                                         'IEA   ',03350000
033600                                                         'ISA   '.03360000
033700                                                                  03370000
033800     05  PV-REC-CHECK                PIC  X(03)  VALUE SPACES.    03380000
033900                                                                  03390000
034000     05  PV-EDI-RECORDS              PIC  X(03).                  03400000
034100         88  EDI-IEA-RECORD                        VALUE 'IEA'.   03410000
034200         88  EDI-CTT-RECORD                        VALUE 'CTT'.   03420000
034300         88  EDI-ISA-RECORD                        VALUE 'ISA'.   03430000
034400                                                                  03440000
034500     05  PV-HOLD-EDI-RECORD.                                      03450000
034600         10  FILLER                  PIC X(32)     VALUE SPACES.  03460000
034700         10  PV-EDI-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.  03470000
034800         10  FILLER                  PIC X(01)     VALUE SPACES.  03480000
034900         10  PV-EDI-VEND-ID          PIC X(15)     VALUE SPACES.  03490000
035000         10  FILLER                  PIC X(20)     VALUE SPACES.  03500000
035100         10  PV-EDI-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.  03510000
035200         10  FILLER                  PIC X(01)     VALUE SPACES.  03520000
035300         10  PV-EDI-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.  03530000
035400         10  FILLER                  PIC X(09)     VALUE SPACES.  03540000
035500         10  PV-EDI-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.  03550000
035600         10  FILLER                  PIC X(51)     VALUE SPACES.  03560000
035700                                                                  03570000
035800     05  PV-TMST                     PIC X(26)     VALUE SPACES.  03580000
035900     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  03590000
036000     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  03600000
036100     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       03610000
036200                                                    COMP SYNC.    03620000
036300                                                                  03630000
036400     05  PV-FORMAT-TMST.                                          03640000
036500         10  PV-FORMAT-TMST-DTE.                                  03650000
036600             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  03660000
036700             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     03670000
036800             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  03680000
036900             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     03690000
037000             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  03700000
037100             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     03710000
037200         10  PV-FORMAT-TMST-TM.                                   03720000
037300             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  03730000
037400             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     03740000
037500             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  03750000
037600             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          03760000
037700                                                     '.00.000000'.03770000
037800     05  PV-FORMAT-DYDT.                                          03780000
037900         10  PV-FORMAT-DYDT-DTE-CY  PIC X(04)  VALUE SPACES.      03790000
038000         10  PV-FORMAT-DYDT-DTE-D1  PIC X(01)  VALUE '-'.         03800000
038100         10  PV-FORMAT-DYDT-DTE-MM  PIC X(02)  VALUE SPACES.      03810000
038200         10  PV-FORMAT-DYDT-DTE-D2  PIC X(01)  VALUE '-'.         03820000
038300         10  PV-FORMAT-DYDT-DTE-DD  PIC X(02)  VALUE SPACES.      03830000
038400         10  PV-FORMAT-DYDT-DTE-D3  PIC X(01)  VALUE '-'.         03840000
038500         10  PV-FORMAT-DYDT-TM-HH   PIC X(02)  VALUE SPACES.      03850000
038600         10  PV-FORMAT-DYDT-TM-D1   PIC X(01)  VALUE '.'.         03860000
038700         10  PV-FORMAT-DYDT-TM-MM   PIC X(02)  VALUE SPACES.      03870000
038800         10  PV-FORMAT-DYDT-TM-D2   PIC X(10)  VALUE '.00.000000'.03880000
038900                                                                  03890000
039000     05  PV-REFORMAT-TMST.                                        03900000
039100         10  PV-REFORMAT-TMST-DTE.                                03910000
039200             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.03920000
039300             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.03930000
039400             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.03940000
039500         10  PV-REFORMAT-TMST-TM.                                 03950000
039600             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.03960000
039700             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.03970000
039800                                                                  03980000
039900     05  PV-HDR-CONSOL-TRNS-DTE.                                  03990000
040000         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.04000000
040100         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.04010000
040200                                                                  04020000
040300*-----------------------------------------------------------------04030000
040400*  CURSOR DECLARATION TO CALCULATE ENT_ID. THE ENT_NAME_DESC WILL 04040000
040500*  BE USED IN THE ISA RECORD HEADER, AND THE ENT_ID WILL BE PASSED04050000
040600*  WITH ALL RECORDS OF A LOGICAL FILE FOR EACH ISA.               04060000
040700*-----------------------------------------------------------------04070000
040800                                                                  04080000
040900     EXEC SQL                                                     04090000
041000          DECLARE ENTID_CSR CURSOR FOR                            04100000
041100             SELECT A.ENT_NAME_DESC                               04110000
041200                 ,  A.ENT_ID                                      04120000
041300               FROM TENTNME  A                                    04130000
041400                   ,TTRDPRT  B                                    04140000
041500              WHERE B.VEND_INCHG_ID       = :PV-VEND-ID           04150000
041600                AND B.VEND_INCHG_ID_DESC  = :PV-VEND-ID-QUAL      04160000
041700                AND A.ENT_ID              = B.ENT_ID              04170000
041800                AND A.TYPE_CDE            = '01'                  04180000
041900                AND B.INACTV_DTE          = '9999-09-09'          04190000
042000     END-EXEC.                                                    04200000
042100                                                                  04210000
042200 EJECT                                                            04220000
042300                                                                  04230000
042310*-----------------------------------------------------------------04231000
042320*  CURSOR DECLARATION TO SELECT THE FOB AND SCAC CODE FOR A       04232000
042330*  GIVEN P.O. NUMBER.                                             04233000
042350*-----------------------------------------------------------------04235000
042360                                                                  04236000
042370     EXEC SQL                                                     04237000
042380          DECLARE FOB_SCAC_CSR CURSOR FOR                         04238000
042390             SELECT DISTINCT                                      04239000
042391                    A.FOB_CDE                                     04239100
042392                   ,C.SCAC_CDE                                    04239200
042393               FROM TPLNSHP  A                                    04239300
042394                   ,TIMFOB   B                                    04239400
042395                   ,TEXTENT  C                                    04239500
042396              WHERE A.PO_NBR              = :IMCNPO-PO-NBR        04239600
042397                AND A.VER_STATUS_CDE      = :PC-A                 04239700
042398                AND A.FOB_CDE             = B.FOB_CDE             04239800
042399                AND B.CONSLR_ENT_ID       = C.ENT_ID              04239900
042400     END-EXEC.                                                    04240000
042401                                                                  04240100
042402 EJECT                                                            04240200
042410*-----------------------------------------------------------------04241000
042500*  CURSOR DECLARATION TO LOOK UP THE POE NAME DESCRIPTION FROM    04250000
042600*  KOHL'S TIMPOE TABLE. THE NAME DESCRIPTION WILL BE PASSED TO    04260000
042700*  BOTH ERROR AND EXTRACT FILES IF IT IS VALID.                   04270000
042800*  THE ACTUAL 4-BYTE POE-STD-EDI-CDE ITSELF IS ONLY PASSED TO     04280000
042900*  THE EXTRACT FILE IF IT IS VALID (NOT ZEROES OR SPACES).        04290000
043000*  IF THE POE-STD-EDI-CDE IS NOT VALID (FOUND) SPACES WILL        04300000
043100*  BE MOVED TO THE EXTRACT FILE POE-STD-EDI-CDE FIELD AND         04310000
043200*  NAME DESCRIPTION FIELD. THE ACTUAL 4-BYTE FIELD OF THE         04320000
043300*  POE-STD-EDI-CDE WILL BE MOVED TO THE NAME DESCRIPTION FIELD    04330000
043400*  ON THE ERROR REPORT WITH EITHER OF TWO WARNING MESSAGES:       04340000
043500*  " POE CODE NOT ON MAINFRAME " (NOT FOUND)  OR                  04350000
043600*  " POE CODE NOT SENT " (INOUT WAS ZEROES OR SPACES)             04360000
043700*-----------------------------------------------------------------04370000
043800                                                                  04380000
043900     EXEC SQL                                                     04390000
044000         DECLARE POE_CSR CURSOR FOR                               04400000
044100             SELECT POE_NM                                        04410000
044200             FROM   TIMPOE                                        04420000
044300             WHERE  POE_STD_EDI_CDE = :IMPOE-POE-STD-EDI-CDE AND  04430000
044400                    STAT_CDE        = 'A'                         04440000
044500     END-EXEC.                                                    04450000
044600                                                                  04460000
044700 EJECT                                                            04470000
044800                                                                  04480000
044900******************************************************************04490000
045000 LINKAGE SECTION.                                                 04500000
045100******************************************************************04510000
045200                                                                  04520000
045300******************************************************************04530000
045400 PROCEDURE DIVISION.                                              04540000
045500******************************************************************04550000
045600******************************************************************04560000
045700*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *04570000
045800******************************************************************04580000
045900 0000-PROGRAM-MAINLINE.                                           04590000
046000                                                                  04600000
046100     PERFORM 1000-INITIALIZE.                                     04610000
046200                                                                  04620000
046300     PERFORM 2000-PROCESS-CUSTOMS-RECORDS                         04630000
046400         UNTIL PS-END-OF-ENTRIES.                                 04640000
046500                                                                  04650000
046600     PERFORM 8000-EOJ-ROUTINE.                                    04660000
046700     STOP RUN.                                                    04670000
046800                                                                  04680000
046900******************************************************************04690000
047000*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *04700000
047100*  JOB PROCESSES - PRIMING READ, INITIALIZATION, EMPTY FILE ETC. *04710000
047200******************************************************************04720000
047300 1000-INITIALIZE.                                                 04730000
047400                                                                  04740000
047500     OPEN INPUT TR017-CUSTOMS-FILE                                04750000
047600         OUTPUT TR027-UPDATE-CUSTOMS-FILE                         04760000
047700                TR241-CUSTOMS-ERROR-FILE.                         04770000
047800                                                                  04780000
047900     INITIALIZE TR027-REC-TYP-ENF                                 04790000
048000                TR241-RECORD                                      04800000
048100                TR241-REC-TYP-HDR.                                04810000
048200                                                                  04820000
048300     PERFORM 3000-RESET-SWITCHES.                                 04830000
048400                                                                  04840000
048500     SET PS-GOOD-RECORD-NO TO TRUE.                               04850000
048600                                                                  04860000
048700     MOVE PC-IEA TO PV-HOLD-LAST-REC-TYP.                         04870000
048800                                                                  04880000
048900     PERFORM 6000-READ-CUSTOMS-RECORD                             04890000
049000         UNTIL PS-GOOD-RECORD OR PS-END-OF-ENTRIES.               04900000
049100                                                                  04910000
049200     SET PS-GOOD-RECORD-NO TO TRUE.                               04920000
049300                                                                  04930000
049400     IF PS-END-OF-ENTRIES                                         04940000
049500         MOVE PC-EMPTY       TO TR241-ERROR-TYPE                  04950000
049600     END-IF.                                                      04960000
049700                                                                  04970000
049800 EJECT                                                            04980000
049900                                                                  04990000
050000******************************************************************05000000
050100* MAIN PROCESSING / EDIT PARAGRAPH.                              *05010000
050200*                                                                *05020000
050300*  IN THIS PARAGRAPH, A CHECK IS PERFORMED TO MAKE SURE THE      *05030000
050400*  RECORD HAS A VALID TRANSACTION TYP AND RECORD TYP.  IF NOT,   *05040000
050500*  AN ERROR RECORD IS WRITTEN OUR IMMEDIATELY.                   *05050000
050600*  IF EITHER IS MISSING OR INVALID, THE RECORD IS WRITTEN OUT TO *05060000
050700*  ERROR REPORT AND THE PROCESSING PASSES TO THE NEXT RECORD.    *05070000
050800*  WHEN TRAN TYPE, RECORD TYPE, ARE PRESENT AND VALID, THE       *05080000
050900*  THE PROCESSING WILL                                           *05090000
051000*  PASS THRU ALL OF THE EDITS BEFORE READING THE NEXT RECORD.    *05100000
051100*  THIS IS DONE TO TRY TO CATCH ALL OF THE ERRORS ON THE FIRST   *05110000
051200*  TIME THROUGH THE PROGRAM.                                     *05120000
051300*                                                                *05130000
051400******************************************************************05140000
051500 2000-PROCESS-CUSTOMS-RECORDS.                                    05150000
051600                                                                  05160000
051610     IF PV-CSTM-ENTR-ID  =  TR017-ENF-CSTM-ENTR-ID                05161000
051611        CONTINUE                                                  05161100
051612     ELSE                                                         05161200
051613        MOVE TR017-ENF-CSTM-ENTR-ID  TO PV-CSTM-ENTR-ID           05161300
051620        INITIALIZE  PV-MOM-TRIP-TYP                               05162000
051621        SET PS-NEED-ENFPO-FOB-SCAC-NO  TO TRUE                    05162100
051630     END-IF.                                                      05163000
051640                                                                  05164000
051700     PERFORM 3150-CHECK-VALID-TRN-REC-TYP.                        05170000
051900     IF (PS-VALID-REC-TYP-CDE AND PS-VALID-TRN-TYP)               05190000
052000                                                                  05200000
052100         PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                       05210000
052200                                                                  05220000
052300         EVALUATE TR017-ENF-REC-TYP-CDE                           05230000
052400            WHEN PC-ENF                                           05240000
052500                PERFORM 3300-EDIT-ENF-FIELDS                      05250000
052600            WHEN PC-ENFBOL                                        05260000
052700                PERFORM 3350-EDIT-ENFBOL-FIELDS                   05270000
052800            WHEN PC-ENFCON                                        05280000
052900                PERFORM 3400-EDIT-ENFCON-FIELDS                   05290000
052910            WHEN PC-DOP                                           05291000
052920                PERFORM 3410-EDIT-DOP-FIELDS                      05292000
053000            WHEN PC-ENFPO                                         05300000
053100                PERFORM 3450-EDIT-ENFPO-FIELDS                    05310000
053200            WHEN PC-EXD                                           05320000
053300                PERFORM 3500-EDIT-EXD-FIELDS                      05330000
053400            WHEN PC-REJ                                           05340000
053500                PERFORM 3550-EDIT-REJ-FIELDS                      05350000
053600            WHEN PC-ECR                                           05360000
053700                PERFORM 3600-EDIT-ECR-FIELDS                      05370000
053800            WHEN PC-RLS                                           05380000
053900                PERFORM 3650-EDIT-RLS-FIELDS                      05390000
054000            WHEN PC-LIQ                                           05400000
054100                PERFORM 3700-EDIT-LIQ-FIELDS                      05410000
054200            WHEN PC-LSU                                           05420000
054300                PERFORM 3750-EDIT-LSU-FIELDS                      05430000
054400         END-EVALUATE                                             05440000
054500     END-IF.                                                      05450000
054600                                                                  05460000
054700     PERFORM 6000-READ-CUSTOMS-RECORD                             05470000
054800             UNTIL PS-GOOD-RECORD OR PS-END-OF-ENTRIES.           05480000
054900                                                                  05490000
055000     SET   PS-GOOD-RECORD-NO            TO TRUE.                  05500000
055100                                                                  05510000
055200                                                                  05520000
055300 EJECT                                                            05530000
055400                                                                  05540000
055500******************************************************************05550000
055600* RESET SWITCHES.                                                *05560000
055700******************************************************************05570000
055800 3000-RESET-SWITCHES.                                             05580000
055900                                                                  05590000
056000     SET PS-EDIT-ERROR-NO             TO TRUE.                    05600000
056100                                                                  05610000
056200 EJECT                                                            05620000
056300                                                                  05630000
056400******************************************************************05640000
056500* CHECK TO MAKE SURE THAT THE RECORD TYPES TO BE EDITED ARE:     *05650000
056600* ENF, ENFBOL, ENFCON, DOP, ENFPO, EXD, REJ, ECR, RLS, LIQ OR LSU 05660000
056700* AND THAT THE TRANSACTION TYPES ARE EITHER A, C OR D.           *05670000
056800* SETS TWO SWITCHES AND CONTINUES EDITING.                       *05680000
056900******************************************************************05690000
057000 3150-CHECK-VALID-TRN-REC-TYP.                                    05700000
057100                                                                  05710000
057200     SET PS-VALID-REC-TYP-CDE-NO          TO TRUE.                05720000
057300                                                                  05730000
057400     MOVE TR017-ENF-REC-TYP-CDE           TO PV-EVAL-REC-TYP-CDE. 05740000
057500                                                                  05750000
057600     EVALUATE TRUE                                                05760000
057700        WHEN REC-TYP-ENF                                          05770000
057800        WHEN REC-TYP-ENFBOL                                       05780000
057900        WHEN REC-TYP-ENFCON                                       05790000
057910        WHEN REC-TYP-DOP                                          05791000
058000        WHEN REC-TYP-ENFPO                                        05800000
058100        WHEN REC-TYP-EXD                                          05810000
058200        WHEN REC-TYP-REJ                                          05820000
058300        WHEN REC-TYP-ECR                                          05830000
058400        WHEN REC-TYP-RLS                                          05840000
058500        WHEN REC-TYP-LIQ                                          05850000
058600        WHEN REC-TYP-LSU                                          05860000
058700             SET PS-VALID-REC-TYP-CDE          TO TRUE            05870000
058800        WHEN OTHER                                                05880000
058801             SET PS-VALID-REC-TYP-CDE-NO   TO TRUE                05880100
058810             MOVE PC-E                     TO TR241-RPT-TYP       05881000
059000             MOVE 'RECORD TYPE'            TO TR241-DATA-IN-ERROR 05900000
059100             MOVE TR017-ENF-REC-TYP-CDE    TO TR241-DATA-VALUE    05910000
059200             MOVE PC-ERROR                 TO TR241-ERROR-TYPE    05920000
059300             MOVE 'INVALID REC TYPE'       TO TR241-ERROR-MSG     05930000
059400             SET PS-EDIT-ERROR             TO TRUE                05940000
059500             ADD  +1                  TO PA-TOT-INVALID-REC-TYP   05950000
059600             PERFORM 6190-MOVES-FOR-ERROR-REC                     05960000
059700             PERFORM 6200-WRITE-ERROR-REPORT                      05970000
059800     END-EVALUATE.                                                05980000
059900                                                                  05990000
060000     SET PS-VALID-TRN-TYP-NO                  TO TRUE.            06000000
060100                                                                  06010000
060200     MOVE TR017-ENF-TRN-TYP            TO PV-EVAL-TRN-TYP-CDE     06020000
060300                                                                  06030000
060400     EVALUATE TRUE                                                06040000
060500                                                                  06050000
060600        WHEN TRN-TYP-ADD                                          06060000
060700             SET PS-VALID-TRN-TYP              TO TRUE            06070000
060800             ADD +1 TO PA-TOT-CSTM-RECS-ADD                       06080000
060900        WHEN TRN-TYP-CHG                                          06090000
061000             SET PS-VALID-TRN-TYP              TO TRUE            06100000
061100             ADD +1 TO PA-TOT-CSTM-RECS-CHANGE                    06110000
061200        WHEN TRN-TYP-DEL                                          06120000
061300             SET PS-VALID-TRN-TYP              TO TRUE            06130000
061400             ADD +1 TO PA-TOT-CSTM-RECS-DELETE                    06140000
061500        WHEN OTHER                                                06150000
061501             SET PS-VALID-TRN-TYP-NO       TO TRUE                06150100
061510             MOVE PC-E                     TO TR241-RPT-TYP       06151000
061700             MOVE 'TRAN TYPE'              TO TR241-DATA-IN-ERROR 06170000
061800             MOVE TR017-ENF-TRN-TYP        TO TR241-DATA-VALUE    06180000
061900             MOVE PC-ERROR                 TO TR241-ERROR-TYPE    06190000
062000             MOVE 'INVALID TRAN TYPE'      TO TR241-ERROR-MSG     06200000
062100             SET PS-EDIT-ERROR             TO TRUE                06210000
062200             ADD  +1                  TO PA-TOT-INVALID-TRN-TYP   06220000
062300             PERFORM 6190-MOVES-FOR-ERROR-REC                     06230000
062400             PERFORM 6200-WRITE-ERROR-REPORT                      06240000
062500     END-EVALUATE.                                                06250000
062600                                                                  06260000
062700                                                                  06270000
062800 EJECT                                                            06280000
062900                                                                  06290000
063000******************************************************************06300000
063100* EDIT THE KEY FIELDS AND FIELDS THAT ARE PRESENT ON 11 RECORD   *06310000
063200* TYPES: ENF, ENFBOL, ENFCON, ENFPO, EXD, REJ, ECR, RLS, LIQ,    *06320000
063210*        LSU, DOP                                                 06321000
063300* THE KEY FIELD IS: CSTM-ENTR-ID.                                *06330000
063400* A VALID ENT-ID, WHICH WAS CALCULATED IN THE ISA-RECORD PROCESS-*06340000
063500* ING OF PARAGRAPH 7292-SELECT-ENT-ID, IS PASSED TO TRKUP245     *06350000
063600* IF THE ENT-ID WAS NOT VALID, AN WARNING MESSAGE IS WRITTEN OUT *06360000
063700* FOR EVERY RECORD OF THE LOGICAL FILE.                          *06370000
063800* THE POE-STD-EDI-CDE IS PRESENT ON ALL REC-TYPES.               *06380000
063900* IT GETS PASSED WITH THE EACH REC-TYP EDIT, AND WILL BE EDITED  *06390000
064000* IN THE TRKUP255 CUSTOM LOAD PROGRAM.                           *06400000
064100******************************************************************06410000
064200 3200-EDIT-KEYS-LIKE-FIELDS.                                      06420000
064300                                                                  06430000
065610     MOVE TR017-ENF-ENT-ID  TO TR027-ENF-ENT-ID.                  06561000
065620     MOVE TR017-ENF-FILE-ID TO TR027-ENF-FILE-ID.                 06562000
065700****                                                              06570000
065800*  TR017-ENF-CSTM-ENTR-ID FORMAT = XXXNNNNNNNCY WHERE             06580000
065900*         XXX  - ENTRY FILE CODE ASSIGNED BY CUSTOMS              06590000
066000*     NNNNNNN  - UNIQUE NUMBER ASSIGNED BY THE BROKER             06600000
066100*           C  - CHECK DIGIT COMPUTED FROM FIRST 10 CHARACTERS    06610000
066200*           Y  - RESERVED FOR FUTURE EXPANSION                    06620000
066300****                                                              06630000
066400     IF  TR017-ENF-CSTM-ENTR-ID (4:8) NOT NUMERIC                 06640000
066600        MOVE 'CUSTOM ENTRY ID'        TO TR241-DATA-IN-ERROR      06660000
066700        MOVE TR017-ENF-CSTM-ENTR-ID   TO TR241-DATA-VALUE         06670000
066800        MOVE PC-ERROR                 TO TR241-ERROR-TYPE         06680000
066900        SET PS-EDIT-ERROR             TO TRUE                     06690000
066910        IF TR017-ENF-CSTM-ENTR-ID = SPACES                        06691000
067000          MOVE 'CUSTOMS ENTRY ID MISSING'                         06700000
067100                                      TO TR241-ERROR-MSG          06710000
067101        ELSE                                                      06710100
067110          MOVE 'CUSTOMS ENTRY ID INVALID'                         06711000
067120                                      TO TR241-ERROR-MSG          06712000
067130        END-IF                                                    06713000
067200        PERFORM 6190-MOVES-FOR-ERROR-REC                          06720000
067300        PERFORM 6200-WRITE-ERROR-REPORT                           06730000
067400     ELSE                                                         06740000
067500        MOVE TR017-ENF-CSTM-ENTR-ID    TO TR027-ENF-CSTM-ENTR-ID  06750000
067600     END-IF.                                                      06760000
067700                                                                  06770000
067800 EJECT                                                            06780000
067900                                                                  06790000
068000******************************************************************06800000
068100* EDIT THE FIELDS THAT ARE PRESENT ON THE ENF RECORD TYPE ONLY.  *06810000
068200* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *06820000
068300* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *06830000
068400* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *06840000
068500******************************************************************06850000
068600 3300-EDIT-ENF-FIELDS.                                            06860000
068700                                                                  06870000
068702     MOVE TR017-ENF-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      06870200
068703                                   TR027-ENF-POE-STD-EDI-CDE.     06870300
068705     IF TR017-ENF-TRN-TYP EQUAL PC-D                              06870500
068706         CONTINUE                                                 06870600
068707     ELSE                                                         06870700
068708         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     06870800
068709         MOVE PV-CURRENT-POE-NM     TO TR027-ENF-POE-NM           06870900
068710     END-IF.                                                      06871000
071900                                                                  07190000
071910     IF TR017-ENF-TRN-TYP EQUAL PC-D                              07191000
071920         MOVE TR017-ENF-BKR-REF-NBR TO                            07192000
071930                            TR027-ENF-BKR-REF-NBR                 07193000
071940     ELSE                                                         07194000
072000      IF TR017-ENF-BKR-REF-NBR  EQUAL SPACES                      07200000
072100        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     07210000
072200        MOVE TR017-ENF-BKR-REF-NBR     TO TR241-DATA-VALUE        07220000
072300        MOVE PC-WARNING                TO TR241-ERROR-TYPE        07230000
072400        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         07240000
072500        MOVE SPACES                    TO TR027-ENF-BKR-REF-NBR   07250000
072600        PERFORM 6190-MOVES-FOR-ERROR-REC                          07260000
072700        PERFORM 6200-WRITE-ERROR-REPORT                           07270000
072800      ELSE                                                        07280000
072900        MOVE TR017-ENF-BKR-REF-NBR     TO TR027-ENF-BKR-REF-NBR   07290000
072910      END-IF                                                      07291000
073000     END-IF.                                                      07300000
073100                                                                  07310000
073200      IF TR017-ENF-TRN-TYP EQUAL PC-D                             07320000
073300           MOVE TR017-ENF-FILD-DTE      TO                        07330000
073400                TR027-ENF-FILD-DTE                                07340000
073500           MOVE TR017-ENF-FILD-TM       TO                        07350000
073600                TR027-ENF-FILD-TM                                 07360000
073700      ELSE                                                        07370000
073800        IF TR017-ENF-FILD-DTE EQUAL SPACES                        07380000
073900          MOVE 'ENTRY FILED DTE'        TO TR241-DATA-IN-ERROR    07390000
074000          MOVE TR017-ENF-FILD-DTE       TO TR241-DATA-VALUE       07400000
074100          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       07410000
074200          SET PS-EDIT-ERROR             TO TRUE                   07420000
074300          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        07430000
074400          PERFORM 6190-MOVES-FOR-ERROR-REC                        07440000
074500          PERFORM 6200-WRITE-ERROR-REPORT                         07450000
074600        ELSE                                                      07460000
074700          PERFORM 5600-CHK-FILD-DTE-TM                            07470000
074800        END-IF                                                    07480000
074900      END-IF.                                                     07490000
075000                                                                  07500000
075001******************************************************************07500100
075002* EDIT ENTR TYPE CODE                                             07500200
075003******************************************************************07500300
075004                                                                  07500400
075010     MOVE TR017-ENF-ENTR-TYP-CDE                                  07501000
075020                               TO TR027-ENF-ENTR-TYP-CDE.         07502000
075030     PERFORM 3310-EDIT-ENTR-TYP-CDE.                              07503000
075040     IF PS-VALID-ENTR-TYP-CDE                                     07504000
075050       MOVE ICDVAL-CDVL-DESC   TO TR027-ENF-ENTR-TYP-DESC         07505000
075060     ELSE                                                         07506000
075080       MOVE SPACES             TO TR027-ENF-ENTR-TYP-DESC         07508000
075090     END-IF.                                                      07509000
075093                                                                  07509300
075094******************************************************************07509400
075095* EDIT TRIP TYPE                                                  07509500
075096******************************************************************07509600
075097                                                                  07509700
075098     MOVE TR017-ENF-MOM-TRIP-TYP-CDE                              07509800
075099                                  TO TR027-ENF-MOM-TRIP-TYP-CDE   07509900
075100                                     PV-MOM-TRIP-TYP.             07510000
075101     IF TR017-ENF-MOM-TRIP-TYP-VALID OR TR017-ENF-TRN-TYP-DEL     07510100
075102        CONTINUE                                                  07510200
075103     ELSE                                                         07510300
075104       IF TR027-ENF-MOM-TRIP-TYP-CDE    = SPACES                  07510400
075109          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        07510900
075111       ELSE                                                       07511100
075117          MOVE 'INVALID DATA SENT'      TO TR241-ERROR-MSG        07511700
075119       END-IF                                                     07511900
075120          MOVE PC-E                     TO TR241-RPT-TYP          07512000
075121          MOVE 'MOM TRIP TYPE '         TO TR241-DATA-IN-ERROR    07512100
075122          MOVE TR017-ENF-MOM-TRIP-TYP-CDE                         07512200
075123                                        TO TR241-DATA-VALUE       07512300
075124          MOVE PC-WARNING               TO TR241-ERROR-TYPE       07512400
075125          PERFORM 6190-MOVES-FOR-ERROR-REC                        07512500
075126          PERFORM 6200-WRITE-ERROR-REPORT                         07512600
075127     END-IF.                                                      07512700
075128                                                                  07512800
075130     IF PS-EDIT-ERROR-NO                                          07513000
075200        PERFORM 6180-MOVES-FOR-DETAIL-REC                         07520000
075300        PERFORM 6400-WRITE-UPDATE-REPORT                          07530000
075400     END-IF.                                                      07540000
075510                                                                  07551000
075520******************************************************************07552000
075530* EDIT ENTRY TYPE CODE                                            07553000
075540******************************************************************07554000
075550 3310-EDIT-ENTR-TYP-CDE.                                          07555000
075560                                                                  07556000
075570     SET PS-VALID-ENTR-TYP-CDE-NO TO TRUE.                        07557000
075580     IF TR017-ENF-ENTR-TYP-CDE = SPACES OR '00' OR ' 0'           07558000
075590       CONTINUE                                                   07559000
075591     ELSE                                                         07559100
075592       PERFORM 7360-SELECT-TIMCDVAL                               07559200
075593     END-IF.                                                      07559300
075594                                                                  07559400
075595     IF PS-VALID-ENTR-TYP-CDE OR TR017-ENF-TRN-TYP-DEL            07559500
075596       CONTINUE                                                   07559600
075597     ELSE                                                         07559700
075605       MOVE PC-E                        TO TR241-RPT-TYP          07560500
075606       MOVE 'ENTRY TYP CDE '            TO TR241-DATA-IN-ERROR    07560600
075607       MOVE TR017-ENF-ENTR-TYP-CDE      TO TR241-DATA-VALUE       07560700
075608       MOVE PC-WARNING                  TO TR241-ERROR-TYPE       07560800
075609       IF TR017-ENF-ENTR-TYP-CDE = SPACES                         07560900
075610         MOVE 'DATA NOT SENT'             TO TR241-ERROR-MSG      07561000
075611       ELSE                                                       07561100
075612         MOVE 'INVALID DATA SENT'         TO TR241-ERROR-MSG      07561200
075613       END-IF                                                     07561300
075614       PERFORM 6190-MOVES-FOR-ERROR-REC                           07561400
075615       PERFORM 6200-WRITE-ERROR-REPORT                            07561500
075616     END-IF.                                                      07561600
075617                                                                  07561700
075620  EJECT                                                           07562000
075700                                                                  07570000
075808                                                                  07580800
075810******************************************************************07581000
075900* EDIT THE FIELDS THAT ARE PRESENT ON THE ENFBOL RECORD TYPE ONLY 07590000
076000* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *07600000
076100* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *07610000
076200* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *07620000
076300******************************************************************07630000
076400 3350-EDIT-ENFBOL-FIELDS.                                         07640000
076500                                                                  07650000
076501     MOVE TR017-ENFBOL-POE-STD-EDI-CDE  TO PV-CURRENT-POE-CDE     07650100
076502                                 TR027-ENFBOL-POE-STD-EDI-CDE.    07650200
076504     IF TR017-ENFBOL-TRN-TYP EQUAL PC-D                           07650400
076505         CONTINUE                                                 07650500
076506     ELSE                                                         07650600
076507         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     07650700
076508         MOVE PV-CURRENT-POE-NM     TO TR027-ENFBOL-POE-NM        07650800
076518     END-IF.                                                      07651800
076520                                                                  07652000
080000     EVALUATE TRUE                                                08000000
080001                                                                  08000100
080010       WHEN PV-MOM-TRIP-TYP = 'A'                                 08001000
080020          CONTINUE                                                08002000
080030       WHEN OTHER                                                 08003000
080032          PERFORM 7300-SELECT-SCAC                                08003200
080033                                                                  08003300
080034          EVALUATE TRUE                                           08003400
080035                                                                  08003500
080036            WHEN PS-VALID-SCAC                                    08003600
080037              PERFORM 3360-EDIT-MASTER                            08003700
080038              IF PS-EDIT-ERROR                                    08003800
080039                CONTINUE                                          08003900
080040              ELSE                                                08004000
080041                PERFORM 3380-MATCH-MASTER-TO-CONTR                08004100
080042              END-IF                                              08004200
080043                                                                  08004300
080044            WHEN PS-VALID-SCAC-NO                                 08004400
080045              PERFORM 3370-EDIT-HOUSE                             08004500
080046              IF PS-EDIT-ERROR                                    08004600
080047                CONTINUE                                          08004700
080048              ELSE                                                08004800
080049                PERFORM 3390-MATCH-HOUSE-TO-CONTR                 08004900
080050              END-IF                                              08005000
080052                                                                  08005200
080053          END-EVALUATE                                            08005300
080054     END-EVALUATE.                                                08005400
080055                                                                  08005500
080056     IF TR017-ENFBOL-TRN-TYP EQUAL PC-D                           08005600
080057         MOVE TR017-ENFBOL-CARR-SCAC-ID TO                        08005700
080058                               TR027-ENFBOL-CARR-SCAC-ID          08005800
080059     ELSE                                                         08005900
080060      IF TR017-ENFBOL-CARR-SCAC-ID  EQUAL SPACES                  08006000
080062        MOVE 'CARRIER SCAC'       TO TR241-DATA-IN-ERROR          08006200
080063        MOVE TR017-ENFBOL-CARR-SCAC-ID  TO TR241-DATA-VALUE       08006300
080064        MOVE PC-WARNING           TO TR241-ERROR-TYPE             08006400
080065        MOVE 'DATA NOT SENT'      TO TR241-ERROR-MSG              08006500
080066        MOVE SPACES               TO TR027-ENFBOL-CARR-SCAC-ID    08006600
080067        PERFORM 6190-MOVES-FOR-ERROR-REC                          08006700
080068        PERFORM 6200-WRITE-ERROR-REPORT                           08006800
080069      ELSE                                                        08006900
080070        MOVE TR017-ENFBOL-CARR-SCAC-ID   TO                       08007000
080071               TR027-ENFBOL-CARR-SCAC-ID                          08007100
080072      END-IF                                                      08007200
080073     END-IF.                                                      08007300
080074                                                                  08007400
080075     IF TR017-ENFBOL-TRN-TYP EQUAL PC-D                           08007500
080076         MOVE TR017-ENFBOL-BKR-REF-NBR TO                         08007600
080077                        TR027-ENFBOL-BKR-REF-NBR                  08007700
080078     ELSE                                                         08007800
080079       IF TR017-ENFBOL-BKR-REF-NBR EQUAL SPACES                   08007900
080081         MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR    08008100
080082         MOVE TR017-ENFBOL-BKR-REF-NBR  TO TR241-DATA-VALUE       08008200
080083         MOVE PC-WARNING                TO TR241-ERROR-TYPE       08008300
080084         MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG        08008400
080085         MOVE SPACES                  TO TR027-ENFBOL-BKR-REF-NBR 08008500
080086         PERFORM 6190-MOVES-FOR-ERROR-REC                         08008600
080087         PERFORM 6200-WRITE-ERROR-REPORT                          08008700
080088       ELSE                                                       08008800
080089         MOVE TR017-ENFBOL-BKR-REF-NBR  TO                        08008900
080090              TR027-ENFBOL-BKR-REF-NBR                            08009000
080091       END-IF                                                     08009100
080092     END-IF.                                                      08009200
080093                                                                  08009300
080094     IF PS-EDIT-ERROR-NO                                          08009400
080095          MOVE TR017-ENFBOL-HSE-BOL-NBR TO                        08009500
080096                  TR027-ENFBOL-HSE-BOL-NBR                        08009600
080097          MOVE TR017-ENFBOL-MSTR-BOL-NBR TO                       08009700
080098                  TR027-ENFBOL-MSTR-BOL-NBR                       08009800
080099        PERFORM 6180-MOVES-FOR-DETAIL-REC                         08009900
080100        PERFORM 6400-WRITE-UPDATE-REPORT                          08010000
080101     END-IF.                                                      08010100
080102                                                                  08010200
080103******************************************************************08010300
080104 3360-EDIT-MASTER.                                                08010400
080105                                                                  08010500
080106     IF  TR017-ENFBOL-MSTR-BOL-NBR EQUAL ZEROES                   08010600
080107       MOVE 'MASTER BOL'   TO TR241-DATA-IN-ERROR                 08010700
080108       MOVE TR017-ENFBOL-MSTR-BOL-NBR                             08010800
080109                           TO TR241-DATA-VALUE                    08010900
080110       MOVE PC-ERROR       TO TR241-ERROR-TYPE                    08011000
080111       MOVE 'INVALID DATA SENT'  TO TR241-ERROR-MSG               08011100
080112       SET  PS-EDIT-ERROR        TO TRUE                          08011200
080113       PERFORM 6190-MOVES-FOR-ERROR-REC                           08011300
080114       PERFORM 6200-WRITE-ERROR-REPORT                            08011400
080115     END-IF.                                                      08011500
080116                                                                  08011600
080117     IF TR017-ENFBOL-MSTR-BOL-NBR EQUAL SPACES                    08011700
080119       MOVE 'MASTER BOL'   TO TR241-DATA-IN-ERROR                 08011900
080120       MOVE TR017-ENFBOL-MSTR-BOL-NBR                             08012000
080121                           TO TR241-DATA-VALUE                    08012100
080122       MOVE PC-ERROR       TO TR241-ERROR-TYPE                    08012200
080123       MOVE 'DATA NOT SENT'  TO TR241-ERROR-MSG                   08012300
080124       SET  PS-EDIT-ERROR        TO TRUE                          08012400
080125       PERFORM 6190-MOVES-FOR-ERROR-REC                           08012500
080126       PERFORM 6200-WRITE-ERROR-REPORT                            08012600
080130     END-IF.                                                      08013000
080200                                                                  08020000
082301******************************************************************08230100
082302 3370-EDIT-HOUSE.                                                 08230200
082303                                                                  08230300
082304     IF TR017-ENFBOL-HSE-BOL-NBR EQUAL ZEROES                     08230400
082305       MOVE 'HOUSE BOL'    TO TR241-DATA-IN-ERROR                 08230500
082306       MOVE TR017-ENFBOL-HSE-BOL-NBR                              08230600
082307                           TO TR241-DATA-VALUE                    08230700
082308       MOVE PC-ERROR       TO TR241-ERROR-TYPE                    08230800
082309       MOVE 'INVALID DATA SENT'  TO TR241-ERROR-MSG               08230900
082310       SET  PS-EDIT-ERROR        TO TRUE                          08231000
082311       PERFORM 6190-MOVES-FOR-ERROR-REC                           08231100
082312       PERFORM 6200-WRITE-ERROR-REPORT                            08231200
082313     END-IF.                                                      08231300
082314                                                                  08231400
082315     IF TR017-ENFBOL-HSE-BOL-NBR EQUAL SPACES                     08231500
082317       MOVE 'HOUSE BOL'   TO TR241-DATA-IN-ERROR                  08231700
082318       MOVE TR017-ENFBOL-HSE-BOL-NBR                              08231800
082319                           TO TR241-DATA-VALUE                    08231900
082320       MOVE PC-ERROR       TO TR241-ERROR-TYPE                    08232000
082321       MOVE 'DATA NOT SENT'  TO TR241-ERROR-MSG                   08232100
082322       SET  PS-EDIT-ERROR        TO TRUE                          08232200
082323       PERFORM 6190-MOVES-FOR-ERROR-REC                           08232300
082324       PERFORM 6200-WRITE-ERROR-REPORT                            08232400
082325     END-IF.                                                      08232500
082326                                                                  08232600
082327******************************************************************08232700
082328 3380-MATCH-MASTER-TO-CONTR.                                      08232800
082329                                                                  08232900
082330     MOVE TR017-ENFBOL-MSTR-BOL-NBR  TO IMCNPO-MSTR-BOL-NBR.      08233000
082331     SET PS-MSTR-BOL-FOUND-NO TO TRUE.                            08233100
082332     PERFORM 7390-SELECT-TIMCNPO-MSTR-BOL.                        08233200
082333                                                                  08233300
082334     IF TR017-ENFBOL-TRN-TYP EQUAL PC-D                           08233400
082335       CONTINUE                                                   08233500
082336     ELSE                                                         08233600
082337       IF PS-MSTR-BOL-FOUND                                       08233700
082343         CONTINUE                                                 08234300
082344       ELSE                                                       08234400
082350**       **********************************************           08235000
082351**       *  WE ONLY WANT TO SAVE THE PROCESS SEQ ON   *           08235100
082352**       *  THE FIRST ENFBOL RECORD FOR THIS ENTRY ID *           08235200
082353**       **********************************************           08235300
082354         IF PS-NEED-ENFPO-FOB-SCAC-NO                             08235400
082355           MOVE PV-PROCESS-SEQ-NBR        TO PV-SAVE-ER-SEQ-NBR   08235500
082356           SET PS-NEED-ENFPO-FOB-SCAC     TO TRUE                 08235600
082359         END-IF                                                   08235900
082360         MOVE 'MASTER BOL'              TO TR241-DATA-IN-ERROR    08236000
082361         MOVE TR017-ENFBOL-MSTR-BOL-NBR TO TR241-DATA-VALUE       08236100
082362         MOVE PC-WARNING                TO TR241-ERROR-TYPE       08236200
082363         MOVE                                                     08236300
082364            'MBOL FROM CUSTOMS DOES NOT MATCH CONT MANIFEST'      08236400
082365                                        TO TR241-ERROR-MSG        08236500
082366         PERFORM 6190-MOVES-FOR-ERROR-REC                         08236600
082367         PERFORM 6200-WRITE-ERROR-REPORT                          08236700
082368       END-IF                                                     08236800
082369     END-IF.                                                      08236900
082370                                                                  08237000
082371******************************************************************08237100
082372 3390-MATCH-HOUSE-TO-CONTR.                                       08237200
082373                                                                  08237300
082377     MOVE TR017-ENFBOL-HSE-BOL-NBR   TO IMCNPO-HSE-BOL-NBR.       08237700
082378     SET PS-HSE-BOL-FOUND-NO TO TRUE.                             08237800
082379     PERFORM 7400-SELECT-TIMCNPO-HSE-BOL.                         08237900
082380     IF TR017-ENFBOL-TRN-TYP EQUAL PC-D                           08238000
082381       CONTINUE                                                   08238100
082382     ELSE                                                         08238200
082383       IF PS-HSE-BOL-FOUND                                        08238300
082384         CONTINUE                                                 08238400
082385       ELSE                                                       08238500
082386         SET PS-NEED-ENFPO-FOB-SCAC    TO TRUE                    08238600
082387         MOVE PV-PROCESS-SEQ-NBR       TO PV-SAVE-ER-SEQ-NBR      08238700
082388         MOVE 'HOUSE BOL'              TO TR241-DATA-IN-ERROR     08238800
082389         MOVE TR017-ENFBOL-HSE-BOL-NBR TO TR241-DATA-VALUE        08238900
082390         MOVE PC-WARNING               TO TR241-ERROR-TYPE        08239000
082391         MOVE                                                     08239100
082392           'HBOL FROM CUSTOMS DOES NOT MATCH CONT MANIFEST'       08239200
082393                                        TO TR241-ERROR-MSG        08239300
082394         PERFORM 6190-MOVES-FOR-ERROR-REC                         08239400
082395         PERFORM 6200-WRITE-ERROR-REPORT                          08239500
082396       END-IF                                                     08239600
082397     END-IF.                                                      08239700
082398                                                                  08239800
086700 EJECT                                                            08670000
086800                                                                  08680000
086900******************************************************************08690000
087000* EDIT THE FIELDS THAT ARE PRESENT ON THE ENFCON RECORD TYPE ONLY.08700000
087100* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *08710000
087200* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *08720000
087300* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *08730000
087400******************************************************************08740000
087500 3400-EDIT-ENFCON-FIELDS.                                         08750000
087600                                                                  08760000
087610     MOVE TR017-ENFCON-POE-STD-EDI-CDE  TO PV-CURRENT-POE-CDE     08761000
087620                                   TR027-ENFCON-POE-STD-EDI-CDE.  08762000
087622     IF TR017-ENFCON-TRN-TYP EQUAL PC-D                           08762200
087623         CONTINUE                                                 08762300
087624     ELSE                                                         08762400
087630         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     08763000
087640         MOVE PV-CURRENT-POE-NM     TO TR027-ENFCON-POE-NM        08764000
087641     END-IF.                                                      08764100
087650                                                                  08765000
091200        IF TR017-ENFCON-CONTNR-ID  EQUAL ZEROES                   09120000
091300          MOVE 'CONTAINER ID'           TO TR241-DATA-IN-ERROR    09130000
091400          MOVE TR017-ENFCON-CONTNR-ID   TO TR241-DATA-VALUE       09140000
091500          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       09150000
091600          SET PS-EDIT-ERROR             TO TRUE                   09160000
091700          MOVE 'INVALID DATA SENT'      TO TR241-ERROR-MSG        09170000
091800          PERFORM 6190-MOVES-FOR-ERROR-REC                        09180000
091900          PERFORM 6200-WRITE-ERROR-REPORT                         09190000
092000        END-IF.                                                   09200000
092100                                                                  09210000
092110        IF TR017-ENFCON-TRN-TYP EQUAL PC-D                        09211000
092120            MOVE TR017-ENFCON-CONTNR-ID TO                        09212000
092130                     TR027-ENFCON-CONTNR-ID                       09213000
092140        ELSE                                                      09214000
092200         IF TR017-ENFCON-CONTNR-ID  EQUAL SPACES                  09220000
092300          MOVE 'CONTAINER ID'           TO TR241-DATA-IN-ERROR    09230000
092400          MOVE TR017-ENFCON-CONTNR-ID   TO TR241-DATA-VALUE       09240000
092500          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       09250000
092600          SET PS-EDIT-ERROR             TO TRUE                   09260000
092700          MOVE 'CONTAINER ID MISSING'   TO TR241-ERROR-MSG        09270000
092800          PERFORM 6190-MOVES-FOR-ERROR-REC                        09280000
092900          PERFORM 6200-WRITE-ERROR-REPORT                         09290000
093000         ELSE                                                     09300000
093100          MOVE TR017-ENFCON-CONTNR-ID   TO                        09310000
093200                 TR027-ENFCON-CONTNR-ID                           09320000
093210         END-IF                                                   09321000
093300        END-IF.                                                   09330000
093400                                                                  09340000
093410      IF TR017-ENFCON-TRN-TYP EQUAL PC-D                          09341000
093420          MOVE TR017-ENFCON-BKR-REF-NBR TO                        09342000
093421                 TR027-ENFCON-BKR-REF-NBR                         09342100
093422      ELSE                                                        09342200
093423       IF TR017-ENFCON-BKR-REF-NBR EQUAL SPACES                   09342300
093600        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     09360000
093700        MOVE TR017-ENFCON-BKR-REF-NBR  TO TR241-DATA-VALUE        09370000
093800        MOVE PC-WARNING                TO TR241-ERROR-TYPE        09380000
093900        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         09390000
094000        MOVE SPACES                    TO TR027-ENFCON-BKR-REF-NBR09400000
094100        PERFORM 6190-MOVES-FOR-ERROR-REC                          09410000
094200        PERFORM 6200-WRITE-ERROR-REPORT                           09420000
094300       ELSE                                                       09430000
094400        MOVE TR017-ENFCON-BKR-REF-NBR  TO TR027-ENFCON-BKR-REF-NBR09440000
094410       END-IF                                                     09441000
094500      END-IF.                                                     09450000
094600                                                                  09460000
094700      IF PS-EDIT-ERROR-NO                                         09470000
094800         PERFORM 6180-MOVES-FOR-DETAIL-REC                        09480000
094900         PERFORM 6400-WRITE-UPDATE-REPORT                         09490000
095000      END-IF.                                                     09500000
095100                                                                  09510000
095200 EJECT                                                            09520000
095300                                                                  09530000
095310******************************************************************09531000
095320* EDIT THE FIELDS THAT ARE PRESENT ON THE DOP RECORD TYPE ONLY.  *09532000
095330* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *09533000
095340* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *09534000
095350* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *09535000
095360******************************************************************09536000
095370 3410-EDIT-DOP-FIELDS.                                            09537000
095380                                                                  09538000
095381     MOVE TR017-DOP-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      09538100
095382                                   TR027-DOP-POE-STD-EDI-CDE.     09538200
095384     IF TR017-DOP-TRN-TYP EQUAL PC-D                              09538400
095385         CONTINUE                                                 09538500
095386     ELSE                                                         09538600
095387         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     09538700
095388         MOVE PV-CURRENT-POE-NM     TO TR027-DOP-POE-NM           09538800
095389     END-IF.                                                      09538900
095390                                                                  09539000
095425     IF TR017-DOP-CONTNR-ID  EQUAL ZEROES                         09542500
095427         MOVE 'CONTAINER ID'           TO TR241-DATA-IN-ERROR     09542700
095428         MOVE TR017-DOP-CONTNR-ID      TO TR241-DATA-VALUE        09542800
095429         MOVE PC-ERROR                 TO TR241-ERROR-TYPE        09542900
095430         SET PS-EDIT-ERROR             TO TRUE                    09543000
095431         MOVE 'INVALID DATA SENT'      TO TR241-ERROR-MSG         09543100
095432         PERFORM 6190-MOVES-FOR-ERROR-REC                         09543200
095433         PERFORM 6200-WRITE-ERROR-REPORT                          09543300
095435     END-IF.                                                      09543500
095436                                                                  09543600
095440     IF TR017-DOP-CONTNR-ID  EQUAL SPACES                         09544000
095442         MOVE 'CONTAINER ID'           TO TR241-DATA-IN-ERROR     09544200
095443         MOVE TR017-DOP-CONTNR-ID      TO TR241-DATA-VALUE        09544300
095444         MOVE PC-ERROR                 TO TR241-ERROR-TYPE        09544400
095445         SET PS-EDIT-ERROR             TO TRUE                    09544500
095446         MOVE 'CONTAINER ID MISSING'   TO TR241-ERROR-MSG         09544600
095447         PERFORM 6190-MOVES-FOR-ERROR-REC                         09544700
095448         PERFORM 6200-WRITE-ERROR-REPORT                          09544800
095449     ELSE                                                         09544900
095450         MOVE TR017-DOP-CONTNR-ID     TO TR027-DOP-CONTNR-ID      09545000
095452     END-IF.                                                      09545200
095453                                                                  09545300
095454                                                                  09545400
095455      IF TR017-DOP-TRN-TYP EQUAL PC-D                             09545500
095456           MOVE TR017-DOP-DELY-ORD-SNT-DTE      TO                09545600
095457                TR027-DOP-DELY-ORD-SNT-DTE                        09545700
095458           MOVE TR017-DOP-DELY-ORD-SNT-TM       TO                09545800
095459                TR027-DOP-DELY-ORD-SNT-TM                         09545900
095460      ELSE                                                        09546000
095461        IF TR017-DOP-DELY-ORD-SNT-DTE EQUAL SPACES                09546100
095462          MOVE 'DELY ORDER DTE'          TO TR241-DATA-IN-ERROR   09546200
095463          MOVE TR017-DOP-DELY-ORD-SNT-DTE  TO TR241-DATA-VALUE    09546300
095464          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       09546400
095465          SET PS-EDIT-ERROR             TO TRUE                   09546500
095466          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        09546600
095467          PERFORM 6190-MOVES-FOR-ERROR-REC                        09546700
095468          PERFORM 6200-WRITE-ERROR-REPORT                         09546800
095469        ELSE                                                      09546900
095470          PERFORM 5670-CHK-DELY-ORD-SNT-DTE-TM                    09547000
095471        END-IF                                                    09547100
095472      END-IF.                                                     09547200
095473                                                                  09547300
095474      IF TR017-DOP-TRN-TYP EQUAL PC-D                             09547400
095475          MOVE TR017-DOP-BKR-REF-NBR   TO TR027-DOP-BKR-REF-NBR   09547500
095476      ELSE                                                        09547600
095477        IF TR017-DOP-BKR-REF-NBR EQUAL SPACES                     09547700
095479          MOVE 'BROKER REF NBR'        TO TR241-DATA-IN-ERROR     09547900
095480          MOVE TR017-DOP-BKR-REF-NBR   TO TR241-DATA-VALUE        09548000
095481          MOVE PC-WARNING              TO TR241-ERROR-TYPE        09548100
095482          MOVE 'DATA NOT SENT'         TO TR241-ERROR-MSG         09548200
095483          MOVE SPACES                  TO TR027-DOP-BKR-REF-NBR   09548300
095484          PERFORM 6190-MOVES-FOR-ERROR-REC                        09548400
095485          PERFORM 6200-WRITE-ERROR-REPORT                         09548500
095486        ELSE                                                      09548600
095487          MOVE TR017-DOP-BKR-REF-NBR   TO TR027-DOP-BKR-REF-NBR   09548700
095488        END-IF                                                    09548800
095489      END-IF.                                                     09548900
095490                                                                  09549000
095491      IF PS-EDIT-ERROR-NO                                         09549100
095492         PERFORM 6180-MOVES-FOR-DETAIL-REC                        09549200
095493         PERFORM 6400-WRITE-UPDATE-REPORT                         09549300
095494      END-IF.                                                     09549400
095495                                                                  09549500
095496 EJECT                                                            09549600
095497                                                                  09549700
095498******************************************************************09549800
095500* EDIT THE FIELDS THAT ARE PRESENT ON THE ENFPO RECORD TYPE ONLY. 09550000
095600* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *09560000
095700* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *09570000
095800* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *09580000
095900******************************************************************09590000
096000 3450-EDIT-ENFPO-FIELDS.                                          09600000
096100                                                                  09610000
096110     MOVE TR017-ENFPO-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE    09611000
096120                                   TR027-ENFPO-POE-STD-EDI-CDE.   09612000
096122     IF TR017-ENFPO-TRN-TYP EQUAL PC-D                            09612200
096123         CONTINUE                                                 09612300
096124     ELSE                                                         09612400
096130         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     09613000
096140         MOVE PV-CURRENT-POE-NM     TO TR027-ENFPO-POE-NM         09614000
096141     END-IF.                                                      09614100
096150                                                                  09615000
096160* EDIT PO ***********************************************         09616000
102800     SET PS-PO-FOUND-NO TO TRUE.                                  10280000
103700     IF TR017-ENFPO-PO-NBR EQUAL SPACES OR                        10370000
103800        TR017-ENFPO-PO-NBR = ZERO                                 10380000
103900       MOVE 'PO NUMBER'              TO TR241-DATA-IN-ERROR       10390000
104000       MOVE TR017-ENFPO-PO-NBR       TO TR241-DATA-VALUE          10400000
104100       MOVE PC-ERROR                 TO TR241-ERROR-TYPE          10410000
104200       SET PS-EDIT-ERROR             TO TRUE                      10420000
104300       MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG           10430000
104400       PERFORM 6190-MOVES-FOR-ERROR-REC                           10440000
104500       PERFORM 6200-WRITE-ERROR-REPORT                            10450000
104600     ELSE                                                         10460000
104700       IF TR017-ENFPO-PO-NBR  NUMERIC                             10470000
104800         MOVE TR017-ENFPO-PO-NBR     TO TR027-ENFPO-PO-NBR        10480000
104900                                        IMCNPO-PO-NBR             10490000
104901*        ****************************************                 10490100
104902*        * IF THE PO IS VALID, GO GET THE FOB   *                 10490200
104903*        * CODE FROM TPLNSHP.                   *                 10490300
104904*        ****************************************                 10490400
104906         MOVE SPACES       TO PV-FOB-CDE                          10490600
104907*        ****************************************                 10490700
104908*        * SELECT FOB AND SCAC FOR PO NBR       *                 10490800
104909*        ****************************************                 10490900
104910         PERFORM 7500-OPEN-FOB-SCAC                               10491000
104911         PERFORM 7505-FETCH-FOB-SCAC                              10491100
104913*        ****************************************                 10491300
104914         MOVE PV-FOB-CDE   TO TR027-ENFPO-FOB-CDE                 10491400
104915         IF PS-NEED-ENFPO-FOB-SCAC                                10491500
104916             SET PS-NEED-ENFPO-FOB-SCAC-NO  TO TRUE               10491600
104917             IF SQLCODE = +0                                      10491700
104918                 PERFORM 6130-ERROR-30                            10491800
104919                 PERFORM 6200-WRITE-ERROR-REPORT                  10491900
104921             END-IF                                               10492100
104923         END-IF                                                   10492300
104924         PERFORM 7510-CLOSE-FOB-SCAC                              10492400
104925*        ****************************************                 10492500
104926*        * GO SEE IF THIS PO IS ON TIMCNPO AND  *                 10492600
104927*        * SET A SWITCH FOR EXTL-REF EDIT BELOW *                 10492700
104930*        ****************************************                 10493000
105100         PERFORM 7370-SELECT-TIMCNPO-PO                           10510000
105500       ELSE                                                       10550000
105710         MOVE 'PO NUMBER'              TO TR241-DATA-IN-ERROR     10571000
105720         MOVE TR017-ENFPO-PO-NBR       TO TR241-DATA-VALUE        10572000
105730         MOVE PC-ERROR                 TO TR241-ERROR-TYPE        10573000
105740         SET PS-EDIT-ERROR             TO TRUE                    10574000
105750         MOVE 'INVALID DATA SENT'      TO TR241-ERROR-MSG         10575000
105760         PERFORM 6190-MOVES-FOR-ERROR-REC                         10576000
105770         PERFORM 6200-WRITE-ERROR-REPORT                          10577000
105800       END-IF                                                     10580000
105802     END-IF.                                                      10580200
105810                                                                  10581000
105811* EDIT EXTL REF *****************************************         10581100
105812     MOVE TR017-ENFPO-EXTL-REF-NBR                                10581200
105813                                  TO TR027-ENFPO-EXTL-REF-NBR.    10581300
105814     EVALUATE TRUE                                                10581400
105815                                                                  10581500
105816      WHEN PV-MOM-TRIP-TYP = 'A'                                  10581600
105817      WHEN TR017-ENFPO-TRN-TYP EQUAL PC-D                         10581700
105818        CONTINUE                                                  10581800
105820                                                                  10582000
105821      WHEN OTHER                                                  10582100
105822        IF TR017-ENFPO-EXTL-REF-NBR EQUAL SPACES                  10582200
105830         MOVE 'EXTL REF NBR'            TO TR241-DATA-IN-ERROR    10583000
105840         MOVE TR017-ENFPO-EXTL-REF-NBR  TO TR241-DATA-VALUE       10584000
105850         MOVE PC-WARNING                TO TR241-ERROR-TYPE       10585000
105860         MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG        10586000
105870         MOVE SPACES              TO TR027-ENFPO-EXTL-REF-NBR     10587000
105880         PERFORM 6190-MOVES-FOR-ERROR-REC                         10588000
105890         PERFORM 6200-WRITE-ERROR-REPORT                          10589000
105891        ELSE                                                      10589100
105894*        ****************************************                 10589400
105895*        * IF THIS PO NUMBER IS ON TIMCNPO, GO  *                 10589500
105896*        * SEE IF THE EXTL REF IS ON TIMCNPO.   *                 10589600
105897*        ****************************************                 10589700
105898         IF PS-PO-FOUND                                           10589800
105900           MOVE TR017-ENFPO-PO-NBR       TO IMCNPO-PO-NBR         10590000
105901           MOVE TR017-ENFPO-EXTL-REF-NBR                          10590100
105902                                    TO IMCNPO-EXTL-REF-NBR        10590200
105903           SET PS-EXTL-REF-FOUND-NO TO TRUE                       10590300
105904           PERFORM 7380-SELECT-TIMCNPO-EXTL-REF                   10590400
105905           IF PS-EXTL-REF-FOUND                                   10590501
105907             CONTINUE                                             10590700
105908           ELSE                                                   10590800
105909             MOVE 'EXTL REF NBR'          TO TR241-DATA-IN-ERROR  10590900
105910             MOVE TR017-ENFPO-EXTL-REF-NBR  TO TR241-DATA-VALUE   10591000
105911             MOVE PC-WARNING              TO TR241-ERROR-TYPE     10591100
105912             MOVE                                                 10591200
105913             'REFERENCE FROM CUSTOMS DOES NOT MATCH CONT MANFST'  10591300
105914                                            TO TR241-ERROR-MSG    10591400
105915             PERFORM 6190-MOVES-FOR-ERROR-REC                     10591500
105916             PERFORM 6200-WRITE-ERROR-REPORT                      10591600
105917           END-IF                                                 10591700
105918         END-IF                                                   10591800
105919        END-IF                                                    10591900
105921                                                                  10592100
105922     END-EVALUATE.                                                10592200
105930                                                                  10593000
105931* EDIT BROKER NUMBER ************************************         10593100
105940     IF TR017-ENFPO-TRN-TYP EQUAL PC-D                            10594000
105950        MOVE TR017-ENFPO-BKR-REF-NBR  TO TR027-ENFPO-BKR-REF-NBR  10595000
105960     ELSE                                                         10596000
106000       IF TR017-ENFPO-BKR-REF-NBR EQUAL SPACES                    10600000
106100          MOVE 'BROKER REF NBR'       TO TR241-DATA-IN-ERROR      10610000
106200          MOVE TR017-ENFPO-BKR-REF-NBR   TO TR241-DATA-VALUE      10620000
106300          MOVE PC-WARNING             TO TR241-ERROR-TYPE         10630000
106400          MOVE 'DATA NOT SENT'        TO TR241-ERROR-MSG          10640000
106500          MOVE SPACES                 TO TR027-ENFPO-BKR-REF-NBR  10650000
106600          PERFORM 6190-MOVES-FOR-ERROR-REC                        10660000
106700          PERFORM 6200-WRITE-ERROR-REPORT                         10670000
106800       ELSE                                                       10680000
106900          MOVE TR017-ENFPO-BKR-REF-NBR                            10690000
106901                                      TO TR027-ENFPO-BKR-REF-NBR  10690100
106910       END-IF                                                     10691000
107000     END-IF.                                                      10700000
107100                                                                  10710000
107200     IF PS-EDIT-ERROR-NO                                          10720000
107300        PERFORM 6180-MOVES-FOR-DETAIL-REC                         10730000
107400        PERFORM 6400-WRITE-UPDATE-REPORT                          10740000
107500     END-IF.                                                      10750000
107600                                                                  10760000
107700 EJECT                                                            10770000
107800                                                                  10780000
107900******************************************************************10790000
108000* EDIT THE FIELDS THAT ARE PRESENT ON THE EXD RECORD TYPE ONLY.   10800000
108100* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *10810000
108200* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *10820000
108300* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *10830000
108400******************************************************************10840000
108500 3500-EDIT-EXD-FIELDS.                                            10850000
108600                                                                  10860000
108601     MOVE TR017-EXD-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      10860100
108602                                   TR027-EXD-POE-STD-EDI-CDE.     10860200
108604     IF TR017-EXD-TRN-TYP EQUAL PC-D                              10860400
108605         CONTINUE                                                 10860500
108606     ELSE                                                         10860600
108607         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     10860700
108608         MOVE PV-CURRENT-POE-NM     TO TR027-EXD-POE-NM           10860800
108609     END-IF.                                                      10860900
108610                                                                  10861000
108611     IF TR017-EXD-TRN-TYP EQUAL PC-D                              10861100
108612        MOVE TR017-EXD-BKR-REF-NBR     TO TR027-EXD-BKR-REF-NBR   10861200
108620     ELSE                                                         10862000
112800      IF TR017-EXD-BKR-REF-NBR EQUAL SPACES                       11280000
112900        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     11290000
113000        MOVE TR017-EXD-BKR-REF-NBR     TO TR241-DATA-VALUE        11300000
113100        MOVE PC-WARNING                TO TR241-ERROR-TYPE        11310000
113200        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         11320000
113300        MOVE SPACES                    TO TR027-EXD-BKR-REF-NBR   11330000
113400        PERFORM 6190-MOVES-FOR-ERROR-REC                          11340000
113500        PERFORM 6200-WRITE-ERROR-REPORT                           11350000
113600      ELSE                                                        11360000
113700        MOVE TR017-EXD-BKR-REF-NBR     TO TR027-EXD-BKR-REF-NBR   11370000
113710      END-IF                                                      11371000
113800     END-IF.                                                      11380000
113900                                                                  11390000
114000      IF TR017-EXD-TRN-TYP EQUAL PC-D                             11400000
114100           MOVE TR017-EXD-EXM-DTE       TO                        11410000
114200                TR027-EXD-EXM-DTE                                 11420000
114300           MOVE TR017-EXD-EXM-TM        TO                        11430000
114400                TR027-EXD-EXM-TM                                  11440000
114500      ELSE                                                        11450000
114600        IF TR017-EXD-EXM-DTE EQUAL SPACES                         11460000
114700          MOVE PC-E                     TO TR241-RPT-TYP          11470000
114800          MOVE TR017-EXD-TRN-TYP        TO TR241-TRN-TYP          11480000
114900          MOVE 'CSTM EXAM DATE'         TO TR241-DATA-IN-ERROR    11490000
115000          MOVE TR017-EXD-EXM-DTE        TO TR241-DATA-VALUE       11500000
115100          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       11510000
115200          SET PS-EDIT-ERROR             TO TRUE                   11520000
115300          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        11530000
115400          PERFORM 6190-MOVES-FOR-ERROR-REC                        11540000
115500          PERFORM 6200-WRITE-ERROR-REPORT                         11550000
115600        ELSE                                                      11560000
115700          PERFORM 5610-CHK-EXM-DTE-TM                             11570000
115800        END-IF                                                    11580000
115900      END-IF.                                                     11590000
116000                                                                  11600000
116100      IF PS-EDIT-ERROR-NO                                         11610000
116200         PERFORM 6180-MOVES-FOR-DETAIL-REC                        11620000
116300         PERFORM 6400-WRITE-UPDATE-REPORT                         11630000
116400      END-IF.                                                     11640000
116500                                                                  11650000
116600  EJECT                                                           11660000
116700                                                                  11670000
116800******************************************************************11680000
116900* EDIT THE FIELDS THAT ARE PRESENT ON THE REJ RECORD TYPE ONLY.   11690000
117000* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *11700000
117100* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *11710000
117200* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *11720000
117300******************************************************************11730000
117400 3550-EDIT-REJ-FIELDS.                                            11740000
117500                                                                  11750000
117501     MOVE TR017-REJ-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      11750100
117502                                   TR027-REJ-POE-STD-EDI-CDE.     11750200
117504     IF TR017-REJ-TRN-TYP EQUAL PC-D                              11750400
117505         CONTINUE                                                 11750500
117506     ELSE                                                         11750600
117507         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     11750700
117508         MOVE PV-CURRENT-POE-NM     TO TR027-REJ-POE-NM           11750800
117509     END-IF.                                                      11750900
117510                                                                  11751000
117511     IF TR017-REJ-TRN-TYP EQUAL PC-D                              11751100
117512        MOVE TR017-REJ-BKR-REF-NBR     TO TR027-REJ-BKR-REF-NBR   11751200
117520     ELSE                                                         11752000
120800      IF TR017-REJ-BKR-REF-NBR EQUAL SPACES                       12080000
120900        MOVE TR017-REJ-TRN-TYP         TO TR241-TRN-TYP           12090000
121000        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     12100000
121100        MOVE TR017-REJ-BKR-REF-NBR     TO TR241-DATA-VALUE        12110000
121200        MOVE PC-WARNING                TO TR241-ERROR-TYPE        12120000
121300        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         12130000
121400        PERFORM 6190-MOVES-FOR-ERROR-REC                          12140000
121500        PERFORM 6200-WRITE-ERROR-REPORT                           12150000
121600      ELSE                                                        12160000
121700        MOVE TR017-REJ-BKR-REF-NBR     TO TR027-REJ-BKR-REF-NBR   12170000
121710      END-IF                                                      12171000
121800     END-IF.                                                      12180000
121900                                                                  12190000
122000      IF TR017-REJ-TRN-TYP EQUAL PC-D                             12200000
122100           MOVE TR017-REJ-REJ-DTE       TO                        12210000
122200                TR027-REJ-REJ-DTE                                 12220000
122300           MOVE TR017-REJ-REJ-TM        TO                        12230000
122400                TR027-REJ-REJ-TM                                  12240000
122500      ELSE                                                        12250000
122600        IF TR017-REJ-REJ-DTE EQUAL SPACES                         12260000
122700          MOVE 'REJECTION DATE'         TO TR241-DATA-IN-ERROR    12270000
122800          MOVE TR017-REJ-REJ-DTE        TO TR241-DATA-VALUE       12280000
122900          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       12290000
123000          SET PS-EDIT-ERROR             TO TRUE                   12300000
123100          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        12310000
123200          PERFORM 6190-MOVES-FOR-ERROR-REC                        12320000
123300          PERFORM 6200-WRITE-ERROR-REPORT                         12330000
123400        ELSE                                                      12340000
123500          PERFORM 5620-CHK-REJ-DTE-TM                             12350000
123600        END-IF                                                    12360000
123700      END-IF.                                                     12370000
123800                                                                  12380000
123810      IF TR017-REJ-TRN-TYP EQUAL PC-D                             12381000
123820         MOVE TR017-REJ-REJ-DESC   TO TR027-REJ-REJ-DESC          12382000
123830      ELSE                                                        12383000
123900        IF TR017-REJ-REJ-DESC EQUAL SPACES                        12390000
124000          MOVE 'REJECTION DESC'     TO TR241-DATA-IN-ERROR        12400000
124100          MOVE TR017-REJ-REJ-DESC   TO TR241-DATA-VALUE           12410000
124200          MOVE PC-WARNING           TO TR241-ERROR-TYPE           12420000
124300          MOVE 'DATA NOT SENT'      TO TR241-ERROR-MSG            12430000
124400          MOVE SPACES               TO TR027-REJ-REJ-DESC         12440000
124500          PERFORM 6190-MOVES-FOR-ERROR-REC                        12450000
124600          PERFORM 6200-WRITE-ERROR-REPORT                         12460000
124700        ELSE                                                      12470000
124800          MOVE TR017-REJ-REJ-DESC   TO TR027-REJ-REJ-DESC         12480000
124810        END-IF                                                    12481000
124900      END-IF.                                                     12490000
125000                                                                  12500000
125100      IF PS-EDIT-ERROR-NO                                         12510000
125200         PERFORM 6180-MOVES-FOR-DETAIL-REC                        12520000
125300         PERFORM 6400-WRITE-UPDATE-REPORT                         12530000
125400      END-IF.                                                     12540000
125500                                                                  12550000
125600  EJECT                                                           12560000
125700                                                                  12570000
125800******************************************************************12580000
125900* EDIT THE FIELDS THAT ARE PRESENT ON THE ECR RECORD TYPE ONLY.   12590000
126000* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *12600000
126100* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *12610000
126200* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *12620000
126300******************************************************************12630000
126400 3600-EDIT-ECR-FIELDS.                                            12640000
126500                                                                  12650000
126501     MOVE TR017-ECR-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      12650100
126502                                   TR027-ECR-POE-STD-EDI-CDE.     12650200
126504     IF TR017-ECR-TRN-TYP EQUAL PC-D                              12650400
126505         CONTINUE                                                 12650500
126506     ELSE                                                         12650600
126507         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     12650700
126508         MOVE PV-CURRENT-POE-NM     TO TR027-ECR-POE-NM           12650800
126509     END-IF.                                                      12650900
126510                                                                  12651000
126511     IF TR017-ECR-TRN-TYP EQUAL PC-D                              12651100
126512        MOVE TR017-ECR-BKR-REF-NBR     TO TR027-ECR-BKR-REF-NBR   12651200
126520     ELSE                                                         12652000
129800      IF TR017-ECR-BKR-REF-NBR EQUAL SPACES                       12980000
129900        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     12990000
130000        MOVE TR017-ECR-BKR-REF-NBR     TO TR241-DATA-VALUE        13000000
130100        MOVE PC-WARNING                TO TR241-ERROR-TYPE        13010000
130200        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         13020000
130300        MOVE SPACES                    TO TR027-ECR-BKR-REF-NBR   13030000
130400        PERFORM 6190-MOVES-FOR-ERROR-REC                          13040000
130500        PERFORM 6200-WRITE-ERROR-REPORT                           13050000
130600      ELSE                                                        13060000
130700        MOVE TR017-ECR-BKR-REF-NBR     TO TR027-ECR-BKR-REF-NBR   13070000
130800      END-IF                                                      13080000
130810     END-IF.                                                      13081000
130900                                                                  13090000
131000      IF TR017-ECR-TRN-TYP EQUAL PC-D                             13100000
131100           MOVE TR017-ECR-EST-CLR-DTE   TO                        13110000
131200                TR027-ECR-EST-CLR-DTE                             13120000
131300           MOVE TR017-ECR-EST-CLR-TM    TO                        13130000
131400                TR027-ECR-EST-CLR-TM                              13140000
131500      ELSE                                                        13150000
131600        IF TR017-ECR-EST-CLR-DTE EQUAL SPACES                     13160000
131700          MOVE 'EST CLEAR DATE'         TO TR241-DATA-IN-ERROR    13170000
131800          MOVE TR017-ECR-EST-CLR-DTE    TO TR241-DATA-VALUE       13180000
131900          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       13190000
132000          SET PS-EDIT-ERROR             TO TRUE                   13200000
132100          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        13210000
132200          PERFORM 6190-MOVES-FOR-ERROR-REC                        13220000
132300          PERFORM 6200-WRITE-ERROR-REPORT                         13230000
132400        ELSE                                                      13240000
132500          PERFORM 5630-CHK-EST-CLR-DTE-TM                         13250000
132600        END-IF                                                    13260000
132700      END-IF.                                                     13270000
132800                                                                  13280000
132900      IF PS-EDIT-ERROR-NO                                         13290000
133000         PERFORM 6180-MOVES-FOR-DETAIL-REC                        13300000
133100         PERFORM 6400-WRITE-UPDATE-REPORT                         13310000
133200      END-IF.                                                     13320000
133300                                                                  13330000
133400  EJECT                                                           13340000
133500                                                                  13350000
133600******************************************************************13360000
133700* EDIT THE FIELDS THAT ARE PRESENT ON THE RLS RECORD TYPE ONLY.   13370000
133800* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *13380000
133900* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *13390000
134000* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *13400000
134100******************************************************************13410000
134200 3650-EDIT-RLS-FIELDS.                                            13420000
134300                                                                  13430000
134301     MOVE TR017-RLS-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      13430100
134302                                   TR027-RLS-POE-STD-EDI-CDE.     13430200
134304     IF TR017-RLS-TRN-TYP EQUAL PC-D                              13430400
134305         CONTINUE                                                 13430500
134306     ELSE                                                         13430600
134307         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     13430700
134308         MOVE PV-CURRENT-POE-NM     TO TR027-RLS-POE-NM           13430800
134309     END-IF.                                                      13430900
134310                                                                  13431000
134311     IF TR017-RLS-TRN-TYP EQUAL PC-D                              13431100
134312        MOVE TR017-RLS-BKR-REF-NBR     TO TR027-RLS-BKR-REF-NBR   13431200
134320     ELSE                                                         13432000
137600      IF TR017-RLS-BKR-REF-NBR EQUAL SPACES                       13760000
137700        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     13770000
137800        MOVE TR017-RLS-BKR-REF-NBR     TO TR241-DATA-VALUE        13780000
137900        MOVE PC-WARNING                TO TR241-ERROR-TYPE        13790000
138000        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         13800000
138100        MOVE SPACES                    TO TR027-RLS-BKR-REF-NBR   13810000
138200        PERFORM 6190-MOVES-FOR-ERROR-REC                          13820000
138300        PERFORM 6200-WRITE-ERROR-REPORT                           13830000
138400      ELSE                                                        13840000
138500        MOVE TR017-RLS-BKR-REF-NBR     TO TR027-RLS-BKR-REF-NBR   13850000
138600      END-IF                                                      13860000
138610     END-IF.                                                      13861000
138700                                                                  13870000
138800      IF TR017-RLS-TRN-TYP EQUAL PC-D                             13880000
138900           MOVE TR017-RLS-ACTL-CLR-DTE  TO                        13890000
139000                TR027-RLS-ACTL-CLR-DTE                            13900000
139100           MOVE TR017-RLS-ACTL-CLR-TM   TO                        13910000
139200                TR027-RLS-ACTL-CLR-TM                             13920000
139300      ELSE                                                        13930000
139400        IF TR017-RLS-ACTL-CLR-DTE EQUAL SPACES                    13940000
139500          MOVE 'ACTL CLEAR DATE'        TO TR241-DATA-IN-ERROR    13950000
139600          MOVE TR017-RLS-ACTL-CLR-DTE   TO TR241-DATA-VALUE       13960000
139700          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       13970000
139800          SET PS-EDIT-ERROR             TO TRUE                   13980000
139900          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        13990000
140000          PERFORM 6190-MOVES-FOR-ERROR-REC                        14000000
140100          PERFORM 6200-WRITE-ERROR-REPORT                         14010000
140200        ELSE                                                      14020000
140300          PERFORM 5640-CHK-ACTL-CLR-DTE-TM                        14030000
140400        END-IF                                                    14040000
140500      END-IF.                                                     14050000
140600                                                                  14060000
140700      IF PS-EDIT-ERROR-NO                                         14070000
140800         PERFORM 6180-MOVES-FOR-DETAIL-REC                        14080000
140900         PERFORM 6400-WRITE-UPDATE-REPORT                         14090000
141000      END-IF.                                                     14100000
141100                                                                  14110000
141200  EJECT                                                           14120000
141300                                                                  14130000
141400******************************************************************14140000
141500* EDIT THE FIELDS THAT ARE PRESENT ON THE LIQ RECORD TYPE ONLY.   14150000
141600* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *14160000
141700* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *14170000
141800* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *14180000
141900******************************************************************14190000
142000 3700-EDIT-LIQ-FIELDS.                                            14200000
142100                                                                  14210000
142101     MOVE TR017-LIQ-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      14210100
142102                                   TR027-LIQ-POE-STD-EDI-CDE.     14210200
142104     IF TR017-LIQ-TRN-TYP EQUAL PC-D                              14210400
142105         CONTINUE                                                 14210500
142106     ELSE                                                         14210600
142107         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     14210700
142108         MOVE PV-CURRENT-POE-NM     TO TR027-LIQ-POE-NM           14210800
142109     END-IF.                                                      14210900
142110                                                                  14211000
142111     IF TR017-LIQ-TRN-TYP EQUAL PC-D                              14211100
142112        MOVE TR017-LIQ-BKR-REF-NBR     TO TR027-LIQ-BKR-REF-NBR   14211200
142120     ELSE                                                         14212000
145400      IF TR017-LIQ-BKR-REF-NBR EQUAL SPACES                       14540000
145500        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     14550000
145600        MOVE TR017-LIQ-BKR-REF-NBR     TO TR241-DATA-VALUE        14560000
145700        MOVE PC-WARNING                TO TR241-ERROR-TYPE        14570000
145800        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         14580000
145900        MOVE SPACES                    TO TR027-LIQ-BKR-REF-NBR   14590000
146000        PERFORM 6190-MOVES-FOR-ERROR-REC                          14600000
146100        PERFORM 6200-WRITE-ERROR-REPORT                           14610000
146200      ELSE                                                        14620000
146300        MOVE TR017-LIQ-BKR-REF-NBR     TO TR027-LIQ-BKR-REF-NBR   14630000
146400      END-IF                                                      14640000
146410     END-IF.                                                      14641000
146500                                                                  14650000
146600      IF TR017-LIQ-TRN-TYP EQUAL PC-D                             14660000
146700           MOVE TR017-LIQ-LQDN-DTE      TO                        14670000
146800                TR027-LIQ-LQDN-DTE                                14680000
146900           MOVE TR017-LIQ-LQDN-TM       TO                        14690000
147000                TR027-LIQ-LQDN-TM                                 14700000
147100      ELSE                                                        14710000
147200        IF TR017-LIQ-LQDN-DTE EQUAL SPACES                        14720000
147300          MOVE 'LIQUIDATION DTE'        TO TR241-DATA-IN-ERROR    14730000
147400          MOVE TR017-LIQ-LQDN-DTE       TO TR241-DATA-VALUE       14740000
147500          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       14750000
147600          SET PS-EDIT-ERROR             TO TRUE                   14760000
147700          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        14770000
147800          PERFORM 6190-MOVES-FOR-ERROR-REC                        14780000
147900          PERFORM 6200-WRITE-ERROR-REPORT                         14790000
148000        ELSE                                                      14800000
148100          PERFORM 5650-CHK-LQDN-DTE-TM                            14810000
148200        END-IF                                                    14820000
148300      END-IF.                                                     14830000
148400                                                                  14840000
148500      IF PS-EDIT-ERROR-NO                                         14850000
148600         PERFORM 6180-MOVES-FOR-DETAIL-REC                        14860000
148700         PERFORM 6400-WRITE-UPDATE-REPORT                         14870000
148800      END-IF.                                                     14880000
148900                                                                  14890000
149000  EJECT                                                           14900000
149100                                                                  14910000
149200******************************************************************14920000
149300* EDIT THE FIELDS THAT ARE PRESENT ON THE LSU RECORD TYPE ONLY.   14930000
149400* (BKR-REF-NBR AND POE-STD-EDI-CDE APPEAR ON ALL REC TYPES BUT   *14940000
149500* ARE LOCATED IN DIFFERENT POSITIONS ON THE RECORD, SO THEY NEED *14950000
149600* TO BE EDITED INDIVIDUALLY WITH EACH REC-TYP.                   *14960000
149700******************************************************************14970000
149800 3750-EDIT-LSU-FIELDS.                                            14980000
149900                                                                  14990000
149901     MOVE TR017-LSU-POE-STD-EDI-CDE    TO PV-CURRENT-POE-CDE      14990100
149902                                   TR027-LSU-POE-STD-EDI-CDE.     14990200
149904     IF TR017-LSU-TRN-TYP EQUAL PC-D                              14990400
149905         CONTINUE                                                 14990500
149906     ELSE                                                         14990600
149907         PERFORM 3800-GET-POE-NM-FROM-EDI-CDE                     14990700
149908         MOVE PV-CURRENT-POE-NM     TO TR027-LSU-POE-NM           14990800
149909     END-IF.                                                      14990900
149910                                                                  14991000
149911     IF TR017-LSU-TRN-TYP EQUAL PC-D                              14991100
149912        MOVE TR017-LSU-BKR-REF-NBR     TO TR027-LSU-BKR-REF-NBR   14991200
149920     ELSE                                                         14992000
153200      IF TR017-LSU-BKR-REF-NBR EQUAL SPACES                       15320000
153300        MOVE 'BROKER REF NBR'          TO TR241-DATA-IN-ERROR     15330000
153400        MOVE TR017-LSU-BKR-REF-NBR     TO TR241-DATA-VALUE        15340000
153500        MOVE PC-WARNING                TO TR241-ERROR-TYPE        15350000
153600        MOVE 'DATA NOT SENT'           TO TR241-ERROR-MSG         15360000
153700        MOVE SPACES                    TO TR027-LSU-BKR-REF-NBR   15370000
153800        PERFORM 6190-MOVES-FOR-ERROR-REC                          15380000
153900        PERFORM 6200-WRITE-ERROR-REPORT                           15390000
154000      ELSE                                                        15400000
154100        MOVE TR017-LSU-BKR-REF-NBR     TO TR027-LSU-BKR-REF-NBR   15410000
154200      END-IF                                                      15420000
154210     END-IF.                                                      15421000
154300                                                                  15430000
154400      IF TR017-LSU-TRN-TYP EQUAL PC-D                             15440000
154500           MOVE TR017-LSU-LQDN-SSPNN-DTE TO                       15450000
154600                TR027-LSU-LQDN-SSPNN-DTE                          15460000
154700           MOVE TR017-LSU-LQDN-SSPNN-TM TO                        15470000
154800                TR027-LSU-LQDN-SSPNN-TM                           15480000
154900      ELSE                                                        15490000
155000        IF TR017-LSU-LQDN-SSPNN-DTE EQUAL SPACES                  15500000
155100          MOVE 'LIQ SUSPEN DATE'        TO TR241-DATA-IN-ERROR    15510000
155200          MOVE TR017-LSU-LQDN-SSPNN-DTE TO TR241-DATA-VALUE       15520000
155300          MOVE PC-ERROR                 TO TR241-ERROR-TYPE       15530000
155400          SET PS-EDIT-ERROR             TO TRUE                   15540000
155500          MOVE 'DATA NOT SENT'          TO TR241-ERROR-MSG        15550000
155600          PERFORM 6190-MOVES-FOR-ERROR-REC                        15560000
155700          PERFORM 6200-WRITE-ERROR-REPORT                         15570000
155800        ELSE                                                      15580000
155900          PERFORM 5660-CHK-LQDN-SUSP-DTE-TM                       15590000
156000        END-IF                                                    15600000
156100      END-IF.                                                     15610000
156200                                                                  15620000
156210      IF TR017-LSU-TRN-TYP EQUAL PC-D                             15621000
156220         MOVE TR017-LSU-LQDN-SSPNN-DESC TO                        15622000
156230                TR027-LSU-LQDN-SSPNN-DESC                         15623000
156240      ELSE                                                        15624000
156300       IF TR017-LSU-LQDN-SSPNN-DESC EQUAL SPACES                  15630000
156400         MOVE PC-E                 TO TR241-RPT-TYP               15640000
156500         MOVE TR017-LSU-TRN-TYP    TO TR241-TRN-TYP               15650000
156600         MOVE 'LIQ SUSPN DESC'     TO TR241-DATA-IN-ERROR         15660000
156700         MOVE TR017-LSU-LQDN-SSPNN-DESC                           15670000
156800                                   TO TR241-DATA-VALUE            15680000
156900         MOVE PC-WARNING           TO TR241-ERROR-TYPE            15690000
157000         MOVE 'DATA NOT SENT'      TO TR241-ERROR-MSG             15700000
157100         MOVE PV-PROCESS-SEQ-NBR   TO TR241-PROCESS-SEQ-NBR       15710000
157200         MOVE SPACES               TO TR027-LSU-LQDN-SSPNN-DESC   15720000
157300         PERFORM 6190-MOVES-FOR-ERROR-REC                         15730000
157400         PERFORM 6200-WRITE-ERROR-REPORT                          15740000
157500       ELSE                                                       15750000
157600         MOVE TR017-LSU-LQDN-SSPNN-DESC TO                        15760000
157700                TR027-LSU-LQDN-SSPNN-DESC                         15770000
157710       END-IF                                                     15771000
157800      END-IF.                                                     15780000
157900                                                                  15790000
158000      IF PS-EDIT-ERROR-NO                                         15800000
158100         PERFORM 6180-MOVES-FOR-DETAIL-REC                        15810000
158200         PERFORM 6400-WRITE-UPDATE-REPORT                         15820000
158300      END-IF.                                                     15830000
158400                                                                  15840000
158500  EJECT                                                           15850000
158730******************************************************************15873000
158800* RETRIEVE THE POE NAME DESCRIPTION FROM THE POE-STD-EDI-CDE      15880000
158900* ON THE INPUT BY LOOKING UP THE POE NAME DESCRIPTION FROM        15890000
159000*  KOHL'S TIMPOE TABLE. THE NAME DESCRIPTION WILL BE PASSED TO    15900000
159100*  BOTH ERROR AND EXTRACT FILES IF IT IS VALID.                   15910000
159200*  THE ACTUAL 4-BYTE POE-STD-EDI-CDE ITSELF IS ONLY PASSED TO     15920000
159300*  THE EXTRACT FILE IF IT IS PRESENT (NOT ZEROES OR SPACES).      15930000
159400*  IT IS STILL PASSED TO THE EXTRACT FOR LOADING EVEN IF THE      15940000
159500*  POE CDE WAS NOT FOUND ON THE TABLE. THE POE CDE WILL ALSO      15950000
159600*  BE PUT INTO THE POE-NM FIELD OF THE EXTRACT FILE , EVEN IF     15960000
159700*  THE CODE WAS NOT FOUND ON THE KOHL'S TIMPOE TABLE.             15970000
159800*  IF THE POE-STD-EDI-CDE IS NOT PRESENT, SPACES WILL             15980000
159900*  BE MOVED TO THE EXTRACT FILE POE-STD-EDI-CDE FIELD AND         15990000
160000*  NAME DESCRIPTION FIELD. THE ACTUAL 4-BYTE FIELD OF THE         16000000
160100*  POE-STD-EDI-CDE WILL BE MOVED TO THE NAME DESCRIPTION FIELD    16010000
160200*  ON THE ERROR REPORT WITH EITHER OF TWO WARNING MESSAGES:       16020000
160300*  " POE CODE NOT ON MAINFRAME " (NOT FOUND)  OR                  16030000
160400*  " POE CODE NOT SENT " (INPUT WAS ZEROES OR SPACES)             16040000
160500******************************************************************16050000
160600 3800-GET-POE-NM-FROM-EDI-CDE.                                    16060000
160700                                                                  16070000
160701     EVALUATE TRUE                                                16070100
160702                                                                  16070200
160704      WHEN PV-CURRENT-POE-CDE = SPACES                            16070400
160705      WHEN PV-CURRENT-POE-CDE = ZEROES                            16070500
160706        MOVE 'DEST POE CDE'           TO TR241-DATA-IN-ERROR      16070600
160707        MOVE PV-CURRENT-POE-CDE       TO TR241-DATA-VALUE         16070700
160708        MOVE PC-WARNING               TO TR241-ERROR-TYPE         16070800
160709        MOVE 'POE CODE MISSING'       TO TR241-ERROR-MSG          16070900
160710        MOVE SPACES                   TO PV-CURRENT-POE-NM        16071000
160711        MOVE SPACES                   TO PV-CURRENT-POE-CDE       16071100
160712        PERFORM 6190-MOVES-FOR-ERROR-REC                          16071200
160713        PERFORM 6200-WRITE-ERROR-REPORT                           16071300
160714                                                                  16071400
160715      WHEN OTHER                                                  16071500
160716       IF PV-CURRENT-POE-CDE = PV-LAST-GOOD-POE-CDE               16071600
160717         MOVE PV-LAST-GOOD-POE-NM    TO PV-CURRENT-POE-NM         16071700
160718         CONTINUE                                                 16071800
160719       ELSE                                                       16071900
160720         MOVE PV-CURRENT-POE-CDE     TO IMPOE-POE-STD-EDI-CDE     16072000
160721         PERFORM 3810-OPEN-POE-CSR                                16072100
160722         SET PS-POE-FOUND-NO TO TRUE                              16072200
160723         PERFORM 3820-FETCH-POE-CSR                               16072300
160724         IF PS-POE-FOUND                                          16072400
160725           MOVE IMPOE-POE-NM         TO PV-LAST-GOOD-POE-NM       16072500
160726                                        PV-CURRENT-POE-NM         16072600
160727           MOVE PV-CURRENT-POE-CDE   TO PV-LAST-GOOD-POE-CDE      16072700
160728         ELSE                                                     16072800
160729           MOVE 'DEST POE CDE'       TO TR241-DATA-IN-ERROR       16072900
160730           MOVE PV-CURRENT-POE-CDE   TO TR241-DATA-VALUE          16073000
160731                                        PV-CURRENT-POE-NM         16073100
160732           MOVE PC-WARNING           TO TR241-ERROR-TYPE          16073200
160733           MOVE 'POE CODE NOT ON MAINFRAME'                       16073300
160734                                     TO TR241-ERROR-MSG           16073400
160735           PERFORM 6190-MOVES-FOR-ERROR-REC                       16073500
160736           PERFORM 6200-WRITE-ERROR-REPORT                        16073600
160737         END-IF                                                   16073700
160738         PERFORM 3830-CLOSE-POE-CSR                               16073800
160739       END-IF                                                     16073900
160740                                                                  16074000
160741     END-EVALUATE.                                                16074100
160750                                                                  16075000
162000 EJECT                                                            16200000
162100                                                                  16210000
162200******************************************************************16220000
162300* OPEN POE_CSR                                                   *16230000
162400******************************************************************16240000
162500 3810-OPEN-POE-CSR.                                               16250000
162600                                                                  16260000
162700     EXEC SQL                                                     16270000
162800         OPEN POE_CSR                                             16280000
162900     END-EXEC.                                                    16290000
163000                                                                  16300000
163100     EVALUATE TRUE                                                16310000
163200        WHEN SQLWARN0 NOT EQUAL SPACE                             16320000
163300        WHEN SQLCODE NOT EQUAL ZERO                               16330000
163400           DISPLAY '*************************************'        16340000
163500           DISPLAY '** ABEND                           **'        16350000
163600           DISPLAY '** PROGRAM = TRKUT240              **'        16360000
163700           DISPLAY '** PARAGRAPH = 3810-OPEN-POE-CSR   **'        16370000
163800           DISPLAY '*************************************'        16380000
163900           PERFORM 9100-SQL-ABEND                                 16390000
164000     END-EVALUATE.                                                16400000
164100                                                                  16410000
164200 EJECT                                                            16420000
164300                                                                  16430000
164400******************************************************************16440000
164500* FETCH POE_CSR                                                  *16450000
164600******************************************************************16460000
164700 3820-FETCH-POE-CSR.                                              16470000
164800                                                                  16480000
165100                                                                  16510000
165200     EXEC SQL                                                     16520000
165300         FETCH POE_CSR                                            16530000
165400              INTO :IMPOE-POE-NM                                  16540000
165500     END-EXEC.                                                    16550000
165600                                                                  16560000
165700     EVALUATE TRUE                                                16570000
165800        WHEN SQLCODE = +100                                       16580000
165900           CONTINUE                                               16590000
166000        WHEN SQLCODE = +0                                         16600000
166100           SET PS-POE-FOUND               TO TRUE                 16610000
166200        WHEN SQLWARN0 NOT EQUAL SPACE                             16620000
166300        WHEN SQLCODE NOT EQUAL ZERO                               16630000
166400           DISPLAY '**************************************'       16640000
166500           DISPLAY '** ABEND                            **'       16650000
166600           DISPLAY '** PROGRAM = TRKUT240               **'       16660000
166700           DISPLAY '** PARAGRAPH = 3820-FETCH-POE-CSR   **'       16670000
166800           DISPLAY '**************************************'       16680000
166900           PERFORM 9100-SQL-ABEND                                 16690000
167000     END-EVALUATE.                                                16700000
167100                                                                  16710000
167200 EJECT                                                            16720000
167300                                                                  16730000
167400******************************************************************16740000
167500* CLOSE POE_CSR                                                  *16750000
167600******************************************************************16760000
167700 3830-CLOSE-POE-CSR.                                              16770000
167800                                                                  16780000
167900     EXEC SQL                                                     16790000
168000       CLOSE POE_CSR                                              16800000
168100     END-EXEC.                                                    16810000
168200                                                                  16820000
168300     EVALUATE TRUE                                                16830000
168400        WHEN SQLWARN0 NOT EQUAL SPACE                             16840000
168500        WHEN SQLCODE NOT EQUAL ZERO                               16850000
168600           DISPLAY '**************************************'       16860000
168700           DISPLAY '** ABEND                            **'       16870000
168800           DISPLAY '** PROGRAM = TRKUT240               **'       16880000
168900           DISPLAY '** PARAGRAPH = 3830-CLOSE-POE-CSR   **'       16890000
169000           DISPLAY '**************************************'       16900000
169100           PERFORM 9100-SQL-ABEND                                 16910000
169200     END-EVALUATE.                                                16920000
169300                                                                  16930000
169400 EJECT                                                            16940000
169500                                                                  16950000
169600******************************************************************16960000
169700* INITIALIZE THE ERROR FIELDS FROM TRRD241.                      *16970000
169800******************************************************************16980000
169900 5450-INITIALIZE-ERROR-FIELDS.                                    16990000
170000                                                                  17000000
170100      INITIALIZE      TR241-RPT-TYP                               17010000
170200                      TR241-TRN-TYP                               17020000
170300                      TR241-CSTM-ENTR-ID                          17030000
170400                      TR241-BKR-REF-NBR                           17040000
170500                      TR241-DATA-IN-ERROR                         17050000
170600                      TR241-DATA-VALUE-NUM                        17060000
170700                      TR241-DATA-VALUE                            17070000
170800                      TR241-ERROR-TYPE                            17080000
170900                      TR241-ERROR-MSG                             17090000
171000                      TR241-REC-TYP-ENF                           17100000
171100                      TR241-REC-TYP-ENFBOL                        17110000
171200                      TR241-REC-TYP-ENFCON                        17120000
171210                      TR241-REC-TYP-DOP                           17121000
171300                      TR241-REC-TYP-ENFPO                         17130000
171400                      TR241-REC-TYP-EXD                           17140000
171500                      TR241-REC-TYP-REJ                           17150000
171600                      TR241-REC-TYP-ECR                           17160000
171700                      TR241-REC-TYP-RLS                           17170000
171800                      TR241-REC-TYP-LIQ                           17180000
171900                      TR241-REC-TYP-LSU.                          17190000
172000                                                                  17200000
172100 EJECT                                                            17210000
172200                                                                  17220000
172300******************************************************************17230000
172400* CHECK THE INPUT ENF-FILD-DTE WITH CALENDAR ROUTINE TO MAKE      17240000
172500* SURE THE DATE IS VALID, THEN EDIT THE TIME IF IT WAS SENT.      17250000
172600******************************************************************17260000
172700 5600-CHK-FILD-DTE-TM.                                            17270000
172800                                                                  17280000
172900     INITIALIZE   DPG51 DPG52 DPG53                               17290000
173000                  DPG54 DPG55 DPG56.                              17300000
173100                                                                  17310000
173200     SET DPG52-LK-DTE-ISO              TO TRUE.                   17320000
173300     MOVE TR017-ENF-FILD-DTE           TO                         17330000
173400            DPG52-LK-DATE-INPUT.                                  17340000
173500     MOVE PC-A0                        TO DPG51-CALENDAR-TYPE.    17350000
173600                                                                  17360000
173700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    17370000
173800                                             DPG54 DPG55 DPG56.   17380000
173900                                                                  17390000
174000     EVALUATE TRUE                                                17400000
174100         WHEN DPG54-SEVERE-ERROR                                  17410000
174200         WHEN DPG54-WARNING-ERROR                                 17420000
174300            MOVE 'ENTRY FILED DTE'       TO TR241-DATA-IN-ERROR   17430000
174400            MOVE TR017-ENF-FILD-DTE      TO TR241-DATA-VALUE      17440000
174500            MOVE PC-ERROR                TO TR241-ERROR-TYPE      17450000
174600            SET PS-EDIT-ERROR            TO TRUE                  17460000
174700            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       17470000
174800            PERFORM 6190-MOVES-FOR-ERROR-REC                      17480000
174900            PERFORM 6200-WRITE-ERROR-REPORT                       17490000
175000         WHEN OTHER                                               17500000
175100            MOVE TR017-ENF-FILD-DTE      TO                       17510000
175200                    TR027-ENF-FILD-DTE                            17520000
175300     END-EVALUATE.                                                17530000
175400                                                                  17540000
175500     IF TR017-ENF-FILD-TM EQUAL SPACES OR                         17550000
175600        TR017-ENF-FILD-TM EQUAL ZEROES                            17560000
175700         MOVE ZEROES TO TR027-ENF-FILD-TM                         17570000
175710     ELSE                                                         17571002
175720         IF TR017-ENF-FILD-TM (1:1) = SPACES OR                   17572002
175730            TR017-ENF-FILD-TM (2:1) = SPACES OR                   17573002
175740            TR017-ENF-FILD-TM (3:1) = SPACES OR                   17574002
175750            TR017-ENF-FILD-TM (4:1) = SPACES                      17575002
175770             MOVE 'ENTRY FILED TM'     TO TR241-DATA-IN-ERROR     17577003
175780             MOVE TR017-ENF-FILD-TM    TO TR241-DATA-VALUE        17578003
175790             MOVE PC-WARNING           TO TR241-ERROR-TYPE        17579003
175791             MOVE 'INVALID TIME'       TO TR241-ERROR-MSG         17579103
175792             MOVE ZEROES               TO TR027-ENF-FILD-TM       17579203
175793             PERFORM 6190-MOVES-FOR-ERROR-REC                     17579303
175794             PERFORM 6200-WRITE-ERROR-REPORT                      17579403
175800         ELSE                                                     17580003
175900             IF TR017-ENF-FILD-TM (1:2) < '24' AND                17590003
176000                TR017-ENF-FILD-TM (3:2) < '60'                    17600003
176100                 MOVE TR017-ENF-FILD-TM TO                        17610003
176200                      TR027-ENF-FILD-TM                           17620003
176300             ELSE                                                 17630003
176400                 MOVE 'ENTRY FILED TM'     TO TR241-DATA-IN-ERROR 17640003
176500                 MOVE TR017-ENF-FILD-TM    TO TR241-DATA-VALUE    17650003
176600                 MOVE PC-WARNING           TO TR241-ERROR-TYPE    17660003
176700                 MOVE 'INVALID TIME'       TO TR241-ERROR-MSG     17670003
176800                 MOVE ZEROES               TO TR027-ENF-FILD-TM   17680003
176900                 PERFORM 6190-MOVES-FOR-ERROR-REC                 17690003
177000                 PERFORM 6200-WRITE-ERROR-REPORT                  17700003
177100             END-IF                                               17710003
177110         END-IF                                                   17711003
177200     END-IF.                                                      17720000
177300                                                                  17730000
177400 EJECT                                                            17740000
177600******************************************************************17760000
177700* CHECK THE INPUT EXD-EXM-DTE DATE WITH THE CALENDAR ROUTINE     *17770000
177800* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *17780000
177900******************************************************************17790000
178000 5610-CHK-EXM-DTE-TM.                                             17800000
178100                                                                  17810000
178200     INITIALIZE   DPG51 DPG52 DPG53                               17820000
178300                  DPG54 DPG55 DPG56.                              17830000
178400                                                                  17840000
178500     SET DPG52-LK-DTE-ISO              TO TRUE.                   17850000
178600     MOVE TR017-EXD-EXM-DTE            TO                         17860000
178700            DPG52-LK-DATE-INPUT.                                  17870000
178800     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 17880000
178900                                                                  17890000
179000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    17900000
179100                                             DPG54 DPG55 DPG56.   17910000
179200                                                                  17920000
179300     EVALUATE TRUE                                                17930000
179400         WHEN DPG54-SEVERE-ERROR                                  17940000
179500         WHEN DPG54-WARNING-ERROR                                 17950000
179600            MOVE 'CSTM EXAM DATE'        TO TR241-DATA-IN-ERROR   17960000
179700            MOVE TR017-EXD-EXM-DTE       TO TR241-DATA-VALUE      17970000
179800            MOVE PC-ERROR                TO TR241-ERROR-TYPE      17980000
179900            SET PS-EDIT-ERROR            TO TRUE                  17990000
180000            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       18000000
180100            PERFORM 6190-MOVES-FOR-ERROR-REC                      18010000
180200            PERFORM 6200-WRITE-ERROR-REPORT                       18020000
180300         WHEN OTHER                                               18030000
180400            MOVE TR017-EXD-EXM-DTE       TO                       18040000
180500                   TR027-EXD-EXM-DTE                              18050000
180600     END-EVALUATE.                                                18060000
180700                                                                  18070000
180800     IF TR017-EXD-EXM-TM EQUAL SPACES OR                          18080003
180900        TR017-EXD-EXM-TM EQUAL ZEROES                             18090003
181000         MOVE ZEROES TO TR027-EXD-EXM-TM                          18100003
181010     ELSE                                                         18101003
181020         IF TR017-EXD-EXM-TM (1:1) = SPACES OR                    18102003
181030            TR017-EXD-EXM-TM (2:1) = SPACES OR                    18103003
181040            TR017-EXD-EXM-TM (3:1) = SPACES OR                    18104003
181050            TR017-EXD-EXM-TM (4:1) = SPACES                       18105003
181060             MOVE 'CSTM EXAM TIME'   TO TR241-DATA-IN-ERROR       18106003
181070             MOVE TR017-EXD-EXM-TM   TO TR241-DATA-VALUE          18107003
181080             MOVE PC-WARNING         TO TR241-ERROR-TYPE          18108003
181090             MOVE 'INVALID TIME'     TO TR241-ERROR-MSG           18109003
181091             MOVE ZEROES             TO TR027-EXD-EXM-TM          18109103
181092             PERFORM 6190-MOVES-FOR-ERROR-REC                     18109203
181093             PERFORM 6200-WRITE-ERROR-REPORT                      18109303
181100         ELSE                                                     18110003
181200             IF TR017-EXD-EXM-TM (1:2) < '24' AND                 18120003
181300                TR017-EXD-EXM-TM (3:2) < '60'                     18130003
181400                 MOVE TR017-EXD-EXM-TM TO TR027-EXD-EXM-TM        18140003
181600             ELSE                                                 18160003
181700                 MOVE 'CSTM EXAM TIME'   TO TR241-DATA-IN-ERROR   18170003
181800                 MOVE TR017-EXD-EXM-TM   TO TR241-DATA-VALUE      18180003
181900                 MOVE PC-WARNING         TO TR241-ERROR-TYPE      18190003
182000                 MOVE 'INVALID TIME'     TO TR241-ERROR-MSG       18200003
182100                 MOVE ZEROES             TO TR027-EXD-EXM-TM      18210003
182200                 PERFORM 6190-MOVES-FOR-ERROR-REC                 18220003
182300                 PERFORM 6200-WRITE-ERROR-REPORT                  18230003
182400             END-IF                                               18240003
182410         END-IF                                                   18241003
182500     END-IF.                                                      18250003
182600                                                                  18260000
182700 EJECT                                                            18270000
182900******************************************************************18290000
183000* CHECK THE INPUT REJ-REJ-DTE WITH A CALENDAR ROUTINE TO MAKE    *18300000
183100* SURE THE DATE IS VALID, THEN EDIT THE TIME IF IT WAS SENT.     *18310000
183200******************************************************************18320000
183300 5620-CHK-REJ-DTE-TM.                                             18330000
183400                                                                  18340000
183500     INITIALIZE   DPG51 DPG52 DPG53                               18350000
183600                  DPG54 DPG55 DPG56.                              18360000
183700                                                                  18370000
183800     SET DPG52-LK-DTE-ISO              TO TRUE.                   18380000
183900     MOVE TR017-REJ-REJ-DTE            TO                         18390000
184000            DPG52-LK-DATE-INPUT.                                  18400000
184100     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 18410000
184200                                                                  18420000
184300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    18430000
184400                                             DPG54 DPG55 DPG56.   18440000
184500                                                                  18450000
184600     EVALUATE TRUE                                                18460000
184700         WHEN DPG54-SEVERE-ERROR                                  18470000
184800         WHEN DPG54-WARNING-ERROR                                 18480000
184900            MOVE 'REJECTION DATE'        TO TR241-DATA-IN-ERROR   18490000
185000            MOVE TR017-REJ-REJ-DTE       TO TR241-DATA-VALUE      18500000
185100            MOVE PC-ERROR                TO TR241-ERROR-TYPE      18510000
185200            SET  PS-EDIT-ERROR           TO TRUE                  18520000
185300            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       18530000
185400            PERFORM 6190-MOVES-FOR-ERROR-REC                      18540000
185500            PERFORM 6200-WRITE-ERROR-REPORT                       18550000
185600         WHEN OTHER                                               18560000
185700            MOVE TR017-REJ-REJ-DTE       TO                       18570000
185800                   TR027-REJ-REJ-DTE                              18580000
185900     END-EVALUATE.                                                18590000
186000                                                                  18600000
186100     IF TR017-REJ-REJ-TM EQUAL SPACES OR                          18610003
186200        TR017-REJ-REJ-TM EQUAL ZEROES                             18620003
186300         MOVE ZEROES TO TR027-REJ-REJ-TM                          18630003
186310     ELSE                                                         18631003
186320         IF TR017-REJ-REJ-TM (1:1) = SPACES OR                    18632003
186330            TR017-REJ-REJ-TM (2:1) = SPACES OR                    18633003
186340            TR017-REJ-REJ-TM (3:1) = SPACES OR                    18634003
186350            TR017-REJ-REJ-TM (4:1) = SPACES                       18635003
186360             MOVE 'REJECTION TIME'    TO TR241-DATA-IN-ERROR      18636003
186370             MOVE TR017-REJ-REJ-TM    TO TR241-DATA-VALUE         18637003
186380             MOVE PC-WARNING          TO TR241-ERROR-TYPE         18638003
186390             MOVE 'INVALID TIME'      TO TR241-ERROR-MSG          18639003
186391             MOVE ZEROES              TO TR027-REJ-REJ-TM         18639103
186392             PERFORM 6190-MOVES-FOR-ERROR-REC                     18639203
186393             PERFORM 6200-WRITE-ERROR-REPORT                      18639303
186400         ELSE                                                     18640003
186500             IF TR017-REJ-REJ-TM (1:2) < '24' AND                 18650003
186600                TR017-REJ-REJ-TM (3:2) < '60'                     18660003
186700                 MOVE TR017-REJ-REJ-TM TO TR027-REJ-REJ-TM        18670003
186900             ELSE                                                 18690003
187000                 MOVE 'REJECTION TIME'     TO TR241-DATA-IN-ERROR 18700000
187100                 MOVE TR017-REJ-REJ-TM     TO TR241-DATA-VALUE    18710000
187200                 MOVE PC-WARNING           TO TR241-ERROR-TYPE    18720000
187300                 MOVE 'INVALID TIME'       TO TR241-ERROR-MSG     18730000
187400                 MOVE ZEROES               TO TR027-REJ-REJ-TM    18740000
187500                 PERFORM 6190-MOVES-FOR-ERROR-REC                 18750000
187600                 PERFORM 6200-WRITE-ERROR-REPORT                  18760000
187610             END-IF                                               18761003
187700         END-IF                                                   18770003
187710     END-IF.                                                      18771003
187800                                                                  18780000
187900 EJECT                                                            18790000
188100******************************************************************18810000
188200* CHECK THE INPUT ECR-EST-CLR-DTE WITH THE CALENDAR ROUTINE      *18820000
188300* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *18830000
188400******************************************************************18840000
188500 5630-CHK-EST-CLR-DTE-TM.                                         18850000
188600                                                                  18860000
188700     INITIALIZE   DPG51 DPG52 DPG53                               18870000
188800                  DPG54 DPG55 DPG56.                              18880000
188900                                                                  18890000
189000     SET DPG52-LK-DTE-ISO              TO TRUE.                   18900000
189100     MOVE TR017-ECR-EST-CLR-DTE        TO                         18910000
189200            DPG52-LK-DATE-INPUT.                                  18920000
189300     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 18930000
189400                                                                  18940000
189500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    18950000
189600                                             DPG54 DPG55 DPG56.   18960000
189700                                                                  18970000
189800     EVALUATE TRUE                                                18980000
189900         WHEN DPG54-SEVERE-ERROR                                  18990000
190000         WHEN DPG54-WARNING-ERROR                                 19000000
190100            MOVE 'EST CLEAR DATE'        TO TR241-DATA-IN-ERROR   19010000
190200            MOVE TR017-ECR-EST-CLR-DTE   TO TR241-DATA-VALUE      19020000
190300            MOVE PC-ERROR                TO TR241-ERROR-TYPE      19030000
190400            SET PS-EDIT-ERROR            TO TRUE                  19040000
190500            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       19050000
190600            PERFORM 6190-MOVES-FOR-ERROR-REC                      19060000
190700            PERFORM 6200-WRITE-ERROR-REPORT                       19070000
190800         WHEN OTHER                                               19080000
190900            MOVE TR017-ECR-EST-CLR-DTE   TO                       19090000
191000                   TR027-ECR-EST-CLR-DTE                          19100000
191100     END-EVALUATE.                                                19110000
191200                                                                  19120000
191300     IF TR017-ECR-EST-CLR-TM EQUAL SPACES OR                      19130003
191400        TR017-ECR-EST-CLR-TM EQUAL ZEROES                         19140003
191500         MOVE ZEROES TO TR027-ECR-EST-CLR-TM                      19150003
191600     ELSE                                                         19160003
191610         IF TR017-ECR-EST-CLR-TM (1:1) = SPACES OR                19161003
191620            TR017-ECR-EST-CLR-TM (2:1) = SPACES OR                19162003
191630            TR017-ECR-EST-CLR-TM (3:1) = SPACES OR                19163003
191640            TR017-ECR-EST-CLR-TM (4:1) = SPACES                   19164003
191650             MOVE 'EST CLEAR TIME'   TO TR241-DATA-IN-ERROR       19165003
191660             MOVE TR017-ECR-EST-CLR-TM TO TR241-DATA-VALUE        19166003
191670             MOVE PC-WARNING         TO TR241-ERROR-TYPE          19167003
191680             MOVE 'INVALID TIME'     TO TR241-ERROR-MSG           19168003
191690             MOVE ZEROES             TO TR027-ECR-EST-CLR-TM      19169003
191691             PERFORM 6190-MOVES-FOR-ERROR-REC                     19169103
191692             PERFORM 6200-WRITE-ERROR-REPORT                      19169203
191693         ELSE                                                     19169303
191700            IF TR017-ECR-EST-CLR-TM (1:2) < '24' AND              19170003
191800               TR017-ECR-EST-CLR-TM (3:2) < '60'                  19180003
191900                MOVE TR017-ECR-EST-CLR-TM TO TR027-ECR-EST-CLR-TM 19190003
192100            ELSE                                                  19210003
192200                MOVE 'EST CLEAR TIME'   TO TR241-DATA-IN-ERROR    19220003
192300                MOVE TR017-ECR-EST-CLR-TM TO TR241-DATA-VALUE     19230003
192400                MOVE PC-WARNING         TO TR241-ERROR-TYPE       19240003
192500                MOVE 'INVALID TIME'     TO TR241-ERROR-MSG        19250003
192600                MOVE ZEROES             TO TR027-ECR-EST-CLR-TM   19260003
192700                PERFORM 6190-MOVES-FOR-ERROR-REC                  19270003
192800                PERFORM 6200-WRITE-ERROR-REPORT                   19280003
192900            END-IF                                                19290003
193000         END-IF                                                   19300003
193010     END-IF.                                                      19301003
193100                                                                  19310000
193200 EJECT                                                            19320000
193400******************************************************************19340000
193500* CHECK THE INPUT RLS-ACTL-CLR-DTE WITH THE CALENDAR ROUTINE     *19350000
193600* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *19360000
193700******************************************************************19370000
193800 5640-CHK-ACTL-CLR-DTE-TM.                                        19380000
193900                                                                  19390000
194000     INITIALIZE   DPG51 DPG52 DPG53                               19400000
194100                  DPG54 DPG55 DPG56.                              19410000
194200                                                                  19420000
194300     SET DPG52-LK-DTE-ISO              TO TRUE.                   19430000
194400     MOVE TR017-RLS-ACTL-CLR-DTE       TO                         19440000
194500            DPG52-LK-DATE-INPUT.                                  19450000
194600     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 19460000
194700                                                                  19470000
194800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    19480000
194900                                             DPG54 DPG55 DPG56.   19490000
195000                                                                  19500000
195100     EVALUATE TRUE                                                19510000
195200         WHEN DPG54-SEVERE-ERROR                                  19520000
195300         WHEN DPG54-WARNING-ERROR                                 19530000
195400            MOVE 'ACTL CLEAR DATE'       TO TR241-DATA-IN-ERROR   19540000
195500            MOVE TR017-RLS-ACTL-CLR-DTE  TO TR241-DATA-VALUE      19550000
195600            MOVE PC-ERROR                TO TR241-ERROR-TYPE      19560000
195700            SET PS-EDIT-ERROR            TO TRUE                  19570000
195800            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       19580000
195900            PERFORM 6190-MOVES-FOR-ERROR-REC                      19590000
196000            PERFORM 6200-WRITE-ERROR-REPORT                       19600000
196100         WHEN OTHER                                               19610000
196200            MOVE TR017-RLS-ACTL-CLR-DTE  TO                       19620000
196300                   TR027-RLS-ACTL-CLR-DTE                         19630000
196400     END-EVALUATE.                                                19640000
196500                                                                  19650000
196600     IF TR017-RLS-ACTL-CLR-TM EQUAL SPACES OR                     19660003
196700        TR017-RLS-ACTL-CLR-TM EQUAL ZEROES                        19670003
196800         MOVE ZEROES TO TR027-RLS-ACTL-CLR-TM                     19680003
196900     ELSE                                                         19690003
196910         IF TR017-RLS-ACTL-CLR-TM (1:1) = SPACES OR               19691003
196920            TR017-RLS-ACTL-CLR-TM (2:1) = SPACES OR               19692003
196930            TR017-RLS-ACTL-CLR-TM (3:1) = SPACES OR               19693003
196940            TR017-RLS-ACTL-CLR-TM (4:1) = SPACES                  19694003
196950             MOVE 'ACTL CLEAR TIME'  TO TR241-DATA-IN-ERROR       19695003
196960             MOVE TR017-RLS-ACTL-CLR-TM TO TR241-DATA-VALUE       19696003
196970             MOVE PC-WARNING         TO TR241-ERROR-TYPE          19697003
196980             MOVE 'INVALID TIME'     TO TR241-ERROR-MSG           19698003
196990             MOVE ZEROES             TO TR027-RLS-ACTL-CLR-TM     19699003
196991             PERFORM 6190-MOVES-FOR-ERROR-REC                     19699103
196992             PERFORM 6200-WRITE-ERROR-REPORT                      19699203
196993         ELSE                                                     19699303
197000             IF TR017-RLS-ACTL-CLR-TM (1:2) < '24' AND            19700003
197100                TR017-RLS-ACTL-CLR-TM (3:2) < '60'                19710003
197200                  MOVE TR017-RLS-ACTL-CLR-TM TO                   19720003
197300                       TR027-RLS-ACTL-CLR-TM                      19730003
197400             ELSE                                                 19740003
197500                 MOVE 'ACTL CLEAR TIME'  TO TR241-DATA-IN-ERROR   19750003
197600                 MOVE TR017-RLS-ACTL-CLR-TM TO TR241-DATA-VALUE   19760003
197700                 MOVE PC-WARNING         TO TR241-ERROR-TYPE      19770003
197800                 MOVE 'INVALID TIME'     TO TR241-ERROR-MSG       19780003
197900                 MOVE ZEROES            TO TR027-RLS-ACTL-CLR-TM  19790003
198000                 PERFORM 6190-MOVES-FOR-ERROR-REC                 19800003
198100                 PERFORM 6200-WRITE-ERROR-REPORT                  19810003
198200             END-IF                                               19820003
198300         END-IF                                                   19830003
198310     END-IF.                                                      19831003
198400                                                                  19840000
198500 EJECT                                                            19850000
198700******************************************************************19870000
198800* CHECK THE INPUT LIQ-LQDN-DTE WITH THE CALENDAR ROUTINE         *19880000
198900* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *19890000
199000******************************************************************19900000
199100 5650-CHK-LQDN-DTE-TM.                                            19910000
199200                                                                  19920000
199300     INITIALIZE   DPG51 DPG52 DPG53                               19930000
199400                  DPG54 DPG55 DPG56.                              19940000
199500                                                                  19950000
199600     SET DPG52-LK-DTE-ISO              TO TRUE.                   19960000
199700     MOVE TR017-LIQ-LQDN-DTE           TO                         19970000
199800            DPG52-LK-DATE-INPUT.                                  19980000
199900     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 19990000
200000                                                                  20000000
200100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    20010000
200200                                             DPG54 DPG55 DPG56.   20020000
200300                                                                  20030000
200400     EVALUATE TRUE                                                20040000
200500         WHEN DPG54-SEVERE-ERROR                                  20050000
200600         WHEN DPG54-WARNING-ERROR                                 20060000
200700            MOVE 'LIQUIDATION DTE'       TO TR241-DATA-IN-ERROR   20070000
200800            MOVE TR017-LIQ-LQDN-DTE      TO TR241-DATA-VALUE      20080000
200900            MOVE PC-ERROR                TO TR241-ERROR-TYPE      20090000
201000            SET PS-EDIT-ERROR            TO TRUE                  20100000
201100            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       20110000
201200            PERFORM 6190-MOVES-FOR-ERROR-REC                      20120000
201300            PERFORM 6200-WRITE-ERROR-REPORT                       20130000
201400         WHEN OTHER                                               20140000
201500            MOVE TR017-LIQ-LQDN-DTE      TO                       20150000
201600                   TR027-LIQ-LQDN-DTE                             20160000
201700     END-EVALUATE.                                                20170000
201800                                                                  20180000
201900     IF TR017-LIQ-LQDN-TM EQUAL SPACES OR                         20190003
202000        TR017-LIQ-LQDN-TM EQUAL ZEROES                            20200003
202100         MOVE ZEROES TO TR027-LIQ-LQDN-TM                         20210003
202110     ELSE                                                         20211003
202120         IF TR017-LIQ-LQDN-TM (1:1) = SPACES OR                   20212003
202130            TR017-LIQ-LQDN-TM (2:1) = SPACES OR                   20213003
202140            TR017-LIQ-LQDN-TM (3:1) = SPACES OR                   20214003
202150            TR017-LIQ-LQDN-TM (4:1) = SPACES                      20215003
202160             MOVE 'LIQUIDATION TM'   TO TR241-DATA-IN-ERROR       20216003
202170             MOVE TR017-LIQ-LQDN-TM  TO TR241-DATA-VALUE          20217003
202180             MOVE PC-WARNING         TO TR241-ERROR-TYPE          20218003
202190             MOVE 'INVALID TIME'     TO TR241-ERROR-MSG           20219003
202191             MOVE ZEROES             TO TR027-LIQ-LQDN-TM         20219103
202192             PERFORM 6190-MOVES-FOR-ERROR-REC                     20219203
202193             PERFORM 6200-WRITE-ERROR-REPORT                      20219303
202200         ELSE                                                     20220000
202300             IF TR017-LIQ-LQDN-TM (1:2) < '24' AND                20230003
202400                TR017-LIQ-LQDN-TM (3:2) < '60'                    20240003
202500                 MOVE TR017-LIQ-LQDN-TM TO TR027-LIQ-LQDN-TM      20250003
202700             ELSE                                                 20270003
202800                 MOVE 'LIQUIDATION TM'   TO TR241-DATA-IN-ERROR   20280003
202900                 MOVE TR017-LIQ-LQDN-TM  TO TR241-DATA-VALUE      20290003
203000                 MOVE PC-WARNING         TO TR241-ERROR-TYPE      20300003
203100                 MOVE 'INVALID TIME'     TO TR241-ERROR-MSG       20310003
203200                 MOVE ZEROES             TO TR027-LIQ-LQDN-TM     20320003
203300                 PERFORM 6190-MOVES-FOR-ERROR-REC                 20330003
203400                 PERFORM 6200-WRITE-ERROR-REPORT                  20340003
203500             END-IF                                               20350003
203600         END-IF                                                   20360003
203610     END-IF.                                                      20361003
203700                                                                  20370000
203800 EJECT                                                            20380000
204000******************************************************************20400000
204100* CHECK THE INPUT LSU-LQDN-SSPNN-DTE WITH THE CALENDAR ROUTINE   *20410000
204200* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *20420000
204300******************************************************************20430000
204400 5660-CHK-LQDN-SUSP-DTE-TM.                                       20440000
204500                                                                  20450000
204600     INITIALIZE   DPG51 DPG52 DPG53                               20460000
204700                  DPG54 DPG55 DPG56.                              20470000
204800                                                                  20480000
204900     SET DPG52-LK-DTE-ISO              TO TRUE.                   20490000
205000     MOVE TR017-LSU-LQDN-SSPNN-DTE     TO                         20500000
205100            DPG52-LK-DATE-INPUT.                                  20510000
205200     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 20520000
205300                                                                  20530000
205400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    20540000
205500                                             DPG54 DPG55 DPG56.   20550000
205600                                                                  20560000
205700     EVALUATE TRUE                                                20570000
205800         WHEN DPG54-SEVERE-ERROR                                  20580000
205900         WHEN DPG54-WARNING-ERROR                                 20590000
206000            MOVE 'LQDN SUSP DATE'        TO TR241-DATA-IN-ERROR   20600000
206100            MOVE TR017-LSU-LQDN-SSPNN-DTE TO TR241-DATA-VALUE     20610000
206200            MOVE PC-ERROR                TO TR241-ERROR-TYPE      20620000
206300            SET PS-EDIT-ERROR            TO TRUE                  20630000
206400            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       20640000
206500            PERFORM 6190-MOVES-FOR-ERROR-REC                      20650000
206600            PERFORM 6200-WRITE-ERROR-REPORT                       20660000
206700         WHEN OTHER                                               20670000
206800            MOVE TR017-LSU-LQDN-SSPNN-DTE TO                      20680000
206900                   TR027-LSU-LQDN-SSPNN-DTE                       20690000
207000     END-EVALUATE.                                                20700000
207100                                                                  20710000
207200     IF TR017-LSU-LQDN-SSPNN-TM EQUAL SPACES OR                   20720003
207300        TR017-LSU-LQDN-SSPNN-TM EQUAL ZEROES                      20730003
207400         MOVE ZEROES TO TR027-LSU-LQDN-SSPNN-TM                   20740003
207500     ELSE                                                         20750003
207501         IF TR017-LSU-LQDN-SSPNN-TM (1:1) = SPACES OR             20750103
207502            TR017-LSU-LQDN-SSPNN-TM (2:1) = SPACES OR             20750203
207503            TR017-LSU-LQDN-SSPNN-TM (3:1) = SPACES OR             20750303
207504            TR017-LSU-LQDN-SSPNN-TM (4:1) = SPACES                20750403
207505             MOVE 'LQDN SUSP TIME'   TO TR241-DATA-IN-ERROR       20750503
207506             MOVE TR017-LSU-LQDN-SSPNN-TM TO TR241-DATA-VALUE     20750603
207508             MOVE PC-WARNING     TO TR241-ERROR-TYPE              20750803
207509             MOVE 'INVALID TIME' TO TR241-ERROR-MSG               20750903
207510             MOVE ZEROES         TO TR027-LSU-LQDN-SSPNN-TM       20751003
207511             PERFORM 6190-MOVES-FOR-ERROR-REC                     20751103
207512             PERFORM 6200-WRITE-ERROR-REPORT                      20751203
207520         ELSE                                                     20752003
207600             IF TR017-LSU-LQDN-SSPNN-TM (1:2) < '24' AND          20760003
207700                TR017-LSU-LQDN-SSPNN-TM (3:2) < '60'              20770003
207800                 MOVE TR017-LSU-LQDN-SSPNN-TM TO                  20780003
207900                      TR027-LSU-LQDN-SSPNN-TM                     20790003
208000             ELSE                                                 20800003
208100                 MOVE 'LQDN SUSP TIME'  TO TR241-DATA-IN-ERROR    20810003
208200                 MOVE TR017-LSU-LQDN-SSPNN-TM TO                  20820003
208300                      TR241-DATA-VALUE                            20830003
208400                 MOVE PC-WARNING        TO TR241-ERROR-TYPE       20840003
208500                 MOVE 'INVALID TIME'    TO TR241-ERROR-MSG        20850003
208600                 MOVE ZEROES       TO TR027-LSU-LQDN-SSPNN-TM     20860003
208700                 PERFORM 6190-MOVES-FOR-ERROR-REC                 20870003
208800                 PERFORM 6200-WRITE-ERROR-REPORT                  20880003
208900             END-IF                                               20890003
209000         END-IF                                                   20900003
209010     END-IF.                                                      20901003
209100                                                                  20910000
209200 EJECT                                                            20920000
209310******************************************************************20931000
209320* CHECK THE INPUT DOP-DELY-ORD-SNT-DTE WITH THE CALENDAR ROUTINE *20932000
209330* TO BE SURE THE DATE IS VALID, THEN EDIT THE TM FIELD IF SENT.  *20933000
209340******************************************************************20934000
209350 5670-CHK-DELY-ORD-SNT-DTE-TM.                                    20935000
209360                                                                  20936000
209370     INITIALIZE   DPG51 DPG52 DPG53                               20937000
209380                  DPG54 DPG55 DPG56.                              20938000
209390                                                                  20939000
209391     SET DPG52-LK-DTE-ISO              TO TRUE.                   20939100
209392     MOVE TR017-DOP-DELY-ORD-SNT-DTE     TO                       20939200
209393            DPG52-LK-DATE-INPUT.                                  20939300
209394     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 20939400
209395                                                                  20939500
209396     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    20939600
209397                                             DPG54 DPG55 DPG56.   20939700
209398                                                                  20939800
209399     EVALUATE TRUE                                                20939900
209400         WHEN DPG54-SEVERE-ERROR                                  20940000
209401         WHEN DPG54-WARNING-ERROR                                 20940100
209402            MOVE 'DELY ORDER DTE'      TO TR241-DATA-IN-ERROR     20940200
209403            MOVE TR017-DOP-DELY-ORD-SNT-DTE TO                    20940300
209404                                             TR241-DATA-VALUE     20940400
209405            MOVE PC-ERROR                TO TR241-ERROR-TYPE      20940500
209406            SET PS-EDIT-ERROR            TO TRUE                  20940600
209407            MOVE 'INVALID DATE'          TO TR241-ERROR-MSG       20940700
209408            PERFORM 6190-MOVES-FOR-ERROR-REC                      20940800
209409            PERFORM 6200-WRITE-ERROR-REPORT                       20940900
209410         WHEN OTHER                                               20941000
209411            MOVE TR017-DOP-DELY-ORD-SNT-DTE TO                    20941100
209412                   TR027-DOP-DELY-ORD-SNT-DTE                     20941200
209413     END-EVALUATE.                                                20941300
209414                                                                  20941400
209415     IF TR017-DOP-DELY-ORD-SNT-TM EQUAL SPACES OR                 20941503
209416        TR017-DOP-DELY-ORD-SNT-TM EQUAL ZEROES                    20941603
209417         MOVE ZEROES TO TR027-DOP-DELY-ORD-SNT-TM                 20941703
209418     ELSE                                                         20941803
209419         IF TR017-DOP-DELY-ORD-SNT-TM (1:1) = SPACES OR           20941903
209420            TR017-DOP-DELY-ORD-SNT-TM (2:1) = SPACES OR           20942003
209421            TR017-DOP-DELY-ORD-SNT-TM (3:1) = SPACES OR           20942103
209422            TR017-DOP-DELY-ORD-SNT-TM (4:1) = SPACES              20942203
209423             MOVE 'DELY ORDER TM'  TO TR241-DATA-IN-ERROR         20942303
209424             MOVE TR017-DOP-DELY-ORD-SNT-TM TO TR241-DATA-VALUE   20942403
209426             MOVE PC-WARNING       TO TR241-ERROR-TYPE            20942603
209427             MOVE 'INVALID TIME'   TO TR241-ERROR-MSG             20942703
209428             MOVE ZEROES       TO TR027-DOP-DELY-ORD-SNT-TM       20942803
209429             PERFORM 6190-MOVES-FOR-ERROR-REC                     20942903
209430             PERFORM 6200-WRITE-ERROR-REPORT                      20943003
209431         ELSE                                                     20943103
209432             IF TR017-DOP-DELY-ORD-SNT-TM (1:2) < '24' AND        20943203
209433                TR017-DOP-DELY-ORD-SNT-TM (3:2) < '60'            20943303
209434                 MOVE TR017-DOP-DELY-ORD-SNT-TM TO                20943403
209435                      TR027-DOP-DELY-ORD-SNT-TM                   20943503
209436             ELSE                                                 20943603
209437                 MOVE 'DELY ORDER TM'  TO TR241-DATA-IN-ERROR     20943703
209438                 MOVE TR017-DOP-DELY-ORD-SNT-TM TO                20943803
209439                      TR241-DATA-VALUE                            20943903
209440                 MOVE PC-WARNING       TO TR241-ERROR-TYPE        20944003
209441                 MOVE 'INVALID TIME'   TO TR241-ERROR-MSG         20944103
209442                 MOVE ZEROES       TO TR027-DOP-DELY-ORD-SNT-TM   20944203
209443                 PERFORM 6190-MOVES-FOR-ERROR-REC                 20944303
209444                 PERFORM 6200-WRITE-ERROR-REPORT                  20944403
209445             END-IF                                               20944503
209446         END-IF                                                   20944603
209447     END-IF.                                                      20944703
209448                                                                  20944803
209449 EJECT                                                            20944903
209460******************************************************************20946003
209500* REFORMAT CURRENT TIMESTAMP.                                    *20950000
209600******************************************************************20960000
209700 5730-REFORMAT-CURRENT-TMST.                                      20970000
209800                                                                  20980000
209900     MOVE PV-CURRENT-TMST (1:4) TO                                20990000
210000                      PV-REFORMAT-TMST-DTE-CY.                    21000000
210100     MOVE PV-CURRENT-TMST (6:2) TO                                21010000
210200                      PV-REFORMAT-TMST-DTE-MM.                    21020000
210300     MOVE PV-CURRENT-TMST (9:2) TO                                21030000
210400                      PV-REFORMAT-TMST-DTE-DD.                    21040000
210500     MOVE PV-CURRENT-TMST (12:2) TO                               21050000
210600                      PV-REFORMAT-TMST-TM-HH.                     21060000
210700     MOVE PV-CURRENT-TMST (15:2) TO                               21070000
210800                      PV-REFORMAT-TMST-TM-MM.                     21080000
210900                                                                  21090000
211000 EJECT                                                            21100000
211100                                                                  21110000
211200******************************************************************21120000
211300* READ A RECORD FROM THE CUSTOMS ORDER FILE.                     *21130000
211400******************************************************************21140000
211500 6000-READ-CUSTOMS-RECORD.                                        21150000
211600                                                                  21160000
211700          SET PS-EDIT-ERROR-NO           TO TRUE.                 21170000
211800          SET PS-WRITE-THIS-EDI-NO       TO TRUE.                 21180000
211900                                                                  21190000
212000     READ TR017-CUSTOMS-FILE                                      21200000
212100         INTO TR017-REC-TYP-ENF                                   21210000
212200         AT END                                                   21220000
212300           SET PS-END-OF-ENTRIES         TO TRUE.                 21230000
212400                                                                  21240000
212500          IF PS-END-OF-ENTRIES-NO                                 21250000
212600             ADD  +1                     TO PA-TOTAL-INPUT-READ   21260000
212700          END-IF.                                                 21270000
212800                                                                  21280000
212900          MOVE TR017-REC-TYP-ENF (1:3)   TO PV-REC-CHECK.         21290000
213000                                                                  21300000
213100          EVALUATE TRUE                                           21310000
213200                 WHEN PV-REC-CHECK EQUAL 'CTT'                    21320000
213300                      ADD  +1             TO PV-PROCESS-SEQ-NBR   21330000
213400                                             PA-TOTAL-EDI-REC-READ21340000
213500                      SET PS-GOOD-RECORD-NO TO TRUE               21350000
213600                 WHEN PV-REC-CHECK EQUAL 'IEA'                    21360000
213700                      ADD  +1             TO PV-PROCESS-SEQ-NBR   21370000
213800                                                                  21380000
213900                      IF PS-END-OF-ENTRIES-NO                     21390000
214000                         ADD  +1          TO PA-TOTAL-EDI-REC-READ21400000
214100                      END-IF                                      21410000
214200                                                                  21420000
214300                      SET PS-GOOD-RECORD-NO TO TRUE               21430000
214400                 WHEN PV-REC-CHECK EQUAL 'ISA'                    21440000
214500                      ADD  +1             TO PA-TOTAL-EDI-REC-READ21450000
214600          END-EVALUATE.                                           21460000
214700                                                                  21470000
214800                                                                  21480000
214900     IF PS-END-OF-ENTRIES AND PS-GOOD-RECORD                      21490000
215000         CONTINUE                                                 21500000
215100     ELSE                                                         21510000
215200         MOVE TR017-REC-TYP-ENF    (1:3) TO PV-EDI-RECORDS        21520000
215300                                                                  21530000
215400                IF EDI-ISA-RECORD                                 21540000
215500                   PERFORM 6040-CHECK-IEA-RECORD                  21550000
215600                   SET PS-EDI-RECORD TO TRUE                      21560000
215700                   PERFORM 6030-PROCESS-EDI-RECORD                21570000
215800                ELSE                                              21580000
215900                   IF PV-REC-CHECK NOT EQUAL 'CTT' AND            21590000
216000                      PV-REC-CHECK NOT EQUAL 'IEA'                21600000
216100                         SET PS-GOOD-RECORD TO TRUE               21610000
216200                         ADD +1             TO PV-PROCESS-SEQ-NBR 21620000
216300                   END-IF                                         21630000
216400                END-IF                                            21640000
216500           END-IF.                                                21650000
216600                                                                  21660000
216700     IF PS-END-OF-ENTRIES-NO                                      21670000
216800         MOVE TR017-REC-TYP-ENF (1:3) TO PV-HOLD-LAST-REC-TYP     21680000
216900     END-IF.                                                      21690000
217000                                                                  21700000
217100 EJECT                                                            21710000
217200                                                                  21720000
217300***************************************************************** 21730000
217400* CHECK EDI RECORDS FOR AN ISA RECORD TO DETERMINE THE          * 21740000
217500* CONSOLIDATOR NAME.                                            * 21750000
217600***************************************************************** 21760000
217700 6030-PROCESS-EDI-RECORD.                                         21770000
217800                                                                  21780000
217900     IF TR017-REC-TYP-ENF    (1:3) EQUAL PC-ISA                   21790000
218000         ADD +1 TO PV-PROCESS-SEQ-NBR                             21800000
218100         MOVE TR017-REC-TYP-ENF   TO  PV-HOLD-EDI-RECORD          21810000
218200         MOVE PV-EDI-VEND-ID-QUAL     TO PV-VEND-ID-QUAL          21820000
218300         MOVE PV-EDI-VEND-ID          TO PV-VEND-ID               21830000
218400         PERFORM 6035-PROCESS-ISA-RECORD                          21840000
218500     END-IF.                                                      21850000
218600                                                                  21860000
218700 EJECT                                                            21870000
218800                                                                  21880000
218900***************************************************************** 21890000
219000* PROCESS THE ISA RECORD TO OBTAIN HEADER RECORD FIELDS.        * 21900000
219100***************************************************************** 21910000
219200 6035-PROCESS-ISA-RECORD.                                         21920000
219300                                                                  21930000
219400                                                                  21940000
219500      MOVE PC-HEADER1           TO TR241-ERROR-TYPE.              21950000
219600      MOVE PC-HDR               TO TR241-REC-TYP-HDR-CDE.         21960000
219700      MOVE PC-01                TO TR241-HDR-SEQ-NBR.             21970000
219800      MOVE PV-PROCESS-SEQ-NBR   TO TR241-PROCESS-SEQ-NBR.         21980000
219900                                                                  21990000
220000      MOVE SPACES               TO TR241-DATA-IN-ERROR            22000000
220100                                   TR241-CSTM-ENTR-ID             22010000
220200                                   TR241-BKR-REF-NBR              22020000
220300                                   TR241-DATA-VALUE               22030000
220400                                   TR241-TRN-TYP                  22040000
220500                                   TR241-ERROR-MSG.               22050000
220600                                                                  22060000
220800      PERFORM 7292-SELECT-ENT-ID.                                 22080000
220900                                                                  22090000
221000      IF PS-VALID-ENTNME                                          22100000
221100          MOVE ENTNME-ENT-NAME-DESC TO TR241-HDR-CONSOL-ENTNME    22110000
221300      ELSE                                                        22130000
221400          MOVE SPACES               TO TR241-HDR-CONSOL-ENTNME    22140000
221600      END-IF.                                                     22160000
221700                                                                  22170000
221900                                                                  22190000
222000      MOVE PV-EDI-CONSOL-TRNS-DTE  TO PV-HDR-CONSOL-TRNS-DTE-REST.22200000
222100                                                                  22210000
222200      IF PV-EDI-CONSOL-TRNS-DTE (1:2) EQUAL PC-98 OR PC-99        22220000
222300          MOVE PC-19 TO PV-HDR-CONSOL-TRNS-DTE-CC                 22230000
222400      ELSE                                                        22240000
222500          MOVE PC-20 TO PV-HDR-CONSOL-TRNS-DTE-CC                 22250000
222600      END-IF.                                                     22260000
222700                                                                  22270000
222800      MOVE PV-HDR-CONSOL-TRNS-DTE   TO TR241-HDR-CONSOL-TRNS-DTE. 22280000
222900                                                                  22290000
223000      MOVE PV-EDI-CONSOL-TRNS-TM    TO TR241-HDR-CONSOL-TRNS-TM.  22300000
223100      MOVE PV-EDI-CONSOL-FIL-ID     TO TR241-HDR-CONSOL-FIL-ID.   22310000
223200                                                                  22320000
223300      PERFORM 7100-SET-CURRENT-TMST.                              22330000
223400      PERFORM 5730-REFORMAT-CURRENT-TMST.                         22340000
223500      MOVE PV-REFORMAT-TMST-DTE     TO TR241-HDR-LOAD-DTE.        22350000
223600      MOVE PV-REFORMAT-TMST-TM      TO TR241-HDR-LOAD-TM.         22360000
223700      MOVE PC-E          TO TR241-RPT-TYP.                        22370000
223800      PERFORM 6201-WRITE-ERROR-REPORT-HDR.                        22380000
223900                                                                  22390000
224000      MOVE PC-HEADER2               TO TR241-ERROR-TYPE.          22400000
224100      MOVE PV-PROCESS-SEQ-NBR       TO TR241-PROCESS-SEQ-NBR.     22410000
224200      MOVE PC-D          TO TR241-RPT-TYP.                        22420000
224300      PERFORM 6201-WRITE-ERROR-REPORT-HDR.                        22430000
224400                                                                  22440000
224500      MOVE TR017-REC-TYP-ENF (1:3)  TO TR027-ENF-REC-TYP-CDE.     22450000
224600      MOVE PV-PROCESS-SEQ-NBR       TO TR027-ENF-PROCESS-SEQ-NBR. 22460000
224700      PERFORM 6401-WRITE-UPDATE-REPORT-HDR.                       22470000
224800      INITIALIZE TR027-REC-TYP-ENF.                               22480000
224900      INITIALIZE TR241-RECORD.                                    22490000
225000      INITIALIZE TR241-REC-TYP-HDR.                               22500000
225100                                                                  22510000
225200                                                                  22520000
225300 EJECT                                                            22530000
225400                                                                  22540000
225500***************************************************************** 22550000
225600* CHECK TO SEE IF PREVIOUS RECORD WAS AN IEA RECORD.            * 22560000
225700***************************************************************** 22570000
225800 6040-CHECK-IEA-RECORD.                                           22580000
225900                                                                  22590000
226000     IF PV-HOLD-LAST-REC-TYP EQUAL PC-IEA                         22600000
226100         CONTINUE                                                 22610000
226200     ELSE                                                         22620000
226300         MOVE PC-EDI         TO TR241-ERROR-TYPE                  22630000
226400         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  22640000
226500                             TO TR241-ERROR-MSG                   22650000
226600         MOVE SPACES         TO TR241-REC-TYP-ENF                 22660000
226700                                TR241-DATA-IN-ERROR               22670000
226800                                TR241-CSTM-ENTR-ID                22680000
226900                                TR241-BKR-REF-NBR                 22690000
227000                                TR241-DATA-VALUE                  22700000
227100                                TR241-TRN-TYP                     22710000
227200         ADD +1 TO PV-PROCESS-SEQ-NBR                             22720000
227300         MOVE PV-PROCESS-SEQ-NBR TO TR241-PROCESS-SEQ-NBR         22730000
227400         PERFORM 6205-WRITE-ERROR-REPORT-IEA                      22740000
227500     END-IF.                                                      22750000
227600                                                                  22760000
227700 EJECT                                                            22770000
227800                                                                  22780000
227801***************************************************************** 22780100
227802* ERROR MESSAGE # 30                                              22780200
227803***************************************************************** 22780300
227804 6130-ERROR-30.                                                   22780400
227805                                                                  22780500
227806     MOVE PC-E                      TO TR241-RPT-TYP.             22780600
227807     SET TR241-REC-TYP-MLT-CDE-MLT  TO TRUE.                      22780700
227808     SET TR241-MLT-WRN-TYP-MBOL     TO TRUE.                      22780800
227809     MOVE TR017-ENF-CSTM-ENTR-ID    TO TR241-CSTM-ENTR-ID.        22780900
227811     MOVE PV-SAVE-ER-SEQ-NBR        TO TR241-PROCESS-SEQ-NBR.     22781100
227812     MOVE '***'                     TO TR241-DATA-IN-ERROR.       22781200
227813     MOVE '***'                     TO TR241-DATA-VALUE.          22781300
227814     MOVE PC-WARNING                TO TR241-ERROR-TYPE.          22781400
227815     MOVE PV-FOB-CDE                TO PC-FOB.                    22781500
227816     MOVE PV-SCAC-CDE               TO PC-SCAC.                   22781600
227817     MOVE TR017-ENFPO-PO-NBR        TO PC-PO.                     22781700
227818     MOVE PC-FOB-SCAC-MSG           TO TR241-ERROR-MSG.           22781800
227820                                                                  22782000
227900***************************************************************** 22790000
228000* SETUP THE DETAIL RECORD BEFORE WRITING A RECORD. ALL WARNING  * 22800000
228100* MESSAGES ARE WRITTEN OUT TO THE EXTRACT FILE                  * 22810000
228200* THESE 4 FIELDS ARE THE SAME POSITIONALLY ON ALL REC TYPES     * 22820000
228300***************************************************************** 22830000
228400 6180-MOVES-FOR-DETAIL-REC.                                       22840000
228500                                                                  22850000
228600      MOVE PV-PROCESS-SEQ-NBR      TO TR027-ENF-PROCESS-SEQ-NBR.  22860000
228700                                                                  22870000
228800      MOVE TR017-ENF-TRN-TYP       TO TR027-ENF-TRN-TYP.          22880000
228900      MOVE TR017-ENF-REC-TYP-CDE   TO TR027-ENF-REC-TYP-CDE.      22890000
229000      MOVE TR017-ENF-SEQ-NBR       TO TR027-ENF-SEQ-NBR.          22900000
229100      MOVE TR017-ENF-3RD-PARTY-CDE TO TR027-ENF-3RD-PARTY-CDE.    22910000
229200                                                                  22920000
229300 EJECT                                                            22930000
229400                                                                  22940000
229500***************************************************************** 22950000
229600* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 22960000
229700***************************************************************** 22970000
229800 6190-MOVES-FOR-ERROR-REC.                                        22980000
229900                                                                  22990000
229910     MOVE TR017-ENF-CSTM-ENTR-ID        TO TR241-CSTM-ENTR-ID.    22991000
229911     MOVE PV-CURRENT-POE-NM             TO TR241-POE-NM.          22991100
229912     MOVE PV-CURRENT-POE-CDE         TO TR241-POE-STD-EDI-CDE.    22991200
229913                                                                  22991300
229920                                                                  22992000
230000     EVALUATE TR017-ENF-REC-TYP-CDE                               23000000
230100       WHEN PC-ENF                                                23010000
230200         MOVE PC-E                        TO                      23020000
230300                TR241-RPT-TYP                                     23030000
230400         MOVE TR017-ENF-TRN-TYP           TO                      23040000
230500                TR241-TRN-TYP                                     23050000
230600         MOVE PV-PROCESS-SEQ-NBR          TO                      23060000
230700                TR241-PROCESS-SEQ-NBR                             23070000
230800         MOVE TR017-ENF-REC-TYP-CDE       TO                      23080000
230900                TR241-REC-TYP-ENF-CDE                             23090000
231000         MOVE TR017-ENF-SEQ-NBR           TO                      23100000
231100                TR241-ENF-SEQ-NBR                                 23110000
231200         MOVE TR017-ENF-3RD-PARTY-CDE     TO                      23120000
231300                TR241-ENF-3RD-PARTY-CDE                           23130000
231301         MOVE TR017-ENF-BKR-REF-NBR       TO TR241-BKR-REF-NBR    23130100
231310         MOVE TR017-ENF-MOM-TRIP-TYP-CDE  TO                      23131000
231320                TR241-ENF-MOM-TRIP-TYP-CDE                        23132000
231330         MOVE TR027-ENF-ENTR-TYP-CDE      TO                      23133000
231340                TR241-ENF-ENTR-TYP-CDE                            23134000
231350         MOVE TR027-ENF-ENTR-TYP-DESC     TO                      23135000
231360                TR241-ENF-ENTR-TYP-DESC                           23136000
231400         MOVE TR017-ENF-FILD-DTE          TO                      23140000
231500                TR241-ENF-FILD-DTE                                23150000
231510         MOVE TR017-ENF-ENT-ID            TO                      23151000
231520                TR241-DAT-SRC-ENT-ID                              23152000
231600         IF TR017-ENF-FILD-TM EQUAL SPACES OR ZEROES              23160000
231700             MOVE ZEROES TO TR241-ENF-FILD-TM                     23170000
231800         ELSE                                                     23180000
231900             MOVE TR017-ENF-FILD-TM       TO                      23190000
232000                   TR241-ENF-FILD-TM                              23200000
232100         END-IF                                                   23210000
232200       WHEN PC-ENFBOL                                             23220000
232300         MOVE PC-E                        TO                      23230000
232400                TR241-RPT-TYP                                     23240000
232500         MOVE TR017-ENFBOL-TRN-TYP        TO                      23250000
232600                TR241-TRN-TYP                                     23260000
232700         MOVE PV-PROCESS-SEQ-NBR          TO                      23270000
232800                TR241-PROCESS-SEQ-NBR                             23280000
232900         MOVE TR017-ENFBOL-REC-TYP-CDE    TO                      23290000
233000                TR241-REC-TYP-ENFBOL-CDE                          23300000
233100         MOVE TR017-ENFBOL-SEQ-NBR        TO                      23310000
233200                TR241-ENFBOL-SEQ-NBR                              23320000
233300         MOVE TR017-ENFBOL-3RD-PARTY-CDE  TO                      23330000
233400                TR241-ENFBOL-3RD-PARTY-CDE                        23340000
233410         MOVE TR017-ENFBOL-BKR-REF-NBR    TO TR241-BKR-REF-NBR    23341000
233500         MOVE TR017-ENFBOL-MSTR-BOL-NBR   TO                      23350000
233600                TR241-ENFBOL-MSTR-BOL-NBR                         23360000
233700         MOVE TR017-ENFBOL-HSE-BOL-NBR    TO                      23370000
233800                TR241-ENFBOL-HSE-BOL-NBR                          23380000
233810         MOVE TR017-ENFBOL-CARR-SCAC-ID   TO                      23381000
233820                TR241-ENFBOL-CARR-SCAC-ID                         23382000
233830         MOVE TR017-ENFBOL-ENT-ID         TO                      23383000
233840                TR241-DAT-SRC-ENT-ID                              23384000
233900       WHEN PC-ENFCON                                             23390000
234000         MOVE PC-E                        TO                      23400000
234100                TR241-RPT-TYP                                     23410000
234200         MOVE TR017-ENFCON-TRN-TYP        TO                      23420000
234300                TR241-TRN-TYP                                     23430000
234400         MOVE PV-PROCESS-SEQ-NBR          TO                      23440000
234500                TR241-PROCESS-SEQ-NBR                             23450000
234600         MOVE TR017-ENFCON-REC-TYP-CDE    TO                      23460000
234700                TR241-REC-TYP-ENFCON-CDE                          23470000
234800         MOVE TR017-ENFCON-SEQ-NBR        TO                      23480000
234900                TR241-ENFCON-SEQ-NBR                              23490000
235000         MOVE TR017-ENFCON-3RD-PARTY-CDE  TO                      23500000
235100                TR241-ENFCON-3RD-PARTY-CDE                        23510000
235110         MOVE TR017-ENFCON-BKR-REF-NBR    TO TR241-BKR-REF-NBR    23511000
235200         MOVE TR017-ENFCON-CONTNR-ID      TO                      23520000
235300                TR241-ENFCON-CONTNR-ID                            23530000
235301         MOVE TR017-ENFCON-ENT-ID         TO                      23530100
235302                TR241-DAT-SRC-ENT-ID                              23530200
235310       WHEN PC-DOP                                                23531000
235320         MOVE PC-E                        TO                      23532000
235330                TR241-RPT-TYP                                     23533000
235340         MOVE TR017-DOP-TRN-TYP        TO                         23534000
235350                TR241-TRN-TYP                                     23535000
235360         MOVE PV-PROCESS-SEQ-NBR          TO                      23536000
235370                TR241-PROCESS-SEQ-NBR                             23537000
235380         MOVE TR017-DOP-REC-TYP-CDE    TO                         23538000
235390                TR241-REC-TYP-DOP-CDE                             23539000
235391         MOVE TR017-DOP-SEQ-NBR        TO                         23539100
235392                TR241-DOP-SEQ-NBR                                 23539200
235393         MOVE TR017-DOP-3RD-PARTY-CDE  TO                         23539300
235394                TR241-DOP-3RD-PARTY-CDE                           23539400
235395         MOVE TR017-DOP-BKR-REF-NBR    TO TR241-BKR-REF-NBR       23539500
235396         MOVE TR017-DOP-CONTNR-ID      TO                         23539600
235397                TR241-DOP-CONTNR-ID                               23539700
235398         MOVE TR017-DOP-DELY-ORD-SNT-DTE   TO                     23539800
235399                TR241-DOP-DELY-SNT-DTE                            23539900
235400         MOVE TR017-DOP-ENT-ID         TO                         23540000
235401                TR241-DAT-SRC-ENT-ID                              23540100
235402         IF TR017-DOP-DELY-ORD-SNT-TM EQUAL SPACES OR ZEROES      23540200
235403             MOVE ZEROES TO TR241-DOP-DELY-SNT-TM                 23540300
235404         ELSE                                                     23540400
235405             MOVE TR017-DOP-DELY-ORD-SNT-TM       TO              23540500
235406                   TR241-DOP-DELY-SNT-TM                          23540600
235407         END-IF                                                   23540700
235410       WHEN PC-ENFPO                                              23541000
235500         MOVE PC-E                        TO                      23550000
235600                TR241-RPT-TYP                                     23560000
235700         MOVE TR017-ENFPO-TRN-TYP         TO                      23570000
235800                TR241-TRN-TYP                                     23580000
235900         MOVE PV-PROCESS-SEQ-NBR          TO                      23590000
236000                TR241-PROCESS-SEQ-NBR                             23600000
236100         MOVE TR017-ENFPO-REC-TYP-CDE     TO                      23610000
236200                TR241-REC-TYP-ENFPO-CDE                           23620000
236300         MOVE TR017-ENFPO-SEQ-NBR         TO                      23630000
236400                TR241-ENFPO-SEQ-NBR                               23640000
236500         MOVE TR017-ENFPO-3RD-PARTY-CDE   TO                      23650000
236600                TR241-ENFPO-3RD-PARTY-CDE                         23660000
236610         MOVE TR017-ENFPO-BKR-REF-NBR     TO TR241-BKR-REF-NBR    23661000
236700         MOVE TR017-ENFPO-PO-NBR          TO                      23670000
236800                TR241-ENFPO-PO-NBR                                23680000
236810         MOVE TR017-ENFPO-EXTL-REF-NBR    TO                      23681000
236820                TR241-ENFPO-EXTL-REF-NBR                          23682000
236821         MOVE TR017-ENFPO-ENT-ID          TO                      23682100
236822                TR241-DAT-SRC-ENT-ID                              23682200
236830         MOVE PV-FOB-CDE                  TO TR241-ENFPO-FOB-CDE  23683000
236900       WHEN PC-EXD                                                23690000
237000         MOVE PC-E                        TO                      23700000
237100                TR241-RPT-TYP                                     23710000
237200         MOVE TR017-EXD-TRN-TYP           TO                      23720000
237300                TR241-TRN-TYP                                     23730000
237400         MOVE PV-PROCESS-SEQ-NBR          TO                      23740000
237500                TR241-PROCESS-SEQ-NBR                             23750000
237600         MOVE TR017-EXD-REC-TYP-CDE       TO                      23760000
237700                TR241-REC-TYP-EXD-CDE                             23770000
237800         MOVE TR017-EXD-SEQ-NBR           TO                      23780000
237900                TR241-EXD-SEQ-NBR                                 23790000
238000         MOVE TR017-EXD-3RD-PARTY-CDE     TO                      23800000
238100                TR241-EXD-3RD-PARTY-CDE                           23810000
238110         MOVE TR017-EXD-BKR-REF-NBR       TO TR241-BKR-REF-NBR    23811000
238200         MOVE TR017-EXD-EXM-DTE           TO                      23820000
238300                TR241-EXD-EXM-DTE                                 23830000
238310         MOVE TR017-EXD-ENT-ID            TO                      23831000
238320                TR241-DAT-SRC-ENT-ID                              23832000
238400         IF TR017-EXD-EXM-TM EQUAL SPACES OR ZEROES               23840000
238500             MOVE ZEROES TO TR241-EXD-EXM-TM                      23850000
238600         ELSE                                                     23860000
238700             MOVE TR017-EXD-EXM-TM        TO                      23870000
238800                   TR241-EXD-EXM-TM                               23880000
238900         END-IF                                                   23890000
239000       WHEN PC-REJ                                                23900000
239100         MOVE PC-E                        TO                      23910000
239200                TR241-RPT-TYP                                     23920000
239300         MOVE TR017-REJ-TRN-TYP           TO                      23930000
239400                TR241-TRN-TYP                                     23940000
239500         MOVE PV-PROCESS-SEQ-NBR          TO                      23950000
239600                TR241-PROCESS-SEQ-NBR                             23960000
239700         MOVE TR017-REJ-REC-TYP-CDE       TO                      23970000
239800                TR241-REC-TYP-REJ-CDE                             23980000
239900         MOVE TR017-REJ-SEQ-NBR           TO                      23990000
240000                TR241-REJ-SEQ-NBR                                 24000000
240100         MOVE TR017-REJ-3RD-PARTY-CDE     TO                      24010000
240200                TR241-REJ-3RD-PARTY-CDE                           24020000
240210         MOVE TR017-REJ-BKR-REF-NBR       TO TR241-BKR-REF-NBR    24021000
240300         MOVE TR017-REJ-REJ-DTE           TO                      24030000
240400                TR241-REJ-REJ-DTE                                 24040000
240410         MOVE TR017-REJ-ENT-ID            TO                      24041000
240420                TR241-DAT-SRC-ENT-ID                              24042000
240500         IF TR017-REJ-REJ-TM EQUAL SPACES OR ZEROES               24050000
240600             MOVE ZEROES TO TR241-REJ-REJ-TM                      24060000
240700         ELSE                                                     24070000
240800             MOVE TR017-REJ-REJ-TM        TO                      24080000
240900                   TR241-REJ-REJ-TM                               24090000
241000         END-IF                                                   24100000
241100         MOVE TR017-REJ-REJ-DESC          TO                      24110000
241200                TR241-REJ-REJ-DESC                                24120000
241300       WHEN PC-ECR                                                24130000
241400         MOVE PC-E                        TO                      24140000
241500                TR241-RPT-TYP                                     24150000
241600         MOVE TR017-ECR-TRN-TYP           TO                      24160000
241700                TR241-TRN-TYP                                     24170000
241800         MOVE PV-PROCESS-SEQ-NBR          TO                      24180000
241900                TR241-PROCESS-SEQ-NBR                             24190000
242000         MOVE TR017-ECR-REC-TYP-CDE TO                            24200000
242100                TR241-REC-TYP-ECR-CDE                             24210000
242200         MOVE TR017-ECR-SEQ-NBR           TO                      24220000
242300                TR241-ECR-SEQ-NBR                                 24230000
242400         MOVE TR017-ECR-3RD-PARTY-CDE     TO                      24240000
242500                TR241-ECR-3RD-PARTY-CDE                           24250000
242510         MOVE TR017-ECR-BKR-REF-NBR       TO TR241-BKR-REF-NBR    24251000
242600         MOVE TR017-ECR-EST-CLR-DTE       TO                      24260000
242700                TR241-ECR-EST-CLR-DTE                             24270000
242710         MOVE TR017-ECR-ENT-ID            TO                      24271000
242720                TR241-DAT-SRC-ENT-ID                              24272000
242800         IF TR017-ECR-EST-CLR-TM EQUAL SPACES OR ZEROES           24280000
242900             MOVE ZEROES TO TR241-ECR-EST-CLR-TM                  24290000
243000         ELSE                                                     24300000
243100             MOVE TR017-ECR-EST-CLR-TM     TO                     24310000
243200                   TR241-ECR-EST-CLR-TM                           24320000
243300         END-IF                                                   24330000
243400       WHEN PC-RLS                                                24340000
243500         MOVE PC-E                        TO                      24350000
243600                TR241-RPT-TYP                                     24360000
243700         MOVE TR017-RLS-TRN-TYP           TO                      24370000
243800                TR241-TRN-TYP                                     24380000
243900         MOVE PV-PROCESS-SEQ-NBR          TO                      24390000
244000                TR241-PROCESS-SEQ-NBR                             24400000
244100         MOVE TR017-RLS-REC-TYP-CDE TO                            24410000
244200                TR241-REC-TYP-RLS-CDE                             24420000
244300         MOVE TR017-RLS-SEQ-NBR           TO                      24430000
244400                TR241-RLS-SEQ-NBR                                 24440000
244500         MOVE TR017-RLS-3RD-PARTY-CDE     TO                      24450000
244600                TR241-RLS-3RD-PARTY-CDE                           24460000
244610         MOVE TR017-RLS-BKR-REF-NBR       TO TR241-BKR-REF-NBR    24461000
244700         MOVE TR017-RLS-ACTL-CLR-DTE      TO                      24470000
244800                TR241-RLS-ACTL-CLR-DTE                            24480000
244810         MOVE TR017-RLS-ENT-ID            TO                      24481000
244820                TR241-DAT-SRC-ENT-ID                              24482000
244900         IF TR017-RLS-ACTL-CLR-TM EQUAL SPACES OR ZEROES          24490000
245000             MOVE ZEROES TO TR241-RLS-ACTL-CLR-TM                 24500000
245100         ELSE                                                     24510000
245200             MOVE TR017-RLS-ACTL-CLR-TM    TO                     24520000
245300                   TR241-RLS-ACTL-CLR-TM                          24530000
245400         END-IF                                                   24540000
245500       WHEN PC-LIQ                                                24550000
245600         MOVE PC-E                        TO                      24560000
245700                TR241-RPT-TYP                                     24570000
245800         MOVE TR017-LIQ-TRN-TYP           TO                      24580000
245900                TR241-TRN-TYP                                     24590000
246000         MOVE PV-PROCESS-SEQ-NBR          TO                      24600000
246100                TR241-PROCESS-SEQ-NBR                             24610000
246200         MOVE TR017-LIQ-REC-TYP-CDE TO                            24620000
246300                TR241-REC-TYP-LIQ-CDE                             24630000
246400         MOVE TR017-LIQ-SEQ-NBR           TO                      24640000
246500                TR241-LIQ-SEQ-NBR                                 24650000
246600         MOVE TR017-LIQ-3RD-PARTY-CDE     TO                      24660000
246700                TR241-LIQ-3RD-PARTY-CDE                           24670000
246710         MOVE TR017-LIQ-BKR-REF-NBR       TO TR241-BKR-REF-NBR    24671000
246800         MOVE TR017-LIQ-LQDN-DTE          TO                      24680000
246900                TR241-LIQ-LQDN-DTE                                24690000
246910         MOVE TR017-LIQ-ENT-ID            TO                      24691000
246920                TR241-DAT-SRC-ENT-ID                              24692000
247000         IF TR017-LIQ-LQDN-TM EQUAL SPACES OR ZEROES              24700000
247100             MOVE ZEROES TO TR241-LIQ-LQDN-TM                     24710000
247200         ELSE                                                     24720000
247300             MOVE TR017-LIQ-LQDN-TM        TO                     24730000
247400                   TR241-LIQ-LQDN-TM                              24740000
247500         END-IF                                                   24750000
247600       WHEN PC-LSU                                                24760000
247700         MOVE PC-E                        TO                      24770000
247800                TR241-RPT-TYP                                     24780000
247900         MOVE TR017-LSU-TRN-TYP           TO                      24790000
248000                TR241-TRN-TYP                                     24800000
248100         MOVE PV-PROCESS-SEQ-NBR          TO                      24810000
248200                TR241-PROCESS-SEQ-NBR                             24820000
248300         MOVE TR017-LSU-REC-TYP-CDE TO                            24830000
248400                TR241-REC-TYP-LSU-CDE                             24840000
248500         MOVE TR017-LSU-SEQ-NBR           TO                      24850000
248600                TR241-LSU-SEQ-NBR                                 24860000
248700         MOVE TR017-LSU-3RD-PARTY-CDE     TO                      24870000
248800                TR241-LSU-3RD-PARTY-CDE                           24880000
248810         MOVE TR017-LSU-BKR-REF-NBR       TO TR241-BKR-REF-NBR    24881000
248900         MOVE TR017-LSU-LQDN-SSPNN-DTE    TO                      24890000
249000                TR241-LSU-LQDN-SSPNN-DTE                          24900000
249010         MOVE TR017-LSU-ENT-ID            TO                      24901000
249020                TR241-DAT-SRC-ENT-ID                              24902000
249100         IF TR017-LSU-LQDN-SSPNN-TM EQUAL SPACES OR ZEROES        24910000
249200             MOVE ZEROES TO TR241-LSU-LQDN-SSPNN-TM               24920000
249300         ELSE                                                     24930000
249400             MOVE TR017-LSU-LQDN-SSPNN-TM  TO                     24940000
249500                   TR241-LSU-LQDN-SSPNN-TM                        24950000
249600         END-IF                                                   24960000
249700         MOVE TR017-LSU-LQDN-SSPNN-DESC   TO                      24970000
249800                TR241-LSU-LQDN-SSPNN-DESC                         24980000
249900     END-EVALUATE.                                                24990000
250000                                                                  25000000
250100 EJECT                                                            25010000
250200                                                                  25020000
250300***************************************************************** 25030000
250400* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 25040000
250500***************************************************************** 25050000
250700                                                                  25070000
250800 6200-WRITE-ERROR-REPORT.                                         25080000
250900                                                                  25090000
253300       WRITE TR241-CUSTOMS-ERROR-RECORD FROM                      25330000
253400             TR241-RECORD.                                        25340000
253500                                                                  25350000
253600       PERFORM 5450-INITIALIZE-ERROR-FIELDS.                      25360000
253700                                                                  25370000
253800 EJECT                                                            25380000
253900                                                                  25390000
254000***************************************************************** 25400000
254100* SETUP THE ERROR RECORD PRIOR TO WRITING THE HEADER RECORD.    * 25410000
254200* THE DIFFERENCE BETWEEN THIS PARA AND 6200 IS THAT THIS DOES   * 25420000
254300* NOT INITIALIZE THE ERROR RECORD SO THE ORIGINAL ISA RECORD    * 25430000
254400* READ FROM INPUT CAN BE PASSED TO THE EXTRACT RECORD.          * 25440000
254500***************************************************************** 25450000
254600 6201-WRITE-ERROR-REPORT-HDR.                                     25460000
254700                                                                  25470000
254800       WRITE TR241-CUSTOMS-ERROR-RECORD FROM                      25480000
254900             TR241-RECORD.                                        25490000
255000                                                                  25500000
255100                                                                  25510000
255200 EJECT                                                            25520000
255300                                                                  25530000
255400***************************************************************** 25540000
255500* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 25550000
255600***************************************************************** 25560000
255700 6205-WRITE-ERROR-REPORT-IEA.                                     25570000
255800                                                                  25580000
255900       MOVE PC-E      TO TR241-RPT-TYP.                           25590000
256000                                                                  25600000
256100       WRITE TR241-CUSTOMS-ERROR-RECORD FROM                      25610000
256200             TR241-RECORD.                                        25620000
256300                                                                  25630000
256400       PERFORM 5450-INITIALIZE-ERROR-FIELDS.                      25640000
256500                                                                  25650000
256600 EJECT                                                            25660000
256700                                                                  25670000
256800***************************************************************** 25680000
256900* SETUP THE EDITED UPDATE RECORD PRIOR TO WRITING TO THE UPDATE * 25690000
257000* FILE THAT WILL BE PASSED TO PROGRAM TRKUP245.                 * 25700000
257100***************************************************************** 25710000
257200 6400-WRITE-UPDATE-REPORT.                                        25720000
257300                                                                  25730000
257400     WRITE TR027-UPDATE-CUSTOMS-RECORD FROM                       25740000
257500           TR027-REC-TYP-ENF.                                     25750000
257600                                                                  25760000
257700                                                                  25770000
257800     INITIALIZE TR027-REC-TYP-ENF.                                25780000
257900     INITIALIZE TR027-REC-TYP-ENFBOL.                             25790000
258000     INITIALIZE TR027-REC-TYP-ENFCON.                             25800000
258010     INITIALIZE TR027-REC-TYP-DOP.                                25801000
258100     INITIALIZE TR027-REC-TYP-ENFPO.                              25810000
258200     INITIALIZE TR027-REC-TYP-EXD.                                25820000
258300     INITIALIZE TR027-REC-TYP-REJ.                                25830000
258400     INITIALIZE TR027-REC-TYP-ECR.                                25840000
258500     INITIALIZE TR027-REC-TYP-RLS.                                25850000
258600     INITIALIZE TR027-REC-TYP-LIQ.                                25860000
258700     INITIALIZE TR027-REC-TYP-LSU.                                25870000
258800                                                                  25880000
258900 EJECT                                                            25890000
259000                                                                  25900000
259100***************************************************************** 25910000
259200* WRITE THE EXTRACT RECORD FROM THE INPUT RECORD THAT WAS READ  * 25920000
259300* INTO THE WORKING STORAGE VARIABLE PV-HOLD-EDI-RECORD. THIS IS * 25930000
259400* ONLY EXECUTED TO PASS THE ISA RECORD TO THE EXTRACT FILE.     * 25940000
259500* THIS PARA ALSO INITIALIZES THE ERROR RECORD BECAUSE ALL OF THE* 25950000
259600* ISA RECORD WRITING WILL HAVE BEEN DONE AND THE FIELDS WILL BE * 25960000
259700* READY FOR THE NEXT RECORD.                                    * 25970000
259800***************************************************************** 25980000
259900 6401-WRITE-UPDATE-REPORT-HDR.                                    25990000
260000                                                                  26000000
260100     MOVE TR017-REC-TYP-ENF  TO TR027-REC-TYP-ENF.                26010000
260200                                                                  26020000
260300      MOVE PV-PROCESS-SEQ-NBR       TO TR027-ENF-PROCESS-SEQ-NBR. 26030000
260400                                                                  26040000
260500     WRITE TR027-UPDATE-CUSTOMS-RECORD FROM                       26050000
260600           TR027-REC-TYP-ENF.                                     26060000
260700                                                                  26070000
260800     INITIALIZE TR027-REC-TYP-ENF.                                26080000
260900     INITIALIZE TR027-REC-TYP-ENFBOL.                             26090000
261000     INITIALIZE TR027-REC-TYP-ENFCON.                             26100000
261010     INITIALIZE TR027-REC-TYP-DOP.                                26101000
261100     INITIALIZE TR027-REC-TYP-ENFPO.                              26110000
261200     INITIALIZE TR027-REC-TYP-EXD.                                26120000
261300     INITIALIZE TR027-REC-TYP-REJ.                                26130000
261400     INITIALIZE TR027-REC-TYP-ECR.                                26140000
261500     INITIALIZE TR027-REC-TYP-RLS.                                26150000
261600     INITIALIZE TR027-REC-TYP-LIQ.                                26160000
261700     INITIALIZE TR027-REC-TYP-LSU.                                26170000
261800     INITIALIZE TR241-RECORD.                                     26180000
261900                                                                  26190000
262000 EJECT                                                            26200000
262100                                                                  26210000
262200******************************************************************26220000
262300* SET THE CURRENT TIMESTAMP.                                     *26230000
262400******************************************************************26240000
262500 7100-SET-CURRENT-TMST.                                           26250000
262600                                                                  26260000
262700          EXEC SQL                                                26270000
262800              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            26280000
262900          END-EXEC                                                26290000
263000                                                                  26300000
263100         EVALUATE TRUE                                            26310000
263200             WHEN SQLCODE = ZERO                                  26320000
263300                 CONTINUE                                         26330000
263400                                                                  26340000
263500             WHEN SQLWARN0 NOT EQUAL SPACE                        26350000
263600             WHEN SQLCODE NOT EQUAL ZERO                          26360000
263700                 DISPLAY '**************************************' 26370000
263800                 DISPLAY '** ABEND                            **' 26380000
263900                 DISPLAY '** PROGRAM = TRKUT240               **' 26390000
264000                 DISPLAY '** PARAGRAPH = 7100-SET-CURRENT-TMST**' 26400000
264100                 DISPLAY '** SET CURRENT TIMESTAMP            **' 26410000
264200                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   26420000
264300                 DISPLAY '**************************************' 26430000
264400                 PERFORM 9100-SQL-ABEND                           26440000
264500         END-EVALUATE.                                            26450000
264600                                                                  26460000
264700 EJECT                                                            26470000
267100******************************************************************26710000
267200* SELECT THE CONSOLIDATOR ENTERPRISE NAME FOR HEADER RECORD.     *26720000
267300* THIS ENT_ID WILL BE PASSED TO TRKUP245 LOAD PROGRAM WITH       *26730000
267400* EACH RECORD FOR EACH LOGICAL FILE THAT HAS A VALID ENT_ID.     *26740000
267500******************************************************************26750000
267600 7292-SELECT-ENT-ID.                                              26760000
267700                                                                  26770000
267800         EXEC SQL                                                 26780000
267900             SELECT A.ENT_NAME_DESC                               26790000
268000                 ,  A.ENT_ID                                      26800000
268100              INTO :ENTNME-ENT-NAME-DESC                          26810000
268200                 , :ENTNME-ENT-ID                                 26820000
268300               FROM TENTNME  A                                    26830000
268400                   ,TTRDPRT  B                                    26840000
268410                   ,TEXTENT  C                                    26841007
268500              WHERE B.VEND_INCHG_ID       = :PV-VEND-ID           26850000
268600                AND B.VEND_INCHG_ID_DESC  = :PV-VEND-ID-QUAL      26860000
268700                AND A.ENT_ID              = B.ENT_ID              26870000
268710                AND B.ENT_ID              = C.ENT_ID              26871008
268800                AND A.TYPE_CDE            = '01'                  26880000
268900                AND B.INACTV_DTE          = '9999-09-09'          26890000
268910                AND C.SCAC_CDE            > '    '                26891008
269000         END-EXEC                                                 26900000
269100                                                                  26910000
269200         EVALUATE TRUE                                            26920000
269300             WHEN SQLCODE = ZERO                                  26930000
269310             WHEN SQLCODE = -811                                  26931008
269400                 SET PS-VALID-ENTNME   TO TRUE                    26940000
269500                                                                  26950000
269600             WHEN SQLCODE = +100                                  26960000
269700                 SET PS-INVALID-ENTNME TO TRUE                    26970000
269800                                                                  26980000
269900             WHEN SQLCODE = -904                                  26990000
270000             WHEN SQLCODE = -913                                  27000000
270100                 CONTINUE                                         27010000
270200                                                                  27020000
270300             WHEN SQLWARN0 NOT EQUAL SPACE                        27030000
270400             WHEN SQLCODE NOT EQUAL ZERO                          27040000
270500                 DISPLAY '**************************************' 27050000
270600                 DISPLAY '** ABEND                            **' 27060000
270700                 DISPLAY '** PROGRAM = TRKUT240               **' 27070000
270800                 DISPLAY '** PARAGRAPH = 7292-SELECT-ENT-ID'      27080000
270900                 DISPLAY '** SELECT CONSOLIDATOR NAME         **' 27090000
271000                 DISPLAY '** FROM ISA FOR REC HEADER          **' 27100000
271100                 DISPLAY '** VEND ID      = ' PV-VEND-ID          27110000
271200                 DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL     27120000
271300                 DISPLAY '**************************************' 27130000
271400                 PERFORM 9100-SQL-ABEND                           27140000
271500         END-EVALUATE.                                            27150000
271600                                                                  27160000
271700 EJECT                                                            27170000
274210******************************************************************27421000
274220* HBOL IS CHECKED USING CARRIER SCAC THAT EI SENDS ON THE ENFBOL *27422000
274230* AND CARRIER SCAC ON TEXTENT. IF IT HAS A 'Y' IN CARRIER_IND AND 27423000
274240* AN 'A' IN STATUS_CDE THEN BOL IS NOT REQUIRED AND ERROR MESSAGE 27424000
274250* SHOULD NOT BE SENT.                                             27425000
274260* IF IT DOES NOT MEET THESE REQUIREMENTS THEN CHECK FOR SPACES OR 27426000
274270* ZEROS AND IF FOUND THEN SEND MESSAGE.                           27427000
274280******************************************************************27428000
274290 7300-SELECT-SCAC.                                                27429000
274291                                                                  27429100
274292         MOVE TR017-ENFBOL-CARR-SCAC-ID  TO PV-CARR-SCAC-ID.      27429200
274293                                                                  27429300
274294         EXEC SQL                                                 27429400
274295             SELECT A.CARRIER_IND                                 27429500
274296                 ,  A.STATUS_CDE                                  27429600
274297              INTO :EXTENT-CARRIER-IND                            27429700
274298                 , :EXTENT-STATUS-CDE                             27429800
274299               FROM TEXTENT  A                                    27429900
274300              WHERE A.SCAC_CDE            = :PV-CARR-SCAC-ID      27430000
274301                AND A.STATUS_CDE          = :PC-A                 27430100
274302                AND A.CARRIER_IND         = :PC-Y                 27430200
274303         END-EXEC.                                                27430300
274304                                                                  27430400
274305         EVALUATE TRUE                                            27430500
274306             WHEN SQLCODE = ZERO                                  27430600
274307                 SET PS-VALID-SCAC   TO TRUE                      27430700
274308                                                                  27430800
274309             WHEN SQLCODE = +100                                  27430900
274310                 SET PS-VALID-SCAC-NO TO TRUE                     27431000
274311                                                                  27431100
274312             WHEN SQLWARN0 NOT EQUAL SPACE                        27431200
274313             WHEN SQLCODE NOT EQUAL ZERO                          27431300
274314                 DISPLAY '**************************************' 27431400
274315                 DISPLAY '** ABEND                            **' 27431500
274316                 DISPLAY '** PROGRAM = TRKUT240               **' 27431600
274317                 DISPLAY '** PARAGRAPH = 7300-SELECT-SCAC     **' 27431700
274318                 DISPLAY '** SELECT CARRIER SCAC              **' 27431800
274319                 DISPLAY '** SCAC CDE     = ' PV-CARR-SCAC-ID     27431900
274320                 DISPLAY '** STATUS CDE   = ' PC-A                27432000
274321                 DISPLAY '** CARRIER IND  = ' PC-Y                27432100
274322                 DISPLAY '**************************************' 27432200
274323                 PERFORM 9100-SQL-ABEND                           27432300
274324         END-EVALUATE.                                            27432400
274325                                                                  27432500
274326 EJECT                                                            27432600
274327                                                                  27432700
274328******************************************************************27432800
274329*  TRY TO SELECT ENTRY TYPE CODE FROM TICDVAL/TICDMST             27432900
274330******************************************************************27433000
274331 7360-SELECT-TIMCDVAL.                                            27433100
274332                                                                  27433200
274333     PERFORM                                                      27433300
274334         WITH TEST AFTER                                          27433400
274335         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27433500
274336         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27433600
274337                 SQLCODE = ZERO                     OR            27433700
274338                 SQLCODE = +100                                   27433800
274339                                                                  27433900
274340         EXEC SQL                                                 27434000
274341            SELECT CDVL_DESC                                      27434100
274342            INTO   :ICDVAL-CDVL-DESC                              27434200
274343            FROM   TICDMST  A                                     27434300
274344                 , TICDVAL  B                                     27434400
274345            WHERE B.CDE_ID             =  :PC-DATA-ID-900         27434500
274346              AND B.CDVL_CDE           =  :TR017-ENF-ENTR-TYP-CDE 27434600
274347              AND A.CDE_ID             =  B.CDE_ID                27434700
274348              AND B.CDVL_EFF_STRT_DTE  <  CURRENT DATE            27434800
274349              AND (B.CDVL_EFF_END_DTE  >  CURRENT DATE OR         27434900
274350                   B.CDVL_EFF_END_DTE  =  :PC-DEFAULT-DTE)        27435000
274351              AND A.CDE_EFF_STRT_DTE   <  CURRENT DATE            27435100
274352              AND (A.CDE_EFF_END_DTE   >  CURRENT DATE OR         27435200
274353                   A.CDE_EFF_END_DTE   =  :PC-DEFAULT-DTE)        27435300
274354         END-EXEC                                                 27435400
274355                                                                  27435500
274356         EVALUATE TRUE                                            27435600
274357             WHEN SQLCODE = ZERO                                  27435700
274358                 SET PS-VALID-ENTR-TYP-CDE      TO TRUE           27435800
274359             WHEN SQLCODE = +100                                  27435900
274360             WHEN SQLCODE = -904                                  27436000
274361             WHEN SQLCODE = -913                                  27436100
274362                 CONTINUE                                         27436200
274363             WHEN SQLWARN0 NOT EQUAL SPACE                        27436300
274364             WHEN SQLCODE NOT EQUAL ZERO                          27436400
274365                DISPLAY '***************************************' 27436500
274366                DISPLAY '** ABEND                               ' 27436600
274367                DISPLAY '** SELECT ENF-ENTR-TYP-CDE FROM TIMCDVL '27436700
274368                DISPLAY '** PROGRAM = TRKUT240                   '27436800
274369                DISPLAY '** PARA = 7360-SELECT-TIMCDVAL          '27436900
274370                DISPLAY '** ENTRY ID  = ' TR017-ENF-CSTM-ENTR-ID  27437000
274371                DISPLAY '** ENTY TYP  = ' TR017-ENF-ENTR-TYP-CDE  27437100
274372                DISPLAY '****************************************'27437200
274373                PERFORM 9100-SQL-ABEND                            27437300
274374         END-EVALUATE                                             27437400
274375     END-PERFORM.                                                 27437500
274376                                                                  27437600
274377     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27437700
274378         (SQLCODE NOT = ZERO AND                                  27437800
274379          SQLCODE NOT = +100)                                     27437900
274380         DISPLAY '****************************************'       27438000
274381         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '       27438100
274382         DISPLAY '** SELECT ENF-ENTR-TYP-CDE FROM TIMCDVL '       27438200
274383         DISPLAY '** PROGRAM = TRKUT240                   '       27438300
274384         DISPLAY '** PARA = 7360-SELECT-TIMCDVAL          '       27438400
274385         DISPLAY '** ENTRY ID  = ' TR017-ENF-CSTM-ENTR-ID         27438500
274386         DISPLAY '** ENTY TYP  = ' TR017-ENF-ENTR-TYP-CDE         27438600
274387         DISPLAY '****************************************'       27438700
274388         PERFORM 9100-SQL-ABEND                                   27438800
274389     END-IF.                                                      27438900
274390                                                                  27439000
274391******************************************************************27439100
274392*  TRY TO SELECT FROM CONTAINER PO USING JUST PO.                 27439200
274393******************************************************************27439300
274394 7370-SELECT-TIMCNPO-PO.                                          27439400
274395                                                                  27439500
274396     PERFORM                                                      27439600
274397         WITH TEST AFTER                                          27439700
274398         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27439800
274399         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27439900
274400                 SQLCODE = ZERO                     OR            27440000
274401                 SQLCODE = -811                     OR            27440100
274402                 SQLCODE = +100                                   27440200
274403                                                                  27440300
274404         EXEC SQL                                                 27440400
274405            SELECT PO_NBR                                         27440500
274406            INTO   :IMCNPO-PO-NBR                                 27440600
274407            FROM   TIMCNPO                                        27440700
274409            WHERE PO_NBR  = :IMCNPO-PO-NBR                        27440900
274418         END-EXEC                                                 27441800
274419                                                                  27441900
274420         EVALUATE TRUE                                            27442000
274421             WHEN SQLCODE = ZERO                                  27442100
274422             WHEN SQLCODE = -811                                  27442200
274423                 SET PS-PO-FOUND      TO TRUE                     27442300
274424             WHEN SQLCODE = +100                                  27442400
274425             WHEN SQLCODE = -904                                  27442500
274426             WHEN SQLCODE = -913                                  27442600
274427                 CONTINUE                                         27442700
274428             WHEN SQLWARN0 NOT EQUAL SPACE                        27442800
274429             WHEN SQLCODE NOT EQUAL ZERO                          27442900
274430                DISPLAY '***************************************' 27443000
274431                DISPLAY '** ABEND                               ' 27443100
274432                DISPLAY '** SELECT PO FROM TIMCNPO               '27443200
274433                DISPLAY '** PROGRAM = TRKUT240                   '27443300
274434                DISPLAY '** PARA = 7370-SELECT-TIMCNPO-PO        '27443400
274435                DISPLAY '** ENTRY ID  = ' TR017-ENF-CSTM-ENTR-ID  27443500
274436                DISPLAY '** PO NBR    = ' TR017-ENFPO-PO-NBR      27443600
274437                DISPLAY '****************************************'27443700
274438                PERFORM 9100-SQL-ABEND                            27443800
274439         END-EVALUATE                                             27443900
274440     END-PERFORM.                                                 27444000
274441                                                                  27444100
274442     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27444200
274443         (SQLCODE NOT = ZERO AND                                  27444300
274444          SQLCODE NOT = +100)                                     27444400
274445         DISPLAY '****************************************'       27444500
274446         DISPLAY '** ABEND - MAX RETRIES EXCEEDED        '        27444600
274447         DISPLAY '** SELECT PO FROM TIMCNPO               '       27444700
274448         DISPLAY '** PROGRAM = TRKUT240                   '       27444800
274449         DISPLAY '** PARA = 7370-SELECT-TIMCNPO-PO        '       27444900
274450         DISPLAY '** ENTRY ID  = ' TR017-ENF-CSTM-ENTR-ID         27445000
274451         DISPLAY '** PO NBR    = ' TR017-ENFPO-PO-NBR             27445100
274452         DISPLAY '****************************************'       27445200
274453         PERFORM 9100-SQL-ABEND                                   27445300
274454     END-IF.                                                      27445400
274455                                                                  27445500
274456******************************************************************27445600
274457*  TRY TO SELECT FROM CONTAINER PO USING PO AND EXTL.             27445700
274458******************************************************************27445800
274459 7380-SELECT-TIMCNPO-EXTL-REF.                                    27445900
274460                                                                  27446000
274461     PERFORM                                                      27446100
274462         WITH TEST AFTER                                          27446200
274463         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27446300
274464         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27446400
274465                 SQLCODE = ZERO                     OR            27446500
274466                 SQLCODE = -811                     OR            27446600
274467                 SQLCODE = +100                                   27446700
274468                                                                  27446800
274469         EXEC SQL                                                 27446900
274470            SELECT PO_NBR                                         27447000
274471            INTO   :IMCNPO-PO-NBR                                 27447100
274472            FROM   TIMCNPO                                        27447200
274473            WHERE PO_NBR         = :IMCNPO-PO-NBR                 27447300
274474              AND EXTL_REF_NBR   = :IMCNPO-EXTL-REF-NBR           27447400
274475         END-EXEC                                                 27447500
274476                                                                  27447600
274477         EVALUATE TRUE                                            27447700
274478             WHEN SQLCODE = ZERO                                  27447800
274479             WHEN SQLCODE = -811                                  27447900
274480                 SET PS-EXTL-REF-FOUND TO TRUE                    27448000
274481             WHEN SQLCODE = +100                                  27448100
274482             WHEN SQLCODE = -904                                  27448200
274483             WHEN SQLCODE = -913                                  27448300
274484                 CONTINUE                                         27448400
274485             WHEN SQLWARN0 NOT EQUAL SPACE                        27448500
274486             WHEN SQLCODE NOT EQUAL ZERO                          27448600
274487                DISPLAY '***************************************' 27448700
274488                DISPLAY '** ABEND                               ' 27448800
274489                DISPLAY '** SELECT PO FROM TIMCNPO               '27448900
274490                DISPLAY '** PROGRAM = TRKUT240                   '27449000
274491                DISPLAY '** PARA = 7380-SELECT-TIMCNPO-EXTL-REF'  27449100
274492                DISPLAY '** ENTRY ID  = ' TR017-ENF-CSTM-ENTR-ID  27449200
274493                DISPLAY '** PO NBR    = ' TR017-ENFPO-PO-NBR      27449300
274494                DISPLAY '** EXTL REF  = ' TR017-ENFPO-EXTL-REF-NBR27449400
274495                DISPLAY '****************************************'27449500
274496                PERFORM 9100-SQL-ABEND                            27449600
274497         END-EVALUATE                                             27449700
274498     END-PERFORM.                                                 27449800
274499                                                                  27449900
274500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27450000
274501         (SQLCODE NOT = ZERO AND                                  27450100
274502          SQLCODE NOT = +100)                                     27450200
274503         DISPLAY '****************************************'       27450300
274504         DISPLAY '** ABEND - MAX RETRIES EXCEEDED        '        27450400
274505         DISPLAY '** SELECT PO FROM TIMCNPO               '       27450500
274506         DISPLAY '** PROGRAM = TRKUT240                   '       27450600
274507         DISPLAY '** PARA = 7380-SELECT-TIMCNPO-EXTL-REF'         27450700
274508         DISPLAY '** ENTRY ID  = ' TR017-ENF-CSTM-ENTR-ID         27450800
274509         DISPLAY '** PO NBR    = ' TR017-ENFPO-PO-NBR             27450900
274510         DISPLAY '** EXTL REF  = ' TR017-ENFPO-EXTL-REF-NBR       27451000
274511         DISPLAY '****************************************'       27451100
274512         PERFORM 9100-SQL-ABEND                                   27451200
274513     END-IF.                                                      27451300
274514                                                                  27451400
274515******************************************************************27451500
274516*  TRY TO SELECT FROM CONTAINER PO USING ONLY MASTER BOL          27451600
274517******************************************************************27451700
274518 7390-SELECT-TIMCNPO-MSTR-BOL.                                    27451800
274519                                                                  27451900
274520     PERFORM                                                      27452000
274521         WITH TEST AFTER                                          27452100
274522         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27452200
274523         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27452300
274524                 SQLCODE = ZERO                     OR            27452400
274525                 SQLCODE = -811                     OR            27452500
274526                 SQLCODE = +100                                   27452600
274527                                                                  27452700
274528         EXEC SQL                                                 27452800
274529            SELECT DISTINCT PO_NBR                                27452900
274530            INTO   :IMCNPO-PO-NBR                                 27453000
274531            FROM   TIMCNPO                                        27453100
274532            WHERE  MSTR_BOL_NBR   = :IMCNPO-MSTR-BOL-NBR          27453200
274534         END-EXEC                                                 27453400
274535                                                                  27453500
274536         EVALUATE TRUE                                            27453600
274537           WHEN SQLCODE = ZERO                                    27453700
274538           WHEN SQLCODE = -811                                    27453800
274539               SET PS-MSTR-BOL-FOUND TO TRUE                      27453900
274541           WHEN SQLCODE = +100                                    27454100
274542           WHEN SQLCODE = -904                                    27454200
274543           WHEN SQLCODE = -913                                    27454300
274544               CONTINUE                                           27454400
274545           WHEN SQLWARN0 NOT EQUAL SPACE                          27454500
274546           WHEN SQLCODE NOT EQUAL ZERO                            27454600
274547            DISPLAY '***************************************'     27454700
274548            DISPLAY '** ABEND                               '     27454800
274550            DISPLAY '** PROGRAM = TRKUT240                   '    27455000
274551            DISPLAY '** PARA = 7390-SELECT-TIMCNPO-MSTR-BOL'      27455100
274552            DISPLAY '** ENTRY ID  = ' TR017-ENFBOL-CSTM-ENTR-ID   27455200
274553            DISPLAY '** MSTR BOL  = ' TR017-ENFBOL-MSTR-BOL-NBR   27455300
274555            DISPLAY '****************************************'    27455500
274556            PERFORM 9100-SQL-ABEND                                27455600
274557       END-EVALUATE                                               27455700
274558     END-PERFORM.                                                 27455800
274559                                                                  27455900
274560     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27456000
274561         (SQLCODE NOT = ZERO AND                                  27456100
274562          SQLCODE NOT = +100)                                     27456200
274563         DISPLAY '****************************************'       27456300
274564         DISPLAY '** ABEND - MAX RETRIES EXCEEDED        '        27456400
274566         DISPLAY '** PROGRAM = TRKUT240                   '       27456600
274567         DISPLAY '** PARA = 7390-SELECT-TIMCNPO-MSTR-BOL'         27456700
274568         DISPLAY '** ENTRY ID  = ' TR017-ENFBOL-CSTM-ENTR-ID      27456800
274569         DISPLAY '** MSTR BOL  = ' TR017-ENFBOL-MSTR-BOL-NBR      27456900
274571         DISPLAY '****************************************'       27457100
274572         PERFORM 9100-SQL-ABEND                                   27457200
274573     END-IF.                                                      27457300
274574                                                                  27457400
274575******************************************************************27457500
274576*  TRY TO SELECT FROM CONTAINER PO USING ONLY HOUSE BOL           27457600
274577******************************************************************27457700
274578 7400-SELECT-TIMCNPO-HSE-BOL.                                     27457800
274579                                                                  27457900
274580     PERFORM                                                      27458000
274581         WITH TEST AFTER                                          27458100
274582         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27458200
274583         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27458300
274584                 SQLCODE = ZERO                     OR            27458400
274585                 SQLCODE = -811                     OR            27458500
274586                 SQLCODE = +100                                   27458600
274587                                                                  27458700
274588         EXEC SQL                                                 27458800
274589            SELECT DISTINCT PO_NBR                                27458900
274590            INTO   :IMCNPO-PO-NBR                                 27459000
274591            FROM   TIMCNPO                                        27459100
274592            WHERE  HSE_BOL_NBR    = :IMCNPO-HSE-BOL-NBR           27459200
274593         END-EXEC                                                 27459300
274594                                                                  27459400
274595         EVALUATE TRUE                                            27459500
274596           WHEN SQLCODE = ZERO                                    27459600
274597           WHEN SQLCODE = -811                                    27459700
274598               SET PS-HSE-BOL-FOUND TO TRUE                       27459800
274599           WHEN SQLCODE = +100                                    27459900
274600           WHEN SQLCODE = -904                                    27460000
274601           WHEN SQLCODE = -913                                    27460100
274602               CONTINUE                                           27460200
274603           WHEN SQLWARN0 NOT EQUAL SPACE                          27460300
274604           WHEN SQLCODE NOT EQUAL ZERO                            27460400
274605            DISPLAY '***************************************'     27460500
274606            DISPLAY '** ABEND                               '     27460600
274607            DISPLAY '** PROGRAM = TRKUT240                   '    27460700
274608            DISPLAY '** PARA = 7400-SELECT-TIMCNPO-HSE-BOL'       27460800
274609            DISPLAY '** ENTRY ID  = ' TR017-ENFBOL-CSTM-ENTR-ID   27460900
274610            DISPLAY '** HSE BOL  = ' TR017-ENFBOL-HSE-BOL-NBR     27461000
274611            DISPLAY '****************************************'    27461100
274612            PERFORM 9100-SQL-ABEND                                27461200
274613       END-EVALUATE                                               27461300
274614     END-PERFORM.                                                 27461400
274615                                                                  27461500
274616     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27461600
274617         (SQLCODE NOT = ZERO AND                                  27461700
274618          SQLCODE NOT = +100)                                     27461800
274619         DISPLAY '****************************************'       27461900
274620         DISPLAY '** ABEND - MAX RETRIES EXCEEDED        '        27462000
274621         DISPLAY '** PROGRAM = TRKUT240                   '       27462100
274622         DISPLAY '** PARA = 7400-SELECT-TIMCNPO-HSE-BOL'          27462200
274623         DISPLAY '** ENTRY ID  = ' TR017-ENFBOL-CSTM-ENTR-ID      27462300
274624         DISPLAY '** HSE BOL   = ' TR017-ENFBOL-HSE-BOL-NBR       27462400
274625         DISPLAY '****************************************'       27462500
274626         PERFORM 9100-SQL-ABEND                                   27462600
274627     END-IF.                                                      27462700
274628                                                                  27462800
274629******************************************************************27462900
274631*   OPEN  FOB AND SCAC CURSOR                                    *27463100
274632******************************************************************27463200
274633                                                                  27463300
274634 7500-OPEN-FOB-SCAC.                                              27463400
274636                                                                  27463600
274637     EXEC SQL                                                     27463700
274638         OPEN FOB_SCAC_CSR                                        27463800
274639     END-EXEC                                                     27463900
274640                                                                  27464000
274641     EVALUATE TRUE                                                27464100
274642         WHEN SQLCODE = ZERO                                      27464200
274643             CONTINUE                                             27464300
274644         WHEN SQLWARN0 NOT EQUAL SPACE                            27464400
274645         WHEN SQLCODE NOT EQUAL ZERO                              27464500
274646             DISPLAY '**************************************'     27464600
274647             DISPLAY '** ABEND                            **'     27464700
274648             DISPLAY '** PROGRAM = TRKUT240               **'     27464800
274649             DISPLAY '** PARAGRAPH = 7500-OPEN-FOB-SCAC   **'     27464900
274656             DISPLAY '**************************************'     27465600
274657             PERFORM 9100-SQL-ABEND                               27465700
274658                                                                  27465800
274659     END-EVALUATE.                                                27465900
274660                                                                  27466000
274661******************************************************************27466100
274662* FETCH FOB-SCAC.                                                *27466200
274663******************************************************************27466300
274664 7505-FETCH-FOB-SCAC.                                             27466400
274665                                                                  27466500
274676         EXEC SQL                                                 27467600
274677             FETCH FOB_SCAC_CSR                                   27467700
274678               INTO :PV-FOB-CDE                                   27467800
274679                   ,:PV-SCAC-CDE                                  27467900
274683         END-EXEC                                                 27468300
274684                                                                  27468400
274685         EVALUATE TRUE                                            27468500
274686             WHEN SQLCODE = +0                                    27468600
274687                 CONTINUE                                         27468700
274689             WHEN SQLCODE = +100                                  27468900
274690                 MOVE SPACES TO PV-FOB-CDE                        27469000
274691                                PV-SCAC-CDE                       27469100
274696             WHEN SQLWARN0 NOT EQUAL SPACE                        27469600
274697             WHEN SQLCODE NOT EQUAL ZERO                          27469700
274698                 DISPLAY '**************************************' 27469800
274699                 DISPLAY '** ABEND                            **' 27469900
274700                 DISPLAY '** PROGRAM = TRKUT240               **' 27470000
274701                 DISPLAY '** PARAGRAPH = 7505-FETCH-FOB-SCAC  **' 27470100
274704                 DISPLAY '**************************************' 27470400
274705                 PERFORM 9100-SQL-ABEND                           27470500
274706         END-EVALUATE.                                            27470600
274721                                                                  27472100
274722******************************************************************27472200
274723*   CLOSE FOB-SCAC                                               *27472300
274724******************************************************************27472400
274725                                                                  27472500
274726 7510-CLOSE-FOB-SCAC.                                             27472600
274727                                                                  27472700
274728     EXEC SQL                                                     27472800
274729        CLOSE FOB_SCAC_CSR                                        27472900
274730     END-EXEC                                                     27473000
274731                                                                  27473100
274732     EVALUATE TRUE                                                27473200
274733         WHEN SQLCODE = ZERO                                      27473300
274734             CONTINUE                                             27473400
274735         WHEN SQLWARN0 NOT EQUAL SPACE                            27473500
274736         WHEN SQLCODE NOT EQUAL ZERO                              27473600
274737             DISPLAY '**************************************'     27473700
274738             DISPLAY '** ABEND                            **'     27473800
274739             DISPLAY '** PROGRAM = TRKUT240               **'     27473900
274740             DISPLAY '** PARAGRAPH = 7510-CLOSE-FOB-SCAC  **'     27474000
274747             DISPLAY '**************************************'     27474700
274748             PERFORM 9100-SQL-ABEND                               27474800
274749                                                                  27474900
274750     END-EVALUATE.                                                27475000
274751 EJECT                                                            27475100
274752******************************************************************27475200
274753* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *27475300
274754* JOB SUMMARY INFORMATION.                                       *27475400
274755* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *27475500
274760* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *27476000
274800* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *27480000
274900* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*27490000
275000* NO RETURN CODE OR MESSAGE IS SENT.                             *27500000
275100******************************************************************27510000
275200 8000-EOJ-ROUTINE.                                                27520000
275300                                                                  27530000
275400     IF EDI-IEA-RECORD OR                                         27540000
275500        TR241-ERROR-TYPE = PC-EMPTY                               27550000
275600         CONTINUE                                                 27560000
275700     ELSE                                                         27570000
275800         MOVE PC-EDI         TO TR241-ERROR-TYPE                  27580000
275900         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  27590000
276000                             TO TR241-ERROR-MSG                   27600000
276100         MOVE SPACES         TO TR241-REC-TYP-ENF                 27610000
276200                                TR241-DATA-IN-ERROR               27620000
276300                                TR241-CSTM-ENTR-ID                27630000
276400                                TR241-BKR-REF-NBR                 27640000
276500                                TR241-DATA-VALUE                  27650000
276600                                TR241-TRN-TYP                     27660000
276700         ADD +1 TO PV-PROCESS-SEQ-NBR                             27670000
276800         MOVE PV-PROCESS-SEQ-NBR TO TR241-PROCESS-SEQ-NBR         27680000
276900         PERFORM 6205-WRITE-ERROR-REPORT-IEA                      27690000
277000     END-IF.                                                      27700000
277100                                                                  27710000
277200     CLOSE TR017-CUSTOMS-FILE                                     27720000
277300           TR027-UPDATE-CUSTOMS-FILE                              27730000
277400           TR241-CUSTOMS-ERROR-FILE.                              27740000
277500                                                                  27750000
277600     DISPLAY '**********************************'.                27760000
277700     DISPLAY '** TRKUT240 SUMMARY **'.                            27770000
277800     DISPLAY 'TOTAL CSTM INPUT RECS  = ' PA-TOTAL-INPUT-READ.     27780000
277900     DISPLAY 'TOTAL EDI RECS         = ' PA-TOTAL-EDI-REC-READ.   27790000
278000     DISPLAY 'TOTAL CSTM ADD RECS    = ' PA-TOT-CSTM-RECS-ADD.    27800000
278100     DISPLAY 'TOTAL CSTM CHG RECS    = ' PA-TOT-CSTM-RECS-CHANGE. 27810000
278200     DISPLAY 'TOTAL CSTM DEL RECS    = ' PA-TOT-CSTM-RECS-DELETE. 27820000
278300     DISPLAY 'TOTAL INVALID REC TYPS = ' PA-TOT-INVALID-REC-TYP.  27830000
278400     DISPLAY 'TOTAL INVALID TRN TYPS = ' PA-TOT-INVALID-TRN-TYP.  27840000
278500     DISPLAY '**********************************'.                27850000
278600                                                                  27860000
278700 EJECT                                                            27870000
278800                                                                  27880000
278900******************************************************************27890000
279000* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *27900000
279100* ERROR OR WARNING CODE OCCURS.                                  *27910000
279200******************************************************************27920000
279300 9100-SQL-ABEND.                                                  27930000
279400******************************************************************27940000
279500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *27950000
279600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *27960000
279700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *27970000
279800* FORMAT.                                                        *27980000
279900******************************************************************27990000
280000                                                                  28000000
280100     COPY DPPD004.                                                28010000
280200                                                                  28020000
280300     DISPLAY 'CUSTOMS ENTRY ABEND     '  TR017-ENF-CSTM-ENTR-ID   28030000
280400     DISPLAY 'BROKER REF NBR          '  TR017-ENF-BKR-REF-NBR.   28040000
280500     MOVE +4013 TO ABEND-CODE.                                    28050000
280600     CALL 'ILBOABN0' USING ABEND-CODE.                            28060000
280700                                                                  28070000
