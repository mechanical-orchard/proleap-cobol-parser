000100******************************************************************00010055
000200 IDENTIFICATION DIVISION.                                         00020056
000300******************************************************************00030056
000400                                                                  00040056
000500 PROGRAM-ID.             ARKUT025.                                00050056
000600 AUTHOR.                 TAMARA KOLTUN.                           00060056
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070056
000800 DATE-WRITTEN            5-15-95.                                 00080056
000900 DATE-COMPILED.                                                   00090056
001000                                                                  00100056
001100*----------------------------------------------------------------*00110056
001200* THIS PROGRAM IS USED TO START THE CREDIT REFUND PROCESS ON THE *00120056
001300* IBM.                                                           *00130056
001400* THERE ARE 2 CONTROL CARDS THAT ARE INPUT TO THE PROGRAM        *00140056
001500*  FIRST CHECK CARD FILE - CONTAINS THE 1ST CHECK # TO START WITH*00150056
001600*  RESTART CHECK CARD FILE - CONTAINS THE 1ST CHECK IF RERUN     *00160056
001700*----------------------------------------------------------------*00170056
001800******************************************************************00170166
001900*    DATE  07/10/2011                                            *00171066
002000*    WRITTEN BY: JILL ZIMBAL             WR/IR #: 3231A          *00172066
002100* - MADE THE ACCOUNT TYPE FIELD A FILLER.  WITH THE FIRST DATA   *00172166
002200*   CONVERSION THE ACCOUNT TYPE FIELD WILL NO LONGER BE USED     *00172266
002300*   ALSO, MAPPED THE PHONE CODE OVER FROM THE FIRST DATA VALUES  *00172366
002400*   TO THE KOHLS VALUES.                                         *00173066
002401******************************************************************00174066
002402                                                                  00180056
002403******************************************************************00190056
002404 ENVIRONMENT DIVISION.                                            00200056
002405******************************************************************00210056
002406                                                                  00220056
002407 CONFIGURATION SECTION.                                           00230056
002408                                                                  00240056
002500 SOURCE-COMPUTER.        IBM-3090.                                00250056
002600 OBJECT-COMPUTER.        IBM-3090.                                00260056
002700                                                                  00270056
002800 INPUT-OUTPUT SECTION.                                            00280056
002900                                                                  00290056
003000 FILE-CONTROL.                                                    00300056
003100                                                                  00310056
003200      SELECT CREDIT-BALANCE-FILE      ASSIGN TO INP01.            00320056
003300      SELECT FIRST-CHECK-CARD-FILE    ASSIGN TO INP02.            00330056
003400      SELECT RESTART-CHECK-CARD-FILE  ASSIGN TO INP03.            00340056
003500      SELECT CHECK-FILE               ASSIGN TO OUT01.            00350056
003600      SELECT EXCEPTION-REPORT-FILE    ASSIGN TO OUT02.            00360056
003700      SELECT CREDIT-BALANCE-GL-FILE   ASSIGN TO OUT03.            00370056
003800                                                                  00380056
003900******************************************************************00390056
004000 DATA DIVISION.                                                   00400056
004100******************************************************************00410056
004200                                                                  00420056
004300 FILE SECTION.                                                    00430056
004400 FD  CREDIT-BALANCE-FILE                                          00440056
004500     LABEL RECORDS ARE STANDARD                                   00450056
004600     BLOCK CONTAINS 0 RECORDS                                     00460056
004700     RECORDING MODE IS F                                          00470056
004800     RECORD CONTAINS 241 CHARACTERS                               00480064
004900     DATA RECORD IS CREDIT-BALANCE-RECORD.                        00490056
005000                                                                  00500056
005100 01  CREDIT-BALANCE-RECORD        PIC X(241).                     00510064
005200                                                                  00520056
005300 FD  FIRST-CHECK-CARD-FILE                                        00530056
005400     LABEL RECORDS ARE STANDARD                                   00540056
005500     BLOCK CONTAINS 0 RECORDS                                     00550056
005600     RECORDING MODE IS F                                          00560056
005700     RECORD CONTAINS 80  CHARACTERS                               00570056
005800     DATA RECORD IS FIRST-CHECK-CARD-RECORD.                      00580056
005900                                                                  00590056
006000 01  FIRST-CHECK-CARD-RECORD         PIC X(80).                   00600056
006100                                                                  00610056
006200 FD  RESTART-CHECK-CARD-FILE                                      00620056
006300     LABEL RECORDS ARE STANDARD                                   00630056
006400     BLOCK CONTAINS 0 RECORDS                                     00640056
006500     RECORDING MODE IS F                                          00650056
006600     RECORD CONTAINS 80  CHARACTERS                               00660056
006700     DATA RECORD IS RESTART-CHECK-CARD-RECORD.                    00670056
006800                                                                  00680056
006900 01  RESTART-CHECK-CARD-RECORD       PIC X(80).                   00690056
007000                                                                  00700056
007100 FD  CHECK-FILE                                                   00710056
007200     LABEL RECORDS ARE STANDARD                                   00720056
007300     BLOCK CONTAINS 0 RECORDS                                     00730056
007400     RECORDING MODE IS F                                          00740056
007500     RECORD CONTAINS 346 CHARACTERS                               00750062
007600     DATA RECORD IS CHECK-RECORD.                                 00760056
007700                                                                  00770056
007800 01  CHECK-RECORD                    PIC X(346).                  00780062
007900                                                                  00790056
008000 FD  EXCEPTION-REPORT-FILE                                        00800056
008100     LABEL RECORDS ARE STANDARD                                   00810056
008200     BLOCK CONTAINS 0 RECORDS                                     00820056
008300     RECORDING MODE IS F                                          00830056
008400     RECORD CONTAINS 132 CHARACTERS                               00840056
008500     DATA RECORD IS EXCEPTION-REPORT-RECORD.                      00850056
008600                                                                  00860056
008700 01  EXCEPTION-REPORT-RECORD         PIC X(132).                  00870056
008800                                                                  00880056
008810 FD  CREDIT-BALANCE-GL-FILE                                       00881056
008820     LABEL RECORDS ARE STANDARD                                   00882056
008830     BLOCK CONTAINS 0 RECORDS                                     00883056
008840     RECORDING MODE IS F                                          00884056
008850     RECORD CONTAINS 184 CHARACTERS                               00885056
008860     DATA RECORD IS CREDIT-BALANCE-GL-RECORD.                     00886056
008870                                                                  00887056
008880 01  CREDIT-BALANCE-GL-RECORD        PIC X(184).                  00888056
008890                                                                  00889056
008900*------------------------------------------------------*          00890056
009000 WORKING-STORAGE SECTION.                                         00900056
009100*------------------------------------------------------*          00910056
009200 01 PC-PROGRAM-CONSTANTS.                                         00920056
009300    05 PC-AMT-DESC                   PIC X(22)                    00930056
009400                              VALUE 'CREDIT BALANCE REFUND '.     00940056
009500    05 PC-AMT-LIMIT                  PIC S9(04)V99 VALUE          00950056
009600                                         -4999.99.                00960056
009700    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'ARKUT025'.  00970056
009800    05 PC-EXC-REPORT-NBR             PIC 9(01) VALUE 1.           00980056
009900                                                                  00990056
010000 01 PV-PROGRAM-VARIABLES.                                         01000056
010100    05  PV-CURR-TMST-DETAIL.                                      01010056
010110        10  PV-CURR-DATE.                                         01011056
010120            15  PV-CURR-TMST-CC      PIC  X(02).                  01012056
010130            15  PV-CURR-TMST-YY      PIC  X(02).                  01013056
010140            15  PV-CURR-TMST-MM      PIC  X(02).                  01014056
010150            15  PV-CURR-TMST-DD      PIC  X(02).                  01015056
010160        10  PV-CURR-TMST-HOUR        PIC  X(02).                  01016056
010170        10  PV-CURR-TMST-MIN         PIC  X(02).                  01017056
010180        10  PV-CURR-TMST-SEC         PIC  X(02).                  01018056
010190                                                                  01019056
010200    05 PV-ABEND-CODE                 PIC  9(04)    VALUE ZEROES.  01020056
010300    05 PV-EXC-LINE-COUNT             PIC S9(04)    VALUE 61       01030056
010400                                                   COMP.          01040056
010500    05 PV-EXC-PAGE-COUNT             PIC S9(04)    VALUE ZEROES   01050056
010600                                                   COMP.          01060056
010700    05 PV-INSERT-COUNT               PIC S9(09)    VALUE ZEROES   01070056
010800                                                   COMP.          01080056
010900    05 PV-READ-COUNT                 PIC S9(09)    VALUE ZEROES   01090056
011000                                                   COMP.          01100056
011100    05 PV-WRITE-COUNT                PIC S9(09)    VALUE ZEROES   01110056
011200                                                   COMP.          01120056
011300    05 PV-ABEND-PARA-NAME            PIC X(30)     VALUE SPACE.   01130056
011400    05 PV-DB2-OPERATION-MSG-1        PIC X(40)     VALUE SPACE.   01140056
011500    05 PV-DB2-TABLE-NAME             PIC X(12)     VALUE SPACE.   01150056
011600    05 PV-SQLCODE                    PIC Z(8)9-.                  01160056
011700    05 PV-PARAGRAPH-NAME             PIC X(30)     VALUE SPACE.   01170056
011800    05 PV-ADDR-LINE1-HOLD            PIC X(21)     VALUE SPACE.   01180056
011900    05 PV-ADDR-LINE2-HOLD            PIC X(19)     VALUE SPACE.   01190056
012000    05 PV-ADDR-LINE3-HOLD            PIC X(19)     VALUE SPACE.   01200056
012100    05 PV-ADDR-LINE4-HOLD            PIC X(10)     VALUE SPACE.   01210056
012200    05 PV-ACCOUNT-NBR                PIC X(10)     VALUE ZEROS.   01220065
012300    05 PV-ACCOUNT-NBR-RED REDEFINES PV-ACCOUNT-NBR                01230056
012400                                     PIC 9(10).                   01240069
012500    05 PV-LAST-GOOD-CHECK            PIC S9(09) COMP VALUE 0.     01250056
012600    05 PV-INT                        PIC  9(06)     VALUE 0.      01260056
012700    05 PV-REMNDR                     PIC  9(02)     VALUE 0.      01270056
012800    05 PV-GL-TR-AMT                  PIC S9(08)V9(05)             01280056
012900                                                    VALUE ZEROS.  01290056
013000    05 PV-GL-TR-UNITS                PIC S9(08)V9(05)             01300056
013100                                                    VALUE ZEROS.  01310056
013200    05 PV-GL-CR-REFUND-DESC.                                      01320056
013300       10 FILLER                     PIC X(14)     VALUE          01330056
013400                                       'CREDIT REFUND '.          01340056
013500       10 PV-GL-CR-REFUND-DATE       PIC X(8)      VALUE SPACES.  01350056
013510       10 FILLER                     PIC X(36)     VALUE SPACES.  01351056
013511    05 PV-CHECK-SEQ-NBR              PIC 9(06)     VALUE ZEROES.  01351157
013512                                                                  01351257
013520 01 PS-PROGRAM-SWITCHES.                                          01352056
013530    05 PS-END-OF-CR-BAL-RFND-SW      PIC  X(01)    VALUE 'N'.     01353056
013540       88 PS-END-OF-CR-BAL-RFND                    VALUE 'Y'.     01354056
013550    05 PS-ERROR-FOUND-IND            PIC  X(01)    VALUE ' '.     01355056
013560       88 PS-ERROR-FOUND                           VALUE 'F'.     01356056
013570       88 PS-ERROR-NOT-FOUND                       VALUE 'N'.     01357056
013580    05 PS-FIRST-TIME-THRU-SW         PIC  X(01)    VALUE 'Y'.     01358056
013590       88 PS-FIRST-TIME-THRU                       VALUE 'Y'.     01359056
013600       88 PS-NOT-FIRST-TIME-THRU                   VALUE 'N'.     01360056
013700    05 PS-ACT-FOUND-SW               PIC  X(01)    VALUE 'N'.     01370056
013800       88 PS-ACT-FOUND                             VALUE 'Y'.     01380056
013900                                                                  01390056
014000 01 FIRST-CHECK-CARD-LAYOUT.                                      01400056
014100    05  FIRST-CARD-CHECK-NBR        PIC X(09)     VALUE SPACES.   01410056
014200                                                                  01420056
014300 01 RESTART-CHECK-CARD-LAYOUT.                                    01430056
014400    05 RESTART-FIRST-VOID-CHECK     PIC X(09)     VALUE SPACES.   01440056
014500    05 FILLER                       PIC X(01)     VALUE SPACES.   01450056
014600    05 RESTART-LAST-VOID-CHECK      PIC X(09)     VALUE SPACES.   01460056
014700    05 FILLER                       PIC X(01)     VALUE SPACES.   01470056
014800    05 RESTART-FIRST-START-CHECK    PIC X(09)     VALUE SPACES.   01480056
014801    05 FILLER                       PIC X(01)     VALUE SPACES.   01480158
014810    05 RESTART-CK-SEQ-NBR           PIC 9(06)     VALUE ZEROES.   01481058
014900                                                                  01490056
015000                                                                  01500056
015100*** STANDARD HEADER LINE - 132 BYTES.                             01510056
015200     COPY DPWS132O.                                               01520056
015300                                                                  01530056
015400****                                                              01540056
015500 01 EXCEPTION-REPORT-AREA.                                        01550056
015600    05 ER-HEADER-LINE-2.                                          01560056
015700       10 FILLER                     PIC  X(52)      VALUE SPACE. 01570056
015800       10 FILLER                     PIC  X(29)      VALUE        01580056
015900       'REJECTED CREDIT REFUND CHECKS'.                           01590056
016000       10 FILLER                     PIC  X(51)      VALUE SPACE. 01600056
016100                                                                  01610056
016200    05 ER-HEADER-LINE-3.                                          01620056
016300       10 FILLER                     PIC  X(51)      VALUE SPACE. 01630056
016400       10 FILLER                     PIC  X(21)      VALUE        01640056
016500       'FOR CHECKS PROCESSED '.                                   01650056
016600       10 ER-MM                      PIC 9(02).                   01660056
016700       10 FILLER                     PIC X(01) VALUE '/'.         01670056
016800       10 ER-DD                      PIC 9(02).                   01680056
016900       10 FILLER                     PIC X(01) VALUE '/'.         01690056
017000       10 ER-CC                      PIC 9(02).                   01700056
017100       10 ER-YY                      PIC 9(02).                   01710056
017200       10 FILLER                     PIC  X(50)      VALUE SPACE. 01720056
017300                                                                  01730056
017400    05 ER-HEADER-LINE-4.                                          01740056
017500       10 FILLER                     PIC  X(03)      VALUE SPACE. 01750056
017600       10 FILLER                     PIC  X(07)      VALUE        01760056
017700                                                       'ACCOUNT'. 01770056
017800       10 FILLER                     PIC  X(11)      VALUE SPACE. 01780056
017900       10 FILLER                     PIC  X(06)      VALUE        01790056
018000                                                       'REFUND'.  01800056
018100       10 FILLER                     PIC  X(03)      VALUE SPACE. 01810056
018200       10 FILLER                     PIC  X(14)      VALUE        01820056
018300                                                'CUSTOMER  NAME'. 01830056
018400       10 FILLER                     PIC  X(18)      VALUE SPACE. 01840056
018500       10 FILLER                     PIC  X(46)      VALUE        01850056
018600                'C  U  S  T  O  M  E  R     A  D  D  R  E  S  S'. 01860056
018700       10 FILLER                     PIC  X(12)      VALUE SPACE. 01870056
018800       10 FILLER                     PIC  X(14)      VALUE        01880056
018900                                            'CUST PHONE'.         01890056
019000                                                                  01900056
019100    05 ER-HEADER-LINE-5.                                          01910056
019200       10 FILLER                     PIC  X(05)      VALUE SPACE. 01920056
019300       10 FILLER                     PIC  X(03)      VALUE 'NUM'. 01930056
019400       10 FILLER                     PIC  X(14)      VALUE SPACE. 01940056
019500       10 FILLER                     PIC  X(03)      VALUE 'AMT'. 01950056
019600       10 FILLER                     PIC  X(97)      VALUE SPACE. 01960056
019700       10 FILLER                     PIC  X(06)      VALUE        01970056
019800                                                     'NUMBER'.    01980056
019900       10 FILLER                     PIC  X(04)      VALUE SPACE. 01990056
020000                                                                  02000056
020100    05 ER-DETAIL-LINE.                                            02010056
020200       10 FILLER                     PIC  X(01)      VALUE SPACE. 02020056
020300       10 ER-ACT-NUM                 PIC  9(10)      VALUE ZEROS. 02030065
020400       10 FILLER                     PIC  X(03)      VALUE SPACE. 02040065
020500       10 ER-REFUND-AMT              PIC  Z(10).99-  VALUE ZEROS. 02050056
020600       10 FILLER                     PIC  X(01)      VALUE SPACE. 02060056
020700       10 ER-CUSTOMER-NAME           PIC  X(20)      VALUE SPACE. 02070056
020800       10 FILLER                     PIC  X(01)      VALUE SPACE. 02080056
020900       10 ER-CUSTOMER-ADDRESS        PIC  X(69)      VALUE SPACE. 02090056
021000       10 FILLER                     PIC  X(01)      VALUE SPACE. 02100056
021100       10 ER-CUSTOMER-PHONE          PIC  X(12)      VALUE SPACE. 02110056
021200       10 FILLER                     PIC  X(01)      VALUE SPACE. 02120056
021300                                                                  02130056
021400*INPUT FILE FROM TANDEM                                           02140056
021500     COPY ARWS051.                                                02150056
021600                                                                  02160056
021700*OUTPUT CHECK FILE                                                02170056
021800     COPY ARRD062.                                                02180056
021900*OUTPUT GL FILE                                                   02190056
022000     COPY ARWS030.                                                02200056
022100*** DB2 MESSAGE AREAS ****                                        02210056
022200     COPY DPWS004.                                                02220056
022300                                                                  02230056
022400     EXEC SQL                                                     02240056
022500          INCLUDE SQLCA                                           02250056
022600     END-EXEC.                                                    02260056
022700                                                                  02270056
022800     EXEC SQL                                                     02280056
022900          INCLUDE TCRRFND                                         02290056
023000     END-EXEC.                                                    02300056
023100                                                                  02310056
023200 01 CA-COMMON-AREA.                                               02320056
023300    05 CA-REFUND-AMT              PIC 9(05)V9(02) VALUE 0.        02330056
023400    05 CA-REFUND-IN-WORDS         PIC X(80)       VALUE SPACE.    02340056
023500                                                                  02350056
023600                                                                  02360056
023700 PROCEDURE DIVISION.                                              02370056
023800********************************************************          02380056
023900 0000-MAIN.                                                       02390056
024000********************************************************          02400056
024100     PERFORM 1000-OPEN-FILES.                                     02410056
024200                                                                  02420056
024300     PERFORM 2000-INITIALIZATION.                                 02430056
024400                                                                  02440056
024500     PERFORM 3000-PROCESS-CR-BAL-RNFD-CHKS                        02450056
024600        UNTIL PS-END-OF-CR-BAL-RFND.                              02460056
024700                                                                  02470056
024800     PERFORM 4000-CREATE-CR-BAL-GL.                               02480056
024900                                                                  02490056
025000     PERFORM 5000-END-PGM.                                        02500056
025100                                                                  02510056
025200     STOP RUN.                                                    02520056
025300                                                                  02530056
025400********************************************************          02540056
025500 1000-OPEN-FILES.                                                 02550056
025600********************************************************          02560056
025700       OPEN INPUT  CREDIT-BALANCE-FILE                            02570056
025800                   FIRST-CHECK-CARD-FILE                          02580056
025900                   RESTART-CHECK-CARD-FILE.                       02590056
026000                                                                  02600056
026100       OPEN OUTPUT CHECK-FILE                                     02610056
026200                   CREDIT-BALANCE-GL-FILE                         02620056
026300                   EXCEPTION-REPORT-FILE.                         02630056
026400                                                                  02640056
026500********************************************************          02650056
026600 2000-INITIALIZATION.                                             02660056
026700********************************************************          02670056
026800                                                                  02680056
026900       MOVE FUNCTION CURRENT-DATE TO PV-CURR-TMST-DETAIL.         02690056
027000                                                                  02700056
027100       PERFORM 2100-FORMAT-ERR-REPORT-HEADER.                     02710056
027200                                                                  02720056
027300       PERFORM 3200-READ-INPUT-FILE.                              02730056
027400                                                                  02740056
027500       IF PS-END-OF-CR-BAL-RFND                                   02750056
027600           DISPLAY '***********************************'          02760056
027700           DISPLAY 'FROM ARKUT025: INPUT FILE IS EMPTY.'          02770056
027800           DISPLAY '***********************************'          02780056
027900       ELSE                                                       02790056
028000          PERFORM 2200-GET-FIRST-CHECK-NBR                        02800056
028100       END-IF.                                                    02810056
028300                                                                  02830056
028400********************************************************          02840056
028500 2100-FORMAT-ERR-REPORT-HEADER.                                   02850056
028600********************************************************          02860056
028700                                                                  02870056
028800       MOVE PV-CURR-TMST-CC          TO ER-CC.                    02880056
028900       MOVE PV-CURR-TMST-YY          TO DP132O-RUN-YEAR           02890056
029000                                        ER-YY.                    02900056
029100       MOVE PV-CURR-TMST-MM          TO DP132O-RUN-MONTH          02910056
029200                                        ER-MM.                    02920056
029300       MOVE PV-CURR-TMST-DD          TO DP132O-RUN-DAY            02930056
029400                                        ER-DD.                    02940056
029500                                                                  02950056
029600       MOVE PV-CURR-TMST-HOUR        TO DP132O-RUN-HOUR.          02960056
029700       MOVE PV-CURR-TMST-MIN         TO DP132O-RUN-MINUTE.        02970056
029800                                                                  02980056
029900       MOVE PC-PROGRAM-NAME          TO DP132O-PROGRAM-NAME.      02990056
030000                                                                  03000056
030100********************************************************          03010056
030200 2200-GET-FIRST-CHECK-NBR.                                        03020056
030300********************************************************          03030056
030400                                                                  03040056
030500       READ RESTART-CHECK-CARD-FILE INTO                          03050056
030600          RESTART-CHECK-CARD-LAYOUT.                              03060056
030700                                                                  03070056
030800*RESTART CONTROL CARD WILL BE ZEROES FOR THE INITIAL RUN          03080056
030900*IT WILL NOT BE ZEROES ONLY ON A CHECK RERUN                      03090056
031000       IF RESTART-FIRST-START-CHECK = ZEROES                      03100056
031100          READ FIRST-CHECK-CARD-FILE INTO                         03110056
031200             FIRST-CHECK-CARD-LAYOUT                              03120056
031300                                                                  03130056
031400          DISPLAY '------------------------------------'          03140056
031500          DISPLAY '         INITIAL CHECK RUN          '          03150056
031600          DISPLAY 'FIRST CHECK NBR USED: ' FIRST-CARD-CHECK-NBR   03160056
031700          DISPLAY '------------------------------------'          03170056
031710          MOVE 1                         TO PV-CHECK-SEQ-NBR      03171060
031800       ELSE                                                       03180056
031900          MOVE RESTART-FIRST-START-CHECK TO FIRST-CARD-CHECK-NBR  03190056
031910          MOVE RESTART-CK-SEQ-NBR        TO PV-CHECK-SEQ-NBR      03191061
032000          DISPLAY '------------------------------------'          03200056
032100          DISPLAY '            CHECK RERUN             '          03210056
032200          DISPLAY 'FIRST CHECK NBR USED: ' FIRST-CARD-CHECK-NBR   03220056
032300          DISPLAY '------------------------------------'          03230056
032400          PERFORM 2250-FIND-CR-BAL-RNFD-REC                       03240056
032500       END-IF.                                                    03250056
032600                                                                  03260056
032700       DISPLAY '------------------------------------'.            03270056
032800       DISPLAY '        ARKUT025 CNTL CARDS         '.            03280056
032900       DISPLAY 'RESTART CNTL CARD : ' RESTART-CHECK-CARD-LAYOUT.  03290056
033000       DISPLAY 'FIRST CK CNTL CARD: ' FIRST-CHECK-CARD-LAYOUT.    03300056
033100       DISPLAY '------------------------------------'.            03310056
033200                                                                  03320056
033300       IF FIRST-CARD-CHECK-NBR IS NOT NUMERIC OR                  03330056
033400          FIRST-CARD-CHECK-NBR = ZEROES                           03340056
033500          DISPLAY '***************************'                   03350056
033600          DISPLAY 'CHECK NUMBER ' FIRST-CARD-CHECK-NBR            03360056
033700                  ' IS INVALID'                                   03370056
033800          DISPLAY 'RUN ABORTED'                                   03380056
033900          DISPLAY '***************************'                   03390056
034000          MOVE 4003  TO PV-ABEND-CODE                             03400056
034100          PERFORM 9999-ABORT                                      03410056
034200       END-IF.                                                    03420056
034300                                                                  03430056
034500       MOVE FIRST-CARD-CHECK-NBR           TO AR062-CHECK-NBR.    03450056
034600                                                                  03460056
034700********************************************************          03470056
034800  2250-FIND-CR-BAL-RNFD-REC.                                      03480056
034900********************************************************          03490056
035000                                                                  03500056
035100       MOVE RESTART-FIRST-VOID-CHECK TO CRRFND-CK-NBR             03510056
035200                                                                  03520056
035300       PERFORM 7000-SELECT-CRRFND                                 03530056
035400                                                                  03540056
035500       MOVE CRRFND-ACCT-NBR TO PV-ACCOUNT-NBR-RED                 03550068
035600                                                                  03560056
035700       PERFORM                                                    03570056
035800          UNTIL PV-ACCOUNT-NBR = AR051-ACCOUNT-NBR OR             03580056
035900                PS-END-OF-CR-BAL-RFND                             03590056
036000          PERFORM 3200-READ-INPUT-FILE                            03600056
036100       END-PERFORM                                                03610056
036200                                                                  03620056
036300       IF PS-END-OF-CR-BAL-RFND                                   03630056
036400          DISPLAY '!!! COULD NOT FIND RESTART ACCT !!!'           03640056
036500          MOVE 4003  TO PV-ABEND-CODE                             03650056
036600          PERFORM 9999-ABORT                                      03660056
036700       END-IF.                                                    03670056
036800                                                                  03680056
036900********************************************************          03690056
037000 3000-PROCESS-CR-BAL-RNFD-CHKS.                                   03700056
037100********************************************************          03710056
037200                                                                  03720056
037300       SET PS-ERROR-NOT-FOUND TO TRUE.                            03730056
037400                                                                  03740056
037500       PERFORM 3100-EDIT-INPUT.                                   03750056
037600                                                                  03760056
037700       IF PS-ERROR-FOUND                                          03770056
037800          PERFORM 3300-WRITE-EXCEPTION-REPORT                     03780056
037900       ELSE                                                       03790056
038000          PERFORM 3400-PRINT-CHECKS                               03800056
038100          PERFORM 3500-LOAD-TCRRFND                               03810056
038200          PERFORM 7100-INSERT-CRRFND-ROW                          03820056
038300       END-IF.                                                    03830056
038400                                                                  03840056
038500       PERFORM 3200-READ-INPUT-FILE.                              03850056
038600                                                                  03860056
038700********************************************************          03870056
038800 3100-EDIT-INPUT.                                                 03880056
038900********************************************************          03890056
039000      IF AR051-REFUND-DUE-DATE IS NOT NUMERIC OR                  03900056
039100         AR051-REFUND-AMT      IS NOT NUMERIC OR                  03910056
039200         AR051-ACCOUNT-NBR     IS NOT NUMERIC                     03920056
039300         SET PS-ERROR-FOUND    TO TRUE                            03930056
039400      END-IF.                                                     03940056
039500                                                                  03950056
039600      IF AR051-CUST-NAME         = SPACES   OR                    03960056
039700         AR051-CUST-ADDR-LINE-1  = SPACES   OR                    03970056
039800         AR051-CUST-ADDR-LINE-2  = SPACES                         03980056
039900         SET PS-ERROR-FOUND      TO TRUE                          03990056
040000      END-IF.                                                     04000056
040100                                                                  04010056
040200*  FD SENDS THE AMOUNT AS POSITIVE, SO MAKE IT NEGAITVE           04020070
040300      IF AR051-REFUND-AMT  > 0                                    04030071
040400         COMPUTE AR051-REFUND-AMT = AR051-REFUND-AMT * -1         04030170
040600      END-IF.                                                     04030270
040601                                                                  04030370
040602      IF AR051-REFUND-AMT = ZEROES OR                             04031070
040603         AR051-REFUND-AMT  < PC-AMT-LIMIT                         04040056
040604         SET PS-ERROR-FOUND      TO TRUE                          04050056
040605      END-IF.                                                     04060056
040700                                                                  04070056
040800********************************************************          04080056
040900 3200-READ-INPUT-FILE.                                            04090056
041000********************************************************          04100056
041100       INITIALIZE AR051-CREDIT-BALANCE-RECORD.                    04110056
041200       READ CREDIT-BALANCE-FILE INTO AR051-CREDIT-BALANCE-RECORD  04120056
041300         AT END                                                   04130056
041400            SET PS-END-OF-CR-BAL-RFND TO TRUE                     04140056
041500       END-READ.                                                  04150056
041600                                                                  04160056
041700       IF NOT PS-END-OF-CR-BAL-RFND                               04170056
041800          ADD 1 TO PV-READ-COUNT                                  04180056
041900       END-IF.                                                    04190056
042000********************************************************          04200056
042100 3300-WRITE-EXCEPTION-REPORT.                                     04210056
042200********************************************************          04220056
042300      IF PV-EXC-LINE-COUNT > 60                                   04230056
042400         ADD  1                 TO PV-EXC-PAGE-COUNT              04240056
042500         MOVE PV-EXC-PAGE-COUNT                                   04250056
042600                                TO DP132O-PAGE-NUMBER             04260056
042700         MOVE 0                 TO PV-EXC-LINE-COUNT              04270056
042800         MOVE PC-EXC-REPORT-NBR TO DP132O-REPORT-NUMBER           04280056
042900         WRITE EXCEPTION-REPORT-RECORD FROM                       04290056
043000                              DP132O-STANDRD-HEADER-132-COLS      04300056
043100                AFTER ADVANCING PAGE                              04310056
043200         WRITE EXCEPTION-REPORT-RECORD FROM ER-HEADER-LINE-2      04320056
043300                AFTER ADVANCING 1 LINE                            04330056
043400         WRITE EXCEPTION-REPORT-RECORD FROM ER-HEADER-LINE-3      04340056
043500                AFTER ADVANCING 1 LINE                            04350056
043600         WRITE EXCEPTION-REPORT-RECORD FROM ER-HEADER-LINE-4      04360056
043700                AFTER ADVANCING 3 LINES                           04370056
043800         WRITE EXCEPTION-REPORT-RECORD FROM ER-HEADER-LINE-5      04380056
043900                AFTER ADVANCING 1 LINE                            04390056
044000         ADD  7                 TO PV-EXC-LINE-COUNT              04400056
044100      END-IF.                                                     04410056
044200                                                                  04420056
044300      ADD 1                         TO PV-EXC-LINE-COUNT          04430056
044400      MOVE AR051-ACCOUNT-NBR        TO ER-ACT-NUM                 04440056
044500      MOVE AR051-CUST-NAME          TO ER-CUSTOMER-NAME           04450056
044600      MOVE AR051-REFUND-AMT         TO ER-REFUND-AMT              04460056
044700                                                                  04470056
044800      MOVE AR051-CUST-ADDR-LINE-1   TO PV-ADDR-LINE1-HOLD         04480056
044900      MOVE AR051-CUST-ADDR-LINE-2   TO PV-ADDR-LINE2-HOLD         04490056
045000      MOVE AR051-CUST-ADDR-LINE-3   TO PV-ADDR-LINE3-HOLD         04500056
045100      MOVE AR051-CUST-ADDR-LINE-4   TO PV-ADDR-LINE4-HOLD         04510056
045200                                                                  04520056
045300      INITIALIZE ER-CUSTOMER-ADDRESS                              04530056
045400      STRING                                                      04540056
045500         PV-ADDR-LINE1-HOLD                                       04550056
045600         ' '                                                      04560056
045700         PV-ADDR-LINE2-HOLD                                       04570056
045800         ' '                                                      04580056
045900         PV-ADDR-LINE3-HOLD                                       04590056
046000         ' '                                                      04600056
046100         PV-ADDR-LINE4-HOLD                                       04610056
046200        DELIMITED BY SIZE                                         04620056
046300        INTO ER-CUSTOMER-ADDRESS                                  04630056
046400      END-STRING                                                  04640056
046500                                                                  04650056
046600      INITIALIZE ER-CUSTOMER-PHONE                                04660056
046700      STRING                                                      04670056
046800         AR051-AREA-CODE                                          04680056
046900         '-'                                                      04690056
047000         AR051-PHONE-CODE-1                                       04700056
047100         '-'                                                      04710056
047200         AR051-PHONE-CODE-2                                       04720056
047300        DELIMITED BY SIZE                                         04730056
047400        INTO ER-CUSTOMER-PHONE                                    04740056
047500      END-STRING                                                  04750056
047600                                                                  04760056
047700      WRITE EXCEPTION-REPORT-RECORD  FROM ER-DETAIL-LINE          04770056
047800             AFTER ADVANCING 1 LINE.                              04780056
047900                                                                  04790056
048000********************************************************          04800056
048100 3400-PRINT-CHECKS.                                               04810056
048200********************************************************          04820056
048300                                                                  04830056
048400      MOVE AR051-ACCOUNT-NBR        TO AR062-ACCOUNT-NBR.         04840056
048500                                                                  04850056
048600      MOVE ZEROES                   TO AR062-CHECK-DATE.          04860056
048700      STRING                                                      04870056
048800         PV-CURR-TMST-MM DELIMITED BY SIZE                        04880056
048900         PV-CURR-TMST-DD DELIMITED BY SIZE                        04890056
049000         PV-CURR-TMST-YY DELIMITED BY SIZE                        04900056
049100      INTO AR062-CHECK-DATE                                       04910056
049200      END-STRING.                                                 04920056
049300                                                                  04930056
049400      MOVE PC-AMT-DESC              TO AR062-DESCRIPTION.         04940056
049500      MOVE AR051-REFUND-AMT         TO AR062-CHECK-AMT-1          04950056
049600                                       AR062-CHECK-AMT-2          04960056
049700                                       AR062-TOTAL-CHECK-AMT.     04970056
049800      MOVE AR051-CUST-NAME          TO AR062-NAME-LINE.           04980056
049900      MOVE AR051-CUST-ADDR-LINE-1   TO AR062-ADDR-LINE-1.         04990056
050000      MOVE AR051-CUST-ADDR-LINE-2   TO AR062-ADDR-LINE-2.         05000056
050100      MOVE AR051-CUST-ADDR-LINE-3   TO AR062-ADDR-LINE-3.         05010056
050200      MOVE AR051-CUST-ADDR-LINE-4   TO AR062-ADDR-LINE-4.         05020056
050300                                                                  05030056
050400      INITIALIZE CA-COMMON-AREA.                                  05040056
050500      MOVE AR051-REFUND-AMT         TO CA-REFUND-AMT              05050056
050600      CALL 'ARKUT050' USING CA-COMMON-AREA.                       05060056
050700      MOVE CA-REFUND-IN-WORDS       TO AR062-CHECK-AMT-IN-WORDS.  05070056
050701      MOVE AR051-ENTITY-NBR         TO AR062-ENTITY-NBR.          05070163
050710      MOVE PV-CHECK-SEQ-NBR         TO AR062-CHECK-SEQ-NBR.       05071058
050800                                                                  05080056
050900      WRITE CHECK-RECORD      FROM  AR062-CHECK-DATA.             05090056
051000      ADD 1                         TO PV-WRITE-COUNT             05100056
051100                                       PV-GL-TR-UNITS             05110058
051110                                       PV-CHECK-SEQ-NBR.          05111058
051200                                                                  05120056
051300      ADD AR051-REFUND-AMT          TO PV-GL-TR-AMT.              05130056
051400                                                                  05140056
051500********************************************************          05150056
051600 3500-LOAD-TCRRFND.                                               05160056
051700********************************************************          05170056
051800                                                                  05180056
051900      MOVE SPACES                   TO CRRFND-CK-DTE.             05190056
052000      STRING                                                      05200056
052100          PV-CURR-TMST-CC DELIMITED BY SIZE                       05210056
052200          PV-CURR-TMST-YY DELIMITED BY SIZE                       05220056
052300          '-'             DELIMITED BY SIZE                       05230056
052400          PV-CURR-TMST-MM DELIMITED BY SIZE                       05240056
052500          '-'             DELIMITED BY SIZE                       05250056
052600          PV-CURR-TMST-DD DELIMITED BY SIZE                       05260056
052700        INTO CRRFND-CK-DTE                                        05270056
052800      END-STRING.                                                 05280056
052900                                                                  05290056
053000      MOVE AR062-CHECK-NBR          TO CRRFND-CK-NBR.             05300056
053100      MOVE ' '                      TO CRRFND-VOID-IND.           05310056
053200      MOVE AR051-ACCOUNT-NBR        TO PV-ACCOUNT-NBR.            05320056
053300      MOVE PV-ACCOUNT-NBR-RED       TO CRRFND-ACCT-NBR.           05330056
053400      MOVE AR051-CUST-NAME          TO CRRFND-CUST-NAME.          05340056
053500      MOVE AR051-CUST-ADDR-LINE-1   TO CRRFND-CUST-ADR-LNE1.      05350056
053600      MOVE AR051-CUST-ADDR-LINE-2   TO CRRFND-CUST-ADR-LNE2.      05360056
053700      MOVE AR051-CUST-ADDR-LINE-3   TO CRRFND-CUST-ADR-LNE3.      05370056
053800                                                                  05380056
053900      MOVE SPACES                   TO CRRFND-PHN-NBR.            05390056
054000      STRING                                                      05400056
054100          AR051-AREA-CODE    DELIMITED BY SIZE                    05410056
054200          '-'                DELIMITED BY SIZE                    05420056
054300          AR051-PHONE-CODE-1 DELIMITED BY SIZE                    05430056
054400          '-'                DELIMITED BY SIZE                    05440056
054500          AR051-PHONE-CODE-2 DELIMITED BY SIZE                    05450056
054600        INTO CRRFND-PHN-NBR                                       05460056
054700      END-STRING.                                                 05470056
054800                                                                  05480056
054900      IF AR051-PH-VALIDITY-CODE = 'X' OR 'C'                      05490065
054901          MOVE 'N'                  TO CRRFND-PHN-VALID-CDE       05491065
054902      ELSE                                                        05491165
054903      IF AR051-PH-VALIDITY-CODE = 'U'                             05491265
054904          MOVE 'P'                  TO CRRFND-PHN-VALID-CDE       05491365
054905      ELSE                                                        05491465
054906      IF AR051-PH-VALIDITY-CODE = 'N' OR 'E'                      05491565
054907          MOVE 'W'                  TO CRRFND-PHN-VALID-CDE       05491665
054908      ELSE                                                        05491765
054909      IF AR051-PH-VALIDITY-CODE = 'D'                             05491865
054910          MOVE 'D'                  TO CRRFND-PHN-VALID-CDE       05491965
054911      ELSE                                                        05492065
054912      IF AR051-PH-VALIDITY-CODE = 'Y'                             05492165
054913          MOVE ' '                  TO CRRFND-PHN-VALID-CDE       05492265
054914      ELSE                                                        05492365
054915          MOVE ' '                  TO CRRFND-PHN-VALID-CDE       05492465
054916      END-IF                                                      05492565
054917      END-IF                                                      05492665
054918      END-IF                                                      05492765
054919      END-IF                                                      05492865
054920      END-IF.                                                     05492965
054930                                                                  05493065
054931                                                                  05493165
054932*     MOVE AR051-PH-VALIDITY-CODE   TO CRRFND-PHN-VALID-CDE.      05494065
055000      MOVE AR051-REFUND-AMT         TO CRRFND-RFND-AMT.           05500056
055100      MOVE AR051-STAFF-FLAG         TO CRRFND-STAFF-IND.          05510056
055200                                                                  05520056
055300      MOVE SPACES                   TO CRRFND-RFND-DUE-DTE.       05530056
055400      STRING                                                      05540056
055500         AR051-REFUND-DUE-YYYY DELIMITED BY SIZE                  05550056
055600         '-'                   DELIMITED BY SIZE                  05560056
055700         AR051-REFUND-DUE-MM   DELIMITED BY SIZE                  05570056
055800         '-'                   DELIMITED BY SIZE                  05580056
055900         AR051-REFUND-DUE-DD   DELIMITED BY SIZE                  05590056
056000      INTO CRRFND-RFND-DUE-DTE                                    05600056
056100      END-STRING.                                                 05610056
056200                                                                  05620056
056300      ADD 1                         TO AR062-CHECK-NBR.           05630056
056400                                                                  05640056
056500********************************************************          05650056
056600 4000-CREATE-CR-BAL-GL.                                           05660056
056700********************************************************          05670056
056800     MOVE 1                    TO AR030-GL-TR-ENTRY-NBR           05680056
056900                                  AR030-GL-TR-ENTRY-SEQ-NBR.      05690056
057000     MOVE ZEROES               TO AR030-TR-COMPANY.               05700056
057100     MOVE ZEROES               TO AR030-TR-DIVISION.              05710056
057200     MOVE 880                  TO AR030-TR-DEPARTMENT.            05720056
057300     MOVE '0000010102'         TO AR030-TR-ACCOUNT.               05730056
057400     MOVE PV-GL-TR-AMT         TO AR030-GL-TR-AMT.                05740056
057500     MOVE PV-GL-TR-UNITS       TO AR030-GL-TR-UNITS.              05750056
057600     MOVE PV-CURR-DATE         TO AR030-GL-TR-APPLY-DATE          05760056
057610                                  AR030-GL-TR-THRU-DATE.          05761056
057620     MOVE SPACES               TO PV-GL-CR-REFUND-DATE.           05762056
057630     STRING                                                       05763056
057640        PV-CURR-TMST-MM DELIMITED BY SIZE                         05764056
057650        '/'             DELIMITED BY SIZE                         05765056
057660        PV-CURR-TMST-DD DELIMITED BY SIZE                         05766056
057670        '/'             DELIMITED BY SIZE                         05767056
057680        PV-CURR-TMST-YY DELIMITED BY SIZE                         05768056
057690     INTO PV-GL-CR-REFUND-DATE                                    05769056
057700     END-STRING.                                                  05770056
057701                                                                  05770156
057702     MOVE PV-GL-CR-REFUND-DESC TO AR030-GL-TR-DESCRIPTION.        05770256
057703     MOVE SPACES               TO AR030-GL-TR-SUB-SYSTEM-KEYS.    05770356
057704                                                                  05770456
057705     WRITE CREDIT-BALANCE-GL-RECORD                               05770556
057706        FROM AR030-SELECT-GL-UPDATE-RECORD.                       05770656
057707                                                                  05770756
057708     ADD 1                     TO AR030-GL-TR-ENTRY-SEQ-NBR.      05770856
057709     MOVE '0000020116'         TO AR030-TR-ACCOUNT.               05770956
057710     MULTIPLY PV-GL-TR-AMT BY -1                                  05771056
057711        GIVING AR030-GL-TR-AMT.                                   05771156
057712                                                                  05771256
057713     WRITE CREDIT-BALANCE-GL-RECORD                               05771356
057714        FROM AR030-SELECT-GL-UPDATE-RECORD.                       05771456
057715********************************************************          05771556
057716 5000-END-PGM.                                                    05771656
057717********************************************************          05771756
057718                                                                  05771856
057719     CLOSE  CREDIT-BALANCE-FILE                                   05771956
057720            CREDIT-BALANCE-GL-FILE                                05772056
057721            FIRST-CHECK-CARD-FILE                                 05772156
057722            RESTART-CHECK-CARD-FILE                               05772256
057723            CHECK-FILE                                            05772356
057724            EXCEPTION-REPORT-FILE.                                05772456
057725                                                                  05772556
057726     DISPLAY '------------------------------------'.              05772656
057727     DISPLAY 'RECORDS READ   : ' PV-READ-COUNT.                   05772756
057728     DISPLAY 'RECORDS WRITTEN: ' PV-WRITE-COUNT.                  05772856
057729     DISPLAY 'ROWS INSERTED  : ' PV-INSERT-COUNT.                 05772956
057730     DISPLAY '------------------------------------'.              05773056
057731                                                                  05773156
057732********************************************************          05773256
057733 7000-SELECT-CRRFND.                                              05773356
057734********************************************************          05773456
057735      EXEC SQL                                                    05773556
057736           SELECT                                                 05773656
057737              ACCT_NBR                                            05773756
057738           INTO                                                   05773856
057739              :CRRFND-ACCT-NBR                                    05773956
057740           FROM TCRRFND                                           05774056
057750           WHERE CK_NBR = :CRRFND-CK-NBR                          05775056
057760      END-EXEC.                                                   05776056
057770                                                                  05777056
057780      EVALUATE TRUE                                               05778056
057790         WHEN SQLCODE = ZERO                                      05779056
057800              CONTINUE                                            05780056
057900         WHEN OTHER                                               05790056
058000               MOVE '7000-SELECT-TCRRFND' TO PV-ABEND-PARA-NAME   05800056
058100               MOVE 'SELECT '            TO PV-DB2-OPERATION-MSG-105810056
058200               MOVE 'TCRRFND'             TO PV-DB2-TABLE-NAME    05820056
058300               PERFORM 9998-SQL-ABEND                             05830056
058400      END-EVALUATE.                                               05840056
058500                                                                  05850056
058600********************************************************          05860056
058700 7100-INSERT-CRRFND-ROW.                                          05870056
058800********************************************************          05880056
058900      EXEC SQL                                                    05890056
059000           INSERT INTO TCRRFND                                    05900056
059100          ( CK_NBR                                                05910056
059200           ,CK_DTE                                                05920056
059300           ,VOID_IND                                              05930056
059400           ,ACCT_NBR                                              05940056
059500           ,CUST_NAME                                             05950056
059600           ,CUST_ADR_LNE1                                         05960056
059700           ,CUST_ADR_LNE2                                         05970056
059800           ,CUST_ADR_LNE3                                         05980056
059900           ,PHN_NBR                                               05990056
060000           ,PHN_VALID_CDE                                         06000056
060100           ,RFND_AMT                                              06010056
060200           ,STAFF_IND                                             06020056
060300           ,RFND_DUE_DTE                                          06030056
060400           ,PRCD_CDE)                                             06040056
060500           VALUES                                                 06050056
060600            ( :CRRFND-CK-NBR                                      06060056
060700             ,:CRRFND-CK-DTE                                      06070056
060800             ,:CRRFND-VOID-IND                                    06080056
060900             ,:CRRFND-ACCT-NBR                                    06090056
061000             ,:CRRFND-CUST-NAME                                   06100056
061100             ,:CRRFND-CUST-ADR-LNE1                               06110056
061200             ,:CRRFND-CUST-ADR-LNE2                               06120056
061300             ,:CRRFND-CUST-ADR-LNE3                               06130056
061400             ,:CRRFND-PHN-NBR                                     06140056
061500             ,:CRRFND-PHN-VALID-CDE                               06150056
061600             ,:CRRFND-RFND-AMT                                    06160056
061700             ,:CRRFND-STAFF-IND                                   06170056
061800             ,:CRRFND-RFND-DUE-DTE                                06180056
061900             ,:CRRFND-PRCD-CDE)                                   06190056
062000      END-EXEC.                                                   06200056
062100                                                                  06210056
062200      EVALUATE TRUE                                               06220056
062300         WHEN SQLCODE = ZERO                                      06230056
062400              ADD 1 TO PV-INSERT-COUNT                            06240056
062500         WHEN OTHER                                               06250056
062600               MOVE '7100-INSERT-CRRFND-ROW' TO PV-ABEND-PARA-NAME06260056
062700               MOVE 'INSERT '            TO PV-DB2-OPERATION-MSG-106270056
062800               MOVE 'TCRRFND'                TO PV-DB2-TABLE-NAME 06280056
062900               PERFORM 9998-SQL-ABEND                             06290056
063000      END-EVALUATE.                                               06300056
063100                                                                  06310056
063200********************************************************          06320056
063300 9998-SQL-ABEND.                                                  06330056
063400********************************************************          06340056
063500     MOVE SQLCODE     TO PV-SQLCODE.                              06350056
063600     DISPLAY '** ABEND           ** = SQLABEND'.                  06360056
063700     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          06370056
063800     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        06380056
063900     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        06390056
064000     DISPLAY '** CHECK NBR       ** = ' CRRFND-CK-NBR.            06400056
064010     DISPLAY '** CHECK SEQ NBR   ** = ' PV-CHECK-SEQ-NBR.         06401059
064100     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   06410056
064200     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               06420056
064300     COPY DPPD004.                                                06430056
064400                                                                  06440056
064500     EXEC SQL                                                     06450056
064600          ROLLBACK                                                06460056
064700     END-EXEC.                                                    06470056
064800                                                                  06480056
064900     MOVE +4013                  TO PV-ABEND-CODE.                06490056
065000     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       06500072
065100                                                                  06510056
065200********************************************************          06520056
065300 9999-ABORT.                                                      06530056
065400********************************************************          06540056
065500      DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE.                   06550056
065600      CALL 'ILBOABN0'   USING PV-ABEND-CODE.                      06560056
065700                                                                  06570056
