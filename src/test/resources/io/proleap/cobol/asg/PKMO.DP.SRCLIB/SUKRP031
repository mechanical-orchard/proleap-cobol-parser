000100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP031.                                00050000
000600 AUTHOR.                 LYNN MCADAMS.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            AUGUST, 2002.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100*---------------------------------------------------------------- 00110000
001200*  THIS PROGRAM WILL PRODUCE A REPORT OF THE MANIFESTED CARTON    00120000
001300*  EXCEPTIONS - UNITS VERIFIED VERSUS UNITS MANIFESTED TO CARTONS 00130000
001400*                                                                 00140000
001500*  THE REPORT WILL BREAK AT DC LOCATION, PO/RECEIVER/LINE.        00150000
001600*---------------------------------------------------------------- 00160000
000098*  CHANGED 10/14/14 BY CHERI PARMLEY                            * 00161002
000099*   CHG#0098147 EXPAND PO# FROM 7 TO 8 DIGITS                   * 00162004
001700*                                                                 00170000
001800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00200000
002100                                                                  00210000
002200 CONFIGURATION SECTION.                                           00220000
002300                                                                  00230000
002400 SOURCE-COMPUTER.        IBM-3090.                                00240000
002500 OBJECT-COMPUTER.        IBM-3090.                                00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800                                                                  00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100     SELECT PO-FILE       ASSIGN TO INP01.                        00310000
003200     SELECT REPORT-FILE   ASSIGN TO RPT01.                        00320000
003300                                                                  00330000
003400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00340000
003500 DATA DIVISION.                                                   00350000
003600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00360000
003700                                                                  00370000
003800 FILE SECTION.                                                    00380000
003900                                                                  00390000
004000 FD  PO-FILE                                                      00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     BLOCK CONTAINS 0 RECORDS.                                    00430000
004400 01  PO-RECORD                       PIC X(300).                  00440000
004500*                                                                 00450000
004600 FD  REPORT-FILE                                                  00460000
004700     RECORDING MODE IS F                                          00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     BLOCK CONTAINS 0 RECORDS.                                    00490000
005000 01  REPORT-RECORD                   PIC X(132).                  00500000
005100*                                                                 00510000
005200*                                                                 00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400 01  PROGRAM-SWITCHES.                                            00540000
005500     05  PS-FIRST-TIME-SW                PIC X(01) VALUE 'N'.     00550000
005600         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00560000
005700         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00570000
005800     05  PS-END-OF-PO-FILE-SWITCH    PIC  X(01)    VALUE 'N'.     00580000
005900         88  PS-END-OF-PO-FILE                     VALUE 'Y'.     00590000
006000     05  PS-NEW-PAGE-SW              PIC  X(03)    VALUE 'N'.     00600000
006100         88  PS-NEW-PAGE                           VALUE 'Y'.     00610000
006200         88  PS-NOT-NEW-PAGE                       VALUE 'N'.     00620000
006300     05  PS-SKIP-LINE-SW             PIC  X(03)    VALUE 'N'.     00630000
006400         88  PS-SKIP-LINE                          VALUE 'Y'.     00640000
006500         88  PS-NO-SKIP-LINE                       VALUE 'N'.     00650000
006600     05  PS-LOC-FOUND-SW             PIC  X(03)    VALUE 'N'.     00660000
006700         88  PS-LOC-FOUND                          VALUE 'Y'.     00670000
006800         88  PS-LOC-NOT-FOUND                      VALUE 'N'.     00680000
006900                                                                  00690000
007000 01  DK-DB-KEYS.                                                  00700000
007100     05  DK-PO-NBR                   PIC S9(09) COMP.             00710000
007200     05  DK-REC-SEQ-NBR              PIC S9(09) COMP.             00720000
007300     05  DK-LINE-NBR                 PIC S9(09) COMP.             00730000
007400     05  DK-LINE-ITEM                PIC S9(15)V COMP-3.          00740000
007500     05  DK-OPER-UNT-ID              PIC S9(04) COMP.             00750000
007600     05  DK-SHIPT-UNT-ID             PIC S9(18)V COMP-3.          00760000
007700                                                                  00770000
007800 01  PC-CONSTANTS.                                                00780000
007900     05  PC-1                        PIC S9(03)    VALUE +1       00790000
008000                                                   COMP-3.        00800000
008100     05  PC-MAX-REPORT-LINES         PIC S9(3) COMP-3 VALUE +60.  00810000
008200     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     00820000
008300     05  PC-COLON                    PIC  X(01)    VALUE ':'.     00830000
008400     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     00840000
008500     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00850000
008600         'SUKRP031'.                                              00860000
008700     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00870000
008800     05  PC-INNER-PREPACK          PIC  X(06)  VALUE 'INPRPK'.    00880000
008900     05  PC-MULTI-SKU              PIC  X(06)  VALUE 'MLTSKU'.    00890000
009000     05  PC-SINGLE-SKU             PIC  X(06)  VALUE 'SGLSKU'.    00900000
009100     05  PC-CASEPACK               PIC  X(06)  VALUE 'CASEPK'.    00910000
009200     05  PC-BULK                   PIC  X(06)  VALUE 'BULK  '.    00920000
009300     05  PC-PBS                    PIC  X(06)  VALUE 'PBS   '.    00930000
009400     05  PC-MANUAL                 PIC  X(07)  VALUE 'MANUAL '.   00940000
009500     05  PC-FCS-P2L                PIC  X(07)  VALUE 'FCS&P2L'.   00950000
009600     05  PC-P2L                    PIC  X(07)  VALUE 'P2L    '.   00960000
009700     05  PC-FCSE                   PIC  X(07)  VALUE 'FCSE   '.   00970000
009800     05  PC-CM                     PIC  X(02)  VALUE 'CM'.        00980000
009900     05  PC-ASN                    PIC  X(03)  VALUE 'ASN'.       00990000
010000     05  PC-CKN                    PIC  X(03)  VALUE 'CKN'.       01000000
010100     05  PC-DC                     PIC  X(02)  VALUE 'DC'.        01010000
010200                                                                  01020000
010300 01  PC-BLANK-LINE                 PIC X(132)    VALUE SPACE.     01030000
010400                                                                  01040000
010500 01 PV-VARIABLES.                                                 01050000
010600     05  PV-READ-COUNTER              PIC S9(09) VALUE ZERO       01060000
010700                                                  COMP SYNC.      01070000
010800     05  PV-FETCH-COUNTER             PIC S9(09) VALUE ZERO       01080000
010900                                                  COMP SYNC.      01090000
011000     05  PV-WRITE-COUNTER             PIC S9(09) VALUE ZERO       01100000
011100                                                  COMP SYNC.      01110000
011200     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            01120000
011300     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     01130000
011400                                                   COMP-3.        01140000
011500     05  PV-LINE-COUNT               PIC S9(03)   VALUE ZERO      01150000
011600                                                  COMP-3.         01160000
011700     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       01170000
011800     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01180000
011900                                                 COMP SYNC.       01190000
012000     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01200000
012100     05  PV-ABEND-OPERATION1          PIC  X(51) VALUE SPACES.    01210000
012200     05  PV-ABEND-OPERATION2          PIC  X(51) VALUE SPACES.    01220000
012300     05  PV-DB2-TABLE-NAME            PIC X(12)     VALUE SPACES. 01230000
012400                                                                  01240000
012500                                                                  01250000
012600     05  PV-CURR-OPER-UNT-ID             PIC  S9(4) COMP          01260000
012700                                                    VALUE ZERO.   01270000
012800     05  PV-PREV-OPER-UNT-ID             PIC  9(03) VALUE ZERO.   01280000
012900***                                                               01290000
013000     05  PV-CURR-PO-NBR                  PIC  X(09) VALUE SPACE.  01300000
013100     05  PV-PREV-PO-NBR                  PIC  X(09) VALUE SPACE.  01310000
013200                                                                  01320000
013300     05  PV-DASH                         PIC  X(01) VALUE '-'.    01330000
013400                                                                  01340000
013500     05  PV-CURR-REC-SEQ-NBR             PIC  X(09) VALUE SPACE.  01350000
013600     05  PV-PREV-REC-SEQ-NBR             PIC  X(09) VALUE SPACE.  01360000
013700                                                                  01370000
013800     05  PV-CURR-LINE-STATUS             PIC  X(02) VALUE SPACE.  01380000
013900     05  PV-PREV-LINE-STATUS             PIC  X(02) VALUE SPACE.  01390000
014000                                                                  01400000
014100     05  PV-CURR-VRFD-DATE.                                       01410000
014200         10   PV-CURR-VF-CC             PIC X(02)   VALUE SPACE.  01420000
014300         10   PV-CURR-VF-YY             PIC X(02)   VALUE SPACE.  01430000
014400         10   FILLER                    PIC X(01)   VALUE SPACE.  01440000
014500         10   PV-CURR-VF-MM             PIC X(02)   VALUE SPACE.  01450000
014600         10   FILLER                    PIC X(01)   VALUE SPACE.  01460000
014700         10   PV-CURR-VF-DD             PIC X(02)   VALUE SPACE.  01470000
014800         10   FILLER                    PIC X(01)   VALUE SPACE.  01480000
014900         10   PV-CURR-VF-HRS            PIC X(02)   VALUE SPACE.  01490000
015000         10   FILLER                    PIC X(01)   VALUE SPACE.  01500000
015100         10   PV-CURR-VF-MIN            PIC X(02)   VALUE SPACE.  01510000
015200     05  PV-PREV-VRFD-DATE.                                       01520000
015300         10   PV-PREV-VF-CC             PIC X(02)   VALUE SPACE.  01530000
015400         10   PV-PREV-VF-YY             PIC X(02)   VALUE SPACE.  01540000
015500         10   FILLER                    PIC X(01)   VALUE SPACE.  01550000
015600         10   PV-PREV-VF-MM             PIC X(02)   VALUE SPACE.  01560000
015700         10   FILLER                    PIC X(01)   VALUE SPACE.  01570000
015800         10   PV-PREV-VF-DD             PIC X(02)   VALUE SPACE.  01580000
015900         10   FILLER                    PIC X(01)   VALUE SPACE.  01590000
016000         10   PV-PREV-VF-HRS            PIC X(02)   VALUE SPACE.  01600000
016100         10   FILLER                    PIC X(01)   VALUE SPACE.  01610000
016200         10   PV-PREV-VF-MIN            PIC X(02)   VALUE SPACE.  01620000
016300                                                                  01630000
016400     05  PV-CURR-LINE-NBR                PIC  X(09) VALUE SPACE.  01640000
016500     05  PV-PREV-LINE-NBR                PIC  X(09) VALUE SPACE.  01650000
016600                                                                  01660000
016700     05  PV-CURR-VRFD-SRC                PIC  X(02) VALUE SPACE.  01670000
016800     05  PV-PREV-VRFD-SRC                PIC  X(02) VALUE SPACE.  01680000
016900                                                                  01690000
017000     05  PV-CURR-VRFD-AREA               PIC  X(06) VALUE SPACE.  01700000
017100     05  PV-PREV-VRFD-AREA               PIC  X(06) VALUE SPACE.  01710000
017200                                                                  01720000
017300     05  PV-CURR-VRFD-UNT                PIC  X(09) VALUE SPACE.  01730000
017400     05  PV-PREV-VRFD-UNT                PIC  X(09) VALUE SPACE.  01740000
017500                                                                  01750000
017600     05  PV-CURR-MFST-SRC                PIC  X(03) VALUE SPACE.  01760000
017700     05  PV-PREV-MFST-SRC                PIC  X(03) VALUE SPACE.  01770000
017800                                                                  01780000
017900     05  PV-CURR-MFST-UNT                PIC  X(09) VALUE SPACE.  01790000
018000     05  PV-PREV-MFST-UNT                PIC  X(09) VALUE SPACE.  01800000
018100                                                                  01810000
018200     05  PV-CURR-MFST-CTN                PIC  X(09) VALUE SPACE.  01820000
018300     05  PV-PREV-MFST-CTN                PIC  X(09) VALUE SPACE.  01830000
018400***                                                               01840000
018500     05  PV-VRFD-SOURCE                    PIC  X(02).            01850000
018600                                                                  01860000
018700     05  PV-DB2-TIMESTAMP               PIC X(26)   VALUE SPACES. 01870000
018800     05  PV-TMST-R REDEFINES  PV-DB2-TIMESTAMP.                   01880000
018900         10   PV-TMST-CC                PIC X(02).                01890000
019000         10   PV-TMST-YY                PIC X(02).                01900000
019100         10   FILLER                    PIC X(01).                01910000
019200         10   PV-TMST-MM                PIC X(02).                01920000
019300         10   FILLER                    PIC X(01).                01930000
019400         10   PV-TMST-DD                PIC X(02).                01940000
019500         10   FILLER                    PIC X(01).                01950000
019600         10   PV-TMST-HRS               PIC X(02).                01960000
019700         10   FILLER                    PIC X(01).                01970000
019800         10   PV-TMST-MIN               PIC X(02).                01980000
019900         10   FILLER                    PIC X(01).                01990000
020000         10   PV-TMST-SEC               PIC X(02).                02000000
020100         10   FILLER                    PIC X(07).                02010000
020200                                                                  02020000
020300     05  PV-VERIFD-UNITS             PIC  9(04).                  02030000
020400     05  PV-VERIFD-UNITS-X REDEFINES PV-VERIFD-UNITS              02040000
020500                                     PIC  X(04).                  02050000
020600                                                                  02060000
020700 01  PV-CONTROL-KEYS.                                             02070000
020800                                                                  02080000
020900     05  SD-SYSTEM-DATE.                                          02090000
021000         10  SD-SYSTEM-DATE-YY       PIC  9(02)    VALUE ZERO.    02100000
021100         10  SD-SYSTEM-DATE-MM       PIC  9(02)    VALUE ZERO.    02110000
021200         10  SD-SYSTEM-DATE-DD       PIC  9(02)    VALUE ZERO.    02120000
021300     05  ST-SYSTEM-TIME.                                          02130000
021400         10  ST-SYSTEM-HOUR          PIC  9(02)    VALUE ZERO.    02140000
021500         10  ST-SYSTEM-MINUTE        PIC  9(02)    VALUE ZERO.    02150000
021600         10  ST-SYSTEM-SECOND        PIC  9(02)    VALUE ZERO.    02160000
021700         10  FILLER                  PIC  9(02)    VALUE ZERO.    02170000
021800                                                                  02180000
021900 EJECT                                                            02190000
022000                                                                  02200000
022100*-----------------------------------------------------------------02210000
022200* COMMAREA FOR XLKUT071 - LOCATION MODULE                         02220000
022300*-----------------------------------------------------------------02230000
022400     COPY XLWS071.                                                02240000
022500                                                                  02250000
022600*-----------------------------------------------------------------02260000
022700*  STANDARD REPORT HEADER FOR 132 COLUMN REPORT.                  02270000
022800*-----------------------------------------------------------------02280000
022900     COPY DPWS132O.                                               02290000
023000                                                                  02300000
023100*-----------------------------------------------------------------02310000
023200*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               02320000
023300*-----------------------------------------------------------------02330000
023400     COPY XLWS001.                                                02340000
023500                                                                  02350000
023600***************************************************************** 02360000
023700*  RECORD LAYOUT FOR THE CARTON EXCEPTION EXTRACT FILE            02370000
023800***************************************************************** 02380000
023900     COPY SURD036.                                                02390000
024000                                                                  02400000
024100*MAIN HEADING                                                     02410000
024200 01  HL-HEADING-LINE-1.                                           02420000
024300     05  FILLER                  PIC  X(51)    VALUE SPACE.       02430000
024400     05  FILLER                  PIC  X(34)    VALUE              02440000
024500         'MANIFESTED CARTON EXCEPTION REPORT'.                    02450000
024600     05  FILLER                  PIC  X(47)    VALUE SPACE.       02460000
024700                                                                  02470000
024800 01  HL-HEADING-LINE-2.                                           02480000
024900     05  FILLER                  PIC  X(37)    VALUE SPACE.       02490000
025000     05  FILLER                  PIC  X(48)    VALUE              02500000
025100         'UNITS VERIFIED/COMPLETED VERSUS UNITS MANIFESTED'.      02510000
025200     05  FILLER                  PIC  X(11)    VALUE              02520000
025300         ' TO CARTONS'.                                           02530000
025400     05  FILLER                  PIC  X(36)    VALUE SPACE.       02540000
025500                                                                  02550000
025600 01  HL-HEADING-LINE-3.                                           02560000
025700     05  FILLER                  PIC  X(01)    VALUE SPACE.       02570000
025800     05  FILLER                  PIC  X(08)    VALUE              02580000
025900         'OPER ID:'.                                              02590000
026000     05  FILLER                  PIC  X(01)    VALUE SPACE.       02600000
026100     05  HL3-DC-OPER-UNT         PIC  9(04)    VALUE ZERO.        02610000
026200     05  FILLER                  PIC  X(02)    VALUE SPACE.       02620000
026300     05  HL3-DC-NAME             PIC  X(25)    VALUE ZERO.        02630000
026400     05  FILLER                  PIC  X(91)    VALUE SPACE.       02640000
026500                                                                  02650000
026600 01  HL-HEADING-LINE-4.                                           02660000
026700     05  FILLER                  PIC  X(74)    VALUE SPACE.       02670000
026800     05  FILLER                  PIC  X(08)    VALUE              02680000
026900         'TOT CTNS'.                                              02690000
027000     05  FILLER                  PIC  X(50)    VALUE SPACE.       02700000
027100                                                                  02710000
027200 01  HL-HEADING-LINE-5.                                           02720000
027300     05  FILLER                  PIC  X(14)    VALUE SPACE.       02730000
027400     05  FILLER                  PIC  X(18)    VALUE              02740000
027500         'VERFD/COMPL STATUS'.                                    02750000
027600     05  FILLER                  PIC  X(03)    VALUE SPACE.       02760000
027700     05  FILLER                  PIC  X(04)    VALUE              02770000
027800         'LINE'.                                                  02780000
027900     05  FILLER                  PIC  X(03)    VALUE SPACE.       02790000
028000     05  FILLER                  PIC  X(03)    VALUE              02800000
028100         'SKU'.                                                   02810000
028200     05  FILLER                  PIC  X(05)    VALUE SPACE.       02820000
028300     05  FILLER                  PIC  X(05)    VALUE              02830000
028400         'UNITS'.                                                 02840000
028500     05  FILLER                  PIC  X(03)    VALUE SPACE.       02850000
028600     05  FILLER                  PIC  X(05)    VALUE              02860000
028700         'UNITS'.                                                 02870000
028800     05  FILLER                  PIC  X(04)    VALUE SPACE.       02880000
028900     05  FILLER                  PIC  X(04)    VALUE              02890000
029000         'UNIT'.                                                  02900000
029100     05  FILLER                  PIC  X(05)    VALUE SPACE.       02910000
029200     05  FILLER                  PIC  X(04)    VALUE              02920000
029300         'WITH'.                                                  02930000
029400     05  FILLER                  PIC  X(02)    VALUE SPACE.       02940000
029500     05  FILLER                  PIC  X(03)    VALUE              02950000
029600         'PKG'.                                                   02960000
029700     05  FILLER                  PIC  X(05)    VALUE SPACE.       02970000
029800     05  FILLER                  PIC  X(18)    VALUE              02980000
029900         'VERIFIED/COMPLETED'.                                    02990000
030000     05  FILLER                  PIC  X(06)    VALUE SPACE.       03000000
030100     05  FILLER                  PIC  X(10)    VALUE              03010000
030200         'MANIFESTED'.                                            03020000
030300     05  FILLER                  PIC  X(08)    VALUE SPACE.       03030000
030400                                                                  03040000
030500 01  HL-HEADING-LINE-6.                                           03050000
030600     05  FILLER                  PIC  X(01)    VALUE SPACE.       03060000
      *CLP 10/14/14                                                     03061002
030700     05  FILLER                  PIC  X(12)    VALUE              03070002
030800         'PO/RECEIVER '.                                          03080002
030900     05  FILLER                  PIC  X(01)    VALUE SPACE.       03090002
031000     05  FILLER                  PIC  X(02)    VALUE              03100000
031100         'CD'.                                                    03110000
031200     05  FILLER                  PIC  X(04)    VALUE SPACE.       03120000
031300     05  FILLER                  PIC  X(04)    VALUE              03130000
031400         'DATE'.                                                  03140000
031500     05  FILLER                  PIC  X(04)    VALUE SPACE.       03150000
031600     05  FILLER                  PIC  X(04)    VALUE              03160000
031700         'TIME'.                                                  03170000
031800     05  FILLER                  PIC  X(03)    VALUE SPACE.       03180000
031900     05  FILLER                  PIC  X(03)    VALUE              03190000
032000         'NBR'.                                                   03200000
032100     05  FILLER                  PIC  X(03)    VALUE SPACE.       03210000
032200     05  FILLER                  PIC  X(06)    VALUE              03220000
032300         'NUMBER'.                                                03230000
032400     05  FILLER                  PIC  X(03)    VALUE SPACE.       03240000
032500     05  FILLER                  PIC  X(05)    VALUE              03250000
032600         'VE/CM'.                                                 03260000
032700     05  FILLER                  PIC  X(03)    VALUE SPACE.       03270000
032800     05  FILLER                  PIC  X(06)    VALUE              03280000
032900         'MANIFD'.                                                03290000
033000     05  FILLER                  PIC  X(02)    VALUE SPACE.       03300000
033100     05  FILLER                  PIC  X(08)    VALUE              03310000
033200         'VARIANCE'.                                              03320000
033300     05  FILLER                  PIC  X(02)    VALUE SPACE.       03330000
033400     05  FILLER                  PIC  X(04)    VALUE              03340000
033500         'LINE'.                                                  03350000
033600     05  FILLER                  PIC  X(02)    VALUE SPACE.       03360000
033700     05  FILLER                  PIC  X(04)    VALUE              03370000
033800         'TYPE'.                                                  03380000
033900     05  FILLER                  PIC  X(04)    VALUE SPACE.       03390000
034000     05  FILLER                  PIC  X(03)    VALUE              03400000
034100         'SRC'.                                                   03410000
034200     05  FILLER                  PIC  X(03)    VALUE SPACE.       03420000
034300     05  FILLER                  PIC  X(04)    VALUE              03430000
034400         'AREA'.                                                  03440000
034500     05  FILLER                  PIC  X(02)    VALUE SPACE.       03450000
034600     05  FILLER                  PIC  X(05)    VALUE              03460000
034700         'UNITS'.                                                 03470000
034800     05  FILLER                  PIC  X(05)    VALUE SPACE.       03480000
034900     05  FILLER                  PIC  X(03)    VALUE              03490000
035000         'SRC'.                                                   03500000
035100     05  FILLER                  PIC  X(02)    VALUE SPACE.       03510000
035200     05  FILLER                  PIC  X(05)    VALUE              03520000
035300         'UNITS'.                                                 03530000
035400     05  FILLER                  PIC  X(02)    VALUE SPACE.       03540000
035500     05  FILLER                  PIC  X(04)    VALUE              03550000
035600         'CTNS'.                                                  03560000
035700     05  FILLER                  PIC  X(04)    VALUE SPACE.       03570000
035800                                                                  03580000
035900 01  HL-HEADING-LINE-7.                                           03590000
036000     05  FILLER                  PIC  X(14)    VALUE SPACE.       03600000
036100     05  FILLER                  PIC  X(20)    VALUE              03610000
036200         '-------------------'.                                   03620000
036300     05  FILLER                  PIC  X(56)    VALUE SPACE.       03630000
036400     05  FILLER                  PIC  X(18)    VALUE              03640000
036500         '------------------'.                                    03650000
036600     05  FILLER                  PIC  X(04)    VALUE SPACE.       03660000
036700     05  FILLER                  PIC  X(16)    VALUE              03670000
036800         '----------------'.                                      03680000
036900     05  FILLER                  PIC  X(04)    VALUE SPACE.       03690000
037000                                                                  03700000
037100 01  DL-DETAIL-LINE-1.                                            03710000
037200     05  FILLER                  PIC  X(01)    VALUE SPACE.       03720000
037300     05  DL1-PO-RCVR-NBR.                                         03730000
      *CLP 10/14/14                                                     03731002
037400         10  DL1-PO-NBR          PIC  X(08)    VALUE SPACE.       03740002
037500         10  DL1-PO-RCVR-DASH    PIC  X(01)    VALUE '-'.         03750000
037600         10  DL1-REC-SEQ-NBR     PIC  X(03).                      03760000
      *CLP 10/14/14                                                     03761003
037700     05  FILLER                  PIC  X(01)    VALUE SPACE.       03770003
037800     05  DL1-LINE-STATUS         PIC  X(02)    VALUE SPACE.       03780000
037900     05  FILLER                  PIC  X(01)    VALUE SPACE.       03790000
038000     05  DL1-DATE.                                                03800000
038100         10  DL1-MM              PIC    XX.                       03810000
038200         10  DL1-SLASH-1         PIC  X(01)    VALUE '/'.         03820000
038300         10  DL1-DD              PIC    XX.                       03830000
038400         10  DL1-SLASH-2         PIC  X(01)    VALUE '/'.         03840000
038500         10  DL1-CC              PIC    XX.                       03850000
038600         10  DL1-YY              PIC    XX.                       03860000
038700     05  FILLER                  PIC  X(01)    VALUE ' '.         03870000
038800     05  DL1-TIME.                                                03880000
038900         10  DL1-HH              PIC    XX.                       03890000
039000         10  DL1-COLON           PIC  X(01)    VALUE ':'.         03900000
039100         10  DL1-MI              PIC    XX.                       03910000
039200     05  FILLER                  PIC  X(02)    VALUE SPACE.       03920000
039300     05  DL1-LINE-NBR            PIC  X(04)    VALUE SPACE.       03930000
039400     05  FILLER                  PIC  X(02)    VALUE SPACE.       03940000
039500     05  DL1-SKU-NBR             PIC  X(08).                      03950000
039600     05  FILLER                  PIC  X(01)    VALUE SPACE.       03960000
039700     05  DL1-TOT-UNTS-VERIFD     PIC  ZZ,ZZZ.                     03970000
039800     05  FILLER                  PIC  X(02)    VALUE SPACE.       03980000
039900     05  DL1-TOT-UNTS-MANIFD     PIC  ZZ,ZZZ.                     03990000
040000     05  FILLER                  PIC  X(02)    VALUE SPACE.       04000000
040100     05  DL1-TOT-UNT-VARIANCE    PIC  ZZ,ZZZ-.                    04010000
040200     05  FILLER                  PIC  X(02)    VALUE SPACE.       04020000
040300     05  DL1-TOT-CTN-LINE        PIC  Z,ZZZ.                      04030000
040400     05  FILLER                  PIC  X(02)    VALUE SPACE.       04040000
040500     05  DL1-PKG-TYPE            PIC  X(06).                      04050000
040600     05  FILLER                  PIC  X(02)    VALUE SPACE.       04060000
040700     05  DL1-VERIFD-SRC          PIC  X(02).                      04070000
040800     05  FILLER                  PIC  X(03)    VALUE SPACE.       04080000
040900     05  DL1-VERIFD-AREA         PIC  X(06).                      04090000
041000     05  FILLER                  PIC  X(02)    VALUE SPACE.       04100000
041100     05  DL1-VERIFD-UNITS        PIC  Z,ZZZ.                      04110000
041200     05  FILLER                  PIC  X(04)    VALUE SPACE.       04120000
041300     05  DL1-MANIFD-SRC          PIC  X(03).                      04130000
041400     05  FILLER                  PIC  X(03)    VALUE SPACE.       04140000
041500     05  DL1-MANIFD-UNITS        PIC  Z,ZZZ.                      04150000
041600     05  FILLER                  PIC  X(02)    VALUE SPACE.       04160000
041700     05  DL1-MANIFD-CTNS         PIC  Z,ZZZ.                      04170000
041800     05  FILLER                  PIC  X(10)    VALUE SPACE.       04180000
041900                                                                  04190000
042000                                                                  04200000
042100 01  ER-END-OF-REPORT-LINE.                                       04210000
042200     05  FILLER                  PIC  X(44)    VALUE SPACE.       04220000
042300     05  FILLER                  PIC  X(45)    VALUE              04230000
042400         '*******   E N D   O F   R E P O R T   *******'.         04240000
042500     05  FILLER                  PIC  X(43)    VALUE SPACE.       04250000
042600 01  ER-EMPTY-REPORT-LINE.                                        04260000
042700     05  FILLER                  PIC  X(40)    VALUE SPACE.       04270000
042800     05  FILLER                  PIC  X(52)    VALUE              04280000
042900         '*******  N O   D A T A   T O   R E P O R T   *******'.  04290000
043000     05  FILLER                  PIC  X(40)    VALUE SPACE.       04300000
043100                                                                  04310000
043200                                                                  04320000
043300*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 04330000
043400     COPY DPWS024.                                                04340000
043500                                                                  04350000
043600*** DB2 MESSAGE AREAS ****                                        04360000
043700     COPY DPWS004.                                                04370000
043800                                                                  04380000
043900*DB2 AREA FOR LOGISTICS LOCATION TABLE                            04390000
044000* XLT_LOC                                                         04400000
044100     EXEC SQL                                                     04410000
044200          INCLUDE XLT00010                                        04420000
044300     END-EXEC.                                                    04430000
044400                                                                  04440000
044500*DB2 AREA FOR COMMUNICATIONS                                      04450000
044600     EXEC SQL                                                     04460000
044700          INCLUDE SQLCA                                           04470000
044800     END-EXEC.                                                    04480000
044900                                                                  04490000
045000*DB2 AREA FOR COMMUNICATIONS AREA2                                04500000
045100     COPY SQLCA2.                                                 04510000
045200                                                                  04520000
045300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04530000
045400 PROCEDURE DIVISION.                                              04540000
045500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04550000
045600                                                                  04560000
045700***************************************************************** 04570000
045800 0000-MAINLINE.                                                   04580000
045900***************************************************************** 04590000
046000     OPEN INPUT  PO-FILE                                          04600000
046100          OUTPUT REPORT-FILE.                                     04610000
046200                                                                  04620000
046300     PERFORM 1000-INITIALIZE.                                     04630000
046400                                                                  04640000
046500     IF PS-END-OF-PO-FILE AND                                     04650000
046600        PS-FIRST-TIME-YES                                         04660000
046700         CONTINUE                                                 04670000
046800*        WRITE REPORT-RECORD                                      04680000
046900*        FROM  ER-EMPTY-REPORT-LINE                               04690000
047000*            AFTER ADVANCING 2 LINES                              04700000
047100     ELSE                                                         04710000
047200         IF PS-FIRST-TIME-YES                                     04720000
047300            PERFORM 8400-WRITE-DETAIL-LINES                       04730000
047400         ELSE                                                     04740000
047500            SET PS-FIRST-TIME-NO TO TRUE                          04750000
047600         END-IF                                                   04760000
047700                                                                  04770000
047800         PERFORM 2000-PROCESS-PO-FILE                             04780000
047900             UNTIL PS-END-OF-PO-FILE                              04790000
048000     END-IF.                                                      04800000
048100                                                                  04810000
048200     WRITE REPORT-RECORD                                          04820000
048300      FROM ER-END-OF-REPORT-LINE                                  04830000
048400     AFTER ADVANCING 2 LINES.                                     04840000
048500                                                                  04850000
048600     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    04860000
048700     DISPLAY 'TOTAL RECORDS READ    '          PV-DISPLAY-COUNT.  04870000
048800                                                                  04880000
048900     MOVE PV-WRITE-COUNTER TO PV-DISPLAY-COUNT.                   04890000
049000     DISPLAY 'TOTAL EXTRACT RECORDS WRITTEN '  PV-DISPLAY-COUNT.  04900000
049100*DISPLAY 'READ TOTAL SHOULD EQUAL WRITE TOTAL '.                  04910000
049200                                                                  04920000
049300     CLOSE PO-FILE                                                04930000
049400           REPORT-FILE.                                           04940000
049500                                                                  04950000
049600     GOBACK.                                                      04960000
049700                                                                  04970000
049800                                                                  04980000
049900***************************************************************** 04990000
050000 1000-INITIALIZE.                                                 05000000
050100***************************************************************** 05010000
050200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             05020000
050300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             05030000
050400                                                                  05040000
050500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              05050000
050600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             05060000
050700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               05070000
050800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              05080000
050900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            05090000
051000                                                                  05100000
051100     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          05110000
051200     MOVE PC-1                   TO DP132O-REPORT-NUMBER          05120000
051300                                    DP132O-PAGE-NUMBER            05130000
051400*FIRST READ                                                       05140000
051500     PERFORM 7100-READ-PO-FILE                                    05150000
051600     SET PS-FIRST-TIME-YES TO TRUE                                05160000
051700                                                                  05170000
051800     IF PS-END-OF-PO-FILE                                         05180000
051900        PERFORM 2100-CALL-LOCATION-MODULE                         05190000
052000        IF PS-LOC-FOUND                                           05200000
052100           MOVE PV-CURR-OPER-UNT-ID  TO HL3-DC-OPER-UNT           05210000
052200           MOVE XL071-LOC-NM         TO HL3-DC-NAME               05220000
052300        ELSE                                                      05230000
052400            MOVE DK-OPER-UNT-ID          TO HL3-DC-OPER-UNT       05240000
052500            MOVE 'LOC NAME NOT FOUND'    TO HL3-DC-NAME           05250000
052600        END-IF                                                    05260000
052700                                                                  05270000
052800        PERFORM 8000-WRITE-REPORT-HEADERS                         05280000
052900        WRITE REPORT-RECORD FROM PC-BLANK-LINE                    05290000
053000            AFTER ADVANCING 2 LINES                               05300000
053100        WRITE REPORT-RECORD FROM ER-EMPTY-REPORT-LINE             05310000
053200            AFTER ADVANCING 3 LINES                               05320000
053300     ELSE                                                         05330000
053400        MOVE SU036-OPER-UNT-ID       TO PV-CURR-OPER-UNT-ID       05340000
053500        MOVE PV-CURR-OPER-UNT-ID     TO PV-PREV-OPER-UNT-ID       05350000
053600                                                                  05360000
053700        MOVE SU036-PO-NUMBER         TO PV-CURR-PO-NBR            05370000
053800        MOVE SU036-REC-SEQ-NBR       TO PV-CURR-REC-SEQ-NBR       05380000
053900                                                                  05390000
054000        IF SU036-LINE-STATUS = 'IP'                               05400000
054100           MOVE PC-CM                TO PV-CURR-LINE-STATUS       05410000
054200        ELSE                                                      05420000
054300           MOVE SU036-LINE-STATUS    TO PV-CURR-LINE-STATUS       05430000
054400        END-IF                                                    05440000
054500                                                                  05450000
054600        EVALUATE TRUE                                             05460000
054700           WHEN SU036-VRFD-USR-ID      = 'CASE'                   05470000
054800             MOVE SU036-TMST-LINE-CONFIRMED TO                    05480000
054900                               PV-CURR-VRFD-DATE                  05490000
055000           WHEN SU036-VRFD-USR-ID      = 'P2L'                    05500000
055100             MOVE SU036-TMST-LINE-P2L-UPLD  TO                    05510000
055200                               PV-CURR-VRFD-DATE                  05520000
055300           WHEN SU036-VRFD-USR-ID      = 'P2L/CASE'               05530000
055400             MOVE SU036-TMST-LINE-VERIFIED  TO                    05540000
055500                               PV-CURR-VRFD-DATE                  05550000
055600           WHEN SU036-VRFD-USR-ID(1:2) = 'TK'                     05560000
055610           WHEN SU036-VRFD-USR-ID(1:2) = 'TC'                     05561000
055620           WHEN SU036-VRFD-USR-ID(1:2) = 'TV'                     05562000
055700             MOVE SU036-TMST-LINE-VERIFIED  TO                    05570000
055800                               PV-CURR-VRFD-DATE                  05580000
055900           WHEN SU036-VRFD-USR-ID      = SPACES                   05590000
056000             MOVE SU036-TMST-LINE-VERIFIED  TO                    05600000
056100                               PV-CURR-VRFD-DATE                  05610000
056200        END-EVALUATE                                              05620000
056300                                                                  05630000
056400        MOVE SU036-LINE-NBR          TO PV-CURR-LINE-NBR          05640000
056500                                                                  05650000
056600        MOVE +0             TO PV-PAGE-COUNT                      05660000
056700                                                                  05670000
056800        PERFORM 2100-CALL-LOCATION-MODULE                         05680000
056900        IF PS-LOC-FOUND                                           05690000
057000           MOVE PV-CURR-OPER-UNT-ID  TO HL3-DC-OPER-UNT           05700000
057100           MOVE XL071-LOC-NM         TO HL3-DC-NAME               05710000
057200        ELSE                                                      05720000
057300            MOVE DK-OPER-UNT-ID          TO HL3-DC-OPER-UNT       05730000
057400            MOVE 'LOC NAME NOT FOUND'    TO HL3-DC-NAME           05740000
057500        END-IF                                                    05750000
057600     END-IF.                                                      05760000
057700                                                                  05770000
057800     IF PS-END-OF-PO-FILE                                         05780000
057900        CONTINUE                                                  05790000
058000     ELSE                                                         05800000
058100        PERFORM 8000-WRITE-REPORT-HEADERS                         05810000
058200     END-IF.                                                      05820000
058300                                                                  05830000
058400***************************************************************** 05840000
058500 2000-PROCESS-PO-FILE.                                            05850000
058600***************************************************************** 05860000
058700     MOVE '2000-PROCESS-EXTRACTS   ' TO PV-ABEND-PARAGRAPH.       05870000
058800*NEXT READ                                                        05880000
058900        PERFORM 7100-READ-PO-FILE                                 05890000
059000                                                                  05900000
059100        IF PS-END-OF-PO-FILE                                      05910000
059200           CONTINUE                                               05920000
059300        ELSE                                                      05930000
059400            MOVE SU036-OPER-UNT-ID       TO PV-CURR-OPER-UNT-ID   05940000
059500            MOVE SU036-PO-NUMBER         TO PV-CURR-PO-NBR        05950000
059600            MOVE SU036-REC-SEQ-NBR       TO PV-CURR-REC-SEQ-NBR   05960000
059700                                                                  05970000
059800            IF SU036-LINE-STATUS = 'IP'                           05980000
059900               MOVE PC-CM                TO PV-CURR-LINE-STATUS   05990000
060000            ELSE                                                  06000000
060100               MOVE SU036-LINE-STATUS    TO PV-CURR-LINE-STATUS   06010000
060200            END-IF                                                06020000
060300                                                                  06030000
060400            EVALUATE TRUE                                         06040000
060500              WHEN SU036-VRFD-USR-ID      = 'CASE'                06050000
060600                MOVE SU036-TMST-LINE-CONFIRMED TO                 06060000
060700                                  PV-CURR-VRFD-DATE               06070000
060800              WHEN SU036-VRFD-USR-ID      = 'P2L'                 06080000
060900                MOVE SU036-TMST-LINE-P2L-UPLD  TO                 06090000
061000                                  PV-CURR-VRFD-DATE               06100000
061100              WHEN SU036-VRFD-USR-ID      = 'P2L/CASE'            06110000
061200                MOVE SU036-TMST-LINE-VERIFIED  TO                 06120000
061300                                  PV-CURR-VRFD-DATE               06130000
061400              WHEN SU036-VRFD-USR-ID(1:2) = 'TK'                  06140000
061410              WHEN SU036-VRFD-USR-ID(1:2) = 'TC'                  06141000
061420              WHEN SU036-VRFD-USR-ID(1:2) = 'TV'                  06142000
061500                MOVE SU036-TMST-LINE-VERIFIED  TO                 06150000
061600                                  PV-CURR-VRFD-DATE               06160000
061700              WHEN SU036-VRFD-USR-ID      = SPACES                06170000
061800                MOVE SU036-TMST-LINE-VERIFIED  TO                 06180000
061900                                  PV-CURR-VRFD-DATE               06190000
062000            END-EVALUATE                                          06200000
062100                                                                  06210000
062200            MOVE SU036-LINE-NBR          TO PV-CURR-LINE-NBR      06220000
062300            MOVE SU036-VRFD-SOURCE       TO PV-CURR-VRFD-SRC      06230000
062400            MOVE SU036-MFST-SOURCE       TO PV-CURR-MFST-SRC      06240000
062500            MOVE SU036-MFST-UNITS        TO PV-CURR-MFST-UNT      06250000
062600            MOVE SU036-MFST-CTNS         TO PV-CURR-MFST-CTN      06260000
062700                                                                  06270000
062800            IF PV-CURR-OPER-UNT-ID    = PV-PREV-OPER-UNT-ID       06280000
062900               IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR      AND   06290000
063000                  PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR AND   06300000
063100                  PV-CURR-LINE-NBR    = PV-PREV-LINE-NBR    AND   06310000
063200                  PV-CURR-VRFD-SRC    = PV-PREV-VRFD-SRC    AND   06320000
063300                  PV-CURR-MFST-SRC    = PV-PREV-MFST-SRC          06330000
063400                  CONTINUE                                        06340000
063500               ELSE                                               06350000
063600                  PERFORM 8400-WRITE-DETAIL-LINES                 06360000
063700               END-IF                                             06370000
063800            ELSE                                                  06380000
063900               MOVE SU036-PO-NUMBER         TO PV-CURR-PO-NBR     06390000
064000               MOVE SU036-REC-SEQ-NBR       TO PV-CURR-REC-SEQ-NBR06400000
064100                                                                  06410000
064200               IF SU036-LINE-STATUS = 'IP'                        06420000
064300                  MOVE PC-CM                TO PV-CURR-LINE-STATUS06430000
064400               ELSE                                               06440000
064500                  MOVE SU036-LINE-STATUS    TO PV-CURR-LINE-STATUS06450000
064600               END-IF                                             06460000
064700                                                                  06470000
064800               EVALUATE TRUE                                      06480000
064900                  WHEN SU036-VRFD-USR-ID      = 'CASE'            06490000
065000                    MOVE SU036-TMST-LINE-CONFIRMED TO             06500000
065100                                      PV-CURR-VRFD-DATE           06510000
065200                  WHEN SU036-VRFD-USR-ID      = 'P2L'             06520000
065300                    MOVE SU036-TMST-LINE-P2L-UPLD  TO             06530000
065400                                      PV-CURR-VRFD-DATE           06540000
065500                  WHEN SU036-VRFD-USR-ID      = 'P2L/CASE'        06550000
065600                    MOVE SU036-TMST-LINE-VERIFIED  TO             06560000
065700                                      PV-CURR-VRFD-DATE           06570000
065800                  WHEN SU036-VRFD-USR-ID(1:2) = 'TK'              06580000
065810                  WHEN SU036-VRFD-USR-ID(1:2) = 'TC'              06581000
065820                  WHEN SU036-VRFD-USR-ID(1:2) = 'TV'              06582000
065900                    MOVE SU036-TMST-LINE-VERIFIED  TO             06590000
066000                                      PV-CURR-VRFD-DATE           06600000
066100                  WHEN SU036-VRFD-USR-ID      = SPACES            06610000
066200                    MOVE SU036-TMST-LINE-VERIFIED  TO             06620000
066300                                      PV-CURR-VRFD-DATE           06630000
066400               END-EVALUATE                                       06640000
066500                                                                  06650000
066600               MOVE SU036-LINE-NBR          TO PV-CURR-LINE-NBR   06660000
066700               MOVE SU036-VRFD-SOURCE       TO PV-CURR-VRFD-SRC   06670000
066800               MOVE SU036-MFST-SOURCE       TO PV-CURR-MFST-SRC   06680000
066900               MOVE SU036-MFST-UNITS        TO PV-CURR-MFST-UNT   06690000
067000               MOVE SU036-MFST-CTNS         TO PV-CURR-MFST-CTN   06700000
067100                                                                  06710000
067200               MOVE +0               TO PV-PAGE-COUNT             06720000
067300               PERFORM 2100-CALL-LOCATION-MODULE                  06730000
067400               IF PS-LOC-FOUND                                    06740000
067500                  MOVE SU036-OPER-UNT-ID    TO HL3-DC-OPER-UNT    06750000
067600                  MOVE XL071-LOC-NM         TO HL3-DC-NAME        06760000
067700               ELSE                                               06770000
067800                  MOVE DK-OPER-UNT-ID          TO HL3-DC-OPER-UNT 06780000
067900                  MOVE 'LOC NAME NOT FOUND'    TO HL3-DC-NAME     06790000
068000               END-IF                                             06800000
068100               PERFORM 8000-WRITE-REPORT-HEADERS                  06810000
068200               PERFORM 8400-WRITE-DETAIL-LINES                    06820000
068300               MOVE PV-CURR-OPER-UNT-ID     TO PV-PREV-OPER-UNT-ID06830000
068400            END-IF                                                06840000
068500        END-IF.                                                   06850000
068600                                                                  06860000
068700                                                                  06870000
068800****************************************************************  06880000
068900* CALL XLKUT071 MODULE TO GET DC LOCATION DESCRIPTION             06890000
069000****************************************************************  06900000
069100 2100-CALL-LOCATION-MODULE.                                       06910000
069200* HIERARCY DOMAIN TABLE XLT00010                                  06920000
069300                                                                  06930000
069400     INITIALIZE XL071-COMMAREA-REC.                               06940000
069500                                                                  06950000
069600     MOVE SU036-OPER-UNT-ID          TO XL071-LOCATION-NUMBER     06960000
069700                                        DK-OPER-UNT-ID            06970000
069800                                                                  06980000
069900     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06990000
070000                                                                  07000000
070100     EVALUATE TRUE                                                07010000
070200         WHEN XL071-NO-ERRORS                                     07020000
070300             IF XL071-LOC-TYP-CDE = PC-DC                         07030000
070400                SET PS-LOC-FOUND      TO TRUE                     07040000
070500             ELSE                                                 07050000
070600                SET PS-LOC-NOT-FOUND  TO TRUE                     07060000
070700             END-IF                                               07070000
070800         WHEN XL071-LOC-NOT-FOUND                                 07080000
070900         WHEN XL071-DC-ASGMT-NOT-FND                              07090000
071000             SET PS-LOC-NOT-FOUND  TO TRUE                        07100000
071100         WHEN OTHER                                               07110000
071200             MOVE XL071-SQLCA         TO SQLCA                    07120000
071300             DISPLAY '** ABEND **         ** = ' 'XLKUT071'       07130000
071400             DISPLAY '** PROGRAM   ** = ' 'SUKRP031'              07140000
071500             DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH      07150000
071600             DISPLAY '** OPERATION ** = ' ' SELECT XLT_LOC'       07160000
071700             DISPLAY '** SQLCODE FROM MOD ** = ' SQLCODE          07170000
071800             DISPLAY '** XLT_LOC  ** = '  XL071-LOCATION-NUMBER   07180000
071900             DISPLAY '** TABLE IN ERROR   ** = ' XL071-DB2-TABLE  07190000
072000             DISPLAY '** XLKUT071 RETURN  ** = ' XL071-RETURN-CODE07200000
072100             PERFORM 9100-SQL-ABEND                               07210000
072200     END-EVALUATE.                                                07220000
072300                                                                  07230000
072400***************************************************************** 07240000
072500 7100-READ-PO-FILE.                                               07250000
072600******************************************************************07260000
072700     READ PO-FILE  INTO SU036-RECORD                              07270000
072800        AT END                                                    07280000
072900           SET PS-END-OF-PO-FILE TO TRUE                          07290000
073000        NOT AT END                                                07300000
073100           ADD +1 TO PV-READ-COUNTER                              07310000
073200     END-READ.                                                    07320000
073300                                                                  07330000
073400                                                                  07340000
073500***************************************************************** 07350000
073600 8000-WRITE-REPORT-HEADERS.                                       07360000
073700***************************************************************** 07370000
073800     ADD 1                            TO PV-PAGE-COUNT.           07380000
073900     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      07390000
074000     MOVE ZERO                        TO PV-LINE-COUNT            07400000
074100                                                                  07410000
074200     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      07420000
074300                 AFTER ADVANCING PAGE                             07430000
074400                                                                  07440000
074500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1.                  07450000
074600                                                                  07460000
074700     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2.                  07470000
074800                                                                  07480000
074900     WRITE REPORT-RECORD FROM PC-BLANK-LINE                       07490000
075000         AFTER ADVANCING 2 LINES.                                 07500000
075100                                                                  07510000
075200     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   07520000
075300        AFTER ADVANCING 2 LINES.                                  07530000
075400                                                                  07540000
075500     WRITE REPORT-RECORD FROM PC-BLANK-LINE                       07550000
075600         AFTER ADVANCING 2 LINES.                                 07560000
075700                                                                  07570000
075800     WRITE REPORT-RECORD FROM HL-HEADING-LINE-4                   07580000
075900        AFTER ADVANCING 2 LINES.                                  07590000
076000                                                                  07600000
076100     WRITE REPORT-RECORD FROM HL-HEADING-LINE-5.                  07610000
076200                                                                  07620000
076300     WRITE REPORT-RECORD FROM HL-HEADING-LINE-6.                  07630000
076400                                                                  07640000
076500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-7.                  07650000
076600                                                                  07660000
076700     ADD  +11                     TO PV-LINE-COUNT.               07670000
076800                                                                  07680000
076900***************************************************************** 07690000
077000 8400-WRITE-DETAIL-LINES.                                         07700000
077100***************************************************************** 07710000
077200     MOVE SU036-PO-NUMBER          TO PV-CURR-PO-NBR.             07720000
077300     MOVE SU036-REC-SEQ-NBR        TO PV-CURR-REC-SEQ-NBR.        07730000
077400                                                                  07740000
077500     IF SU036-LINE-STATUS = 'IP'                                  07750000
077600        MOVE PC-CM                TO PV-CURR-LINE-STATUS          07760000
077700     ELSE                                                         07770000
077800        MOVE SU036-LINE-STATUS    TO PV-CURR-LINE-STATUS          07780000
077900     END-IF                                                       07790000
078000                                                                  07800000
078100     EVALUATE TRUE                                                07810000
078200        WHEN SU036-VRFD-USR-ID      = 'CASE'                      07820000
078300          MOVE SU036-TMST-LINE-CONFIRMED TO                       07830000
078400                            PV-CURR-VRFD-DATE                     07840000
078500        WHEN SU036-VRFD-USR-ID      = 'P2L'                       07850000
078600          MOVE SU036-TMST-LINE-P2L-UPLD  TO                       07860000
078700                            PV-CURR-VRFD-DATE                     07870000
078800        WHEN SU036-VRFD-USR-ID      = 'P2L/CASE'                  07880000
078900          MOVE SU036-TMST-LINE-VERIFIED  TO                       07890000
079000                            PV-CURR-VRFD-DATE                     07900000
079100        WHEN SU036-VRFD-USR-ID(1:2) = 'TK'                        07910000
079110        WHEN SU036-VRFD-USR-ID(1:2) = 'TC'                        07911000
079120        WHEN SU036-VRFD-USR-ID(1:2) = 'TV'                        07912000
079200          MOVE SU036-TMST-LINE-VERIFIED  TO                       07920000
079300                            PV-CURR-VRFD-DATE                     07930000
079400        WHEN SU036-VRFD-USR-ID      = SPACES                      07940000
079500          MOVE SU036-TMST-LINE-VERIFIED  TO                       07950000
079600                            PV-CURR-VRFD-DATE                     07960000
079700     END-EVALUATE                                                 07970000
079800                                                                  07980000
079900     MOVE SU036-LINE-NBR           TO PV-CURR-LINE-NBR.           07990000
080000     MOVE SU036-VRFD-SOURCE        TO PV-CURR-VRFD-SRC.           08000000
080100     MOVE SU036-VRFD-AREA          TO PV-CURR-VRFD-AREA.          08010000
080200                                                                  08020000
080300                                                                  08030000
080400     MOVE SU036-VRFD-UNITS         TO PV-CURR-VRFD-UNT.           08040000
080500     MOVE SU036-MFST-SOURCE        TO PV-CURR-MFST-SRC.           08050000
080600     MOVE SU036-MFST-UNITS         TO PV-CURR-MFST-UNT.           08060000
080700     MOVE SU036-MFST-CTNS          TO PV-CURR-MFST-CTN.           08070000
080800                                                                  08080000
080900     EVALUATE TRUE                                                08090000
081000        WHEN PS-NEW-PAGE                                          08100000
081100        IF PV-CURR-PO-NBR            = PV-PREV-PO-NBR      AND    08110000
081200           PV-CURR-REC-SEQ-NBR       = PV-PREV-REC-SEQ-NBR AND    08120000
081300           PV-CURR-LINE-STATUS       = PV-PREV-LINE-STATUS AND    08130000
081400           PV-CURR-VRFD-DATE         = PV-PREV-VRFD-DATE   AND    08140000
081500           PV-CURR-LINE-NBR          = PV-PREV-LINE-NBR           08150000
081510***        DISPLAY 'SPACE 1'  PV-READ-COUNTER                     08151001
081600           MOVE SPACES         TO DL1-PO-NBR                      08160000
081700           MOVE SPACES         TO DL1-PO-RCVR-DASH                08170000
081800           MOVE SPACES         TO DL1-REC-SEQ-NBR                 08180000
081900           MOVE SPACES         TO DL1-LINE-STATUS                 08190000
082000           MOVE SPACES         TO DL1-MM                          08200000
082100           MOVE SPACES         TO DL1-SLASH-1                     08210000
082200           MOVE SPACES         TO DL1-DD                          08220000
082300           MOVE SPACES         TO DL1-SLASH-2                     08230000
082400           MOVE SPACES         TO DL1-CC                          08240000
082500           MOVE SPACES         TO DL1-YY                          08250000
082600           MOVE SPACES         TO DL1-HH                          08260000
082700           MOVE SPACES         TO DL1-COLON                       08270000
082800           MOVE SPACES         TO DL1-MI                          08280000
082900           MOVE SPACES         TO DL1-LINE-NBR                    08290000
083000           MOVE SPACES         TO DL1-SKU-NBR                     08300000
083100           MOVE ZEROES         TO DL1-TOT-UNTS-VERIFD             08310000
083200           MOVE ZEROES         TO DL1-TOT-UNTS-MANIFD             08320000
083300           MOVE ZEROES         TO DL1-TOT-UNT-VARIANCE            08330000
083400           MOVE ZEROES         TO DL1-TOT-CTN-LINE                08340000
083500           MOVE SPACES         TO DL1-PKG-TYPE                    08350000
083600                                                                  08360000
083700           IF SU036-VRFD-SOURCE = SPACES                          08370000
083800              MOVE SPACES                 TO DL1-VERIFD-SRC       08380000
083900              MOVE SPACES                 TO DL1-VERIFD-AREA      08390000
084000              MOVE ZEROES                 TO DL1-VERIFD-UNITS     08400000
084100           ELSE                                                   08410000
084200              MOVE SU036-VRFD-SOURCE      TO DL1-VERIFD-SRC       08420000
084300              MOVE SU036-VRFD-AREA        TO DL1-VERIFD-AREA      08430000
084400              MOVE SU036-VRFD-UNITS       TO DL1-VERIFD-UNITS     08440000
084500           END-IF                                                 08450000
084600                                                                  08460000
084700           IF SU036-MFST-SOURCE = SPACES                          08470000
084800              MOVE SPACES                 TO DL1-MANIFD-SRC       08480000
084900              MOVE ZEROES                 TO DL1-MANIFD-UNITS     08490000
085000              MOVE ZEROES                 TO DL1-MANIFD-CTNS      08500000
085100           ELSE                                                   08510000
085200              IF SU036-MFST-SOURCE = PC-ASN                       08520000
085300                 MOVE PC-CKN              TO SU036-MFST-SOURCE    08530000
085400              END-IF                                              08540000
085500              MOVE SU036-MFST-SOURCE      TO DL1-MANIFD-SRC       08550000
085600              MOVE SU036-MFST-UNITS       TO DL1-MANIFD-UNITS     08560000
085700              MOVE SU036-MFST-CTNS        TO DL1-MANIFD-CTNS      08570000
085800           END-IF                                                 08580000
085900           SET PS-NO-SKIP-LINE TO TRUE                            08590000
086000        ELSE                                                      08600000
      *CLP 10/14/14                                                     08601002
086100              MOVE PV-CURR-PO-NBR(2:8)    TO DL1-PO-NBR           08610002
086200              MOVE PV-DASH                TO DL1-PO-RCVR-DASH     08620000
086300              SET PS-SKIP-LINE TO TRUE                            08630000
086400                                                                  08640000
086500              MOVE PV-CURR-REC-SEQ-NBR(7:3) TO DL1-REC-SEQ-NBR    08650000
086600                                                                  08660000
086700              MOVE PV-CURR-LINE-STATUS TO DL1-LINE-STATUS         08670000
086800                                                                  08680000
086900              EVALUATE TRUE                                       08690000
087000                 WHEN SU036-VRFD-USR-ID      = 'CASE'             08700000
087100                   MOVE SU036-TMST-LINE-CONFIRMED TO              08710000
087200                                     PV-DB2-TIMESTAMP             08720000
087300                 WHEN SU036-VRFD-USR-ID      = 'P2L'              08730000
087400                   MOVE SU036-TMST-LINE-P2L-UPLD  TO              08740000
087500                                     PV-DB2-TIMESTAMP             08750000
087600                 WHEN SU036-VRFD-USR-ID      = 'P2L/CASE'         08760000
087700                   MOVE SU036-TMST-LINE-VERIFIED  TO              08770000
087800                                     PV-DB2-TIMESTAMP             08780000
087900                 WHEN SU036-VRFD-USR-ID(1:2) = 'TK'               08790000
087910                 WHEN SU036-VRFD-USR-ID(1:2) = 'TC'               08791000
087920                 WHEN SU036-VRFD-USR-ID(1:2) = 'TV'               08792000
088000                   MOVE SU036-TMST-LINE-VERIFIED  TO              08800000
088100                                     PV-DB2-TIMESTAMP             08810000
088200                 WHEN SU036-VRFD-USR-ID      = SPACES             08820000
088300                   MOVE SU036-TMST-LINE-VERIFIED  TO              08830000
088400                                     PV-DB2-TIMESTAMP             08840000
088500              END-EVALUATE                                        08850000
088600                                                                  08860000
088700              IF PV-DB2-TIMESTAMP = SPACES OR LOW-VALUES          08870000
088710***              DISPLAY 'SPACE 2'  PV-READ-COUNTER               08871001
088800                 MOVE SPACES                 TO DL1-MM            08880000
088900                 MOVE SPACES                 TO DL1-SLASH-1       08890000
089000                 MOVE SPACES                 TO DL1-DD            08900000
089100                 MOVE SPACES                 TO DL1-SLASH-2       08910000
089200                 MOVE SPACES                 TO DL1-CC            08920000
089300                 MOVE SPACES                 TO DL1-YY            08930000
089400                 MOVE SPACES                 TO DL1-HH            08940000
089500                 MOVE SPACES                 TO DL1-COLON         08950000
089600                 MOVE SPACES                 TO DL1-MI            08960000
089700              ELSE                                                08970000
089800                 MOVE PV-TMST-MM             TO DL1-MM            08980000
089900                 MOVE PC-SLASH               TO DL1-SLASH-1       08990000
090000                 MOVE PV-TMST-DD             TO DL1-DD            09000000
090100                 MOVE PC-SLASH               TO DL1-SLASH-2       09010000
090200                 MOVE PV-TMST-CC             TO DL1-CC            09020000
090300                 MOVE PV-TMST-YY             TO DL1-YY            09030000
090400                 MOVE PV-TMST-HRS            TO DL1-HH            09040000
090500                 MOVE PC-COLON               TO DL1-COLON         09050000
090600                 MOVE PV-TMST-MIN            TO DL1-MI            09060000
090700              END-IF                                              09070000
090800                                                                  09080000
090900              MOVE PV-CURR-LINE-NBR(7:3)  TO DL1-LINE-NBR         09090000
091000              MOVE SU036-SKU-NUMBER       TO DL1-SKU-NBR          09100000
091100                                                                  09110000
091200*TOTAL UNITS VERIFIED                                             09120000
091300              MOVE SU036-TOT-UNT-VRFD     TO DL1-TOT-UNTS-VERIFD  09130000
091400              MOVE SU036-TOT-UNT-MFST     TO DL1-TOT-UNTS-MANIFD  09140000
091500              MOVE SU036-TOT-VARIANCE     TO DL1-TOT-UNT-VARIANCE 09150000
091600              MOVE SU036-TOT-CTNS-LINE    TO DL1-TOT-CTN-LINE     09160000
091700                                                                  09170000
091800              EVALUATE TRUE                                       09180000
091900                WHEN SU036-PKG-TYPE    = 'I'                      09190000
092000                    MOVE PC-INNER-PREPACK        TO DL1-PKG-TYPE  09200000
092100                WHEN SU036-PKG-TYPE    = 'M'                      09210000
092200                    MOVE PC-MULTI-SKU            TO DL1-PKG-TYPE  09220000
092300                WHEN SU036-PKG-TYPE    = 'S'                      09230000
092400                    MOVE PC-SINGLE-SKU           TO DL1-PKG-TYPE  09240000
092500                WHEN SU036-PKG-TYPE    = 'C'                      09250000
092600                    MOVE PC-CASEPACK             TO DL1-PKG-TYPE  09260000
092700                WHEN SU036-PKG-TYPE    = 'B'                      09270000
092800                    MOVE PC-BULK                 TO DL1-PKG-TYPE  09280000
092900                WHEN SU036-PKG-TYPE    = 'P'                      09290000
093000                    MOVE PC-PBS                  TO DL1-PKG-TYPE  09300000
093100                WHEN SU036-PKG-TYPE    = ' '                      09310000
093200                    MOVE SPACES                  TO DL1-PKG-TYPE  09320000
093300              END-EVALUATE                                        09330000
093400                                                                  09340000
093500                 MOVE SU036-VRFD-SOURCE      TO DL1-VERIFD-SRC    09350000
093600                 MOVE SU036-VRFD-AREA        TO DL1-VERIFD-AREA   09360000
093700                                                                  09370000
093800                 MOVE SU036-VRFD-UNITS       TO DL1-VERIFD-UNITS  09380000
093900                                                                  09390000
094000                 IF SU036-MFST-SOURCE = PC-ASN                    09400000
094100                    MOVE PC-CKN              TO SU036-MFST-SOURCE 09410000
094200                 END-IF                                           09420000
094300                 MOVE SU036-MFST-SOURCE      TO DL1-MANIFD-SRC    09430000
094400                 MOVE SU036-MFST-UNITS       TO DL1-MANIFD-UNITS  09440000
094500                 MOVE SU036-MFST-CTNS        TO DL1-MANIFD-CTNS   09450000
094600        END-IF                                                    09460000
094700                                                                  09470000
094800        WHEN PS-NOT-NEW-PAGE                                      09480000
094900        IF PV-CURR-PO-NBR            = PV-PREV-PO-NBR             09490000
095000           MOVE SPACES                 TO DL1-PO-NBR              09500000
095100           MOVE SPACES                 TO DL1-PO-RCVR-DASH        09510000
095200           MOVE SPACES                 TO DL1-REC-SEQ-NBR         09520000
095300           SET PS-NO-SKIP-LINE TO TRUE                            09530000
095400        ELSE                                                      09540000
      *CLP 10/14/14                                                     09541002
095500           MOVE PV-CURR-PO-NBR(2:8)    TO DL1-PO-NBR              09550002
095600           MOVE PV-DASH                TO DL1-PO-RCVR-DASH        09560000
095700           MOVE PV-CURR-REC-SEQ-NBR    TO DL1-REC-SEQ-NBR         09570000
095800           SET PS-SKIP-LINE TO TRUE                               09580000
095900        END-IF                                                    09590000
096000                                                                  09600000
096100        IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR AND               09610000
096200           PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR              09620000
096300           MOVE SPACES         TO DL1-REC-SEQ-NBR                 09630000
096400        ELSE                                                      09640000
096500           MOVE PV-CURR-REC-SEQ-NBR(7:3) TO DL1-REC-SEQ-NBR       09650000
096600        END-IF                                                    09660000
096700                                                                  09670000
096800        IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR      AND          09680000
096900           PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR AND          09690000
097000           PV-CURR-LINE-STATUS = PV-PREV-LINE-STATUS              09700000
097100           MOVE SPACES         TO DL1-LINE-STATUS                 09710000
097200        ELSE                                                      09720000
097300           MOVE PV-CURR-LINE-STATUS TO DL1-LINE-STATUS            09730000
097400        END-IF                                                    09740000
097500                                                                  09750000
097600        IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR      AND          09760000
097700           PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR AND          09770000
097800           PV-CURR-VRFD-DATE   = PV-PREV-VRFD-DATE                09780000
097810***        DISPLAY 'SPACE 3' PV-READ-COUNTER                      09781001
097900           MOVE SPACES         TO DL1-MM                          09790000
098000           MOVE SPACES         TO DL1-SLASH-1                     09800000
098100           MOVE SPACES         TO DL1-DD                          09810000
098200           MOVE SPACES         TO DL1-SLASH-2                     09820000
098300           MOVE SPACES         TO DL1-CC                          09830000
098400           MOVE SPACES         TO DL1-YY                          09840000
098500           MOVE SPACES         TO DL1-HH                          09850000
098600           MOVE SPACES         TO DL1-COLON                       09860000
098700           MOVE SPACES         TO DL1-MI                          09870000
098800        ELSE                                                      09880000
098900           EVALUATE TRUE                                          09890000
099000              WHEN SU036-VRFD-USR-ID      = 'CASE'                09900000
099100                MOVE SU036-TMST-LINE-CONFIRMED TO                 09910000
099200                                  PV-DB2-TIMESTAMP                09920000
099300              WHEN SU036-VRFD-USR-ID      = 'P2L'                 09930000
099400                MOVE SU036-TMST-LINE-P2L-UPLD  TO                 09940000
099500                                  PV-DB2-TIMESTAMP                09950000
099600              WHEN SU036-VRFD-USR-ID      = 'P2L/CASE'            09960000
099700                MOVE SU036-TMST-LINE-VERIFIED  TO                 09970000
099800                                  PV-DB2-TIMESTAMP                09980000
099900              WHEN SU036-VRFD-USR-ID(1:2) = 'TK'                  09990000
099910              WHEN SU036-VRFD-USR-ID(1:2) = 'TC'                  09991000
099920              WHEN SU036-VRFD-USR-ID(1:2) = 'TV'                  09992000
100000                MOVE SU036-TMST-LINE-VERIFIED  TO                 10000000
100100                                  PV-DB2-TIMESTAMP                10010000
100200              WHEN SU036-VRFD-USR-ID      = SPACES                10020000
100300                MOVE SU036-TMST-LINE-VERIFIED  TO                 10030000
100400                                  PV-DB2-TIMESTAMP                10040000
100500           END-EVALUATE                                           10050000
100600                                                                  10060000
100700           IF PV-DB2-TIMESTAMP = SPACES OR LOW-VALUES             10070000
100710***           DISPLAY 'SPACE 4'  PV-READ-COUNTER                  10071001
100800              MOVE SPACES                 TO DL1-MM               10080000
100900              MOVE SPACES                 TO DL1-SLASH-1          10090000
101000              MOVE SPACES                 TO DL1-DD               10100000
101100              MOVE SPACES                 TO DL1-SLASH-2          10110000
101200              MOVE SPACES                 TO DL1-CC               10120000
101300              MOVE SPACES                 TO DL1-YY               10130000
101400              MOVE SPACES                 TO DL1-HH               10140000
101500              MOVE SPACES                 TO DL1-COLON            10150000
101600              MOVE SPACES                 TO DL1-MI               10160000
101700           ELSE                                                   10170000
101800              MOVE PV-TMST-MM             TO DL1-MM               10180000
101900              MOVE PC-SLASH               TO DL1-SLASH-1          10190000
102000              MOVE PV-TMST-DD             TO DL1-DD               10200000
102100              MOVE PC-SLASH               TO DL1-SLASH-2          10210000
102200              MOVE PV-TMST-CC             TO DL1-CC               10220000
102300              MOVE PV-TMST-YY             TO DL1-YY               10230000
102400              MOVE PV-TMST-HRS            TO DL1-HH               10240000
102500              MOVE PC-COLON               TO DL1-COLON            10250000
102600              MOVE PV-TMST-MIN            TO DL1-MI               10260000
102700           END-IF                                                 10270000
102800        END-IF                                                    10280000
102900                                                                  10290000
103000        IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR      AND          10300000
103100           PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR AND          10310000
103200           PV-CURR-LINE-NBR    = PV-PREV-LINE-NBR                 10320000
103300           MOVE SPACES         TO DL1-LINE-NBR                    10330000
103400           MOVE SPACES         TO DL1-SKU-NBR                     10340000
103500           MOVE ZEROES         TO DL1-TOT-UNTS-VERIFD             10350000
103600           MOVE ZEROES         TO DL1-TOT-UNTS-MANIFD             10360000
103700           MOVE ZEROES         TO DL1-TOT-UNT-VARIANCE            10370000
103800           MOVE ZEROES         TO DL1-TOT-CTN-LINE                10380000
103900           MOVE SPACES         TO DL1-PKG-TYPE                    10390000
104000        ELSE                                                      10400000
104100           MOVE PV-CURR-LINE-NBR(7:3)  TO DL1-LINE-NBR            10410000
104200           MOVE SU036-SKU-NUMBER       TO DL1-SKU-NBR             10420000
104300                                                                  10430000
104400*TOTAL UNITS VERIFIED                                             10440000
104500           MOVE SU036-TOT-UNT-VRFD     TO DL1-TOT-UNTS-VERIFD     10450000
104600           MOVE SU036-TOT-UNT-MFST     TO DL1-TOT-UNTS-MANIFD     10460000
104700           MOVE SU036-TOT-VARIANCE     TO DL1-TOT-UNT-VARIANCE    10470000
104800           MOVE SU036-TOT-CTNS-LINE    TO DL1-TOT-CTN-LINE        10480000
104900                                                                  10490000
105000           EVALUATE TRUE                                          10500000
105100             WHEN SU036-PKG-TYPE    = 'I'                         10510000
105200                 MOVE PC-INNER-PREPACK        TO DL1-PKG-TYPE     10520000
105300             WHEN SU036-PKG-TYPE    = 'M'                         10530000
105400                 MOVE PC-MULTI-SKU            TO DL1-PKG-TYPE     10540000
105500             WHEN SU036-PKG-TYPE    = 'S'                         10550000
105600                 MOVE PC-SINGLE-SKU           TO DL1-PKG-TYPE     10560000
105700             WHEN SU036-PKG-TYPE    = 'C'                         10570000
105800                 MOVE PC-CASEPACK             TO DL1-PKG-TYPE     10580000
105900             WHEN SU036-PKG-TYPE    = 'B'                         10590000
106000                 MOVE PC-BULK                 TO DL1-PKG-TYPE     10600000
106100             WHEN SU036-PKG-TYPE    = 'P'                         10610000
106200                 MOVE PC-PBS                  TO DL1-PKG-TYPE     10620000
106300             WHEN SU036-PKG-TYPE    = ' '                         10630000
106400                 MOVE SPACES                  TO DL1-PKG-TYPE     10640000
106500           END-EVALUATE                                           10650000
106600        END-IF                                                    10660000
106700                                                                  10670000
106800*IF SAME AS PREVIOUS DON'T PRINT                                  10680000
106900        IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR      AND          10690000
107000           PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR AND          10700000
107100           PV-CURR-LINE-NBR    = PV-PREV-LINE-NBR    AND          10710000
107200           PV-CURR-VRFD-SRC    = PV-PREV-VRFD-SRC    AND          10720000
107300           PV-CURR-VRFD-AREA   = PV-PREV-VRFD-AREA   AND          10730000
107400           PV-CURR-VRFD-UNT    = PV-PREV-VRFD-UNT                 10740000
107500              MOVE SPACES                 TO DL1-VERIFD-SRC       10750000
107600              MOVE SPACES                 TO DL1-VERIFD-AREA      10760000
107700              MOVE ZEROES                 TO DL1-VERIFD-UNITS     10770000
107800        ELSE                                                      10780000
107900              MOVE SU036-VRFD-SOURCE      TO DL1-VERIFD-SRC       10790000
108000              MOVE SU036-VRFD-AREA        TO DL1-VERIFD-AREA      10800000
108100                                                                  10810000
108200*VERIFIED UNITS BY SOURCE                                         10820000
108300              MOVE SU036-VRFD-UNITS       TO DL1-VERIFD-UNITS     10830000
108400        END-IF                                                    10840000
108500                                                                  10850000
108600        IF PV-CURR-PO-NBR      = PV-PREV-PO-NBR      AND          10860000
108700           PV-CURR-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR AND          10870000
108800           PV-CURR-LINE-NBR    = PV-PREV-LINE-NBR    AND          10880000
108900           PV-CURR-MFST-SRC    = PV-PREV-MFST-SRC    AND          10890000
109000           PV-CURR-MFST-UNT    = PV-PREV-MFST-UNT    AND          10900000
109100           PV-CURR-MFST-CTN    = PV-PREV-MFST-CTN                 10910000
109200              MOVE SPACES                 TO DL1-MANIFD-SRC       10920000
109300              MOVE ZEROES                 TO DL1-MANIFD-UNITS     10930000
109400              MOVE ZEROES                 TO DL1-MANIFD-CTNS      10940000
109500           ELSE                                                   10950000
109600              IF SU036-MFST-SOURCE = PC-ASN                       10960000
109700                 MOVE PC-CKN              TO SU036-MFST-SOURCE    10970000
109800              END-IF                                              10980000
109900              MOVE SU036-MFST-SOURCE      TO DL1-MANIFD-SRC       10990000
110000              MOVE SU036-MFST-UNITS       TO DL1-MANIFD-UNITS     11000000
110100              MOVE SU036-MFST-CTNS        TO DL1-MANIFD-CTNS      11010000
110200           END-IF                                                 11020000
110300     END-EVALUATE                                                 11030000
110400                                                                  11040000
110500        MOVE PV-CURR-PO-NBR         TO PV-PREV-PO-NBR             11050000
110600        MOVE PV-CURR-REC-SEQ-NBR    TO PV-PREV-REC-SEQ-NBR        11060000
110700        MOVE PV-CURR-LINE-STATUS    TO PV-PREV-LINE-STATUS        11070000
110800        MOVE PV-CURR-VRFD-DATE      TO PV-PREV-VRFD-DATE          11080000
110900        MOVE PV-CURR-LINE-NBR       TO PV-PREV-LINE-NBR           11090000
111000        MOVE PV-CURR-VRFD-SRC       TO PV-PREV-VRFD-SRC           11100000
111100        MOVE PV-CURR-VRFD-AREA      TO PV-PREV-VRFD-AREA          11110000
111200        MOVE PV-CURR-VRFD-UNT       TO PV-PREV-VRFD-UNT           11120000
111300        MOVE PV-CURR-MFST-SRC       TO PV-PREV-MFST-SRC           11130000
111400        MOVE PV-CURR-MFST-UNT       TO PV-PREV-MFST-UNT           11140000
111500        MOVE PV-CURR-MFST-CTN       TO PV-PREV-MFST-CTN           11150000
111600     IF PS-SKIP-LINE                                              11160000
111700        ADD +1        TO PV-LINE-COUNT                            11170000
111800        WRITE REPORT-RECORD FROM PC-BLANK-LINE                    11180000
111900           AFTER ADVANCING 1 LINES                                11190000
112000     ELSE                                                         11200000
112100        CONTINUE                                                  11210000
112200     END-IF                                                       11220000
112300                                                                  11230000
112400     WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1                    11240000
112500        AFTER ADVANCING 1 LINES.                                  11250000
112600     ADD +1        TO PV-WRITE-COUNTER.                           11260000
112700                                                                  11270000
112800*CHECK FOR OVERFLOW.                                              11280000
112900     ADD +1        TO PV-LINE-COUNT.                              11290000
113000     IF  PV-LINE-COUNT > PC-MAX-REPORT-LINES                      11300000
113100          SET PS-NEW-PAGE     TO TRUE                             11310000
113200          PERFORM 8000-WRITE-REPORT-HEADERS                       11320000
113300     ELSE                                                         11330000
113400          SET PS-NOT-NEW-PAGE TO TRUE                             11340000
113500     END-IF.                                                      11350000
113600                                                                  11360000
113700***************************************************************** 11370000
113800 9100-SQL-ABEND.                                                  11380000
113900***************************************************************** 11390000
114000     MOVE SQLCODE                     TO SQLCODE2.                11400000
114100     MOVE SQLERRD(3)                  TO SQLERRD3.                11410000
114200                                                                  11420000
114300     DISPLAY '** ABEND **         ** = SQLERROR'.                 11430000
114400     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                11440000
114500     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             11450000
114600     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11460000
114700     DISPLAY '** OPERATION ** = ' PV-ABEND-OPERATION1.            11470000
114800     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME.              11480000
114900                                                                  11490000
115000     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                11500000
115100     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                11510000
115200     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 11520000
115300     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                11530000
115400                                                                  11540000
115500                                                                  11550000
115600     MOVE +4013                       TO PV-ABEND-CODE.           11560000
115700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11570000
115800                                                                  11580000
