000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKRP093.                                00050000
000600 AUTHOR.                 DENISE HAHN.                             00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JANUARY, 2022.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL PRINT REPORT FOR VERIFIED RECEIVERS THAT   * 00130000
001310*  WERE CREATED FROM CARTONS THAT WERE PROCESSED BY GEODIS (3WD)* 00131000
001320*                                                               * 00132000
001330***************************************************************** 00133000
001340                                                                  00134000
001350***************************************************************** 00135000
001360 ENVIRONMENT DIVISION.                                            00136000
001370***************************************************************** 00137000
001380                                                                  00138000
001390 CONFIGURATION SECTION.                                           00139000
001400 SOURCE-COMPUTER.        IBM-3090.                                00140000
001500 OBJECT-COMPUTER.        IBM-3090.                                00150000
001600                                                                  00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800                                                                  00180000
001900 FILE-CONTROL.                                                    00190000
002000                                                                  00200000
002400     SELECT INPUT01-FILE                                          00240000
002500            ASSIGN TO INP01.                                      00250000
002600                                                                  00260000
002700     SELECT REPORT-FILE                                           00270000
002800            ASSIGN TO RPT01.                                      00280000
002900                                                                  00290000
003000***************************************************************** 00300000
003100 DATA DIVISION.                                                   00310000
003200***************************************************************** 00320000
003300                                                                  00330000
003400 FILE SECTION.                                                    00340000
003500                                                                  00350000
004100 FD  INPUT01-FILE                                                 00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0 RECORDS                                     00440000
004500     RECORD CONTAINS 300 CHARACTERS.                              00450013
004600 01  INPUT01-RECORD                  PIC X(300).                  00460013
004700                                                                  00470000
004800 FD  REPORT-FILE                                                  00480000
004900     RECORDING MODE IS F                                          00490000
005000     BLOCK CONTAINS 0  RECORDS.                                   00500000
005100 01  REPORT-RECORD                   PIC X(200).                  00510046
005200                                                                  00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400                                                                  00540000
005500 01  PROGRAM-SWITCHES.                                            00550000
005600     05  PS-EOF-INPUT-SW             PIC  X(01)    VALUE 'N'.     00560000
005700         88  PS-EOF-INPUT                          VALUE 'Y'.     00570000
005800         88  PS-EOF-INPUT-NO                       VALUE 'N'.     00580000
005900                                                                  00590000
006000 01  PC-CONSTANTS.                                                00600000
006100     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00610000
006200                           'RCKRP093'.                            00620000
006300     05  PC-REPORT-NBR               PIC  X(02)    VALUE          00630000
006400                           '-1'.                                  00640000
006500                                                                  00650000
006600 01  PV-PROGRAM-VARIABLES.                                        00660000
006700     05  PV-LINE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00670000
006800     05  PV-NBR-OF-LINES             PIC S9(05) COMP-3 VALUE +0.  00680000
006900     05  PV-LINE-LIMIT               PIC S9(03) COMP-3 VALUE +57. 00690000
007000     05  PV-PAGE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00700000
007100                                                                  00710000
007200     05  PV-TODAYS-DATE.                                          00720000
007300         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    00730000
007400         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    00740000
007500         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    00750000
007600     05  PV-TODAYS-TIME.                                          00760000
007700         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    00770000
007800         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    00780000
007900         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    00790000
008000         10  FILLER                  PIC  9(02)    VALUE ZERO.    00800000
008100     05  PV-FORMAT-DATE.                                          00810000
008200         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  00820000
008300         10  FILLER                  PIC  X(01)    VALUE '/'.     00830000
008400         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  00840000
008500         10  FILLER                  PIC  X(01)    VALUE '/'.     00850000
008600         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  00860000
008700                                                                  00870000
008800     05  PV-OPER-UNT-ID              PIC 9(04)         VALUE 0.   00880000
008900     05  PV-PREV-OPER-UNT-ID         PIC 9(04)         VALUE 0.   00890000
009000                                                                  00900000
009100     05  PV-OPER-SKU-CNT             PIC 9(17)     VALUE ZEROES.  00910000
009200     05  PV-OPER-SSCC-COUNT          PIC 9(17)     VALUE ZEROES.  00920000
009300     05  PV-OPER-UNIT-CNT            PIC 9(17)     VALUE ZEROES.  00930000
009301                                                                  00930104
009400                                                                  00940004
009500     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00950004
009600     05  PV-DB2-TABLE-NAME-1          PIC X(30) VALUE SPACES.     00960004
009700     05  PV-DB2-TABLE-NAME-2          PIC X(30) VALUE SPACES.     00970004
009800     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     00980008
009810                                                                  00981004
009820     05  PV-PREV-SUPPORT-DC-NBR       PIC 9(04) VALUE ZEROES.     00982010
009821     05  PV-PREV-KOHLS-PO-NBR         PIC 9(08) VALUE ZEROES.     00982110
009822     05  PV-PREV-REC-SEQ-NBR          PIC 9(04) VALUE ZEROES.     00982210
009823     05  PV-PREV-KOHLS-PO-LINE-NBR    PIC 9(04) VALUE ZEROES.     00982310
009824     05  PV-PREV-SML-NBR-NUM          PIC 9(18) VALUE ZEROES.     00982410
009825     05  PV-PREV-DEST-STORE-NBR       PIC 9(04) VALUE ZEROES.     00982531
009826                                                                  00982610
009827     05  PV-PREV-3RD-PRTY             PIC 9(04) VALUE ZEROES.     00982750
009829     05  PV-PREV-DEPT-NBR             PIC X(03) VALUE ZEROES.     00982950
009831     05  PV-PREV-3RD-PRTY-PO          PIC X(15) VALUE SPACES.     00983150
009833                                                                  00983350
009834     05  PV-STR-CNT                  PIC S9(09)    COMP           00983450
009835                                                   VALUE ZEROES.  00983550
009836     05  PV-SSCC-CNT                 PIC S9(09)    COMP           00983650
009837                                                   VALUE ZEROES.  00983750
009838     05  PV-UNIT-QTY                 PIC S9(09)    COMP           00983850
009839                                                   VALUE ZEROES.  00983950
009840                                                                  00984050
009841     05  PV-RCVR-STR-CNT             PIC S9(09)    COMP           00984150
009842                                                   VALUE ZEROES.  00984250
009843     05  PV-RCVR-SSCC-CNT            PIC S9(09)    COMP           00984350
009844                                                   VALUE ZEROES.  00984450
009845     05  PV-RCVR-UNIT-QTY            PIC S9(09)    COMP           00984550
009846                                                   VALUE ZEROES.  00984650
009847     05  PV-LINE-RETAIL              PIC S9(10)V99 COMP           00984750
009848                                                   VALUE ZEROES.  00984850
009849     05  PV-RCVR-VE-DATE             PIC  X(10)    VALUE SPACES.  00984950
009850                                                                  00985050
009860                                                                  00986050
009900 01  PV-ABEND-FIELDS.                                             00990004
009910     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         00991004
009920                                                 COMP SYNC.       00992004
009930     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKRP093'.00993004
009940     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00994004
009950     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    00995004
009960     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    00996004
009970     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    00997004
009980     05  PV-ABEND-STRUCTURE-3         PIC  X(08) VALUE SPACES.    00998004
009990     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    00999004
009991     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    00999104
009992     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    00999204
009993     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30) VALUE SPACE.     00999304
009994                                                                  00999404
010000*----------------------------------------------------------------*01000000
010100* INPUT01 COPYBOOK                                               *01010000
010200*----------------------------------------------------------------*01020000
010300     COPY RCRD119.                                                01030001
010400                                                                  01040000
010500*----------------------------------------------------------------*01050000
010600*    STANDARD HEADER FOR 150 COLUMN REPORT                       *01060027
010700*----------------------------------------------------------------*01070000
010800     COPY DPWS200O.                                               01080046
010900                                                                  01090000
011000*----------------------------------------------------------------*01100000
011100*                                                                *01110000
011200*----------------------------------------------------------------*01120000
011300 01  HDR-LINES.                                                   01130000
011400     05  HDR01-LINE.                                              01140000
011500         10  FILLER                  PIC  X(78)    VALUE SPACES.  01150047
011600         10  FILLER                  PIC  X(45)    VALUE          01160001
011700             'VERIFIED RECEIVERS-FROM 3WD PROCESSED CARTONS'.     01170001
011800         10  FILLER                  PIC  X(77)    VALUE SPACES.  01180047
011900                                                                  01190000
012000***  05  HDR02-LINE.                                              01200027
012100***      10  FILLER                  PIC  X(54)    VALUE SPACES.  01210027
012200***      10  FILLER                  PIC  X(14)                   01220027
012300***                                  VALUE '        DATE: '.      01230027
012600***      10  HEADING-2-DATE          PIC  X(10)    VALUE SPACES.  01260027
012700***      10  FILLER                  PIC  X(54)    VALUE SPACES.  01270027
012800                                                                  01280000
012900     05  HDR03-LINE.                                              01290000
013000         10  FILLER                  PIC  X(06)    VALUE          01300000
013100             'OPER: '.                                            01310000
013200         10  HDR03-DC                PIC  ZZZ9.                   01320002
013300         10  FILLER                  PIC  X(02)    VALUE SPACES.  01330000
013400         10  HDR03-DC-DESCRIPTION    PIC  X(40)    VALUE SPACES.  01340002
013500         10  FILLER                  PIC  X(80)    VALUE SPACES.  01350000
013600                                                                  01360000
013700     05  HDR04-LINE.                                              01370000
013800         10  FILLER                  PIC  X(04)  VALUE '3RD '.    01380002
013900         10  FILLER                  PIC  X(01)  VALUE SPACES.    01390002
014000         10  FILLER                  PIC  X(04)  VALUE 'OPER'.    01400002
014001         10  FILLER                  PIC  X(01)  VALUE SPACES.    01400127
014010         10  FILLER                  PIC  X(03)  VALUE 'DPT'.     01401027
014100         10  FILLER                  PIC  X(03)  VALUE SPACES.    01410005
014200         10  FILLER                  PIC  X(06)  VALUE 'VENDOR'.  01420002
014300         10  FILLER                  PIC  X(40)  VALUE SPACES.    01430002
014310         10  FILLER                  PIC  X(05)  VALUE 'KOHLS'.   01431008
014320         10  FILLER                  PIC  X(05)  VALUE SPACES.    01432017
014330         10  FILLER                  PIC  X(11)                   01433002
014331                                          VALUE 'THIRD PARTY'.    01433102
014340         10  FILLER                  PIC  X(16)  VALUE SPACES.    01434002
014350         10  FILLER                  PIC  X(03)  VALUE 'SKU'.     01435002
014360         10  FILLER                  PIC  X(10)  VALUE SPACES.    01436002
014370         10  FILLER                  PIC  X(04)  VALUE 'UNIT'.    01437002
014380         10  FILLER                  PIC  X(12)  VALUE SPACES.    01438002
014390         10  FILLER                  PIC  X(03)  VALUE 'SML'.     01439002
014391         10  FILLER                  PIC  X(10)  VALUE SPACES.    01439131
014392         10  FILLER                  PIC  X(05)  VALUE 'STORE'.   01439230
014393         10  FILLER                  PIC  X(01)  VALUE SPACES.    01439344
014394         10  FILLER                  PIC  X(10)  VALUE            01439444
014395                                          '  VERIFY  '.           01439544
014396         10  FILLER                  PIC  X(01)    VALUE SPACES.  01439644
014397         10  FILLER                  PIC  X(17)  VALUE            01439744
014398                                         '         RETAIL '.      01439844
014399         10  FILLER                  PIC  X(04)  VALUE SPACES.    01439930
014400                                                                  01440000
014500     05  HDR05-LINE.                                              01450000
014510         10  FILLER                  PIC  X(04)  VALUE 'PRTY'.    01451002
014520         10  FILLER                  PIC  X(01)  VALUE SPACES.    01452002
014530         10  FILLER                  PIC  X(04)  VALUE 'UNIT'.    01453002
014531         10  FILLER                  PIC  X(01)  VALUE SPACES.    01453127
014532         10  FILLER                  PIC  X(03)  VALUE 'NBR'.     01453227
014540         10  FILLER                  PIC  X(03)  VALUE SPACES.    01454005
014550         10  FILLER                  PIC  X(06)  VALUE '  ID  '.  01455002
014560         10  FILLER                  PIC  X(02)  VALUE SPACES.    01456002
014561         10  FILLER                  PIC  X(11)                   01456102
014562                                          VALUE 'VENDOR NAME'.    01456202
014563         10  FILLER                  PIC  X(27)  VALUE SPACES.    01456302
014570         10  FILLER                  PIC  X(05)  VALUE ' PO  '.   01457008
014580         10  FILLER                  PIC  X(05)  VALUE SPACES.    01458017
014590         10  FILLER                  PIC  X(11)                   01459002
014591                                          VALUE '  PO NBR   '.    01459102
014592         10  FILLER                  PIC  X(03)  VALUE SPACES.    01459219
014593         10  FILLER                  PIC  X(04)  VALUE 'RCVR'.    01459302
014594         10  FILLER                  PIC  X(01)  VALUE SPACES.    01459402
014595         10  FILLER                  PIC  X(04)  VALUE 'LINE'.    01459502
014596         10  FILLER                  PIC  X(04)  VALUE SPACES.    01459619
014598         10  FILLER                  PIC  X(03)  VALUE 'NBR'.     01459802
014599         10  FILLER                  PIC  X(08)  VALUE SPACES.    01459902
014600         10  FILLER                  PIC  X(08)                   01460002
014601                                          VALUE 'QUANTITY'.       01460102
014602         10  FILLER                  PIC  X(09)  VALUE SPACES.    01460202
014610         10  FILLER                  PIC  X(05)  VALUE 'COUNT'.   01461002
014620         10  FILLER                  PIC  X(09)  VALUE SPACES.    01462030
014630         10  FILLER                  PIC  X(05)  VALUE 'COUNT'.   01463030
014640         10  FILLER                  PIC  X(01)  VALUE SPACES.    01464044
014650         10  FILLER                  PIC  X(10)  VALUE            01465044
014660                                          '   DATE   '.           01466044
014670         10  FILLER                  PIC  X(01)    VALUE SPACES.  01467044
014680         10  FILLER                  PIC  X(17)  VALUE            01468044
014690                                         '         AMOUNT '.      01469044
014700         10  FILLER                  PIC  X(04)  VALUE SPACES.    01470002
015200                                                                  01520000
015300     05  HDR06-LINE.                                              01530000
015310         10  FILLER                  PIC  X(04)  VALUE '----'.    01531002
015320         10  FILLER                  PIC  X(01)  VALUE SPACES.    01532002
015330         10  FILLER                  PIC  X(04)  VALUE '----'.    01533029
015331         10  FILLER                  PIC  X(01)  VALUE SPACES.    01533127
015332         10  FILLER                  PIC  X(03)  VALUE '---'.     01533227
015340         10  FILLER                  PIC  X(01)  VALUE SPACES.    01534005
015350         10  FILLER                  PIC  X(09)                   01535002
015351                                          VALUE '---------'.      01535102
015360         10  FILLER                  PIC  X(01)  VALUE SPACES.    01536002
015370         10  FILLER                  PIC  X(35)  VALUE            01537016
015380             '-----------------------------------'.               01538016
015390         10  FILLER                  PIC  X(01)  VALUE SPACES.    01539002
015392         10  FILLER                  PIC  X(09)                   01539217
015393                                          VALUE '---------'.      01539317
015394         10  FILLER                  PIC  X(01)  VALUE SPACES.    01539402
015395         10  FILLER                  PIC  X(15)  VALUE            01539502
015396                                            '---------------'.    01539602
015397         10  FILLER                  PIC  X(01)  VALUE SPACES.    01539702
015398         10  FILLER                  PIC  X(04)  VALUE '----'.    01539802
015399         10  FILLER                  PIC  X(01)  VALUE SPACES.    01539902
015400         10  FILLER                  PIC  X(04)  VALUE '----'.    01540002
015401         10  FILLER                  PIC  X(01)  VALUE SPACES.    01540102
015402         10  FILLER                  PIC  X(08)                   01540202
015403                                          VALUE '--------'.       01540302
015404         10  FILLER                  PIC  X(01)  VALUE SPACES.    01540402
015406         10  FILLER                  PIC  X(13)  VALUE            01540608
015407                                          '-------------'.        01540702
015408         10  FILLER                  PIC  X(01)  VALUE SPACES.    01540802
015410         10  FILLER                  PIC  X(13)  VALUE            01541008
015411                                          '-------------'.        01541102
015412         10  FILLER                  PIC  X(01)  VALUE SPACES.    01541230
015413         10  FILLER                  PIC  X(13)  VALUE            01541330
015414                                          '-------------'.        01541430
015420         10  FILLER                  PIC  X(01)  VALUE SPACES.    01542044
015430         10  FILLER                  PIC  X(10)  VALUE            01543044
015431                                          '----------'.           01543144
015440         10  FILLER                  PIC  X(01)    VALUE SPACES.  01544044
015450         10  FILLER                  PIC  X(17)  VALUE            01545044
015460                                         '----------------'.      01546044
015470         10  FILLER                  PIC  X(04)  VALUE SPACES.    01547044
016000                                                                  01600000
016100     05  BLANK-LINE                  PIC X(150)    VALUE SPACES.  01610027
016200                                                                  01620000
016300     05  END-OF-REPORT-LINE.                                      01630000
016400         10  FILLER                  PIC  X(43)    VALUE SPACES.  01640000
016500         10  FILLER                  PIC  X(45)    VALUE          01650000
016600             '*******   E N D   O F   R E P O R T   *******'.     01660000
016700         10  FILLER                  PIC  X(44)    VALUE SPACES.  01670000
016800                                                                  01680000
016900     05  NO-DATA-TO-REPORT-LINE.                                  01690000
017000         10  FILLER                  PIC  X(40)    VALUE SPACES.  01700000
017100         10  FILLER                  PIC  X(52)    VALUE          01710000
017200         '*******  N O   D A T A   T O   R E P O R T   *******'.  01720000
017300         10  FILLER                  PIC  X(40)    VALUE SPACES.  01730000
017400                                                                  01740000
017500*----------------------------------------------------------------*01750000
017600*                                                                *01760000
017700*----------------------------------------------------------------*01770000
017800 01  DETAIL-LINES.                                                01780000
017900     05  DTL01-LINE.                                              01790000
018000         10  DTL01-3RD-PRTY          PIC  ZZZ9     VALUE ZEROES.  01800002
018100         10  FILLER                  PIC  X(01)    VALUE SPACES.  01810000
018200         10  DTL01-OPER-UNT          PIC  ZZZ9     VALUE ZEROES.  01820002
018210         10  FILLER                  PIC  X(01)    VALUE SPACES.  01821027
018220         10  DTL01-DEPT-NBR          PIC  X(03)    VALUE SPACES.  01822027
018300         10  FILLER                  PIC  X(01)    VALUE SPACES.  01830000
018400         10  DTL01-VNDR-ID           PIC  Z(09)    VALUE ZEROES.  01840002
018410         10  FILLER                  PIC  X(01)    VALUE SPACES.  01841002
018420         10  DTL01-VNDR-NAME         PIC  X(35)    VALUE SPACES.  01842015
018500         10  FILLER                  PIC  X(01)    VALUE SPACES.  01850000
018600         10  DTL01-KOHLS-PO          PIC  Z(09)    VALUE ZEROES.  01860051
018610         10  FILLER                  PIC  X(01)    VALUE SPACES.  01861002
018620         10  DTL01-3RD-PRTY-PO       PIC  X(15)    VALUE SPACES.  01862002
018700         10  FILLER                  PIC  X(01)    VALUE SPACES.  01870017
018800         10  DTL01-RCVR              PIC  Z(04)    VALUE ZEROES.  01880017
018900         10  FILLER                  PIC  X(01)    VALUE SPACES.  01890017
018910         10  DTL01-LINE-NBR          PIC  Z(04)    VALUE ZEROES.  01891018
018920         10  FILLER                  PIC  X(01)    VALUE SPACES.  01892017
018930         10  DTL01-SKU-NBR           PIC  Z(08)    VALUE ZEROES.  01893051
019000         10  FILLER                  PIC  X(01)    VALUE SPACES.  01900019
019010         10  DTL01-UNIT-CNT          PIC  Z,ZZZ,ZZZ,ZZ9           01901022
019200                                                   VALUE ZEROES.  01920000
019300         10  FILLER                  PIC  X(01)    VALUE SPACES.  01930019
019310         10  DTL01-SSCC-CNT          PIC  Z,ZZZ,ZZZ,ZZ9           01931022
019500                                                   VALUE ZEROES.  01950000
019510         10  FILLER                  PIC  X(01)    VALUE SPACES.  01951031
019520         10  DTL01-STR-CNT           PIC  Z,ZZZ,ZZZ,ZZ9           01952031
019530                                                   VALUE ZEROES.  01953031
019540         10  FILLER                  PIC  X(01)    VALUE SPACES.  01954044
019550         10  DTL01-VE-DATE           PIC  X(10)    VALUE SPACES.  01955048
019560         10  FILLER                  PIC  X(01)    VALUE SPACES.  01956044
019570         10  DTL01-RETAIL            PIC  Z,ZZZ,ZZZ,ZZ9.99        01957045
019580                                                   VALUE ZEROES.  01958044
019600         10  FILLER                  PIC  X(02)    VALUE SPACES.  01960000
019700                                                                  01970000
019800*----------------------------------------------------------------*01980000
019900*                                                                *01990000
020000*----------------------------------------------------------------*02000000
020100 01  TOTAL-LINES.                                                 02010000
020200     05  TOT01-RCVR-TOTAL.                                        02020036
020201         10  TOT01-3RD-PRTY          PIC  ZZZ9     VALUE ZEROES.  02020149
020202         10  FILLER                  PIC  X(01)    VALUE SPACES.  02020249
020300         10  TOT01-DC                PIC  ZZZ9     VALUE ZEROES.  02030034
020310         10  FILLER                  PIC  X(01)    VALUE SPACES.  02031049
020320         10  TOT01-DEPT-NBR          PIC  X(03)    VALUE SPACES.  02032049
020400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02040049
020500         10  FILLER                  PIC  X(12)    VALUE          02050034
020600                                          'RCVR TOTALS:'.         02060034
020601         10  FILLER                  PIC  X(31)    VALUE SPACES.  02060140
020610         10  TOT01-KOHLS-PO          PIC  Z(09)    VALUE ZEROES.  02061051
020611         10  FILLER                  PIC  X(01)    VALUE SPACES.  02061149
020612         10  TOT01-3RD-PRTY-PO       PIC  X(15)    VALUE SPACES.  02061249
020613         10  FILLER                  PIC  X(01)    VALUE SPACES.  02061349
020650         10  TOT01-RCVR              PIC  Z(04)    VALUE ZEROES.  02065038
020700         10  FILLER                  PIC  X(15)    VALUE SPACES.  02070041
020710         10  TOT01-UNIT-CNT          PIC  Z,ZZZ,ZZZ,ZZ9           02071034
020720                                                   VALUE ZEROES.  02072034
020730         10  FILLER                  PIC  X(01)    VALUE SPACES.  02073034
020740         10  TOT01-SSCC-CNT          PIC  Z,ZZZ,ZZZ,ZZ9           02074034
020750                                                   VALUE ZEROES.  02075034
020760         10  FILLER                  PIC  X(01)    VALUE SPACES.  02076034
020770         10  TOT01-STR-CNT           PIC  Z,ZZZ,ZZZ,ZZ9           02077034
020780                                                   VALUE ZEROES.  02078034
021600         10  FILLER                  PIC  X(02)    VALUE '**'.    02160041
021700                                                                  02170000
022410*----------------------------------------------------------------*02241003
022420*  XLT00010 - DC LOCATION TABLE                                   02242003
022430*----------------------------------------------------------------*02243003
022440     EXEC SQL                                                     02244003
022450          INCLUDE XLT00010                                        02245003
022460     END-EXEC.                                                    02246003
022470                                                                  02247003
022480*----------------------------------------------------------------*02248003
022490*  TPURCHS                                                        02249004
022491*----------------------------------------------------------------*02249103
022492     EXEC SQL                                                     02249203
022493          INCLUDE TPURCHS                                         02249304
022494     END-EXEC.                                                    02249403
022495                                                                  02249503
022496*----------------------------------------------------------------*02249644
022497*  TPURITM                                                        02249744
022498*----------------------------------------------------------------*02249844
022499     EXEC SQL                                                     02249944
022500          INCLUDE TPURITM                                         02250044
022501     END-EXEC.                                                    02250144
022502                                                                  02250244
022503*----------------------------------------------------------------*02250348
022504*  TRECITM                                                        02250448
022505*----------------------------------------------------------------*02250548
022506     EXEC SQL                                                     02250648
022507          INCLUDE TRECITM                                         02250748
022508     END-EXEC.                                                    02250848
022509                                                                  02250948
022510*----------------------------------------------------------------*02251004
022511*  TENTNME                                                        02251104
022512*----------------------------------------------------------------*02251204
022513     EXEC SQL                                                     02251304
022514          INCLUDE TENTNME                                         02251404
022515     END-EXEC.                                                    02251504
022516                                                                  02251604
022517*----------------------------------------------------------------*02251734
022518*  SUT_OTBND_CART                                                 02251834
022519*----------------------------------------------------------------*02251934
022520     EXEC SQL                                                     02252034
022521          INCLUDE SUT00024                                        02252134
022522     END-EXEC.                                                    02252234
022523                                                                  02252334
022524*----------------------------------------------------------------*02252434
022525*  SUT_OTBND_UPC                                                  02252534
022526*----------------------------------------------------------------*02252634
022527     EXEC SQL                                                     02252734
022528          INCLUDE SUT00028                                        02252834
022529     END-EXEC.                                                    02252934
022530                                                                  02253034
022540*----------------------------------------------------------------*02254000
022600*  DB2 AREA FOR COMMUNICATIONS                                    02260000
022700*----------------------------------------------------------------*02270000
022800     EXEC SQL                                                     02280000
022900          INCLUDE SQLCA                                           02290000
023000     END-EXEC.                                                    02300000
023100                                                                  02310000
023200     COPY SQLCA2.                                                 02320000
023300                                                                  02330000
023400*----------------------------------------------------------------*02340000
023500*                                                                 02350000
023600*----------------------------------------------------------------*02360000
023700 PROCEDURE DIVISION.                                              02370000
023800                                                                  02380000
023900     DISPLAY '*** START - RCKRP093 ***'.                          02390000
024000     DISPLAY ' '.                                                 02400000
024100                                                                  02410000
024200                                                                  02420000
024300*----------------------------------------------------------------*02430000
024400*                                                                 02440000
024500*----------------------------------------------------------------*02450000
024600 0000-MAINLINE.                                                   02460000
024700                                                                  02470000
024800     PERFORM 0010-INITIALIZATION.                                 02480000
024900                                                                  02490000
025000     PERFORM 1000-PROCESS-INPUT                                   02500000
025100       UNTIL PS-EOF-INPUT.                                        02510000
025200                                                                  02520000
025300     WRITE REPORT-RECORD                                          02530000
025400      FROM END-OF-REPORT-LINE                                     02540000
025500     AFTER ADVANCING 3 LINES.                                     02550000
025600                                                                  02560000
026200     CLOSE INPUT01-FILE                                           02620000
026300           REPORT-FILE.                                           02630000
026400                                                                  02640000
026500     GOBACK.                                                      02650000
026600                                                                  02660000
026700                                                                  02670000
026800*----------------------------------------------------------------*02680000
026900*                                                                 02690000
027000*----------------------------------------------------------------*02700000
027100 0010-INITIALIZATION.                                             02710000
027200                                                                  02720000
027400     OPEN INPUT  INPUT01-FILE                                     02740003
027500          OUTPUT REPORT-FILE.                                     02750000
027600                                                                  02760000
030100     ACCEPT PV-TODAYS-DATE   FROM DATE.                           03010000
030200     ACCEPT PV-TODAYS-TIME   FROM TIME.                           03020000
030300                                                                  03030000
030400     MOVE PV-TODAYS-DATE-MM      TO DP200O-RUN-MONTH.             03040046
030500     MOVE PV-TODAYS-DATE-DD      TO DP200O-RUN-DAY.               03050046
030600     MOVE PV-TODAYS-DATE-YY      TO DP200O-RUN-YEAR.              03060046
030700     MOVE PV-TODAYS-TIME-HH      TO DP200O-RUN-HOUR.              03070046
030800     MOVE PV-TODAYS-TIME-MM      TO DP200O-RUN-MINUTE.            03080046
030900     MOVE PC-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          03090046
031000     MOVE PC-REPORT-NBR          TO DP200O-REPORT-NUMBER.         03100046
031100                                                                  03110000
031200     PERFORM 7000-READ-INPUT.                                     03120000
031300                                                                  03130000
031400     IF  PS-EOF-INPUT                                             03140000
031500         PERFORM 9040-PAGE-HEADERS                                03150000
031600         WRITE REPORT-RECORD                                      03160000
031700          FROM NO-DATA-TO-REPORT-LINE                             03170000
031800         AFTER ADVANCING 2 LINES                                  03180000
031900     ELSE                                                         03190000
032000                                                                  03200000
032100         PERFORM 2000-GET-OPER-NAME                               03210000
032200         PERFORM 9040-PAGE-HEADERS                                03220000
032300                                                                  03230000
032310         MOVE RC119-STORE-SUPPORT-DC-NBR                          03231008
032400                                    TO PV-OPER-UNT-ID             03240010
032500                                       PV-PREV-OPER-UNT-ID        03250010
032510                                       PV-PREV-SUPPORT-DC-NBR     03251010
032511                                                                  03251110
032520         MOVE RC119-KOHLS-PO-NBR   TO  PV-PREV-KOHLS-PO-NBR       03252010
032530         MOVE RC119-REC-SEQ-NBR    TO  PV-PREV-REC-SEQ-NBR        03253010
032531         MOVE RC119-KOHLS-PO-LINE-NBR                             03253110
032540                                   TO  PV-PREV-KOHLS-PO-LINE-NBR  03254010
032550         MOVE RC119-SML-NBR-NUM    TO  PV-PREV-SML-NBR-NUM        03255010
032551         MOVE RC119-DEST-STORE-NBR TO  PV-PREV-DEST-STORE-NBR     03255132
032552                                                                  03255250
032553         MOVE RC119-3RD-PRTY-DC-NBR    TO  PV-PREV-3RD-PRTY       03255350
032555         MOVE RC119-3RD-PRTY-ORDER-NBR TO  PV-PREV-3RD-PRTY-PO    03255550
032556                                                                  03255650
032557         ADD  1                    TO  PV-STR-CNT                 03255750
032560                                                                  03256010
032590         PERFORM 3000-GET-VENDOR-INFO                             03259014
032591         PERFORM 3020-GET-PURITM-INFO                             03259144
032595                                                                  03259514
032596         MOVE RC119-3RD-PRTY-DC-NBR       TO  DTL01-3RD-PRTY      03259614
032597         MOVE RC119-STORE-SUPPORT-DC-NBR  TO  DTL01-OPER-UNT      03259714
032598         MOVE PURCHS-ENT-ID               TO  DTL01-VNDR-ID       03259814
032599         MOVE PURCHS-DEPT-NBR             TO  DTL01-DEPT-NBR      03259927
032600                                              PV-PREV-DEPT-NBR    03260050
032601         MOVE ENTNME-ENT-NAME-DESC        TO  DTL01-VNDR-NAME     03260127
032602         MOVE RC119-KOHLS-PO-NBR          TO  DTL01-KOHLS-PO      03260227
032603         MOVE RC119-SEPHORA-PO-NBR        TO  DTL01-3RD-PRTY-PO   03260327
032604         MOVE RC119-SKU-NBR               TO  DTL01-SKU-NBR       03260427
032605         MOVE RC119-REC-SEQ-NBR           TO  DTL01-RCVR          03260527
032606         MOVE RC119-KOHLS-PO-LINE-NBR     TO  DTL01-LINE-NBR      03260627
032610     END-IF.                                                      03261017
032700                                                                  03270000
032800                                                                  03280000
032900*----------------------------------------------------------------*03290000
033000*                                                                 03300000
033100*----------------------------------------------------------------*03310000
033200 1000-PROCESS-INPUT.                                              03320000
033300                                                                  03330000
034400                                                                  03440000
034410     IF  RC119-STORE-SUPPORT-DC-NBR =  PV-PREV-SUPPORT-DC-NBR     03441010
034460         AND  RC119-KOHLS-PO-NBR    =  PV-PREV-KOHLS-PO-NBR       03446010
034470         AND  RC119-REC-SEQ-NBR     =  PV-PREV-REC-SEQ-NBR        03447010
034480         AND  RC119-KOHLS-PO-LINE-NBR                             03448010
034490                                    =  PV-PREV-KOHLS-PO-LINE-NBR  03449010
034497         ADD  1                    TO  PV-SSCC-CNT                03449711
034498         ADD  RC119-SHIP-UNT-QTY   TO  PV-UNIT-QTY                03449811
034499         IF  RC119-DEST-STORE-NBR =  PV-PREV-DEST-STORE-NBR       03449931
034500             CONTINUE                                             03450031
034501         ELSE                                                     03450131
034502             ADD  1                    TO  PV-STR-CNT             03450231
034503         END-IF                                                   03450331
034504     ELSE                                                         03450410
034505         MOVE PV-STR-CNT              TO  DTL01-STR-CNT           03450531
034506         MOVE PV-SSCC-CNT             TO  DTL01-SSCC-CNT          03450631
034507         MOVE PV-UNIT-QTY             TO  DTL01-UNIT-CNT          03450731
034508         MULTIPLY PV-UNIT-QTY                                     03450844
034509               BY PURITM-UNT-RTL-PR-AMT                           03450944
034510           GIVING PV-LINE-RETAIL                                  03451044
034511         MOVE PV-LINE-RETAIL          TO  DTL01-RETAIL            03451144
034512         MOVE PV-RCVR-VE-DATE         TO  DTL01-VE-DATE           03451248
034513         PERFORM 9000-REPORT-DETAIL                               03451344
034514         MOVE ZEROES  TO  PV-SSCC-CNT                             03451444
034515                          PV-UNIT-QTY                             03451544
034516                          PV-STR-CNT                              03451644
034517                          PV-PREV-DEST-STORE-NBR                  03451744
034518                                                                  03451844
034519         IF  RC119-STORE-SUPPORT-DC-NBR                           03451944
034520                                    NOT = PV-PREV-OPER-UNT-ID     03452044
034521             PERFORM 3010-GET-RCVR-COUNTS                         03452144
034522             PERFORM 9010-WRITE-RCVR-TOTALS                       03452244
034523             PERFORM 9005-BLANK-LINE                              03452344
034524             PERFORM 2000-GET-OPER-NAME                           03452444
034525             PERFORM 9040-PAGE-HEADERS                            03452544
034526         ELSE                                                     03452644
034527             IF   RC119-KOHLS-PO-NBR  =  PV-PREV-KOHLS-PO-NBR  AND03452744
034528                  RC119-REC-SEQ-NBR   =  PV-PREV-REC-SEQ-NBR      03452844
034529                  CONTINUE                                        03452944
034530             ELSE                                                 03453044
034531                 PERFORM 3010-GET-RCVR-COUNTS                     03453144
034532                 PERFORM 9010-WRITE-RCVR-TOTALS                   03453244
034533                 PERFORM 9005-BLANK-LINE                          03453344
034534             END-IF                                               03453444
034535         END-IF                                                   03453544
034536                                                                  03453644
034537         MOVE RC119-STORE-SUPPORT-DC-NBR                          03453744
034538                                   TO  PV-OPER-UNT-ID             03453844
034539                                       PV-PREV-OPER-UNT-ID        03453944
034540                                       PV-PREV-SUPPORT-DC-NBR     03454044
034541         MOVE RC119-KOHLS-PO-NBR   TO  PV-PREV-KOHLS-PO-NBR       03454144
034542         MOVE RC119-REC-SEQ-NBR    TO  PV-PREV-REC-SEQ-NBR        03454244
034543         MOVE RC119-KOHLS-PO-LINE-NBR                             03454344
034544                                   TO  PV-PREV-KOHLS-PO-LINE-NBR  03454444
034545         MOVE RC119-SML-NBR-NUM    TO  PV-PREV-SML-NBR-NUM        03454544
034546         MOVE RC119-DEST-STORE-NBR TO  PV-PREV-DEST-STORE-NBR     03454644
034547                                                                  03454750
034548         MOVE RC119-3RD-PRTY-DC-NBR    TO  PV-PREV-3RD-PRTY       03454850
034549         MOVE RC119-3RD-PRTY-ORDER-NBR TO  PV-PREV-3RD-PRTY-PO    03454950
034550                                                                  03455050
034551         PERFORM 3000-GET-VENDOR-INFO                             03455144
034552         PERFORM 3020-GET-PURITM-INFO                             03455244
034553                                                                  03455344
034554         MOVE RC119-3RD-PRTY-DC-NBR       TO  DTL01-3RD-PRTY      03455444
034555         MOVE RC119-STORE-SUPPORT-DC-NBR  TO  DTL01-OPER-UNT      03455544
034556         MOVE PURCHS-ENT-ID               TO  DTL01-VNDR-ID       03455644
034557         MOVE PURCHS-DEPT-NBR             TO  DTL01-DEPT-NBR      03455744
034558                                              PV-PREV-DEPT-NBR    03455850
034559         MOVE ENTNME-ENT-NAME-DESC        TO  DTL01-VNDR-NAME     03455944
034560         MOVE RC119-KOHLS-PO-NBR          TO  DTL01-KOHLS-PO      03456044
034561         MOVE RC119-SEPHORA-PO-NBR        TO  DTL01-3RD-PRTY-PO   03456144
034562         MOVE RC119-SKU-NBR               TO  DTL01-SKU-NBR       03456244
034563         MOVE RC119-REC-SEQ-NBR           TO  DTL01-RCVR          03456344
034564         MOVE RC119-KOHLS-PO-LINE-NBR     TO  DTL01-LINE-NBR      03456444
034565                                                                  03456544
034566         ADD  1                    TO  PV-STR-CNT                 03456644
034567         ADD  1                    TO  PV-SSCC-CNT                03456744
034568         ADD  RC119-SHIP-UNT-QTY   TO  PV-UNIT-QTY                03456844
034570     END-IF.                                                      03457010
035800                                                                  03580000
035900     PERFORM 7000-READ-INPUT.                                     03590000
036000                                                                  03600000
036100     IF  PS-EOF-INPUT                                             03610000
036110         MOVE PV-STR-CNT              TO  DTL01-STR-CNT           03611031
036111         MOVE PV-SSCC-CNT             TO  DTL01-SSCC-CNT          03611131
036120         MOVE PV-UNIT-QTY             TO  DTL01-UNIT-CNT          03612026
036121         MULTIPLY PV-UNIT-QTY                                     03612144
036122               BY PURITM-UNT-RTL-PR-AMT                           03612244
036123           GIVING PV-LINE-RETAIL                                  03612344
036124         MOVE PV-LINE-RETAIL          TO  DTL01-RETAIL            03612444
036125         MOVE PV-RCVR-VE-DATE         TO  DTL01-VE-DATE           03612548
036130         PERFORM 9000-REPORT-DETAIL                               03613026
036131         PERFORM 3010-GET-RCVR-COUNTS                             03613142
036140         PERFORM 9010-WRITE-RCVR-TOTALS                           03614034
036300     END-IF.                                                      03630000
036400                                                                  03640000
036500                                                                  03650000
036600*----------------------------------------------------*            03660000
036700* GET OPER UNIT NAME                                 *            03670000
036800*----------------------------------------------------*            03680000
036900 2000-GET-OPER-NAME.                                              03690000
037000                                                                  03700000
037100     MOVE RC119-STORE-SUPPORT-DC-NBR TO XLT00010-LOC-NBR.         03710008
037200                                                                  03720000
037300     EXEC SQL                                                     03730000
037400         SELECT A.LOC_NM                                          03740000
037500           INTO :XLT00010-LOC-NM                                  03750000
037600           FROM XLT_LOC A                                         03760000
037700          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 03770000
037800           WITH UR                                                03780000
037900     END-EXEC.                                                    03790000
038000                                                                  03800000
038100     EVALUATE TRUE                                                03810000
038200       WHEN SQLCODE = ZERO                                        03820000
038300           MOVE XLT00010-LOC-NBR TO HDR03-DC                      03830008
038400           MOVE XLT00010-LOC-NM  TO HDR03-DC-DESCRIPTION          03840008
038500                                                                  03850000
038600       WHEN OTHER                                                 03860000
038700           MOVE ZEROES           TO HDR03-DC                      03870008
038800           MOVE SPACES           TO HDR03-DC-DESCRIPTION          03880008
038900                                                                  03890000
039000     END-EVALUATE.                                                03900000
039100                                                                  03910000
039200                                                                  03920000
039201*----------------------------------------------------*            03920104
039202*                                                    *            03920204
039203*----------------------------------------------------*            03920304
039210 3000-GET-VENDOR-INFO.                                            03921004
039211                                                                  03921104
039212     MOVE RC119-KOHLS-PO-NBR  TO  PURCHS-PO-NBR.                  03921204
039213                                                                  03921304
039214     EXEC SQL                                                     03921404
039215         SELECT A.ENT_ID                                          03921504
039216              , A.DEPT_NBR                                        03921627
039217              , B.ENT_NAME_DESC                                   03921727
039218           INTO :PURCHS-ENT-ID                                    03921827
039219              , :PURCHS-DEPT-NBR                                  03921927
039220              , :ENTNME-ENT-NAME-DESC                             03922027
039221           FROM TPURCHS A                                         03922127
039222              , TENTNME B                                         03922227
039223          WHERE A.PO_NBR          = :PURCHS-PO-NBR                03922327
039224            AND A.VER_STATUS_CDE  = 'A'                           03922427
039225            AND A.ENT_ID          =  B.ENT_ID                     03922527
039226            AND B.TYPE_CDE        = '01'                          03922627
039227           WITH UR                                                03922727
039228     END-EXEC.                                                    03922827
039229                                                                  03922927
039230     EVALUATE TRUE                                                03923027
039231       WHEN SQLCODE = ZERO                                        03923127
039232            CONTINUE                                              03923227
039233                                                                  03923327
039234       WHEN OTHER                                                 03923427
039235             MOVE '3000-GET-VENDOR-INFO '                         03923527
039236                           TO PV-ABEND-PARAGRAPH                  03923627
039237             MOVE 'SELECT         '   TO PV-DB2-FUNCTION          03923727
039238             MOVE 'TPURCHS        '   TO PV-DB2-TABLE-NAME-1      03923827
039239             MOVE 'TENTNME        '   TO PV-DB2-TABLE-NAME-2      03923927
039240             PERFORM 9200-SQL-ABEND                               03924027
039241     END-EVALUATE.                                                03924127
039242                                                                  03924227
039243                                                                  03924334
039244*----------------------------------------------------*            03924434
039245*                                                    *            03924534
039246*----------------------------------------------------*            03924634
039247 3010-GET-RCVR-COUNTS.                                            03924734
039248                                                                  03924834
039249     MOVE PV-PREV-KOHLS-PO-NBR TO  SUT00028-TRN-NBR.              03924934
039250     MOVE PV-PREV-REC-SEQ-NBR  TO  SUT00028-RCVR-SEQ-NBR.         03925034
039251                                                                  03925134
039257     EXEC SQL                                                     03925734
039258         SELECT COUNT(DISTINCT(A.DEST_LOC_NBR))                   03925834
039259              , COUNT(DISTINCT(A.SHIPT_UNT_ID))                   03925934
039260              , SUM(B.SHPD_UNT_QTY)                               03926034
039261           INTO :PV-RCVR-STR-CNT                                  03926134
039262              , :PV-RCVR-SSCC-CNT                                 03926234
039263              , :PV-RCVR-UNIT-QTY                                 03926334
039264           FROM SUT_OTBND_CART A                                  03926434
039265              , SUT_OTBND_UPC B                                   03926534
039266          WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID                 03926635
039267            AND A.ACTV_IND      = 'Y'                             03926735
039268            AND B.TRN_NBR       = :SUT00028-TRN-NBR               03926835
039269            AND B.RCVR_SEQ_NBR  = :SUT00028-RCVR-SEQ-NBR          03926935
039270           WITH UR                                                03927034
039271     END-EXEC.                                                    03927134
039272                                                                  03927234
039273     EVALUATE TRUE                                                03927334
039274       WHEN SQLCODE = ZERO                                        03927434
039275            CONTINUE                                              03927534
039276                                                                  03927634
039277       WHEN OTHER                                                 03927734
039278             MOVE '3010-GET-RCVR-COUNTS '                         03927834
039279                           TO PV-ABEND-PARAGRAPH                  03927934
039280             MOVE 'SELECT         '   TO PV-DB2-FUNCTION          03928034
039281             MOVE 'SUT_OTBND_CART '   TO PV-DB2-TABLE-NAME-1      03928134
039282             MOVE 'SUT_OTBND_UPC  '   TO PV-DB2-TABLE-NAME-2      03928234
039283             DISPLAY '3010-GET-RCVR-COUNTS '                      03928334
039284                      PV-PREV-KOHLS-PO-NBR '-'                    03928434
039285                      PV-PREV-REC-SEQ-NBR                         03928534
039286             PERFORM 9200-SQL-ABEND                               03928634
039287     END-EVALUATE.                                                03928734
039288                                                                  03928834
039289                                                                  03928934
039290*----------------------------------------------------*            03929044
039291*                                                    *            03929144
039292*----------------------------------------------------*            03929244
039293 3020-GET-PURITM-INFO.                                            03929344
039294                                                                  03929444
039295     MOVE RC119-KOHLS-PO-NBR      TO  PURITM-PO-NBR.              03929544
039296     MOVE RC119-KOHLS-PO-LINE-NBR TO  PURITM-PO-LNE-NBR.          03929644
039297     MOVE RC119-REC-SEQ-NBR       TO  RECITM-REC-SEQ-NBR.         03929748
039298                                                                  03929848
039299     EXEC SQL                                                     03929948
039300         SELECT A.UNT_RTL_PR_AMT                                  03930048
039301              , DATE(B.VERFYD_TMST)                               03930148
039302           INTO :PURITM-UNT-RTL-PR-AMT                            03930244
039303              , :PV-RCVR-VE-DATE                                  03930348
039305           FROM TPURITM A                                         03930548
039306              , TRECITM B                                         03930648
039307          WHERE A.PO_NBR        = :PURITM-PO-NBR                  03930748
039308            AND A.PO_LNE_NBR    = :PURITM-PO-LNE-NBR              03930848
039309            AND A.VER_STATUS_CDE  = 'A'                           03930948
039310            AND A.PO_NBR        = B.ORD_NBR                       03931048
039311            AND A.PO_LNE_NBR    = B.ORD_LNE_NBR                   03931148
039312            AND B.REC_SEQ_NBR   = :RECITM-REC-SEQ-NBR             03931248
039314            AND B.VER_STATUS_CDE  = 'A'                           03931448
039315           WITH UR                                                03931548
039316     END-EXEC.                                                    03931648
039317                                                                  03931748
039318     EVALUATE TRUE                                                03931848
039319       WHEN SQLCODE = ZERO                                        03931948
039320            CONTINUE                                              03932048
039321                                                                  03932148
039322       WHEN OTHER                                                 03932248
039323             MOVE '3020-GET-PURITM-INFO '                         03932348
039324                           TO PV-ABEND-PARAGRAPH                  03932448
039325             MOVE 'SELECT         '   TO PV-DB2-FUNCTION          03932548
039326             MOVE 'TPURITM        '   TO PV-DB2-TABLE-NAME-1      03932648
039327             MOVE 'RECITM         '   TO PV-DB2-TABLE-NAME-2      03932748
039328             DISPLAY '3020-GET-PURITM-INFO '                      03932848
039329                     RC119-KOHLS-PO-NBR  '-'                      03932948
039330                     RC119-REC-SEQ-NBR   '-'                      03933048
039331                     RC119-KOHLS-PO-LINE-NBR                      03933148
039332             PERFORM 9200-SQL-ABEND                               03933248
039333     END-EVALUATE.                                                03933348
039334                                                                  03933448
039335                                                                  03933548
039340*----------------------------------------------------*            03934000
039400* READ INPUT FILE                                    *            03940000
039500*----------------------------------------------------*            03950000
039600 7000-READ-INPUT.                                                 03960000
039700                                                                  03970000
039800     READ INPUT01-FILE                                            03980000
039900          INTO  RC119-VALID-SHIPMENT-REC                          03990009
040000        AT END SET  PS-EOF-INPUT  TO TRUE.                        04000000
040100                                                                  04010000
040200                                                                  04020000
040300*----------------------------------------------------*            04030000
040400* WRITE DETAIL REPORT LINE                           *            04040000
040500*----------------------------------------------------*            04050000
040600 9000-REPORT-DETAIL.                                              04060000
040700                                                                  04070000
040800     WRITE REPORT-RECORD FROM DTL01-LINE                          04080000
040900            AFTER ADVANCING 1 LINE.                               04090000
041000                                                                  04100000
041100     ADD  +1 TO PV-LINE-CNT                                       04110000
041200                PV-NBR-OF-LINES.                                  04120000
041300                                                                  04130000
041400     IF  PV-LINE-CNT  >  PV-LINE-LIMIT                            04140000
041500         PERFORM 9040-PAGE-HEADERS                                04150000
041600     END-IF.                                                      04160000
041700                                                                  04170000
041800                                                                  04180000
041801*----------------------------------------------------*            04180122
041802* WRITE BLANK LINE                                   *            04180222
041803*----------------------------------------------------*            04180322
041810 9005-BLANK-LINE.                                                 04181022
041820                                                                  04182022
041830     WRITE REPORT-RECORD FROM BLANK-LINE                          04183022
041840            AFTER ADVANCING 1 LINE.                               04184022
041850                                                                  04185022
041860     ADD  +1 TO PV-LINE-CNT                                       04186022
041870                PV-NBR-OF-LINES.                                  04187022
041880                                                                  04188022
041890     IF  PV-LINE-CNT  >  PV-LINE-LIMIT                            04189022
041891         PERFORM 9040-PAGE-HEADERS                                04189122
041892     END-IF.                                                      04189222
041893                                                                  04189322
041894                                                                  04189422
041900*----------------------------------------------------*            04190000
042000* WRITE RECEIVER TOTAL LINE                          *            04200034
042100*----------------------------------------------------*            04210000
042110 9010-WRITE-RCVR-TOTALS.                                          04211034
042300                                                                  04230000
042400     MOVE PV-PREV-3RD-PRTY     TO  TOT01-3RD-PRTY.                04240049
042401     MOVE PV-PREV-OPER-UNT-ID  TO  TOT01-DC.                      04240149
042402     MOVE PV-PREV-DEPT-NBR     TO  TOT01-DEPT-NBR.                04240249
042410     MOVE PV-PREV-KOHLS-PO-NBR TO  TOT01-KOHLS-PO.                04241038
042420     MOVE PV-PREV-3RD-PRTY-PO  TO  TOT01-3RD-PRTY-PO.             04242049
042430     MOVE PV-PREV-REC-SEQ-NBR  TO  TOT01-RCVR.                    04243038
042500     MOVE PV-RCVR-UNIT-QTY     TO  TOT01-UNIT-CNT.                04250034
042600     MOVE PV-RCVR-SSCC-CNT     TO  TOT01-SSCC-CNT.                04260034
042700     MOVE PV-RCVR-STR-CNT      TO  TOT01-STR-CNT.                 04270034
042800                                                                  04280000
042900     WRITE REPORT-RECORD FROM TOT01-RCVR-TOTAL                    04290036
043000            AFTER ADVANCING 2 LINE.                               04300000
043100                                                                  04310000
043200     MOVE ZEROES  TO  PV-RCVR-UNIT-QTY                            04320034
043300                      PV-RCVR-SSCC-CNT                            04330034
043400                      PV-RCVR-STR-CNT .                           04340034
043500                                                                  04350000
043600                                                                  04360000
043700*----------------------------------------------------*            04370000
043800* WRITE PAGE HEADERS                                 *            04380000
043900*----------------------------------------------------*            04390000
044000 9040-PAGE-HEADERS.                                               04400000
044100                                                                  04410000
044200     ADD +1           TO PV-PAGE-CNT.                             04420000
044300     MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                      04430046
044400                                                                  04440000
044500     WRITE REPORT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS      04450046
044600            AFTER ADVANCING PAGE.                                 04460000
044700     WRITE REPORT-RECORD FROM HDR01-LINE                          04470000
044800            AFTER ADVANCING 1 LINE.                               04480000
044900                                                                  04490000
045000     MOVE +2 TO PV-LINE-CNT.                                      04500000
045100                                                                  04510000
045400     WRITE REPORT-RECORD FROM HDR03-LINE                          04540000
045500            AFTER ADVANCING 2 LINE.                               04550028
045510     WRITE REPORT-RECORD FROM BLANK-LINE                          04551025
045520            AFTER ADVANCING 1 LINES.                              04552025
045600     WRITE REPORT-RECORD FROM HDR04-LINE                          04560000
045700            AFTER ADVANCING 1 LINE.                               04570000
045800     WRITE REPORT-RECORD FROM HDR05-LINE                          04580000
045900            AFTER ADVANCING 1 LINES.                              04590000
046000     WRITE REPORT-RECORD FROM HDR06-LINE                          04600000
046100            AFTER ADVANCING 1 LINES.                              04610000
046200                                                                  04620000
046300     ADD  +6 TO PV-LINE-CNT.                                      04630028
046400                                                                  04640000
046500******************************************************************04650004
046600 9200-SQL-ABEND.                                                  04660004
046700******************************************************************04670004
046800                                                                  04680004
047500                                                                  04750004
047600     MOVE SQLCODE                     TO SQLCODE2.                04760004
047700     MOVE SQLERRD(3)                  TO SQLERRD3.                04770004
047800                                                                  04780004
047900     DISPLAY '** ABEND **         ** = SQLERROR'.                 04790004
048000     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                04800009
048100     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             04810004
048200     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME-1.            04820004
048300     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME-2.            04830004
048400     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                04840004
048500     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     04850004
048600     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     04860004
048700     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     04870004
048900                                                                  04890004
049000     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                04900004
049100     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                04910004
049200     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 04920004
049300     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                04930004
049400                                                                  04940004
049500                                                                  04950004
049600     MOVE +4013                       TO PV-ABEND-CODE.           04960004
049700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04970004
049800                                                                  04980004
