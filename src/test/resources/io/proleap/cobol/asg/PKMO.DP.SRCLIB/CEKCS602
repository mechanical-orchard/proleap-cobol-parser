000100*-----------------------*                                         00010039
000200 IDENTIFICATION DIVISION.                                         00020039
000300*-----------------------*                                         00030039
000400 PROGRAM-ID.    CEKCS602.                                         00040039
000500 AUTHOR.        DENISE HAHN.                                      00050039
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060039
000700 DATE-WRITTEN.  12-14-1999.                                       00070039
000800 DATE-COMPILED.                                                   00080039
000900                                                                  00090039
001000*---------------------------------------------------------------* 00100039
001100*    S602 - CENTRAL STOCK INTERFACE - PULL ITEM LIST            * 00110039
001200*                                                               * 00120039
001300*---------------------------------------------------------------* 00130039
001310*----------------------------------------------------------------*00131055
001320* 04/28/2010 - DJK - CHANGES MADE FOR EFC2 WR 38216              *00132056
001330*----------------------------------------------------------------*00133056
001331* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00133156
001332* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00133256
001333* MAKING THE CALL DYNAMIC VS STATIC.                              00133356
001334*----------------------------------------------------------------*00133456
001335* CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00133556
001336* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00133656
001337* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00133756
001338*-----------------------------------------------------------------00133856
001339                                                                  00133956
001400 EJECT                                                            00140039
001500 ENVIRONMENT DIVISION.                                            00150039
001600                                                                  00160039
001700 DATA DIVISION.                                                   00170039
001800                                                                  00180039
001900 WORKING-STORAGE SECTION.                                         00190039
002000                                                                  00200039
002100 01  DK-DB2-KEYS.                                                 00210039
002200     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00220039
002300                                                    COMP.         00230039
002400     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00240039
002500     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00250039
002600                                                    COMP.         00260039
002700     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00270039
002800     15  DK-DUMMY-FIELD                 PIC S9(01)  VALUE ZERO    00280039
002900                                                    COMP.         00290039
003000     15  DK-RDM-PULL-NUMBER             PIC S9(09)  VALUE ZERO    00300039
003100                                                    COMP.         00310039
003200     15  DK-RDM-LINE-NUMBER             PIC S9(04)  VALUE ZERO    00320039
003300                                                    COMP.         00330039
003400     15  DK-LOC-ID                      PIC S9(04)  VALUE ZERO    00340039
003500                                                    COMP.         00350039
003600                                                                  00360039
003700 01  PC-PROGRAM-CONSTANTS.                                        00370039
003710     05  PC-SPACE                  PIC  X(01)  VALUE ' '.         00371056
003800     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE602A  '.  00380039
003900     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM602 '.  00390039
004000     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS602'.  00400039
004100     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00410039
004200     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'CEKCS609'.  00420039
004300     05  PC-PRINT-PROGRAM          PIC  X(08)  VALUE 'CEKCS609'.  00430039
004400     05  PC-CONFIRM-MODULE         PIC  X(08)  VALUE 'CEKCS610'.  00440039
004500     05  PC-RDM-AUTO-PROCESS       PIC  X(08)  VALUE 'WMKUP015'.  00450039
004600     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00460039
004700     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00470039
004800     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00480039
004900     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00490039
005000     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00500039
005100                                               COMP SYNC.         00510039
005200     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00520039
005300                                               COMP SYNC.         00530039
005400     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00540039
005500                                               COMP-3.            00550039
005600     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00560039
005700                                               COMP SYNC.         00570039
005800     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00580039
005900                                               COMP-3.            00590039
006000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00600039
006100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00610039
006200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00620039
006300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00630039
006400     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00640039
006500     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00650039
006600     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00660039
006700                                               COMP.              00670039
006800     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00680039
006900     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00690039
007000     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00700039
007100     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00710039
007200     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00720039
007300     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00730039
007400     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00740039
007500     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00750039
007600     05  PC-01                     PIC  X(02)  VALUE '01'.        00760039
007700*                                                                 00770039
007800*----------------------------------------------------------------*00780039
007900*  DESCRIPTION CONSTANTS                                         *00790039
008000*----------------------------------------------------------------*00800039
008100     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00810039
008200     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00820039
008300     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00830039
008400     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00840039
008500     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00850039
008600     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00860039
008700     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00870039
008800     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00880039
008900     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00890039
009000     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00900039
009100     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00910039
009200     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00920039
009201**DJK - 05/04/10 - ADDED DESCRIPT BELOW FOR EFC2 PROJECT          00920156
009210     05  PC-XFER-DESC               PIC X(08)  VALUE 'WMXFR'.     00921046
009300     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00930039
009400                                           VALUE '** UNKNOWN **'. 00940039
009500*                                                                 00950039
009600*----------------------------------------------------------------*00960039
009700*  SYSTEM MESSAGES                                               *00970039
009800*----------------------------------------------------------------*00980039
009900*   00005 = INVALID VALUE                                        *00990039
010000*   00008 = MUST BE NUMERIC                                      *01000039
010100*   00045 = INVALID FUNCTION KEY                                 *01010039
010200*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01020039
010300*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01030039
010400*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01040039
010500*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01050039
010600*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01060039
010700*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01070039
010800*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01080039
010900*   00069 - TOP OF LIST                                          *01090039
011000*   00070 - BOTTOM OF LIST                                       *01100039
011100*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01110039
011200*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01120039
011300*   00279 - MORE ITEMS TO DISPLAY                                *01130039
011400*   00746 = INVALID PRINTER DESTINATION                          *01140039
011500*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01150039
011600*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01160039
011700*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01170039
011800*   02225 = CANNOT CONFIRM/UNCONFIRM DISTRO - PULL CANCELLED      01180039
011900*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01190039
012000*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01200039
012100*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01210039
012200*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01220039
012300*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01230039
012400*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01240039
012500*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01250039
012600*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01260039
012700*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01270039
012800*   02258 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM PULL DI01280039
012900*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01290039
013000*   02260 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM LINE IT01300039
013100*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01310039
013200*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01320039
013300*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01330039
013400*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01340039
013500*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01350039
013600*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01360039
013700*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01370039
013800*   02268 - CANNOT CNCL/UNCNCL-LINE(S) POSTED,DISTRBTD, WORKED RDM01380039
013900*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01390039
014000*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01400039
014100*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01410039
014200*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01420039
014300*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01430039
014400*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01440039
014500*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01450039
014600*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01460039
014700*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01470039
014800*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01480039
014900*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01490039
015000*   02289 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS DISTRIBTD01500039
015100*   02290 - CANNOT CONFIRM/UNCONFIRM DISTRO - LINE IS POSTED      01510039
015200*   02291 - CANNOT CONFIRM/UNCONFIRM DISTRO - LINE IS CANCELLED   01520039
015300*   02296 - PRINT PULL FAILED - NO LINE(S) FOR REQUESTED PULL     01530039
015400*   02297 - PRINT PULL FAILED - LINE(S) MISSING DISTRIBUTION INFOR01540039
015500*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01550039
015600*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01560039
015700*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01570039
015800*   02317 - CANNOT CONFIRM/UNCONFIRM DISTRO - PULL STATUS NEW     01580039
015900*   02324 - PRINT REQUEST FAILED - LINE STATUS IS POSTED OR DISTRI01590039
016000*   02325 - PRINT REQUEST FAILED - LINE STATUS IS CANCELLED       01600039
016100*   02328 - YOU DO NOT HAVE AUTHORITY TO ADD NEW LINE ITEMS       01610039
016200*   02332 - CANNOT ADD LINE ITEMS - PULL STATUS IS POSTED/DISTRIBU01620039
016300*   02339 - CANNOT CONFIRM/UNCONFRM DISTRO - PULL LINE STATUS NEW 01630039
016400*   02557 - CANNOT SET TO POSTED STATUS - NOT ALL PROCESSED UNITS 01640039
016500*   02558 - SETTING LINE ITEM TO A POSTED STATUS - PRESS F2 TO CON01650039
016600*   02559 - SETTING LINE ITEM TO AN IN-PROCESS STATUS - PRESS F2  01660039
016700*   02560 - YOU DO NOT HAVE AUTHORITY TO POST/UNPOST              01670039
016800*   02561 - CANNOT POST/UNPOST DISTRIBUTION - PULL STATUS NEW     01680039
016900*   02562 - CANNOT POST/UNPOST DISTRIBUTION - PULL STATUS CANCELLD01690039
017000*   02563 - CANNOT POST/UNPOST DISTRIBUTION - PULL STATUS DISTRBTD01700039
017100*   02564 - CANNOT POST/UNPOST DISTRIBUTION - PULL LINE STATUS NEW01710039
017200*   02565 - CANNOT POST/UNPOST DISTRIBUTION - PULL LINE STATUS CAN01720039
017300*   02566 - CANNOT POST/UNPOST DISTRIBUTION - PULL LINE STATUS DIS01730039
017400*   02567 - F KEY CANNOT BE USED-DISTRB UNTS NOT MAINTAINED BY RDM01740039
017500*   02568 - (UN)PULL PULL REQUEST FAILED                          01750039
017600*   02569 - (UN)POST DISTRIBUTION REQUEST SUCCESSFUL              01760039
017700*   02570 - CANNOT UNPOST A LINE THAT WAS POSTED BY THE RDM AUTO  01770039
017800*   02677 - COMMUNICATION ERROR - CANNOT ACCESS WEB INVENTORY     01780039
017900*   02877 - HIGHLIGHTED PULL LINES NOT UN-CANCELLED - INSUFFICIENT01790039
018000*           WEB INVENTORY                                         01800039
018100*   02880 - NO AUTHORITY TO CANCEL PULL SENT TO RDM - CENTRAL STK 01810039
018200*           SITE MUST CANCEL                                      01820039
018300*   99901 = INVALID COMMAND WAS ENTERED                          *01830039
018400*----------------------------------------------------------------*01840039
018500     05  PC-TSYMSG-NUMBERS.                                       01850039
018600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01860039
018700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01870039
018800         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01880039
018900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01890039
019000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01900039
019100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01910039
019200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01920039
019300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01930039
019400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01940039
019500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01950039
019600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01960039
019700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01970039
019800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01980039
019900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01990039
020000         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  02000039
020100         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  02010039
020200         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  02020039
020300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  02030039
020400         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  02040039
020500         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  02050039
020600         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  02060039
020700         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  02070039
020800         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  02080039
020900         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  02090039
021000         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  02100039
021100         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  02110039
021200         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  02120039
021300         10  PC-TSYMSG-02256            PIC  9(05)  VALUE 02256.  02130039
021400         10  PC-TSYMSG-02257            PIC  9(05)  VALUE 02257.  02140039
021500         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  02150039
021600         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  02160039
021700         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  02170039
021800         10  PC-TSYMSG-02261            PIC  9(05)  VALUE 02261.  02180039
021900         10  PC-TSYMSG-02262            PIC  9(05)  VALUE 02262.  02190039
022000         10  PC-TSYMSG-02263            PIC  9(05)  VALUE 02263.  02200039
022100         10  PC-TSYMSG-02264            PIC  9(05)  VALUE 02264.  02210039
022200         10  PC-TSYMSG-02265            PIC  9(05)  VALUE 02265.  02220039
022300         10  PC-TSYMSG-02266            PIC  9(05)  VALUE 02266.  02230039
022400         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  02240039
022500         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  02250039
022600         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  02260039
022700         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  02270039
022800         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  02280039
022900         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  02290039
023000         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  02300039
023100         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  02310039
023200         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  02320039
023300         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  02330039
023400         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  02340039
023500         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  02350039
023600         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  02360039
023700         10  PC-TSYMSG-02289            PIC  9(05)  VALUE 02289.  02370039
023800         10  PC-TSYMSG-02290            PIC  9(05)  VALUE 02290.  02380039
023900         10  PC-TSYMSG-02291            PIC  9(05)  VALUE 02291.  02390039
024000         10  PC-TSYMSG-02296            PIC  9(05)  VALUE 02296.  02400039
024100         10  PC-TSYMSG-02297            PIC  9(05)  VALUE 02297.  02410039
024200         10  PC-TSYMSG-02306            PIC  9(05)  VALUE 02306.  02420039
024300         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  02430039
024400         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  02440039
024500         10  PC-TSYMSG-02317            PIC  9(05)  VALUE 02317.  02450039
024600         10  PC-TSYMSG-02324            PIC  9(05)  VALUE 02324.  02460039
024700         10  PC-TSYMSG-02325            PIC  9(05)  VALUE 02325.  02470039
024800         10  PC-TSYMSG-02328            PIC  9(05)  VALUE 02328.  02480039
024900         10  PC-TSYMSG-02332            PIC  9(05)  VALUE 02332.  02490039
025000         10  PC-TSYMSG-02339            PIC  9(05)  VALUE 02339.  02500039
025100         10  PC-TSYMSG-02495            PIC  9(05)  VALUE 02495.  02510039
025200         10  PC-TSYMSG-02557            PIC  9(05)  VALUE 02557.  02520039
025300         10  PC-TSYMSG-02558            PIC  9(05)  VALUE 02558.  02530039
025400         10  PC-TSYMSG-02559            PIC  9(05)  VALUE 02559.  02540039
025500         10  PC-TSYMSG-02560            PIC  9(05)  VALUE 02560.  02550039
025600         10  PC-TSYMSG-02561            PIC  9(05)  VALUE 02561.  02560039
025700         10  PC-TSYMSG-02562            PIC  9(05)  VALUE 02562.  02570039
025800         10  PC-TSYMSG-02563            PIC  9(05)  VALUE 02563.  02580039
025900         10  PC-TSYMSG-02564            PIC  9(05)  VALUE 02564.  02590039
026000         10  PC-TSYMSG-02565            PIC  9(05)  VALUE 02565.  02600039
026100         10  PC-TSYMSG-02566            PIC  9(05)  VALUE 02566.  02610039
026200         10  PC-TSYMSG-02567            PIC  9(05)  VALUE 02567.  02620039
026300         10  PC-TSYMSG-02568            PIC  9(05)  VALUE 02568.  02630039
026400         10  PC-TSYMSG-02569            PIC  9(05)  VALUE 02569.  02640039
026500         10  PC-TSYMSG-02570            PIC  9(05)  VALUE 02570.  02650039
026600         10  PC-TSYMSG-02677            PIC  9(05)  VALUE 02677.  02660039
026700         10  PC-TSYMSG-02877            PIC  9(05)  VALUE 02877.  02670039
026800         10  PC-TSYMSG-02880            PIC  9(05)  VALUE 02880.  02680039
026900         10  PC-TSYMSG-02885            PIC  9(05)  VALUE 02885.  02690039
027000         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02700039
027100*                                                                 02710039
027200 01  PS-PROGRAM-SWITCHES.                                         02720039
027300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02730039
027400         88  PS-NO-ERROR                            VALUE 'Y'.    02740039
027500         88  PS-ERROR                               VALUE 'N'.    02750039
027600     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02760039
027700         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02770039
027800         88  PS-BLOCK-ERROR                         VALUE 'N'.    02780039
027900     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   02790039
028000         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   02800039
028100         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   02810039
028200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02820039
028300         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02830039
028400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02840039
028500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02850039
028600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02860039
028700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02870039
028800     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02880039
028900         88  PS-DONE                                VALUE 'Y'.    02890039
029000         88  PS-NOT-DONE                            VALUE 'N'.    02900039
029100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02910039
029200         88  PS-LIST-END                            VALUE 'Y'.    02920039
029300         88  PS-NO-LIST-END                         VALUE 'N'.    02930039
029400     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    02940039
029500         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    02950039
029600         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    02960039
029700     05  PS-EOF-STATUS-CSR-SW           PIC  X(01)  VALUE 'N'.    02970039
029800         88  PS-EOF-STATUS-CSR-YES                  VALUE 'Y'.    02980039
029900         88  PS-EOF-STATUS-CSR-NO                   VALUE 'N'.    02990039
030000     05  PS-FIRST-ERR-LINE-FOUND-SW     PIC  X(01)  VALUE 'N'.    03000039
030100         88  PS-FIRST-ERR-LINE-FOUND                VALUE 'Y'.    03010039
030200         88  PS-FIRST-ERR-LINE-NOT-FOUND            VALUE 'N'.    03020039
030300*                                                                 03030039
030400 01  PV-PROGRAM-VARIABLES.                                        03040039
030500     05  PV-SAVE-ITEM-NUMBER            PIC  9(05)  VALUE 0.      03050039
030600     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  03060039
030700                                        COMP SYNC.                03070039
030800     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 03080039
030900     05  PV-SUB                         PIC S9(04)  VALUE +0      03090039
031000                                                    COMP SYNC.    03100039
031100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03110039
031200                                                    COMP SYNC.    03120039
031300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      03130039
031400                                                    COMP-3.       03140039
031500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      03150039
031600                                                    COMP-3.       03160039
031700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      03170039
031800                                                    COMP-3.       03180039
031900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03190039
032000                                                    COMP-3.       03200039
032100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      03210039
032200                                                    COMP-3.       03220039
032300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03230039
032400                                                    COMP-3.       03240039
032500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      03250039
032600                                                    COMP-3.       03260039
032700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03270039
032800                                                    COMP SYNC.    03280039
032900     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03290039
033000                                                    COMP SYNC.    03300039
033100     05  PV-ITEM                        PIC S9(04)  VALUE +0      03310039
033200                                                    COMP SYNC.    03320039
033300     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03330039
033400                                                    COMP SYNC.    03340039
033500     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03350039
033600                                                    COMP SYNC.    03360039
033700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03370039
033800                                                    COMP SYNC.    03380039
033900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03390039
034000                                                    COMP SYNC.    03400039
034100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03410039
034200                                                    COMP SYNC.    03420039
034300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03430039
034400                                                    COMP SYNC.    03440039
034500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03450039
034600                                                    COMP SYNC.    03460039
034700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03470039
034800                                                    COMP SYNC.    03480039
034900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03490039
035000                                                    COMP SYNC.    03500039
035100     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03510039
035200                                                    COMP SYNC.    03520039
035300     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03530039
035400                                                    COMP SYNC.    03540039
035500     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03550039
035600                                                    COMP SYNC.    03560039
035700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03570039
035800                                                    COMP SYNC.    03580039
035900     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03590039
036000                                                    COMP.         03600039
036100     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03610039
036200                                                    COMP.         03620039
036300     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03630039
036400                                                    COMP.         03640039
036500     05  PV-NULL-IND-4                  PIC S9(04)  VALUE +0      03650039
036600                                                    COMP.         03660039
036700     05  PV-NULL-IND-5                  PIC S9(04)  VALUE +0      03670039
036800                                                    COMP.         03680039
036900     05  PV-SOFT-ABORT-MSG.                                       03690039
037000         10  FILLER            PIC X(12) VALUE ' CEKCS602 - '.    03700039
037100         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03710039
037200         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    03720039
037300         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03730039
037400         10  PV-SOFT-PARAGRAPH PIC X(30).                         03740039
037500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03750039
037600                                                     COMP SYNC.   03760039
037700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03770039
037800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03780039
037900     05  PV-CICS-MSG-HOLD.                                        03790039
038000         10  FILLER                      PIC  X(01)  VALUE SPACE. 03800039
038100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 03810039
038200     05  PV-CICS-MSG-HOLD2.                                       03820039
038300         10  FILLER                      PIC  X(01)  VALUE SPACE. 03830039
038400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 03840039
038500                                                                  03850039
038600                                                                  03860039
038700     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 03870039
038800     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              03880039
038900         10   PV-CREATE-CC              PIC X(02).                03890039
039000         10   PV-CREATE-YY              PIC X(02).                03900039
039100         10   FILLER                    PIC X(01).                03910039
039200         10   PV-CREATE-MM              PIC X(02).                03920039
039300         10   FILLER                    PIC X(01).                03930039
039400         10   PV-CREATE-DD              PIC X(02).                03940039
039500         10   FILLER                    PIC X(16).                03950039
039600     05  PV-CREATE-MMDDYY.                                        03960039
039700         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 03970039
039800         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 03980039
039900         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 03990039
040000         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 04000039
040100         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 04010039
040200     05  PV-STATUS-MMDDYY.                                        04020039
040300         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 04030039
040400         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 04040039
040500         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 04050039
040600         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 04060039
040700         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 04070039
040800     05  PV-SELECT-FROM-DATE.                                     04080039
040900         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 04090039
041000         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 04100039
041100         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 04110039
041200         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 04120039
041300         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 04130039
041400     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 04140039
041500         88   PV-SOURCE-ADAM                        VALUE 'AD'.   04150039
041600         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   04160039
041700         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   04170039
041800         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 04180039
041900     05  PV-PULL-STATUS                 PIC X(02)   VALUE SPACES. 04190039
042000         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   04200039
042100         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   04210039
042200         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   04220039
042300         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   04230039
042400         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   04240039
042500     05  PV-LINE-STATUS                 PIC X(02)   VALUE SPACES. 04250039
042600         88   PV-LINE-STATUS-NEW                    VALUE 'NW'.   04260039
042700         88   PV-LINE-STATUS-CANCELLED              VALUE 'CA'.   04270039
042800         88   PV-LINE-STATUS-INPROCESS              VALUE 'IP'.   04280039
042900         88   PV-LINE-STATUS-DISTRIBTD              VALUE 'DS'.   04290039
043000         88   PV-LINE-STATUS-POSTED                 VALUE 'PD'.   04300039
043100     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  04310039
043200                                                    COMP.         04320039
043300     05  PV-ADJUSTMENT-QTY               PIC S9(09) VALUE ZEROES  04330039
043400                                                    COMP.         04340039
043500     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  04350039
043600                                                    COMP.         04360039
043700     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  04370039
043800                                                    COMP.         04380039
043900     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  04390039
044000                                                    COMP.         04400039
044100     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  04410039
044200                                                    COMP.         04420039
044300     05  PV-CEPLMF-MANIF-QTY             PIC S9(09) VALUE ZEROES  04430039
044400                                                    COMP.         04440039
044500     05  PV-CEPLAU-ADJUST-QTY            PIC S9(09) VALUE ZEROES  04450039
044600                                                    COMP.         04460039
044700     05  PV-COMPUTE-DISTRB-QTY           PIC S9(09) VALUE ZEROES  04470039
044800                                                    COMP.         04480039
044900     05  PV-VARIANCE-UNITS               PIC S9(09) VALUE ZEROES  04490039
045000                                                    COMP.         04500039
045100     05  PV-TOT-MANIFEST-QTY             PIC S9(09) VALUE ZEROES  04510039
045200                                                    COMP.         04520039
045300     05  PV-TOT-ADJUSTED-QTY             PIC S9(09) VALUE ZEROES  04530039
045400                                                    COMP.         04540039
045500     05  PV-TOT-DISTRB-QTY               PIC S9(09) VALUE ZEROES  04550039
045600                                                    COMP.         04560039
045700                                                                  04570039
045800     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 04580039
045900         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   04590039
046000         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   04600039
046100         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   04610039
046200     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 04620039
046300         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   04630039
046400         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   04640039
046500         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   04650039
046600     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 04660039
046700         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   04670039
046800         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   04680039
046900         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   04690039
047000                                                                  04700039
047100     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 04710039
047200         88   PV-STATUS-1-NEW                       VALUE 'NW'.   04720039
047300         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   04730039
047400         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   04740039
047500         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   04750039
047600         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   04760039
047700     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 04770039
047800         88   PV-STATUS-2-NEW                       VALUE 'NW'.   04780039
047900         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   04790039
048000         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   04800039
048100         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   04810039
048200         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   04820039
048300     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 04830039
048400         88   PV-STATUS-3-NEW                       VALUE 'NW'.   04840039
048500         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   04850039
048600         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   04860039
048700         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   04870039
048800         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   04880039
048900     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 04890039
049000         88   PV-STATUS-4-NEW                       VALUE 'NW'.   04900039
049100         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   04910039
049200         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   04920039
049300         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   04930039
049400         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   04940039
049500     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 04950039
049600         88   PV-STATUS-5-NEW                       VALUE 'NW'.   04960039
049700         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   04970039
049800         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   04980039
049900         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   04990039
050000         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   05000039
050100                                                                  05010039
050200     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 05020039
050300     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 05030039
050400     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 05040039
050500     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 05050039
050600     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 05060039
050700*---------------------------------CHANGED FOR WR/IR# 230ZZ -----* 05070039
050800     05  PV-SKU-NUMBER                   PIC  X(08) VALUE SPACES. 05080039
050900*---------------------------------CHANGED FOR WR/IR# 230ZZ -----* 05090039
051000     05  PV-SKU-DESCRIPTION              PIC  X(15) VALUE SPACES. 05100039
051100     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 05110039
051200     05  PV-LINE-STATUS-DESC             PIC  X(09) VALUE SPACES. 05120039
051300     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 05130039
051400     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05140039
051500     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05150039
051600     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 05160039
051700     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 05170039
051800     05  PV-DIST-UNT-ZERO-SUPPRESS       PIC ZZZZ9- VALUE ZEROES. 05180039
051900                                                                  05190039
052000     05  PV-CS-PRINTER-ID                PIC  X(08) VALUE SPACES. 05200039
052100     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 05210039
052200     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 05220039
052300     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 05230039
052400     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 05240039
052500     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 05250039
052600     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 05260039
052700                                                                  05270039
052800     05  PV-SEL-TERM-ID                  PIC  X(04).              05280039
052900     05  PV-SEL-TASK-NUMBER              PIC  9(05).              05290039
053000     05  PV-SEL-SEQ                      PIC  9(01).              05300039
053100                                                                  05310039
053200     05  PV-LINES-POSTED-DISTRB          PIC S9(09)  COMP.        05320039
053300     05  PV-TCEPLMF-COUNT                PIC S9(09)  COMP.        05330039
053400     05  PV-TCEPLAU-COUNT                PIC S9(09)  COMP.        05340039
053500     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     05350039
053600                                                     COMP SYNC.   05360039
053700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      05370039
053800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      05380039
053900     05  PV-SEL-CNCL-CNT                 PIC S9(09)  COMP-3       05390039
054000                                                     VALUE ZEROES.05400039
054100     05  PV-SEL-UNCNCL-CNT               PIC S9(09)  COMP-3       05410039
054200                                                     VALUE ZEROES.05420039
054300     05  PV-NUMBER-OF-STORES             PIC  9(05)  VALUE ZEROES.05430039
054400     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.05440039
054500******************************************************************05450039
054600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **05460039
054700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **05470039
054800**  APPLICATION-SPECIFIC COMMAREA.                              **05480039
054900******************************************************************05490039
055000 01  LQW-LIST-QUEUE-WORK-AREA.                                    05500039
055100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  05510039
055200     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           05520039
055300                                        INDEXED BY LQW-IDX.       05530039
055400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       05540039
055500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               05550039
055600         10  LQW-SELECTED-SW            PIC  X(01).               05560039
055700             88  LQW-SELECT                         VALUE 'S'.    05570039
055800             88  LQW-DESELECT                       VALUE ' '.    05580039
055900         10  LQW-ACTION                 PIC  X(03).               05590039
056000             88  LQW-DEL                            VALUE 'DEL'.  05600039
056100             88  LQW-INQ                            VALUE 'INQ'.  05610039
056200             88  LQW-UPD                            VALUE 'UPD'.  05620039
056300             88  LQW-ERR                            VALUE 'ERR'.  05630039
056400             88  LQW-PRT                            VALUE 'PRT'.  05640039
056500         10  LQW-UPD-UNITS              PIC  Z(05).               05650039
056600         10  LQW-LINE-NUMBER            PIC  Z(08).               05660039
056700         10  LQW-SKU-NUMBER             PIC  X(08).               05670039
056800         10  LQW-SKU-DESCRIPTION        PIC  X(15).               05680039
056900         10  LQW-LINE-STATUS-CDE        PIC  X(02).               05690039
057000         10  LQW-LINE-STATUS-DESC       PIC  X(08).               05700039
057100         10  LQW-NBR-STORES             PIC  Z(05).               05710039
057200         10  LQW-REQ-PULL-UNITS         PIC  Z(05).               05720039
057300         10  LQW-ACT-PULL-UNITS         PIC  Z(05).               05730039
057400         10  LQW-DISTRBUTED-UNITS       PIC  X(06).               05740039
057500         10  LQW-DISTRB-UNTS-NUM        PIC S9(05).               05750039
057600         10  LQW-VARIANCE-UNITS         PIC S9(05).               05760039
057700         10  LQW-ADJUSTMENT-SW          PIC  X(03).               05770039
057800         10  LQW-LINE-ITEM              PIC  9(15).               05780039
057900         10  LQW-LINE-SKU-RETAIL        PIC  9(05)V99.            05790039
058000         10  LQW-TOT-MNFST-UNITS        PIC S9(09)    COMP.       05800039
058100         10  LQW-TOT-ADJ-UNITS          PIC S9(09)    COMP.       05810039
058200         10  LQW-TOT-DSTRB-UNITS        PIC S9(09)    COMP.       05820039
058300         10  LQW-IN-TCEPLMF             PIC  X(01).               05830039
058400             88  LQW-IN-TCEPLMF-YES                 VALUE 'Y'.    05840039
058500             88  LQW-IN-TCEPLMF-NO                  VALUE 'N'.    05850039
058600                                                                  05860039
058700                                                                  05870039
058800*---------------------------------------------------------------* 05880039
058900* SELECTON QUEUE LAYOUT                                         * 05890039
059000*---------------------------------------------------------------* 05900039
059100     COPY CEWS003.                                                05910039
059200                                                                  05920039
059300                                                                  05930039
059400*---------------------------------------------------------------* 05940039
059500* COMMUNICATION AREA FOR PRINT MODULE (CEKCS609)                * 05950039
059600*---------------------------------------------------------------* 05960039
059700     COPY CEWS004.                                                05970039
059800                                                                  05980039
059900                                                                  05990039
060000*---------------------------------------------------------------* 06000039
060100*  SENDING/RECEIVING AREA FOR THE CONFIRMATION ROUTINE          * 06010039
060200*  (CEKCS610)                                                   * 06020039
060300*---------------------------------------------------------------* 06030039
060400     COPY CEWS005.                                                06040039
060500                                                                  06050039
060600                                                                  06060039
060700*---------------------------------------------------------------* 06070039
060800*    MAP LAYOUT                                                 * 06080039
060900*---------------------------------------------------------------* 06090039
061000                                                                  06100039
061100     COPY CEKM602.                                                06110039
061200*                                                                 06120039
061300 01  MR-OCCURS-LAYOUT                   REDEFINES  CE602AO.       06130039
061400     05  FILLER                         PIC X(158).               06140039
061500     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          06150039
061600         10  MR-SELECTL                 PIC S9(04) COMP.          06160039
061700         10  MR-SELECTA                 PIC  X(01).               06170039
061800         10  MR-SELECTC                 PIC  X(01).               06180039
061900         10  MR-SELECTH                 PIC  X(01).               06190039
062000         10  MR-SELECTI                 PIC  X(01).               06200039
062100                                                                  06210039
062200         10  MR-ACTIONL                 PIC S9(04) COMP.          06220039
062300         10  MR-ACTIONA                 PIC  X(01).               06230039
062400         10  MR-ACTIONC                 PIC  X(01).               06240039
062500         10  MR-ACTIONH                 PIC  X(01).               06250039
062600         10  MR-ACTION                  PIC  X(03).               06260039
062700                                                                  06270039
062800         10  MR-LINE-NUMBERL            PIC S9(04) COMP.          06280039
062900         10  MR-LINE-NUMBERA            PIC  X(01).               06290039
063000         10  MR-LINE-NUMBERC            PIC  X(01).               06300039
063100         10  MR-LINE-NUMBERH            PIC  X(01).               06310039
063200         10  MR-LINE-NUMBER-X.                                    06320039
063300             15  MR-LINE-NUMBER         PIC  Z(04).               06330039
063400                                                                  06340039
063500         10  MR-SKU-NBRL                PIC S9(04) COMP.          06350039
063600         10  MR-SKU-NBRA                PIC  X(01).               06360039
063700         10  MR-SKU-NBRC                PIC  X(01).               06370039
063800         10  MR-SKU-NBRH                PIC  X(01).               06380039
063900         10  MR-SKU-NBR                 PIC  X(08).               06390039
064000                                                                  06400039
064100         10  MR-SKU-DESCL               PIC S9(04) COMP.          06410039
064200         10  MR-SKU-DESCA               PIC  X(01).               06420039
064300         10  MR-SKU-DESCC               PIC  X(01).               06430039
064400         10  MR-SKU-DESCH               PIC  X(01).               06440039
064500         10  MR-SKU-DESC                PIC  X(15).               06450039
064600                                                                  06460039
064700         10  MR-LINE-STATUSL            PIC S9(04) COMP.          06470039
064800         10  MR-LINE-STATUSA            PIC  X(01).               06480039
064900         10  MR-LINE-STATUSC            PIC  X(01).               06490039
065000         10  MR-LINE-STATUSH            PIC  X(01).               06500039
065100         10  MR-LINE-STATUS             PIC  X(08).               06510039
065200                                                                  06520039
065300         10  MR-NBR-STORESL             PIC S9(04) COMP.          06530039
065400         10  MR-NBR-STORESA             PIC  X(01).               06540039
065500         10  MR-NBR-STORESC             PIC  X(01).               06550039
065600         10  MR-NBR-STORESH             PIC  X(01).               06560039
065700         10  MR-NBR-STORES              PIC  Z(04).               06570039
065800                                                                  06580039
065900         10  MR-REQ-PULL-UNITSL         PIC S9(04) COMP.          06590039
066000         10  MR-REQ-PULL-UNITSA         PIC  X(01).               06600039
066100         10  MR-REQ-PULL-UNITSC         PIC  X(01).               06610039
066200         10  MR-REQ-PULL-UNITSH         PIC  X(01).               06620039
066300         10  MR-REQ-PULL-UNITS          PIC  Z(05).               06630039
066400                                                                  06640039
066500         10  MR-DISTRBUTED-UNITSL       PIC S9(04) COMP.          06650039
066600         10  MR-DISTRBUTED-UNITSA       PIC  X(01).               06660039
066700         10  MR-DISTRBUTED-UNITSC       PIC  X(01).               06670039
066800         10  MR-DISTRBUTED-UNITSH       PIC  X(01).               06680039
066900         10  MR-DISTRBUTED-UNITS        PIC  X(06).               06690039
067000                                                                  06700039
067100         10  MR-VARIANCE-UNITSL         PIC S9(04) COMP.          06710039
067200         10  MR-VARIANCE-UNITSA         PIC  X(01).               06720039
067300         10  MR-VARIANCE-UNITSC         PIC  X(01).               06730039
067400         10  MR-VARIANCE-UNITSH         PIC  X(01).               06740039
067500         10  MR-VARIANCE-UNITS          PIC  Z(05)-.              06750039
067600                                                                  06760039
067700         10  MR-ADJUSTMENT-SWL          PIC S9(04) COMP.          06770039
067800         10  MR-ADJUSTMENT-SWA          PIC  X(01).               06780039
067900         10  MR-ADJUSTMENT-SWC          PIC  X(01).               06790039
068000         10  MR-ADJUSTMENT-SWH          PIC  X(01).               06800039
068100         10  MR-ADJUSTMENT-SW           PIC  X(03).               06810039
068200                                                                  06820039
068300     05  FILLER                         PIC  X(12).               06830039
068400                                                                  06840039
068500                                                                  06850039
068600*----------------------------------------------------------------*06860039
068700*  SENDING/RECEIVING AREA FOR THE                                *06870039
068800*  PRINTER VALIDATION ROUTING (DPKCS060)                         *06880039
068900*----------------------------------------------------------------*06890039
069000     COPY DPWS072.                                                06900039
069100                                                                  06910039
069200                                                                  06920039
069300*----------------------------------------------------------------*06930039
069400**  SECURITY SUBROUTINE PARAMETERS                                06940039
069500*----------------------------------------------------------------*06950039
069600     COPY DPWS008.                                                06960039
069700                                                                  06970039
069800                                                                  06980039
069900*---------------------------------------------------------------* 06990039
070000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 07000039
070100*---------------------------------------------------------------* 07010039
070200                                                                  07020039
070300     COPY DPWS015.                                                07030039
070400                                                                  07040039
070500*---------------------------------------------------------------* 07050039
070600*    FUNCTION KEYS COPYBOOK.                                    * 07060039
070700*---------------------------------------------------------------* 07070039
070800                                                                  07080039
070900     COPY DPWS016.                                                07090039
071000                                                                  07100039
071100*---------------------------------------------------------------* 07110039
071200*    NUMERIC EDIT LAYOUT.                                       * 07120039
071300*---------------------------------------------------------------* 07130039
071400                                                                  07140039
071500     COPY DPWS010I.                                               07150039
071600 EJECT                                                            07160039
071700*---------------------------------------------------------------* 07170039
071800*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 07180054
071900*---------------------------------------------------------------* 07190039
072000                                                                  07200039
072100     COPY DPWS030.                                                07210039
072110     COPY DPWS930.                                                07211054
072200                                                                  07220039
072300 EJECT                                                            07230039
072400*---------------------------------------------------------------* 07240039
072500*    STANDARD COMMAREA.                                         * 07250039
072600*---------------------------------------------------------------* 07260039
072700                                                                  07270039
072800     COPY DPWS020.                                                07280039
072900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07290039
073000                                                                  07300039
073100*---------------------------------------------------------------* 07310039
073200* INTER-APPLICATION COMMAREA.                                   * 07320039
073300*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07330039
073400*             SPEC SCREEN.                                      * 07340039
073500*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07350039
073600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 07360039
073700*---------------------------------------------------------------* 07370039
073800                                                                  07380039
073900         10  INTER-APPL-COMM-AREA       PIC X(200).               07390039
074000     COPY CEWS001.                                                07400039
074100     COPY CEWS002.                                                07410039
074200*---------------------------------------------------------------* 07420039
074300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07430039
074400*---------------------------------------------------------------* 07440039
074500         10  ASC-SPECIFIC-COMMAREA.                               07450039
074600             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          07460039
074700             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 07470039
074800                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          07480039
074900             15  ASC-CURR-FCLTY-ID           PIC  X(04).          07490039
075000             15  ASC-CURR-FCLTY-ID-N REDEFINES                    07500039
075100                     ASC-CURR-FCLTY-ID       PIC  9(04).          07510039
075200             15  ASC-CS-LOC                  PIC  X(04).          07520039
075300             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               07530039
075400                 20  ASC-CS-LOC-N            PIC  9(04).          07540039
075500             15  ASC-CS-LOCATION-DESC        PIC  X(25).          07550039
075600             15  ASC-CS-PRINTER-ID           PIC  X(08).          07560039
075700             15  ASC-PULL-NBR                PIC  X(09).          07570039
075800             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           07580039
075900                 20  ASC-PULL-NBR-N          PIC  9(09).          07590039
076000             15  ASC-REF-NBR                 PIC  X(15).          07600039
076100             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          07610039
076200                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    07620039
076300                                                   'I' 'N' 'P'    07630039
076400                                                   ' '.           07640039
076500                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    07650039
076600                                                   'I' 'N' 'P'.   07660039
076700                 88  ASC-SELECT-ALL               VALUE 'A'.      07670039
076800                 88  ASC-SELECT-CNCLD             VALUE 'C'.      07680039
076900                 88  ASC-SELECT-DSTRB             VALUE 'D'.      07690039
077000                 88  ASC-SELECT-INPROC            VALUE 'I'.      07700039
077100                 88  ASC-SELECT-NEW               VALUE 'N'.      07710039
077200                 88  ASC-SELECT-POSTD             VALUE 'P'.      07720039
077300             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          07730039
077400                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    07740039
077500                                                   'M' ' ' 'X'.   07750041
077600                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    07760039
077700                                                   'M' 'X'.       07770041
077800                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      07780039
077900                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      07790039
078000                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      07800039
078100                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      07810039
078110                 88  ASC-SELECT-SRC-XFER          VALUE 'X'.      07811041
078200             15  ASC-PULL-SELECT-DATE-FROM.                       07820039
078300                 20  ASC-FROM-MM             PIC  9(02).          07830039
078400                 20  ASC-FROM-DD             PIC  9(02).          07840039
078500                 20  ASC-FROM-YY             PIC  9(04).          07850039
078600             15  ASC-PULL-SELECT-DATE-TO.                         07860039
078700                 20  ASC-TO-MM               PIC  9(02).          07870039
078800                 20  ASC-TO-DD               PIC  9(02).          07880039
078900                 20  ASC-TO-YY               PIC  9(04).          07890039
079000             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          07900039
079100                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   07910039
079200                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       07920039
079300                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      07930039
079400                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      07940039
079500             15  ASC-PULL-STATUS             PIC  X(02).          07950039
079600                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     07960039
079700                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     07970039
079800                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     07980039
079900                 88  ASC-PULL-NEW                 VALUE 'NW'.     07990039
080000                 88  ASC-PULL-POSTED              VALUE 'PD'.     08000039
080100             15  ASC-PULL-TYPE               PIC  X(02).          08010039
080200                 88  ASC-PULL-SRC-ADAM            VALUE 'MA'.     08020039
080300                 88  ASC-PULL-SRC-INFOREM         VALUE 'MR'.     08030039
080400                 88  ASC-PULL-SRC-MANUAL          VALUE 'UC'.     08040039
080410                 88  ASC-PULL-SRC-XFER            VALUE 'XF'.     08041041
080500             15  ASC-CONFIRM-TYPE-IND        PIC  X(01).          08050039
080600                 88  ASC-CONFIRM-TYPE-NONE        VALUE 'N'.      08060039
080700                 88  ASC-CONFIRM-CNCL-ITEM        VALUE 'A'.      08070039
080800                 88  ASC-CONFIRM-UNCNCL-ITEM      VALUE 'B'.      08080039
080900                 88  ASC-CONFIRM-CONF-DIST-ITEM   VALUE 'C'.      08090039
081000                 88  ASC-CONFIRM-UNCONF-DIST-ITEM VALUE 'D'.      08100039
081100                 88  ASC-CONFIRM-CONF-ITEM        VALUE 'E'.      08110039
081200                 88  ASC-CONFIRM-UNCONF-ITEM      VALUE 'F'.      08120039
081300                 88  ASC-CONFIRM-POST-DIST        VALUE 'G'.      08130039
081400                 88  ASC-CONFIRM-UNPOST-DIST      VALUE 'H'.      08140039
081500             15  ASC-DIST-PULL-UNITS         PIC S9(06).          08150039
081600                                                                  08160039
081700             15  FILLER                      PIC  X(50).          08170039
081800*-----------------------------------------------------------------08180039
081900             15  ASC-BLK-SUB                  PIC S9(04) COMP     08190039
082000                                                         SYNC.    08200039
082100             15  ASC-ITEM-SUB                 PIC S9(04) COMP     08210039
082200                                                         SYNC.    08220039
082300             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  08230039
082400             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  08240039
082500             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  08250039
082600             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  08260039
082700             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  08270039
082800             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     08280039
082900                                                         SYNC.    08290039
083000             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  08300039
083100             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  08310039
083200             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         08320039
083300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08330039
083400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08340039
083500             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         08350039
083600                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08360039
083700                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08370039
083800             15  ASC-LIST-QUEUE-NAME.                             08380039
083900                 20  ASC-LIST-TERM-ID         PIC  X(04).         08390039
084000                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  08400039
084100                 20  ASC-LIST-SEQ             PIC  9(01).         08410039
084200                                                                  08420039
084300             15  ASC-START-ITEM-REQUEST.                          08430039
084400                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         08440039
084500                                                                  08450039
084600             15  ASC-SEL-SUB                  PIC S9(4) COMP.     08460039
084700             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     08470039
084800             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          08480039
084900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 08490039
085000             15  ASC-SEL-QUEUE-NAME.                              08500039
085100                 20  ASC-SEL-TERM-ID          PIC  X(04).         08510039
085200                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  08520039
085300                 20  ASC-SEL-SEQ              PIC  9(01).         08530039
085400             15  ASC-SEL-QUEUE-NAME-2.                            08540039
085500                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         08550039
085600                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  08560039
085700                 20  ASC-SEL-SEQ-2            PIC  9(01).         08570039
085800             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  08580039
085900                                                                  08590039
086000*-----------------------------------------------------------------08600039
086100                                                                  08610039
086200             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                08620039
086300                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  08630039
086400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   08640039
086500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   08650039
086600                                                                  08660039
086700                 20  ASC-ITEM-ARRAY.                              08670039
086800                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        08680039
086900                         30  ASC-LIST-ITEM-NUMBER                 08690039
087000                                                     PIC S9(09)   08700039
087100                                                     COMP-3.      08710039
087200                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  08720039
087300                             88  ASC-VALID-SELECT    VALUE ' '    08730039
087400                                                           'S'    08740039
087500                                                           'B'    08750039
087600                                                           'E'.   08760039
087700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   08770039
087800                             88  ASC-TEMP-SELECT     VALUE 'S'.   08780039
087900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   08790039
088000                             88  ASC-TEMP-END        VALUE 'E'.   08800039
088100                         30  ASC-SELECTED-SW         PIC  X(01).  08810039
088200                             88  ASC-NO-SELECT       VALUE ' '.   08820039
088300                             88  ASC-SELECT          VALUE 'S'.   08830039
088400                             88  ASC-BEGIN           VALUE 'B'.   08840039
088500                             88  ASC-END             VALUE 'E'.   08850039
088600                         30  ASC-ACTION              PIC  X(03).  08860039
088700                         30  ASC-UPD-UNITS-X         PIC  X(05).  08870039
088800                         30  ASC-UPD-UNITS-R REDEFINES            08880039
088900                             ASC-UPD-UNITS-X.                     08890039
089000                             35  ASC-UPD-UNITS       PIC  9(05).  08900039
089100                         30  ASC-LINE-NUMBER         PIC  9(08).  08910039
089200                         30  ASC-SKU-NUMBER          PIC  X(08).  08920039
089300                         30  ASC-SKU-DESCRIPTION     PIC  X(15).  08930039
089400                         30  ASC-LINE-STATUS-CDE     PIC  X(02).  08940039
089500                             88   ASC-LINE-STATUS-NEW             08950039
089600                                                      VALUE 'NW'. 08960039
089700                             88   ASC-LINE-STATUS-CANCELLED       08970039
089800                                                      VALUE 'CA'. 08980039
089900                             88   ASC-LINE-STATUS-INPROCESS       08990039
090000                                                      VALUE 'IP'. 09000039
090100                             88   ASC-LINE-STATUS-DISTRIBTD       09010039
090200                                                      VALUE 'DS'. 09020039
090300                             88   ASC-LINE-STATUS-POSTED          09030039
090400                                                      VALUE 'PD'. 09040039
090500                         30  ASC-LINE-STATUS-DESC    PIC  X(08).  09050039
090600                         30  ASC-NBR-STORES          PIC  Z(05).  09060039
090700                         30  ASC-REQ-PULL-UNITS      PIC  Z(05).  09070039
090800                         30  ASC-ACT-PULL-UNITS      PIC  Z(05).  09080039
090900                         30  ASC-DISTRBUTED-UNITS    PIC  X(06).  09090039
091000                         30  ASC-DISTRB-UNTS-NUM     PIC S9(05).  09100039
091100                         30  ASC-VARIANCE-UNITS      PIC S9(05).  09110039
091200                         30  ASC-ADJUSTMENT-SW       PIC  X(03).  09120039
091300                         30  ASC-LINE-ITEM           PIC  9(15).  09130039
091400                         30  ASC-LINE-SKU-RETAIL   PIC  9(05)V99. 09140039
091500                         30  ASC-TOT-MNFST-UNITS     PIC S9(09)   09150039
091600                                                         COMP.    09160039
091700                         30  ASC-TOT-ADJ-UNITS       PIC S9(09)   09170039
091800                                                         COMP.    09180039
091900                         30  ASC-TOT-DSTRB-UNITS     PIC S9(09)   09190039
092000                                                         COMP.    09200039
092100                         30  ASC-IN-TCEPLMF          PIC  X(01).  09210039
092200                                                                  09220039
092300     EJECT                                                        09230039
092400*---------------------------------------------------------------* 09240039
092500*    ABEND PROCESSING COPYBOOK.                                 * 09250039
092600*---------------------------------------------------------------* 09260039
092700                                                                  09270039
092800     COPY DPWS013.                                                09280039
092900                                                                  09290039
093000 EJECT                                                            09300039
093100*---------------------------------------------------------------* 09310039
093200*    TKRPRPM - KOHLS/RETEK PARAMETERS                           * 09320039
093300*---------------------------------------------------------------* 09330039
093400     EXEC SQL                                                     09340039
093500          INCLUDE TKRPRPM                                         09350039
093600     END-EXEC.                                                    09360039
093700*---------------------------------------------------------------* 09370039
093800*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 09380039
093900*---------------------------------------------------------------* 09390039
094000     EXEC SQL                                                     09400039
094100          INCLUDE TCEPLRQ                                         09410039
094200     END-EXEC.                                                    09420039
094300*---------------------------------------------------------------* 09430039
094400*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 09440039
094500*---------------------------------------------------------------* 09450039
094600     EXEC SQL                                                     09460039
094700          INCLUDE TCEPLDS                                         09470039
094800     END-EXEC.                                                    09480039
094900*---------------------------------------------------------------* 09490039
095000*    TCEPLDS - CENTRAL STOCK PULL MANIFESTING                   * 09500039
095100*---------------------------------------------------------------* 09510039
095200     EXEC SQL                                                     09520039
095300          INCLUDE TCEPLMF                                         09530039
095400     END-EXEC.                                                    09540039
095500*---------------------------------------------------------------* 09550039
095600*    TCEPLAU - CENTRAL STOCK PULL ADJUSTMENT                    * 09560039
095700*---------------------------------------------------------------* 09570039
095800     EXEC SQL                                                     09580039
095900          INCLUDE TCEPLAU                                         09590039
096000     END-EXEC.                                                    09600039
096100*---------------------------------------------------------------* 09610039
096200*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 09620039
096300*---------------------------------------------------------------* 09630039
096400     EXEC SQL                                                     09640039
096500          INCLUDE TCEPLIT                                         09650039
096600     END-EXEC.                                                    09660039
096700*---------------------------------------------------------------* 09670039
096800*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 09680039
096900*---------------------------------------------------------------* 09690039
097000     EXEC SQL                                                     09700039
097100          INCLUDE TCEPLST                                         09710039
097200     END-EXEC.                                                    09720039
097300*---------------------------------------------------------------* 09730039
097400*    LOGISTICS DOMAIN SKU TABLE XLV_SKU          WR/IR# 230ZZ   * 09740039
097500*---------------------------------------------------------------* 09750039
097600     EXEC SQL                                                     09760039
097700          INCLUDE XLV00000                                        09770039
097800     END-EXEC.                                                    09780039
097900                                                                  09790039
098000*---------------------------------------------------------------* 09800039
098100*    DB2 AREA FOR COMMUNICATIONS                                * 09810039
098200*---------------------------------------------------------------* 09820039
098300     EXEC SQL                                                     09830039
098400          INCLUDE SQLCA                                           09840039
098500     END-EXEC.                                                    09850039
098600                                                                  09860039
098700*---------------------------------------------------------------* 09870039
098800*    LINE ITEM CURSOR                                           * 09880039
098900*---------------------------------------------------------------* 09890039
099000                                                                  09900039
099100     EXEC SQL                                                     09910039
099200          DECLARE LINE-ITEM-CSR CURSOR FOR                        09920039
099300              SELECT  CNSTK_REQ_PL_NBR                            09930039
099400                     ,PL_LNE_NBR                                  09940039
099500                     ,ITM_NBR                                     09950039
099600                     ,PL_REQ_QTY                                  09960039
099700                     ,ACTL_PL_QTY                                 09970039
099800                     ,STAT_CDE                                    09980039
099900                     ,UNT_RTL_AMT                                 09990039
100000                FROM  TCEPLIT                                     10000039
100100               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          10010039
100200            ORDER BY  PL_LNE_NBR                                  10020039
100300     END-EXEC.                                                    10030039
100400                                                                  10040039
100500                                                                  10050039
100600*---------------------------------------------------------------* 10060039
100700*    STATUS-USER CURSOR                                         * 10070039
100800*---------------------------------------------------------------* 10080039
100900     EXEC SQL                                                     10090039
101000          DECLARE STATUS-USER-CSR CURSOR FOR                      10100039
101100              SELECT CNSTK_REQ_PL_NBR                             10110039
101200                   , PL_LNE_NBR                                   10120039
101300                   , CRE_TMST                                     10130039
101400                   , STAT_CDE                                     10140039
101500                   , CRE_BY_USR_ID                                10150039
101600               FROM TCEPLST                                       10160039
101700              WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER          10170039
101800                AND PL_LNE_NBR        =  :DK-LINE-NUMBER          10180039
101900                AND STAT_CDE          =  :DK-LINE-STATUS          10190039
102000              ORDER BY CRE_TMST DESC                              10200039
102100     END-EXEC.                                                    10210039
102200                                                                  10220039
102300                                                                  10230039
102400 LINKAGE SECTION.                                                 10240039
102500                                                                  10250039
102600 01  DFHCOMMAREA.                                                 10260039
102700     05  FILLER                         OCCURS  1 TO 4072 TIMES   10270039
102800                                        DEPENDING ON EIBCALEN.    10280039
102900         10  FILLER                     PIC X.                    10290039
103000                                                                  10300039
103100 EJECT                                                            10310039
103200 PROCEDURE DIVISION.                                              10320039
103300******************************************************************10330039
103400**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **10340039
103500**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **10350039
103600**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **10360039
103700******************************************************************10370039
103800 0000-MAIN-MODULE.                                                10380039
103900     INITIALIZE DP030-CICS-API-FIELDS.                            10390039
104000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       10400039
104100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10410039
104200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10420039
104300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10430039
104400     MOVE LENGTH OF CE602AI        TO DP030-MAP-LENGTH (1).       10440039
104500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10450039
104600     PERFORM 0001-CALL-CICS-ARCH-API.                             10460039
104700*                                                                 10470039
104800     PERFORM 1000-CONTROL-PROCESSING                              10480039
104900*                                                                 10490039
105000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10500039
105100     PERFORM 0001-CALL-CICS-ARCH-API.                             10510039
105200                                                                  10520039
105300******************************************************************10530039
105400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10540039
105500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10550039
105600******************************************************************10560039
105700 0001-CALL-CICS-ARCH-API.                                         10570039
105710     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10571054
105900                                    DFHCOMMAREA                   10590054
106000                                    DP030-CICS-API-FIELDS         10600054
106100                                    DP020-STANDARD-COMMAREA       10610054
106200                                    CE602AI.                      10620054
106300*                                                                 10630039
106400     IF  DP030-RC-CALL-SUCCESSFUL                                 10640039
106500         CONTINUE                                                 10650039
106600     ELSE                                                         10660039
106700         SET DP013-NO-ROLLBACK                                    10670039
106800             DP013-XCTL-DISPLAY-RESTART                           10680039
106900             DP013-CICS-ABEND      TO TRUE                        10690039
107000         MOVE '0001-CALL-CICS-ARCH-API'                           10700039
107100                                   TO DP013-PARAGRAPH             10710039
107110         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10711054
107120-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10712054
107400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10740039
107500         PERFORM DP013-0000-PROCESS-ABEND                         10750039
107600     END-IF.                                                      10760039
107700*----------------------------------------------------------------*10770039
107800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10780039
107900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10790039
108000*                                                                *10800039
108100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10810039
108200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10820039
108300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10830039
108400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10840039
108500*----------------------------------------------------------------*10850039
108600                                                                  10860039
108700 1000-CONTROL-PROCESSING.                                         10870039
108800                                                                  10880039
108900     EVALUATE TRUE                                                10890039
109000         WHEN DP020-NEXT-ACT-INITIAL                              10900039
109100             INITIALIZE ASC-SPECIFIC-COMMAREA                     10910039
109200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10920039
109300                                      ASC-SEL-TERM-ID             10930039
109400                                      ASC-SEL-TERM-ID-2           10940039
109500             MOVE DP020-SRC-TASK-NUMBER                           10950039
109600                                   TO ASC-LIST-TASK-NUMBER        10960039
109700                                      ASC-SEL-TASK-NUMBER         10970039
109800                                      ASC-SEL-TASK-NUMBER-2       10980039
109900             MOVE PC-LIST-QUEUE-SEQ                               10990039
110000                                   TO ASC-LIST-SEQ                11000039
110100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 11010039
110200                                      ASC-SEL-SEQ-2               11020039
110300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11030039
110400***-----$TEMPLATE NOTE$-------------------------------------------11040039
110500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,11050039
110600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  11060039
110700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.11070039
110800***---------------------------------------------------------------11080039
110900             IF  PS-COMMAREA-NOT-VALID                            11090039
111000                 SET DP020-NEXT-ACT-APPL-ERROR                    11100039
111100                                   TO TRUE                        11110039
111200             ELSE                                                 11120039
111300                 PERFORM 4000-BUILD-INITIAL-PANEL                 11130039
111400             END-IF                                               11140039
111500                                                                  11150039
111600         WHEN DP020-NEXT-ACT-READ-MAP                             11160039
111700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11170039
111800                                   TO PV-TOP-ITEM                 11180039
111900             PERFORM 2000-PROCESS-PANEL                           11190039
112000                                                                  11200039
112100         WHEN DP020-NEXT-ACT-RETURN                               11210039
112200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11220039
112300                                   TO PV-TOP-ITEM                 11230039
112400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11240039
112500             PERFORM 4505-COUNT-PULL-LINE-ITEMS                   11250039
112600             IF  PV-CEPLIT-ITEM-QTY = ASC-NUMBER-OF-ITEMS-READ    11260039
112700                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             11270039
112800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11280039
112900             ELSE                                                 11290039
113000                 PERFORM 2050-DELETE-LIST-QUEUE                   11300039
113100                 PERFORM 4000-BUILD-INITIAL-PANEL                 11310039
113200             END-IF                                               11320039
113300                                                                  11330039
113400         WHEN OTHER                                               11340039
113500             SET DP013-LOGIC-ABEND TO TRUE                        11350039
113600             SET DP013-NO-ROLLBACK TO TRUE                        11360039
113700             MOVE '1000-CONTROL-PROCESSING'                       11370039
113800                                   TO DP013-PARAGRAPH             11380039
113900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    11390039
114000                                   TO DP013-MESSAGE-TEXT(1)       11400039
114100             PERFORM DP013-0000-PROCESS-ABEND                     11410039
114200     END-EVALUATE.                                                11420039
114300                                                                  11430039
114400 EJECT                                                            11440039
114500*----------------------------------------------------------------*11450039
114600* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11460039
114700* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11470039
114800*----------------------------------------------------------------*11480039
114900                                                                  11490039
115000 1100-PROCESS-INTER-APPL-COMM.                                    11500039
115100                                                                  11510039
115200     SET PS-COMMAREA-VALID         TO TRUE.                       11520039
115300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     11530039
115400                                                                  11540039
115500     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          11550039
115600         MOVE CE001-CURR-OPER-UNT-ID-N                            11560039
115700                                      TO ASC-CURR-OPER-UNT-ID-N   11570039
115800         MOVE CE001-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      11580039
115900         MOVE CE001-CS-LOCATION       TO ASC-CS-LOC-N             11590039
116000         MOVE CE001-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        11600039
116100         MOVE CE001-PULL-NBR          TO ASC-PULL-NBR-N           11610039
116200         MOVE CE001-REF-NBR           TO ASC-REF-NBR              11620039
116300         MOVE CE001-PULL-SELECT-STATUS                            11630039
116400                                      TO ASC-PULL-SELECT-STATUS   11640039
116500         MOVE CE001-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     11650039
116600         MOVE CE001-PULL-SELECT-DATE-FROM                         11660039
116700                                      TO ASC-PULL-SELECT-DATE-FROM11670039
116800         MOVE CE001-PULL-SELECT-DATE-TO                           11680039
116900                                      TO ASC-PULL-SELECT-DATE-TO  11690039
117000         MOVE CE001-SELECT-LIST-SEQUENCE                          11700039
117100                                      TO ASC-SELECT-LIST-SEQUENCE 11710039
117200         MOVE CE001-CURR-PULL-STATUS  TO ASC-PULL-STATUS          11720039
117300         MOVE CE001-CURR-PULL-TYPE    TO ASC-PULL-TYPE            11730039
117400     END-IF.                                                      11740039
117500                                                                  11750039
117600     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              11760039
117700       IF CE002-NUMBER-OF-SELECTED-ITEMS > 0                      11770039
117800         MOVE CE002-CURR-OPER-UNT-ID-N                            11780039
117900                                      TO ASC-CURR-OPER-UNT-ID-N   11790039
118000         MOVE CE002-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      11800039
118100         MOVE CE002-CS-LOCATION       TO ASC-CS-LOC-N             11810039
118200         MOVE CE002-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        11820039
118300         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           11830039
118400         MOVE CE002-REF-NBR           TO ASC-REF-NBR              11840039
118500         MOVE CE002-PULL-SELECT-STATUS                            11850039
118600                                      TO ASC-PULL-SELECT-STATUS   11860039
118700         MOVE CE002-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     11870039
118800         MOVE CE002-SELECT-LIST-SEQUENCE                          11880039
118900                                      TO ASC-SELECT-LIST-SEQUENCE 11890039
119000         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    11900039
119100         MOVE CE002-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  11910039
119200         MOVE CE002-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      11920039
119300         PERFORM 1120-PREPARE-LIST-ENTRY                          11930039
119400       ELSE                                                       11940039
119500         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           11950039
119600         SET  PS-COMMAREA-NOT-VALID TO TRUE                       11960039
119700       END-IF                                                     11970039
119800     END-IF.                                                      11980039
119900                                                                  11990039
120000                                                                  12000039
120100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12010039
120200 1120-PREPARE-LIST-ENTRY.                                         12020039
120300                                                                  12030039
120400     MOVE CE003-MAX-ITEMS          TO ASC-SEL-SUB.                12040039
120500     MOVE ZERO                     TO ASC-SEL-ITEM.               12050039
120600     PERFORM 1130-GET-NEXT-RECORD.                                12060039
120700                                                                  12070039
120800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12080039
120900*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*12090039
121000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12100039
121100 1130-GET-NEXT-RECORD.                                            12110039
121200                                                                  12120039
121300     ADD +1                       TO ASC-SEL-SUB.                 12130039
121400                                                                  12140039
121500     IF  ASC-SEL-SUB > CE003-MAX-ITEMS                            12150039
121600         ADD +1                   TO ASC-SEL-ITEM                 12160039
121700         MOVE +1                  TO ASC-SEL-SUB                  12170039
121800     END-IF.                                                      12180039
121900                                                                  12190039
122000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                12200039
122100         PERFORM 9100-READ-SEL-QUEUE                              12210039
122200         IF  CE003-ITEM (ASC-SEL-SUB) > ZERO                      12220039
122300             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 12230039
122400                                  TO PV-PULL-NUMBER               12240039
122500                                     ASC-PULL-NBR-N               12250039
122600             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  12260039
122700                                  TO PV-REF-NUMBER                12270039
122800                                     ASC-REF-NBR                  12280039
122900             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 12290039
123000                                  TO PV-LINE-NUMBER               12300039
123100             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 12310039
123200                                  TO PV-CS-LOCATION               12320039
123300                                     ASC-CS-LOC-N                 12330039
123400             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 12340039
123500                                  TO PV-CREATE-DATE               12350039
123600             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             12360039
123700                                  TO PV-PULL-STATUS-CDE           12370039
123800                                     ASC-PULL-STATUS              12380039
123900             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             12390039
124000                                  TO PV-PULL-SOURCE-CDE           12400039
124100                                     ASC-PULL-TYPE                12410039
124200             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             12420039
124300                                  TO PV-SELECT-LIST-SEQ           12430039
124400             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   12440039
124500                                  TO PV-NBR-ITEMS                 12450039
124600             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  12460039
124700                                  TO PV-NBR-STORES                12470039
124800             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              12480039
124900                                  TO PV-REQ-PULL-UNITS            12490039
125000             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              12500039
125100                                  TO PV-ACT-PULL-UNITS            12510039
125200             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             12520039
125300                                  TO PV-DIST-PULL-UNITS           12530039
125400                                     ASC-DIST-PULL-UNITS          12540039
125500                                                                  12550039
125600             SET CE003-INQ (ASC-SEL-SUB)                          12560039
125700                                  TO TRUE                         12570039
125800             PERFORM 9200-REWRITE-SEL-QUEUE                       12580039
125900         ELSE                                                     12590039
126000             SUBTRACT +1 FROM ASC-SEL-SUB                         12600039
126100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             12610039
126200             SET DP020-MSG-INFORMATIONAL                          12620039
126300                 PS-LIST-END             TO TRUE                  12630039
126400         END-IF                                                   12640039
126500     ELSE                                                         12650039
126600         SUBTRACT +1 FROM ASC-SEL-ITEM                            12660039
126700         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  12670039
126800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             12680039
126900         SET DP020-MSG-INFORMATIONAL                              12690039
127000             PS-LIST-END             TO TRUE                      12700039
127100     END-IF.                                                      12710039
127200                                                                  12720039
127300/                                                                 12730039
127400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12740039
127500*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *12750039
127600*    PROCESSED.                                                  *12760039
127700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12770039
127800                                                                  12780039
127900 1140-GET-PREV-RECORD.                                            12790039
128000                                                                  12800039
128100     SUBTRACT +1 FROM ASC-SEL-SUB.                                12810039
128200                                                                  12820039
128300     IF  ASC-SEL-SUB < +1                                         12830039
128400         SUBTRACT +1 FROM ASC-SEL-ITEM                            12840039
128500         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  12850039
128600     END-IF.                                                      12860039
128700                                                                  12870039
128800     IF  ASC-SEL-ITEM > ZERO                                      12880039
128900         PERFORM 9100-READ-SEL-QUEUE                              12890039
129000             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 12900039
129100                                  TO PV-PULL-NUMBER               12910039
129200                                     ASC-PULL-NBR-N               12920039
129300             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  12930039
129400                                  TO PV-REF-NUMBER                12940039
129500                                     ASC-REF-NBR                  12950039
129600             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 12960039
129700                                  TO PV-LINE-NUMBER               12970039
129800             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 12980039
129900                                  TO PV-CS-LOCATION               12990039
130000                                     ASC-CS-LOC-N                 13000039
130100             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 13010039
130200                                  TO PV-CREATE-DATE               13020039
130300             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             13030039
130400                                  TO PV-PULL-STATUS-CDE           13040039
130500                                     ASC-PULL-STATUS              13050039
130600             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             13060039
130700                                  TO PV-PULL-SOURCE-CDE           13070039
130800                                     ASC-PULL-TYPE                13080039
130900             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             13090039
131000                                  TO PV-SELECT-LIST-SEQ           13100039
131100             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   13110039
131200                                  TO PV-NBR-ITEMS                 13120039
131300             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  13130039
131400                                  TO PV-NBR-STORES                13140039
131500             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              13150039
131600                                  TO PV-REQ-PULL-UNITS            13160039
131700             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              13170039
131800                                  TO PV-ACT-PULL-UNITS            13180039
131900             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             13190039
132000                                  TO PV-DIST-PULL-UNITS           13200039
132100                                     ASC-DIST-PULL-UNITS          13210039
132200         SET CE003-INQ (ASC-SEL-SUB)                              13220039
132300                                  TO TRUE                         13230039
132400         PERFORM 9200-REWRITE-SEL-QUEUE                           13240039
132500     ELSE                                                         13250039
132600         MOVE +1                  TO ASC-SEL-ITEM                 13260039
132700                                     ASC-SEL-SUB                  13270039
132800         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             13280039
132900         SET DP020-MSG-INFORMATIONAL                              13290039
133000             PS-LIST-END             TO TRUE                      13300039
133100     END-IF.                                                      13310039
133200                                                                  13320039
133300                                                                  13330039
133400                                                                  13340039
133500                                                                  13350039
133600*----------------------------------------------------------------*13360039
133700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13370039
133800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13380039
133900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13390039
134000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13400039
134100* FUNCTION KEYS CAN GET THIS FAR.                                *13410039
134200*----------------------------------------------------------------*13420039
134300                                                                  13430039
134400 2000-PROCESS-PANEL.                                              13440039
134500     EVALUATE TRUE                                                13450039
134600         WHEN DP020-SRC-AID = DP016-CLEAR                         13460039
134700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13470039
134800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13480039
134900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13490039
135000                                                                  13500039
135100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13510039
135200             PERFORM 2050-DELETE-LIST-QUEUE                       13520039
135300             PERFORM 4000-BUILD-INITIAL-PANEL                     13530039
135400                                                                  13540039
135500         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    13550039
135600             PERFORM 2140-DESELECT-ALL-ITEMS                      13560039
135700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13570039
135800                                                                  13580039
135900         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  13590039
136000             PERFORM 2150-SELECT-ALL-ITEMS                        13600039
136100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13610039
136200                                                                  13620039
136300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13630039
136400             IF  ASC-USE-SELECTION-QUEUE                          13640039
136500                 PERFORM 1130-GET-NEXT-RECORD                     13650039
136600                 IF PS-LIST-END                                   13660039
136700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13670039
136800                     SET PS-NO-LIST-END TO TRUE                   13680039
136900                 ELSE                                             13690039
137000                     PERFORM 2050-DELETE-LIST-QUEUE               13700039
137100                     PERFORM 3200-RESET-ATTRIBUTES                13710039
137200                     PERFORM 4000-BUILD-INITIAL-PANEL             13720039
137300                 END-IF                                           13730039
137400              ELSE                                                13740039
137500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13750039
137600*                --- BOTTOM OF LIST ---                           13760039
137700                 MOVE PC-TSYMSG-00070                             13770039
137800                                   TO DP020-MSG-NUMBER            13780039
137900                 SET DP020-MSG-INFORMATIONAL                      13790039
138000                                   TO TRUE                        13800039
138100             END-IF                                               13810039
138200                                                                  13820039
138300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13830039
138400             IF  ASC-USE-SELECTION-QUEUE                          13840039
138500                 PERFORM 1140-GET-PREV-RECORD                     13850039
138600                 IF PS-LIST-END                                   13860039
138700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13870039
138800                     SET PS-NO-LIST-END                           13880039
138900                                   TO TRUE                        13890039
139000                 ELSE                                             13900039
139100                     PERFORM 2050-DELETE-LIST-QUEUE               13910039
139200                     PERFORM 3200-RESET-ATTRIBUTES                13920039
139300                     PERFORM 4000-BUILD-INITIAL-PANEL             13930039
139400                 END-IF                                           13940039
139500             ELSE                                                 13950039
139600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13960039
139700                 MOVE PC-TSYMSG-00069                             13970039
139800                                   TO DP020-MSG-NUMBER            13980039
139900                 SET DP020-MSG-INFORMATIONAL                      13990039
140000                                   TO TRUE                        14000039
140100             END-IF                                               14010039
140200                                                                  14020039
140300         WHEN OTHER                                               14030039
140400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14040039
140500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14050039
140600                                                                  14060039
140700             IF  PS-NO-ERROR                                      14070039
140800                 SET DP030-CONTINUE-GO                            14080039
140900                                 TO TRUE                          14090039
141000                 PERFORM 2100-CHECK-FUNCTION-KEY                  14100039
141100             ELSE                                                 14110039
141200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14120039
141300                 SET DP030-OVERRIDE-GO                            14130039
141400                                 TO TRUE                          14140039
141500             END-IF                                               14150039
141600     END-EVALUATE.                                                14160039
141700 EJECT                                                            14170039
141800*----------------------------------------------------------------*14180039
141900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14190039
142000*----------------------------------------------------------------*14200039
142100 2050-DELETE-LIST-QUEUE.                                          14210039
142200                                                                  14220039
142300     EXEC CICS                                                    14230039
142400         DELETEQ TS                                               14240039
142500             QUEUE (ASC-LIST-QUEUE-NAME)                          14250039
142600             RESP  (PV-CICS-RESP)                                 14260039
142700     END-EXEC.                                                    14270039
142800                                                                  14280039
142900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14290039
143000        (PV-CICS-RESP = DFHRESP(QIDERR))                          14300039
143100         CONTINUE                                                 14310039
143200     ELSE                                                         14320039
143300         SET DP013-CICS-ABEND      TO TRUE                        14330039
143400         SET DP013-NO-ROLLBACK     TO TRUE                        14340039
143500                                                                  14350039
143600         MOVE '2050-DELETE-LIST-QUEUE'                            14360039
143700                                   TO DP013-PARAGRAPH             14370039
143800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14380039
143900                                   TO DP013-MESSAGE-TEXT (1)      14390039
144000         PERFORM DP013-0000-PROCESS-ABEND                         14400039
144100     END-IF.                                                      14410039
144200                                                                  14420039
144300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  14430039
144400 EJECT                                                            14440039
144500*----------------------------------------------------------------*14450039
144600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14460039
144700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14470039
144800* CICS ARCHITECTURE API.                                         *14480039
144900*----------------------------------------------------------------*14490039
145000 2100-CHECK-FUNCTION-KEY.                                         14500039
145100                                                                  14510039
145200     EVALUATE TRUE                                                14520039
145300*                                                                 14530039
145400* F15 - ADJUSTMENT LIST      (LOCAL-FUNC-03)                      14540039
145500* F16 - MANIFEST LIST        (LOCAL-FUNC-04)                      14550039
145600* F17 - STORE LIST           (LOCAL-FUNC-05)                      14560039
145700*                                                                 14570039
145800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              14580039
145900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              14590039
146000         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              14600039
146100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14610039
146200                 INITIALIZE CE002-INTER-APPL-COMMAREA             14620039
146300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14630039
146400                                TO CE002-NUMBER-OF-SELECTED-ITEMS 14640039
146500                 MOVE ASC-CURR-OPER-UNT-ID-N                      14650039
146600                                    TO CE002-CURR-OPER-UNT-ID-N   14660039
146700                 MOVE ASC-CURR-FCLTY-ID-N                         14670039
146800                                    TO CE002-CURR-FCLTY-ID-N      14680039
146900                 MOVE ASC-CS-LOC-N                                14690039
147000                                    TO CE002-CS-LOCATION          14700039
147100                 MOVE ASC-CS-PRINTER-ID                           14710039
147200                                    TO CE002-CS-PRINTER-ID        14720039
147300                 MOVE ASC-PULL-NBR-N                              14730039
147400                                    TO CE002-PULL-NBR             14740039
147500                 MOVE ASC-REF-NBR   TO CE002-REF-NBR              14750039
147600                 MOVE ASC-PULL-SELECT-STATUS                      14760039
147700                                    TO CE002-PULL-SELECT-STATUS   14770039
147800                 MOVE ASC-PULL-SELECT-TYPE                        14780039
147900                                    TO CE002-PULL-SELECT-TYPE     14790039
148000                 MOVE ASC-SELECT-LIST-SEQUENCE                    14800039
148100                                    TO CE002-SELECT-LIST-SEQUENCE 14810039
148200                 IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)  OR   14820039
148300                     DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)       14830039
148400                     SET  CE002-DISPLAY-ALL  TO  TRUE             14840039
148500                 ELSE                                             14850039
148600                     SET  CE002-DISPLAY-ONE  TO  TRUE             14860039
148700                 END-IF                                           14870039
148800                 PERFORM 5000-PREPARE-SEL-QUEUE                   14880039
148900             ELSE                                                 14890039
149000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14900039
149100                 SET DP030-OVERRIDE-GO                            14910039
149200                                   TO TRUE                        14920039
149300                 MOVE PC-TSYMSG-00057                             14930039
149400                                   TO DP020-MSG-NUMBER            14940039
149500                 SET DP020-MSG-WARNING                            14950039
149600                                   TO TRUE                        14960039
149700             END-IF                                               14970039
149800*                                                                 14980039
149900* F22 - STATUS LIST     (LOCAL-FUNC-07)                           14990039
150000*                                                                 15000039
150100         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              15010039
150200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15020039
150300                 INITIALIZE CE001-INTER-APPL-COMMAREA             15030039
150400                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                15040039
150500                                TO CE002-NUMBER-OF-SELECTED-ITEMS 15050039
150600                 MOVE ASC-CURR-OPER-UNT-ID-N                      15060039
150700                                    TO CE002-CURR-OPER-UNT-ID-N   15070039
150800                 MOVE ASC-CURR-FCLTY-ID-N                         15080039
150900                                    TO CE002-CURR-FCLTY-ID-N      15090039
151000                 MOVE ASC-CS-LOC-N                                15100039
151100                                    TO CE002-CS-LOCATION          15110039
151200                 MOVE ASC-CS-PRINTER-ID                           15120039
151300                                    TO CE002-CS-PRINTER-ID        15130039
151400                 MOVE ASC-PULL-NBR-N                              15140039
151500                                    TO CE002-PULL-NBR             15150039
151600                 MOVE ASC-REF-NBR   TO CE002-REF-NBR              15160039
151700                 MOVE ASC-PULL-SELECT-STATUS                      15170039
151800                                    TO CE002-PULL-SELECT-STATUS   15180039
151900                 MOVE ASC-PULL-SELECT-TYPE                        15190039
152000                                    TO CE002-PULL-SELECT-TYPE     15200039
152100                 MOVE ASC-SELECT-LIST-SEQUENCE                    15210039
152200                                    TO CE002-SELECT-LIST-SEQUENCE 15220039
152300                 PERFORM 5000-PREPARE-SEL-QUEUE                   15230039
152400             ELSE                                                 15240039
152500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15250039
152600                 SET DP030-OVERRIDE-GO                            15260039
152700                                   TO TRUE                        15270039
152800                 MOVE PC-TSYMSG-00057                             15280039
152900                                   TO DP020-MSG-NUMBER            15290039
153000                 SET DP020-MSG-WARNING                            15300039
153100                                   TO TRUE                        15310039
153200             END-IF                                               15320039
153300*                                                                 15330039
153400* F2 - CONFIRM (CNCL/UNCNCL) (CNFM/UNCNFM DISTRO)                 15340039
153500*                                                                 15350039
153600         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    15360039
153700              IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO             15370039
153800                  EVALUATE TRUE                                   15380039
153900                      WHEN ASC-CONFIRM-CNCL-ITEM                  15390039
154000                      WHEN ASC-CONFIRM-UNCNCL-ITEM                15400039
154100                      WHEN ASC-CONFIRM-CONF-DIST-ITEM             15410039
154200                      WHEN ASC-CONFIRM-UNCONF-DIST-ITEM           15420039
154300                      WHEN ASC-CONFIRM-CONF-ITEM                  15430039
154400                      WHEN ASC-CONFIRM-UNCONF-ITEM                15440039
154500                      WHEN ASC-CONFIRM-POST-DIST                  15450039
154600                      WHEN ASC-CONFIRM-UNPOST-DIST                15460039
154700                           PERFORM 4800-PROCESS-CONFIRM-FUNCTION  15470039
154800                           VARYING PV-ITEM  FROM 1 BY 1           15480039
154900                             UNTIL PV-ITEM >                      15490039
155000                                   ASC-HIGHEST-BLOCK-WRITTEN      15500039
155100                                OR PS-SOFT-ABORT-ERROR            15510039
155200                           PERFORM 4840-GET-NEW-PULL-STATUS       15520039
155300                           IF PS-FIRST-ERR-LINE-FOUND             15530039
155400                               MOVE PV-SAVE-ITEM-NUMBER           15540039
155500                                 TO ASC-START-ITEM-REQUEST        15550039
155600                               PERFORM 2130-CHECK-FOR-JUMP-BROWSE 15560039
155700                               MOVE PC-TSYMSG-02877               15570039
155800                                             TO DP020-MSG-NUMBER  15580039
155900                           END-IF                                 15590039
156000                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   15600039
156100                                                                  15610039
156200                      WHEN OTHER                                  15620039
156300                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   15630039
156400                           SET  PS-ERROR                          15640039
156500                                DP020-MSG-FATAL  TO TRUE          15650039
156600                           MOVE PC-TSYMSG-00045                   15660039
156700                                             TO DP020-MSG-NUMBER  15670039
156800                  END-EVALUATE                                    15680039
156900              ELSE                                                15690039
157000                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            15700039
157100                  SET DP030-OVERRIDE-GO      TO TRUE              15710039
157200                  MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER  15720039
157300                  SET DP020-MSG-WARNING      TO TRUE              15730039
157400              END-IF                                              15740039
157500                                                                  15750039
157600              SET  ASC-CONFIRM-TYPE-NONE  TO  TRUE                15760039
157700                                                                  15770039
157800*                                                                 15780039
157900* F13 - ADD LINE        (LOCAL-FUNC-01)                           15790039
158000*                                                                 15800039
158100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15810039
158200             INITIALIZE CE002-INTER-APPL-COMMAREA                 15820039
158300             MOVE ASC-CURR-OPER-UNT-ID-N                          15830039
158400                                    TO CE002-CURR-OPER-UNT-ID-N   15840039
158500             MOVE ASC-CURR-FCLTY-ID-N                             15850039
158600                                    TO CE002-CURR-FCLTY-ID-N      15860039
158700             MOVE ASC-CS-LOC-N      TO CE002-CS-LOCATION          15870039
158800             MOVE ASC-CS-PRINTER-ID                               15880039
158900                                    TO CE002-CS-PRINTER-ID        15890039
159000             MOVE ASC-PULL-NBR-N    TO CE002-PULL-NBR             15900039
159100             MOVE ASC-REF-NBR       TO CE002-REF-NBR              15910039
159200             MOVE ASC-PULL-SELECT-STATUS                          15920039
159300                                    TO CE002-PULL-SELECT-STATUS   15930039
159400             MOVE ASC-PULL-SELECT-TYPE                            15940039
159500                                    TO CE002-PULL-SELECT-TYPE     15950039
159600*                                                                 15960039
159700* F23 - PRINT PULL      (LOCAL-FUNC-08)                           15970039
159800*                                                                 15980039
159900         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              15990039
160000                                                                  16000039
160100             MOVE 'CECSPPRT' TO DP008-FUNCTION-NAME               16010039
160200             PERFORM 2105-RACF-ACCESS                             16020039
160300             IF  PS-ACCESS-NOT-ALLOWED                            16030039
160400                 SET  PS-ERROR                                    16040039
160500                      DP020-MSG-FATAL TO TRUE                     16050039
160600                 MOVE PC-TSYMSG-02306 TO DP020-MSG-NUMBER         16060039
160700                 MOVE -1              TO MR-SELECTL (1)           16070039
160800                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             16080039
160900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16090039
161000             END-IF                                               16100039
161100                                                                  16110039
161200             IF  PS-NO-ERROR                                      16120039
161300                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          16130039
161400                     PERFORM 4600-PROCESS-PRINT-FUNCTION          16140039
161500                         VARYING PV-ITEM  FROM 1 BY 1             16150039
161600                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN16160039
161700                            OR PS-SOFT-ABORT-ERROR                16170039
161800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16180039
161900                 ELSE                                             16190039
162000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16200039
162100                     SET DP030-OVERRIDE-GO TO TRUE                16210039
162200                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    16220039
162300                     SET DP020-MSG-WARNING  TO TRUE               16230039
162400                 END-IF                                           16240039
162500             END-IF                                               16250039
162600*                                                                 16260039
162700* F14 - CANCEL/UNCANCEL           (LOCAL-FUNC-02)                 16270039
162800* F24 - CONFIRM/UNCONFIRM DISTR   (LOCAL-FUNC-06)                 16280039
162900* F18 - POST/UNPOST               (LOCAL-FUNC-09)                 16290039
163000*                                                                 16300039
163100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              16310039
163200         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              16320039
163300         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              16330039
163400                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          16340039
163500                     CONTINUE                                     16350039
163600                 ELSE                                             16360039
163700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16370039
163800                     SET DP030-OVERRIDE-GO TO TRUE                16380039
163900                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    16390039
164000                     SET DP020-MSG-WARNING  TO TRUE               16400039
164100                 END-IF                                           16410039
164200*                                                                 16420039
164300* F6 - FIRST PAGE                                                 16430039
164400*                                                                 16440039
164500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  16450039
164600             MOVE +1               TO PV-TOP-ITEM                 16460039
164700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16470039
164800*                                                                 16480039
164900* F7 - PREVIOUS PAGE                                              16490039
165000*                                                                 16500039
165100         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   16510039
165200             PERFORM 2110-BROWSE-BACKWARD                         16520039
165300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16530039
165400*                                                                 16540039
165500* F8 - NEXT PAGE                                                  16550039
165600*                                                                 16560039
165700         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   16570039
165710             PERFORM 3200-RESET-ATTRIBUTES                        16571039
165720             MOVE -1               TO  MR-SELECTL(1)              16572039
165730             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   16573039
165800             PERFORM 2120-BROWSE-FORWARD                          16580039
165900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16590039
166000*                                                                 16600039
166100* ENTER KEY                                                       16610039
166200*                                                                 16620039
166300         WHEN DP020-SRC-AID = DP016-ENTER                         16630039
166400             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   16640039
166500             IF  PS-ERROR                                         16650039
166600                 CONTINUE                                         16660039
166700             ELSE                                                 16670039
166800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16680039
166900             END-IF                                               16690039
167000                                                                  16700039
167100         WHEN OTHER                                               16710039
167200             SET DP013-NO-ROLLBACK                                16720039
167300                 DP013-XCTL-DISPLAY-RESTART                       16730039
167400                 DP013-CICS-ABEND  TO TRUE                        16740039
167500             MOVE '2100-CHECK-FUNCTION-KEY'                       16750039
167600                                   TO DP013-PARAGRAPH             16760039
167700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      16770039
167800                                   TO DP013-MESSAGE-TEXT (1)      16780039
167900             PERFORM DP013-0000-PROCESS-ABEND                     16790039
168000     END-EVALUATE.                                                16800039
168100                                                                  16810039
168200                                                                  16820039
168300*----------------------------------------------------------------*16830039
168400* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     16840039
168500*----------------------------------------------------------------*16850039
168600 2105-RACF-ACCESS.                                                16860039
168700                                                                  16870039
168800      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  16880039
168900      SET DP008-ACCESS-TYPE-USE          TO TRUE                  16890039
169000                                                                  16900039
169100      EXEC CICS                                                   16910039
169200         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 16920039
169300              COMMAREA (DP008-SECURITY-COMMAREA)                  16930039
169400              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             16940039
169500      END-EXEC                                                    16950039
169600                                                                  16960039
169700      IF DP008-CALL-SUCCESSFUL                                    16970039
169800         IF DP008-ACCESS-ALLOWED                                  16980039
169900             SET PS-ACCESS-ALLOWED TO TRUE                        16990039
170000         ELSE                                                     17000039
170100             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    17010039
170200         END-IF                                                   17020039
170300     ELSE                                                         17030039
170400         MOVE '2105-RACF-ACCESS'                                  17040039
170500                               TO DP013-PARAGRAPH                 17050039
170600          MOVE 'UNABLE TO ACCESS CICS'                            17060039
170700                               TO DP013-MESSAGE-TEXT (1)          17070039
170800          MOVE SQLCA                 TO DP013-SQLCA               17080039
170900          SET DP013-DB2-ABEND                                     17090039
171000              DP013-XCTL-DISPLAY-RESTART                          17100039
171100                               TO TRUE                            17110039
171200          PERFORM DP013-0000-PROCESS-ABEND                        17120039
171300      END-IF.                                                     17130039
171400                                                                  17140039
171500                                                                  17150039
171600*----------------------------------------------------------------*17160039
171700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *17170039
171800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *17180039
171900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *17190039
172000*    MESSAGE.                                                    *17200039
172100*----------------------------------------------------------------*17210039
172200                                                                  17220039
172300 2110-BROWSE-BACKWARD.                                            17230039
172400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    17240039
172500         GIVING PV-TOP-ITEM.                                      17250039
172600*                                                                 17260039
172700     IF  ((PV-TOP-ITEM < +1)                                      17270039
172800       OR (PV-TOP-ITEM = +1))                                     17280039
172900         MOVE +1                   TO PV-TOP-ITEM                 17290039
173000*        -- TOP OF LIST --                                        17300039
173100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            17310039
173200         SET DP020-MSG-INFORMATIONAL TO TRUE                      17320039
173300     END-IF.                                                      17330039
173400                                                                  17340039
173500 EJECT                                                            17350039
173600*----------------------------------------------------------------*17360039
173700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *17370039
173800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *17380039
173900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *17390039
174000*----------------------------------------------------------------*17400039
174100                                                                  17410039
174200 2120-BROWSE-FORWARD.                                             17420039
174300                                                                  17430039
174400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              17440039
174500         GIVING PV-TOP-ITEM.                                      17450039
174600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   17460039
174700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17470039
174800                                   TO PV-TOP-ITEM                 17480039
174900*        -- BOTTOM OF LIST --                                     17490039
175000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            17500039
175100         SET DP020-MSG-INFORMATIONAL                              17510039
175200                                   TO TRUE                        17520039
175300     ELSE                                                         17530039
175400         COMPUTE PV-BOTTOM-ITEM =                                 17540039
175500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 17550039
175600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            17560039
175700*            -- BOTTOM OF LIST --                                 17570039
175800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17580039
175900             SET DP020-MSG-INFORMATIONAL                          17590039
176000                                   TO TRUE                        17600039
176100         END-IF                                                   17610039
176200     END-IF.                                                      17620039
176300 EJECT                                                            17630039
176400*----------------------------------------------------------------*17640039
176500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *17650039
176600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *17660039
176700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *17670039
176800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *17680039
176900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *17690039
177000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *17700039
177100*----------------------------------------------------------------*17710039
177200                                                                  17720039
177300 2130-CHECK-FOR-JUMP-BROWSE.                                      17730039
177400     SET PS-NO-ERROR               TO TRUE.                       17740039
177500     IF (ASC-START-ITEM-REQUEST = SPACE)                          17750039
177600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17760039
177700                                   TO PV-TOP-ITEM                 17770039
177800     ELSE                                                         17780039
177900         MOVE ASC-START-ITEM-REQUEST                              17790039
178000                                   TO DP010I-UNEDITED-FIELD       17800039
178100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17810039
178200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     17820039
178300         SET DP010I-NEGATIVE-NOT-ALLOWED                          17830039
178400                                   TO TRUE                        17840039
178510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17851052
178520              USING DP010I-NUMERIC-EDIT-AREA                      17852052
178600                                                                  17860039
178700         IF  NOT DP010I-ERROR-DETECTED                            17870039
178800             MOVE DP010I-NUMERIC-FIELD                            17880039
178900                                   TO  ASC-START-ITEM-REQUEST-N   17890039
179000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  17900039
179100                 IF  ASC-START-ITEM-REQUEST-N >                   17910039
179200                                          ASC-NUMBER-OF-ITEMS-READ17920039
179300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         17930039
179400                     COMPUTE PV-TOP-ITEM =                        17940039
179500                             ASC-NUMBER-OF-ITEMS-READ             17950039
179600                             - PC-ITEMS-PER-PANEL + 1             17960039
179700                     IF  PV-TOP-ITEM < +1                         17970039
179800                         MOVE +1   TO PV-TOP-ITEM                 17980039
179900                         MOVE PC-TSYMSG-00070                     17990039
180000                                   TO DP020-MSG-NUMBER            18000039
180100                         SET DP020-MSG-INFORMATIONAL              18010039
180200                                   TO TRUE                        18020039
180300                     END-IF                                       18030039
180400                 ELSE                                             18040039
180500                     MOVE ASC-START-ITEM-REQUEST-N                18050039
180600                                   TO PV-TOP-ITEM                 18060039
180700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      18070039
180800                     COMPUTE PV-BOTTOM-ITEM =                     18080039
180900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     18090039
181000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ18100039
181100*                        -- BOTTOM OF LIST --                     18110039
181200                         MOVE PC-TSYMSG-00070                     18120039
181300                                   TO DP020-MSG-NUMBER            18130039
181400                         SET DP020-MSG-INFORMATIONAL              18140039
181500                                   TO TRUE                        18150039
181600                     END-IF                                       18160039
181700                 END-IF                                           18170039
181800             ELSE                                                 18180039
181900*                --- VALUE OUT OF RANGE ----                      18190039
182000                 MOVE PC-TSYMSG-00101                             18200039
182100                                   TO DP020-MSG-NUMBER            18210039
182200                 MOVE -1           TO ASTRTITL                    18220039
182300                 SET DP030-SET-CURSOR-APPL-1                      18230039
182400                                   TO TRUE                        18240039
182500                 MOVE DP015-REVERSE                               18250039
182600                                   TO ASTRTITH                    18260039
182700                 MOVE DP015-RED    TO ASTRTITC                    18270039
182800                 MOVE DP015-UNP-NUM-BRT-MDT                       18280039
182900                                   TO ASTRTITA                    18290039
183000                 SET DP020-MSG-FATAL                              18300039
183100                                   TO TRUE                        18310039
183200                 SET PS-ERROR      TO TRUE                        18320039
183300             END-IF                                               18330039
183400                                                                  18340039
183500         ELSE                                                     18350039
183600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18360039
183700             MOVE -1               TO ASTRTITL                    18370039
183800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18380039
183900             MOVE DP015-REVERSE    TO ASTRTITH                    18390039
184000             MOVE DP015-RED        TO ASTRTITC                    18400039
184100             MOVE DP015-UNP-NUM-BRT-MDT                           18410039
184200                                   TO ASTRTITA                    18420039
184300             SET DP020-MSG-FATAL   TO TRUE                        18430039
184400             SET PS-ERROR          TO TRUE                        18440039
184500         END-IF                                                   18450039
184600     END-IF.                                                      18460039
184700 EJECT                                                            18470039
184800*----------------------------------------------------------------*18480039
184900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *18490039
185000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *18500039
185100*----------------------------------------------------------------*18510039
185200 2140-DESELECT-ALL-ITEMS.                                         18520039
185300     MOVE +1                       TO ASC-BLK-SUB.                18530039
185400                                                                  18540039
185500     PERFORM 2141-CLEAR-SELECTED-INDS                             18550039
185600         VARYING ASC-ITEM-SUB                                     18560039
185700         FROM 1 BY 1                                              18570039
185800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18580039
185900                                                                  18590039
186000     ADD +1                        TO ASC-BLK-SUB.                18600039
186100                                                                  18610039
186200     PERFORM 2141-CLEAR-SELECTED-INDS                             18620039
186300         VARYING ASC-ITEM-SUB                                     18630039
186400         FROM 1 BY 1                                              18640039
186500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18650039
186600                                                                  18660039
186700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18670039
186800                                   TO PV-LIST-ITEM-NUMBER.        18680039
186900                                                                  18690039
187000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18700039
187100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18710039
187200                                                                  18720039
187300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18730039
187400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      18740039
187500         MOVE +1                   TO ASC-BLK-SUB                 18750039
187600                                                                  18760039
187700         PERFORM 5100-WRITE-TEMP-STORAGE                          18770039
187800                                                                  18780039
187900         MOVE +1                   TO PV-BLOCK-NUMBER             18790039
188000                                                                  18800039
188100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18810039
188200             PV-FIRST-BLOCK-IN-ARRAY - 1                          18820039
188300                                                                  18830039
188400         PERFORM                                                  18840039
188500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18850039
188600                                                                  18860039
188700             PERFORM 4410-READ-TEMP-STORAGE                       18870039
188800                                                                  18880039
188900             PERFORM 2141-CLEAR-SELECTED-INDS                     18890039
189000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18900039
189100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18910039
189200                                                                  18920039
189300             PERFORM 5100-WRITE-TEMP-STORAGE                      18930039
189400                                                                  18940039
189500             ADD +1                TO PV-BLOCK-NUMBER             18950039
189600                                                                  18960039
189700         END-PERFORM                                              18970039
189800                                                                  18980039
189900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18990039
190000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19000039
190100                                                                  19010039
190200         PERFORM                                                  19020039
190300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19030039
190400                   ASC-HIGHEST-BLOCK-WRITTEN                      19040039
190500                                                                  19050039
190600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19060039
190700                                   TO PV-BLOCK-NUMBER             19070039
190800                                                                  19080039
190900             PERFORM 4410-READ-TEMP-STORAGE                       19090039
191000                                                                  19100039
191100             PERFORM 2141-CLEAR-SELECTED-INDS                     19110039
191200                 VARYING ASC-ITEM-SUB                             19120039
191300                 FROM 1 BY 1                                      19130039
191400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19140039
191500                                                                  19150039
191600             PERFORM 5100-WRITE-TEMP-STORAGE                      19160039
191700                                                                  19170039
191800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19180039
191900                                                                  19190039
192000         END-PERFORM                                              19200039
192100                                                                  19210039
192200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19220039
192300                                   TO PV-BLOCK-NUMBER             19230039
192400                                                                  19240039
192500         PERFORM 4410-READ-TEMP-STORAGE                           19250039
192600     END-IF.                                                      19260039
192700                                                                  19270039
192800                                                                  19280039
192900     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 19290039
193000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.19300039
193100     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  19310039
193200                                                                  19320039
193300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19330039
193400                                                                  19340039
193500 EJECT                                                            19350039
193600*----------------------------------------------------------------*19360039
193700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *19370039
193800*----------------------------------------------------------------*19380039
193900                                                                  19390039
194000 2141-CLEAR-SELECTED-INDS.                                        19400039
194100                                                                  19410039
194200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19420039
194300             NOT EQUAL ZERO                                       19430039
194400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19440039
194500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19450039
194600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    19460039
194700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19470039
194800                                   TO TRUE                        19480039
194900         END-IF                                                   19490039
195000     END-IF.                                                      19500039
195100                                                                  19510039
195200 EJECT                                                            19520039
195300*----------------------------------------------------------------*19530039
195400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *19540039
195500*  FOR ALL ITEMS.                                                *19550039
195600*----------------------------------------------------------------*19560039
195700                                                                  19570039
195800 2150-SELECT-ALL-ITEMS.                                           19580039
195900                                                                  19590039
196000     MOVE +1                       TO ASC-BLK-SUB.                19600039
196100                                                                  19610039
196200     PERFORM 2151-SET-SELECTED-INDS                               19620039
196300         VARYING ASC-ITEM-SUB                                     19630039
196400         FROM 1 BY 1                                              19640039
196500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19650039
196600                                                                  19660039
196700     ADD +1                        TO ASC-BLK-SUB.                19670039
196800                                                                  19680039
196900     PERFORM 2151-SET-SELECTED-INDS                               19690039
197000         VARYING ASC-ITEM-SUB                                     19700039
197100         FROM 1 BY 1                                              19710039
197200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19720039
197300                                                                  19730039
197400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19740039
197500                                   TO PV-LIST-ITEM-NUMBER.        19750039
197600                                                                  19760039
197700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19770039
197800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19780039
197900                                                                  19790039
197910* 6/18/09 - BEGIN                                                 19791040
197920     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            19792040
197930         MOVE +1                   TO ASC-BLK-SUB                 19793040
197940                                                                  19794040
197950         PERFORM 5100-WRITE-TEMP-STORAGE                          19795040
197960         MOVE +2                   TO ASC-BLK-SUB                 19796040
197970         PERFORM 5100-WRITE-TEMP-STORAGE                          19797040
197980         MOVE +1                   TO ASC-BLK-SUB                 19798040
197990         MOVE +1                   TO PV-BLOCK-NUMBER             19799040
197991     END-IF.                                                      19799140
197992* 6/18/09 - END                                                   19799240
197993                                                                  19799340
198000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19800039
198100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    19810039
198200         MOVE +1                   TO ASC-BLK-SUB                 19820039
198300                                                                  19830039
198400         PERFORM 5100-WRITE-TEMP-STORAGE                          19840039
198500                                                                  19850039
198600         MOVE +1                   TO PV-BLOCK-NUMBER             19860039
198700                                                                  19870039
198800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19880039
198900             PV-FIRST-BLOCK-IN-ARRAY - 1                          19890039
199000                                                                  19900039
199100         PERFORM                                                  19910039
199200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19920039
199300                                                                  19930039
199400             PERFORM 4410-READ-TEMP-STORAGE                       19940039
199500                                                                  19950039
199600             PERFORM 2151-SET-SELECTED-INDS                       19960039
199700                 VARYING ASC-ITEM-SUB                             19970039
199800                 FROM 1 BY 1                                      19980039
199900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19990039
200000                                                                  20000039
200100             PERFORM 5100-WRITE-TEMP-STORAGE                      20010039
200200                                                                  20020039
200300             ADD +1                TO PV-BLOCK-NUMBER             20030039
200400                                                                  20040039
200500         END-PERFORM                                              20050039
200600                                                                  20060039
200700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20070039
200800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20080039
200900                                                                  20090039
201000         PERFORM                                                  20100039
201100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20110039
201200                   ASC-HIGHEST-BLOCK-WRITTEN                      20120039
201300                                                                  20130039
201400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20140039
201500                                   TO PV-BLOCK-NUMBER             20150039
201600                                                                  20160039
201700             PERFORM 4410-READ-TEMP-STORAGE                       20170039
201800                                                                  20180039
201900             PERFORM 2151-SET-SELECTED-INDS                       20190039
202000                 VARYING ASC-ITEM-SUB                             20200039
202100                 FROM 1 BY 1                                      20210039
202200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20220039
202300                                                                  20230039
202400             PERFORM 5100-WRITE-TEMP-STORAGE                      20240039
202500                                                                  20250039
202600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20260039
202700                                                                  20270039
202800         END-PERFORM                                              20280039
202900                                                                  20290039
203000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20300039
203100                                   TO PV-BLOCK-NUMBER             20310039
203200                                                                  20320039
203300         PERFORM 4410-READ-TEMP-STORAGE                           20330039
203400     END-IF.                                                      20340039
203500                                                                  20350039
203600                                                                  20360039
203700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             20370039
203800                       ASC-NUMBER-OF-SELECTED-ITEMS.              20380039
203900                                                                  20390039
204000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20400039
204100                                                                  20410039
204200 EJECT                                                            20420039
204300*----------------------------------------------------------------*20430039
204400*    MARK EACH ITEM AS BEING SELECTED.                           *20440039
204500*----------------------------------------------------------------*20450039
204600                                                                  20460039
204700 2151-SET-SELECTED-INDS.                                          20470039
204800                                                                  20480039
204900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20490039
205000             NOT EQUAL ZERO                                       20500039
205100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20510039
205200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20520039
205300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        20530039
205400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20540039
205500                               TO  TRUE                           20550039
205600         END-IF                                                   20560039
205700     END-IF.                                                      20570039
205800******************************************************************20580039
205900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **20590039
206000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **20600039
206100******************************************************************20610039
206200 2200-MOVE-SCREEN-TO-COMMAREA.                                    20620039
206300                                                                  20630039
206400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             20640039
206500     MOVE +1                       TO PV-SUB.                     20650039
206600*                                                                 20660039
206700     PERFORM 3100-SET-SUBSCRIPTS.                                 20670039
206800     IF  ASTRTITL > ZERO                                          20680039
206900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          20690039
207000     ELSE                                                         20700039
207100         IF  ASTRTITF = DP015-ERASE-EOF                           20710039
207200             INITIALIZE ASC-START-ITEM-REQUEST                    20720039
207300         END-IF                                                   20730039
207400     END-IF.                                                      20740039
207500                                                                  20750039
207600     IF  APRTIDL > ZERO                                           20760039
207700         MOVE APRTIDI          TO ASC-CS-PRINTER-ID               20770039
207800     ELSE                                                         20780039
207900         IF  APRTIDF = DP015-ERASE-EOF                            20790039
208000             MOVE  SPACES      TO ASC-CS-PRINTER-ID               20800039
208100         END-IF                                                   20810039
208200     END-IF.                                                      20820039
208300                                                                  20830039
208400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          20840039
208500         VARYING PV-SUB                                           20850039
208600         FROM 1 BY 1                                              20860039
208700         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      20870039
208800******************************************************************20880039
208900** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**20890039
209000******************************************************************20900039
209100 2210-MOVE-LINES-TO-COMMAREA.                                     20910039
209200     IF  MR-SELECTL (PV-SUB) > ZERO                               20920039
209300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             20930039
209400         MOVE MR-SELECTI (PV-SUB)                                 20940039
209500                                   TO ASC-TEMP-SELECTED-SW        20950039
209600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      20960039
209700     ELSE                                                         20970039
209800         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                20980039
209900                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     20990039
210000                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        21000039
210100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21010039
210200         END-IF                                                   21020039
210300     END-IF.                                                      21030039
210400                                                                  21040039
210500                                                                  21050039
210600     ADD +1                        TO ASC-ITEM-SUB.               21060039
210700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        21070039
210800         ADD +1                    TO ASC-BLK-SUB                 21080039
210900         MOVE +1                   TO ASC-ITEM-SUB                21090039
211000     END-IF.                                                      21100039
211100******************************************************************21110039
211200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **21120039
211300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **21130039
211400******************************************************************21140039
211500 3000-EDIT-DATA-IN-COMMAREA.                                      21150039
211600     SET PS-NO-ERROR               TO TRUE.                       21160039
211700     PERFORM 3200-RESET-ATTRIBUTES.                               21170039
211800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     21180039
211900                                                                  21190039
212000*-----------------------------------------------------------------21200039
212100* VALIDATE PRINTER ID                                             21210039
212200*-----------------------------------------------------------------21220039
212300     IF  PS-NO-ERROR                                              21230039
212400         EVALUATE TRUE                                            21240039
212500             WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)          21250039
212600                  PERFORM 3010-VALIDATE-PRINTER-ID                21260039
212700         END-EVALUATE                                             21270039
212800     END-IF.                                                      21280039
212900                                                                  21290039
213000*-----------------------------------------------------------------21300039
213100* VERIFY RACF AUTHORITY FOR "UNCANCEL/CANCEL"                     21310039
213200*  F14 - LOCAL-02 (CHECK WHEN DOWNLOADED TO RDM) 12/17/01 BUD     21320039
213300*-----------------------------------------------------------------21330039
213400     IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)                    21340039
213500         MOVE ASC-PULL-NBR-N TO DK-PULL-NUMBER                    21350039
213600                                                                  21360039
213700         EXEC SQL                                                 21370039
213800             SELECT  CNSTK_REQ_PL_NBR                             21380039
213900               INTO :CEPLIT-CNSTK-REQ-PL-NBR                      21390039
214000               FROM  TCEPLIT                                      21400039
214100              WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER         21410039
214200                AND  DWNLD_RDM_STAT_CDE IN ('X','R')              21420039
214300         END-EXEC                                                 21430039
214400                                                                  21440039
214500         EVALUATE TRUE                                            21450039
214600             WHEN SQLCODE = ZERO                                  21460039
214700             WHEN SQLCODE = -811                                  21470039
214800                                                                  21480039
214900             MOVE 'CECSCNCL' TO DP008-FUNCTION-NAME               21490039
215000             PERFORM 2105-RACF-ACCESS                             21500039
215100             IF  PS-ACCESS-NOT-ALLOWED                            21510039
215200                 SET  PS-ERROR                                    21520039
215300                   DP020-MSG-FATAL TO TRUE                        21530039
215400                 MOVE PC-TSYMSG-02880 TO DP020-MSG-NUMBER         21540039
215500                 MOVE -1              TO MR-SELECTL (PV-SUB)      21550039
215600                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             21560039
215700             END-IF                                               21570039
215800                                                                  21580039
215900             WHEN OTHER                                           21590039
216000                 CONTINUE                                         21600039
216100         END-EVALUATE                                             21610039
216200     END-IF.                                                      21620039
216300                                                                  21630039
216400*-----------------------------------------------------------------21640039
216500* F13-LOCAL-FUNC-01 (ADD LINE) MAKE SURE USER HAS RACF ACCESS     21650039
216600*-----------------------------------------------------------------21660039
216700     IF  PS-NO-ERROR                                              21670039
216800     EVALUATE TRUE                                                21680039
216900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              21690039
217000                                                                  21700039
217100              MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME              21710039
217200              PERFORM 2105-RACF-ACCESS                            21720039
217300              IF  PS-ACCESS-NOT-ALLOWED                           21730039
217400                  SET  PS-ERROR                                   21740039
217500                       DP020-MSG-FATAL TO TRUE                    21750039
217600                  MOVE PC-TSYMSG-02328 TO DP020-MSG-NUMBER        21760039
217700                  MOVE -1              TO MR-SELECTL (PV-SUB)     21770039
217800                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            21780039
217900              END-IF                                              21790039
218000                                                                  21800039
218100              IF  PS-NO-ERROR                                     21810039
218200                  MOVE  ASC-PULL-STATUS  TO  PV-PULL-STATUS       21820039
218300                                                                  21830039
218400                  EVALUATE  TRUE                                  21840039
218500                      WHEN  PV-PULL-STATUS-CANCELLED              21850039
218600                      WHEN  PV-PULL-STATUS-DISTRIBTD              21860039
218700                      WHEN  PV-PULL-STATUS-POSTED                 21870039
218800                            SET PS-ERROR                          21880039
218900                            DP020-MSG-FATAL   TO TRUE             21890039
219000                            MOVE PC-TSYMSG-02332                  21900039
219100                                              TO DP020-MSG-NUMBER 21910039
219200                            MOVE -1         TO MR-SELECTL (PV-SUB)21920039
219300                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   21930039
219400                  END-EVALUATE                                    21940039
219500              END-IF                                              21950039
219600                                                                  21960039
219700                                                                  21970039
219800*-----------------------------------------------------------------21980039
219900* LOCAL-FUNC-02 (UNCANCEL/CANCEL) PULL CANNOT BE POSTED/DISTRIBUT221990039
220000* F14                                                             22000039
220100*-----------------------------------------------------------------22010039
220200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              22020039
220300                                                                  22030039
220400              MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME              22040039
220500              PERFORM 2105-RACF-ACCESS                            22050039
220600              IF  PS-ACCESS-NOT-ALLOWED                           22060039
220700                  SET  PS-ERROR                                   22070039
220800                       DP020-MSG-FATAL TO TRUE                    22080039
220900                  MOVE PC-TSYMSG-02307 TO DP020-MSG-NUMBER        22090039
221000                  MOVE -1              TO MR-SELECTL (PV-SUB)     22100039
221100                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            22110039
221200              END-IF                                              22120039
221300                                                                  22130039
221400              IF  PS-NO-ERROR                                     22140039
221500                  MOVE  ASC-PULL-STATUS  TO  PV-PULL-STATUS       22150039
221600                                                                  22160039
221700                  EVALUATE  TRUE                                  22170039
221800                      WHEN  PV-PULL-STATUS-DISTRIBTD              22180039
221900                      WHEN  PV-PULL-STATUS-POSTED                 22190039
222000                            SET PS-ERROR                          22200039
222100                            DP020-MSG-FATAL   TO TRUE             22210039
222200                            MOVE PC-TSYMSG-02267                  22220039
222300                                              TO DP020-MSG-NUMBER 22230039
222400                            MOVE -1         TO MR-SELECTL (PV-SUB)22240039
222500                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   22250039
222600                  END-EVALUATE                                    22260039
222700              END-IF                                              22270039
222800                                                                  22280039
222900*-----------------------------------------------------------------22290039
223000* LOCAL-FUNC-06 ((UN)CONFIRM DISTRO) PULL CANNOT BE POSTED/CNCL   22300039
223100*-----------------------------------------------------------------22310039
223200         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              22320039
223300                                                                  22330039
223400              MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME              22340039
223500              PERFORM 2105-RACF-ACCESS                            22350039
223600              IF  PS-ACCESS-NOT-ALLOWED                           22360039
223700                  SET  PS-ERROR                                   22370039
223800                       DP020-MSG-FATAL TO TRUE                    22380039
223900                  MOVE PC-TSYMSG-02308 TO DP020-MSG-NUMBER        22390039
224000                  MOVE -1              TO MR-SELECTL (PV-SUB)     22400039
224100                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            22410039
224200              END-IF                                              22420039
224300                                                                  22430039
224400              IF  PS-NO-ERROR                                     22440039
224500                  MOVE  ASC-PULL-STATUS  TO  PV-PULL-STATUS       22450039
224600                                                                  22460039
224700                  EVALUATE  TRUE                                  22470039
224800                      WHEN PV-PULL-STATUS-NEW                     22480039
224900                            SET PS-ERROR                          22490039
225000                            DP020-MSG-FATAL   TO TRUE             22500039
225100                            MOVE PC-TSYMSG-02317                  22510039
225200                                              TO DP020-MSG-NUMBER 22520039
225300                            MOVE -1    TO MR-SELECTL (PV-SUB)     22530039
225400                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   22540039
225500                                                                  22550039
225600                      WHEN  PV-PULL-STATUS-POSTED                 22560039
225700                            SET PS-ERROR                          22570039
225800                            DP020-MSG-FATAL   TO TRUE             22580039
225900                            MOVE PC-TSYMSG-02224                  22590039
226000                                              TO DP020-MSG-NUMBER 22600039
226100                            MOVE -1    TO MR-SELECTL (PV-SUB)     22610039
226200                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   22620039
226300                                                                  22630039
226400                      WHEN  PV-PULL-STATUS-CANCELLED              22640039
226500                            SET PS-ERROR                          22650039
226600                            DP020-MSG-FATAL TO TRUE               22660039
226700                            MOVE PC-TSYMSG-02225                  22670039
226800                                              TO DP020-MSG-NUMBER 22680039
226900                            MOVE -1    TO MR-SELECTL (PV-SUB)     22690039
227000                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   22700039
227100                                                                  22710039
227200                  END-EVALUATE                                    22720039
227300              END-IF                                              22730039
227400*-----------------------------------------------------------------22740039
227500* LOCAL-FUNC-09 ((UN)POST) IN-PROCESS OR POSTED STATUS ONLY       22750039
227600*-----------------------------------------------------------------22760039
227700         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              22770039
227800                                                                  22780039
227900              MOVE 'CECSPOST' TO DP008-FUNCTION-NAME              22790039
228000              PERFORM 2105-RACF-ACCESS                            22800039
228100              IF  PS-ACCESS-NOT-ALLOWED                           22810039
228200                  SET  PS-ERROR                                   22820039
228300                       DP020-MSG-FATAL TO TRUE                    22830039
228400                  MOVE PC-TSYMSG-02560 TO DP020-MSG-NUMBER        22840039
228500                  MOVE -1              TO MR-SELECTL (PV-SUB)     22850039
228600                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            22860039
228700              END-IF                                              22870039
228800                                                                  22880039
228900              IF  PS-NO-ERROR                                     22890039
229000                  MOVE  ASC-PULL-STATUS  TO  PV-PULL-STATUS       22900039
229100                                                                  22910039
229200                  EVALUATE  TRUE                                  22920039
229300                      WHEN PV-PULL-STATUS-NEW                     22930039
229400                            SET PS-ERROR                          22940039
229500                            DP020-MSG-FATAL   TO TRUE             22950039
229600                            MOVE PC-TSYMSG-02561                  22960039
229700                                              TO DP020-MSG-NUMBER 22970039
229800                            MOVE -1    TO MR-SELECTL (PV-SUB)     22980039
229900                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   22990039
230000                                                                  23000039
230100                      WHEN  PV-PULL-STATUS-DISTRIBTD              23010039
230200                            SET PS-ERROR                          23020039
230300                            DP020-MSG-FATAL   TO TRUE             23030039
230400                            MOVE PC-TSYMSG-02563                  23040039
230500                                              TO DP020-MSG-NUMBER 23050039
230600                            MOVE -1    TO MR-SELECTL (PV-SUB)     23060039
230700                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   23070039
230800                                                                  23080039
230900                      WHEN  PV-PULL-STATUS-CANCELLED              23090039
231000                            SET PS-ERROR                          23100039
231100                            DP020-MSG-FATAL TO TRUE               23110039
231200                            MOVE PC-TSYMSG-02562                  23120039
231300                                              TO DP020-MSG-NUMBER 23130039
231400                            MOVE -1    TO MR-SELECTL (PV-SUB)     23140039
231500                            SET DP030-SET-CURSOR-APPL-1 TO TRUE   23150039
231600                                                                  23160039
231700                  END-EVALUATE                                    23170039
231800              END-IF                                              23180039
231900     END-EVALUATE                                                 23190039
232000     END-IF.                                                      23200039
232100                                                                  23210039
232200                                                                  23220039
232300*-----------------------------------------------------------------23230039
232400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              23240039
232500* EDITTING IS DONE FROM THE BOTTOM UP.                            23250039
232600**                                                                23260039
232700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       23270039
232800         ASC-ITEMS-DISPLAYED - 1.                                 23280039
232900     PERFORM 3100-SET-SUBSCRIPTS.                                 23290039
233000                                                                  23300039
233100      IF  PS-NO-ERROR                                             23310039
233200          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       23320039
233300      END-IF.                                                     23330039
233400*                                                                 23340039
233500     IF  PS-NO-ERROR                                              23350039
233600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        23360039
233700     END-IF.                                                      23370039
233800*                                                                 23380039
233900     IF  ((PS-NO-ERROR)                                           23390039
234000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   23400039
234100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    23410039
234200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  23420039
234300     END-IF.                                                      23430039
234400                                                                  23440039
234500                                                                  23450039
234600*----------------------------------------------------------------*23460039
234700* 3005-EDIT-COMMAREA-BLOCKS                                      *23470039
234800*----------------------------------------------------------------*23480039
234900 3005-EDIT-COMMAREA-BLOCKS.                                       23490039
235000     MOVE +1                       TO PV-BLOCK-NUMBER.            23500039
235100     MOVE +1                       TO ASC-BLK-SUB.                23510039
235200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               23520039
235300                                                                  23530039
235400     COMPUTE PV-BLOCK-NUMBER  =                                   23540039
235500             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            23550039
235600             PC-ITEMS-PER-PANEL.                                  23560039
235700                                                                  23570039
235800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          23580039
235900                                                                  23590039
236000     PERFORM                                                      23600039
236100        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         23610039
236200           OR PS-ERROR                                            23620039
236300           OR PS-BLOCK-ERROR                                      23630039
236400                                                                  23640039
236500              COMPUTE PV-ITEMS-HOLD  =                            23650039
236600                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       23660039
236700                      PC-ITEMS-PER-PANEL - 1                      23670039
236800                                                                  23680039
236900               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     23690039
237000                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             23700039
237100                       FROM  PV-ITEMS-HOLD                        23710039
237200                     GIVING  PV-ITEMS-DIFF                        23720039
237300                   SUBTRACT  PV-ITEMS-DIFF                        23730039
237400                       FROM  PC-ITEMS-PER-PANEL                   23740039
237500                     GIVING  PV-ITEMS-HOLD                        23750039
237600                       MOVE  PV-ITEMS-HOLD TO PV-SUB              23760039
237700                                              ASC-ITEM-SUB        23770039
237800                                              ASC-ITEMS-DISPLAYED 23780039
237900                                                                  23790039
238000               ELSE                                               23800039
238100                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            23810039
238200                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      23820039
238300               END-IF                                             23830039
238400                                                                  23840039
238500               PERFORM 3300-EDIT-SELECTIONS                       23850039
238600                       VARYING PV-SUB                             23860039
238700                          FROM PV-SUB BY -1                       23870039
238800                          UNTIL PV-SUB < +1                       23880039
238900                                                                  23890039
239000                  EVALUATE TRUE                                   23900039
239100                      WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) 23910039
239200                           PERFORM 3006-CHECK-SAME-STATUS         23920039
239300                  END-EVALUATE                                    23930039
239400                                                                  23940039
239500               MOVE +1               TO ASC-BLK-SUB               23950039
239600                                                                  23960039
239700               PERFORM 5105-REWRITE-ASC-LISTQ                     23970039
239800                                                                  23980039
239900               MOVE +1                TO ASC-BLK-SUB              23990039
240000                                                                  24000039
240100               IF  PS-BLOCK-ERROR                                 24010039
240200                   SET  PS-ERROR     TO TRUE                      24020039
240300                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      24030039
240400                                     TO PV-TOP-ITEM               24040039
240500               ELSE                                               24050039
240600                   ADD  +1           TO PV-BLOCK-NUMBER           24060039
240700                   IF  PV-BLOCK-NUMBER >                          24070039
240800                       ASC-HIGHEST-BLOCK-WRITTEN                  24080039
240900                       MOVE +2       TO ASC-BLK-SUB               24090039
241000                       PERFORM 4410-READ-TEMP-STORAGE             24100039
241100                       MOVE +1       TO ASC-BLK-SUB               24110039
241200                   ELSE                                           24120039
241300                       PERFORM 4410-READ-TEMP-STORAGE             24130039
241400                       ADD  +1        TO PV-BLOCK-NUMBER          24140039
241500                       MOVE +2        TO ASC-BLK-SUB              24150039
241600                       PERFORM 4410-READ-TEMP-STORAGE             24160039
241700                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          24170039
241800                       MOVE +1        TO ASC-BLK-SUB              24180039
241900               END-IF                                             24190039
242000           END-IF                                                 24200039
242100     END-PERFORM.                                                 24210039
242200                                                                  24220039
242300     IF  PV-ORIGINAL-BLOCK  = +1    OR                            24230039
242400         PS-ERROR                   OR                            24240039
242500         PS-BLOCK-ERROR                                           24250039
242600             CONTINUE                                             24260039
242700     ELSE                                                         24270039
242800         MOVE +1                 TO PV-BLOCK-NUMBER               24280039
242900         MOVE +1                 TO ASC-BLK-SUB                   24290039
243000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24300039
243100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           24310039
243200         PERFORM 4410-READ-TEMP-STORAGE                           24320039
243300                                                                  24330039
243400         PERFORM                                                  24340039
243500            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             24350039
243600               OR PS-ERROR                                        24360039
243700               OR PS-BLOCK-ERROR                                  24370039
243800                                                                  24380039
243900                  COMPUTE PV-ITEMS-HOLD  =                        24390039
244000                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   24400039
244100                          PC-ITEMS-PER-PANEL - 1                  24410039
244200                                                                  24420039
244300                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    24430039
244400                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          24440039
244500                          FROM  PV-ITEMS-HOLD                     24450039
244600                        GIVING  PV-ITEMS-DIFF                     24460039
244700                      SUBTRACT  PV-ITEMS-DIFF                     24470039
244800                          FROM  PC-ITEMS-PER-PANEL                24480039
244900                        GIVING  PV-ITEMS-HOLD                     24490039
245000                          MOVE  PV-ITEMS-HOLD TO PV-SUB           24500039
245100                                                 ASC-ITEM-SUB     24510039
245200                                              ASC-ITEMS-DISPLAYED 24520039
245300                  ELSE                                            24530039
245400                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         24540039
245500                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   24550039
245600                  END-IF                                          24560039
245700                                                                  24570039
245800                  PERFORM 3300-EDIT-SELECTIONS                    24580039
245900                          VARYING PV-SUB                          24590039
246000                             FROM PV-SUB BY -1                    24600039
246100                            UNTIL PV-SUB < +1                     24610039
246200                                                                  24620039
246300                  EVALUATE TRUE                                   24630039
246400                      WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) 24640039
246500                           PERFORM 3006-CHECK-SAME-STATUS         24650039
246600                  END-EVALUATE                                    24660039
246700                                                                  24670039
246800                  MOVE +1               TO ASC-BLK-SUB            24680039
246900                                                                  24690039
247000                  PERFORM 5105-REWRITE-ASC-LISTQ                  24700039
247100                                                                  24710039
247200                  MOVE +1                TO ASC-BLK-SUB           24720039
247300                                                                  24730039
247400                  IF  PS-BLOCK-ERROR                              24740039
247500                      SET  PS-ERROR     TO TRUE                   24750039
247600                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   24760039
247700                                        TO PV-TOP-ITEM            24770039
247800                  ELSE                                            24780039
247900                      ADD  +1            TO PV-BLOCK-NUMBER       24790039
248000                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     24800039
248100                          MOVE +2        TO ASC-BLK-SUB           24810039
248200                          PERFORM 4410-READ-TEMP-STORAGE          24820039
248300                          MOVE +1        TO ASC-BLK-SUB           24830039
248400                      ELSE                                        24840039
248500                          PERFORM 4410-READ-TEMP-STORAGE          24850039
248600                          ADD  +1        TO PV-BLOCK-NUMBER       24860039
248700                          MOVE +2        TO ASC-BLK-SUB           24870039
248800                          PERFORM 4410-READ-TEMP-STORAGE          24880039
248900                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       24890039
249000                          MOVE +1        TO ASC-BLK-SUB           24900039
249100                      END-IF                                      24910039
249200                  END-IF                                          24920039
249300     END-PERFORM.                                                 24930039
249400                                                                  24940039
249500                                                                  24950039
249600*----------------------------------------------------------------*24960039
249700* CHECK TO MAKE SURE THAT ALL SELECTED ITEMS HAS SAME STATUS     *24970039
249800*----------------------------------------------------------------*24980039
249900 3006-CHECK-SAME-STATUS.                                          24990039
250000                                                                  25000039
250100     IF  PS-NO-BLOCK-ERROR                                        25010039
250200         EVALUATE TRUE                                            25020039
250300             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          25030039
250400                  EVALUATE TRUE                                   25040039
250500                      WHEN ASC-CONFIRM-UNCNCL-ITEM                25050039
250600                           IF  PV-SEL-UNCNCL-CNT  =               25060039
250700                               ASC-NUMBER-OF-SELECTED-ITEMS       25070039
250800                               CONTINUE                           25080039
250900                           ELSE                                   25090039
251000                               SET PS-ERROR                       25100039
251100                                   PS-BLOCK-ERROR                 25110039
251200                                   DP020-MSG-FATAL                25120039
251300                                  DP030-SET-CURSOR-APPL-1 TO TRUE 25130039
251400                               MOVE PC-TSYMSG-02278               25140039
251500                                 TO  DP020-MSG-NUMBER             25150039
251600                                MOVE -1  TO  MR-SELECTL (1)       25160039
251700                           END-IF                                 25170039
251800                                                                  25180039
251900                      WHEN ASC-CONFIRM-CNCL-ITEM                  25190039
252000                           IF  PV-SEL-CNCL-CNT  =                 25200039
252100                               ASC-NUMBER-OF-SELECTED-ITEMS       25210039
252200                               CONTINUE                           25220039
252300                           ELSE                                   25230039
252400                              SET PS-ERROR                        25240039
252500                                  PS-BLOCK-ERROR                  25250039
252600                                  DP020-MSG-FATAL                 25260039
252700                                  DP030-SET-CURSOR-APPL-1 TO TRUE 25270039
252800                              MOVE PC-TSYMSG-02278                25280039
252900                                TO  DP020-MSG-NUMBER              25290039
253000                              MOVE -1  TO  MR-SELECTL (1)         25300039
253100                           END-IF                                 25310039
253200                 END-EVALUATE                                     25320039
253300         END-EVALUATE                                             25330039
253400     END-IF.                                                      25340039
253500                                                                  25350039
253600                                                                  25360039
253700*----------------------------------------------------------------*25370039
253800* VALIDATE PRINTER ID                                            *25380039
253900*----------------------------------------------------------------*25390039
254000 3010-VALIDATE-PRINTER-ID.                                        25400039
254100                                                                  25410039
254200     IF  ASC-CS-PRINTER-ID  =  SPACES                             25420039
254300         SET PS-ERROR                                             25430039
254400             DP020-MSG-FATAL       TO TRUE                        25440039
254500         MOVE PC-TSYMSG-01563      TO DP020-MSG-NUMBER            25450039
254600         MOVE DP015-UNP-ALP-BRT-OFF                               25460039
254700                                   TO APRTIDA                     25470039
254800         MOVE DP015-RED            TO APRTIDC                     25480039
254900         MOVE DP015-REVERSE        TO APRTIDH                     25490039
255000         MOVE -1                   TO APRTIDL                     25500039
255100         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    25510039
255200     ELSE                                                         25520039
255300         PERFORM 3020-VALIDATE-PRINTER                            25530039
255410         IF  DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'              25541047
255500             CONTINUE                                             25550039
255600         ELSE                                                     25560039
255700             SET PS-ERROR                                         25570039
255800                 DP020-MSG-FATAL           TO TRUE                25580039
255900             MOVE PC-TSYMSG-00746          TO DP020-MSG-NUMBER    25590039
256000             MOVE DP015-UNP-ALP-BRT-OFF    TO APRTIDA             25600039
256100             MOVE DP015-RED                TO APRTIDC             25610039
256200             MOVE DP015-REVERSE            TO APRTIDH             25620039
256300             MOVE -1                       TO APRTIDL             25630039
256400             SET DP030-SET-CURSOR-APPL-1   TO TRUE                25640039
256500         END-IF                                                   25650039
256600     END-IF.                                                      25660039
256700                                                                  25670039
256800                                                                  25680039
256900*----------------------------------------------------------------*25690039
257000*   3020-VALIDATE-PRINTER                                        *25700039
257100* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *25710039
257200*----------------------------------------------------------------*25720039
257300 3020-VALIDATE-PRINTER.                                           25730039
257400                                                                  25740039
257500     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     25750039
257600     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 25760039
257700     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        25770039
257800     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     25780039
257900                                        DP072-FCLTY-ID.           25790039
258000     MOVE ASC-CS-PRINTER-ID          TO DP072-PRINTER-ID          25800039
258100     MOVE PC-REPORT-PGM-1            TO DP072-RPT-PGM-NME         25810039
258200     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     25820039
258300     SET DP072-VALIDATE              TO TRUE.                     25830039
258400                                                                  25840039
258500     EXEC CICS                                                    25850039
258600          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  25860039
258700               COMMAREA (DP072-COMM-AREA)                         25870039
258800               RESP     (PV-CICS-RESPONSE)                        25880039
258900     END-EXEC                                                     25890039
259000                                                                  25900039
259100     EVALUATE TRUE                                                25910039
259200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 25920039
259300              CONTINUE                                            25930039
259400         WHEN OTHER                                               25940039
259500             SET PS-ERROR                                         25950039
259600                 DP020-MSG-FATAL       TO TRUE                    25960039
259700             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        25970039
259800             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              25980039
259900                 MOVE DP015-UNP-ALP-BRT-OFF                       25990039
260000                                       TO APRTIDA                 26000039
260100                 MOVE DP015-RED        TO APRTIDC                 26010039
260200                 MOVE DP015-REVERSE    TO APRTIDH                 26020039
260300                 MOVE -1               TO APRTIDL                 26030039
260400             ELSE                                                 26040039
260500                 MOVE DP015-UNP-ALP-BRT-OFF                       26050039
260600                                       TO APRTIDA                 26060039
260700                 MOVE DP015-RED        TO APRTIDC                 26070039
260800                 MOVE DP015-REVERSE    TO APRTIDH                 26080039
260900                 MOVE -1               TO APRTIDL                 26090039
261000             END-IF                                               26100039
261100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  26110039
261200     END-EVALUATE.                                                26120039
261300                                                                  26130039
261400                                                                  26140039
261500*----------------------------------------------------------------*26150039
261600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *26160039
261700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*26170039
261800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *26180039
261900*                                                                *26190039
262000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *26200039
262100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *26210039
262200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *26220039
262300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *26230039
262400*----------------------------------------------------------------*26240039
262500                                                                  26250039
262600 3100-SET-SUBSCRIPTS.                                             26260039
262700                                                                  26270039
262800     COMPUTE ASC-ITEM-SUB =                                       26280039
262900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        26290039
263000                                                                  26300039
263100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         26310039
263200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26320039
263300                                                                  26330039
263400         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               26340039
263500     ELSE                                                         26350039
263600         MOVE +1                     TO ASC-BLK-SUB               26360039
263700     END-IF.                                                      26370039
263800******************************************************************26380039
263900** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **26390039
264000******************************************************************26400039
264100                                                                  26410039
264200 3200-RESET-ATTRIBUTES.                                           26420039
264300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    26430039
264400                                      APRTIDA.                    26440039
264500     MOVE DP015-GREEN              TO ASTRTITC                    26450039
264600                                      APRTIDC.                    26460039
264700     MOVE DP015-UNDERLINE          TO ASTRTITH                    26470039
264800                                      APRTIDH.                    26480039
264900*                                                                 26490039
265000     PERFORM                                                      26500039
265100         VARYING PV-SUB                                           26510039
265200         FROM 1 BY 1                                              26520039
265300         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        26530039
265400         MOVE DP015-UNP-ALP-NOR-OFF                               26540039
265500                                   TO MR-SELECTA (PV-SUB)         26550039
265600         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         26560039
265700         MOVE DP015-BLUE           TO MR-LINE-STATUSC (PV-SUB)    26570039
265800         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         26580039
265900     END-PERFORM.                                                 26590039
266000******************************************************************26600039
266100** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **26610039
266200** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **26620039
266300** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **26630039
266400** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **26640039
266500******************************************************************26650039
266600 3300-EDIT-SELECTIONS.                                            26660039
266700     EVALUATE TRUE                                                26670039
266800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     26680039
266900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         26690039
267000                 CONTINUE                                         26700039
267100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         26710039
267200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        26720039
267300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   26730039
267400                 MOVE ASC-TEMP-SELECTED-SW                        26740039
267500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26750039
267600                                TO ASC-SELECTED-SW                26760039
267700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26770039
267800             END-IF                                               26780039
267900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     26790039
268000                 = SPACE                                          26800039
268100             EVALUATE TRUE                                        26810039
268200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       26820039
268300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS26830039
268400                     MOVE SPACE TO ASC-SELECTED-SW                26840039
268500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26850039
268600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        26860039
268700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    26870039
268800                     MOVE SPACE TO ASC-SELECTED-SW                26880039
268900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26890039
269000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          26900039
269100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      26910039
269200                     MOVE SPACE TO ASC-SELECTED-SW                26920039
269300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26930039
269400             END-EVALUATE                                         26940039
269500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           26950039
269600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            26960039
269700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    26970039
269800             END-IF                                               26980039
269900             PERFORM 3310-EDIT-RANGE                              26990039
270000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             27000039
270100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            27010039
270200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    27020039
270300             END-IF                                               27030039
270400             PERFORM 3310-EDIT-RANGE                              27040039
270500         WHEN OTHER                                               27050039
270600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           27060039
270700             SET DP020-MSG-FATAL    TO TRUE                       27070039
270800             MOVE -1                TO MR-SELECTL (PV-SUB)        27080039
270900             SET DP030-SET-CURSOR-APPL-1                          27090039
271000                                    TO TRUE                       27100039
271100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        27110039
271200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        27120039
271300             SET PS-ERROR TO TRUE                                 27130039
271400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            27140039
271500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     27150039
271600                 MOVE SPACE         TO ASC-SELECTED-SW            27160039
271700                                        (ASC-BLK-SUB ASC-ITEM-SUB)27170039
271800             END-IF                                               27180039
271900     END-EVALUATE.                                                27190039
272000                                                                  27200039
272100     PERFORM 3305-EDIT-LINES.                                     27210039
272200                                                                  27220039
272300     EVALUATE TRUE                                                27230039
272400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              27240039
272500              EVALUATE TRUE                                       27250039
272600                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      27260039
272700                       PERFORM 3600-UN-CNCL-EDITS                 27270039
272800              END-EVALUATE                                        27280039
272900                                                                  27290039
273000         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              27300039
273100              EVALUATE TRUE                                       27310039
273200                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      27320039
273300                       PERFORM 3630-UN-CNFM-DIST-EDITS            27330039
273400              END-EVALUATE                                        27340039
273500                                                                  27350039
273600         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              27360039
273700              EVALUATE TRUE                                       27370039
273800                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      27380039
273900                       PERFORM 3640-PRINT-LINE-EDITS              27390039
274000              END-EVALUATE                                        27400039
274100                                                                  27410039
274200         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              27420039
274300              EVALUATE TRUE                                       27430039
274400                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      27440039
274500                       PERFORM 3650-UN-POST-LINE-EDITS            27450039
274600              END-EVALUATE                                        27460039
274700     END-EVALUATE.                                                27470039
274800                                                                  27480039
274900     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 27490039
275000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               27500039
275100     IF  ASC-ITEM-SUB < 1                                         27510039
275200         SUBTRACT +1 FROM ASC-BLK-SUB                             27520039
275300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                27530039
275400     END-IF.                                                      27540039
275500                                                                  27550039
275600                                                                  27560039
275700*----------------------------------------------------------------*27570039
275800*  EDIT SELECTED LINES                                           *27580039
275900*----------------------------------------------------------------*27590039
276000 3305-EDIT-LINES.                                                 27600039
276100                                                                  27610039
276200                                                                  27620039
276300     IF  PS-NO-ERROR                                              27630039
276400       IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                  27640039
276500         EVALUATE TRUE                                            27650039
276600             WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)          27660039
276700                                                                  27670039
276800                  EVALUATE TRUE                                   27680039
276900                      WHEN ASC-LINE-STATUS-POSTED                 27690039
277000                               (ASC-BLK-SUB ASC-ITEM-SUB)         27700039
277100                      WHEN ASC-LINE-STATUS-DISTRIBTD              27710039
277200                               (ASC-BLK-SUB ASC-ITEM-SUB)         27720039
277300                                                                  27730039
277400                           SET PS-ERROR                           27740039
277500                               DP020-MSG-FATAL TO  TRUE           27750039
277600                           MOVE PC-TSYMSG-02324                   27760039
277700                                      TO DP020-MSG-NUMBER         27770039
277800                           MOVE DP015-UNP-ALP-BRT-OFF             27780039
277900                                      TO MR-SELECTA (PV-SUB)      27790039
278000                           MOVE DP015-RED                         27800039
278100                                      TO MR-SELECTC (PV-SUB)      27810039
278200                           MOVE DP015-REVERSE                     27820039
278300                                      TO MR-SELECTH (PV-SUB)      27830039
278400                           MOVE -1    TO MR-SELECTL (PV-SUB)      27840039
278500                           SET DP030-SET-CURSOR-APPL-1            27850039
278600                                      TO TRUE                     27860039
278700                                                                  27870039
278800                      WHEN ASC-LINE-STATUS-CANCELLED              27880039
278900                               (ASC-BLK-SUB ASC-ITEM-SUB)         27890039
279000                                                                  27900039
279100                           SET PS-ERROR                           27910039
279200                               DP020-MSG-FATAL TO  TRUE           27920039
279300                           MOVE PC-TSYMSG-02325                   27930039
279400                                      TO DP020-MSG-NUMBER         27940039
279500                           MOVE DP015-UNP-ALP-BRT-OFF             27950039
279600                                      TO MR-SELECTA (PV-SUB)      27960039
279700                           MOVE DP015-RED                         27970039
279800                                      TO MR-SELECTC (PV-SUB)      27980039
279900                           MOVE DP015-REVERSE                     27990039
280000                                      TO MR-SELECTH (PV-SUB)      28000039
280100                           MOVE -1    TO MR-SELECTL (PV-SUB)      28010039
280200                           SET DP030-SET-CURSOR-APPL-1            28020039
280300                                      TO TRUE                     28030039
280400                                                                  28040039
280500                  END-EVALUATE                                    28050039
280600         END-EVALUATE                                             28060039
280700       END-IF                                                     28070039
280800     END-IF.                                                      28080039
280900                                                                  28090039
281000                                                                  28100039
281100******************************************************************28110039
281200** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **28120039
281300** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **28130039
281400** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**28140039
281500** THE ENDING.                                                  **28150039
281600******************************************************************28160039
281700 3310-EDIT-RANGE.                                                 28170039
281800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                28180039
281900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   28190039
282000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)28200039
282100                                   TO ASC-SELECTED-SW             28210039
282200                                        (ASC-BLK-SUB ASC-ITEM-SUB)28220039
282300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 28230039
282400         ELSE                                                     28240039
282500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     28250039
282600                 CONTINUE                                         28260039
282700             ELSE                                                 28270039
282800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        28280039
282900                 MOVE PC-TSYMSG-00054                             28290039
283000                                   TO DP020-MSG-NUMBER            28300039
283100                 SET DP020-MSG-FATAL                              28310039
283200                                   TO TRUE                        28320039
283300                 MOVE -1           TO MR-SELECTL (PV-SUB)         28330039
283400                 SET DP030-SET-CURSOR-APPL-1                      28340039
283500                                   TO TRUE                        28350039
283600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         28360039
283700                 MOVE DP015-UNDERLINE                             28370039
283800                                   TO MR-SELECTH (PV-SUB)         28380039
283900                 SET PS-ERROR      TO TRUE                        28390039
284000             END-IF                                               28400039
284100         END-IF                                                   28410039
284200     ELSE                                                         28420039
284300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28430039
284400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 28440039
284500                                   TO ASC-SELECTED-SW             28450039
284600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28460039
284700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   28470039
284800         ELSE                                                     28480039
284900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       28490039
285000                 CONTINUE                                         28500039
285100             ELSE                                                 28510039
285200*                -- ONLY ONE END-OF-RANGE ALLOWED --              28520039
285300                 MOVE PC-TSYMSG-00055                             28530039
285400                                   TO DP020-MSG-NUMBER            28540039
285500                 SET DP020-MSG-FATAL                              28550039
285600                                   TO TRUE                        28560039
285700                 MOVE -1           TO MR-SELECTL (PV-SUB)         28570039
285800                 SET DP030-SET-CURSOR-APPL-1                      28580039
285900                                   TO TRUE                        28590039
286000                 SET PS-ERROR      TO TRUE                        28600039
286100             END-IF                                               28610039
286200         END-IF                                                   28620039
286300     END-IF.                                                      28630039
286400*                                                                 28640039
286500******************************************************************28650039
286600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **28660039
286700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **28670039
286800******************************************************************28680039
286900 3400-CHECK-RANGE-SEQUENCE.                                       28690039
287000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28700039
287100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      28710039
287200       AND  ASC-START-OF-SELECTED-RANGE >                         28720039
287300                                         ASC-END-OF-SELECTED-RANGE28730039
287400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                28740039
287500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 28750039
287600         SET DP020-MSG-FATAL TO TRUE                              28760039
287700         SET PS-ERROR TO TRUE                                     28770039
287800         PERFORM 3410-POSITION-AT-ERROR                           28780039
287900     END-IF.                                                      28790039
288000******************************************************************28800039
288100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **28810039
288200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **28820039
288300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **28830039
288400******************************************************************28840039
288500 3410-POSITION-AT-ERROR.                                          28850039
288600     SET DP030-SET-CURSOR-APPL-1                                  28860039
288700                                   TO TRUE.                       28870039
288800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 28880039
288900                    - PV-TOP-ITEM + 1.                            28890039
289000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28900039
289100         CONTINUE                                                 28910039
289200     ELSE                                                         28920039
289300         MOVE -1                   TO MR-SELECTL (PV-SUB)         28930039
289400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28940039
289500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         28950039
289600     END-IF.                                                      28960039
289700*                                                                 28970039
289800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   28980039
289900                    - PV-TOP-ITEM + 1.                            28990039
290000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29000039
290100         CONTINUE                                                 29010039
290200     ELSE                                                         29020039
290300         MOVE -1                   TO MR-SELECTL (PV-SUB)         29030039
290400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29040039
290500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         29050039
290600     END-IF.                                                      29060039
290700 EJECT                                                            29070039
290800*----------------------------------------------------------------*29080039
290900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *29090039
291000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *29100039
291100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *29110039
291200*----------------------------------------------------------------*29120039
291300                                                                  29130039
291400 3500-MARK-RANGE-AS-SELECTED.                                     29140039
291500     MOVE +1                       TO  ASC-BLK-SUB.               29150039
291600     PERFORM 3510-MARK-SELECTED-INDS                              29160039
291700         VARYING ASC-ITEM-SUB                                     29170039
291800         FROM 1 BY 1                                              29180039
291900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 29190039
292000                                                                  29200039
292100     ADD +1                        TO ASC-BLK-SUB.                29210039
292200     PERFORM 3510-MARK-SELECTED-INDS                              29220039
292300         VARYING ASC-ITEM-SUB                                     29230039
292400         FROM 1 BY 1                                              29240039
292500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 29250039
292600                                                                  29260039
292700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               29270039
292800                                   TO  PV-LIST-ITEM-NUMBER.       29280039
292900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            29290039
293000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         29300039
293100               PC-ITEMS-PER-PANEL).                               29310039
293200                                                                  29320039
293300     MOVE ASC-START-OF-SELECTED-RANGE                             29330039
293400                                   TO PV-START-OF-SELECTED-RANGE. 29340039
293500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            29350039
293600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  29360039
293700               PC-ITEMS-PER-PANEL).                               29370039
293800                                                                  29380039
293900     MOVE ASC-END-OF-SELECTED-RANGE                               29390039
294000                                   TO  PV-END-OF-SELECTED-RANGE.  29400039
294100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             29410039
294200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    29420039
294300               PC-ITEMS-PER-PANEL).                               29430039
294400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             29440039
294500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             29450039
294600                                                                  29460039
294700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    29470039
294800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        29480039
294900         MOVE +1                   TO ASC-BLK-SUB                 29490039
295000         PERFORM 5100-WRITE-TEMP-STORAGE                          29500039
295100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         29510039
295200             PV-FIRST-BLOCK-IN-ARRAY - 1                          29520039
295300                                                                  29530039
295400         PERFORM                                                  29540039
295500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      29550039
295600                   PV-PREV-BLOCK-IN-ARRAY                         29560039
295700             MOVE PV-FIRST-BLOCK-IN-RANGE                         29570039
295800                                   TO PV-BLOCK-NUMBER             29580039
295900             PERFORM 4410-READ-TEMP-STORAGE                       29590039
296000             PERFORM 3510-MARK-SELECTED-INDS                      29600039
296100                 VARYING ASC-ITEM-SUB                             29610039
296200                 FROM 1 BY 1                                      29620039
296300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29630039
296400             PERFORM 5100-WRITE-TEMP-STORAGE                      29640039
296500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     29650039
296600         END-PERFORM                                              29660039
296700                                                                  29670039
296800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         29680039
296900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     29690039
297000         PERFORM                                                  29700039
297100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       29710039
297200                   PV-LAST-BLOCK-IN-RANGE                         29720039
297300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          29730039
297400                                   TO PV-BLOCK-NUMBER             29740039
297500             PERFORM 4410-READ-TEMP-STORAGE                       29750039
297600             PERFORM 3510-MARK-SELECTED-INDS                      29760039
297700                 VARYING ASC-ITEM-SUB                             29770039
297800                 FROM 1 BY 1                                      29780039
297900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29790039
298000             PERFORM 5100-WRITE-TEMP-STORAGE                      29800039
298100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      29810039
298200         END-PERFORM                                              29820039
298300                                                                  29830039
298400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             29840039
298500                                   TO PV-BLOCK-NUMBER             29850039
298600         PERFORM 4410-READ-TEMP-STORAGE                           29860039
298700     END-IF.                                                      29870039
298800                                                                  29880039
298900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 29890039
299000                                      ASC-END-OF-SELECTED-RANGE.  29900039
299100                                                                  29910039
299200 EJECT                                                            29920039
299300*----------------------------------------------------------------*29930039
299400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *29940039
299500*----------------------------------------------------------------*29950039
299600                                                                  29960039
299700 3510-MARK-SELECTED-INDS.                                         29970039
299800                                                                  29980039
299900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         29990039
300000                                ASC-ITEM-SUB) >                   30000039
300100         ASC-START-OF-SELECTED-RANGE)                             30010039
300200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         30020039
300300                                ASC-ITEM-SUB) =                   30030039
300400         ASC-START-OF-SELECTED-RANGE)                             30040039
300500                                                                  30050039
300600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     30060039
300700                                    ASC-ITEM-SUB) <               30070039
300800             ASC-END-OF-SELECTED-RANGE)                           30080039
300900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     30090039
301000                                    ASC-ITEM-SUB) =               30100039
301100             ASC-END-OF-SELECTED-RANGE)                           30110039
301200                                                                  30120039
301300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          30130039
301400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   30140039
301500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   30150039
301600                               TO TRUE                            30160039
301700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              30170039
301800                               TO TRUE                            30180039
301900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    30190039
302000             END-IF                                               30200039
302100         END-IF                                                   30210039
302200     END-IF.                                                      30220039
302300                                                                  30230039
302400                                                                  30240039
302500*----------------------------------------------------------------*30250039
302600* CANCEL/UNCANCEL EDITS                                          *30260039
302700*----------------------------------------------------------------*30270039
302800 3600-UN-CNCL-EDITS.                                              30280039
302900                                                                  30290039
303000     EVALUATE TRUE                                                30300039
303100         WHEN ASC-LINE-STATUS-DISTRIBTD (ASC-BLK-SUB ASC-ITEM-SUB)30310039
303200         WHEN ASC-LINE-STATUS-POSTED (ASC-BLK-SUB ASC-ITEM-SUB)   30320039
303300              SET PS-ERROR                                        30330039
303400              DP020-MSG-FATAL   TO TRUE                           30340039
303500              MOVE PC-TSYMSG-02268  TO DP020-MSG-NUMBER           30350039
303600              MOVE -1               TO MR-SELECTL (PV-SUB)        30360039
303700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 30370039
303800              MOVE DP015-RED        TO MR-LINE-NUMBERC (PV-SUB)   30380039
303900              MOVE DP015-REVERSE    TO MR-LINE-NUMBERH (PV-SUB)   30390039
304000              SET PS-BLOCK-ERROR    TO TRUE                       30400039
304100     END-EVALUATE.                                                30410039
304200                                                                  30420039
304300     IF  PS-NO-ERROR                                              30430039
304400         PERFORM 3605-CHECK-RDM-TCEPLMF                           30440039
304500     END-IF.                                                      30450039
304600                                                                  30460039
304700     IF  PS-NO-ERROR                                              30470039
304800         PERFORM 3610-CHECK-RDM-TCEPLAU                           30480039
304900     END-IF.                                                      30490039
305000                                                                  30500039
305100     IF  PS-NO-ERROR                                              30510039
305200         IF  ASC-LINE-STATUS-CANCELLED (ASC-BLK-SUB ASC-ITEM-SUB) 30520039
305300             SET  ASC-CONFIRM-UNCNCL-ITEM                         30530039
305400                  PS-ERROR                                        30540039
305500                  DP020-MSG-WARNING                               30550039
305600                  PS-CONFIRM-PROCESSING  TO TRUE                  30560039
305700             MOVE PC-TSYMSG-02257        TO DP020-MSG-NUMBER      30570039
305800             MOVE -1                     TO MR-SELECTL (1)        30580039
305900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  30590039
306000         ELSE                                                     30600039
306100             SET  ASC-CONFIRM-CNCL-ITEM                           30610039
306200                  PS-ERROR                                        30620039
306300                  DP020-MSG-WARNING                               30630039
306400                  PS-CONFIRM-PROCESSING  TO TRUE                  30640039
306500             MOVE PC-TSYMSG-02256        TO DP020-MSG-NUMBER      30650039
306600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  30660039
306700         END-IF                                                   30670039
306800     END-IF.                                                      30680039
306900                                                                  30690039
307000     IF  ASC-LINE-STATUS-CANCELLED (ASC-BLK-SUB ASC-ITEM-SUB)     30700039
307100         ADD  1  TO PV-SEL-UNCNCL-CNT                             30710039
307200     ELSE                                                         30720039
307300         ADD  1  TO PV-SEL-CNCL-CNT                               30730039
307400     END-IF.                                                      30740039
307500                                                                  30750039
307600                                                                  30760039
307700*-----------------------------------------------------------------30770039
307800* COUNT NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT ARE BEING    30780039
307900* WORKED IN RDM                                                   30790039
308000*-----------------------------------------------------------------30800039
308100 3605-CHECK-RDM-TCEPLMF.                                          30810039
308200                                                                  30820039
308300     INITIALIZE  PV-TCEPLMF-COUNT.                                30830039
308400     MOVE  ASC-PULL-NBR-N                                         30840039
308500       TO  DK-PULL-NUMBER.                                        30850039
308600     MOVE  ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             30860039
308700       TO  DK-LINE-NUMBER.                                        30870039
308800                                                                  30880039
308900     EXEC SQL                                                     30890039
309000          SELECT COUNT(*)                                         30900039
309100            INTO :PV-TCEPLMF-COUNT                                30910039
309200            FROM TCEPLMF                                          30920039
309300           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             30930039
309400             AND PL_LNE_NBR        =  :DK-LINE-NUMBER             30940039
309500     END-EXEC.                                                    30950039
309600                                                                  30960039
309700     EVALUATE TRUE                                                30970039
309800         WHEN SQLCODE = +0                                        30980039
309900              IF  PV-TCEPLMF-COUNT  >  0                          30990039
310000                  SET PS-ERROR                                    31000039
310100                  DP020-MSG-FATAL   TO TRUE                       31010039
310200                  MOVE PC-TSYMSG-02268  TO DP020-MSG-NUMBER       31020039
310300                  MOVE -1               TO MR-SELECTL (PV-SUB)    31030039
310400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             31040039
310500                  MOVE DP015-RED      TO MR-LINE-NUMBERC (PV-SUB) 31050039
310600                  MOVE DP015-REVERSE  TO MR-LINE-NUMBERH (PV-SUB) 31060039
310700                  SET PS-BLOCK-ERROR    TO TRUE                   31070039
310800              END-IF                                              31080039
310900                                                                  31090039
311000         WHEN SQLCODE = +100                                      31100039
311100              CONTINUE                                            31110039
311200                                                                  31120039
311300         WHEN OTHER                                               31130039
311400              MOVE '3605-CHECK-RDM-TCEPLMF'   TO DP013-PARAGRAPH  31140039
311500              MOVE 'COUNT NBR LINES WORKED BY RDM   '             31150039
311600                                       TO DP013-MESSAGE-TEXT (1)  31160039
311700              STRING ' PULL NBR-'    DELIMITED BY SIZE            31170039
311800                      ASC-PULL-NBR-N DELIMITED BY SIZE            31180039
311900                     ' LINE NBR-'    DELIMITED BY SIZE            31190039
312000                      ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  31200039
312100                                     DELIMITED BY SIZE            31210039
312200                                     INTO DP013-MESSAGE-TEXT (2)  31220039
312300              MOVE SQLCA                      TO DP013-SQLCA      31230039
312400              MOVE 'TCEPLMF '        TO DP013-DB2-TABLE-NAME (1)  31240039
312500              SET  DP013-DB2-ABEND                                31250039
312600                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            31260039
312700              PERFORM DP013-0000-PROCESS-ABEND                    31270039
312800     END-EVALUATE.                                                31280039
312900                                                                  31290039
313000                                                                  31300039
313100*-----------------------------------------------------------------31310039
313200* COUNT NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT ARE BEING    31320039
313300* WORKED IN RDM                                                   31330039
313400*-----------------------------------------------------------------31340039
313500 3610-CHECK-RDM-TCEPLAU.                                          31350039
313600                                                                  31360039
313700     INITIALIZE  PV-TCEPLAU-COUNT.                                31370039
313800     MOVE  ASC-PULL-NBR-N                                         31380039
313900       TO  DK-PULL-NUMBER.                                        31390039
314000     MOVE  ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             31400039
314100       TO  DK-LINE-NUMBER.                                        31410039
314200                                                                  31420039
314300     EXEC SQL                                                     31430039
314400          SELECT COUNT(*)                                         31440039
314500            INTO :PV-TCEPLAU-COUNT                                31450039
314600            FROM TCEPLAU                                          31460039
314700           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             31470039
314800             AND PL_LNE_NBR        =  :DK-LINE-NUMBER             31480039
314900     END-EXEC.                                                    31490039
315000                                                                  31500039
315100     EVALUATE TRUE                                                31510039
315200         WHEN SQLCODE = +0                                        31520039
315300              IF  PV-TCEPLAU-COUNT  >  0                          31530039
315400                  SET PS-ERROR                                    31540039
315500                  DP020-MSG-FATAL   TO TRUE                       31550039
315600                  MOVE PC-TSYMSG-02268  TO DP020-MSG-NUMBER       31560039
315700                  MOVE -1               TO MR-SELECTL (PV-SUB)    31570039
315800                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             31580039
315900                  MOVE DP015-RED      TO MR-LINE-NUMBERC (PV-SUB) 31590039
316000                  MOVE DP015-REVERSE  TO MR-LINE-NUMBERH (PV-SUB) 31600039
316100                  SET PS-BLOCK-ERROR    TO TRUE                   31610039
316200              END-IF                                              31620039
316300                                                                  31630039
316400         WHEN SQLCODE = +100                                      31640039
316500              CONTINUE                                            31650039
316600                                                                  31660039
316700         WHEN OTHER                                               31670039
316800              MOVE '3610-CHECK-RDM-TCEPLAU'   TO DP013-PARAGRAPH  31680039
316900              MOVE 'COUNT NBR LINES WORKED BY RDM   '             31690039
317000                                       TO DP013-MESSAGE-TEXT (1)  31700039
317100              STRING ' PULL NBR-'    DELIMITED BY SIZE            31710039
317200                      ASC-PULL-NBR-N DELIMITED BY SIZE            31720039
317300                     ' LINE NBR-'    DELIMITED BY SIZE            31730039
317400                      ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  31740039
317500                                     DELIMITED BY SIZE            31750039
317600                                     INTO DP013-MESSAGE-TEXT (2)  31760039
317700              MOVE SQLCA                      TO DP013-SQLCA      31770039
317800              MOVE 'TCEPLAU '        TO DP013-DB2-TABLE-NAME (1)  31780039
317900              SET  DP013-DB2-ABEND                                31790039
318000                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            31800039
318100              PERFORM DP013-0000-PROCESS-ABEND                    31810039
318200     END-EVALUATE.                                                31820039
318300                                                                  31830039
318400                                                                  31840039
318500*----------------------------------------------------------------*31850039
318600* CONFIRM/UNCONFIRM DISTRIBUTION EDITS                           *31860039
318700*----------------------------------------------------------------*31870039
318800 3630-UN-CNFM-DIST-EDITS.                                         31880039
318900                                                                  31890039
319000     PERFORM 3635-CHECK-FOR-RDM.                                  31900039
319100                                                                  31910039
319200     IF  PS-NO-ERROR                                              31920039
319300         EVALUATE TRUE                                            31930039
319400         WHEN ASC-LINE-STATUS-NEW (ASC-BLK-SUB ASC-ITEM-SUB)      31940039
319500              SET PS-ERROR                                        31950039
319600                  DP020-MSG-FATAL TO  TRUE                        31960039
319700              MOVE PC-TSYMSG-02339        TO DP020-MSG-NUMBER     31970039
319800              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  31980039
319900              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  31990039
320000              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  32000039
320100              MOVE -1                     TO MR-SELECTL (PV-SUB)  32010039
320200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 32020039
320300                                                                  32030039
320400         WHEN ASC-LINE-STATUS-POSTED (ASC-BLK-SUB ASC-ITEM-SUB)   32040039
320500              SET PS-ERROR                                        32050039
320600                  DP020-MSG-FATAL TO  TRUE                        32060039
320700              MOVE PC-TSYMSG-02290        TO DP020-MSG-NUMBER     32070039
320800              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  32080039
320900              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  32090039
321000              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  32100039
321100              MOVE -1                     TO MR-SELECTL (PV-SUB)  32110039
321200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 32120039
321300                                                                  32130039
321400         WHEN ASC-LINE-STATUS-CANCELLED (ASC-BLK-SUB ASC-ITEM-SUB)32140039
321500              SET PS-ERROR                                        32150039
321600                  DP020-MSG-FATAL TO  TRUE                        32160039
321700              MOVE PC-TSYMSG-02291        TO DP020-MSG-NUMBER     32170039
321800              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  32180039
321900              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  32190039
322000              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  32200039
322100              MOVE -1                     TO MR-SELECTL (PV-SUB)  32210039
322200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 32220039
322300         END-EVALUATE                                             32230039
322400     END-IF.                                                      32240039
322500                                                                  32250039
322600                                                                  32260039
322700     IF  PS-NO-ERROR                                              32270039
322800         EVALUATE TRUE                                            32280039
322900         WHEN ASC-LINE-STATUS-DISTRIBTD (ASC-BLK-SUB ASC-ITEM-SUB)32290039
323000              SET  ASC-CONFIRM-UNCONF-DIST-ITEM                   32300039
323100                   PS-ERROR                                       32310039
323200                   DP020-MSG-WARNING                              32320039
323300                   PS-CONFIRM-PROCESSING  TO TRUE                 32330039
323400                   MOVE PC-TSYMSG-02261   TO DP020-MSG-NUMBER     32340039
323500                   MOVE -1                TO MR-SELECTL (1)       32350039
323600              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 32360039
323700                                                                  32370039
323800         WHEN OTHER                                               32380039
323900              IF  PS-NO-ERROR                                     32390039
324000                  MOVE  ASC-NBR-STORES (ASC-BLK-SUB ASC-ITEM-SUB) 32400039
324100                    TO  PV-NUMBER-OF-STORES                       32410039
324200                  IF  PV-NUMBER-OF-STORES  >  0                   32420039
324300                      CONTINUE                                    32430039
324400                  ELSE                                            32440039
324500                      SET PS-ERROR                                32450039
324600                          DP020-MSG-FATAL TO  TRUE                32460039
324700                      MOVE PC-TSYMSG-02288                        32470039
324800                                          TO DP020-MSG-NUMBER     32480039
324900                      MOVE DP015-UNP-ALP-BRT-OFF                  32490039
325000                                          TO MR-SELECTA (PV-SUB)  32500039
325100                      MOVE DP015-RED      TO MR-SELECTC (PV-SUB)  32510039
325200                      MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)   32520039
325300                      MOVE -1            TO MR-SELECTL (PV-SUB)   32530039
325400                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         32540039
325500                  END-IF                                          32550039
325600              END-IF                                              32560039
325700                                                                  32570039
325800              IF  PS-NO-ERROR                                     32580039
325900                  SET  ASC-CONFIRM-CONF-DIST-ITEM                 32590039
326000                       PS-ERROR                                   32600039
326100                       DP020-MSG-WARNING                          32610039
326200                       PS-CONFIRM-PROCESSING  TO TRUE             32620039
326300                  MOVE PC-TSYMSG-02260        TO DP020-MSG-NUMBER 32630039
326400                  MOVE -1                     TO MR-SELECTL (1)   32640039
326500                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             32650039
326600              END-IF                                              32660039
326700                                                                  32670039
326800         END-EVALUATE                                             32680039
326900     END-IF.                                                      32690039
327000                                                                  32700039
327100                                                                  32710039
327200*----------------------------------------------------------------*32720039
327300* VALIDATE CONFIRM/UNCONFIRM FOR RDM                             *32730039
327400*----------------------------------------------------------------*32740039
327500 3635-CHECK-FOR-RDM.                                              32750039
327600                                                                  32760039
327700      MOVE ASC-PULL-NBR-N TO DK-RDM-PULL-NUMBER.                  32770039
327800                                                                  32780039
327900      EXEC SQL                                                    32790039
328000        SELECT  1                                                 32800039
328100          INTO  :DK-DUMMY-FIELD                                   32810039
328200           FROM  TCEPLRQ A, TCEPLST B,                            32820039
328300                 TKRPRPM C                                        32830039
328400           WHERE     A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR      32840039
328500                 AND B.CNSTK_REQ_PL_NBR = :DK-RDM-PULL-NUMBER     32850039
328600                 AND A.CNSTK_LOC_ID = C.LOC_ID                    32860039
328700                 AND B.PL_LNE_NBR = 0                             32870039
328800                 AND B.STAT_CDE = 'NW'                            32880039
328900                 AND C.INTFC_SYS_CDE = 'RDM'                      32890039
329000                 AND C.SYS_PRC_FUNC_CDE = 'RDMCSL'                32900039
329100                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   32910039
329200                 AND DATE(FUNC_BEG_TMST) < DATE(CRE_TMST)         32920039
329300      END-EXEC.                                                   32930039
329400                                                                  32940039
329500      EVALUATE TRUE                                               32950039
329600          WHEN SQLCODE = 0                                        32960039
329700              SET PS-ERROR                                        32970039
329800                  DP020-MSG-FATAL TO  TRUE                        32980039
329900              MOVE PC-TSYMSG-02495        TO DP020-MSG-NUMBER     32990039
330000              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  33000039
330100              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  33010039
330200              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  33020039
330300              MOVE -1                     TO MR-SELECTL (PV-SUB)  33030039
330400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 33040039
330500      END-EVALUATE.                                               33050039
330600                                                                  33060039
330700                                                                  33070039
330800*----------------------------------------------------------------*33080039
330900* PRINT LINE EDITS                                               *33090039
331000*----------------------------------------------------------------*33100039
331100 3640-PRINT-LINE-EDITS.                                           33110039
331200                                                                  33120039
331300     EVALUATE TRUE                                                33130039
331400         WHEN ASC-NBR-STORES (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  33140039
331500              CONTINUE                                            33150039
331600                                                                  33160039
331700         WHEN OTHER                                               33170039
331800              SET PS-ERROR                                        33180039
331900                  DP020-MSG-FATAL TO  TRUE                        33190039
332000              MOVE PC-TSYMSG-02297        TO DP020-MSG-NUMBER     33200039
332100              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  33210039
332200              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  33220039
332300              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  33230039
332400              MOVE -1                     TO MR-SELECTL (PV-SUB)  33240039
332500              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 33250039
332600                                                                  33260039
332700     END-EVALUATE.                                                33270039
332800                                                                  33280039
332900                                                                  33290039
333000*----------------------------------------------------------------*33300039
333100* POST/UNPOST DISTRIBUTION EDITS                                 *33310039
333200*----------------------------------------------------------------*33320039
333300 3650-UN-POST-LINE-EDITS.                                         33330039
333400                                                                  33340039
333500     PERFORM 3655-CHECK-FOR-RDM.                                  33350039
333600                                                                  33360039
333700     IF  PS-NO-ERROR                                              33370039
333800         EVALUATE TRUE                                            33380039
333900         WHEN ASC-LINE-STATUS-INPROCESS(ASC-BLK-SUB ASC-ITEM-SUB) 33390039
334000              PERFORM 3660-CHECK-BATCH-ID                         33400039
334100         END-EVALUATE                                             33410039
334200     END-IF.                                                      33420039
334300                                                                  33430039
334400     IF  PS-NO-ERROR                                              33440039
334500         EVALUATE TRUE                                            33450039
334600         WHEN ASC-LINE-STATUS-NEW (ASC-BLK-SUB ASC-ITEM-SUB)      33460039
334700              SET PS-ERROR                                        33470039
334800                  DP020-MSG-FATAL TO  TRUE                        33480039
334900              MOVE PC-TSYMSG-02564        TO DP020-MSG-NUMBER     33490039
335000              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  33500039
335100              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  33510039
335200              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  33520039
335300              MOVE -1                     TO MR-SELECTL (PV-SUB)  33530039
335400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 33540039
335500                                                                  33550039
335600         WHEN ASC-LINE-STATUS-DISTRIBTD(ASC-BLK-SUB ASC-ITEM-SUB) 33560039
335700              SET PS-ERROR                                        33570039
335800                  DP020-MSG-FATAL TO  TRUE                        33580039
335900              MOVE PC-TSYMSG-02566        TO DP020-MSG-NUMBER     33590039
336000              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  33600039
336100              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  33610039
336200              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  33620039
336300              MOVE -1                     TO MR-SELECTL (PV-SUB)  33630039
336400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 33640039
336500                                                                  33650039
336600         WHEN ASC-LINE-STATUS-CANCELLED (ASC-BLK-SUB ASC-ITEM-SUB)33660039
336700              SET PS-ERROR                                        33670039
336800                  DP020-MSG-FATAL TO  TRUE                        33680039
336900              MOVE PC-TSYMSG-02565        TO DP020-MSG-NUMBER     33690039
337000              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  33700039
337100              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  33710039
337200              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  33720039
337300              MOVE -1                     TO MR-SELECTL (PV-SUB)  33730039
337400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 33740039
337500         END-EVALUATE                                             33750039
337600     END-IF.                                                      33760039
337700                                                                  33770039
337800     IF  PS-NO-ERROR                                              33780039
337900         EVALUATE TRUE                                            33790039
338000         WHEN ASC-LINE-STATUS-POSTED (ASC-BLK-SUB ASC-ITEM-SUB)   33800039
338100              PERFORM 3670-CHECK-STATUS-USER                      33810039
338200         END-EVALUATE                                             33820039
338300     END-IF.                                                      33830039
338400                                                                  33840039
338500     IF  PS-NO-ERROR                                              33850039
338600         EVALUATE TRUE                                            33860039
338700         WHEN ASC-LINE-STATUS-POSTED (ASC-BLK-SUB ASC-ITEM-SUB)   33870039
338800              SET  ASC-CONFIRM-UNPOST-DIST                        33880039
338900                   PS-ERROR                                       33890039
339000                   DP020-MSG-WARNING                              33900039
339100                   PS-CONFIRM-PROCESSING  TO TRUE                 33910039
339200                   MOVE PC-TSYMSG-02559   TO DP020-MSG-NUMBER     33920039
339300                   MOVE -1                TO MR-SELECTL (1)       33930039
339400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 33940039
339500                                                                  33950039
339600         WHEN OTHER                                               33960039
339700              SET  ASC-CONFIRM-POST-DIST                          33970039
339800                   PS-ERROR                                       33980039
339900                   DP020-MSG-WARNING                              33990039
340000                   PS-CONFIRM-PROCESSING  TO TRUE                 34000039
340100              MOVE PC-TSYMSG-02258        TO DP020-MSG-NUMBER     34010039
340200              MOVE -1                     TO MR-SELECTL (1)       34020039
340300              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 34030039
340400                                                                  34040039
340500         END-EVALUATE                                             34050039
340600     END-IF.                                                      34060039
340700                                                                  34070039
340800                                                                  34080039
340900*----------------------------------------------------------------*34090039
341000* VALIDATE POST/UNPOST - DISTRIBUTED UNITS MAINTAINED BY RDM     *34100039
341100*----------------------------------------------------------------*34110039
341200 3655-CHECK-FOR-RDM.                                              34120039
341300                                                                  34130039
341400      MOVE ASC-PULL-NBR-N TO DK-RDM-PULL-NUMBER.                  34140039
341500                                                                  34150039
341600      EXEC SQL                                                    34160039
341700        SELECT  1                                                 34170039
341800          INTO  :DK-DUMMY-FIELD                                   34180039
341900           FROM  TCEPLRQ A, TCEPLST B,                            34190039
342000                 TKRPRPM C                                        34200039
342100           WHERE     A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR      34210039
342200                 AND B.CNSTK_REQ_PL_NBR = :DK-RDM-PULL-NUMBER     34220039
342300                 AND A.CNSTK_LOC_ID = C.LOC_ID                    34230039
342400                 AND B.PL_LNE_NBR = 0                             34240039
342500                 AND B.STAT_CDE = 'NW'                            34250039
342600                 AND C.INTFC_SYS_CDE = 'RDM'                      34260039
342700                 AND C.SYS_PRC_FUNC_CDE = 'RDMCSL'                34270039
342800                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   34280039
342900                 AND DATE(FUNC_BEG_TMST) < DATE(CRE_TMST)         34290039
343000      END-EXEC.                                                   34300039
343100                                                                  34310039
343200      EVALUATE TRUE                                               34320039
343300          WHEN SQLCODE = +100                                     34330039
343400              SET PS-ERROR                                        34340039
343500                  DP020-MSG-FATAL TO  TRUE                        34350039
343600              MOVE PC-TSYMSG-02567        TO DP020-MSG-NUMBER     34360039
343700              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  34370039
343800              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  34380039
343900              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  34390039
344000              MOVE -1                     TO MR-SELECTL (PV-SUB)  34400039
344100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 34410039
344200      END-EVALUATE.                                               34420039
344300                                                                  34430039
344400                                                                  34440039
344500*----------------------------------------------------------------*34450039
344600* VALIDATE POST - ENSURE BATCH ID PRESENT                        *34460039
344700*----------------------------------------------------------------*34470039
344800 3660-CHECK-BATCH-ID.                                             34480039
344900                                                                  34490039
345000      MOVE  ASC-PULL-NBR-N TO DK-RDM-PULL-NUMBER.                 34500039
345100      MOVE  ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)            34510039
345200        TO  DK-RDM-LINE-NUMBER.                                   34520039
345300                                                                  34530039
345400      EXEC SQL                                                    34540039
345500        SELECT  EXPRT_PRC_BTCH_ID                                 34550039
345600          INTO  :CEPLMF-EXPRT-PRC-BTCH-ID                         34560039
345700          FROM  TCEPLMF                                           34570039
345800         WHERE  CNSTK_REQ_PL_NBR = :DK-RDM-PULL-NUMBER            34580039
345900           AND  PL_LNE_NBR       = :DK-RDM-LINE-NUMBER            34590039
346000      END-EXEC.                                                   34600039
346100                                                                  34610039
346200      EVALUATE TRUE                                               34620039
346300          WHEN SQLCODE = 0                                        34630039
346400          WHEN SQLCODE = +100                                     34640039
346500               CONTINUE                                           34650039
346600      END-EVALUATE.                                               34660039
346700                                                                  34670039
346800      EXEC SQL                                                    34680039
346900        SELECT  EXPRT_PRC_BTCH_ID                                 34690039
347000          INTO  :CEPLAU-EXPRT-PRC-BTCH-ID                         34700039
347100          FROM  TCEPLAU                                           34710039
347200         WHERE  CNSTK_REQ_PL_NBR = :DK-RDM-PULL-NUMBER            34720039
347300           AND  PL_LNE_NBR       = :DK-RDM-LINE-NUMBER            34730039
347400      END-EXEC.                                                   34740039
347500                                                                  34750039
347600      EVALUATE TRUE                                               34760039
347700          WHEN SQLCODE = 0                                        34770039
347800          WHEN SQLCODE = +100                                     34780039
347900               CONTINUE                                           34790039
348000      END-EVALUATE.                                               34800039
348100                                                                  34810039
348200     IF  CEPLMF-EXPRT-PRC-BTCH-ID  >  SPACES  OR                  34820039
348300         CEPLAU-EXPRT-PRC-BTCH-ID  >  SPACES                      34830039
348400         CONTINUE                                                 34840039
348500     ELSE                                                         34850039
348600         SET PS-ERROR                                             34860039
348700             DP020-MSG-FATAL TO  TRUE                             34870039
348800         MOVE PC-TSYMSG-02557        TO DP020-MSG-NUMBER          34880039
348900         MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)       34890039
349000         MOVE DP015-RED              TO MR-SELECTC (PV-SUB)       34900039
349100         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       34910039
349200         MOVE -1                     TO MR-SELECTL (PV-SUB)       34920039
349300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34930039
349400     END-IF.                                                      34940039
349500                                                                  34950039
349600                                                                  34960039
349700*----------------------------------------------------------------*34970039
349800* CHECK TO SEE IF POSTED STATUS WAS FROM RDM AUTO PROCESS        *34980039
349900* IF FROM RDM DO NOT ALLOW UNPOST                                *34990039
350000*----------------------------------------------------------------*35000039
350100 3670-CHECK-STATUS-USER.                                          35010039
350200                                                                  35020039
350300     MOVE  ASC-PULL-NBR-N       TO DK-PULL-NUMBER.                35030039
350400     MOVE  ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             35040039
350500                                TO  DK-LINE-NUMBER.               35050039
350600     MOVE  ASC-LINE-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         35060039
350700                                TO  DK-LINE-STATUS.               35070039
350800                                                                  35080039
350900     PERFORM 3675-OPEN-STATUS-CSR.                                35090039
351000                                                                  35100039
351100     IF  PS-NO-ERROR                                              35110039
351200         PERFORM 3680-FETCH-STATUS-CSR                            35120039
351300     END-IF.                                                      35130039
351400                                                                  35140039
351500     IF  PS-NO-ERROR                                              35150039
351600         PERFORM 3685-CLOSE-STATUS-CSR                            35160039
351700     END-IF.                                                      35170039
351800                                                                  35180039
351900     IF  CEPLST-CRE-BY-USR-ID  =  PC-RDM-AUTO-PROCESS             35190039
352000         SET PS-ERROR                                             35200039
352100             DP020-MSG-FATAL TO  TRUE                             35210039
352200         MOVE PC-TSYMSG-02570        TO DP020-MSG-NUMBER          35220039
352300         MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)       35230039
352400         MOVE DP015-RED              TO MR-SELECTC (PV-SUB)       35240039
352500         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       35250039
352600         MOVE -1                     TO MR-SELECTL (PV-SUB)       35260039
352700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      35270039
352800     END-IF.                                                      35280039
352900                                                                  35290039
353000                                                                  35300039
353100 3675-OPEN-STATUS-CSR.                                            35310039
353200                                                                  35320039
353300     EXEC SQL                                                     35330039
353400          OPEN STATUS-USER-CSR                                    35340039
353500     END-EXEC.                                                    35350039
353600                                                                  35360039
353700     EVALUATE TRUE                                                35370039
353800         WHEN SQLCODE = ZERO                                      35380039
353900             CONTINUE                                             35390039
354000         WHEN SQLWARN0 NOT = SPACES                               35400039
354100         WHEN SQLCODE < ZERO                                      35410039
354200         WHEN SQLCODE > ZERO                                      35420039
354300             MOVE '3675-OPEN-STATUS-CSR'                          35430039
354400                               TO DP013-PARAGRAPH                 35440039
354500             MOVE 'OPEN STATUS USER CURSOR      '                 35450039
354600                               TO DP013-MESSAGE-TEXT (1)          35460039
354700             MOVE SQLCA        TO DP013-SQLCA                     35470039
354800             MOVE 'TCEPLST '   TO DP013-DB2-TABLE-NAME (1)        35480039
354900             SET DP013-DB2-ABEND                                  35490039
355000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35500039
355100             PERFORM DP013-0000-PROCESS-ABEND                     35510039
355200     END-EVALUATE.                                                35520039
355300                                                                  35530039
355400                                                                  35540039
355500 3680-FETCH-STATUS-CSR.                                           35550039
355600                                                                  35560039
355700     EXEC SQL                                                     35570039
355800          FETCH STATUS-USER-CSR                                   35580039
355900           INTO  :CEPLST-CNSTK-REQ-PL-NBR                         35590039
356000               , :CEPLST-PL-LNE-NBR                               35600039
356100               , :CEPLST-CRE-TMST                                 35610039
356200               , :CEPLST-STAT-CDE                                 35620039
356300               , :CEPLST-CRE-BY-USR-ID                            35630039
356400     END-EXEC.                                                    35640039
356500                                                                  35650039
356600     EVALUATE TRUE                                                35660039
356700         WHEN SQLCODE = ZERO                                      35670039
356800         WHEN SQLCODE = +100                                      35680039
356900              CONTINUE                                            35690039
357000                                                                  35700039
357100         WHEN SQLWARN0 NOT = SPACE                                35710039
357200         WHEN SQLCODE NOT = ZERO                                  35720039
357300              MOVE '3680-FETCH-STATUS-CSR'                        35730039
357400                               TO DP013-PARAGRAPH                 35740039
357500              MOVE 'FETCH STATUS USER CURSOR'                     35750039
357600                               TO DP013-MESSAGE-TEXT (1)          35760039
357700              MOVE SQLCA       TO DP013-SQLCA                     35770039
357800              MOVE 'TCEPLST '  TO DP013-DB2-TABLE-NAME (1)        35780039
357900              SET DP013-DB2-ABEND                                 35790039
358000                               TO TRUE                            35800039
358100              PERFORM DP013-0000-PROCESS-ABEND                    35810039
358200     END-EVALUATE.                                                35820039
358300                                                                  35830039
358400                                                                  35840039
358500 3685-CLOSE-STATUS-CSR.                                           35850039
358600                                                                  35860039
358700     EXEC SQL                                                     35870039
358800          CLOSE STATUS-USER-CSR                                   35880039
358900     END-EXEC.                                                    35890039
359000                                                                  35900039
359100     EVALUATE TRUE                                                35910039
359200         WHEN SQLCODE = ZERO                                      35920039
359300             CONTINUE                                             35930039
359400         WHEN SQLWARN0 NOT = SPACES                               35940039
359500         WHEN SQLCODE < ZERO                                      35950039
359600         WHEN SQLCODE > ZERO                                      35960039
359700             MOVE '3685-CLOSE-STATUS-CSR'                         35970039
359800                               TO DP013-PARAGRAPH                 35980039
359900             MOVE 'CLOSE STATUS USER CURSOR    '                  35990039
360000                               TO DP013-MESSAGE-TEXT (1)          36000039
360100             MOVE SQLCA        TO DP013-SQLCA                     36010039
360200             MOVE 'TCEPLST '   TO DP013-DB2-TABLE-NAME (1)        36020039
360300             SET DP013-DB2-ABEND                                  36030039
360400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36040039
360500             PERFORM DP013-0000-PROCESS-ABEND                     36050039
360600     END-EVALUATE.                                                36060039
360700                                                                  36070039
360800                                                                  36080039
360900*----------------------------------------------------------------*36090039
361000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *36100039
361100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *36110039
361200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *36120039
361300*    DISPLAY THE PANEL TO USER.                                  *36130039
361400*----------------------------------------------------------------*36140039
361500                                                                  36150039
361600 4000-BUILD-INITIAL-PANEL.                                        36160039
361700                                                                  36170039
361800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            36180039
361900                                 ASC-BLOCK-ENTRIES (2).           36190039
362000     MOVE +1                 TO ASC-BLK-SUB.                      36200039
362100     SET ASC-ITEMS-LEFT-ON-DB                                     36210039
362200                             TO TRUE.                             36220039
362300                                                                  36230039
362400     MOVE +0                 TO ASC-ITEM-SUB                      36240039
362500                                ASC-NUMBER-OF-ITEMS-READ          36250039
362600                                ASC-NUMBER-OF-SELECTED-ITEMS      36260039
362700                                ASC-HIGHEST-BLOCK-WRITTEN         36270039
362800                                ASC-START-OF-SELECTED-RANGE       36280039
362900                                ASC-END-OF-SELECTED-RANGE         36290039
363000                                ASC-ITEM-AT-TOP-OF-PANEL.         36300039
363100                                                                  36310039
363200     PERFORM 4100-PREPARE-CURSOR                                  36320039
363300                                                                  36330039
363400     PERFORM 4010-OPEN-CURSOR.                                    36340039
363500                                                                  36350039
363600     PERFORM 4300-READ-ITEMS-FROM-DB.                             36360039
363700                                                                  36370039
363800     PERFORM 4020-CLOSE-CURSOR.                                   36380039
363900                                                                  36390039
364000     MOVE +1                   TO  PV-TOP-ITEM.                   36400039
364100     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          36410039
364200         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    36420039
364300         SET DP020-MSG-FATAL   TO  TRUE                           36430039
364400         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               36440039
364500     ELSE                                                         36450039
364600         MOVE -1               TO MR-SELECTL (1)                  36460039
364700         SET DP030-SET-CURSOR-APPL-1                              36470039
364800                               TO TRUE                            36480039
364900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     36490039
365000     END-IF.                                                      36500039
365100 EJECT                                                            36510039
365200*----------------------------------------------------------------*36520039
365300* OPEN THE TMESSAGE CURSOR.                                      *36530039
365400*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *36540039
365500*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *36550039
365600*   USER.                                                        *36560039
365700*----------------------------------------------------------------*36570039
365800                                                                  36580039
365900 4010-OPEN-CURSOR.                                                36590039
366000     PERFORM                                                      36600039
366100         WITH TEST AFTER                                          36610039
366200         VARYING PV-RETRY-COUNTER                                 36620039
366300         FROM 1 BY 1                                              36630039
366400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36640039
366500                   OR (SQLCODE = ZERO))                           36650039
366600                                                                  36660039
366700         MOVE 'CURSOR:  LINE-ITEM-CSR'                            36670039
366800                              TO DP013-MESSAGE-TEXT (2)           36680039
366900         EXEC SQL                                                 36690039
367000              OPEN LINE-ITEM-CSR                                  36700039
367100         END-EXEC                                                 36710039
367200                                                                  36720039
367300                                                                  36730039
367400         EVALUATE TRUE                                            36740039
367500             WHEN SQLCODE = ZERO                                  36750039
367600             WHEN SQLCODE = -904                                  36760039
367700             WHEN SQLCODE = -913                                  36770039
367800                 CONTINUE                                         36780039
367900             WHEN SQLWARN0 NOT = SPACES                           36790039
368000             WHEN SQLCODE < ZERO                                  36800039
368100             WHEN SQLCODE > ZERO                                  36810039
368200                 MOVE '4010-OPEN-CURSOR'                          36820039
368300                                   TO DP013-PARAGRAPH             36830039
368400                 MOVE 'OPEN SYSTEM MESSAGE CURSOR - '             36840039
368500                                   TO DP013-MESSAGE-TEXT (1)      36850039
368600                 MOVE SQLCA        TO DP013-SQLCA                 36860039
368700                 MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)    36870039
368800                 SET DP013-DB2-ABEND                              36880039
368900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36890039
369000                 PERFORM DP013-0000-PROCESS-ABEND                 36900039
369100         END-EVALUATE                                             36910039
369200     END-PERFORM                                                  36920039
369300*                                                                 36930039
369400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36940039
369500         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             36950039
369600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   36960039
369700                                   TO DP013-MESSAGE-TEXT (1)      36970039
369800         MOVE SQLCA                TO DP013-SQLCA                 36980039
369900         MOVE 'TSYMSG  '           TO DP013-DB2-TABLE-NAME (1)    36990039
370000         SET DP013-DB2-ABEND                                      37000039
370100             DP013-XCTL-DISPLAY-RESTART                           37010039
370200                                   TO TRUE                        37020039
370300         PERFORM DP013-0000-PROCESS-ABEND                         37030039
370400     END-IF.                                                      37040039
370500                                                                  37050039
370600 EJECT                                                            37060039
370700*----------------------------------------------------------------*37070039
370800* CLOSE THE TMESSAGE CURSOR.                                     *37080039
370900*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *37090039
371000*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *37100039
371100*   USER.                                                        *37110039
371200*----------------------------------------------------------------*37120039
371300                                                                  37130039
371400 4020-CLOSE-CURSOR.                                               37140039
371500                                                                  37150039
371600     EXEC SQL                                                     37160039
371700          CLOSE LINE-ITEM-CSR                                     37170039
371800     END-EXEC.                                                    37180039
371900                                                                  37190039
372000*                                                                 37200039
372100     EVALUATE TRUE                                                37210039
372200         WHEN SQLCODE = ZERO                                      37220039
372300             CONTINUE                                             37230039
372400         WHEN SQLWARN0 NOT = SPACES                               37240039
372500         WHEN SQLCODE < ZERO                                      37250039
372600         WHEN SQLCODE > ZERO                                      37260039
372700             MOVE '4020-CLOSE-CURSOR'                             37270039
372800                               TO DP013-PARAGRAPH                 37280039
372900             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  37290039
373000                               TO DP013-MESSAGE-TEXT (1)          37300039
373100             MOVE SQLCA        TO DP013-SQLCA                     37310039
373200             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        37320039
373300             SET DP013-DB2-ABEND                                  37330039
373400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37340039
373500             PERFORM DP013-0000-PROCESS-ABEND                     37350039
373600     END-EVALUATE.                                                37360039
373700                                                                  37370039
373800 EJECT                                                            37380039
373900*----------------------------------------------------------------*37390039
374000*    SET UP THE HOST VARIABLES.                                  *37400039
374100*----------------------------------------------------------------*37410039
374200                                                                  37420039
374300 4100-PREPARE-CURSOR.                                             37430039
374400                                                                  37440039
374500     MOVE ASC-PULL-NBR         TO DK-PULL-NUMBER.                 37450039
374600     MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  37460039
374700                                                                  37470039
374800                                                                  37480039
374900*----------------------------------------------------------------*37490039
375000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *37500039
375100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *37510039
375200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *37520039
375300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *37530039
375400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *37540039
375500*                                                                *37550039
375600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *37560039
375700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *37570039
375800*    UPON INITIALIZATION.                                        *37580039
375900*----------------------------------------------------------------*37590039
376000 4300-READ-ITEMS-FROM-DB.                                         37600039
376100                                                                  37610039
376200     PERFORM                                                      37620039
376300         VARYING PV-READ-COUNT                                    37630039
376400         FROM 1 BY 1                                              37640039
376500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    37650039
376600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         37660039
376700                                                                  37670039
376800         PERFORM 4310-FETCH                                       37680039
376900                                                                  37690039
377000         IF  ASC-ITEMS-LEFT-ON-DB                                 37700039
377100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                37710039
377200                 ADD +1            TO ASC-ITEM-SUB                37720039
377300             ELSE                                                 37730039
377400                 ADD +1            TO ASC-BLK-SUB                 37740039
377500                 MOVE +1           TO ASC-ITEM-SUB                37750039
377600                                                                  37760039
377700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         37770039
377800                     MOVE +1       TO ASC-BLK-SUB                 37780039
377900                     SET ASC-BLOCK-MODIFIED (1)                   37790039
378000                                   TO TRUE                        37800039
378100                     PERFORM 5100-WRITE-TEMP-STORAGE              37810039
378200                     MOVE ASC-BLOCK-ENTRIES                       37820039
378300                               (PC-MAX-BLOCKS-IN-ARRAY)           37830039
378400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 37840039
378500                     ADD +1        TO ASC-BLK-SUB                 37850039
378600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   37860039
378700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      37870039
378800                                   TO TRUE                        37880039
378900                 END-IF                                           37890039
379000             END-IF                                               37900039
379100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    37910039
379200             MOVE ASC-NUMBER-OF-ITEMS-READ                        37920039
379300                                   TO ASC-LIST-ITEM-NUMBER        37930039
379400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37940039
379500                                                                  37950039
379600             PERFORM 4320-GET-LINE-ITEM                           37960039
379700             PERFORM 4340-GET-ITEM-DISTRO                         37970039
379800             PERFORM 4350-GET-SKU-INFO                            37980039
379900             PERFORM 4360-GET-PULL-MANIFEST                       37990039
380000             PERFORM 4370-GET-PULL-ADJUST                         38000039
380100                                                                  38010039
380200             MOVE ZEROES      TO  ASC-UPD-UNITS                   38020039
380300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38030039
380400             MOVE DK-LINE-NUMBER                                  38040039
380500                              TO  ASC-LINE-NUMBER                 38050039
380600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38060039
380700             MOVE PV-CEPLDS-STORE-COUNT                           38070039
380800                              TO  ASC-NBR-STORES                  38080039
380900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38090039
381000             MOVE PV-CEPLIT-REQ-QTY                               38100039
381100                              TO  ASC-REQ-PULL-UNITS              38110039
381200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38120039
381300             MOVE PV-CEPLIT-ACTL-QTY                              38130039
381400                              TO  ASC-ACT-PULL-UNITS              38140039
381500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38150039
381600             COMPUTE PV-COMPUTE-DISTRB-QTY =                      38160039
381700                     (PV-CEPLDS-DISTRB-QTY +                      38170039
381800                      PV-CEPLMF-MANIF-QTY  +                      38180039
381900                      PV-CEPLAU-ADJUST-QTY)                       38190039
382000             MOVE  PV-COMPUTE-DISTRB-QTY                          38200039
382100                              TO  ASC-DISTRBUTED-UNITS            38210039
382200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38220039
382300                                  ASC-DISTRB-UNTS-NUM             38230039
382400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38240039
382500             MOVE  PV-PULL-STATUS                                 38250039
382600                               TO ASC-LINE-STATUS-CDE             38260039
382700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38270039
382800*-- MOVE THE NEW VALUES FROM XLV_SKU IN PLACE     WR/IR# 230ZZ --*38280039
382900*-- OF THE VALUES FROM TSK.                       WR/IR# 230ZZ --*38290039
383000             MOVE  PV-SKU-NUMBER                                  38300039
383100                              TO  ASC-SKU-NUMBER                  38310039
383200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38320039
383300             MOVE  PV-SKU-DESCRIPTION                             38330039
383400                              TO  ASC-SKU-DESCRIPTION             38340039
383500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38350039
383600*-- END OF CHANGES -----------------------------  WR/IR# 230ZZ --*38360039
383700             MOVE  CEPLIT-ITM-NBR                                 38370039
383800                              TO  ASC-LINE-ITEM                   38380039
383900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38390039
384000             MOVE  CEPLIT-UNT-RTL-AMT                             38400039
384100                              TO  ASC-LINE-SKU-RETAIL             38410039
384200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38420039
384300                                                                  38430039
384400             PERFORM 4380-GET-ADJUSTMENT-COUNT                    38440039
384500             PERFORM 4385-GET-TOT-MANIFEST                        38450039
384600             PERFORM 4390-GET-TOT-ADJUST                          38460039
384700             PERFORM 4395-GET-TOT-DISTRB                          38470039
384800                                                                  38480039
384900             IF  PV-ADJUSTMENT-QTY  >  0                          38490039
385000                 MOVE 'YES'                                       38500039
385100                   TO  ASC-ADJUSTMENT-SW                          38510039
385200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38520039
385300             ELSE                                                 38530039
385400                 MOVE  SPACES                                     38540039
385500                   TO  ASC-ADJUSTMENT-SW                          38550039
385600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38560039
385700             END-IF                                               38570039
385800                                                                  38580039
385900             MOVE  PV-TOT-MANIFEST-QTY                            38590039
386000                              TO  ASC-TOT-MNFST-UNITS             38600039
386100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38610039
386200             MOVE  PV-TOT-ADJUSTED-QTY                            38620039
386300                              TO  ASC-TOT-ADJ-UNITS               38630039
386400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38640039
386500             MOVE  PV-TOT-DISTRB-QTY                              38650039
386600                              TO  ASC-TOT-DSTRB-UNITS             38660039
386700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38670039
386800***          MOVE  PV-TOT-                                        38680039
386900***                           TO  ASC-TOT-DSTRB-RETAIL            38690039
387000***                                    (ASC-BLK-SUB ASC-ITEM-SUB) 38700039
387100                                                                  38710039
387200             EVALUATE  TRUE                                       38720039
387300                 WHEN  PV-PULL-STATUS-NEW                         38730039
387400                           MOVE  PC-NEW-DESC                      38740039
387500                               TO ASC-LINE-STATUS-DESC            38750039
387600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38760039
387700                 WHEN  PV-PULL-STATUS-CANCELLED                   38770039
387800                           MOVE  PC-PULL-STATUS-CANCELLED         38780039
387900                               TO ASC-LINE-STATUS-DESC            38790039
388000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38800039
388100                 WHEN  PV-PULL-STATUS-INPROCESS                   38810039
388200                           MOVE  PC-IN-PROCESS-DESC               38820039
388300                               TO ASC-LINE-STATUS-DESC            38830039
388400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38840039
388500                 WHEN  PV-PULL-STATUS-DISTRIBTD                   38850039
388600                           MOVE  PC-DISTRIB-DESC                  38860039
388700                               TO ASC-LINE-STATUS-DESC            38870039
388800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38880039
388900                 WHEN  PV-PULL-STATUS-POSTED                      38890039
389000                           MOVE  PC-POSTED-DESC                   38900039
389100                               TO ASC-LINE-STATUS-DESC            38910039
389200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38920039
389300             END-EVALUATE                                         38930039
389400* DMH 12/15/00 - BEGIN                                            38940039
389500             EVALUATE  TRUE                                       38950039
389600                 WHEN  PV-PULL-STATUS-NEW                         38960039
389700                 WHEN  PV-PULL-STATUS-INPROCESS                   38970039
389800                       PERFORM 4365-GET-TCEPLMF                   38980039
389900                       IF  PV-TCEPLMF-COUNT  >  0                 38990039
390000                           MOVE 'Y' TO ASC-IN-TCEPLMF             39000039
390100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 39010039
390200                       ELSE                                       39020039
390300                           MOVE 'N' TO ASC-IN-TCEPLMF             39030039
390400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 39040039
390500                       END-IF                                     39050039
390600                 WHEN OTHER                                       39060039
390700                           MOVE 'N' TO ASC-IN-TCEPLMF             39070039
390800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 39080039
390900             END-EVALUATE                                         39090039
391000* DMH 12/15/00 - END                                              39100039
391100                                                                  39110039
391200         END-IF                                                   39120039
391300     END-PERFORM.                                                 39130039
391400                                                                  39140039
391500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          39150039
391600         MOVE +1               TO ASC-BLK-SUB                     39160039
391700         PERFORM 5100-WRITE-TEMP-STORAGE                          39170039
391800         ADD +1                TO ASC-BLK-SUB                     39180039
391900         PERFORM 5100-WRITE-TEMP-STORAGE                          39190039
392000                                                                  39200039
392100         MOVE 1                TO ASC-BLK-SUB                     39210039
392200                                  PV-BLOCK-NUMBER                 39220039
392300         PERFORM 4410-READ-TEMP-STORAGE                           39230039
392400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             39240039
392500             MOVE 2            TO ASC-BLK-SUB                     39250039
392600                                  PV-BLOCK-NUMBER                 39260039
392700             PERFORM 4410-READ-TEMP-STORAGE                       39270039
392800         END-IF                                                   39280039
392900     END-IF.                                                      39290039
393000 EJECT                                                            39300039
393100*----------------------------------------------------------------*39310039
393200*    FETCH THE MESSAGE CURSOR.                                   *39320039
393300*----------------------------------------------------------------*39330039
393400                                                                  39340039
393500 4310-FETCH.                                                      39350039
393600                                                                  39360039
393700     EXEC SQL                                                     39370039
393800          FETCH LINE-ITEM-CSR                                     39380039
393900           INTO  :CEPLIT-CNSTK-REQ-PL-NBR                         39390039
394000               , :CEPLIT-PL-LNE-NBR                               39400039
394100               , :CEPLIT-ITM-NBR                                  39410039
394200               , :CEPLIT-PL-REQ-QTY                               39420039
394300               , :CEPLIT-ACTL-PL-QTY :PV-NULL-IND-3               39430039
394400               , :CEPLIT-STAT-CDE                                 39440039
394500               , :CEPLIT-UNT-RTL-AMT                              39450039
394600     END-EXEC.                                                    39460039
394700                                                                  39470039
394800                                                                  39480039
394900     EVALUATE TRUE                                                39490039
395000         WHEN SQLCODE = ZERO                                      39500039
395100              MOVE  CEPLIT-STAT-CDE     TO  PV-PULL-STATUS        39510039
395200              MOVE  CEPLIT-PL-LNE-NBR   TO  DK-LINE-NUMBER        39520039
395300              MOVE  CEPLIT-STAT-CDE     TO  DK-LINE-STATUS        39530039
395400         WHEN SQLCODE = +100                                      39540039
395500              MOVE  SPACES              TO  PV-PULL-STATUS        39550039
395600              MOVE  ZEROES              TO  DK-LINE-NUMBER        39560039
395700              MOVE  SPACES              TO  DK-LINE-STATUS        39570039
395800         WHEN SQLWARN0 NOT = SPACE                                39580039
395900         WHEN SQLCODE NOT = ZERO                                  39590039
396000              MOVE '4310-FETCH-CURSOR'                            39600039
396100                               TO DP013-PARAGRAPH                 39610039
396200              MOVE 'FETCH MESSAGE CURSOR'                         39620039
396300                               TO DP013-MESSAGE-TEXT (1)          39630039
396400              MOVE SQLCA       TO DP013-SQLCA                     39640039
396500              SET DP013-DB2-ABEND                                 39650039
396600                               TO TRUE                            39660039
396700              PERFORM DP013-0000-PROCESS-ABEND                    39670039
396800     END-EVALUATE.                                                39680039
396900                                                                  39690039
397000     IF  SQLCODE EQUAL +100                                       39700039
397100         SET ASC-NO-ITEMS-LEFT-ON-DB                              39710039
397200                                   TO TRUE                        39720039
397300     END-IF.                                                      39730039
397400                                                                  39740039
397500                                                                  39750039
397600*----------------------------------------------------------------*39760039
397700* GET PULL ITEM LINE QTY.                                        *39770039
397800*----------------------------------------------------------------*39780039
397900 4320-GET-LINE-ITEM.                                              39790039
398000                                                                  39800039
398100     INITIALIZE  PV-CEPLIT-ITEM-QTY                               39810039
398200                 PV-CEPLIT-REQ-QTY                                39820039
398300                 PV-CEPLIT-ACTL-QTY.                              39830039
398400                                                                  39840039
398500     EXEC SQL                                                     39850039
398600         SELECT  COUNT(*)                                         39860039
398700                ,SUM(PL_REQ_QTY)                                  39870039
398800                ,SUM(ACTL_PL_QTY)                                 39880039
398900           INTO  :PV-CEPLIT-ITEM-QTY                              39890039
399000                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               39900039
399100                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               39910039
399200           FROM  TCEPLIT                                          39920039
399300          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             39930039
399400            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             39940039
399500            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    39950039
399600     END-EXEC                                                     39960039
399700                                                                  39970039
399800     EVALUATE TRUE                                                39980039
399900         WHEN SQLCODE = +0                                        39990039
400000              CONTINUE                                            40000039
400100         WHEN SQLCODE = -904                                      40010039
400200         WHEN SQLCODE = -911                                      40020039
400300         WHEN SQLCODE = -913                                      40030039
400400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    40040039
400500             MOVE '4320-GET-LINE-ITEM  '    TO PV-SOFT-PARAGRAPH  40050039
400600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  40060039
400700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     40070039
400800               TO PV-COMMAREA-LENGTH                              40080039
400900             EXEC CICS                                            40090039
401000                  WRITEQ TD                                       40100039
401100                   QUEUE  ('CSSL')                                40110039
401200                    FROM  (PV-CICS-MSG-AREA2)                     40120039
401300                  LENGTH  (PV-COMMAREA-LENGTH)                    40130039
401400                    RESP  (PV-CICS-RESP)                          40140039
401500             END-EXEC                                             40150039
401600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          40160039
401700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              40170039
401800             PERFORM 9900-SOFT-ABORT                              40180039
401900         WHEN OTHER                                               40190039
402000              MOVE '4320-GET-LINE-ITEM'                           40200039
402100                               TO DP013-PARAGRAPH                 40210039
402200              MOVE 'GET PULL STATUS ITEM QTYS'                    40220039
402300                               TO DP013-MESSAGE-TEXT (1)          40230039
402400              MOVE SQLCA       TO DP013-SQLCA                     40240039
402500              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        40250039
402600              SET DP013-DB2-ABEND                                 40260039
402700                  DP013-XCTL-DISPLAY-RESTART                      40270039
402800                                   TO TRUE                        40280039
402900                  PERFORM DP013-0000-PROCESS-ABEND                40290039
403000     END-EVALUATE.                                                40300039
403100                                                                  40310039
403200                                                                  40320039
403300*----------------------------------------------------------------*40330039
403400* GET LINE ITEM DISTRIBUTION QTY & STORE COUNT                   *40340039
403500*----------------------------------------------------------------*40350039
403600 4340-GET-ITEM-DISTRO.                                            40360039
403700     INITIALIZE  PV-CEPLDS-DISTRB-QTY                             40370039
403800                 PV-CEPLDS-STORE-COUNT.                           40380039
403900                                                                  40390039
404000     EXEC SQL                                                     40400039
404100          SELECT  SUM(A.ACTL_DISTRB_QTY)                          40410039
404200            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            40420039
404300            FROM  TCEPLDS A                                       40430039
404400           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           40440039
404500             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           40450039
404600             AND  :DK-LINE-STATUS  IN  ('DS','PD')                40460039
404700     END-EXEC                                                     40470039
404800                                                                  40480039
404900                                                                  40490039
405000     EVALUATE TRUE                                                40500039
405100         WHEN SQLCODE = +0                                        40510039
405200              CONTINUE                                            40520039
405300         WHEN SQLCODE = -904                                      40530039
405400         WHEN SQLCODE = -911                                      40540039
405500         WHEN SQLCODE = -913                                      40550039
405600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    40560039
405700             MOVE '4340-GET-ITEM-DISTRO'    TO PV-SOFT-PARAGRAPH  40570039
405800             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  40580039
405900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     40590039
406000               TO PV-COMMAREA-LENGTH                              40600039
406100             EXEC CICS                                            40610039
406200                  WRITEQ TD                                       40620039
406300                   QUEUE  ('CSSL')                                40630039
406400                    FROM  (PV-CICS-MSG-AREA2)                     40640039
406500                  LENGTH  (PV-COMMAREA-LENGTH)                    40650039
406600                    RESP  (PV-CICS-RESP)                          40660039
406700             END-EXEC                                             40670039
406800             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          40680039
406900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              40690039
407000             PERFORM 9900-SOFT-ABORT                              40700039
407100         WHEN OTHER                                               40710039
407200              MOVE '4340-GET-ITEM-DISTRO'                         40720039
407300                               TO DP013-PARAGRAPH                 40730039
407400              MOVE 'GET LINE DISTRIBTION     '                    40740039
407500                               TO DP013-MESSAGE-TEXT (1)          40750039
407600              MOVE SQLCA       TO DP013-SQLCA                     40760039
407700              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        40770039
407800              SET DP013-DB2-ABEND                                 40780039
407900                  DP013-XCTL-DISPLAY-RESTART                      40790039
408000                                   TO TRUE                        40800039
408100                  PERFORM DP013-0000-PROCESS-ABEND                40810039
408200     END-EVALUATE.                                                40820039
408300                                                                  40830039
408400                                                                  40840039
408500     EXEC SQL                                                     40850039
408600          SELECT  COUNT(*)                                        40860039
408700            INTO  :PV-CEPLDS-STORE-COUNT                          40870039
408800            FROM  TCEPLDS A                                       40880039
408900           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           40890039
409000             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           40900039
409100     END-EXEC                                                     40910039
409200                                                                  40920039
409300                                                                  40930039
409400     EVALUATE TRUE                                                40940039
409500         WHEN SQLCODE = +0                                        40950039
409600              CONTINUE                                            40960039
409700         WHEN SQLCODE = -904                                      40970039
409800         WHEN SQLCODE = -911                                      40980039
409900         WHEN SQLCODE = -913                                      40990039
410000             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   41000039
410100             MOVE '4340-GET-ITEM-DISTRO 2ND' TO PV-SOFT-PARAGRAPH 41010039
410200             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 41020039
410300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41030039
410400               TO PV-COMMAREA-LENGTH                              41040039
410500             EXEC CICS                                            41050039
410600                  WRITEQ TD                                       41060039
410700                   QUEUE  ('CSSL')                                41070039
410800                    FROM  (PV-CICS-MSG-AREA2)                     41080039
410900                  LENGTH  (PV-COMMAREA-LENGTH)                    41090039
411000                    RESP  (PV-CICS-RESP)                          41100039
411100             END-EXEC                                             41110039
411200             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          41120039
411300             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              41130039
411400             PERFORM 9900-SOFT-ABORT                              41140039
411500         WHEN OTHER                                               41150039
411600              MOVE '4340-GET-ITEM-DISTRO 2ND'                     41160039
411700                               TO DP013-PARAGRAPH                 41170039
411800              MOVE 'GET LINE DISTRO STORE COUNT'                  41180039
411900                               TO DP013-MESSAGE-TEXT (1)          41190039
412000              MOVE SQLCA       TO DP013-SQLCA                     41200039
412100              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        41210039
412200              SET DP013-DB2-ABEND                                 41220039
412300                  DP013-XCTL-DISPLAY-RESTART                      41230039
412400                                   TO TRUE                        41240039
412500                  PERFORM DP013-0000-PROCESS-ABEND                41250039
412600     END-EVALUATE.                                                41260039
412700                                                                  41270039
412800                                                                  41280039
412900*----------------------------------------------------------------*41290039
413000* GET LINE ITEM SKU & DESCRIPTION                                *41300039
413100*---REPLACED TSK WITH DATA FROM XLV_SKU        WR/IR# 230ZZ------*41310039
413200*----------------------------------------------------------------*41320039
413300 4350-GET-SKU-INFO.                                               41330039
413400                                                                  41340039
413500     INITIALIZE  PV-SKU-NUMBER                                    41350039
413600                 PV-SKU-DESCRIPTION                               41360039
413700                 DCLXLV00000.                                     41370039
413800                                                                  41380039
413900     EXEC SQL                                                     41390039
414000          SELECT   SKU_NBR                                        41400039
414100                  ,SKU_DESC                                       41410039
414200            INTO   :XLV00000-SKU-NBR                              41420039
414300                  ,:XLV00000-SKU-DESC                             41430039
414400            FROM  XLV_SKU                                         41440039
414500           WHERE  ITM_NBR          =  :CEPLIT-ITM-NBR             41450039
414600     END-EXEC                                                     41460039
414700                                                                  41470039
414800                                                                  41480039
414900     EVALUATE TRUE                                                41490039
415000         WHEN SQLCODE = 0                                         41500039
415100              MOVE  XLV00000-SKU-NBR   TO  PV-SKU-NUMBER          41510039
415110              PERFORM 4540-INSPECT-XLV00000-SKU-DESC              41511057
415200              MOVE  XLV00000-SKU-DESC  TO  PV-SKU-DESCRIPTION     41520039
415300         WHEN SQLCODE = +100                                      41530039
415400              MOVE  SPACES               TO  PV-SKU-NUMBER        41540039
415500              MOVE  PC-UNKNOWN-SKU-DESC  TO  PV-SKU-DESCRIPTION   41550039
415600         WHEN SQLCODE = -904                                      41560039
415700         WHEN SQLCODE = -911                                      41570039
415800         WHEN SQLCODE = -913                                      41580039
415900             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    41590039
416000             MOVE '4350-GET-SKU-INFO'       TO PV-SOFT-PARAGRAPH  41600039
416100             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  41610039
416200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     41620039
416300               TO PV-COMMAREA-LENGTH                              41630039
416400             EXEC CICS                                            41640039
416500                  WRITEQ TD                                       41650039
416600                   QUEUE  ('CSSL')                                41660039
416700                    FROM  (PV-CICS-MSG-AREA2)                     41670039
416800                  LENGTH  (PV-COMMAREA-LENGTH)                    41680039
416900                    RESP  (PV-CICS-RESP)                          41690039
417000             END-EXEC                                             41700039
417100             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          41710039
417200             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              41720039
417300             PERFORM 9900-SOFT-ABORT                              41730039
417400         WHEN OTHER                                               41740039
417500              MOVE '4350-GET-SKU-INFO'                            41750039
417600                               TO DP013-PARAGRAPH                 41760039
417700              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           41770039
417800              STRING ' PULL-'           DELIMITED BY SIZE         41780039
417900                     PV-PULL-NUMBER     DELIMITED BY SIZE         41790039
418000                     '  -  LINE-'       DELIMITED BY SIZE         41800039
418100                     PV-LINE-NUMBER     DELIMITED BY SIZE         41810039
418200                     '  -  ITEM NBR-'   DELIMITED BY SIZE         41820039
418300                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         41830039
418400                     '  TRYING TO GET SKU INFORMATION'            41840039
418500                                        DELIMITED BY SIZE         41850039
418600                             INTO DP013-MESSAGE-TEXT (1)          41860039
418700              MOVE SQLCA       TO DP013-SQLCA                     41870039
418800              MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (2)        41880039
418900              SET DP013-DB2-ABEND                                 41890039
419000                  DP013-XCTL-DISPLAY-RESTART                      41900039
419100                                   TO TRUE                        41910039
419200                  PERFORM DP013-0000-PROCESS-ABEND                41920039
419300     END-EVALUATE.                                                41930039
419400                                                                  41940039
419500*-- END OF CHANGES ----------------------------  WR/IR# 230ZZ----*41950039
419600                                                                  41960039
419700*----------------------------------------------------------------*41970039
419800* GET LINE ITEM MANIFESTED UNIT QUANTITY                         *41980039
419900*----------------------------------------------------------------*41990039
420000 4360-GET-PULL-MANIFEST.                                          42000039
420100     INITIALIZE  PV-CEPLMF-MANIF-QTY.                             42010039
420200                                                                  42020039
420300     EXEC SQL                                                     42030039
420400          SELECT  SUM(A.MFST_UNT_QTY)                             42040039
420500            INTO  :PV-CEPLMF-MANIF-QTY :PV-NULL-IND-4             42050039
420600            FROM  TCEPLMF A                                       42060039
420700               ,  TCEPLIT B                                       42070039
420800           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           42080039
420900             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           42090039
421000             AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR        42100039
421100             AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR              42110039
421200             AND  B.STAT_CDE         NOT IN ('CA', 'PD')          42120039
421300     END-EXEC                                                     42130039
421400                                                                  42140039
421500                                                                  42150039
421600     EVALUATE TRUE                                                42160039
421700         WHEN SQLCODE = +0                                        42170039
421800              CONTINUE                                            42180039
421900         WHEN SQLCODE = -904                                      42190039
422000         WHEN SQLCODE = -911                                      42200039
422100         WHEN SQLCODE = -913                                      42210039
422200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    42220039
422300             MOVE '4360-GET-PULL-MANIFEST'  TO PV-SOFT-PARAGRAPH  42230039
422400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  42240039
422500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     42250039
422600               TO PV-COMMAREA-LENGTH                              42260039
422700             EXEC CICS                                            42270039
422800                  WRITEQ TD                                       42280039
422900                   QUEUE  ('CSSL')                                42290039
423000                    FROM  (PV-CICS-MSG-AREA2)                     42300039
423100                  LENGTH  (PV-COMMAREA-LENGTH)                    42310039
423200                    RESP  (PV-CICS-RESP)                          42320039
423300             END-EXEC                                             42330039
423400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          42340039
423500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              42350039
423600             PERFORM 9900-SOFT-ABORT                              42360039
423700         WHEN OTHER                                               42370039
423800              MOVE '4360-GET-PULL-MANIFEST'                       42380039
423900                               TO DP013-PARAGRAPH                 42390039
424000              MOVE 'GET LINE MANIFEST QTY    '                    42400039
424100                               TO DP013-MESSAGE-TEXT (1)          42410039
424200              MOVE SQLCA       TO DP013-SQLCA                     42420039
424300              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (2)        42430039
424400              SET DP013-DB2-ABEND                                 42440039
424500                  DP013-XCTL-DISPLAY-RESTART                      42450039
424600                                   TO TRUE                        42460039
424700                  PERFORM DP013-0000-PROCESS-ABEND                42470039
424800     END-EVALUATE.                                                42480039
424900                                                                  42490039
425000                                                                  42500039
425100*----------------------------------------------------------------*42510039
425200* CHECK IF ROWS EXIST ON TCEPLMF                                  42520039
425300*----------------------------------------------------------------*42530039
425400 4365-GET-TCEPLMF.                                                42540039
425500                                                                  42550039
425600     INITIALIZE  PV-TCEPLMF-COUNT.                                42560039
425700                                                                  42570039
425800     EXEC SQL                                                     42580039
425900          SELECT COUNT(*)                                         42590039
426000            INTO :PV-TCEPLMF-COUNT                                42600039
426100            FROM TCEPLMF                                          42610039
426200           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             42620039
426300             AND PL_LNE_NBR        =  :DK-LINE-NUMBER             42630039
426400     END-EXEC.                                                    42640039
426500                                                                  42650039
426600     EVALUATE TRUE                                                42660039
426700         WHEN SQLCODE = +0                                        42670039
426800         WHEN SQLCODE = +100                                      42680039
426900              CONTINUE                                            42690039
427000                                                                  42700039
427100         WHEN OTHER                                               42710039
427200              MOVE '4365-GET-TCEPLMF     '    TO DP013-PARAGRAPH  42720039
427300              MOVE 'COUNT ENTRIES IN TCEPLMF        '             42730039
427400                                       TO DP013-MESSAGE-TEXT (1)  42740039
427500              STRING ' PULL NBR-'    DELIMITED BY SIZE            42750039
427600                      ASC-PULL-NBR                                42760039
427700                                     DELIMITED BY SIZE            42770039
427800                     ' LINE NBR-'    DELIMITED BY SIZE            42780039
427900                      ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  42790039
428000                                     DELIMITED BY SIZE            42800039
428100                                     INTO DP013-MESSAGE-TEXT (2)  42810039
428200              MOVE SQLCA                      TO DP013-SQLCA      42820039
428300              MOVE 'TCEPLMF '        TO DP013-DB2-TABLE-NAME (1)  42830039
428400              SET  DP013-DB2-ABEND                                42840039
428500                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            42850039
428600              PERFORM DP013-0000-PROCESS-ABEND                    42860039
428700     END-EVALUATE.                                                42870039
428800                                                                  42880039
428900                                                                  42890039
429000*----------------------------------------------------------------*42900039
429100* GET LINE ITEM ADJUSTED UNIT QUANTITY                           *42910039
429200*----------------------------------------------------------------*42920039
429300 4370-GET-PULL-ADJUST.                                            42930039
429400     INITIALIZE  PV-CEPLAU-ADJUST-QTY.                            42940039
429500                                                                  42950039
429600     EXEC SQL                                                     42960039
429700          SELECT  SUM(A.AFT_ADJ_UNT_QTY - A.BEF_ADJ_UNT_QTY)      42970039
429800            INTO  :PV-CEPLAU-ADJUST-QTY :PV-NULL-IND-5            42980039
429900            FROM  TCEPLAU A                                       42990039
430000               ,  TCEPLIT B                                       43000039
430100           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           43010039
430200             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           43020039
430300             AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR        43030039
430400             AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR              43040039
430500             AND  B.STAT_CDE         NOT IN ('CA', 'PD')          43050039
430600     END-EXEC                                                     43060039
430700                                                                  43070039
430800                                                                  43080039
430900     EVALUATE TRUE                                                43090039
431000         WHEN SQLCODE = +0                                        43100039
431100              CONTINUE                                            43110039
431200         WHEN SQLCODE = -904                                      43120039
431300         WHEN SQLCODE = -911                                      43130039
431400         WHEN SQLCODE = -913                                      43140039
431500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    43150039
431600             MOVE '4370-GET-PULL-ADJUST'    TO PV-SOFT-PARAGRAPH  43160039
431700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  43170039
431800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     43180039
431900               TO PV-COMMAREA-LENGTH                              43190039
432000             EXEC CICS                                            43200039
432100                  WRITEQ TD                                       43210039
432200                   QUEUE  ('CSSL')                                43220039
432300                    FROM  (PV-CICS-MSG-AREA2)                     43230039
432400                  LENGTH  (PV-COMMAREA-LENGTH)                    43240039
432500                    RESP  (PV-CICS-RESP)                          43250039
432600             END-EXEC                                             43260039
432700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          43270039
432800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              43280039
432900             PERFORM 9900-SOFT-ABORT                              43290039
433000         WHEN OTHER                                               43300039
433100              MOVE '4370-GET-PULL-ADJUST'                         43310039
433200                               TO DP013-PARAGRAPH                 43320039
433300              MOVE 'GET LINE ADJUSTMENT QTY  '                    43330039
433400                               TO DP013-MESSAGE-TEXT (1)          43340039
433500              MOVE SQLCA       TO DP013-SQLCA                     43350039
433600              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (2)        43360039
433700              SET DP013-DB2-ABEND                                 43370039
433800                  DP013-XCTL-DISPLAY-RESTART                      43380039
433900                                   TO TRUE                        43390039
434000                  PERFORM DP013-0000-PROCESS-ABEND                43400039
434100     END-EVALUATE.                                                43410039
434200                                                                  43420039
434300                                                                  43430039
434400*----------------------------------------------------------------*43440039
434500* COUNT NUMBER OF ADJUSTMENTS                                    *43450039
434600*----------------------------------------------------------------*43460039
434700 4380-GET-ADJUSTMENT-COUNT.                                       43470039
434800                                                                  43480039
434900     EXEC SQL                                                     43490039
435000         SELECT  COUNT(*)                                         43500039
435100           INTO  :PV-ADJUSTMENT-QTY                               43510039
435200           FROM  TCEPLAU                                          43520039
435300          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             43530039
435400            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             43540039
435500     END-EXEC                                                     43550039
435600                                                                  43560039
435700     EVALUATE TRUE                                                43570039
435800         WHEN SQLCODE = +0                                        43580039
435900              CONTINUE                                            43590039
436000         WHEN SQLCODE = -904                                      43600039
436100         WHEN SQLCODE = -911                                      43610039
436200         WHEN SQLCODE = -913                                      43620039
436300             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   43630039
436400             MOVE '4380-GET-ADJUSTMENT-COUN' TO PV-SOFT-PARAGRAPH 43640039
436500             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 43650039
436600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     43660039
436700               TO PV-COMMAREA-LENGTH                              43670039
436800             EXEC CICS                                            43680039
436900                  WRITEQ TD                                       43690039
437000                   QUEUE  ('CSSL')                                43700039
437100                    FROM  (PV-CICS-MSG-AREA2)                     43710039
437200                  LENGTH  (PV-COMMAREA-LENGTH)                    43720039
437300                    RESP  (PV-CICS-RESP)                          43730039
437400             END-EXEC                                             43740039
437500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          43750039
437600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              43760039
437700             PERFORM 9900-SOFT-ABORT                              43770039
437800         WHEN OTHER                                               43780039
437900              MOVE '4380-GET-ADJUSTMENT-COUNT'                    43790039
438000                               TO DP013-PARAGRAPH                 43800039
438100              MOVE 'DETERMINE IF ADJUSTMENST WERE MADE'           43810039
438200                               TO DP013-MESSAGE-TEXT (1)          43820039
438300              MOVE SQLCA       TO DP013-SQLCA                     43830039
438400              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (1)        43840039
438500              SET DP013-DB2-ABEND                                 43850039
438600                  DP013-XCTL-DISPLAY-RESTART                      43860039
438700                                   TO TRUE                        43870039
438800                  PERFORM DP013-0000-PROCESS-ABEND                43880039
438900     END-EVALUATE.                                                43890039
439000                                                                  43900039
439100                                                                  43910039
439200*----------------------------------------------------------------*43920039
439300* TOTAL MANIFEST UNITS FOR PULL                                  *43930039
439400*----------------------------------------------------------------*43940039
439500 4385-GET-TOT-MANIFEST.                                           43950039
439600     INITIALIZE  PV-TOT-MANIFEST-QTY.                             43960039
439700     MOVE  ASC-CS-LOC-N               TO DK-LOC-ID.               43970039
439800     MOVE  ASC-REF-NBR                TO DK-REF-NUMBER.           43980039
439900                                                                  43990039
440000     EXEC SQL                                                     44000039
440100          SELECT  SUM(A.MFST_UNT_QTY)                             44010039
440200            INTO  :PV-TOT-MANIFEST-QTY :PV-NULL-IND-1             44020039
440300            FROM  TCEPLMF A                                       44030039
440400               ,  TCEPLRQ B                                       44040039
440500           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           44050039
440600             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           44060039
440700             AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR        44070039
440800             AND  B.CNSTK_LOC_ID     =  :DK-LOC-ID                44080039
440900             AND  B.SRC_REF_NBR      =  :DK-REF-NUMBER            44090039
441000     END-EXEC.                                                    44100039
441100                                                                  44110039
441200                                                                  44120039
441300     EVALUATE TRUE                                                44130039
441400         WHEN SQLCODE = +0                                        44140039
441500              CONTINUE                                            44150039
441600         WHEN SQLCODE = -904                                      44160039
441700         WHEN SQLCODE = -911                                      44170039
441800         WHEN SQLCODE = -913                                      44180039
441900             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    44190039
442000             MOVE '4385-GET-TOT-MANIFEST '  TO PV-SOFT-PARAGRAPH  44200039
442100             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  44210039
442200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     44220039
442300               TO PV-COMMAREA-LENGTH                              44230039
442400             EXEC CICS                                            44240039
442500                  WRITEQ TD                                       44250039
442600                   QUEUE  ('CSSL')                                44260039
442700                    FROM  (PV-CICS-MSG-AREA2)                     44270039
442800                  LENGTH  (PV-COMMAREA-LENGTH)                    44280039
442900                    RESP  (PV-CICS-RESP)                          44290039
443000             END-EXEC                                             44300039
443100             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          44310039
443200             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              44320039
443300             PERFORM 9900-SOFT-ABORT                              44330039
443400         WHEN OTHER                                               44340039
443500              MOVE '4385-GET-TOT-MANIFEST '                       44350039
443600                               TO DP013-PARAGRAPH                 44360039
443700              MOVE 'GET TOTAL MANIFEST QTY   '                    44370039
443800                               TO DP013-MESSAGE-TEXT (1)          44380039
443900              MOVE SQLCA       TO DP013-SQLCA                     44390039
444000              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        44400039
444100              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (2)        44410039
444200              SET DP013-DB2-ABEND                                 44420039
444300                  DP013-XCTL-DISPLAY-RESTART                      44430039
444400                                   TO TRUE                        44440039
444500                  PERFORM DP013-0000-PROCESS-ABEND                44450039
444600     END-EVALUATE.                                                44460039
444700                                                                  44470039
444800                                                                  44480039
444900                                                                  44490039
445000                                                                  44500039
445100*----------------------------------------------------------------*44510039
445200* TOTAL ADJUSTED UNITS FOR PULL                                  *44520039
445300*----------------------------------------------------------------*44530039
445400 4390-GET-TOT-ADJUST.                                             44540039
445500     INITIALIZE  PV-TOT-ADJUSTED-QTY.                             44550039
445600                                                                  44560039
445700     EXEC SQL                                                     44570039
445800          SELECT  SUM(A.AFT_ADJ_UNT_QTY - A.BEF_ADJ_UNT_QTY)      44580039
445900            INTO  :PV-TOT-ADJUSTED-QTY  :PV-NULL-IND-1            44590039
446000            FROM  TCEPLAU A                                       44600039
446100           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           44610039
446200             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           44620039
446300     END-EXEC                                                     44630039
446400                                                                  44640039
446500                                                                  44650039
446600     EVALUATE TRUE                                                44660039
446700         WHEN SQLCODE = +0                                        44670039
446800              CONTINUE                                            44680039
446900         WHEN SQLCODE = -904                                      44690039
447000         WHEN SQLCODE = -911                                      44700039
447100         WHEN SQLCODE = -913                                      44710039
447200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    44720039
447300             MOVE '4390-GET-TOT-ADJUST '    TO PV-SOFT-PARAGRAPH  44730039
447400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  44740039
447500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     44750039
447600               TO PV-COMMAREA-LENGTH                              44760039
447700             EXEC CICS                                            44770039
447800                  WRITEQ TD                                       44780039
447900                   QUEUE  ('CSSL')                                44790039
448000                    FROM  (PV-CICS-MSG-AREA2)                     44800039
448100                  LENGTH  (PV-COMMAREA-LENGTH)                    44810039
448200                    RESP  (PV-CICS-RESP)                          44820039
448300             END-EXEC                                             44830039
448400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          44840039
448500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              44850039
448600             PERFORM 9900-SOFT-ABORT                              44860039
448700         WHEN OTHER                                               44870039
448800              MOVE '4390-GET-TOT-ADJUST '                         44880039
448900                               TO DP013-PARAGRAPH                 44890039
449000              MOVE 'GET TOTAL ADJUSTMENT QTY '                    44900039
449100                               TO DP013-MESSAGE-TEXT (1)          44910039
449200              MOVE SQLCA       TO DP013-SQLCA                     44920039
449300              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (2)        44930039
449400              SET DP013-DB2-ABEND                                 44940039
449500                  DP013-XCTL-DISPLAY-RESTART                      44950039
449600                                   TO TRUE                        44960039
449700                  PERFORM DP013-0000-PROCESS-ABEND                44970039
449800     END-EVALUATE.                                                44980039
449900                                                                  44990039
450000                                                                  45000039
450100*----------------------------------------------------------------*45010039
450200* TOTAL DISTRIBUTED UNITS FOR PULL                               *45020039
450300*----------------------------------------------------------------*45030039
450400 4395-GET-TOT-DISTRB.                                             45040039
450500     INITIALIZE  PV-TOT-DISTRB-QTY.                               45050039
450600                                                                  45060039
450700     EXEC SQL                                                     45070039
450800          SELECT  SUM(A.ACTL_DISTRB_QTY)                          45080039
450900            INTO  :PV-TOT-DISTRB-QTY :PV-NULL-IND-1               45090039
451000            FROM  TCEPLDS A                                       45100039
451100           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           45110039
451200             AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER           45120039
451300     END-EXEC                                                     45130039
451400                                                                  45140039
451500                                                                  45150039
451600     EVALUATE TRUE                                                45160039
451700         WHEN SQLCODE = +0                                        45170039
451800              CONTINUE                                            45180039
451900         WHEN SQLCODE = -904                                      45190039
452000         WHEN SQLCODE = -911                                      45200039
452100         WHEN SQLCODE = -913                                      45210039
452200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    45220039
452300             MOVE '4395-GET-TOT-DISTRB '    TO PV-SOFT-PARAGRAPH  45230039
452400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  45240039
452500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     45250039
452600               TO PV-COMMAREA-LENGTH                              45260039
452700             EXEC CICS                                            45270039
452800                  WRITEQ TD                                       45280039
452900                   QUEUE  ('CSSL')                                45290039
453000                    FROM  (PV-CICS-MSG-AREA2)                     45300039
453100                  LENGTH  (PV-COMMAREA-LENGTH)                    45310039
453200                    RESP  (PV-CICS-RESP)                          45320039
453300             END-EXEC                                             45330039
453400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          45340039
453500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              45350039
453600             PERFORM 9900-SOFT-ABORT                              45360039
453700         WHEN OTHER                                               45370039
453800              MOVE '4395-GET-TOT-DISTRB '                         45380039
453900                               TO DP013-PARAGRAPH                 45390039
454000              MOVE 'GET TOTAL DISTRIBUTED QTY'                    45400039
454100                               TO DP013-MESSAGE-TEXT (1)          45410039
454200              MOVE SQLCA       TO DP013-SQLCA                     45420039
454300              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        45430039
454400              SET DP013-DB2-ABEND                                 45440039
454500                  DP013-XCTL-DISPLAY-RESTART                      45450039
454600                                   TO TRUE                        45460039
454700                  PERFORM DP013-0000-PROCESS-ABEND                45470039
454800     END-EVALUATE.                                                45480039
454900                                                                  45490039
455000                                                                  45500039
455100*----------------------------------------------------------------*45510039
455200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *45520039
455300*----------------------------------------------------------------*45530039
455400                                                                  45540039
455500 4400-MOVE-COMMAREA-TO-SCREEN.                                    45550039
455600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             45560039
455700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          45570039
455800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          45580039
455900             MOVE +1    TO ASC-BLK-SUB                            45590039
456000             PERFORM 5100-WRITE-TEMP-STORAGE                      45600039
456100             ADD +1     TO ASC-BLK-SUB                            45610039
456200             PERFORM 5100-WRITE-TEMP-STORAGE                      45620039
456300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             45630039
456400                 GIVING PV-BLOCK-NUMBER                           45640039
456500                 REMAINDER PV-REMAINDER                           45650039
456600             IF  PV-REMAINDER > ZERO                              45660039
456700                 ADD +1 TO PV-BLOCK-NUMBER                        45670039
456800             END-IF                                               45680039
456900             MOVE +1    TO ASC-BLK-SUB                            45690039
457000             PERFORM 4410-READ-TEMP-STORAGE                       45700039
457100             ADD +1     TO ASC-BLK-SUB                            45710039
457200                           PV-BLOCK-NUMBER                        45720039
457300             PERFORM 4410-READ-TEMP-STORAGE                       45730039
457400     END-IF.                                                      45740039
457500     MOVE +1            TO ASC-BLK-SUB.                           45750039
457600     COMPUTE ASC-ITEM-SUB =                                       45760039
457700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              45770039
457800         + PC-ITEMS-PER-PANEL).                                   45780039
457900*                                                                 45790039
458000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        45800039
458100         ADD +1         TO ASC-BLK-SUB                            45810039
458200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            45820039
458300     END-IF.                                                      45830039
458400*                                                                 45840039
458500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           45850039
458600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                45860039
458700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        45870039
458800     PERFORM 4420-FORMAT-LIST-LINES                               45880039
458900         VARYING PV-SUB                                           45890039
459000         FROM PC-ITEMS-PER-PANEL BY -1                            45900039
459100         UNTIL PV-SUB < +1.                                       45910039
459200*                                                                 45920039
459300     COMPUTE ASC-ITEMS-DISPLAYED =                                45930039
459400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          45940039
459500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    45950039
459600                                      ASTRTITO.                   45960039
459700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    45970039
459800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    45980039
459900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            45990039
460000                                   TO ASELITO.                    46000039
460100                                                                  46010039
460200     MOVE ASC-CS-LOC-N               TO PV-4-DIGIT-STORE.         46020039
460300     MOVE PV-4-DIGIT-STORE           TO ALOCIDO.                  46030039
460400                                                                  46040039
460500     MOVE ASC-CS-PRINTER-ID          TO APRTIDO.                  46050039
460600     MOVE ASC-PULL-NBR-N             TO APULNOO                   46060039
460700                                        DK-PULL-NUMBER.           46070039
460800                                                                  46080039
460900     PERFORM 4500-GET-PULL-ITEM.                                  46090039
461000     PERFORM 4510-GET-PULL-DISTRO.                                46100039
461100     PERFORM 4520-GET-PULL-MANIFEST.                              46110039
461200     PERFORM 4530-GET-PULL-ADJUST.                                46120039
461300     PERFORM 4840-GET-NEW-PULL-STATUS.                            46130039
461400                                                                  46140039
461500     MOVE PV-CEPLIT-REQ-QTY          TO ARQUNTO.                  46150039
461600                                                                  46160039
461700     COMPUTE PV-COMPUTE-DISTRB-QTY =                              46170039
461800             (PV-CEPLDS-DISTRB-QTY +                              46180039
461900              PV-CEPLMF-MANIF-QTY  +                              46190039
462000              PV-CEPLAU-ADJUST-QTY).                              46200039
462100     MOVE  PV-COMPUTE-DISTRB-QTY     TO ADSUNTO.                  46210039
462200                                                                  46220039
462300     IF  PV-COMPUTE-DISTRB-QTY = +0                               46230039
462400         MOVE  ZEROES                TO AVRUNTO                   46240039
462500     ELSE                                                         46250039
462600         SUBTRACT  PV-CEPLIT-REQ-QTY                              46260039
462700             FROM  PV-COMPUTE-DISTRB-QTY                          46270039
462800           GIVING  PV-VARIANCE-UNITS                              46280039
462900         MOVE  PV-VARIANCE-UNITS     TO AVRUNTO                   46290039
463000     END-IF.                                                      46300039
463100                                                                  46310039
463200     MOVE ASC-REF-NBR                TO AREFNOO.                  46320039
463300                                                                  46330039
463400     EVALUATE TRUE                                                46340039
463500         WHEN ASC-PULL-SRC-ADAM                                   46350039
463600              MOVE PC-ADAM-DESC             TO APLSRCO            46360039
463700         WHEN ASC-PULL-SRC-INFOREM                                46370039
463800              MOVE PC-INFOREM-DESC          TO APLSRCO            46380039
463900         WHEN ASC-PULL-SRC-MANUAL                                 46390039
464000              MOVE PC-MANUAL-DESC           TO APLSRCO            46400039
464001**DJK - 05/05/2010 - ADDED NEW DESCRIPT FOR EFC2                  46400146
464010         WHEN ASC-PULL-SRC-XFER                                   46401042
464020              MOVE PC-XFER-DESC             TO APLSRCO            46402042
464100         WHEN OTHER                                               46410039
464200              MOVE PC-UNKNOWN-DESC          TO APLSRCO            46420039
464300     END-EVALUATE.                                                46430039
464400                                                                  46440039
464500     EVALUATE TRUE                                                46450039
464600         WHEN ASC-PULL-CANCELLED                                  46460039
464700              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            46470039
464800         WHEN ASC-PULL-DISTRIBUTED                                46480039
464900              MOVE PC-DISTRIB-DESC          TO APULSTO            46490039
465000         WHEN ASC-PULL-IN-PROCESS                                 46500039
465100              MOVE PC-IN-PROCESS-DESC       TO APULSTO            46510039
465200         WHEN ASC-PULL-NEW                                        46520039
465300              MOVE PC-NEW-DESC              TO APULSTO            46530039
465400         WHEN ASC-PULL-POSTED                                     46540039
465500              MOVE PC-POSTED-DESC           TO APULSTO            46550039
465600         WHEN OTHER                                               46560039
465700              MOVE PC-UNKNOWN-DESC          TO APULSTO            46570039
465800     END-EVALUATE.                                                46580039
465900                                                                  46590039
466000*                                                                 46600039
466100     IF  DP020-MSG-NUMBER-X = SPACE                               46610039
466200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  46620039
466300*            --- MORE ITEMS TO DISPLAY ----                       46630039
466400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            46640039
466500             SET DP020-MSG-INFORMATIONAL TO TRUE                  46650039
466600         END-IF                                                   46660039
466700     END-IF.                                                      46670039
466800*----------------------------------------------------------------*46680039
466900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *46690039
467000*----------------------------------------------------------------*46700039
467100                                                                  46710039
467200 4410-READ-TEMP-STORAGE.                                          46720039
467300                                                                  46730039
467400     EXEC CICS                                                    46740039
467500         READQ TS                                                 46750039
467600             QUEUE (ASC-LIST-QUEUE-NAME)                          46760039
467700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               46770039
467800             ITEM  (PV-BLOCK-NUMBER)                              46780039
467900             RESP  (PV-CICS-RESP)                                 46790039
468000     END-EXEC.                                                    46800039
468100                                                                  46810039
468200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       46820039
468300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     46830039
468400         CONTINUE                                                 46840039
468500     ELSE                                                         46850039
468600         SET DP013-CICS-ABEND     TO TRUE                         46860039
468700         SET DP013-NO-ROLLBACK    TO TRUE                         46870039
468800         MOVE '4410-READ-TEMP-STORAGE'                            46880039
468900                                  TO DP013-PARAGRAPH              46890039
469000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      46900039
469100                                  TO DP013-MESSAGE-TEXT(1)        46910039
469200         PERFORM DP013-0000-PROCESS-ABEND                         46920039
469300     END-IF.                                                      46930039
469400                                                                  46940039
469500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             46950039
469600*                                                                 46960039
469700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         46970039
469800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               46980039
469900     END-IF.                                                      46990039
470000 EJECT                                                            47000039
470100*----------------------------------------------------------------*47010039
470200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *47020039
470300*----------------------------------------------------------------*47030039
470400                                                                  47040039
470500 4420-FORMAT-LIST-LINES.                                          47050039
470600     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      47060039
470700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                47070039
470800         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           47080039
470900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           47090039
471000         MOVE SPACE              TO MR-SELECTI (PV-SUB)           47100039
471100                                    MR-ACTION (PV-SUB)            47110039
471200                                    MR-SKU-NBR (PV-SUB)           47120039
471300                                    MR-SKU-DESC (PV-SUB)          47130039
471400                                    MR-LINE-STATUS (PV-SUB)       47140039
471500                                    MR-ADJUSTMENT-SW (PV-SUB)     47150039
471600                                    MR-DISTRBUTED-UNITS (PV-SUB)  47160039
471700                                                                  47170039
471800         MOVE ZEROES             TO MR-LINE-NUMBER (PV-SUB)       47180039
471900                                    MR-NBR-STORES (PV-SUB)        47190039
472000                                    MR-REQ-PULL-UNITS (PV-SUB)    47200039
472100                                    MR-VARIANCE-UNITS (PV-SUB)    47210039
472200     ELSE                                                         47220039
472300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      47230039
472400                                                   > SPACE        47240039
472500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 47250039
472600                                 TO MR-SELECTI (PV-SUB)           47260039
472700         ELSE                                                     47270039
472800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      47280039
472900                                 TO MR-SELECTI (PV-SUB)           47290039
473000         END-IF                                                   47300039
473100*                                                                 47310039
473200         IF  DP030-SET-CURSOR-TRAILER                             47320039
473300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)47330039
473400                 > SPACE)                                         47340039
473500               OR (PV-SUB = 1))                                   47350039
473600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               47360039
473700                MOVE -1          TO MR-SELECTL (PV-SUB)           47370039
473800             END-IF                                               47380039
473900         END-IF                                                   47390039
474000*                                                                 47400039
474100         MOVE ASC-PULL-NBR              TO  DK-PULL-NUMBER        47410039
474200         MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          47420039
474300                                        TO  DK-LINE-NUMBER        47430039
474400         PERFORM 4830-LINE-STATUS                                 47440039
474500         MOVE  PV-PULL-STATUS                                     47450039
474600           TO  ASC-LINE-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)     47460039
474700         EVALUATE  TRUE                                           47470039
474800             WHEN  PV-PULL-STATUS-NEW                             47480039
474900                   MOVE  PC-NEW-DESC                              47490039
475000                     TO  ASC-LINE-STATUS-DESC                     47500039
475100                         (ASC-BLK-SUB ASC-ITEM-SUB)               47510039
475200             WHEN  PV-PULL-STATUS-CANCELLED                       47520039
475300                   MOVE  PC-PULL-STATUS-CANCELLED                 47530039
475400                     TO  ASC-LINE-STATUS-DESC                     47540039
475500                         (ASC-BLK-SUB ASC-ITEM-SUB)               47550039
475600             WHEN  PV-PULL-STATUS-INPROCESS                       47560039
475700                   MOVE  PC-IN-PROCESS-DESC                       47570039
475800                     TO  ASC-LINE-STATUS-DESC                     47580039
475900                         (ASC-BLK-SUB ASC-ITEM-SUB)               47590039
476000             WHEN  PV-PULL-STATUS-DISTRIBTD                       47600039
476100                   MOVE  PC-DISTRIB-DESC                          47610039
476200                     TO  ASC-LINE-STATUS-DESC                     47620039
476300                         (ASC-BLK-SUB ASC-ITEM-SUB)               47630039
476400             WHEN  PV-PULL-STATUS-POSTED                          47640039
476500                   MOVE  PC-POSTED-DESC                           47650039
476600                     TO  ASC-LINE-STATUS-DESC                     47660039
476700                         (ASC-BLK-SUB ASC-ITEM-SUB)               47670039
476800         END-EVALUATE                                             47680039
476900*                                                                 47690039
477000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               47700039
477100                                 TO MR-ACTION (PV-SUB)            47710039
477200         MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          47720039
477300                                 TO MR-LINE-NUMBER (PV-SUB)       47730039
477400         MOVE ASC-SKU-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)           47740039
477500                                 TO MR-SKU-NBR (PV-SUB)           47750039
477600         MOVE ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)      47760039
477700                                 TO MR-SKU-DESC (PV-SUB)          47770039
477800         MOVE ASC-LINE-STATUS-DESC (ASC-BLK-SUB ASC-ITEM-SUB)     47780039
477900                                 TO MR-LINE-STATUS (PV-SUB)       47790039
478000         MOVE ASC-NBR-STORES (ASC-BLK-SUB ASC-ITEM-SUB)           47800039
478100                                 TO MR-NBR-STORES (PV-SUB)        47810039
478200         MOVE ASC-REQ-PULL-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       47820039
478300                                 TO MR-REQ-PULL-UNITS (PV-SUB)    47830039
478400         MOVE ASC-PULL-NBR       TO DK-PULL-NUMBER                47840039
478500         MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          47850039
478600                                 TO DK-LINE-NUMBER                47860039
478700         MOVE ASC-LINE-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)      47870039
478800                                 TO DK-LINE-STATUS                47880039
478900         PERFORM 4340-GET-ITEM-DISTRO                             47890039
479000         PERFORM 4360-GET-PULL-MANIFEST                           47900039
479100         PERFORM 4370-GET-PULL-ADJUST                             47910039
479200         IF  PV-PULL-STATUS-DISTRIBTD  OR                         47920039
479300             PV-PULL-STATUS-POSTED                                47930039
479400             COMPUTE PV-COMPUTE-DISTRB-QTY =                      47940039
479500                     (PV-CEPLDS-DISTRB-QTY +                      47950039
479600                      PV-CEPLMF-MANIF-QTY  +                      47960039
479700                      PV-CEPLAU-ADJUST-QTY)                       47970039
479800             MOVE  PV-COMPUTE-DISTRB-QTY                          47980039
479900                              TO  PV-DIST-UNT-ZERO-SUPPRESS       47990039
480000                                  ASC-DISTRB-UNTS-NUM             48000039
480100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48010039
480200             MOVE  PV-DIST-UNT-ZERO-SUPPRESS                      48020039
480300                              TO  ASC-DISTRBUTED-UNITS            48030039
480400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48040039
480500         ELSE                                                     48050039
480600             IF  PV-CEPLMF-MANIF-QTY = 0                          48060039
480700             AND PV-CEPLAU-ADJUST-QTY = 0                         48070039
480800                 IF  PV-NULL-IND-4 < +0  AND                      48080039
480900                     PV-NULL-IND-5 < +0                           48090039
481000                     MOVE SPACES  TO  ASC-DISTRBUTED-UNITS        48100039
481100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48110039
481200                     MOVE ZEROES  TO  ASC-DISTRB-UNTS-NUM         48120039
481300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48130039
481400                 ELSE                                             48140039
481500                     MOVE ZEROES  TO  PV-DIST-UNT-ZERO-SUPPRESS   48150039
481600                                      ASC-DISTRB-UNTS-NUM         48160039
481700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48170039
481800                     MOVE  PV-DIST-UNT-ZERO-SUPPRESS              48180039
481900                                  TO  ASC-DISTRBUTED-UNITS        48190039
482000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48200039
482100                 END-IF                                           48210039
482200             ELSE                                                 48220039
482300                 COMPUTE PV-COMPUTE-DISTRB-QTY =                  48230039
482400                         (PV-CEPLDS-DISTRB-QTY +                  48240039
482500                          PV-CEPLMF-MANIF-QTY  +                  48250039
482600                          PV-CEPLAU-ADJUST-QTY)                   48260039
482700                 MOVE  PV-COMPUTE-DISTRB-QTY                      48270039
482800                                  TO  PV-DIST-UNT-ZERO-SUPPRESS   48280039
482900                                      ASC-DISTRB-UNTS-NUM         48290039
483000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48300039
483100                 MOVE  PV-DIST-UNT-ZERO-SUPPRESS                  48310039
483200                                  TO  ASC-DISTRBUTED-UNITS        48320039
483300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48330039
483400             END-IF                                               48340039
483500         END-IF                                                   48350039
483600         MOVE ASC-DISTRBUTED-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)     48360039
483700                                 TO MR-DISTRBUTED-UNITS (PV-SUB)  48370039
483800                                                                  48380039
483900         PERFORM 4380-GET-ADJUSTMENT-COUNT                        48390039
484000         IF  PV-ADJUSTMENT-QTY  >  0                              48400039
484100             MOVE 'YES'                                           48410039
484200               TO  ASC-ADJUSTMENT-SW (ASC-BLK-SUB ASC-ITEM-SUB)   48420039
484300         ELSE                                                     48430039
484400             MOVE SPACES                                          48440039
484500               TO  ASC-ADJUSTMENT-SW (ASC-BLK-SUB ASC-ITEM-SUB)   48450039
484600         END-IF                                                   48460039
484700                                                                  48470039
484800         MOVE  ASC-REQ-PULL-UNITS  (ASC-BLK-SUB ASC-ITEM-SUB)     48480039
484900           TO  PV-REQ-PULL-UNITS                                  48490039
485000                                                                  48500039
485100         IF  ASC-DIST-PULL-UNITS = ZERO                           48510039
485200             MOVE  ZEROES        TO ASC-VARIANCE-UNITS            48520039
485300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48530039
485400         ELSE                                                     48540039
485500             SUBTRACT PV-REQ-PULL-UNITS                           48550039
485600                 FROM ASC-DISTRB-UNTS-NUM                         48560039
485700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48570039
485800               GIVING ASC-VARIANCE-UNITS                          48580039
485900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48590039
486000         END-IF                                                   48600039
486100                                                                  48610039
486200         MOVE ASC-VARIANCE-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       48620039
486300                                 TO MR-VARIANCE-UNITS (PV-SUB)    48630039
486400                                                                  48640039
486500         MOVE ASC-ADJUSTMENT-SW  (ASC-BLK-SUB ASC-ITEM-SUB)       48650039
486600                                 TO MR-ADJUSTMENT-SW (PV-SUB)     48660039
486700* DMH 12/15/00 - BEGIN                                            48670039
486800         EVALUATE  TRUE                                           48680039
486900             WHEN  PV-PULL-STATUS-NEW                             48690039
487000             WHEN  PV-PULL-STATUS-INPROCESS                       48700039
487100                   PERFORM 4365-GET-TCEPLMF                       48710039
487200                   IF  PV-TCEPLMF-COUNT  >  0                     48720039
487300                       MOVE 'Y' TO ASC-IN-TCEPLMF                 48730039
487400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     48740039
487500                       MOVE DP015-YELLOW                          48750039
487600                                       TO MR-LINE-STATUSC(PV-SUB) 48760039
487700                   ELSE                                           48770039
487800                       MOVE 'N' TO ASC-IN-TCEPLMF                 48780039
487900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     48790039
488000                   END-IF                                         48800039
488100             WHEN OTHER                                           48810039
488200                       MOVE 'N' TO ASC-IN-TCEPLMF                 48820039
488300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     48830039
488400         END-EVALUATE                                             48840039
488500* DMH 12/15/00 - END                                              48850039
488600     END-IF.                                                      48860039
488700                                                                  48870039
488800                                                                  48880039
488900     SUBTRACT +1 FROM ASC-ITEM-SUB                                48890039
489000     IF  ASC-ITEM-SUB < + 1                                       48900039
489100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  48910039
489200         MOVE +1                 TO ASC-BLK-SUB                   48920039
489300     END-IF.                                                      48930039
489400******************************************************************48940039
489500** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **48950039
489600** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **48960039
489700** ISSUE A WARNING.                                             **48970039
489800******************************************************************48980039
489900 4430-CHECK-FOR-BEGIN-AND-END.                                    48990039
490000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       49000039
490100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     49010039
490200*            -- NO END-OF-RANGE SPECFIED ---                      49020039
490300             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            49030039
490400             SET DP020-MSG-WARNING TO TRUE                        49040039
490500             PERFORM 4431-POSITION-AT-WARNING                     49050039
490600         END-IF                                                   49060039
490700     ELSE                                                         49070039
490800         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     49080039
490900*            -- NO BEGINNING-OF-RANGE SPECFIED ---                49090039
491000             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            49100039
491100             SET DP020-MSG-WARNING TO TRUE                        49110039
491200             PERFORM 4431-POSITION-AT-WARNING                     49120039
491300         END-IF                                                   49130039
491400     END-IF.                                                      49140039
491500******************************************************************49150039
491600** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **49160039
491700** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **49170039
491800** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **49180039
491900** POSITION THE CURSOR THERE.                                   **49190039
492000******************************************************************49200039
492100 4431-POSITION-AT-WARNING.                                        49210039
492200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 49220039
492300                    - PV-TOP-ITEM + 1.                            49230039
492400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      49240039
492500         CONTINUE                                                 49250039
492600     ELSE                                                         49260039
492700         SET DP030-SET-CURSOR-APPL-1                              49270039
492800                                   TO TRUE                        49280039
492900         MOVE -1                   TO MR-SELECTL (PV-SUB)         49290039
493000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         49300039
493100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         49310039
493200     END-IF.                                                      49320039
493300*                                                                 49330039
493400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   49340039
493500                    - PV-TOP-ITEM + 1.                            49350039
493600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      49360039
493700         CONTINUE                                                 49370039
493800     ELSE                                                         49380039
493900         SET DP030-SET-CURSOR-APPL-1                              49390039
494000                                   TO TRUE                        49400039
494100         MOVE -1                   TO MR-SELECTL (PV-SUB)         49410039
494200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         49420039
494300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         49430039
494400     END-IF.                                                      49440039
494500                                                                  49450039
494600                                                                  49460039
494700*----------------------------------------------------------------*49470039
494800* GET PULL ITEM QTYS                                             *49480039
494900*----------------------------------------------------------------*49490039
495000 4500-GET-PULL-ITEM.                                              49500039
495100                                                                  49510039
495200     INITIALIZE  PV-CEPLIT-ITEM-QTY                               49520039
495300                 PV-CEPLIT-REQ-QTY                                49530039
495400                 PV-CEPLIT-ACTL-QTY.                              49540039
495500                                                                  49550039
495600     EXEC SQL                                                     49560039
495700         SELECT  COUNT(*)                                         49570039
495800                ,SUM(PL_REQ_QTY)                                  49580039
495900                ,SUM(ACTL_PL_QTY)                                 49590039
496000           INTO  :PV-CEPLIT-ITEM-QTY                              49600039
496100                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               49610039
496200                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               49620039
496300           FROM  TCEPLIT                                          49630039
496400          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             49640039
496500            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    49650039
496600     END-EXEC                                                     49660039
496700                                                                  49670039
496800     EVALUATE TRUE                                                49680039
496900         WHEN SQLCODE = +0                                        49690039
497000              CONTINUE                                            49700039
497100         WHEN SQLCODE = -904                                      49710039
497200         WHEN SQLCODE = -911                                      49720039
497300         WHEN SQLCODE = -913                                      49730039
497400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    49740039
497500             MOVE '4500-GET-PULL-ITEM  '    TO PV-SOFT-PARAGRAPH  49750039
497600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  49760039
497700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     49770039
497800               TO PV-COMMAREA-LENGTH                              49780039
497900             EXEC CICS                                            49790039
498000                  WRITEQ TD                                       49800039
498100                   QUEUE  ('CSSL')                                49810039
498200                    FROM  (PV-CICS-MSG-AREA2)                     49820039
498300                  LENGTH  (PV-COMMAREA-LENGTH)                    49830039
498400                    RESP  (PV-CICS-RESP)                          49840039
498500             END-EXEC                                             49850039
498600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          49860039
498700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              49870039
498800             PERFORM 9900-SOFT-ABORT                              49880039
498900         WHEN OTHER                                               49890039
499000              MOVE '4500-GET-PULL-ITEM'                           49900039
499100                               TO DP013-PARAGRAPH                 49910039
499200              MOVE 'GET PULL STATUS ITEM QTYS'                    49920039
499300                               TO DP013-MESSAGE-TEXT (1)          49930039
499400              MOVE SQLCA       TO DP013-SQLCA                     49940039
499500              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        49950039
499600              SET DP013-DB2-ABEND                                 49960039
499700                  DP013-XCTL-DISPLAY-RESTART                      49970039
499800                                   TO TRUE                        49980039
499900                  PERFORM DP013-0000-PROCESS-ABEND                49990039
500000     END-EVALUATE.                                                50000039
500100                                                                  50010039
500200                                                                  50020039
500300*----------------------------------------------------------------*50030039
500400* COUNT NUMBER OF LINE ITEMS                                     *50040039
500500*----------------------------------------------------------------*50050039
500600 4505-COUNT-PULL-LINE-ITEMS.                                      50060039
500700                                                                  50070039
500800     INITIALIZE  PV-CEPLIT-ITEM-QTY.                              50080039
500900     MOVE  ASC-PULL-NBR  TO DK-PULL-NUMBER.                       50090039
501000                                                                  50100039
501100     EXEC SQL                                                     50110039
501200         SELECT  COUNT(*)                                         50120039
501300           INTO  :PV-CEPLIT-ITEM-QTY                              50130039
501400           FROM  TCEPLIT                                          50140039
501500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             50150039
501600     END-EXEC                                                     50160039
501700                                                                  50170039
501800     EVALUATE TRUE                                                50180039
501900         WHEN SQLCODE = +0                                        50190039
502000              CONTINUE                                            50200039
502100         WHEN SQLCODE = -904                                      50210039
502200         WHEN SQLCODE = -911                                      50220039
502300         WHEN SQLCODE = -913                                      50230039
502400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    50240039
502500             MOVE '4505-COUNT-LINE-ITEM'    TO PV-SOFT-PARAGRAPH  50250039
502600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  50260039
502700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     50270039
502800               TO PV-COMMAREA-LENGTH                              50280039
502900             EXEC CICS                                            50290039
503000                  WRITEQ TD                                       50300039
503100                   QUEUE  ('CSSL')                                50310039
503200                    FROM  (PV-CICS-MSG-AREA2)                     50320039
503300                  LENGTH  (PV-COMMAREA-LENGTH)                    50330039
503400                    RESP  (PV-CICS-RESP)                          50340039
503500             END-EXEC                                             50350039
503600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          50360039
503700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              50370039
503800             PERFORM 9900-SOFT-ABORT                              50380039
503900         WHEN OTHER                                               50390039
504000              MOVE '4500-GET-PULL-ITEM'                           50400039
504100                               TO DP013-PARAGRAPH                 50410039
504200              MOVE 'GET PULL STATUS ITEM QTYS'                    50420039
504300                               TO DP013-MESSAGE-TEXT (1)          50430039
504400              MOVE SQLCA       TO DP013-SQLCA                     50440039
504500              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        50450039
504600              SET DP013-DB2-ABEND                                 50460039
504700                  DP013-XCTL-DISPLAY-RESTART                      50470039
504800                                   TO TRUE                        50480039
504900                  PERFORM DP013-0000-PROCESS-ABEND                50490039
505000     END-EVALUATE.                                                50500039
505100                                                                  50510039
505200                                                                  50520039
505300*----------------------------------------------------------------*50530039
505400* GET PULL DISTRIBUTION QTY                                      *50540039
505500*----------------------------------------------------------------*50550039
505600 4510-GET-PULL-DISTRO.                                            50560039
505700                                                                  50570039
505800     INITIALIZE  PV-CEPLDS-DISTRB-QTY.                            50580039
505900                                                                  50590039
506000     EXEC SQL                                                     50600039
506100          SELECT  SUM(B.ACTL_DISTRB_QTY)                          50610039
506200            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            50620039
506300            FROM  TCEPLIT A                                       50630039
506400                 ,TCEPLDS B                                       50640039
506500           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           50650039
506600             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        50660039
506700             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              50670039
506800             AND  A.STAT_CDE   IN  ('DS', 'PD')                   50680039
506900     END-EXEC                                                     50690039
507000                                                                  50700039
507100                                                                  50710039
507200     EVALUATE TRUE                                                50720039
507300         WHEN SQLCODE = +0                                        50730039
507400              CONTINUE                                            50740039
507500         WHEN SQLCODE = -904                                      50750039
507600         WHEN SQLCODE = -911                                      50760039
507700         WHEN SQLCODE = -913                                      50770039
507800             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    50780039
507900             MOVE '4510-GET-PULL-DISTRO'    TO PV-SOFT-PARAGRAPH  50790039
508000             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  50800039
508100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     50810039
508200               TO PV-COMMAREA-LENGTH                              50820039
508300             EXEC CICS                                            50830039
508400                  WRITEQ TD                                       50840039
508500                   QUEUE  ('CSSL')                                50850039
508600                    FROM  (PV-CICS-MSG-AREA2)                     50860039
508700                  LENGTH  (PV-COMMAREA-LENGTH)                    50870039
508800                    RESP  (PV-CICS-RESP)                          50880039
508900             END-EXEC                                             50890039
509000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          50900039
509100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              50910039
509200             PERFORM 9900-SOFT-ABORT                              50920039
509300         WHEN OTHER                                               50930039
509400              MOVE '4510-GET-PULL-DISTRO'                         50940039
509500                               TO DP013-PARAGRAPH                 50950039
509600              MOVE 'GET PULL DISTRIBTION     '                    50960039
509700                               TO DP013-MESSAGE-TEXT (1)          50970039
509800              MOVE SQLCA       TO DP013-SQLCA                     50980039
509900              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        50990039
510000              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        51000039
510100              SET DP013-DB2-ABEND                                 51010039
510200                  DP013-XCTL-DISPLAY-RESTART                      51020039
510300                                   TO TRUE                        51030039
510400                  PERFORM DP013-0000-PROCESS-ABEND                51040039
510500     END-EVALUATE.                                                51050039
510600                                                                  51060039
510700                                                                  51070039
510800*----------------------------------------------------------------*51080039
510900* GET PULL MANIFESTED QTY                                        *51090039
511000*----------------------------------------------------------------*51100039
511100 4520-GET-PULL-MANIFEST.                                          51110039
511200                                                                  51120039
511300     INITIALIZE  PV-CEPLMF-MANIF-QTY.                             51130039
511400                                                                  51140039
511500     EXEC SQL                                                     51150039
511600          SELECT  SUM(B.MFST_UNT_QTY)                             51160039
511700            INTO  :PV-CEPLMF-MANIF-QTY :PV-NULL-IND-1             51170039
511800            FROM  TCEPLIT A                                       51180039
511900                 ,TCEPLMF B                                       51190039
512000           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           51200039
512100             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        51210039
512200             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              51220039
512300             AND  A.STAT_CDE         NOT IN ('CA', 'PD')          51230039
512400     END-EXEC                                                     51240039
512500                                                                  51250039
512600                                                                  51260039
512700     EVALUATE TRUE                                                51270039
512800         WHEN SQLCODE = +0                                        51280039
512900              CONTINUE                                            51290039
513000         WHEN SQLCODE = -904                                      51300039
513100         WHEN SQLCODE = -911                                      51310039
513200         WHEN SQLCODE = -913                                      51320039
513300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    51330039
513400             MOVE '4520-GET-PULL-MANIFEST'  TO PV-SOFT-PARAGRAPH  51340039
513500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  51350039
513600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     51360039
513700               TO PV-COMMAREA-LENGTH                              51370039
513800             EXEC CICS                                            51380039
513900                  WRITEQ TD                                       51390039
514000                   QUEUE  ('CSSL')                                51400039
514100                    FROM  (PV-CICS-MSG-AREA2)                     51410039
514200                  LENGTH  (PV-COMMAREA-LENGTH)                    51420039
514300                    RESP  (PV-CICS-RESP)                          51430039
514400             END-EXEC                                             51440039
514500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          51450039
514600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              51460039
514700             PERFORM 9900-SOFT-ABORT                              51470039
514800         WHEN OTHER                                               51480039
514900              MOVE '4520-GET-PULL-MANIFEST'                       51490039
515000                               TO DP013-PARAGRAPH                 51500039
515100              MOVE 'GET PULL MANIFEST QTY    '                    51510039
515200                               TO DP013-MESSAGE-TEXT (1)          51520039
515300              MOVE SQLCA       TO DP013-SQLCA                     51530039
515400              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        51540039
515500              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (2)        51550039
515600              SET DP013-DB2-ABEND                                 51560039
515700                  DP013-XCTL-DISPLAY-RESTART                      51570039
515800                                   TO TRUE                        51580039
515900                  PERFORM DP013-0000-PROCESS-ABEND                51590039
516000     END-EVALUATE.                                                51600039
516100                                                                  51610039
516200                                                                  51620039
516300*----------------------------------------------------------------*51630039
516400* GET PULL ADJUSTMENT QUANTITY                                   *51640039
516500*----------------------------------------------------------------*51650039
516600 4530-GET-PULL-ADJUST.                                            51660039
516700                                                                  51670039
516800     INITIALIZE  PV-CEPLAU-ADJUST-QTY.                            51680039
516900                                                                  51690039
517000     EXEC SQL                                                     51700039
517100          SELECT  SUM(B.AFT_ADJ_UNT_QTY - B.BEF_ADJ_UNT_QTY)      51710039
517200            INTO  :PV-CEPLAU-ADJUST-QTY :PV-NULL-IND-1            51720039
517300            FROM  TCEPLIT A                                       51730039
517400                 ,TCEPLAU B                                       51740039
517500           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           51750039
517600             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        51760039
517700             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              51770039
517800             AND  A.STAT_CDE         NOT IN ('CA', 'PD')          51780039
517900     END-EXEC                                                     51790039
518000                                                                  51800039
518100                                                                  51810039
518200     EVALUATE TRUE                                                51820039
518300         WHEN SQLCODE = +0                                        51830039
518400              CONTINUE                                            51840039
518500         WHEN SQLCODE = -904                                      51850039
518600         WHEN SQLCODE = -911                                      51860039
518700         WHEN SQLCODE = -913                                      51870039
518800             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    51880039
518900             MOVE '4530-GET-PULL-ADJUST'    TO PV-SOFT-PARAGRAPH  51890039
519000             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  51900039
519100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     51910039
519200               TO PV-COMMAREA-LENGTH                              51920039
519300             EXEC CICS                                            51930039
519400                  WRITEQ TD                                       51940039
519500                   QUEUE  ('CSSL')                                51950039
519600                    FROM  (PV-CICS-MSG-AREA2)                     51960039
519700                  LENGTH  (PV-COMMAREA-LENGTH)                    51970039
519800                    RESP  (PV-CICS-RESP)                          51980039
519900             END-EXEC                                             51990039
520000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          52000039
520100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              52010039
520200             PERFORM 9900-SOFT-ABORT                              52020039
520300         WHEN OTHER                                               52030039
520400              MOVE '4530-GET-PULL-ADJUST'                         52040039
520500                               TO DP013-PARAGRAPH                 52050039
520600              MOVE 'GET PULL ADJUSTMENT QTY  '                    52060039
520700                               TO DP013-MESSAGE-TEXT (1)          52070039
520800              MOVE SQLCA       TO DP013-SQLCA                     52080039
520900              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        52090039
521000              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (2)        52100039
521100              SET DP013-DB2-ABEND                                 52110039
521200                  DP013-XCTL-DISPLAY-RESTART                      52120039
521300                                   TO TRUE                        52130039
521400                  PERFORM DP013-0000-PROCESS-ABEND                52140039
521500     END-EVALUATE.                                                52150039
521600                                                                  52160039
521700                                                                  52170039
521710*----------------------------------------------------------------*52171057
521720* INSPECT THE SKU DESCRIPTION FROM XLV_SKU TO CONVERT INVALID    *52172058
521730* CHARACTERS TO SPACES.                                          *52173057
521740*----------------------------------------------------------------*52174057
521750 4540-INSPECT-XLV00000-SKU-DESC.                                  52175057
521760                                                                  52176057
521780     MOVE SPACE TO  PC-SPACE.                                     52178057
521790     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52179057
521791         quote BY PC-SPACE.                                       52179157
521792     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52179257
521793         '&'   BY PC-SPACE.                                       52179357
521794     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52179457
521795         '"'   BY PC-SPACE.                                       52179557
521796     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52179657
521797         '<'   BY PC-SPACE.                                       52179757
521798     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52179857
521799         '>'   BY PC-SPACE.                                       52179957
521800*-------------------------                                        52180057
521801* ADDED CHECK FOR HEX 05                                          52180157
521802*-------------------------                                        52180257
521803     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52180357
521804         '	'   BY PC-SPACE.                                       52180457
521805     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52180557
521806         ''   BY PC-SPACE.                                       52180657
521807     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52180757
521808         ';'   BY PC-SPACE.                                       52180857
521809     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52180957
521810         LOW-VALUES BY PC-SPACE.                                  52181057
521811*-------------------------                                        52181157
521812* ADDED CHECK FOR HEX 3F                                          52181257
521813*-------------------------                                        52181357
521814     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52181457
521815         ''   BY PC-SPACE.                                       52181557
521816*-------------------------                                        52181657
521817* ADDED CHECK FOR HEX 71                                          52181757
521818*-------------------------                                        52181857
521819     INSPECT XLV00000-SKU-DESC   REPLACING ALL                    52181957
521820         ''   BY PC-SPACE.                                       52182057
521821                                                                  52182157
521822                                                                  52182257
521830*----------------------------------------------------------------*52183039
521900*  PRINT PULL FUNCTION                                           *52190039
522000*----------------------------------------------------------------*52200039
522100 4600-PROCESS-PRINT-FUNCTION.                                     52210039
522200                                                                  52220039
522300     MOVE +1                       TO ASC-BLK-SUB.                52230039
522400     PERFORM 5100-WRITE-TEMP-STORAGE.                             52240039
522500     ADD +1                        TO ASC-BLK-SUB.                52250039
522600     PERFORM 5100-WRITE-TEMP-STORAGE.                             52260039
522700                                                                  52270039
522800     PERFORM 6112-READ-LIST-QUEUE.                                52280039
522900                                                                  52290039
523000     SET  LQW-IDX  TO   1.                                        52300039
523100                                                                  52310039
523200     IF PS-NO-SOFT-ABORT-ERROR                                    52320039
523300       IF PV-CICS-RESP = DFHRESP (NORMAL)                         52330039
523400         PERFORM                                                  52340039
523500         VARYING LQW-IDX  FROM 1 BY 1                             52350039
523600         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     52360039
523700            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            52370039
523800            OR   PS-SOFT-ABORT-ERROR                              52380039
523900            OR   PS-ERROR                                         52390039
524000             IF  LQW-SELECT (LQW-IDX)                             52400039
524100                 PERFORM 4605-PROCESS-SELECTED-LINES              52410039
524200             END-IF                                               52420039
524300         END-PERFORM                                              52430039
524400       END-IF                                                     52440039
524500     END-IF.                                                      52450039
524600                                                                  52460039
524700     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           52470039
524800     PERFORM 6111-WRITE-LIST-QUEUE.                               52480039
524900                                                                  52490039
525000     MOVE +1                     TO  ASC-BLK-SUB.                 52500039
525100     PERFORM 4410-READ-TEMP-STORAGE.                              52510039
525200                                                                  52520039
525300     ADD +1                      TO  ASC-BLK-SUB                  52530039
525400                                     PV-BLOCK-NUMBER.             52540039
525500                                                                  52550039
525600     PERFORM 4410-READ-TEMP-STORAGE.                              52560039
525700                                                                  52570039
525800                                                                  52580039
525900*----------------------------------------------------------------*52590039
526000*                                                                *52600039
526100*----------------------------------------------------------------*52610039
526200 4605-PROCESS-SELECTED-LINES.                                     52620039
526300                                                                  52630039
526400     PERFORM 4620-PROCESS-LINES.                                  52640039
526500                                                                  52650039
526600     IF  PS-NO-ERROR                                              52660039
526700         EVALUATE TRUE                                            52670039
526800             WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)          52680039
526900                  SET DP020-MSG-INFORMATIONAL  TO  TRUE           52690039
527000                  MOVE PC-TSYMSG-02234  TO  DP020-MSG-NUMBER      52700039
527100         END-EVALUATE                                             52710039
527200     END-IF.                                                      52720039
527300                                                                  52730039
527400                                                                  52740039
527500*----------------------------------------------------------------*52750039
527600*                                                                *52760039
527700*                                                                *52770039
527800*----------------------------------------------------------------*52780039
527900 4620-PROCESS-LINES.                                              52790039
528000                                                                  52800039
528100     MOVE ASC-PULL-NBR                   TO PV-PULL-NUMBER.       52810039
528200     MOVE ASC-REF-NBR                    TO PV-REF-NUMBER.        52820039
528300     MOVE ASC-CS-LOC                     TO PV-CS-LOCATION.       52830039
528400     MOVE LQW-LINE-NUMBER (LQW-IDX)      TO PV-LINE-NUMBER.       52840039
528500     MOVE LQW-SKU-NUMBER (LQW-IDX)       TO PV-SKU-NUMBER.        52850039
528600     MOVE LQW-SKU-DESCRIPTION (LQW-IDX)  TO PV-SKU-DESCRIPTION.   52860039
528700     MOVE LQW-LINE-STATUS-CDE  (LQW-IDX) TO PV-LINE-STATUS-CDE.   52870039
528800     MOVE LQW-LINE-STATUS-DESC (LQW-IDX) TO PV-LINE-STATUS-DESC.  52880039
528900     MOVE LQW-NBR-STORES (LQW-IDX)       TO PV-NBR-STORES.        52890039
529000     MOVE LQW-REQ-PULL-UNITS (LQW-IDX)   TO PV-REQ-PULL-UNITS.    52900039
529100     MOVE LQW-ACT-PULL-UNITS (LQW-IDX)   TO PV-ACT-PULL-UNITS.    52910039
529200     MOVE LQW-DISTRBUTED-UNITS (LQW-IDX) TO PV-DISTRBUTED-UNITS.  52920039
529300                                                                  52930039
529400     IF  PS-NO-ERROR                                              52940039
529500         IF  LQW-SELECT (LQW-IDX)                                 52950039
529600                 PERFORM 4630-ISSUE-PRINT-REQ                     52960039
529700         END-IF                                                   52970039
529800     END-IF.                                                      52980039
529900                                                                  52990039
530000                                                                  53000039
530100     IF  PS-NO-ERROR                                              53010039
530200         SET  LQW-DESELECT (LQW-IDX)                              53020039
530300              LQW-PRT (LQW-IDX)        TO  TRUE                   53030039
530400         SUBTRACT  1                                              53040039
530500             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   53050039
530600         MOVE LQW-SELECTED-SW (LQW-IDX)                           53060039
530700                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   53070039
530800     END-IF.                                                      53080039
530900                                                                  53090039
531000                                                                  53100039
531100*----------------------------------------------------------------*53110039
531200*                                                                *53120039
531300*----------------------------------------------------------------*53130039
531400 4630-ISSUE-PRINT-REQ.                                            53140039
531500                                                                  53150039
531600     INITIALIZE CE004-COMMAREA-REC.                               53160039
531700                                                                  53170039
531800     SET  CE004-CICS-LINK                                         53180039
531900          CE004-FROM-PULL-LIST    TO TRUE.                        53190039
532000     MOVE ASC-CURR-OPER-UNT-ID-N  TO CE004-CURR-OPER-UNT-ID.      53200039
532100     MOVE ASC-CURR-FCLTY-ID-N     TO CE004-CURR-FCLTY-ID.         53210039
532200     MOVE ASC-CS-PRINTER-ID       TO CE004-CS-PRINTER-ID.         53220039
532300     MOVE ASC-PULL-SELECT-STATUS  TO CE004-PULL-SELECT-STATUS.    53230039
532400     MOVE ASC-PULL-SELECT-TYPE    TO CE004-PULL-SELECT-TYPE.      53240039
532500     MOVE ASC-SELECT-LIST-SEQUENCE                                53250039
532600                                  TO CE004-SELECT-LIST-SEQUENCE.  53260039
532700     MOVE ASC-PULL-SELECT-DATE-FROM                               53270039
532800                                  TO CE004-PULL-SELECT-DATE-FROM. 53280039
532900     MOVE ASC-PULL-SELECT-DATE-TO TO CE004-PULL-SELECT-DATE-TO.   53290039
533000                                                                  53300039
533100     MOVE PV-PULL-NUMBER          TO CE004-PULL-NBR.              53310039
533200     MOVE PV-REF-NUMBER           TO CE004-REF-NBR.               53320039
533300     MOVE PV-LINE-NUMBER          TO CE004-LINE-NBR.              53330039
533400     MOVE PV-LINE-STATUS-CDE      TO CE004-LINE-STATUS.           53340039
533500     MOVE ZEROES                  TO CE004-PULL-STATUS-DATE.      53350039
533600     MOVE SPACES                  TO CE004-PULL-SOURCE.           53360039
533700     MOVE PV-CS-LOCATION          TO CE004-CS-LOCATION.           53370039
533800     MOVE ZEROES                  TO CE004-NBR-ITEMS.             53380039
533900     MOVE PV-REQ-PULL-UNITS       TO CE004-REQ-PULL-UNITS.        53390039
534000     MOVE PV-ACT-PULL-UNITS       TO CE004-ACT-PULL-UNITS.        53400039
534100     MOVE PV-DISTRBUTED-UNITS     TO CE004-DISTRBUTED-UNITS.      53410039
534200     MOVE DP020-USERID            TO CE004-USER-ID.               53420039
534300                                                                  53430039
534400     MOVE LENGTH OF CE004-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    53440039
534500                                                                  53450039
534600     EXEC CICS                                                    53460039
534700         LINK                                                     53470039
534800             PROGRAM   (PC-PRINT-PROGRAM)                         53480039
534900             COMMAREA  (CE004-COMMAREA-REC)                       53490039
535000             LENGTH    (PV-COMMAREA-LENGTH)                       53500039
535100             RESP      (PV-CICS-RESP)                             53510039
535200     END-EXEC.                                                    53520039
535300                                                                  53530039
535400     EVALUATE TRUE                                                53540039
535500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     53550039
535600              PERFORM 4640-VALIDATE-PRT-REQ-CALL                  53560039
535700         WHEN OTHER                                               53570039
535800              MOVE PC-TSYMSG-02238  TO DP020-MSG-NUMBER           53580039
535900              PERFORM 9900-SOFT-ABORT                             53590039
536000     END-EVALUATE.                                                53600039
536100                                                                  53610039
536200                                                                  53620039
536300*----------------------------------------------------------------*53630039
536400* CHECK RETURN CODE FROM LABEL PRINT PROGRAM TO SEE IF SUCCESSFUL*53640039
536500*----------------------------------------------------------------*53650039
536600 4640-VALIDATE-PRT-REQ-CALL.                                      53660039
536700                                                                  53670039
536800     IF  CE004-PRT-SUCCESSFUL                                     53680039
536900         CONTINUE                                                 53690039
537000     ELSE                                                         53700039
537100         MOVE PC-TSYMSG-02238  TO DP020-MSG-NUMBER                53710039
537200         PERFORM 9900-SOFT-ABORT                                  53720039
537300     END-IF.                                                      53730039
537400                                                                  53740039
537500                                                                  53750039
537600*----------------------------------------------------------------*53760039
537700*  UPDATE FUNCTION                                               *53770039
537800*----------------------------------------------------------------*53780039
537900 4700-PROCESS-UPDATE-FUNCTION.                                    53790039
538000                                                                  53800039
538100     MOVE +1                       TO ASC-BLK-SUB.                53810039
538200     PERFORM 5100-WRITE-TEMP-STORAGE.                             53820039
538300     ADD +1                        TO ASC-BLK-SUB.                53830039
538400     PERFORM 5100-WRITE-TEMP-STORAGE.                             53840039
538500                                                                  53850039
538600     PERFORM 6112-READ-LIST-QUEUE.                                53860039
538700                                                                  53870039
538800     SET  LQW-IDX  TO   1.                                        53880039
538900                                                                  53890039
539000     IF PS-NO-SOFT-ABORT-ERROR                                    53900039
539100       IF PV-CICS-RESP = DFHRESP (NORMAL)                         53910039
539200         PERFORM                                                  53920039
539300         VARYING LQW-IDX  FROM 1 BY 1                             53930039
539400         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     53940039
539500            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            53950039
539600            OR   PS-SOFT-ABORT-ERROR                              53960039
539700            OR   PS-ERROR                                         53970039
539800             IF  LQW-SELECT (LQW-IDX)                             53980039
539900                 PERFORM 4705-PROCESS-SELECTED-LINES              53990039
540000             END-IF                                               54000039
540100         END-PERFORM                                              54010039
540200       END-IF                                                     54020039
540300     END-IF.                                                      54030039
540400                                                                  54040039
540500     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           54050039
540600     PERFORM 6111-WRITE-LIST-QUEUE.                               54060039
540700                                                                  54070039
540800     MOVE +1                     TO  ASC-BLK-SUB.                 54080039
540900     PERFORM 4410-READ-TEMP-STORAGE.                              54090039
541000                                                                  54100039
541100     ADD +1                      TO  ASC-BLK-SUB                  54110039
541200                                     PV-BLOCK-NUMBER.             54120039
541300                                                                  54130039
541400     PERFORM 4410-READ-TEMP-STORAGE.                              54140039
541500                                                                  54150039
541600                                                                  54160039
541700*----------------------------------------------------------------*54170039
541800*                                                                *54180039
541900*----------------------------------------------------------------*54190039
542000 4705-PROCESS-SELECTED-LINES.                                     54200039
542100                                                                  54210039
542200     PERFORM 4720-UPDATE-LINES.                                   54220039
542300                                                                  54230039
542400     IF  PS-NO-ERROR                                              54240039
542500         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    54250039
542600         MOVE PC-TSYMSG-02252  TO  DP020-MSG-NUMBER               54260039
542700     END-IF.                                                      54270039
542800                                                                  54280039
542900                                                                  54290039
543000*----------------------------------------------------------------*54300039
543100*                                                                *54310039
543200*                                                                *54320039
543300*----------------------------------------------------------------*54330039
543400 4720-UPDATE-LINES.                                               54340039
543500                                                                  54350039
543600     MOVE ASC-PULL-NBR                   TO PV-PULL-NUMBER.       54360039
543700     MOVE LQW-LINE-NUMBER (LQW-IDX)      TO PV-LINE-NUMBER.       54370039
543800     MOVE LQW-UPD-UNITS (LQW-IDX)        TO PV-UPDATE-UNITS.      54380039
543900                                                                  54390039
544000     IF  PS-NO-ERROR                                              54400039
544100         IF  LQW-SELECT (LQW-IDX)                                 54410039
544200                 PERFORM 4730-ISSUE-UPDATE-REQ                    54420039
544300         END-IF                                                   54430039
544400     END-IF.                                                      54440039
544500                                                                  54450039
544600                                                                  54460039
544700     IF  PS-NO-ERROR                                              54470039
544800         SET  LQW-DESELECT (LQW-IDX)                              54480039
544900              LQW-UPD (LQW-IDX)        TO  TRUE                   54490039
545000         MOVE LQW-UPD-UNITS (LQW-IDX)  TO  LQW-ACT-PULL-UNITS     54500039
545100                                                         (LQW-IDX)54510039
545200         MOVE ZEROES                   TO  LQW-UPD-UNITS (LQW-IDX)54520039
545300         SUBTRACT  1                                              54530039
545400             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   54540039
545500         MOVE LQW-SELECTED-SW (LQW-IDX)                           54550039
545600                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   54560039
545700     END-IF.                                                      54570039
545800                                                                  54580039
545900                                                                  54590039
546000*----------------------------------------------------------------*54600039
546100*                                                                *54610039
546200*----------------------------------------------------------------*54620039
546300 4730-ISSUE-UPDATE-REQ.                                           54630039
546400                                                                  54640039
546500     PERFORM 4740-UPDATE-UNITS.                                   54650039
546600                                                                  54660039
546700     IF  PS-NO-ERROR                                              54670039
546800         EXEC CICS                                                54680039
546900              SYNCPOINT                                           54690039
547000         END-EXEC                                                 54700039
547100     END-IF.                                                      54710039
547200                                                                  54720039
547300                                                                  54730039
547400*----------------------------------------------------------------*54740039
547500*                                                                *54750039
547600*----------------------------------------------------------------*54760039
547700 4740-UPDATE-UNITS.                                               54770039
547800                                                                  54780039
547900     MOVE PV-UPDATE-UNITS         TO CEPLIT-ACTL-PL-QTY.          54790039
548000     MOVE PV-PULL-NUMBER          TO DK-PULL-NUMBER.              54800039
548100     MOVE PV-LINE-NUMBER          TO DK-LINE-NUMBER.              54810039
548200                                                                  54820039
548300     EXEC SQL                                                     54830039
548400          UPDATE TCEPLIT                                          54840039
548500             SET                                                  54850039
548600                 ACTL_PL_QTY       = :CEPLIT-ACTL-PL-QTY          54860039
548700           WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              54870039
548800             AND PL_LNE_NBR        = :DK-LINE-NUMBER              54880039
548900     END-EXEC.                                                    54890039
549000                                                                  54900039
549100     EVALUATE TRUE                                                54910039
549200         WHEN SQLCODE = ZERO                                      54920039
549300              CONTINUE                                            54930039
549400         WHEN SQLCODE = -904                                      54940039
549500         WHEN SQLCODE = -911                                      54950039
549600         WHEN SQLCODE = -913                                      54960039
549700             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   54970039
549800             MOVE '4740-UPDATE-UNITS'        TO PV-SOFT-PARAGRAPH 54980039
549900             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 54990039
550000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     55000039
550100               TO PV-COMMAREA-LENGTH                              55010039
550200             EXEC CICS                                            55020039
550300                  WRITEQ TD                                       55030039
550400                   QUEUE  ('CSSL')                                55040039
550500                    FROM  (PV-CICS-MSG-AREA2)                     55050039
550600                  LENGTH  (PV-COMMAREA-LENGTH)                    55060039
550700                    RESP  (PV-CICS-RESP)                          55070039
550800             END-EXEC                                             55080039
550900              MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER         55090039
551000              PERFORM 9900-SOFT-ABORT                             55100039
551100         WHEN SQLWARN0 NOT = SPACES                               55110039
551200         WHEN SQLCODE NOT EQUAL ZERO                              55120039
551300              MOVE '4740-UPDATE-UNITS'                            55130039
551400                                   TO DP013-PARAGRAPH             55140039
551500              STRING ' PULL NUMBER-'  DELIMITED BY SIZE           55150039
551600                     PV-PULL-NUMBER   DELIMITED BY SIZE           55160039
551700                     '  -  LINE NBR-' DELIMITED BY SIZE           55170039
551800                     PV-LINE-NUMBER   DELIMITED BY SIZE           55180039
551900                     '  -  UPD UNIT-' DELIMITED BY SIZE           55190039
552000                     PV-UPDATE-UNITS  DELIMITED BY SIZE           55200039
552100                     '  TRYING TO UPDATE ACTUAL UNITS'            55210039
552200                                      DELIMITED BY SIZE           55220039
552300                                 INTO DP013-MESSAGE-TEXT (1)      55230039
552400              MOVE SQLCA           TO DP013-SQLCA                 55240039
552500              MOVE 'TCEPLIT'       TO DP013-DB2-TABLE-NAME (1)    55250039
552600              SET DP013-DB2-ABEND  TO TRUE                        55260039
552700              PERFORM DP013-0000-PROCESS-ABEND                    55270039
552800     END-EVALUATE.                                                55280039
552900                                                                  55290039
553000                                                                  55300039
553100*----------------------------------------------------------------*55310039
553200* CONFIRM FUNCTION                                               *55320039
553300*----------------------------------------------------------------*55330039
553400 4800-PROCESS-CONFIRM-FUNCTION.                                   55340039
553500     MOVE +1                       TO ASC-BLK-SUB.                55350039
553600     PERFORM 5100-WRITE-TEMP-STORAGE.                             55360039
553700     ADD +1                        TO ASC-BLK-SUB.                55370039
553800     PERFORM 5100-WRITE-TEMP-STORAGE.                             55380039
553900                                                                  55390039
554000     PERFORM 6112-READ-LIST-QUEUE.                                55400039
554100          SET  LQW-IDX  TO   1.                                   55410039
554200                                                                  55420039
554300     IF  PS-NO-SOFT-ABORT-ERROR                                   55430039
554400        IF  PV-CICS-RESP = DFHRESP (NORMAL)                       55440039
554500            PERFORM                                               55450039
554600            VARYING LQW-IDX  FROM 1 BY 1                          55460039
554700              UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                  55470039
554800                 OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO         55480039
554900                 OR PS-SOFT-ABORT-ERROR                           55490039
555000                 OR PS-ERROR                                      55500039
555100                    IF  LQW-SELECT (LQW-IDX)                      55510039
555200                        IF  PS-NO-ERROR                           55520039
555300                        PERFORM 4810-PROCESS-CONFIRM-LINES        55530039
555400                        END-IF                                    55540039
555500                    END-IF                                        55550039
555600            END-PERFORM                                           55560039
555700        END-IF                                                    55570039
555800     END-IF.                                                      55580039
555900                                                                  55590039
556000     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           55600039
556100     PERFORM 6111-WRITE-LIST-QUEUE.                               55610039
556200                                                                  55620039
556300     MOVE +1                     TO  ASC-BLK-SUB.                 55630039
556400     PERFORM 4410-READ-TEMP-STORAGE.                              55640039
556500                                                                  55650039
556600     ADD +1                      TO  ASC-BLK-SUB                  55660039
556700                                     PV-BLOCK-NUMBER.             55670039
556800                                                                  55680039
556900     PERFORM 4410-READ-TEMP-STORAGE.                              55690039
557000                                                                  55700039
557100                                                                  55710039
557200*----------------------------------------------------------------*55720039
557300* CONFIRM FUNCTION                                               *55730039
557400*----------------------------------------------------------------*55740039
557500 4810-PROCESS-CONFIRM-LINES.                                      55750039
557600      INITIALIZE  CE005-INTER-APPL-COMMAREA                       55760039
557700      EVALUATE TRUE                                               55770039
557800          WHEN ASC-CONFIRM-CNCL-ITEM                              55780039
557900               SET  CE005-CNCL-ITEM  TO  TRUE                     55790039
558000               PERFORM 4815-LINK-CONFIRM-MODULE                   55800039
558100                                                                  55810039
558200          WHEN ASC-CONFIRM-UNCNCL-ITEM                            55820039
558300               SET  CE005-UNCNCL-ITEM  TO  TRUE                   55830039
558400               PERFORM 4815-LINK-CONFIRM-MODULE                   55840039
558500                                                                  55850039
558600          WHEN ASC-CONFIRM-CONF-DIST-ITEM                         55860039
558700               SET  CE005-CNFM-DIST-ITEM  TO  TRUE                55870039
558800               PERFORM 4815-LINK-CONFIRM-MODULE                   55880039
558900                                                                  55890039
559000          WHEN ASC-CONFIRM-UNCONF-DIST-ITEM                       55900039
559100               SET  CE005-UNCNFM-DIST-ITEM  TO  TRUE              55910039
559200               PERFORM 4815-LINK-CONFIRM-MODULE                   55920039
559300                                                                  55930039
559400          WHEN ASC-CONFIRM-CONF-ITEM                              55940039
559500               SET  CE005-CNFM-ITEM  TO  TRUE                     55950039
559600               PERFORM 4815-LINK-CONFIRM-MODULE                   55960039
559700                                                                  55970039
559800         WHEN ASC-CONFIRM-UNCONF-ITEM                             55980039
559900              SET  CE005-UNCNFM-ITEM  TO  TRUE                    55990039
560000              PERFORM 4815-LINK-CONFIRM-MODULE                    56000039
560100                                                                  56010039
560200         WHEN ASC-CONFIRM-POST-DIST                               56020039
560300              SET  CE005-POST-ITEM    TO  TRUE                    56030039
560400              PERFORM 4815-LINK-CONFIRM-MODULE                    56040039
560500                                                                  56050039
560600         WHEN ASC-CONFIRM-UNPOST-DIST                             56060039
560700              SET  CE005-UNPOST-ITEM  TO  TRUE                    56070039
560800              PERFORM 4815-LINK-CONFIRM-MODULE                    56080039
560900                                                                  56090039
561000     END-EVALUATE.                                                56100039
561100                                                                  56110039
561200                                                                  56120039
561300*----------------------------------------------------------------*56130039
561400* LINK TO CANCEL/CONFIRMATION MODULE                             *56140039
561500*----------------------------------------------------------------*56150039
561600 4815-LINK-CONFIRM-MODULE.                                        56160039
561700                                                                  56170039
561800     MOVE DP020-USERID              TO  CE005-USER-ID.            56180039
561900     MOVE ASC-CURR-OPER-UNT-ID-N    TO  CE005-CURR-OPER-UNT-ID-N. 56190039
562000     MOVE ASC-CURR-FCLTY-ID-N       TO  CE005-CURR-FCLTY-ID-N.    56200039
562100     MOVE ASC-CS-LOC-N              TO  CE005-CS-LOCATION.        56210039
562200     MOVE ASC-CS-PRINTER-ID         TO  CE005-CS-PRINTER-ID.      56220039
562300     MOVE ASC-PULL-NBR-N            TO  CE005-PULL-NBR.           56230039
562400     MOVE ASC-REF-NBR               TO  CE005-REF-NBR.            56240039
562500     MOVE LQW-LINE-NUMBER (LQW-IDX) TO  CE005-LNE-NBR.            56250039
562600     MOVE ASC-PULL-STATUS           TO  CE005-CURR-PULL-STATUS.   56260039
562700     MOVE LQW-LINE-STATUS-CDE (LQW-IDX)                           56270039
562800                                    TO  CE005-CURR-LINE-STATUS.   56280039
562900                                                                  56290039
563000     MOVE LENGTH OF CE005-INTER-APPL-COMMAREA                     56300039
563100                                    TO  PV-COMMAREA-LENGTH.       56310039
563200                                                                  56320039
563300     EXEC CICS                                                    56330039
563400          LINK                                                    56340039
563500              PROGRAM   (PC-CONFIRM-MODULE)                       56350039
563600              COMMAREA  (CE005-INTER-APPL-COMMAREA)               56360039
563700              RESP      (PV-CICS-RESPONSE)                        56370039
563800     END-EXEC.                                                    56380039
563900                                                                  56390039
564000     EVALUATE TRUE                                                56400039
564100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 56410039
564200              PERFORM 4820-VALIDATE-CONFIRM-CALL                  56420039
564300         WHEN OTHER                                               56430039
564400              EVALUATE TRUE                                       56440039
564500                  WHEN CE005-CNCL-ITEM                            56450039
564600                  WHEN CE005-UNCNCL-ITEM                          56460039
564700                       SET  PS-ERROR                              56470039
564800                            DP020-MSG-FATAL  TO TRUE              56480039
564900                            MOVE PC-TSYMSG-02269                  56490039
565000                                               TO DP020-MSG-NUMBER56500039
565100                  WHEN CE005-CNFM-DIST-ITEM                       56510039
565200                  WHEN CE005-UNCNFM-DIST-ITEM                     56520039
565300                       SET  PS-ERROR                              56530039
565400                            DP020-MSG-FATAL  TO TRUE              56540039
565500                            MOVE PC-TSYMSG-02270                  56550039
565600                                               TO DP020-MSG-NUMBER56560039
565700                  WHEN CE005-CNFM-ITEM                            56570039
565800                  WHEN CE005-UNCNFM-ITEM                          56580039
565900                       SET  PS-ERROR                              56590039
566000                            DP020-MSG-FATAL  TO TRUE              56600039
566100                       MOVE PC-TSYMSG-02271                       56610039
566200                                               TO DP020-MSG-NUMBER56620039
566300                                                                  56630039
566400                  WHEN CE005-POST-ITEM                            56640039
566500                  WHEN CE005-UNPOST-ITEM                          56650039
566600                       SET  PS-ERROR                              56660039
566700                            DP020-MSG-FATAL  TO TRUE              56670039
566800                       MOVE PC-TSYMSG-02568                       56680039
566900                                               TO DP020-MSG-NUMBER56690039
567000              END-EVALUATE                                        56700039
567100     END-EVALUATE.                                                56710039
567200                                                                  56720039
567300                                                                  56730039
567400     IF  PS-NO-ERROR                                              56740039
567500         IF LQW-ERR (LQW-IDX)                                     56750039
567600             CONTINUE                                             56760039
567700         ELSE                                                     56770039
567800             SET  LQW-DESELECT (LQW-IDX)                          56780039
567900                  LQW-UPD (LQW-IDX)        TO  TRUE               56790039
568000             SUBTRACT  1                                          56800039
568100                 FROM  ASC-NUMBER-OF-SELECTED-ITEMS               56810039
568200             MOVE LQW-SELECTED-SW (LQW-IDX)                       56820039
568300                  TO LQW-TEMP-SELECTED-SW (LQW-IDX)               56830039
568400         END-IF                                                   56840039
568500     END-IF.                                                      56850039
568600                                                                  56860039
568700     PERFORM 4825-GET-NEW-STATUS.                                 56870039
568800                                                                  56880039
568900                                                                  56890039
569000*----------------------------------------------------------------*56900039
569100* CHECK RETURN CODE FROM CNFM/CNCL PROGRAM TO SEE IF SUCCESSFUL  *56910039
569200*----------------------------------------------------------------*56920039
569300 4820-VALIDATE-CONFIRM-CALL.                                      56930039
569400                                                                  56940039
569500     EVALUATE TRUE                                                56950039
569600         WHEN CE005-FUNC-SUCCESSFUL                               56960039
569700              EVALUATE TRUE                                       56970039
569800                  WHEN CE005-CNCL-PULL                            56980039
569900                  WHEN CE005-UNCNCL-PULL                          56990039
570000                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      57000039
570100                       MOVE PC-TSYMSG-02274  TO DP020-MSG-NUMBER  57010039
570200                  WHEN CE005-CNFM-DIST-PULL                       57020039
570300                  WHEN CE005-UNCNFM-DIST-PULL                     57030039
570400                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      57040039
570500                       MOVE PC-TSYMSG-02275  TO DP020-MSG-NUMBER  57050039
570600                  WHEN CE005-CNFM-PULL                            57060039
570700                  WHEN CE005-UNCNFM-PULL                          57070039
570800                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      57080039
570900                       MOVE PC-TSYMSG-02276  TO DP020-MSG-NUMBER  57090039
571000                  WHEN CE005-POST-ITEM                            57100039
571100                  WHEN CE005-UNPOST-ITEM                          57110039
571200                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      57120039
571300                       MOVE PC-TSYMSG-02569  TO DP020-MSG-NUMBER  57130039
571400              END-EVALUATE                                        57140039
571500                                                                  57150039
571600         WHEN OTHER                                               57160039
571700                                                                  57170039
571800                                                                  57180039
571900              EVALUATE TRUE                                       57190039
572000                  WHEN CE005-RETURN-MSG = 'MQ SERIES ERROR'       57200039
572100                      SET  PS-ERROR                               57210039
572200                           DP020-MSG-FATAL  TO TRUE               57220039
572300                      MOVE PC-TSYMSG-02677  TO DP020-MSG-NUMBER   57230039
572400                  WHEN CE005-CNCL-PULL                            57240039
572500                  WHEN CE005-UNCNCL-PULL                          57250039
572600                       SET  PS-ERROR                              57260039
572700                            DP020-MSG-FATAL  TO TRUE              57270039
572800                       MOVE PC-TSYMSG-02269  TO DP020-MSG-NUMBER  57280039
572900                  WHEN CE005-CNFM-DIST-PULL                       57290039
573000                  WHEN CE005-UNCNFM-DIST-PULL                     57300039
573100                       SET  PS-ERROR                              57310039
573200                            DP020-MSG-FATAL  TO TRUE              57320039
573300                       MOVE PC-TSYMSG-02270  TO DP020-MSG-NUMBER  57330039
573400                  WHEN CE005-CNFM-PULL                            57340039
573500                  WHEN CE005-UNCNFM-PULL                          57350039
573600                       SET  PS-ERROR                              57360039
573700                            DP020-MSG-FATAL  TO TRUE              57370039
573800                       MOVE PC-TSYMSG-02271  TO DP020-MSG-NUMBER  57380039
573900                  WHEN CE005-POST-ITEM                            57390039
574000                  WHEN CE005-UNPOST-ITEM                          57400039
574100                       SET  PS-ERROR                              57410039
574200                            DP020-MSG-FATAL  TO TRUE              57420039
574300                       MOVE PC-TSYMSG-02568  TO DP020-MSG-NUMBER  57430039
574400                  WHEN CE005-UNCNCL-ITEM                          57440039
574500                       IF CE005-RETURN-MSG =                      57450039
574600                                      'UNITS ARE NOT AVAILABLE'   57460039
574700                           SET LQW-ERR (LQW-IDX) TO  TRUE         57470039
574800                           IF PS-FIRST-ERR-LINE-NOT-FOUND         57480039
574900                               SET PS-FIRST-ERR-LINE-FOUND TO TRUE57490039
575000                               MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)57500039
575100                                     TO PV-SAVE-ITEM-NUMBER       57510039
575200                           END-IF                                 57520039
575300                       END-IF                                     57530039
575400              END-EVALUATE                                        57540039
575500     END-EVALUATE.                                                57550039
575600                                                                  57560039
575700                                                                  57570039
575800*----------------------------------------------------------------*57580039
575900* GET NEW LINE STATUS AFTER CONFIRM ROUTINE IS COMPLETE          *57590039
576000*----------------------------------------------------------------*57600039
576100 4825-GET-NEW-STATUS.                                             57610039
576200     MOVE ASC-PULL-NBR              TO  DK-PULL-NUMBER.           57620039
576300     MOVE LQW-LINE-NUMBER (LQW-IDX) TO  DK-LINE-NUMBER.           57630039
576400                                                                  57640039
576500     PERFORM 4830-LINE-STATUS.                                    57650039
576600                                                                  57660039
576700     MOVE  PV-PULL-STATUS TO LQW-LINE-STATUS-CDE (LQW-IDX)        57670039
576800     EVALUATE  TRUE                                               57680039
576900         WHEN  PV-PULL-STATUS-NEW                                 57690039
577000               MOVE  PC-NEW-DESC                                  57700039
577100                         TO LQW-LINE-STATUS-DESC (LQW-IDX)        57710039
577200         WHEN  PV-PULL-STATUS-CANCELLED                           57720039
577300               MOVE  PC-PULL-STATUS-CANCELLED                     57730039
577400                         TO LQW-LINE-STATUS-DESC (LQW-IDX)        57740039
577500         WHEN  PV-PULL-STATUS-INPROCESS                           57750039
577600               MOVE  PC-IN-PROCESS-DESC                           57760039
577700                         TO LQW-LINE-STATUS-DESC (LQW-IDX)        57770039
577800         WHEN  PV-PULL-STATUS-DISTRIBTD                           57780039
577900               MOVE  PC-DISTRIB-DESC                              57790039
578000                         TO LQW-LINE-STATUS-DESC (LQW-IDX)        57800039
578100         WHEN  PV-PULL-STATUS-POSTED                              57810039
578200               MOVE  PC-POSTED-DESC                               57820039
578300                         TO LQW-LINE-STATUS-DESC (LQW-IDX)        57830039
578400     END-EVALUATE.                                                57840039
578500                                                                  57850039
578600                                                                  57860039
578700*----------------------------------------------------------------*57870039
578800*                                                                *57880039
578900*----------------------------------------------------------------*57890039
579000 4830-LINE-STATUS.                                                57900039
579100                                                                  57910039
579200     EXEC SQL                                                     57920039
579300          SELECT STAT_CDE                                         57930039
579400            INTO :PV-PULL-STATUS                                  57940039
579500            FROM TCEPLIT                                          57950039
579600           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             57960039
579700             AND PL_LNE_NBR        =  :DK-LINE-NUMBER             57970039
579800     END-EXEC.                                                    57980039
579900                                                                  57990039
580000     EVALUATE TRUE                                                58000039
580100         WHEN SQLCODE = +0                                        58010039
580200              CONTINUE                                            58020039
580300                                                                  58030039
580400         WHEN OTHER                                               58040039
580500              MOVE '4830-LINE-STATUS     '    TO DP013-PARAGRAPH  58050039
580600              MOVE 'GET NEW LINE STATUS AFTER CONFIRM ROUTINE'    58060039
580700                                       TO DP013-MESSAGE-TEXT (1)  58070039
580800              STRING ' PULL NBR-'    DELIMITED BY SIZE            58080039
580900                      ASC-PULL-NBR-N DELIMITED BY SIZE            58090039
581000                     ' LINE NBR-'    DELIMITED BY SIZE            58100039
581100                      LQW-LINE-NUMBER (LQW-IDX)                   58110039
581200                                     DELIMITED BY SIZE            58120039
581300                                     INTO DP013-MESSAGE-TEXT (2)  58130039
581400              MOVE SQLCA                      TO DP013-SQLCA      58140039
581500              MOVE 'TCEPLIT '        TO DP013-DB2-TABLE-NAME (1)  58150039
581600              SET  DP013-DB2-ABEND                                58160039
581700                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            58170039
581800              PERFORM DP013-0000-PROCESS-ABEND                    58180039
581900     END-EVALUATE.                                                58190039
582000                                                                  58200039
582100                                                                  58210039
582200*----------------------------------------------------------------*58220039
582300*                                                                *58230039
582400*----------------------------------------------------------------*58240039
582500 4840-GET-NEW-PULL-STATUS.                                        58250039
582600                                                                  58260039
582700     MOVE ASC-PULL-NBR              TO  DK-PULL-NUMBER.           58270039
582800                                                                  58280039
582900     EXEC SQL                                                     58290039
583000          SELECT STAT_CDE                                         58300039
583100            INTO :PV-PULL-STATUS                                  58310039
583200            FROM TCEPLRQ                                          58320039
583300           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             58330039
583400     END-EXEC.                                                    58340039
583500                                                                  58350039
583600     EVALUATE TRUE                                                58360039
583700         WHEN SQLCODE = +0                                        58370039
583800              MOVE  PV-PULL-STATUS TO ASC-PULL-STATUS             58380039
583900              CONTINUE                                            58390039
584000                                                                  58400039
584100         WHEN OTHER                                               58410039
584200              MOVE '4840-GET-NEW-PULL-STATUS' TO DP013-PARAGRAPH  58420039
584300              MOVE 'GET NEW PULL STATUS AFTER CONFIRM ROUTINE'    58430039
584400                                       TO DP013-MESSAGE-TEXT (1)  58440039
584500              STRING ' PULL NBR-'    DELIMITED BY SIZE            58450039
584600                      ASC-PULL-NBR-N DELIMITED BY SIZE            58460039
584700                     ' LINE NBR-'    DELIMITED BY SIZE            58470039
584800                      LQW-LINE-NUMBER (LQW-IDX)                   58480039
584900                                     DELIMITED BY SIZE            58490039
585000                                     INTO DP013-MESSAGE-TEXT (2)  58500039
585100              MOVE SQLCA                      TO DP013-SQLCA      58510039
585200              MOVE 'TCEPLRQ '        TO DP013-DB2-TABLE-NAME (1)  58520039
585300              SET  DP013-DB2-ABEND                                58530039
585400                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            58540039
585500              PERFORM DP013-0000-PROCESS-ABEND                    58550039
585600     END-EVALUATE.                                                58560039
585700                                                                  58570039
585800                                                                  58580039
585900*----------------------------------------------------------------*58590039
586000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *58600039
586100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *58610039
586200* FOR THE SELECTED ITEMS QUEUE.                                  *58620039
586300*                                                                *58630039
586400* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *58640039
586500* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *58650039
586600* THE ARRAY IS FULL.                                             *58660039
586700*----------------------------------------------------------------*58670039
586800                                                                  58680039
586900 5000-PREPARE-SEL-QUEUE.                                          58690039
587000                                                                  58700039
587100     MOVE +1                   TO  ASC-BLK-SUB.                   58710039
587200     PERFORM 5100-WRITE-TEMP-STORAGE.                             58720039
587300     ADD +1                    TO  ASC-BLK-SUB.                   58730039
587400     PERFORM 5100-WRITE-TEMP-STORAGE.                             58740039
587500                                                                  58750039
587600     MOVE ASC-SEL-QUEUE-NAME-2 TO  ASC-SEL-QUEUE-NAME.            58760039
587700     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          58770039
587800     PERFORM 6010-DELETE-SEL-QUEUE.                               58780039
587900                                                                  58790039
588000     SET ASC-UPDATE-TSQ        TO  TRUE.                          58800039
588100                                                                  58810039
588200     SET CE003-IDX             TO  1.                             58820039
588300     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       58830039
588400     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        58840039
588500                                                                  58850039
588600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           58860039
588700             VARYING PV-ITEM                                      58870039
588800             FROM 1 BY 1                                          58880039
588900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     58890039
589000                                                                  58900039
589100     IF  CE003-IDX > 1                                            58910039
589200         PERFORM 5205-WRITE-SEL-QUEUE                             58920039
589300         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        58930039
589400     END-IF.                                                      58940039
589500 EJECT                                                            58950039
589600*----------------------------------------------------------------*58960039
589700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *58970039
589800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *58980039
589900*----------------------------------------------------------------*58990039
590000                                                                  59000039
590100 5100-WRITE-TEMP-STORAGE.                                         59010039
590200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     59020039
590300                                   TO PV-LIST-ITEM-NUMBER.        59030039
590400     COMPUTE PV-BLOCK-NUMBER =                                    59040039
590500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    59050039
590600                                                                  59060039
590700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             59070039
590800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             59080039
590900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      59090039
591000             PERFORM 5105-REWRITE-ASC-LISTQ                       59100039
591100         END-IF                                                   59110039
591200     ELSE                                                         59120039
591300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       59130039
591400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            59140039
591500         PERFORM 5110-WRITE-ASC-LISTQ                             59150039
591600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   59160039
591700     END-IF.                                                      59170039
591800                                                                  59180039
591900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             59190039
592000******************************************************************59200039
592100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **59210039
592200** SPECIFIC COMMAREA.                                           **59220039
592300******************************************************************59230039
592400 5105-REWRITE-ASC-LISTQ.                                          59240039
592500     EXEC CICS                                                    59250039
592600         WRITEQ TS                                                59260039
592700             QUEUE (ASC-LIST-QUEUE-NAME)                          59270039
592800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               59280039
592900             ITEM  (PV-BLOCK-NUMBER)                              59290039
593000             REWRITE                                              59300039
593100             RESP  (PV-CICS-RESP)                                 59310039
593200     END-EXEC.                                                    59320039
593300                                                                  59330039
593400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           59340039
593500         CONTINUE                                                 59350039
593600     ELSE                                                         59360039
593700         SET DP013-CICS-ABEND            TO TRUE                  59370039
593800         SET DP013-NO-ROLLBACK           TO TRUE                  59380039
593900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       59390039
594000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     59400039
594100                                         TO DP013-MESSAGE-TEXT(1) 59410039
594200         PERFORM DP013-0000-PROCESS-ABEND                         59420039
594300     END-IF.                                                      59430039
594400                                                                  59440039
594500******************************************************************59450039
594600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **59460039
594700** SPECIFIC COMMAREA.                                           **59470039
594800******************************************************************59480039
594900 5110-WRITE-ASC-LISTQ.                                            59490039
595000     EXEC CICS                                                    59500039
595100         WRITEQ TS                                                59510039
595200             QUEUE (ASC-LIST-QUEUE-NAME)                          59520039
595300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               59530039
595400             ITEM  (PV-BLOCK-NUMBER)                              59540039
595500             RESP  (PV-CICS-RESP)                                 59550039
595600     END-EXEC.                                                    59560039
595700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      59570039
595800         SET DP013-CICS-ABEND      TO TRUE                        59580039
595900         SET DP013-NO-ROLLBACK     TO TRUE                        59590039
596000         MOVE '5110-WRITE-ASC-LISTQ'                              59600039
596100                                   TO DP013-PARAGRAPH             59610039
596200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           59620039
596300                                   TO DP013-MESSAGE-TEXT(1)       59630039
596400         PERFORM DP013-0000-PROCESS-ABEND                         59640039
596500     END-IF.                                                      59650039
596600 EJECT                                                            59660039
596700*----------------------------------------------------------------*59670039
596800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *59680039
596900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *59690039
597000*----------------------------------------------------------------*59700039
597100                                                                  59710039
597200 5200-FILL-SEL-QUEUE-RECORD.                                      59720039
597300                                                                  59730039
597400     PERFORM 6112-READ-LIST-QUEUE.                                59740039
597500                                                                  59750039
597600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       59760039
597700         PERFORM                                                  59770039
597800         VARYING LQW-IDX                                          59780039
597900         FROM 1 BY 1                                              59790039
598000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            59800039
598100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          59810039
598200                                                                  59820039
598300             IF  LQW-SELECT (LQW-IDX)                             59830039
598400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              59840039
598500                                   TO CE003-ITEM (CE003-IDX)      59850039
598600                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 59860039
598700                                                                  59870039
598800                 MOVE ASC-PULL-NBR TO  CE003-PULL-NUMBER          59880039
598900                                        (CE003-IDX)               59890039
599000                 MOVE ASC-REF-NBR  TO  CE003-REF-NUMBER           59900039
599100                                        (CE003-IDX)               59910039
599200                 MOVE ASC-CS-LOC   TO  CE003-CS-LOCATION          59920039
599300                                        (CE003-IDX)               59930039
599400                 MOVE ZEROES       TO  CE003-CREATE-DATE          59940039
599500                                        (CE003-IDX)               59950039
599600                 MOVE ASC-PULL-STATUS                             59960039
599700                                   TO  CE003-PULL-STATUS-CDE      59970039
599800                                        (CE003-IDX)               59980039
599900                 MOVE ASC-PULL-TYPE                               59990039
600000                                   TO  CE003-PULL-SOURCE-CDE      60000039
600100                                        (CE003-IDX)               60010039
600200                 MOVE ZEROES       TO  CE003-NBR-ITEMS            60020039
600300                                        (CE003-IDX)               60030039
600400                 MOVE LQW-NBR-STORES (LQW-IDX)                    60040039
600500                                   TO  CE003-NBR-STORES           60050039
600600                                        (CE003-IDX)               60060039
600700                 MOVE LQW-REQ-PULL-UNITS (LQW-IDX)                60070039
600800                                   TO  CE003-REQ-PULL-UNITS       60080039
600900                                        (CE003-IDX)               60090039
601000                 MOVE LQW-ACT-PULL-UNITS (LQW-IDX)                60100039
601100                                   TO  CE003-ACT-PULL-UNITS       60110039
601200                                        (CE003-IDX)               60120039
601300                 MOVE LQW-DISTRBUTED-UNITS (LQW-IDX)              60130039
601400                                   TO  CE003-DIST-PULL-UNITS      60140039
601500                                        (CE003-IDX)               60150039
601600                 MOVE LQW-LINE-STATUS-CDE (LQW-IDX)               60160039
601700                                   TO  CE003-LINE-STATUS-CDE      60170039
601800                                        (CE003-IDX)               60180039
601900                 MOVE LQW-SKU-NUMBER (LQW-IDX)                    60190039
602000                                   TO  CE003-LINE-SKU             60200039
602100                                        (CE003-IDX)               60210039
602200                 MOVE LQW-LINE-SKU-RETAIL (LQW-IDX)               60220039
602300                                   TO  CE003-LINE-SKU-RETAIL      60230039
602400                                        (CE003-IDX)               60240039
602500                 MOVE LQW-LINE-ITEM (LQW-IDX)                     60250039
602600                                   TO  CE003-LINE-ITEM            60260039
602700                                        (CE003-IDX)               60270039
602800                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   60280039
602900                                   TO  CE003-LINE-NUMBER          60290039
603000                                        (CE003-IDX)               60300039
603100                 MOVE LQW-TOT-MNFST-UNITS (LQW-IDX)               60310039
603200                                   TO  CE003-TOT-MNFST-UNTS       60320039
603300                                        (CE003-IDX)               60330039
603400                 MOVE LQW-TOT-ADJ-UNITS   (LQW-IDX)               60340039
603500                                   TO  CE003-TOT-ADJ-UNTS         60350039
603600                                        (CE003-IDX)               60360039
603700                 MOVE LQW-TOT-DSTRB-UNITS (LQW-IDX)               60370039
603800                                   TO  CE003-TOT-DSTRB-UNTS       60380039
603900                                        (CE003-IDX)               60390039
604000                                                                  60400039
604100                 SET CE003-IDX UP BY 1                            60410039
604200                 IF  CE003-IDX > CE003-MAX-ITEMS                  60420039
604300                     PERFORM 5205-WRITE-SEL-QUEUE                 60430039
604400                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    60440039
604500                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         60450039
604600                     SET CE003-IDX TO  1                          60460039
604700                 END-IF                                           60470039
604800             END-IF                                               60480039
604900         END-PERFORM                                              60490039
605000     END-IF.                                                      60500039
605100                                                                  60510039
605200*----------------------------------------------------------------*60520039
605300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *60530039
605400*----------------------------------------------------------------*60540039
605500                                                                  60550039
605600 5205-WRITE-SEL-QUEUE.                                            60560039
605700                                                                  60570039
605800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            60580039
605900                                   TO CE003-SELECTED-ITEMS.       60590039
606000                                                                  60600039
606100     EXEC CICS                                                    60610039
606200          WRITEQ TS                                               60620039
606300              QUEUE (ASC-SEL-QUEUE-NAME)                          60630039
606400              FROM  (CE003-SELECT-RECORD)                         60640039
606500              ITEM  (PV-SEL-QUEUE-ITEM)                           60650039
606600              RESP  (PV-CICS-RESP)                                60660039
606700     END-EXEC.                                                    60670039
606800                                                                  60680039
606900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          60690039
607000         CONTINUE                                                 60700039
607100     ELSE                                                         60710039
607200         SET DP013-CICS-ABEND      TO TRUE                        60720039
607300         SET DP013-NO-ROLLBACK     TO TRUE                        60730039
607400         MOVE '5205-WRITE-SEL-QUEUE'                              60740039
607500                                   TO DP013-PARAGRAPH             60750039
607600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          60760039
607700                                   TO DP013-MESSAGE-TEXT(1)       60770039
607800         PERFORM DP013-0000-PROCESS-ABEND                         60780039
607900     END-IF.                                                      60790039
608000 EJECT                                                            60800039
608100******************************************************************60810039
608200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **60820039
608300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **60830039
608400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **60840039
608500** THE USER.                                                    **60850039
608600******************************************************************60860039
608700 6000-REFRESH-PANEL-FROM-TEMP.                                    60870039
608800     IF  ASC-UPDATE-TSQ                                           60880039
608900         SET ASC-NO-TSQ-UPDATE TO TRUE                            60890039
609000         MOVE ZERO                 TO PV-SAVE-ITEM                60900039
609100                                      PV-SEL-QUEUE-ITEM           60910039
609200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        60920039
609300                                   TO PV-HOLD-SELECTED-ITEMS      60930039
609400         MOVE +1                   TO PV-ITEMS-PROCESSED          60940039
609500         PERFORM 6100-UPDATE-TSQ                                  60950039
609600             UNTIL PV-ITEMS-PROCESSED >                           60960039
609700                                     PV-HOLD-SELECTED-ITEMS       60970039
609800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         60980039
609900                    ASC-BLOCK-ENTRIES (2)                         60990039
610000     END-IF.                                                      61000039
610100                                                                  61010039
610200*----------------------------------------------------------------*61020039
610300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *61030039
610400*----------------------------------------------------------------*61040039
610500 6010-DELETE-SEL-QUEUE.                                           61050039
610600                                                                  61060039
610700     EXEC CICS                                                    61070039
610800         DELETEQ TS                                               61080039
610900             QUEUE (ASC-SEL-QUEUE-NAME)                           61090039
611000             RESP  (PV-CICS-RESP)                                 61100039
611100     END-EXEC.                                                    61110039
611200*                                                                 61120039
611300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      61130039
611400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         61140039
611500         CONTINUE                                                 61150039
611600     ELSE                                                         61160039
611700         SET DP013-CICS-ABEND TO TRUE                             61170039
611800         SET DP013-NO-ROLLBACK TO TRUE                            61180039
611900         MOVE '6010-DELETE-SEL-QUEUE'                             61190039
612000                        TO DP013-PARAGRAPH                        61200039
612100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         61210039
612200                        TO DP013-MESSAGE-TEXT (1)                 61220039
612300         PERFORM DP013-0000-PROCESS-ABEND                         61230039
612400     END-IF.                                                      61240039
612500                                                                  61250039
612600*----------------------------------------------------------------*61260039
612700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *61270039
612800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *61280039
612900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *61290039
613000*    THE TEMP QUEUE.                                             *61300039
613100*----------------------------------------------------------------*61310039
613200                                                                  61320039
613300 6100-UPDATE-TSQ.                                                 61330039
613400                                                                  61340039
613500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             61350039
613600     PERFORM 6105-READ-SEL-QUEUE.                                 61360039
613700     PERFORM                                                      61370039
613800         VARYING CE003-IDX                                        61380039
613900         FROM 1 BY 1                                              61390039
614000         UNTIL ((PV-ITEMS-PROCESSED >                             61400039
614100                              PV-HOLD-SELECTED-ITEMS)             61410039
614200         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             61420039
614300         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  61430039
614400             PERFORM 6110-PROCESS-ITEMS                           61440039
614500         END-IF                                                   61450039
614600         ADD +1                TO PV-ITEMS-PROCESSED              61460039
614700     END-PERFORM.                                                 61470039
614800     PERFORM 6111-WRITE-LIST-QUEUE.                               61480039
614900*----------------------------------------------------------------*61490039
615000*    READ THE LIST QUEUE RECORD.                                 *61500039
615100*----------------------------------------------------------------*61510039
615200                                                                  61520039
615300 6105-READ-SEL-QUEUE.                                             61530039
615400                                                                  61540039
615500     EXEC CICS                                                    61550039
615600          READQ TS                                                61560039
615700              QUEUE (ASC-SEL-QUEUE-NAME)                          61570039
615800              INTO  (CE003-SELECT-RECORD)                         61580039
615900              ITEM  (PV-SEL-QUEUE-ITEM)                           61590039
616000              RESP  (PV-CICS-RESP)                                61600039
616100     END-EXEC.                                                    61610039
616200*                                                                 61620039
616300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          61630039
616400         CONTINUE                                                 61640039
616500     ELSE                                                         61650039
616600         SET DP013-CICS-ABEND      TO  TRUE                       61660039
616700         SET DP013-NO-ROLLBACK     TO  TRUE                       61670039
616800         MOVE '6105-READ-SEL-QUEUE'                               61680039
616900                                   TO  DP013-PARAGRAPH            61690039
617000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           61700039
617100                                   TO  DP013-MESSAGE-TEXT(1)      61710039
617200         PERFORM DP013-0000-PROCESS-ABEND                         61720039
617300     END-IF.                                                      61730039
617400 EJECT                                                            61740039
617500*----------------------------------------------------------------*61750039
617600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*61760039
617700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*61770039
617800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *61780039
617900*----------------------------------------------------------------*61790039
618000                                                                  61800039
618100 6110-PROCESS-ITEMS.                                              61810039
618200                                                                  61820039
618300     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          61830039
618400                     / PC-ITEMS-PER-PANEL).                       61840039
618500                                                                  61850039
618600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           61860039
618700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          61870039
618800             PERFORM 6111-WRITE-LIST-QUEUE                        61880039
618900         END-IF                                                   61890039
619000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    61900039
619100                                                                  61910039
619200         PERFORM 6112-READ-LIST-QUEUE                             61920039
619300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               61930039
619400             CONTINUE                                             61940039
619500         END-IF                                                   61950039
619600     END-IF.                                                      61960039
619700                                                                  61970039
619800     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     61980039
619900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              61990039
620000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         62000039
620100     MOVE LQW-SELECTED-SW (PV-SUB)                                62010039
620200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  62020039
620300     EVALUATE TRUE                                                62030039
620400         WHEN CE003-INQ (CE003-IDX)                               62040039
620500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             62050039
620600                                                                  62060039
620700         WHEN CE003-UPD (CE003-IDX)                               62070039
620800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             62080039
620900                                                                  62090039
621000         WHEN CE003-DEL (CE003-IDX)                               62100039
621100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             62110039
621200                                                                  62120039
621300         WHEN CE003-ERR (CE003-IDX)                               62130039
621400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             62140039
621500     END-EVALUATE.                                                62150039
621600                                                                  62160039
621700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                62170039
621800                                                                  62180039
621900*----------------------------------------------------------------*62190039
622000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *62200039
622100*----------------------------------------------------------------*62210039
622200                                                                  62220039
622300 6111-WRITE-LIST-QUEUE.                                           62230039
622400                                                                  62240039
622500     EXEC CICS                                                    62250039
622600         WRITEQ TS                                                62260039
622700             QUEUE (ASC-LIST-QUEUE-NAME)                          62270039
622800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     62280039
622900             ITEM  (PV-SAVE-ITEM)                                 62290039
623000             REWRITE                                              62300039
623100             RESP  (PV-CICS-RESP)                                 62310039
623200     END-EXEC.                                                    62320039
623300*                                                                 62330039
623400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          62340039
623500         CONTINUE                                                 62350039
623600     ELSE                                                         62360039
623700         SET DP013-CICS-ABEND  TO  TRUE                           62370039
623800         SET DP013-NO-ROLLBACK TO  TRUE                           62380039
623900         MOVE '6111-WRITE-LIST-QUEUE'                             62390039
624000                               TO  DP013-PARAGRAPH                62400039
624100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  62410039
624200                               TO  DP013-MESSAGE-TEXT(1)          62420039
624300         PERFORM DP013-0000-PROCESS-ABEND                         62430039
624400     END-IF.                                                      62440039
624500                                                                  62450039
624600 EJECT                                                            62460039
624700*----------------------------------------------------------------*62470039
624800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*62480039
624900*----------------------------------------------------------------*62490039
625000                                                                  62500039
625100 6112-READ-LIST-QUEUE.                                            62510039
625200                                                                  62520039
625300     EXEC CICS                                                    62530039
625400         READQ TS                                                 62540039
625500             QUEUE (ASC-LIST-QUEUE-NAME)                          62550039
625600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     62560039
625700             ITEM  (PV-ITEM)                                      62570039
625800             RESP  (PV-CICS-RESP)                                 62580039
625900     END-EXEC.                                                    62590039
626000*                                                                 62600039
626100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          62610039
626200         CONTINUE                                                 62620039
626300     ELSE                                                         62630039
626400         SET DP013-CICS-ABEND        TO TRUE                      62640039
626500         SET DP013-NO-ROLLBACK       TO TRUE                      62650039
626600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           62660039
626700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    62670039
626800                                     TO DP013-MESSAGE-TEXT(1)     62680039
626900         PERFORM DP013-0000-PROCESS-ABEND                         62690039
627000     END-IF.                                                      62700039
627100                                                                  62710039
627200                                                                  62720039
627300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 62730039
627400* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *62740039
627500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 62750039
627600 9100-READ-SEL-QUEUE.                                             62760039
627700     EXEC CICS                                                    62770039
627800         READQ TS                                                 62780039
627900             QUEUE (ASC-SEL-QUEUE-NAME)                           62790039
628000             INTO  (CE003-SELECT-RECORD)                          62800039
628100             ITEM  (ASC-SEL-ITEM)                                 62810039
628200             RESP  (PV-CICS-RESP)                                 62820039
628300     END-EXEC.                                                    62830039
628400     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        62840039
628500         CONTINUE                                                 62850039
628600     ELSE                                                         62860039
628700         SET DP013-LOGIC-ABEND                                    62870039
628800             DP013-NO-ROLLBACK   TO   TRUE                        62880039
628900         MOVE '9100-READ-SEL-QUEUE'                               62890039
629000                                 TO   DP013-PARAGRAPH             62900039
629100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   62910039
629200                                 TO   DP013-MESSAGE-TEXT (1)      62920039
629300         PERFORM DP013-0000-PROCESS-ABEND                         62930039
629400     END-IF.                                                      62940039
629500                                                                  62950039
629600                                                                  62960039
629700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*62970039
629800* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *62980039
629900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 62990039
630000 9200-REWRITE-SEL-QUEUE.                                          63000039
630100                                                                  63010039
630200     EXEC CICS                                                    63020039
630300          WRITEQ TS                                               63030039
630400              QUEUE  (ASC-SEL-QUEUE-NAME)                         63040039
630500              FROM   (CE003-SELECT-RECORD)                        63050039
630600              ITEM   (ASC-SEL-ITEM)                               63060039
630700              RESP   (PV-CICS-RESP)                               63070039
630800              REWRITE                                             63080039
630900     END-EXEC.                                                    63090039
631000                                                                  63100039
631100     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   63110039
631200         SET DP013-CICS-ABEND                                     63120039
631300             DP013-NO-ROLLBACK     TO TRUE                        63130039
631400         MOVE '9200-REWRITE-SEL-QUEUE'                            63140039
631500                                   TO DP013-PARAGRAPH             63150039
631600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   63160039
631700                                   TO DP013-MESSAGE-TEXT (1)      63170039
631800         PERFORM DP013-0000-PROCESS-ABEND                         63180039
631900     END-IF.                                                      63190039
632000                                                                  63200039
632100                                                                  63210039
632200*----------------------------------------------------------------*63220039
632300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *63230039
632400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *63240039
632500*----------------------------------------------------------------*63250039
632600 9900-SOFT-ABORT.                                                 63260039
632700                                                                  63270039
632800     EXEC CICS SYNCPOINT                                          63280039
632900          ROLLBACK                                                63290039
633000     END-EXEC.                                                    63300039
633100                                                                  63310039
633200     SET  PS-ERROR                                                63320039
633300          PS-SOFT-ABORT-ERROR                                     63330039
633400          DP020-MSG-FATAL       TO  TRUE.                         63340039
633500                                                                  63350039
633600                                                                  63360039
633700                                                                  63370039
633800*----------------------------------------------------------------*63380039
633900*    ABEND PROCESSOR MODULE                                      *63390039
634000*----------------------------------------------------------------*63400039
634100                                                                  63410039
634200     COPY DPPD013.                                                63420039
