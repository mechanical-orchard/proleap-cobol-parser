000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    PCKUT072.                                         00020000
000300 AUTHOR.        JEAN KURKOWSKI.                                   00030000
000400                                                                  00040000
000500******************************************************************00050000
000600* TO BE USED TO TAKE PACK-TO-LIGHT BUSINESS EVENT FOR A           00060000
000700* PICK-MADE AND WRITE THE INFORMATION OUT TO THE EAI BUSINESS     00070000
000800* EVENT EXPORT TABLES                                             00080000
000900*                                                                 00090000
001000* THIS PROGRAM WAS CONVERTED FROM PCKCS762 AND CHGD TO BATCH      00100000
001100*                                                                 00110000
001200******************************************************************00120000
001300******************************************************************00130000
001400*** RLK - CHG0055296 - CHECK FOR RFID                             00140001
001500* 04/18/2013  CHERI PARMLEY        CHG0055296                    *00150001
001600*             ADD LOGIC TO ALLOW RFID CHECK TO BE TURNED ON/OFF  *00160001
001700*             USING PARM ON TKRPRPM TABLE.                       *00170001
001800*             ADD LOGIC TO CHECK SWITCHES RETURNED FROM RFID     *00180001
001900*             DETERMINATION PROGRAM (SUKUT149) TO CHECK IF       *00190001
001910*             DIRECTIVES ARE NEEDED BASED ON WHETHER             *00191001
001920*             ALL OF THE FOLLOWING SWITCHES ARE SET BY SUKUT149: *00192001
001930*             SU093-RFID-YES                                     *00193001
001940*             SU093-DPT-STR-P2L-FIRST-YES                        *00194001
001950*             SU093-RFID-KOHL-DPT-IN-STR-YES                     *00195001
001960*             SU093-VNDR-DPT-RFID-COMPLI-NO                      *00196001
001970*             TO CALL SUKUT149 THE FOLLOWING SWITCHES MUST BE SET*00197001
001980*             SU093-CHECK-BY-DEPT-SUBCLS-YES                     *00198001
001990*             SU093-CHECK-BY-DEPT-IN-STR-YES                     *00199001
001991*             SU093-RFID-STR-CHK-NEEDED-NO                       *00199101
001992*             SU093-CHECK-BY-DC                                  *00199201
001993*             SU093-RFID-NO                                      *00199301
001994*             AND THE FOLLOWING KEY VALUES MUST BE SET:          *00199401
001995*             SU093-KEY-PO                                       *00199501
001996*             SU093-KEY-REC-SEQ-NBR                              *00199601
001997*             SU093-KEY-LNE-NBR                                  *00199701
001998*             SU093-KEY-OPER-UNT-ID                              *00199801
001999*             SU093-KEY-DEST-LOC                                 *00199901
002000*             SU093-KEY-CARTON-ID                                *00200001
002001*                                                                *00200101
002002******************************************************************00200201
002003*** RLK - CHG0055296 - CHECK FOR RFID                             00200301
002004                                                                  00200400
002005 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00200500
002006 DATE-WRITTEN.  JULY 2007.                                        00200600
002007 DATE-COMPILED.                                                   00200700
002008                                                                  00200800
002009 ENVIRONMENT DIVISION.                                            00200900
002010 CONFIGURATION SECTION.                                           00201000
002020 SOURCE-COMPUTER. IBM-3090.                                       00202000
002030 OBJECT-COMPUTER. IBM-3090.                                       00203000
002040                                                                  00204000
002050 DATA DIVISION.                                                   00205000
002060 WORKING-STORAGE SECTION.                                         00206000
002070                                                                  00207000
002080 01  PS-SWITCHES.                                                 00208000
002090     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00209000
002100         88  PS-ERROR-YES                       VALUE 'Y'.        00210000
002200         88  PS-ERROR-NO                        VALUE 'N'.        00220000
002300     05  PS-P4-INTERFACE-SW           PIC X(01) VALUE 'N'.        00230000
002400         88  PS-P4-INTERFACE-YES                VALUE 'Y'.        00240000
002500         88  PS-P4-INTERFACE-NO                 VALUE 'N'.        00250000
002600     05  PS-USER-FOUND-SW             PIC X(01) VALUE 'N'.        00260000
002700         88  PS-USER-FOUND-YES                  VALUE 'Y'.        00270000
002800         88  PS-USER-FOUND-NO                   VALUE 'N'.        00280000
002900     05  PS-PICK-FROM-WORKSTATION-SW  PIC X(01) VALUE 'N'.        00290000
003000         88  PS-PICK-FROM-WORKSTATION           VALUE 'Y'.        00300000
003100         88  PS-PICK-FROM-WORKSTATION-NO        VALUE 'N'.        00310000
003200     05  PS-LOG-RFID-TUPLDER-SW       PIC X(01) VALUE 'N'.        00320000
003300         88  PS-LOG-RFID-TUPLDER-YES            VALUE 'Y'.        00330000
003400         88  PS-LOG-RFID-TUPLDER-NO             VALUE 'N'.        00340000
003500     05  PS-RFID-CHECK-SW             PIC X(01) VALUE 'N'.        00350000
003600         88  PS-RFID-CHECK-YES                  VALUE 'Y'.        00360000
003700         88  PS-RFID-CHECK-NO                   VALUE 'N'.        00370000
003800                                                                  00380000
003900 01  DA-KEYS.                                                     00390000
004000     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00400000
004100     05  DK-MODU-NBR                  PIC S9(04) COMP.            00410000
004200                                                                  00420000
004300 01  PV-PROGRAM-VARIABLES.                                        00430000
004400     05  PV-DISP-OPER                 PIC 9(04)   VALUE ZEROES.   00440000
004500     05  PV-DISP-PO                   PIC 9(09)   VALUE ZEROES.   00450000
004600     05  PV-DISP-RCVR                 PIC 9(04)   VALUE ZEROES.   00460000
004700     05  PV-DISP-LINE                 PIC 9(04)   VALUE ZEROES.   00470000
004800     05  PV-DISP-DEST                 PIC 9(05)   VALUE ZEROES.   00480000
004900     05  PV-DISP-SML                  PIC 9(18)   VALUE ZEROES.   00490000
005000     05  PV-DISP-SQL                  PIC -999    VALUE ZEROES.   00500000
005100     05  PV-DIRECTIVE-NEEDED-SW       PIC X       VALUE 'N'.      00510000
005200       88  PV-DIRECTIVE-NEEDED-NO                 VALUE 'N'.      00520000
005300       88  PV-DIRECTIVE-NEEDED-YES                VALUE 'Y'.      00530000
005400                                                                  00540000
005500     05  PV-PICKER-ID                 PIC X(08)   VALUE SPACES.   00550000
005600     05  PV-PICK-MADE-TM.                                         00560000
005700         10  PV-PICK-BYTE OCCURS 25   PIC X(01).                  00570000
005800     05  PV-PLACE-PTR                 PIC S9(03) COMP-3.          00580000
005900     05  PV-SUB                       PIC S9(03) COMP-3.          00590000
006000     05  PV-HOLD-TWO                  PIC X(02).                  00600000
006100     05  PV-HOLD-FOUR                 PIC X(04).                  00610000
006200     05  PV-HOLD-PTR                  PIC S9(03) COMP-3.          00620000
006300     05  PV-START-TIMESTAMP.                                      00630000
006400         10 PV-START-DATE.                                        00640000
006500             15 PV-START-CCYY         PIC X(04).                  00650000
006600             15 FILLER                PIC X(01) VALUE '-'.        00660000
006700             15 PV-START-MM           PIC X(02).                  00670000
006800             15 FILLER                PIC X(01) VALUE '-'.        00680000
006900             15 PV-START-DD           PIC X(02).                  00690000
007000         10 PV-START-TIME.                                        00700000
007100             15 FILLER                PIC X(01) VALUE '-'.        00710000
007200             15 PV-START-HOUR.                                    00720000
007300                 20 PV-START-HOUR-N   PIC 9(02).                  00730000
007400             15 FILLER                PIC X(01) VALUE '.'.        00740000
007500             15 PV-START-MIN          PIC X(02).                  00750000
007600             15 FILLER                PIC X(01) VALUE '.'.        00760000
007700             15 PV-START-SEC          PIC X(02).                  00770000
007800             15 FILLER                PIC X(01) VALUE '.'.        00780000
007900             15 FILLER                PIC X(06) VALUE ZERO.       00790000
008000                                                                  00800000
008100     05  PV-HOLD-LOCATION             PIC X(10).                  00810000
008200     05  PV-LENGTH                    PIC S9(03) COMP-3.          00820000
008300     05  PV-DUMMY                     PIC S9(03) COMP-3           00830000
008400                                          VALUE ZERO.             00840000
008500                                                                  00850000
008600     05  PV-LABOR-ASGMT-STRT-DTE      PIC X(10) VALUE SPACES.     00860000
008700     05  PV-LABOR-ASGMT-NBR-TXT       PIC X(10) VALUE SPACES.     00870000
008800     05  PV-LABOR-ASGMT-NBR-SEQ-NBR   PIC S9(09) COMP VALUE ZERO. 00880000
008900     05  PV-LABOR-SEQ-START-NBR       PIC S9(09) COMP VALUE ZERO. 00890000
009000                                                                  00900000
009100     05  PV-CURRENT-TIME.                                         00910000
009200         10  PV-CURRENT-HOUR          PIC 99.                     00920000
009300         10  PV-CURRENT-MINUTE        PIC 99.                     00930000
009400         10  PV-CURRENT-SECOND        PIC 99.                     00940000
009500         10  PV-CURRENT-HUNDRETH      PIC 99.                     00950000
009600                                                                  00960000
009700     05  PV-FORMAT-TIME.                                          00970000
009800         10  PV-FORMAT-HH             PIC 99.                     00980000
009900         10  FILLER                   PIC X(01) VALUE ':'.        00990000
010000         10  PV-FORMAT-MM             PIC 99.                     01000000
010100         10  FILLER                   PIC X(01) VALUE ':'.        01010000
010200         10  PV-FORMAT-SS             PIC 99.                     01020000
010300         10  FILLER                   PIC X(01) VALUE ':'.        01030000
010400         10  PV-FORMAT-HUND           PIC 99.                     01040000
010500     05  PV-LOG-MSG                   PIC X(100) VALUE SPACES.    01050000
010600     05  PV-PC243-RECORD.                                         01060000
010700         10  PV-PC243-1-100           PIC X(100) VALUE SPACES.    01070000
010800         10  PV-PC243-2-200           PIC X(100) VALUE SPACES.    01080000
010900                                                                  01090000
011000 01  PV-ERROR-MSG.                                                01100000
011100     05  FILLER                       PIC X(12)                   01110000
011200         VALUE ' PCKUT072 '.                                      01120000
011300     05  PV-ERROR-TIME                PIC X(11).                  01130000
011400     05  FILLER                       PIC X(06)                   01140000
011500                                           VALUE ' PARA-'.        01150000
011600     05  PV-ERROR-PARA                PIC X(05) VALUE SPACES.     01160000
011700     05  FILLER                       PIC X(02) VALUE SPACES.     01170000
011800     05  PV-ERROR-TEXT                PIC X(100) VALUE SPACES.    01180000
011900                                                                  01190000
012000     05  PV-DISP-SQLCODE              PIC 999-     VALUE ZEROS.   01200000
012100     05  PV-DISP-SQLCODE-2            PIC 999-     VALUE ZEROS.   01210000
012200     05  PV-DISP-SQLCODE-3            PIC 999-    VALUE ZEROES.   01220000
012300     05  PV-DISP-SQLCODE-4            PIC 999-    VALUE ZEROES.   01230000
012400     05  PV-DISP-SQLCODE-5            PIC 999-    VALUE ZEROES.   01240000
012500     05  PV-DISP-INNER-PK-IND         PIC 999-     VALUE ZEROS.   01250000
012600     05  PV-DISP-INNER-PK-QTY         PIC 99999-   VALUE ZEROS.   01260000
012700     05  PV-DISP-EXP-PICK-ORD-QTY     PIC 99999-   VALUE ZEROS.   01270000
012800     05  PV-DISP-PICKED-QTY           PIC 99999-   VALUE ZEROS.   01280000
012900     05  PV-DISP-TOTAL-PICKED-QTY     PIC 99999-   VALUE ZEROS.   01290000
013000     05  PV-EXP-PICK-QTY              PIC S9(4) COMP-3            01300000
013100                                          VALUE ZERO.             01310000
013200     05  PV-PICKED-QTY                PIC S9(4) COMP-3            01320000
013300                                          VALUE ZERO.             01330000
013400     05  PV-TOTAL-PICKED-QTY          PIC S9(4) COMP-3            01340000
013500                                          VALUE ZERO.             01350000
013600                                                                  01360000
013700 01  PV-KEY-MSGS.                                                 01370000
013800     05  PV-OPER-TEXT.                                            01380000
013900         10  FILLER                   PIC X(06)                   01390000
014000             VALUE ' LOC= '.                                      01400000
014100         10  PV-MSG-OPER              PIC 9(04).                  01410000
014200                                                                  01420000
014300     05  PV-MODU-TEXT.                                            01430000
014400         10  FILLER                   PIC X(05)                   01440000
014500             VALUE ' DC= '.                                       01450000
014600         10  PV-MSG-MODU-DC           PIC 9(04).                  01460000
014700         10  FILLER                   PIC X(07)                   01470000
014800             VALUE ' MODU= '.                                     01480000
014900         10  PV-MSG-MODU              PIC 9(02).                  01490000
015000                                                                  01500000
015100     05  PV-DLKUT410-TEXT1.                                       01510000
015200         10  FILLER                   PIC X(07)                   01520000
015300             VALUE ' USER= '.                                     01530000
015400         10  PV-DLKUT410-USER         PIC X(08).                  01540000
015500                                                                  01550000
015600         10  FILLER                   PIC X(08)                   01560000
015700             VALUE ' WKTYP= '.                                    01570000
015800         10  PV-DLKUT410-WK-TYP       PIC X(15).                  01580000
015900                                                                  01590000
016000         10  FILLER                   PIC X(13)                   01600000
016100             VALUE ' WKTYP DESC= '.                               01610000
016200         10  PV-DLKUT410-WK-TYP-DESC  PIC X(15).                  01620000
016300                                                                  01630000
016400     05  PV-DLKUT410-TEXT2.                                       01640000
016500                                                                  01650000
016600         10  FILLER                   PIC X(09)                   01660000
016700             VALUE ' WKAREA= '.                                   01670000
016800         10  PV-DLKUT410-WK-AREA-DESC PIC X(20).                  01680000
016900                                                                  01690000
017000         10  FILLER                   PIC X(08)                   01700000
017100             VALUE ' DC=  '.                                      01710000
017200         10  PV-DLKUT410-DC-NBR       PIC 9(04).                  01720000
017300                                                                  01730000
017400         10  FILLER                   PIC X(10)                   01740000
017500             VALUE ' CRE USER='.                                  01750000
017600         10  PV-DLKUT410-CRE-USERID   PIC X(08).                  01760000
017700                                                                  01770000
017800         10  FILLER                   PIC X(10)                   01780000
017900             VALUE ' USER TYP='.                                  01790000
018000         10  PV-DLKUT410-USER-TYP     PIC X(01).                  01800000
018100                                                                  01810000
018200                                                                  01820000
018300     05  PV-XLKUP046-TEXT1.                                       01830000
018400         10  FILLER                   PIC X(07)                   01840000
018500             VALUE ' USER= '.                                     01850000
018600         10  PV-XLKUP046-USER         PIC X(08).                  01860000
018700                                                                  01870000
018800         10  FILLER                   PIC X(10)                   01880000
018900             VALUE ' OBJ TXT= '.                                  01890000
019000         10  PV-XLKUP046-OBJTXT       PIC X(40).                  01900000
019100                                                                  01910000
019200     05  PV-XLKUP046-TEXT2.                                       01920000
019300         10  FILLER                   PIC X(15)                   01930000
019400             VALUE ' OBJ ACTN TXT= '.                             01940000
019500         10  PV-XLKUP046-OBJACTNTXT   PIC X(40).                  01950000
019600                                                                  01960000
019700     05  PV-PCWS243-TEXT.                                         01970000
019800         10  FILLER                   PIC X(09)                   01980000
019900             VALUE ' PCWS243 '.                                   01990000
020000         10  FILLER                   PIC X(08)                   02000000
020100             VALUE 'FIELDS= '.                                    02010000
020200         10  PV-PCWS23-FIELDS                                     02020000
020300                                      PIC X(63).                  02030000
020400                                                                  02040000
020500     05  PV-XLKUT067-TEXT.                                        02050000
020600         10  FILLER                   PIC X(09)                   02060000
020700             VALUE ' PICKER= '.                                   02070000
020800         10  PV-XLKUT067-USERID       PIC X(10).                  02080000
020900         10  FILLER                   PIC X(16)                   02090000
021000             VALUE ' RETURN FIELDS= '.                            02100000
021100         10  PV-XLKUT067-RETURN-FIELDS                            02110000
021200                                      PIC X(90).                  02120000
021300                                                                  02130000
021400     05  PV-DLKUP024-TEXT.                                        02140000
021500         10  FILLER                   PIC X(12)                   02150000
021600             VALUE ' START DTE= '.                                02160000
021700         10  PV-DLKUP024-DATE         PIC X(10).                  02170000
021800         10  FILLER                   PIC X(12)                   02180000
021900             VALUE ' ASGMT TXT= '.                                02190000
022000         10  PV-DLKUP024-TXT          PIC X(10).                  02200000
022100         10  FILLER                   PIC X(12)                   02210000
022200             VALUE ' ASGMT SEQ= '.                                02220000
022300         10  PV-DLKUP024-SEQ          PIC 9(09).                  02230000
022400                                                                  02240000
022500*    FOR FORMATTING SLQCA INTO SOMETHING READABLE                 02250000
022600     COPY DPWS004.                                                02260000
022700/                                                                 02270000
022800*    DLKUP024 COMMAREA                                            02280000
022900     COPY DLWS020.                                                02290000
023000***  COPY DLWS001.   (COMMAREA FOR CICS VERSION - DLKUP001)       02300000
023100/                                                                 02310000
023200*    DLKUT410 COMMAREA                                            02320000
023300     COPY DLWS019.                                                02330000
023400/                                                                 02340000
023500*    XLKUT067                                                     02350000
023600     COPY XLWS067.                                                02360000
023700/                                                                 02370000
023800*    XLKUP046 COMMAREA                                            02380000
023900     COPY XLWS091.                                                02390000
024000***  COPY XLWS072.  (COMMAREA FOR CICS VERSION - XLKUP033)        02400000
024100/                                                                 02410000
024200*    FORMAT FOR PCT_BUS_EVNT_DTL                                  02420000
024300     COPY PCWS242.                                                02430000
024400                                                                  02440000
024500*    FORMAT FOR TEXT DATA ON TUPLDER FOR RFID                     02450000
024600     COPY PCWS265.                                                02460000
024700                                                                  02470000
024800*    COMMUNICATION AREA FOR DIRECTIVE GENERATOR MODULE-SUKUT129   02480000
024900     COPY SUWS090.                                                02490000
025000                                                                  02500000
025100*    COMMUNICATION AREA FOR RFID DETERMINATION MODULE-SUKUT149    02510000
025200     COPY SUWS093.                                                02520000
025300                                                                  02530000
025400*    FORMATTING TEMPLATE                                          02540000
025500     COPY DLWS011.                                                02550000
025600                                                                  02560000
025700*    ABEND FIELDS                                                 02570000
025800*    COPY DPWS013.                                                02580000
025900/                                                                 02590000
026000*    CORP PARM TABLE                                              02600000
026100     EXEC SQL                                                     02610000
026200         INCLUDE TKRPRPM                                          02620000
026300     END-EXEC.                                                    02630000
026400                                                                  02640000
026500*    UPLOAD ERROR TABLE                                           02650000
026600     EXEC SQL                                                     02660000
026700         INCLUDE TUPLDER                                          02670000
026800     END-EXEC.                                                    02680000
026900                                                                  02690000
027000*    PACK-TO-LITE MODULES                                         02700000
027100     EXEC SQL                                                     02710000
027200         INCLUDE TP2LMOD                                          02720000
027300     END-EXEC.                                                    02730000
027400                                                                  02740000
027500*     XLT_USR                                                     02750000
027600     EXEC SQL                                                     02760000
027700         INCLUDE XLT00024                                         02770000
027800     END-EXEC.                                                    02780000
027900                                                                  02790000
028000*     DLT_TMP_EMP                                                 02800000
028100     EXEC SQL                                                     02810000
028200         INCLUDE DLT00002                                         02820000
028300     END-EXEC.                                                    02830000
028400                                                                  02840000
028500*     CARTON DIRECTIVE - SUT_CART_DIRV_TRKG                       02850000
028600     EXEC SQL                                                     02860000
028700         INCLUDE SUT00102                                         02870000
028800     END-EXEC.                                                    02880000
028900                                                                  02890000
029000     EXEC SQL                                                     02900000
029100          INCLUDE SQLCA                                           02910000
029200     END-EXEC.                                                    02920000
029300                                                                  02930000
029400                                                                  02940000
029500 LINKAGE SECTION.                                                 02950000
029600                                                                  02960000
029700     COPY PCWS243.                                                02970000
029800/                                                                 02980000
029900 PROCEDURE DIVISION USING PC243-COMMAREA.                         02990000
030000                                                                  03000000
030100     INITIALIZE PS-SWITCHES                                       03010000
030200                PV-PROGRAM-VARIABLES                              03020000
030300                PV-ERROR-MSG.                                     03030000
030400                                                                  03040000
030500     SET  PS-PICK-FROM-WORKSTATION-NO  TO  TRUE.                  03050000
030600                                                                  03060000
030700     PERFORM 1000-INITIALIZE.                                     03070000
030800                                                                  03080000
030900     IF  PS-PICK-FROM-WORKSTATION                                 03090000
031000         CONTINUE                                                 03100000
031100     ELSE                                                         03110000
031200         IF PS-ERROR-NO                                           03120000
031300             IF  PS-P4-INTERFACE-YES                              03130000
031400                 PERFORM 2000-PROCESS-DA-PICK                     03140000
031500             END-IF                                               03150000
031600*                                                                 03160000
031700*** DMH - WR-WR41309 - CHECK FOR RFID                             03170000
031800*** 9/27/12 - BEGIN                                               03180000
031900*                                                                 03190000
032000*** RLK - CHG0055296 - CHECK FOR RFID                             03200000
032100             IF PS-RFID-CHECK-YES                                 03210000
032200                 PERFORM 5000-CHECK-RFID                          03220000
032300             END-IF                                               03230000
032400*** RLK - CHG0055296 - CHECK FOR RFID                             03240000
032500*                                                                 03250000
032600*** DMH - WR-WR41309 - CHECK FOR RFID                             03260000
032700*** 9/27/12 - END                                                 03270000
032800*                                                                 03280000
032900         END-IF                                                   03290000
033000     END-IF.                                                      03300000
033100                                                                  03310000
033200     PERFORM 9999-RETURN.                                         03320000
033300                                                                  03330000
033400 1000-INITIALIZE.                                                 03340000
033500                                                                  03350000
033600     SET PS-ERROR-NO                                              03360000
033700         PS-P4-INTERFACE-NO                                       03370000
033800         PC243-SUCCESSFUL             TO TRUE.                    03380000
033900                                                                  03390000
034000     MOVE FUNCTION UPPER-CASE(PC243-PICKER-ID)                    03400000
034100                                      TO PV-PICKER-ID.            03410000
034200                                                                  03420000
034300     PERFORM 7030-SELECT-TKRPRPM.                                 03430000
034400*** RLK - CHG0055296 - CHECK FOR RFID                             03440000
034500                                                                  03450000
034600     PERFORM 7060-SELECT-TKRPRPM.                                 03460000
034700*** RLK - CHG0055296 - CHECK FOR RFID                             03470000
034800                                                                  03480000
034900     IF PC243-BOX-BAR-CODE-NBR = '00000000000000000000' AND       03490000
035000        PC243-PICKED-QTY = 0                                      03500000
035100         SET PS-ERROR-YES            TO TRUE                      03510000
035200     END-IF.                                                      03520000
035300                                                                  03530000
035400     IF PS-ERROR-NO                                               03540000
035500         IF KRPRPM-FUNC-TXT = 'Y'                                 03550000
035600             PERFORM 1100-DISPLAY-PCWS243                         03560000
035700         END-IF                                                   03570000
035800     END-IF.                                                      03580000
035900                                                                  03590000
036000     IF PS-ERROR-NO                                               03600000
036100         PERFORM 7000-SELECT-TKRPRPM                              03610000
036200     END-IF.                                                      03620000
036300                                                                  03630000
036400     IF PS-ERROR-NO                                               03640000
036500         IF PS-P4-INTERFACE-YES                                   03650000
036600*            PERFORM 8600-CALL-XLKUT067                           03660000
036700             MOVE SPACES              TO XL067-USER-FOUND-CODE    03670000
036800                                                                  03680000
036900             IF  (PV-PICKER-ID     = 'NOMAN' OR                   03690000
037000                  PV-PICKER-ID     = 'UNASSIGN') AND              03700000
037100                 PC243-PICKED-QTY   =  0                          03710000
037200                 SET  PS-PICK-FROM-WORKSTATION                    03720000
037300                      PC243-SUCCESSFUL          TO TRUE           03730000
037400             ELSE                                                 03740000
037500                 PERFORM 7100-KOHLS-USER                          03750000
037600             END-IF                                               03760000
037700                                                                  03770000
037800         END-IF                                                   03780000
037900     END-IF.                                                      03790000
038000                                                                  03800000
038100 1100-DISPLAY-PCWS243.                                            03810000
038200     MOVE SPACES TO PV-PCWS23-FIELDS.                             03820000
038300     STRING                                                       03830000
038400             PC243-FUNCTION                                       03840000
038500         '/' PC243-CALLING-PROGRAM                                03850000
038600         '/' PC243-DC-NBR                                         03860000
038700         '/' PC243-PICK-ORDER-NBR                                 03870000
038800             DELIMITED BY SIZE                                    03880000
038900        INTO PV-PCWS23-FIELDS.                                    03890000
039000     STRING ' PCKUT072 PM - '                                     03900000
039100              PV-PCWS243-TEXT            DELIMITED BY SIZE        03910000
039200                                    INTO PV-LOG-MSG.              03920000
039300     PERFORM 9900-WRITE-LOG.                                      03930000
039400                                                                  03940000
039500     MOVE PC243-INNER-PK-IND          TO PV-DISP-INNER-PK-IND.    03950000
039600     MOVE PC243-INNER-PK-QTY          TO PV-DISP-INNER-PK-QTY.    03960000
039700     MOVE SPACES TO PV-PCWS23-FIELDS.                             03970000
039800     STRING                                                       03980000
039900             PV-DISP-INNER-PK-IND                                 03990000
040000         '/' PV-DISP-INNER-PK-QTY                                 04000000
040100         '/' PC243-STR-NBR                                        04010000
040200         '/' PC243-LOCATION-NM                                    04020000
040300             DELIMITED BY SIZE                                    04030000
040400             INTO PV-PCWS23-FIELDS.                               04040000
040500     STRING ' PCKUT072 PM - '                                     04050000
040600              PV-PCWS243-TEXT            DELIMITED BY SIZE        04060000
040700                                    INTO PV-LOG-MSG.              04070000
040800     PERFORM 9900-WRITE-LOG.                                      04080000
040900                                                                  04090000
041000     MOVE SPACES TO PV-PCWS23-FIELDS.                             04100000
041100     MOVE PC243-EXP-PICK-ORDER-QTY   TO PV-DISP-EXP-PICK-ORD-QTY. 04110000
041200     MOVE PC243-PICKED-QTY           TO PV-DISP-PICKED-QTY.       04120000
041300     STRING                                                       04130000
041400             PC243-BOX-BAR-CODE-NBR                               04140000
041500         '/' PV-DISP-EXP-PICK-ORD-QTY                             04150000
041600         '/' PV-DISP-PICKED-QTY                                   04160000
041700             DELIMITED BY SIZE                                    04170000
041800        INTO PV-PCWS23-FIELDS.                                    04180000
041900     STRING ' PCKUT072 PM - '                                     04190000
042000              PV-PCWS243-TEXT            DELIMITED BY SIZE        04200000
042100                                    INTO PV-LOG-MSG.              04210000
042200     PERFORM 9900-WRITE-LOG.                                      04220000
042300                                                                  04230000
042400     MOVE SPACES TO PV-PCWS23-FIELDS.                             04240000
042500     MOVE PC243-TOTAL-PICKED-QTY     TO PV-DISP-TOTAL-PICKED-QTY. 04250000
042600     STRING                                                       04260000
042700             PC243-PICKMADE-DATE                                  04270003
042800         '/' PC243-PICKER-ID                                      04280000
042900         '/' PV-DISP-TOTAL-PICKED-QTY                             04290000
043000                                                                  04300000
043100             DELIMITED BY SIZE                                    04310000
043200        INTO PV-PCWS23-FIELDS.                                    04320000
043300     STRING ' PCKUT072 PM - '                                     04330000
043400              PV-PCWS243-TEXT            DELIMITED BY SIZE        04340000
043500                                    INTO PV-LOG-MSG.              04350000
043600     PERFORM 9900-WRITE-LOG.                                      04360000
043700                                                                  04370000
043800*        '/' XL067-KOHLS-CONTENTION-NBR                           04380000
043900*        '/' XL067-KOHLS-ERROR-NBR                                04390000
044000*        '/' XL067-TEMP-NOT-FOUND-NBR                             04400000
044100*        '/' XL067-TEMP-CONTENTION-NBR                            04410000
044200*        '/' XL067-TEMP-ERROR-NBR                                 04420000
044300*        '/' XL067-CALL-MOD-FAIL-NM                               04430000
044400*        '/' XL067-CALL-MOD-FAIL-ERR-CDE                          04440000
044500                                                                  04450000
044600 2000-PROCESS-DA-PICK.                                            04460000
044700     IF KRPRPM-FUNC-TXT = 'Y'                                     04470000
044800         MOVE ' PCKUT072 START 2000- PARA '     TO PV-LOG-MSG     04480000
044900         PERFORM 9900-WRITE-LOG                                   04490000
045000     END-IF.                                                      04500000
045100                                                                  04510000
045200     PERFORM 3000-MANAGE-ASSIGNMENT                               04520000
045300     IF   PS-PICK-FROM-WORKSTATION                                04530000
045400          CONTINUE                                                04540000
045500     ELSE                                                         04550000
045600         IF PS-ERROR-NO                                           04560000
045700             PERFORM 4000-CREATE-BUSINESS-EVENT                   04570000
045800         END-IF                                                   04580000
045900     END-IF.                                                      04590000
046000                                                                  04600000
046100     IF KRPRPM-FUNC-TXT = 'Y'                                     04610000
046200         MOVE ' PCKUT072 END 2000- PARA '     TO PV-LOG-MSG       04620000
046300         PERFORM 9900-WRITE-LOG                                   04630000
046400     END-IF.                                                      04640000
046500                                                                  04650000
046600 3000-MANAGE-ASSIGNMENT.                                          04660000
046700     IF KRPRPM-FUNC-TXT = 'Y'                                     04670000
046800         MOVE ' PCKUT072 START 3000- PARA '     TO PV-LOG-MSG     04680000
046900         PERFORM 9900-WRITE-LOG                                   04690000
047000     END-IF.                                                      04700000
047100                                                                  04710000
047200     PERFORM 3100-EXTRACT-DATE.                                   04720000
047300                                                                  04730000
047400     PERFORM 3120-DETERMINE-MOD-NBR.                              04740000
047500                                                                  04750000
047600     PERFORM 7050-SELECT-TP2LMOD.                                 04760000
047700                                                                  04770000
047800     IF  PS-PICK-FROM-WORKSTATION                                 04780000
047900         CONTINUE                                                 04790000
048000     ELSE                                                         04800000
048100         IF P2LMOD-MODU-MDSE-TYP-CDE = 'H'                        04810000
048200             MOVE 'HRTW '             TO P2LMOD-DFLT-STR-ZN-ID    04820000
048300         END-IF                                                   04830000
048400                                                                  04840000
048500         IF PS-ERROR-NO                                           04850000
048600             PERFORM 8450-LINK-DLKUT410                           04860000
048700         END-IF                                                   04870000
048800     END-IF.                                                      04880000
048900                                                                  04890000
049000     IF KRPRPM-FUNC-TXT = 'Y'                                     04900000
049100         MOVE ' PCKUT072 END 3000- PARA '     TO PV-LOG-MSG       04910000
049200         PERFORM 9900-WRITE-LOG                                   04920000
049300     END-IF.                                                      04930000
049400                                                                  04940000
049500 3100-EXTRACT-DATE.                                               04950000
049600     IF KRPRPM-FUNC-TXT = 'Y'                                     04960000
049700         MOVE ' PCKUT072 START 3100- PARA '     TO PV-LOG-MSG     04970000
049800         PERFORM 9900-WRITE-LOG                                   04980000
049900     END-IF.                                                      04990000
049901                                                                  04990101
049902*                                                                 04990202
049903*DMH - 03/16 BEGIN                                                04990302
049910     MOVE PC243-PICKMADE-DATE-YYYY  TO PV-START-CCYY.             04991001
049920     MOVE PC243-PICKMADE-DATE-MM    TO PV-START-MM.               04992001
049930     MOVE PC243-PICKMADE-DATE-DD    TO PV-START-DD.               04993001
049940                                                                  04994001
049950     MOVE PC243-PICKMADE-TIME-HH    TO PV-START-HOUR-N.           04995001
049960     MOVE PC243-PICKMADE-TIME-MM    TO PV-START-MIN.              04996001
049970     MOVE PC243-PICKMADE-TIME-SS    TO PV-START-SEC.              04997005
049980*DMH - 03/16 END                                                  04998002
049990*                                                                 04999002
051500     IF KRPRPM-FUNC-TXT = 'Y'                                     05150000
051600         MOVE ' PCKUT072 END 3100- PARA '     TO PV-LOG-MSG       05160000
051700         PERFORM 9900-WRITE-LOG                                   05170000
051800     END-IF.                                                      05180000
051900                                                                  05190002
076300 3120-DETERMINE-MOD-NBR.                                          07630000
076400     IF KRPRPM-FUNC-TXT = 'Y'                                     07640000
076500         MOVE ' PCKUT072 START 3120- PARA '     TO PV-LOG-MSG     07650000
076600         PERFORM 9900-WRITE-LOG                                   07660000
076700     END-IF.                                                      07670000
076800                                                                  07680000
076900     MOVE PC243-LOCATION-NM           TO PV-HOLD-LOCATION.        07690000
077000     PERFORM VARYING PV-LENGTH FROM 10 BY -1                      07700000
077100             UNTIL PV-HOLD-LOCATION (PV-LENGTH:1) NOT = SPACES    07710000
077200         ADD 1                        TO PV-DUMMY                 07720000
077300     END-PERFORM.                                                 07730000
077400                                                                  07740000
077500     EVALUATE PV-LENGTH                                           07750000
077600         WHEN 4                                                   07760000
077700             MOVE PV-HOLD-LOCATION(1:1)                           07770000
077800                                      TO DK-MODU-NBR              07780000
077900         WHEN 5                                                   07790000
078000             MOVE PV-HOLD-LOCATION(1:2)                           07800000
078100                                      TO DK-MODU-NBR              07810000
078200         WHEN OTHER                                               07820000
078300             MOVE ZEROES              TO DK-MODU-NBR              07830000
078400     END-EVALUATE.                                                07840000
078500     IF KRPRPM-FUNC-TXT = 'Y'                                     07850000
078600         MOVE ' PCKUT072 END 3120- PARA '     TO PV-LOG-MSG       07860000
078700         PERFORM 9900-WRITE-LOG                                   07870000
078800     END-IF.                                                      07880000
078900/                                                                 07890000
079000 4000-CREATE-BUSINESS-EVENT.                                      07900000
079100     IF KRPRPM-FUNC-TXT = 'Y'                                     07910000
079200         MOVE ' PCKUT072 START 4000- PARA '     TO PV-LOG-MSG     07920000
079300         PERFORM 9900-WRITE-LOG                                   07930000
079400     END-IF.                                                      07940000
079500                                                                  07950000
079600*    GET THE NEXT ASSIGNMENT SEQUENCE NUMBER                      07960000
079700     PERFORM 8400-CALL-DLKUP024                                   07970000
079800                                                                  07980000
079900*    UPDATE EAI TABLES                                            07990000
080000     IF PS-ERROR-NO                                               08000000
080100         PERFORM 8410-CALL-XLKUP046                               08010000
080200     END-IF.                                                      08020000
080300     IF KRPRPM-FUNC-TXT = 'Y'                                     08030000
080400         MOVE ' PCKUT072 END 4000- PARA '     TO PV-LOG-MSG       08040000
080500         PERFORM 9900-WRITE-LOG                                   08050000
080600     END-IF.                                                      08060000
080700                                                                  08070000
080800                                                                  08080000
080900***************************************************************** 08090000
081000* CHECK FOR RFID PROCESSING                                     * 08100000
081100* DMH - WR-41309 -  9/27/12                                     * 08110000
081200***************************************************************** 08120000
081300 5000-CHECK-RFID.                                                 08130000
081400     IF KRPRPM-FUNC-TXT = 'Y'                                     08140000
081500         MOVE ' PCKUT072 START 5000-CHECK-RFID' TO PV-LOG-MSG     08150000
081600         PERFORM 9900-WRITE-LOG                                   08160000
081700     END-IF.                                                      08170000
081800                                                                  08180000
081900     PERFORM 5005-CHECK-RFID-NEEDED.                              08190000
082000                                                                  08200000
082100                                                                  08210000
082200*** RLK - CHG0055296 - CHECK FOR RFID                             08220000
082300*  CHECK TO SEE IF A DIRECTIVE HAS ALREADY BEEN REQUESTED FOR     08230000
082400*  THIS CARTON - ONLY ONE DIRECTIVE IS NEEDED PER CARTON          08240000
082500*  PV-DIRECTIVE-NEEDED-SW IS USED TO DETERMINE IF DIRECTIVE IS    08250000
082600*  TO BE CREATED BASED ON RFID CONSIDERATION.                     08260000
082700     IF  SU093-RFID-NO                                            08270000
082800       SET PV-DIRECTIVE-NEEDED-NO TO TRUE                         08280000
082900     ELSE                                                         08290000
083000     IF  SU093-RFID-YES                                           08300000
083100       AND SU093-DPT-STR-P2L-FIRST-YES                            08310000
083200       AND SU093-RFID-KOHL-DPT-IN-STR-YES                         08320000
083300       AND SU093-VNDR-DPT-RFID-COMPLI-NO                          08330000
083400* IF CARTON IS RFID,P2L FIRST, DEPT FOR STORE IS RFID AND VEND    08340000
083500* NOT COMPLIANT, THEN, A DIRECTIVE IS NEEDED                      08350000
083600* AND PV-DIRECTIVE-NEEDED-YES IS SET TO TRUE.                     08360000
083700* IF A DIRECTIVE HAS ALREADY BEEN CREATED, THEN, THE DIRECTIVE SW 08370000
083800* IS RESET TO NO AND PGM ACTS LIKE NOT RFID. THE RESET OF THE     08380000
083900* SWITCH IS PERFORMED IN 7045-CHECK-FOR-DIRECTV.                  08390000
084000* IF THE VENDOR IS COMPLIANT WE DON'T NEED TO TAG AS ALL ITEMS    08400000
084100* SHOULD BE TAGGED BEFORE GETTING TO THIS POINT.                  08410000
084200         SET PV-DIRECTIVE-NEEDED-YES TO TRUE                      08420000
084300         PERFORM 7045-CHECK-FOR-DIRECTV                           08430000
084400       END-IF                                                     08440000
084500*** RLK - CHG0055296 - CHECK FOR RFID                             08450000
084600     END-IF.                                                      08460000
084700                                                                  08470000
084800*  CALL THE CARTON DIRECTIVE MODULE                               08480000
084900     IF  PV-DIRECTIVE-NEEDED-YES                                  08490000
085000         PERFORM 5010-CREATE-DIRECTIVE                            08500000
085100     END-IF.                                                      08510000
085200                                                                  08520000
085300*  CHECK TO SEE IF A RECORD SHOULD BE WRITTEN TO TUPLDER          08530000
085400     IF  SU093-RFID-NO                                            08540000
085500         CONTINUE                                                 08550000
085600     ELSE                                                         08560000
085700*** RLK - CHG0055296 - CHECK FOR RFID                             08570000
085800       IF PV-DIRECTIVE-NEEDED-YES                                 08580000
085900         PERFORM 7040-SELECT-TKRPRPM-RFID                         08590000
086000       END-IF                                                     08600000
086100*** RLK - CHG0055296 - CHECK FOR RFID                             08610000
086200     END-IF.                                                      08620000
086300                                                                  08630000
086400*  WRITE LOGGING RECORD TO TUPLDER TABLE                          08640000
086500     IF  SU093-RFID-NO                                            08650000
086600         CONTINUE                                                 08660000
086700     ELSE                                                         08670000
086800*** RLK - CHG0055296 - CHECK FOR RFID                             08680000
086900       IF PV-DIRECTIVE-NEEDED-YES                                 08690000
087000         IF  PS-LOG-RFID-TUPLDER-YES                              08700000
087100             PERFORM 6000-INSERT-TUPLDER-RFID                     08710000
087200         END-IF                                                   08720000
087300       END-IF                                                     08730000
087400*** RLK - CHG0055296 - CHECK FOR RFID                             08740000
087500     END-IF.                                                      08750000
087600                                                                  08760000
087700*  COMMIT IF CARTON DIRECTIVES WERE REQUESTED                     08770000
087800     IF  PV-DIRECTIVE-NEEDED-YES                                  08780000
087900         PERFORM 8000-COMMIT                                      08790000
088000     END-IF.                                                      08800000
088100                                                                  08810000
088200                                                                  08820000
088300***************************************************************** 08830000
088400* CALL THE RFID MODULE TO CHECK IF A CARTON DIRECTIVE IS NEEDED * 08840000
088500* FOR THE CARTON COMING FROM P2L - CALLS SUKUT149               * 08850000
088600* DMH - WR-41309   08/27/12                                     * 08860000
088700***************************************************************** 08870000
088800 5005-CHECK-RFID-NEEDED.                                          08880000
088900                                                                  08890000
089000     IF KRPRPM-FUNC-TXT = 'Y'                                     08900000
089100         MOVE ' PCKUT072 START 5005-CHECK-RFID-NEEDED'            08910000
089200                                                TO PV-LOG-MSG     08920000
089300         PERFORM 9900-WRITE-LOG                                   08930000
089400     END-IF.                                                      08940000
089500                                                                  08950000
089600     INITIALIZE SU093-ITEM-COMMAREA.                              08960000
089700                                                                  08970000
089800*** RLK - CHG0055296 - CHECK FOR RFID                             08980000
089900*** SAME VALUE AS THE SUBCLS-YES BELOW SU093-DEPT-SUBCLASS        08990000
090000     SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE.                  09000000
090100     SET SU093-CHECK-BY-DEPT-IN-STR-YES TO TRUE.                  09010000
090200     SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE.                  09020000
090300     SET SU093-CHECK-BY-DC              TO TRUE.                  09030000
090400     SET SU093-RFID-NO                  TO TRUE.                  09040000
090500     SET  SU093-OUTBOUND-CTN      TO  TRUE.                       09050000
090600     SET  SU093-PACK-TO-LIGHT     TO  TRUE.                       09060000
090700*** RLK - CHG0055296 - CHECK FOR RFID                             09070000
090800     MOVE '00'                    TO  SU093-RETURN-CODE.          09080000
090900     MOVE ZEROES                  TO  SU093-ERROR-NBR.            09090000
091000     MOVE PC243-HDR-ORD-NBR       TO  SU093-KEY-PO.               09100000
091100     MOVE PC243-HDR-RCVR-SEQ-NBR  TO  SU093-KEY-REC-SEQ-NBR.      09110000
091200     MOVE PC243-HDR-ORD-LNE-NBR   TO  SU093-KEY-LNE-NBR.          09120000
091300     MOVE PC243-DC-NBR            TO  SU093-KEY-OPER-UNT-ID.      09130000
091400     MOVE PC243-STR-NBR           TO  SU093-KEY-DEST-LOC.         09140000
091500     MOVE PC243-BOX-BAR-CODE-NBR  TO  SU093-KEY-CARTON-ID.        09150000
091600                                                                  09160000
091700     IF KRPRPM-FUNC-TXT = 'Y'                                     09170000
091800             MOVE SQLCODE                TO  PV-DISP-SQLCODE      09180000
091900             MOVE KRPRPM-LOC-ID          TO  PV-DISP-OPER         09190000
092000             MOVE  SU093-KEY-OPER-UNT-ID TO  PV-DISP-OPER         09200000
092100             MOVE  SU093-KEY-PO          TO  PV-DISP-PO           09210000
092200             MOVE  SU093-KEY-REC-SEQ-NBR TO  PV-DISP-RCVR         09220000
092300             MOVE  SU093-KEY-LNE-NBR     TO  PV-DISP-LINE         09230000
092400             MOVE  SU093-KEY-DEST-LOC    TO  PV-DISP-DEST         09240000
092500             MOVE  SU093-KEY-CARTON-ID   TO  PV-DISP-SML          09250000
092600             MOVE  SU093-SQLCODE         TO  PV-DISP-SQL          09260000
092700                                                                  09270000
092800             DISPLAY ' '                                          09280000
092900             DISPLAY ' RFID COMMUNICATION AREA FIELDS       '     09290000
093000             DISPLAY '-------------------------------------'      09300000
093100             DISPLAY ' SU093-ACCESS-METHOD    = '                 09310000
093200                                           SU093-ACCESS-METHOD    09320000
093300             DISPLAY ' SU093-DC               = '                 09330000
093400                                           SU093-DC               09340000
093500             DISPLAY ' SU093-STORE            = '                 09350000
093600                                           SU093-STORE            09360000
093700             DISPLAY ' SU093-DEPT-SUBCLASS    = '                 09370000
093800                                           SU093-DEPT-SUBCLASS    09380000
093900             DISPLAY ' SU093-SKU              = '                 09390000
094000                                           SU093-SKU              09400000
094100             DISPLAY ' SU093-RETURN-CODE      = '                 09410000
094200                                           SU093-RETURN-CODE      09420000
094300             DISPLAY ' SU093-PREPK-ORDER-IND  = '                 09430000
094400                                           SU093-PREPK-ORDER-IND  09440000
094500             DISPLAY ' SU093-INB-OUTB-IND     = '                 09450000
094600                                           SU093-INB-OUTB-IND     09460000
094700             DISPLAY ' SU093-ERROR-NBR        = '                 09470000
094800                                           SU093-ERROR-NBR        09480000
094900             DISPLAY ' SU093-SQLCODE          = '                 09490000
095000                                           PV-DISP-SQLCODE        09500000
095100             DISPLAY ' SU093-KEY-PO           = '                 09510000
095200                                           PV-DISP-PO             09520000
095300             DISPLAY ' SU093-KEY-REC-SEQ-NBR  = '                 09530000
095400                                           PV-DISP-RCVR           09540000
095500             DISPLAY ' SU093-KEY-LNE-NBR      = '                 09550000
095600                                           PV-DISP-LINE           09560000
095700             DISPLAY ' SU093-KEY-OPER-UNT-ID  = '                 09570000
095800                                           PV-DISP-OPER           09580000
095900             DISPLAY ' SU093-KEY-DEST-LOC     = '                 09590000
096000                                           PV-DISP-DEST           09600000
096100             DISPLAY ' SU093-KEY-CARTON-ID    = '                 09610000
096200                                           PV-DISP-SML            09620000
096300             DISPLAY '-------------------------------------'      09630000
096400             DISPLAY ' '                                          09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700     CALL SU093-RFID-PGM       USING  SU093-ITEM-COMMAREA.        09670000
096800                                                                  09680000
096900     EVALUATE TRUE                                                09690000
097000       WHEN SU093-SUCCESSFUL                                      09700000
097100             CONTINUE                                             09710000
097200       WHEN OTHER                                                 09720000
097300             MOVE SQLCODE                TO  PV-DISP-SQLCODE      09730000
097400             MOVE KRPRPM-LOC-ID          TO  PV-DISP-OPER         09740000
097500             MOVE  SU093-KEY-OPER-UNT-ID TO  PV-DISP-OPER         09750000
097600             MOVE  SU093-KEY-PO          TO  PV-DISP-PO           09760000
097700             MOVE  SU093-KEY-REC-SEQ-NBR TO  PV-DISP-RCVR         09770000
097800             MOVE  SU093-KEY-LNE-NBR     TO  PV-DISP-LINE         09780000
097900             MOVE  SU093-KEY-DEST-LOC    TO  PV-DISP-DEST         09790000
098000             MOVE  SU093-KEY-CARTON-ID   TO  PV-DISP-SML          09800000
098100             MOVE  SU093-SQLCODE         TO  PV-DISP-SQL          09810000
098200             DISPLAY ' PCKUT072 - 5005 - '                        09820000
098300                     ' UNSUCCESSFUL CALL TO SUKUT149'             09830000
098400                     ' RFID MODULE'                               09840000
098500                                                                  09850000
098600             DISPLAY 'PCKUT072-5005-'                             09860000
098700                      SU093-ITEM-COMMAREA                         09870000
098800                                                                  09880000
098900             DISPLAY ' '                                          09890000
099000             DISPLAY 'SU093-RFID-PGM      = ' SU093-RFID-PGM      09900000
099100                                                                  09910000
099200             DISPLAY ' '                                          09920000
099300             DISPLAY ' RFID COMMUNICATION AREA FIELDS       '     09930000
099400             DISPLAY '-------------------------------------'      09940000
099500             DISPLAY ' SU093-ACCESS-METHOD    = '                 09950000
099600                                           SU093-ACCESS-METHOD    09960000
099700             DISPLAY ' SU093-DC               = '                 09970000
099800                                           SU093-DC               09980000
099900             DISPLAY ' SU093-STORE            = '                 09990000
100000                                           SU093-STORE            10000000
100100             DISPLAY ' SU093-DEPT-SUBCLASS    = '                 10010000
100200                                           SU093-DEPT-SUBCLASS    10020000
100300             DISPLAY ' SU093-SKU              = '                 10030000
100400                                           SU093-SKU              10040000
100500             DISPLAY ' SU093-RETURN-CODE      = '                 10050000
100600                                           SU093-RETURN-CODE      10060000
100700             DISPLAY ' SU093-PREPK-ORDER-IND  = '                 10070000
100800                                           SU093-PREPK-ORDER-IND  10080000
100900             DISPLAY ' SU093-INB-OUTB-IND     = '                 10090000
101000                                           SU093-INB-OUTB-IND     10100000
101100             DISPLAY ' SU093-ERROR-NBR        = '                 10110000
101200                                           SU093-ERROR-NBR        10120000
101300             DISPLAY ' SU093-SQLCODE          = '                 10130000
101400                                           PV-DISP-SQLCODE        10140000
101500             DISPLAY ' SU093-KEY-PO           = '                 10150000
101600                                           PV-DISP-PO             10160000
101700             DISPLAY ' SU093-KEY-REC-SEQ-NBR  = '                 10170000
101800                                           PV-DISP-RCVR           10180000
101900             DISPLAY ' SU093-KEY-LNE-NBR      = '                 10190000
102000                                           PV-DISP-LINE           10200000
102100             DISPLAY ' SU093-KEY-OPER-UNT-ID  = '                 10210000
102200                                           PV-DISP-OPER           10220000
102300             DISPLAY ' SU093-KEY-DEST-LOC     = '                 10230000
102400                                           PV-DISP-DEST           10240000
102500             DISPLAY ' SU093-KEY-CARTON-ID    = '                 10250000
102600                                           PV-DISP-SML            10260000
102700             DISPLAY '-------------------------------------'      10270000
102800             DISPLAY ' '                                          10280000
102900                                                                  10290000
103000     END-EVALUATE.                                                10300000
103100                                                                  10310000
103200                                                                  10320000
103300***************************************************************** 10330000
103400* CREATE CARTON DIRECTIVE - DIVERT THE CARTON TO HAVE RFID      * 10340000
103500* ATTACHED                                                      * 10350000
103600* DMH - WR-41309   08/27/12                                     * 10360000
103700***************************************************************** 10370000
103800 5010-CREATE-DIRECTIVE.                                           10380000
103900                                                                  10390000
104000     IF KRPRPM-FUNC-TXT = 'Y'                                     10400000
104100         MOVE ' PCKUT072 START 5010-CREATE-DIRECTIVE'             10410000
104200                                                TO PV-LOG-MSG     10420000
104300         PERFORM 9900-WRITE-LOG                                   10430000
104400     END-IF.                                                      10440000
104500                                                                  10450000
104600                                                                  10460000
104700**** INITIALIZE THE DIRECTIVE GENERATOR COMMUNICATION AREA        10470000
104800                                                                  10480000
104900     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        10490000
105000                                                                  10500000
105100**** SET UP SOME CONSTANT AREAS                                   10510000
105200                                                                  10520000
105300     SET SU090-BATCH                                              10530000
105400         SU090-CARTON-DIRECTIVE                                   10540000
105500         SU090-ADD-ACTION                                         10550000
105600         SU090-SML-BARCODE      TO TRUE.                          10560000
105700                                                                  10570000
105800*** INITIALIZE FIELDS                                             10580000
105900     SET SU090-SUCCESS          TO TRUE.                          10590000
106000                                                                  10600000
106100     MOVE SPACES                TO SU090-ERR-PROGRAM              10610000
106200                                   SU090-ERR-PARAGRAPH            10620000
106300                                   SU090-SQLCA                    10630000
106400                                   SU090-MQ-REAS-TXT.             10640000
106500                                                                  10650000
106600     MOVE ZEROES                TO SU090-SQLCODE                  10660000
106700                                   SU090-MQ-COND-CODE             10670000
106800                                   SU090-MQ-REAS-CODE.            10680000
106900                                                                  10690000
107000**** SETUP THE REST OF THE DIRECTIVE GENEATOR COMMUNICATION AREA  10700000
107100                                                                  10710000
107200     MOVE 'PCKUT072'               TO SU090-CALLING-PGM.          10720000
107300     MOVE SPACES                   TO SU090-P2L-BRCDE-NBR.        10730000
107400     MOVE PC243-DC-NBR             TO SU090-OPER-UNT-ID.          10740000
107500     MOVE 'RFD'                    TO SU090-DIRV-RSN-CDE.         10750000
107600     MOVE ZEROS                    TO SU090-AUD-CNTL-NBR.         10760000
107700     MOVE PC243-BOX-BAR-CODE-NBR   TO SU090-SML-BRCDE-NBR.        10770000
107800     MOVE SPACES                   TO SU090-AUD-STAT-CDE.         10780000
107900     MOVE PC243-HDR-ORD-NBR        TO SU090-PO-NBR.               10790000
108000     MOVE PC243-HDR-RCVR-SEQ-NBR   TO SU090-RCVR-SEQ-NBR.         10800000
108100     MOVE PC243-HDR-ORD-LNE-NBR    TO SU090-PO-LNE-NBR.           10810000
108200     MOVE ZEROS                    TO SU090-PO-PREPK-ID.          10820000
108300     MOVE PC243-STR-NBR            TO SU090-STR-NBR.              10830000
108400     MOVE SPACES                   TO SU090-CASI-CDE.             10840000
108500     SET  SU090-ACTIVE-CART        TO TRUE.                       10850000
108600     MOVE SPACES                   TO SU090-AUD-FAIL-RSN.         10860000
108700     MOVE SPACES                   TO SU090-STR-ZN.               10870000
108800     MOVE SPACES                   TO SU090-SEASET-YR.            10880000
108900     MOVE SPACES                   TO SU090-SEASET-CDE.           10890000
109000     MOVE PC243-PICKER-ID          TO SU090-ASSOC-ID.             10900000
109100                                                                  10910000
109200***                                                               10920000
109300*** THE P2L LABOR PROCESS USES STARTS WITH A MESSAGE QUEUE        10930000
109400*** BECAUSE OF THIS WE ARE ALREADY CONNECTED TO THE QMANAGER      10940000
109500*** SO THE CALLED MODULE WILL GET AN "ALREADY_CONNECTED" ERROR    10950000
109600*** WHEN THEY TRY TO CONNECT - WHICH IS VALID                     10960000
109700*** ALSO IF THIS SWITCH IS SET THEN THE CALLED MODULE WILL NOT    10970000
109800*** DISCONNECT SINCE IT WILL CAUSE THE P2L LABOR INTERFACE TO     10980000
109900*** ABEND BECAUSE IT WILL NO LONGER BE CONNECTED TO THE QMGR      10990000
110000***                                                               11000000
110100***                                                               11010000
110200     SET  SU090-QMNGR-CONNECTED-YES  TO  TRUE.                    11020000
110300***                                                               11030000
110400                                                                  11040000
110500     IF KRPRPM-FUNC-TXT = 'Y'                                     11050000
110600         DISPLAY 'PCKUT072 5010-BEFORE CALL'                      11060000
110700         DISPLAY  SU090-DG-REQUEST-COMMAREA                       11070000
110800         DISPLAY  ' '                                             11080000
110900         DISPLAY 'DG COMMUNICATION AREA FIELDS BEFORE CALL'       11090000
111000         DISPLAY '----------------------------------------'       11100000
111100         DISPLAY 'SU090-CALLING-PGM       = ' SU090-CALLING-PGM   11110000
111200         DISPLAY 'SU090-BATCH-ONLINE-IND  = '                     11120000
111300                                          SU090-BATCH-ONLINE-IND  11130000
111400         DISPLAY 'SU090-OPER-UNT-ID       = '                     11140000
111500                                          SU090-OPER-UNT-ID       11150000
111600         DISPLAY 'SU090-ACTN-CDE          = '                     11160000
111700                                          SU090-ACTN-CDE          11170000
111800         DISPLAY 'SU090-DIRECTIVE-LVL-CDE = '                     11180000
111900                                          SU090-DIRECTIVE-LVL-CDE 11190000
112000         DISPLAY 'SU090-DIRV-RSN-CDE      = '                     11200000
112100                                          SU090-DIRV-RSN-CDE      11210000
112200         DISPLAY 'SU090-BRCDE-TYP-CDE     = '                     11220000
112300                                          SU090-BRCDE-TYP-CDE     11230000
112400         DISPLAY 'SU090-SML-BRCDE-NBR     = '                     11240000
112500                                          SU090-SML-BRCDE-NBR     11250000
112600         DISPLAY 'SU090-P2L-BRCDE-NBR     = '                     11260000
112700                                          SU090-P2L-BRCDE-NBR     11270000
112800         DISPLAY 'SU090-PO-NBR            = '                     11280000
112900                                          SU090-PO-NBR            11290000
113000         DISPLAY 'SU090-PO-LNE-NBR        = '                     11300000
113100                                          SU090-PO-LNE-NBR        11310000
113200         DISPLAY 'SU090-PO-PREPK-ID       = '                     11320000
113300                                          SU090-PO-PREPK-ID       11330000
113400         DISPLAY 'SU090-RCVR-SEQ-NBR      = '                     11340000
113500                                          SU090-RCVR-SEQ-NBR      11350000
113600         DISPLAY 'SU090-CASI-CDE          = '                     11360000
113700                                          SU090-CASI-CDE          11370000
113800         DISPLAY 'SU090-CART-STAT-CDE     = '                     11380000
113900                                          SU090-CART-STAT-CDE     11390000
114000         DISPLAY 'SU090-AUD-CNTL-NBR      = '                     11400000
114100                                          SU090-AUD-CNTL-NBR      11410000
114200         DISPLAY 'SU090-AUD-STAT-CDE      = '                     11420000
114300                                          SU090-AUD-STAT-CDE      11430000
114400         DISPLAY 'SU090-AUD-FAIL-RSN      = '                     11440000
114500                                          SU090-AUD-FAIL-RSN      11450000
114600         DISPLAY 'SU090-STR-ZN            = '                     11460000
114700                                          SU090-STR-ZN            11470000
114800         DISPLAY 'SU090-SEASET-YR         = '                     11480000
114900                                          SU090-SEASET-YR         11490000
115000         DISPLAY 'SU090-SEASET-CDE        = '                     11500000
115100                                          SU090-SEASET-CDE        11510000
115200         DISPLAY 'SU090-STR-NBR           = '                     11520000
115300                                          SU090-STR-NBR           11530000
115400         DISPLAY 'SU090-ASSOC-ID          = '                     11540000
115500                                          SU090-ASSOC-ID          11550000
115600         DISPLAY 'SU090-QMNGR-CONNECTED-SW= '                     11560000
115700                                        SU090-QMNGR-CONNECTED-SW  11570000
115800         DISPLAY '----------------------------------------'       11580000
115900         DISPLAY ' '                                              11590000
116000     END-IF.                                                      11600000
116100                                                                  11610000
116200                                                                  11620000
116300*----------------------------------------------------------------*11630000
116400*  CALL THE DIRECTIVE GENERATOR TO REQUEST THE ISSUANCE OF A     *11640000
116500*  DIRECTIVE.                                                    *11650000
116600*----------------------------------------------------------------*11660000
116700                                                                  11670000
116800     CALL SU090-DIRV-GEN-PGM USING SU090-DG-REQUEST-COMMAREA.     11680000
116900                                                                  11690000
117000     EVALUATE TRUE                                                11700000
117100        WHEN SU090-SUCCESS                                        11710000
117200             CONTINUE                                             11720000
117300        WHEN OTHER                                                11730000
117400            DISPLAY '**************************************'      11740000
117500            DISPLAY '*     DIRECTIVE GENERATOR FAILED     *'      11750000
117600            DISPLAY '**************************************'      11760000
117700            PERFORM 5015-DG-ERROR-DISPLAY                         11770000
117800     END-EVALUATE.                                                11780000
117900                                                                  11790000
118000     IF KRPRPM-FUNC-TXT = 'Y'                                     11800000
118100         DISPLAY 'PCKUT072 5010-AFTER CALL'                       11810000
118200         DISPLAY  SU090-DG-REQUEST-COMMAREA                       11820000
118300         DISPLAY  ' '                                             11830000
118400     END-IF.                                                      11840000
118500                                                                  11850000
118600                                                                  11860000
118700 5015-DG-ERROR-DISPLAY.                                           11870000
118800                                                                  11880000
118900     IF KRPRPM-FUNC-TXT = 'Y'                                     11890000
119000         MOVE ' PCKUT072 START 5015-DG-ERROR-DISPLAY'             11900000
119100                                                TO PV-LOG-MSG     11910000
119200         PERFORM 9900-WRITE-LOG                                   11920000
119300     END-IF.                                                      11930000
119400                                                                  11940000
119500                                                                  11950000
119600     EVALUATE TRUE                                                11960000
119700        WHEN SU090-PARAMETER-ERROR                                11970000
119800             DISPLAY 'DG FAILED WITH PARAMETER ERROR'             11980000
119900        WHEN SU090-DB2-ERROR                                      11990000
120000             DISPLAY 'DG FAILED WITH DB2 ERROR'                   12000000
120100        WHEN SU090-MQ-ERROR                                       12010000
120200             DISPLAY 'DG FAILED WITH MQ ERROR'                    12020000
120300        WHEN SU090-OTHER-ERROR                                    12030000
120400             DISPLAY 'DG FAILED WITH UNKNOWN ERROR'               12040000
120500     END-EVALUATE.                                                12050000
120600                                                                  12060000
120700     DISPLAY ' '.                                                 12070000
120800     DISPLAY 'SU090-ERR-PROGRAM   = ' SU090-ERR-PROGRAM.          12080000
120900     DISPLAY 'SU090-ERR-PARAGRAPH = ' SU090-ERR-PARAGRAPH.        12090000
121000                                                                  12100000
121100     DISPLAY ' '.                                                 12110000
121200     DISPLAY 'DG COMMUNICATION AREA FIELDS'.                      12120000
121300     DISPLAY '----------------------------'.                      12130000
121400     DISPLAY 'SU090-CALLING-PGM       = ' SU090-CALLING-PGM.      12140000
121500     DISPLAY 'SU090-BATCH-ONLINE-IND  = ' SU090-BATCH-ONLINE-IND. 12150000
121600     DISPLAY 'SU090-OPER-UNT-ID       = ' SU090-OPER-UNT-ID.      12160000
121700     DISPLAY 'SU090-ACTN-CDE          = ' SU090-ACTN-CDE.         12170000
121800     DISPLAY 'SU090-DIRECTIVE-LVL-CDE = ' SU090-DIRECTIVE-LVL-CDE.12180000
121900     DISPLAY 'SU090-DIRV-RSN-CDE      = ' SU090-DIRV-RSN-CDE.     12190000
122000     DISPLAY 'SU090-BRCDE-TYP-CDE     = ' SU090-BRCDE-TYP-CDE.    12200000
122100     DISPLAY 'SU090-SML-BRCDE-NBR     = ' SU090-SML-BRCDE-NBR.    12210000
122200     DISPLAY 'SU090-P2L-BRCDE-NBR     = ' SU090-P2L-BRCDE-NBR.    12220000
122300     DISPLAY 'SU090-PO-NBR            = ' SU090-PO-NBR.           12230000
122400     DISPLAY 'SU090-PO-LNE-NBR        = ' SU090-PO-LNE-NBR.       12240000
122500     DISPLAY 'SU090-PO-PREPK-ID       = ' SU090-PO-PREPK-ID.      12250000
122600     DISPLAY 'SU090-RCVR-SEQ-NBR      = ' SU090-RCVR-SEQ-NBR.     12260000
122700     DISPLAY 'SU090-CASI-CDE          = ' SU090-CASI-CDE.         12270000
122800     DISPLAY 'SU090-CART-STAT-CDE     = ' SU090-CART-STAT-CDE.    12280000
122900     DISPLAY 'SU090-AUD-CNTL-NBR      = ' SU090-AUD-CNTL-NBR.     12290000
123000     DISPLAY 'SU090-AUD-STAT-CDE      = ' SU090-AUD-STAT-CDE.     12300000
123100     DISPLAY 'SU090-AUD-FAIL-RSN      = ' SU090-AUD-FAIL-RSN.     12310000
123200     DISPLAY 'SU090-STR-ZN            = ' SU090-STR-ZN.           12320000
123300     DISPLAY 'SU090-SEASET-YR         = ' SU090-SEASET-YR.        12330000
123400     DISPLAY 'SU090-SEASET-CDE        = ' SU090-SEASET-CDE.       12340000
123500     DISPLAY 'SU090-STR-NBR           = ' SU090-STR-NBR.          12350000
123600     DISPLAY 'SU090-ASSOC-ID          = ' SU090-ASSOC-ID.         12360000
123700     DISPLAY 'SU090-QMNGR-CONNECTED-SW= '                         12370000
123800                                      SU090-QMNGR-CONNECTED-SW    12380000
123900                                                                  12390000
124000     EVALUATE TRUE                                                12400000
124100        WHEN SU090-DB2-ERROR                                      12410000
124200           DISPLAY 'SU090-SQLCODE = ' SU090-SQLCODE               12420000
124300           DISPLAY 'SU090-SQLCA   = ' SU090-SQLCA                 12430000
124400        WHEN SU090-MQ-ERROR                                       12440000
124500           DISPLAY 'SU090-MQ-COND-CODE = ' SU090-MQ-COND-CODE     12450000
124600           DISPLAY 'SU090-MQ-REAS-CODE = ' SU090-MQ-REAS-CODE     12460000
124700           DISPLAY 'SU090-MQ-REAS-TXT  = ' SU090-MQ-REAS-TXT      12470000
124800     END-EVALUATE.                                                12480000
124900                                                                  12490000
125000                                                                  12500000
125100***************************************************************** 12510000
125200* INSERT INTO TUPLDER - TO TRACK CARTON DIRECTIVES FROM P2L     * 12520000
125300* DMH - WR-41309   08/27/12                                     * 12530000
125400***************************************************************** 12540000
125500 6000-INSERT-TUPLDER-RFID.                                        12550000
125600                                                                  12560000
125700     IF KRPRPM-FUNC-TXT = 'Y'                                     12570000
125800         MOVE ' PCKUT072 START 6000- PARA '     TO PV-LOG-MSG     12580000
125900         PERFORM 9900-WRITE-LOG                                   12590000
126000     END-IF.                                                      12600000
126100                                                                  12610000
126200                                                                  12620000
126300     INITIALIZE DCLTUPLDER.                                       12630000
126400     MOVE PC243-DC-NBR            TO UPLDER-OPER-UNT-ID.          12640000
126500     MOVE 'H'                     TO UPLDER-UPLD-TRN-CDE.         12650000
126600     MOVE 'RFD'                   TO UPLDER-ERR-CDE.              12660000
126700     MOVE ZEROES                  TO UPLDER-UPLD-SEQ-NBR.         12670000
126800                                                                  12680000
126900     MOVE SPACES                  TO PC265-ERROR-DATA.            12690000
127000     SET  PC265-RFID-DIRECTIVE    TO TRUE                         12700000
127100     MOVE SU093-DC                TO  PC265-RF-SEL-DC.            12710000
127200     MOVE SU093-STORE             TO  PC265-RF-SEL-STR.           12720000
127300     MOVE SU093-DEPT-SUBCLASS     TO  PC265-RF-SEL-DEPT.          12730000
127400     MOVE SU093-SKU               TO  PC265-RF-SEL-SKU.           12740000
127500     MOVE SU093-RETURN-CODE       TO  PC265-RF-RET-CDE.           12750000
127600     MOVE SU093-PREPK-ORDER-IND   TO  PC265-RF-FLAG-PP.           12760000
127700     MOVE SU093-INB-OUTB-IND      TO  PC265-RF-FLAG-IO.           12770000
127800     MOVE SU093-ERROR-NBR         TO  PC265-RF-ERROR-NBR.         12780000
127900     MOVE PC243-DC-NBR            TO  PC265-RF-KEY-DC-NBR.        12790000
128000     MOVE PC243-HDR-ORD-NBR       TO  PC265-RF-KEY-PO.            12800000
128100     MOVE PC243-HDR-RCVR-SEQ-NBR  TO  PC265-RF-KEY-RCVR.          12810000
128200     MOVE PC243-HDR-ORD-LNE-NBR   TO  PC265-RF-KEY-LINE.          12820000
128300     MOVE PC243-STR-NBR           TO  PC265-RF-KEY-STR.           12830000
128400     MOVE PC243-BOX-BAR-CODE-NBR  TO  PC265-RF-KEY-SML.           12840000
128500                                                                  12850000
128600     MOVE PC265-UPLOAD-ERROR-RECORD TO UPLDER-PKT-TXT             12860000
128700                                                                  12870000
128800                                                                  12880000
128900     EXEC SQL                                                     12890000
129000       INSERT INTO TUPLDER                                        12900000
129100             (OPER_UNT_ID                                         12910000
129200            , UPLD_TRN_CDE                                        12920000
129300            , ERR_CDE                                             12930000
129400            , PRC_TMST                                            12940000
129500            , UPLD_SEQ_NBR                                        12950000
129600            , PKT_TXT                                             12960000
129700             )                                                    12970000
129800       VALUES                                                     12980000
129900             (:UPLDER-OPER-UNT-ID                                 12990000
130000            , :UPLDER-UPLD-TRN-CDE                                13000000
130100            , :UPLDER-ERR-CDE                                     13010000
130200            , CURRENT TIMESTAMP                                   13020000
130300            , :UPLDER-UPLD-SEQ-NBR                                13030000
130400            , :UPLDER-PKT-TXT                                     13040000
130500             )                                                    13050000
130600     END-EXEC.                                                    13060000
130700                                                                  13070000
130800     EVALUATE TRUE                                                13080000
130900         WHEN SQLCODE = ZERO                                      13090000
131000              CONTINUE                                            13100000
131100         WHEN OTHER                                               13110000
131200              MOVE SQLCODE  TO  PV-DISP-SQLCODE                   13120000
131300              MOVE UPLDER-OPER-UNT-ID  TO  PV-DISP-OPER           13130000
131400              DISPLAY 'PCKUT071 - ERROR WRITING TO TUPLDER'       13140000
131500              DISPLAY 'SQLCODE = ' PV-DISP-SQLCODE                13150000
131600              DISPLAY 'UPLDER-OPER-UNT-ID =  ' PV-DISP-OPER       13160000
131700              DISPLAY 'UPLDER-UPLD-TRN-CDE = ' UPLDER-UPLD-TRN-CDE13170000
131800              DISPLAY 'UPLDER-ERR-CDE =      ' UPLDER-ERR-CDE     13180000
131900              DISPLAY 'UPLDER-PRC-TMST =     ' UPLDER-PRC-TMST    13190000
132000              DISPLAY 'UPLDER-PKT-TXT =      ' UPLDER-PKT-TXT     13200000
132100     END-EVALUATE.                                                13210000
132200                                                                  13220000
132300                                                                  13230000
132400***************************************************************** 13240000
132500* COMMIT WHEN RFID DIRECTIVE MESSAGES ARE SENT                  * 13250000
132600* DMH - WR-41309   08/27/12                                     * 13260000
132700***************************************************************** 13270000
132800 8000-COMMIT.                                                     13280000
132900                                                                  13290000
133000     EXEC SQL                                                     13300000
133100          COMMIT                                                  13310000
133200     END-EXEC.                                                    13320000
133300                                                                  13330000
133400     EVALUATE TRUE                                                13340000
133500         WHEN SQLCODE = ZERO                                      13350000
133600         WHEN SQLCODE = +100                                      13360000
133700             CONTINUE                                             13370000
133800         WHEN OTHER                                               13380000
133900              MOVE SQLCODE  TO  PV-DISP-SQLCODE                   13390000
134000              DISPLAY 'PCKUT072 - 8000 - ERROR ON COMMIT'         13400000
134100              DISPLAY                                             13410000
134200                 ' SQLCODE:               ' PV-DISP-SQLCODE       13420000
134300                 ' PC243-DC-NBR:          ' PC243-DC-NBR          13430000
134400                 ' PC243-HDR-ORD-NBR      ' PC243-HDR-ORD-NBR     13440000
134500                 ' PC243-HDR-RCVR-SEQ-NBR:' PC243-HDR-RCVR-SEQ-NBR13450000
134600                 ' PC243-HDR-ORD-LNE-NBR: ' PC243-HDR-ORD-LNE-NBR 13460000
134700                 ' PC243-STR-NBR:         ' PC243-STR-NBR         13470000
134800                 ' PC243-BOX-BAR-CODE-NBR:' PC243-BOX-BAR-CODE-NBR13480000
134900     END-EVALUATE.                                                13490000
135000                                                                  13500000
135100                                                                  13510000
135200                                                                  13520000
135300***************************************************************** 13530000
135400*                                                               * 13540000
135500***************************************************************** 13550000
135600 7000-SELECT-TKRPRPM.                                             13560000
135700     IF KRPRPM-FUNC-TXT = 'Y'                                     13570000
135800         MOVE ' PCKUT072 START 7000- PARA '     TO PV-LOG-MSG     13580000
135900         PERFORM 9900-WRITE-LOG                                   13590000
136000     END-IF.                                                      13600000
136100                                                                  13610000
136200     MOVE PC243-DC-NBR                TO KRPRPM-LOC-ID            13620000
136300     SET PS-P4-INTERFACE-NO           TO TRUE                     13630000
136400     EXEC SQL                                                     13640000
136500         SELECT FUNC_TXT                                          13650000
136600         INTO :PS-P4-INTERFACE-SW                                 13660000
136700         FROM                                                     13670000
136800             TKRPRPM                                              13680000
136900         WHERE                                                    13690000
137000             LOC_ID                   = :KRPRPM-LOC-ID            13700000
137100         AND INTFC_SYS_CDE            = 'DLX'                     13710000
137200         AND SYS_PRC_FUNC_CDE         = 'DLP2LI'                  13720000
137300         WITH UR                                                  13730000
137400     END-EXEC.                                                    13740000
137500                                                                  13750000
137600     EVALUATE TRUE                                                13760000
137700         WHEN SQLCODE = ZERO                                      13770000
137800             CONTINUE                                             13780000
137900         WHEN OTHER                                               13790000
138000***                                                               13800000
138100*** DMH ADDED DISPLAYS - 8/21/2007                                13810000
138200***                                                               13820000
138300             MOVE SQLCODE             TO  PV-DISP-SQLCODE         13830000
138400             MOVE KRPRPM-LOC-ID       TO  PV-DISP-OPER            13840000
138500             DISPLAY ' PCKUT072 - 7000 - '                        13850000
138600                     ' SQLCODE: '         PV-DISP-SQLCODE         13860000
138700                     ' TKRPRPM '                                  13870000
138800             DISPLAY ' PCKUT072 - 7000 - '                        13880000
138900                     ' OPER: '            PV-DISP-OPER            13890000
139000                     ' DLX  DLP2LI'                               13900000
139100***                                                               13910000
139200             MOVE '7000-'             TO PV-ERROR-PARA            13920000
139300             STRING                                               13930000
139400                  'SQL ERROR - TKRPRPM'                           13940000
139500                  ' CART = '                                      13950000
139600                  PC243-BOX-BAR-CODE-NBR                          13960000
139700                  ' OPER = '                                      13970000
139800                  PC243-DC-NBR   DELIMITED BY SIZE                13980000
139900                                    INTO PV-ERROR-TEXT            13990000
140000             PERFORM 9700-SQL-ERROR                               14000000
140100                                                                  14010000
140200     END-EVALUATE.                                                14020000
140300     IF KRPRPM-FUNC-TXT = 'Y'                                     14030000
140400         MOVE ' PCKUT072 END 7000- PARA '     TO PV-LOG-MSG       14040000
140500         PERFORM 9900-WRITE-LOG                                   14050000
140600     END-IF.                                                      14060000
140700                                                                  14070000
140800 7030-SELECT-TKRPRPM.                                             14080000
140900                                                                  14090000
141000     MOVE PC243-DC-NBR                TO KRPRPM-LOC-ID.           14100000
141100                                                                  14110000
141200     EXEC SQL                                                     14120000
141300         SELECT FUNC_TXT                                          14130000
141400         INTO :KRPRPM-FUNC-TXT                                    14140000
141500         FROM                                                     14150000
141600             TKRPRPM                                              14160000
141700         WHERE                                                    14170000
141800             LOC_ID                   = :KRPRPM-LOC-ID            14180000
141900         AND INTFC_SYS_CDE            = 'DLX'                     14190000
142000         AND SYS_PRC_FUNC_CDE         = 'DLPLDI'                  14200000
142100         AND CURRENT TIMESTAMP BETWEEN                            14210000
142200             FUNC_BEG_TMST AND FUNC_END_TMST                      14220000
142300         WITH UR                                                  14230000
142400     END-EXEC.                                                    14240000
142500                                                                  14250000
142600     EVALUATE TRUE                                                14260000
142700         WHEN SQLCODE = ZERO                                      14270000
142800             CONTINUE                                             14280000
142900         WHEN OTHER                                               14290000
143000***                                                               14300000
143100*** DMH ADDED DISPLAYS - 8/21/2007                                14310000
143200***                                                               14320000
143300             MOVE SQLCODE             TO  PV-DISP-SQLCODE         14330000
143400             MOVE KRPRPM-LOC-ID       TO  PV-DISP-OPER            14340000
143500             DISPLAY ' PCKUT072 - 7030 - '                        14350000
143600                     ' SQLCODE: '         PV-DISP-SQLCODE         14360000
143700                     ' TKRPRPM '                                  14370000
143800             DISPLAY ' PCKUT072 - 7030 - '                        14380000
143900                     ' OPER: '            PV-DISP-OPER            14390000
144000                     ' DLX  DLPLDI'                               14400000
144100***                                                               14410000
144200              MOVE  PC243-COMMAREA  TO  PV-PC243-RECORD           14420000
144300              MOVE  PV-PC243-1-100  TO  PV-LOG-MSG                14430000
144400              PERFORM 9900-WRITE-LOG                              14440000
144500              MOVE  SPACES          TO  PV-LOG-MSG                14450000
144600              MOVE  PV-PC243-2-200  TO  PV-LOG-MSG                14460000
144700              PERFORM 9900-WRITE-LOG                              14470000
144800              MOVE  SPACES          TO  PV-LOG-MSG                14480000
144900                                                                  14490000
145000             MOVE '7030-'             TO PV-ERROR-PARA            14500000
145100             MOVE SQLCODE             TO PV-DISP-SQLCODE          14510000
145200             STRING                                               14520000
145300                  'SQL TKRPRPM'                                   14530000
145400                  '='  PV-DISP-SQLCODE '  '                       14540000
145500                  PC243-DC-NBR                                    14550000
145600                  ' CART='                                        14560000
145700                  PC243-BOX-BAR-CODE-NBR                          14570000
145800                                 DELIMITED BY SIZE                14580000
145900                                    INTO PV-ERROR-TEXT            14590000
146000             PERFORM 9700-SQL-ERROR                               14600000
146100                                                                  14610000
146200     END-EVALUATE.                                                14620000
146300                                                                  14630000
146400                                                                  14640000
146500***************************************************************** 14650000
146600* CHECK PARM TABLE TO SEE IF WE SHOULD LOG THE CARTON DIRECTIVE * 14660000
146700* GENERATED FOR RFID - THESE WILL BE SENT TO TUPLDER DATABASE   * 14670000
146800* DMH - WR-41309   08/27/12                                     * 14680000
146900***************************************************************** 14690000
147000 7040-SELECT-TKRPRPM-RFID.                                        14700000
147100                                                                  14710000
147200     IF KRPRPM-FUNC-TXT = 'Y'                                     14720000
147300         MOVE ' PCKUT072 START 7040- PARA '     TO PV-LOG-MSG     14730000
147400         PERFORM 9900-WRITE-LOG                                   14740000
147500     END-IF.                                                      14750000
147600                                                                  14760000
147700     SET  PS-LOG-RFID-TUPLDER-NO      TO TRUE                     14770000
147800     MOVE PC243-DC-NBR                TO KRPRPM-LOC-ID.           14780000
147900                                                                  14790000
148000     EXEC SQL                                                     14800000
148100         SELECT FUNC_TXT                                          14810000
148200         INTO :PS-LOG-RFID-TUPLDER-SW                             14820000
148300         FROM                                                     14830000
148400             TKRPRPM                                              14840000
148500         WHERE                                                    14850000
148600             LOC_ID                   = :KRPRPM-LOC-ID            14860000
148700         AND INTFC_SYS_CDE            = 'KHL'                     14870000
148800         AND SYS_PRC_FUNC_CDE         = 'P2LRFD'                  14880000
148900         AND FUNC_PRC_STAT_CDE        = 'AC'                      14890000
149000         AND CURRENT TIMESTAMP BETWEEN                            14900000
149100             FUNC_BEG_TMST AND FUNC_END_TMST                      14910000
149200         WITH UR                                                  14920000
149300     END-EXEC.                                                    14930000
149400                                                                  14940000
149500     EVALUATE TRUE                                                14950000
149600         WHEN SQLCODE = ZERO                                      14960000
149700         WHEN SQLCODE = +100                                      14970000
149800             CONTINUE                                             14980000
149900         WHEN OTHER                                               14990000
150000                                                                  15000000
150100             MOVE SQLCODE             TO  PV-DISP-SQLCODE         15010000
150200             MOVE KRPRPM-LOC-ID       TO  PV-DISP-OPER            15020000
150300             DISPLAY ' PCKUT072 - 7040 - '                        15030000
150400                     ' SQLCODE: '         PV-DISP-SQLCODE         15040000
150500                     ' TKRPRPM '                                  15050000
150600             DISPLAY ' PCKUT072 - 7040 - '                        15060000
150700                     ' OPER: '            PV-DISP-OPER            15070000
150800                     ' KHL  P2LRFD'                               15080000
150900                                                                  15090000
151000              MOVE  PC243-COMMAREA  TO  PV-PC243-RECORD           15100000
151100              MOVE  PV-PC243-1-100  TO  PV-LOG-MSG                15110000
151200              PERFORM 9900-WRITE-LOG                              15120000
151300              MOVE  SPACES          TO  PV-LOG-MSG                15130000
151400              MOVE  PV-PC243-2-200  TO  PV-LOG-MSG                15140000
151500              PERFORM 9900-WRITE-LOG                              15150000
151600              MOVE  SPACES          TO  PV-LOG-MSG                15160000
151700                                                                  15170000
151800             MOVE '7040-'             TO PV-ERROR-PARA            15180000
151900             MOVE SQLCODE             TO PV-DISP-SQLCODE          15190000
152000             STRING                                               15200000
152100                  'SQL TKRPRPM'                                   15210000
152200                  '='  PV-DISP-SQLCODE '  '                       15220000
152300                  PC243-DC-NBR                                    15230000
152400                  ' CART='                                        15240000
152500                  PC243-BOX-BAR-CODE-NBR                          15250000
152600                                 DELIMITED BY SIZE                15260000
152700                                    INTO PV-ERROR-TEXT            15270000
152800             PERFORM 9700-SQL-ERROR                               15280000
152900                                                                  15290000
153000     END-EVALUATE.                                                15300000
153100                                                                  15310000
153200                                                                  15320000
153300***************************************************************** 15330000
153400* CHECK TO SEE IF A CARTON DIRECTIVE HAS ALREADY BEEN CREATED   * 15340000
153500* FOR THE CARTON - ONLY ONE IS NEEDED.                          * 15350000
153600* DMH - WR-41309   08/27/12                                     * 15360000
153700***************************************************************** 15370000
153800 7045-CHECK-FOR-DIRECTV.                                          15380000
153900                                                                  15390000
154000     IF KRPRPM-FUNC-TXT = 'Y'                                     15400000
154100         MOVE ' PCKUT072 START 7045- PARA '     TO PV-LOG-MSG     15410000
154200         PERFORM 9900-WRITE-LOG                                   15420000
154300     END-IF.                                                      15430000
154400                                                                  15440000
154500     MOVE PC243-BOX-BAR-CODE-NBR  TO  SUT00102-BRCDE-NBR          15450000
154600     MOVE PC243-BOX-BAR-CODE-NBR  TO  SUT00102-SHIPT-UNT-ID       15460000
154700                                                                  15470000
154800     EXEC SQL                                                     15480000
154900         SELECT  CART_STAT_CDE                                    15490000
155000           INTO :SUT00102-CART-STAT-CDE                           15500000
155100           FROM  SUT_CART_DIRV_TRKG                               15510000
155200          WHERE (BRCDE_NBR       = :SUT00102-BRCDE-NBR   OR       15520000
155300                 SHIPT_UNT_ID    = :SUT00102-SHIPT-UNT-ID         15530000
155400                )                                                 15540000
155500         WITH UR                                                  15550000
155600     END-EXEC.                                                    15560000
155700                                                                  15570000
155800     EVALUATE TRUE                                                15580000
155900         WHEN SQLCODE = ZERO                                      15590000
156000         WHEN SQLCODE = -811                                      15600000
156100              SET  PV-DIRECTIVE-NEEDED-NO TO TRUE                 15610000
156200              IF  KRPRPM-FUNC-TXT = 'Y'                           15620000
156300                  DISPLAY 'CARTON HAS PREVIOUS DIRECTIVE:'        15630000
156400                           PC243-BOX-BAR-CODE-NBR                 15640000
156500              END-IF                                              15650000
156600                                                                  15660000
156700         WHEN SQLCODE = +100                                      15670000
156800             CONTINUE                                             15680000
156900                                                                  15690000
157000         WHEN OTHER                                               15700000
157100                                                                  15710000
157200             MOVE SQLCODE             TO  PV-DISP-SQLCODE         15720000
157300             DISPLAY ' PCKUT072 - 7045 - '                        15730000
157400                     ' SQLCODE: '         PV-DISP-SQLCODE         15740000
157500                     ' SUT_CART_DIRV_TRKG'                        15750000
157600             DISPLAY ' PCKUT072 - 7045 - '                        15760000
157700                     ' SML: '    PC243-BOX-BAR-CODE-NBR           15770000
157800                                                                  15780000
157900              MOVE  PC243-COMMAREA  TO  PV-PC243-RECORD           15790000
158000              MOVE  PV-PC243-1-100  TO  PV-LOG-MSG                15800000
158100              PERFORM 9900-WRITE-LOG                              15810000
158200              MOVE  SPACES          TO  PV-LOG-MSG                15820000
158300              MOVE  PV-PC243-2-200  TO  PV-LOG-MSG                15830000
158400              PERFORM 9900-WRITE-LOG                              15840000
158500              MOVE  SPACES          TO  PV-LOG-MSG                15850000
158600                                                                  15860000
158700             MOVE '7045-'             TO PV-ERROR-PARA            15870000
158800             MOVE SQLCODE             TO PV-DISP-SQLCODE          15880000
158900             STRING                                               15890000
159000                  'SQL SUT_CART_DIRV_TRKG'                        15900000
159100                  '='  PV-DISP-SQLCODE '  '                       15910000
159200                  PC243-DC-NBR                                    15920000
159300                  ' CART='                                        15930000
159400                  PC243-BOX-BAR-CODE-NBR                          15940000
159500                                 DELIMITED BY SIZE                15950000
159600                                    INTO PV-ERROR-TEXT            15960000
159700             PERFORM 9700-SQL-ERROR                               15970000
159800                                                                  15980000
159900     END-EVALUATE.                                                15990000
160000                                                                  16000000
160100                                                                  16010000
160200***************************************************************** 16020000
160300*                                                               * 16030000
160400*                                                               * 16040000
160500***************************************************************** 16050000
160600 7050-SELECT-TP2LMOD.                                             16060000
160700     IF KRPRPM-FUNC-TXT = 'Y'                                     16070000
160800         MOVE ' PCKUT072 START 7050- PARA '     TO PV-LOG-MSG     16080000
160900         PERFORM 9900-WRITE-LOG                                   16090000
161000     END-IF.                                                      16100000
161100                                                                  16110000
161200     SET PS-PICK-FROM-WORKSTATION-NO                              16120000
161300         PC243-SUCCESSFUL            TO TRUE                      16130000
161400                                                                  16140000
161500     MOVE PC243-DC-NBR               TO DK-OPER-UNT-ID.           16150000
161600     EXEC SQL                                                     16160000
161700         SELECT                                                   16170000
161800             MODU_NBR                                             16180000
161900            ,DFLT_STR_ZN_ID                                       16190000
162000            ,MODU_MDSE_TYP_CDE                                    16200000
162100         INTO                                                     16210000
162200             :P2LMOD-MODU-NBR                                     16220000
162300            ,:P2LMOD-DFLT-STR-ZN-ID                               16230000
162400            ,:P2LMOD-MODU-MDSE-TYP-CDE                            16240000
162500         FROM                                                     16250000
162600             TP2LMOD                                              16260000
162700         WHERE                                                    16270000
162800             OPER_UNT_ID              = :DK-OPER-UNT-ID           16280000
162900         AND FCLTY_ID                 = 1                         16290000
163000         AND MODU_NBR                 = :DK-MODU-NBR              16300000
163100         WITH UR                                                  16310000
163200     END-EXEC.                                                    16320000
163300                                                                  16330000
163400     EVALUATE TRUE                                                16340000
163500         WHEN SQLCODE = ZERO                                      16350000
163600             CONTINUE                                             16360000
163700         WHEN SQLCODE = +100                                      16370000
163800                                                                  16380000
163900*** DMH ADDED 9/12/07 - BYPASS 0 MOD WITH 0 UNITS                 16390000
164000*** THESE ARE CAUSED BY THE P2L SUP COMPLETING AN                 16400000
164100*** ORDER FROM THE WORKSTATION. NO LABOR CREDIT FOR THESE.        16410000
164200             IF  DK-MODU-NBR  =  0  AND                           16420000
164300                 PC243-PICKED-QTY  =  0                           16430000
164400                 SET  PS-PICK-FROM-WORKSTATION                    16440000
164500                      PC243-SUCCESSFUL         TO TRUE            16450000
164600             ELSE                                                 16460000
164700                 MOVE SQLCODE         TO  PV-DISP-SQLCODE         16470000
164800                 MOVE DK-OPER-UNT-ID  TO  PV-DISP-OPER            16480000
164900                 DISPLAY ' PCKUT072 - 7050 - '                    16490000
165000                         ' SQLCODE: '     PV-DISP-SQLCODE         16500000
165100                         ' TP2LMOD '                              16510000
165200                 DISPLAY ' PCKUT072 - 7050 - '                    16520000
165300                         ' OPER: '        PV-DISP-OPER            16530000
165400                         ' MODULE: '      DK-MODU-NBR             16540000
165500                 MOVE '7050-'             TO PV-ERROR-PARA        16550000
165600                 MOVE 'STR ZN NOTFOUND'   TO PV-ERROR-TEXT        16560000
165700                 PERFORM 9700-SQL-ERROR                           16570000
165800                 MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC       16580000
165900                 MOVE DK-MODU-NBR         TO PV-MSG-MODU          16590000
166000                 MOVE PV-MODU-TEXT        TO PV-LOG-MSG           16600000
166100                 PERFORM 9900-WRITE-LOG                           16610000
166200             END-IF                                               16620000
166300                                                                  16630000
166400         WHEN SQLCODE = -904                                      16640000
166500         WHEN SQLCODE = -913                                      16650000
166600         WHEN SQLCODE = -911                                      16660000
166700***                                                               16670000
166800*** DMH ADDED DISPLAYS - 8/21/2007                                16680000
166900***                                                               16690000
167000             MOVE SQLCODE             TO  PV-DISP-SQLCODE         16700000
167100             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            16710000
167200             DISPLAY ' PCKUT072 - 7050 - '                        16720000
167300                     ' SQLCODE: '         PV-DISP-SQLCODE         16730000
167400                     ' TP2LMOD '                                  16740000
167500             DISPLAY ' PCKUT072 - 7050 - '                        16750000
167600                     ' OPER: '            PV-DISP-OPER            16760000
167700                     ' MODULE: '          DK-MODU-NBR             16770000
167800***                                                               16780000
167900             MOVE '7050-'             TO PV-ERROR-PARA            16790000
168000             MOVE 'SQL ERROR - TP2LMOD'                           16800000
168100                                      TO PV-ERROR-TEXT            16810000
168200             PERFORM 9700-SQL-ERROR                               16820000
168300             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           16830000
168400             MOVE DK-MODU-NBR         TO PV-MSG-MODU              16840000
168500             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               16850000
168600             PERFORM 9900-WRITE-LOG                               16860000
168700                                                                  16870000
168800         WHEN SQLWARN0 NOT = SPACES                               16880000
168900         WHEN SQLCODE NOT = ZERO                                  16890000
169000***                                                               16900000
169100*** DMH ADDED DISPLAYS - 8/21/2007                                16910000
169200***                                                               16920000
169300             MOVE SQLCODE             TO  PV-DISP-SQLCODE         16930000
169400             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            16940000
169500             DISPLAY ' PCKUT072 - 7050 - '                        16950000
169600                     ' SQLCODE: '         PV-DISP-SQLCODE         16960000
169700                     ' TP2LMOD '                                  16970000
169800             DISPLAY ' PCKUT072 - 7050 - '                        16980000
169900                     ' OPER: '            PV-DISP-OPER            16990000
170000                     ' MODULE: '          DK-MODU-NBR             17000000
170100***                                                               17010000
170200             MOVE '7050-'             TO PV-ERROR-PARA            17020000
170300             MOVE 'SQL ERROR - TP2LMOD'                           17030000
170400                                      TO PV-ERROR-TEXT            17040000
170500             PERFORM 9700-SQL-ERROR                               17050000
170600             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           17060000
170700             MOVE DK-MODU-NBR         TO PV-MSG-MODU              17070000
170800             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               17080000
170900             PERFORM 9900-WRITE-LOG                               17090000
171000                                                                  17100000
171100     END-EVALUATE.                                                17110000
171200     IF KRPRPM-FUNC-TXT = 'Y'                                     17120000
171300         MOVE ' PCKUT072 END 7050- PARA '     TO PV-LOG-MSG       17130000
171400         PERFORM 9900-WRITE-LOG                                   17140000
171500     END-IF.                                                      17150000
171600/                                                                 17160000
171700*** RLK - CHG0055296 - CHECK FOR RFID                             17170000
171800***************************************************************** 17180000
171900*  NEW PARM IT CAN BE TURNED ON OR OFF TO DETERMINE IF RFID     * 17190000
172000*  WILL BE CHECKED                                              * 17200000
172100***************************************************************** 17210000
172200 7060-SELECT-TKRPRPM.                                             17220000
172300                                                                  17230000
172400     MOVE PC243-DC-NBR                TO KRPRPM-LOC-ID.           17240000
172500                                                                  17250000
172600     EXEC SQL                                                     17260000
172700         SELECT FUNC_TXT                                          17270000
172800         INTO :PS-RFID-CHECK-SW                                   17280000
172900         FROM                                                     17290000
173000             TKRPRPM                                              17300000
173100         WHERE                                                    17310000
173200             LOC_ID                   = :KRPRPM-LOC-ID            17320000
173300         AND INTFC_SYS_CDE            = 'KHL'                     17330000
173400         AND SYS_PRC_FUNC_CDE         = 'RFIDP2'                  17340000
173500         AND FUNC_PRC_STAT_CDE        = 'AC'                      17350000
173600         AND CURRENT TIMESTAMP BETWEEN                            17360000
173700             FUNC_BEG_TMST AND FUNC_END_TMST                      17370000
173800         WITH UR                                                  17380000
173900     END-EXEC.                                                    17390000
174000                                                                  17400000
174100     EVALUATE TRUE                                                17410000
174200         WHEN SQLCODE = ZERO                                      17420000
174300             CONTINUE                                             17430000
174400         WHEN OTHER                                               17440000
174500             MOVE SQLCODE             TO  PV-DISP-SQLCODE         17450000
174600             MOVE KRPRPM-LOC-ID       TO  PV-DISP-OPER            17460000
174700             DISPLAY ' PCKUT072 - 7060 - '                        17470000
174800                     ' SQLCODE: '         PV-DISP-SQLCODE         17480000
174900                     ' TKRPRPM '                                  17490000
175000             DISPLAY ' PCKUT072 - 7060 - '                        17500000
175100                     ' OPER: '            PV-DISP-OPER            17510000
175200                     ' DLX  DLPLDI'                               17520000
175300**                                                                17530000
175400              MOVE  PC243-COMMAREA  TO  PV-PC243-RECORD           17540000
175500              MOVE  PV-PC243-1-100  TO  PV-LOG-MSG                17550000
175600              PERFORM 9900-WRITE-LOG                              17560000
175700              MOVE  SPACES          TO  PV-LOG-MSG                17570000
175800              MOVE  PV-PC243-2-200  TO  PV-LOG-MSG                17580000
175900              PERFORM 9900-WRITE-LOG                              17590000
176000              MOVE  SPACES          TO  PV-LOG-MSG                17600000
176100                                                                  17610000
176200             MOVE '7060-'             TO PV-ERROR-PARA            17620000
176300             MOVE SQLCODE             TO PV-DISP-SQLCODE          17630000
176400             STRING                                               17640000
176500                  'SQL TKRPRPM'                                   17650000
176600                  '='  PV-DISP-SQLCODE '  '                       17660000
176700                  PC243-DC-NBR                                    17670000
176800                  ' CART='                                        17680000
176900                  PC243-BOX-BAR-CODE-NBR                          17690000
177000                                 DELIMITED BY SIZE                17700000
177100                                    INTO PV-ERROR-TEXT            17710000
177200             PERFORM 9700-SQL-ERROR                               17720000
177300                                                                  17730000
177400     END-EVALUATE.                                                17740000
177500*** RLK - CHG0055296 - CHECK FOR RFID                             17750000
177600                                                                  17760000
177700                                                                  17770000
177800 7100-KOHLS-USER.                                                 17780000
177900                                                                  17790000
178000     IF KRPRPM-FUNC-TXT = 'Y'                                     17800000
178100         MOVE ' PCKUT072 START 7100- PARA '     TO PV-LOG-MSG     17810000
178200         PERFORM 9900-WRITE-LOG                                   17820000
178300     END-IF.                                                      17830000
178400                                                                  17840000
178500     SET PS-USER-FOUND-NO             TO TRUE                     17850000
178600     MOVE PV-PICKER-ID                TO XLT00024-USR-ID          17860000
178700                                                                  17870000
178800                                                                  17880000
178900     EXEC SQL                                                     17890000
179000         SELECT  'Y'                                              17900000
179100              INTO  :PS-USER-FOUND-SW                             17910000
179200              FROM   XLT_USR    USR                               17920000
179300          WHERE  USR.USR_ID       = :XLT00024-USR-ID              17930000
179400          WITH UR                                                 17940000
179500     END-EXEC                                                     17950000
179600                                                                  17960000
179700     EVALUATE TRUE                                                17970000
179800         WHEN SQLCODE = ZERO                                      17980000
179900             SET XL067-USER-IS-KOHLS  TO TRUE                     17990000
180000                                                                  18000000
180100              IF KRPRPM-FUNC-TXT = 'Y'                            18010000
180200                 MOVE ' PCKUT072 START 7100- KOHLS ASSOCIATE'     18020000
180300                                            TO PV-LOG-MSG         18030000
180400                 PERFORM 9900-WRITE-LOG                           18040000
180500               END-IF                                             18050000
180600                                                                  18060000
180700         WHEN SQLCODE = +100                                      18070000
180800                                                                  18080000
180900              IF KRPRPM-FUNC-TXT = 'Y'                            18090000
181000                 MOVE ' PCKUT072 START 7100- NOT KOHLS ASSOCIATE' 18100000
181100                                            TO PV-LOG-MSG         18110000
181200                 PERFORM 9900-WRITE-LOG                           18120000
181300               END-IF                                             18130000
181400                                                                  18140000
181500             PERFORM 7105-TEMP-USER                               18150000
181600                                                                  18160000
181700         WHEN SQLCODE = -904                                      18170000
181800         WHEN SQLCODE = -911                                      18180000
181900         WHEN SQLCODE = -913                                      18190000
182000         WHEN SQLWARN0 NOT = SPACES                               18200000
182100              AND SQLCODE NOT = ZERO                              18210000
182200                                                                  18220000
182300             SET PS-ERROR-YES         TO TRUE                     18230000
182400             MOVE SQLCODE             TO  PV-DISP-SQLCODE         18240000
182500             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            18250000
182600             DISPLAY ' PCKUT072 - 7100 - '                        18260000
182700                     ' SQLCODE: '         PV-DISP-SQLCODE         18270000
182800                     ' TP2LMOD '                                  18280000
182900             DISPLAY ' PCKUT072 - 7100 - '                        18290000
183000                     ' OPER: '            PV-DISP-OPER            18300000
183100                     ' MODULE: '          DK-MODU-NBR             18310000
183200                                                                  18320000
183300             MOVE '7100-'             TO PV-ERROR-PARA            18330000
183400             MOVE 'SQL ERROR - TP2LMOD'                           18340000
183500                                      TO PV-ERROR-TEXT            18350000
183600             PERFORM 9700-SQL-ERROR                               18360000
183700             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           18370000
183800             MOVE DK-MODU-NBR         TO PV-MSG-MODU              18380000
183900             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               18390000
184000             PERFORM 9900-WRITE-LOG                               18400000
184100                                                                  18410000
184200     END-EVALUATE.                                                18420000
184300/                                                                 18430000
184400 7105-TEMP-USER.                                                  18440000
184500                                                                  18450000
184600     IF KRPRPM-FUNC-TXT = 'Y'                                     18460000
184700         MOVE ' PCKUT072 START 7105- PARA '     TO PV-LOG-MSG     18470000
184800         PERFORM 9900-WRITE-LOG                                   18480000
184900     END-IF.                                                      18490000
185000                                                                  18500000
185100                                                                  18510000
185200     SET PS-USER-FOUND-NO             TO TRUE                     18520000
185300     MOVE PV-PICKER-ID                TO DLT00002-TMP-USR-ID      18530000
185400                                                                  18540000
185500     EXEC SQL                                                     18550000
185600         SELECT  'Y'                                              18560000
185700              INTO  :PS-USER-FOUND-SW                             18570000
185800              FROM   DLT_TMP_EMP                                  18580000
185900          WHERE  TMP_USR_ID       = :DLT00002-TMP-USR-ID          18590000
186000          WITH UR                                                 18600000
186100     END-EXEC                                                     18610000
186200                                                                  18620000
186300     EVALUATE TRUE                                                18630000
186400         WHEN SQLCODE = ZERO                                      18640000
186500             SET XL067-USER-IS-TEMP TO TRUE                       18650000
186600                                                                  18660000
186700              IF KRPRPM-FUNC-TXT = 'Y'                            18670000
186800                 MOVE ' PCKUT072 START 7105- TEMP ASSOCIATE'      18680000
186900                                            TO PV-LOG-MSG         18690000
187000                 PERFORM 9900-WRITE-LOG                           18700000
187100               END-IF                                             18710000
187200                                                                  18720000
187300                                                                  18730000
187400         WHEN SQLCODE = +100                                      18740000
187500             SET PS-ERROR-YES                                     18750000
187600                 XL067-USER-NOT-FOUND                             18760000
187700                 PC243-UNKNOWN-USER   TO TRUE                     18770000
187800                                                                  18780000
187900              IF KRPRPM-FUNC-TXT = 'Y'                            18790000
188000                 MOVE ' PCKUT072 START 7105- NOT FOUND ASSOC'     18800000
188100                                            TO PV-LOG-MSG         18810000
188200                 PERFORM 9900-WRITE-LOG                           18820000
188300               END-IF                                             18830000
188400                                                                  18840000
188500         WHEN SQLCODE = -904                                      18850000
188600         WHEN SQLCODE = -911                                      18860000
188700         WHEN SQLCODE = -913                                      18870000
188800         WHEN SQLWARN0 NOT = SPACES                               18880000
188900              AND SQLCODE NOT = ZERO                              18890000
189000                                                                  18900000
189100             MOVE SQLCODE             TO  PV-DISP-SQLCODE         18910000
189200             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            18920000
189300             DISPLAY ' PCKUT072 - 7105 - '                        18930000
189400                     ' SQLCODE: '         PV-DISP-SQLCODE         18940000
189500                     ' TP2LMOD '                                  18950000
189600             DISPLAY ' PCKUT072 - 7105 - '                        18960000
189700                     ' OPER: '            PV-DISP-OPER            18970000
189800                     ' MODULE: '          DK-MODU-NBR             18980000
189900                                                                  18990000
190000             MOVE '7105-'             TO PV-ERROR-PARA            19000000
190100             MOVE 'SQL ERROR - TP2LMOD'                           19010000
190200                                      TO PV-ERROR-TEXT            19020000
190300             PERFORM 9700-SQL-ERROR                               19030000
190400             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           19040000
190500             MOVE DK-MODU-NBR         TO PV-MSG-MODU              19050000
190600             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               19060000
190700             PERFORM 9900-WRITE-LOG                               19070000
190800                                                                  19080000
190900     END-EVALUATE.                                                19090000
191000/                                                                 19100000
191100                                                                  19110000
191200 8400-CALL-DLKUP024.                                              19120000
191300     IF KRPRPM-FUNC-TXT = 'Y'                                     19130000
191400         MOVE ' PCKUT072 START 8400- PARA '     TO PV-LOG-MSG     19140000
191500         PERFORM 9900-WRITE-LOG                                   19150000
191600     END-IF.                                                      19160000
191700                                                                  19170000
191800     INITIALIZE DL020-ASGMT-COMMAREA.                             19180000
191900                                                                  19190000
192000     SET DL020-BY-ASGMT-KEY                                       19200000
192100         DL020-COMMIT-UPDATE                                      19210000
192200         DL020-FIND-NEXT-ASGMT        TO TRUE.                    19220000
192300                                                                  19230000
192400     MOVE DL019-ESO-ASGMT-START-DTE   TO DL020-KEY-START-DTE      19240000
192500                                         PV-LABOR-ASGMT-STRT-DTE. 19250000
192600     MOVE DL019-ESO-ASGMT-NBR-TXT     TO DL020-KEY-NBR-TXT        19260000
192700                                         PV-LABOR-ASGMT-NBR-TXT.  19270000
192800     MOVE DL019-ESO-ASGMT-NBR-SEQ-NBR TO DL020-KEY-NBR-SEQ-NBR    19280000
192900                                       PV-LABOR-ASGMT-NBR-SEQ-NBR.19290000
193000                                                                  19300000
193100     IF PC243-EXP-PICK-ORDER-QTY =  PC243-PICKED-QTY              19310000
193200         MOVE 1                    TO DL020-NBR-OF-NBRS-NEED-QTY  19320000
193300     ELSE                                                         19330000
193400         MOVE 2                    TO DL020-NBR-OF-NBRS-NEED-QTY  19340000
193500     END-IF.                                                      19350000
193600     MOVE 'PCKUT072'               TO DL020-ORIG-CALLING-PGM-NM.  19360000
193700                                                                  19370000
193800     CALL DL020-USER-PGM USING DL020-ASGMT-COMMAREA.              19380000
193900                                                                  19390000
194000     IF DL020-SUCCESSFUL                                          19400000
194100         IF DL020-ASGMT-NEXT-USED                                 19410000
194200             MOVE DL020-NXT-START-DTE                             19420000
194300                                   TO PV-LABOR-ASGMT-STRT-DTE     19430000
194400             MOVE DL020-NXT-NBR-TXT                               19440000
194500                                   TO PV-LABOR-ASGMT-NBR-TXT      19450000
194600             MOVE DL020-NXT-NBR-SEQ-NBR                           19460000
194700                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  19470000
194800             MOVE DL020-SEQ-START-NBR                             19480000
194900                                   TO PV-LABOR-SEQ-START-NBR      19490000
195000         ELSE                                                     19500000
195100             MOVE DL020-SEQ-START-NBR                             19510000
195200                                   TO PV-LABOR-SEQ-START-NBR      19520000
195300         END-IF                                                   19530000
195400                                                                  19540000
195500     ELSE                                                         19550000
195600         MOVE '8400-'                 TO PV-ERROR-PARA            19560000
195700         MOVE 'SQL ERROR IN DLKUP024'                             19570000
195800                                      TO PV-ERROR-TEXT            19580000
195900         MOVE DL020-SQLCA             TO SQLCA                    19590000
196000         PERFORM 9700-SQL-ERROR                                   19600000
196100                                                                  19610000
196200         MOVE DL020-KEY-START-DTE     TO PV-DLKUP024-DATE         19620000
196300         MOVE DL020-KEY-NBR-TXT       TO PV-DLKUP024-TXT          19630000
196400         MOVE DL020-KEY-NBR-SEQ-NBR   TO PV-DLKUP024-SEQ          19640000
196500         MOVE PV-DLKUP024-TEXT        TO PV-LOG-MSG               19650000
196600         PERFORM 9900-WRITE-LOG                                   19660000
196700                                                                  19670000
196800         STRING ' PARA= '                                         19680000
196900                DL020-SQL-ERROR-PARA                              19690000
197000                 ' PGM= '                                         19700000
197100               DL020-CALL-MOD-FAIL-NM                             19710000
197200                 ' ERR CODE= '                                    19720000
197300               DL020-CALL-MOD-FAIL-ERR-CDE                        19730000
197400                 DELIMITED BY SIZE INTO PV-LOG-MSG                19740000
197500         PERFORM 9900-WRITE-LOG                                   19750000
197600                                                                  19760000
197700     END-IF.                                                      19770000
197800     IF KRPRPM-FUNC-TXT = 'Y'                                     19780000
197900         MOVE ' PCKUT072 END 8400- PARA '     TO PV-LOG-MSG       19790000
198000         PERFORM 9900-WRITE-LOG                                   19800000
198100     END-IF.                                                      19810000
198200/                                                                 19820000
198300 8410-CALL-XLKUP046.                                              19830000
198400     IF KRPRPM-FUNC-TXT = 'Y'                                     19840000
198500         MOVE ' PCKUT072 START 8410- PARA '     TO PV-LOG-MSG     19850000
198600         PERFORM 9900-WRITE-LOG                                   19860000
198700     END-IF.                                                      19870000
198800                                                                  19880000
198900     INITIALIZE XL091-EAI-EXPORT-COMMAREA                         19890000
199000                PC242-DTL-TXT-AREA.                               19900000
199100                                                                  19910000
199200     SET XL091-PC-APP-ID          TO TRUE.                        19920000
199300     SET XL091-COMMIT-UPDATE      TO TRUE.                        19930000
199400                                                                  19940000
199500     MOVE 'PCKUT072'              TO XL091-ORIG-CALLING-PGM-NM.   19950000
199600     MOVE 'PACKTOLIGHT'           TO XL091-EVNT-OBJ-TXT           19960000
199700     MOVE 'PICKMADE'              TO XL091-EVNT-OBJ-ACTN-TXT.     19970000
199800     MOVE PV-PICKER-ID            TO XL091-CRE-BY-USR-ID.         19980000
199900     MOVE 'PCKUT072'              TO XL091-CRE-PGM-NM.            19990000
200000                                                                  20000000
200100     MOVE PC243-DC-NBR            TO XL091-EVNT-KY-1-NBR.         20010000
200200     MOVE PC243-STR-NBR           TO XL091-EVNT-KY-2-NBR.         20020000
200300     MOVE PC243-HDR-ORD-NBR       TO XL091-EVNT-KY-3-NBR.         20030000
200400     MOVE PC243-HDR-RCVR-SEQ-NBR  TO XL091-EVNT-KY-4-NBR.         20040000
200500     MOVE PC243-HDR-ORD-LNE-NBR   TO XL091-EVNT-KY-5-NBR.         20050000
200600                                                                  20060000
200700     MOVE DK-MODU-NBR             TO XL091-EVNT-KY-1-TXT.         20070000
200800     MOVE PC243-BOX-BAR-CODE-NBR  TO XL091-EVNT-KY-2-TXT.         20080000
200900                                                                  20090000
201000     MOVE PV-START-TIMESTAMP      TO XL091-EVNT-KY-1-TMST         20100000
201100                                                                  20110000
201200*    POPULATE DETAIL AREA                                         20120000
201300     SET XL091-PCWS242-COPYBOOK TO TRUE.                          20130000
201400                                                                  20140000
201500     INITIALIZE PC242-DTL-TXT-AREA.                               20150000
201600                                                                  20160000
201700     SET PC242-P2L-PICK-MADE          TO TRUE.                    20170000
201800                                                                  20180000
201900     MOVE PV-LABOR-ASGMT-STRT-DTE     TO PC242-AJ-ASGMT-STRT-DTE. 20190000
202000     MOVE PV-LABOR-ASGMT-NBR-TXT      TO PC242-AJ-ASGMT-NBR-TXT.  20200000
202100     MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR  TO                          20210000
202200                                   PC242-AJ-ASGMT-NBR-SEQ-NBR.    20220000
202300     MOVE PV-LABOR-SEQ-START-NBR      TO                          20230000
202400                                   PC242-AJ-ASGMT-SEQ-DTL-NBR.    20240000
202500     IF PC243-EXP-PICK-ORDER-QTY NOT EQUAL PC243-PICKED-QTY       20250000
202600         COMPUTE PC242-AJ-ASGMT-SEQ-DTL-NBR-2 =                   20260000
202700              PV-LABOR-SEQ-START-NBR + 1                          20270000
202800     END-IF.                                                      20280000
202900                                                                  20290000
203000     MOVE P2LMOD-DFLT-STR-ZN-ID TO PC242-AJ-STR-ZN-ID.            20300000
203100     IF PC243-INNER-PK-YES                                        20310000
203200         PERFORM 8410A-CALC-PACK-QTYS                             20320000
203300         SET PC242-AJ-INNER-PK-YES    TO TRUE                     20330000
203400     ELSE                                                         20340000
203500         PERFORM 8410B-NON-PACK                                   20350000
203600         SET PC242-AJ-INNER-PK-NO     TO TRUE                     20360000
203700     END-IF.                                                      20370000
203800                                                                  20380000
203900     MOVE PC243-INNER-PK-QTY          TO PC242-AJ-INNER-PK-QTY.   20390000
204000                                                                  20400000
204100     MOVE PC242-DTL-TXT-AREA          TO XL091-DTL-TXT.           20410000
204200                                                                  20420000
204300     CALL XL091-USER-PGM USING XL091-EAI-EXPORT-COMMAREA.         20430000
204400                                                                  20440000
204500     IF XL091-SUCCESSFUL                                          20450000
204600        CONTINUE                                                  20460000
204700     ELSE                                                         20470000
204800         MOVE PV-PICKER-ID            TO PV-XLKUP046-USER         20480000
204900                                                                  20490000
205000         MOVE 'PACKTOLIGHT'           TO PV-XLKUP046-OBJTXT       20500000
205100         MOVE PV-XLKUP046-TEXT1       TO PV-LOG-MSG               20510000
205200         PERFORM 9900-WRITE-LOG                                   20520000
205300                                                                  20530000
205400         MOVE 'PICKMADE'              TO PV-XLKUP046-OBJACTNTXT   20540000
205500         MOVE PV-XLKUP046-TEXT2       TO PV-LOG-MSG               20550000
205600         PERFORM 9900-WRITE-LOG                                   20560000
205700                                                                  20570000
205800         IF XL091-SQL-ERROR                                       20580000
205900             MOVE '8410-'             TO PV-ERROR-PARA            20590000
206000             MOVE 'SQL ERROR IN XLKUP046'                         20600000
206100                                      TO PV-ERROR-TEXT            20610000
206200             MOVE XL091-SQLCA         TO SQLCA                    20620000
206300             PERFORM 9700-SQL-ERROR                               20630000
206400                                                                  20640000
206500             MOVE XL091-EAI-DB-SQLCODE TO  PV-DISP-SQLCODE        20650000
206600                                                                  20660000
206700             STRING                                               20670000
206800            ' XL091-SQL-ERROR-PARA = '                            20680000
206900              XL091-SQL-ERROR-PARA                                20690000
207000                                   DELIMITED BY SIZE              20700000
207100                                   INTO PV-LOG-MSG                20710000
207200                  PERFORM 9900-WRITE-LOG                          20720000
207300                                                                  20730000
207400             STRING                                               20740000
207500            ' XL091-EAI-DB-SQLCODE       = '                      20750000
207600              PV-DISP-SQLCODE                                     20760000
207700                                   DELIMITED BY SIZE              20770000
207800                                   INTO PV-LOG-MSG                20780000
207900                  PERFORM 9900-WRITE-LOG                          20790000
208000                                                                  20800000
208100             STRING                                               20810000
208200            ' XL091-CALL-MOD-FAIL-ERR-CDE = '                     20820000
208300              XL091-CALL-MOD-FAIL-ERR-CDE                         20830000
208400                                   DELIMITED BY SIZE              20840000
208500                                   INTO PV-LOG-MSG                20850000
208600              PERFORM 9900-WRITE-LOG                              20860000
208700                                                                  20870000
208800         END-IF                                                   20880000
208900     END-IF.                                                      20890000
209000                                                                  20900000
209100     IF KRPRPM-FUNC-TXT = 'Y'                                     20910000
209200         MOVE ' PCKUT072 END 8410- PARA '     TO PV-LOG-MSG       20920000
209300         PERFORM 9900-WRITE-LOG                                   20930000
209400     END-IF.                                                      20940000
209500                                                                  20950000
209600 8410A-CALC-PACK-QTYS.                                            20960000
209700     IF KRPRPM-FUNC-TXT = 'Y'                                     20970000
209800         MOVE ' PCKUT072 START 8410A- PARA '     TO PV-LOG-MSG    20980000
209900         PERFORM 9900-WRITE-LOG                                   20990000
210000     END-IF.                                                      21000000
210100                                                                  21010000
210200     COMPUTE PV-EXP-PICK-QTY =                                    21020000
210300             PC243-EXP-PICK-ORDER-QTY / PC243-INNER-PK-QTY        21030000
210400     ON SIZE ERROR                                                21040000
210500         MOVE PC243-EXP-PICK-ORDER-QTY    TO                      21050000
210600                                   PV-EXP-PICK-QTY                21060000
210700     END-COMPUTE.                                                 21070000
210800     MOVE PV-EXP-PICK-QTY             TO                          21080000
210900                                   PC242-AJ-EXP-PICK-ORDER-QTY.   21090000
211000                                                                  21100000
211100     COMPUTE PV-PICKED-QTY = PC243-PICKED-QTY /                   21110000
211200                     PC243-INNER-PK-QTY                           21120000
211300     ON SIZE ERROR                                                21130000
211400         MOVE PC243-PICKED-QTY        TO PV-PICKED-QTY            21140000
211500     END-COMPUTE.                                                 21150000
211600     MOVE PV-PICKED-QTY               TO PC242-AJ-PICKED-QTY.     21160000
211700                                                                  21170000
211800     COMPUTE PV-TOTAL-PICKED-QTY = PC243-TOTAL-PICKED-QTY         21180000
211900                                 / PC243-INNER-PK-QTY             21190000
212000     ON SIZE ERROR                                                21200000
212100         MOVE PC243-TOTAL-PICKED-QTY  TO PV-TOTAL-PICKED-QTY      21210000
212200     END-COMPUTE.                                                 21220000
212300     MOVE PV-TOTAL-PICKED-QTY      TO PC242-AJ-TOTAL-PICKED-QTY.  21230000
212400                                                                  21240000
212500     IF PV-PICKED-QTY < ZERO                                      21250000
212600         SET PC242-AJ-PICKED-QTY-NEG  TO TRUE                     21260000
212700     ELSE                                                         21270000
212800         SET PC242-AJ-PICKED-QTY-POS  TO TRUE                     21280000
212900     END-IF.                                                      21290000
213000     IF KRPRPM-FUNC-TXT = 'Y'                                     21300000
213100         MOVE ' PCKUT072 END 8410A- PARA '     TO PV-LOG-MSG      21310000
213200         PERFORM 9900-WRITE-LOG                                   21320000
213300     END-IF.                                                      21330000
213400                                                                  21340000
213500 8410B-NON-PACK.                                                  21350000
213600     IF KRPRPM-FUNC-TXT = 'Y'                                     21360000
213700         MOVE ' PCKUT072 START 8410B- PARA '     TO PV-LOG-MSG    21370000
213800         PERFORM 9900-WRITE-LOG                                   21380000
213900     END-IF.                                                      21390000
214000     MOVE PC243-EXP-PICK-ORDER-QTY    TO                          21400000
214100                                   PC242-AJ-EXP-PICK-ORDER-QTY.   21410000
214200     MOVE PC243-TOTAL-PICKED-QTY   TO PC242-AJ-TOTAL-PICKED-QTY.  21420000
214300     MOVE PC243-PICKED-QTY            TO PC242-AJ-PICKED-QTY.     21430000
214400     IF PC243-PICKED-QTY < ZERO                                   21440000
214500         SET PC242-AJ-PICKED-QTY-NEG  TO TRUE                     21450000
214600     ELSE                                                         21460000
214700         SET PC242-AJ-PICKED-QTY-POS  TO TRUE                     21470000
214800     END-IF.                                                      21480000
214900     IF KRPRPM-FUNC-TXT = 'Y'                                     21490000
215000         MOVE ' PCKUT072 END 8410B- PARA '     TO PV-LOG-MSG      21500000
215100         PERFORM 9900-WRITE-LOG                                   21510000
215200     END-IF.                                                      21520000
215300/                                                                 21530000
215400 8450-LINK-DLKUT410.                                              21540000
215500     IF KRPRPM-FUNC-TXT = 'Y'                                     21550000
215600         MOVE ' PCKUT072 START 8450- PARA '     TO PV-LOG-MSG     21560000
215700         PERFORM 9900-WRITE-LOG                                   21570000
215800     END-IF.                                                      21580000
215900                                                                  21590000
216000     INITIALIZE DL019-PGM-COMMAREA.                               21600000
216100                                                                  21610000
216200     SET DL019-ESTABLISH-ASGMT        TO TRUE.                    21620000
216300     SET DL019-COMMIT-UPDATE          TO TRUE.                    21630000
216400     MOVE 'PCKUT072'                  TO DL019-CALLING-PGM-NM.    21640000
216500     MOVE PV-PICKER-ID                TO DL019-SIGN-ON-USR-ID.    21650000
216600                                                                  21660000
216700     SET DL011-AN-P2L-WRK-TYP         TO TRUE.                    21670000
216800     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL019-ASGMT-NBR-WRK-TYP. 21680000
216900                                                                  21690000
217000     SET DL011-P2L-WRK-TYP            TO TRUE.                    21700000
217100     MOVE DL011-KEY-WK-TYP            TO DL019-EAI-WK-TYP-DESC.   21710000
217200                                                                  21720000
217300     MOVE P2LMOD-DFLT-STR-ZN-ID       TO DL011-P2-WRK-AREA-5-9.   21730000
217400     MOVE P2LMOD-MODU-NBR             TO DL011-P2-WRK-AREA-MOD-4-621740000
217500     MOVE DL011-P2L-MOD-WRK-AREA      TO DL019-EAI-WK-AREA-DESC.  21750000
217600                                                                  21760000
217700     MOVE PC243-DC-NBR                TO DL019-EAI-DC-NBR.        21770000
217800                                                                  21780000
217900     MOVE PV-PICKER-ID                TO DL019-EAI-CRE-BY-USR-ID. 21790000
218000                                                                  21800000
218100                                                                  21810000
218200*    THIS IS KNOWN FROM THE VERIFICATION OF THE USERID            21820000
218300     IF XL067-USER-IS-KOHLS                                       21830000
218400         SET DL019-EAI-USR-IS-KOHLS   TO TRUE                     21840000
218500     ELSE                                                         21850000
218600         SET DL019-EAI-USR-IS-TMP     TO TRUE                     21860000
218700     END-IF.                                                      21870000
218800                                                                  21880000
218900     CALL DL019-USER-PGM USING DL019-PGM-COMMAREA.                21890000
219000                                                                  21900000
219100     EVALUATE TRUE                                                21910000
219200         WHEN DL019-SUCCESSFUL                                    21920000
219300                 CONTINUE                                         21930000
219400                                                                  21940000
219500         WHEN DL019-SQL-ERROR                                     21950000
219600***                                                               21960000
219700*** DMH ADDED DISPLAYS - 8/21/2007                                21970000
219800***                                                               21980000
219900             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           21990000
220000             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        22000000
220100             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    22010000
220200                                       TO PV-DISP-SQLCODE-3       22020000
220300             DISPLAY ' PCKUT072 - 8450 - CALL TO DLKUT410 - '     22030000
220400             DISPLAY ' PCKUT072 - DLWS019 '                       22040000
220500                     ' PROCESS CODE:'   DL019-PROCESS-CDE         22050000
220600                     ' COMMIT CODE:'    DL019-COMMIT-CDE          22060000
220700                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      22070000
220800                     ' USER ID:'        DL019-SIGN-ON-USR-ID      22080000
220900                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   22090000
221000             DISPLAY ' PCKUT072 - DLWS019 '                       22100000
221100                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     22110000
221200                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    22120000
221300                     ' DC:'             PV-DISP-OPER              22130000
221400                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   22140000
221500                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     22150000
221600             DISPLAY ' PCKUT072 - DLWS019 '                       22160000
221700                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 22170000
221800             DISPLAY ' PCKUT072 - DLWS019 '                       22180000
221900                     ' RETURN CODE:'     DL019-RETURN-CODE        22190000
222000                     ' SQLCODE:'         PV-DISP-SQLCODE          22200000
222100                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    22210000
222200                     '-'          DL019-CALL-MOD-FAIL-NM          22220000
222300                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     22230000
222400                     '-'          PV-DISP-SQLCODE-3               22240000
222500***                                                               22250000
222600             MOVE '8450-'             TO PV-ERROR-PARA            22260000
222700             MOVE 'SQL ERROR IN DLKUT410'                         22270000
222800                                      TO PV-ERROR-TEXT            22280000
222900             MOVE DL019-SQLCA         TO SQLCA                    22290000
223000             PERFORM 9700-SQL-ERROR                               22300000
223100                                                                  22310000
223200         WHEN DL019-CALLED-MODULE-FAILURE AND                     22320000
223300              DL019-CALL-MOD-FAIL-SQL-PARA NOT = SPACES           22330000
223400                                                                  22340000
223500***                                                               22350000
223600*** DMH ADDED DISPLAYS - 8/21/2007                                22360000
223700***                                                               22370000
223800             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           22380000
223900             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        22390000
224000             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    22400000
224100                                       TO PV-DISP-SQLCODE-3       22410000
224200             DISPLAY ' PCKUT072 - 8450 - CALL TO DLKUT410 - '     22420000
224300             DISPLAY ' PCKUT072 - DLWS019 '                       22430000
224400                     ' PROCESS CODE:'   DL019-PROCESS-CDE         22440000
224500                     ' COMMIT CODE:'    DL019-COMMIT-CDE          22450000
224600                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      22460000
224700                     ' USER ID:'        DL019-SIGN-ON-USR-ID      22470000
224800                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   22480000
224900             DISPLAY ' PCKUT072 - DLWS019 '                       22490000
225000                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     22500000
225100                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    22510000
225200                     ' DC:'             PV-DISP-OPER              22520000
225300                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   22530000
225400                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     22540000
225500             DISPLAY ' PCKUT072 - DLWS019 '                       22550000
225600                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 22560000
225700             DISPLAY ' PCKUT072 - DLWS019 '                       22570000
225800                     ' RETURN CODE:'     DL019-RETURN-CODE        22580000
225900                     ' SQLCODE:'         PV-DISP-SQLCODE          22590000
226000                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    22600000
226100                     '-'          DL019-CALL-MOD-FAIL-NM          22610000
226200                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     22620000
226300                     '-'          PV-DISP-SQLCODE-3               22630000
226400***                                                               22640000
226500             MOVE '8450-'             TO PV-ERROR-PARA            22650000
226600             SET PC243-SQL-ERROR      TO TRUE                     22660000
226700                                                                  22670000
226800*            HANDLE EACH KIND OF SQL ERROR AS NEEDED              22680000
226900             MOVE DL019-CALL-MOD-FAIL-SQL-CDE                     22690000
227000                                      TO SQLCODE                  22700000
227100                                                                  22710000
227200             IF SQLCODE = ZERO                                    22720000
227300                 CONTINUE                                         22730000
227400             ELSE                                                 22740000
227500                 PERFORM 8451-ERROR                               22750000
227600             END-IF                                               22760000
227700                                                                  22770000
227800         WHEN DL019-INVALID-ACCESS                                22780000
227900***                                                               22790000
228000*** DMH ADDED DISPLAYS - 8/21/2007                                22800000
228100***                                                               22810000
228200             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           22820000
228300             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        22830000
228400             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    22840000
228500                                       TO PV-DISP-SQLCODE-3       22850000
228600             DISPLAY ' PCKUT072 - 8450 - CALL TO DLKUT410 - '     22860000
228700             DISPLAY ' PCKUT072 - DLWS019 '                       22870000
228800                     ' PROCESS CODE:'   DL019-PROCESS-CDE         22880000
228900                     ' COMMIT CODE:'    DL019-COMMIT-CDE          22890000
229000                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      22900000
229100                     ' USER ID:'        DL019-SIGN-ON-USR-ID      22910000
229200                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   22920000
229300             DISPLAY ' PCKUT072 - DLWS019 '                       22930000
229400                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     22940000
229500                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    22950000
229600                     ' DC:'             PV-DISP-OPER              22960000
229700                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   22970000
229800                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     22980000
229900             DISPLAY ' PCKUT072 - DLWS019 '                       22990000
230000                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 23000000
230100             DISPLAY ' PCKUT072 - DLWS019 '                       23010000
230200                     ' RETURN CODE:'     DL019-RETURN-CODE        23020000
230300                     ' SQLCODE:'         PV-DISP-SQLCODE          23030000
230400                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    23040000
230500                     '-'          DL019-CALL-MOD-FAIL-NM          23050000
230600                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     23060000
230700                     '-'          PV-DISP-SQLCODE-3               23070000
230800***                                                               23080000
230900             SET PS-ERROR-YES         TO TRUE                     23090000
231000             MOVE '8450-'             TO PV-ERROR-PARA            23100000
231100             MOVE 'INVALID ACCESS - DLKUT410'                     23110000
231200                                      TO PV-ERROR-TEXT            23120000
231300             PERFORM 9001-GENERIC-ERROR                           23130000
231400                                                                  23140000
231500                                                                  23150000
231600         WHEN OTHER                                               23160000
231700***                                                               23170000
231800*** DMH ADDED DISPLAYS - 8/21/2007                                23180000
231900***                                                               23190000
232000             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           23200000
232100             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        23210000
232200             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    23220000
232300                                       TO PV-DISP-SQLCODE-3       23230000
232400             DISPLAY ' PCKUT072 - 8450 - CALL TO DLKUT410 - '     23240000
232500             DISPLAY ' PCKUT072 - DLWS019 '                       23250000
232600                     ' PROCESS CODE:'   DL019-PROCESS-CDE         23260000
232700                     ' COMMIT CODE:'    DL019-COMMIT-CDE          23270000
232800                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      23280000
232900                     ' USER ID:'        DL019-SIGN-ON-USR-ID      23290000
233000                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   23300000
233100             DISPLAY ' PCKUT072 - DLWS019 '                       23310000
233200                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     23320000
233300                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    23330000
233400                     ' DC:'             PV-DISP-OPER              23340000
233500                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   23350000
233600                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     23360000
233700             DISPLAY ' PCKUT072 - DLWS019 '                       23370000
233800                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 23380000
233900             DISPLAY ' PCKUT072 - DLWS019 '                       23390000
234000                     ' RETURN CODE:'     DL019-RETURN-CODE        23400000
234100                     ' SQLCODE:'         PV-DISP-SQLCODE          23410000
234200                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    23420000
234300                     '-'          DL019-CALL-MOD-FAIL-NM          23430000
234400                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     23440000
234500                     '-'          PV-DISP-SQLCODE-3               23450000
234600***                                                               23460000
234700             SET PS-ERROR-YES         TO TRUE                     23470000
234800             MOVE '8450-'             TO PV-ERROR-PARA            23480000
234900             STRING                                               23490000
235000                  'DLKUT410 - ERROR= '                            23500000
235100                  DL019-RETURN-CODE                               23510000
235200                  ' / MODULE= ' DL019-CALL-MOD-FAIL-NM            23520000
235300                  DELIMITED BY SIZE                               23530000
235400                                    INTO PV-ERROR-TEXT            23540000
235500             PERFORM 9001-GENERIC-ERROR                           23550000
235600     END-EVALUATE.                                                23560000
235700     IF KRPRPM-FUNC-TXT = 'Y'                                     23570000
235800         MOVE ' PCKUT072 END 8450- PARA '     TO PV-LOG-MSG       23580000
235900         PERFORM 9900-WRITE-LOG                                   23590000
236000     END-IF.                                                      23600000
236100                                                                  23610000
236200 8451-ERROR.                                                      23620000
236300     IF KRPRPM-FUNC-TXT = 'Y'                                     23630000
236400         MOVE ' PCKUT072 START 8451- PARA '     TO PV-LOG-MSG     23640000
236500         PERFORM 9900-WRITE-LOG                                   23650000
236600     END-IF.                                                      23660000
236700     PERFORM 9001-GENERIC-ERROR.                                  23670000
236800     MOVE  DL019-CALL-MOD-FAIL-SQL-CDE TO PV-DISP-SQLCODE-3       23680000
236900     STRING 'MODULE ERROR - '                                     23690000
237000         DL019-CALL-MOD-FAIL-SQL-PARA                             23700000
237100      ' / ' DL019-CALL-MOD-FAIL-NM                                23710000
237200      ' / '   DL019-CALL-MOD-FAIL-ERR-CDE                         23720000
237300      ' / '   PV-DISP-SQLCODE-3                                   23730000
237400         DELIMITED BY SIZE                                        23740000
237500         INTO PV-LOG-MSG                                          23750000
237600     PERFORM 9900-WRITE-LOG.                                      23760000
237700                                                                  23770000
237800     MOVE PV-PICKER-ID                TO PV-DLKUT410-USER.        23780000
237900     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO PV-DLKUT410-WK-TYP.      23790000
238000     MOVE DL011-KEY-WK-TYP            TO PV-DLKUT410-WK-TYP-DESC. 23800000
238100     MOVE DL011-P2L-MOD-WRK-AREA      TO PV-DLKUT410-WK-AREA-DESC.23810000
238200     MOVE PC243-DC-NBR                TO PV-DLKUT410-DC-NBR.      23820000
238300     MOVE PV-PICKER-ID                TO PV-DLKUT410-CRE-USERID.  23830000
238400     MOVE DL019-EAI-USR-TYP-CDE       TO PV-DLKUT410-USER-TYP.    23840000
238500                                                                  23850000
238600     MOVE PV-DLKUT410-TEXT1           TO PV-LOG-MSG.              23860000
238700     PERFORM 9900-WRITE-LOG.                                      23870000
238800     MOVE PV-DLKUT410-TEXT2           TO PV-LOG-MSG.              23880000
238900     PERFORM 9900-WRITE-LOG.                                      23890000
239000                                                                  23900000
239100     PERFORM 9700-SQL-ERROR.                                      23910000
239200     IF KRPRPM-FUNC-TXT = 'Y'                                     23920000
239300         MOVE ' PCKUT072 END 8451- PARA '     TO PV-LOG-MSG       23930000
239400         PERFORM 9900-WRITE-LOG                                   23940000
239500     END-IF.                                                      23950000
239600/                                                                 23960000
239700*8600-CALL-XLKUT067.                                              23970000
239800*                                                                 23980000
239900*    IF KRPRPM-FUNC-TXT = 'Y'                                     23990000
240000*        MOVE SPACES TO PV-LOG-MSG                                24000000
240100*        STRING ' PCKUT072 START 8600- PARA WITH USER ID:'        24010000
240200*             PV-PICKER-ID DELIMITED BY SIZE                      24020000
240300*                                   INTO PV-LOG-MSG               24030000
240400*        PERFORM 9900-WRITE-LOG                                   24040000
240500*    END-IF.                                                      24050000
240600*    INITIALIZE XL067-USER-COMMAREA.                              24060000
240700*                                                                 24070000
240800*    MOVE ZEROS   TO  XL067-KOHLS-SQLCODE                         24080000
240900*                     XL067-TEMP-SQLCODE.                         24090000
241000*                                                                 24100000
241100*    MOVE SPACES  TO  XL067-USER-FOUND-CODE                       24110000
241200*                     XL067-FIRST-NAME                            24120000
241300*                     XL067-LAST-NAME                             24130000
241400*                     XL067-MIDDLE-INITIAL                        24140000
241500*                     XL067-USERID                                24150000
241600*                     XL067-KEY-USER-ID.                          24160000
241700*                                                                 24170000
241800*    SET XL067-BY-USER-ID                                         24180000
241900*        XL067-SELECT-BOTH-USERS      TO TRUE.                    24190000
242000*                                                                 24200000
242100*    MOVE PV-PICKER-ID                TO XL067-KEY-USER-ID.       24210000
242200*    MOVE 'PCKUT072'                  TO XL067-ORIG-CALLING-PGM-NM24220000
242300*                                                                 24230000
242400*    CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               24240000
242500*                                                                 24250000
242600*    IF KRPRPM-FUNC-TXT = 'Y'                                     24260000
242700*        MOVE  XL067-KOHLS-SQLCODE  TO  PV-DISP-SQLCODE-4         24270000
242800*        MOVE  XL067-TEMP-SQLCODE   TO  PV-DISP-SQLCODE-5         24280000
242900*        MOVE SPACES TO PV-LOG-MSG                                24290000
243000*        STRING ' PCKUT072-XL067-USER-FOUND-CODE:'                24300000
243100*             XL067-USER-FOUND-CODE                               24310000
243200*             ' USER ID:' PV-PICKER-ID                            24320000
243300*             ' KSQL:' PV-DISP-SQLCODE-4                          24330000
243400*             ' TSQL:' PV-DISP-SQLCODE-5                          24340000
243500*             ' RC:' XL067-RETURN-CODE                            24350000
243600*                                        DELIMITED BY SIZE        24360000
243700*                                   INTO PV-LOG-MSG               24370000
243800*        PERFORM 9900-WRITE-LOG                                   24380000
243900*    END-IF.                                                      24390000
244000***                                                               24400000
244100*** DMH ADDED ADDITIONAL DISPLAYS - 8/21/2007                     24410000
244200***                                                               24420000
244300*    EVALUATE TRUE                                                24430000
244400*        WHEN XL067-SUCCESSFUL                                    24440000
244500*            CONTINUE                                             24450000
244600*        WHEN OTHER                                               24460000
244700*             MOVE  XL067-KOHLS-SQLCODE  TO  PV-DISP-SQLCODE      24470000
244800*             MOVE  XL067-TEMP-SQLCODE   TO  PV-DISP-SQLCODE-2    24480000
244900*             DISPLAY ' PCKUT072 - CALL XLKUT067 '                24490000
245000*             DISPLAY ' XLWS067 - '                               24500000
245100*                     ' ACCESS METHOD:' XL067-ACCESS-METHOD       24510000
245200*                     ' VIEW:'          XL067-VIEW-SELECTION      24520000
245300*             DISPLAY ' XLWS067 - '                               24530000
245400*                     ' KEYS:'          XL067-KEYS                24540000
245500*                     ' RETURN CODE:'   XL067-RETURN-CODE         24550000
245600*                     ' KOHLS SQLCODE:' PV-DISP-SQLCODE           24560000
245700*                     ' TEMP SQLCODE:'  PV-DISP-SQLCODE-2         24570000
245800*             DISPLAY ' XLWS067 - '                               24580000
245900*                     ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM   24590000
246000*                     ' PARA: '  XL067-KOHLS-NOT-FOUND-NBR        24600000
246100*                     '-'        XL067-KOHLS-CONTENTION-NBR       24610000
246200*                     '-'        XL067-KOHLS-ERROR-NBR            24620000
246300*                     '-'        XL067-TEMP-NOT-FOUND-NBR         24630000
246400*                     '-'        XL067-TEMP-CONTENTION-NBR        24640000
246500*                     '-'        XL067-TEMP-ERROR-NBR             24650000
246600*                     '-'        XL067-CALL-MOD-FAIL-NM           24660000
246700*                     '-'        XL067-CALL-MOD-FAIL-ERR-CDE      24670000
246800*    END-EVALUATE.                                                24680000
246900***                                                               24690000
247000*    EVALUATE TRUE                                                24700000
247100*        WHEN XL067-SUCCESSFUL                                    24710000
247200*            CONTINUE                                             24720000
247300*        WHEN XL067-SQL-ERROR                                     24730000
247400*            SET PC243-SQL-ERROR      TO TRUE                     24740000
247500*            PERFORM 8601-ERROR                                   24750000
247600*        WHEN XL067-INVALID-ACCESS                                24760000
247700*            SET PC243-ERROR          TO TRUE                     24770000
247800*            PERFORM 8601-ERROR                                   24780000
247900*        WHEN OTHER                                               24790000
248000*            SET PC243-ERROR          TO TRUE                     24800000
248100*            PERFORM 8601-ERROR                                   24810000
248200*    END-EVALUATE.                                                24820000
248300*    IF KRPRPM-FUNC-TXT = 'Y'                                     24830000
248400*        MOVE ' PCKUT072 END 8600- PARA '     TO PV-LOG-MSG       24840000
248500*        PERFORM 9900-WRITE-LOG                                   24850000
248600*    END-IF.                                                      24860000
248700*                                                                 24870000
248800*8601-ERROR.                                                      24880000
248900*    IF KRPRPM-FUNC-TXT = 'Y'                                     24890000
249000*        MOVE ' PCKUT072 START 8601- PARA '     TO PV-LOG-MSG     24900000
249100*        PERFORM 9900-WRITE-LOG                                   24910000
249200*    END-IF.                                                      24920000
249300*                                                                 24930000
249400*    MOVE XL067-SQLCA                 TO SQLCA.                   24940000
249500*    MOVE '8601-'                     TO PV-ERROR-PARA.           24950000
249600*    STRING 'CALL XLKUT067-'                                      24960000
249700*            PC243-DC-NBR                                         24970000
249800*            '-CHK PICKERBARCODE IN PCC'                          24980000
249900*            DELIMITED BY SIZE                                    24990000
250000*       INTO PV-ERROR-TEXT.                                       25000000
250100*    PERFORM 9700-SQL-ERROR.                                      25010000
250200*                                                                 25020000
250300*    MOVE PV-PICKER-ID                TO PV-XLKUT067-USERID.      25030000
250400*    STRING                                                       25040000
250500*            XL067-KOHLS-NOT-FOUND-NBR                            25050000
250600*        '/' XL067-KOHLS-CONTENTION-NBR                           25060000
250700*        '/' XL067-KOHLS-ERROR-NBR                                25070000
250800*        '/' XL067-TEMP-NOT-FOUND-NBR                             25080000
250900*        '/' XL067-TEMP-CONTENTION-NBR                            25090000
251000*        '/' XL067-TEMP-ERROR-NBR                                 25100000
251100*        '/' XL067-CALL-MOD-FAIL-NM                               25110000
251200*        '/' XL067-CALL-MOD-FAIL-ERR-CDE                          25120000
251300*            DELIMITED BY SIZE                                    25130000
251400*       INTO PV-XLKUT067-RETURN-FIELDS.                           25140000
251500*                                                                 25150000
251600*    MOVE PV-XLKUT067-TEXT            TO PV-LOG-MSG.              25160000
251700*    PERFORM 9900-WRITE-LOG.                                      25170000
251800*    INITIALIZE PV-LOG-MSG.                                       25180000
251900*    STRING ' XL067-RETURN-CODE = ' XL067-RETURN-CODE             25190000
252000*            DELIMITED BY SIZE INTO PV-LOG-MSG.                   25200000
252100*    PERFORM 9900-WRITE-LOG.                                      25210000
252200*    IF KRPRPM-FUNC-TXT = 'Y'                                     25220000
252300*        MOVE ' PCKUT072 END 8601- PARA '     TO PV-LOG-MSG       25230000
252400*        PERFORM 9900-WRITE-LOG                                   25240000
252500*    END-IF.                                                      25250000
252600                                                                  25260000
252700/                                                                 25270000
252800 9000-FORMAT-TIME.                                                25280000
252900     ACCEPT PV-CURRENT-TIME FROM TIME.                            25290000
253000     MOVE PV-CURRENT-HOUR             TO PV-FORMAT-HH.            25300000
253100     MOVE PV-CURRENT-MINUTE           TO PV-FORMAT-MM.            25310000
253200     MOVE PV-CURRENT-SECOND           TO PV-FORMAT-SS.            25320000
253300     MOVE PV-CURRENT-HUNDRETH         TO PV-FORMAT-HUND.          25330000
253400                                                                  25340000
253500 9001-GENERIC-ERROR.                                              25350000
253600     SET PC243-ERROR                  TO TRUE.                    25360000
253700     PERFORM 9000-FORMAT-TIME.                                    25370000
253800     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           25380000
253900     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              25390000
254000     PERFORM 9900-WRITE-LOG.                                      25400000
254100                                                                  25410000
254200 9700-SQL-ERROR.                                                  25420000
254300                                                                  25430000
254400     SET PC243-SQL-ERROR                                          25440000
254500         PS-ERROR-YES                 TO TRUE.                    25450000
254600     MOVE SPACES                      TO PV-LOG-MSG.              25460000
254700     PERFORM 9900-WRITE-LOG.                                      25470000
254800     PERFORM 9000-FORMAT-TIME.                                    25480000
254900     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           25490000
255000     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              25500000
255100     PERFORM 9900-WRITE-LOG.                                      25510000
255200                                                                  25520000
255300     INITIALIZE PV-LOG-MSG.                                       25530000
255400     STRING ' XL067-RETURN-CODE = ' XL067-RETURN-CODE             25540000
255500             DELIMITED BY SIZE INTO PV-LOG-MSG.                   25550000
255600     PERFORM 9900-WRITE-LOG.                                      25560000
255700                                                                  25570000
255800     IF SQLCODE = +100                                            25580000
255900         CONTINUE                                                 25590000
256000     ELSE                                                         25600000
256100         IF XL067-SQL-ERROR OR XL067-SQL-WARNING-ERROR            25610000
256200             PERFORM 9800-WRITE-SQLCA                             25620000
256300         END-IF                                                   25630000
256400     END-IF.                                                      25640000
256500                                                                  25650000
256600                                                                  25660000
256700 9800-WRITE-SQLCA.                                                25670000
256800*                                                                 25680000
256900**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               25690000
257000*                                                                 25700000
257100     CALL 'DSNTIAR' USING SQLCA                                   25710000
257200                          DP004-FORMATTED-MESSAGE                 25720000
257300                          DP004-ERROR-LINE-LENGTH.                25730000
257400*                                                                 25740000
257500     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG               25750000
257600     PERFORM 9900-WRITE-LOG.                                      25760000
257700                                                                  25770000
257800     PERFORM                                                      25780000
257900         VARYING DP004-MSG-IDX                                    25790000
258000         FROM 1 BY 1                                              25800000
258100         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            25810000
258200             MOVE DP004-MESSAGE-LINE (DP004-MSG-IDX)              25820000
258300                                      TO PV-LOG-MSG               25830000
258400             PERFORM 9900-WRITE-LOG                               25840000
258500     END-PERFORM.                                                 25850000
258600                                                                  25860000
258700     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG               25870000
258800     PERFORM 9900-WRITE-LOG.                                      25880000
258900                                                                  25890000
259000 9900-WRITE-LOG.                                                  25900000
259100                                                                  25910000
259200     DISPLAY PV-LOG-MSG.                                          25920000
259300     MOVE SPACES                      TO PV-LOG-MSG.              25930000
259400                                                                  25940000
259500 9999-RETURN.                                                     25950000
259600                                                                  25960000
259700     GOBACK.                                                      25970000
