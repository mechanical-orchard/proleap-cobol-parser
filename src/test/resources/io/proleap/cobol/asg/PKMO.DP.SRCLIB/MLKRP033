       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    MLKRP033                                                  
       AUTHOR.        R. MCDONALD                                               
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  01-10-2004.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * MLKRP033 - M/L CREATE THE PRICE CHANGE TRANSACTION LIST BY              
      *            DEPT, DOC NO, SKU, STORE WITH TOTALS ON DOC#,                
      *            SKU, AND GRAND TOTALS.                                       
      ******************************************************************        
      *     THIS PROGRAM WAS MODELED AFTER MLKRP032, BUT IT INCLUDES    00290000
      *     BOTH MARKUPS AND MARKDOWNS OF ALL KINDS.  THIS PROGRAM      00290000
      *     WILL REPORT ON THE TRANSACTIONS, BUT WILL NOT EDIT THEM             
      *     OR DROP ANY RECORDS.  THIS SHOWS EVERYTHING THAT IS                 
      *     CREATED AND FED INTO ML.                                            
      *                                                                         
      ******************************************************************        
      ******************************************************************        
      *                        CHANGE LOG                              *        
      *  CHNGE DTE   PERSON     CHG ID     REASON FOR CHANGE           *        
      *  ----------  ---------- ---------  -------------------------   *        
21731 *  01/12/2005  RONNA M.     23606    INITIAL CREATION            *        
27813 *  03/14/2005  R. JANSSEN   27813    CREATE THE MKDN ERROR REPORT*        
23606M*  03/18/2005  RONNA M.     23606M   INCLUDE THE DOCNO IN THE    *        
23606M*                                    DOCNO TOTAL LINE            *        
23606R*  03/22/2005  RONNA M.     23606R   FIX ALIGNMENT ON GRAND TOTAL*        
23606R*                                    REMOVE BATCH TOTAL          *        
23606R*                                    THIS RPT ONLY HAS BATCH 999 *        
X27813*  03/14/2005  R. JANSSEN   27813    EFFICIENCIES IN CORP PRICE           
X27813*                                    LOAD.                                
R27813*  04/21/2005  RONNA M.     R27813   ADD A SUMMARY REPORT AND             
R27813*                                    A SUMMARY OUTPUT FILE.               
R27813*                                    THE SUMMARY OUTPUT FILE WILL         
R27813*                                    BE USED ALONG WITH DATA FOR          
R27813*                                    REPORTING BOTH NEG AND POS           
R27813*                                    ON HANDS                             
27813R*  05/16/2005  RONNA M.     27813R   IF RUNNING THIS PROGRAM              
27813R*                                    FOR AN ERROR REPORT,                 
27813R*                                    DO NOT VALIDATE ML017-PC-TYP         
27813R*                                    FIELD.                               
W29145*  11/20/2005  S. JACKSON   W29145   SAS MARKDOWN OPTIMIZATION            
W29145*                                    MODIFY FOR MLRD017 EXPANSION         
S29145*  12/14/2005  S. JACKSON   S29145   FIX REPORT TRUNCATION TOTALS         
SR3403*  03/01/2012  TEJA K       SR3403   LARGE RETAIL AMOUNT EXPANSION        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT INP-MARKDOWN-FILE                                             
               ASSIGN TO INP01.                                                 
                                                                                
27813      SELECT INP-CONTROL-CARD-IN                                           
27813          ASSIGN TO INP02.                                                 
27813                                                                           
           SELECT OUT-MARKDOWN-FILE                                             
               ASSIGN TO OUT01.                                                 
R27813                                                                          
R27813     SELECT OUT-MARKDOWN-SUM-FILE                                         
R27813         ASSIGN TO OUT02.                                                 
                                                                                
           SELECT OUT-MARKDOWN-TRAN-LIST                                        
               ASSIGN TO RPT01.                                                 
R27813                                                                          
R27813     SELECT OUT-MARKDOWN-SUM-RPT                                          
R27813         ASSIGN TO RPT02.                                                 
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  INP-MARKDOWN-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
W26603*    RECORD CONTAINS 120 CHARACTERS                                       
W29145     RECORD CONTAINS 200 CHARACTERS                                       
           DATA RECORD IS INP-MARKDOWN-RECORD.                                  
                                                                                
W26603*01  INP-MARKDOWN-RECORD            PIC X(120).                           
W29145 01  INP-MARKDOWN-RECORD            PIC X(200).                           
                                                                                
27813  FD  INP-CONTROL-CARD-IN                                                  
27813      RECORDING MODE IS F                                                  
27813      LABEL RECORDS ARE STANDARD                                           
27813      BLOCK CONTAINS 0 RECORDS.                                            
27813  01  ICCI-CONTROL-RECORD.                                                 
27813      05  ICCI-RPT-VERSION-ID        PIC X(01).                            
27813          88  ICCI-MKDN-REPORT          VALUE '1', '3'.                    
27813          88  ICCI-ERR-MKDN-REPORT      VALUE '2', '4'.                    
R27813     05  FILLER                     PIC X(01).                            
R27813     05  ICCI-NEG-OR-POS            PIC X(03).                            
27813          88  ICCI-POS                  VALUE 'POS'.                       
27813          88  ICCI-NEG                  VALUE 'NEG'.                       
27813      05  ICCI-REST-RECORD           PIC X(75).                            
27813                                                                           
       FD  OUT-MARKDOWN-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
W26603*    RECORD CONTAINS 120 CHARACTERS                                       
W26603     RECORD CONTAINS 200 CHARACTERS                                       
           DATA RECORD IS INP-MARKDOWN-RECORD.                                  
                                                                                
W26603*01  OUT-MARKDOWN-RECORD            PIC X(120).                           
W26603 01  OUT-MARKDOWN-RECORD            PIC X(200).                           
                                                                                
R27813 FD  OUT-MARKDOWN-SUM-FILE                                                
R27813     LABEL RECORDS ARE STANDARD                                           
R27813     RECORDING MODE IS F                                                  
R27813     BLOCK  CONTAINS   0 RECORDS                                          
R27813     RECORD CONTAINS 080 CHARACTERS                                       
R27813     DATA RECORD IS OUT-MARKDOWN-SUM-REC.                                 
R27813                                                                          
R27813 01  OUT-MARKDOWN-SUM-REC           PIC X(080).                           
R27813                                                                          
       FD  OUT-MARKDOWN-TRAN-LIST                                               
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
21731      RECORD CONTAINS 200 CHARACTERS                                       
           DATA RECORD IS OUT-MARKDOWN-LIST-RECORD.                             
                                                                                
21731  01  OUT-MARKDOWN-REPORT-RECORD     PIC X(200).                           
                                                                                
R27813 FD  OUT-MARKDOWN-SUM-RPT                                                 
R27813     LABEL RECORDS ARE STANDARD                                           
R27813     RECORDING MODE IS F                                                  
R27813     BLOCK CONTAINS 0 RECORDS                                             
R27813     RECORD CONTAINS 200 CHARACTERS                                       
R27813     DATA RECORD IS OUT-MARKDOWN-SUM-RPT.                                 
R27813                                                                          
R27813 01  OUT-MARKDOWN-SUM-RPT-REC       PIC X(200).                           
R27813                                                                          
       EJECT                                                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** WORKING STORAGE AREA BEGIN ***'.                                
                                                                                
RONNA ******************************************************************        
RONNA *  MERCHANDISE AREA TABLE (TMDSEAR)                                       
RONNA ******************************************************************        
RONNA                                                                           
RONNA      EXEC SQL                                                             
RONNA          INCLUDE TMDSEAR                                                  
RONNA      END-EXEC.                                                            
RONNA                                                                           
RONNA ******************************************************************        
RONNA *  APPLICATION AVAILABILITY TABLE (TAPLAVL)                               
RONNA ******************************************************************        
RONNA                                                                           
RONNA      EXEC SQL                                                             
RONNA          INCLUDE TAPLAVL                                                  
RONNA      END-EXEC.                                                            
RONNA                                                                           
RONNA ******************************************************************        
RONNA *    DB2 COMMUNICATION AREA                                               
RONNA ******************************************************************        
RONNA                                                                           
RONNA      EXEC SQL                                                             
RONNA          INCLUDE SQLCA                                                    
RONNA      END-EXEC.                                                            
RONNA                                                                           
      *****************************************************************         
      ***************************************************************** 00120000
21731 *  MERCHANDISE LEDGER MARKDOWN/MARKON RECORD LAYOUT - INPUT AND   00130000
21731 *                                                     OUTPUT.     00130000
      ***************************************************************** 00140000
W26603     COPY MLRD017.                                                00000400
                                                                                
R27813***************************************************************** 00120000
R27813*  PERM MONTHLY REPORTING                                         00130000
R27813***************************************************************** 00140000
R27813     COPY MLRD011.                                                00000400
R27813                                                                          
010300*****************************************************************         
010400*    WORKING STORAGE AREA FOR ROUTINE TO FORMAT NAME                      
010500*****************************************************************         
010600                                                                          
010700     COPY DPWS024.                                                        
010800                                                                          
010900******************************************************************        
011000*  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004                
011100******************************************************************        
011200                                                                          
011300     COPY DPWS004.                                                        
011400                                                                          
       01  PC-PROGRAM-CONSTANTS.                                                
23606M     05  PC-LINE-MAX                   PIC S9(4)   VALUE +80              
                                                         COMP SYNC.             
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'MLKRP033'.        
           05  PC-TYPE.                                                         
               10  PC-NORMAL-MARKDOWN       PIC X(01)  VALUE '1'.               
               10  PC-MARKDOWN-CANCEL       PIC X(01)  VALUE '2'.               
               10  PC-NORMAL-MARKUP         PIC X(01)  VALUE '3'.               
               10  PC-MARKUP-CANCEL         PIC X(01)  VALUE '4'.               
      *                                                                         
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.            
               88  PS-INPUT-EOF                           VALUE 'Y'.            
           05  PS-MARKDOWN-REC-FOUND-SW      PIC X(01)    VALUE 'N'.            
               88  PS-MARKDOWN-REC-FOUND                  VALUE 'Y'.            
           05  PS-FIRST-RECORD-SW            PIC X(01)    VALUE 'Y'.            
               88  PS-FIRST-RECORD                        VALUE 'Y'.            
27813      05  PS-CONTROL-CARD-SW            PIC X(01)    VALUE 'N'.            
27813          88  PS-CONTROL-CARD-EOF                    VALUE 'Y'.            
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PAGE-COUNTER               PIC S9(4)   VALUE ZEROES           
                                                         COMP SYNC.             
           05  PV-LINE-COUNTER               PIC S9(4)   VALUE 99               
                                                         COMP SYNC.             
           05  PV-IN-COUNTER                 PIC S9(4)   VALUE ZEROES           
                                                         COMP SYNC.             
R27813     05  PV-SUM-PAGE-COUNTER           PIC S9(4)   VALUE ZEROES           
R27813                                                   COMP SYNC.             
R27813     05  PV-SUM-LINE-COUNTER           PIC S9(4)   VALUE 99               
R27813                                                   COMP SYNC.             
           05  PV-TEMP-DOC.                                                     
               10  PV-TEMP-DOC-POS1       PIC X(01) VALUE SPACE.                
               10  FILLER                 PIC X(06) VALUE SPACES.               
SR3403     05  PV-PGMDIFF                 PIC S9(5)V99 VALUE ZEROES.            
           05  PV-EXTAMT                  PIC S9(8)V99 VALUE ZEROES.            
RONNA      05  PV-TYPE                    PIC X(05) VALUE SPACE.                
R27813     05  PV-PC-TYPE.                                                      
R27813         10 PV-PC-CDE               PIC X(01) VALUE SPACE.                
R27813         10 PV-PC-TYP-CDE           PIC X(01) VALUE SPACE.                
R27813         10 PV-PC-RSN-CDE           PIC X(01) VALUE SPACE.                
           05  PV-SAVEDOCNO               PIC 9(07) VALUE ZEROES.               
W26603     05  PV-SAVESTORE               PIC X(05) VALUE SPACES.               
R27813     05  PV-ST-TOT-QTY              PIC S9(12) VALUE 0 COMP-3.            
R27813     05  PV-ST-TOT-EXT-QTY          PIC S9(15)V9(2)                       
R27813                                               VALUE 0 COMP-3.            
           05  PV-DOCDIFF                 PIC S9(07) VALUE ZEROES.              
           05  PV-SAVE-DOCQTY             PIC S9(04) VALUE ZEROES.              
           05  PV-XDATE                   PIC X(05) VALUE SPACES.               
           05  FILLER REDEFINES PV-XDATE.                                       
               10  PV-XDATE1              PIC X(02).                            
               10  PV-DDASH1              PIC X(01).                            
               10  PV-XDATE2              PIC X(02).                            
           05  PV-PDATE                   PIC X(05).                            
           05  PV-XSKU                    PIC X(10) VALUE SPACES.               
           05  FILLER REDEFINES PV-XSKU.                                        
               10  PV-XSKU1               PIC X(03).                            
               10  PV-XDASH1              PIC X(01).                            
               10  PV-XSKU2               PIC X(02).                            
               10  PV-XDASH2              PIC X(01).                            
               10  PV-XSKU3               PIC X(03).                            
           05  PV-PSKU                    PIC X(10)      VALUE SPACES.          
21731      05  PV-MAJOR-CLASS.                                                  
21731          10  PV-MAJOR-CLASS-PART1   PIC X(02)      VALUE SPACES.          
21731          10  PV-MAJOR-CLASS-PART2   PIC X(02)      VALUE SPACES.          
           05  PV-SAVE-DOCNO              PIC X(07)      VALUE SPACES.          
           05  PV-SAVE-BATCH              PIC X(03)      VALUE SPACES.          
RONNA      05  PV-SAVE-DEPT               PIC 9(03)      VALUE ZEROES.          
R27813     05  PV-SAVE-GMM-NBR            PIC X(02)      VALUE SPACE.           
R27813     05  PV-SAVE-DMM-NBR            PIC X(02)      VALUE SPACE.           
R27813     05  PV-SAVE-BYR-NBR            PIC X(03)      VALUE SPACE.           
RONNA      05  PV-SAVE-SKU                PIC 9(08)      VALUE ZEROES.          
R27813     05  PV-SAVE-PC-CDE             PIC X(01)      VALUE SPACE.           
R27813     05  PV-SAVE-PC-TYP-CDE         PIC X(01)      VALUE SPACE.           
R27813     05  PV-SAVE-PC-RSN-CDE         PIC X(01)      VALUE SPACE.           
R27813     05  PV-SAVE-PC-MAJ-CLASS       PIC 9(04)      VALUE ZEROES.          
R27813     05  PV-SAVE-PC-CLASS-NBR       PIC 9(04)      VALUE ZEROES.          
019200     05  PV-PARAGRAPH-NAME          PIC X(30)      VALUE SPACE.           
019300     05  PV-DB2-OPER-ATTEMPTED      PIC X(30)      VALUE SPACE.           
019400     05  PV-ABEND-CODE              PIC S9(04)     COMP                   
019500                                                   VALUE ZERO.            
      ***************************************************************** 00120000
      *   STANDARD REPORT HEADER FOR A 150 COLUMN REPORT.               00220000
      ***************************************************************** 00230000
21731      COPY DPWS200O.                                                       
                                                                                
       01  HL-HEADING-LINE1.                                                    
21731      05  FILLER                        PIC X(87)   VALUE SPACES.          
21731      05  FILLER                        PIC X(25)   VALUE                  
21731          'MARKDOWN TRANSACTION LIST'.                                     
21731      05  FILLER                        PIC X(88)   VALUE SPACES.          
                                                                                
R27813 01  HL-HEADING-SUM-LINE1.                                                
R27813     05  FILLER                        PIC X(83)   VALUE SPACES.          
R27813     05  FILLER                        PIC X(33)   VALUE                  
R27813         'MARKDOWN TRANSACTION SUMMARY LIST'.                             
R27813     05  FILLER                        PIC X(84)   VALUE SPACES.          
R27813                                                                          
R27813 01  HL-HEADING-LINE1-NEG.                                                
R21731     05  FILLER                        PIC X(85)   VALUE SPACES.          
R21731     05  FILLER                        PIC X(30)   VALUE                  
R21731         'NEG MARKDOWN TRANSACTION LIST'.                                 
R21731     05  FILLER                        PIC X(85)   VALUE SPACES.          
                                                                                
R27813 01  HL-HEADING-SUM-LINE1-NEG.                                            
R27813     05  FILLER                        PIC X(81)   VALUE SPACES.          
R27813     05  FILLER                        PIC X(37)   VALUE                  
R27813         'NEG MARKDOWN TRANSACTION SUMMARY LIST'.                         
R27813     05  FILLER                        PIC X(82)   VALUE SPACES.          
R27813                                                                          
27813  01  HL-HEADING-LINE1A.                                                   
27813      05  FILLER                        PIC X(84)   VALUE SPACES.          
27813      05  FILLER                        PIC X(31)   VALUE                  
27813          'ERROR MARKDOWN TRANSACTION LIST'.                               
27813      05  FILLER                        PIC X(85)   VALUE SPACES.          
27813                                                                           
R27813 01  HL-HEADING-SUM-LINE1A.                                               
R27813     05  FILLER                        PIC X(80)   VALUE SPACES.          
R27813     05  FILLER                        PIC X(39)   VALUE                  
R27813         'ERROR MARKDOWN SUMMARY TRANSACTION LIST'.                       
R27813     05  FILLER                        PIC X(81)   VALUE SPACES.          
R27813                                                                          
27813  01  HL-HEADING-LINE1A-NEG.                                               
27813      05  FILLER                        PIC X(82)   VALUE SPACES.          
27813      05  FILLER                        PIC X(35)   VALUE                  
27813          'NEG ERROR MARKDOWN TRANSACTION LIST'.                           
27813      05  FILLER                        PIC X(83)   VALUE SPACES.          
27813                                                                           
R27813 01  HL-HEADING-SUM-LINE1A-NEG.                                           
R27813     05  FILLER                        PIC X(78)   VALUE SPACES.          
R27813     05  FILLER                        PIC X(43)   VALUE                  
R27813         'NEG ERROR MARKDOWN SUMMARY TRANSACTION LIST'.                   
R27813     05  FILLER                        PIC X(79)   VALUE SPACES.          
R27813                                                                          
       01  DH-DEPT-HEADING.                                                     
           05  FILLER                       PIC X(06) VALUE ' DEPT:'.           
           05  FILLER                       PIC X(01) VALUE SPACE.              
           05  DH-DEPT-NBR                  PIC 9(03) VALUE ZERO.               
           05  FILLER                       PIC X(01) VALUE '-'.                
           05  DH-DEPT-NAME                 PIC X(20) VALUE SPACE.              
           05  FILLER                       PIC X(116) VALUE SPACE.             
                                                                                
       01  HL-HEADING-LINE2.                                                    
           05  FILLER                        PIC X(18)   VALUE SPACES.          
           05  FILLER                        PIC X(04)   VALUE SPACES.          
21731      05  FILLER                        PIC X(50)   VALUE                  
21731          'BATCH   DOCNO    ENT            STORE   DATE    KM'.            
21731      05  FILLER                        PIC X(50)   VALUE                  
21731          '  DEPT/CLS/SUB    SKU          OLD        NEW     '.            
RONNA *        '     SKU      DEPT/CLS/SUB     OLD        NEW     '.            
21731      05  FILLER                        PIC X(50)   VALUE                  
21731          '     PGM        QTY          EXTENDED       TYPE  '.            
21731      05  FILLER                        PIC X(46)   VALUE                  
21731          '                                         '.                     
21731  01  HL-HEADING-LINE3.                                                    
21731      05  FILLER                        PIC X(18)   VALUE SPACES.          
21731      05  FILLER                        PIC X(04)   VALUE SPACES.          
21731      05  FILLER                        PIC X(50)   VALUE                  
21731          '                 ID                               '.            
21731      05  FILLER                        PIC X(50)   VALUE                  
21731          '                               PRICE      PRICE   '.            
21731      05  FILLER                        PIC X(50)   VALUE                  
21731          '     DIFF                    AMOUNT               '.            
21731      05  FILLER                        PIC X(46)   VALUE                  
21731          '                                     '.                         
21731                                                                           
21731  01  SL-SPACE-LINE                     PIC X(200)  VALUE SPACES.          
                                                                                
       01  DL-DETAIL-LINE.                                                      
           05  FILLER                        PIC X(18)   VALUE SPACES.          
           05  FILLER                        PIC X(05)   VALUE SPACES.          
           05  DL-BATCH                      PIC X(03)   VALUE SPACES.          
21731      05  FILLER                        PIC X(03)   VALUE SPACE.           
           05  DL-DOC                        PIC Z(07)   VALUE ZEROES.          
21731      05  FILLER                        PIC X(02)   VALUE SPACES.          
           05  DL-ENT-ID                     PIC X(09)   VALUE SPACES.          
W21732     05  FILLER                        PIC X(02)   VALUE SPACES.          
RONNA *    05  DL-LINE-NO                    PIC Z(04)   VALUE ZEROES.          
RONNA      05  FILLER                        PIC X(04)   VALUE SPACES.          
W26603     05  FILLER                        PIC X(02)   VALUE SPACES.          
W26603     05  DL-STORE                      PIC X(05)   VALUE SPACES.          
21731      05  FILLER                        PIC X(03)   VALUE SPACES.          
           05  DL-DATE-MM                    PIC X(02)   VALUE SPACES.          
21731      05  FILLER                        PIC X(01)   VALUE '-'.             
           05  DL-DATE-DD                    PIC X(02)   VALUE SPACES.          
21731      05  FILLER                        PIC X(03)   VALUE SPACES.          
           05  DL-KM                         PIC X(02)   VALUE SPACES.          
21731      05  FILLER                        PIC X(03)   VALUE SPACES.          
21731      05  DL-DEPT                       PIC X(03)   VALUE SPACES.          
21731      05  FILLER                        PIC X(01)   VALUE '-'.             
21731      05  DL-CLASS                      PIC X(02)   VALUE SPACES.          
21731      05  FILLER                        PIC X(01)   VALUE '-'.             
21731      05  DL-SUB                        PIC X(02)   VALUE SPACES.          
21731      05  FILLER                        PIC X(04)   VALUE SPACES.          
21731      05  DL-SKU                        PIC X(08)   VALUE SPACES.          
SR3403     05  FILLER                        PIC X(04)   VALUE SPACES.          
SR3403     05  DL-OLD-PRICE                  PIC ZZ,ZZZ.99 VALUE ZEROS.         
SR3403     05  FILLER                        PIC X(02)   VALUE SPACES.          
SR3403     05  DL-NEW-PRICE                  PIC ZZ,ZZZ.99 VALUE ZEROS.         
SR3403     05  FILLER                        PIC X(02)   VALUE SPACES.          
RONNA *    05  DL-KEY-DIFF                   PIC Z,ZZZ.99 VALUE ZEROS.          
RONNA *    05  FILLER                        PIC X(07)   VALUE SPACES.          
SR3403     05  DL-PGM-DIFF                   PIC ZZ,ZZZ.99 VALUE ZEROS.         
21731      05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  DL-QTY                        PIC Z,ZZZ,ZZZ VALUE ZEROS.         
21731      05  FILLER                        PIC X(01)   VALUE SPACES.          
RONNA *    05  DL-DOC-QTY                    PIC Z,ZZZ,ZZZ VALUE ZEROS.         
RONNA *    05  DL-DOC-DIFF                   PIC ZZZZZZZ- VALUE ZEROS.          
X27813     05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  DL-EXTENDED-AMT               PIC ZZZ,ZZZ,ZZZ.99-                
                                                         VALUE ZEROES.          
21731      05  FILLER                        PIC X(07)   VALUE SPACES.          
RONNA      05  DL-TYPE                       PIC X(05)   VALUE SPACES.          
RONNA      05  FILLER                        PIC X(02)   VALUE SPACES.          
RONNA      05  FILLER                        PIC X(08)   VALUE SPACES.          
                                                                                
       01  DLST-SKU-TOTALS-PRINT-LINE.                                          
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(18)   VALUE                  
                                             '         SKU TOTAL'.              
23606M     05  FILLER                        PIC X(70)   VALUE SPACES.          
23606M     05  DLST-SKU                      PIC X(08)   VALUE SPACES.          
S29145     05  FILLER                        PIC X(35)   VALUE SPACES.          
S29145     05  DLST-QTY                      PIC ZZ,ZZZ,ZZZ VALUE ZEROS.        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  DLST-EXTENDED-AMT             PIC ZZZ,ZZZ,ZZZ.99-                
                                                 VALUE ZEROES.                  
       01  DLDT-DOCNO-TOTALS-PRINT-LINE.                                        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
           05  FILLER                        PIC X(18)   VALUE                  
                                             '         DOC TOTAL'.              
23606M     05  FILLER                        PIC X(10)   VALUE SPACES.          
23606M     05  DLDT-DOCNO                    PIC Z(07)   VALUE ZEROES.          
S29145     05  FILLER                        PIC X(96)   VALUE SPACES.          
S29145     05  DLDT-QTY                      PIC ZZ,ZZZ,ZZZ VALUE ZEROS.        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  DLDT-EXTENDED-AMT             PIC ZZZ,ZZZ,ZZZ.99-                
                                                 VALUE ZEROES.                  
       01  DLDT-DEPT-TOTALS-PRINT-LINE.                                         
23606M     05  FILLER                        PIC X(06) VALUE ' DEPT:'.          
23606M     05  FILLER                        PIC X(01) VALUE SPACE.             
23606M     05  DLDPT-DEPT-NBR                PIC 9(03) VALUE ZERO.              
23606M     05  FILLER                        PIC X(09)   VALUE                  
23606M                                       '    TOTAL'.                       
S29145     05  FILLER                        PIC X(113)  VALUE SPACES.          
S29145     05  DLDPT-TOT-QTY                 PIC ZZ,ZZZ,ZZZ VALUE ZEROS.        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  DLDPT-TOT-EXTENDED-AMT        PIC ZZZ,ZZZ,ZZZ.99-                
                                                 VALUE ZEROES.                  
       01  DLBT-BATCH-TOTALS-PRINT-LINE.                                        
23606M     05  FILLER                        PIC X(08)   VALUE SPACES.          
           05  FILLER                        PIC X(11)   VALUE                  
                                             'BATCH TOTAL'.                     
23606M     05  FILLER                        PIC X(04)   VALUE SPACES.          
23606M     05  DLBT-BATCH                    PIC X(03)   VALUE SPACES.          
23606M     05  FILLER                        PIC X(100)  VALUE SPACES.          
S29145     05  FILLER                        PIC X(06)   VALUE SPACES.          
S29145     05  DLBT-QTY                      PIC ZZ,ZZZ,ZZZ VALUE ZEROS.        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  DLBT-EXTENDED-AMT             PIC ZZZ,ZZZ,ZZZ.99-                
                                                 VALUE ZEROES.                  
       01  DLGT-GRAND-TOTALS-PRINT-LINE.                                        
           05  FILLER                        PIC X(04)   VALUE SPACES.          
           05  FILLER                        PIC X(11)   VALUE                  
                                             'GRAND TOTAL'.                     
21731      05  FILLER                        PIC X(111)  VALUE SPACES.          
S29145     05  FILLER                        PIC X(06)   VALUE SPACES.          
S29145     05  DLGT-QTY                      PIC ZZ,ZZZ,ZZZ VALUE ZEROS.        
           05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  FILLER                        PIC X(01)   VALUE SPACES.          
X27813     05  DLGT-EXTENDED-AMT             PIC ZZZ,ZZZ,ZZZ.99-                
                                                 VALUE ZEROES.                  
       01  ST-SKU-TOTALS.                                                       
S29145     05  ST-TOT-QTY                    PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
S29145     05  ST-TOT-DOC-QTY                PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
           05  ST-TOT-EXTENDED-AMT           PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  DT-DOCNO-TOTALS.                                                     
S29145     05  DT-TOT-QTY                    PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
S29145     05  DT-TOT-DOC-QTY                PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
           05  DT-TOT-EXTENDED-AMT           PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  DDT-DOC-DEPT-TOTALS.                                                 
S29145     05  DDT-TOT-QTY                   PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
S29145     05  DDT-TOT-DOC-QTY               PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
           05  DDT-TOT-EXTENDED-AMT          PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  BT-BATCH-TOTALS.                                                     
S29145     05  BT-TOT-QTY                    PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
S29145     05  BT-TOT-DOC-QTY                PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
           05  BT-TOT-EXTENDED-AMT           PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  GT-GRAND-TOTALS.                                                     
S29145     05  GT-TOT-QTY                    PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
S29145     05  GT-TOT-DOC-QTY                PIC S9(08) VALUE ZEROES            
                                                          COMP-3.               
           05  GT-TOT-EXTENDED-AMT           PIC S9(11)V99 VALUE ZEROES         
                                                          COMP-3.               
       01  RUN-TIME.                                                            
           05  R-HR                    PIC 99.                                  
           05  R-MIN                   PIC 99.                                  
           05  R-SEC                   PIC 99.                                  
           05  R-TH                    PIC 99.                                  
                                                                                
       01  DATE-IN.                                                             
           05 DATE-IN-YY               PIC XX.                                  
           05 DATE-IN-MM               PIC XX.                                  
           05 DATE-IN-DD               PIC XX.                                  
                                                                                
       EJECT                                                                    
      *                                                                         
       PROCEDURE DIVISION.                                                      
                                                                                
       0000-MLKRP033.                                                           
                                                                                
      ****************************************************************          
      *    OPEN ALL FILES.                                                      
      *    INITIALIZE PAGE HEADINGS                                             
      *    PROCESS AND PRINT RECORDS ON MARKDOWN FILE                           
      *    PRINT THE STORE TOTALS ON CHANGE IN STORE NUMBER                     
      *    PRINT THE DOCNO TOTALS ON CHANGE IN DOCNO NUMBER                     
      *    PRINT THE BATCH TOTALS ON CHANGE IN BATCH NUMBER                     
      *    PRINT THE GRAND TOTALS WHICH INCLUDE ALL BATCH TOTALS                
      *    AT END-OF-JOB.                                                       
      *    CLOSE ALL FILES.                                                     
      ****************************************************************          
                                                                                
           OPEN INPUT  INP-MARKDOWN-FILE                                        
27813                  INP-CONTROL-CARD-IN                                      
                OUTPUT OUT-MARKDOWN-FILE                                        
R27813                 OUT-MARKDOWN-SUM-FILE                                    
R27813                 OUT-MARKDOWN-SUM-RPT                                     
                       OUT-MARKDOWN-TRAN-LIST.                                  
                                                                                
           PERFORM 1000-INITIALIZE-HEADER.                                      
                                                                                
           PERFORM 2000-PROCESS                                                 
               UNTIL PS-INPUT-EOF.                                              
                                                                                
           IF PV-PAGE-COUNTER = +0                                              
               CONTINUE                                                         
           ELSE                                                                 
RONNA *        PERFORM B100-MAP-PRINT-DETAIL                                    
RONNA          PERFORM B150-PRINT-SKU-TOTALS                                    
               PERFORM B200-PRINT-DOCNO-TOTALS                                  
RONNA          PERFORM B250-PRINT-DEPT-TOTALS                                   
23606R*        PERFORM B300-PRINT-BATCH-TOTALS                                  
               PERFORM B400-PRINT-GRAND-TOTALS                                  
                                                                                
           END-IF.                                                              
                                                                                
           CLOSE INP-MARKDOWN-FILE                                              
27813            INP-CONTROL-CARD-IN                                            
                 OUT-MARKDOWN-FILE                                              
R27813           OUT-MARKDOWN-SUM-FILE                                          
R27813           OUT-MARKDOWN-SUM-RPT                                           
                 OUT-MARKDOWN-TRAN-LIST.                                        
                                                                                
           STOP RUN.                                                            
                                                                                
       1000-INITIALIZE-HEADER.                                                  
                                                                                
      ****************************************************************          
      *    SET UP THE STANDARD PAGE HEADER.                                     
      *    ACCEPT THE RUN DATE AND RUN TIME FROM THE SYSTEM.                    
      *    READ FIRST MARKDOWN RECORD.                                          
      *    PERFORMED BY 0000-MLKRP033.                                          
      ****************************************************************          
R27813     MOVE PC-LINE-MAX         TO PV-SUM-LINE-COUNTER.                     
           ACCEPT DATE-IN  FROM DATE.                                           
           ACCEPT RUN-TIME FROM TIME.                                           
21731      MOVE DATE-IN-MM TO DP200O-RUN-MONTH.                                 
21731      MOVE DATE-IN-DD TO DP200O-RUN-DAY.                                   
21731      MOVE DATE-IN-YY TO DP200O-RUN-YEAR.                                  
21731      MOVE R-HR       TO DP200O-RUN-HOUR.                                  
21731      MOVE R-MIN      TO DP200O-RUN-MINUTE.                                
21731      MOVE PC-PROGRAM-NAME TO DP200O-PROGRAM-NAME.                         
27813                                                                           
27813 *** DETERMINE THE TYPE OF MARKDOWN REPORT TO BE PROCESSED....             
27813 ***   1 - MARKDOWN TRANSACTION LIST                                       
27813 ***   2 - ERROR MARKDOWN TRANSACTION LIST                                 
27813      MOVE 'N'                 TO PS-CONTROL-CARD-SW.                      
27813      PERFORM 4100-READ-MKDN-REPORT-CONTROL.                               
27813      IF ICCI-MKDN-REPORT                                                  
R27813        IF ICCI-POS                                                       
27813            DISPLAY '** ICCI-RPT-VERSION-ID: ' ICCI-RPT-VERSION-ID         
27813                    ' - MARKDOWN TRANSACTION LIST'                         
              END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           DISPLAY '** ICCI-RPT-VERSION-ID: ' ICCI-RPT-VERSION-ID         
R27813                   ' - NEG MARKDOWN TRANSACTION LIST'                     
              END-IF                                                            
27813      ELSE                                                                 
27813      IF ICCI-ERR-MKDN-REPORT                                              
R27813        IF ICCI-POS                                                       
27813            DISPLAY '** ICCI-RPT-VERSION-ID: ' ICCI-RPT-VERSION-ID         
27813                    ' - ERROR MARKDOWN TRANSACTION LIST'                   
              END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           DISPLAY '** ICCI-RPT-VERSION-ID: ' ICCI-RPT-VERSION-ID         
R27813                   ' - NEG ERROR MARKDOWN TRANSACTION LIST'               
              END-IF                                                            
27813      ELSE                                                                 
27813          DISPLAY '** ABEND **'                                            
27813          DISPLAY '** PROGRAM MLKRP033 **'                                 
27813          DISPLAY '** PARAGRAPH 1000-INITIALIZE-HEADER'                    
27813          DISPLAY '** CONTROL CARD INVALID: ' ICCI-RPT-VERSION-ID          
27813          MOVE +4003 TO PV-ABEND-CODE                                      
27813          PERFORM 9999-ABEND                                               
27813      END-IF.                                                              
27813                                                                           
27813      IF ICCI-MKDN-REPORT                                                  
R27813        IF ICCI-POS                                                       
21731            MOVE 1           TO DP200O-REPORT-NUMBER                       
R27813        END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           MOVE 3           TO DP200O-REPORT-NUMBER                       
R27813        END-IF                                                            
R27813     ELSE                                                                 
R27813     IF ICCI-ERR-MKDN-REPORT                                              
R27813        IF ICCI-POS                                                       
21731            MOVE 2           TO DP200O-REPORT-NUMBER                       
R27813        END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           MOVE 4           TO DP200O-REPORT-NUMBER                       
R27813        END-IF                                                            
R27813     END-IF.                                                              
27813                                                                           
           MOVE 'N'             TO PS-MARKDOWN-REC-FOUND-SW                     
           PERFORM 4000-READ-MARKDOWN-DATA                                      
             UNTIL PS-MARKDOWN-REC-FOUND OR PS-INPUT-EOF.                       
           IF PS-MARKDOWN-REC-FOUND                                             
               MOVE ML017-PC-SKU         TO PV-SAVE-SKU                         
R27813         MOVE ML017-PC-CDE         TO PV-SAVE-PC-CDE                      
R27813         MOVE ML017-PC-TYP-CDE     TO PV-SAVE-PC-TYP-CDE                  
R27813         MOVE ML017-PC-RSN-CDE     TO PV-SAVE-PC-RSN-CDE                  
R27813         MOVE ML017-PC-MAJ-CLASS   TO PV-SAVE-PC-MAJ-CLASS                
R27813         MOVE ML017-PC-CLASS-NBR   TO PV-SAVE-PC-CLASS-NBR                
               MOVE ML017-PC-DOC-7-NBR   TO PV-SAVE-DOCNO                       
               MOVE ML017-PC-DEPT-NBR    TO PV-SAVE-DEPT                        
                                            MDSEAR-DEPT-NBR                     
                                            DH-DEPT-NBR                         
               MOVE ML017-PC-BATCH-NBR   TO PV-SAVE-BATCH                       
               MOVE 'Y'                  TO PS-FIRST-RECORD-SW                  
               PERFORM 8400-GET-MDSEAR-DESC                                     
               MOVE MDSEAR-DESC          TO DH-DEPT-NAME                        
R27813         MOVE MDSEAR-GMA-NBR       TO PV-SAVE-GMM-NBR                     
R27813         MOVE MDSEAR-DMA-NBR       TO PV-SAVE-DMM-NBR                     
R27813         MOVE MDSEAR-BYR-NBR       TO PV-SAVE-BYR-NBR                     
           END-IF.                                                              
                                                                                
       EJECT                                                                    
                                                                                
       2000-PROCESS.                                                            
                                                                                
      ****************************************************************          
      *    PRINT DETAIL FOR THE CURRENT MARKDOWN RECORD AND                     
      *    READ THE NEXT INPUT RECORD.                                          
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      ****************************************************************          
                                                                                
           IF PS-FIRST-RECORD                                                   
               MOVE 'N' TO PS-FIRST-RECORD-SW                                   
           END-IF.                                                      00005200
                                                                                
           IF ML017-PC-BATCH-NBR = PV-SAVE-BATCH                                
RONNA          IF ML017-PC-DEPT-NBR = PV-SAVE-DEPT                              
RONNA              IF ML017-PC-DOC-7-NBR = PV-SAVE-DOCNO                        
RONNA                  IF ML017-PC-SKU = PV-SAVE-SKU                            
RONNA                      PERFORM B100-MAP-PRINT-DETAIL                        
RONNA                  ELSE                                                     
RONNA                      PERFORM B150-PRINT-SKU-TOTALS                        
RONNA                      PERFORM B100-MAP-PRINT-DETAIL                        
RONNA                      MOVE ML017-PC-SKU       TO PV-SAVE-SKU               
R27813                     MOVE ML017-PC-CDE       TO PV-SAVE-PC-CDE            
R27813                     MOVE ML017-PC-TYP-CDE   TO PV-SAVE-PC-TYP-CDE        
R27813                     MOVE ML017-PC-RSN-CDE   TO PV-SAVE-PC-RSN-CDE        
R27813                     MOVE ML017-PC-MAJ-CLASS TO                           
R27813                                            PV-SAVE-PC-MAJ-CLASS          
R27813                     MOVE ML017-PC-CLASS-NBR TO                           
R27813                                            PV-SAVE-PC-CLASS-NBR          
RONNA                  END-IF                                                   
RONNA              ELSE                                                         
RONNA                  PERFORM B150-PRINT-SKU-TOTALS                            
RONNA                  PERFORM B200-PRINT-DOCNO-TOTALS                          
RONNA                  PERFORM B100-MAP-PRINT-DETAIL                            
RONNA                  MOVE ML017-PC-SKU       TO PV-SAVE-SKU                   
R27813                 MOVE ML017-PC-CDE       TO PV-SAVE-PC-CDE                
R27813                 MOVE ML017-PC-TYP-CDE   TO PV-SAVE-PC-TYP-CDE            
R27813                 MOVE ML017-PC-RSN-CDE   TO PV-SAVE-PC-RSN-CDE            
R27813                 MOVE ML017-PC-MAJ-CLASS TO PV-SAVE-PC-MAJ-CLASS          
R27813                 MOVE ML017-PC-CLASS-NBR TO PV-SAVE-PC-CLASS-NBR          
RONNA                  MOVE ML017-PC-DOC-7-NBR TO PV-SAVE-DOCNO                 
RONNA              END-IF                                                       
RONNA          ELSE                                                             
RONNA              PERFORM B150-PRINT-SKU-TOTALS                                
RONNA              PERFORM B200-PRINT-DOCNO-TOTALS                              
RONNA              PERFORM B250-PRINT-DEPT-TOTALS                               
23606R             MOVE ML017-PC-DEPT-NBR      TO MDSEAR-DEPT-NBR               
23606R             PERFORM 8400-GET-MDSEAR-DESC                                 
23606R             MOVE MDSEAR-DESC            TO DH-DEPT-NAME                  
R27813             MOVE MDSEAR-GMA-NBR         TO PV-SAVE-GMM-NBR               
R27813             MOVE MDSEAR-DMA-NBR         TO PV-SAVE-DMM-NBR               
R27813             MOVE MDSEAR-BYR-NBR         TO PV-SAVE-BYR-NBR               
23606R             MOVE ML017-PC-DEPT-NBR      TO DH-DEPT-NBR                   
23606R             PERFORM 6000-PRINT-HEADERS                                   
RONNA              PERFORM B100-MAP-PRINT-DETAIL                                
RONNA              MOVE ML017-PC-SKU           TO PV-SAVE-SKU                   
R27813             MOVE ML017-PC-CDE           TO PV-SAVE-PC-CDE                
R27813             MOVE ML017-PC-TYP-CDE       TO PV-SAVE-PC-TYP-CDE            
R27813             MOVE ML017-PC-RSN-CDE       TO PV-SAVE-PC-RSN-CDE            
R27813             MOVE ML017-PC-MAJ-CLASS     TO PV-SAVE-PC-MAJ-CLASS          
R27813             MOVE ML017-PC-CLASS-NBR     TO PV-SAVE-PC-CLASS-NBR          
RONNA              MOVE ML017-PC-DOC-7-NBR     TO PV-SAVE-DOCNO                 
RONNA              MOVE ML017-PC-DEPT-NBR      TO PV-SAVE-DEPT                  
RONNA          END-IF                                                           
RONNA      ELSE                                                                 
RONNA          PERFORM B150-PRINT-SKU-TOTALS                                    
               PERFORM B200-PRINT-DOCNO-TOTALS                                  
RONNA          PERFORM B250-PRINT-DEPT-TOTALS                                   
23606R*        PERFORM B300-PRINT-BATCH-TOTALS                                  
23606R         MOVE ML017-PC-DEPT-NBR      TO MDSEAR-DEPT-NBR                   
23606R         PERFORM 8400-GET-MDSEAR-DESC                                     
23606R         MOVE MDSEAR-DESC            TO DH-DEPT-NAME                      
R27813         MOVE MDSEAR-GMA-NBR       TO PV-SAVE-GMM-NBR                     
R27813         MOVE MDSEAR-DMA-NBR       TO PV-SAVE-DMM-NBR                     
R27813         MOVE MDSEAR-BYR-NBR       TO PV-SAVE-BYR-NBR                     
23606R         MOVE ML017-PC-DEPT-NBR      TO DH-DEPT-NBR                       
23606R         PERFORM 6000-PRINT-HEADERS                                       
RONNA          PERFORM B100-MAP-PRINT-DETAIL                                    
RONNA          MOVE ML017-PC-SKU                 TO PV-SAVE-SKU                 
R27813         MOVE ML017-PC-CDE                 TO PV-SAVE-PC-CDE              
R27813         MOVE ML017-PC-TYP-CDE             TO PV-SAVE-PC-TYP-CDE          
R27813         MOVE ML017-PC-RSN-CDE             TO PV-SAVE-PC-RSN-CDE          
R27813         MOVE ML017-PC-MAJ-CLASS           TO PV-SAVE-PC-MAJ-CLASS        
R27813         MOVE ML017-PC-CLASS-NBR           TO PV-SAVE-PC-CLASS-NBR        
RONNA          MOVE ML017-PC-DOC-7-NBR           TO PV-SAVE-DOCNO               
RONNA          MOVE ML017-PC-DEPT-NBR            TO PV-SAVE-DEPT                
RONNA          MOVE ML017-PC-BATCH-NBR           TO PV-SAVE-BATCH               
           END-IF.                                                              
                                                                                
RONNA *    ADD ML017-PC-QTY              TO DT-TOT-QTY.                         
RONNA *    ADD ML017-PC-TOT-DOC-QTY      TO DT-TOT-DOC-QTY.                     
RONNA *    MOVE ML017-PC-TOT-DOC-QTY     TO DT-TOT-DOC-QTY.                     
RONNA *    ADD PV-EXTAMT                 TO DT-TOT-EXTENDED-AMT.                
                                                                                
RONNA      WRITE OUT-MARKDOWN-RECORD FROM                                       
RONNA           ML017-PRICE-CHANGE-RECORD.                                      
                                                                                
           MOVE 'N'                      TO PS-MARKDOWN-REC-FOUND-SW.           
           PERFORM 4000-READ-MARKDOWN-DATA                                      
             UNTIL PS-MARKDOWN-REC-FOUND OR PS-INPUT-EOF.                       
                                                                                
       4000-READ-MARKDOWN-DATA.                                                 
                                                                                
      ****************************************************************          
      *    READ THE MARKDOWN DATA FILE.                                         
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                                 
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
21731      READ INP-MARKDOWN-FILE INTO ML017-PRICE-CHANGE-RECORD                
               AT END                                                           
                   SET PS-INPUT-EOF TO TRUE.                                    
RONNA *                                                                         
RONNA      IF (ML017-VALID-PC-CDE                                               
27813R        AND ICCI-MKDN-REPORT ) OR                                         
27813R        (ICCI-ERR-MKDN-REPORT)                                            
               MOVE 'Y' TO PS-MARKDOWN-REC-FOUND-SW                             
21731 *        MOVE ML017-PRICE-CHANGE-RECORD TO                                
21731 *             ML017-PRICE-CHANGE-RECORD                                   
               ADD 1 TO PV-IN-COUNTER                                           
           END-IF.                                                              
                                                                                
27813 ****************************************************************          
27813 *  4100-READ-MKDN-REPORT-CONTROL.                                         
27813 ****************************************************************          
27813  4100-READ-MKDN-REPORT-CONTROL.                                           
27813                                                                           
27813      READ INP-CONTROL-CARD-IN NEXT                                        
27813          AT END  MOVE 'Y'     TO PS-CONTROL-CARD-SW                       
27813                  INITIALIZE ICCI-CONTROL-RECORD.                          
27813                                                                           
       6000-PRINT-HEADERS.                                                      
                                                                                
      ****************************************************************          
      *    PRINT THE PAGE HEADERS.                                              
      *                                                                         
      *    PERFORMED BY Z100-DETAIL-PRINT-LINE                                  
      *    PERFORMED BY Z200-PRINT-SKU-TOTALS.   (SKU)                          
      *    PERFORMED BY Z300-PRINT-DOCNO-TOTALS. (DOCNO)                        
      *    PERFORMED BY Z350-PRINT-DEPT-TOTALS.  (DEPT)                         
      *    PERFORMED BY Z400-PRINT-BATCH-TOTALS. (BATCH)                        
      *    PERFORMED BY Z500-PRINT-GRAND-TOTALS.                                
      ****************************************************************          
                                                                                
           ADD  1               TO PV-PAGE-COUNTER.                             
                                                                                
21731      MOVE PV-PAGE-COUNTER TO DP200O-PAGE-NUMBER.                          
                                                                                
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
21731          FROM DP200O-STANDRD-HEADER-200-COLS                              
               AFTER ADVANCING PAGE.                                            
                                                                                
27813      IF ICCI-MKDN-REPORT                                                  
R27813        IF ICCI-POS                                                       
                 WRITE OUT-MARKDOWN-REPORT-RECORD                               
                   FROM HL-HEADING-LINE1                                        
                   AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           WRITE OUT-MARKDOWN-REPORT-RECORD                               
R27813             FROM HL-HEADING-LINE1-NEG                                    
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
27813      ELSE                                                                 
R27813     IF ICCI-ERR-MKDN-REPORT                                              
R27813        IF ICCI-POS                                                       
R27813           WRITE OUT-MARKDOWN-REPORT-RECORD                               
R27813             FROM HL-HEADING-LINE1A                                       
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           WRITE OUT-MARKDOWN-REPORT-RECORD                               
R27813             FROM HL-HEADING-LINE1A-NEG                                   
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
27813      END-IF.                                                              
                                                                                
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DH-DEPT-HEADING                                             
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM HL-HEADING-LINE2                                            
               AFTER ADVANCING 2 LINE.                                          
                                                                                
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM HL-HEADING-LINE3                                            
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM SL-SPACE-LINE                                               
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           MOVE 08 TO PV-LINE-COUNTER.                                          
                                                                                
           EJECT                                                                
                                                                                
R27813 6100-PRINT-SUM-HEADERS.                                                  
R27813                                                                          
R27813****************************************************************          
R27813*    PRINT THE PAGE HEADERS.                                              
R27813*                                                                         
R27813*    PERFORMED BY Z100-DETAIL-PRINT-LINE                                  
R27813*    PERFORMED BY Z200-PRINT-SKU-TOTALS.   (SKU)                          
R27813*    PERFORMED BY Z300-PRINT-DOCNO-TOTALS. (DOCNO)                        
R27813*    PERFORMED BY Z350-PRINT-DEPT-TOTALS.  (DEPT)                         
R27813*    PERFORMED BY Z400-PRINT-BATCH-TOTALS. (BATCH)                        
R27813*    PERFORMED BY Z500-PRINT-GRAND-TOTALS.                                
R27813****************************************************************          
R27813                                                                          
R27813     ADD  1               TO PV-SUM-PAGE-COUNTER.                         
R27813                                                                          
R27813     MOVE PV-SUM-PAGE-COUNTER TO DP200O-PAGE-NUMBER.                      
R27813                                                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DP200O-STANDRD-HEADER-200-COLS                              
R27813         AFTER ADVANCING PAGE.                                            
R27813                                                                          
R27813     IF ICCI-MKDN-REPORT                                                  
R27813        IF ICCI-POS                                                       
R27813           WRITE OUT-MARKDOWN-SUM-RPT-REC                                 
R27813             FROM HL-HEADING-SUM-LINE1                                    
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           WRITE OUT-MARKDOWN-SUM-RPT-REC                                 
R27813             FROM HL-HEADING-SUM-LINE1-NEG                                
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
R27813     ELSE                                                                 
R27813     IF ICCI-ERR-MKDN-REPORT                                              
R27813        IF ICCI-POS                                                       
R27813           WRITE OUT-MARKDOWN-SUM-RPT-REC                                 
R27813             FROM HL-HEADING-SUM-LINE1A                                   
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
R27813        IF ICCI-NEG                                                       
R27813           WRITE OUT-MARKDOWN-SUM-RPT-REC                                 
R27813             FROM HL-HEADING-SUM-LINE1A-NEG                               
R27813             AFTER ADVANCING 2 LINE                                       
R27813        END-IF                                                            
R27813     END-IF.                                                              
R27813                                                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DH-DEPT-HEADING                                             
R27813         AFTER ADVANCING 1 LINE.                                          
R27813                                                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM HL-HEADING-LINE2                                            
R27813         AFTER ADVANCING 2 LINE.                                          
R27813                                                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM HL-HEADING-LINE3                                            
R27813         AFTER ADVANCING 1 LINE.                                          
R27813                                                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM SL-SPACE-LINE                                               
R27813         AFTER ADVANCING 1 LINE.                                          
R27813                                                                          
R27813     MOVE 08 TO PV-SUM-LINE-COUNTER.                                      
R27813                                                                          
R27813     EJECT                                                                
                                                                                
       8400-GET-MDSEAR-DESC.                                                    
                                                                                
           EXEC SQL                                                             
               SELECT     A.MDSEAR_DESC                                         
R27813                   ,A.GMA_NBR                                             
R27813                   ,A.DMA_NBR                                             
R27813                   ,A.BYR_NBR                                             
                 INTO    :MDSEAR-DESC                                           
R27813                  ,:MDSEAR-GMA-NBR                                        
R27813                  ,:MDSEAR-DMA-NBR                                        
R27813                  ,:MDSEAR-BYR-NBR                                        
                 FROM     TMDSEAR A                                             
                    ,     TAPLAVL B                                             
                WHERE    (A.DEPT_NBR    = :MDSEAR-DEPT-NBR)                     
                  AND    (A.MDSELV_CDE  = 'DPT')                                
                  AND    (B.APLSYS_CDE  = 'ML')                                 
                  AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                       
                  AND    (CURRENT DATE                                          
                          BETWEEN B.MDSEAR_STRT_DTE                             
                          AND     B.MDSEAR_END_DTE)                             
                  AND    (CURRENT DATE                                          
                          BETWEEN A.STRT_DTE                                    
                          AND     A.END_DTE)                                    
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE 'NOT FOUND' TO MDSEAR-DESC                              
R27813             MOVE ZEROS       TO MDSEAR-GMA-NBR                           
R27813                                 MDSEAR-DMA-NBR                           
R27813                                 MDSEAR-BYR-NBR                           
               WHEN OTHER                                                       
                   MOVE '8400-GET-MDSEAR-DESC'  TO PV-PARAGRAPH-NAME            
                   MOVE 'SELECT DEPARTMENT ROW ON TMDSEAR'                      
                                                TO PV-DB2-OPER-ATTEMPTED        
                   PERFORM 9998-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
       B100-MAP-PRINT-DETAIL.                                                   
                                                                                
      ****************************************************************          
      *    FORMAT STORE TOTAL PRINT LINE AND ADD STORE TOTALS                   
      *    TO DOCNO TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
           COMPUTE PV-EXTAMT =                                          00006510
21731        (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)                00006510
21731            * ML017-PC-QTY.                                        00006520
                                                                        00006530
           COMPUTE PV-PGMDIFF =                                         00006610
21731        ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.                 00006610
                                                                        00006700
           IF PV-PGMDIFF < 0                                            00007400
               COMPUTE PV-PGMDIFF = PV-PGMDIFF * -1                     00007500
           END-IF.                                                      00007600
                                                                        00007700
RONNA *    TYPE CODE OF 1                                               00006800
RONNA      IF ML017-PC-TYP-CDE = PC-NORMAL-MARKDOWN                     00006800
RONNA          MOVE 'MKDN ' TO PV-TYPE                                  00006900
RONNA      END-IF.                                                      00007200
RONNA *    TYPE CODE OF 2                                               00006800
RONNA      IF ML017-PC-TYP-CDE = PC-MARKDOWN-CANCEL                     00006800
RONNA          MOVE 'MKDNC' TO PV-TYPE                                  00006900
RONNA      END-IF.                                                      00007200
RONNA *    TYPE CODE OF 3                                               00006800
RONNA      IF ML017-PC-TYP-CDE = PC-NORMAL-MARKUP                       00006800
RONNA          MOVE 'MKUP ' TO PV-TYPE                                  00006900
RONNA      END-IF.                                                      00007200
RONNA *    TYPE CODE OF 4                                               00006800
RONNA      IF ML017-PC-TYP-CDE = PC-MARKUP-CANCEL                       00006800
RONNA          MOVE 'MKUPC' TO PV-TYPE                                  00006900
           END-IF.                                                      00007200
                                                                                
21731      MOVE ML017-PC-BATCH-NBR       TO DL-BATCH.                           
           MOVE ML017-PC-DOC-7-NBR       TO DL-DOC.                             
21731      MOVE ML017-PC-ENT-ID          TO DL-ENT-ID.                          
RONNA *    MOVE ML017-PC-LINE-NBR        TO DL-LINE-NO.                         
21731      MOVE ML017-PC-STORE-NBR       TO DL-STORE.                           
21731      MOVE ML017-PC-DTE-MM          TO DL-DATE-MM.                         
21731      MOVE ML017-PC-DTE-DD          TO DL-DATE-DD.                         
21731      MOVE ML017-PC-KOHLS-MM        TO DL-KM.                              
21731      MOVE ML017-PC-KOHLS-MM        TO DL-KM.                              
21731      MOVE ML017-PC-SKU             TO DL-SKU.                             
21731      MOVE ML017-PC-DEPT-NBR        TO DL-DEPT.                            
21731      MOVE ML017-PC-CLASS-NBR       TO DL-SUB.                             
21731      MOVE ML017-PC-MAJ-CLASS       TO PV-MAJOR-CLASS.                     
21731      MOVE PV-MAJOR-CLASS-PART2     TO DL-CLASS.                           
21731      MOVE ML017-PC-OLD-PR-AMT      TO DL-OLD-PRICE.                       
21731      MOVE ML017-PC-NEW-PR-AMT      TO DL-NEW-PRICE.                       
RONNA *    MOVE ML017-PC-DIFFER-AMT      TO DL-KEY-DIFF.                        
           MOVE PV-PGMDIFF               TO DL-PGM-DIFF.                        
21731      MOVE ML017-PC-QTY             TO DL-QTY.                             
RONNA *    MOVE ML017-PC-TOT-DOC-QTY     TO DL-DOC-QTY.                         
RONNA *    MOVE ZEROS                    TO DL-DOC-DIFF.                        
           MOVE PV-EXTAMT                TO DL-EXTENDED-AMT.                    
           MOVE PV-TYPE                  TO DL-TYPE.                            
           PERFORM Z100-PRINT-DETAIL.                                           
                                                                                
RONNA      ADD ML017-PC-QTY              TO ST-TOT-QTY.                         
RONNA      ADD PV-EXTAMT                 TO ST-TOT-EXTENDED-AMT.                
RONNA *    ADD ML017-PC-QTY              TO DDT-TOT-QTY.                        
RONNA *    ADD PV-EXTAMT                 TO DDT-TOT-EXTENDED-AMT.               
RONNA *    ADD ML017-PC-QTY              TO DT-TOT-QTY.                         
RONNA *    ADD PV-EXTAMT                 TO DT-TOT-EXTENDED-AMT.                
                                                                                
RONNA *B150-PRINT-DOC-DEPT-TOTALS.                                              
       B150-PRINT-SKU-TOTALS.                                                   
                                                                                
      ****************************************************************          
      *    FORMAT SKU TOTAL PRINT LINE AND ADD DOCNO TOTALS                     
      *    TO BATCH TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
22606M     MOVE PV-SAVE-SKU            TO DLST-SKU.                             
           MOVE ST-TOT-QTY             TO DLST-QTY.                             
           MOVE ST-TOT-EXTENDED-AMT    TO DLST-EXTENDED-AMT.                    
                                                                                
           PERFORM Z200-PRINT-SKU-TOTALS.                                       
           PERFORM C100-MAP-SKU-SUM.                                            
           PERFORM C200-PRINT-SKU-SUM.                                          
                                                                                
           ADD ST-TOT-QTY              TO DT-TOT-QTY.                           
           ADD ST-TOT-EXTENDED-AMT     TO DT-TOT-EXTENDED-AMT.                  
           MOVE ZEROES                 TO ST-TOT-QTY                            
                                          ST-TOT-EXTENDED-AMT.                  
       B200-PRINT-DOCNO-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    FORMAT DOCNO TOTAL PRINT LINE AND ADD DOCNO TOTALS                   
      *    TO BATCH TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
23606M     MOVE PV-SAVE-DOCNO          TO DLDT-DOCNO.                           
           MOVE DT-TOT-QTY             TO DLDT-QTY.                             
           MOVE DT-TOT-EXTENDED-AMT    TO DLDT-EXTENDED-AMT.                    
                                                                                
           PERFORM Z300-PRINT-DOCNO-TOTALS.                                     
                                                                                
           ADD DT-TOT-QTY              TO DDT-TOT-QTY                           
           ADD DT-TOT-EXTENDED-AMT     TO DDT-TOT-EXTENDED-AMT.                 
           MOVE ZEROES                 TO DT-TOT-QTY                            
                                          DT-TOT-EXTENDED-AMT.                  
       B250-PRINT-DEPT-TOTALS.                                                  
                                                                                
      ****************************************************************          
      *    FORMAT DOCNO TOTAL PRINT LINE AND ADD DOCNO TOTALS                   
      *    TO BATCH TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
23606M     MOVE PV-SAVE-DEPT            TO DLDPT-DEPT-NBR.                      
23606M     MOVE DDT-TOT-QTY             TO DLDPT-TOT-QTY.                       
           MOVE DDT-TOT-EXTENDED-AMT    TO DLDPT-TOT-EXTENDED-AMT.              
                                                                                
           PERFORM Z350-PRINT-DEPT-TOTALS.                                      
                                                                                
23606R*    ADD DDT-TOT-QTY             TO BT-TOT-QTY.                           
23606R     ADD DDT-TOT-QTY             TO GT-TOT-QTY.                           
23606R*    ADD DDT-TOT-EXTENDED-AMT    TO BT-TOT-EXTENDED-AMT.                  
23606R     ADD DDT-TOT-EXTENDED-AMT    TO GT-TOT-EXTENDED-AMT.                  
           MOVE ZEROES                 TO DDT-TOT-QTY                           
                                          DDT-TOT-EXTENDED-AMT.                 
       B300-PRINT-BATCH-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    FORMAT BATCH TOTAL PRINT LINE AND ADD BATCH TOTALS                   
      *    TO GRAND TOTALS.                                                     
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
23606M     MOVE PV-SAVE-BATCH          TO DLBT-BATCH.                           
           MOVE BT-TOT-QTY             TO DLBT-QTY.                             
           MOVE BT-TOT-EXTENDED-AMT    TO DLBT-EXTENDED-AMT.                    
                                                                                
           PERFORM Z400-PRINT-BATCH-TOTALS.                                     
                                                                                
           ADD BT-TOT-QTY              TO GT-TOT-QTY.                           
           ADD BT-TOT-EXTENDED-AMT     TO GT-TOT-EXTENDED-AMT.                  
           MOVE ZEROES                 TO BT-TOT-QTY                            
                                          BT-TOT-EXTENDED-AMT.                  
           PERFORM 6000-PRINT-HEADERS.                                          
                                                                                
       B400-PRINT-GRAND-TOTALS.                                                 
      ****************************************************************          
      *    FORMAT GRAND TOTAL PRINT LINE                                        
      *                                                                         
      *    PERFORMED BY 0000-MLKRP033.                                          
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           MOVE GT-TOT-QTY             TO DLGT-QTY.                             
           MOVE GT-TOT-EXTENDED-AMT    TO DLGT-EXTENDED-AMT.                    
                                                                                
23606R     MOVE ZEROS                  TO DH-DEPT-NBR.                          
23606R     MOVE 'CORPORATE'            TO DH-DEPT-NAME.                         
23606R     PERFORM 6000-PRINT-HEADERS.                                          
           PERFORM Z500-PRINT-GRAND-TOTALS.                                     
                                                                                
R27813 C100-MAP-SKU-SUM.                                                        
R27813                                                                          
R27813****************************************************************          
R27813*    MAP FIELDS TO THE SKU SUMMARY RECORD                                 
R27813*                                                                         
R27813****************************************************************          
R27813                                                                          
R27813     MOVE PV-SAVE-DOCNO            TO ML011-DOC-NBR.                      
R27813     MOVE PV-SAVE-GMM-NBR          TO ML011-GMM-NBR.                      
R27813     MOVE PV-SAVE-DMM-NBR          TO ML011-DMM-NBR.                      
R27813     MOVE PV-SAVE-BYR-NBR          TO ML011-BYR-NBR.                      
R27813     MOVE PV-SAVE-DEPT             TO ML011-DEPT-NBR.                     
R27813     MOVE PV-SAVE-SKU              TO ML011-SKU-NBR.                      
R27813     MOVE PV-SAVE-PC-CDE           TO PV-PC-CDE.                          
R27813     MOVE PV-SAVE-PC-TYP-CDE       TO PV-PC-TYP-CDE.                      
R27813     MOVE PV-SAVE-PC-RSN-CDE       TO PV-PC-RSN-CDE.                      
R27813     MOVE PV-PC-TYPE               TO ML011-PC-TYPE.                      
R27813     MOVE PV-SAVE-PC-MAJ-CLASS     TO ML011-MCL-NBR.                      
R27813     MOVE PV-SAVE-PC-CLASS-NBR     TO ML011-SCL-NBR.                      
R27813*    THE QUANTITY IS EITHER GOING TO BE POSITVE OR NEGATIVE               
R27813*    IT WILL NEVER BE ZERO.                                               
R27813     IF ICCI-NEG                                                          
R27813         COMPUTE PV-ST-TOT-QTY = ST-TOT-QTY * -1                          
R27813         MOVE PV-ST-TOT-QTY        TO ML011-NEG-ON-HAND-QTY               
R27813         COMPUTE PV-ST-TOT-EXT-QTY = ST-TOT-EXTENDED-AMT * -1             
R27813         MOVE PV-ST-TOT-EXT-QTY    TO ML011-NEG-EXTD-RTL-AMT              
R27813         MOVE ZERO                 TO ML011-POS-ON-HAND-QTY               
R27813         MOVE ZERO                 TO ML011-POS-EXTD-RTL-AMT              
R27813     ELSE                                                                 
R27813         MOVE ZERO                 TO ML011-NEG-ON-HAND-QTY               
R27813         MOVE ZERO                 TO ML011-NEG-EXTD-RTL-AMT              
R27813         MOVE ST-TOT-QTY           TO ML011-POS-ON-HAND-QTY               
R27813         MOVE ST-TOT-EXTENDED-AMT  TO ML011-POS-EXTD-RTL-AMT              
R27813     END-IF.                                                              
                                                                                
R27813 C200-PRINT-SKU-SUM.                                                      
R27813                                                                          
R27813****************************************************************          
R27813*    PRINT SKU SUM RECORD                                                 
R27813*                                                                         
R27813****************************************************************          
R27813                                                                          
R27813     WRITE OUT-MARKDOWN-SUM-REC                                           
R27813         FROM ML011-PRICE-CHANGE-RECORD.                                  
R27813                                                                          
           EJECT                                                                
                                                                                
       Z100-PRINT-DETAIL.                                                       
                                                                                
      ****************************************************************          
      *    PRINT DETAIL LINE.                                                   
      *                                                                         
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS                                        
           END-IF.                                                              
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DL-DETAIL-LINE                                              
               AFTER ADVANCING 1 LINE.                                          
           ADD 1 TO PV-LINE-COUNTER.                                            
                                                                                
           EJECT                                                                
                                                                                
       Z200-PRINT-SKU-TOTALS.                                                   
                                                                                
      ****************************************************************          
      *    PRINT TOTAL LINE                                                     
      *                                                                         
      *    PERFORMED BY B100-MAP-PRINT-DETAIL.                                  
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS                                        
           END-IF.                                                              
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DLST-SKU-TOTALS-PRINT-LINE                                  
               AFTER ADVANCING 1 LINE.                                          
           ADD 2 TO PV-LINE-COUNTER.                                            
                                                                                
R27813     IF PV-SUM-LINE-COUNTER >= PC-LINE-MAX                                
R27813        PERFORM 6100-PRINT-SUM-HEADERS                                    
R27813     END-IF.                                                              
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DLST-SKU-TOTALS-PRINT-LINE                                  
R27813         AFTER ADVANCING 1 LINE.                                          
R27813     ADD 2 TO PV-SUM-LINE-COUNTER.                                        
R27813                                                                          
           EJECT                                                                
                                                                                
       Z300-PRINT-DOCNO-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    PRINT DOCNO TOTALS                                                   
      *                                                                         
      *    PERFORMED BY B200-PRINT-DOCNO-TOTALS.                                
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS                                        
           END-IF.                                                              
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DLDT-DOCNO-TOTALS-PRINT-LINE                                
               AFTER ADVANCING 2 LINE.                                          
RONNA      WRITE OUT-MARKDOWN-REPORT-RECORD                                     
RONNA          FROM SL-SPACE-LINE.                                              
RONNA      ADD 3 TO PV-LINE-COUNTER.                                            
                                                                                
R27813     IF PV-SUM-LINE-COUNTER >= PC-LINE-MAX                                
R27813        PERFORM 6100-PRINT-SUM-HEADERS                                    
R27813     END-IF.                                                              
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DLDT-DOCNO-TOTALS-PRINT-LINE                                
R27813         AFTER ADVANCING 2 LINE.                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM SL-SPACE-LINE.                                              
R27813     ADD 3 TO PV-SUM-LINE-COUNTER.                                        
                                                                                
           EJECT                                                                
                                                                                
       Z350-PRINT-DEPT-TOTALS.                                                  
                                                                                
      ****************************************************************          
      *    PRINT DEPT  TOTALS                                                   
      *                                                                         
      *    PERFORMED BY B250-PRINT-DEPT-TOTALS.                                 
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS                                        
           END-IF.                                                              
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DLDT-DEPT-TOTALS-PRINT-LINE                                 
               AFTER ADVANCING 2 LINE.                                          
RONNA      WRITE OUT-MARKDOWN-REPORT-RECORD                                     
RONNA          FROM SL-SPACE-LINE.                                              
RONNA      ADD 3 TO PV-LINE-COUNTER.                                            
                                                                                
R27813     IF PV-SUM-LINE-COUNTER >= PC-LINE-MAX                                
R27813        PERFORM 6100-PRINT-SUM-HEADERS                                    
R27813     END-IF.                                                              
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DLDT-DEPT-TOTALS-PRINT-LINE                                 
R27813         AFTER ADVANCING 2 LINE.                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM SL-SPACE-LINE.                                              
R27813     ADD 3 TO PV-SUM-LINE-COUNTER.                                        
                                                                                
           EJECT                                                                
                                                                                
       Z400-PRINT-BATCH-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    PRINT BATCH TOTALS                                                   
      *                                                                         
      *    PERFORMED BY B300-PRINT-BATCH-TOTALS.                                
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS                                        
           END-IF.                                                              
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DLBT-BATCH-TOTALS-PRINT-LINE                                
               AFTER ADVANCING 2 LINE.                                          
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM SL-SPACE-LINE                                               
               AFTER ADVANCING 1 LINE.                                          
           ADD 2 TO PV-LINE-COUNTER.                                            
                                                                                
R27813     IF PV-SUM-LINE-COUNTER >= PC-LINE-MAX                                
R27813        PERFORM 6100-PRINT-SUM-HEADERS                                    
R27813     END-IF.                                                              
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DLBT-BATCH-TOTALS-PRINT-LINE                                
R27813         AFTER ADVANCING 2 LINE.                                          
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM SL-SPACE-LINE                                               
R27813         AFTER ADVANCING 1 LINE.                                          
R27813     ADD 2 TO PV-SUM-LINE-COUNTER.                                        
                                                                                
           EJECT                                                                
                                                                                
       Z500-PRINT-GRAND-TOTALS.                                                 
                                                                                
      ****************************************************************          
      *    PRINT GRAND TOTALS                                                   
      *                                                                         
      *    PERFORMED BY B300-PRINT-BATCH-TOTALS.                                
      ****************************************************************          
                                                                                
           IF PV-LINE-COUNTER >= PC-LINE-MAX                                    
              PERFORM 6000-PRINT-HEADERS                                        
           END-IF.                                                              
           WRITE OUT-MARKDOWN-REPORT-RECORD                                     
               FROM DLGT-GRAND-TOTALS-PRINT-LINE                                
               AFTER ADVANCING 1 LINE.                                          
           ADD 2 TO PV-LINE-COUNTER.                                            
                                                                                
R27813     IF PV-SUM-LINE-COUNTER >= PC-LINE-MAX                                
R27813        PERFORM 6100-PRINT-SUM-HEADERS                                    
R27813     END-IF.                                                              
R27813     WRITE OUT-MARKDOWN-SUM-RPT-REC                                       
R27813         FROM DLGT-GRAND-TOTALS-PRINT-LINE                                
R27813         AFTER ADVANCING 1 LINE.                                          
R27813     ADD 2 TO PV-SUM-LINE-COUNTER.                                        
                                                                                
           EJECT                                                                
                                                                                
171700 9998-SQL-ABEND.                                                          
171800                                                                          
171900     MOVE +4013 TO PV-ABEND-CODE.                                         
172000     DISPLAY '** ABEND **         ** = SQLERROR'.                         
172100     DISPLAY '** PROGRAM          ** = MLKRP200'.                         
172200     DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.               
172300     DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.           
172400                                                                          
172500*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
172600*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
172700     COPY DPPD004.                                                        
172800                                                                          
172900     PERFORM 9999-ABEND.                                                  
173000                                                                          
173100                                                                          
173200 9999-ABEND.                                                              
173300                                                                          
173400     CALL 'ILBOABN0'  USING PV-ABEND-CODE.                                
